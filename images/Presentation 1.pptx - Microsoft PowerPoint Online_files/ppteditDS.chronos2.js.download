'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1001:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r,n=null){super();this.shapeId=e;this.jeg=r;this.WY=n}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},1002:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r=null){super();this.shapeId=e;this.WY=r}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOutEventArgs",
Sys.EventArgs,[])},1003:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.XHc=null}}Object(J.a)(h,"IdeasSmartArtSuggestionWrapper",null,[])},1240:function(J,aa,d){d.r(aa);var h=d(0),e=d(71),r=d(387),n=d(14),v=d(27),B=d(199),y=d(142),x;(function(t){t[t.error=0]="error";t[t.warning=1]="warning";t[t.tip=2]="tip";t[t.intelligentService=3]="intelligentService"})(x||(x={}));Object(h.b)("AccessibilityRuleCategory",x);var A=d(57),E=d(73),u=d(37),K=d(126),G=d(182),O=d(108);
class R{constructor(t,S,la=null){this.bxd=null;this.Rff=this.mff=!1;this.JBa=t;this.$vc=S;this.Ca=la;this.An.ya(u.a.xvi,E.a.frame,Object(n.a)(this,this.YK,"closePane"))}get An(){return this.Ca||(this.Ca=v.AFrameworkApplication.Ta)}set An(t){this.Ca=t}OSi(){this.mff||(this.JBa.initialize(this),this.$vc.initialize(this),this.mff=!0)}xHe(){O.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.$vc.H5k()}Ql(t,S,la){if(1===la)return B.SessionStatusManager.instance.Aka?8:32;this.JBa.isVisible||this.OSi();
this.znl();return 32}YK(t,S,la){1!==la&&this.JBa.Cr();return 32}eJe(){this.JBa.Ewh(!0)}F0d(t){if(t){if(t.AccessibilityRules&&Object.keys(t.AccessibilityRules).length){const la=t.AccessibilityRules;for(let Ca in la){var S=Ca;const Na=la[Ca].RuleId+"";S!==Na&&O.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",S,Na)}this.bxd=la}else!this.bxd&&t.Results&&0<t.Results.length?(O.c(18993251,200,15,"No accessibility rule definitions available"),t.IsSuccess=!1):t.AccessibilityRules=
this.bxd;t.IsSuccess||O.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.BYk(t);this.q5j(t);this.JBa.F0d(t)}}BYk(t){const S=t.AccessibilityRules;if(t=t.Results)for(let la=t.length-1;0<=la;la--){const Ca=t[la];let Na="";const qb=Ca.RuleId;Ca.ContentName||(Na+="Result does not have content name. ");qb in S||(Na+=String.format("No accessibility check rule exists for ID {0}.",qb));0<Na.length&&(O.c(36214999,200,15,"Omitting invalid accessibility check result: "+Na),Array.removeAt(t,la))}}ljj(){return v.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("accessibility-checker-pane-strings"):A.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Vw.loadScript("accessibility-checker-pane-strings")}znl(){this.Rff?this.JBa.Ql():this.ljj().then(()=>{this.Rff=!0;this.JBa.Ql()}).catch(t=>r.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",t))}q5j(t){var S={};const la={};var Ca=t.Results,Na=[];Array.add(Na,Object.assign(new K.a,{name:"FinalViolationCount",int64:0}));
Array.add(Na,Object.assign(new K.a,{name:"FinalErrorCount",string:"0"}));Array.add(Na,Object.assign(new K.a,{name:"FinalWarningCount",string:"0"}));Array.add(Na,Object.assign(new K.a,{name:"FinalTipCount",string:"0"}));Array.add(Na,Object.assign(new K.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Ca){for(const xc of Ca)if(t.AccessibilityRules){var qb=t.AccessibilityRules[xc.RuleId];if(qb){if(S[x[qb.Category]]){let ed=S[x[qb.Category]];S[x[qb.Category]]=++ed}else S[x[qb.Category]]=1;la[xc.RuleId]?
(qb=la[xc.RuleId],la[xc.RuleId]=++qb):la[xc.RuleId]=1}}Na[0].int64=Ca.length;for(var Pb in S)switch(t=S[Pb],Ca=Pb,Ca="Final"+Ca.charAt(0).toUpperCase()+Ca.substring(1,Ca.length)+"Count",Ca){case "FinalErrorCount":Na[1].string=t.toString();break;case "FinalWarningCount":Na[2].string=t.toString();break;case "FinalTipCount":Na[3].string=t.toString();break;case "FinalIntelligentServiceCount":Na[4].string=t.toString()}}y.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}","Office.UX.AccChecker",
"AccCheckerViolationInformation"),dataFields:Na}));for(let xc in la)S=xc,Na=la[xc],Pb=[],Array.add(Pb,Object.assign(new K.a,{name:"RuleID",string:S})),Array.add(Pb,Object.assign(new K.a,{name:"FinalViolationCount",string:Na.toString()})),y.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Pb}))}dispose(){this.JBa&&this.JBa.dispose();this.$vc&&this.$vc.dispose()}}Object(h.a)(R,"AAccessibilityCheckManager",
null,[182,106]);var V=d(82),D=d(1204),Q=d(63),Z=d(297),P=d(28);class ca extends R{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed){super(t,S);this.dfb=this.VHa=null;this.Fa=la;this.zb=Ca;this.Nq=Na;this.WX=qb;this.ua=Pb;this.pa=xc;this.Tb=ed;this.dCe=!1}Pbl(t){if(!t)return P.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(t.sldIdField){var S=new Q.a(Object.assign(new Z.a,{Sid:t.sldIdField.sidField,Cid:t.sldIdField.cidField}));S=this.Tb.pka(S);if(!S)return!1;let la=null;if(t.spIdFieldSpecified&&
(la=S.zC(t.spIdField),!la&&this.dCe))return!1;this.G8k(S,la)}else P.a.J(19227929,334,15,"There is no slide id info in violation data");return!0}xHe(){this.dCe=!1;super.xHe()}eJe(){this.dCe=!0;super.eJe()}G8k(t,S){if(t){const la=this.ua.Ba!==t?!0:!1;S&&(this.dfb=S,la?this.Nq.eW(Object(n.a)(this,this.hHb,"onActiveSlideDomChanged")):this.pph());la&&(this.WX.Ba=t);this.pa.ey();this.Fa.Ed()}}hHb(){this.Nq.Yxa(Object(n.a)(this,this.hHb,"onActiveSlideDomChanged"));this.VHa||(this.VHa=new V.a(2,1,0,Object(n.a)(this,
this.YIe,"onPostActiveSlideDomChangedTask"),90,"20"),this.zb.Db(this.VHa))}YIe(){this.VHa=null;this.pph()}Ed(){this.WX.PK.pp||this.Fa.Ed()}pph(){if(this.dfb){const t=Object(D.a)(117,this.dfb.ng(this.WX.PK.Ma));t?t.Al?P.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.dfb.id):t.aq?t.ord():this.pa.selectShape(this.dfb,!0):P.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.dfb.id);this.Ed();this.dfb=null}}}Object(h.a)(ca,"PptAccCheckManager",
R,[]);class T{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(t){t=Sys.Serialization.JavaScriptSerializer.deserialize(t);const S=t.AccessibilityRules,la={};if(S)for(let Ca=0;Ca<S.length;++Ca){const Na=S[Ca];la[Na.Key]=Na.Value}t.AccessibilityRules=la;return t}}Object(h.a)(T,"AccessibilityCheckResultCollection",null,[]);class da{}Object(h.a)(da,"AccessibilityCheckResult",null,[]);class fa{}Object(h.a)(fa,"AccessibilityCheckRule",
null,[]);class ma{constructor(t){this.JMa=null;this.edf=t}get fileId(){return this.edf?this.edf():null}initialize(t){this.JMa=t}e3g(t){this.JMa.F0d(t)}}Object(h.a)(ma,"AAccessibilityCheckService",null,[665,106]);var ea=d(18),ra=d(110);class F extends ra.a{constructor(){super()}Zk(){return 56}}Object(h.a)(F,"AccCheckRequest",ra.a,[]);var na=d(246);class ka extends ma{constructor(t,S){super(null);this.wi=t;this.BXa=S}H5k(){const t=new na.a(new F,Object(n.a)(this,this.yrk,"onAccCheckSucceed"),Object(n.a)(this,
this.xrk,"onAccCheckFailed"));this.wi.Db(t)}dispose(){}get JJj(){return 0<this.BXa.qYb.length}yrk(t){if(t&&t.ACResult&&(t=this.Fki(t.ACResult))){this.e3g(t);P.a.J(19227935,334,50,"Acc-check succeeded");return}this.AYg("Succeeded but response is invalid")}xrk(t){this.AYg(t.toString());return!0}AYg(t){P.a.J(19227937,334,50,String.format("Acc-check failed: {0}",t));t=new T;t.IsSuccess=!1;this.e3g(t)}Fki(t){if(t){var S=null;try{S=JSON.parse(t)}catch(la){return P.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",
la.toString()),null}if(S){t=new T;t.IsSuccess=!0;t.IsPartialResult=S.isPartialResultField;t.AccessibilityRules={};if(S.violatedRulesField){const la=new ea.a;for(const Ca of S.violatedRulesField)if(S=this.Hki(Ca)){t.AccessibilityRules[S.RuleId]=S;for(const Na of Ca.violationsField){const qb=new da;qb.RuleId=S.RuleId;qb.ContentName=Na.labelField;qb.ContentId=Na;la.add(qb)}}t.Results=la.toArray()}return t}}return null}Hki(t){if(!t)return null;if(t.ruleIdField>=this.BXa.qYb.length)return P.a.J(19227971,
334,10,"Rule id {0} is bigger than total rule info list count {1}",t.ruleIdField,this.BXa.qYb.length),null;const S=new fa;S.RuleId=t.ruleIdField.toString();S.RuleName=this.BXa.qYb[t.ruleIdField].ruleTextField;switch(this.BXa.qYb[t.ruleIdField].ruleTypeField){case 0:S.Category=0;break;case 1:S.Category=1;break;case 2:S.Category=2;break;case 3:S.Category=3}return S}}Object(h.a)(ka,"PptAccCheckService",ma,[664,665,106]);class Ua{get SAi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get TAi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get UAi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get YBk(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get whd(){return CommonUIStrings.l_AccCheckerPaneTitle}get HEk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(h.a)(Ua,"AccessibilityCheckStringsProvider",null,[1322]);class za{constructor(){this.qnh=this.contentId=null}}Object(h.a)(za,"ResultIds",null,[]);var ha=d(67),ua=d(173);class Ga{constructor(t,S){this._element=null;this.Nn=S;this.Rg=t}get element(){this._element||(this._element=this.oYd(),this.Wu());return this._element}nkb(t){this._element=t}dispose(){this.element&&(this.ppa(),this.nkb(null))}Wu(){this.Nn&&this.Rg?(this.Nn.pb(ha.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),
this.Rg.pb(ha.a.Xf,this.element,Object(n.a)(this,this.a5g,"onKeyPress"))):r.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}ppa(){this.Nn&&this.Rg&&(this.Nn.yb(ha.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),this.Rg.yb(ha.a.Xf,this.element,Object(n.a)(this,this.a5g,"onKeyPress")))}onClick(){this.X4g();return!0}a5g(t){return this.FQj(t.qc.keyCode)?(this.X4g(),!0):!1}FQj(t){return t===
ua.a.NPb||t===ua.a.tq}}Object(h.a)(Ga,"AInteractivePaneElement",null,[1353,106]);const sa=(t,S,la)=>{t=document.createElement(t);S&&(t.id=S);la&&(t.className=la);t.setAttribute("Unselectable","on");return t};var Ba=d(75),pa=d(135),ia=d(97);class Da extends Ga{constructor(t,S,la){super(t,S);this.tYh=la}hide(){this.element.removeAttribute(pa.a.af);pa.a.eP(this.element,pa.a.SK,pa.a.jC);this.element.style.display="none"}show(){pa.a.eP(this.element,pa.a.SK,pa.a.Nia);pa.a.eP(this.element,pa.a.af,pa.a.cSd);
this.element.style.display="block"}oYd(){const t=sa("div",this.c1g,"AccCheckerNotification");pa.a.eP(t,pa.a.dSd,pa.a.jC);pa.a.eP(t,pa.a.U2,this.oGe);t.tabIndex=0;const S=sa("span",this.b1g,"AccCheckerNotificationIcon");var la=Ba.createClusteredImage(16,16,"Info_16x16x32","",!0,"");S.appendChild(la);la=sa("span",this.oGe,"AccCheckerNotificationText");ia.a.Nx(la,this.d1g);t.appendChild(S);t.appendChild(la);return t}X4g(){this.tYh()}}Object(h.a)(Da,"APopupNotification",Ga,[1389,1353,106]);class Xa extends Da{constructor(t,
S,la,Ca){super(t,S,la);this.Zba=Ca}get c1g(){return"AccCheckerOutOfSyncNotificationId"}get b1g(){return"AccCheckerOutOfSyncNotificationIconId"}get oGe(){return"AccCheckerOutOfSyncNotificationTextId"}get d1g(){return this.Zba.YBk}}Object(h.a)(Xa,"OutOfSyncNotification",Da,[]);class Ka extends Da{constructor(t,S,la,Ca){super(t,S,la);this.Zba=Ca}get c1g(){return"AccCheckerPartialResultNotificationId"}get b1g(){return"AccCheckerPartialResultNotificationIconId"}get oGe(){return"AccCheckerPartialResultNotificationTextId"}get d1g(){return this.Zba.HEk}}
Object(h.a)(Ka,"PartialResultNotification",Da,[]);var Ma=d(121),Oa=d(107);class qa{constructor(t,S,la,Ca=null,Na=null,qb=null,Pb=null){this.qnf=this.F7=this.Rg=this.JMa=null;this.Ibb=Ca;this.Nn=t;this.Od=S;this.xK=la;this.Zba=Pb||new Ua;this.hId=Na||new Xa(this.Ibb,this.Nn,Object(n.a)(this,this.ONi,"dimissOutOfSyncNotification"),this.Zba);this.zId=qb||new Ka(this.Ibb,this.Nn,Object(n.a)(this,this.PNi,"dimissPartialResultNotification"),this.Zba)}show(){}hide(){}get Ibb(){return this.Rg||(this.Rg=v.AFrameworkApplication.Aa.pG)}set Ibb(t){this.Rg=
t}tKf(){}Cr(){}dispose(){}CGh(){}gpd(){}sJj(t){var S=this.qnf[t];t=S.contentId;if((S=S.qnh+"")&&S.length){const la=[];Array.add(la,Object.assign(new K.a,{name:"RuleID",string:S}));y.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}",qa.J1e,"ViolationSelected"),dataFields:la}))}this.Tok(t)}Tok(t){t&&this.JMa.Pbl(t)||(this.Od.LU(Ma.AFrame.ZV,!1),this.bml())}ONi(){this.Ewh(!1);this.gpd()}PNi(){this.Gwh(!1);this.gpd()}bml(){const t=Object.assign(new Oa.StandardDialog(!0),{Ar:v.AFrameworkApplication.Kda,
yd:1,E0a:!1});t.wya(1);t.Xe(1,this.Zba.SAi);t.Xe(0,CommonUIStrings.l_DialogCancel);t.fP(this.Zba.UAi,this.Zba.TAi,S=>{1===S&&this.Lie()})}omi(t){let S=null;if(t.Results&&0<t.Results.length){S={};let la=0;for(const Ca of t.Results)Ca.ResultId=qa.R4h+ ++la,t=new za,t.contentId=Ca.ContentId,t.qnh=Ca.RuleId,S[Ca.ResultId]=t}return S}y5j(){y.a.addNamespaceMapping(qa.J1e,qa.Ovl);y.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}",qa.J1e,"ShowTaskpane")}))}}qa.R4h="AccCheckResult";
qa.J1e="Office.UX.AccChecker";qa.Ovl="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(h.a)(qa,"BaseAccessibilityCheckPane",null,[642,106]);class Ya{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(h.a)(Ya,"AccCheckerTaskPaneProps",null,[]);
var Fb=d(1162),hc=d(282);class ec{constructor(){this.Qwc=new ea.a}pKa(t){this.Qwc.add(t)}eel(t){for(let S of this.Qwc)S(t)}}Object(h.a)(ec,"ReactTaskPaneManager",null,[1351]);var Tb=d(651),vb=d(141);class zb extends qa{constructor(t,S,la,Ca,Na=null,qb=null,Pb,xc=null,ed=null){super(S,la,Ca,qb,void 0,void 0,xc);this.W7e=null;this.Dmf=this.yId=this.qCc=this.QDc=this.BDc=!1;this.HNd=null;this.CMd=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.Wme;this.GSb=
this.Fpa=null;this.fTb=0;this.xzc=null;this.Xxd=Na;ed&&(this.Fpa=ed.d5h,this.GSb=ed.f_i,this.fTb=ed.uAj);this.Fqa=new ec}get isVisible(){return this.Dmf}AMb(t){this.Dmf=t}F0d(t){t&&(this.W7e=t,t.IsSuccess&&(this.qnf=this.omi(t),t.IsPartialResult&&this.Gwh(!0)),this.BDc=!0,this.QDc=!1,this.Luc())}Ewh(t){this.isVisible&&t!==this.qCc&&(this.qCc=t,this.Luc())}Gwh(t){this.yId=t;this.Luc()}Ql(){this.QDc||vb.UISurfaces.zr().then(t=>{hc.a.instance.Q2(zb.b2a+":PaneOpen:Start");t.showTaskPane(zb.b2a,this.Jca());
this.Lie();return null});this.isVisible?vb.UISurfaces.zr().then(t=>{t.setSelectedTaskPane(zb.b2a);return null}):this.y5j()}Luc(){vb.UISurfaces.zr().then(t=>{t.updateTaskPane(zb.b2a,this.Jca());return null})}Jca(){var t=new Ya;this.Fqa.eel(t);t=Object.assign(new Tb.a,{title:this.Zba.whd,hideHeader:!1,width:320,location:2,contentProps:t,onOpen:()=>{this.Sbl();this.AMb(!0);v.AFrameworkApplication.Aa.updateCommandUI()},onClose:()=>{this.mpd();this.AMb(!1);this.QDc=this.BDc=!1;this.Luc();v.AFrameworkApplication.Aa.updateCommandUI()},
isModernPane:!0});this.CMd&&(t.enableResize=!0,t.minResizeWidth=268,t.maxResizeWidth=920);return t}initialize(t){const S=this.Od.Fc(zb.b2a);S.parent=Ma.AFrame.hj;S.dJ=!0;this.JMa=t;this.s5h()}dispose(){this.CGh();this.hId&&(this.hId.dispose(),this.hId=null);this.zId&&(this.zId.dispose(),this.zId=null);super.dispose()}s5h(){this.Fqa.pKa(this.onRecheckExecute());this.Fqa.pKa(this.E3i());this.Fqa.pKa(this.tij());this.Fqa.pKa(this.onInvokeNavigateExecute());this.Fqa.pKa(this.abj());this.Fqa.pKa(this.Pfj());
this.Fqa.pKa(this.rgj());this.Fqa.pKa(this.updateLastScanTime());this.Fqa.pKa(this.showHelpPane())}onRecheckExecute(){return t=>{t.onRecheckExecute=()=>{this.Lie()}}}E3i(){return t=>{t.accessibilityCheckResultCollection=this.W7e}}tij(){return t=>{t.resultsReady=this.BDc}}onInvokeNavigateExecute(){return t=>{t.onInvokeNavigateExecute=S=>{this.sJj(S)}}}abj(){return t=>{t.helpLink=this.LVi}}Pfj(){return t=>{t.outOfSync=this.qCc}}rgj(){return t=>{t.partialResult=this.yId}}updateLastScanTime(){return t=>
{t.updateLastScanTime=S=>{this.HNd=S}}}showHelpPane(){return t=>{t.showHelpPane=()=>{v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?v.AFrameworkApplication.Asa||this.Eyf()?this.xzc?this.xzc():this.Fpa.value&&this.GSb&&this.fTb&&this.Fpa.value.La(this.fTb,2,this.GSb):this.nxh():this.Eyf()?this.xzc?this.xzc():this.Fpa.value&&this.GSb&&this.fTb&&this.Fpa.value.La(this.fTb,2,this.GSb):this.nxh()}}}Eyf(){return!this.Xxd||
!this.Xxd.value}nxh(){const t=this.Xxd.value;if(t){var S={};S.query=zb.g_h+zb.JCd;S=Object.assign(new Fb.a,{nonPersistedSettings:S});t.lga(zb.ICd,S)}}Lie(){this.yId=this.qCc=this.BDc=!1;this.HNd&&this.HNd();this.Luc();this.QDc=!0;this.JMa.xHe()}Sbl(){this.Od.rf(zb.b2a)}mpd(){this.Vme()&&this.Od.rf(this.Od.q8)}Vme(){return!!this.Od.Ae&&this.Od.Ae.name===zb.b2a}}zb.b2a="AccessibilityCheckerPane";zb.JCd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";zb.ICd="FA000000012";zb.g_h="AssetID=";Object(h.a)(zb,"ReactAccessibilityCheckPane",
qa,[]);class Xb{constructor(t,S,la){this.d5h=t;this.f_i=S;this.uAj=la}}Object(h.a)(Xb,"HelpPaneProperties",null,[]);var Za=d(102),Va=d(30);class tc extends zb{constructor(t,S,la,Ca,Na,qb,Pb,xc){super(null,S,la,Ca,void 0,null,void 0,void 0,new Xb(Pb,tc.M7d(),Va.a.lga));this.Mgc=t;this.G6j=Na;this.zH=qb;this.bHg=Pb;this.tB=xc}get isVisible(){return!!this.Mgc&&this.Mgc.isVisible}AMb(t){this.Mgc&&(this.Mgc.isVisible=t)}get LVi(){return this.G6j}Ql(){this.AMb(!0);this.zH.IM(this.Mgc,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
Ma.AFrame.ZV);super.Ql();if(this.bHg){var t=this.bHg.value;if(t){t.processAction(Va.a.vOd,1);t=!1;try{this.tB.selectRibbonTabById("AccessibleAuthoring"),t=!0}catch(S){P.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",S.toString())}Za.a("AccessibleAuthoringTab",t)}else P.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else P.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Cfd(){}onBeforeLoadContent(){}onAfterLoadContent(){this.JMa&&
this.JMa.eJe()}onAfterFirstSaveContent(){}static M7d(){const t={};t.XE=ResourceStrings.L_Help;t.assetId="FA000000012";t.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return t}}Object(h.a)(tc,"PptReactAccCheckControl",zb,[377]);class Kb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}Zb(t){this.K=t;this.K.register(ka,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().oa(()=>
new ka(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(642,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().oa(()=>new tc(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.ke("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(182,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().oa(()=>new ca(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){e.a.instance.Dc(new Kb)}}Object(h.a)(Kb,"PptAccessibilityPackage",null,[2,3]);var Pa=d(179),mb=d(1209),qc=d(240),oc=d(180),ib=d(534),$a=d(52),Db=d(124);class Mb{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed){this.ia=t;this.la=S;this.H6j=la;this.I6j=Ca;this.dcb=Na;this.tB=Pb;this.BXa=qb;this.Fa=xc;this.oc=ed;this.BXa.I$h(Object(n.a)(this,this.Zgh,"refreshAccCheckButtonStatus"))}wb(){this.la.powerPointEnableAccCheck&&
(this.ia.ra(Va.a.PLe,$a.a.application,Object(n.a)(this,this.Xri,"checkAccessibility"),4),this.ia.ra(Va.a.LNk,$a.a.application,Object(n.a)(this,this.gNk,"queryCheckAccessibility"),97))}Ee(){this.la.powerPointEnableAccCheck&&this.Fa.Fc(Db.a.$Bf).bindAction(oc.KeyInputManager.Oa(ua.a.Pvc,oc.KeyInputManager.Oe|1),Va.a.PLe)}Xri(t,S,la,Ca,Na){return 1===la?this.oc.qj()?this.I6j.JJj?32:8:8:this.H6j.Ql(t,S,la,Ca,Na)}gNk(t,S,la,Ca,Na){Na[ib.a.On]=this.dcb.isVisible;return 32}dispose(){this.BXa.UZk(Object(n.a)(this,
this.Zgh,"refreshAccCheckButtonStatus"))}Zgh(){this.tB.HH()}}Object(h.a)(Mb,"AccCheckActor",null,[365,106]);class ob{constructor(){this.Sbc=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}Zb(t){this.K=t}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").azb(()=>{this.Jyb()})}Jyb(){const t=this.K.resolve("Common.AFrameworkApplication").JS.qd,S=this.K.resolve("Common.IActionManagerExtended");t.powerPointEnableAccCheck&&(this.Sbc=new Mb(S,t,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.Sbc.wb(),this.Sbc.Ee());t.Coe&&Pa.a.get_instance().Uj(7,Object(n.a)(this,this.Coe,"loadInternalSlice"))}Coe(){const t=mb.a.create("pptedit.internal",
null,()=>d.e(17).then(d.bind(null,1254)));qc.a.fy(t)}dispose(){this.Sbc&&this.Sbc.dispose()}static main(){e.a.instance.Dc(new ob)}}Object(h.a)(ob,"PptLazyActorsPackage",null,[2,3]);var jc=d(213),Gb=d(583),Gc=d(1212),bc=d(187),dc=d(167),Nb=d(58),Ac=d(49),jb=d(69),Vb=d(138),Tc=d(631);class wb extends Tc.a{constructor(){super();this.pe=this.createElement(jb.a.m2e)}Rfl(t){this.xa.textContent=t}appendChild(t){if(!t.xa||!this.xa)throw Error.argumentNull();this.xa.appendChild(t.xa)}}Object(h.a)(wb,"HTMLText",
Tc.a,[]);var Rb=d(329),vc=d(197);class rd{constructor(t,S,la,Ca,Na,qb,Pb,xc){this.vd=1;this.CBe=null;this.H0=new bc.a;this.nu=new bc.a;this.un=null;this.So=!1;this.L4c=null;this.kBg="";this.FGa=this.E$=!1;this.vfb=this.mWa=this.Pcb=this.EGa=this.cCb=this.uea=null;this.hVa=!1;this.ta=t;this.zb=S;this.qe=la;this.la=Ca;this.ia=Na;this.Zc=qb;this.ob=Pb;this.YC=xc}Zml(t){this.uea&&this.vfb&&(this.E$=!0,this.vfb.appendChild(this.uea.xa),this.ob.KG(Object(n.a)(this,this.mY,"onSelectionChange")),this.L4c=
new V.a(3,1,this.la.Mwh,Object(n.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.SHh(t))}EFl(t){this.ta===t&&this.E$&&this.SHh(this.ta.get_alt())}Jm(t){this.vfb=t.xa;this.eEi()}lD(t){if(this.E$&&!this.So)switch(t){case 1:t=this.qe.rk("formatpainterobject.cur");this.EGa.nl(Ac.a.fQ(t,jb.a.ysc));break;case 0:this.EGa.nl(jb.a.ysc)}}Zp(){return null}PN(){return!1}Ox(t){this.So=t}dispose(){this.TNc();this.uea&&(this.mWa=this.Pcb=this.cCb=this.EGa=this.uea=null)}Xy(){}bE(){return null}JB(){return[]}draw(){this.E$&&
this.g5e(!0)}get visible(){return this.FGa}set visible(t){this.E$&&(this.FGa!==t&&(this.FGa=t,this.uea.setVisibility(this.FGa)),this.FGa||this.TNc())}setPosition(){}Kj(t){this.vd=t;this.E$&&(this.Uid(),this.RHh())}Qq(t){this.H0=t;this.E$&&this.Uid()}Yu(t){this.nu=t;this.E$&&this.Uid()}setZIndex(t){this.E$&&this.uea.OB(t)}OE(t,S){this.E$&&(this.g5e(!t&&S||!S),t||this.zb.Y5(this.L4c,this.la.Mwh))}setSelection(){}eEi(){this.uea=new Vb.a;this.EGa=new Rb.a;this.EGa.Hoa("ImageDescriptionBarBackground");
this.Zc.pb(ha.a.click,this.EGa.xa,Object(n.a)(this,this.Evk,"onImageDescriptonBarClickHandler"));this.cCb=new vc.a;this.cCb.appendChild(this.EGa);this.Pcb=new wb;this.Pcb.ur("ImageDescriptionBarText");this.RHh();this.mWa=new Vb.a;this.mWa.ur("ImageDescriptionBarTextWrappingDiv");this.mWa.appendChild(this.Pcb);this.uea.appendChild(this.cCb);this.uea.appendChild(this.mWa)}SHh(t){const S=t.indexOf("\n");this.kBg=-1===S?t:t.substring(0,S);this.Pcb.Rfl(ResourceStrings.L_ShapeAltText+": "+this.kBg);this.g5e(!0)}g5e(t){this.un=
this.ta.fp;this.FGa=t;this.Uid();this.uea.setVisibility(this.FGa);this.hVa||(this.hVa=!0,this.zb.Db(this.L4c))}RHh(){this.Pcb.xa.style.fontSize=this.YC.pja(29)}Evk(){this.ia.processAction(Va.a.Lrb,2);return!0}mY(){this.TNc()}dismissImageDescriptionBarTask(){this.TNc()}TNc(){this.E$&&(this.FGa=this.E$=!1,this.ob.yKa(Object(n.a)(this,this.mY,"onSelectionChange")),this.hVa&&(this.zb.Mg(this.L4c),this.hVa=!1),this.vfb&&this.vfb.contains(this.uea.xa)&&this.vfb.removeChild(this.uea.xa))}Uid(){if(this.E$&&
this.un){var t=this.un.copy();this.H0.El(t);this.nu.El(t);this.CBe=Gb.a.YO(Nb.a.MG(t.ga(0),t.ga(1)));var S=t.sk(new dc.a(6)),la=t.sk(new dc.a(4));t=t.sk(new dc.a(2));t=Nb.a.lm(la,t)*this.vd;la=Nb.a.lm(S,la)*this.vd;if(60>la||80>t)this.FGa=!1;else{t=this.vfb.children[0].style;this.cCb.setPosition(this.aPb(t.left),this.aPb(t.top));this.cCb.lh(this.aPb(t.width),this.aPb(t.height));var Ca=this.YC.Pe(Gc.a.qf(40,1),1);this.mWa.setPosition(S.x*this.vd,S.y*this.vd-Ca);this.mWa.lh(la,Ca);this.mWa.xa.style.transform=
this.oRa(this.CBe);this.Pcb.lh(la-9,Ca-6);var Na=new bc.a;Na.P7(this.CBe,new Nb.a(0,Ca));Na.hC(S.x*this.vd-this.aPb(t.left),S.y*this.vd-this.aPb(t.top)-Ca);this.EGa.QE(Na,1);this.EGa.lh(la,Ca)}}}aPb(t){t=parseFloat(t);return isNaN(t)?0:t}oRa(t){return"rotate("+t.toString()+"deg)"}}Object(h.a)(rd,"ImageDescriptionBarView",null,[668,435,436,106]);var rc=d(1024),cb=d(47),Wb=d(39);class Uc{constructor(t,S,la,Ca){this.shapeNode=t;this.VPc=S;this.cTj=la;this.imageDescription=Ca}}Object(h.a)(Uc,"ImageDescriptionCache",
null,[]);var Ib=d(220);class Vc{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd){this.X9=new rc.a;this.Fb=t;this.wi=S;this.Nq=Pb;this.Hcb=la;this.ob=Ca;this.n0=qb;this.bak=Na;this.Gv=xc;this.Jb=ed;this.fc=dd;this.swe=fd}initialize(){this.Gv.kk(Object(n.a)(this,this.ph,"onPropertyChanged"));this.Nq.nvf(Object(n.a)(this,this.FHb,"onShapeImageFirstDraw"));this.Nq.yai(Object(n.a)(this,this.o5g,"onLocalImageViewDismissed"));this.Hcb.tai(Object(n.a)(this,this.N4g,"onImageDescriptionReady"))}dispose(){this.Gv.Rm(Object(n.a)(this,
this.ph,"onPropertyChanged"));this.Nq.LRe(Object(n.a)(this,this.FHb,"onShapeImageFirstDraw"));this.Nq.w_k(Object(n.a)(this,this.o5g,"onLocalImageViewDismissed"));this.Hcb.s_k(Object(n.a)(this,this.N4g,"onImageDescriptionReady"))}ph(t,S){(t=S.node)&&t.Hj&&(S=S.property,S===Wb.a.alt?((S=Object(D.a)(117,t.sc(this.Fb.Ma)))&&S.BQ&&t.get_alt()&&this.swe.ZG(t).EFl(t),this.bak.SDl(t),t.get_alt()&&this.krd(t,t.get_alt())):S===Wb.a.DC?t.DC&&(S=Object(D.a)(117,t.sc(this.Fb.Ma)))&&S.BQ&&(this.swe.ZG(t).visible=
!1):S===Wb.a.jh&&t.jh!==Ib.a.sT&&(S=Object(D.a)(117,t.sc(this.Fb.Ma)))&&S.BQ&&!t.hea&&this.X9.ga(t.id)&&this.X9.ga(t.id).VPc&&(this.owb(t,S),this.X9.remove(t.id)))}N4g(t,S){if(t=S.KVc){var la=S.confidence,Ca=S.imageDescription,Na=S.iPj;S=S.VPc;var qb=this.n0.qda(t),Pb=qb?Object(D.a)(117,qb.sc(this.Fb.Ma)):null;S?Pb&&Pb.BQ&&!qb.isLocal&&!qb.DC?this.owb(qb,Pb):this.X9.add(t,new Uc(qb,!0,!0,Ca)):!Ca||!Na&&60>la?P.a.J(33609505,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Na,la):(Ca=this.Exi(la,
Ca),Na?this.AVe(qb,Ca,!1):(P.a.J(34194368,815,50,"Image description ready for show and save"),Pb&&Pb.BQ?(P.a.J(34194370,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",t.toString(),(new Date).getTime()),this.krd(qb,Ca),qb.isLocal?this.X9.add(t,new Uc(qb,!1,!1,Ca)):(P.a.J(34194372,815,50,"Save image description immediately"),this.AVe(qb,Ca,!0))):this.X9.add(t,new Uc(qb,!1,!0,Ca))))}else P.a.J(33609503,815,15,"Graph node id is null")}FHb(t,S){t=S.KVc;P.a.J(34194374,815,50,
"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",t?t.toString():"",(new Date).getTime());this.X9.Gb(t)?this.hdh(t):(t=this.n0.qda(t))&&t.get_alt()&&this.krd(t,t.get_alt())}Exi(t,S){S+=String.fromCharCode(10,10);return S=80<=t?S+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=t?S+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=t?S+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=t?S+ResourceStrings.L_ImageDescriptionWithLowConfidence:S+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}o5g(t,
S){(t=S.sql)&&this.X9.Gb(t.id)&&this.hdh(t.id)}hdh(t){const S=this.X9.ga(t).shapeNode;if(S){var la=this.X9.ga(t).VPc,Ca=this.X9.ga(t).cTj,Na=this.X9.ga(t).imageDescription;la?(la=Object(D.a)(117,S.sc(this.Fb.Ma)))&&this.owb(S,la):(Ca&&this.krd(S,Na),S.isLocal?P.a.J(33609539,815,15,"Try to save alt text for local picture"):this.AVe(S,Na,!0));this.X9.remove(t)}else P.a.J(37029889,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}owb(t,S){this.wi.generateImageDescription(t.id,S.v_e,
t.get_isSVGBlipFilled(),!1)}AVe(t,S,la){if(!la||!t.get_alt()){var Ca=this.Jb.oe(la?7:15);Ca.nc(t);t.F0a=la;t.set_alt(cb.a.aUa(S));Ca.dispose();la&&this.wi.forceOutbound()}}krd(t,S){if(t.Hj){this.fc.$c(t)&&P.a.J(34079445,815,50,"Graph node or parents blocked");var la=this.ob.Xd();la&&this.ob.jX(t)?(P.a.J(33609545,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",t.id.toString(),(new Date).getTime()),this.swe.ZG(t).Zml(S)):P.a.J(33609543,815,50,"Is selected shapes empty: {0}",
!la)}else P.a.J(33609541,815,50,"ShapeNode.IsPicture: {0}",t.Hj)}}Object(h.a)(Vc,"ImageDescriptionManager",null,[106]);var gc=d(95),rb=d(341),Zb=d(60),Hc=d(72),Ab=d(35),ad=d(48);class Bd{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we){this.ta=null;this.YT=0;this.J7c=!0;this.uwe=new rc.a(0);this.lF=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.iX;this.Pg=t;this.Rb=S;this.qe=la;this.Fa=dd;this.wi=Ca;this.Zc=Na;this.ob=qb;this.nE=Pb;this.q0=xc;this.Jb=ed;
this.Hcb=fd;this.zH=we;this.qb=document.createElement("div");this.qb.className=Zb.a.ceg;this.qb.id=Zb.a.ceg;this.qb.style.position=Hc.a.dpa;this.qb.setAttribute(pa.a.af,pa.a.bCa);this.qb.setAttribute(pa.a.U2,"ImageDescriptionPaneLabel");this.Zc.pb(ha.a.click,this.qb,Object(n.a)(this,this.Vmh,"rootElementClickHandler"));this.q0.addHandler(this.qb,ha.a.Xf,Object(n.a)(this,this.$ta,"inputKeyPressHandler"));this.Eb=!1;this.UGa=Ac.a.Ie();this.UGa.className="ImageDescriptionPaneLayoutRoot";this.yo=this.KCa("per",
"ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.yo,"ImageDescriptionPaneCloseButton");this.yo.setAttribute(pa.a.af,pa.a.Au);this.UGa.appendChild(this.yo);this.Zc.pb(ha.a.click,this.yo,Object(n.a)(this,this.Gtb,"closeButtonClickHandler"));this.q0.addHandler(this.yo,ha.a.focus,Object(n.a)(this,this.oHb,"onElementFocused"));this.pec=Ac.a.Ie();this.pec.id="ImageDescriptionPaneLabel";this.pec.className="PaneLabel";this.pec.innerText=ResourceStrings.L_ShapeAltText;this.UGa.appendChild(this.pec);
this.y6c=Ac.a.Ie();this.y6c.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.y6c.className="ImageDescriptionLabel";this.UGa.appendChild(this.y6c);this.x6c=Ac.a.Ie();this.x6c.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.x6c.className="ImageDescriptionHint";this.UGa.appendChild(this.x6c);this.twe=Ac.a.Ie();this.jJ=document.createElement("textarea");this.jJ.className="AltTextTextArea";this.jJ.setAttribute(pa.a.ns,ResourceStrings.L_ShapeAltText);this.jJ.tabIndex=0;this.twe.appendChild(this.jJ);
this.UGa.appendChild(this.twe);this.Zc.pb(ha.a.click,this.jJ,Object(n.a)(this,this.Hwf,"altTextboxClickHandler"));this.q0.addHandler(this.jJ,ha.a.Xf,Object(n.a)(this,this.Iwf,"altTextboxTypingHandler"));this.q0.addHandler(this.jJ,ha.a.focus,Object(n.a)(this,this.oHb,"onElementFocused"));t=Ac.a.Sn();t.className="GenerateDescriptionButtonText";t.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;t.setAttribute("Unselectable","on");this.bU=Ac.a.Eca();this.bU.className="ImageDescriptionPaneButton cui-ctl";
this.bU.setAttribute(pa.a.af,pa.a.Au);this.bU.tabIndex=0;this.bU.appendChild(t);this.UGa.appendChild(this.bU);this.Zc.pb(ha.a.click,this.bU,Object(n.a)(this,this.EZf,"generateDescriptionClickHandler"));this.q0.addHandler(this.bU,ha.a.focus,Object(n.a)(this,this.oHb,"onElementFocused"));this.nE.a9(ad.a.Fka,ad.a.hj,this.qb,()=>{this.DU(!0)},()=>{this.DU(!1)},!0);this.nE.a9(ad.a.VQd,ad.a.hj,this.jJ,()=>{this.x4g(!0)},()=>{this.x4g(!1)},!0);this.Hcb.Xai(Object(n.a)(this,this.b7g,"onShowHideAltTextPane"))}rFj(){this.Yri()&&
(this.jJ.disabled=!1,this.jJ.value=this.ta.get_alt(),this.qb.appendChild(this.UGa),this.bU.style.display=this.ta.isLocal?Hc.a.Ff:Hc.a.Wk,this.Eb=!0,this.qb.style.display=Hc.a.Wk,this.lF?(this.oGc(this.qb),this.zH.IM(this,this.Eb,ResourceStrings.L_ShapeAltText,ad.a.Fka)):this.Rb.Oq(),this.ob.KG(Object(n.a)(this,this.mY,"onSelectionChange")),P.a.J(512233536,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.cKc();this.Hcb.M_k(Object(n.a)(this,this.b7g,"onShowHideAltTextPane"));this.Zc.yb(ha.a.click,
this.qb,Object(n.a)(this,this.Vmh,"rootElementClickHandler"));this.q0.removeHandler(this.qb,ha.a.Xf,Object(n.a)(this,this.$ta,"inputKeyPressHandler"));this.Zc.yb(ha.a.click,this.yo,Object(n.a)(this,this.Gtb,"closeButtonClickHandler"));this.q0.removeHandler(this.yo,ha.a.focus,Object(n.a)(this,this.oHb,"onElementFocused"));this.Zc.yb(ha.a.click,this.jJ,Object(n.a)(this,this.Hwf,"altTextboxClickHandler"));this.q0.removeHandler(this.jJ,ha.a.Xf,Object(n.a)(this,this.Iwf,"altTextboxTypingHandler"));this.q0.removeHandler(this.jJ,
ha.a.focus,Object(n.a)(this,this.oHb,"onElementFocused"));this.Zc.yb(ha.a.click,this.bU,Object(n.a)(this,this.EZf,"generateDescriptionClickHandler"));this.q0.removeHandler(this.bU,ha.a.focus,Object(n.a)(this,this.oHb,"onElementFocused"));this.bU=this.jJ=this.twe=this.x6c=this.y6c=this.pec=null;P.a.J(512233507,815,50,"ImageDescriptionPane::Dispose")}SDl(t){this.ta&&t===this.ta&&this.Eb&&(this.uwe.Gb(t.id.toString())&&this.ta.jh!==this.uwe.ga(t.id.toString())&&P.a.J(512233506,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),
2!==this.YT&&(this.jJ.value=this.ta.get_alt()))}layout(t,S){const la=S?t.oD(this.width):t.pD(this.width);this.Eb&&(S?(Sys.UI.DomElement.addCssClass(this.qb,Zb.a.eeg),la.oD(Zb.a.Rde)):(Sys.UI.DomElement.addCssClass(this.qb,Zb.a.deg),la.pD(Zb.a.Rde)));Ac.a.z1(this.qb,la);return t}get isVisible(){return this.Eb}get xa(){return this.qb}get order(){return 10}DU(t){this.Eb&&(t?0===this.YT&&this.HEh():this.YT=0)}x4g(t){this.Eb&&(t||this.iWe(),this.Rb.updateCommandUI())}Iwf(t){t.keyCode===ua.a.hZ&&t.ctrlKey?
this.VLb():(2!==this.YT&&this.Tqh(),this.YT=2)}$ta(t){this.Eb&&(t.keyCode===ua.a.tq||t.keyCode===ua.a.pP?1===this.YT?this.YK():3===this.YT?this.owb():2===this.YT&&(this.bU.style.display=Hc.a.Wk):2===this.YT&&(this.bU.style.display=Hc.a.Wk))}HEh(){gc.FocusManager.Wr(this.yo)?(this.VLb(),this.YT=1):P.a.J(512233505,815,50,"Fail to set focus on close button")}VLb(){this.Fa.iD(ad.a.Fka)}Tqh(){this.Fa.iD(ad.a.VQd)}Yri(){const t=this.ob.Xd();if(!t||1<t.length||!t[0].Hj)return P.a.J(512233504,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",
!t),!1;this.ta=t[0];return!0}Gtb(){this.YK();return!0}YK(){this.Eb&&(this.cKc(),this.Fa.Ej(ad.a.Fka,!1),P.a.J(512233503,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}Vmh(){this.Eb&&(this.VLb(),this.YT=0);return!0}Hwf(){this.Tqh();this.YT=2;return!0}EZf(){this.VLb();this.owb();return!0}owb(){this.YT=3;this.bU.style.display=Hc.a.Ff;this.HEh();const t=this.ta?Object(D.a)(117,this.ta.sc(0)):null;t?(this.uwe.add(this.ta.id.toString(),this.ta.jh),
this.wi.generateImageDescription(this.ta.id,t.v_e,this.ta.get_isSVGBlipFilled(),!0)):P.a.J(512233502,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.ta)}b7g(){this.Eb?this.cKc():(this.rFj(),this.YT=0);this.Fa.Ej(ad.a.Fka,this.Eb);P.a.J(512233501,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Eb)}TDl(t){t=t.Xd();this.J7c&&this.iWe();1===t.length&&t[0].Hj?(this.ta=t[0],this.J7c=!0,this.jJ.value=this.ta.get_alt(),this.jJ.disabled=!1,this.bU.style.display=
this.ta.isLocal?Hc.a.Ff:Hc.a.Wk):(this.bU.style.display=Hc.a.Ff,this.jJ.disabled=!0,this.jJ.value=null,this.J7c=!1)}mY(t){Ab.a("ChangePictureAltTextFixEnabled")?this.TDl(t):this.cKc();this.Pg.Lo(ad.a.Fka)}oHb(t){this.Eb&&(t.target===this.yo?this.YT=1:t.target===this.jJ?this.YT=2:t.target===this.bU&&(this.YT=3))}cKc(){this.Eb&&(this.ob.yKa(Object(n.a)(this,this.mY,"onSelectionChange")),this.J7c&&this.iWe(),this.Eb=!1,this.qb.removeChild(this.UGa),this.qb.style.display=Hc.a.Ff,this.lF?(this.oGc(this.qb),
this.zH.IM(this,this.Eb,ResourceStrings.L_ShapeAltText,ad.a.Fka)):this.Rb.Oq(),P.a.J(512233500,815,50,"ImageDescriptionPane::CleanUpAndHide"))}oGc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,Zb.a.eeg):Sys.UI.DomElement.addCssClass(t,Zb.a.deg)}iWe(){const t=this.jJ.value;if(!(Ab.a("ChangePictureAltTextFixEnabled")&&null===t||t===this.ta.get_alt())){var S=this.Jb.oe(15);S.nc(this.ta);this.ta.F0a=!1;this.ta.set_alt(t);S.dispose()}}KCa(t,S){return this.JCa(t,"cui-img-16by16","cui-ctl-iconContainer",
S,CommonUIStrings.l_DialogClose,null)}JCa(t,S,la,Ca,Na,qb){const Pb=Ac.a.SA();Pb.alt=Na;Pb.className=Ba.getImageClassWithCluster(t,Ca);Pb.src=this.qe.rk(t+".png");Pb.setAttribute("Unselectable","on");t=Ac.a.Sn();t.className=S+" cui-img-cont-float";t.appendChild(Pb);S=Ac.a.Sn();S.className=la;S.setAttribute("Unselectable","on");S.appendChild(t);la=Ac.a.Eca();la.className="ImageDescriptionPaneNoBorderButton cui-ctl";la.title=Na;la.setAttribute(pa.a.af,pa.a.Au);la.tabIndex=0;la.appendChild(S);qb&&(Na=
Ac.a.Sn(),Na.className="cui-ctl-mediumlabel",Na.setAttribute("Unselectable","on"),Na.innerText=qb,la.appendChild(Na));return la}get width(){return this.Eb?Zb.a.OCj+Zb.a.Rde+rb.a.MKa:0}}Object(h.a)(Bd,"ImageDescriptionPane",null,[638,552,106]);var kd=d(280);class Be{constructor(){this.K=null;this.lF=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.iX}get name(){return"PowerPointWebEditor.ImageDescription"}Zb(t){this.K=t;this.K.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().oa(()=>
new kd.a(S=>{let la=null;const Ca=Object(D.a)(117,S.sc(t.resolve("Box4.IPageView").Ma));Ca&&!Ca.Al&&(la=new rd(S,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView").Md),la.Jm(Ca.WU),Ca.xra(la,4));return la}));this.K.register(638,"PowerPointWebEditor.IImageDescriptionPane").ma().oa(()=>
new Bd(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(Vc,"PowerPointWebEditor.ImageDescriptionManager").ma().oa(()=>new Vc(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),
this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").xd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").FUa&&
(this.lF||this.K.resolve("PowerPointWebEditor.IPaneManager").RP(this.K.resolve("PowerPointWebEditor.IImageDescriptionPane")),this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").FUa&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){e.a.instance.Dc(jc.a(new Be,0))}}Object(h.a)(Be,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var Qd=d(79);class ae extends Qd.a{constructor(t){super(!1,
!1,!0);this.awc=t}start(){const t={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.awc.Dde}};this.aj("",Object(n.a)(this,this.D4k,"resultHandler"),t)}D4k(t,S){1===t&&(this.awc.Dde=S.tooltipPersistenceEnabled)}}Object(h.a)(ae,"AccessibilitySettingsDialog",Qd.a,[]);class We{constructor(t,S){this.Ca=t;this.awc=S}wb(){this.Ca.ya(u.a.Bll,E.a.frame,Object(n.a)(this,this.Cll,"showAccessibilitySettingsDialogHandler"))}Cll(){(new ae(this.awc)).start();return 32}}Object(h.a)(We,
"AccessibilitySettingsDialogActor",null,[692]);var $d=d(1066);const Re=t=>{const S=new $d.a;v.AFrameworkApplication.Ke.nj(Ta(t),1,null,null,!0,2,la=>{200===la.data.ie?S.Kg("true"===la.data.Wd.toLowerCase()):S.Kg(!1)},()=>{S.Kg(!1)},null,void 0,void 0,void 0,void 0,"7");return S.task},Ta=t=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",v.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",t,v.AFrameworkApplication.hh);var xb=d(70);class kc{constructor(){this.xob=
null}get Dde(){return!!this.xob}set Dde(t){t!==this.xob&&(this.xob=t,xb.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(t),this.Gmg()&&v.AFrameworkApplication.Ke.nj(Ta("saveHoverableRibbonTooltipIsEnabled"),2,t.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}y1j(){const t=new $d.a;if(this.xob)t.Kg(this.xob);else if(this.Gmg()){const S=Re("getHoverableRibbonTooltipIsEnabled");S.continueWith(()=>{this.xob=S.result;xb.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(S.result);t.Kg(S.result)},8)}else t.Kg(!1)}Gmg(){const t=v.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),S=v.AFrameworkApplication.fa.ka("IsAnonymousUser");return t&&!S}}Object(h.a)(kc,"AccessibilitySettingsInfo",null,[691]);class Nc{constructor(){this.Da=null}get name(){return"Common.App.AccessibilitySettings"}Zb(t){this.Da=t;this.Da.register(kc,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").oa(()=>
new kc).ma();this.Da.register(We,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").oa(()=>new We(v.AFrameworkApplication.Ta,this.Da.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const t=this.Da.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),S=this.Da.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");t&&S?(S.wb(),t.y1j()):O.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){e.a.instance.Dc(new Nc)}}Object(h.a)(Nc,"AccessibilitySettingsPackage",null,[2,3]);var id=d(93),Ed=d(221),Ja=d(1133),db=d(81),zc=d(713);class Hd extends Oa.StandardDialog{constructor(t,S,la,Ca=null){super();this.G2=this.hs=this.yNa=null;this.fw=[];this.CCc=S;this.GP=t;this.ETh=la;this.aEc=Ca;this.Bqb=new zc.a("LoadResource","LoadPrintablePdf")}Hja(){this.yd=
5;this.width=40;const t=document.createElement("span");t.id=this.Oh("DirectPrintHeaderContent");const S=document.createElement("span");S.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(S,"DirectPrintHeader");this.G2=document.createElement("iframe");this.G2.name="pdfObjectFrame";this.G2.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.G2.onload=Object(n.a)(this,this.XKk,"printablePdfLoaded");if(this.aEc&&0<this.aEc.count){var la=db.a.J9d(this.CCc,this.aEc);const Ca=
db.a.oRe(this.CCc,this.aEc);this.hs=document.createElement("form");this.hs.id="printPreviewPostForm";this.hs.method="POST";this.hs.target=this.G2.name;this.hs.action=Ca;for(let Na of la)la=document.createElement("input"),la.type="hidden",la.name=Na.key,la.value=Na.value,this.hs.appendChild(la)}else this.G2.setAttribute("src",this.CCc);Sys.UI.DomElement.addCssClass(this.G2,Ed.a.vkf);this.ETh?(Sys.UI.DomElement.addCssClass(this.G2,"DirectPrintPdfObjectHidden"),S.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
pa.a.eP(this.G2,pa.a.SK,pa.a.jC)):(Sys.UI.DomElement.addCssClass(this.G2,"DirectPrintPdfObject"),this.fw.push(this.G2));t.appendChild(S);t.appendChild(document.createElement("br"));t.appendChild(this.G2);this.hs&&t.appendChild(this.hs);t.appendChild(document.createElement("br"));t.appendChild(this.bAi(this.hs?"#":this.CCc));this.Bqb.start();this.pGb(CommonUIStrings.l_AppTitle,null,null,null,null,t);this.f6(this.Oh("DirectPrintHeaderContent"));this.hs&&this.hs.submit();this.FEi();r.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}bAi(t){const S=document.createElement("span");var la=document.createElement("span");la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;S.appendChild(la);v.AFrameworkApplication.fa&&(2===v.AFrameworkApplication.Aa.hb.Uk&&v.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===v.AFrameworkApplication.Aa.hb.Uk&&v.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(t=document.createElement("span"),2===
v.AFrameworkApplication.Aa.hb.Uk?t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.Aa.hb.Uk&&(t.innerText=CommonUIStrings.l_InternalError_Directive,r.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.yNa=t,S.appendChild(document.createElement("br")),S.appendChild(t)):(la=document.createElement("a"),la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,la.href=t,la.target="_blank",la.id="PrintPDFLink",la.className=
"AllowBrowserClick",this.yNa=la,S.appendChild(document.createElement("br")),S.appendChild(la),this.hs&&id.a.addHandler(la,"click",Object(n.a)(this,this.rJe,"onSubmit")),this.GP.pb(ha.a.click,this.yNa,Object(n.a)(this,this.NQf,"downloadPDFLinkClicked"),null));this.fw.push(this.yNa);return S}rJe(t){this.hs&&(this.hs.target="_blank",this.hs.submit());t.preventDefault()}FEi(){if(0<this.fw.length){const t=new Ja.a(this.fw),S=gc.FocusManager.instance().yl();S&&(this.yNa.focus(),S.wj=t,S.rX=!0)}}NQf(){r.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}Zbb(){r.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}XKk(){r.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Bqb&&this.Bqb.stop()}dispose(){this.yNa&&(this.GP.yb(ha.a.click,this.yNa,Object(n.a)(this,this.NQf,"downloadPDFLinkClicked")),this.yNa=null);ia.a.$O(this.G2);this.G2=null;super.dispose()}}Object(h.a)(Hd,"DirectPrintDialog",Oa.StandardDialog,[747]);class Ad{constructor(t){this.GP=
t}y9i(t,S){return new Hd(this.GP,t,S,null)}}Object(h.a)(Ad,"DirectPrintDialogFactory",null,[726]);var Kd=d(1203),Pc=d(65);class tf{constructor(t,S){this._url=t;this.EYh=S}qQf(){this.EYh?Pc.a.downloadFile(this._url):Pc.a.vn(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(h.a)(tf,"OpenUrlInTabDialogDownloadBehavior",null,[784,106]);var xe=d(55);class ef extends Oa.StandardDialog{constructor(t,S=!0,la=!1,Ca=null,Na=null,qb=!1){super();this.mob=this.lob=this.hs=
this.Jba=null;var Pb=this.E2e?this.E2e:CommonUIStrings.l_DefaultDialogTitle;ef.myb=qb;this.NAd=Ca||new tf(t,!0);const xc=[],ed=[];ef.U1&&(this.pHc&&this.pHc.forEach(we=>{Array.add(xc,we)}),this.Xvf&&this.Xvf.forEach(we=>{Array.add(ed,we)}));S?la?(this.yd=4,this.Xe(1,this.buttonText),this.Xe(2,CommonUIStrings.l_DialogClose)):(this.yd=6,this.Xe(0,CommonUIStrings.l_DialogClose)):this.yd=5;qb=document.createElement("span");this.X1b&&(qb.className=this.X1b);Ca=document.createElement("a");Ca.innerText=
this.cBb;Ca.href=t;Ca.target="_blank";Ca.id=this.pbc;Ca.className=Ma.AFrame.Cwf;var dd=!xe.a.zT&&!!Na&&0<Na.count;if(dd){const we=db.a.J9d(t,Na);Na=db.a.oRe(t,Na);Ca.href="#";Ca.target="_self";this.hs=document.createElement("form");this.hs.id="printPreviewPostForm1";this.hs.method="post";this.hs.target="_blank";this.hs.action=Na;for(var fd of we)Na=document.createElement("input"),Na.type="hidden",Na.name=fd.key,Na.value=fd.value,this.hs.appendChild(Na)}else this.hs=null;this.hs||ef.myb?ef.myb||Array.add(ed,
{["type"]:"AppLinkProps",["id"]:this.pbc,["text"]:this.cBb,["onExecute"]:()=>{this.agh()}}):Array.add(ed,{["type"]:"AppLinkProps",["id"]:this.pbc,["text"]:this.cBb,["handler"]:{["href"]:dd?"#":t,["target"]:dd?"_self":"_blank"}});this.lna&&Array.add(xc,this.lna);la?(t=document.createElement("span"),t.innerText=this.lna.replace("{0}",""),qb.appendChild(t)):this.QZg?(t=document.createElement("span"),t.id=this.Oh("message"),fd=document.createElement("span"),Na=document.createElement("span"),dd=this.lna.split("{0}"),
fd.innerText=dd[0],Na.innerText=dd[1],t.appendChild(fd),t.appendChild(Ca),t.appendChild(Na),qb.appendChild(t)):(t=document.createElement("span"),t.innerText=this.lna,qb.appendChild(t),qb.appendChild(document.createElement("br")),qb.appendChild(document.createElement("br")),qb.appendChild(Ca),ef.myb||Array.add(xc,"{0}"));this.hs&&qb.appendChild(this.hs);ef.U1&&(this.uVa&&(this.mbc?this.etf(this.uVa,this.mbc):(Array.add(xc,"{0}"),Array.add(ed,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.uVa,
["onExecute"]:()=>{this.b2c()}}))),this.lGc(xc,ed));this.pGb(Pb,null,this.Hde,null,Object(n.a)(this,this.p3,"dialogHandler"),ef.U1?null:qb);this.f6(this.Oh("message"));!ef.U1&&this.mbc&&this.uVa&&(Pb=document.createElement("div"),Pb.className="WACDialogLearnMoreLinkContainer",this.Jba=document.createElement("a"),this.Jba.innerText=this.uVa,this.Jba.href=this.mbc,this.Jba.target="_blank",this.Jba.id=this.Oh("LearnMoreLinkId"),this.Jba.className=Ma.AFrame.Cwf,Pb.appendChild(this.Jba),S?this.Hb.insertBefore(Pb,
this.Hb.lastChild):this.Hb.appendChild(Pb),this.f6(String.format("{0} {1}",this.Oh("message"),this.Oh("LearnMoreLinkId"))));this.XRb=Ca;la?this.KR(this.wD):this.KR(this.XRb);this.Ebc();v.AFrameworkApplication.Aa.WR.pb(ha.a.click,this.XRb,Object(n.a)(this,this.MQf,"downloadLinkClicked"),null);this.Jba&&v.AFrameworkApplication.Aa.WR.pb(ha.a.click,this.Jba,Object(n.a)(this,this.b2c,"learnMoreLinkClicked"),null);this.Paf=!1}get Hde(){return null}get E2e(){return null}get lna(){return null}get mbc(){return null}get uVa(){return null}get QZg(){return!1}get buttonText(){return CommonUIStrings.l_Open}get X1b(){return null}get pHc(){return null}get Xvf(){return null}b8(){this.hs&&
(this.lob||(this.lob=Object(n.a)(this,this.Crk,"onActionButtonClicked"),this.yn.pb(ha.a.click,this.wD,this.lob)),this.mob||(this.mob=Object(n.a)(this,this.Drk,"onActionButtonKeyUp"),this.Rg.pb(ha.a.Il,this.wD,this.mob)));super.b8()}Crk(t){this.eUf(t);return!0}Drk(t){return this.y1c(t,Object(n.a)(this,this.eUf,"executeDismissActionButtonFromArgs"))}eUf(t){this.hs&&this.hs.submit();this.A8a(t.Ec)}Zbb(){}MQf(){this.Gbc();this.hs?this.hs.submit():this.NAd.qQf();return!0}b2c(){return!1}dispose(){this.NAd.dispose();
this.XRb&&(v.AFrameworkApplication.Aa.WR.yb(ha.a.click,this.XRb,Object(n.a)(this,this.MQf,"downloadLinkClicked")),this.XRb=null);this.Jba&&(v.AFrameworkApplication.Aa.WR.yb(ha.a.click,this.Jba,Object(n.a)(this,this.b2c,"learnMoreLinkClicked")),this.Jba=null);this.yn&&this.lob&&(this.yn.yb(ha.a.click,this.wD,this.lob),this.lob=null);this.Rg&&this.mob&&(this.Rg.yb(ha.a.Il,this.wD,this.mob),this.mob=null);super.dispose()}agh(){this.hs&&(document.body.appendChild(this.hs),this.hs.submit(),document.body.removeChild(this.hs))}p3(t){1===
t&&(this.Zbb(),this.hs?ef.U1&&this.agh():this.NAd.qQf());this.dispose()}static get U1(){return v.AFrameworkApplication.Aa.hb.IC&&v.AFrameworkApplication.Aa.hb.smg}static get myb(){return ef.Tdf}static set myb(t){ef.Tdf=t}}ef.Tdf=!1;Object(h.a)(ef,"ADialogWithLinkToResource",Oa.StandardDialog,[]);class Id extends ef{constructor(t,S,la=null,Ca=!0,Na=!1){super(t,!0,!(Id.P1a&&Ca),new tf(t,S),la,Na);Id.P1a=Id.P1a&&Ca;if(Id.P1a){S=document.createElement("iframe");Ca=null;Na=this.pNi;S.name="pdfObjectFrame";
S.id="pdfObjectIFrame";if(la&&0<la.count){const qb=db.a.J9d(t,la);t=db.a.oRe(t,la);Ca=document.createElement("form");Ca.id="printPreviewPostForm";Ca.method="POST";Ca.target=S.name;Ca.action=t;for(let Pb of qb)t=document.createElement("input"),t.type="hidden",t.name=Pb.key,t.value=Pb.value,Ca.appendChild(t)}else S.src=t;Na.appendChild(S);Ca&&(Na.appendChild(Ca),Ca.submit());Sys.UI.DomElement.addCssClass(S,"DirectPrintPdfObjectHidden");pa.a.eP(S,pa.a.SK,pa.a.jC)}}get Hde(){return"Print_32x32x32"}get E2e(){return Id.P1a?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get lna(){return Id.P1a?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get pHc(){const t=[];Array.add(t,CommonUIStrings.l_PrintDialogCanCloseDocument);if(ef.myb){let S=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.Aa.hb.PMf&&(S=v.AFrameworkApplication.Aa.hb.PMf);Array.add(t,S)}return Id.P1a?t:null}get cBb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get pbc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get X1b(){return v.AFrameworkApplication.ysa?
"UIFontDialogTextLarge":null}Ebc(){r.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Gbc(){v.AFrameworkApplication.kj.jab(9540,1);r.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Zbb(){r.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get P1a(){return!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.IC&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(xe.a.zT||xe.a.Gj||xe.a.fg||xe.a.eac)&&!v.AFrameworkApplication.Lac&&
v.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set P1a(t){}}Object(h.a)(Id,"PrintDialogWithLinkToPdf",ef,[]);class qe{constructor(t){this.isEnabled=Boolean.parse(t.DirectPrintIsEnabled||"false");this.UTj=Boolean.parse(t.DirectPrintProbeIsEnabled||"false");this.sQj=Boolean.parse(t.DirectPrintEnabledForInternetExplorer||"false");this.dlb=(t.DirectPrintSupportedMimeTypes||"").split(qe.j0d);this.Y0a=(t.DirectPrintSupportedPlugins||"").split(qe.j0d);this.oDj=(t.DirectPrintImmersivePreviewPlugins||
"").split(qe.j0d);this.Sig=Boolean.parse(t.DirectPrintEnabledForEdge||"false");this.XLj=Boolean.parse(t.ChromePrintLayoutFixIsEnabled||"false");this.Cti=parseInt(t.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.OEe=14;this.SZg=14394;if(t=t.DirectPrintMinimalSupportedEdgeVersion){const S=t.split(".");2===S.length?(this.OEe=parseInt(S[0]),this.SZg=parseInt(S[1])):r.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",t)}else r.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}qe.j0d=",";Object(h.a)(qe,"DirectPrintBrsSettings",null,[]);class jg{constructor(t,S){this.I0e=t;this.Y0a=S}}Object(h.a)(jg,"DirectPrintProbeResults",null,[]);var of=d(195),Cb=d(105);class Df{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd){this.IFc=null;this.lRh=t;this.hVb=S;this.fHd=la;this.TUh=Ca;this.NVh=Na;this.WVb=new Kd.a(Object(n.a)(this,this.mhj,"getProbeResults"));this.rAd=qb;this.eif=ed;this.YLd=Pb;this.OVh=
xc;this.bWh=dd}get cL(){return this.lRh}start(){}jLk(){this.cL.UTj&&this.Z4j()}jOk(){const t=Array(this.cL.dlb.length);if(void 0!==this.hVb&&null!==this.hVb)for(let S=0;S<this.cL.dlb.length;S++)t[S]=this.cL.dlb[S]in this.hVb&&this.TUh(this.hVb[this.cL.dlb[S]]);return t}kOk(){const t=Array(this.cL.Y0a.length),S=!(void 0===this.fHd||null===this.fHd);for(let la=0;la<this.cL.Y0a.length;la++){const Ca=this.cL.Y0a[la];t[la]=S&&Ca in this.fHd?!0:this.NVh(Ca)}return t}Emj(){const t=this.jOk(),S=Array(t.length);
for(let la=0;la<t.length;la++)S[la]=t[la]?this.VVi(this.hVb[this.cL.dlb[la]]):null;return S}VVi(t){if(void 0===t||null===t)return null;t=t.enabledPlugin;return void 0===t||null===t?null:t.name}Z4j(){r.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.WVb.value.I0e,this.WVb.value.Y0a)}mhj(){var t=this.Emj();const S=this.kOk(),la={},Ca={};for(let Na=0;Na<this.cL.dlb.length;Na++)la[this.cL.dlb[Na]]=t[Na];for(t=0;t<this.cL.Y0a.length;t++)Ca[this.cL.Y0a[t]]=S[t];return new jg(la,Ca)}sll(){return this.bWh||
!this.cL.isEnabled||v.AFrameworkApplication.Lac?!1:this.Btl()}Vvh(){if(null!=this.IFc)return this.IFc;const t=Df.Qig(this.cL);return this.IFc=this.cL.Sig&&t||this.ULj()}ULj(){return xe.a.Vj&&this.cL.XLj&&xe.a.aKc>=this.cL.Cti?!0:!1}Btl(){if(!this.OVh(this.cL))return!1;var t=Cb.a.Xae(this.WVb.value.I0e);for(const S of t)if(void 0!==S&&null!==S)return!0;t=Cb.a.Xae(this.WVb.value.Y0a);for(const S of t)if(S)return!0;return!1}hzj(){const t=Cb.a.Xae(this.WVb.value.I0e);for(const S of t)if(of.a.contains(this.cL.oDj,
S))return!0;return!1}Ywh(t){v.AFrameworkApplication.Aa&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.eif(t,null):this.sll()?this.zOi(t,this.hzj()&&!0):this.eif(t,null)}zOi(t,S){const la=this.YLd.Ei("UserAction","OpenDirectPrintDialog");this.rAd.y9i(t,S).Hja();la.stop()}static DWj(t){try{return new ActiveXObject(t),!0}catch(S){r.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",t)}return!1}static ZNj(t){return void 0===t||null===
t?!1:!(void 0===t.enabledPlugin||null===t.enabledPlugin)}static create(t){const S=new qe(v.AFrameworkApplication.fa.appSettings);let la=null;try{la=window.navigator.mimeTypes}catch(dd){r.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let Ca=null;try{Ca=window.navigator.plugins}catch(dd){r.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Na=Df.ZNj,qb=Df.DWj;t=t.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Pb=v.AFrameworkApplication.Aa.lV,
xc=Df.EWj,ed=!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.IC&&!v.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new Df(S,la,Ca,Na,qb,t,Pb,xc,(dd,fd)=>new Id(dd,!1,fd,!0,ed),v.AFrameworkApplication.isEmbedded)}static EWj(t){return xe.a.Vj||xe.a.Gj&&t.sQj||t.Sig&&Df.Qig(t)?!0:!1}static Qig(t){var S=xe.a.CRa;if(S){var la=S.split(".");if(2===la.length)return S=parseInt(la[0]),la=parseInt(la[1]),S>t.OEe||S===t.OEe&&la>=t.SZg}return!1}}Object(h.a)(Df,"DirectPrintManager",
null,[686]);class Bf{constructor(){this.Gaf=this.Da=null}get name(){return"Common.App.DirectPrint"}Zb(t){this.Da=t;t.register(Ad,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().oa(()=>new Ad(v.AFrameworkApplication.Aa.WR));t.register(686,"Common.App.DirectPrint.IDirectPrintManager").ma().oa(()=>Df.create(this.Da))}init(){this.Gaf=this.Da.resolve("Common.App.DirectPrint.IDirectPrintManager");this.Gaf.start()}dispose(){}}Object(h.a)(Bf,"PackageManager",null,[2,3]);var qg=d(1136),vd=d(304);class $f{constructor(t,
S){this.oSb=null;this.Ca=t;this.$a=S}wb(){(this.oSb=this.$a.Ga("StatusBarEnvironmentNameToUse"))&&""!==this.oSb&&this.Ca.ra(u.a.ZNe,E.a.frame,Object(n.a)(this,this.gFl,"updateEnvironmentName"),96)}gFl(t,S,la,Ca,Na){if(1===la)return 32;Na[qg.a.Value]=this.oSb;Na[vd.a.labelText]=this.oSb;Na[qg.a.Visible]=!0;return 32}}Object(h.a)($f,"DisplayEnvironmentName",null,[]);class ng{constructor(){this.Da=null}get name(){return"Common.App.DisplayEnvironmentName"}Zb(t){this.Da=t;this.Da.register($f,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().oa(()=>
new $f(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa))}init(){this.Da.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").wb()}dispose(){}static main(){e.a.instance.Dc(new ng)}}Object(h.a)(ng,"DisplayEnvironmentNamePackage",null,[2,3]);var Qe=d(174),Gf=d(552);class Jf extends Gf.a{constructor(t){super(t)}get r1b(){return!1}createElement(){const t=document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("type","text/css");t.setAttribute("href",this.Bt);
return t}bMc(){return null}Doc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.FM.Bt)}}Object(h.a)(Jf,"CssResource",Gf.a,[]);var xh=d(284),he=d(2);class de{constructor(){this.OCc=this.Vyc=null}v1j(){this.Vyc||(r.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.Vyc=he.Task.WAA(de.E1j(),de.k1j()),this.Vyc.continueWith(t=>{r.ULS.sendTraceTag(21030599,324,10,"{0}",cb.a.s7d(t.$i))},5));return this.Vyc}w1j(){if(!this.OCc)try{r.ULS.sendTraceTag(39978390,
324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.OCc=he.Task.WAA(de.V1d(xh.a.create(v.AFrameworkApplication.fa.Ga("DimeUrl"),null,null))),this.OCc.continueWith(t=>{r.ULS.sendTraceTag(39978391,324,10,"{0}",cb.a.s7d(t.$i))},5)}catch(t){r.ULS.sendTraceTag(594874951,324,10,"{0}",cb.a.s7d(t))}return this.OCc}static E1j(){var t=de.nVc("inproductmessaging.js");t=xh.a.create(t,null,null);return de.V1d(t)}static k1j(){var t=de.nVc("inproductmessaging.css");t=new Jf(t);return de.V1d(t)}static nVc(t){return Qe.a.L0b(String.format("ipm/{0}",
t))}static V1d(t){qc.a.fy(t);return t.ZFa}}Object(h.a)(de,"DependencyDownloader",null,[690]);class xf{}xf.tCk="inProductMessagingOverlayDiv";xf.rGk="PlayButtonImage";xf.N1k="ReplayButtonImage";Object(h.a)(xf,"Constants",null,[]);class re{constructor(){this.gpf=this.yjf=this.R8e=!0;this.O1k=this.sGk=null;this.Mok=!1;this.locale=null;this.bGh={}}get autoPlay(){return this.R8e}set autoPlay(t){this.R8e=t}get n_g(){return this.yjf}set n_g(t){this.yjf=t}get Pwh(){return this.gpf}set Pwh(t){(this.gpf=t)&&
this.Odl()}Odl(){this.yuf(xf.rGk,this.sGk);this.yuf(xf.N1k,this.O1k)}yuf(t,S){S&&(this.bGh[t]=S)}}Object(h.a)(re,"FirstRunExperienceUISettings",null,[688]);class Ih{constructor(){this.completed=this.DXk=!1}}Object(h.a)(Ih,"FirstRunExperienceViewData",null,[687]);var Le=d(192);class Cd{constructor(t,S,la){this.Ca=t;this.Sh=S;this.Ozc=la}wb(){this.Ca.ra(u.a.j_i,E.a.frame,Object(n.a)(this,this.i_i,"firstRunExperienceHandler"),64);this.Ca.ya(u.a.yXf,E.a.frame,Object(n.a)(this,this.vDj,"inProductMessagingTabHandler"));
this.Ca.ya(u.a.xXf,E.a.frame,Object(n.a)(this,this.uDj,"inProductMessagingShiftTabHandler"));this.Ca.ya(u.a.MNi,E.a.frame,Object(n.a)(this,this.NNi,"dimeLaunchHandler"));this.Ca.ya(u.a.Nkh,E.a.frame,Le.ActionManager.Ng);this.Ca.ya(u.a.g2k,E.a.frame,Le.ActionManager.Ng);this.Ca.ya(u.a.h2k,E.a.frame,Le.ActionManager.Ng);this.Sh&&this.Sh.updateCommandUI()}i_i(t,S,la,Ca,Na){2===la&&this.Ozc.z_j(Na);return 32}NNi(t,S,la,Ca,Na){2===la&&this.Ozc.y_j(Na);return 32}vDj(t,S,la){return 2===la?this.Ozc.qFe():
32}uDj(t,S,la){return 2===la?this.Ozc.iFe():32}}Object(h.a)(Cd,"InProductMessagingActor",null,[]);class Lc{constructor(){this.Shh=this.Z5=this.QBh=this.Z1c=this.instance=null}}Object(h.a)(Lc,"DimeExperienceUISettings",null,[]);var Td=d(524);class Ge{constructor(t,S,la,Ca,Na){this.nRc=!1;this.D2b=null;this.Ca=t;this.H5a=S;this.xDc=la;this.Zga=Ca;this.Yga=Na}XFj(t){xb.b("getHeaderApi")?t.isFeatureEnabled("MsoPremiumBadge",!0).then(S=>{const la=t.isFreemiumUpsellEnabled();la&&(appChrome.getHeaderApi().then(Ca=>
{Ca.updatePremiumStatus(S,la);return null}),t.Gib("MsoPremiumBadge",Ca=>{appChrome.getHeaderApi().then(Na=>{Na.updatePremiumStatus(Ca.isEnabled,la);return null})}));return null}):r.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}z_j(t){this.xDc.v1j().continueWith(()=>{this.H5a.vol(t)})}y_j(t){let S="gopremium",la=null,Ca=()=>{};t?(t.experience&&""!==Object(D.a)(String,t.experience)&&(S=Object(D.a)(String,t.experience)),t.onTaskComplete&&(Ca=t.onTaskComplete),t.campaignId&&""!==Object(D.a)(String,
t.campaignId)&&(la=Object(D.a)(String,t.campaignId))):r.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Qpg(S,Ca,la)}Qpg(t,S,la=null){if(this.nRc&&this.D2b){const Ca={};Ca.experience=t||"gopremium";Ca.campaignId=la||Td.b(this.Zga,this.Yga,Object(D.a)(String,Ca.experience),!0);this.Ca.processAction(u.a.Nkh,2);r.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Ca.experience);try{const Na=Object.assign(new Lc,{instance:this.D2b,Z1c:Ca,QBh:S||
(()=>{}),Z5:qb=>{r.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+qb.status)},Shh:()=>{r.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.nRc=!1;this.D2b=null}});this.H5a.Kml(Na)}catch(Na){r.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Na.message),this.nRc=!1,this.D2b=null,this.Ca.La(u.a.oRc,2,{["experience"]:Ca.experience})}}else r.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.La(u.a.oRc,2,{["experience"]:t})}x1j(){this.xDc.w1j().continueWith(()=>
{try{var t=cb.a.rg(v.AFrameworkApplication.uiCulture);const Ca=Td.c(this.Zga);if(Ca){var S={};S.partnerId=Ca;S.language=t;S.sessionId=v.AFrameworkApplication.userSessionId;S.authHint=v.AFrameworkApplication.fa.Ga("UserPrincipalName");var la=v.AFrameworkApplication.fa.Ga("Puid")||"";""!==la&&(t={},t.puid=la,S.userInfo=t);this.D2b=new Dime(S);this.nRc=!0;r.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else r.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Ca){r.ULS.sendTraceTag(51675410,
324,10,"FreemiumUpsellDialogDependencies failed: "+Ca.message)}},3)}qFe(){return this.H5a.qFe()}iFe(){return this.H5a.iFe()}}Object(h.a)(Ge,"InProductMessagingUIManager",null,[685]);class Xc{constructor(){this.Gqf=0;this.epb=Array(5);this.epb[0]=10;this.epb[1]=15;this.epb[2]=50;this.epb[3]=100;this.epb[4]=200}Init(t){this.Gqf=t}SendTrace(t,S){r.ULS.sendTraceTag(34182235,this.Gqf,this.epb[t],"{0}",S)}}Object(h.a)(Xc,"DefaultNetworkingManager",null,[725]);var jf=d(201);class Mh{constructor(t){this.Od=
t}vol(t){t&&(InProductMessaging.Networking.NetworkingMgr=new Xc,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(t.Pwh,t.n_g,t.autoPlay,t.Mok,t.locale,Object(n.a)(this,this.guk,"onDismissFirstRunExperience"),t.bGh),this.g6(xf.tCk,!0))}Kml(t){if(t&&t.instance&&t.Z1c){let S=document.getElementById("wacDimeContainer");S||(S=document.createElement("div"),S.id="wacDimeContainer",document.body.appendChild(S));v.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.g6("wacDimeContainer",
!1);t.Z1c.parentElementId="wacDimeContainer";t.instance.launch(t.Z1c,t.QBh).then(la=>{this.koa();document.body.removeChild(S);t.Z5(la)}).catch(la=>{this.koa();document.body.removeChild(S);t.Shh(la)})}else throw Error.argument("DimeExperienceUISettings");}g6(t,S){if(this.Od&&t&&(t=document.getElementById(t),this.NFj(t),t=this.Od.uQ("InProductMessagingFocusId"))){const la=this.Od.Ae;la&&"InProductMessagingFocusId"===la.name||this.Od.LU("InProductMessagingFocusId",!1);S&&this.aQe(t.scope)}}NFj(t){var S=
this.Od.Fc("InProductMessagingFocusId");S.parent=Ma.AFrame.ND;const la=new jf.DOMFocusListing(()=>t);la.Kib=!1;la.Io(3);la.Io(2);la.Io(4);S=this.Od.Yia(()=>t,S,la);S.Lib();S.rX=!0;S.NQa=!0}aQe(t){t.Dp(gc.FocusManager.instance().Wqa);t.Dp(gc.FocusManager.instance().Xqa);t.bindAction(gc.FocusManager.instance().Wqa,u.a.yXf);t.bindAction(gc.FocusManager.instance().Xqa,u.a.xXf)}koa(){this.Od&&(this.Od.a1("InProductMessagingFocusId"),this.Od.tKb("InProductMessagingFocusId"))}guk(t,S){this.koa();t=Object.assign(new Ih,
{completed:t,DXk:S});v.AFrameworkApplication.Ta.La(u.a.h_i,2,t)}qFe(){const t=document.activeElement,S=this.Od.yl();return t&&S&&S.wj&&t===S.wj.RAb?(S.wj.ZE(t),S.AGb()?32:8):4}iFe(){const t=document.activeElement,S=this.Od.yl();return t&&S&&S.wj&&t===S.wj.Uja?(S.wj.ZE(t),S.yGb()?32:8):4}}Object(h.a)(Mh,"InProductMessagingUIWrapper",null,[684]);class bd{constructor(){this.Da=null}get name(){return"Common.App.InProductMessaging"}Zb(t){t.register(de,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().oa(()=>
new de);t.register(Mh,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().oa(()=>new Mh(gc.FocusManager.instance()));t.register(Ge,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().oa(()=>new Ge(v.AFrameworkApplication.Ta,t.resolve("Common.IInProductMessagingUIWrapper"),t.resolve("Common.App.InProductMessaging.IDependencyDownloader"),v.AFrameworkApplication.Aa.hb.Uk,v.AFrameworkApplication.Aa.hb.gJa));
t.register(Cd,"Common.App.InProductMessaging.InProductMessagingActor").ma().oa(()=>new Cd(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,t.resolve("Common.IInProductMessagingUIManager")));t.register(re,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().oa(()=>new re);t.register(Ih,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().oa(()=>new Ih);this.Da=t}init(){this.Da.resolve("Common.App.InProductMessaging.InProductMessagingActor").wb();
v.AFrameworkApplication.fa.ff(()=>{v.AFrameworkApplication.Aa.hb.dO&&Pa.a.get_instance().Uj(15,()=>{this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").XFj(t)})});v.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&Td.a()&&!xe.a.px&&1!==v.AFrameworkApplication.Aa.hb.Uk&&this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("MsoPremiumBadge",
!0).then(S=>{!S&&t.isFreemiumUpsellEnabled()&&this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").x1j();return null})})})}dispose(){}static main(){e.a.instance.Dc(new bd)}}Object(h.a)(bd,"InProductMessagingPackage",null,[2,3]);var Bc=d(392),Hf=d(565);class Me{static eSi(t){return Me.CBf("New",t)}static fSi(t){return Me.CBf("Open",t)}static jBf(t,S){return Me.O6a("LoadingMenuSection",Me.r2j,t,Me.g_b("lblLoading",S))}static h_b(t,S,la=null,Ca=null){return Me.O6a("MessageMenuSection",
Me.R_g,S,Me.g_b("lblMessage",t,la,Ca))}static Tli(t){return Me.jBf(t,CommonUIStrings.l_VoicedLoadingText)}static Uli(t,S){return Me.h_b(CommonUIStrings.l_NewCreationLocationMessage,t.labelText,S.DR,S.CLa)}static Sli(t,S){return Me.h_b(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,S.CLa,"\n\n"),t.labelText)}static lBf(t){return Me.h_b(CommonUIStrings.l_NewGenericErrorMessage,t.labelText)}static Qli(t,S,la){return Me.O6a("menuNewBlank",Me.iAj,la?t.labelText:null,Me.c_b(t.Bcg,t.Ccg,t.Dcg,
null,t.NEa,t.K8b,S,"blank"))}static Dmi(){return Me.g_b("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static zBf(){return Me.g_b("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static Emi(t,S){return Me.O6a("menuNewTemplates",t,null,S)}static Oli(t,S){return Me.O6a("menuNewMoreTemplates",Me.wYf,null,Me.c_b("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,t,S))}static Pki(t,S,la){let Ca="";la&&S&&(Ca=Me.O6a("BrowseMoreMenuSection",
Me.wYf,null,Me.c_b("btnBrowseMore",S,S,null,null,null,t||"1959943459",la)));return Ca}static g_b(t,S,la=null,Ca=null){let Na=Ca;S&&0<S.length&&(Na=Me.v0g.IJa(S).trimEnd(),Na=0<=Na.indexOf("{0}")?String.format(Na,Ca):String.format("{0} {1}",Na,Ca));la=la&&Ca?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',cb.a.ue(la),cb.a.ue(Ca),cb.a.ue(Na)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
cb.a.ue(t||""),Me.v0g.IJa(cb.a.ue(S||"")),la)}static c_b(t,S,la,Ca,Na,qb,Pb,xc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',cb.a.ue(t||""),cb.a.ue(S||""),cb.a.ue(la||""),Ca||"32by32",cb.a.ue(Na||""),cb.a.ue(qb||""),Pb,cb.a.ue(xc||""))}static CBf(t,S){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
t,S)}static O6a(t,S,la,Ca){la=la?String.format('Title="{0}"',cb.a.ue(la)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',cb.a.ue(t||""),cb.a.ue(S||""),la,Ca)}}Me.R_g="MenuMru";Me.r2j="MenuLoading";Me.iAj="MenuHeader";Me.wYf="MenuFooter";Me.v0g=Hf.a.ex("\n","&#10;");Object(h.a)(Me,"NewAndOpenXmlUtilities",
null,[]);var Tf=d(96);class Sd{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(h.a)(Sd,"HostInformation",null,[]);var lf=d(134),fb=d(175),Qb=d(127),ac=d(438),Jc=d(525);class pd{constructor(t,S,la,Ca,Na,qb){this.YEc=this.mo=this.Kwc=null;this.pEc=this.zLd=!1;this.kjf=0;this.nLd=this.FEd=!1;this.Pha=t;this.CSb=S;this.wha=new Kd.a(()=>new Bc.a(la.value,Object(n.a)(this,this.kEa,"getMoreInfoEventReceived")));this.IXh=Ca;this.uOa=Na;this.s1h=qb;this.YWb=this.Pqd;2===
this.CU.una&&(this.nLd=!0);v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.TXi()}get T2(){switch(this.CU.una){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}TXi(){lf.a.instance.Db(new V.a(5,1,0,()=>{this.getTemplateListJson()}))}wb(){const t=this.CU.NGb;t.ya(u.a.newDocument,E.a.frame,Object(n.a)(this,this.newDocument,"newDocument"));t.ya(u.a.omc,
E.a.frame,Object(n.a)(this,this.omc,"populateNewMenu"))}newDocument(t,S,la,Ca,Na){if(1===la)return 32;if(2===la&&Na){if(v.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Na.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.Ta.processAction(u.a.ZJk,2);if(Na.MenuItemId&&Na.SourceControlId)return"NewDocumentHome"===Na.SourceControlId&&Za.a("NewDocumentFromHomeTab"),this.L7a(Na.MenuItemId,Na.SourceControlId)}return 8}L7a(t,
S){var la=this.ded.LYd;if(null===la)return 8;var Ca=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.Dbb&&Ca){r.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Na={};Na[fb.a.lCh]=t;Na[fb.a.T2]=this.T2;Na[fb.a.lcid]=v.AFrameworkApplication.lcid.toString();Na[fb.a.reason]=ac.a.cGi;Na[fb.a.uiCulture]=v.AFrameworkApplication.uiCulture;Na[fb.a.dataCulture]=v.AFrameworkApplication.dataCulture;
v.AFrameworkApplication.nT().execute(qb=>{qb.sendMessage(Qb.a.L7a,Na)})}else Ca=(new Date).getTime(),S=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",la,cb.a.Ne(this.Swa),cb.a.Ne(t),cb.a.Ne(this.T2),cb.a.Ne(v.AFrameworkApplication.lcid.toString()),cb.a.Ne(Ca.toString()),cb.a.Ne(S),cb.a.Ne(v.AFrameworkApplication.canary),v.AFrameworkApplication.hh),(la=v.AFrameworkApplication.fa.Ga("ScenarioId"))&&""!==la&&(S+="&wdscenarioid="+
cb.a.Ne(la)),S+="&"+v.AFrameworkApplication.kTa(),v.AFrameworkApplication.MUa&&(S+="&"+v.AFrameworkApplication.KTc()),(la=this.mo?this.mo.DR:null)&&(S+="&DestinationUrl="+cb.a.Ne(la)),Pc.a.vn(S,"_blank",void 0,"CreateNewDocument");2===this.CU.una&&r.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Jc.a[this.CU.una],["Template"]:t});v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&
1===this.CU.una&&("blank"===t?Za.b("ConsumerTemplateNewBlank"):(t=[Object.assign(new K.a,{name:"TemplateId",string:t})],Za.b("ConsumerTemplateNew",null,0,!0,0,t)));return 32}Q5j(t){let S=Number.MAX_VALUE,la=Number.MIN_VALUE;const Ca=window.performance;if(Ca&&"undefined"!==typeof Ca.getEntriesByName){for(let qb=0;qb<t.length;qb++){var Na=Ca.getEntriesByName(t[qb]);Na&&0<Na.length&&(Na=Na[0],S=Math.min(parseInt(String(Na.fetchStart)),S),la=Math.max(parseInt(String(Na.responseEnd)),la))}la>S&&r.ULS.sendTraceTag(5849601,
202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:la-S,["MinFetchStart"]:S,["MaxResponseEnd"]:la})}}omc(t,S,la,Ca,Na){if(1===la)return this.nLd&&(v.AFrameworkApplication.LL("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.nLd=!1),32;2!==la||this.FEd||(this.kjf=(new Date).getTime(),r.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Pqd,["CachedNewMenuXmlExists"]:!!this.Kwc,["ShouldCallGetMoreInfo"]:this.CU.DLa}));
v.AFrameworkApplication.dGa("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.dGa("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.xHk(Na)}xHk(t){t&&(this.Kwc?t.PopulationXML=this.Kwc:(this.CU.DLa&&!this.mo&&this.opk.pda("Opened New menu",!0),t.PopulationXML=this.y3i(this.getTemplateListJson())));return 32}wmg(){return!this.CU.DLa||!!this.mo&&3===this.mo.state&&!!this.mo.CLa&&!!this.mo.DR}mUj(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.GFa?
!0:this.wmg()}getTemplateListJson(){if(!this.Pqd||!this.mUj())return null;if(this.YWb&&!this.pEc){var t="9";v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(t="21");const S=v.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in S&&(t=S.NumberOfTemplatesInBackstage);let la=this.T2;"TemplateCollectionId"in S&&(la=S.TemplateCollectionId);v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",
!1)&&(la="WordConsumerWAC",t="23");t=String.format(this.CU.tna+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",cb.a.Ne(v.AFrameworkApplication.lcid.toString()),cb.a.Ne(la),t);Boolean.parse(S.AppendOriginQueryParam||"false")&&(t+="&org=backstage");Boolean.parse(S.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in S&&(t+="&templateTier="+S.TemplateTier);t+="&"+v.AFrameworkApplication.kTa();v.AFrameworkApplication.MUa&&(t+="&"+v.AFrameworkApplication.KTc());this.CU.Njc.nj(t,
1,null,null,!1,2,Ca=>{this.CU.$bb("CreateNewActor.GetTemplateListJson",Ca.data);this.Uvl(Ca.data.Wd)},Ca=>{this.CU.$bb("CreateNewActor.GetTemplateListJson",Ca.data);this.Tvl()},null,void 0,void 0,void 0,void 0,"5");this.YWb=!1}return this.YEc}Uvl(t){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.YEc=this.CYi(t):this.YEc=t;this.YWb=!1;this.roc();if(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.GFa&&
xb.c()){t=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const S=v.AFrameworkApplication.Dbb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.YEc,!0,t&&S))}}Tvl(){this.pEc=this.YWb=!0;this.roc();v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.GFa&&xb.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Tf.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,
!0,!1,null)}CYi(t){t=JSON.parse(t);const S=new ea.a;S.add("TM00002102");S.add("TM00002101");S.add("TM16392939");const la=of.a.zpa(t,Ca=>S.contains(Ca.AssetId));t=t.slice(0,9);t.splice.apply(t,[2,0].concat(la));return JSON.stringify(t)}Qnj(t){var S=0;for(var la=0;la<t.length;la++)if("ST"===t[la].ImageType){S=la;break}const Ca=t.length?t[S]:null;t=Ca?Ca.Url||"":"";var Na;let qb=la=S=!1;if(Ca&&(Na=Ca.AspectRatio))Na=parseFloat(Na),1>Na?S=!0:1.5<Na?la=!0:1===Na&&(qb=!0);else switch(r.ULS.sendTraceTag(5849603,
202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:t}),this.CU.una){case 3:S=!0;break;case 2:la=!0;break;case 5:qb=!0}return{returnValue:t,wL:S?"95by123":la?"123by69":qb?"100by100":"123by95"}}y3i(t){const S=({Cqd:t}=this.Rli(t,this.ded,this.ded.n_b||"1056925771")).returnValue;t&&(this.Kwc=S,r.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.kjf}));return S}kEa(t,S){r.ULS.sendTraceTag(590964757,202,50,
"GetMoreInfoEventReceived");this.mo||3!==t.state?2===t.state&&(r.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.zLd=!0,this.roc()):(this.mo=t,S||this.roc(),v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.GFa&&xb.c()&&xb.d("setFileMenuHostInformation")&&(t=Object.assign(new Sd,{hostUrl:this.mo.DR,hostName:this.mo.CLa,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),r.ULS.sendTraceTag(590964758,
202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(t))))}Rli(t,S,la){let Ca;Ca=!1;const Na=this.wmg();let qb="";this.CU.DLa&&(this.zLd?(qb=Me.lBf(S),this.zLd=!1,r.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.mo?Na?qb=Me.Uli(S,this.mo):this.mo.BIj?(Ca=!0,this.YWb=!1,qb=Me.Sli(S,this.mo),r.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(Ca=!0,qb=Me.lBf(S),r.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.mo.DR,["StorageServiceDisplayNameIsSet"]:!!this.mo.CLa})):(qb=Me.Tli(S.labelText),r.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Na&&(qb+=Me.Qli(S,la,!qb)+({Cqd:Ca}=this.Cmi(t,la)).returnValue);return{returnValue:Me.eSi(qb),Cqd:Ca}}Cmi(t,S){let la;la=!1;if(!this.Pqd)return la=!0,r.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Cqd:la};let Ca="",Na="",qb="MenuTemplate";if(this.pEc)Ca=Me.zBf(),this.pEc=!1,r.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(t){try{const Pb=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0);Ca=this.Bmi(Pb,S);r.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.x0g&&"OneDrive"===this.Swa&&(Na=Me.Oli(this.ppk,v.AFrameworkApplication.x0g))}catch(Pb){r.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:t}),Ca=Me.zBf()}la=!0}else qb="MenuLoading",Ca=Me.Dmi(),r.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Me.Emi(qb,Ca)+Na,Cqd:la}}Bmi(t,S){let la="";const Ca=[];for(let qb=0;qb<t.length;qb++){var Na=t[qb];let Pb="";if(Na){const xc=Na.Title,ed=Na.AssetId;Na=Na.Thumbnails;ed&&xc&&Na&&({wL:Na,returnValue:Pb}=this.Qnj(Na),la+=Me.c_b("jbtnNewTemplate"+qb,xc,null,Na,
null,Pb,S,ed))}Ca[qb]=Pb}t=new V.a(4,1,5E3,()=>{this.Q5j(Ca)},106);this.CU.bed.Db(t);return la}roc(){this.FEd=!0;this.CU.s0g.T1(this.ded.N4b);this.FEd=!1}get CU(){return this.Pha.value}get ded(){return this.CSb.value}get opk(){return this.wha.value}get ppk(){return this.IXh.value}get Swa(){return this.uOa.value}get Pqd(){return this.s1h.value}}Object(h.a)(pd,"CreateNewActor",null,[]);class qd{constructor(){this._initialized=!1;this.dMd={}}BC(t){this.uTf();return this.get(t)}contains(t){this.uTf();
return t.toString()in this.dMd}uTf(){this._initialized||(this.M8h(),this._initialized=!0)}orb(t,S){this.dMd[t.toString()]=S}get(t){return this.dMd[t.toString()]}}Object(h.a)(qd,"AIntlHelper",null,[]);class sd extends qd{constructor(){super()}M8h(){this.orb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.orb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.orb(2,CommonUIStrings.l_Open);this.orb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.orb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.orb(5,
CommonUIStrings.l_VoicedLoadingText)}static get instance(){return sd.Ka||(sd.Ka=new sd)}static wBk(t){return sd.instance.BC(t)}}sd.Ka=null;Object(h.a)(sd,"MruActorIntlHelper",qd,[]);var ze;(function(t){t[t.success=0]="success";t[t.failure=1]="failure";t[t.spinner=2]="spinner";t[t.none=3]="none"})(ze||(ze={}));Object(h.b)("DisplayState",ze);var Wd=d(36);class ye{constructor(t,S,la,Ca,Na,qb,Pb,xc){this.Kyd=null;this.XNd=!0;this.Jwc="";this.j3h=0;this.dpb=null;this.AFd=3;this.$a=xc;this.Pha=t;this.Zba=
S;this.uSh=la;this.XOh=Ca;this.WOh=Na;this.wha=new Kd.a(()=>new Bc.a(qb.value,null));this.dTh=new Kd.a(()=>new Bc.a(Pb.value,Object(n.a)(this,this.Eok,"mruEventResultReceived")));this.$a.ka("WacInTabOpenMRUIsEnabledForUiHost");this.$a.ka("UiHostSupportsDocRebootFeatures")}Eok(t,S){this.dpb=t;S||this.ehh()}JWk(){this.VO.NGb.ra(u.a.Qid,E.a.frame,Object(n.a)(this,this.Qid,"populateMruMenu"),96)}Qid(t,S,la,Ca,Na){return 1!==la&&Na?this.vHk(Na):32}vHk(t){this.ISi();this.HSi();t.PopulationXML=Me.fSi(this.Jwc+
this.Kyd);return 32}ISi(){var t=3;let S=!1;if(this.Jwc&&this.j3h===this.dpb.oxl)r.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),t=this.AFd;else{r.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var la=this.VO.EF();this.dpb=this.Dok.pda("File Open opened",!0);this.Jwc&&2!==this.AFd&&3!==this.dpb.state?S=!0:(t=this.Tjj(this.dpb),v.AFrameworkApplication.Aa&&
v.AFrameworkApplication.Aa.hb.GFa&&xb.c()&&t&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t,!0)),this.Jwc=({fpk:t}=this.z3i(this.dpb)).returnValue);la=this.VO.EF()-la;r.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:la})}2!==t&&(la={["DisplayState"]:ze[t]},1!==t&&(la.IsStale=S),r.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",la));this.AFd=t}Tjj(t){let S;try{S=Wd.c(t.HFe)}catch(la){S=null,
r.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",la)}return S}HSi(){this.XNd?(r.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Kyd=({oLl:this.XNd}=this.Okk()).returnValue):r.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");r.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.XNd,["NotDisplayingLink"]:!this.Kyd})}z3i(t){let S;
1===t.state||0===t.state?(r.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),t=2,S=Me.jBf(this.yEa(2),this.yEa(5))):3===t.state&&t.HFe?(S=this.Pli(t.HFe),t=0):(r.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),S=Me.h_b(this.yEa(1),this.yEa(2)),t=1);return{returnValue:S,fpk:t}}Pli(t){let S;const la=this.hjc.n_b||"2155708348";if(t.length){S=Me.g_b("lblRecentDocuments",this.yEa(3));let Ca=0;for(let Na=0;Na<t.length;Na++){const qb=
t[Na];"FileName"in qb&&"DocumentUrl"in qb&&"Path"in qb&&(S+=Me.c_b("MruButton"+Na,qb.FileName.toString(),qb.Path.toString(),null,this.hjc.NEa,this.hjc.K8b,la,qb.DocumentUrl.toString()),qb.IsPinned&&Ca++)}S=Me.O6a("RecentDocumentsMenuSection",Me.R_g,this.yEa(2),S);r.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:t.length,["NumPinnedDocuments"]:Ca})}else S=Me.h_b(this.yEa(0),this.yEa(2)),r.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
{["Display"]:"Empty MRU"});return S}Okk(){let t;t=!0;let S=this.gki;var la=this.fki;if(S&&la||!this.VO.DLa)t=!1;else{const Ca=this.OTc.pda("File Open",!1);3===Ca.state&&(S=Ca.DR,la=Ca.CLa,t=!1)}la=la?String.format(this.yEa(4),la):null;return{returnValue:Me.Pki(this.hjc.n_b,la,S),oLl:t}}ehh(){this.VO.s0g.T1(this.hjc.N4b)}get VO(){return this.Pha.value}get yEa(){return this.Zba.value}get hjc(){return this.uSh.value}get gki(){return this.XOh.value}get fki(){return this.WOh.value}get OTc(){return this.wha.value}get Dok(){return this.dTh.value}}
Object(h.a)(ye,"MruRenderer",null,[]);var Yc=d(176),Ae=d(450);class hd{constructor(t,S,la,Ca,Na,qb,Pb){this.mo=null;this.jof=!1;this.BNa=this.s9e=0;this.TXh=t;this.rpb=S;this.IBc=la;this.CSb=Ca;this.uOa=Na;this.Pha=qb;this.wha=new Kd.a(()=>new Bc.a(Pb.value,Object(n.a)(this,this.kEa,"getMoreInfoEventReceived")))}L7a(){!this.mo&&this.UFe.DLa?this.OTc.pda("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}kEa(t){if(!this.mo&&3===t.state)this.mo=t;else if(2===t.state){this.jof?r.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.OTc.pda("NewDocumentFromStream",!0),this.jof=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.s9e=(new Date).getTime();var t=this.aYi.LYd;if(null===t)this.rpb(null);else{var S=this.IBc.menuItemId,la=this.IBc.aV,Ca=this.IBc.Osl,Na=this.IBc.hYi;this.BNa="streamBase64"===Ca?Na.length/1024:0;r.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.T2,this.BNa);var qb=(new Date).getTime();t=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
t,cb.a.Ne(this.Swa),cb.a.Ne(S),cb.a.Ne(this.T2),cb.a.Ne(v.AFrameworkApplication.lcid.toString()),cb.a.Ne(qb.toString()),cb.a.Ne(la),cb.a.Ne(v.AFrameworkApplication.canary),v.AFrameworkApplication.hh,cb.a.Ne(Ca));t+="&"+v.AFrameworkApplication.kTa();v.AFrameworkApplication.MUa&&(t+="&"+v.AFrameworkApplication.KTc());(S=this.mo?this.mo.DR:null)&&(t+="&DestinationUrl="+cb.a.Ne(S));this.UFe.Njc.nj(t,2,Na,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(n.a)(this,this.ipk,"newDocumentFromStreamSuccessHandler"),
Object(n.a)(this,this.hpk,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}ipk(t){if(t&&t.data&&t.data.Wd){var S;({sv:S}=Wd.d(t.data.Wd)).returnValue?(t=S,t.StatusCode!==Yc.a.Wv&&t.StatusCode!==Yc.a.T1b?(r.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.T2,this.BNa,t.StatusCode),this.rpb(null)):t.NewDocumentUrl&&""!==t.NewDocumentUrl?(r.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.T2,this.BNa,(new Date).getTime()-this.s9e),this.TXh(t.NewDocumentUrl)):(r.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.T2,this.BNa),this.rpb(null))):(r.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.T2,this.BNa,{["ResponseData"]:Ae.a.kuc(t.data.Wd)}),this.rpb(null))}else r.ULS.sendTraceTag(24904473,202,10,
"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.T2,this.BNa),this.rpb(null)}hpk(t){t&&t.data&&r.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.T2,this.BNa,t.data.status);this.rpb(null)}get T2(){switch(this.UFe.una){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get aYi(){return this.CSb.value}get Swa(){return this.uOa.value}get UFe(){return this.Pha.value}get OTc(){return this.wha.value}}
Object(h.a)(hd,"NewDocumentFromStreamOperation",null,[]);class oe{constructor(t,S,la,Ca){this.CSb=t;this.uOa=S;this.Pha=la;this.cTh=Ca}create(t,S,la){return new hd(t,S,la,this.CSb,this.uOa,this.Pha,this.cTh)}}Object(h.a)(oe,"NewDocumentFromStreamOperationFactory",null,[724]);var Xe=d(291);class Ke{get name(){return"Common.App.NewAndOpen.UX"}Zb(t){t.register(oe,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().oa(()=>
new oe(new Kd.a(()=>v.AFrameworkApplication.Aa.hb.B7d()),new Kd.a(()=>v.AFrameworkApplication.Swa),new Kd.a(()=>t.rb("Common.INewAndOpenCommonHelpers")),new Kd.a(()=>t.rb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.fa.ff(()=>{this.REa()})}REa(){const t=Xe.a.av(A.a.instance.Ja("Common.INewAndOpenCommonHelpers")),S=Xe.a.av(A.a.instance.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.Swa&&he.Task.WAA.call(null,t,S).continueWith(()=>
{const la=new pd(new Kd.a(()=>t.result),new Kd.a(()=>v.AFrameworkApplication.Aa.hb.B7d()),new Kd.a(()=>S.result),new Kd.a(()=>v.AFrameworkApplication.Aa.hb.C7d().n_b||"1959943459"),new Kd.a(()=>v.AFrameworkApplication.Swa),new Kd.a(()=>v.AFrameworkApplication.HRj));la.wb();la.roc()});if(v.AFrameworkApplication.XPe){const la=Xe.a.av(A.a.instance.Ja("Common.IEventEmitter<Common.IMruResult>"));he.Task.WAA.call(null,t,S,la).continueWith(()=>{const Ca=new ye(new Kd.a(()=>t.result),new Kd.a(()=>sd.wBk),
new Kd.a(()=>v.AFrameworkApplication.Aa.hb.C7d()),new Kd.a(()=>v.AFrameworkApplication.vBk),new Kd.a(()=>v.AFrameworkApplication.uBk),new Kd.a(()=>S.result),new Kd.a(()=>la.result),v.AFrameworkApplication.fa);Ca.JWk();Ca.ehh()})}}dispose(){}}Object(h.a)(Ke,"UXPackageManager",null,[2,3,106]);class me extends Oa.StandardDialog{constructor(){super();this.yd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}uv(t){this.Jy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}jDa(t){this.Jy(t,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(h.a)(me,"ErrorDialog",Oa.StandardDialog,[702]);class Uf{p_f(){r.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const t=new $d.a;t.Kg("api.onedrive.com");return t.task}}Object(h.a)(Uf,"OneDriveConsumerEndpointHelper",null,[661]);var yf=d(166);class Cf{constructor(t,S,la,Ca){this.u4a=this.Hna=null;this.fLd=this.hLd=!1;this.xpb=null;this.$a=t;this.Xmb=S;this.V3a=la;this.IA=Ca}get Vwf(){return this.Xmb}get fa(){return this.$a}lxb(){this.xpb||
(this.xpb=this.KHb?xh.a.create(this.KHb,null,null,null,!1):null);return this.xpb}setup(t){this.u4a=t;this.hLd||this.fLd?this.hLd&&this.u4a&&this.u4a(!0):(t=this.lxb())?(this.fLd=!0,t.ZFa.continueWith(S=>{this.Wwk(S)}),qc.a.fy(t)):(r.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.u4a(!1))}DIe(t){r.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",t.$i?t.$i.toString():"No error detail.")}Wwk(t){this.fLd=!1;
if(t.rm)this.DIe(t),this.u4a(!1);else try{this.hLd=!0,r.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Kee(),r.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.u4a(!0)}catch(S){r.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",S.toString()),this.u4a(!1)}}ssc(t){this.Hna=t;this.V3a?r.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(r.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(n.a)(this,this.WGe,"onApiReady")))}WGe(t){t?this.$1c():this.Ft()}Ft(){this.IA().uv(yf.a.VAk)}onSuccess(t){r.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.Hna&&this.Hna(!0,t)}dispose(){this.xpb&&this.xpb.dispose()}}Object(h.a)(Cf,"AOneDriveFilePickerApiManager",null,[727,106]);class Ld extends Cf{constructor(t,S,la,Ca,Na,qb){super(S,la,Ca,qb);this.ol=null;this.Yba=t;this.x1h=Na}get KHb(){return this.fa.Ga("OneDriveApiUrl")}start(t,S){this.ol=
t;this.ssc(S)}Kee(){WL.init(1===this.Vwf||2===this.Vwf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}ssc(t){this.Hna=t;!this.V3a&&this.Yba.eje?(r.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(n.a)(this,this.WGe,"onApiReady"))):(r.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.x1h())}$1c(){try{r.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.ol).then(Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.Bz,"onFailure"))}catch(t){r.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.Ft()}}Bz(t){if(t&&t.error){if("user_canceled"===t.error.code){r.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}r.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else r.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.Hna&&this.Hna(!1,t);this.Ft()}}Object(h.a)(Ld,"OneDriveFilePickerApiManagerV5",Cf,[]);class od extends Cf{constructor(t,S,la,Ca,Na){super(t,S,la,Ca);this.Azc=this.Okf=null;this.TRh=Na;this.options={};this.options.clientId=this.fa.Ga("OneDriveApiV7ClientId");this.options.cancel=Object(n.a)(this,this.Jtd,"toggleHostDivVisibility")}get KHb(){return this.fa.Ga("OneDriveApiV72Url")}start(t,S){this.Azc=S;const la=this.TRh.p_f();la.continueWith(()=>{r.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Okf=la.result;this.ssc((Ca,Na)=>{this.Jtd();t(Ca,Na)})},3);la.continueWith(()=>{r.ULS.sendTraceTag(24134242,352,15,la.$i.message);this.Jtd()},5)}Kee(){this.options.success=t=>{const S={};S.data=t;this.onSuccess(S)};this.options.error=t=>{const S={};S.error=t;this.Bz(S)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Okf;this.options.advanced.iframeParentDiv=this.Azc}$1c(){try{r.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.Jtd(),OneDrive.open(this.options)}catch(t){r.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",t.message),this.Ft()}}Bz(t){this.Hna&&this.Hna(!1,t);this.Ft()}Jtd(){this.Azc.style.visibility="hidden"===this.Azc.style.visibility?"":"hidden"}}Object(h.a)(od,"OneDriveFilePickerApiManagerV7",Cf,[]);class ug extends Cf{constructor(t,S,la,Ca){super(t,S,la,Ca);this.jOh=t;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ga("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get KHb(){return this.fa.Ga("OneDriveApiV72Url")}start(t,S,la,Ca){this.options.advanced.iframeParentDiv=la;this.options.advanced.endpointHint=Ca;this.options.cancel=S;this.jOh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.ssc(t)}ssc(t){this.Hna=t;this.V3a?r.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(r.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(n.a)(this,this.WGe,"onApiReady")))}Kee(){this.options.success=t=>{const S={};S.data=t;this.onSuccess(S)};this.options.error=t=>{const S={};S.error=t;this.Bz(S)}}$1c(){try{r.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(t){r.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.Ft()}}DIe(t){r.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",t.$i?t.$i.toString():"No error detail.");qc.a.bZk(this.KHb);this.xpb=null}Ft(){this.IA().jDa(yf.a.O6k)}Bz(t){this.Hna&&this.Hna(!1,t)}}Object(h.a)(ug,"OneDriveFilePickerApiManagerV72",Cf,[]);class Kf{constructor(t){this.olsSessionId=this.value=this.key=null;this.olsSessionId=t}}Object(h.a)(Kf,"IExtraData",null,
[]);class Vf extends ug{constructor(t,S,la,Ca){super(t,S,la,Ca);this.options.advanced.filter=t.Ga("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.gxf;t.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=t.Ga("OneDriveApiV72CommandMode")||"none");t.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new Kf(v.AFrameworkApplication.userSessionId))}get KHb(){return this.fa.Ga("OneDriveApiV72Url")}$1c(){try{r.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(t){r.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.Ft()}}}Object(h.a)(Vf,"OneDriveFilePickerApiOpenManagerV72",
ug,[]);class Ch{constructor(t){this.dw=null;this.Yh=t;this.cKd=3}p_f(){this.dw=new $d.a;r.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.fVe();return this.dw.task}fVe(t=null){const S=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.O7a);this.Yh.cW(S,1,null,t,["PersonalFileStorageUrl","X-NewKey"],2,Object(n.a)(this,this.xej,"getMoreInfoSucceeded"),Object(n.a)(this,this.vej,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}vej(t){if(t.data.ie===Yc.a.Pmc&&"X-NewKey"in t.data.tj){r.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const S={};S["X-Key"]=t.data.tj["X-NewKey"];this.fVe(S)}else 0<this.cKd?(r.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.cKd),this.cKd--,this.fVe()):(r.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.dw.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}xej(t){"PersonalFileStorageUrl"in t.data.tj&&""!==t.data.tj.PersonalFileStorageUrl?(r.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.dw.Kg(t.data.tj.PersonalFileStorageUrl)):(r.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.dw.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(h.a)(Ch,"OneDriveForBusinessEndpointHelper",null,[661]);var xg=d(355);class lh{constructor(){this.Da=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Zb(t){this.Da=t;this.Da.register(Ld,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().oa(()=>new Ld(xg.a.instance,v.AFrameworkApplication.fa,v.AFrameworkApplication.URa,v.AFrameworkApplication.PQ,v.AFrameworkApplication.bxh,()=>
new me));v.AFrameworkApplication.wAb?this.Da.register(661,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new Uf):this.Da.register(661,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new Ch(v.AFrameworkApplication.Ke));this.Da.register(od,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().oa(()=>new od(v.AFrameworkApplication.fa,v.AFrameworkApplication.URa,v.AFrameworkApplication.PQ,()=>new me,this.Da.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Da.register(ug,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().oa(()=>new ug(v.AFrameworkApplication.fa,v.AFrameworkApplication.URa,v.AFrameworkApplication.PQ,()=>new me));this.Da.register(Vf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().oa(()=>new Vf(v.AFrameworkApplication.fa,v.AFrameworkApplication.URa,v.AFrameworkApplication.PQ,()=>new me))}static main(){e.a.instance.Dc(new lh)}}Object(h.a)(lh,"PackageManager",null,[2,3]);var Oi=d(172),
ph=d(181);class Dh{constructor(t){this.scb=this.xAe=this.Ueb=this.k8c=0;this.aze=this.pJg=null;t?(this.zb=t,this.n2b=Date.now,this.KGi(),this.xWk()):r.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}Mdl(){this.pJg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}xWk(){window.document.body.addEventListener("pointerenter",Object(n.a)(this,this.zxk,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(n.a)(this,this.Axk,
"onPointerLeave"));A.a.instance.Ja("Common.App.VisibilityManagement.IVisibilityManager").execute(t=>{t.eHc(Object(n.a)(this,this.S7b,"handleVisibilityChange"))})}zxk(t){"pen"!==t.pointerType||this.Ueb||(this.Ueb=Math.floor(this.n2b()/1E3),this.Ueb<=this.k8c&&(this.Ueb=this.k8c),this.xAe=0)}Axk(){this.Pag()}Pag(){const t=Math.ceil(this.n2b()/1E3);this.Ueb&&t>this.k8c&&(this.xAe=t,this.scb+=this.xAe-this.Ueb);this.k8c=t;this.Ueb=0}S7b(t,S){0!==S.newState&&this.Pag()}KGi(){this.aze=new V.a(4,2,6E4,Object(n.a)(this,
this.V4j,"logPenUsage"));this.zb.Db(this.aze)}V4j(){0<this.scb&&this.Qph(this.scb);this.scb=0}Qph(t){const S=new ph.a;S.name=this.pJg;const la=[];(t=Oi.a.L8("PenInputSec",t.toString(),3))&&Array.add(la,t);S.dataFields=la;y.a.sendActivityEvent(S)}dispose(){0<this.scb&&this.Qph(this.scb);this.zb.Mg(this.aze)}}Object(h.a)(Dh,"PenMinutesManager",null,[660]);class mh{constructor(){this.JId=this.Da=null}get name(){return"Common.App.PenMinutesManager"}Zb(t){this.Da=t;const S=v.AFrameworkApplication.ye;this.Da.register(660,
"Common.App.PenMinutesManager.IPenMinutesManager").ma().oa(()=>new Dh(S))}init(){this.JId=this.Da.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.JId&&this.JId.dispose()}static main(){e.a.instance.Dc(new mh)}}Object(h.a)(mh,"PenMinutesManagerPackage",null,[2,3]);class Od extends Oa.StandardDialog{constructor(t,S){super();this.zpb=!1;this.yK=null;this.Ca=t;this.uSb=S;this.E0a=!1}uv(t,S,la){this.yK=S;this.zpb=la;r.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
t,la);t=this.qVd(t);0===t?(this.yd=6,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.yd=0,this.Xe(1,CommonUIStrings.l_DialogClose));0===t&&r.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Jy(yf.a.N6k,this.s9i(t),this.r9i(t,S),Object(n.a)(this,this.sTe,"retryDialogHandler"),!0)}sTe(t){1===t?(r.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.yK?this.Ca.La(u.a.dLb,2,[this.yK,this.zpb]):this.Ca.processAction(u.a.dLb,2)):r.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}qVd(t){return 0>t||6<t?(r.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",t),0):t}r9i(t,S){t=this.qVd(t);return this.uSb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,S),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][t]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,S),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][t]}s9i(t){t=this.qVd(t);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][t]}}
Object(h.a)(Od,"ErrorRetryDialog",Oa.StandardDialog,[731]);class Ue{constructor(t,S){this.$a=t;this.Ca=S;this.uSb=this.$a.ka("SaveToHostWithExtraCharsInFileName")}create(){return new Od(this.Ca,this.uSb)}}Object(h.a)(Ue,"ErrorRetryDialogFactory",null,[705]);class yh extends Qd.a{constructor(t,S,la,Ca,Na,qb,Pb=null){super();this.EV=null;this.Ca=S;this.nba=Ca;this.CBa=qb;this.$a=t;this.IA=Na;this.Sh=la;this.uSb=this.$a.ka("SaveToHostWithExtraCharsInFileName");this.ol=Pb;this.Xe(1,CommonUIStrings.l_SaveButtonLabel)}get Aa(){return this.Sh}CPf(t,
S){this.jD(1,!!t&&t!==S);this.EV=document.getElementById(yh.fWf);id.a.addHandler(this.EV,"change",Object(n.a)(this,this.vfd,"onFileNameChange"));id.a.addHandler(this.EV,"input",Object(n.a)(this,this.vfd,"onFileNameChange"));this.EV.focus()}eWf(t){return this.uSb?(new RegExp("["+this.PTf('\\/:*?"<>|')+"]")).test(t):(new RegExp("["+this.PTf('\\/:*?"<>|#{}%~&')+"]")).test(t)}PTf(t){return t.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Ibe(){const t=cb.a.XG(v.AFrameworkApplication.St.$w);this.jD(1,
!!this.EV&&""!==this.EV.value&&this.EV.value!==t)}vfd(){this.EV&&window.setTimeout(()=>{this.Ibe()},0)}dQc(t,S){if(1!==t)r.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{t=S[yh.fWf];S=yh.j9g in S?S[yh.j9g]:!1;r.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",cb.a.Ugh(t),S);const la=cb.a.pQ(v.AFrameworkApplication.fileName);(t=t?t.trim():null)&&""!==t&&""!==la||1===this.Aa.state?
this.eWf(t)?this.IA.create().uv(1,t,S):this.CBa.J1(t+la,S,this.ol):this.IA.create().uv(2,t,S)}}dispose(){this.EV&&(id.a.removeHandler(this.EV,"change",Object(n.a)(this,this.vfd,"onFileNameChange")),id.a.removeHandler(this.EV,"input",Object(n.a)(this,this.vfd,"onFileNameChange")),this.EV=null);super.dispose()}}yh.fWf="txtFileName";yh.j9g="chkOverwrite";Object(h.a)(yh,"FileNameDialogBase",Qd.a,[]);class Hj{static get eg(){return Qd.a.VA(Hj.En,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Hj.En="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(h.a)(Hj,"FileNameDialogHtml",null,[]);class fe extends yh{constructor(t,S,la,Ca,Na,qb){super(t,S,la,Ca,Na,qb);this.eg=Hj.eg;this.ig="FileNameDialog-SaveAsToHost"}Hja(t,S){const la=cb.a.XG(v.AFrameworkApplication.St.$w);S={["txtFileName"]:t||la,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:S};this.aj(CommonUIStrings.L_SaveAs,Object(n.a)(this,this.dQc,"fileNameDialogHandler"),S);this.CPf(t,la)}}Object(h.a)(fe,"FileNameDialog",yh,[729]);class Zh{constructor(t,S,la,Ca,Na,
qb){this.Ca=S;this.$a=t;this.nba=Ca;this.CBa=qb;this.IA=Na;this.Sh=la}create(){return new fe(this.$a,this.Ca,this.Sh,this.nba,this.IA,this.CBa)}}Object(h.a)(Zh,"FileNameDialogFactory",null,[704]);class Pi{constructor(t,S,la){this.CBa=la;this.EBd=S;this.$a=t}wb(){2===v.AFrameworkApplication.Aa.hb.Uk?v.AFrameworkApplication.Ta.ra(u.a.dLb,E.a.frame,Object(n.a)(this,this.koh,"saveAsToHostActionDispatcher"),4):v.AFrameworkApplication.Ta.ya(u.a.dLb,E.a.frame,Object(n.a)(this,this.koh,"saveAsToHostActionDispatcher"))}koh(t,
S,la,Ca,Na){return S.contextId!==E.a.frame||t!==u.a.dLb?2:this.$a.ka("SaveAsToHostBrsIsEnabled")?1===la?B.SessionStatusManager.instance.Aka||v.AFrameworkApplication.JQ?8:32:2===la?(r.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),t=this.EBd.create(),Na&&Object.getType(Na)===Array&&2===Na.length?t.Hja(Na[0],!!Na[1]):t.Hja(null,!1),32):8:8}}Object(h.a)(Pi,"SaveAsToHostActor",null,[]);class Zj{constructor(t,S,la,Ca,Na,qb,Pb,xc){this.Qn=null;this.zpb=this.t2=
!1;this.BBa=this.ol=this.yK=null;this.$a=S;this.GBa=this.$a.appSettings.SaveAsToHostWebServiceBase;this.fff=Ca;this.Cqa=Na;this.Yh=la;this.IA=qb;this.Zh=xc;this.Sh=Pb;this.Ca=t;this.vAa=S.Ga("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Wrc(){1!==this.Sh.state&&(this.Qn=this.Cqa(),this.Qn.message=CommonUIStrings.l_CommentProgressTooltip,this.Qn.yd=5,this.Qn.Ar=!1,this.Qn.Xoa(CommonUIStrings.l_DefaultDialogTitle,null,null))}UY(t=0){1!==this.Sh.state&&this.IA.create().uv(t,cb.a.XG(this.yK),
this.zpb)}Eib(){const t=this.$a.appSettings.BreadcrumbFolderUrl;r.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Pc.a.vn(t,Pc.a.hba(3),void 0,"UploadToHostManager.RedirectToFolder")}Dib(t){let S=!1,la=!1;this.$a&&(S=this.$a.ka("SaveACopyIsEnabledForUiHost"),la=this.$a.ka("UiHostSupportsDocRebootFeatures"));r.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",t,S,la);if(S&&la){r.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ca={};Ca[fb.a.$Jb]="1";Ca[fb.a.documentUrl]=t;Ca[fb.a.reason]=ac.a.iUe;v.AFrameworkApplication.nT().execute(Na=>{Na.sendMessage(Qb.a.mDa,Ca)})}else S&&!la&&v.AFrameworkApplication.ela?Pc.a.vn(t,Pc.a.hba(4),void 0,"UploadToHostManager.RedirectToEditUrl"):Pc.a.vn(t,Pc.a.hba(3),void 0,"UploadToHostManager.RedirectToEditUrl")}J1(t,S,la=null){r.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.fff&&
!this.fff()&&this.Yh&&(this.Zh&&(this.BBa=this.Zh.Ei("DialogShown","SaveAsToHostUploadTime")),this.Wrc(),this.zpb=S,this.yK=t,(this.ol=la)&&"true"===this.ol.SkipSaveToHost?this.vPc():this.w3())}w3(){32!==this.Ca.processAction(u.a.J_a,1)?(r.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.vPc()):this.Ca.La(u.a.J_a,2,[()=>{r.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.vPc()},(t,S)=>{r.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.UY(S)}])}DAk(t){this.f8a();this.t2=!1;if(t&&t.data&&t.data.Wd)if(({sv:S}=Wd.d(t.data.Wd)).returnValue)if(t=S,t.StatusCode!==Yc.a.Wv&&t.StatusCode!==Yc.a.T1b){r.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var S={};S.FailureReason=t.StatusCode.toString();S.ExtraInfo=t.ExtraInfo;this.$xa(S);this.UY(parseInt(t.ExtraInfo))}else{r.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.CSe();try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.Dib(t.NewDocumentUrl):this.Eib()}catch(la){r.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",la.toString())}this.Vlc()}else r.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ae.a.kuc(t.data.Wd)}),this.$xa({["FailureReason"]:"Failed to deserialize response"}),this.UY();else r.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.$xa({["FailureReason"]:"null response"}),this.UY()}CAk(t){5!==t.data.status&&12!==t.data.status||this.t2?(r.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:t.data.status,["HttpStatus"]:t.data.ie}),this.$xa({["FailureReason"]:t.data.ie.toString()}),this.f8a(),this.UY(),this.Vlc()):(r.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.t2=!0,this.ol&&"true"===this.ol.SkipSaveToHost?this.vPc():this.w3())}f8a(){this.Qn&&
(this.Qn.close(),this.Qn=null)}Vlc(){this.BBa&&(this.BBa.stop(),this.BBa=null)}CSe(){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.processAction(u.a.zmd,2)}$xa(t){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.La(u.a.DSe,2,t)}vPc(){let t=this.GBa+this.vAa;t=db.a.Ni(t,"qs",cb.a.Ne(v.AFrameworkApplication.hh));t=db.a.Ni(t,"n",cb.a.Ne((new Date).getTime().toString()));t=db.a.Ni(t,"ov",cb.a.Ne(this.zpb.toString()));t=db.a.Ni(t,"fn",cb.a.Ne(this.yK));this.ol&&this.ol.FileDownloadUrl&&
(t=db.a.Ni(t,"furl",cb.a.Ne(this.ol.FileDownloadUrl)));this.Yh.nj(t,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(n.a)(this,this.DAk,"onUploadFinished"),Object(n.a)(this,this.CAk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(h.a)(Zj,"UploadToHostManager",null,[703]);var Wg=d(556);class $h{constructor(){this.Da=null}get name(){return"Common.App.SaveAsToHost"}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){v.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").wb()}Zb(t){this.Da=t;this.Da.register(Ue,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").oa(()=>new Ue(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta)).ma();this.Da.register(Zj,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").oa(()=>new Zj(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa,v.AFrameworkApplication.Ke,()=>v.AFrameworkApplication.Ug,
()=>(new Wg.a).create(),t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.lV)).ma();this.Da.register(Zh,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").oa(()=>new Zh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.hb,t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();
this.Da.register(Pi,"Common.App.SaveAsToHost.SaveAsToHostActor").oa(()=>new Pi(v.AFrameworkApplication.fa,t.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){e.a.instance.Dc(new $h)}}Object(h.a)($h,"SaveAsToHostPackage",null,[2,3]);class Fe extends Oa.StandardDialog{constructor(){super();this.yd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}uv(t,S){this.YPf(t,S,yf.a.P6k)}YPf(t,S,la){r.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",la);this.Jy(la,t,S,null)}jDa(t,S){r.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Jy(yf.a.R6k,t,S,null,!0)}}Object(h.a)(Fe,"ErrorDialog",Oa.StandardDialog,[711]);class Ph{static get eg(){return Qd.a.VA(Ph.En,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Ph.En="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(h.a)(Ph,"FileNameDialogHtml",null,[]);class rg extends yh{constructor(t,S,la,Ca,Na,qb,Pb,xc){super(t,S,la,Ca,Na,qb,xc);this.MNa=this.GKd=this.oI=null;this.Vmi=CommonUIStrings.l_SaveToAnotherFolder;this.eg=Ph.eg;this.ig="FileNameDialog-SaveToSharePoint";this.FWb=Pb;this.GYh=xc}Hja(t){const S=cb.a.XG(v.AFrameworkApplication.St.$w),la=v.AFrameworkApplication.breadcrumbFolderName,Ca=v.AFrameworkApplication.breadcrumbBrandName,Na={["txtFileName"]:t||S};let qb=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.Aa.hb.Uk&&
(qb=CommonUIStrings.L_SaveACopy);this.aj(qb,Object(n.a)(this,this.dQc,"fileNameDialogHandler"),Na);this.CPf(t,S);this.c0d.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.oI=document.getElementById("anotherFolder"),t=document.getElementById("folderLocation"),this.GKd=pa.a.jxf(t,this.oI,"anotherFolderDescribedBy",""),this.oI.className="WACButton WACDialogButtonNormal",
t=!1,la&&la.length?(this.Jsf(this.oI,this.GKd,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ca,la)),t=this.E5h(Ca,la)):this.Jsf(this.oI,this.GKd,CommonUIStrings.l_CurrentOnlineFolder),this.c7h(this.oI),this.G5h(this.oI),t?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.oI,"SaveToAnotherLocationTwo"),r.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.oI,"SaveToAnotherLocationOne"),
id.a.addHandler(this.oI,ha.a.click,Object(n.a)(this,this.iJe,"onSaveToAnotherLocationClick")),id.a.addHandler(this.oI,ha.a.Xf,Object(n.a)(this,this.C6g,"onSaveToAnotherLocationKeyDown")))}E5h(t,S){let la;la=!1;const Ca=document.getElementById("currentLocation");Ca.innerText="";const Na=this.O4f(Ca,t),qb=this.O4f(Ca,S);let Pb=255,xc=255;255<Na+qb&&(Pb=Math.max(238,408-Na),xc=Math.max(170,408-qb),la=!0);this.B8h(Ca,t,xc,S,Pb);return la}O4f(t,S){const la=document.createElement("div");la.innerText=S;
la.style.visibility="hidden";t.appendChild(la);S=la.clientWidth;t.removeChild(la);return S}B8h(t,S,la,Ca,Na){S&&(this.Isf(t,S,la),this.q8h(t));Ca&&this.Isf(t,Ca,Na)}Isf(t,S,la){const Ca=document.createElement("div");Ca.innerText=S;Ca.title=S;Ca.className="SaveToAnotherFolderBreadcrumb";Ca.style.maxWidth=la.toString()+"px";t.appendChild(Ca)}q8h(t){const S=document.createElement("span");S.id="FolderSeparator";const la=document.createElementNS("http://www.w3.org/2000/svg","svg");la.setAttribute("class",
"SeparatorCaret");const Ca=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ca.setAttribute("points","1 4 1 11 5 7.5");la.appendChild(Ca);S.appendChild(la);t.appendChild(S)}Jsf(t,S,la){la=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,la);S&&(S.innerText=la);t.tabIndex=0;t.setAttribute(pa.a.af,pa.a.Au)}G5h(t){const S=document.createElement("span");S.id="anotherFolderText";S.innerText=this.Vmi;S.className="AnotherFolderTextSpan";t.appendChild(S)}c7h(t){const S=
document.createElement("span");S.className="cui-img-cont-float cui-img-16by16 ";this.MNa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.MNa.setAttribute("class","FolderIconSVG");const la=document.createElementNS("http://www.w3.org/2000/svg","path");la.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.MNa.appendChild(la);S.appendChild(this.MNa);t.appendChild(S)}C6g(t){!t||t.keyCode!==
ua.a.tq&&t.keyCode!==ua.a.NPb||this.iJe(t)}iJe(){if(this.EV){const t=cb.a.pQ(v.AFrameworkApplication.fileName);let S=this.EV.value;this.hide();S&&""!==S&&""!==t||1===this.Aa.state?(""!==t&&(S+=t),this.eWf(S)?this.IA.create().uv(1,S,!1):this.FWb.start(S,this.GYh)):this.IA.create().uv(2,S,!1)}}Nri(t){this.oI&&this.MNa&&(t?(this.oI.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.oI,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.MNa,"DisabledFolderIconSVG")):(this.oI.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.oI,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.MNa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.oI,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.MNa,"DisabledFolderIconSVG"))))}Ibe(){super.Ibe();this.Nri(!!this.EV&&""!==this.EV.value)}dispose(){this.oI&&(id.a.removeHandler(this.oI,ha.a.click,Object(n.a)(this,this.iJe,"onSaveToAnotherLocationClick")),id.a.removeHandler(this.oI,ha.a.Xf,Object(n.a)(this,this.C6g,"onSaveToAnotherLocationKeyDown")),this.oI=
null);super.dispose()}}Object(h.a)(rg,"FileNameDialog",yh,[737]);var zg=d(1205),lj=d(1206),pg=d(923),Nh=d(222);class Ha{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(h.a)(Ha,"SaveAsDialogInput",null,[]);class kb{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(h.a)(kb,"SaveLocation",null,[]);var Hb=d(89);class ic{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed){this.UFd=null;this.yK="";this.FWb=t;this.IA=
S;this.ol=ed;this.CBa=la;this.Sh=Na;this.gF=Ca;this.M5a=Pb;this.lqb=xc;qb&&(this.UFd=new Kd.a(()=>new Bc.a(qb.value,null)))}x8i(){const t=new zg.a(lj.a.Hn());t.$("type","currentHost");return Object.assign(new kb,{folderName:this.gF.breadcrumbFolderName,friendlyPath:this.gF.breadcrumbBrandName,properties:t})}NVj(t){return!!t&&"ClassicMru"===t.type&&!!t.service_info&&!!t.service_info.service_id&&-1!==t.service_info.service_id.indexOf("SHAREPOINT")}Lkj(){if(!this.UFd||!this.M5a)return null;var t=this.UFd.value.pda("SaveAsToSharePointDialog",
!1);if(!t||3!==t.state||!t.S_g)return null;t=t.S_g;const S=new ea.a;let la=0,Ca=0;for(var Na=0;Na<t.length;Na++){var qb=t[Na];if(!this.NVj(qb))continue;la++;if(!qb.sharepoint_info)continue;const Pb=qb.url,xc=qb.sharepoint_info.site_url,ed=qb.title;qb=pg.b(qb,v.AFrameworkApplication.isRtl);if(!(Pb&&xc&&ed&&qb))continue;Ca++;const dd=new zg.a(lj.a.Hn());dd.$("type","SharePoint");dd.$("siteUrl",xc);dd.$("folderUrl",Pb);Ca++;S.add(Object.assign(new kb,{folderName:ed,friendlyPath:qb,properties:dd}))}Na=
new Map;Na.set("NumPlaces",t.length.toString());Na.set("NumSharepointPlaces",la.toString());Na.set("placesWithMetadata",Ca.toString());Tf.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Na);0<la&&(Ca?.5>1*Ca/la&&Tf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Tf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return S}q9i(){const t=new ea.a;t.add(this.x8i());const S=
this.Lkj();S&&t.addRange(S);return Object.assign(new Ha,{enableMoreLocations:!v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.yK,extension:cb.a.pQ(this.gF.$w),saveLocations:t.toArray(),scenario:"SaveToSharePoint"})}HSc(){const t=Object(n.a)(this,this.q9i,"getDialogInput"),S={};S.inputPropsCallback=t;return S}Hja(t){this.yK=t;this.yK||(this.yK=String.format(CommonUIStrings.l_SaveACopy_Filename,cb.a.XG(this.gF.$w)));t={["id"]:"SaveAsDialog",["bodyControls"]:this.HSc()};
let S=CommonUIStrings.L_SaveAs;2===this.Sh.hb.Uk&&(S=CommonUIStrings.L_SaveACopy);const la=new Qd.a(!1,!1,!0);la.yd=1;la.ig="SaveAsDialog";la.Xe(1,CommonUIStrings.l_SaveButtonLabel);la.aj(S,Object(n.a)(this,this.L6k,"saveAsDialogHandler"),t)}onl(t,S){t&&""!==t&&""!==S||1===this.Sh.state?this.MVj()?this.Q1j(t,S):(""!==S&&(t+=S),this.FWb.start(t,this.ol)):(r.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.IA.create().uv(2,t,!1))}Q1j(t,S){Tf.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const la=this.lqb.sYd(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.lqb.D7d(la).then(Ca=>{if(Ca&&0<Ca.length){const Na=Ca[0][fb.a.ZFk];Ca=Ca[0][fb.a.kLe];if(""!==Na&&""!==Ca)this.M5a.J1(Ca,t+S,Na,this.ol),Tf.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.IA.create().uv(0,t,!1);const qb=Nh.a.Uz();qb&&(qb.set("SiteUrlAvailable",""===Na?"false":"true"),qb.set("FolderUrlAvailable",""===Ca?"false":
"true"));Tf.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Hb.a,{extendedProperties:qb}))}}else this.IA.create().uv(0,t,!1),Tf.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ca=>{"Canceled"===Ca?((Ca=Nh.a.Uz())&&Ca.set("IsCanceled","true"),Tf.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Hb.a,{extendedProperties:Ca}))):Tf.Health.instance.recordKpiFailure("SaveACopySFP",
Ca,!1,!1,null)})}MVj(){return this.lqb?this.lqb.rme():(r.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}L6k(t,S){if(S&&1===t){t=S.fileName;var la=cb.a.pQ(this.gF.$w);S.moreLocationsSelected&&this.onl(t,la);if(S.locationCallback){var Ca=S.locationCallback();Ca?Ca.properties&&"currentHost"===Ca.properties.ga("type")?this.CBa.J1(t+la,!1,this.ol):Ca.properties&&"SharePoint"===Ca.properties.ga("type")?(S=Ca.properties.ga("siteUrl"),Ca=Ca.properties.ga("folderUrl"),this.M5a.J1(Ca,
t+la,S,this.ol)):r.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):r.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else r.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(h.a)(ic,"ReactSaveAsDialog",null,[737]);class Qc{constructor(t,S,la,Ca,Na,qb,Pb,xc=null,ed=null,dd=null){this.Ca=S;this.$a=t;this.nba=Ca;this.CBa=qb;this.IA=Na;this.Sh=la;this.eof=Pb;this.xWh=xc;this.M5a=ed;this.lqb=dd}create(t){return this.Sh&&this.Sh.hb.IC?new ic(this.eof,
this.IA,this.CBa,v.AFrameworkApplication.St,this.Sh,this.xWh,this.M5a,this.lqb,t):new rg(this.$a,this.Ca,this.Sh,this.nba,this.IA,this.CBa,this.eof,t)}}Object(h.a)(Qc,"FileNameDialogFactory",null,[710]);class Jd{constructor(t,S,la,Ca){this.mo=this.Tha=null;this.d3a=t;this.Sh=la;this.pZh=Ca;this.wha=new Kd.a(()=>new Bc.a(S.value,Object(n.a)(this,this.kEa,"getMoreInfoEventReceived")))}get LHb(){this.Tha||(this.wha.value.pda("Save As",!0),this.mo&&this.mo.DR&&this.mo.DR.length&&(this.Tha=this.v9d(this.mo.DR)));
return this.Tha}start(t){if(!this.LHb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Tha=v.AFrameworkApplication.breadcrumbFolderUrl;else return r.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.mo),!1;const S=this.pZh();S.wZe();const la=S.O9d();if(!la)return r.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.d3a.start((Ca,Na)=>{S.hide();t(Ca,Na)},()=>{this.vHe(S)},la,this.Tha);return!0}vHe(t){t.hide();r.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}v9d(t){t=t.toLowerCase();t.endsWith("/")||(t+="/");const S=t.indexOf("/documents/");return-1!==S?t.substring(0,S+1)+"_layouts/15/onedrive.aspx":""}kEa(t){this.mo||3!==t.state||(this.mo=t)}}Object(h.a)(Jd,"OneDriveFilePickerHelper",null,[709]);class yd extends Qd.a{constructor(){super()}wZe(){this.Vxc="FilePickerDialog";
this.eg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ig="PickerDialog-MsoSp";this.showDialog("",null)}O9d(){return document.getElementById("FilePickerDiv")}BA(){}oaa(){}}Object(h.a)(yd,"PickerDialog",Qd.a,[708]);var He=d(488);class sf{constructor(t,S,la,Ca,Na,qb,Pb){this.$a=t;this.EBd=la;this.Ca=S;this.FWb=Ca;this.d3a=Na;this.WHd=qb;this.oPh=Pb}wb(){const t=this.d3a.lxb();t?xe.a.px||this.$a.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.ra(u.a.xjb,E.a.frame,Object(n.a)(this,
this.Eoh,"saveToSharePointActionDispatcher"),64):(t.ZFa.continueWith(S=>{S.rm&&this.d3a.DIe(S)}),this.qJc()):r.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}qJc(){qc.a.wld(Object(n.a)(this,this.Eoh,"saveToSharePointActionDispatcher"));qc.a.F3b([new He.a(u.a.xjb,E.a.frame,0)],this.d3a.lxb())}get IAb(){return this.$a.ka("SaveToAnotherFolderBrsIsEnabled")}get aEf(){return this.$a.ka("UserCanWriteRelative")}Eoh(t,S,la,Ca,Na){return S.contextId!==E.a.frame||
t!==u.a.xjb?2:this.IAb&&(this.WHd.LHb||this.aEf)?1===la?B.SessionStatusManager.instance.Aka||v.AFrameworkApplication.JQ?8:this.oPh()?32:8:2===la?(r.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Na&&Na.SaveEntryPoint&&"VersionHistory"===Na.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.aEf?(r.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.EBd.create(Na).Hja(null)):(r.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.FWb.start(null,Na)),32):8:8}}Object(h.a)(sf,"SaveToSharePointActor",null,[]);class bg{constructor(t,S,la,Ca){this.ol=this.Tjf=null;this.M5a=t;this.IA=S;this.WHd=la;this.Sh=Ca}start(t,S){r.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Tjf=t;this.ol=S;this.WHd.start((la,Ca)=>{this.$Ib(la,Ca)})||this.xZe()}$Ib(t,S){if(t)this.onSuccess(S);else this.Bz(S)}xZe(){1!==this.Sh.state&&this.IA().jDa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(t){r.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(t&&t.data&&t.data.value&&t.data.value.length&&t.data.value[0].sharePoint){const S=t.data.value[0].sharePoint.url;t=t.data.value[0].sharePoint.listUrl;let la=null;if(S&&(la=t?this.Ukj(t):this.Tkj(S))){this.M5a.J1(S,this.Tjf,la,this.ol);return}r.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!S,!la)}r.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.xZe()}Tkj(t){t.endsWith("/")||(t+="/");let S=0;for(let la=0;la<t.length;la++)if("/"===t.charAt(la)&&5===++S)return t.substr(0,la);return null}Ukj(t){t.endsWith("/")&&(t=t.substring(0,t.length-1));const S=t.lastIndexOf("/");return-1!==S?t.substring(0,S):null}Bz(t){r.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");t&&t.error?r.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",t.error.errorCode,t.error.message):r.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.xZe()}}Object(h.a)(bg,"SaveToSharePointManager",null,[707]);class Ag{constructor(t,S,la,Ca,Na,qb,Pb,xc){this.GBa=t;this.yK=S;this.hob=Ca;this.qJd=qb;this.gqa=la;this.I1h=Na;this.vAa=Pb;this.ol=xc}execute(t,S){if(!v.AFrameworkApplication.Ug&&v.AFrameworkApplication.Ke){var la=this.GBa+this.vAa;la=db.a.Ni(la,"fu",cb.a.Ne(this.gqa));la=db.a.Ni(la,"su",cb.a.Ne(this.I1h));la=db.a.Ni(la,"fn",cb.a.Ne(this.yK));la=db.a.Ni(la,"n",cb.a.Ne((new Date).getTime().toString()));
this.ol&&this.ol.FileDownloadUrl&&(la=db.a.Ni(la,"furl",cb.a.Ne(this.ol.FileDownloadUrl)));la=la+"&"+this.qJd;this.hob&&this.hob.length?la=db.a.Ni(la,"fnn",cb.a.Ne(this.hob)):r.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");r.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.Ke.nj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,S,null,void 0,void 0,void 0,void 0,"9")}}}Object(h.a)(Ag,"SharePointSaveAsCaller",
null,[732]);class Ii{constructor(t){this.jra=t.appSettings.SaveAsToHostWebServiceBase;this.yK=t.appSettings.FileName;this.vAa=t.Ga("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(t,S,la,Ca){return new Ag(this.jra,this.yK,t,S,la,v.AFrameworkApplication.hh,this.vAa,Ca)}}Object(h.a)(Ii,"SharePointUploadCallerFactory",null,[706]);var aj=d(498);class Xg{constructor(t,S,la,Ca,Na){this.Qn=this.TQb=null;this.Mxd=!1;this.DKd=this.gqa=null;this.JNd=S;this.Cqa=la;this.IA=Ca;this.Sh=Na;this.Ca=
t}J1(t,S,la,Ca){this.Mxd=!1;r.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Wrc();this.gqa=t;Ca&&Ca.SaveEntryPoint&&(this.DKd=Ca.SaveEntryPoint);this.TQb=this.JNd.create(t,S,la,Ca);Ca&&"true"===Ca.SkipSaveToHost?this.w3():this.V0i()}V0i(){const t=()=>{r.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.w3()};32!==this.Ca.La(u.a.J_a,2,[()=>{r.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.w3()},t])&&t()}w3(){r.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.TQb.execute(Object(n.a)(this,this.Iyk,"onSaveToSharePointUploadFinished"),Object(n.a)(this,this.Hyk,"onSaveToSharePointUploadFailed"))}Iyk(t){if(t&&t.data&&t.data.Wd){var S;if(({sv:S}=Wd.d(t.data.Wd)).returnValue)if(S.StatusCode!==Yc.a.Wv&&S.StatusCode!==Yc.a.T1b)r.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
t.data.status,S.StatusCode),S.StatusCode!==Yc.a.qlh&&this.vQf(t.data.status)||(this.$xa(S.StatusCode.toString()),this.sml(S.StatusCode));else{r.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.CSe();try{S.NewDocumentUrl?this.Dib(S.NewDocumentUrl):this.Eib()}catch(la){r.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",la.toString())}}else r.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ae.a.kuc(t.data.Wd)}),
this.dOc()||(this.$xa("Failed to deserialize response"),this.Urc())}else r.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.dOc()||(this.$xa("Unknown"),this.Urc())}Hyk(t){t&&t.data?this.vQf(t.data.status)||(r.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.$xa(aj.a[t.data.status]),this.Urc()):(r.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.dOc()||(this.$xa("Unknown"),this.Urc()))}dOc(){if(!this.Mxd)return r.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.Mxd=!0,this.w3(),!0;r.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}vQf(t){r.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",t);return this.dOc()}Eib(){r.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Pc.a.vn(this.gqa,Pc.a.hba(3),void 0,"UploadToSharePointManager.RedirectToFolder")}Dib(t){let S=!1,la=!1;v.AFrameworkApplication.fa&&(S=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
la=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));r.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,S);if(S&&la){r.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ca={};Ca[fb.a.$Jb]="1";Ca[fb.a.documentUrl]=t;Ca[fb.a.reason]=ac.a.iUe;v.AFrameworkApplication.nT().execute(Na=>{Na.sendMessage(Qb.a.mDa,Ca)})}else Pc.a.vn(t,Pc.a.hba(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Wrc(){this.Sh&&
1===this.Sh.state||(this.Qn=this.Cqa(),this.Qn.message=CommonUIStrings.l_CommentProgressTooltip,this.Qn.yd=5,this.Qn.Ar=!1,this.Qn.Xoa(CommonUIStrings.l_DefaultDialogTitle,null,null))}f8a(){this.Qn&&(this.Qn.close(),this.Qn=null)}Urc(){this.Ft(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}snl(){this.Ft(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Aml(){const t=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.Ft(CommonUIStrings.l_SaveAsFileTooLargeTitle,t,yf.a.M6k)}Ft(t,S,la=yf.a.Q6k){r.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",t,S);this.f8a();1!==this.Sh.state&&this.IA().YPf(t,S,la)}sml(t){r.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",t);switch(t){case Yc.a.iGh:this.snl();break;case Yc.a.qlh:this.Aml();break;default:this.Urc()}}CSe(){"VersionHistory"===this.DKd&&this.Ca.processAction(u.a.zmd,2)}$xa(t){"VersionHistory"===this.DKd&&this.Ca.La(u.a.DSe,
2,{["FailureReason"]:t})}}Object(h.a)(Xg,"UploadToSharePointManager",null,[683]);class Qi{constructor(){this.fEc=this.$Gd=this.UGd=this.Da=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Zb(t){this.Da=t;this.UGd=Xe.a.av(t.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.$Gd=Xe.a.av(t.Ja("Common.IEventEmitter<Common.IMruResult>"));this.fEc=Xe.a.av(t.Ja("Common.App.SharedFilePicker.ISharedFilePicker"));he.Task.WAA.call(null,this.UGd,this.$Gd,this.fEc).continueWith(()=>
{this.OUk()})}OUk(){this.Da.register(Ii,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").oa(()=>new Ii(v.AFrameworkApplication.fa)).ma();this.Da.register(Xg,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").oa(()=>new Xg(v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Wg.a).create(),()=>new Fe,
v.AFrameworkApplication.Aa)).ma();this.Da.register(bg,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").oa(()=>new bg(this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Fe,this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.Aa)).ma();this.Da.register(Jd,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").oa(()=>
new Jd(this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Kd.a(()=>this.UGd.result),v.AFrameworkApplication.Aa,()=>new yd)).ma();this.Da.register(Qc,"Common.App.SaveToSharePoint.FileNameDialogFactory").oa(()=>new Qc(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.hb,this.Da.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Da.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Kd.a(()=>this.$Gd.result),this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.fEc?this.fEc.result:null)).ma();this.Da.register(sf,"Common.App.SaveToSharePoint.SaveToSharePointActor").oa(()=>new sf(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.Aa.AJc)).ma();v.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Da.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").wb()}static main(){e.a.instance.Dc(new Qi)}}Object(h.a)(Qi,"PackageManager",null,[2,3]);class Jh extends Oa.StandardDialog{constructor(){super();this.yd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}uv(t){this.Jy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(h.a)(Jh,"ErrorDialog",Oa.StandardDialog,[716]);class Og{}Og.default=0;Object(h.a)(Og,"SaveToCloudErrorCodes",null,[]);class Qh{constructor(t,S,la,Ca,Na,qb){this.ol=null;this.A1h=t;this.Yba=S;this.YXb=la;this.$a=Ca;this.Xmb=Na;this.IA=qb}start(t){this.ol=t;if("SharePointOnlineConsumer"===this.$a.Ga("FileSource")){const S=A.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(S){S.start(null,t);return}}this.Yba.eje?(r.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.Rpi()):(r.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.Znl())}Znl(){this.A1h.create().Hja()}Ft(){this.IA().uv(Og.default)}Rpi(){try{r.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let t={["client_id"]:this.$a.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.Xmb||2===this.Xmb)t={["client_id"]:this.$a.appSettings.UploadToSkyDriveClientId};WL.init(t);r.ULS.sendTraceTag(6590562,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&
1===v.AFrameworkApplication.Aa.hb.Uk?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.Bz,"onFailure"))}catch(t){r.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.Ft()}}onSuccess(t){r.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");t&&t.data&&t.data.folders&&
this.YXb.J1(t.data.folders[0].id,t.data.folders[0].urls.viewInBrowser,null,this.ol)}Bz(t){if(t&&t.error){if("user_canceled"===t.error.code){r.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}r.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else r.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Ft()}}Object(h.a)(Qh,"SaveToCloudManager",null,[715]);class Yg{constructor(t,
S,la,Ca){this.ADc=null;this.m0h=t;this.$a=la;this.Pkf=S;this.rif=new $d.a;this.Zh=Ca}IAb(){return this.$a.ka("SaveToCloudStorageUIIsEnabled")}$Zf(){return u.a.rUe}qJc(){qc.a.wld(Object(n.a)(this,this.Boh,"saveToCloudActionDispatcher"));qc.a.F3b([new He.a(u.a.rUe,E.a.frame,0)],this.Pkf.lxb())}wb(){const t=this.Pkf.lxb();t?(t.HS(()=>{this.rif.Kg(!0)}),this.qJc()):r.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Fgh(){r.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")}Boh(t,S,la,Ca,Na){return S.contextId!==E.a.frame||t!==this.$Zf()?2:this.IAb()?1===la?B.SessionStatusManager.instance.Aka||v.AFrameworkApplication.JQ?8:32:2===la?(this.Fgh(),Na&&Na.FileDownloadUrl&&r.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Zh&&(this.ADc=this.Zh.Ei("DialogShown","SaveToOneDriveReponseTime")),this.rif.task.continueWith(()=>{this.ADc&&(this.ADc.stop(),this.ADc=null);this.m0h.start(Na)}),
32):8:8}}Object(h.a)(Yg,"SaveToCloudStorageActor",null,[714]);var If=d(214);class mj extends Oa.StandardDialog{constructor(t,S,la){super();this.Ca=t;this.Yba=S;this.nba=la;this.KV=!1;this.yd=1;this.wya(1);this.Xe(1,CommonUIStrings.l_SignIn);this.Xe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}Hja(){this.Yba.Huf(Object(n.a)(this,this.d7g,"onSignIn"));this.Gx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(n.a)(this,this.vHj,"inputHandler"))}vHj(t){0===
t?(r.ULS.sendTraceTag(6590598,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===v.AFrameworkApplication.Aa.hb.Uk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.lid()}bsi(){let t="2";if(this.nba)switch(this.nba.Uk){case 3:t="0";break;case 2:t="3";break;case 1:t="1"}return t}hide(){this.Yba.wZk(Object(n.a)(this,this.d7g,"onSignIn"));super.hide()}lid(){var t=v.AFrameworkApplication.fa.ka("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";t=new If.QueryStringBuilder(t);
t.Xg("prompt","1");t.Xg("cbcxt",this.bsi());v.AFrameworkApplication.APa(t);Pc.a.vn(t.toString(),"LoginWindow",void 0,"SignInDialog")}d7g(){this.LQ&&this.hide();r.ULS.sendTraceTag(7143885,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===v.AFrameworkApplication.Aa.hb.Uk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ca.processAction(u.a.rUe,2)}}Object(h.a)(mj,"SignInDialog",Oa.StandardDialog,[740]);class xi{constructor(t,S,la){this.Ca=t;this.Yba=
S;this.nba=la}create(){return new mj(this.Ca,this.Yba,this.nba)}}Object(h.a)(xi,"SignInDialogFactory",null,[713]);class Bj{constructor(t,S,la,Ca,Na,qb,Pb){this.GBa=t;this.yK=S;this.hob=la;this.Zyc=Ca;this.qJd=Na;this.vAa=qb;this.ol=Pb}execute(t,S){if(!v.AFrameworkApplication.Ug&&v.AFrameworkApplication.Ke){var la=this.GBa+this.vAa;la=db.a.Ni(la,"fo",cb.a.Ne(this.Zyc));la=db.a.Ni(la,"fn",cb.a.Ne(this.yK));la=db.a.Ni(la,"qs",cb.a.Ne(this.qJd));la=db.a.Ni(la,"n",cb.a.Ne((new Date).getTime().toString()));
this.ol&&this.ol.FileDownloadUrl&&(la=db.a.Ni(la,"furl",cb.a.Ne(this.ol.FileDownloadUrl)));this.hob&&(la=db.a.Ni(la,"fnn",cb.a.Ne(this.hob)));v.AFrameworkApplication.Ke.nj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,S,null)}}}Object(h.a)(Bj,"SkyDriveUploadCaller",null,[738]);class yi{constructor(t){this.$a=t;this.jra=t.appSettings.SkyDriveUploadWebServiceBase;this.yK=t.appSettings.FileName;this.vAa=t.Ga("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(t,S,la){return new Bj(this.jra,
this.yK,S,t,v.AFrameworkApplication.hh,this.vAa,la)}}Object(h.a)(yi,"SkydriveUploadCallerFactory",null,[712]);class Zg{constructor(t,S,la,Ca,Na){this.gqa=this.Qn=this.TQb=null;this.t2=!1;this.ol=this.BBa=null;this.JNd=t;this.Cqa=S;this.IA=la;this.Sh=Ca;this.Zh=Na}Wrc(){this.Sh&&1===this.Sh.state||(this.Qn=this.Cqa(),this.Qn.message=CommonUIStrings.l_CommentProgressTooltip,this.Qn.yd=5,this.Qn.Ar=!1,this.Qn.Xoa(CommonUIStrings.l_DefaultDialogTitle,null,null))}f8a(){this.Qn&&(this.Qn.close(),this.Qn=
null)}UY(){1!==v.AFrameworkApplication.Aa.state&&this.IA().uv(Og.default)}Eib(){r.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Pc.a.vn(this.gqa,Pc.a.hba(3),void 0,"UploadToCloudManager.RedirectToFolder")}Dib(t){let S=!1,la=!1;v.AFrameworkApplication.fa&&(S=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),la=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));r.ULS.sendTraceTag(6654163,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===
v.AFrameworkApplication.Aa.hb.Uk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,S);if(S&&la){r.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ca={};Ca[fb.a.$Jb]="1";Ca[fb.a.documentUrl]=t;v.AFrameworkApplication.nT().execute(Na=>{Na.sendMessage(Qb.a.mDa,Ca)})}else Pc.a.vn(t,Pc.a.hba(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}J1(t,S,la=null,Ca=null){r.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.Zh&&(this.BBa=this.Zh.Ei("DialogShown","SaveToOneDriveUploadTime"));this.Wrc();this.gqa=S;this.TQb=this.JNd.create(t,la,Ca);this.ol=Ca;this.w3()}w3(){r.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.TQb.execute(Object(n.a)(this,this.Gyk,"onSaveToCloudUploadFinished"),Object(n.a)(this,this.Fyk,"onSaveToCloudUploadFailed"))}Gyk(t){this.f8a();this.t2=!1;if(t&&t.data&&t.data.Wd){var S;if(({sv:S}=Wd.d(t.data.Wd)).returnValue)if(t=S,t.StatusCode!==Yc.a.Wv&&t.StatusCode!==Yc.a.T1b)r.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.UY();else{r.ULS.sendTraceTag(6590603,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===v.AFrameworkApplication.Aa.hb.Uk?15:50,"UploadToCloudManager upload success.");try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.Dib(t.NewDocumentUrl):this.Eib()}catch(la){r.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",la.toString())}this.Vlc()}else r.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:Ae.a.kuc(t.data.Wd)}),this.UY()}else r.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.UY()}Fyk(t){5!==t.data.status&&12!==t.data.status||this.t2?(r.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",t.data.status),this.f8a(),this.UY(),this.Vlc()):(r.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.t2=!0,this.w3())}Vlc(){this.BBa&&(this.BBa.stop(),this.BBa=null)}}Object(h.a)(Zg,
"UploadToCloudManager",null,[682]);class ya{constructor(){this.Da=null}get name(){return"Common.App.SaveToCloudStorage"}init(){v.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&this.Da.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").wb()}dispose(){}Zb(t){this.Da=t;this.Da.register(xi,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").oa(()=>new xi(v.AFrameworkApplication.Ta,xg.a.instance,v.AFrameworkApplication.Aa.hb)).ma();
this.Da.register(yi,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").oa(()=>new yi(v.AFrameworkApplication.fa)).ma();this.Da.register(Yg,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").oa(()=>new Yg(t.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.lV)).ma();this.Da.register(Zg,
"Common.App.SaveToCloudStorage.UploadToCloudManager").oa(()=>new Zg(t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Wg.a).create(),()=>new Jh,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.lV)).ma();this.Da.register(Qh,"Common.App.SaveToCloudStorage.SaveToCloudManager").oa(()=>new Qh(t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),xg.a.instance,t.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.URa,
()=>new Jh)).ma()}static main(){e.a.instance.Dc(new ya)}}Object(h.a)(ya,"PackageManager",null,[2,3]);class La{static get eg(){return Qd.a.VA(La.En,CommonUIStrings.l_SaveACopyFileName)}}La.En="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(h.a)(La,"FileNameDialogHtml",null,[]);class Qa extends Qd.a{constructor(t,S,la,Ca){super();this.Zyc=this.gqa=null;this.Ca=t;this.nba=S;this.YXb=la;this.Xe(1,CommonUIStrings.l_SaveButtonLabel);this.eg=La.eg;this.ig="FileNameDialog-SaveACopy";this.ol=Ca}Hja(t,S,la){this.Zyc=t;this.gqa=la;t={["txtFileName"]:cb.a.XG(v.AFrameworkApplication.St.$w),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,S)};this.aj(CommonUIStrings.l_SaveToOneDrive,Object(n.a)(this,this.dQc,"fileNameDialogHandler"),
t);r.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}dQc(t,S){1!==t?r.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(t=S.txtFileName.trim(),r.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),S=cb.a.pQ(v.AFrameworkApplication.fileName),t&&""!==t&&""!==S&&(t+=S),this.YXb.J1(this.Zyc,this.gqa,t,this.ol))}}Object(h.a)(Qa,"FileNameDialog",Qd.a,
[744]);class Eb{constructor(t,S,la){this.Ca=t;this.nba=S;this.YXb=la}create(t){return new Qa(this.Ca,this.nba,this.YXb,t)}}Object(h.a)(Eb,"FileNameDialogFactory",null,[717]);class fc extends Oa.StandardDialog{constructor(t){super();this.yd=1;this.Xe(1,CommonUIStrings.l_RetryButtonLabel);this.Xe(0,CommonUIStrings.l_DialogClose);this.Ca=t}uv(t){r.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",t);this.Jy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(n.a)(this,
this.sTe,"retryDialogHandler"))}sTe(t){1===t?(r.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.processAction(u.a.Rpc,2)):r.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(h.a)(fc,"RetryDialog",Oa.StandardDialog,[716]);class mc extends Yg{constructor(t,S,la,Ca){super(t,S,la,Ca);this.zYh=S}IAb(){return this.$a.ka("SaveACopyBrsIsEnabled")}$Zf(){return u.a.Rpc}qJc(){qc.a.wld(Object(n.a)(this,this.Boh,"saveToCloudActionDispatcher"));qc.a.F3b([new He.a(u.a.Rpc,
E.a.frame,0)],this.zYh.lxb())}Fgh(){v.AFrameworkApplication.dGa("CreateCopy_cf;CreateCopy_tf");r.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(h.a)(mc,"SaveACopyActor",Yg,[]);class Mc extends Qh{constructor(t,S,la,Ca,Na,qb,Pb){super(S,la,Ca,Na,qb,Pb);this.tSh=t}onSuccess(t){t&&t.data&&t.data.folders?(r.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.tSh.create(this.ol).Hja(t.data.folders[0].id,t.data.folders[0].name,
t.data.folders[0].urls.viewInBrowser)):(r.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Ft())}Bz(t){t&&t.error&&"user_canceled"===t.error.code&&r.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.Bz(t)}Ft(){r.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Ft()}}Object(h.a)(Mc,"SaveACopyManager",Qh,[]);class nd extends Zg{constructor(t,S,la,Ca,Na,qb){super(S,la,Ca,Na,qb);this.Ca=t}gme(){return!!this.ol&&
!!this.ol.SaveEntryPoint&&"VersionHistory"===this.ol.SaveEntryPoint.toString()}UY(){r.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.gme()&&this.Ca.La(u.a.DSe,2,{["FailureReason"]:"Unknown"});super.UY()}Eib(){r.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.gme()&&this.Ca.processAction(u.a.zmd,2);super.Eib()}Dib(t){r.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",t);this.gme()&&this.Ca.processAction(u.a.zmd,
2);super.Dib(t)}w3(){this.ol&&"true"===this.ol.SkipSaveToHost?super.w3():32!==this.Ca.processAction(u.a.J_a,1)?(r.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.w3()):this.Ca.La(u.a.J_a,2,[()=>{r.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Zg.prototype.w3.call(this)},()=>{r.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.UY()}])}}
Object(h.a)(nd,"SaveACopyUploadToCloudManager",Zg,[]);class ba{constructor(){this.Da=null}get name(){return"Common.App.SaveACopy"}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){v.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&this.Da.resolve("Common.App.SaveACopy.SaveACopyActor").wb()}dispose(){}Zb(t){this.Da=t;this.Da.register(nd,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").oa(()=>new nd(v.AFrameworkApplication.Ta,t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new Wg.a).create(),()=>new fc(v.AFrameworkApplication.Ta),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.lV)).ma();this.Da.register(Eb,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").oa(()=>new Eb(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa.hb,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Da.register(mc,"Common.App.SaveACopy.SaveACopyActor").oa(()=>new mc(t.resolve("Common.App.SaveACopy.SaveACopyManager"),
t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.lV)).ma();this.Da.register(Mc,"Common.App.SaveACopy.SaveACopyManager").oa(()=>new Mc(t.resolve("Common.App.SaveACopy.FileNameDialogFactory"),t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),xg.a.instance,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.URa,()=>new fc(v.AFrameworkApplication.Ta))).ma()}static main(){e.a.instance.Dc(new ba)}}
Object(h.a)(ba,"PackageManager",null,[2,3]);var Aa=d(373);class Wa{constructor(t){this.zGg=null;r.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Fgc=v.AFrameworkApplication.fa.Ga("PhoneLinkServiceEndpoint");(this.eM=t)||r.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Fgc&&this.Fgc.length||r.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}PXi(t){t&&(this.Fgc="https://dcg-df.microsoft.com/",r.ULS.sendTraceTag(526697302,
306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.OXi()}OXi(){r.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.zGg)r.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.zGg=new Date;var t=new Date;this.eM.sV("BayBridge",this.Fgc).then(S=>{const la=+new Date-+t;S.IsSuccess?(r.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",
la),this.IXi(S.Token,this.D4i())):r.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",la,S.ErrorCode,S.ErrorMessage)}).catch(S=>{r.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",S,+new Date-+t)})}}IXi(t,S){const la={};la.Authorization="Bearer "+t;la["Authorization-Type"]="AAD";la.Accept="application/json";la["DCG-SessionId"]=
v.AFrameworkApplication.userSessionId;v.AFrameworkApplication.Ke.nj(S,1,null,la,!1,2,Object(n.a)(this,this.Rlj,"getStatusSucceeded"),Object(n.a)(this,this.Plj,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");Za.a("FetchAccountLinkedStatus")}G5i(){const t=Aa.a.instance.getItem("AccountLinkedStatusCache");return t&&t.length?"true"===t.toLowerCase()?!0:!1:!1}D4i(){return this.Fgc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Plj(){r.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Rlj(t){r.ULS.sendTraceTag(527214157,
352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");t=Wd.a(t.data.Wd).state+"";Aa.a.instance.setItem("AccountLinkedStatusCache",t)}}Object(h.a)(Wa,"PhoneLinkManager",null,[659]);class gb{constructor(){this.Da=null}get name(){return"Common.App.PhoneLink"}Zb(t){this.Da=t;this.Da.register(659,"Common.App.PhoneLink.IPhoneLinkManager").ma().oa(()=>new Wa(this.Da.resolve("Common.App.OAuth.IOAuthManager")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.REa()})}REa(){this.Da.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){e.a.instance.Dc(new gb)}}
Object(h.a)(gb,"PhoneLinkPackage",null,[2,3]);var nb;(function(t){t[t.myFiles=0]="myFiles";t[t.recent=1]="recent";t[t.currentFolder=2]="currentFolder";t[t.yourPhone=3]="yourPhone"})(nb||(nb={}));Object(h.b)("SharedFilePickerLandingLocation",nb);class lc{constructor(t){this.Z$a=this.dJb=null;this._initialized=!1;this.yde=t}i2d(t){this._initialized||(t.yu(Qb.a.sgh),t.KB(Qb.a.sgh,Object(n.a)(this,this.ayk,"onReceivedPickerResponse")),this._initialized=!0)}D7d(t){return this.Z$a=new Promise((S,la)=>{const Ca=
{};Ca[fb.a.YFk]=t;this.dJb=(Na,qb)=>{""===qb?(r.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),S(Na)):("Canceled"===qb?r.ULS.sendTraceTag(572548164,306,50,qb):r.ULS.sendTraceTag(556901065,306,10,qb),la(qb))};this.yde.execute(Na=>{this.i2d(Na);Na.sendMessage(Qb.a.CBk,Ca)})})}ayk(t){this.dJb(t.Values[fb.a.L8k],void 0===t.Values[fb.a.dLe]||null===t.Values[fb.a.dLe]?"":t.Values[fb.a.dLe])}rme(){return v.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}sYd(t,S,la,Ca,Na,qb,
Pb,xc,ed=null){const dd={};dd[fb.a.v8k]=t;dd[fb.a.titleText]=S;dd[fb.a.kei]=la;dd[fb.a.lei]=Ca;dd[fb.a.mei]=Na;dd[fb.a.xOi]=!0;dd[fb.a.iYi]=qb;dd[fb.a.aGk]=Pb;dd[fb.a.$Fk]=nb[xc];xb.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(dd[fb.a.bGk]="Dark");ed&&(null!=ed.Jrb&&(dd[fb.a.Jrb]=ed.Jrb),null!=ed.Fyb&&(dd[fb.a.Fyb]=ed.Fyb));return dd}}Object(h.a)(lc,"SharedFilePickerManager",null,[679]);class jd{constructor(){this.Da=null}get name(){return"Common.App.SharedFilePicker"}Zb(t){this.Da=
t;t.register(lc,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().oa(()=>new lc(t.Ja("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.REa()})}REa(){this.Da.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Dc(new jd)}}Object(h.a)(jd,"SharedFilePickerPackage",null,[2,3]);class xd{constructor(t,S=3E4){this.Wxl=9E5;this.$xl=1E4;this.mug=this.gEb=null;this.Oqe=0;
this.n2b=Date.now;this.hVc=t;this.Ltd=S;this.KRc()}Y8f(t=!0){const S=this.n2b();if(S<this.Oqe+this.Wxl)return S>this.Oqe+this.$xl&&this.KRc(),this.mug;t&&this.KRc();return null}getToken(t=!0){return(t=this.Y8f(t))?Promise.resolve(t):this.KRc()}KRc(){return this.gEb=this.gEb||new Promise(t=>{this.hVc().then(S=>{this.gEb=null;""!==S&&S&&(this.mug=S,this.Oqe=this.n2b(),t(S));t(null)}).catch(()=>{this.gEb=null;t(null)});window.setTimeout(()=>{this.gEb=null;t(null)},this.Ltd)})}}Object(h.a)(xd,"OAuthCacheManager",
null,[]);var Kc=d(109),Zc=d(68);class Sc{static d6d(t){return""!==t&&t?Sc.Kei[t.toLowerCase()]:""}static Vnj(t,S){const la=Date.now();var Ca=Sc.fLc();const Na=v.AFrameworkApplication.fa.Ga("UserPrincipalName"),qb=Sc.d6d(t);r.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+t);if(""===Na||!Na)return r.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===qb||!qb)return r.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+
t),Promise.resolve("");const Pb=Kc.a.create().toString();Ca=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none","https://login.microsoftonline.com",qb,encodeURIComponent(S),encodeURIComponent(Na),encodeURIComponent(Ca),Pb);const xc=document.createElement("iframe");xc.style.display="none";xc.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");xc.src=
Ca;document.body.appendChild(xc);return new Promise(ed=>{Sc.dok(xc.contentWindow).then(dd=>{document.body.removeChild(xc);const fd=new Zc.a,we=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Sf;for(;Sf=we.exec(dd);)3!==Sf.length&&(r.ULS.sendTraceTag(593862983,1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Sf.length),ed("")),fd.$(Sf[1],Sf[2]);fd.Gb("access_token")?(r.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",S,t,Date.now()-
la),ed(fd.ga("access_token"))):(r.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",S,t,(Date.now()-la).toString()),ed(""))}).catch(dd=>{try{document.body.removeChild(xc)}catch(fd){}r.ULS.sendTraceTag(593862980,1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",S,t,JSON.stringify(dd),(Date.now()-la).toString());ed("")})})}static fLc(){const t=window.location.protocol,S=window.location.host;var la=v.AFrameworkApplication.fa.Ga("OAuthManagerHostPathOverride");
if(void 0===la||null===la){la=window.location.pathname;const Ca=la.lastIndexOf("/");la=0<=Ca?la.substring(0,Ca+1):""}return t+"//"+S+la+"WacOAuth.html"}static dok(t){return new Promise((S,la)=>{let Ca=0,Na=0;Na=window.setInterval(()=>{if(200<Ca++)window.clearInterval(Na),la("Exceeded 10000ms timeout after 200 polls");else{var qb=null,Pb=null;try{if(!t||t.closed){window.clearInterval(Na);la("Window or Frame is closed before completion");return}qb=t.location.href;Pb=t.location.hash}catch(xc){}qb&&"about:blank"!==
qb&&Pb&&""!==Pb&&(window.clearInterval(Na),S(Pb))}},50)})}}Sc.Kei={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(h.a)(Sc,"OAuthHelper",null,[]);class ld{constructor(t,S){this.token=t;this.source=S}}Object(h.a)(ld,"TokenResult",null,[]);class Dg{constructor(){this.eM=null;this.Jbf={};this.GOb=new zg.a(lj.a.Hn())}getToken(t,S,la=!1){if(this.GOb.Gb(S))return this.GOb.ga(S).getToken();const Ca=new xd(()=>la?this.Z8f(t,S):this.hVc(t,S));
this.GOb.$(S,Ca);return Ca.getToken()}Tnj(t,S,la=!1){if(this.GOb.Gb(S))return this.GOb.ga(S).Y8f();const Ca=new xd(()=>la?this.Z8f(t,S):this.hVc(t,S));this.GOb.$(S,Ca);return null}hVc(t,S){const la=Date.now();return Sc.Vnj(t,S).then(Ca=>new ld(Ca,"SSOStack")).then(Ca=>new Promise(Na=>{Ca.token&&""!==Ca.token?(r.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",t,Ca.source,Date.now()-la),this.W_a("GetTokenInternal",!0,Date.now()-la,t,"","",S),Na(Ca.token)):(r.ULS.sendTraceTag(593862978,
1300,50,"{0}: SSO Token provider failed! Latency: {1}",t,Date.now()-la),this.W_a("GetTokenInternal",!1,Date.now()-la,t,"GetTokenSilent Failed","SSO Token provider failed!",S),Na(""))}))}Z8f(t,S){if(!this.eM)try{this.eM=A.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(la){r.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+la)}return this.eM?new Promise(la=>{const Ca=Date.now();this.eM.sV(t,S).then(Na=>{const qb=Na.Token;!Na.IsSuccess||this.BXj(qb)?(this.W_a("GetTokenInternalImplicitJS",
!1,Date.now()-Ca,t,Na.ErrorCode,Na.ErrorMessage,S),la(null)):(this.W_a("GetTokenInternalImplicitJS",!0,Date.now()-Ca,t,Na.ErrorCode,Na.ErrorMessage,S),la(qb))}).catch(Na=>{Na=Na?Wd.c(Na):"";this.W_a("GetTokenInternalImplicitJS",!1,Date.now()-Ca,t,"Caught Exception",Na,S);la(null)})}):new Promise(la=>{this.W_a("GetTokenInternalImplicitJS",!1,0,t,"Null OAuthManager","OAuthManager not set");la(null)})}W_a(t,S,la,Ca,Na="",qb="",Pb=""){var xc="Search"===Ca;const ed=[];t=Oi.a.L8(xc?"Event":"EventName",
t,2);Ca=Oi.a.L8("AppName",Ca,2);Array.add(ed,t);Array.add(ed,Ca);xc&&(Ca=Oi.a.L8("LatencyType","FetchToken",2),Array.add(ed,Ca));Na&&""!==Na&&(Na=Oi.a.L8("ErrorCode",Na,2),Array.add(ed,Na));qb&&""!==qb&&(qb=Oi.a.L8("ErrorMessage",qb,2),Array.add(ed,qb));Pb&&""!==Pb&&(qb=!(Pb in this.Jbf),this.Jbf[Pb]=qb,qb=Oi.a.L8("WarmUpCall",qb.toString(),1),Array.add(ed,qb),Pb=Oi.a.L8("Service",this.HUc(Pb),2),Array.add(ed,Pb));xc=xc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
S=Object.assign(new ph.a,{name:xc,samplingPolicy:2,dataFields:ed,succeeded:S,durationMs:la});y.a.sendActivityEvent(S)}HUc(t){return t===v.AFrameworkApplication.spe?"Loki":t===v.AFrameworkApplication.D0e?"Substrate":v.AFrameworkApplication.fa&&t===v.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}BXj(t){return!t||!t.length}}Object(h.a)(Dg,"SearchOAuthManager",null,[657]);class De{constructor(){this.Da=null}get name(){return"Common.App.SearchOAuthManager"}Zb(t){this.Da=
t;this.Da.register(657,"Common.App.SearchCommon.ISearchOAuthManager").ma().oa(()=>new Dg)}init(){}dispose(){}static main(){e.a.instance.Dc(new De)}}Object(h.a)(De,"SearchOAuthPackage",null,[2,3]);var gi;(function(t){t[t.generalException=0]="generalException";t[t.invalidArgument=1]="invalidArgument";t[t.notAllowed=2]="notAllowed";t[t.apiNotAvailable=3]="apiNotAvailable";t[t.unresolvedPendingRequest=4]="unresolvedPendingRequest";t[t.timeout=5]="timeout";t[t.adalTimeout=6]="adalTimeout";t[t.userNotSignedIn=
7]="userNotSignedIn";t[t.userAborted=8]="userAborted";t[t.silentSignInFailed=9]="silentSignInFailed";t[t.invalidResourceUrl=10]="invalidResourceUrl";t[t.invalidGrant=11]="invalidGrant";t[t.connectionLost=12]="connectionLost";t[t.clientError=13]="clientError";t[t.serverError=14]="serverError"})(gi||(gi={}));Object(h.b)("ErrorCodes",gi);class pk{}Object(h.a)(pk,"HostApplicationType",null,[]);class Kh{constructor(t,S){this.requestCallback=this.requestParameters=null;this.requestParameters=t;this.requestCallback=
S}}Object(h.a)(Kh,"OutstandingRequest",null,[]);class Yd{}Yd.Lpk="AADSTS50058";Yd.invalidResourceUrl="AADSTS50001";Yd.Fpk="AADSTS65001";Yd.Ypk="AADSTS70011";Yd.userAborted="13002";Yd.RHk="Popup Window is null";Yd.QHk="Popup Window closed";Yd.adalTimeout="Token renewal operation failed due to timeout";Yd.ayl="tokenRevoked";Object(h.a)(Yd,"WopiHostErrorType",null,[]);var Kk=d(226),zi=d(352),Vi=d(980);class hi{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=
""}}Object(h.a)(hi,"WopiIdentityInfo",null,[721]);class xa{constructor(t,S,la){this.expiration=this.authority=this.accessToken=null;this.accessToken=t;this.authority=S;this.expiration=la}}Object(h.a)(xa,"WopiIdentityToken",null,[720]);class sb{constructor(t){this._initialized=!1;this.QHb={};this.bsd={};this.Maa=v.AFrameworkApplication.Aa.lV;this.yde=t}i2d(t){this._initialized||(t.yu(Qb.a.ebh),t.KB(Qb.a.ebh,Object(n.a)(this,this.Zxk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(t,
S,la=null){this.a6j(t,S);return new Promise((Ca,Na)=>{if(this.Zie(S))if(S in this.QHb)Na("unresolvedPendingRequest");else{var qb=window.setTimeout(()=>{r.ULS.sendTraceTag(37856032,344,10,Wd.c({["error"]:"Request timeout.",["callerId"]:S}));Na("timeout")},12E4);this.O5d(t,S,la,(Pb,xc)=>{window.clearTimeout(qb);Pb?Ca(Pb):(r.ULS.sendTraceTag(37856033,369,15,Wd.c({["error"]:gi[xc]})),Na(xc))})}else r.ULS.sendTraceTag(37856034,344,10,Wd.c({["error"]:"Caller is not allowed."})),Na("notAllowed")})}getPrimaryIdentityInfo(t){return new Promise((S,
la)=>{this.Zie(t)?this.jhj((Ca,Na)=>{Ca?S(Ca):(r.ULS.sendTraceTag(37856064,369,10,Wd.c({["error"]:Na.toString()})),la(Na))}):(r.ULS.sendTraceTag(37856065,344,10,Wd.c({["error"]:"Caller is not allowed."})),la("notAllowed"))})}getAuthContext(t){return new Promise((S,la)=>{const Ca=this.getAuthContextSync(t);Ca?S(Ca):la("notAllowed")})}getAuthContextSync(t){if(this.Zie(t)){const S=new Vi.a;S.upn=v.AFrameworkApplication.fa.Ga("UserPrincipalName");S.userId=v.AFrameworkApplication.fa.Ga("LoggableUserId");
S.authority=v.AFrameworkApplication.fa.Ga("HostAuthAuthority");S.tenantId=v.AFrameworkApplication.fa.Ga("TenantId");S.isAnonymous=v.AFrameworkApplication.fa.ka("IsAnonymousUser");S.supportsAuthToken=this.qBj(t);t=v.AFrameworkApplication.fa.Ga("HostAuthType");S.authorityType="aad"===t.toLowerCase()?2:"msa"===t.toLowerCase()?1:0;return S}r.ULS.sendTraceTag(40751647,344,10,Wd.c({["error"]:"Caller is not allowed."}));return null}qBj(t){const S=Kk.OAuthManagerSettings.Y$a;return xe.a.OFa?S&&Kk.OAuthManagerSettings.ZBh?
Array.contains(Kk.OAuthManagerSettings.ZBh,t.toLowerCase()):!1:S}O5d(t,S,la,Ca){var Na=[];Array.add(Na,Object.assign(new K.a,{name:"CallerId",string:S}));Array.add(Na,Object.assign(new K.a,{name:fb.a.H_e,string:t.correlationId}));y.a.sendTelemetryEvent(Object.assign(new G.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Na}));Na=zi.a.create().toString();const qb="getAccessToken_"+Na,Pb=this.Maa.Ei("ComponentAttach",qb);this.bsd[qb]=Pb;const xc={};xc[fb.a.I_e]=Na;
xc[fb.a.mrl]=t.resource;xc[fb.a.nrl]=t.scope;xc[fb.a.Oyh]=v.AFrameworkApplication.fa.Ga("HostAuthType");xc[fb.a.qrl]=v.AFrameworkApplication.fa.Ga("UserPrincipalName");xc[fb.a.orl]=t.silentLogin;xc[fb.a.jrl]=t.options;xc[fb.a.H_e]=t.correlationId;xc[fb.a.krl]=S;la&&(xc[fb.a.addinName]=la.AddinName,xc[fb.a.irl]=la.AddinTrustId);this.yde.execute(ed=>{this.i2d(ed);ed.sendMessage(Qb.a.getAuthToken,xc)});this.QHb[Na]=new Kh(t,Ca)}jhj(t){const S=v.AFrameworkApplication.fa.Ga("UserName"),la=v.AFrameworkApplication.fa.Ga("UserPrincipalName"),
Ca=v.AFrameworkApplication.fa.Ga("LoggableUserIdSpace"),Na=new hi;Na.email=la;Na.displayName=S;switch(Ca){case "OrgIdPuid":Na.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Na.authority="MicrosoftAccount";break;default:Na.authority=Ca}t(Na,null)}Zxk(t){let S=null;try{let Ca=t.Values[fb.a.I_e];const Na=t.Values[fb.a.hrl],qb=t.Values[fb.a.Oyh],Pb=t.Values[fb.a.prl];let xc=null,ed=null;const dd=this.QHb[Ca];if("undefined"!==typeof dd&&dd){var la=[];Array.add(la,Object.assign(new K.a,
{name:fb.a.H_e,string:dd.requestParameters.correlationId}));y.a.sendTelemetryEvent(Object.assign(new G.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:la}));S=dd.requestCallback;delete this.QHb[Ca];"undefined"!==typeof Na&&Na&&Na.length?ed=new xa(Na,qb,Pb):xc=gi[this.olk(t)];la="getAccessToken_"+Ca;la in this.bsd&&(this.bsd[la].stop(),delete this.bsd[la]);S(ed,xc)}else r.ULS.sendTraceTag(37856066,344,10,Wd.c({["error"]:"No matching outstanding request for request ID.",
["requestId"]:Ca}))}catch(Ca){t=t.Values[fb.a.I_e],t in this.QHb&&delete this.QHb[t],this.x2c(),r.ULS.sendTraceTag(37856067,344,10,Wd.c({["error"]:Ca.message,["stack"]:Ca.stack})),S&&S(null,"generalException")}}Zie(t){var S=v.AFrameworkApplication.oqj();t=t.toLowerCase();for(const la of S)if(t===la.toLowerCase())return!0;S=Kk.OAuthManagerSettings.dRd;for(let la in S)if(t===S[la].toLowerCase())return!0;return!1}olk(t){t=t.Values[fb.a.lrl];this.x2c();r.ULS.sendTraceTag(39068821,344,15,Wd.c({["error"]:t}));
return t?-1<t.indexOf(Yd.Lpk)?9:-1<t.indexOf(Yd.RHk)||-1<t.indexOf(Yd.QHk)?12:-1<t.indexOf(Yd.invalidResourceUrl)?10:-1<t.indexOf(Yd.userAborted)?8:-1<t.indexOf(Yd.Ypk)||-1<t.indexOf(Yd.Fpk)||t===Yd.ayl?11:-1<t.indexOf(Yd.adalTimeout)?6:0:13}a6j(t,S){t=this.lUk(t.resource);r.ULS.sendTraceTag(39921882,344,50,Wd.c({["callerId"]:S,["resource"]:t}))}x2c(){r.ULS.sendTraceTag(39068822,344,50,Wd.c({["userAgent"]:window.navigator.userAgent}))}lUk(t){return(t?t:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")}}Object(h.a)(sb,"WopiIdentityManager",null,[675]);class Jb{constructor(){this.Da=null}get name(){return"Common.App.WopiIdentity"}Zb(t){this.Da=t;t.register(sb,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().oa(()=>new sb(t.Ja("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){try{this.Da.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(t){r.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+t)}}dispose(){}static main(){e.a.instance.Dc(new Jb)}}Object(h.a)(Jb,"WopiIdentityPackage",null,[2,3]);var uc=d(671);class Gd extends uc.a{constructor(t,S){super(t,db.a.sQ(S))}Txa(t,S){this.isEnabled()&&this.LBa(this.NLa)&&(this.yu(t),this.KB(t,S))}}Object(h.a)(Gd,"InsertMediaCrossDocumentMessenger",uc.a,[842,371,106]);class ee{getInstance(t,S){return new Gd(t,S)}}Object(h.a)(ee,"InsertMediaCrossDocumentMessengerFactory",null,[805]);
class se{constructor(t,S,la){this.correlationId=null;this.w5=0;this.insertPictureTelemetryEndpoint=null;this.d0d=0;this.KTh=t;this.VXb=[];this.ITh=S;this.Xpf=la.split(";")}aNb(t,S){Array.clear(this.VXb);t=this.KTh.value;t.aDl(S.ryb);t.LBa(this.ITh);t.yu(S.ryb);t.KB(S.ryb,la=>{this.wIe(la,S)});r.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");t.sendMessage(S.mMf,{["FileExtensionFilterList"]:this.Xpf})}p9h(t){Array.contains(this.VXb,t)||
Array.add(this.VXb,t)}wIe(t,S){r.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");t=S.j$g(t);const la=[];for(let Ca=0;Ca<t.length;Ca++){const Na=t[Ca];S.LZc(Na,this.Xpf)?Array.add(la,Na):this.p9h(S.D6f(Na))}la&&la.length?S.aua(la):r.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.VXb.length&&(S=this.VXb.join(", "),r.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",
S),this.yol(S))}yol(t){const S=new Oa.StandardDialog;S.yd=0;S.fP(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,t),null)}dispose(){}}Object(h.a)(se,"InsertMediaFromHostManager",null,[804,106]);class $e{constructor(t){this.mUh=t}getInstance(){return this.mUh}}Object(h.a)($e,"InsertMediaFromHostManagerFactory",null,[802,803]);class gg{constructor(){this.ySb=document.createElement("iframe");this.ySb.src="about:blank";this.ySb.style.visibility=
"hidden";this.ySb.style.position="absolute";this.ySb.style.zIndex="-100"}get S8a(){return this.ySb}}Object(h.a)(gg,"InsertMediaFromHostOneDriveHostFrame",null,[801]);class Th extends uc.a{constructor(t,S){super(t,"*"===S?S:db.a.sQ(S));this.Csf(Qb.a.insertImage);this.Csf(Qb.a.nfe)}reportDocumentLoadedTime(){}}Object(h.a)(Th,"InsertMediaFromOneDriveCrossDocumentMessenger",uc.a,[800,371,106]);var Uh=d(270),Qj=d(542);class Xd{MHc(t){switch(t){case 1:t=8;break;case 4:t=3;break;case 2:t=0;break;default:t=
0}return t}Cli(t,S){return String.format(S,this.MHc(t))}Bli(t,S,la,Ca,Na,qb,Pb){t=this.MHc(t);const xc=Uh.a.xe(v.AFrameworkApplication.lcid).name,ed=v.AFrameworkApplication.buildVersion;v.AFrameworkApplication.dGa("ShIns226;ShIns226cf");return String.format(S,v.AFrameworkApplication.lcid,xc,ed,Na,t,qb,la,Ca,Pb)}Fli(t,S){t=this.MHc(t);const la=v.AFrameworkApplication.buildVersion,Ca=0<la.indexOf(".")?la.substring(0,la.indexOf(".")):"16";return String.format(S,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,
v.AFrameworkApplication.lcid,t,Ca,la,"Video",0,0)}Eli(t,S,la,Ca,Na,qb,Pb){const xc=Uh.a.xe(v.AFrameworkApplication.lcid).name;t=String.format(S,v.AFrameworkApplication.lcid,xc,v.AFrameworkApplication.buildVersion,la,this.MHc(t),Ca);Na&&(t+="&flipgrid=1");qb&&(Na=new If.QueryStringBuilder(t),Na.Xg("stream2","1"),t=Na.toString());"defaultModal"!=Pb&&(Na=new If.QueryStringBuilder(t),Na.Xg("modalvariation",Pb),t=Na.toString());return t}l$g(t){if(!t||!t.Values)return null;t=t.Values;if(!t)return null;
let S="";"sourceProvider"in t&&(S=t.sourceProvider||"");return Object.assign(new Qj.a,{Action:t.action||"",Caption:t.caption||"",ContentType:t.contentType||"",Type:t.extension||"",PageUrl:t.pageUrl||"",OriginalUrl:t.sourceUrl||"",ContentProvider:S,ThumbnailUrl:t.thumbnailUrl||"",LicenseUrl:t.licenseUrl||"",LicenseDisplayName:t.licenseDisplayName||"",Height:t.height||0,Width:t.width||0,SvgContent:t.svgContent||"",Description:t.description||"",ProviderName:t.providerName||"",StartInsertTime:t.startInsertTime||
0})}pEk(t){const S=[];if(!t||!t.Values||!t.Values.Items)return S;t=t.Values.Items;for(let Ca=0;Ca<t.length;Ca++){var la=t[Ca];la&&(la=Object.assign(new Qj.a,{Type:la.Extension||"",OriginalUrl:la.SourceUrl||"",Caption:la.caption,Description:la.description||"",Height:la.Height||0,Width:la.Width||0}),Array.add(S,la))}return S}LZc(t,S){if(!t)return!1;for(let la=0;la<S.length;la++)if(0<=t.toLowerCase().indexOf(S[la]))return!0;return!1}kKk(t){let S="";if(t)for(let la=0;la<t.length;la++){const Ca=t[la];
Ca&&(S+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',Ca.OriginalUrl,Ca.Width,Ca.Height))}return S}ppj(t){return(t=Xd.U5k.exec(t))&&2<t.length?t[2].trim():""}}Xd.U5k=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(h.a)(Xd,"InsertMediaHelper",null,[799]);var Wf=d(34);class yk{constructor(t){this.BTb=Wf.a.insertHyperlink;this.Ca=t}get hy(){return this.BTb}set hy(t){this.BTb=t}aua(t){try{r.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
t.length);for(let S=0;S<t.length;S++)this.Ca.La(this.hy,2,t[S]);r.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",t.length)}catch(S){r.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",S.toString())}}}Object(h.a)(yk,"InsertOneDriveFileHandler",null,[798]);class ak extends yk{constructor(t){super(t)}get mMf(){return Qb.a.nfe}get ryb(){return Qb.a.IHj}j$g(t){return t&&t.Values&&"Items"in t.Values?
t.Values.Items:null}D6f(){O.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}LZc(){return!0}odh(t,S,la){t=la(t);t.length&&(la={},la.Items=t,S.sendMessage(this.ryb,la))}k$g(t){const S=[];for(let la=0;la<t.data.value.length;la++){const Ca=t.data.value[la];if(Ca){const Na={};Na.DisplayText=Ca.name;Na.Url=Ca.urls.download;Na.sourceUrl=Ca.urls.download;Na.caption=Ca.name;Array.add(S,Na)}}return S}}Object(h.a)(ak,"InsertOneDriveFileHelper",
yk,[797,798]);class Im extends Qd.a{constructor(){super()}wZe(){this.Vxc="FilePickerDialog";this.eg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.ig="PickerDialog-Livebooks";this.showDialog("",null)}O9d(){return document.getElementById("OpenFilePickerDiv")}BA(){}oaa(){}}Object(h.a)(Im,"PickerDialog",Qd.a,[840]);class ml{constructor(t,S,la){this.mo=this.Tha=null;this.d3a=t;this.ZId=la;this.wha=new Kd.a(()=>new Bc.a(S.value,Object(n.a)(this,this.kEa,"getMoreInfoEventReceived")))}get LHb(){this.Tha||
(this.wha.value.pda("InsertFromOneDrive",!0),this.mo&&this.mo.DR&&this.mo.DR.length&&(this.Tha=this.v9d(this.mo.DR)));return this.Tha}v9d(t){t=t.toLowerCase();t.endsWith("/")||(t+="/");const S=t.indexOf("/documents/");return-1!==S?t.substring(0,S+1)+"_layouts/15/onedrive.aspx":""}kEa(t){this.mo||3!==t.state||(this.mo=t)}start(t){if(!this.LHb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Tha=v.AFrameworkApplication.breadcrumbFolderUrl;else{r.ULS.sendTraceTag(26071185,
352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.mo);return}const S=new Im;S.wZe();const la=S.O9d();la?this.d3a.start((Ca,Na)=>{S.hide();this.$Ib(Ca,Na,t)},()=>{this.vHe(S)},la,this.Tha):r.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}vHe(t){t.hide();r.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}$Ib(t,S,la){r.ULS.sendTraceTag(26071188,
352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",t);t&&S&&S.data&&S.data.value&&0<S.data.value.length?(t=this.ZId.getInstance(window.frames[0].parent,window.document.URL),la.odh(S,t,Object(n.a)(la,la.k$g,"parseOneDriveV7Response"))):r.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(h.a)(ml,"OneDriveFilePickerHelperV7",null,[795,796]);class Lk{constructor(t,S,la,Ca){this.ia=S;this.la=
t;this.L4=this.la.fua;this.ML=la;this.Osg=Ca}get SP(){return this.Osg?this.Osg.instance:null}wb(){this.ia.ra(u.a.W1c,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"),4);this.ia.ra(u.a.e6a,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"),4);this.ia.ra(u.a.vQe,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"),4);this.ia.ra(u.a.iJb,$a.a.application,Object(n.a)(this,this.iJb,"queryAddInCommandsLoadStatus"),96);this.ia.ya(u.a.RYe,
$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"));this.ia.ra(u.a.naa,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"),64);this.ia.ra(u.a.SKb,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"),64);this.ia.ya(u.a.Trc,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"));this.ia.ra(u.a.q8b,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"),64);this.ia.ya(u.a.WMb,$a.a.application,
Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"));this.ia.ya(u.a.V3b,$a.a.application,Object(n.a)(this,this.yza,"triggerCommandforAddinCommands"))}Ee(){}yza(t,S,la,Ca,Na){if(!this.L4)return 16;if(1===la)return S=t===u.a.e6a&&(!this.SP||!this.SP.qrj(Na)),t=t===u.a.e6a&&!!this.SP&&this.SP.Gil(Na),S||t?8:32;if(this.SP)switch(t){case u.a.W1c:this.SP.X1c(Na);break;case u.a.e6a:this.SP.z7b(Na);break;case u.a.iJb:this.SP.Wdh(Na);break;case u.a.RYe:this.SP.Gll();break;case u.a.naa:this.SP.cNk(Na);
break;case u.a.SKb:this.SP.SKb(Na);break;case u.a.vQe:this.SP.nUk();break;case u.a.Trc:this.SP.Trc(Na);break;case u.a.q8b:this.SP.q8b(Na);break;case u.a.WMb:this.SP.WMb(Na);break;case u.a.V3b:this.SP.V3b(Na)}else this.ML.dja(),this.ML.zPa(t,Na);return 32}iJb(t,S,la,Ca,Na){if(!this.L4)return 16;this.SP&&this.SP.Wdh(Na);return 32}}Object(h.a)(Lk,"AddinCommandsActor",null,[365]);var Jm=d(1006),Mk=d(212),vh=d(87),Ij=d(168),nj=d(43),am=d(1029),pn=d(276);class lm{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,
fd,we,Sf,Ff,Gh,gk,vj,mk,sl,On,Pn,bi,Qn,Rn,wn,fl){this.ndc=null;this.stg=!1;this.FWa=null;this.Cyg=Ab.a("PartialDoc.SkipCutCopyCallout");if(!fl)throw Error.argumentNull("calloutNotificationAdapter");this.ia=t;this.gf=S;this.Fa=la;this.pa=Ca;this.wt=Na;this.uE=qb;this.oTg=Pb;this.Q$j=xc;this.Rfk=ed;this.k4c=dd;this.Rb=fd;this.t6c=mk.ndg;this.Pu=we;this.oc=On;this.x6j=mk.powerPointEditorDownloadACopyUiIsEnabled;this.Eek=Sf;this.R4c=Ff;this.Xa=vj;this.LXa=!mk.vg;this.ERg=Pn;this.fUg=Qn;this.eGg=Rn;this.Bw=
wn;this.Owg=!mk.printingEnabled||sl.ka("DisablePrint");this.Pwg=Gh;this.gl=gk;this.W8j=sl.Ga("DownloadPdfFromPodsUrl");this.m_printUrl=sl.Ga("PrintPdfFromPodsUrl");this.V8j=sl.Ga("DownloadOdpFromPodsUrl");this.fxg=sl.Ga("DownloadImagesFromPodsUrl");this.rgk=sl.ka("UseToastForDeferredBlobsEnabled");this.uhk=mk.pptAppendFileNameToQueryUrlForDocumentOperationsActor;t=(v.AFrameworkApplication.fileName||"").toLowerCase();mk.vg&&mk.sNj?(this.stg=!0,this.ndc=sl.Ga("DownloadACopyPodsUrl")):!mk.vg&&mk.wUj&&
(t.endsWith(".pptx")||t.endsWith(".ppsx"))?this.ndc=this.Qkk():this.ndc=v.AFrameworkApplication.zRa;this.iwe=bi;this.mbk=mk.F_c;this.Dwa=A.a.instance.Ja("Common.ISystemInitiatedFeedback");this.Rak=sl.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.NL=fl}wb(){const t=!!this.Pwg&&!this.ERg();P.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.Owg,t);this.Owg?t&&this.gl.Xml(this.Pwg):(this.ia.ya(Va.a.print,$a.a.application,Object(n.a)(this,
this.Wvj,"handlePrint")),this.ia.ya(Va.a.downloadACopy,$a.a.application,Object(n.a)(this,this.downloadACopy,"downloadACopy")),this.ia.ya(Va.a.Y2b,$a.a.application,Object(n.a)(this,this.Y2b,"downloadACopyAsPdf")),this.ia.ya(Va.a.X2b,$a.a.application,Object(n.a)(this,this.X2b,"downloadACopyAsOdp")),this.ia.ya(Va.a.Z2b,$a.a.application,Object(n.a)(this,this.Z2b,"downloadAsImages")),this.ia.ya(Va.a.qUe,$a.a.application,Object(n.a)(this,this.qUe,"saveSlidesAsImages")),this.ia.ya(Va.a.Dmc,$a.a.application,
Object(n.a)(this,this.EJk,"pptoSaveACopy")),this.ia.ya(Va.a.ZLe,$a.a.application,Object(n.a)(this,this.FJk,"pptoSaveAsToHost")),this.ia.ya(Va.a.$Le,$a.a.application,Object(n.a)(this,this.GJk,"pptoSaveToSharePoint")),this.ia.ya(Va.a.OMe,$a.a.application,Object(n.a)(this,this.Yvj,"handlePrintNotes")),this.ia.ya(Va.a.MMe,$a.a.application,Object(n.a)(this,this.Xvj,"handlePrintHandouts")));this.ia.ya(u.a.J_a,$a.a.application,Object(n.a)(this,this.J_a,"saveFileChange"));this.oTg&&this.ia.ra(Va.a.ckd,$a.a.application,
Object(n.a)(this,this.ckd,"querySaveStatus"),96);this.iwe.execute(Object(n.a)(this,this.ukc,"onHostPostmessengerCreated"))}Ee(){const t=this.Fa.Fc(Db.a.ani);t.bindAction(oc.KeyInputManager.Oa(ua.a.Fmb,oc.KeyInputManager.Oe),Va.a.print);t.bindAction(oc.KeyInputManager.Oa(ua.a.HMa,oc.KeyInputManager.Oe),u.a.ve);t.bindAction(oc.KeyInputManager.Oa(ua.a.Twd,oc.KeyInputManager.Oe),u.a.ve);t.bindAction(oc.KeyInputManager.Oa(ua.a.hZ,oc.KeyInputManager.Oe),u.a.ve);t.bindAction(oc.KeyInputManager.Oa(ua.a.hZ,
oc.KeyInputManager.Oe|4),u.a.ve)}FJk(t,S,la){return this.jUe(la,u.a.dLb,"SaveAsToHost")}EJk(t,S,la){return this.jUe(la,u.a.Rpc,"SaveACopy")}GJk(t,S,la){return this.jUe(la,u.a.xjb,"SaveToSharePoint")}jUe(t,S,la){if(1===t)return v.AFrameworkApplication.iG||v.AFrameworkApplication.JQ?8:this.ia.processAction(S,1);if(this.Bw.hasDeferredContent()&&(P.a.J(512500628,843,15,"{0} is triggered while document has deferred content",la),!this.rgk))return this.Bw.UYe(la,null,null),8;this.grb(la);return this.Xa.Pda?
(P.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",S),this.ia.La(Va.a.fLb,2,S)):this.ia.processAction(S,2)}downloadACopy(t,S,la,Ca,Na){if(this.gf.$c(this.wt))return 16;if(1===la)return!this.oc.qj()||v.AFrameworkApplication.JQ?8:lm.gVf()?32:this.xtb();if(this.Bw.hasDeferredContent())return P.a.J(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),this.Cyg&&this.NL.r0d(),this.Bw.UYe("DownloadACopy",new am.a,()=>{this.t3e(Na)}),
this.Bw.wra("DownloadACopyRequestedTime",nj.a.mf(new Date)),8;this.pa.Rh();this.Fa.Ed();P.a.J(512500625,801,50,"PPT save and download a copy");this.Xa.Pda?this.t3e(Na):(this.Pu.show(!0,t),this.uE.C3(!1,this.LXa,()=>{this.t3e(Na)},Object(n.a)(this,this.jya,"saveFailureCallback")));this.grb("DownloadACopy");return 32}t3e(t){this.Pu.hide();let S;S=lm.gVf()?v.AFrameworkApplication.zRa:this.stg?this.Srb(this.ndc):this.ndc;t&&t.FileDownloadUrl&&(S=t.FileDownloadUrl.toString());this.u3j();this.eGg&&!this.eGg()&&
this.fUg&&this.fUg("3555692408")?this.FWa.sendMessage(Qb.a.download,{}):this.x6j?(this.Eek.Enl(S),this.Bw.wra("DownloadModalTime",nj.a.mf(new Date))):this.Rb.rM(!0,S,!0)}u3j(){this.Rak&&this.Dwa&&this.Dwa.execute(t=>{t.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}ckd(t,S,la,Ca,Na){t="";this.oTg&&(t=this.Q$j.aX(this.wt)?String.format(ResourceStrings.L_SavingStatus):this.t6c?String.format(CommonUIStrings.l_SavedToStatus,this.t6c):String.format(ResourceStrings.L_SavedStatus));
Na[qg.a.Value]=t;return 32}Wvj(t,S,la){return this.NMe(la,0,t)}Yvj(t,S,la){return this.NMe(la,8,t)}Xvj(t,S,la){return this.NMe(la,4,t)}NMe(t,S,la){if(this.gf.$c(this.wt))return 16;if(1===t)return!this.oc.qj()||v.AFrameworkApplication.JQ?8:this.xtb();if(this.ERg())return P.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),16;P.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",S);this.pa.Rh();this.Fa.Ed();this.Xa.Pda?this.ooh(S):(this.Pu.show(!0,la),this.uE.C3(!1,this.LXa,
()=>{this.ooh(S)},Object(n.a)(this,this.jya,"saveFailureCallback")));this.grb("Print-"+la);return 32}ooh(t){this.Pu.hide();this.Rfk.print(this.Xa.presentationId.string,this.Srb(this.m_printUrl),t)}Y2b(t,S,la){if(this.gf.$c(this.wt))return 16;if(1===la)return!this.oc.qj()||v.AFrameworkApplication.JQ?8:this.xtb();this.R4c.PQf=new Date;this.pa.Rh();this.Fa.Ed();this.Xa.Pda?this.loh():(this.Pu.show(!0,t),this.uE.C3(!1,this.LXa,()=>{this.loh()},Object(n.a)(this,this.jya,"saveFailureCallback")));this.grb("DownloadACopyAsPDF");
return 32}loh(){this.Pu.hide();this.R4c.toh=new Date;this.k4c.convert(this.Xa.presentationId.string,1,this.Srb(this.W8j))}Z2b(t,S,la){if(this.gf.$c(this.wt))return 16;if(1===la)return!this.oc.qj()||v.AFrameworkApplication.JQ?8:this.xtb();this.pa.Rh();this.Fa.Ed();this.Xa.Pda?this.moh():(this.Pu.show(!0,t),this.uE.C3(!1,this.LXa,()=>{this.moh()},Object(n.a)(this,this.jya,"saveFailureCallback")));this.grb("DownloadAsImages");return 32}qUe(t,S,la){if(this.gf.$c(this.wt))return 16;if(1===la)return!this.oc.qj()||
v.AFrameworkApplication.JQ?8:this.xtb();this.pa.Rh();this.Fa.Ed();this.Xa.Pda?this.OQf():(this.Pu.show(!0,t),this.uE.C3(!1,this.LXa,()=>{this.OQf()},Object(n.a)(this,this.jya,"saveFailureCallback")));this.grb("SaveSlidesAsImages");return 32}moh(){this.Pu.hide();this.k4c.convert(this.Xa.presentationId.string,2,this.Srb(this.fxg))}OQf(){this.Pu.hide();var t=this.Srb(this.fxg),S=this.pa.Qe();0<S.length&&(S=Ij.c(S,la=>la.sid.toString()).join(","),t=new If.QueryStringBuilder(t),t.Xg(vh.a.opl,S),this.k4c.convert(this.Xa.presentationId.string,
2,t.toString()))}X2b(t,S,la){if(this.gf.$c(this.wt))return 16;if(1===la)return!this.oc.qj()||v.AFrameworkApplication.JQ?8:this.xtb();if(this.Bw.hasDeferredContent())return this.Cyg&&this.NL.r0d(),P.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.Bw.UYe("DownloadACopyAsOdp",new am.a,()=>{this.kUe()}),8;this.pa.Rh();this.Fa.Ed();this.Xa.Pda?this.kUe():(this.Pu.show(!0,t),this.uE.C3(!1,this.LXa,()=>{this.kUe()},Object(n.a)(this,this.jya,"saveFailureCallback")));
return 32}jya(){this.Pu.hide();return!1}kUe(){this.Pu.hide();this.k4c.convert(this.Xa.presentationId.string,0,this.Srb(this.V8j))}J_a(t,S,la,Ca,Na){if(this.gf.$c(this.wt))return 16;if(1===la)return 32;this.pa.Rh();this.Fa.Ed();this.uE.C3(!1,!0,qb=>{if(Na&&1<=Na.length)Na[0](qb)},qb=>Na&&2<=Na.length?(Na[1](qb,qb.ServerError.Code),!0):!1);return 32}Qkk(){const t=new If.QueryStringBuilder(db.a.ita("DownloadACopyHandler.ashx"));t.Xg(vh.a.Dhd,this.Xa.presentationId.string);t.Xg(vh.a.Tna,this.Xa.sessionInfo);
t.Xg("fn",v.AFrameworkApplication.fileName);v.AFrameworkApplication.APa(t);return t.toString()}Srb(t){if(t){const S=new If.QueryStringBuilder(t);this.Xa&&this.Xa.podSessionId&&0>t.indexOf(this.Xa.podSessionId)&&(S.sGc(vh.a.iaa+"="+this.Xa.podSessionId),P.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Xa.podSessionId));this.uhk&&v.AFrameworkApplication.St.$w&&0<v.AFrameworkApplication.St.$w.length&&(S.Xg(vh.a.X9g,v.AFrameworkApplication.St.$w),P.a.J(512500619,801,50,"Appended FileName in url"));
this.mbk&&(S.Xg(vh.a.tDk,"true"),P.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));v.AFrameworkApplication.APa(S);return S.toString()}return null}grb(t){const S=Mk.a.I3(pn.a.BZa,!0);P.a.J(509448414,801,15,"DocOperation={0};SimplifiedRibbonON={1}",t,S)}ukc(t){this.FWa=t}xtb(){return v.AFrameworkApplication.iG?8:32}static gVf(){const t=v.AFrameworkApplication.iG,S=!cb.a.Wa(v.AFrameworkApplication.zRa),la=v.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),Ca=v.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");
P.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",t,S,la,Ca);return t&&S&&la&&Ca}}Object(h.a)(lm,"DocumentOperationsActor",null,[365]);class Km{}Km.eg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(h.a)(Km,"EmbedDialogHtml",null,[]);class mm{constructor(t,S,la,Ca){this.VJe=
t;this.X3=S;this.T8g=la;this.value=Ca}}Object(h.a)(mm,"OptionInfo",null,[]);class $k{constructor(t,S,la){this.EUe=t;this.Ayb=S;this.X3=la}}Object(h.a)($k,"SectionInfo",null,[]);var nl=d(289);class Af extends Qd.a{constructor(t,S=!1){super(!1,!1,S);this.ybf=476;this.uyc=288;this.hRh=798;this.FZh=476;this.DZh=288;this.Ehd={};this.P_a=[];this.vP=this.WAa=this.aId=this.hyc=this.mCc=this.Fpb=null;this.hSb=v.AFrameworkApplication.syb;this.PCc=t;this.ZHd=Object(n.a)(this,this.IBk,"optionClickHandler");this.$Hd=
Object(n.a)(this,this.JBk,"optionKeyHandler");this.$xd=Object(n.a)(this,this.fhi,"arrowClickHandler");this.anb=Object(n.a)(this,this.ghi,"arrowKeyHandler");this.ZEc=Object(n.a)(this,this.fwl,"textAreaOnFocusHandler");this.CVh=S;this.eg=Km.eg;this.yd=0;this.ig="EmbedDialog"}get vob(){return this.uyc}set vob(t){this.uyc=t}axh(t){const S={["id"]:this.ig,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:db.a.Ni(this.PCc,"wdPreview","1"),["initialEmbedUrl"]:this.hSb,["getEmbedCode"]:Af.f2f,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const la of Object.keys(t))S[la]=t[la];this.yd=1;this.Xe(1,CommonUIStrings.l_CopyAction);this.Xe(0,CommonUIStrings.l_Close);this.aj(CommonUIStrings.l_Embed,null,S)}Ekb(){if(this.CVh)this.axh({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.Fpb=document.getElementById("embedpreviewpane");
this.mCc=document.getElementById("embedoptionpane");this.Fpb.style.width=String.format("{0}px",this.FZh);this.WAa=document.createElement("iframe");this.WAa.className=Af.CZh;this.WAa.frameBorder="0";this.WAa.style.height=String.format("{0}px",this.DZh);this.WAa.tabIndex=-1;this.Fpb.appendChild(this.qMc(CommonUIStrings.l_Preview,this.WAa,Af.dmf,Af.EZh,Af.dmf,!0));this.vP=document.createElement("textarea");this.vP.className=Af.MRh;Sys.UI.DomElement.addCssClass(this.vP,nl.a.YBa);this.vP.id=Af.NRh;xe.a.Pi||
(this.vP.readOnly=!0);this.vP.rows=4;this.vP.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.vP.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.vP.setAttribute(pa.a.U2,String.format("{0} {1}",Af.xbf,Af.wbf));this.Fpb.appendChild(this.qMc(CommonUIStrings.l_EmbedCode,this.vP,Af.xbf));id.a.addHandler(this.vP,"focus",this.ZEc);var t=document.createElement("span");t.className=Af.MSh;t.innerText=CommonUIStrings.l_CopyText;t.id=Af.wbf;this.Fpb.appendChild(t);this.hyc=document.createElement("div");
this.hyc.className=Af.kRh;this.mCc.appendChild(this.qMc(CommonUIStrings.l_Dimensions,this.hyc));this.aId=document.createElement("div");this.mCc.appendChild(this.DDi(Af.HYh,this.aId));this.yd=0;this.Xe(1,CommonUIStrings.l_Close);this.BHh();this.xIh();xe.a.Pi||this.vP.focus()}}dispose(){if(this.Ehd){var t=this.Ehd;for(let S in t){const la=t[S];this.yn.yb(ha.a.click,la.VJe,this.ZHd);this.Rg.yb(ha.a.Xf,la.VJe,this.$Hd);this.Rg.yb(ha.a.Il,la.VJe,this.$Hd)}this.$Hd=this.ZHd=this.Ehd=null}if(this.P_a){for(t=
0;t<this.P_a.length;++t)this.yn.yb(ha.a.click,this.P_a[t].Ayb,this.$xd),this.Rg.yb(ha.a.Xf,this.P_a[t].Ayb,this.anb),this.Rg.yb(ha.a.my,this.P_a[t].Ayb,this.anb),this.Rg.yb(ha.a.Il,this.P_a[t].Ayb,this.anb);this.Rg=this.$xd=this.P_a=null}this.ZEc&&this.vP&&(id.a.removeHandler(this.vP,"focus",this.ZEc),this.ZEc=null);this.vP=this.WAa=this.aId=this.hyc=this.mCc=this.Fpb=null;super.dispose()}oaa(){super.oaa();this.Hb.style.width=String.format("{0}px",this.hRh);this.mCa()}CHh(t,S){const la=db.a.Ni(this.hSb,
t,S);return this.hSb!==la?(this.hSb=la,this.PCc=db.a.Ni(this.PCc,t,S),!0):!1}BHh(){this.vP&&(this.vP.innerText=Af.f2f(this.hSb,this.ybf,this.uyc))}xIh(){this.WAa&&this.WAa.contentWindow.location.replace(db.a.Ni(this.PCc,"wdPreview","1"))}dFl(t,S){this.CHh(t,S)&&(this.BHh(),this.xIh())}qMc(t,S,la=null,Ca=null,Na=null,qb=!1){const Pb=document.createElement("div");Pb.className=Af.s0h;Ca&&(Pb.id=Ca);Na&&Pb.setAttribute(pa.a.U2,Na);qb&&(Pb.tabIndex=0);Ca=document.createElement("span");Ca.className=Af.t0h;
Ca.innerText=t;la&&(Ca.id=la);Pb.appendChild(Ca);Pb.appendChild(S);return Pb}DDi(t,S){const la=this.qMc(CommonUIStrings.l_Interaction,S),Ca=this.ji.createElement("div");Ca.className=Af.qOh;Ca.id=Af.sOh+t;Ca.setAttribute(pa.a.af,pa.a.Au);Ca.tabIndex=0;la.insertBefore(Ca,S);t=Ba.createClusteredImage(16,16,Af.rOh,Af.tOh,!0,"");Ca.appendChild(t);t=t.childNodes[0];t.className=Ba.getImageClass(Af.abf);t.title=CommonUIStrings.l_Expand;Ca.title=CommonUIStrings.l_Expand;S.style.visibility="hidden";S=new $k(S,
Ca,t);Array.add(this.P_a,S);this.yn.OU(ha.a.click,Ca,this.$xd,S);this.Rg.OU(ha.a.Xf,Ca,this.anb,S);this.Rg.OU(ha.a.my,Ca,this.anb,S);this.Rg.OU(ha.a.Il,Ca,this.anb,S);return la}fhi(t){this.JEf(t);return!0}ghi(t){return this.y1c(t,Object(n.a)(this,this.JEf,"changeArrowState"))}JEf(t){t=t.rD;"visible"===t.EUe.style.visibility?(t.EUe.style.visibility="hidden",t.X3.className=Ba.getImageClass(Af.abf),t.X3.title=CommonUIStrings.l_Expand,t.Ayb.title=CommonUIStrings.l_Expand):(t.EUe.style.visibility="visible",
t.X3.className=Ba.getImageClass(Af.S3h),t.X3.title=CommonUIStrings.l_Collapse,t.Ayb.title=CommonUIStrings.l_Collapse)}IBk(t){this.S8g(t);return!0}JBk(t){return this.y1c(t,Object(n.a)(this,this.S8g,"optionHandler"))}S8g(t){const S=this.Ehd[t.rD.toString()];S.value?(S.value=0,S.X3.className=Ba.getImageClass(Af.D3h),S.T8g.setAttribute(pa.a.Pyf,pa.a.Nia)):(S.value=1,S.X3.className=Ba.getImageClass(Af.xPh),S.T8g.setAttribute(pa.a.Pyf,pa.a.jC));this.dFl(t.rD.toString(),S.value.toString())}fwl(){this.vP.select()}static f2f(t,
S,la){if(!Af.lHd){const Ca=String.format('<a target="_blank" href="{0}">{1}</a>',cb.a.x8b("https://office.com"),CommonUIStrings.l_Office),Na=String.format('<a target="_blank" href="{0}">{1}</a>',cb.a.x8b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Af.lHd=String.format(CommonUIStrings.l_NoFrames,Ca,Na)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',cb.a.x8b(t),S,la,Af.lHd)}}Af.lHd=null;Af.xPh="CheckboxChecked_16x16x32";Af.D3h="CheckboxUnchecked_16x16x32";
Af.S3h="OutlookSearchChevronUp_16x16x32";Af.abf="OutlookSearchChevronDown_16x16x32";Af.rOh="UpArrowServer";Af.s0h="EmbedSectionHeader";Af.t0h="EmbedSectionName UIFontBold";Af.MSh="EmbedCodeFooter";Af.CZh="EmbedPreviewFrame";Af.MRh="EmbedCodeTextArea";Af.kRh="EmbedDimensionSection";Af.tOh="EmbedArrowIcon";Af.qOh="WACGlyph EmbedArrowHolder";Af.NRh="EmbedCode";Af.xbf="EmbedCodeHeader";Af.dmf="Preview";Af.EZh="PreviewHeader";Af.HYh="Options";Af.sOh="Arrow";Af.wbf="EmbedCodeFooter";Object(h.a)(Af,"EmbedDialog",
Qd.a,[]);class yl extends Af{constructor(t,S){super(t,!0);S&&S&&!isNaN(S)||P.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.CHh(vh.a.kDk,S.toString())}Ekb(){const t=[];t.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:yl.pSk});this.axh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.ybf,["defaultHeight"]:this.uyc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,
["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:t})}static pSk(t,S,la){return"wdEaaCheck"===S?db.a.Ni(t,S,la?"1":"0"):t}}Object(h.a)(yl,"ReactEmbedDialog",Af,[]);class oj{constructor(t,S,la,Ca,Na){this.kGa=null;this.Ete=!1;this.FWa=null;this.Rb=t;this.Qve=S;this.wdc=la;this.iwe=Ca;this.Xa=Na}Ekb(t,S,la){(t=(t=v.AFrameworkApplication.BM)||this.Xa.Pda)||this.Ete||(t=!this.tEh());return 1===la?t?2:32:this.pml()}pml(){if(!this.Ete)return 8;if(v.AFrameworkApplication.syb&&this.wdc)this.owh();
else{const t=v.AFrameworkApplication.f6e?this.FWa.sendMessage(Qb.a.ZXi,null)?32:8:2;return 32!==t?this.Rb.rM(!0,v.AFrameworkApplication.J3d):t}return 32}oml(t){t.Values.HostEmbeddedViewUrl&&(this.wdc=v.AFrameworkApplication.syb=t.Values.HostEmbeddedViewUrl.toString(),this.owh())}tEh(){return!1}z6h(t,S){this.kGa=S;this.Ete=!!this.Rb&&!!this.Qve&&!(void 0===this.wdc||null===this.wdc)&&!!t&&!!S}owh(){(new yl(this.wdc,this.kGa)).Ekb()}}Object(h.a)(oj,"EmbedManager",null,[]);class zl{constructor(t,S,la){this.kGa=
null;this.c$j={};for(S=0;S<t.length;S++)this.c$j[t[S].Format.toString()]=S;this.kGa=la&&!isNaN(la)&&isFinite(la)?la:0}}Object(h.a)(zl,"FormatPicker",null,[]);class Bm extends oj{constructor(t,S,la,Ca,Na,qb,Pb,xc){super(t,S,la,qb,Pb,xc);this.ia=Ca;this.Tb=Na}wb(){this.ia.ya(Va.a.Ekb,$a.a.application,Object(n.a)(this,this.Ekb,"showEmbedDialog"));this.iwe.execute(Object(n.a)(this,this.ukc,"onHostPostmessengerCreated"))}Ee(){}tEh(){var t=this.Tb.Hu();if(!this.Qve||!t.height)return!1;t=t.width/t.height;
const S=new zl(this.Qve,!1,t);this.z6h(S,t);return!0}ukc(t){this.FWa=t;v.AFrameworkApplication.isEmbedded||v.AFrameworkApplication.syb||!this.FWa||(this.FWa.yu(Qb.a.IDf),this.FWa.KB(Qb.a.IDf,Object(n.a)(this,this.oml,"showEmbedDialogPostMessage")))}}Object(h.a)(Bm,"EmbedActor",oj,[365]);var va=d(41),Ki=d(736),Jj=d(688);class al{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we){this.ia=t;this.Feb=S?S.xa:null;this.ua=la;this.fc=Ca;this.ob=Na;this.Ou=qb;this.Jb=Pb;this.Sk=xc;this.Sd=ed;this.EBb=null;this.Fa=
dd;this.wt=la.presentation;this.Fe=fd;this.Pf=null;this.neb=we}wb(){this.ia.ra(Va.a.Nwh,va.a.application,Object(n.a)(this,this.ryj,"handleUploadAudioDialog"),4)}Ee(){}ryj(t,S,la){const Ca=this.ua.Ba;if(!Ca||this.fc.$c(Ca))return 16;if(1===la)return 32;if(this.Feb){this.Pf=nj.a.zk("Audio::Insert");try{return Jj.a.OZe("audio/*",Ki.e,()=>Ki.d(t,Object(n.a)(this,this.AHj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Fe,Ca),"audio",Ca,this.ua.presentation,this.fc,this.Sd,this.Pf,!1,this.neb,
50,10,3),this.Pf&&this.Pf.Va("AudioDialogInitialized","true"),32}catch(Na){P.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return P.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(t,S){this.Pf&&(this.Pf.finish(),this.Pf=null);this.Sd.cH(t,la=>{la.mC=1;la.$Ra=S;return!1})}AHj(t,S,la,Ca,Na,qb,Pb){Ca.YN(la)&&P.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+la.lja);Ca.hK(la);Na&&Na.Va("AudioUploadToRC","true");Object(Ab.a)("FixForInsertMediaSlideNavigationIssue")||(Pb=this.ua.Ba);la=Pb.Wt();var xc=this.wt.slideWidth,ed=this.wt.slideHeight;Ca=Gc.a.qf(32,0);const dd=Gc.a.qf(32,1);xc=xc/2-Gc.a.qf(16,0);ed=ed/2-Gc.a.qf(16,1);if(Pb&&Pb.isConnected){var fd=this.Jb.Ad(15,void 0,void 0,()=>{this.Ou.SF=this.EBb;this.ob.selectShape(this.EBb,!0);this.Fa.Ed()});try{fd.nc(Pb);fd.jd=t;Na&&Na.Va("CreatingAudioShape","true");this.EBb=this.Sk.aRa(!1,Pb.Cb.cid,
Pb.Cb.sid,0,10,xc,ed,Ca,dd,la+1);const we=qb.files[0].name;this.EBb.LZb=S;this.EBb.JZb=we;Pb.gC(this.EBb)}finally{fd&&fd.dispose()}Na&&(Na.Va("AudioShapeSuccessfullyCreated","true"),Na.finish(),Na=null)}}}Object(h.a)(al,"InsertAudioActor",null,[365]);class gh{constructor(){this.Fyb=this.Jrb=null}}Object(h.a)(gh,"CreatePickerCustomizationDictionaryOptions",null,[1570]);var Nk=d(165),Pd=d(29);class bl{}bl.eg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(h.a)(bl,"InsertMediaDialogHtml",null,[]);class Lm{}Lm.eg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(h.a)(Lm,"InsertMediaM365DialogHtml",null,[]);var fj=d(393);class Ai{static get eg(){return Qd.a.VA(Ai.En,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}Ai.En="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(h.a)(Ai,"InsertOnlineVideoDialogHtml",null,[]);class dg extends Qd.a{constructor(t){super();this.jD(1,!0);this.Xe(1,ResourceStrings.L_Insert);this.eg=Ai.eg;this.a$=t;this.KV=!1}j6(){this.width=50;this.aj(ResourceStrings.L_OnlineVideo,Object(n.a)(this,this.UHj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(pa.a.hSd,pa.a.Vgi);const t=document.getElementById("url");this.jD(1,!!t&&0<t.value.length);
id.a.addHandler(t,ha.a.input,Object(n.a)(this,this.mgd,"onPatternChanged"));id.a.addHandler(t,ha.a.change,Object(n.a)(this,this.mgd,"onPatternChanged"));this.KR(t)}hide(){const t=document.getElementById("url");t&&(id.a.removeHandler(t,ha.a.input,Object(n.a)(this,this.mgd,"onPatternChanged")),id.a.removeHandler(t,ha.a.change,Object(n.a)(this,this.mgd,"onPatternChanged")));super.hide()}UHj(t,S){if(1===t){if(S){var la=nj.a.zk("InsertOnlineVideo",1);la.Ur=!0;t=S.url.trim();(t=this.a$.cWi(t))?this.a$.Iog(t)&&
this.a$.JYj(t)?(P.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.a$.Y1f(t)),this.a$.requestVideoData(t,Ca=>{nj.a.AF(la,()=>{this.XY(Ca)})},Object(n.a)(this,this.fXi,"failCallback"))):(P.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.a$.Y1f(t)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(P.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}XY(t){this.hide();
this.a$.agg(t)}fXi(t){this.fail(t,ResourceStrings.l_CannotInsertOnlineVideo)}fail(t,S){if(document.getElementById("labelmessage")){var la=+new Date-+this.a$.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=S;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();t&&P.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:la,["ResponseCode"]:t.data.ie}))}else P.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}mgd(){nj.a.QFa();const t=document.getElementById("url");this.jD(1,!!t&&0<t.value.length)}}Object(h.a)(dg,"InsertOnlineVideoDialog",Qd.a,[983]);class Mm{static get eg(){return Qd.a.VA(Mm.En,ResourceStrings.l_InsertCameoExpDialogContent,ResourceStrings.L_LearnMore,"https://aka.ms/pptocameoblog")}}Mm.En="<div class='CameoExperimentTextDiv' id='cameoexperimenttextdiv'> <label id='cameoexperimenttext' class='WACDialogLabel' >{0}</label> </div> <div class='cameoexperimentlearnmorediv' id='CameoExperimentLearnMoreDiv'> <a id='cameoexperimentlearnmore' class='CameoExperimentLearnMore' href={2} target='newtab' >{1}</a> </div>";
Object(h.a)(Mm,"InsertCameoDialogHtml",null,[]);class nc extends Qd.a{constructor(){super();this.jD(1,!0);this.eg=Mm.eg;this.yd=0}j6(){this.width=50;this.aj(ResourceStrings.l_InsertCameoExpDialogTitle);const t=document.getElementById("cameoexperimentlearnmore");t&&(t.onclick=()=>P.a.J(520119896,352,50,"InsertCameoDialog::showAndFocus : Click on learn more of insert cameo"))}}Object(h.a)(nc,"InsertCameoDialog",Qd.a,[982]);var nm=d(1101),Rc=d(61);class pf{constructor(t,S,la){this.BTb=Wf.a.d8;this.uG=
null;this.Ca=t;this.CTb=S;this.wBa=la}get An(){return this.Ca}get a8(){return this.uG||(this.uG=A.a.instance.resolve("Common.Utils.IAriaNotifier"))}get hy(){return this.BTb}set hy(t){this.BTb=t}aua(t){try{r.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",t.length);const S=this.CTb.kKk(t);let la=2;if(S&&0<S.length){const Ca=new nm.DictionaryPropertySet;Ca.setValue(Rc.a.JU,S);Ca.setValue(Rc.a.e_c,!0);if(this.wBa){const Na=this.wBa.S_e();Na.THc("insertOnlineImage");
Ca.setValue(Rc.a.EQa,Na)}v.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.a8.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);la=this.Ca.La(this.hy,2,Ca)}r.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",t.length,32===la,""===S)}catch(S){r.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",S.toString())}}}
Object(h.a)(pf,"InsertOnlineImageHandler",null,[798]);class jk extends pf{constructor(t,S,la=null){super(t,S,la)}get mMf(){return Qb.a.insertImage}get ryb(){return Qb.a.NHj}j$g(t){return this.CTb.pEk(t)}D6f(t){return t.Type}LZc(t,S){return this.CTb.LZc(t.Type,S)}k$g(t){const S=[];if(t&&t.data&&t.data.value&&0<t.data.value.length)for(let Ca=0;Ca<t.data.value.length;Ca++)if(t.data.value[Ca]&&t.data.value[Ca].urls&&t.data.value[Ca].urls.download){var la=t.data.value[Ca];la=Object.assign(new Qj.a,{OriginalUrl:la.urls.download,
Type:la.extension||"",Caption:la.name,ContentType:"",Height:la.driveItem||la.driveItem.image?la.driveItem.image.height:0,Width:la.driveItem||la.driveItem.image?la.driveItem.image.width:0});Array.add(S,la)}S.length||r.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return S}odh(t,S,la){la=la(t);if(la.length){t=[];for(let Ca=0;Ca<la.length;Ca++){const Na=la[Ca],qb={};qb.Extension=Na.Type;qb.SourceUrl=Na.OriginalUrl;qb.SourceUrl=
Na.OriginalUrl;qb.Width=Na.Width;qb.Height=Na.Height;Array.add(t,qb)}la={};la.Items=t;S.sendMessage(this.ryb,la)}}}Object(h.a)(jk,"InsertOnlineImageHelperBox4",pf,[797,798]);class hg extends jk{constructor(t,S,la){super(t,S);this.HDe=la.insertOnlineVideoUrlPatterns;this.hy=Va.a.qfe}aua(t){if(t&&0<t.length){var S=db.a.YD(t[0].OriginalUrl);S=this.Ome(S)?S:"unsupported";P.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",S);this.An.La(this.hy,2,t[0])}}Ome(t){if(!t)return!1;
t=t.trim();for(const S of this.HDe)if((new RegExp(S)).test(t))return!0;return!1}}Object(h.a)(hg,"InsertOnlineVideoHelper",jk,[]);class qh{static get eg(){return Qd.a.VA(qh.En,ResourceStrings.l_InsertSocialMediaDialogMsg)}}qh.En="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(h.a)(qh,"InsertSocailMediaDialogHtml",null,[]);var Cj=
d(86),mf=d(248);class L extends Sys.EventArgs{constructor(t,S,la,Ca){super();this.slideId=t;this.WY=la;this.shapeId=S;this.LEa=Ca}}Object(h.a)(L,"IconChangedEventArgs",Sys.EventArgs,[]);var Cn=d(495),oi=d(261);class pj{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff,Gh,gk,vj,mk,sl,On,Pn,bi,Qn,Rn,wn,fl,Il,qf,Vl){this.b8c=this.JZc=!1;this.wFb=this.Nye=null;this.Nya=(Em,wj,yr)=>{if(!this.i6(this.ua.Ba,Em,this.la.rab))return 8;if(1===yr)return 32;let vo,Wl;this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",
!1)?Wl="dallecore":this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&(Wl="dalle");switch(Em){case Va.a.g9b:case Va.a.TXc:wj=new If.QueryStringBuilder(this.la.Tfg);wj.Xg("entryPoint",Va.a.mw(Em));Wl&&wj.Xg(Wl,"1");vo=1;this.Jea.hy=Va.a.UXc;break;case Va.a.ife:case Va.a.jfe:wj=new If.QueryStringBuilder(this.la.Tfg);wj.Ty("initpivot","dalle");wj.Xg("entryPoint",Va.a.mw(Em));Wl&&wj.Xg(Wl,"1");vo=1;this.Jea.hy=Va.a.UXc;break;case Va.a.NXc:wj=new If.QueryStringBuilder(this.la.SXc);
vo=1;this.Jea.hy=Va.a.RXc;break;case Va.a.a7a:Ab.a("ChangePictureFromIconsFixEnabled")?(wj=new If.QueryStringBuilder(this.la.SXc),this.Kla.hy=Va.a.N_b):(wj=new If.QueryStringBuilder(this.la.Iri),this.Kla.hy=Va.a.MJc);vo=0;break;case Va.a.rtb:wj=new If.QueryStringBuilder(this.la.MEf);wj.Xg("entryPoint",Va.a.mw(Em));Wl&&wj.Xg(Wl,"1");vo=0;this.Kla.hy=Va.a.N_b;break;case Va.a.OJc:wj=new If.QueryStringBuilder(this.la.MEf);wj.Ty("initpivot","dalle");wj.Xg("entryPoint",Va.a.mw(Em));Wl&&wj.Xg(Wl,"1");vo=
0;this.Kla.hy=Va.a.N_b;break;default:return P.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",Em.toString()),16}this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",!1)&&(wj.Xg("gae","1"),v.AFrameworkApplication.Ibc("0fecb342;2aaje503"));const zr=wj.toString();if(!zr||!zr.length)return 16;P.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const tm=Kc.a.create(),iq=cb.a.sN(this.la.pptEditingUserId).toString();
this.kcb.execute(Mi=>{var cg=this.la.THj&&Mi.isFreemiumUpsellEnabled();cg=this.b8c?1:cg?0:-1;var jq=this.Qb.ka("InsertOnlineM365ExperimentEnabled")?1:0;jq=this.I4.Bli(Pd.App.mode,zr,cg,vo,tm.toString(),iq,jq);Mi=this.F6c.getInstance(jq,this.E6c,this.I4,Mi,Lm.eg);Mi.correlationId=tm;Mi.w5=2;Mi.d0d=cg;Mi.aNb(CommonUIStrings.L_PictureInsertTitle,Em===Va.a.a7a||Em===Va.a.rtb?this.Kla:this.Jea);P.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(tm){return P.a.J(512517952,
352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",tm.toString()),pj.Ft(Cj.a.e5b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}};this.la=t;this.ia=S;this.fc=la;this.pa=Ca;this.Fa=Na;this.ua=qb;this.Jb=Pb;this.F6c=xc;this.uak=ed;this.E6c=dd;this.I4=fd;this.kcb=we;this.Jea=Sf;this.Kla=Ff;this.Tb=Gh;this.Sk=gk;this.Ea=vj;this.Fb=mk;this.Ou=sl;this.Zj=On;this.xeb=Pn;this.MWa=wn;this.oye=fl;this.Lc=Il;this.fU=t.OIb;this.Qb=Vl;this.xeb&&(this.xeb.S8a.removeAttribute("style"),
this.xeb.S8a.style.display="none");this.Oze=bi;this.vak=Qn;this.a$=Rn;this.q4=qf;this.kcb.execute(Em=>{Em.isFeatureEnabled("MsoPremiumStockImages",!1).catch(wj=>P.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",wj)).then(wj=>{this.b8c=wj;this.b8c||(this.Nye=Em.Gib("MsoPremiumStockImages",()=>{this.b8c=!0;P.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null})})}wb(){this.l7h();this.ia.ra(Va.a.RXc,
va.a.application,Object(n.a)(this,this.uIl,"uploadIcon"),4);Ab.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(Va.a.MJc,va.a.application,Object(n.a)(this,this.Qri,"changeToIcon"),4):this.ia.ra(Va.a.MJc,va.a.application,Object(n.a)(this,this.Rri,"changeToIcon"),4);this.ia.ra(Va.a.sab,va.a.application,Object(n.a)(this,this.Gvd,"uploadOnlinePicture"),4);Ab.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(Va.a.R_b,va.a.application,Object(n.a)(this,this.PJc,"changeToOnlinePicture"),4):this.ia.ra(Va.a.R_b,
va.a.application,Object(n.a)(this,this.QJc,"changeToOnlinePicture"),4);this.ia.ra(Va.a.UXc,va.a.application,Object(n.a)(this,this.Gvd,"uploadOnlinePicture"),4);Ab.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(Va.a.N_b,va.a.application,Object(n.a)(this,this.PJc,"changeToOnlinePicture"),4):this.ia.ra(Va.a.N_b,va.a.application,Object(n.a)(this,this.QJc,"changeToOnlinePicture"),4);this.ia.ra(Va.a.VXc,va.a.application,Object(n.a)(this,this.Gvd,"uploadOnlinePicture"),4);Ab.a("ChangePictureOnMultiSelectFixEnabled")?
this.ia.ra(Va.a.O_b,va.a.application,Object(n.a)(this,this.PJc,"changeToOnlinePicture"),4):this.ia.ra(Va.a.O_b,va.a.application,Object(n.a)(this,this.QJc,"changeToOnlinePicture"),4);this.k7h();this.ia.ra(Va.a.Rfg,va.a.application,Object(n.a)(this,this.Gvd,"uploadOnlinePicture"),4);Ab.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(Va.a.eVd,va.a.application,Object(n.a)(this,this.PJc,"changeToOnlinePicture"),4):this.ia.ra(Va.a.eVd,va.a.application,Object(n.a)(this,this.QJc,"changeToOnlinePicture"),
4);this.m7h();this.j7h();this.ia.ra(Va.a.qfe,va.a.application,Object(n.a)(this,this.xIl,"uploadOnlineVideo"),4);this.ia.ra(Va.a.pfe,va.a.application,Object(n.a)(this,this.wIl,"uploadOnlineHubbleVideo"),4);this.ia.ra(Va.a.pnc,$a.a.application,Object(n.a)(this,this.fFl,"updateEntryPoints"),96)}l7h(){this.ia.ra(Va.a.NXc,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),4);this.ia.ra(Va.a.a7a,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),4);this.ia.ra(Va.a.insertOnlinePicture,
va.a.application,Object(n.a)(this,this.lZe,"showInsertPictureDialog"),4);this.ia.ra(Va.a.P_b,va.a.application,Object(n.a)(this,this.lZe,"showInsertPictureDialog"),4);Ab.a("InsertSocialMediaVideoIcon")&&this.ia.ra(Va.a.Zfg,va.a.application,Object(n.a)(this,this.cnl,"showInsertSocialMediaDialog"),4);Ab.a("InsertDalleIcon")&&(this.ia.ra(Va.a.ife,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),4),this.ia.ra(Va.a.jfe,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),
4));this.ia.ra(Va.a.g9b,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),4);this.ia.ra(Va.a.rtb,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),4);Ab.a("ChangePictureCreateWithAI")&&this.ia.ra(Va.a.OJc,va.a.application,this.Nya,4);this.ia.ra(Va.a.TXc,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),4);this.ia.ra(Va.a.Qyb,va.a.application,Object(n.a)(this,this.mZe,"showInsertPictureFromHostDialog"),4);this.ia.ra(Va.a.Q_b,
va.a.application,Object(n.a)(this,this.mZe,"showInsertPictureFromHostDialog"),4);this.la.ocpsIsEnabled&&(this.ia.Mib("ppt_insertOnlinePictures",Va.a.insertOnlinePicture,va.a.application,Object(n.a)(this,this.lZe,"showInsertPictureDialog"),t=>{Pd.App.Kb.G1a(t,Object(n.a)(this.q4,this.q4.XDa,"getCommandById"))}),this.ia.Mib("ppt_insertOnlinePictures",Va.a.g9b,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),t=>{Pd.App.Kb.G1a(t,Object(n.a)(this.q4,this.q4.XDa,"getCommandById"))}),
this.ia.Mib("ppt_insertOnlinePictures",Va.a.TXc,va.a.application,Object(n.a)(this,this.Nya,"showInsertMediaDialogFromM365"),t=>{Pd.App.Kb.G1a(t,Object(n.a)(this.q4,this.q4.XDa,"getCommandById"))}),this.ia.Mib("ppt_insertOnlinePictures",Va.a.Qyb,va.a.application,Object(n.a)(this,this.mZe,"showInsertPictureFromHostDialog"),t=>{Pd.App.Kb.G1a(t,Object(n.a)(this.q4,this.q4.XDa,"getCommandById"))}))}k7h(){this.la.ZXc&&this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)&&(this.ia.ra(Va.a.YXc,va.a.application,Object(n.a)(this,this.mrd,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.ra(Va.a.S_b,va.a.application,Object(n.a)(this,this.mrd,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.Mib("mso_insertMobileDevicePictures",Va.a.YXc,va.a.application,Object(n.a)(this,this.mrd,"showInsertPictureFromMobileDeviceDialog"),t=>{Pd.App.Kb.G1a(t,Object(n.a)(this.q4,this.q4.XDa,"getCommandById"))}),this.ia.Mib("mso_insertMobileDevicePictures",
Va.a.S_b,va.a.application,Object(n.a)(this,this.mrd,"showInsertPictureFromMobileDeviceDialog"),t=>{Pd.App.Kb.G1a(t,Object(n.a)(this.q4,this.q4.XDa,"getCommandById"))})))}m7h(){this.ia.ra(Va.a.dua,va.a.application,Object(n.a)(this,this.bNb,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.Mib("ppt_insertOnlineVideos",Va.a.dua,va.a.application,Object(n.a)(this,this.bNb,"showInsertVideoDialog"),t=>{Pd.App.Kb.G1a(t,Object(n.a)(this.q4,this.q4.XDa,"getCommandById"))})}j7h(){oi.a(this.Qb.appSettings,
"InsertCameoExperimentEnabled",!1)&&this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCameoExperimentEnabled",!1)&&this.ia.ra(Va.a.Qfg,va.a.application,this.anl.bind(this),4)}mKk(){v.AFrameworkApplication.n$b()&&v.AFrameworkApplication.Tvh()&&(v.AFrameworkApplication.Aa.get_element().appendChild(this.xeb.S8a),id.a.addHandler(this.xeb.S8a.contentWindow,"message",Object(n.a)(this,this.Wwh,"showOneDriveFilePickerDialog")),this.JZc=!0)}Wwh(t){if(t.rawEvent&&(t=t.rawEvent.data))try{P.a.J(512517961,
352,50,"User select images.");const S=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0),la=S.MessageId?S.MessageId.toString():null;S&&la&&(la===Qb.a.insertImage||la===Qb.a.nfe)&&this.Oze.start(la===Qb.a.insertImage?this.Jea:this.vak)}catch(S){P.a.J(512517960,352,10,"malformatted postmessage here.")}}Ee(){}fFl(){return 32}lZe(t,S,la){if(!this.i6(this.ua.Ba,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;P.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");
try{const Ca=Kc.a.create(),Na=cb.a.sN(this.la.pptEditingUserId).toString(),qb=t===Va.a.insertOnlinePicture&&this.la.TIk?1:0;let Pb=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,Uh.a.xe(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Ca.toString(),3,Na,qb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net","gi"))&&(Pb=this.I4.Cli(Pd.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:
this.la.insertPictureServiceEndpoint));this.kcb.execute(xc=>{xc=this.F6c.getInstance(Pb,this.E6c,this.I4,xc,bl.eg);xc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;xc.correlationId=Ca;xc.w5=1;switch(t){case Va.a.P_b:this.Kla.hy=Va.a.R_b;break;default:this.Jea.hy=Va.a.sab}xc.aNb(CommonUIStrings.L_PictureInsertTitle,t===Va.a.insertOnlinePicture?this.Jea:this.Kla);P.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Ca){return P.a.J(512517957,
352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",Ca.toString()),pj.Ft(Cj.a.e5b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}cnl(t,S,la){if(1===la)return 32;t=new Qd.a(void 0,void 0,!1);t.yd=5;t.eg=qh.eg;t.aj(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});P.a.J(512517956,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}mZe(t,S,la){if(!this.i6(this.ua.Ba,t,v.AFrameworkApplication.n$b()&&
(pj.Wbg?!!this.Oze.LHb&&9<this.Oze.LHb.length:!0)))return 8;if(1===la)return 32;P.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{S=!0;let Ca=0;if(this.Qb.ka("InsertMediaSharedFilePickerEnabled")){const qb=A.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(qb.rme()){S=!1;const Pb=this.la.Wfg;la=!1;this.la.ZXc&&(la=this.G3i());const xc=Object.assign(new gh,{Jrb:la,Fyb:!0}),ed=qb.sYd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,
!0,!1,!0,Pb,"InsertPicture",0,xc);qb.D7d(ed).then(dd=>{if(dd&&0<dd.length){const fd=[];for(let we=0;we<dd.length;we++){const Sf=dd[we][fb.a.kLe],Ff={};Ff.Extension=dd[we][fb.a.uah];Ff.OriginalUrl=fb.a.fLe in dd[we]?dd[we][fb.a.fLe]:Sf;Ff.Type=fb.a.gLe in dd[we]?dd[we][fb.a.gLe]:"";Ff.Caption=fb.a.jLe in dd[we]?dd[we][fb.a.jLe]:"";Ff.Description=fb.a.eLe in dd[we]?dd[we][fb.a.eLe]:"";Ff.Width=fb.a.iLe in dd[we]?dd[we][fb.a.iLe]:0;Ff.Height=fb.a.hLe in dd[we]?dd[we][fb.a.hLe]:0;Array.add(fd,Ff)}this.Vbj(t).aua(fd);
P.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Ca=32}).catch(dd=>{P.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",dd.toString());pj.Ft(Cj.a.e5b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);Ca=8})}}if(!S)return Ca;pj.Wbg=!0;this.JZc||this.mKk();const Na=this.uak.getInstance();Na.w5=4;switch(t){case Va.a.Q_b:this.Kla.hy=Va.a.O_b;break;default:this.Jea.hy=
Va.a.VXc}Na.aNb(CommonUIStrings.L_PictureInsertTitle,t===Va.a.Qyb?this.Jea:this.Kla);P.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(Ca){return P.a.J(512517919,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Ca.toString()),pj.Ft(Cj.a.e5b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}Vbj(t){if(!Ab.a("ChangePictureFromOneDriveFixEnabled"))return this.Jea;const S=(t=
t===Va.a.Qyb)?this.Jea:this.Kla;S.hy=t?Va.a.VXc:Va.a.O_b;return S}G3i(){return A.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").G5i()}mrd(t,S,la){if(!this.i6(this.ua.Ba,t,this.la.ZXc&&this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)))return 8;if(1===la)return 32;A.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").PXi(this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));
try{let Ca=0;const Na=A.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Na.rme()){const qb=t===Va.a.YXc,Pb=this.la.Wfg,xc=Object.assign(new gh,{Jrb:!0,Fyb:!0}),ed=Na.sYd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,qb,Pb,"InsertPictureFromMobile",3,xc);Na.D7d(ed).then(dd=>{if(dd&&0<dd.length){const fd=[];let we=!1;const Sf=this.Qb.Ga("PhoneLinkServiceEndpoint");for(let Ff=0;Ff<dd.length;Ff++){const Gh=dd[Ff][fb.a.kLe],gk=dd[Ff],vj={};vj.Extension=
dd[Ff][fb.a.uah];vj.OriginalUrl=this.YJb(gk,fb.a.fLe,Gh);vj.Type=this.YJb(gk,fb.a.gLe,"");vj.Caption=this.YJb(gk,fb.a.jLe,"");vj.Description=this.YJb(gk,fb.a.eLe,"");vj.Width=this.YJb(gk,fb.a.iLe,0);vj.Height=this.YJb(gk,fb.a.hLe,0);Array.add(fd,vj);we||(we=-1!==vj.OriginalUrl.indexOf(Sf))}dd=qb?this.Jea:this.Kla;dd.hy=we?qb?Va.a.Rfg:Va.a.eVd:qb?Va.a.VXc:Va.a.O_b;dd.aua(fd);P.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Ca=
32}).catch(dd=>{P.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",dd.toString());Ca=8})}return Ca}catch(Ca){return P.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Ca.toString()),8}}YJb(t,S,la){return S in t?t[S]:la}Gvd(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.i6(S,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;if(!this.Zj.OF(S,
1))return this.Zj.mG(S),16;try{const qb=S.G3(this.pa.Xd());if(qb&&this.fc.$c(qb))return 16;const Pb=this.l$a(S,qb);let xc=null;const ed=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()},()=>{this.pa.selectShape(Pb,!0);xc&&this.pa.selectShape(xc,!1)});try{ed.nc(S);ed.jd=Va.a.insertOnlinePicture;ed.Zy[mf.a.rDa]=mf.a.online;la=null;t={["actionId"]:t};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(Na.LicenseUrl&&Na.LicenseDisplayName){const dd=pj.vMe(Na);la=Nk.c(dd);if(this.la.pptImageAttributionSelectionImprove){const fd=
S.Cb;xc=this.Sk.nsa(!0,fd.cid,fd.sid,0,0,0,Zb.a.hY,Zb.a.y5,S.Wt()+1,!1)}}else t["result.LicenseDisplayName"]=Na.LicenseDisplayName,t["result.LicenseUrl"]=cb.a.sN(Na.LicenseUrl);else t.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;P.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",t);Pb.fMb(Na.OriginalUrl,Na.LicenseUrl?null:Na.Caption,la,Na.PageUrl);qb&&S.PU([qb]);S.gC(Pb);xc&&(S.gC(xc),Pb.D6a=xc.id,xc.cab=!0)}finally{ed&&ed.dispose()}this.Ou.SF=Pb;return 32}catch(qb){return P.a.J(512517913,
352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",qb.toString()),8}}QJc(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.i6(S,t,this.la.UJa))return 8;if(1===la)return 32;P.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Na)return 16;try{const qb=this.J9a()||this.fTc();if(!qb||this.fc.$c(qb))return 16;let Pb=null;const xc=this.Jb.Ad(15,void 0,void 0,()=>{this.pa.selectShape(qb,!0);Pb&&
this.pa.selectShape(Pb,!1);P.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{xc.nc(S);xc.jd=Va.a.R_b;xc.Zy[mf.a.rDa]=mf.a.online;t=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Na.LicenseUrl&&Na.LicenseDisplayName){const ed=pj.vMe(Na);t=Nk.c(ed);if(this.la.pptImageAttributionSelectionImprove){const dd=S.Cb;Pb=this.Sk.nsa(!0,dd.cid,dd.sid,0,0,0,Zb.a.hY,Zb.a.y5,S.Wt()+1,!1);P.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}qb.fMb(Na.OriginalUrl,
Na.LicenseUrl?null:Na.Caption,t,Na.PageUrl);qb.set_isSVGBlipFilled(!1);Pb&&(S.gC(Pb),qb.D6a=Pb.id,Pb.cab=!0)}finally{xc&&xc.dispose()}this.Ou.SF=qb;return 32}catch(qb){return P.a.J(512517905,352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",qb.toString()),8}}PJc(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.i6(S,t,this.la.UJa))return 8;if(1===la)return 32;P.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");
if(!Na)return 16;try{var qb=this.pa.Xd();t=[];for(var Pb of qb)Pb.If||t.push(Pb);for(const ed of t)if(!ed||this.fc.$c(ed))return 16;qb=null;const xc=this.Jb.Ad(15,void 0,void 0);try{xc.nc(S);xc.jd=Va.a.R_b;xc.Zy[mf.a.rDa]=mf.a.online;Pb=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Na.LicenseUrl&&Na.LicenseDisplayName){const dd=pj.vMe(Na);Pb=Nk.c(dd);if(this.la.pptImageAttributionSelectionImprove){const fd=S.Cb;qb=this.Sk.nsa(!0,fd.cid,fd.sid,0,0,0,Zb.a.hY,Zb.a.y5,S.Wt()+1,!1);P.a.J(512517906,
352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const ed=Na.LicenseUrl?null:Na.Caption;for(const dd of t)dd.fMb(Na.OriginalUrl,ed,Pb,Na.PageUrl),dd.set_isSVGBlipFilled(!1),qb&&(S.gC(qb),dd.D6a=qb.id,qb.cab=!0)}finally{xc&&xc.dispose()}this.Ou.SF=t[0];return 32}catch(xc){return P.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",xc.toString()),8}}uIl(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517903,352,50,"Active Slide is null"),
8;if(!this.i6(S,t,this.la.rab))return 8;if(1===la)return 32;P.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Na||!Na.length)return 16;if(!this.Zj.OF(S,Na.length))return this.Zj.mG(S),16;try{let qb=null;la=null;if(!({pGk:la,fGk:qb}=this.Egj(Na,S)).returnValue)return 16;const Pb=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()},()=>{this.pa.R_a(qb,!0)});try{for(Pb.nc(S),Pb.jd=t,Pb.Zy[mf.a.rDa]=mf.a.icon,la&&S.PU(la),t=0;t<qb.length;t++)S.gC(qb[t])}finally{Pb&&
Pb.dispose()}this.Ou.SF=qb[qb.length-1];return 32}catch(qb){return P.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",Na.length,qb.toString()),8}}Egj(t,S){let la,Ca;la=Array(t.length);Ca=Array(t.length);var Na=S.j6d(this.pa.Xd());if(Na&&0<Na.length){var qb=0;for(const Pb of Na)if(Pb&&!this.fc.$c(Pb)&&qb<t.length&&(la[qb]=Pb,qb++,qb===t.length))break}Na=!0;for(qb=0;qb<la.length;qb++)this.la.svgIconLocalEditingIsEnabled&&t[qb].SvgContent&&0<t[qb].SvgContent.length&&
(!la[qb]||la[qb]&&15!==la[qb].Jj)?Ca[qb]=this.Cgj(S,la[qb],t[qb],qb):(Ca[qb]=this.l7f(S,la[qb],t[qb],!0,qb),Na=!1),Na&&nj.a.nP(!0,!0),Ca[qb].fMb(t[qb].OriginalUrl,t[qb].Caption,null,null);return{returnValue:!0,pGk:la,fGk:Ca}}Cgj(t,S,la,Ca){if(!t)return null;var Na=t.Cb,qb=t.Wt();let Pb;const xc=Object(D.a)(566,t.sc(this.Fb.Ma));({E3d:Pb,mD:t}=this.MWa.ZWd(S,la.Width,la.Height));Ca=S?0:Ca*fj.a.RS;Na=this.Sk.nsa(!0,Na.cid,Na.sid,0,t.x+Ca,t.y+Ca,Pb.width,Pb.height,qb+1,!1);qb=this.MWa.iTd(this.Fb.Md,
Pb,t,xc.tT);Na.SU=qb;Na.isResizable=!0;Na.v$b=!0;Na.FL=!0;Na.bJa=!0;Na.set_isSVGBlipFilled(!0);la=this.oye.E6k(la.SvgContent);Na.hea=la?String.format("data:image/svg+xml;charset=utf8,{0}",encodeURIComponent(la)):"";S&&(Na.vca=S.id);return Na}Qri(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.i6(S,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===la)return 32;P.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Na||
!Na.length)return 16;try{const qb=this.pa.Xd(),Pb=[];for(const dd of qb)dd.If||Pb.push(dd);const xc=Na[0].Caption;for(const dd of Pb){if(!Pb||this.fc.$c(dd))return 16;const fd=this.Ea.yr(dd);xc&&fd&&this.Lc.Weh(new L(S.Cb,dd.get_shapeId(),dd.get_smartArtModelId(),xc))}const ed=this.Jb.Ad(15,void 0,void 0,()=>{for(const dd of Pb){const fd=this.Ea.yr(dd);fd&&(this.Lc.Gkd(),this.pa.selectShape(fd,!0),this.Lc.Fkd())}P.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{ed.nc(Pb[0]);
ed.jd=t;ed.Zy[mf.a.rDa]=mf.a.icon;for(const dd of Pb)dd.set_isSVGBlipFilled(!0),dd.fMb(Na[0].OriginalUrl,xc,null,null)}finally{ed&&ed.dispose()}for(const dd of Pb)this.fc.Qra(S,dd,this.Fb.Ma,t);return 32}catch(qb){return P.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Na.length,qb.toString()),8}}Rri(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.i6(S,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;
if(1===la)return 32;P.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Na||!Na.length)return 16;try{const qb=this.fTc()||this.J9a();if(!qb||this.fc.$c(qb))return 16;const Pb=Na[0].Caption,xc=this.Ea.yr(qb);Pb&&xc&&this.Lc.Weh(new L(S.Cb,qb.get_shapeId(),qb.get_smartArtModelId(),Pb));const ed=this.Jb.Ad(15,void 0,void 0,()=>{xc&&(this.Lc.Gkd(),this.pa.selectShape(xc,!0),this.Lc.Fkd());P.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});
try{ed.nc(qb),ed.jd=t,ed.Zy[mf.a.rDa]=mf.a.icon,qb.set_isSVGBlipFilled(!0),qb.fMb(Na[0].OriginalUrl,Pb,null,null)}finally{ed&&ed.dispose()}(la=xc||qb)&&this.fc.Qra(S,la,this.Fb.Ma,t);return 32}catch(qb){return P.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Na.length,qb.toString()),8}}fTc(){let t=null;const S=this.pa.Xd();for(const la of S)if(la&&la.get_isSVGBlipFilled())if(t)break;else t=la;return t}J9a(){if(this.fU){const t=this.pa.Xd();
return t&&t.length?this.VRd(t)?t[0]:this.Wwb():null}return this.Wwb()}VRd(t){if(!t||!t.length)return!1;let S=t[0].Hj,la=1===t[0].mediaType;for(const Ca of t)S=S&&Ca.Hj,la=la&&1===Ca.mediaType;return S||la}Wwb(){const t=this.pa.Xd();for(const S of t)if(S&&S.Hj)return S;return null}Vrg(t,S){const la=this.Qb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==la&&P.a.J(t,352,15,`${S}::Modal:${la}`)}bNb(t,S,la){if(!this.i6(this.ua.Ba,t,this.la.pptInsertOnlineVideoEnabled))return 8;
if(1===la)return 32;this.wFb=nj.a.zk("ShowInsertVideoDialog",1);const Ca=this.Qb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.la.insertVideoOnlineFromHubbleEnabled){P.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const qb=Kc.a.create(),Pb=cb.a.sN(this.la.pptEditingUserId).toString();this.kcb.execute(xc=>{xc=this.F6c.getInstance(this.I4.Eli(Pd.App.mode,this.la.qIj,qb.toString(),Pb,this.la.Pab,
this.la.AAb,Ca),this.E6c,this.I4,xc,Lm.eg);xc.correlationId=qb;xc.w5=5;const ed=new hg(this.ia,this.I4,this.la);ed.hy=Va.a.pfe;xc.aNb(CommonUIStrings.L_VideoInsertTitle,ed)})}else this.la.insertVideoOnlineFromUrlEnabled?(P.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new dg(this.a$)).j6()):(P.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.kcb.execute(qb=>{this.F6c.getInstance(this.I4.Fli(Pd.App.mode,this.la.insertVideoServiceEndpoint),
this.E6c,this.I4,qb,bl.eg).aNb(CommonUIStrings.L_VideoInsertTitle,new hg(this.ia,this.I4,this.la))}));this.Vrg(512557208,"ShowInsertOnlineVideoDialog");null!=this.wFb&&Object(Cn.a)(this.wFb.actionName,(new Date).getTime()-this.wFb.KD.getTime(),"InsertOnlineVideoDialog",this.wFb.actionId,this.wFb.Oj);const Na=this.Qb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");Ab.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Na&&P.a.J(512517859,
352,15,"InsertOnlineVideo::ToolTipMessage : "+Na);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Qb.IQc){const qb=this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";P.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+qb)}P.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Na){return P.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",
Na.toString()),pj.Ft(Cj.a.e5b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}anl(t,S,la){if(!this.i6(this.ua.Ba,t,!0))return 8;if(1===la)return 32;try{return P.a.J(512517855,352,50,"InsertMediaActor::ShowInsertCameoDialog : Insert cameo, creating dialog"),(new nc).j6(),32}catch(Ca){return P.a.J(512517854,352,10,"InsertMediaActor::ShowInsertCameoDialog : Exception = [{0}]",Ca.toString()),8}}xIl(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517853,352,50,"Active Slide is null"),
8;if(!this.i6(S,t,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===la)return 32;if(!this.Zj.OF(S,1))return this.Zj.mG(S),16;try{const qb=S.G3(this.pa.Xd());if(qb&&this.fc.$c(qb))return 16;const Pb=this.l$a(S,qb),xc=this.I4.ppj(Na.OriginalUrl);Pb.zWe(xc,Na.ThumbnailUrl,Na.Caption,Na.Description,0<Na.Width?Na.Width:0,0<Na.Height?Na.Height:0);const ed=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()},()=>{this.pa.selectShape(Pb,!0)});try{ed.nc(S),ed.jd=t,qb&&S.PU([qb]),S.gC(Pb)}finally{ed&&
ed.dispose()}P.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.Ou.SF=Pb;return 32}catch(qb){return P.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",qb.toString()),8}}wIl(t,S,la,Ca,Na){S=this.ua.Ba;if(!S)return P.a.J(512517850,352,50,"Active Slide is null"),8;if(!this.i6(S,t,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===la)return 32;P.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");
if(!this.Zj.OF(S,1))return this.Zj.mG(S),16;try{const qb=S.G3(this.pa.Xd());if(qb&&this.fc.$c(qb))return 16;const Pb=this.l$a(S,qb),xc=0<Na.Width?Na.Width:0,ed=0<Na.Height?Na.Height:0;let dd=Na.PageUrl;this.la.AAb&&"odspbusiness"===Na.ProviderName.toLocaleLowerCase()&&(dd=Na.OriginalUrl);Pb.zWe(dd,Na.ThumbnailUrl,Na.Caption,Na.Description,xc,ed);const fd=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()},()=>{this.pa.selectShape(Pb,!0)});try{fd.nc(S),fd.jd=t,qb&&S.PU([qb]),S.gC(Pb)}finally{fd&&
fd.dispose()}this.Vrg(512557200,"InsertOnlineHubbleVideo");P.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Na.StartInsertTime);this.Ou.SF=Pb;return 32}catch(qb){return P.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",qb.toString()),8}}i6(t,S,la){t=!!t&&la&&!this.fc.$c(t);switch(S){case Va.a.a7a:return t&&(!!this.J9a()||!!this.fTc());case Va.a.P_b:case Va.a.Q_b:case Va.a.S_b:case Va.a.rtb:return t&&
this.bti();default:return t}}bti(){const t=this.J9a()||this.fTc();return t?this.Ea.yr(t)?!1:!0:!1}l$a(t,S){return this.l7f(t,S,null,!1,0)}l7f(t,S,la,Ca,Na){if(!t)return null;var qb=t.Cb;t=t.Wt();let Pb;Ca?{width:la,height:Pb}=pj.Fmj(S,la):(la=Zb.a.hY,Pb=Zb.a.y5);let xc;xc=S?S.kxb(la,Pb):this.Tb.Eta(la,Pb);Na=S?0:Na*fj.a.RS;qb=this.Sk.nsa(!0,qb.cid,qb.sid,0,xc.x+Na,xc.y+Na,la,Pb,t+1,!0);qb.set_isSVGBlipFilled(Ca);S&&(qb.vca=S.id);return qb}dispose(){this.kcb.instance&&this.Nye&&this.kcb.instance.oKb("MsoPremiumStockImages",
this.Nye);this.JZc&&this.xeb.S8a.contentWindow&&(id.a.removeHandler(this.xeb.S8a.contentWindow,"message",Object(n.a)(this,this.Wwh,"showOneDriveFilePickerDialog")),this.JZc=!1)}static qmi(){const t=CommonUIStrings.l_AttributionText.split(/[{}]+/);return Ij.e(t,S=>!!S)}static zli(t,S){const la=document.createElement("body");var Ca="";let Na="",qb=CommonUIStrings.L_CCYYSA;void 0!==S&&null!==S&&(void 0!==S.PageUrl&&null!==S.PageUrl&&(Ca=S.PageUrl),void 0!==S.LicenseDisplayName&&null!==S.LicenseDisplayName&&
0<S.LicenseDisplayName.length&&(qb=S.LicenseDisplayName),void 0!==S.LicenseUrl&&null!==S.LicenseUrl&&(Na=S.LicenseUrl));for(const Pb of t){switch(Pb){case "L_ThePhoto":t=pj.gBf(CommonUIStrings.l_ThePhoto,Ca);break;case "L_CCYYSA":t=pj.gBf(qb,Na);break;case "L_PhotoAuthor":t=pj.ABf(CommonUIStrings.l_PhotoAuthor);break;default:t=pj.ABf(Pb)}t&&la.appendChild(t)}Ca=document.createElement("html");Ca.appendChild(la);return Ca}static ABf(t){const S=document.createElement("span");S.innerText=t;return S}static gBf(t,
S){const la=document.createElement("A");la.setAttribute("href",S);la.setAttribute("target","_blank");la.setAttribute("rel","noreferrer");S=document.createElement("span");S.innerText=t;la.appendChild(S);return la}static vMe(t){const S=pj.qmi();return pj.zli(S,t)}static Ft(){}static Fmj(t,S){let la;t&&15===t.Jj?(la=Gc.a.Pe(t.U6e,0,!1),t=Gc.a.Pe(t.Wce,0,!1)):S&&0<S.Width&&0<S.Height?(la=S.Width,t=S.Height):(la=Gc.a.Pe(2,0,!1),t=Gc.a.Pe(2,0,!1));return{width:la,height:t}}}pj.Wbg=!1;Object(h.a)(pj,"InsertMediaActor",
null,[365]);var Nl=d(541);class Bi{}Bi.fxl=864E5;Bi.Kci=3;Bi.wrk=144E5;Object(h.a)(Bi,"AddinConstantsNum",null,[]);var Li=d(210),Dj=d(540),zk=d(449);class Ne{constructor(t,S,la,Ca=null){this.fa=Ca?Ca:v.AFrameworkApplication.fa;this.sDd=2;this.Kyb=t;this.d4h=S;this.Ow=la}get fUa(){return this.sDd}get WIl(){return this.d4h}nTe(t){if(this.fa.ka("AgaveSupportsLiveIdSpoofing"))this.Kyb(t,this.fUa,{["ak0"]:(new Date).getTime()});else if(zk.a.pvh(t)){var S=String.format(v.AFrameworkApplication.Aa.hb.tna+
"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",v.AFrameworkApplication.Aa.hb.Uk,this.WIl,v.AFrameworkApplication.hh);const la=v.AFrameworkApplication.Ke;let Ca=null;this.Ow&&(Ca=this.Ow.Ei("ComponentAttach",Dj.a[t]+Nl.a[this.fUa]));la.nj(S,1,null,null,!0,4,Na=>{this.KAk(t,Na.data.Wd);Ca&&Ca.stop()},Na=>{r.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Na.data.ie);Ca&&Ca.stop()},null)}else zk.a.oce(t)?(S=zk.a.R5d(t),this.Kyb(t,this.fUa,{["ak0"]:S})):
this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.Kyb(t,this.fUa,null)}KAk(t,S){if(S&&""!==S&&(S=Sys.Net.XMLDOM(S))){zk.a.Ylb(Li.a.xQd,((new Date).getTime()+Bi.wrk).toString(),t);let la=S.getElementsByTagName("update");la&&la.length||(la=S.getElementsByTagName("o:update"));la&&0<la.length&&(S=Date.parse(la[0].firstChild.nodeValue),(zk.a.R5d(t)<S||zk.a.oce(t))&&this.Kyb(t,this.fUa,{["ak0"]:S}))}}}Object(h.a)(Ne,"AddinCommandsAnonymousAPIInitializer",
null,[899]);class Ig{constructor(t,S,la){this.sDd=la;this.Kyb=t;this.Zh=S}get fUa(){return this.sDd}nTe(t){let S=null;this.Zh&&(S=this.Zh.Ei("ComponentAttach",Dj.a[t]+Nl.a[this.fUa]));(null==this.yYe(t)?0:this.yYe(t))&&this.Kyb(t,this.fUa,{["ak0"]:(new Date).getTime()-Bi.Kci*Bi.fxl});S&&S.stop()}}Object(h.a)(Ig,"AddinCommandsInitializerBase",null,[899]);class Ok extends Ig{constructor(t,S){super(t,S,5)}yYe(){return!0}}Object(h.a)(Ok,"AddinCommandsInitializer",Ig,[]);class gj extends Ig{constructor(t,
S){super(t,S,1)}yYe(t){try{const S=Li.a.G2f()+t;return Boolean.parse(this.F5i(S)||"false")}catch(S){r.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",S.toString())}return null}F5i(t){const S=localStorage;return void 0!==S&&null!==S?S.getItem(t):null}}Object(h.a)(gj,"AddinCommandsLocalCacheInitializer",Ig,[]);class Ce{constructor(t,S=null){this.Ow=t;this.fa=S?S:v.AFrameworkApplication.fa}get appUILocale(){return Uh.a.xe(v.AFrameworkApplication.lcid).name}qFj(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var t={};t[Li.a.GQi]="TeachingCallout";this.ZMe(u.a.Lzl,t)}const S=this.h6d();if(S)if(this.fa.ka("OcpsIsEnabled"))A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(la=>
{la.isFeatureEnabled("ConnectedServices",!0).then(Ca=>{for(let Na of S){if(!Ca&&0===Na.key)continue;const qb=this.IZf(Na.value);qb&&qb.nTe(Na.key)}return null})});else for(let la of S)(t=this.IZf(la.value))&&t.nTe(la.key)}oTe(t,S,la){la&&la[Li.a.q6a]?(la[Li.a.U7]=t,la[Li.a.T7]=S,this.ZMe(u.a.SKb,la),zk.a.Ylb(Li.a.q6a,la[Li.a.q6a].toString(),t)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===t&&(la={},la[Li.a.U7]=t,la[Li.a.T7]=S,this.ZMe(u.a.naa,
la))}IZf(t){let S=null;switch(t){case 1:S=new gj(Object(n.a)(this,this.oTe,"retrieveAddinFlagCompleted"),this.Ow);break;case 2:S=new Ne(Object(n.a)(this,this.oTe,"retrieveAddinFlagCompleted"),this.appUILocale,this.Ow,this.fa);break;case 5:S=new Ok(Object(n.a)(this,this.oTe,"retrieveAddinFlagCompleted"),this.Ow)}return S}}Object(h.a)(Ce,"AddinCommandsInitializerHost",null,[]);var Al=d(1132),qk=d(158);class eg extends Ce{constructor(t,S){super(t.$7f());this.Yn=t;this.Qb=S;Al.a.t8b=Al.a.Ebh}bBl(){this.qFj()}h6d(){const t=
new qk.a;this.Qb.ka("51")&&(t.$(0,2),t.$(16,5));this.Qb.ka("187")&&t.$(1,1);this.Yn.qd.fua&&t.$(8,1);this.Qb.ka("305")&&t.$(10,5);return t}ZMe(t,S){this.Yn.VG().La(t,2,S)}}Object(h.a)(eg,"AddinCommandsInitService",Ce,[837]);class Lf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}Zb(t){this.K=t;A.a.instance.register(eg,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").oa(()=>new eg(this.K.resolve("PowerPointWebEditor.IApplicationContext"),
this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Zgg&&this.K.resolve("Common.IAppSettingsManager").ff(()=>{A.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").bBl()})}dispose(){}}Object(h.a)(Lf,"AddInCommandsInitPackage",null,[2,3]);class om extends Id{constructor(t,S=null){super(t,!0,S,!1)}get Hde(){return null}get lna(){return v.AFrameworkApplication.ysa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get cBb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get pHc(){return null}}
Object(h.a)(om,"DownloadAsPdfDialog",Id,[]);class yc extends om{constructor(t){super(t)}get lna(){return v.AFrameworkApplication.ysa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}Ebc(){P.a.J(25544926,801,50,"Images download dialog displayed")}Gbc(){P.a.J(25544928,801,50,"Images download dialog link clicked")}Zbb(){P.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(h.a)(yc,"DownloadACopyAsImagesDialog",om,[]);var Dn=d(198);class Ol extends ef{constructor(t){super(t,
void 0,v.AFrameworkApplication.ysa)}get lna(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get cBb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get pbc(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get X1b(){return v.AFrameworkApplication.ysa?"UIFontDialogTextLarge":null}Ebc(){P.a.J(8958087,801,50,"ODP download dialog displayed")}Gbc(){P.a.J(8958089,801,50,"ODP download dialog link clicked")}Zbb(){P.a.J(19505496,801,50,"ODP download dialog button clicked")}b2c(){Dn.Redirect.showHelp("PPTODF");
return!0}get mbc(){return v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("EnableReactDialogs")&&Ab.a("ReactDialogsODPDialogFix")?null:"#"}get uVa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get QZg(){return!v.AFrameworkApplication.ysa}}Object(h.a)(Ol,"DownloadACopyAsOdpDialog",ef,[]);class ii extends om{constructor(t){super(t)}get lna(){return v.AFrameworkApplication.ysa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}Ebc(){P.a.J(21050910,
801,50,"PDF download dialog displayed")}Gbc(){P.a.J(21050912,801,50,"PDF download dialog link clicked")}Zbb(){P.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(h.a)(ii,"DownloadACopyAsPdfDialog",om,[]);var zh=d(1159),Wi=d(390);class ch extends Wi.a{constructor(t,S,la){super();this.XX=null;this.w4c=0;this.Sd=this.tIg=null;this.Vfk=t;this.l9j=S;this.t6j=la;this.bZa=Object(n.a)(this,this.I5,"onRequestComplete");this.onError=Object(n.a)(this,this.oyk,"onRequestError")}get $kc(){return this.tIg}set $kc(t){this.tIg=
t}get $s(){return this.Sd}set $s(t){this.Sd=t}start(){this.dNb()}dNb(){1!==v.AFrameworkApplication.Aa.state&&(this.XX=new zh.a,this.XX.Ar=!1,this.XX.yd=5,this.XX.message=this.Vfk,this.XX.Xoa(ResourceStrings.l_GenericDialogTitle,null,null),this.w4c=0)}pT(){this.XX&&(this.XX.close(),this.XX=null)}I5(t){this.pT();t.fSa?this.$kc(t):this.UY()}oyk(t){t.lWi&&this.w4c<ch.q6k?(this.w4c+=1,t.start()):this.UY()}UY(){this.pT();if(1!==v.AFrameworkApplication.Aa.state){const t=new Oa.StandardDialog;t.yd=0;t.Jy(this.t6j,
ResourceStrings.l_GenericDialogTitle,this.l9j,this.$s)}}}ch.q6k=3;Object(h.a)(ch,"UIBlockingTask",Wi.a,[]);var M=d(262);class N extends ch{constructor(t){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,Cj.a.irk);this.sB=t}start(){super.start();M.a.VBi(this.sB,Object(n.a)(this,this.xda,"handleWebserviceResponse"),Object(n.a)(this,this.wda,"handleWebserviceError"))}}Object(h.a)(N,"ConvertToOdpTask",ch,[]);class Ia extends ch{constructor(t){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,Cj.a.BFk);this.sB=t}start(){super.start();M.a.XBi(this.sB,Object(n.a)(this,this.xda,"handleWebserviceResponse"),Object(n.a)(this,this.wda,"handleWebserviceError"))}}Object(h.a)(Ia,"ConvertToPdfTask",ch,[]);class lb{constructor(t,S,la){this.R4c=t;this.Ce=S;this.bte=la}get cvb(){return this.R4c.value}convert(t,S,la){let Ca=null;0===S?this.bte?new Ol(la):(Ca=new N(t),Ca.$kc=Object(n.a)(this,this.Dtk,"onConvertOdpRequestSucceeded"),Ca.start()):1===S?this.Ce.qd.Qjg&&
this.bte?new ii(la):nj.a.DI(nj.a.Ib,()=>{Ca=new Ia(t);Ca.$kc=Object(n.a)(this,this.Etk,"onConvertPdfRequestSucceeded");Ca.start()}):2===S?this.Ce.qd.gmg&&this.bte&&new yc(la):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",S))}Dtk(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=db.a.ita(t.PrintUrl),new Ol(t))}Etk(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=db.a.ita(t.PrintUrl),this.cvb.mJf=new Date,new ii(t),this.cvb.XOf=new Date,P.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.cvb.PQf.toString(),this.cvb.toh.toString(),this.cvb.mJf.toString(),this.cvb.XOf.toString()))}}Object(h.a)(lb,"Converter",null,[841]);class Sb{constructor(){this.PQf=this.toh=this.mJf=this.XOf=Pd.App.Ym}}Object(h.a)(Sb,"DownloadACopyAsPdfContext",null,[]);class Wc extends ch{constructor(t,S){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
Cj.a.YKk);this.sB=t;this.Rjk=S}start(){super.start();M.a.print(this.sB,this.Rjk,Object(n.a)(this,this.xda,"handleWebserviceResponse"),Object(n.a)(this,this.wda,"handleWebserviceError"))}}Object(h.a)(Wc,"PrintTask",ch,[]);class td{constructor(t,S,la){if(!t)throw Error.argumentNull("directPrintManager");this.idc=t;this.Ce=S;this.A9j=la}Lxk(t){this.idc.jLk();t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=db.a.ita(t.PrintUrl),this.idc.Ywh(t))}print(t,S,la){this.Ce.qd.Qjg&&this.A9j?(t=new If.QueryStringBuilder(S),
t.Xg(vh.a.CDk,this.idc.Vvh().toString()),t.Xg(vh.a.zDk,la.toString()),this.idc.Ywh(t.toString())):(la=new Wc(t,this.idc.Vvh()),la.$kc=Object(n.a)(this,this.Lxk,"onPrintRequestSucceeded"),la.start())}}Object(h.a)(td,"Printer",null,[839]);class wd{get name(){return"PowerPointWebEditor.PrintPackage"}Zb(){A.a.instance.register(td,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().oa(()=>new td(A.a.instance.rb("Common.App.DirectPrint.IDirectPrintManager"),A.a.instance.rb("PowerPointWebEditor.IApplicationContext"),
A.a.instance.rb("PowerPointWebEditor.IApplicationSettings").vg));A.a.instance.register(lb,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().oa(()=>new lb(A.a.instance.ke("PowerPointWebEditor.DownloadACopyAsPdfContext"),A.a.instance.rb("PowerPointWebEditor.IApplicationContext"),A.a.instance.rb("PowerPointWebEditor.IApplicationSettings").vg));A.a.instance.register(Sb,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().oa(()=>new Sb)}init(){}dispose(){}}Object(h.a)(wd,"PrintPackage",null,
[2,3]);var be=d(1046);class hb extends jk{constructor(t,S,la){super(t,S);this.la=la;this.hy=Va.a.qtb}aua(t){if(t&&t.length){var S=Va.a.mw(this.hy),la=this.MLj(t[0]);try{P.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",S,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");if(32!==(la?this.An.La(Va.a.MJc,2,t):this.An.La(this.hy,2,t[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",
la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));P.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",S,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Ca){P.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",S,Ca.toString())}}}MLj(t){(t=!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&
0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===t.OriginalUrl.length-4)||P.a.J(512517842,352,50,"isChangeSvg = false");return t}}Object(h.a)(hb,"ChangeOnlineImageHelper",jk,[]);class hf extends jk{constructor(t,S,la){super(t,S);this.la=la;this.hy=Va.a.sab}aua(t){if(t&&t.length){var S=Va.a.mw(this.hy),la=new Map;la.set("InsertMediaCommand",S);Tf.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",
null,la);try{const Na=[],qb=[];for(let xc=0;xc<t.length;xc++){const ed=t[xc];this.mkg(ed)?Array.add(Na,ed):Array.add(qb,ed)}P.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",qb.length,Na.length,S);let Pb=this.hy;Pb===Va.a.RXc&&(Pb=Va.a.UXc);for(t=0;t<qb.length;t++){var Ca=this.An.La(Pb,2,qb[t]);if(32!==Ca)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",qb.toString(),S));}if(this.mkg(Na[0])&&(Ca=this.An.La(Va.a.RXc,
2,Na),32!==Ca))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",Na.toString()));P.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images success, command: {2}.",qb.length,Na.length,S)}catch(Na){P.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.hy.toString(),Na.toString()),la.set("Exception",Na.toString()),Tf.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,Object.assign(new Hb.a,{extendedProperties:la}))}}}mkg(t){(t=
!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.rab&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===t.OriginalUrl.length-4)||P.a.J(512517838,352,50,"isInsertSvg = false");return t}}Object(h.a)(hf,"InsertOnlineImageHelper",jk,[]);var Xf=d(722);class Bg{constructor(t,S){this.Kdb=!1;this.feb=new Date(0);this.eeb=
new Date(0);this.GBe=t;this.zb=S}F$f(){this.Kdb=!0}LKa(){this.Kdb?P.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.feb>this.eeb?P.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.feb+". Last scan at "+this.eeb+"."):(this.feb=new Date,this.zb.Db(new V.a(3,1,0,Object(n.a)(this,this.RTe,"runJob"),90,"112")))}RTe(){this.eeb=
new Date;this.Kdb?P.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.GBe()&&this.LKa()}}Object(h.a)(Bg,"PrefetchScheduler",null,[]);class ji{constructor(t,S,la){this.M3c=null;this.Azg=S;this.Ntg=la;this.xBb=t}K$k(t){this.xBb!==t&&(this.xBb=t,this.M3c=null)}ilj(){this.M3c||(this.M3c=this.Cpi());return this.M3c}Cpi(){const t=[];Array.add(t,this.xBb);for(let S=1;S<=this.Azg||S<=this.Ntg;S++)S<=this.Azg&&Array.add(t,this.xBb+
S),S<=this.Ntg&&0<=this.xBb-S&&Array.add(t,this.xBb-S);return t}}Object(h.a)(ji,"SlideWindow",null,[]);class pi{constructor(t,S,la,Ca,Na,qb,Pb,xc){this.Hfb=!1;this.ic=Na;this.kq=Ca;this.Awa=xc;this.zBb=new Xf.a;this.qA=new Bg(Object(n.a)(this,this.l4e,"tryScan"),qb);this.aYg=new ji(Ca&&Ca.Ba?Ca.Ba.slideIndex:0,Pb?Pb.Qsl:10,Pb?Pb.Psl:5);this.yXe(t,S,la)}start(){this.Hfb?P.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(P.a.J(593773075,
813,100,"StreamVideoPrefetchOrchestrator Starting."),this.Hfb=!0,this.qA.LKa())}yXe(t,S,la){t&&t.tI(Object(n.a)(this,this.ofd,"onEditSlideChanged"));S&&S.Gia(Object(n.a)(this,this.kgd,"onPageContentLoaded"));la&&la.IPa(Object(n.a)(this,this.Hzk,"onSlideshowSlideChanged"))}kgd(t,S){this.Hfb&&(t=Object(D.a)(116,S.node))&&t.eE&&(this.zBb.remove(t.Cb),this.qA.LKa())}ofd(t,S){S&&S.sna&&this.DB(S.sna.slideIndex)}Hzk(t,S){S&&this.DB(S.slideIndex)}DB(t){this.aYg.K$k(t);this.Hfb&&this.qA.LKa()}l4e(){const t=
this.V$d();0<t.length&&this.uUe(t[0]);return 1<t.length}V$d(){const t=[];var S=this.kq.presentation;if(!S)throw Error.argumentNull("Presentation is null");S=S.slides||[];for(const la of this.aYg.ilj()){const Ca=S[la];this.kkl(Ca)&&Array.add(t,Ca)}return t}kkl(t){return!!t&&t.eE&&!t.XN&&!this.zBb.contains(t.Cb)}uUe(t){this.zBb.add(t.Cb);t=this.Ulj(t);0<t.length&&(P.a.J(593773072,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",t.length),this.Awa?this.Awa.JJk(t):P.a.J(593773070,
813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}Ulj(t){if(!this.ic)return P.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.qA.F$f(),[];const S=[];if(!t)return S;t=Object(D.a)(116,t);if(!t)return S;for(const la of t.gk())(t=la.vpa)&&this.Awa&&this.Awa.xbb(t)&&Array.add(S,t);return S}static MTj(t){return!!t&&t.xng&&!xe.a.Pi&&
!xe.a.pFa&&!xe.a.TI&&!xe.a.tne}}Object(h.a)(pi,"StreamVideoPrefetchOrchestrator",null,[]);class Oe{static addAppPLTEventToLog(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(t)}catch(S){}}static setIsPageLoadForFirstTime(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(t)}catch(S){}}}Object(h.a)(Oe,"VersionHistoryLogConnector",null,[]);class Ri{constructor(t,S,la,Ca){this.fY=null;this.Klh=this.ResetAppVersionController;this.Ew=t;this.Di=
S;this.Ha=la;this.oc=Ca;this.kYa={}}OnVersionHistorySelected(t,S){try{P.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const la=document.getElementById("VersionHistoryViewerSpinner");la&&(la.style.display="none");if(this.fY)this.fY.onVersionSelected(t,S,this.kYa)}catch(la){P.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",la)}}ResetAppVersionController(t){try{if(this.fY)Oe.setIsPageLoadForFirstTime(!1),
this.fY.switchParentViewContainer(t);else{Oe.setIsPageLoadForFirstTime(!0);const S=new PowerPointVersionHistory.AppBootSettings;S.RenderServiceBase="";S.IsRtl=!1;const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(n.a)(this.Ew,this.Ew.cYd,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(n.a)(this,this.CreateNotesIcon,"CreateNotesIcon");S.IsHighContrast=!1;this.Di&&(S.IsHighContrast=this.Di.isInHighContrastMode);S.IsHighContrast&&(S.ClientColorSettings=
this.Di.highContrastColors.foregroundTextColor+"_"+this.Di.highContrastColors.backgroundColor+"_"+this.Di.highContrastColors.linkColor);if(this.oc){const Ca=this.oc.iTa();S.DefaultSlideWidth=Ca.width;S.DefaultSlideHeight=Ca.height}S.UserSessionId=v.AFrameworkApplication.userSessionId;S.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;S.ProgressImageResourceUrl=Qe.a.ZK(Zb.a.Zna);this.fY=new PowerPointVersionHistory.AppVersionController(S,t,la)}}catch(S){P.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
S)}}CreateNotesIcon(){return Ba.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(h.a)(Ri,"PPTVersionHistorySelectionHandler",null,[792]);class Rj extends ef{constructor(t){super(t,void 0,v.AFrameworkApplication.ysa)}get lna(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get cBb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get pbc(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get X1b(){return v.AFrameworkApplication.ysa?
"UIFontDialogTextLarge":null}Ebc(){P.a.J(19743688,801,50,"Download a copy dialog displayed")}Gbc(){P.a.J(19743690,801,50,"Download a copy dialog clicked")}Zbb(){P.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(h.a)(Rj,"PowerPointDownloadACopyDialog",ef,[]);class dh{Enl(t){new Rj(t)}}Object(h.a)(dh,"PowerPointDownloadACopyDialogFactory",null,[612]);var ff;(function(t){t[t.unknown=0]="unknown";t[t.bing=1]="bing";t[t.M365=2]="M365";t[t.icons=3]="icons";t[t.oneDrive=4]="oneDrive";
t[t.hubbleVideos=5]="hubbleVideos"})(ff||(ff={}));Object(h.b)("InsertMediaProviders",ff);var Kj;(function(t){t[t.OK=0]="OK";t[t.cancel=1]="cancel";t[t.error=2]="error";t[t.open=3]="open"})(Kj||(Kj={}));Object(h.b)("HubbleAction",Kj);var Mf=d(531);class ke extends Qd.a{constructor(t,S,la,Ca,Na){super();this.GD=null;this.Gyc=!1;this.oec=this.YFd=this.JX=null;this.XTd="KeepFocusDiv";this.YTd="KeepFocusStartDiv";this.correlationId=null;this.w5=0;this.insertPictureTelemetryEndpoint=null;this.d0d=0;if(!t)throw Error.argumentNull("insertMediaSeviceEndpoint",
"insertMediaSeviceEndpoint cannot be null.");this.Pef=t;this.Baf="";this.CTb=la;this.e2=Ca;this.kBa=[];this.ZId=S;this.eg=Na||bl.eg;this.ig="InsertMediaDialog";this.qce=!1;this.yd=5}aNb(t,S){this.Baf=t;this.Gyc=!1;this.showDialog(this.Baf,null);this.JX=this.ISc(this.Oh("insertmediaframe"));if(!this.JX)throw this.A8a(this.MIc),Error.invalidOperation("Couldn't get InsertMediaIframe.");(t=document.getElementById(this.Oh("WACDialogPanel")))&&t.setAttribute(pa.a.af,pa.a.fSd);t=document.createElement("div");
t.setAttribute("Id",this.YTd);t.setAttribute("tabindex","0");t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","-1000px");this.JX.parentNode.insertBefore(t,this.JX.parentNode.firstChild);t=document.createElement("div");t.setAttribute("Id",this.XTd);t.setAttribute("tabindex","0");this.JX.parentNode.appendChild(t);t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","10000px");$addHandler(this.c0d,"keydown",Object(n.a)(this,
this.aA,"keyDownHandler"));this.JX.setAttribute("src",this.Pef);this.JX.setAttribute("width","100%");this.JX.setAttribute("height","100%");this.JX.setAttribute("frameborder","0");v.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&(xe.a.fg||xe.a.eac)?(this.JX.style.visibility="hidden",this.oec=Object(n.a)(this,this.Mvk,"onInsertMediaIframeLoaded"),id.a.addHandler(this.JX,"load",this.oec)):this.JX.style.visibility="visible";this.ISc(this.Oh("WACDialogTitleText")).style.display=
"none";if(2===this.w5||5===this.w5)this.ISc(this.Oh("WACDialogTitlePanel")).style.display="none",this.ISc(this.Oh("WACDialogBodyPanel")).style.padding="0";gc.FocusManager.instance().yl().scope.dJ=!0;this.GD=this.ZId.getInstance(this.JX.contentWindow,this.Pef);this.GD.LBa("https://osiziwuspersimmon002.blob.core.windows.net");this.GD.LBa("https://osizewuspersimmon001.blob.core.windows.net");this.GD.LBa("https://osizpscuspersimmon000.blob.core.windows.net");this.GD.LBa("https://cdn.hubblecontent.msit.osi.office.net");
this.GD.LBa("https://cdn.hubblecontent.osi.office.net");this.GD.Txa(Qb.a.ztf,la=>{this.Grk(la,Object(n.a)(S,S.aua,"insertMediaCallback"))});this.GD.Txa(Qb.a.insert,la=>{this.wIe(la,Object(n.a)(S,S.aua,"insertMediaCallback"))});this.GD.Txa(Qb.a.N7h,la=>{this.$wk(la)});this.GD.Txa(Qb.a.D8i,Object(n.a)(this,this.Wuk,"onGetCustomHeaders"));this.GD.Txa(Qb.a.bkj,Object(n.a)(this,this.gvk,"onGetSessionId"));this.GD.Txa(Qb.a.E5i,Object(n.a)(this,this.Tuk,"onGetCID"));this.GD.Txa(Qb.a.Iqi,Object(n.a)(this,
this.Osk,"onCancelDialog"));2===this.w5&&0===this.d0d&&(this.GD.Txa(Qb.a.D_j,Object(n.a)(this,this.hwk,"onLaunchM365Upsell")),this.YFd=this.e2.Gib("MsoPremiumStockImages",la=>{r.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.GD.sendMessage(Qb.a.sIl,{["LicenseTier"]:la.toString()})}));this.lqc(3)}Mvk(){this.JX&&(this.JX.style.visibility="visible",window.setTimeout(()=>{if(this.ji){const t=this.ji.getElementById("insertmediaframe");t&&t.focus()}},0))}aA(t){t.keyCode===
Sys.UI.Key.tab&&(t.target.id!==this.XTd||t.shiftKey?t.target.id===this.YTd&&t.shiftKey&&(t.preventDefault(),this.ji.getElementById(this.XTd).focus()):(t.preventDefault(),this.ji.getElementById(this.YTd).focus()))}dispose(){this.e2&&this.YFd&&this.e2.oKb("MsoPremiumStockImages",this.YFd);this.GD&&(this.GD.dispose(),this.GD=null);this.oec&&(id.a.removeHandler(this.JX,"load",this.oec),this.oec=null);super.dispose()}Grk(t,S){r.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(t=this.CTb.l$g(t))50<
this.kBa.length?r.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.kBa,t),this.Gyc&&(S(this.kBa),this.Gyc=!1))}Osk(){r.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.A8a(this.MIc);this.lqc(1)}lqc(t){var S=RegExp("hubble","gi");if(this.insertPictureTelemetryEndpoint&&0<this.insertPictureTelemetryEndpoint.search(S)&&this.correlationId){S=v.AFrameworkApplication.gd;var la={};la.InsertedFiles=this.kBa.length;la.DialogResult=Kj[t];
la.DialogMode=this.Qdj();la.CorrelationId="{"+this.correlationId.toString()+"}";la.Platform="Wac";la.Provider=ff[this.w5]||"Unknown";la.AudienceGroup=S&&"AudienceGroup"in S?S.AudienceGroup.toString():"Unknown";la.Ring=S&&"Ring"in S?S.Ring.toString():"Unknown";la.AppId=Pd.App.mode;la.Build=v.AFrameworkApplication.buildVersion;la.Locale=Uh.a.xe(v.AFrameworkApplication.lcid).name;this.Hxa().send(JSON.stringify(la))}if(2===this.w5||5===this.w5){const Ca=v.AFrameworkApplication.fa.Ga("InsertMediaDialogAriaTenantNameSpace");
Ca&&""!==Ca&&(S=[],la="InsertUnknownContent",2===this.w5?(Array.add(S,Object.assign(new K.a,{name:"DialogMode",string:"M365Content"})),Array.add(S,Object.assign(new K.a,{name:"Provider",string:"M365Content"})),la="InsertM365Content"):5===this.w5&&(Array.add(S,Object.assign(new K.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(S,Object.assign(new K.a,{name:"Provider",string:"HubbleVideo"})),la="InsertHubbleVideo"),Array.add(S,Object.assign(new K.a,{name:"InsertedFiles",int64:this.kBa.length})),
Array.add(S,Object.assign(new K.a,{name:"DialogResult",string:Kj[t]})),Array.add(S,Object.assign(new K.a,{name:"CorrelationId",string:this.correlationId.toString()})),y.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}",Ca,la),dataFields:S})))}}Qdj(){return 3===this.w5?"Icons":"Images"}ISc(t){const S=document.getElementById(t);if(!S)throw Error.invalidOperation(String.format("Couldn't get {0}.",t));return S}Hxa(){const t=new XMLHttpRequest;t.open("POST",this.insertPictureTelemetryEndpoint,
!0);t.setRequestHeader("Content-Type","");return t}wIe(t,S){r.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.A8a(this.MIc);S?this.kBa&&0<this.kBa.length?(S(this.kBa),this.lqc(0)):(r.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Gyc=!0,S(this.kBa),this.lqc(2)):this.lqc(2)}Wuk(){this.GD&&(r.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.GD.sendMessage(Qb.a.abl,{["CustomHeaders"]:""}))}gvk(){this.GD&&(r.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),
this.GD.sendMessage(Qb.a.Yel,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}Tuk(){this.GD&&(r.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.GD.sendMessage(Qb.a.ual,{["CID"]:""}))}$wk(t){t&&t.Values&&(t=t.Values,delete t.m_Origin,delete t.m_Source,delete t.m_ReceivedTime,r.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+t.eventName||!1),y.a.sendOtelEvent(Object.assign(new Mf.a,{otelEvent:t})))}hwk(){this.e2&&(r.ULS.sendTraceTag(512497693,
352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.e2.launchUpsellExperience("stockimages"))}}Object(h.a)(ke,"InsertMediaDialog",Qd.a,[804,106]);class vf{getInstance(t,S,la,Ca,Na){return new ke(t,S,la,Ca,Na)}}Object(h.a)(vf,"PptInsertMediaDialogFactory",null,[791]);var fo=d(113);class go{constructor(t){this.ndb=t;this.yXe(this.ndb.Qk,this.ndb.XIg)}yXe(t,S){t&&t.tI(Object(n.a)(this,this.ofd,"onEditSlideChanged"));S&&S.Gia(Object(n.a)(this,this.kgd,"onPageContentLoaded"))}JYk(t,
S){t&&t.X5(Object(n.a)(this,this.ofd,"onEditSlideChanged"));S&&S.m_a(Object(n.a)(this,this.kgd,"onPageContentLoaded"))}kgd(t,S){(t=Object(D.a)(116,S.node))&&t.eE&&(this.ndb.zBb.remove(t.Cb),this.ndb.qA.LKa())}ofd(t,S){S&&S.sna&&(this.ndb.lWa=S.sna,this.ndb.qA.LKa(),this.ndb.Npe=new Date)}}Object(h.a)(go,"SlideEventListener",null,[]);class ho{constructor(t,S,la){this.SVg="";this.Kdb=!1;this.feb=new Date(0);this.eeb=new Date(0);this.GBe=t;this.zb=S;la&&(this.SVg=la)}F$f(){this.Kdb=!0}LKa(){this.Kdb?
P.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.feb>this.eeb?P.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.feb+". Last scan at "+this.eeb+"."):(this.feb=new Date,this.zb.Db(new V.a(3,1,0,Object(n.a)(this,this.RTe,"runJob"),90,this.SVg)))}RTe(){this.eeb=new Date;this.Kdb?P.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):
this.GBe()&&this.LKa()}}Object(h.a)(ho,"BackgroundJobScheduler",null,[]);class Of{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd){this.ebd=null;this.Npe=new Date;this.lWa=null;this.dzg={};this.AWg={};this.kXg={};this.dyg={};if(!la)throw Error.argumentNull("graphTopologyManager");if(!Ca)throw Error.argumentNull("fontUtilsManager");this.kq=la;this.oz=Ca;this.Qk=t;this.XIg=S;this.sFb=xc;this.SXa=ed;this.tFb=dd;this.Vad=fd;this.zBb=new Xf.a;this.qA=new ho(Object(n.a)(this,this.l4e,"tryScan"),Na,"");0<qb&&
window.setInterval(Object(n.a)(this,this.Brg,"logMissingFonts"),qb);this.Dck=Pb;t=la.Ba?la.Ba.slideIndex:0;if(S=this.kq.presentation)S=S.slides||[],t<S.length&&(this.lWa=S[t],this.Npe=new Date)}dispose(){this.stop();this.Brg()}start(){this.stop();this.ebd=new go(this);this.qA.LKa()}stop(){this.ebd&&this.ebd.JYk(this.Qk,this.XIg);this.ebd=null}V$d(){const t=[];this.lWa&&t.push(this.lWa);return t}l4e(){const t=this.V$d();0<t.length&&(this.uUe(t[0]),this.zBb.add(t[0].Cb));return 1<t.length}Toe(t,S,la,
Ca){const Na=[];for(const qb of Object.keys(t))t[qb]||this.dyg[qb]||(Na.push(qb),this.dyg[qb]=!0);t=Na.length;0<t&&(P.a.J(la,820,15,"{0}",t),S&&P.a.J(Ca,820,15,"{0}",Na.join(",")))}uUe(t){const S=t.mTa();if(S&&(this.sFb||this.tFb||this.SXa||Ab.a("ShouldLogMissingThirdPartyFontCount"))){var la={},Ca={},Na={};t.uXf.split(",").forEach(dd=>{dd&&(dd=this.oz.dG(dd),la[dd]=!1)});t.MCh.split(",").forEach(dd=>{dd&&(dd=this.oz.dG(dd),Ca[dd]=!1)});t.vGh.split(",").forEach(dd=>{dd&&(dd=this.oz.dG(dd),Na[dd]=
!1)});t=[];var qb=[],Pb=[];for(let dd=0;dd<S.length;dd++){var xc=S[dd];xc=Array.isArray(xc.xC())?xc.xC():null;for(const fd of xc)for(xc=0;fd.Ra&&xc<fd.Ra.length;){var ed=fd.Ra.ga(xc);ed=ed.formatting?this.oz.dG(fo.Font.eEa(ed.formatting.cache.JN.trim().toLowerCase())):"";cb.a.Wa(ed)||(ed in la&&!la[ed]?(t.push(ed),la[ed]=!0):ed in Ca&&!Ca[ed]?(qb.push(ed),Ca[ed]=!0):ed in la||ed in Ca||Na[ed]||(Pb.push(ed),Na[ed]=!0));xc++}}this.sFb&&(Of.Uee(this.dzg,t,this.oz),this.Toe(la,!0,555886295,555886296));
if(this.SXa||Ab.a("ShouldLogMissingThirdPartyFontCount"))Of.Uee(this.AWg,qb,this.oz),this.Toe(Ca,this.SXa||this.Vad,555886297,555886298);this.tFb&&(Of.Uee(this.kXg,Pb,this.oz),this.Toe(Na,this.Vad,555886299,555886300))}}Brg(){+new Date-+this.Npe<this.Dck||(this.sFb&&Of.cpe(this.dzg,this.oz,591003669,!0,"MissingFirstPartyFonts"),(this.SXa||Ab.a("ShouldLogMissingThirdPartyFontCount"))&&Of.cpe(this.AWg,this.oz,591003667,this.SXa||this.Vad,"MissingThirdPartyFonts"),this.tFb&&Of.cpe(this.kXg,this.oz,587337796,
this.Vad,"MissingNonLoggableFonts"))}static Uee(t,S,la){S.forEach(Ca=>{Ab.a("ShouldNormalizeFontNamesBeforeLogging")&&(Ca=la.dG(Ca));if(void 0===t[Ca]||null===t[Ca])t[Ca]=!1})}static jej(t,S){if(!t)throw Error.argumentNull("fonts");const la=[];for(const Ca of Object.keys(t))t[Ca]||(S.l9(Ca)||S.l9('"'+Ca+'"')||la.push(Ca),t[Ca]=!0);return la}static cpe(t,S,la,Ca,Na){S=Of.jej(t,S);t=S.length;0<t&&(S=S.join(","),Ca&&587337796===la?P.a.J(la,820,15,"{0}",S):P.a.J(la,820,15,"{0}",Ca?S:t.toString()),la=
new Map,Ca&&la.set("Fonts",S),la.set("FontsCount",t.toString()),Tf.Health.instance.recordQosError(Na,["MissingFont"],!1,!1,!0,!1,Object.assign(new Hb.a,{extendedProperties:la})))}}Object(h.a)(Of,"FontLogger",null,[106]);var io=d(975),eh=d(977);class rk{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf){this.kga=(Ff,Gh)=>{var gk;this.Pf&&(this.Pf.Va("MediaFileValidationPassedOnUI","false"),this.Pf.Va("ErrorMessage",null===(gk=Gh.Message)||void 0===gk?void 0:gk.toString()),this.Pf.finish(),this.Pf=null);
Ff=Gh.ExtraErrorParam?String.format(Gh.Message,Gh.ExtraErrorParam):Gh.Message;Gh=Object.assign(new eh.a,{title:Gh.Title,message:Ff,timeoutInSeconds:120});this.NL.dwh(Gh)};if(!t)throw Error.argumentNull("applicationSettings");if(!S)throw Error.argumentNull("actionManager");if(!la)throw Error.argumentNull("graphTopologyManager");if(!Ca)throw Error.argumentNull("graphActionBlockingManager");if(!Na)throw Error.argumentNull("pptSelectionManager");if(!qb)throw Error.argumentNull("ribbonChangeManager");
if(!Pb)throw Error.argumentNull("transactionFactory");if(!xc)throw Error.argumentNull("shapeEditor");if(!ed)throw Error.argumentNull("errorHandler");if(!dd)throw Error.argumentNull("focusManager");if(!fd)throw Error.argumentNull("sessionInfo");if(!we)throw Error.argumentNull("mediaUploaderFactory");if(!Sf)throw Error.argumentNull("calloutNotificationAdapter");this.Ha=t;this.ia=S;this.ua=la;this.fc=Ca;this.ob=Na;this.Ou=qb;this.Jb=Pb;this.Sk=xc;this.Sd=ed;this.Fa=dd;this.wt=la.presentation;this.Fe=
fd;this.neb=we;this.NL=Sf;io.a.FJl=this.Ha.kKh;io.a.AKl=this.Ha.CKl}wb(){this.ia.ra(Va.a.bNb,va.a.application,this.uyj.bind(this),4);Ab.a("EnableCalloutNotificationsForVideos")&&Ki.b(this.kga)}Ee(){}uyj(t,S,la){const Ca=this.ua.Ba;if(!Ca||this.fc.$c(Ca))return 16;if(1===la)return 32;this.Pf=nj.a.zk("Video::Insert");try{return P.a.J(509650205,846,50,"InsertLocalVideo: flow initiated"),Jj.a.OZe(this.Ha.kKh.toString(),Ki.e,()=>Ki.d(t,this.rIj.bind(this),"video",this.Fe,Ca),"video",Ca,this.ua.presentation,
this.fc,this.Sd,this.Pf,!0,this.neb,this.Ha.rvc,this.Ha.qvc,this.Ha.pvc),this.Pf&&this.Pf.Va("VideoDialogInitialized","true"),32}catch(Na){P.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Na)}Ki.a("video")?Ki.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}showErrorMessage(t,S){this.Pf&&(this.Pf.finish(),this.Pf=null);this.Sd.cH(t,la=>{la.mC=1;la.$Ra=S;return!1})}rIj(t,S,la,Ca,Na,
qb,Pb){Ca.YN(la)&&P.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+la.lja);Ca.hK(Pb);la=Pb.Wt();var xc=this.wt.slideHeight;Ca=this.wt.slideWidth/2-Gc.a.qf(Zb.a.hY/2,0);xc=xc/2-Gc.a.qf(Zb.a.hY/2,1);if(Pb&&Pb.isConnected){var ed=this.Jb.Ad(15,void 0,void 0,()=>{this.Ou.SF=this.dGb;this.ob.selectShape(this.dGb,!0);this.Fa.Ed()});try{ed.nc(Pb);ed.jd=t;Na&&Na.Va("CreatingVideoShape","true");this.dGb=this.Sk.aRa(!1,Pb.Cb.cid,
Pb.Cb.sid,0,10,Ca,xc,Zb.a.hY,Zb.a.y5,la+1);const dd=qb.files[0].name;this.dGb.ovc=S;this.dGb.nvc=dd;Ab.a("SetMediaTypeAsVideoForEmbeddedVideo")&&this.dGb.setValue(Wb.a.mediaType,2);Pb.gC(this.dGb)}finally{ed&&ed.dispose()}Na&&(Na.Va("VideoShapeSuccessfullyCreated","true"),Na.finish(),Na=null)}}}Object(h.a)(rk,"InsertVideoActor",null,[365]);class cf{constructor(){this.B$=this.nh=this.Y4=this.K=null;this.iIg=[];this.cdc=[new wd];this.TX=[]}get name(){return"PowerPointWebEditor.Chronos2"}Ska(t){return t.resolve("PowerPointWebEditor.IApplicationSettings").eB||
t.resolve("PowerPointWebEditor.IApplicationSettings").$W}Zb(t){this.K=t;this.Y4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.Y4.mEa(5,this.name);this.B$=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let Na=0;Na<this.cdc.length;++Na)Array.add(this.TX,jc.a(this.cdc[Na],5));for(const Na of this.TX)Na.Zb(t);const S=this.K.resolve("PowerPointWebEditor.IApplicationContext"),la=v.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),
Ca=Xe.a.av(this.K.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.Ska(this.K)&&Object(Ab.a)("EnhancementOfSDXPaneBootTime")||this.K.register(be.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new be.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),
this.Ska(this.K))).ma();this.K.register(Ri,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().oa(()=>new Ri(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(ml,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().oa(()=>
new ml(t.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new Kd.a(()=>Ca.result),t.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(ak,"Box4.Media.InsertOneDriveFileHelper").ma().oa(()=>new ak(v.AFrameworkApplication.Ta));this.K.register(Xd,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().oa(()=>new Xd);this.K.register(hf,"PowerPointWebEditor.InsertOnlineImageHelper").ma().oa(()=>new hf(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(hb,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().oa(()=>new hb(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register($e,"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().oa(()=>new $e(new se(new Kd.a(()=>
{if(v.AFrameworkApplication.Tvh()){var Na=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").S8a;Na=new Th(Na.contentWindow,"*")}else Na=S.fbj();return Na}),la?db.a.sQ(window.document.URL):db.a.sQ(v.AFrameworkApplication.Vna),v.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(ee,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();this.K.register(gg,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().oa(()=>
new gg);this.K.register(vf,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.K.register(612,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().oa(()=>new dh);this.K.register(pi,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().oa(()=>new pi(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").xd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let t=this.nh.Bu("resolvechronos2");const S=this.K.resolve("Common.AFrameworkApplication"),la=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Ca=la.qd,Na=S.wq,qb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),
Pb=this.K.resolve("Common.IActionManagerExtended"),xc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var ed=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const dd=this.K.resolve("PowerPointWebEditor.IFocusManager"),fd=Na.Ld,we=this.K.resolve("Common.Transaction.ITransactionFactory"),Sf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Ff=this.K.ke("PowerPointWebEditor.IClassFactory"),Gh=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),gk=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
vj=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),mk=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),sl=this.K.resolve("PowerPointWebEditor.IPresentationReader"),On=Na.zhb,Pn=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),bi=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),Qn=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),Rn=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),wn=this.K.resolve("PowerPointWebEditor.IShapeReader"),
fl=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");this.nh.Gu(t);t=this.nh.Bu("regactorschronos2");ed=[...(this.Ska(this.K)&&Object(Ab.a)("EnhancementOfSDXPaneBootTime")?[]:[new Jm.a(Ca,this.K.resolve("Common.IAppSettingsManager"),ed,Pb,fd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),we,Ff,xc,this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),gk,vj,mk)]),new Lk(Ca,Pb,xc,this.K.Ja("PowerPointWebEditor.IAddinCommandsManager")),new pj(Ca,Pb,vj,Gh,dd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
we,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),sl,Sf,wn,fl,Rn,mk,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),
this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new al(Pb,this.K.resolve("PowerPointWebEditor.ISlidePane"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),vj,Gh,Rn,this.K.resolve("Common.Transaction.ITransactionFactory"),Sf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),dd,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new rk(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Pb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),vj,Gh,Rn,this.K.resolve("Common.Transaction.ITransactionFactory"),
Sf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),dd,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"))];for(const Il of ed)Il.wb(),Il.Ee();xc.zsf=!0;this.nh.Gu(t);v.AFrameworkApplication.fa.ff(()=>{t=this.nh.Bu("regfullactorschronos2");const Il=[new lm(Pb,vj,dd,Gh,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").xf,Pn,la.gTa().dVj,bi,this.K.resolve("PowerPointWeb.IPrinter"),
this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),Qn,qb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),S.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>v.AFrameworkApplication.BM,la.g8d(),qf=>v.AFrameworkApplication.Aa.hb.dYe(qf),
()=>v.AFrameworkApplication.Lac,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new Bm(Na,Ca.Y0i,On.embedPreviewUrl,Pb,sl,la.g8d(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const qf of Il)qf.wb(),qf.Ee();this.nh.Gu(t)});P.a.J(512360593,809,50,"Chronos2Package::Init");for(const Il of this.TX)this.nh.Bu(Il.name),Il.init(),this.nh.Gu(Il.name);
t=this.nh.Bu("al");this.xFj();this.nh.Gu(t);v.AFrameworkApplication.fa.ff(()=>{if(Ca.powerPointIdeasIsEnabled){t=this.nh.Bu("idea");var Il=this.cGj();this.bGj(Il);this.nh.Gu(t)}Ca.powerPointSmartLookupIsEnabled&&(t=this.nh.Bu("smartLookup"),this.RGj(),this.nh.Gu(t));v.AFrameworkApplication.g1c()&&(t=this.nh.Bu("versionhistory"),this.gHj(),this.nh.Gu(t));pi.MTj(Ca)&&Pa.a.get_instance().Uj(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const qf=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
if(qf&&(qf.Vuh||qf.Uuh||qf.Wuh)){const Vl=!cb.a.Wa(v.AFrameworkApplication.fa.Ga("TenantId"))&&Array.contains(qf.Zvl,v.AFrameworkApplication.fa.Ga("TenantId"));this.K.register(Of,"PowerPointWebEditor.Text.FontLogger").ma().oa(()=>new Of(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").xd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),
qf.Mnk,qf.Lnk,qf.Vuh,qf.Uuh&&v.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),qf.Wuh,qf.PRi&&Vl));Il=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.iIg.push(Il);Il.start()}});v.AFrameworkApplication.Asa||(t=this.nh.Bu("appforoffice"),this.uFj(),this.nh.Gu(t));Ca.Txh&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Foe()}dispose(){for(const t of this.TX)t.dispose();for(const t of this.iIg)try{t&&t.dispose()}catch(S){P.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",
S.message,S.stack)}}xFj(){P.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const t=mb.a.create("pptedit.augloop",null,()=>d.e(10).then(d.bind(null,1243)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const S=this.K.resolve("Common.ISharedDependencyLoader"),la=v.AFrameworkApplication.Bj("augloop-runtime-shim-ie",2);S.iBb(la).continueWith(()=>{qc.a.fy(t)})}else qc.a.fy(t)}catch(t){P.a.J(512360590,306,
10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",t.message,t.stack)}}cGj(){P.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var t=[this.B$.mub(v.AFrameworkApplication.Bj("ir-plugin-ski.min.js",5))];t=mb.a.create("pptedit.infrared",t,()=>d.e(13).then(d.bind(null,1249)));qc.a.fy(t);return t}bGj(t){P.a.J(512360587,809,50,"Start to download ideas.hermes.js file");t=this.B$.YYd(v.AFrameworkApplication.Bj("microsoft.ideas.runtime.js",5),[t],!1);
t=mb.a.create("pptedit.ideas",[t],()=>d.e(14).then(d.bind(null,1251)));qc.a.fy(t)}RGj(){P.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");const t=mb.a.create("pptedit.smartlookup",null,()=>d.e(12).then(d.bind(null,1246)));qc.a.fy(t)}gHj(){const t=this.B$.mub((v.AFrameworkApplication.mwd?v.AFrameworkApplication.fa.Ga("StaticContentHostNonOverriden"):v.AFrameworkApplication.tga)+"pptVersionHistory.js");try{qc.a.fy(t)}catch(S){P.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",
S.toString())}}uFj(){const t=this.K.resolve("PowerPointWebEditor.IApplicationSettings");A.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").nce()?cf.zee():t.vg?v.AFrameworkApplication.fa.ff(cf.Neg):Pa.a.get_instance().Uj(8,()=>{cf.Neg()})}static main(){v.AFrameworkApplication.Ug&&xe.a.fg?P.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):e.a.instance.Dc(jc.a(new cf,5))}static zee(){A.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").dja();
e.a.instance.Dc(new Lf)}static Neg(){let t=!1;try{window.self.requestIdleCallback(cf.zee)}catch(S){t=!0}t&&window.setTimeout(cf.zee,0)}}Object(h.a)(cf,"Chronos2Package",null,[2,3]);var qn=d(237),Lj;(function(t){t[t.unsupported=0]="unsupported";t[t.designer=1]="designer";t[t.blank=2]="blank"})(Lj||(Lj={}));Object(h.b)("AgendaSlideThemeType",Lj);var Ie=d(114);class $m{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(h.a)($m,"AgendaApplyInfo",null,[]);class Pl{constructor(){this.DeckSuggestionId=
this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(h.a)(Pl,"AgendaThemeApplyInfo",null,[]);class Pf{constructor(t,S){this.j3d=!1;this.FMe=[];this.gNf=t;this.wWi=S}}Object(h.a)(Pf,"DeckOptionInformation",null,[]);class Jg{constructor(){this.aXg=this.bXg=0;this.Gvg=[]}get bud(){return this.bXg}set bud(t){this.bXg=t}get aud(){return this.aXg}set aud(t){this.aXg=t}get W7a(){return this.Gvg}set W7a(t){this.Gvg=t}Vah(t,S,la){const Ca=new ea.a;if(t)for(let Na=0;Na<la-1&&Na<t.length;Na++)Ca.add(new Pf(t[Na],
!1));cb.a.Wa(S)||Ca.add(new Pf(S,!0));this.W7a=Ca.toArray()}}Object(h.a)(Jg,"AgendaDeckSessionInformation",null,[]);class Ho{constructor(){this.Zbc=this.$bc=this.Xsg=0;this.IBe=this.n3c=this.Jze=this.B9c=null}T$k(t){t&&(this.Xsg=t.body.slideIndex)}Adl(t){t.body&&t.body.outlineRequestContent&&(this.B9c=JSON.stringify(t.body.outlineRequestContent))}P$k(t){t.body&&(this.Zbc=t.body.slideCId)}S$k(t){t.body&&(this.$bc=t.body.slideSId)}Q$k(t){this.n3c=t.id}aKj(t){return t===this.n3c?(this.n3c=this.B9c=null,
!0):!1}hYj(){return!cb.a.Wa(this.B9c)&&!cb.a.Wa(this.n3c)}qdl(t){t.body&&t.body.outlineRequestContent&&t.body.outlineRequestContent.Slides&&(this.Jze=t.body.outlineRequestContent.Slides.length)}R$k(t){this.IBe=t.body.score}}Object(h.a)(Ho,"AgendaDetection",null,[]);var an=d(1051);class sk{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we){this.Tua=this.jB=null;this.s3c=0;this.Z_=null;this.lFb="";this.u5c=!1;this.Dla=0;this.B9=new ea.a;this.XBg=!1;this.wi=t;this.Tb=S;this.ua=la;this.fc=Ca;this.Ha=Na;this.Iq=
qb;this.Ge=xc;this.ob=ed;this.xw=dd;this.afb=fd;this.Qb=we;this.xw.kuk(this.Ha)}QDh(){this.Ush();this.VCi();this.Ivb()?(this.Z_=new Jg,this.Z_.bud=this.mL(),this.jzl()):1!==this.Dla||this.Ha.POc?2===this.Dla&&this.Ha.NOc&&(this.Z_=new Jg,this.Z_.bud=this.mL(),this.Qzl()):this.Pzl()}VCi(){this.Tua=Kc.a.create().toString();this.xw.b2k(this.Tua);this.xw.Hrk()}p3e(t,S){if(this.jB){if(!this.jB.$bc||!this.jB.Zbc){var la=this.Tb.ZA(this.jB.Xsg);this.jB.$bc=la.Cb.sid;this.jB.Zbc=la.Cb.cid}la=this.Tb.ZA(0);
this.wi.generateAgendaSuggestion(la.Cb.cid,la.Cb.sid,this.Tua,this.jB.B9c,this.N2i(),t,S)}else S(null)}Pzl(){this.p3e(Object(n.a)(this,this.cxk,"onPODSTriggerAgendaConversionSuccessV1"),Object(n.a)(this,this.I5g,"onPODSTriggerAgendaConversionFailureV1"));this.fc.blockContent(this.ua.presentation,"ApplyAgenda",!0)}Qzl(){for(let t of this.B9)t&&t.ozl();this.p3e(Object(n.a)(this,this.dxk,"onPODSTriggerAgendaConversionSuccessV2"),Object(n.a)(this,this.bxk,"onPODSTriggerAgendaConversionFailureV2"))}jzl(){this.p3e(Object(n.a)(this,
this.exk,"onPODSTriggerAgendaConversionSuccessV3"),Object(n.a)(this,this.J5g,"onPODSTriggerAgendaConversionFailureV3"));this.fc.blockContent(this.ua.presentation,"ApplyAgenda",!0)}dhb(t,S){if(S.property===Wb.a.xZa&&this.s3c){t=Object(D.a)(532,S.node);if(t.xZa===sk.FLh)for(let la of this.B9)la&&la.esk();else if(t.xZa===sk.GLh){for(let la of this.B9)la&&la.x2g();this.u5c=!0}this.afb.Rm(Object(n.a)(this,this.dhb,"onPresentationPropertyChange"));this.s3c=0}}N2i(){const t={};this.Ha.NOc&&2===this.Dla&&
(t.shouldGenerateThemes="true",t.themeCount="3");this.Ivb()&&(t.shouldNotConvertToGVMLBytes="true",t.shouldInsertBlankSlides="true");return Ie.c(t)}D2i(t){const S={};S.SlideCount=this.qj().toString();S.isBlankThemeRequest=(this.Z_.W7a[t].wWi&&!this.Ivb()).toString();S.isRequestForDeckDesignerForNonBlankSlides=this.Ivb();return Ie.c(S)}Ivb(){return this.Ha.POc&&(1===this.Dla||0===this.Dla)}izl(){this.ob.Rh();const t=this.ua.presentation;if(t){const S=this.Iq.oe(15);try{S.nc(t),S.jd=Va.a.wZb,t.Frb=
Object.assign(new $m,{CorrelationId:this.Tua,AgendaSlideSid:this.jB.$bc,AgendaSlideCid:this.jB.Zbc})}finally{S&&S.dispose()}this.fc.hw(t,Va.a.wZb);this.fc.hK(t)}else this.Led()}RDh(t){this.ob.Rh();this.xw.hgi(this.e7d(t));const S=this.ua.presentation;if(S){const la=this.Iq.oe(15);try{la.nc(S),la.jd=Va.a.wZb,S.xZa=sk.ELh,this.s3c=this.mL(),this.afb.kk(Object(n.a)(this,this.dhb,"onPresentationPropertyChange")),S.Grb=Object.assign(new Pl,{DeckSuggestionId:this.e7d(t),AgendaSessionId:this.Tua,CorrelationId:Kc.a.create().toString()})}finally{la&&
la.dispose()}this.fc.hw(S,Va.a.wZb);this.fc.hK(S)}else this.Led()}Led(){for(let t of this.B9)t&&t.dsk();this.fc.hK(this.ua.presentation)}cxk(){this.izl();this.u5c=!0;for(let t of this.B9)t&&t.x2g()}dxk(t){this.Z_.aud=this.mL();const S=this.C2f(),la=new ea.a;if(t.Images)for(const Ca of t.Images)la.add("data:image/jpg;base64, "+Ca);la.add(S);cb.a.Wa(t.BlankSuggestionId)&&(t.BlankSuggestionId=Kc.a.create().toString());this.Z_.Vah(t.DeckSuggestionId,t.BlankSuggestionId,sk.q7e);for(let Ca of this.B9)Ca&&
Ca.gsk(la.toArray());this.s3e(0)}exk(){this.Z_.aud=this.mL();this.Z_.Vah(null,Kc.a.create().toString(),sk.q7e);this.s3e(0)}s3e(t){this.Ivb()?this.WDh(t,Object(n.a)(this,this.gxk,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(n.a)(this,this.J5g,"onPODSTriggerAgendaConversionFailureV3")):this.WDh(t,Object(n.a)(this,this.fxk,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(n.a)(this,this.K5g,"onPODSTriggerAgendaDeckSuggestionFailure"))}WDh(t,S,la){if(this.Z_.aud<this.Z_.bud)this.QDh();
else if(this.xw.mAk(t),this.lFb=this.e7d(t),this.XWi(this.Z_.W7a[t])){var Ca=Kc.a.create().toString();this.wi.generateAgendaDeckSuggestion(this.jB.Zbc,this.jB.$bc,Ca,this.Tua,this.lFb,this.D2i(t),S,la);P.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",Ca,this.lFb)}else this.g1g(this.Z_.W7a[t].FMe,this.lFb),this.xw.t2g(t,!0)}fxk(t){if(t.Images&&t.Images.length){var S=new ea.a;for(var la of t.Images)S.add("data:image/jpg;base64, "+
la);this.g1g(S.toArray(),t.DeckSuggestionId);if(la=({themeIndex:t}=this.y1f(t.DeckSuggestionId)).returnValue)la.FMe=S.toArray(),la.j3d=!0;this.xw.t2g(t,!1)}else this.K5g(t)}gxk(t){t.Images&&t.Images.length?this.RDh(0):this.Led()}g1g(t,S){for(let la of this.B9)la&&S===this.lFb&&la.$rk(t)}K5g(t){try{let S;const la=({themeIndex:S}=this.y1f(t.DeckSuggestionId)).returnValue;la&&(la.j3d=!1,la.FMe=[]);this.xw.Zrk(S);if(this.lFb!==t.DeckSuggestionId)return!0}catch(S){P.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+
S.message)}for(let S of this.B9)S&&S.w2g();return!0}I5g(){this.Led();return!0}J5g(t){return this.I5g(t)}bxk(){const t=this.C2f(),S=new ea.a;S.add(t);for(let la of this.B9)la&&(la.fsk(S.toArray()),la.w2g());return!0}C2f(){const t=this.Tb.ZA(0);return this.Ge.tL(t.Cb).image.src}u_(t,S){try{this.jB||(this.jB=new Ho);let la=!1;S?this.jB.aKj(t.id)&&(this.prh(!1,this.Dla),la=!0):(this.jB.T$k(t),this.jB.Adl(t),this.jB.P$k(t),this.jB.S$k(t),this.jB.Q$k(t),this.jB.R$k(t),this.Ush(),this.jB.hYj()&&(this.prh(!0,
this.Dla),this.jB.qdl(t)));if(!(0>=this.B9.count))for(let Ca of this.B9)try{Ca&&(la?window.setTimeout(()=>{Ca.f1g()},100):Ca.f1g())}catch(Na){P.a.J(512496857,813,10,"Exception message: "+Na.message)}}catch(la){P.a.J(512496856,813,10,"Exception message: "+la.message)}}QUk(t){t&&this.B9.add(t)}ZCl(t){this.B9.remove(t)}prh(t,S){this.XBg=this.Ha.POc?t:t&&0!==S}O3f(){return this.XBg&&!this.u5c}CJe(t){this.u5c=!t}qj(){return this.ua.presentation.Qya+this.jB.Jze}Ush(){this.Dla=this.Gnj();this.xw.m2k(Lj[this.Dla]);
this.W1k()}W1k(){this.Ivb()?this.xw.xSe("V3"):1!==this.Dla||this.Ha.POc?2===this.Dla&&this.Ha.NOc&&this.xw.xSe("V2"):this.xw.xSe("V1")}Gnj(){try{const t=this.Tb.HI();if(t&&0<t.length)for(const S of t)if(S){const la=S.ThemeFamilyId;if(this.Ha.NOc&&la.toLowerCase()===sk.RLh.toLowerCase())return 2;if(0<=Array.indexOf(this.Ha.Vdi,la)||Object(Ab.a)("EnableNonEmptyThemeIdFixForAgendaToPPT")&&!this.Qb.ka("DisableAgendaToPPTForUnsupportedTheme")&&void 0===an.a.bza.find(Ca=>Ca.YPc===la))return 1}return 0}catch(t){return P.a.J(512496855,
813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+t.message),0}}e7d(t){return this.Z_.W7a[t].gNf}y1f(t){let S;S=0;for(const la of this.Z_.W7a){if(la.gNf===t)return{returnValue:la,themeIndex:S};S++}P.a.J(512496854,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+t);return{returnValue:null,themeIndex:S}}XWi(t){return t?!t.j3d:(P.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),
!1)}dispose(){this.afb.Rm(Object(n.a)(this,this.dhb,"onPresentationPropertyChange"));this.s3c=0}mL(){return(new Date).getTime()}}sk.q7e=4;sk.RLh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";sk.GLh=1;sk.FLh=2;sk.ELh=0;Object(h.a)(sk,"AgendaConverterManager",null,[106]);class Ef{constructor(t,S,la){this.xw=t;this.Lc=S;this.iO=la;this.Wu()}Wu(){this.Lc.dHc(Object(n.a)(this,this.Qna,"onUndoRedo"))}dispose(){this.Lc.bmd(Object(n.a)(this,this.Qna,"onUndoRedo"))}Q7b(t,S){t===Va.a.wZb&&(this.xw.CJe(S),this.iO.CJe(S))}Qna(t,
S){this.Q7b(S.G4e,S.Ebb)}}Object(h.a)(Ef,"AgendaConverterUndoRedoController",null,[630]);var bm=d(78);class rh{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(h.a)(rh,"IAgendaSettings",null,[]);class ie{constructor(t,S,la,Ca,Na){this.pCf="HighConfidenceAgendaDetected";this.jz=null;this.va=new bm.a;this.m3c=null;this.gcd=0;this.la=la;this.ut=S;this.Fa=Na;this.jz||(S=new rh,S.isEntryState=!0,S.pptAppFrameDomElement=this.ut.FF(),S.maxTryAgainCount=this.la.xwf,
this.jz=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(S));this.ktl();this.iO=t;this.la&&this.la.MOc&&this.iO.QUk(this);this.xw=Ca;this.gcb=!1}f1g(){this.iO&&(this.iO.O3f()?(this.xw.V1k(this.iO.jB.IBe),this.bwh(this.m3c),1===this.iO.jB.IBe&&this.va.raiseEvent(this.pCf,null)):this.Zce())}ozl(){this.jz&&(this.xw.ask(),this.jz.showAgendaToPptDialog(this.iO.qj()),this.Fa.AXc(ad.a.wwf,ad.a.hj,document.getElementById("AgendaToPptDialogHostElement")),this.Fa.Ej(ad.a.wwf,!0),this.gcb=
!0)}x2g(){this.Zce();this.xw.csk();window.setTimeout(()=>{this.wzl()},8E3)}gsk(t){this.jxh(t);this.xw.u2g(!0)}fsk(t){this.jxh(t);this.xw.u2g(!1)}$rk(t){this.Gnl(t)}dsk(){this.gcd>=this.la.xwf?this.jz.showAgendaToPptDismissCard():(this.gcd+=1,this.jz.showAgendaToPptFailureCard());this.xw.q5g()}w2g(){this.jz&&this.gcb&&this.jz.showSlidePreviewError()}esk(){this.jz.showMergeSlidesError();this.xw.q5g()}bwh(t){this.la.MOc&&(this.yVe(t),this.jz&&this.m3c&&this.iO&&this.iO.O3f()&&(this.jz.showAgendaCard(this.m3c,
this.iO.jB.Jze),this.xw.Yrk()))}Zce(){P.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.jz&&!this.gcb&&(this.jz.hideAgendaCard(),this.yVe(null))}jxh(t){this.jz&&this.gcb&&this.jz.populateThemesInAgendaDialog(t)}Gnl(t){this.jz&&this.gcb&&this.jz.populatePreviewSlidesInAgendaDialog(t)}yVe(t){this.m3c=t}wzl(){if(this.la.cIk)try{const t=A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&(P.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),
t.execute(S=>{S.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(t){P.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",t)}}ktl(){this.jz.on(ie.HLh,()=>{this.Qdi()});this.jz.on(ie.KLh,()=>{this.Tdi()});this.jz.on(ie.ILh,()=>{this.Rdi()});this.jz.on(ie.JLh,()=>{this.Sdi()});this.jz.on(ie.OLh,t=>{this.Pdi(t)});this.jz.on(ie.LLh,t=>{this.vwf(t,!1)});this.jz.on(ie.MLh,()=>{this.Udi()});this.jz.on(ie.NLh,t=>{this.vwf(t,!0)})}Qdi(){this.gzh()}Tdi(){this.xw.oAk();
this.gzh()}Rdi(){this.uwf();this.xw.b3g()}Sdi(){this.uwf();this.xw.fuk()}uwf(){this.cleanup();this.iO.ZCl(this)}gzh(){this.iO.QDh()}Pdi(t){this.iO.s3e(t)}vwf(t,S){this.xw.bsk(t,S);this.gcb=!1;this.jz.hideAgendaToPptDialog();this.iO.RDh(t)}Udi(){this.gcb=!1;this.jz.hideAgendaToPptDialog();this.xw.b3g()}cleanup(){this.yVe(null);this.gcd=0;this.jz.cleanup()}qai(t){this.va.addHandler(this.pCf,t)}}ie.HLh="AgendaCardAddSlides";ie.KLh="AgendaCardTryAgain";ie.ILh="AgendaCardCancel";ie.JLh="AgendaCardDismiss";
ie.OLh="AgendaToPptDialogThemeSuggestionSelected";ie.LLh="AgendaToPptDialogApply";ie.MLh="AgendaToPptDialogCancel";ie.NLh="AgendaToPptDialogMergeTryAgain";Object(h.a)(ie,"AgendaConverterView",null,[631,655]);var Bl=d(683);class jo{constructor(){this.Egc={}}Trd(t){this.Egc[t]=new Bl.a(t,!0)}zNb(t){if(t in this.Egc){var S=this.Egc[t];S.stop();S=S.uOc;delete this.Egc[t];return S}return-1}TJe(t){return t in this.Egc}}Object(h.a)(jo,"AgendaPerfLogger",null,[]);class Ql{constructor(){this.$Zc=this.chg=
this.ehg=this.dhg=!1}s5j(){this.$Zc&&!this.dhg&&(this.dhg=!0,Za.b(Ql.oni))}U5j(){this.$Zc&&!this.ehg&&(this.ehg=!0,Za.b(Ql.pni))}r4j(){this.$Zc&&!this.chg&&(this.chg=!0,Za.b(Ql.nni))}static s3j(t){t&&t.GQ&&Za.b(Ql.mni)}}Ql.oni="WAC_Exp_AgendaToPPTHighConfidenceSeen";Ql.pni="WAC_Exp_AgendaToPPTHighConfidenceTried";Ql.nni="WAC_Exp_AgendaToPPTHighConfidenceKept";Ql.mni="WAC_Exp_AgendaToPPTIsCreateNew";Object(h.a)(Ql,"ExperimentationMetrics",null,[]);class Io{constructor(){this.yse=this.Tre=this.Wpe=
this.Tua=null;this.Nte=!1;this.Yxg=this.Wsg=this.VVg=this.Ha=null;this.YCe="";this.Qte=!1;this.Vpe=""}reset(){this.VVg={};this.Wsg=new jo;this.Yxg=new Ql;this.YCe="";this.Qte=!1;this.Vpe="";this.yse=this.Tre=this.Wpe=this.Tua=null;this.Nte=!1}get telemetryData(){return this.VVg}get FPc(){return this.Yxg}get W7(){return this.Wsg}get qd(){return this.Ha}set qd(t){this.Ha=t}get Zsd(){return this.YCe}set Zsd(t){this.YCe=t}get dSa(){return this.Qte}set dSa(t){this.Qte=t}get UP(){return this.Vpe}set UP(t){this.Vpe=
t}get gW(){return this.Tua}set gW(t){this.Tua=t}get LG(){return this.Wpe}set LG(t){this.Wpe=t}get XS(){return this.Tre}set XS(t){this.Tre=t}get documentOpenType(){return this.yse}set documentOpenType(t){this.yse=t}get w9b(){return this.Nte}set w9b(t){this.Nte=t}}Object(h.a)(Io,"AgendaMetricsState",null,[]);var bn=d(776);class Sj{constructor(t,S){if(!t)throw Error.argumentNull("AgendaThemetype is null");if(!S)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.mva=new bn.a;this.mva.zia(Object.assign(new K.a,
{name:"AgendaThemeType",string:t}));this.mva.zia(Object.assign(new K.a,{name:"AgendaFlowVersion",string:S}))}d6(t){cb.a.Wa(t)||this.mva.zia(Object.assign(new K.a,{name:"AgendaSessionId",string:t}));return this}Rod(t){this.mva.zia(Object.assign(new K.a,{name:"AgendaThemeIndexSelected",int64:t}));return this}Ljb(t){cb.a.Wa(t)||this.mva.zia(Object.assign(new K.a,{name:"AgendaCardState",string:t}));return this}SKa(t){cb.a.Wa(t)||this.mva.zia(Object.assign(new K.a,{name:"AgendaDialogState",string:t}));
return this}c0a(t){cb.a.Wa(t)||this.mva.zia(Object.assign(new K.a,{name:"AgendaButtonClickedType",string:t}));return this}Kpd(t){cb.a.Wa(t)||this.mva.zia(Object.assign(new K.a,{name:"AgendaSeenTriedKept",string:t}));return this}w1(t){cb.a.Wa(t)||this.mva.zia(Object.assign(new K.a,{name:"DocumentOpenType",string:t}));return this}build(){return this.mva.dataFields}}Object(h.a)(Sj,"AgendaToPptActivityDataPointBuilder",null,[]);class ki{constructor(){this.Vc=null;this.eYa=new Bl.a("AgendaToPpt",!1);this.zXe()}zXe(){this.Vc=
new Io;this.Vc.reset();this.Vc.telemetryData.Flights="";v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)&&(this.Vc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Vc.telemetryData.InitialUserThemeType=this.Vc.UP}kuk(t){t&&(this.Vc.qd=t,this.Vc.documentOpenType=ki.K9i(t),Ql.s3j(this.Vc.qd),this.Vc.telemetryData.IsDocumentOpenTypeCreateNew=this.Vc.qd.GQ.toString())}v2g(t,S){if(this.Vc.W7.TJe("AgendaToPptDialogThemeApply")&&
"V2"===this.Vc.LG){var la=this.Vc.W7.zNb("AgendaToPptDialogThemeApply");this.Vc.telemetryData.TotalTimeTakenToMerge=la.toString();Za.a(ki.rW,t,la,S)}else this.Vc.W7.TJe("OnAddSlidesClicked")?(la=this.Vc.W7.zNb("OnAddSlidesClicked"),this.Vc.telemetryData.TotalTimeTakenToMerge=la.toString(),Za.a(ki.rW,t,la,S)):this.Vc.W7.TJe("OnTryAgainClicked")&&(la=this.Vc.W7.zNb("OnTryAgainClicked"),this.Vc.telemetryData.TotalTimeTakenToMerge=la.toString(),Za.a(ki.rW,t,la,S));this.Vc.w9b=!1}Yrk(){this.Vc.w9b=!1;
if(!("Seen"in this.Vc.telemetryData)){this.VM("OnAgendaCardShown");this.eYa.start();this.Vc.telemetryData.Seen="true";P.a.J(576746627,813,50,"AgendaCard shown");const t=(new Sj(this.Vc.UP,this.Vc.LG)).Ljb("AgendaCardShown").Kpd("Seen").w1(this.Vc.documentOpenType).build();Za.a(ki.rW,!0,0,t);this.Vc.FPc.s5j()}}Hrk(){this.Vc.w9b?this.W5j():this.H2j()}H2j(){this.VM("OnAddSlidesClicked");this.eYa.stop();this.Vc.telemetryData.Tried="true";this.Vc.W7.Trd("OnAddSlidesClicked");P.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",
this.eYa.uOc);const t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).Ljb("AgendaCardShown").c0a("AddSlides").Kpd("Tried").w1(this.Vc.documentOpenType).build();Za.a(ki.rW,!0,this.eYa.uOc,t);this.Vc.FPc.U5j()}csk(){this.VM("OnAgendaToPPTApply");this.Vc.dSa=!0;this.Vc.telemetryData.Kept="true";this.Vc.telemetryData.Event="AgendaCompleted";const t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).Ljb("AgendaCompleted").w1(this.Vc.documentOpenType).build();this.v2g(!0,t);P.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}oAk(){this.Vc.w9b=
!0;this.VM("OnTryAgainClicked");this.Vc.telemetryData.Tried="true";this.Vc.telemetryData.Event="AgendaTryAgain";this.Vc.W7.Trd("OnTryAgainClicked");P.a.J(556561858,813,50,"AgendaCard retry attempt")}W5j(){const t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).Ljb("AgendaMergeError").c0a("TryAgain").Kpd("Tried").w1(this.Vc.documentOpenType).build();Za.a(ki.rW,!0,0,t)}ask(){this.VM("OnAgendaDialogShown");this.Vc.XS="Loading";P.a.J(556602440,813,50,"AgendaDialog shown");const t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).SKa(this.Vc.XS).w1(this.Vc.documentOpenType).build();
Za.a(ki.rW,!0,0,t)}u2g(t){this.VM("OnAgendaThemePaneLoadedSuccess");this.Vc.XS=t?"ThemeSuggestions":"ThemeSuggestionsFailure";t=this.Vc.W7.zNb("OnAddSlidesClicked");this.Vc.telemetryData.ThemePaneLoadingTime=t.toString();const S=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).SKa(this.Vc.XS).w1(this.Vc.documentOpenType).build();Za.a(ki.rW,!0,t,S)}hgi(t){this.VM("ThemeDeckSuggestionId");this.Vc.telemetryData.SelectedDeckSuggestionId=t}mAk(t){"V2"===this.Vc.LG&&(this.VM("OnTriggerDifferentThemeWorkflow"),
this.Vc.XS="ThemeSuggestions",this.Vc.W7.Trd("TriggerDeckLevelDesigner_"+t),t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).SKa(this.Vc.XS).Rod(t).c0a("ThemeSelected").w1(this.Vc.documentOpenType).build(),Za.a(ki.rW,!0,0,t))}t2g(t,S){this.VM("OnAgendaDeckPreviewLoaded");this.Vc.XS=S?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";S=this.Vc.W7.zNb("TriggerDeckLevelDesigner_"+t);this.Vc.telemetryData["DeckPreviewLoadTime_"+t]=S.toString();t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).SKa(this.Vc.XS).Rod(t).w1(this.Vc.documentOpenType).build();
Za.a(ki.rW,!0,S,t)}Zrk(t){const S=this.Vc.W7.zNb("TriggerDeckLevelDesigner_"+t);this.VM("OnAgendaDeckPreviewError");this.Vc.XS="AgendaDeckPreviewError";let la="";"DeckPreviewFailure"in this.Vc.telemetryData&&(la=this.Vc.telemetryData.DeckPreviewFailure.toString());this.Vc.telemetryData.DeckPreviewFailure=la+t.toString()+";";t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).SKa(this.Vc.XS).Rod(t).w1(this.Vc.documentOpenType).build();Za.a(ki.rW,!1,S,t)}bsk(t,S){this.VM("OnAgendaDialogThemeApply");this.Vc.XS=
S?"AgendaDeckMergeError":this.Vc.XS;this.Vc.W7.Trd("AgendaToPptDialogThemeApply");t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).Rod(t).SKa(this.Vc.XS).c0a(S?"TryAgain":"Apply").w1(this.Vc.documentOpenType).build();Za.a(ki.rW,!0,0,t)}b3g(){this.VM("OnCancelClicked");this.Vc.dSa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaCancelled";P.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).c0a("Cancel").w1(this.Vc.documentOpenType);
"V2"===this.Vc.LG?t.SKa(this.Vc.XS):t.Ljb("AgendaMergeError");Za.a(ki.rW,!0,0,t.build())}fuk(){this.VM("OnDismissClicked");this.Vc.dSa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaDismissed";P.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).c0a("Dismiss").w1(this.Vc.documentOpenType);"V2"===this.Vc.LG?t.SKa(this.Vc.XS):t.Ljb("AgendaMergeError");Za.a(ki.rW,!0,0,t.build())}q5g(){this.VM("OnMergingErrorInAgenda");
this.Vc.dSa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaError";const t=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).w1(this.Vc.documentOpenType);"V2"===this.Vc.LG?(this.Vc.XS="AgendaMergeError",t.SKa("AgendaMergeError")):t.Ljb("AgendaMergeError");this.v2g(!1,t.build())}CJe(t){let S=!1;this.VM("OnUndoRedoClicked");let la=(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).w1(this.Vc.documentOpenType);if("Kept"in this.Vc.telemetryData){this.Vc.telemetryData.Kept=(!t).toString();
const Ca=t?"UndoClicked":"RedoClicked";this.Vc.telemetryData.Event=Ca;la=la.c0a(Ca)}else S=!0,la.c0a("UndoRedoPostAgendaKept");Za.a(ki.rW,!0,0,la.build());P.a.J(576746629,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!t).toString(),S.toString())}b2k(t){this.VM("ReportCorrelationID");this.Vc.telemetryData.CorrelationId=t;this.Vc.gW=t}m2k(t){this.VM("ReportInitialUserThemeType");this.Vc.telemetryData.InitialUserThemeType=t;this.Vc.UP=t}xSe(t){this.VM("ReportAgendaToPptFlowVersion");this.Vc.telemetryData.AgendaToPptFlowVersion=
t;this.Vc.LG=t}V1k(t){this.VM("ReportAgendaScore");this.Vc.telemetryData.AgendaScore=t.toString();1===t&&this.k2k()}k2k(){this.VM("ReportHighConfidenceAgendaDetected");this.Vc.telemetryData.HighConfidenceAgendaDetected="true";this.Vc.FPc.$Zc=!0}dispose(){P.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",Ie.c(this.Vc.telemetryData))}t2k(){if(!this.Vc.telemetryData||!Cb.a.count(this.Vc.telemetryData))return"";const t=Ie.c(this.Vc.telemetryData);if(this.Vc.Zsd===t)return"";this.Vc.Zsd=t;if("Kept"in this.Vc.telemetryData){const S=
(new Sj(this.Vc.UP,this.Vc.LG)).d6(this.Vc.gW).Kpd("Kept").w1(this.Vc.documentOpenType).build(),la=Boolean.parse(this.Vc.telemetryData.Kept.toString());Za.a(ki.rW,la,0,S);la&&this.Vc.FPc.r4j()}this.Vc.dSa&&(this.zXe(),this.Vc.dSa=!1);P.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Vc.Zsd,this.Vc.dSa.toString());return t}VM(t){this.Vc.telemetryData||(P.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",t),this.zXe())}static K9i(t){return t.GQ?
"NewDocument":t.qVa?"ViewOnlyDocument":"EditDocument"}}ki.rW="AgendaToPptEvents";Object(h.a)(ki,"AgendaMetrics",null,[629]);class nf{constructor(){this.Ha=this.K=null;this.ORg=!0;this.Vsg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.iO=null}get name(){return"PowerPointWebEditor.AgendaConverter"}Zb(t){this.K=t;this.K.register(629,"PowerPointWebEditor.IAgendaMetrics").ma().oa(()=>new ki);this.K.register(sk,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().oa(()=>new sk(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").xd(7),this.K.resolve("Common.IAppSettingsManager")));this.K.register(630,"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().oa(()=>new Ef(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");
const S=qn.a(this.K);Ab.a("AgendaToPPT.DisableLocalizedStrings")?S("agendaConverter").then(()=>{this.K.register(631,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>new ie(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{}):S("powerpoint-agenda-to-ppt-strings").then(()=>{S("agendaConverter").then(()=>{this.K.register(631,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>new ie(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(n.a)(this,this.PUk,"registerAgendaDetectionEventHandler"))}dispose(){}PUk(){this.Ha=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.iO=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const t=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ha.GRi&&this.ORg&&2===t.mode&&(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(S=>{S.tia(this.Vsg);
S.qhh(this.Vsg,Object(n.a)(this.iO,this.iO.u_,"handleAnnotationEvent"))}),this.ORg=!1)}static main(){e.a.instance.Dc(new nf)}}Object(h.a)(nf,"AgendaConverterPackage",null,[2,3]);var li=d(687);class cn{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd){this.Ubc=0;this.ia=t;this.Rb=S;this.la=la;this.Fa=Ca;this.qe=Na;this.pa=qb;this.Mm=Pb;this.uE=xc;this.Pu=ed;this.Yn=dd;this.Ewa=fd}wb(){this.t5h();this.la.yKk&&this.lVf()&&this.Ewa.continueWith(()=>{this.Ewa.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}t5h(){this.ia.ra(Va.a.Zhb,
$a.a.application,Object(n.a)(this,this.Zhb,"presentToTeams"),4);this.ia.ra(Va.a.DMe,$a.a.application,Object(n.a)(this,this.Zhb,"presentToTeams"),4);this.ia.ra(Va.a.CMe,$a.a.application,Object(n.a)(this,this.Zhb,"presentToTeams"),4)}noh(){this.Pu.hide();this.r4d()}r4d(){let t;nj.a.fud();t=this.DBk();this.showDialog();return t}DBk(){this.Yn.Q$b=!0;const t=Kc.a.create().toString(),S=this.qe.documentUrl;try{const Ca={};Ca.pptSharingUrl=li.b(S);const Na=encodeURIComponent(Wd.c(Ca));let qb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}",
"1",t,Na);if(!cb.a.Wa(null)){const Pb=db.a.YD(null);qb=qb+"&fqdn="+Pb;const xc=encodeURIComponent(Wd.c({joinUrl:null}));qb=qb+"&meetingContext="+xc}var la=qb;r.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.Ubc,t);window.open(la,"_top")}catch(Ca){return r.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",Ca),!1}return!0}showDialog(){const t=new Oa.StandardDialog;t.yd=4;t.Xe(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);t.Xe(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);
t.Gx(ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(n.a)(this,this.cnc,"protocolLaunchingDialogResultHandler"))}cnc(t){1===t||0===t?(r.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.A_a()):2===t&&(r.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(Va.a.CMe,2))}A_a(){this.ia.La(Va.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}lVf(){return!!this.qe.documentUrl}Zhb(t,
S,la){if(!this.lVf())return r.ULS.sendTraceTag(523084879,838,10,"PresentToTeamsActor: Document not supported"),8;if(1===la)return 32;this.Ubc=t;if(this.Mm.isPaused)return this.Fa.Ed(),this.r4d()?32:8;this.pa.Rh();this.Fa.Ed();if(t===Va.a.CMe||1===this.Rb.mode)return this.r4d()?32:8;this.uE.C3(!0,!0,()=>{this.noh()},()=>{r.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.noh();return!0});this.Pu.show(!1,this.Ubc);return 32}G5(){}F5(){}}Object(h.a)(cn,"PresentToTeamsActor",
null,[145]);class dn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}Zb(t){this.K=t}init(){v.AFrameworkApplication.fa.ff(()=>{(new cn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),
this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),Xe.a.av(A.a.instance.Ja("Common.ISystemInitiatedFeedback")))).wb()})}dispose(){}static main(){e.a.instance.Dc(new dn)}}Object(h.a)(dn,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var En=d(737),Pk=d(24);class bk{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=
0}}Object(h.a)(bk,"DesignerSuggestionApplyInfo",null,[]);var uj=d(337),og=d(527),ol=d(111);class ck{constructor(){this.XHc=null}}Object(h.a)(ck,"IdeasSlideSuggestionWrapper",null,[]);var Nm=d(103);class Fn{constructor(){this.trigger=null;this.cid=this.sid=0;this.SN=null;this.timestamp=new Date;this.correlationId=Kc.a.create().toString()}}Object(h.a)(Fn,"DesignerRequestData",null,[]);var en=d(200);class Cl{}Object(h.a)(Cl,"SlideSuggestionData",null,[]);class Nd{}Nd.Qnk="mivTitle";Nd.Pnk="mivSubtitle";
Nd.Ddd="mivContainer";Nd.Onk="mivButtonsContainer";Nd.g_g="mivButton";Nd.Nnk="mivButtonImage";Nd.rGb="mivOverlayContainer";Nd.SEe="mivIcon";Nd.sGb="mivTerm";Nd.i_g="mivFrame";Nd.Rnk="mivView";Nd.j_g="mivIdx";Nd.UEe="mivKeepFocusStart";Nd.TEe="mivKeepFocusEnd";Nd.GRf="Editor";Nd.x1d="EditorContainer";Nd.qRi="EditorTitle";Nd.mRi="EditorSubtitleContainer";Nd.IRf="EditorSubtitle";Nd.aRi="EditorBucketContainer";Nd.r8a="EditorPrev";Nd.p3b="EditorPrevDisabled";Nd.jvb="EditorPrevEnabled";Nd.w1d="EditorBucketCurrent";
Nd.bRi="EditorBucketTotalCount";Nd.xRf="EditorBucketTotal";Nd.hvb="EditorNext";Nd.ivb="EditorNextEnabled";Nd.o3b="EditorNextDisabled";Nd.dRi="EditorDescription";Nd.gRi="EditorIgnoreContainer";Nd.n3b="EditorIgnore";Nd.kRi="EditorSeeMoreContainer";Nd.r3b="EditorSeeMoreLabel";Nd.yRf="EditorCardContent";Nd.LRf="EditorSuggestionsContainer";Nd.IRa="EditorSuggestionContainer";Nd.COc="EditorSuggestionArrow";Nd.nRi="EditorSuggestionCheck";Nd.KRf="EditorSuggestionText";Nd.JRf="EditorSuggestionInstances";Nd.hRi=
"EditorNoMoreContainer";Nd.oRi="EditorSvgCheck";Nd.rRi="EditorWhiteCheck";Nd.fRi="EditorGreenFill";Nd.eRi="EditorGreenBorder";Nd.iRi="EditorNoMoreLabel";Object(h.a)(Nd,"IdeasCss",null,[]);class Ah{}Ah.I8b="IdeasPane";Ah.HRa="editorSuggestionIdx";Ah.YK="ClosePane";Ah.dCj="IdeasPaneOpen";Ah.bjc=6;Ah.kmk=3;Ah.sNf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(h.a)(Ah,"IdeasPaneConstants",null,[]);var Se=d(381),Mj=d(169);class ue{constructor(t,S,la,Ca,Na,qb,Pb){this.tec=
null;this.ua=t;this.oc=S;this.la=la;this.Sb=Ca;this.Y$c=(t=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.Z$c=t?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.zb=Na;this.qe=qb;this.yBb=Pb}xEk(t){const S=[];try{if(!t||!t.SlideSuggestions)return P.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),S;for(let la=0;la<t.SlideSuggestions.length;la++){if(!t.SlideSuggestions[la])continue;
const Ca=t.SlideSuggestions[la].Base64Img;let Na=null;try{Na=Object.assign(new Cl,{suggestionIndex:t.SlideSuggestions[la].Index.toString(),suggestionCid:t.SlideSuggestions[la].SlideId.Cid.toString(),suggestionSid:t.SlideSuggestions[la].SlideId.Sid.toString(),imageData:Ca.startsWith("data:image")?Ca:"data:image/png;base64,"+Ca,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)})}catch(qb){P.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),
Na=null}Na||(Na=Object.assign(new Cl,{suggestionIndex:t.SlideSuggestions[la].Index.toString(),suggestionSid:t.SlideSuggestions[la].SlideSid.toString(),imageData:Ca.startsWith("data:image")?Ca:"data:image/png;base64,"+Ca,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)}));Array.add(S,Na)}}catch(la){P.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",la)}return S}m9i(t,S,la){if(!t)throw Error.argumentNull("suggestionsContainer");
return t.querySelector("#"+S+" ."+ue.pQa+'[correlationId="'+la+'"]')}Qae(){return this.la.HMi?this.la.GMi:this.la.FMi}pXc(t){if(!this.la.designerIncrementalRenderEnabled)return!1;let S=!0;switch(t){case Se.a.moreIdeas:S=!1;break;case Se.a.newDocument:S=!1}return S}eSe(t){P.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Sb.correlationId,t.Y8a);if(t.Nub&&t.EPc&&t.wga){var S=this.Qie(),la=t.wga.parentNode.parentNode.id;if(t.PZe&&this.la.uRa&&t.Y8a)switch(t.Nub.DocumentUpsellStatus){case 0:this.L8h(t.wga);
break;case 1:this.g7h(t.wga);break;case 2:this.Q6h(t.wga)}t.Y8a&&this.la.MOc&&this.ekh(t.wga);var Ca;if(Ca=t.Y8a?this.fEi(t.EPc,t.Kh,t.wga,S,t.Lvd):this.m9i(t.wga,la,t.Kh))try{const qb=this.Sb.vQa,Pb=!of.a.Wa(qb)&&la===Ah.I8b,xc=this.Ami(t.Nub,Pb,qb);if(t.Y8a){this.Sb.z2e=new Date;t.Lvd&&this.Irl(t.tVi);for(var Na=0;Na<Ca.childNodes.length;Na++){let ed=Ca.childNodes[Na];t.Lvd&&this.Ikl(xc,Na)?ue.$ml(S,Na,ed):this.aSe(Pb?qb[Na].Type:0,t.wga,ed,la,t.EPc,xc[Na.toString()],Na,t.PZe,t.Nub.DocumentUpsellStatus)}this.la.Eja&&
t.Nub.HasPaginationInfo&&this.Uwh(t.wga,t.Kh)}else if(t.Lvd){P.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Sb.correlationId,Cb.a.count(xc));for(Na of Object.keys(xc)){const ed=parseInt(Na);let dd=t.wga.querySelector("#"+la+" ["+ue.jCa+'="'+ed+'"]');xc[Na]&&dd&&Sys.UI.DomElement.containsCssClass(dd.firstChild,"IncSuggestionPlaceholder")&&this.aSe(Pb?qb[ed].Type:0,t.wga,dd,la,t.EPc,xc[Na],ed,t.PZe,t.Nub.DocumentUpsellStatus)}}}catch(qb){P.a.J(510248773,
829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Sb.correlationId,qb)}}}f1k(t,S,la,Ca){try{if(!(t&&t.SlideSuggestions&&t.SlideSuggestions.length&&S))return!1;this.HWc(S);const Na=S.querySelector("."+ue.pQa);if(!Na)return!1;const qb=Na.childNodes.length,Pb=Na.childNodes.length+t.SlideSuggestions.length,xc=this.Qie(),ed=S.parentNode.parentNode.id;for(let dd=0;dd<t.SlideSuggestions.length;++dd){const fd=this.zKf(qb+dd,Pb,xc);this.aSe(0,S,fd,ed,Pb,t.SlideSuggestions[dd],
qb+dd,Ca,t.DocumentUpsellStatus);Na.appendChild(fd)}t.HasPaginationInfo&&this.Uwh(S,la);return!0}catch(Na){return P.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",Na),!1}}Ami(t,S,la){const Ca={};if(S)for(const Na of la)switch(Na.Type){case 0:S=Na;la=null;for(const qb of t.SlideSuggestions)if(qb.Index===S.IndexInDesigner){la=qb;break}Ca[Na.Index.toString()]=la;break;default:Ca[Na.Index.toString()]=Na}else for(const Na of t.SlideSuggestions)Ca[Na.Index.toString()]=Na;
return Ca}Ikl(t,S){S=S.toString();return!(S in t)||!t[S]}L8h(t){const S=Ac.a.Ie();S.className="DesignerFreeTrialCardContainer";const la=Ac.a.Ie();la.className="DesignerFreeTrialCardTitle";la.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Ca=Ac.a.Ie();Ca.className="DesignerFreeTrialCardContent";Ca.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.Qae());const Na=Ac.a.Ie();Na.className="DesignerStartFreeTrialButtonsContainer";const qb=Ac.a.Ie();
qb.className=ue.Psb;qb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;qb.tabIndex=0;qb.setAttribute(pa.a.ns,qb.innerText);qb.setAttribute(pa.a.af,pa.a.Au);const Pb=Ac.a.Ie();Pb.className=ue.ZIc;const xc=document.createElement("i");xc.className=ue.eJc;xc.style.lineHeight="20px";xc.setAttribute("Unselectable","on");const ed=Ac.a.Ie();ed.className="DesignerStartTrialGoPremiumButtonText";ed.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ed.setAttribute("Unselectable","on");
Pb.setAttribute(pa.a.ns,ed.innerText);Pb.setAttribute(pa.a.af,pa.a.Au);Pb.tabIndex=0;Pb.appendChild(xc);Pb.appendChild(ed);Na.appendChild(qb);Na.appendChild(Pb);S.appendChild(la);S.appendChild(Ca);S.appendChild(Na);S.setAttribute(pa.a.ns,String.format("{0}. {1}",la.innerText,Ca.innerText));S.setAttribute(pa.a.af,pa.a.bCa);t.appendChild(S)}PKf(){const t=Ac.a.Ie();t.className="DesignerInFreeTrialView";const S=document.createElement("i");S.className=v.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":
"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const la=Ac.a.Ie();la.className=ue.u_b;la.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;la.tabIndex=0;const Ca=Ac.a.Ie();Ca.className=v.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Ca.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;la.setAttribute(pa.a.af,pa.a.gSd);la.setAttribute(pa.a.y6a,pa.a.Nia);la.setAttribute(pa.a.ns,la.innerText);t.appendChild(S);t.appendChild(la);t.appendChild(Ca);
t.setAttribute(pa.a.ns,la.innerText+" "+Ca.innerText);t.setAttribute(pa.a.af,pa.a.bCa);return t}Xyl(){const t=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(t)for(let S=0;S<t.length;S++){const la=t[S];if(la.parentNode){const Ca=this.PKf();la.parentNode.replaceChild(Ca,la)}}this.OGh()}g7h(t){const S=this.PKf();t.appendChild(S)}Q6h(t){const S=Ac.a.Ie();S.className="DesignerFreeTrialCardContainer";const la=Ac.a.Ie();la.className="DesignerFreeTrialCardTitle";la.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;
const Ca=Ac.a.Ie();Ca.className="DesignerFreeTrialCardContent";Ca.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;const Na=Ac.a.Ie();Na.className=ue.t_b;const qb=document.createElement("i");qb.className=ue.eJc;qb.style.lineHeight="20px";const Pb=Ac.a.Ie();Pb.className="DesignerTrialExhaustedGoPremiumButtonText";Pb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Na.setAttribute(pa.a.ns,Pb.innerText);Na.setAttribute(pa.a.af,pa.a.Au);Na.tabIndex=0;Na.appendChild(qb);Na.appendChild(Pb);
S.appendChild(la);S.appendChild(Ca);S.appendChild(Na);S.setAttribute(pa.a.ns,String.format("{0}. {1}",la.innerText,Ca.innerText));S.setAttribute(pa.a.af,pa.a.bCa);t.appendChild(S)}Uwh(t,S){const la=Ac.a.Ie();la.className=ue.aUd;la.setAttribute(ue.Osb,S);la.tabIndex=0;S=new vc.a;S.lh(16,16);S.Dya("0,0,2048,2048");const Ca=new Mj.a;Ca.v1("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
S.appendChild(Ca);S=S.xa;S.setAttribute("class","DesignerMoreIdeasButtonIcon");la.appendChild(S);S=Ac.a.Ie();S.className="DesignerMoreIdeasButtonLabel";S.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;la.appendChild(S);la.setAttribute(pa.a.ns,S.innerText);la.setAttribute(pa.a.af,pa.a.Au);t.appendChild(la)}knl(t){if(t){var S=Ac.a.SA();S.className="DesignerMoreIdeasLoading";S.src=Qe.a.ZK(Zb.a.Zna);t.appendChild(S)}}HWc(t){if(t){var S=t.querySelector("."+ue.aUd);S&&t.removeChild(S);(S=t.querySelector(".DesignerMoreIdeasLoading"))&&
t.removeChild(S)}}fEi(t,S,la,Ca,Na){const qb=Ac.a.Ie();qb.className=ue.pQa;qb.setAttribute(ue.Osb,S);qb.setAttribute(pa.a.ns,ResourceStrings.l_DesignerSuggestions);qb.setAttribute(pa.a.af,pa.a.FZb);Na&&(this.Sb.H_b=this.O5i());for(S=0;S<t;++S)qb.appendChild(this.zKf(S,t,Ca));la.appendChild(qb);return qb}zKf(t,S,la){const Ca=Ac.a.Ie();Ca.className=la?this.Y$c+"4x3":this.Y$c;Ca.setAttribute(ue.jCa,t);Ca.tabIndex=0;Ca.setAttribute(pa.a.ns,String.format(ResourceStrings.l_DesignerSuggestionItem,t+1));
Ca.setAttribute(pa.a.af,pa.a.YPa);Ca.setAttribute(pa.a.iSd,t+1);Ca.setAttribute(pa.a.jSd,S);return Ca}aSe(t,S,la,Ca,Na,qb,Pb,xc,ed){let dd=null;this.la.designerIncrementalRenderEnabled&&(S&&(dd=S.querySelector("#"+Ca+' [IncSuggestionPlaceholder="'+Pb+'"]')),dd&&Sys.UI.DomElement.addCssClass(dd,"ShimmerPaused"),this.m4j(Pb,Na));S=!1;switch(t){case 0:this.Bfl(la,qb,Pb);S=(t=xc&&this.la.uRa)&&1!==ed;Na=Ca=ed=!1;if(qb&&qb.Categories)for(const fd of qb.Categories)2===fd?ed=xc&&!t:1===fd?Ca=!0:3===fd?Na=
!0:4===fd&&this.wee(la,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Pb);(ed||S)&&this.tgl(la);Ca?this.wee(la,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Pb):Na&&(this.wee(la,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Pb),la.setAttribute(ue.STd,ue.STd),la.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.r6h(la,qb);break;case 1:this.d1k(la,qb);break;case 2:this.V0k(la);break;case 3:case 4:this.q1k(la,qb)}dd&&dd.parentNode.removeChild(dd);qb=Ac.a.Ie();qb.className=ue.iJc;S&&(qb.style.visibility=jb.a.visible,la.removeAttribute("tabindex"),la.setAttribute(pa.a.SK,pa.a.jC));la.appendChild(qb)}d1k(t,S){if(S){t.className=Nd.Ddd;t.setAttribute(pa.a.ns,ResourceStrings.L_MakeItVisualCardTitle);var la=Ac.a.Sn();la.className=Nd.Qnk;la.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Ca=Ac.a.Sn();
Ca.className=Nd.Pnk;Ca.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Na=Ac.a.Ie();Na.className=Nd.Onk;Na.setAttribute(pa.a.af,pa.a.FZb);var qb=0,Pb=new Xf.a,xc=Math.min(Ah.bjc,S.SearchTerms.length);for(let ed=0;ed<xc;ed++)qb=this.eLf(S.SearchTerms[ed].Term,Na,Pb,ed,qb);for(S=xc;S<Ah.bjc;S++)for(const ed of Ah.sNf)if(!Pb.contains(ed)){qb=this.eLf(ed,Na,Pb,S,qb);break}t.appendChild(la);t.appendChild(Ca);t.appendChild(Na);this.Sb.Scd=!0}}eLf(t,S,la,Ca,Na){const qb=Ac.a.Ie();qb.className=Nd.g_g;
qb.setAttribute(pa.a.af,pa.a.YPa);const Pb=Nd.sGb+"."+Ca,xc=Ac.a.SA();xc.className=Nd.Nnk;xc.src=({wyb:Na}=this.Jdj(t,la,Na)).returnValue;xc.setAttribute(pa.a.U2,Pb);la=Ac.a.Ie();la.className=Nd.rGb;la.tabIndex=0;la.setAttribute(Nd.j_g,Ca);la.setAttribute(pa.a.af,pa.a.Au);Ca=document.createElement("i");Ca.className=Nd.SEe;Ca.innerText="\ue721";Ca.setAttribute(pa.a.af,pa.a.pN);const ed=Ac.a.Sn();ed.className=Nd.sGb;ed.innerText=t;ed.id=Pb;qb.appendChild(xc);qb.appendChild(la);la.appendChild(Ca);la.appendChild(ed);
S.appendChild(qb);return Na}Jdj(t,S,la){for(const Ca of Ah.sNf)if(Ca.toLowerCase()===t.toLowerCase())return S.add(Ca),{returnValue:this.qe.rk(t+".png"),wyb:la};return{returnValue:this.qe.rk("stock"+la++ +".png"),wyb:la}}Afl(t,S){if(t){var la=document.createElement("video");la.className="SuggestedVideoBackgroundContainer";la.setAttribute("Src",S);la.setAttributeNode(document.createAttribute("muted"));en.a.qUj()||(la.setAttributeNode(document.createAttribute("autoplay")),la.setAttributeNode(document.createAttribute("loop")),
la.addEventListener("canplay",()=>{la.muted="true";la.play()}));t.appendChild(la)}}wee(t,S,la,Ca){if(t){var Na=Ac.a.SA();Na.src=this.qe.rk(S);Na.className="SuggestedMediaIcon";S=Ac.a.Sn();S.className="SuggestedMediaContainer";S.appendChild(Na);t.setAttribute(pa.a.ns,String.format(la,Ca+1));S.setAttribute("aria-hidden",pa.a.jC);S.setAttribute("Unselectable","on");t.appendChild(S)}}r6h(t,S){t&&S&&S.DesignDescription&&0!=S.DesignDescription.length&&t.setAttribute(pa.a.ns,S.DesignDescription)}tgl(t){if(t)if(this.la.uRa)Sys.UI.DomElement.addCssClass(t,
jb.a.bmc);else{t.setAttribute(ue.bJc,ue.bJc);var S=t.getAttribute(pa.a.ns);S&&t.setAttribute(pa.a.ns,String.format("{0}. {1}",S.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));pa.a.eP(t,pa.a.y6a,pa.a.Nia);S=Ac.a.Ie();S.className=ue.hJc;var la=document.createElement("i");la.className=ue.eJc;S.appendChild(la);t.appendChild(S)}}OGh(){const t=document.getElementsByClassName(ue.x_b);if(t)for(let S=0;S<t.length;S++){Sys.UI.DomElement.removeCssClass(t[S].parentNode,jb.a.bmc);t[S].parentNode.tabIndex=
0;t[S].parentNode.removeAttribute(pa.a.SK);const la=ia.a.gda(t[S].parentNode,ue.iJc);!la||la.getAttribute(ue.gUd)&&la.getAttribute(ue.gUd).toString()===ue.ECf||(la.style.visibility=jb.a.hidden)}}zDl(){if(this.la.uRa){var t=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(t)for(var S=0;S<t.length;S++)t[S].parentNode.removeChild(t[S]);if(t=document.getElementsByClassName("DesignerInFreeTrialView"))for(S=0;S<t.length;S++)t[S].parentNode.removeChild(t[S]);this.OGh()}else if(t=document.getElementsByClassName(ue.hJc))for(S=
0;S<t.length;S++){t[S].style.display="none";const Ca=t[S].parentNode;Ca.removeAttribute(ue.bJc);Ca.removeAttribute(pa.a.y6a);var la=Ca.getAttribute(pa.a.ns);la&&(la=la.toString(),la=la.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Ca.setAttribute(pa.a.ns,la))}}Bfl(t,S,la){if(t&&S)try{let Ca=!1;try{t.setAttribute(ue.Rsb,S.SlideId.Sid),t.setAttribute(ue.fUd,S.SlideId.Cid),Ca=!0}catch(qb){P.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
Ca=!1}Ca||t.setAttribute(ue.Rsb,S.SlideSid);const Na=Ac.a.SA();Na.className=ue.x_b;Na.src=S.Base64Img;this.Sb.wsa.contains(S.Index)||this.Sb.wsa.add(S.Index);this.la.tNc&&!cb.a.Wa(S.DesignerMediaURL)&&S.Categories&&of.a.contains(S.Categories,1)&&this.Afl(t,S.DesignerMediaURL);t.appendChild(Na);P.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",la,this.Sb.correlationId)}catch(Ca){t.parentNode.removeChild(t),P.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
la,this.Sb.correlationId,Ca)}}V0k(t){if(of.a.Wa(this.Sb.GW)||!this.Sb.Yzi())t.style.display=jb.a.none;else{t.className=Nd.x1d;var S=Ac.a.Sn();S.className=Nd.qRi;S.innerText=ResourceStrings.L_ConsistencyCardTitle;var la=Ac.a.Ie();la.className=Nd.mRi;var Ca=Ac.a.Sn();Ca.className=Ca.id=Nd.IRf;Ca.innerText=Ca.title=this.Sb.GW[0].critiques[0].explanationLabel;var Na=Ac.a.Ie();Na.className=Nd.aRi;var qb=Ac.a.Sn();qb.innerText="<";qb.tabIndex=0;Sys.UI.DomElement.addCssClass(qb,Nd.r8a);Sys.UI.DomElement.addCssClass(qb,
Nd.p3b);qb.id=Nd.r8a;var Pb=Ac.a.Sn();Pb.innerText="1";Pb.id=Nd.w1d;this.Sb.BN=0;var xc=Ac.a.Sn();xc.innerText="/";var ed=Ac.a.Sn();ed.className=Nd.bRi;ed.id=Nd.xRf;ed.innerText=this.Sb.GW.length.toString();var dd=Ac.a.Sn();dd.innerText=">";dd.tabIndex=0;dd.className=dd.id=Nd.hvb;0<this.Sb.GW.length-1?Sys.UI.DomElement.addCssClass(dd,Nd.ivb):Sys.UI.DomElement.addCssClass(dd,Nd.o3b);Na.appendChild(qb);Na.appendChild(Pb);Na.appendChild(xc);Na.appendChild(ed);Na.appendChild(dd);la.appendChild(Ca);la.appendChild(Na);
Ca=Ac.a.Sn();Ca.className=Nd.dRi;Ca.innerText=ResourceStrings.L_ConsistencyCardDescription;Na=ue.CKf();this.Xag(Na,0);qb=Ac.a.Ie();qb.className=Nd.gRi;Pb=Ac.a.Ie();Pb.className=Nd.n3b;Pb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Pb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Pb.tabIndex=0;qb.appendChild(Pb);Pb=Ac.a.Ie();Pb.className=Nd.kRi;xc=Ac.a.Sn();xc.className=Nd.r3b;xc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;xc.tabIndex=0;Pb.appendChild(xc);xc=Ac.a.Ie();xc.id=Nd.yRf;
xc.appendChild(la);xc.appendChild(Ca);xc.appendChild(Na);xc.appendChild(qb);t.appendChild(S);t.appendChild(xc);t.appendChild(Pb);this.Sb.BOc=!0}}q1k(t,S){if(S){t.className=ue.PCf;t.setAttribute(pa.a.ns,S.TitleText);t.setAttribute(ue.jCa,S.Index);var la=this.ttl(S.ExecutionActionName);if(la){var Ca=Ac.a.SA();Ca.src=this.qe.rk("pegal.png");Ca.className=la;var Na=Ac.a.Sn();Na.className="cui-img-container cui-img-24by24";Na.appendChild(Ca);t.appendChild(Na)}Ca=Ac.a.Sn();Ca.className="DesignerSuggestedActionTitle";
Ca.innerText=S.TitleText;Na=Ac.a.Sn();Na.className="DesignerSuggestedActionSubtitle";Na.innerText=S.DescriptionText;S=Ac.a.Ie();S.className=la?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";S.appendChild(Ca);S.appendChild(Na);t.appendChild(S)}}ekh(t){try{if(this.yBb&&this.yBb.instance){const S=Ac.a.Ie();S.id="AgendaCardContainer";S.className="AgendaCardContainer";t.appendChild(S);this.yBb.instance.bwh(S)}}catch(S){P.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Sb.correlationId,S)}}Rti(){try{this.yBb&&this.yBb.instance&&this.yBb.instance.Zce()}catch(t){P.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Sb.correlationId,t)}}ttl(t){switch(t){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}Xag(t,S){S=this.Sb.GW[S].critiques[0].suggestions;const la=Math.min(Ah.kmk,S.length);for(let Ca=0;Ca<la;Ca++)this.Rwj(t,S[Ca].description,S[Ca].numberOfInstances,
Ca)}Rwj(t,S,la,Ca){const Na=Ac.a.Ie();Na.className=Nd.IRa;Na.tabIndex=0;Na.setAttribute(Ah.HRa,Ca);const qb=Ac.a.Sn();qb.className=Nd.COc;qb.innerText="\u2192";qb.setAttribute(Ah.HRa,Ca);const Pb=Ac.a.Sn();Pb.className=Nd.KRf;Pb.innerText=S;Pb.setAttribute(Ah.HRa,Ca);S=Ac.a.Sn();S.className=Nd.JRf;S.innerText=String.format("[{0}]",la);S.setAttribute(Ah.HRa,Ca);Na.appendChild(qb);Na.appendChild(Pb);Na.appendChild(S);t.appendChild(Na)}Irl(t){this.asd();this.tec=new V.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.l4j(t)},void 0,"IncrementalRenderTimeoutTask");this.zb.Db(this.tec)}asd(){this.tec&&(this.zb.Mg(this.tec),this.tec=null)}l4j(t){this.asd();for(let S=0;S<t;S++)this.Sb.wsa.contains(S)||this.Sb.oXc.add(S)}m4j(t,S){if(!this.Sb.uQa.contains(t)&&(this.Sb.uQa.add(t),t=this.Sb.uQa.count,t===S&&(this.Sb.dZb=new Date,this.asd()),!this.Sb.VPb&&t>=this.Sb.H_b)){for(S=0;S<this.Sb.H_b;S++)if(!this.Sb.uQa.contains(S))return;this.Sb.VPb=new Date}}O5i(){const t=document.getElementById("WACDocumentPanel");
if(t){const S=this.la.useWideSuggestionThumbs,la=this.Qie();return Math.floor((t.offsetHeight-87)/(S||la?135:101))}return 1}Qie(){const t=this.Hu();return.01>=Math.abs(t.width/t.height-1.33)}NFf(t,S){this.X5e(this.vwb(t,S),S,!1)}rqh(t,S){this.X5e(t,S,!0)}CCl(t){if(t&&(t=t.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var S=-1!==t.className.indexOf("4x3");this.X5e(t,S,!1)}}X5e(t,
S,la){t&&(la?(t.className=S?this.Z$c+"4x3":this.Z$c,pa.a.eP(t,pa.a.z6a,pa.a.jC)):(t.className=S?this.Y$c+"4x3":this.Y$c,pa.a.eP(t,pa.a.z6a,pa.a.Nia)))}Hu(){return this.oc.Hu()}vwb(t,S){return t.querySelector("."+(S?this.Z$c+"4x3":this.Z$c))}get Ba(){return Object(D.a)(116,this.ua.Ba)}Woh(t,S){if(t){if(t=t.querySelector("["+ue.jCa+'="'+S+'"]'))S=Pc.a.ai(t),t.contains(Pc.a.LSa(new Sys.UI.Point(S.x,S.y)))&&t.contains(Pc.a.LSa(new Sys.UI.Point(S.x+S.width-1,S.y)))?t.contains(Pc.a.LSa(new Sys.UI.Point(S.x,
S.y+S.height-1)))&&t.contains(Pc.a.LSa(new Sys.UI.Point(S.x+S.width-1,S.y+S.height-1)))||t.scrollIntoView(!1):t.scrollIntoView(!Ab.a("Designer.ScrollIntoViewFix"))}else P.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static P_d(t){let S=null;try{S=Wd.a(t)}catch(la){P.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return S}static RDk(t){const S=t.CardData;let la=null;try{if(la=Wd.a(S),!t.SlideSuggestions&&
la)for(la=Ij.e(la,Ca=>0!==Ca.Type),t=0;t<la.length;t++)la[t].Index=t}catch(Ca){P.a.J(510248726,829,10,"parsing cards failed with exception: {0}",Ca)}return la}static $ml(t,S,la){la.style.backgroundColor="white";const Ca=Ac.a.Ie();Ca.className=t?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Ca.setAttribute("IncSuggestionPlaceholder",S);(xe.a.Vj||xe.a.fg)&&Sys.UI.DomElement.addCssClass(Ca,"Shimmer");la.appendChild(Ca)}static CKf(){const t=Ac.a.Ie();t.className=
t.id=Nd.LRf;return t}}ue.pQa="DesignerSuggestionList";ue.Osb="correlationId";ue.jCa="suggestionIndex";ue.Rsb="slideId";ue.fUd="slideCid";ue.bJc="isShownAsPremiumContent";ue.STd="containsAnimation";ue.ECf="Refreshing";ue.gUd="SourceTrigger";ue.x_b="SuggestionImg";ue.eJc="ms-Icon ms-Icon--Diamond";ue.hJc="ShadowedTriangleContainer";ue.iJc="DesignerSuggestionListDisabled";ue.aUd="DesignerMoreIdeasButton";ue.PCf="DesignerSuggestedActionResult";ue.u_b="DesignerInFreeTrialViewGoPremiumText";ue.t_b="DesignerFreeTrialCardGoPremiumButton";
ue.Psb="DesignerStartFreeTrialButton";ue.ZIc="DesignerStartFreeTrialGoPremiumButton";Object(h.a)(ue,"DesignerViewHelper",null,[615]);class Dl{constructor(){this.cid=this.sid=0;this.QWc=this.SN=this.trigger=null}}Object(h.a)(Dl,"PendingRequest",null,[]);class bj{constructor(){this.mBe=!1;this.LDb=null}get Cmg(){return this.mBe}get Hpg(){return this.LDb}static get inProgress(){const t=new bj;t.mBe=!0;t.LDb=new Date;return t}static get ready(){const t=new bj;t.mBe=!1;t.LDb=null;return t}}Object(h.a)(bj,
"RequestState",null,[]);var $g=d(336),Gn=d(436);class Hn{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff,Gh,gk,vj,mk,sl,On,Pn,bi,Qn,Rn,wn,fl,Il,qf,Vl,Em){this.hM=null;this.QIa=this.Czg=0;this.hGg=!1;this.JVa=this.Wfb=null;this.Tvg=!1;this.evj=(wj,yr,vo)=>{if(1===vo)return 32;try{this.rp&&this.rp.Fo&&this.rp.Fo.isVisible?vb.UISurfaces.zr().then(Wl=>{Wl.setSelectedTaskPane(ad.a.f_);return null}).catch(Wl=>{P.a.J(509354911,811,10,"DesignerPane::SelectPane exception: {0}",Wl.toString())}):this.ia.processAction(Va.a.Qvb,
2)}catch(Wl){return P.a.J(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",Wl.toString()),8}return 32};this.Ro=Pb;this.rp=xc;this.ir=ed;this.qy=dd;this.Sb=fd;this.ia=t;this.WT=S;this.ob=Na;this.Fa=qb;this.ua=we;this.Yf=Sf;this.Lc=Ff;this.la=gk;this.fc=la;this.Jb=Ca;this.wi=vj;this.Gma=mk;this.Oma=bj.ready;this.V9=sl;this.Fb=On;this.Oc=Pn;this.zb=bi;this.VFb=Qn;this.udc=fl;this.oc=Il;this.eM=qf;this.xw=Vl;this.Usg=Em;this.Bzg=Object(n.a)(this,this.Btj,"handleFirstRunExperienceEvent");
wn&&wn.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(wj=>{this.hGg=wj;return null});this.ia.paa(this)}wb(){this.la.rZc&&(this.ia.ra(Va.a.Cwh,$a.a.application,Object(n.a)(this,this.Bwh,"showHideIdeas"),4),this.ia.ra(Va.a.fZe,$a.a.application,Object(n.a)(this,this.Bwh,"showHideIdeas"),4),Ab.a("Designer.QueryNewPane")&&this.ia.ra(Va.a.Onc,$a.a.application,Object(n.a)(this,this.UNk,"queryShowHideDesignerPane"),96),(this.la.eB||this.la.$W)&&this.ia.ra(Va.a.I8g,$a.a.application,this.evj,4),this.ia.ra(Va.a.Qvb,
$a.a.application,Object(n.a)(this,this.eZe,"showHideDesigner"),4),this.ia.ra(Va.a.ZBa,$a.a.application,Object(n.a)(this,this.ZBa,"applyDesignerSuggestion"),4),this.ia.ra(Va.a.Wrb,$a.a.application,Object(n.a)(this,this.ZBa,"applyDesignerSuggestion"),4),this.ia.ya(Va.a.QYa,$a.a.application,Object(n.a)(this,this.OYa,"navigateDesignerSuggestion")),this.ia.ya(Va.a.IGb,$a.a.application,Object(n.a)(this,this.OYa,"navigateDesignerSuggestion")),this.ia.ya(Va.a.JGb,$a.a.application,Object(n.a)(this,this.OYa,
"navigateDesignerSuggestion")),this.ia.ya(Va.a.PYa,$a.a.application,Object(n.a)(this,this.OYa,"navigateDesignerSuggestion")),this.ia.ya(Va.a.FGb,$a.a.application,Object(n.a)(this,this.OYa,"navigateDesignerSuggestion")),this.ia.ya(Va.a.GGb,$a.a.application,Object(n.a)(this,this.OYa,"navigateDesignerSuggestion")),this.ia.ya(Va.a.HGb,$a.a.application,Object(n.a)(this,this.OYa,"navigateDesignerSuggestion")),this.ia.ya(Va.a.Fgb,$a.a.application,Object(n.a)(this,this.OYa,"navigateDesignerSuggestion")),
this.ia.ra(Va.a.uoa,$a.a.application,Object(n.a)(this,this.uoa,"reportSuggestionSessionInfo"),64),this.ia.ya(Va.a.COf,$a.a.application,Object(n.a)(this,this.Bzl,"triggerOnUndoRedo")),this.ia.ya(Va.a.tfe,$a.a.application,Object(n.a)(this,this.nag,"handleImageUploadForDesigner")),this.ia.ya(Va.a.XXc,$a.a.application,Object(n.a)(this,this.nag,"handleImageUploadForDesigner")),this.Gma.n6a(Object(n.a)(this,this.X0,"onSlidePresenceChanged")),this.Yf.tI(Object(n.a)(this,this.CMi,"designerTargetSlideChangedHandler")),
this.la.designerIncrementalRenderEnabled&&this.Lc.Lai(Object(n.a)(this,this.myk,"onRenderSuggestions")),this.la.Eja&&this.Lc.Z9h(Object(n.a)(this,this.Hwk,"onMoreIdesClicked")),this.la.uOf&&this.Lc.m6a(Object(n.a)(this,this.Cfa,"onRibbonTabSwitched")),this.la.HC&&this.Yf.vrb(Object(n.a)(this,this.AMi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.V9.VYb(Object(n.a)(this,this.wfa,"onBlockingStateChanged")),this.Yf.Luf(Object(n.a)(this,this.zfd,"onForceOutboundGraphTransactionDisposed")),
this.VFb.UYb(Object(n.a)(this,this.$gb,"onMarkedUndo")),this.la.V_d&&this.Oc.LPa(Object(n.a)(this,this.ghb,"onSessionEnding")),this.Oc.iC(Object(n.a)(this,this.Eo,"onSessionRehydrated")),this.udc&&this.udc.execute(t=>{t.avf(Object(n.a)(this,this.ZHe,"onEditorCritiques"))}),this.Usg&&this.Usg.execute(t=>{t.qai(Object(n.a)(this,this.zvk,"onHighConfidenceAgendaDetected"))}),this.la.vMi?(this.Czg=window.setTimeout(Object(n.a)(this,this.u4e,"tryTriggerNewDocDesignerRequest"),this.la.uMi),window.addEventListener("FREDecisionEvent",
this.Bzg,!0)):this.u4e(),!cb.a.Wa(this.la.XLe)&&this.DMi(this.la.XLe)&&(this.Hsj(),this.xzl(this.la.XLe)))}Btj(t){window.removeEventListener("FREDecisionEvent",this.Bzg,!0);window.clearTimeout(this.Czg);(t=t.detail)&&t.show&&t.show||this.u4e()}Ee(){const t=this.Fa.Fc(ad.a.f_);t.bindAction(oc.KeyInputManager.Oa(ua.a.Y1,0),Va.a.QYa);t.bindAction(oc.KeyInputManager.Oa(ua.a.VB,0),Va.a.QYa);t.bindAction(oc.KeyInputManager.Oa(ua.a.bF,0),Va.a.IGb);t.bindAction(oc.KeyInputManager.Oa(ua.a.Sq,4),Va.a.JGb);
t.bindAction(oc.KeyInputManager.Oa(ua.a.W1,0),Va.a.PYa);t.bindAction(oc.KeyInputManager.Oa(ua.a.UB,0),Va.a.PYa);t.bindAction(oc.KeyInputManager.Oa(ua.a.Tw,0),Va.a.FGb);t.bindAction(oc.KeyInputManager.Oa(ua.a.Sq,0),Va.a.GGb);t.bindAction(oc.KeyInputManager.Oa(ua.a.ZR,0),Va.a.HGb);t.bindAction(oc.KeyInputManager.Oa(ua.a.oP,0),Va.a.Fgb)}eZe(t,S,la,Ca,Na){return this.IM(this.rp,ad.a.f_,la,t,Na)}Bwh(t,S,la,Ca,Na){return Na||!this.Ro.isVisible?this.IM(this.rp,ad.a.bab,la,t,Na):0}IM(t,S,la,Ca,Na){var qb=
this.ua.presentation;qb=!!this.ua.Ba&&!!qb&&!this.fc.$c(qb);if(this.la.HC){const Pb=this.ob.Qe();qb=!!Pb&&1===Pb.length&&qb}if(!qb)return 16;if(!this.qy.isEnabled())return 8;if(1===la)return 32;Na||this.Fa.Ej(S,t.Fo.isVisible);Ca===Va.a.Qvb?this.Sb.correlationId&&!this.Sb.BAb(this.Sb.correlationId)||this.uda(Se.a.IOb):t.Fo.isVisible?t.Fo.Ap(!1,$g.a.LNb):(this.uda(Ca===Va.a.fZe?Se.a.IOb:Se.a.Ytc),t.Fo.Ap(!0,$g.a.none));return 32}UNk(t,S,la,Ca,Na){if(!Object(Pk.a)(ol.a,Na)||!this.rp||!this.rp.Fo)return 8;
Na.Lf(this.rp.Fo.isVisible);return 32}ZBa(t,S,la,Ca,Na){S=this.ua.presentation;if(!this.ua.Ba||!S||this.fc.$c(S))return 16;Ca=null;let qb=!0;Object(Pk.a)(bk,Na)?Ca=Na:Object(Pk.a)(ck,Na)&&(Ca=Na.XHc,qb=!1);if(!this.qy.isEnabled()||!Ca)return 8;if(this.qy.SCk())return P.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Ca.CorrelationId,t),8;if(1===la)return 32;if(!this.ob.Bs()){if(1===this.ob.Xd().length&&this.ob.Xd()[0].iy)return this.ob.Rh(),
P.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Ca.CorrelationId,t),8;this.ob.Rh()}if(!this.la.Eja&&this.Sb.OZ.sid===Ca.SuggestionSid)return P.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Ca.CorrelationId,Ca.SuggestionSid),2;la=this.Jb.oe(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&(this.Sb.VPa=
new Date),la.nc(S),la.jd=t,S.dDa=Ca,this.Sb.OZ=Q.a.VE(Ca.SuggestionSid,Ca.SuggestionCid),this.Sb.IT=!0,P.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ca.CorrelationId,t,Ca.SuggestionSid)}finally{la&&la.dispose()}this.la.designerBlockApplyUntilDraw?this.fc.Qra(S,this.ua.Ba,this.Fb.Ma,t):this.fc.hw(S,t);this.Ro.isVisible&&this.Fa.rf(ad.a.bab);qb&&this.Sb.pEe();return 32}OYa(t,S,la){S=this.ua.presentation;if(!this.ua.Ba||!S||this.fc.$c(S))return 16;
if(!this.qy.isEnabled())return 8;if(1===la)return 32;this.qy.Sxj(t);return 32}uoa(t,S,la,Ca,Na){if(this.qy.rp.Fo.isVisible)return 0;this.Jjb(Na.L_c,Na.n3k);return 32}Jjb(t,S,la){const Ca=this.Sb.correlationId;if(cb.a.Wa(Ca))P.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",S);else if(this.Sb.BAb(Ca))P.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",Ca,S);else{var Na=
{};Na.CachedTrigger=this.Sb.jUd;Na.SuggestionSlideId=this.Sb.OZ.sid.toString();Na.SuggestionSlideCreationId=this.Sb.OZ.cid.toString();Na.AppliedSuggestion=this.Sb.IT;Na.DisplaySuggestionsTimeoutInMs=this.la.U_d;Na.SuggestionsTimeout=this.Sb.fVa;Na.ClientAbort=this.Sb.pzb||this.qy.PCk();Na.DesignerPaneClosed=t;Na.ResetReason=S;Na.HoverPreviewDesignerTriggered=this.Sb.Xjg;Na.DesignerFixPaneOpenHint=this.la.wOf;Na.DesignerSendTraceRequestOnSessionEnded=this.la.V_d;Na.UseWin32DesignerIconEnabled=this.la.X_d;
Na.IsSimplifiedRibbon=this.iac();Ab.a("DesignerLogRetriggerReason")&&la&&(Na.RetriggerReason=la);this.la.uOf&&(Na.DesignerDesignTabTriggerEnabled=!0);this.rp.Ssa()&&(this.la.uRa?(Na[mf.a.pJh]=this.ir.Qae(),Na[mf.a.qJh]=!0,this.Sb.X_e&&(Na.StartUpsellFreeTrial=!0)):Na[mf.a.RIf]=!0);t=!!S&&0<=S.indexOf(Se.a.moreIdeas);this.la.Eja&&(Na.TermCorrelationId=Hn.xae(),t||(Na.TermAction=this.jnj()));la=Wd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());var qb={};qb.ClientOS=la.Os;
qb.Browser=la.Browser||"";qb.BrowserVersion=la.BrowserVersion||"";qb.BrowserMajorVersion=la.BrowserMajorVersion||"";qb.BrowserMinorVersion=la.BrowserMinorVersion||"";this.Sb.Gsc&&this.Sb.xga&&this.Sb.xga>this.Sb.Gsc&&(qb.SuggestionsE2ETimeMs=+this.Sb.xga-+this.Sb.Gsc);this.la.designerIncrementalRenderEnabled&&(this.ir.asd(),this.b0e(),Na[mf.a.Deg]=!0,qb.VisibleSuggestionsCount=this.Sb.H_b,0<this.Sb.oXc.count&&(qb.IncrementalRenderTimeoutIndexes=this.Sb.oXc.toArray().join(",")),0<this.Sb.nfa.count&&
(qb.MissingDesignerCardIndexes=this.Sb.nfa.toArray().join(",")),0<this.Sb.uQa.count&&(qb.CardIndexes=this.Sb.uQa.toArray().join(",")),0<this.Sb.wsa.count&&(qb.DesignerCardIndexes=this.Sb.wsa.toArray().join(",")),this.Sb.eQ&&(this.Sb.pjc&&this.Sb.pjc>this.Sb.eQ&&(qb.MissingDesignerCardsReceivedTime=+this.Sb.pjc-+this.Sb.eQ),this.Sb.dZb&&this.Sb.dZb>this.Sb.eQ&&(qb.AllIncRenderReceivedTime=+this.Sb.dZb-+this.Sb.eQ),this.Sb.VPb&&this.Sb.VPb>this.Sb.eQ&&(qb.VisibleIncRenderReceivedTime=+this.Sb.VPb-+this.Sb.eQ)));
this.f7h(qb);try{if(this.xw.instance){const Pb=this.xw.instance.t2k();cb.a.Wa(Pb)||(Na.AgendaMetrics=Pb)}}catch(Pb){P.a.J(512496583,813,10,"exception while populating AgendaMetrics",Pb)}Na.BrowserData=qb;this.Sb.eQ&&this.Sb.xga&&this.Sb.xga>this.Sb.eQ&&(Na.TimeToDisplaySuggestionsInMs=+this.Sb.xga-+this.Sb.eQ);this.Sb.z2e&&this.Sb.Ntc&&(Na.TimeSuggestionsRendered=this.Sb.z2e.toUTCString());this.Sb.Ntc&&(Na.TimeDesignerPaneClosed=this.Sb.Ntc.toUTCString());this.Sb.AZb&&0<this.Sb.AZb.count&&(Na.AppliedSuggestionHis=
this.Sb.AZb.toArray().join(" "));this.wi.uoa(Ca,Ie.c(Na),S===$g.a.Lod);this.BFl(Ca,S);this.Sb.Vsf(Ca,this.la.Eja&&t);P.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",S,Ca)}}iac(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.Pp?!0:!1}f7h(t){t.IdeasMivShown=this.Sb.Scd;t.IdeasMivDrillIn=this.Sb.gEe;t.IdeasEditorShown=this.Sb.BOc;t.IdeasEditorKept=this.Sb.AOc;t.IdeasEditorDrillIn=
this.Sb.zRf;t.AnyCardShown=this.Sb.BOc||this.Sb.Scd||0<this.Sb.uQa.count;t.AnyCardKept=this.Sb.AOc||this.Sb.IT}BFl(t,S){this.qy.dJa(t,S===$g.a.LNb||S===$g.a.qsd||S===$g.a.noSuggestion||S===$g.a.HPf?uj.a.cJa:uj.a.pending)}myk(t,S){S.jAh.addRange(this.Sb.wsa);this.ZEf(S.jAh,S.EUf,S.slideId,S.trigger,S.correlationId);S.Y8a&&(this.JVa||this.Sb.nfa.count||this.yrl(S.trigger,S.EUf))}Hwk(t,S){this.uda(Se.a.moreIdeas,null,S.L1c)}Cfa(t,S){!S.qfa||"PptRibbon.Design"!==S.qfa&&"Design"!==S.qfa||2!==S.Iu&&3!==
S.Iu&&4!==S.Iu||this.qy.rp.Fo.isVisible||32!==this.ia.processAction(Va.a.grd,1)||this.uda(Se.a.R_d)}yrl(t,S){this.b0e();const la=this.ua.Ba.Cb,Ca=this.Sb.correlationId;this.JVa=new V.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Sb.BAb(Ca)||this.ZEf(this.Sb.wsa,S,la,t,Ca,S)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.zb.Db(this.JVa)}ZEf(t,S,la,Ca,Na,qb=-1){if(this.Sb.wsa.count===S)this.b0e();else if(t&&t.count&&!(0<this.Sb.nfa.count)){if(-1===qb)for(let Pb of t)Pb>qb&&(qb=
Pb);this.wsi(t,S,qb)&&this.yAl(la,Ca,Na)}}wsi(t,S,la){for(let Ca=0;Ca<S&&(t.contains(Ca)||this.Sb.nfa.contains(Ca)||this.Sb.nfa.add(Ca),Ca!==la||this.Sb.nfa.count);Ca++);return 0<this.Sb.nfa.count}yAl(t,S,la){const Ca={};Ca.MissingDesignerCardIndexes=this.Sb.nfa.toArray().join(",");this.JVa=new V.a(0,1,0,()=>{this.wi.$ja(t.cid,t.sid,la,Hn.xae(),S,null,Ie.c(Ca),()=>{P.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",
Ca.MissingDesignerCardIndexes,la)},Na=>{P.a.J(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Ca.MissingDesignerCardIndexes,Na.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.zb.Db(this.JVa)}b0e(){this.JVa&&(this.zb.Mg(this.JVa),this.JVa=null)}X0(t,S){(t=this.ua.Ba)&&S.slideId.equals(t.Cb)&&(this.qy.Hrd(S.Wxh,S.sch),this.qy.rp.Fo.isVisible&&!this.qy.isEnabled()&&
(P.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",S.Wxh,S.sch,this.Sb.correlationId),this.Ro.Ap(!1,$g.a.Tvi)),this.Ro.isVisible&&(this.qy.isEnabled()||this.qy.dJa(this.Sb.correlationId,uj.a.cJa)))}CMi(t,S){S.sna?(t=Object.assign(new og.a,{slideId:S.sna.Cb}),this.ia.La(Va.a.XZa,2,t),this.qy.Hrd(t.bsc,t.rch),this.Ro.isVisible&&(P.a.J(512496577,
829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Sb.correlationId),this.qy.isEnabled()&&!S.sna.XN?this.uda(Se.a.h_e):S.sna.XN&&this.la.designerNewSlideEnabled||(this.Ro.Ap(!1,$g.a.slideNavigation),this.qy.dJa(this.Sb.correlationId,uj.a.cJa)))):P.a.J(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Sb.correlationId)}N7b(t){this.la.designerRequestThrottlingEnabled&&
(this.Oma=bj.ready,this.hM&&(this.Ro.isVisible?(P.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.hM.trigger,this.hM.sid),t()):this.hM=null))}jhb(t,S){this.N7b(S);P.a.J(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",t.HttpStatusCode);return!0}AMi(){if(this.qy.rp.Fo.isVisible){const t=this.ob.Qe();t&&1<t.length&&(P.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),
this.Ro.isVisible&&this.Ro.Ap(!1,$g.a.Hok))}}wfa(t,S){t=this.Sb.VPa;const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";t&&Object(D.a)(String,S.actionName)===la&&(this.Sb.AZb.add(String.format("{0}:{1}:{2}",this.Sb.OZ,+t-+this.Sb.xga,+new Date-+t)),this.Sb.VPa=null)}ghb(t,S){this.qy.rp.Fo.isVisible&&(P.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Sb.correlationId,Gn.a[S.NE]),1!==S.NE&&3!==S.NE||this.Jjb(!0,$g.a.Lod))}Eo(){P.a.J(512496544,
829,50,"DesignerActor::OnSessionRehydrated");const t={};t[mf.a.TPc]=!0;this.uda(Se.a.refresh,t)}zfd(t,S){S&&this.Fbe(S.actionId,S.transaction.Zy)}$gb(t,S){if(S.Nzb&&this.qy.rog(S.actionId)){t={};if(S.revisionId){const la=nj.a.Hta(Nm.a.FY,nj.a.h$a(S.revisionId.toString()).toString());la&&1===la.length&&(t[mf.a.KD]=la[0].KD)}this.Fbe(S.actionId,t)}}nag(t,S,la,Ca,Na){switch(t){case Va.a.tfe:return this.Sb.Mlk(Na),32;case Va.a.XXc:return this.Sb.gZk(Na),32;default:return 2}}jlk(t,S,la){if(t!==Se.a.insertPicture&&
t!==Se.a.zxa&&t!==Se.a.JXc)return null;const Ca=la?la[mf.a.Z7b]:!1,Na=la?la[mf.a.sWc]:!1,qb=la?la[mf.a.$7b]:!1,Pb=la?la[mf.a.rWc]:!1;let xc=null;switch(S){case Va.a.xxa:case Va.a.Shd:xc=Ca?mf.a.lFk:Na?mf.a.kFk:qb?mf.a.mFk:Pb?mf.a.jFk:null;break;case Va.a.Uhd:xc=Ca?mf.a.pFk:Na?mf.a.oFk:qb?mf.a.qFk:Pb?mf.a.nFk:null;break;case Va.a.pQc:xc=mf.a.$Yf;break;case Va.a.insertOnlinePicture:case Va.a.dua:xc=mf.a.online;break;case Va.a.Nfg:xc=mf.a.icon}xc||P.a.J(512496543,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",
t,S,this.Sb.correlationId);delete la[mf.a.Z7b];delete la[mf.a.sWc];delete la[mf.a.$7b];delete la[mf.a.rWc];return xc}klk(t,S){switch(t){case Va.a.pQc:case Va.a.insertOnlinePicture:case Va.a.dua:case Va.a.Qlc:case Va.a.Nfg:case Va.a.utf:return Se.a.insertPicture;case Va.a.Uhd:case Va.a.xxa:case Va.a.Shd:case Va.a.Xid:return S&&S[mf.a.Z7b]||S&&S[mf.a.sWc]&&this.la.nzl?Se.a.insertPicture:S&&S[mf.a.$7b]?Se.a.zxa:S&&S[mf.a.rWc]&&this.la.VDh?Se.a.JXc:this.la.zza?Se.a.EJa:"";case Va.a.iw:case Va.a.nCa:case Va.a.bsb:return Se.a.bsb;
case Va.a.cja:return Se.a.c_e;case Va.a.Jqc:case Va.a.Kqc:case Va.a.Rpd:case Va.a.Spd:case Va.a.Mqc:return S&&mf.a.byb in S&&S[mf.a.byb]?Se.a.hVd:Se.a.refresh;case Va.a.mGf:case Va.a.k7a:return S&&mf.a.byb in S&&S[mf.a.byb]?Se.a.qOf:Se.a.refresh;case Va.a.YIa:case Va.a.fjb:case Va.a.jqc:case Wf.a.gUa:case Va.a.bringForward:case Va.a.bringToFront:case Va.a.sendToBack:case Va.a.sendBackward:return Se.a.ljb;case Wf.a.uSd:case Wf.a.xSd:case Wf.a.PZb:case Wf.a.wSd:case Wf.a.ySd:case Wf.a.zSd:case Wf.a.aQa:case Wf.a.ASd:case Wf.a.BSd:case Wf.a.CSd:case Wf.a.DSd:case Wf.a.FSd:case Wf.a.HSd:case Wf.a.backspace:case Wf.a.gCa:case Wf.a.bL:case Wf.a.rRa:case Wf.a.enter:case Wf.a.CB:case Wf.a.typing:return Se.a.typing;
case Va.a.zxa:return Se.a.zxa;case Va.a.$id:return this.la.ka("DesignerUseRefreshTriggerForInsertTable")?Se.a.refresh:Se.a.insertTable;case Va.a.C5:case Va.a.fed:case Va.a.PGb:case Va.a.iQ:return Se.a.vna;case Va.a.TPa:return Se.a.BRd;case Va.a.QEf:return Se.a.bVd;case Va.a.qtb:return Se.a.qtb;default:return Se.a.refresh}}Bzl(){const t={};t[mf.a.undoRedo]=!0;this.uda(Se.a.refresh,t);return 32}Fbe(t,S){if(!this.MJj(t)){var la=qb=>{const Pb={};Pb[mf.a.timestamp]=qb.timestamp;Pb[mf.a.correlationId]=
qb.correlationId;Pb[mf.a.trigger]=qb.trigger;Pb[mf.a.sid]=qb.sid;Pb[mf.a.cid]=qb.cid;Pb[mf.a.SN]=qb.SN;qb=this.Jb.Ad(4);try{qb.nc(this.ua.presentation),qb.jd=Va.a.xOf,this.ua.presentation.Mub=Ie.c(Pb)}finally{qb&&qb.dispose()}},Ca=this.klk(t,S),Na=this.jlk(Ca,t,S);Ab.a("DesignerLogRetriggerReason")&&Ca==Se.a.refresh&&(S||(S={}),S[mf.a.pTe]=t);cb.a.Wa(Na)||(S||(S={}),S[mf.a.rDa]=Na);this.qy.rog(t)&&this.Ro.isVisible?(this.Wfb&&this.zb.Mg(this.Wfb),this.qy.dJa(this.Sb.correlationId,uj.a.pending),this.Apd(Se.a.typing),
this.Wfb=new V.a(2,1,this.la.designerTypeRefreshThrottleTimeoutMs,()=>{this.Ro.isVisible&&P.a.J(512496542,829,50,"Potential candidate for typing refresh request for designer pane");this.Xkl(this.ua.Ba)||this.yPc(la,Ca,S)},void 0,"DesignerTypingRefreshTask"),this.zb.Db(this.Wfb)):this.yPc(la,Ca,S)}}uda(t,S=null,la=null){this.yPc(Ca=>{if(this.la.designerRequestThrottlingEnabled){if(this.Oma.Cmg&&+new Date-+this.Oma.Hpg<this.la.designerRequestThrottleIntervalMs){this.hM=new Dl;this.hM.sid=Ca.sid;this.hM.cid=
Ca.cid;this.hM.trigger=Ca.trigger;this.hM.QWc=Ca.SN;P.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",t,Ca.sid);return}this.Oma=bj.inProgress;this.hM=null}const Na=()=>{this.uda(this.hM.trigger,this.hM.QWc,la)};this.wi.$ja(Ca.cid,Ca.sid,Ca.correlationId,Hn.xae(),Ca.trigger,la,Ie.c(Ca.SN),qb=>{qb&&qb.Status===mf.a.Dlh?this.Wmd(()=>{this.uda(Ca.trigger,Ca.SN,la)}):this.QIa=0;this.QIa||this.N7b(Na)},qb=>this.jhb(qb,Na))},t,S)}Wmd(t){this.QIa<
this.la.designerMaxRetryOnWait?this.zb.Db(new V.a(2,1,1E3,()=>{P.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Sb.correlationId);this.Oma=bj.ready;this.QIa++;t()},void 0,"RetryRequestOnWait")):P.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Sb.correlationId)}cbj(t,S=null){S=S||{};this.la.uNc&&t===Se.a.newDocument&&(S[mf.a.KRi]="true");this.la.BMi&&(S[mf.a.ztl]=this.hGg);this.rp.Ssa()&&
(this.la.uRa?(S[mf.a.pJh]=this.ir.Qae(),S[mf.a.qJh]=!0):S[mf.a.RIf]=!0);this.ir.pXc(t)&&(S[mf.a.Deg]=!0);this.qy.jMj()&&(S[mf.a.pWd]=this.qy.pWd());S.NewPaneEnabled=!0;var la=!of.a.Wa(this.Sb.GW);(S.RequestForEditorCardsForNewIdeasPane=la)&&(S.NumEditorCritiques=this.ICi());la={};la.SupportsImageToTableSuggestedAction=32===this.ia.processAction(Va.a.QLe,1);S.PPTOEnabledSuggestedActions=Ie.c(la);this.la.zza&&t===Se.a.EJa&&(S[mf.a.xhb]=this.la.xhb,S[mf.a.IKe]=this.la.IKe,S[mf.a.HKe]=this.la.HKe);return S}ICi(){let t=
0;for(const S of this.Sb.GW)for(const la of S.critiques)t+=la.suggestions.length;return t}MJj(t){if(void 0===t||null===t)return!0;switch(t){case Va.a.ZBa:case Va.a.Wrb:case Va.a.PYa:case Va.a.FGb:case Va.a.GGb:case Va.a.QYa:case Va.a.IGb:case Va.a.JGb:case Va.a.HGb:case Va.a.Fgb:case Va.a.xOf:return!0;case Va.a.YIa:case Va.a.fjb:case Va.a.jqc:case Wf.a.gUa:case Va.a.bringForward:case Va.a.bringToFront:case Va.a.sendToBack:case Va.a.sendBackward:return!this.Sb.IT;default:return!1}}oHi(t,S=null){const la=
this.ua.Ba;return la?Object.assign(new Fn,{trigger:t,sid:la.sid,cid:la.cid,SN:this.cbj(t,S)}):null}AUj(t){return this.BUj(t)}BUj(t){if(!t||!t.sid||!this.Yig(t.trigger)&&!this.Ro.isVisible)return!1;switch(t.trigger){case Se.a.vna:case Se.a.Ytc:case Se.a.IOb:case Se.a.insertPicture:case Se.a.bsb:case Se.a.R_d:case Se.a.IXd:case Se.a.zxa:case Se.a.h_e:case Se.a.c_e:case Se.a.insertTable:return!0;case Se.a.JXc:return this.la.VDh;case Se.a.typing:return this.la.BOf&&this.Ro.isVisible;case Se.a.ljb:return this.la.designerRetriggerEnabled&&
this.Sb.IT;case Se.a.hVd:case Se.a.qOf:return this.la.designerDesignElementsRemovedEnabled;case Se.a.EJa:return this.la.zza;case Se.a.BRd:case Se.a.bVd:case Se.a.qtb:return this.la.triggerDesignerAfterApplyReplaceObject;case Se.a.refresh:return this.tUj(t.SN);case Se.a.moreIdeas:return this.la.Eja;case Se.a.newDocument:return this.la.uNc&&this.la.GQ&&!(Ab.a("DesignerInvokeFix")&&this.la.$W);case Se.a.NQd:return this.la.r3e;default:return P.a.J(512496538,829,15,"invalid trigger: {0}",t.trigger),!1}}tUj(t){return mf.a.TPc in
t&&t[mf.a.TPc]||mf.a.undoRedo in t&&t[mf.a.undoRedo]||this.la.yMi&&this.qy.rp.Fo.isVisible?!0:!1}Yig(t){switch(t){case Se.a.Ytc:case Se.a.IOb:case Se.a.insertPicture:case Se.a.JXc:case Se.a.c_e:case Se.a.hVd:case Se.a.bsb:case Se.a.zxa:case Se.a.newDocument:case Se.a.BRd:case Se.a.R_d:case Se.a.IXd:return!0;case Se.a.NQd:return this.la.r3e;case Se.a.EJa:return this.la.zza;default:return!1}}LJj(t){if(!(this.la.designerSendActionDuration&&mf.a.KD in t.SN&&t.SN[mf.a.KD]))return!1;switch(t.trigger){case Se.a.Ytc:case Se.a.IOb:case Se.a.h_e:case Se.a.newDocument:return!1;
case Se.a.refresh:return!(mf.a.TPc in t.SN)||!(mf.a.undoRedo in t.SN);default:return!0}}Apd(t){const S=t===Se.a.typing?4:t===Se.a.moreIdeas?7:1;(this.qy.rp.Fo.isVisible||this.Yig(t))&&this.rp.t0a(S)}K2d(t,S,la=null){var Ca,Na;this.Wfb&&(this.zb.Mg(this.Wfb),this.Wfb=null);const qb=this.oHi(S,la);if(this.AUj(qb))if(this.Sb.kWj(this.ua.Ba.sid))this.Apd(qb.trigger),this.Wmd(()=>{this.yPc(t,S,la)});else{var Pb=null!==(Na=null===(Ca=qb.SN)||void 0===Ca?void 0:Ca.GNl)&&void 0!==Na?Na:null;P.a.J(512496537,
829,50,"trigger: {0}; sid: {1}; correlationId: {2} ReTriggerReason: {3}",qb.trigger,qb.sid,qb.correlationId,Pb);this.Sb.correlationId&&!this.Sb.BAb(this.Sb.correlationId)&&(Ab.a("DesignerLogRetriggerReason")?this.Jjb(this.qy.rp.Fo.isVisible,qb.trigger,Pb):this.Jjb(this.qy.rp.Fo.isVisible,qb.trigger));this.Sb.Gsc=new Date;this.Sb.correlationId=qb.correlationId;this.Sb.jUd=qb.trigger;this.Sb.eQ=this.LJj(qb)?qb.SN[mf.a.KD]:new Date;t(qb);this.Apd(qb.trigger);this.qy.dJa(qb.correlationId,uj.a.pending)}else P.a.J(512496536,
829,50,"Designer call not currently allowed for trigger {0}",S),this.Ro.Ap(!1,$g.a.HPf)}yPc(t,S,la=null){if(this.la.designerAuthEnabled&&this.eM){this.Apd(S);la||(la={});var Ca=new Date;this.eM.sV(this.la.pptDesignerImplicitAuthAppName,this.la.designerResourceUri).then(Na=>{const qb=+new Date-+Ca;Na.IsSuccess?(la[mf.a.JXi]=qb,la[mf.a.t$k]=Na.Token):(la[mf.a.WVf]=qb,P.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Na.ErrorCode+": "+
Na.ErrorMessage));this.K2d(t,S,la)}).catch(Na=>{P.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Na);la[mf.a.WVf]=+new Date-+Ca;this.K2d(t,S,la)})}else this.K2d(t,S,la)}u4e(){if(this.la.uNc&&this.la.GQ)if(Ab.a("DesignerInvokeFix")&&this.la.$W)P.a.J(509162323,829,50,"No Triggering NewDocument designer request in Copilot.");else if(this.oc){var t=this.ua.presentation;if(!t)throw Error.argumentNull("Presentation is null");var S=this.oc.HI();
if(!S||0>=S.length)P.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var la="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===S[0].ThemeFamilyId.toLowerCase();la&&1!==S.length?P.a.J(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.q3e||la?!t.slides||0>=t.slides.length?P.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):
la&&1!==t.slides.length?P.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(t=null,this.la.W9k&&this.la.iOb&&0<this.la.iOb.length&&(t={},t.TemplateId=this.la.iOb),P.a.J(512496526,829,50,"Triggering NewDocument designer request"),this.uda(Se.a.newDocument,t)):P.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else P.a.J(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");
else P.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.la.uNc,this.la.GQ)}ZHe(t,S){this.Sb.bFl(S.q3b)}Xkl(t){return!t||!this.Ro.isVisible}jnj(){const t=document.querySelector("."+ue.pQa);return t&&(this.ir.vwb(t,!1)||this.ir.vwb(t,!0))?"Kept":"NotKept"}I3f(t){const S=new ea.a;if(t&&t.children)for(let la=0;la<t.children.length;la++){const Ca=t.children[la].innerText;Ca&&0<Ca.length&&S.add(t.children[la].innerText)}return S.toArray()}xgj(t){if(!t)return null;
var S=t.sa(Rc.a.yhb,null);if(S)return S.replace("\r","\n").replace("\n\n","\n").split("\n");if(S=t.sa(Rc.a.JU,null))if(S=this.WT.rZa(S))return this.I3f(S);if(S=t.sa(Rc.a.KKe,null))if(t=this.WT.rZa(S))return this.I3f(t);return null}G5(){}F5(t){if(this.la.zza&&t.actionId===Va.a.Xid&&32===t.response){var S=this.ob.Xd();if(S&&1===S.length&&S[0].id&&(S=this.xgj(Object(D.a)(10,t.rd)))&&!(0>=S.length)){var la={};la[mf.a.rFk]=S;this.Fbe(t.actionId,la)}}}DMi(t){switch(t){case mf.a.aLh:return this.la.IRi;default:return!1}}Hsj(){this.Ro.Ap(!0,
$g.a.none);this.uda(Se.a.IXd);this.rp.t0a(3)}xzl(t){switch(t){case mf.a.aLh:this.yzl()}}yzl(){if(this.la.gIk)try{const t=A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&(P.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),t.execute(S=>{S.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(t){P.a.J(512496524,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",t)}}zvk(){this.la.r3e&&(this.Ro.isVisible||
this.Tvg||(this.Ro.Ap(!0,$g.a.none),this.uda(Se.a.NQd),this.rp.t0a(3),P.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),this.Tvg=!0)}static xae(){const t=document.querySelector("."+ue.pQa);return t&&t.getAttribute(ue.Osb)?t.getAttribute(ue.Osb).toString():null}}Object(h.a)(Hn,"DesignerActor",null,[145]);var gp=d(544),Jo=d(704);class rn{constructor(t){this.bucketId=t;this.critiques=[]}}Object(h.a)(rn,"BucketedEditorData",null,[]);class ko{constructor(t){this.jUd=this.correlationId=
this.eWa=this.$tg=null;this.pzb=this.fVa=this.IT=!1;this.Ntc=this.z2e=null;this.Xjg=!1;this.vQa=this.suggestions=this.VPb=this.dZb=this.eQ=this.VPa=this.pjc=this.xga=this.Gsc=null;this.BN=0;this.X_e=this.gEe=this.Scd=this.zRf=this.AOc=this.BOc=!1;this.fre=[];this.qCe=[];this.fdc=t;this.OZ=Q.a.empty;this.AZb=new ea.a;this.uQa=new ea.a;this.wsa=new ea.a;this.oXc=new ea.a;this.nfa=new ea.a;this.H_b=1}Clk(){this.X_a(0,0)}Blk(){this.X_a(1,0)}pEe(){this.X_a(2,4)}X_a(t,S){this.fdc&&this.fdc.execute(la=>
{const Ca=Object.assign(new Jo.a,{cardId:gp.a.Uxh,actionType:t,actionEngagement:S});la.yed(Ca)})}Vsf(t,S){this.BAb(t)||(Array.add(this.fre,t),P.a.J(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",t,this.fre.length));this.WSe(!S)}BAb(t){return Array.contains(this.fre,t)}Mlk(t){Array.add(this.qCe,t)}gZk(t){Array.remove(this.qCe,t)}kWj(t){return Array.contains(this.qCe,t)}get bXd(){return this.eWa}Yzi(){if(this.eWa)return!0;try{const t=
A.a.instance.rb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(t)return this.eWa=t,!0}catch(t){P.a.J(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",t)}return!1}bFl(t){if(t){var S=[],la=new rc.a;for(const Ca of t.critiques){t=Ca.bucketId;let Na=la.ga(t);Na||(Na=new rn(t),la.$(t,Na),S.push(Na));Na.critiques.push(Ca)}this.$tg=S}}get GW(){return this.$tg}WSe(t){this.correlationId="";this.OZ=Q.a.empty;this.jUd="";this.pzb=this.fVa=this.IT=!1;this.Ntc=null;this.Xjg=!1;this.VPa=
this.pjc=this.xga=this.Gsc=null;this.AZb.clear();this.VPb=this.dZb=this.eQ=null;this.H_b=1;this.uQa.clear();this.wsa.clear();this.oXc.clear();this.nfa.clear();this.BN=0;this.X_e=this.BOc=this.AOc=this.Scd=this.gEe=!1;t&&(this.suggestions=this.vQa=null)}}Object(h.a)(ko,"DesignerContext",null,[618]);class cj{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=null}}Object(h.a)(cj,"DesignerSuggestions",null,[]);var ne;(function(t){t[t.init=0]=
"init";t[t.loading=1]="loading";t[t.noSuggestion=2]="noSuggestion";t[t.showSuggestion=3]="showSuggestion";t[t.refreshing=4]="refreshing";t[t.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";t[t.makeItVisualDrillIn=6]="makeItVisualDrillIn";t[t.loadingMoreIdeas=7]="loadingMoreIdeas";t[t.moreIdeas=8]="moreIdeas";t[t.noSuggestionRibbon=9]="noSuggestionRibbon"})(ne||(ne={}));Object(h.b)("DesignerViewState",ne);class Xi{constructor(){this.suggestions=[]}}Object(h.a)(Xi,"SlideSuggestionNotificationData",
null,[]);var gd=d(258),Tj=d(391);class fg{constructor(t,S,la){this.Lob=this.ZB=!1;t&&(this.TVa=t,this.TVa.isFeatureEnabled("PowerPointDesigner",!1).then(Ca=>{(this.ZB=Ca)?P.a.J(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(this.Lob=this.TVa.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?la?P.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):P.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):
P.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.ogk=this.TVa.Gib("PowerPointDesigner",Object(n.a)(this,this.Nvb,"featureStateChangeCallback")),this.Ndk=S)}Ssa(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.TVa&&(this.TVa.oKb("PowerPointDesigner",this.ogk),this.TVa=null)}get isEnabled(){return this.ZB}get isFreemiumUpsellEnabled(){return this.Lob}launchUpsellExperience(t){this.TVa&&this.TVa.launchUpsellExperience(t)}Nvb(t){t&&
"PowerPointDesigner"===t.featureName&&(!this.isEnabled&&t.isEnabled&&this.Ndk(),this.ZB=t.isEnabled)}}Object(h.a)(fg,"DesignerStateManager",null,[]);class Ip{constructor(t,S,la){this.pik=t;this.xB=S;this.Nhk=la}toString(){return"SuggestionIndex:"+this.pik+" SlideId:"+this.xB+" CreationId:"+this.Nhk}}Object(h.a)(Ip,"LoggableSourceContext",null,[]);var hp=d(1154),El=d(963),Cm=d(543);class Kg{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff){this.Cec=!1;this.ODe=0;this.yo=this.dCb=null;this.va=new bm.a;
this.lF=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.iX;this.DVh=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.iX&&v.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesFocusV2IsEnabled");this.Rb=t;this.qe=S;this.Zc=la;this.Lr=Ca;this.ia=Na;this.Sb=qb;this.nE=Pb;this.Oc=xc;this.sz=ed;this.mc=dd;this.Fa=fd;this.la=we;this.Iv=Sf;this.YF=Ah.I8b;this.Zdk=ResourceStrings.L_Designer;this.zH=Ff;this.qb=document.createElement("div");
this.qb.className=Zb.a.wMi;this.qb.id=Ah.I8b;this.qb.style.position=Hc.a.dpa;this.qb.setAttribute(pa.a.af,pa.a.bCa);this.qb.setAttribute(pa.a.U2,Zb.a.T_d);this.Eb=!1;this.nWa=Ac.a.Ie();this.nWa.className="DesignerPaneLayoutRoot";this.qb.appendChild(this.nWa);t=v.AFrameworkApplication.fa.Ga("PPTFabricIconDiamondCssUrl");S=document.createElement("link");S.setAttribute("rel","stylesheet");S.setAttribute("type","text/css");S.setAttribute("href",t);this.qb.appendChild(S);this.Rb.HPa(Object(n.a)(this,this.nY,
"onSetOffline"))}dispose(){this.b3();this.qb.removeChild(this.nWa);this.Rb.AKb(Object(n.a)(this,this.nY,"onSetOffline"));P.a.J(22590850,829,50,"DesignerPane::Dispose")}initialize(){this.yo=Kg.KCa(this.qe);Sys.UI.DomElement.addCssClass(this.yo,"DesignerPaneCloseButton");this.yo.setAttribute(pa.a.af,pa.a.Au);this.nWa.appendChild(this.yo);this.Zc.pb(ha.a.click,this.yo,Object(n.a)(this,this.xCa,"closePaneButtonClickHandler"));this.Lr.addHandler(this.yo,ha.a.Xf,Object(n.a)(this,this.$ta,"inputKeyPressHandler"));
this.dCb=Ac.a.Ie();this.dCb.id=Zb.a.T_d;this.dCb.className=Zb.a.T_d;this.dCb.innerText=this.Zdk;this.nWa.appendChild(this.dCb);this.nE.a9(this.J2f(),ad.a.hj,this.qb,t=>{this.DVh&&t===this.Fa.Fc(ad.a.OM)&&this.yo?this.zA(!0):this.DU(!0)},()=>{this.DU(!1)});this.Oc.S7(Object(n.a)(this,this.Hw,"onUnifiedAppStateChanged"));this.Oc.iC(Object(n.a)(this,this.gaa,"onPodSessionRehydrated"));this.sz.urb(Object(n.a)(this,this.gaa,"onPodSessionRehydrated"));P.a.J(22590852,829,50,"DesignerPane::Initialize")}J2f(){return ad.a.f_}b3(){this.Zc&&
0<this.nWa.childNodes.length&&(this.Zc.yb(ha.a.click,this.yo,Object(n.a)(this,this.xCa,"closePaneButtonClickHandler")),this.Lr.removeHandler(this.yo,ha.a.Xf,Object(n.a)(this,this.$ta,"inputKeyPressHandler")),this.nWa.removeChild(this.dCb),this.nWa.removeChild(this.yo));this.Oc.Vib(Object(n.a)(this,this.Hw,"onUnifiedAppStateChanged"));this.Oc.Xfa(Object(n.a)(this,this.gaa,"onPodSessionRehydrated"));this.sz.Tib(Object(n.a)(this,this.gaa,"onPodSessionRehydrated"));this.Fa.Ae&&this.Fa.Ae.name===ad.a.f_&&
this.Fa.Ej(ad.a.f_,!1)}Hw(t,S){S.Jab&&!this.mc.In&&this.isVisible&&(P.a.J(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Sb.correlationId),this.Ap(!1,$g.a.LNb))}nY(t){t&&this.isVisible&&this.Ap(!1,$g.a.LNb)}gaa(){P.a.J(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.Ap(!1,$g.a.D$k)}layout(t,S){const la=S?t.oD(this.width):t.pD(this.width);this.isVisible&&(S?(Sys.UI.DomElement.addCssClass(this.qb,
Zb.a.AOf),la.oD(Zb.a.S_d)):(Sys.UI.DomElement.addCssClass(this.qb,Zb.a.zOf),la.pD(Zb.a.S_d)));Ac.a.z1(this.qb,la);return t}Ap(t,S){if(this.Eb!==t){this.Eb=t;var la=this.la.wOf||this.id!==Ah.I8b?mf.a.RCk:Ah.dCj;t?(S={},S[la]=!0,this.Iv.Csd(Ie.c(S)),this.initialize(),this.qb.style.display=Hc.a.$ya,this.Sb.Clk(),P.a.J(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(t={},t[la]=!1,this.Iv.Csd(Ie.c(t)),this.b3(),this.qb.style.display=Hc.a.Ff,this.Qol(S)||(this.Sb.Ntc=new Date,1===this.ODe&&
(this.Sb.pzb=!0),this.ia.La(Va.a.uoa,2,new Cm.a(!0,S))),this.Sb.Blk(),P.a.J(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.lF?(this.oGc(this.qb),la=ResourceStrings.L_Designer,this.zH.IM(this,this.Eb,this.id===Ah.I8b?la:ResourceStrings.L_ShowHideDesignerPane,this.J2f())):this.Rb.Oq()}}oGc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,Zb.a.AOf):Sys.UI.DomElement.addCssClass(t,Zb.a.zOf)}Qol(t){return t===$g.a.SGf||this.isVisible&&t===$g.a.LNb}DU(t){t?this.va.raiseEvent("OnDesignerPaneFocusOn"):
this.va.raiseEvent("OnDesignerPaneFocusBlur")}cvf(t){this.va.addHandler("OnDesignerPaneFocusOn",t)}sjh(t){this.va.removeHandler("OnDesignerPaneFocusOn",t)}dvf(t){this.va.addHandler("OnDesignerPaneFocusBlur",t)}tjh(t){this.va.removeHandler("OnDesignerPaneFocusBlur",t)}$ta(t){!this.isVisible||t.keyCode!==ua.a.tq&&t.keyCode!==ua.a.pP||this.Ap(!1,$g.a.typing)}xCa(){this.isVisible&&(P.a.J(22853525,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",
this.Sb.correlationId),this.Ap(!1,$g.a.LNb));return!0}zA(t){(this.Cec=t)&&this.yo.focus()}get fba(){return this.ODe}set fba(t){this.ODe=t}Zjb(t){this.setFocus("#"+this.id+" ."+Nd.g_g+":nth-child("+t+") > ."+Nd.rGb)}rbl(){this.setFocus("#"+Nd.r8a)}qbl(){this.setFocus("#"+Nd.hvb)}hpd(t){this.setFocus("."+Nd.IRa+"["+Ah.HRa+'="'+t+'"')}obl(){this.setFocus("."+Nd.n3b)}pbl(){this.setFocus("."+Nd.r3b)}setFocus(t){(t=document.querySelector(t))&&gc.FocusManager.Wr(t)}get isVisible(){return this.Eb}get xUa(){return this.Cec}get xa(){return this.qb}get order(){return 7}get id(){return this.YF}get width(){let t=
0;this.isVisible&&(t=Zb.a.xMi,t+=Zb.a.S_d+rb.a.MKa);return t}static KCa(t){return Kg.JCa(t,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static JCa(t,S,la,Ca,Na,qb,Pb){const xc=Ac.a.SA();xc.alt=qb;xc.className=Ba.getImageClassWithCluster(S,Na);xc.src=t.rk(S+".png");xc.setAttribute("Unselectable","on");t=Ac.a.Sn();t.className=la+" cui-img-cont-float";t.appendChild(xc);la=Ac.a.Sn();la.className=Ca;la.setAttribute("Unselectable","on");la.appendChild(t);
Ca=Ac.a.Eca();Ca.className="cui-ctl DesignerPaneButton";Ca.title=qb;Ca.setAttribute(pa.a.af,pa.a.Au);Ca.tabIndex=0;Ca.appendChild(la);Pb&&(qb=Ac.a.Sn(),qb.className="cui-ctl-mediumlabel",qb.setAttribute("Unselectable","on"),qb.innerText=Pb,Ca.appendChild(qb));return Ca}}Object(h.a)(Kg,"DesignerPane",null,[614,552,106]);class Uj{constructor(t,S,la,Ca,Na,qb){this.$bd=this.ycc=this.cEb=this.xo=null;this.bxe=this.c$b=!1;this.zCe=null;this.la=S;this.ia=t;this.Odk=qb;this.Zc=Ca;this.Lr=Na;this.Pxg=oc.KeyInputManager.Oa(ua.a.lmb,
0);this.ia.ya(Va.a.oJh,E.a.frame,Object(n.a)(this,this.Bvi,"closeCallout"));this.UT=Ac.a.Ie();this.UT.className="GoPremiumCalloutContainer";this.ycb=Kg.KCa(la);Sys.UI.DomElement.addCssClass(this.ycb,"GoPremiumCalloutClose");this.ycb.setAttribute(pa.a.af,pa.a.Au);this.UT.appendChild(this.ycb);t=document.createElement("i");t.className=ue.eJc;t.setAttribute(pa.a.af,pa.a.pN);t.setAttribute("Unselectable","on");t.setAttribute(pa.a.SK,pa.a.jC);this.UT.appendChild(t);this.Hwa=Ac.a.Ie();this.Hwa.className=
"GoPremiumTitle";this.UT.appendChild(this.Hwa);this.XT=Ac.a.Ie();this.XT.className="GoPremiumSubtitle";this.UT.appendChild(this.XT);this.fma=Ac.a.Ie();this.fma.className="GoPremiumButton";t=Ac.a.Sn();t.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;t.setAttribute("Unselectable","on");t.setAttribute(pa.a.SK,pa.a.jC);this.fma.appendChild(t);this.fma.tabIndex=0;this.fma.setAttribute(pa.a.ns,t.innerText);this.fma.setAttribute(pa.a.af,pa.a.Au);this.UT.appendChild(this.fma);this.Wu()}show(t,S,
la,Ca,Na,qb){this.AL&&this.dismiss();this.cEb=Ca;this.ycc=S;this.$bd=Na;this.zCe=qb;this.cEb&&Sys.UI.DomElement.addCssClass(this.cEb,this.$bd);la?(this.Hwa.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.XT.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.Hwa.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.XT.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);S.setAttribute(pa.a.y6a,pa.a.jC);this.la.fSf?this.xo=new El.a(t,document.body,v.AFrameworkApplication.Aa.WR,
null):(this.xo=hp.a.IYd(t,document.body,document.body,2,Object(n.a)(this,this.dismiss,"dismiss")),this.xo.A2e=120);this.xo.gba=310;this.UT.setAttribute(pa.a.ns,String.format("{0}. {1}",this.Hwa.innerText,this.XT.innerText));this.UT.setAttribute(pa.a.af,pa.a.bCa);this.Lr&&this.Lr.addHandler(this.UT,ha.a.Xf,Object(n.a)(this,this.$ta,"inputKeyPressHandler"));this.xo.content=this.UT;this.tra();S=new Sys.UI.Bounds(0,0,ia.a.tVc(),ia.a.sVc());this.xo.TZ=this.w6d(S,t,240,la);this.xo.Ar=!1;this.xo.Igd=()=>
{this.UT.parentNode&&Sys.UI.DomElement.addCssClass(this.UT.parentNode,"GoPremiumCalloutContentContainer");this.xo.KJ&&(Sys.UI.DomElement.addCssClass(this.xo.KJ,"GoPremiumCalloutOuter"),this.xo.KJ.removeAttribute(pa.a.af),this.la.fSf||(this.xo.KJ.style.zIndex=String(v.AFrameworkApplication.Aa.erb)));this.xo.TWe();this.KR(this.fma);this.c$b=!0};this.xo.show()}tra(){if(gc.FocusManager.UM()){var t=gc.FocusManager.instance(),S=t.Fc("callout/modal");S.parent=ad.a.hj;t.dPd("callout/modal",ad.a.hj,this.UT);
t.LU("callout/modal",!1);S.bindAction(this.Pxg,Va.a.oJh);S=new jf.DOMFocusListing(()=>this.UT);S.Kib=!0;S.Io(2);t=t.Yia(()=>this.UT,t.Fc("callout/modal"),S);t.Lib();t.rX=!0;t.NQa=!0}}Pib(){if(gc.FocusManager.UM()&&!v.AFrameworkApplication.Ug){const S=gc.FocusManager.instance();var t=S.Fc("callout/modal");t&&t.Dp(this.Pxg);S.a1("callout/modal");(t=S.uQ("callout/modal"))&&t.wj.ZE(null);S.tKb("callout/modal")}}KR(t){gc.FocusManager.UM()?gc.FocusManager.instance().uQ("callout/modal").wj.i9a(t):t.focus()}get AL(){return!!this.xo&&
this.xo.AL}Vxj(){this.AL&&(this.c$b?this.ycb.focus():this.fma.focus(),this.c$b=!this.c$b)}RPf(){this.dismiss();return!0}Bvi(){this.dismiss();return 32}dismiss(){if(!this.bxe){this.bxe=!0;try{this.Pib(),this.ycc&&(this.ycc.setAttribute(pa.a.y6a,pa.a.Nia),gc.FocusManager.Wr(this.ycc),this.ycc=null),this.cEb&&(Sys.UI.DomElement.removeCssClass(this.cEb,this.$bd),this.cEb=null),this.zCe=this.$bd=null,this.c$b=!1,this.xo&&(this.xo.dismiss(),this.xo.dispose(),this.xo=null),this.Lr&&this.Lr.removeHandler(this.UT,
ha.a.Xf,Object(n.a)(this,this.$ta,"inputKeyPressHandler"))}finally{this.bxe=!1}}}dispose(){this.dismiss();this.ppa();this.UT=this.ycb=this.fma=null}$ta(t){if(t.keyCode===ua.a.tq||t.keyCode===ua.a.pP){t.preventDefault();t=document.activeElement;try{t?t.click():P.a.J(590967751,829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(S){P.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",S)}}}F4g(){this.Odk(this.zCe);return!0}Wu(){this.Zc?(this.Zc.pb(ha.a.click,
this.ycb,Object(n.a)(this,this.RPf,"dismissAndReturn")),this.Zc.pb(ha.a.click,this.fma,Object(n.a)(this,this.F4g,"onGoPremiumClicked"))):P.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}ppa(){this.Zc&&(this.Zc.yb(ha.a.click,this.ycb,Object(n.a)(this,this.RPf,"dismissAndReturn")),this.Zc.yb(ha.a.click,this.fma,Object(n.a)(this,this.F4g,"onGoPremiumClicked")))}w6d(t,S,la,Ca){if(Ca)return 0;Ca=
6;S.y-t.y<la&&(Ca=3);return Ca}}Object(h.a)(Uj,"PremiumContentCallout",null,[]);class kk{constructor(t,S,la,Ca,Na,qb,Pb,xc){this.Nub=t;this.tVi=S;this.EPc=la;this.Kh=Ca;this.wga=Na;this.Y8a=qb;this.PZe=Pb;this.Lvd=xc}}Object(h.a)(kk,"RenderSuggestionsArgs",null,[984]);class lo extends Sys.EventArgs{constructor(t){super();this.card=t}}Object(h.a)(lo,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class pm extends Sys.EventArgs{constructor(t){super();this.L1c=t}}Object(h.a)(pm,"DesignerClickMoreIdesEventArgs",
Sys.EventArgs,[]);class qm extends Sys.EventArgs{constructor(t,S){super();this.P8k=t;this.wtl=S}}Object(h.a)(qm,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class rm extends gd.a{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff){super(new Tj.a,t,qb);this.Qcb=this.Rcb=this.QL=this.g0=this.edc=this.CX=null;this.aAg=this.fAg=0;this.kma=!1;this.dWg=this.yHa=this.CEb=null;this.Ro=la;this.ir=Ca;this.Sb=Na;this.Fa=Pb;this.Zc=xc;this.qe=S;this.xp=ed;this.Lr=dd;this.ia=fd;this.je=we;this.la=Sf;
this.FJh=this.la.useWideSuggestionThumbs;this.mR=new Kd.a(()=>new Uj(this.ia,this.la,S,xc,dd,Object(n.a)(this,this.X9f,"goPremiumExperience")));this.wwg=new fg(Ff,Object(n.a)(this,this.Brk,"onAccountUpgrade"),Sf.uRa);this.I4=new Xd;this.xak=Object.assign(new hf(fd,this.I4,this.la),{hy:Va.a.sab})}dispose(){this.kma&&this.OFf();this.CEb&&(this.CEb.dispose(),this.CEb=null);this.mR.X$a&&this.mR.value.dispose();super.dispose();P.a.J(512496477,829,50,"DesignerView::Dispose")}V8b(){this.CX=Ac.a.Ie();this.CX.className=
"DesignerViewContainer";this.container.appendChild(this.CX);this.kma=!0;P.a.J(512496476,829,50,"DesignerView::InitializeView")}OFf(){this.la.MOc&&this.ir.Rti();if(this.CX.children&&0<this.CX.children.length)for(const t=0;t<this.CX.children.length;)this.CX.removeChild(this.CX.children[t]);this.Ro.fba=0;this.Ro.sjh(Object(n.a)(this,this.onFocus,"onFocus"));this.Ro.tjh(Object(n.a)(this,this.w4g,"onFocusBlur"));this.mR.X$a&&this.mR.value.dismiss();P.a.J(512496475,829,50,"DesignerView::CleanUpView")}t0a(t){P.a.J(512496474,
829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",this.Sb.correlationId,ne[t]);this.uN();4!==t&&7!==t&&8!==t&&(this.OFf(),this.CX.id=this.Sb.correlationId);this.Ro.fba=t;switch(this.Ro.fba){case 1:this.wEj();this.$fl();break;case 7:this.Zfl();break;case 2:this.DEj();break;case 9:this.CEj();break;case 5:this.OEj();break;case 3:this.TEj();break;case 6:this.xEj();break;case 4:if(t=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let S=0;S<t.length;S++)t[S].style.visibility=
jb.a.visible,t[S].setAttribute(ue.gUd,ue.ECf)}this.Ro.cvf(Object(n.a)(this,this.onFocus,"onFocus"));this.Ro.dvf(Object(n.a)(this,this.w4g,"onFocusBlur"))}Ssa(){return this.la.DOf&&this.wwg.Ssa()}X9f(t){this.la.DOf&&(P.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",t?t.toString():""),this.mR.X$a&&this.mR.value.dismiss(),this.wwg.launchUpsellExperience(this.la.uRa?"designertrial":"designer"))}startFreeTrial(){this.mR.X$a&&this.mR.value.dismiss();this.ir.Xyl();this.Sb.X_e=
!0;this.Mw(0,!0);P.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}Brk(){P.a.J(512496471,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.mR.X$a&&this.mR.value.dismiss();this.ir.zDl()}wEj(){this.edc=Ac.a.Ie();this.edc.className="DesignerLoadingView";const t=Ac.a.SA();t.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";t.src=Qe.a.ZK(Zb.a.Zna);const S=Ac.a.Ie();S.className=v.AFrameworkApplication.isRtl?
"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";S.innerText=ResourceStrings.L_DesignerLoading;this.edc.appendChild(t);P.a.J(512496470,829,50,"DesignerView::spinner shows up");this.edc.appendChild(S);this.CX.appendChild(this.edc);P.a.J(512496469,829,50,"DesignerView::InitLoadingState")}EEj(){const t=Ac.a.Ie();t.className="DesignerNoSuggestionNewButton";t.tabIndex=0;t.innerText=ResourceStrings.L_DesignerLearnMoreShort;t.setAttribute("Unselectable","on");t.setAttribute(pa.a.ns,t.innerText);t.setAttribute(pa.a.af,
pa.a.Au);t.setAttribute("href",Zb.a.yOf);this.Zc.pb(ha.a.click,t,Object(n.a)(this,this.CGf,"clickSuggestionLinkHandler"));this.g0.appendChild(t)}BEj(){const t=Ac.a.Eca();t.className="DesignerNoSuggestionView-Link";t.setAttribute("href",Zb.a.yOf);t.setAttribute("target","_blank");t.innerText=ResourceStrings.L_DesignerLearnMore;t.tabIndex=0;t.setAttribute(pa.a.af,pa.a.gSd);this.g0.appendChild(t);this.Zc.pb(ha.a.click,t,Object(n.a)(this,this.CGf,"clickSuggestionLinkHandler"))}DEj(){this.Ro.isVisible&&
(this.Bee(!1),this.Rcb.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.Qcb.innerText=ResourceStrings.L_DesignerNoSuggestionContent,P.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}CEj(){this.Ro.isVisible&&(this.Bee(!0),this.Rcb.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.Qcb.innerText=ResourceStrings.L_DesignerNoIdeas,P.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}OEj(){this.Ro.isVisible&&(this.Bee(!1),this.Rcb.innerText=ResourceStrings.L_DesignerCoauthorHeader,
this.Qcb.innerText=ResourceStrings.L_DesignerCoauthorContent,P.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}Bee(t){this.g0=Ac.a.Ie();this.g0.className=v.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.Rcb=Ac.a.Ie();this.Qcb=Ac.a.Ie();this.ir.ekh(this.CX);if(t){this.Rcb.className="DesignerNoSuggestionNew-Header";this.Qcb.className="DesignerNoSuggestionNew-Content";const S=Ac.a.SA();S.src=this.qe.rk("DesignerNoIdeas.svg");S.className=
"DesignerNoIdeasIllustration";this.g0.appendChild(S)}else this.Rcb.className="DesignerNoSuggestionView-Header",this.Qcb.className="DesignerNoSuggestionView-Content";this.g0.appendChild(this.Rcb);this.g0.appendChild(this.Qcb);t?this.EEj():this.BEj();this.CX.appendChild(this.g0);this.Lr.addHandler(this.g0,ha.a.Xf,Object(n.a)(this,this.$ta,"inputKeyPressHandler"))}TEj(){this.Ro.isVisible||this.Ro.Ap(!0,$g.a.none);this.QL=Ac.a.Ie();const t=this.FJh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",
S=this.FJh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.QL.className=v.AFrameworkApplication.isRtl?S:t;this.CX.appendChild(this.QL);this.la.BOf||(this.Fa.Ej(ad.a.f_,!0),this.Fa.Ed());this.Zc.pb(ha.a.click,this.QL,Object(n.a)(this,this.cvi,"clickSuggestionHandler"));this.Lr.addHandler(this.QL,ha.a.Xf,Object(n.a)(this,this.GXc,"inputKeyApplyHandler"));this.xp.pb(ha.a.pointerOver,this.QL,Object(n.a)(this,this.cD,"onPointerOver"));this.xp.pb(ha.a.pointerOut,this.QL,Object(n.a)(this,
this.Cz,"onPointerOut"));P.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}Fjj(){return this.R6b(this.QL.querySelector("#"+this.Fo.id+" .DesignerSuggestionResultSelected"))}gbj(){return this.R6b(this.QL.querySelector("#"+this.Fo.id+" ["+ue.Rsb+"]:hover"))}R6b(t){let S;return({suggestionIndex:S}=this.j8f(t)).returnValue?parseInt(S):-1}j8f(t){let S,la,Ca;Ca=la=S="";if(t){const Na=t.getAttribute(ue.jCa),qb=t.getAttribute(ue.Rsb);if(!Na||!qb)return P.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",
this.Sb.correlationId),{returnValue:!1,suggestionIndex:S,slideId:la,f_e:Ca};S=Na.toString();la=qb.toString();(t=t.getAttribute(ue.fUd))?Ca=t.toString():P.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Sb.correlationId);return{returnValue:!0,suggestionIndex:S,slideId:la,f_e:Ca}}return{returnValue:!1,suggestionIndex:S,slideId:la,f_e:Ca}}S6b(){return this.QL.querySelectorAll("#"+this.Fo.id+" ["+ue.jCa+"]").length}CGf(t){return this.Ro.isVisible&&
t&&t.kC?this.i$f(t.kC.className):!1}rka(){const t=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",S=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(v.AFrameworkApplication.isRtl?S:t))}bvi(t){t=t.getAttribute(ue.jCa).toString();t=this.Sb.vQa[parseInt(t)];if(!t||3!==t.Type&&4!==t.Type)return!1;this.je.VOk(new lo(t));return!0}qQc(t,S){for(;t&&t.className!==S;)t=t.parentNode;
return t}cvi(t){if(!this.Ro.isVisible||t.uA!==Sys.UI.MouseButton.leftButton||!this.ir.Ba||!t.Ec)return!1;var S=t.Ec;try{if(S.className){if(S.className===Nd.rGb||S.className===Nd.sGb||S.className===Nd.SEe||S.className===Nd.Ddd)return this.avi(S);if(S.className.startsWith(Nd.GRf))return this.$ui(S)}else P.a.J(512496462,829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(fd){return P.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",S.className,
fd.message),!1}if(t=this.qQc(S,ue.PCf))return this.bvi(t);if(this.Ssa()){if(S.className===ue.Psb)return this.startFreeTrial(),!0;if(S.className===ue.u_b)return t=Pc.a.ai(S),this.mR.value.show(t,S,!0,S,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(t=this.qQc(S,ue.t_b))||(t=this.qQc(S,ue.ZIc));if(t)return this.X9f(null),!0}if(this.la.Eja&&(t=this.qQc(S,ue.aUd))){this.ir.HWc(this.rka());if(!t.getAttribute(ue.Osb))return!1;this.ir.knl(this.rka());t=new pm(t.getAttribute(ue.Osb).toString());
this.je.gPk(t);return!0}if(Sys.UI.DomElement.containsCssClass(S,"ms-Icon--Diamond")){if(S=S.parentNode,!S)return!1}else if(!(Sys.UI.DomElement.containsCssClass(S,ue.hJc)||Sys.UI.DomElement.containsCssClass(S,ue.x_b)||Sys.UI.DomElement.containsCssClass(S,ue.iJc)||(S=S.firstChild,S)))return!1;t=S.parentNode;var la=document.querySelector("#"+this.Fo.id+" ."+ue.pQa);if(!({suggestionIndex:xc,slideId:ed,f_e:dd}=this.j8f(t)).returnValue)return!1;var Ca=parseInt(xc),Na=parseInt(ed);const qb=parseInt(dd)||
0;let Pb=this.Sb.OZ.sid===Na;this.la.Eja&&(Pb=this.ir.vwb(la,!1)===t||this.ir.vwb(la,!0)===t);if(Pb)return P.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),this.je.Reh(new qm(Ca,this.S6b())),!1;if(t&&t.getAttribute(ue.bJc)){S=null;la=t.childNodes;for(Ca=0;Ca<la.length;Ca++)if(Na=la[Ca],Sys.UI.DomElement.containsCssClass(Na,ue.hJc)){S=Na;break}la=new Ip(xc,ed,dd);S=Pc.a.ai(S||t);this.mR.value.show(S,t,!1,null,null,la);return!1}if(Sys.UI.DomElement.containsCssClass(S,
ue.iJc))return!1;var xc=this.fjj(S,Na,qb);var ed=Object.assign(new bk,{SuggestionCid:qb,SuggestionSid:Na,CorrelationId:la.getAttribute("correlationId").toString(),ActiveSlideCid:this.ir.Ba.cid,ActiveSlideSid:this.ir.Ba.sid});var dd=S;dd=.01>=Math.abs(dd.width/dd.height-1.33);this.ir.vwb(la,dd)?(this.ir.NFf(la,dd),xc&&xc.parentNode&&xc.parentNode.parentNode&&this.ir.NFf(xc.parentNode.parentNode,dd),this.ia.La(Va.a.Wrb,2,ed),P.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):
(this.ia.La(Va.a.ZBa,2,ed),P.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.tMi&&t&&t.getAttribute(ue.STd)&&A.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(fd=>{try{fd.logActivity("DesignerAnimationSuggestion",null)}catch(we){P.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",we)}});this.ir.rqh(S.parentNode,dd);xc&&this.ir.rqh(xc.parentNode,dd);this.ir.Woh(this.CX,Ca);this.je.Reh(new qm(Ca,
this.S6b()));return!0}fjj(t,S,la){var Ca="["+ue.Rsb+'="'+S+'"] > .'+ue.x_b;la&&(Ca=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',ue.Rsb,S,ue.fUd,la,ue.x_b));S=document.querySelectorAll(Ca);if(!S)return null;for(la=0;la<S.length;la++)if(Ca=S[la],Ca!==t)return Ca;return null}$ta(t){this.Ro.isVisible&&(t.keyCode!==ua.a.tq&&t.keyCode!==ua.a.pP||this.i$f(t.target.className))}GXc(t){!this.Ro.isVisible||t.keyCode!==ua.a.tq&&t.keyCode!==ua.a.pP||(t.preventDefault(),(t=document.activeElement)&&t.click())}Mw(t,
S){if(!(0>t)){var la=this.QL.querySelector("["+ue.jCa+'="'+t+'"]');la?S&&(gc.FocusManager.Wr(la),this.ir.Woh(this.CX,t)):P.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",t)}}o9f(){return this.Ssa()?this.QL.querySelector("."+ue.u_b)?2:this.QL.querySelector("."+ue.Psb)?1:this.QL.querySelector("."+ue.t_b)?3:0:0}wng(){return!!this.QL.querySelector("."+ue.Psb+":focus")}Nqc(t){const S=this.QL.querySelector("."+ue.Psb);S?t?gc.FocusManager.Wr(S):S.blur():P.a.J(512496455,
829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}ubg(){this.yog()&&this.mR.value.Vxj()}yog(){return this.mR.X$a&&this.mR.value.AL}bYj(t){return t?!!t&&(t.className===ue.Psb||t.className===ue.ZIc||t.className===ue.u_b||t.className===ue.t_b):!1}Koa(t,S){let la=null;1===S?la=this.QL.querySelector("."+ue.ZIc):2===S?la=this.QL.querySelector("."+ue.u_b):3===S&&(la=this.QL.querySelector("."+ue.t_b));la?t?gc.FocusManager.Wr(la):la.blur():P.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",
S)}Cfl(t,S){(S=9===S?this.g0.querySelector(".DesignerNoSuggestionNewButton"):this.g0.querySelector(".DesignerNoSuggestionView-Link"))?t?S.focus():S.blur():P.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}AWj(t){return!(9===t?!this.g0.querySelector(".DesignerNoSuggestionNewButton:focus"):!this.g0.querySelector(".DesignerNoSuggestionView-Link:focus"))}i$f(t){try{const S=this.g0.querySelector("."+t);if(!S)return!1;const la=S.getAttribute("href").toString();if(!la)return!1;
Pc.a.openWindow(4,la);return!0}catch(S){return P.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",S),!1}}w4g(){this.Ro.isVisible&&this.mR.X$a&&this.mR.value.AL&&this.mR.value.dismiss()}onFocus(){if(this.Ro.isVisible)if(2===this.Ro.fba)gc.FocusManager.Wr(this.g0.lastChild);else if(3===this.Ro.fba){var t=this.o9f();if(1===t)this.Nqc(!0);else if(3===t)this.Koa(!0,t);else{t=this.Fjj();var S=this.gbj();-1===t?this.Mw(-1===S?0:S,!0):this.Mw(t,!0)}}}cD(t){return this.Ro.isVisible&&t.Ec?
this.FRf(t.clientPoint):!1}Cz(t){return this.Ro.isVisible&&t.Ec?this.FRf(t.clientPoint):!1}Ktj(t){this.uN();this.t0a(2);P.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",t);this.Ro.isVisible&&(this.Sb.fVa=!0,this.ia.La(Va.a.uoa,2,new Cm.a(!1,$g.a.qsd)))}$fl(){const t=this.Sb.correlationId;this.fAg=window.setTimeout(()=>{this.Ktj(t)},this.la.U_d)}Jtj(t){this.uN();this.ir.HWc(this.rka());P.a.J(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",
t)}Zfl(){const t=this.Sb.correlationId;this.aAg=window.setTimeout(()=>{this.Jtj(t)},this.la.U_d)}uN(){window.clearTimeout(this.fAg);window.clearTimeout(this.aAg)}get Fo(){return this.Ro}xEj(){this.QL.style.display=jb.a.none;this.Sb.gEe=!0;this.yHa=Ac.a.Ie();this.yHa.className=Nd.Rnk;const t=this.YKf(Nd.UEe),S=document.createElement("iframe");S.className=S.id=Nd.i_g;const la=this.YKf(Nd.TEe);this.yHa.appendChild(t);this.yHa.appendChild(S);this.yHa.appendChild(la);this.CX.appendChild(this.yHa);const Ca=
this.Fa.Fc(ad.a.aXc);Ca.parent=Ma.AFrame.ND;this.Zc.rGc(ad.a.aXc,S);Ca.Q7(()=>{S.focus();const Na=Object.assign(new jf.DOMFocusListing(()=>this.yHa),{Kib:!0});Na.Io(3);Na.Io(2);Na.Io(4);Na.Io(1);Na.Io(6);Na.Io(5);gc.FocusManager.instance().BTd(this.yHa,Ca,Na);const qb=gc.FocusManager.instance().uQ(ad.a.aXc);qb.Lib();qb.rX=!0;qb.NQa=!0;Ca.Dp(gc.FocusManager.instance().Wqa);Ca.Dp(gc.FocusManager.instance().Xqa);Na.ZE(S)});this.Fa.rf(ad.a.aXc);this.Lr.addHandler(this.yHa,ha.a.Xf,Object(n.a)(this,this.aA,
"keyDownHandler"))}YKf(t){const S=document.createElement("div");S.setAttribute("Id",t);S.setAttribute("tabindex",0);S.setAttribute("position","absolute");S.setAttribute("width","-1000px");S.setAttribute("top","-1000px");return S}aA(t){t.keyCode===Sys.UI.Key.tab&&(t.target.id!==Nd.TEe||t.shiftKey?t.target.id===Nd.UEe&&t.shiftKey&&this.Erh(t,Nd.TEe):this.Erh(t,Nd.UEe))}Erh(t,S){t.preventDefault();t.stopPropagation();(t=document.getElementById(S))&&t.focus()}avi(t){switch(t.className){case Nd.Ddd:return this.Fo.Zjb(1),
!0;case Nd.rGb:t=t.querySelector("."+Nd.sGb).innerText;break;case Nd.sGb:t=t.innerText;break;case Nd.SEe:t=t.parentNode.querySelector("."+Nd.sGb).innerText;break;default:return!1}return this.e1k(t)}e1k(t){this.la.Eja&&(this.dWg=this.rka().querySelector("."+ue.pQa).getAttribute("correlationId").toString());this.t0a(6);var S=cb.a.sN(this.la.pptEditingUserId).toString();S=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,Uh.a.xe(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,
Kc.a.create().toString(),3,S,0);S=S.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+t;t=document.getElementById(Nd.i_g);t.setAttribute("src",S);t.style.visibility=jb.a.visible;this.CEb=(new ee).getInstance(t.contentWindow,S);this.CEb.Txa(Qb.a.ztf,la=>{if(la=this.I4.l$g(la)){const Ca=[];Array.add(Ca,la);this.ia.processAction(Va.a.Mrc,2);this.Fo.Ap(!1,$g.a.SGf);this.xak.aua(Ca)}});this.CEb.Txa(Ah.YK,()=>{this.t0a(3);const la=new kk(this.Sb.suggestions,this.Sb.suggestions?this.Sb.suggestions.SlideSuggestions.length:
0,this.Sb.vQa.length,this.la.Eja?this.dWg:this.Sb.correlationId,this.rka(),!0,this.Ssa(),this.ir.pXc(Se.a.makeItVisual));this.ir.eSe(la)});return!0}$ui(t){return Sys.UI.DomElement.containsCssClass(t,Nd.jvb)||Sys.UI.DomElement.containsCssClass(t,Nd.ivb)?this.otj(t):Sys.UI.DomElement.containsCssClass(t,Nd.IRa)||Sys.UI.DomElement.containsCssClass(t,Nd.COc)||Sys.UI.DomElement.containsCssClass(t,Nd.KRf)||Sys.UI.DomElement.containsCssClass(t,Nd.JRf)?this.ptj(t):Sys.UI.DomElement.containsCssClass(t,Nd.n3b)?
this.Utj():Sys.UI.DomElement.containsCssClass(t,Nd.r3b)?this.cvj():!1}cvj(){this.ia.processAction(Va.a.RLe,2);this.Fo.Ap(!1,$g.a.eBk);return this.Sb.zRf=!0}FRf(t){const S=this.Sb.bXd;if(!S||of.a.Wa(this.Sb.GW))return!1;t=Pc.a.LSa(t);this.HNj(t)?S.OWc(this.n1f()):S.OWc([]);return!0}HNj(t){for(;t&&t.className!==Nd.x1d;)t=t.parentNode;return!!t&&t.className===Nd.x1d}Utj(){const t=this.Sb.bXd;if(!t)return!1;t.ignoreCritiques(this.n1f(),4);this.Sb.GW.splice(this.Sb.BN,1);if(this.Sb.BN===this.Sb.GW.length){let S;
(S=this.Sb).BN=S.BN-1}this.wUk();return!0}n1f(){const t=[];for(const S of this.Sb.GW[this.Sb.BN].critiques)t.push(S.critiqueId);return t}otj(t){if(Sys.UI.DomElement.containsCssClass(t,Nd.jvb)){let S;(S=this.Sb).BN=S.BN-1;this.Sb.BN||(Sys.UI.DomElement.removeCssClass(t,Nd.jvb),Sys.UI.DomElement.addCssClass(t,Nd.p3b));t=document.getElementById(Nd.hvb);Sys.UI.DomElement.removeCssClass(t,Nd.o3b);Sys.UI.DomElement.addCssClass(t,Nd.ivb)}else{let S;(S=this.Sb).BN=S.BN+1;this.Sb.BN===this.Sb.GW.length-1&&
(Sys.UI.DomElement.removeCssClass(t,Nd.ivb),Sys.UI.DomElement.addCssClass(t,Nd.o3b));t=document.getElementById(Nd.r8a);Sys.UI.DomElement.removeCssClass(t,Nd.p3b);Sys.UI.DomElement.addCssClass(t,Nd.jvb)}document.getElementById(Nd.w1d).innerText=(this.Sb.BN+1).toString();this.yHh(this.Sb.BN);return!0}yHh(t){var S=this.Sb.GW[t].critiques[0].explanationLabel;document.getElementById(Nd.IRf).innerText=S;S=document.getElementById(Nd.LRf);const la=ue.CKf();S.parentNode.replaceChild(la,S);this.ir.Xag(la,t)}ptj(t){const S=
this.Sb.bXd;if(of.a.Wa(this.Sb.GW)||!S)return!1;t=t.getAttribute(Ah.HRa);var la=document.querySelector("."+Nd.COc+"["+Ah.HRa+'="'+t+'"]');la&&(la.innerText="\u2713",Sys.UI.DomElement.removeCssClass(la,Nd.COc),Sys.UI.DomElement.addCssClass(la,Nd.nRi));la=new rc.a(0);for(const Ca of this.Sb.GW[this.Sb.BN].critiques)la.add(Ca.critiqueId,t);S.MBh(la);return this.Sb.AOc=!0}wUk(){var t=document.getElementById(Nd.xRf);let S=parseInt(t.innerText);S--;if(0>=S)this.rnl(document.getElementById(Nd.yRf));else{t.innerText=
S.toString();this.yHh(this.Sb.BN);t=this.Sb.BN===this.Sb.GW.length-1;const la=document.getElementById(Nd.hvb);1<S&&!t?(Sys.UI.DomElement.addCssClass(la,Nd.ivb),Sys.UI.DomElement.removeCssClass(la,Nd.o3b)):(Sys.UI.DomElement.addCssClass(la,Nd.o3b),Sys.UI.DomElement.removeCssClass(la,Nd.ivb));t&&(document.getElementById(Nd.w1d).innerText=S.toString());t=document.getElementById(Nd.r8a);1<S&&this.Sb.BN?(Sys.UI.DomElement.addCssClass(t,Nd.jvb),Sys.UI.DomElement.removeCssClass(t,Nd.p3b)):(Sys.UI.DomElement.addCssClass(t,
Nd.p3b),Sys.UI.DomElement.removeCssClass(t,Nd.jvb))}}rnl(t){const S=Ac.a.Ie();S.className=Nd.hRi;const la=new vc.a;la.lh(40,40);la.Dya("0,0,2048,2048");la.ur(Nd.oRi);var Ca=new Mj.a;Ca.v1("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Na=new Mj.a;Na.v1("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Na.xa.setAttribute("class",Nd.rRi);const qb=
new Mj.a;qb.v1("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
qb.xa.setAttribute("class",Nd.fRi);const Pb=new Mj.a;Pb.v1("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Pb.xa.setAttribute("class",Nd.eRi);la.appendChild(Ca);la.appendChild(Na);la.appendChild(qb);la.appendChild(Pb);Ca=Ac.a.Sn();Ca.innerText=ResourceStrings.l_ConsistencyCardNoMore;Ca.className=Nd.iRi;S.appendChild(la.xa);S.appendChild(Ca);t.parentNode.replaceChild(S,t)}}rm.cRi=[Nd.r8a,Nd.hvb,Nd.IRa,Nd.n3b,Nd.r3b];Object(h.a)(rm,"DesignerView",gd.a,[613,376,170,106]);var cm=d(189);class mo extends Sys.EventArgs{constructor(t,S){super();this.slideId=t.slideId;this.jAh=t.Esc;this.EUf=t.Taa;this.Y8a=S;this.trigger=
t.trigger;this.correlationId=t.correlationId}}Object(h.a)(mo,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class In{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we){this.jBg=new Xf.a;this.rp=t;this.ir=S;this.Sb=la;this.la=Ca;this.ia=Na;this.ua=qb;this.Jb=Pb;this.Lc=xc;this.Fa=ed;this.Fcc=this.nre=0;this.IWa=dd;this.k7j=fd;this.Ewa=we;this.Wu()}Wu(){this.Lc.cai(Object(n.a)(this,this.H7g,"onSuggestionsUpdated"));this.Lc.bai(Object(n.a)(this,this.n3g,"onCoauthModifiedSameSlide"));this.k7j.execute(t=>
{t.w8h(Object(n.a)(this,this.tzk,"onShowMoreSuggestions"),()=>{this.SLb(this.rp,3)})});this.la.designerIncrementalRenderEnabled&&this.Lc.dbi(Object(n.a)(this,this.i8g,"onUserBeginUploadPicture"));this.Lc.dHc(Object(n.a)(this,this.Qna,"onUndoRedo"))}dispose(){this.Lc.i_k(Object(n.a)(this,this.H7g,"onSuggestionsUpdated"));this.Lc.h_k(Object(n.a)(this,this.n3g,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Lc.R_k(Object(n.a)(this,this.i8g,"onUserBeginUploadPicture"));this.Lc.bmd(Object(n.a)(this,
this.Qna,"onUndoRedo"))}N9k(t){this.ia.La(Va.a.uoa,2,new Cm.a(!1,t))}SLb(t,S){t?t.t0a(S):P.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Sb.correlationId,S)}Sxj(t){const S=this.eNi(t);if(S){var la=S.Fo;P.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",t,ne[la.fba]);switch(la.fba){case 3:this.Rok(t,S);break;case 2:case 9:this.Qok(t,S,la.fba)}}}eNi(t){switch(t){case Va.a.PYa:case Va.a.FGb:case Va.a.GGb:case Va.a.QYa:case Va.a.IGb:case Va.a.JGb:case Va.a.HGb:case Va.a.Fgb:t=
this.rp;break;default:return null}return t}Rok(t,S){if(S&&S.Fo){var la=document.activeElement;if(la){var Ca=la.getAttribute(ue.jCa),Na=S.bYj(la),qb=Sys.UI.DomElement.containsCssClass(la,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(la,"IdeasText"),Pb=this.h_g(la)||this.ARf(la),xc=S.yog();if(Ca||qb||Pb||Na||xc)if(Ca=Ca?parseInt(Ca.toString()):-1,Na=S.S6b()-1,!(1>Na))switch(qb=S.Fo,Pb=S.o9f(),t){case Va.a.PYa:if(xc||1===Pb||3===Pb)break;qb.zA(!1);Ca<Na&&(S.Mw(Ca,!1),S.Mw(Ca+1,!0));
break;case Va.a.FGb:if(xc||1===Pb||3===Pb)break;qb.zA(!1);Ca!==Na&&(S.Mw(Ca,!1),S.Mw(Na,!0));break;case Va.a.GGb:if(xc){S.ubg();break}this.Vuj(S,Ca,Na,Pb);break;case Va.a.QYa:if(xc||1===Pb||3===Pb)break;qb.zA(!1);0<Ca&&(S.Mw(Ca,!1),S.Mw(Ca-1,!0));break;case Va.a.IGb:if(xc||1===Pb||3===Pb)break;qb.zA(!1);Ca&&(S.Mw(Ca,!1),S.Mw(0,!0));break;case Va.a.JGb:if(xc){S.ubg();break}this.Wuj(S,Ca,Na,Pb);break;case Va.a.HGb:case Va.a.Fgb:xc||1===Pb||3===Pb||(t=t===Va.a.Fgb,S=S.Fo,this.h_g(la)?this.Yuj(t,S):this.ARf(la)&&
this.Xuj(t,S))}}}}Vuj(t,S,la,Ca){const Na=t.Fo;if(-1===S){switch(Ca){case 1:Na.xUa?(Na.zA(!1),t.Nqc(!0)):t.wng()?(t.Nqc(!1),t.Koa(!0,Ca)):(t.Koa(!1,Ca),Na.zA(!0));return;case 2:Na.xUa?(Na.zA(!1),t.Mw(0,!0)):(t.Koa(!1,Ca),Na.zA(!0));return;case 3:S=Na.xUa;Na.zA(!S);t.Koa(S,Ca);return}Na.zA(!1);t.Mw(0,!0)}else S===la?(t.Mw(S,!1),2===Ca?t.Koa(!0,Ca):Na.zA(!0)):(t.Mw(S,!1),t.Mw(S+1,!0))}Wuj(t,S,la,Ca){const Na=t.Fo;if(0<S)t.Mw(S,!1),t.Mw(S-1,!0);else if(-1===S){switch(Ca){case 1:Na.xUa?(Na.zA(!1),t.Koa(!0,
Ca)):t.wng()?(t.Nqc(!1),Na.zA(!0)):(t.Koa(!1,Ca),t.Nqc(!0));return;case 2:Na.xUa?(Na.zA(!1),t.Koa(!0,Ca)):(t.Koa(!1,Ca),t.Mw(la,!0));return;case 3:S=Na.xUa;Na.zA(!S);t.Koa(S,Ca);return}Na.xUa&&(Na.zA(!1),t.Mw(la,!0))}else t.Mw(0,!1),Na.zA(!0)}Qok(t,S,la){if(S){var Ca=S.Fo;if(t===Va.a.GGb||t===Va.a.JGb||t===Va.a.QYa||t===Va.a.PYa)t=S.AWj(la),Ca.zA(t),S.Cfl(!t,la)}}h_g(t){return Sys.UI.DomElement.containsCssClass(t,Nd.Ddd)||Sys.UI.DomElement.containsCssClass(t,Nd.rGb)}ARf(t){return t.className.startsWith(Nd.GRf)}Yuj(t,
S){var la=document.activeElement;la&&(Sys.UI.DomElement.containsCssClass(la,Nd.rGb)?(la=parseInt(la.getAttribute(Nd.j_g).toString())+1,t?la!==Ah.bjc?S.Zjb(la+1):S.Zjb(1):1!==la?S.Zjb(la-1):S.Zjb(Ah.bjc)):t?S.Zjb(1):S.Zjb(Ah.bjc))}Xuj(t,S){var la=document.activeElement;if(la){for(var Ca=rm.cRi,Na=0;!Sys.UI.DomElement.containsCssClass(la,Ca[Na]);)if(Na++,Na===Ca.length){Na=-1;break}var qb=document.querySelectorAll("."+Nd.IRa).length;Ca[Na]!==Nd.IRa?t?Na!==Ca.length-1&&-1!==Na?Ca[Na+1]!==Nd.IRa?this.Yxb(Ca[Na+
1],S):S.hpd(0):this.Yxb(Ca[0],S):Na&&-1!==Na?Ca[Na-1]!==Nd.IRa?this.Yxb(Ca[Na-1],S):S.hpd(qb-1):this.Yxb(Ca[Ca.length-1],S):(la=parseInt(la.getAttribute(Ah.HRa).toString()),t?la!==qb-1?S.hpd(la+1):this.Yxb(Ca[Na+1],S):la?S.hpd(la-1):this.Yxb(Ca[Na-1],S))}}Yxb(t,S){switch(t){case Nd.r8a:S.rbl();break;case Nd.hvb:S.qbl();break;case Nd.n3b:S.obl();break;case Nd.r3b:S.pbl()}}Q7b(t,S){if(this.la.rZc&&this.rp.Fo.isVisible){if(S&&(t===Va.a.ZBa||t===Va.a.Wrb)){this.Sb.OZ=Q.a.empty;S=this.ua.presentation;
const la=this.Jb.Ad(7,void 0,void 0,void 0,!0);try{la.nc(S),this.la.EMi&&(la.jd=t),S.removeProperty(Wb.a.dDa)}finally{la&&la.dispose()}}this.ir.CCl(this.rp.rka());this.la.zMi&&t!==Va.a.ZBa&&t!==Va.a.Wrb&&this.ia.processAction(Va.a.COf,2)}}Qna(t,S){this.Q7b(S.G4e,S.Ebb)}hMj(t){return this.Sb.BAb(t)}rog(t){switch(t){case Wf.a.uSd:case Wf.a.xSd:case Wf.a.PZb:case Wf.a.wSd:case Wf.a.ySd:case Wf.a.zSd:case Wf.a.aQa:case Wf.a.ASd:case Wf.a.BSd:case Wf.a.CSd:case Wf.a.DSd:case Wf.a.FSd:case Wf.a.HSd:case Wf.a.backspace:case Wf.a.gCa:case Wf.a.bL:case Wf.a.rRa:case Wf.a.enter:case Wf.a.CB:case Wf.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.rZc}jMj(){return 0<this.Fcc}pWd(){return this.Fcc}n3g(t,S){t=S.slideId;P.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",t.sid);if((S=this.ua.Ba)&&S.Cb.equals(t)){S="unopened";this.rp.Fo.isVisible&&(this.rp.Fo.isVisible&&this.SLb(this.rp,5),S="set to SameSlideCoauthNoSuggestion UI");let la="unopened";this.rp.Fo.isVisible&&(this.dJa(this.Sb.correlationId,uj.a.cJa),la="closed");"unopened"===S&&"unopened"===
la||P.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",S,la,t.sid,t.cid,this.Sb.correlationId,this.nre,this.Fcc)}}H7g(t,S){P.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.rZc,this.nre,
this.Fcc,S.correlationId,S.trigger);if(this.isEnabled()){if(t=this.ua.Ba)if(S.slideId.equals(t.Cb))if(this.hMj(S.correlationId))P.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",S.correlationId);else if(this.eJl(S.correlationId))P.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
S.correlationId);else{this.Sb.correlationId!==S.correlationId&&(this.Sb.Vsf(S.correlationId,this.la.Eja&&S.trigger===Se.a.moreIdeas),P.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Sb.correlationId,S.correlationId));if(this.Sb.correlationId===S.correlationId&&this.rp.Fo.isVisible&&3===this.rp.Fo.fba)if(this.la.designerIncrementalRenderEnabled&&of.a.any(S.Esc.toArray(),la=>0<=this.Sb.nfa.indexOf(la)))this.Sb.pjc=
new Date,P.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",S.correlationId,S.Esc.toString(),this.Sb.nfa.toString());else if(t=S.BLa,!this.la.designerIncrementalRenderEnabled||this.Sb.wsa.contains(t)){P.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",S.correlationId,t.toString());
return}t=ue.P_d(S.lDa);this.V6k(t,S);this.Uxj(S);this.Txj(this.rp,S,t,S.Taa,of.a.Wa(this.Sb.vQa)?S.Taa:this.Sb.vQa.length)}else P.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",S.correlationId)}else P.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",S.correlationId)}V6k(t,S){if(t&&S.trigger!==Se.a.moreIdeas){this.Sb.suggestions||(this.Sb.suggestions=
Object.assign(new cj,{CardData:t.CardData,SlideSuggestions:Array(S.lee?S.Taa:S.W0a)}));if(!of.a.Wa(t.SlideSuggestions))for(const la of t.SlideSuggestions)this.Sb.suggestions.SlideSuggestions[la.Index]=la;this.Sb.vQa||(this.Sb.vQa=ue.RDk(t))}}Txj(t,S,la,Ca,Na){P.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",S.correlationId,S.trigger,S.Taa,Ca);if(S.trigger===Se.a.moreIdeas)this.Sb.xga||(this.Sb.xga=new Date),Ca=t.S6b(),
this.ir.f1k(la,t.rka(),S.correlationId,t.Ssa())||(this.ir.HWc(t.rka()),Ca=t.S6b()-1),t.Mw(Ca,!0),this.SLb(t,8);else if(!Ca)!this.la.designerNewNoIdeasUxEnabled||S.trigger!==Se.a.Ytc&&S.trigger!==Se.a.IOb?this.SLb(t,2):this.SLb(t,9),this.rp.Fo.isVisible?this.dJa(this.Sb.correlationId,uj.a.cJa):this.N9k($g.a.noSuggestion);else if(this.Bkl(S.trigger,t.Fo)){var qb=!0;if(this.la.designerIncrementalRenderEnabled){qb=null;var Pb=t.rka();Pb&&(qb=Pb.querySelector("#"+t.Fo.id+" ."+ue.pQa+'[correlationId="'+
S.correlationId+'"]'));qb=!qb;P.a.J(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",S.correlationId,S.trigger,qb);Pb=new mo(S,qb);this.Lc.tQk(Pb)}if(qb){this.SLb(t,3);this.Sb.xga||(this.Sb.xga=new Date);try{this.la.NIk&&this.Ewa.execute(xc=>{xc.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(xc){P.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
xc)}}t=new kk(la,Ca,Na,S.correlationId,t.rka(),qb,t.Ssa(),this.ir.pXc(S.trigger));this.ir.eSe(t)}}Uxj(t){t.lee?(of.a.Wa(this.Sb.suggestions.SlideSuggestions)||this.Sb.suggestions.SlideSuggestions.length===t.Taa)&&this.dJa(t.correlationId,uj.a.success,this.Sb.suggestions,t.trigger):this.dJa(t.correlationId,uj.a.success,this.Sb.suggestions,t.trigger)}Bkl(t,S){return S.isVisible||t!==Se.a.vna&&t!==Se.a.bVd&&t!==Se.a.qtb}Hrd(t,S){this.Fcc=t;this.nre=S;this.Lc.Gy(new cm.a(1))}i8g(){this.rp.Fo.isVisible&&
3===this.rp.Fo.fba&&(this.jBg.add(this.Sb.correlationId),this.rp.t0a(1))}eJl(t){return this.jBg.contains(t)}dJa(t,S,la=null,Ca=""){P.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",t,S,Ca);this.IWa.execute(Na=>{const qb=this.TBi(t,la);cb.a.Wa(Ca)||(qb.trigger=Ca);Na.notifySlideSuggestion(S,qb)})}TBi(t,S){const la=new Xi;la.correlationId=t;if(!S)return P.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",
t),la;la.suggestions=this.ir.xEk(S);return la}tzk(t){t=new kk(this.Sb.suggestions,t.suggestions.length,t.suggestions.length,t.correlationId,this.rp.rka(),!0,this.rp.Ssa(),this.ir.pXc(t.trigger));this.ir.eSe(t);this.Fa.Ej(ad.a.f_,!0)}SCk(){return 4===this.rp.Fo.fba}PCk(){return 1===this.rp.Fo.fba}}Object(h.a)(In,"DesignerManager",null,[616,106]);class Fl{constructor(t,S){this.cfb=this.Ao=null;this.Whk=S;this.Le=t;this.rr=!1}get Bh(){return this.rr}setup(){this.Bh||(this.cfb=Ac.a.Ie(),this.cfb.setAttribute("Unselectable",
"on"),this.cfb.style.position=jb.a.absolute,this.Le.addCssClass(this.cfb,"designerPreviewImageContainer"),this.Ao=new Vb.a,this.rr=!0)}dispose(){this.Bh&&(this.dismiss(),this.Ao&&this.Ao.xa.parentNode&&(this.Ao.zq(),this.Le.removeCssClass(this.Ao.xa,"designerPreviewImageContainer")))}dismiss(){this.Bh?(this.loa(),this.Ao.setVisibility(!1)):P.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}Loa(t){if(this.Bh){this.cfb&&(this.cfb.appendChild(this.Ao.xa),this.Le.addCssClass(this.Ao.xa,
"designerPreviewImageContainer"),this.Ao.setVisibility(!1));var S=this.Whk.Ic;if(t=this.uja(t))this.loa(),S.asc.appendChild(this.cfb),this.Ao.xa.appendChild(t),this.Ao.setVisibility(!0);this.Ao.lh(S.MB.clientWidth,S.MB.clientHeight)}else P.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}uja(t){if(!cb.a.Wa(t)){const S=Ac.a.SA();S.setAttribute("Unselectable","on");S.src=t;S.style.height="100%";S.style.width="100%";return S}return null}loa(){this.Ao.xa.firstChild&&this.Ao.xa.removeChild(this.Ao.xa.firstChild)}}
Object(h.a)(Fl,"DesignerPreviewImageView",null,[617]);var Qk=d(162);class sm{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we){this.hM=null;this.QIa=0;this.ia=t;this.Jb=S;this.ob=la;this.ua=Ca;this.Fb=Na;this.la=qb;this.wi=Pb;this.rj=xc;this.fc=ed;this.V9=dd;this.zb=fd;this.Sd=we;this.Oma=bj.ready}wb(){this.ia.ra(Va.a.fixIt,$a.a.application,Object(n.a)(this,this.Ctj,"handleFixIt"),4);this.ia.ra(Va.a.aOe,$a.a.application,Object(n.a)(this,this.dwj,"handleQueryFixIt"),96);this.ia.ra(Va.a.Xrb,$a.a.application,
Object(n.a)(this,this.Xrb,"applyFixItSuggestion"),4);this.ia.ra(Va.a.p_a,$a.a.application,Object(n.a)(this,this.p_a,"reportFixItSessionInfo"),64);this.V9.VYb(Object(n.a)(this,this.wfa,"onBlockingStateChanged"))}dispose(){this.V9.Xld(Object(n.a)(this,this.wfa,"onBlockingStateChanged"))}Ctj(t,S,la){S=this.ob.Xd();if(2>S.length)return 8;if(1===la)return 32;la=this.ua.presentation;this.la.designerBlockApplyUntilDraw?this.fc.Qra(la,this.ua.Ba,this.Fb.Ma,t):this.fc.hw(la,t);this.rj.hZc=!0;const Ca=[];S.forEach(Na=>
{Array.add(Ca,Na.get_shapeId())});t={};t.SelectedShapeIds=Ca.join(",");this.rj.skb=Ca;this.Kbe(t);this.rj.Clb=window.setTimeout(()=>{this.Dtj(this.rj.correlationId)},this.la.FXf);return 32}Dtj(t){this.rj.fVa=!0;P.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",t);this.ia.La(Va.a.p_a,2,$g.a.qsd);this.Sd.Csa(Cj.a.Vh(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}Kbe(t=null,S=null){this.VUi(la=>{if(this.la.designerRequestThrottlingEnabled){if(this.Oma.Cmg&&
+new Date-+this.Oma.Hpg<this.la.designerRequestThrottleIntervalMs){this.hM=new Dl;this.hM.sid=la.sid;this.hM.cid=la.cid;this.hM.QWc=la.SN;return}this.Oma=bj.inProgress;this.hM=null}const Ca=()=>{this.Kbe(this.hM.QWc,S)};this.wi.$ja(la.cid,la.sid,la.correlationId,null,mf.a.fixIt,S,Ie.c(la.SN),Na=>{Na&&Na.Status===mf.a.Dlh?this.Wmd(()=>{this.Kbe(la.SN,S)}):this.QIa=0;this.QIa||this.N7b(Ca)},Na=>this.jhb(Na,Ca))},t)}Wmd(t){this.QIa<this.la.designerMaxRetryOnWait?this.zb.Db(new V.a(2,1,1E3,()=>{P.a.J(578937822,
829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.rj.correlationId);this.Oma=bj.ready;this.QIa++;t()},void 0,"RetryRequestOnWait")):P.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.rj.correlationId)}Xrb(t,S,la,Ca,Na){S=this.ua.presentation;if(!this.ua.Ba||!S)return 16;Ca=null;Object(Pk.a)(bk,Na)&&(Ca=Na);if(!Ca)return 8;if(1===la)return 32;la=this.Jb.oe(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.rj.VPa=new Date),la.nc(S),la.jd=t,S.dDa=Ca,this.rj.OZ=Q.a.VE(Ca.SuggestionSid,Ca.SuggestionCid),this.rj.IT=!0,P.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ca.CorrelationId,t,Ca.SuggestionSid)}finally{la&&la.dispose()}return 32}VUi(t,S=null){const la=this.ua.Ba;la&&la.sid&&(S=Object.assign(new Fn,{sid:la.sid,cid:la.cid,SN:S||{}}),P.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",S.sid,S.correlationId),this.rj.correlationId&&
this.Jjb($g.a.ljb),this.rj.V0a=new Date,this.rj.correlationId=S.correlationId,this.rj.eQ=new Date,t(S))}N7b(t){this.la.designerRequestThrottlingEnabled&&(this.Oma=bj.ready,this.hM&&t())}jhb(t,S){this.N7b(S);P.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",t.HttpStatusCode);return!0}dwj(t,S,la,Ca,Na){this.kzl();if(!Object(Pk.a)(ol.a,Na))return 8;if(1<this.ob.sod()){let qb;(qb=this.rj).Msb=qb.Msb+1;return 32}return 8}p_a(t,S,la,Ca,
Na){if(Na===$g.a.noSuggestion||Na===$g.a.qsd)this.la.designerBlockApplyUntilDraw?this.fc.Auc(Qk.e(this.ua.Ba,this.Fb.Ma)):this.fc.hK(this.ua.presentation);this.Jjb(Na);return 32}wfa(t,S){if(this.rj.hZc){t=this.fc.$c(this.ua.presentation);const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";t||Object(D.a)(String,S.actionName)!==la||(window.clearTimeout(this.rj.Clb),this.rj.fVa||(this.rj.U0a=new Date),this.rj.VPa=null,this.rj.hZc=!1)}}Jjb(t){const S=this.rj.correlationId;
if(cb.a.Wa(S))P.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",t);else{var la={};this.rj.OZ&&(la.SuggestionSlideId=this.rj.OZ.sid.toString(),la.SuggestionSlideCreationId=this.rj.OZ.cid.toString());la.AppliedSuggestion=this.rj.IT;la.DisplaySuggestionsTimeoutInMs=this.la.FXf;la.SuggestionsTimeout=this.rj.fVa;la.ClientAbort=this.rj.pzb;la.ResetReason=t;la.DesignerSendTraceRequestOnSessionEnded=this.la.V_d;var Ca=Wd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
Na={};Na.ClientOS=Ca.Os;Na.Browser=Ca.Browser||"";Na.BrowserVersion=Ca.BrowserVersion||"";Na.BrowserMajorVersion=Ca.BrowserMajorVersion||"";Na.BrowserMinorVersion=Ca.BrowserMinorVersion||"";this.rj.V0a&&this.rj.MNb&&this.rj.MNb>this.rj.V0a&&(Na.SuggestionsE2ETimeMs=+this.rj.MNb-+this.rj.V0a);this.rj.V0a&&this.rj.U0a&&this.rj.U0a>this.rj.V0a&&(Na.SuggestionAppliedE2ETimeMs=+this.rj.U0a-+this.rj.V0a);la.BrowserData=Na;this.rj.eQ&&this.rj.U0a&&this.rj.U0a>this.rj.eQ&&(la.TimeToDisplaySuggestionsInMs=
+this.rj.U0a-+this.rj.eQ);this.rj.y2e&&(la.TimeSuggestionsRendered=this.rj.y2e.toUTCString());this.wi.uoa(S,Ie.c(la),t===$g.a.Lod);this.rj.WSe();P.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",t,S)}}kzl(){try{const t=A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&t.execute(S=>{S.logActivity("AutoFixInViewportActivity",null)})}catch(t){P.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",
t)}}G5(){}F5(){}}Object(h.a)(sm,"FixItActor",null,[145]);class Rl{constructor(){this.Msb=0;this.correlationId=this.skb=null;this.Clb=0;this.pzb=this.hZc=this.IT=this.fVa=!1;this.suggestion=this.eQ=this.U0a=this.VPa=this.MNb=this.V0a=this.y2e=null;this.OZ=Q.a.empty}WSe(){this.Msb=0;this.correlationId=this.skb=null;this.OZ=Q.a.empty;this.Clb=0;this.pzb=this.hZc=this.IT=this.fVa=!1;this.eQ=this.U0a=this.VPa=this.MNb=this.V0a=this.y2e=null}}Object(h.a)(Rl,"FixItContext",null,[621]);var Yf=d(957),Jn=d(981),
Ak=d(857),Ye=d(922);class cl{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd){this.ia=t;this.ua=S;this.Jb=la;this.Lc=Ca;this.rj=Na;this.Yf=qb;this.VFb=Pb;this.hJ=xc;this.Oc=ed;this.Sd=dd;this.Wu()}Wu(){this.VFb.UYb(Object(n.a)(this,this.CH,"onEvent"));this.Yf.tI(Object(n.a)(this,this.CH,"onEvent"));this.Oc.LPa(Object(n.a)(this,this.CH,"onEvent"));this.Oc.iC(Object(n.a)(this,this.CH,"onEvent"));this.Lc.oai(Object(n.a)(this,this.G7g,"onSuggestionReceived"));this.Lc.dHc(Object(n.a)(this,this.Qna,"onUndoRedo"))}dispose(){this.Lc.p_k(Object(n.a)(this,
this.G7g,"onSuggestionReceived"));this.Lc.bmd(Object(n.a)(this,this.Qna,"onUndoRedo"))}G7g(t,S){if(t=this.ua.Ba)if(S.slideId.equals(t.Cb))if(this.rj.correlationId!==S.correlationId)P.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.rj.correlationId,S.correlationId);else if(t=cl.P_d(S.lDa),t.SlideSuggestion)this.rj.MNb||(this.rj.MNb=new Date),S=Object.assign(new bk,{SuggestionCid:t.SlideSuggestion.SlideId.Cid,
SuggestionSid:t.SlideSuggestion.SlideId.Sid,CorrelationId:S.correlationId,ActiveSlideCid:Object(D.a)(116,this.ua.Ba).cid,ActiveSlideSid:Object(D.a)(116,this.ua.Ba).sid}),this.ia.La(Va.a.Xrb,2,S);else switch(this.ia.La(Va.a.p_a,2,$g.a.noSuggestion),t.ResponseDescription){case "Invalid request":this.Sd.Csa(Cj.a.Vh(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Sd.Csa(Cj.a.Vh(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Sd.Csa(Cj.a.Vh(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else P.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",S.correlationId)}zQ(t){this.rj.correlationId&&t!==Va.a.Xrb&&this.ia.La(Va.a.p_a,2,$g.a.ZPb+this.hJ.Z5(t))}Q7b(t,S,la){if(this.rj.correlationId&&la&&S===Va.a.Xrb){this.rj.OZ=
Q.a.empty;la=this.ua.presentation;const Ca=this.Jb.Ad(7,void 0,void 0,void 0,!0);try{Ca.nc(la),Ca.jd=S,la.removeProperty(Wb.a.dDa)}finally{Ca&&Ca.dispose()}this.ia.La(Va.a.p_a,2,$g.a.ZPb+this.hJ.Z5(t))}}Qna(t,S){this.Q7b(S.actionId,S.G4e,S.Ebb)}CH(t,S){t=!1;let la="";if(Object(Pk.a)(Yf.a,S)){P.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.rj.correlationId,Gn.a[Object(D.a)(Yf.a,S).NE]);if(1===Object(D.a)(Yf.a,S).NE||3===Object(D.a)(Yf.a,S).NE)t=!0;la=$g.a.Lod}else Object(Pk.a)(Jn.a,
S)?(P.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),t=!0,la=$g.a.qXk):Object(Pk.a)(Ak.a,S)?(t=!0,la=$g.a.slideNavigation):Object(Pk.a)(Ye.a,S)&&Object(D.a)(Ye.a,S).Nzb&&this.zQ(Object(D.a)(Ye.a,S).actionId);t&&this.rj.correlationId&&this.ia.La(Va.a.p_a,2,la);this.r5j()}r5j(){0<this.rj.Msb&&(P.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.rj.Msb),this.rj.Msb=0)}static P_d(t){let S=null;try{S=Wd.a(t)}catch(la){P.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return S}}
Object(h.a)(cl,"FixItManager",null,[620,106]);var ip=d(1031),pl=d(16),Ej;(function(t){t[t.seen=0]="seen";t[t.keep=1]="keep";t[t.drillIn=2]="drillIn"})(Ej||(Ej={}));Object(h.b)("IdeasCardAction",Ej);var ai;(function(t){t[t.designer=0]="designer";t[t.makeItVisual=1]="makeItVisual";t[t.editor=2]="editor";t[t.UNKNOWN=3]="UNKNOWN"})(ai||(ai={}));Object(h.b)("IdeasCardType",ai);class tk{constructor(t,S){this.bva=null;this.sgc=!1;this.ia=t;this.la=S;this.ia.ya(Va.a.ideasPaneOpened,$a.a.application,Object(n.a)(this,
this.Ttj,"handleIdeasPaneOpen"));this.ia.ya(Va.a.Jde,$a.a.application,Object(n.a)(this,this.Stj,"handleIdeasPaneClose"));this.ia.ya(Va.a.Jdg,$a.a.application,Object(n.a)(this,this.lag,"handleIdeasKeep"));this.ia.ya(Va.a.Kdg,$a.a.application,Object(n.a)(this,this.Obe,"handleIdeasSee"));this.ia.ya(Va.a.Pdg,$a.a.application,Object(n.a)(this,this.Obe,"handleIdeasSee"));this.ia.ya(Va.a.Qdg,$a.a.application,Object(n.a)(this,this.Nbe,"handleIdeasDrillIn"));this.ia.ya(Va.a.Ndg,$a.a.application,Object(n.a)(this,
this.lag,"handleIdeasKeep"));this.ia.ya(Va.a.Odg,$a.a.application,Object(n.a)(this,this.Obe,"handleIdeasSee"));this.ia.ya(Va.a.Ldg,$a.a.application,Object(n.a)(this,this.Nbe,"handleIdeasDrillIn"));this.ia.ya(Va.a.Mdg,$a.a.application,Object(n.a)(this,this.Nbe,"handleIdeasDrillIn"))}Ttj(){if(!this.la.pptIdeasContextEnabled)return 2;this.sgc=!0;this.EMj()||this.Orl(Kc.a.create());return 32}Stj(){if(!this.la.pptIdeasContextEnabled)return 2;this.sgc=!1;return 32}lag(t){if(!this.la.pptIdeasContextEnabled)return 2;
this.Byl(this.b0d(t));return 32}Obe(t){if(!this.la.pptIdeasContextEnabled)return 2;this.Ptd(this.b0d(t));return 32}Nbe(t){if(!this.la.pptIdeasContextEnabled)return 2;this.zyl(this.b0d(t));return 32}b0d(t){switch(t){case Va.a.Jdg:case Va.a.Kdg:case Va.a.Ldg:t=0;break;case Va.a.Pdg:case Va.a.Qdg:t=1;break;case Va.a.Ndg:case Va.a.Odg:case Va.a.Mdg:t=2;break;default:t=3}return t}Orl(){this.la.pptIdeasContextEnabled&&(this.bva=new ip.a)}Ptd(t){this.la.pptIdeasContextEnabled&&this.sgc&&3!==t&&this.bva&&
!this.bva.any(S=>S.key===t)&&this.bva.add(new pl.a(t,0))}Byl(t){this.sgc&&3!==t&&this.bva&&this.bva.add(new pl.a(t,1))}zyl(t){this.sgc&&3!==t&&this.bva&&this.bva.add(new pl.a(t,2))}EMj(){return!!this.bva&&0<this.bva.length}}Object(h.a)(tk,"IdeasContext",null,[619]);class no{constructor(){this.By=this.Ay=null;this.JC=this.wx=0}}Object(h.a)(no,"ImageLocationInfo",null,[]);var oo=d(439);class Ji{}Object(h.a)(Ji,"ImageToTableRequest",null,[]);class uk{}uk.meg="ImageToTableTile";uk.keg="ImageToTable.Request";
uk.leg="ImageToTable.Response";Object(h.a)(uk,"ImateToTableAugmentationSchemaNames",null,[]);class Ko{constructor(){this.D0=this.a0=null}get sG(){return"ImageToTableALWorkflow"}get proto(){return""}get ssb(){this.a0||(this.a0=Object.assign(new oo.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:uk.meg,outputSchema:uk.keg,func:Object(n.a)(this,this.Lbb,"lambdaBeforeFunc")}));return this.a0}get Erb(){return null}get mKb(){this.D0||(this.D0=Object.assign(new oo.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:uk.keg,outputSchema:uk.leg,func:null}));return this.D0}Lbb(t,S,la){t=Object.assign(new Ji,{image:t.image});la(t)}}Object(h.a)(Ko,"ImageToTableALWorkflow",null,[656]);class Gl{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(h.a)(Gl,"ImageToTableALv2ResponseWrapper",null,[]);class Ci{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.zbc=null}}Object(h.a)(Ci,"ImageToTableTile",null,[]);class dk{constructor(t,
S,la,Ca,Na,qb,Pb,xc,ed,dd,fd){this.ia=t;this.ob=S;this.fc=la;this.Qk=Ca;this.hA=Na;this.Tb=Pb;this.Sk=xc;this.sqe=ed;this.ima=dd;this.la=fd}initialize(){this.ia.ya(Va.a.QLe,$a.a.application,Object(n.a)(this,this.R$f,"handleConvertImageToTable"));this.ia.ya(Va.a.YLe,$a.a.application,Object(n.a)(this,this.Yag,"handleReplaceImageWithHtmlTable"));this.Qk.tI(Object(n.a)(this,this.DB,"onActiveSlideChanged"));this.sqe.execute(t=>{const S=new Ko;t.registerSimpleRemoteWorkflow(S.sG,S.ssb,S.mKb,S.Erb);t.addEventHandler(uk.leg,
Object(n.a)(this,this.Wtj,"handleImageToTableALResults"));t.tia("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");t.oKa("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(n.a)(this,this.u_,"handleAnnotationEvent"))})}dispose(){this.ia.RJ(Va.a.QLe,$a.a.application,Object(n.a)(this,this.R$f,"handleConvertImageToTable"));this.ia.RJ(Va.a.YLe,$a.a.application,Object(n.a)(this,this.Yag,"handleReplaceImageWithHtmlTable"));this.Qk.X5(Object(n.a)(this,this.DB,"onActiveSlideChanged"))}DB(){this.ima.close()}R$f(t,
S,la){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===la)return 32;t=this.ob.Xd();if(1!==t.length)return 8;const Ca=this.ima.fBk();if(!Ca)return P.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Na=t[0];this.la.Xbh&&(this.ima.Xal(Ca,Na.slideSid,Na.get_shapeId(),dk.HYd(Na)),this.ima.u3g(Ca));this.sqe.execute(qb=>{qb.vIl(Na.slideCid,Na.slideSid,Na.get_shapeId(),Pb=>{this.mag(Ca,Na,Pb)},()=>{this.mag(Ca,Na,null);return!0})});
return 32}u_(t){if(t&&"errorDescription"in t&&"parentPath"in t&&"errorCode"in t){var S=new Gl,la=t.errorDescription.split(";");S.errorDescription=la[0].split(":")[1];S.processId=la[1].split(":")[1];S.errorCode=t.errorCode;P.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",S.processId,S.errorCode,S.errorDescription);la=t.parentPath[1].split("|");S.slideId=Number.parseInvariant(la[0]);S.shapeId=Number.parseInvariant(la[2]);S.html=t.html;
this.ima.Val(S);this.ima.t3g()}}mag(t,S,la){if(la&&la.ImgData)if(this.la.Xbh)this.ima.Wal(t,la.ImgData),this.ima.t3g();else{const Ca=dk.HYd(S),Na=Object.assign(new Ci,{sessionId:t,slideSid:S.slideSid,shapeId:S.get_shapeId(),zbc:Ca,image:la.ImgData});this.sqe.execute(qb=>{qb.submit(uk.meg,Na)});this.ima.u3g(t)}else this.ima.Gvk(t)}Wtj(t,S,la,Ca){P.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Ca.processId,Ca.errorCode,Ca.errorDescription);
this.ima.Ctk(S,Ca)}Yag(t,S,la,Ca,Na){t=this.Tb.uEa(Na.slideSid);if(!t)return 8;la=(S=t.lT(Na.shapeId))?dk.HYd(S):Na.zbc;if(!la)return 8;P.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",S.get_shapeId());Na=this.Sk.RYd(!1,t.cid,t.sid,!1,la.Ay,la.By,la.wx,la.JC,t.Wt()+1,Na.ABh,"");this.hA.HW([Na],t,0,null,S);this.fc.hw(t,"ImageToTable");return 32}static HYd(t){return Object.assign(new no,{Ay:t.Ay,By:t.By,wx:t.wx,JC:t.JC})}}Object(h.a)(dk,"ImageToTableActor",null,[]);class Rk{constructor(t){this.shapeId=
this.slideId=0;this.Vde=null;this.d7e=0;this.Sce=!1;this.mlc=null;this.L_c=!1;this.kXc=this.Zde=this.i2g=this.H8g=null;this.sessionId=t}}Object(h.a)(Rk,"ImageToTableConversionContext",null,[]);class Lo{constructor(){this.shapeId=this.slideSid=0;this.ABh=this.zbc=null}}Object(h.a)(Lo,"ReplaceImageWithHtmlTableData",null,[]);class Kn{constructor(t,S,la,Ca){this.ia=t;this.Yc=S;this.Ha=la;this.qze=Ca;this.Y9=null}initialize(){this.Yc.execute(t=>{t.WGc(Object(n.a)(this,this.u4g,"onFirstPartyAddInHidden"))});
this.qze.TPd(Object(n.a)(this,this.yag,"handleMessage"))}dispose(){this.Yc.execute(t=>{t.o_k(Object(n.a)(this,this.u4g,"onFirstPartyAddInHidden"))});this.qze.gjh(Object(n.a)(this,this.yag,"handleMessage"))}fBk(){this.close();const t=new Rk(Kc.a.create().toString());t.H8g=new Promise(la=>{t.i2g=()=>{la(t.sessionId)}});const S={};S.XE=ResourceStrings.L_DataFromPicturePaneTitle;S.assetId="FA000000050";S.H5=()=>{this.bhb(t)};S.nonPersistedSettings={["SessionID"]:t.sessionId};S.sourceLocationOverrideResourceId=
this.Ha.pptImageToTableSourceLocationId;return 32===this.ia.La(Va.a.lga,2,S)?(this.Y9=t,this.Y9.sessionId):this.Y9=null}close(){this.kWd(this.Y9)}bhb(t){P.a.J(509208392,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",t.sessionId);const S=this.Yc.instance.oQ("FA000000050");if(S&&S.settings&&"SessionID"in S.settings){var la;({sv:la}=Wd.d(S.settings.SessionID)).returnValue&&(t.sessionId===la?(t.mlc=S.instanceId,P.a.J(509208391,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
S.instanceId)):P.a.J(509208390,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}kWd(t){t&&t.mlc&&(t.L_c=!0,this.ia.La(Va.a.Ftb,2,t.mlc))}Xal(t,S,la,Ca){if(t=this.Jwb(t))t.slideId=S,t.shapeId=la,t.Vde=Ca}Val(t){const S=this.Y9;S&&S.slideId===t.slideId&&S.shapeId===t.shapeId&&(this.Y9.kXc=t)}Wal(t,S){if(t=this.Jwb(t))t.Zde=S}u3g(t){const S=this.Jwb(t);S&&(S.d7e=window.setTimeout(()=>{this.Gsj(S)},this.Ha.pptImageToTableALWorkflowTimeoutMs))}Ctk(t,S){if(t&&S){var la=this.Jwb(t.sessionId);if(la&&
!la.Sce)if(la.slideId=t.slideSid,la.shapeId=t.shapeId,la.Vde=t.zbc,window.clearTimeout(la.d7e),0===S.errorCode){const Ca={};Ca.tableHtml=S.html;Ca.imageData=t.image;this.sendMessage(la.sessionId,Ca)}else this.Aod(t.sessionId,"Failed to convert image to table")}}t3g(){const t=this.Y9;if(t&&!t.Sce&&t.kXc&&t.Zde)if(window.clearTimeout(t.d7e),0===t.kXc.errorCode){const S={};S.tableHtml=t.kXc.html;S.imageData=t.Zde;this.sendMessage(t.sessionId,S)}else this.Aod(t.sessionId,"Failed to convert image to table")}Gvk(t){this.Aod(t,
"Failed to render the image shape")}Gsj(t){t.Sce=!0;this.Aod(t.sessionId,"Failed to convert image to table using AL")}yag(t,S){S=S.message;(t=this.Jwb(S.session_id))&&!t.L_c&&("ACK"===S.cmd_type?(P.a.J(509208389,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",S.cmd_type),t.i2g()):"cancel"===S.cmd_type?(P.a.J(509208388,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",S.cmd_type),this.kWd(t)):"insert_html"===S.cmd_type?(P.a.J(509208387,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
S.cmd_type),S=Object.assign(new Lo,{slideSid:t.slideId,shapeId:t.shapeId,zbc:t.Vde,ABh:S.parameters}),this.kWd(t),this.ia.La(Va.a.YLe,2,S)):P.a.J(509208386,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",S.cmd_type))}Aod(t,S){this.sendMessage(t,{["errorMessage"]:S})}sendMessage(t,S){const la=this.Jwb(t);la&&la.sessionId===t&&la.H8g.then(()=>{this.qze.sendMessage(la.mlc,S)})}Jwb(t){return t&&this.Y9&&this.Y9.sessionId===t?this.Y9:null}u4g(t,S){S&&this.Y9&&
S.instanceId===this.Y9.mlc&&(this.Y9=null)}}Object(h.a)(Kn,"ImageToTablePane",null,[623]);class sn extends Sys.EventArgs{constructor(t){super();this.message=t}}Object(h.a)(sn,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class tn{constructor(t){this.va=new bm.a;this.Ha=t}TPd(t){this.va.addHandler("ImageToDocPaneMessageReceived",t)}gjh(t){this.va.removeHandler("ImageToDocPaneMessageReceived",t)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(n.a)(this,this.njc,
"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(n.a)(this,this.njc,"messageReceivedHandler")):P.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(t){P.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",t.message,t.stack)}}sendMessage(t,S){const la={["imageToTablePaneWildcard"]:"."};
for(const Ca of Object.keys(S))la[Ca]=S[Ca];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(t,"onCustomMessage",la,Ca=>{Ca&&P.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Ca)})}njc(t){if(t&&this.C$b(t.origin)){var S;({sv:S}=Wd.d(t.data)).returnValue&&S&&(t=Object(D.a)(Object,S),"."===t.imageToTablePaneWildcard&&this.va.raiseEvent("ImageToDocPaneMessageReceived",new sn(t)))}}C$b(t){return t&&t.length&&"null"!==t?t===this.Ha.pptImageToTableAllowedOrigin:
!1}}Object(h.a)(tn,"ImageToTablePaneMessenger",null,[622]);var po=d(1096);class ve{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(h.a)(ve,"ImageTransformInfo",null,[]);class un{constructor(t,S,la,Ca){this.ia=t;this.ob=S;this.ua=la;this.Lc=Ca}initialize(){this.Lc.U9h(Object(n.a)(this,this.F7g,"onSuggestedActionClick"))}dispose(){this.Lc.xZk(Object(n.a)(this,this.F7g,"onSuggestedActionClick"))}F7g(t,S){if((t=S.card)&&this.ua.Ba){var la=this.ua.Ba.gk(),Ca=[];S=
[];for(var Na of la)for(const qb of t.Selects)if(qb.Id===Na.get_shapeId()){Array.add(Ca,Na);Array.add(S,Na.get_shapeId());break}this.ob.ey();this.ob.Rh();this.ob.R_a(Ca,!0);if(4===t.Type){if(Na=this.ua.presentation)Na.Byb=Object.assign(new ve,{Scenario:t.Scenario,SlideSid:this.ua.Ba.sid,SlideCid:this.ua.Ba.cid,ShapeIds:S})}else this.ia.processAction(po.a.nJc(t.ExecutionActionName),2)}}}Object(h.a)(un,"SuggestedActionsHandler",null,[]);class Mo{constructor(){this.K=null;this.xO=!1;this.lF=!!v.AFrameworkApplication.Aa&&
!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.iX}get name(){return"PowerPointWebEditor.Designer"}Zb(t){this.K=t;this.K.register(613,"PowerPointWebEditor.IDesignerView").ma().oa(()=>new rm(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(614,"PowerPointWebEditor.IDesignerPane").ma().oa(()=>new Kg(this.K.resolve("Box4.IAppFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(615,"PowerPointWebEditor.IDesignerViewHelper").ma().oa(()=>new ue(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.Ja("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(616,"PowerPointWebEditor.IDesignerManager").ma().oa(()=>new In(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.Ja("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Ja("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Ja("Common.ISystemInitiatedFeedback")));this.K.register(617,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().oa(()=>new Fl(this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
this.K.register(618,"PowerPointWebEditor.IDesignerContext").ma().oa(()=>new ko(this.K.Ja("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(619,"PowerPointWebEditor.Infrared.IIdeasContext").ma().oa(()=>new tk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(620,"PowerPointWebEditor.IFixItManager").ma().oa(()=>new cl(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));this.K.register(621,
"PowerPointWebEditor.IFixItContext").ma().oa(()=>new Rl);(this.xO=this.K.resolve("PowerPointWebEditor.IApplicationContext").qd.vg)&&this.K.register(En.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new En.a(v.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(dk,"PowerPointWebEditor.Designer.ImageToTableActor").ma().oa(()=>new dk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(622,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().oa(()=>new tn(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(623,"PowerPointWebEditor.Designer.IImageToTablePane").ma().oa(()=>
new Kn(this.K.resolve("Common.IActionManagerExtended"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(un,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().oa(()=>new un(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const t=this.K.resolve("Common.IAppSettingsManager");t.ff(()=>{if(t.ka("248")){this.xO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var S=this.K.resolve("PowerPointWebEditor.IDesignerView");const la=A.a.instance.resolve("PowerPointWebEditor.IDesignerPane").xa;S.hCa(la);S.V8b();this.lF||this.K.resolve("PowerPointWebEditor.IPaneManager").RP(this.K.resolve("PowerPointWebEditor.IDesignerPane"));S=null;if(t.ka("1034")&&(S=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const Ca=
new Date;S.sV(t.Ga("1043"),t.Ga("1035")).then(Na=>{const qb=+new Date-+Ca;Na.IsSuccess?P.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+qb):(P.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Na.ErrorCode+": "+Na.ErrorMessage),P.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+qb))}).catch(Na=>{P.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+Ca));P.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Na)})}S=new Hn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),
this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.Ja("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),S,this.K.Ja("PowerPointWebEditor.IAgendaMetrics"),this.K.Ja("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));S.wb();S.Ee();(new sm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).wb();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else P.a.J(512262858,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){e.a.instance.Dc(jc.a(new Mo,0))}}Object(h.a)(Mo,"PPTWebEditorDesignerPackage",null,[2,3]);class dm{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PenMinutes"}Zb(t){this.K=t}init(){const t=this.K.rb("Common.App.PenMinutesManager.IPenMinutesManager");t&&t.Mdl()}dispose(){}static main(){e.a.instance.Dc(new dm)}}Object(h.a)(dm,"PPTWebEditorPenMinutesPackage",null,[2,3]);var Hl=d(924);class Om{}Object(h.a)(Om,"TextToSmartArtSuggestionData",null,[]);class Bh{constructor(){this.suggestions=[]}}Object(h.a)(Bh,"TextToSmartArtSuggestionNotificationData",null,[]);class Rg{}Rg.GXe="ShapePresence";Rg.slideNavigation=
"SlideNavigation";Rg.ZPb="WebActionId:";Rg.VU="SelectionChanged";Rg.irc="ShapePositionChanged";Rg.ljb="Retrigger";Rg.fGe="NoSuggestions";Rg.r6j="LowSuggestions";Rg.eed="NewSession";Rg.zpl="SlideShowStarted";Rg.serverError="ServerError";Rg.EGf="ClientSuggestionTimeOut";Object(h.a)(Rg,"ReplaceObjectResetReason",null,[]);class lk{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff,Gh,gk,vj,mk,sl){this.eXa=this.wwe=this.tdb=!1;this.pa=t;this.Fa=S;this.ua=la;this.fc=Ca;this.V9=Na;this.Yf=qb;this.ia=Pb;
this.vz=xc;this.$Ha=ed;this.wz=dd;this.VFb=we;this.Gma=Sf;this.Q$c=Ff;this.Lc=Gh;this.hJ=gk;this.zb=vj;this.Rb=mk;this.lu=fd;this.IWa=sl;this.rr=!1}get Bh(){return this.rr}setup(){this.Bh||(this.Wu(),this.wwe=2===this.Rb.mode,this.rr=!0)}Wu(){this.pa.KG(Object(n.a)(this,this.EH,"onSelectionChanged"));this.VFb.UYb(Object(n.a)(this,this.qEe,"markedUndo"));this.Yf.tI(Object(n.a)(this,this.DB,"onActiveSlideChanged"));this.Gma.n6a(Object(n.a)(this,this.X0,"onSlidePresenceChanged"));this.Lc.Mai(Object(n.a)(this,
this.cJe,"onReplaceObjectResponse"));this.$Ha.Nai(Object(n.a)(this,this.dJe,"onReplaceObjectViewDragEnd"));this.V9.VYb(Object(n.a)(this,this.$Ge,"onApplyReplaceObjectBlockingStateChanged"));this.Yf.YPd(Object(n.a)(this,this.Juc,"updateEditState"));this.Rb.RK(Object(n.a)(this,this.Tu,"onAppFrameModeSwitched"));this.Lc.Uuf(Object(n.a)(this,this.F2g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Lc.Tuf(Object(n.a)(this,this.E2g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Lc.dHc(Object(n.a)(this,
this.Qna,"onUndoRedo"))}dispose(){this.Bh&&(this.pa.yKa(Object(n.a)(this,this.EH,"onSelectionChanged")),this.VFb.BRe(Object(n.a)(this,this.qEe,"markedUndo")),this.Yf.X5(Object(n.a)(this,this.DB,"onActiveSlideChanged")),this.Gma.SRe(Object(n.a)(this,this.X0,"onSlidePresenceChanged")),this.Lc.F_k(Object(n.a)(this,this.cJe,"onReplaceObjectResponse")),this.$Ha.G_k(Object(n.a)(this,this.dJe,"onReplaceObjectViewDragEnd")),this.V9.Xld(Object(n.a)(this,this.$Ge,"onApplyReplaceObjectBlockingStateChanged")),
this.Rb.CY(Object(n.a)(this,this.Tu,"onAppFrameModeSwitched")),this.Yf.ERe(Object(n.a)(this,this.Juc,"updateEditState")),this.Lc.jjh(Object(n.a)(this,this.F2g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Lc.ijh(Object(n.a)(this,this.E2g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Lc.bmd(Object(n.a)(this,this.Qna,"onUndoRedo")),this.rr=!1)}z0a(t){return this.$je()?this.Q$c.lvc(t):!1}selectShape(t){t&&this.pa.selectShape(t,!1)}d_c(t){switch(t){case Va.a.TPa:case Va.a.yFe:case Va.a.xjc:case Va.a.yjc:case Va.a.zjc:case Va.a.Ajc:case Va.a.YIa:return!0;
default:return!1}}$je(){return this.tdb&&this.wwe}n$g(t,S){const la=[];if(cb.a.Wa(t))return la;t=t.split(";");if(t.length<S)return P.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",S,t.length),la;for(let Ca=0;Ca<S;++Ca){const Na=t[Ca].split(":");if(3!==Na.length)throw S=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",Ca,t[Ca]),P.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",S),Error.create(S);
const qb=Hl.a.Bnj(Number.parseInvariant(Na[1]));Array.add(la,Object.assign(new Om,{index:Na[0],labelText:cb.a.Wa(qb)?ResourceStrings.L_SmartArt:qb,imageData:this.uTc(Na[2])}))}return la}F2g(){this.eXa=!0}E2g(){this.eXa=!1}Qna(t,S){this.zQ(S.actionId)}uTc(t){return cb.a.Wa(t)?null:"data:image/png;base64,"+t}Tu(t){P.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",t.mode);this.wwe=2===t.mode}Juc(){this.tdb||P.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.tdb=!0}$Gb(t,S,la,Ca){this.IWa.execute(Na=>{const qb=Object.assign(new Bh,{correlationId:t,shapeId:S,suggestions:la});Na.notifyTextToSmartArtSuggestion(Ca,qb)})}Zag(t,S,la){if(S.gE)if(S.w9&&0!==t.zKa)P.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",t.zKa);else{if(0===t.zKa){if(0>=t.Yda){P.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",t.correlationId);this.closeSession(S,Rg.fGe);
return}if(t.Yda<la.replaceObjectMinRequiredSuggestions){P.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",t.correlationId);this.closeSession(S,Rg.r6j);return}S.w9=!1;S.suggestions=this.n$g(t.lDa,t.Yda);S.gV=t.Yda;P.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",S.gV,t.correlationId)}else if(1===t.zKa){if(cb.a.Wa(t.lDa)){P.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",
t.correlationId);return}S.suggestions=this.n$g(t.lDa,t.Yda);S.tOb=new Date;la.powerPointIdeasIsEnabled&&this.$Gb(t.correlationId,S.shapeId,S.suggestions,uj.a.success)}else 2===t.zKa&&(S.qne=!1,S.shapeId=t.shapeId,this.$Gb(S.correlationId,t.shapeId,S.suggestions,uj.a.success));la=S.shape;S.slide&&S.slide.isConnected&&la&&la.isConnected&&this.lu.sbb(la)&&this.$je()&&(1===t.zKa?this.wz.mhh(S.correlationId):this.wz.vrd(la))}else P.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",
t.correlationId)}}Object(h.a)(lk,"BaseReplaceObjectManager",null,[628,654]);class pc{}pc.none="";pc.irc="ShapePositionChanged";Object(h.a)(pc,"ReplaceObjectRetriggerReason",null,[]);class hj{}hj.selectShape="SelectShape";hj.ljb="Retrigger";hj.Xhi="AugLoopRetrigger";hj.Whi="AugLoopDefault";Object(h.a)(hj,"ReplaceObjectTrigger",null,[]);var No=d(511);class Sl extends lk{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff,Gh,gk,vj,mk,sl,On,Pn,bi,Qn){super(xc,la,Ca,Na,qb,Pb,ed,dd,fd,we,Sf,Gh,gk,vj,mk,
On,Pn,bi,Qn);this.TT=t;this.u3c=S;this.zgk=Ff;this.la=sl;this.hSg=this.la.replaceObjectGrayFloatieInTyping}Wu(){this.la.replaceObjectUseClientAL?this.u3c.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(n.a)(this,this.udh,"processShapeTextConvertibleClientAL"))}):this.TT.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(n.a)(this,this.tNe,"processShapeTextConvertible"))});this.Lc.fci(Object(n.a)(this,this.Mgd,"onSlideShowStarted"));super.Wu()}dispose(){this.Bh&&(this.la.replaceObjectUseClientAL?
this.u3c.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(n.a)(this,this.udh,"processShapeTextConvertibleClientAL"))}):this.TT.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(n.a)(this,this.tNe,"processShapeTextConvertible"))}),this.Lc.w0k(Object(n.a)(this,this.Mgd,"onSlideShowStarted")));super.dispose()}tNe(t,S){if(t&&S){try{var la=Wd.a(t);var Ca=Wd.a(S)}catch(qb){P.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");
return}if(la&&!isNaN(la.sid)&&!isNaN(la.cid)&&!isNaN(la.shapeId)&&this.ua.Ba&&(t=new Date(la.c),P.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",la.sid,la.cid,la.shapeId,la.t,la.c?(new Date).getTime()-la.c:-1),(S=this.ua.Ba.lT(la.shapeId))&&(of.a.contains(this.Y6f(),S.get_shapeId())||"activeSlideChanged"===la.t)))if(Ca&&!Ca.isTextConvertible)this.wz.ooa(S,!0);else{var Na=this.vz.s6b(S.get_shapeId());if(Na&&Na.Zca&&(Na=new No.a(S,Na.Hga),this.ia.La(Va.a.iib,
2,Na),!Na.oua))return;this.z0a(S)&&this.$ja(this.ua.Ba,S,Ca&&Ca.smartArtInfo?Ca.smartArtInfo.length:0,la.t||hj.Whi,pc.none,t)}}}udh(t,S,la,Ca){S&&Ca&&Ca.ContextId&&Ca.Payload&&this.tNe(Ca.ContextId,Ca.Payload)}Mgd(){this.gWd(Rg.zpl)}EH(t,S){if(!this.Bh)P.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.eXa&&(S.EE.length||!this.Fa.Ae||this.Fa.Ae.name!==ad.a.sg)){t=this.Y6f();for(let la of this.vz)la.gE&&!Array.contains(t,la.shapeId)&&
this.closeSession(la,Rg.VU);this.hSg&&!Array.contains(t,this.wz.Vxb)&&this.wz.qYk()}}dJe(t,S){this.Bh?(t=this.vz.s6b(S.shape.get_shapeId()))&&t.gE&&(S=t.shape,this.closeSession(t,Rg.irc),this.z0a(S)&&this.$ja(this.ua.Ba,S,0,hj.Xhi,pc.irc)):P.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}qEe(t,S){S.Nzb&&this.zQ(S.actionId)}DB(){this.gWd(Rg.slideNavigation)}X0(t,S){if(S.f9&&S.shapes)for(const la of S.shapes)(t=this.vz.s6b(la))&&t.gE&&this.closeSession(t,
Rg.GXe)}cJe(t,S){(t=this.vz.f$a(S.correlationId))?this.Zag(S,t,this.la):P.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",S.correlationId)}$Ge(){if(this.Bh)for(let t of this.vz)t.Cab&&0===t.K1&&!this.fc.$c(this.ua.presentation)&&(t.Cab=!1,this.wz.ooa(t.shape,!0))}z0a(t){const S=this.vz.usf;return 1<=S?(P.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
S),!1):super.z0a(t)}$ja(t,S,la,Ca,Na,qb=null){try{let Pb=this.vz.s6b(S.get_shapeId());Pb&&this.closeSession(Pb,Rg.eed);Pb=this.vz.lMc(t,S.get_shapeId(),Ca,Na,this.la);Pb.Ltc=qb;Pb.Zca="richEditTextUnicodeChanged"===Ca;this.wz.Huc(Pb.correlationId);const xc=this.zgk.Kph(Pb);P.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Pb.correlationId,Pb.slide.sid,Pb.slide.cid,Pb.shapeId,xc);P.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Pb.correlationId,la,Math.min(la,this.la.replaceObjectSuggestionMaxCount),Ca);la&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(la=Math.min(la,this.la.replaceObjectSuggestionMaxCount),Pb.suggestions=this.X2i(la),Pb.gV=la,Pb.w9=!1,this.wz.vrd(S));0===xc&&this.la.powerPointIdeasIsEnabled&&this.$Gb(Pb.correlationId,Pb.shapeId,[],uj.a.pending)}catch(Pb){P.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Pb.message)}}X2i(t){const S=Array(t);for(let la=0;la<t;la++)Array.add(S,Object.assign(new Om,
{index:la.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return S}zQ(t){this.Bh?this.d_c(t)||this.gWd(Rg.ZPb+this.hJ.Z5(t)):P.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}qjl(t){if(!this.hSg)return!1;const S=this.pa.Xd();return t.Zca&&Array.contains(S,t.shape)}closeSession(t,S){0===t.K1&&(S===Rg.fGe?this.wz.ooa(t.shape,!0):t.Zca&&this.wz.ooa(t.shape,!0,S!==Rg.eed,this.qjl(t)),this.vz.xYc(t,S),this.la.powerPointIdeasIsEnabled&&this.$Gb(t.correlationId,
t.shapeId,t.suggestions,uj.a.cJa))}gWd(t){for(let S of this.vz)this.closeSession(S,t)}Y6f(){const t=this.pa.Xd(),S=[];t&&t.forEach(la=>{Array.add(S,la.get_shapeId())});return S}}Object(h.a)(Sl,"AugmentationLoopReplaceObjectManager",lk,[]);class dl{constructor(t,S){this.disabled=!1;this.AGg=Pd.App.Ym;this.la=t;this.zb=S}Pqh(t){this.disabled=!0;this.AGg=new Date;const S=new V.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.AGg>=this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&
t()});this.zb.Db(S)}hcl(t){const S=new V.a(2,1,550,()=>{t()});this.zb.Db(S)}static CIl(t,S){return 7<=t&&8>=t&&1!==S}}Object(h.a)(dl,"FlyoutAnchorTimer",null,[]);var Ze=d(369);class qo{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff,Gh){this.Gs=null;this.eXa=!1;this.Lc=S;this.pa=t;this.vz=la;this.ua=Ca;this.Ea=Na;this.la=qb;this.wz=Pb;this.wi=xc;this.lu=ed;this.Gma=dd;this.V9=fd;this.AWa=we;this.Aic=Sf;this.hJ=Ff;this.mc=Gh}Wu(){this.Lc.sai(Object(n.a)(this,this.L4g,"onIconSuggestionNotification"));
this.pa.KG(Object(n.a)(this,this.EH,"onSelectionChanged"));this.Lc.Uuf(Object(n.a)(this,this.D2g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.Tuf(Object(n.a)(this,this.C2g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.rai(Object(n.a)(this,this.K4g,"onIconChanged"));this.Gma.n6a(Object(n.a)(this,this.X0,"onSlidePresenceChanged"));this.V9.VYb(Object(n.a)(this,this.wfa,"onBlockingStateChanged"));this.Aic.UYb(Object(n.a)(this,this.$gb,"onMarkedUndo"))}C4e(){this.Lc.r_k(Object(n.a)(this,
this.L4g,"onIconSuggestionNotification"));this.pa.yKa(Object(n.a)(this,this.EH,"onSelectionChanged"));this.Lc.jjh(Object(n.a)(this,this.D2g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.ijh(Object(n.a)(this,this.C2g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.q_k(Object(n.a)(this,this.K4g,"onIconChanged"));this.Gma.SRe(Object(n.a)(this,this.X0,"onSlidePresenceChanged"));this.V9.Xld(Object(n.a)(this,this.wfa,"onBlockingStateChanged"));this.Aic.BRe(Object(n.a)(this,
this.$gb,"onMarkedUndo"))}dispose(){this.C4e()}setup(){this.Wu()}D2g(){this.eXa=!0}C2g(){this.eXa=!1}K4g(t,S){S&&this.Gs&&this.Gs.Xpc&&this.Gs.slide.sid===S.slideId.sid&&this.Gs.slide.cid===S.slideId.cid&&this.Gs.shapeId===S.shapeId&&this.Gs.p6===S.WY&&(this.Gs.GUe=S.LEa)}X0(t,S){if(S.f9&&S.shapes&&this.Gs)for(const la of S.shapes)this.Gs.shapeId===la&&this.uW(Rg.GXe)}$gb(t,S){S.Nzb&&!this.d_c(S.actionId)&&this.uW(Rg.ZPb+this.hJ.Z5(S.actionId))}d_c(t){switch(t){case Va.a.TPa:case Va.a.yFe:case Va.a.xjc:case Va.a.yjc:case Va.a.zjc:case Va.a.Ajc:case Va.a.YIa:return!0;
default:return!1}}wfa(){if(this.Gs){const t=this.Gs.shape,S=this.Ea.yr(t);t&&S&&!this.AWa.$c(S)&&(this.Gs.Cab=!1,this.wz.ooa(t,!0),this.Gs.Jtc=new Date,this.Gs.uW(Rg.VU))}}EH(){if(!this.eXa){var t=this.Ea.K9a(this.pa.Xd());if(t){if(this.Gs&&this.Gs.gE){if(Ze.a.hrc(t.QY,this.Gs.QY))return;this.uW(Rg.VU)}this.z0a(t)&&this.$ja(this.ua.Ba,t,hj.selectShape)}else this.Gs&&this.Gs.gE&&this.uW(Rg.VU)}}$ja(t,S,la){this.Gs=this.vz.XQa(t,S.get_shapeId(),la,"",this.la,S.get_smartArtModelId());this.Gs.w9=!0;this.wz.Huc(this.Gs.correlationId);
P.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Gs.correlationId,this.Gs.slide.sid,this.Gs.slide.cid,this.Gs.shapeId,this.Gs.p6);const Ca=S.get_smartArtModelId()?this.Ea.yr(S):S;Ca?this.wi.U2i(t.cid,t.sid,Ca.get_shapeId(),this.lu.KUc(Ca),this.lu.JUc(Ca),S.get_smartArtModelId(),this.Gs.correlationId,la,Object(n.a)(this,this.Dvk,"onIconSuggestionResponseSuccess"),Object(n.a)(this,this.jhb,"onTaskFailure")):
P.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",S.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}Dvk(t){if(t&&t.SuggestionResult){var S=t.CorrelationId,la=this.vz.f$a(S);if(la)if(la.gE){S=null;try{S=Sys.Serialization.JavaScriptSerializer.deserialize(t.SuggestionResult)}catch(Ca){P.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Ca)}if(S){la.suggestions=this.jEk(S);la.tOb=new Date;if(la.w9){if(this.Rhg(la)){P.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",la.r0b,this.la.pptIconChunkingSuggestionTimeoutMs);this.uW(Rg.EGf);return}P.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");la.gV=la.suggestions?la.suggestions.length:0;la.w9=!1;this.wz.vrd(la.shape)}this.wz.mhh(la.correlationId)}else this.uW(Rg.serverError),P.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else P.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Gs?this.Gs.correlationId:"",S);else P.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",S)}else this.uW(Rg.serverError),P.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}jhb(t){this.uW(Rg.serverError);
P.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}z0a(t){return this.mc.In?t.get_smartArtModelId()&&t.get_isSVGBlipFilled()?(t=this.Ea.yr(t),!!t&&!t.As):!1:!1}uW(t){this.Gs&&(this.wz.ooa(this.Gs.shape,!0),this.vz.xYc(this.Gs,t),this.Gs=null)}uTc(t){return cb.a.Wa(t)?null:t.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(t):"data:image/png;base64,"+t}jEk(t){const S=[];if(!t||
!t.length)return S;for(let la=0;la<t.length;++la){const Ca=Object.assign(new Om,{index:t[la].Index.toString(),labelText:t[la].Label,imageData:this.uTc(t[la].Render),renderData:this.uTc(t[la].Replace)});Array.add(S,Ca)}return S}iFi(t,S){const la=[];if(cb.a.Wa(t)||!S)return la;for(var Ca=0;Ca<S;++Ca){var Na=Object.assign(new Om,{index:Ca.toString(),labelText:"",imageData:null,renderData:null});Array.add(la,Na)}t=t.split(";");if(t.length-1!==S)return P.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
la.length,S),la;for(Ca=0;Ca<S;++Ca)Na=t[Ca].indexOf(":"),0>Na?P.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):la[Ca].labelText=t[Ca].substr(Na+1);return la}iEk(t){let S,la,Ca,Na;S="";Ca=la=0;Na=null;if(cb.a.Wa(t))return P.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:S,Yda:la,pGe:Ca,suggestions:Na};const qb=t.split("|");if(4!==qb.length)return P.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+t.length),{returnValue:!1,correlationId:S,Yda:la,pGe:Ca,suggestions:Na};S=qb[0];la=parseInt(qb[1]);Ca=Number.parseInvariant(qb[2]);Na=this.iFi(qb[3],la);return{returnValue:!0,correlationId:S,Yda:la,pGe:Ca,suggestions:Na}}L4g(t,S){let la,Ca;if(({correlationId:t,Yda:S,pGe:la,suggestions:Ca}=this.iEk(S.lDa)).returnValue){var Na=this.vz.f$a(t);if(Na)if(Na.gE&&Na.w9){var qb=Na.shape;0===la&&(0>=
S?(P.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",t),this.uW(Rg.fGe)):this.Rhg(Na)?(P.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Na.r0b,this.la.pptIconChunkingSuggestionTimeoutMs),this.uW(Rg.EGf)):(Na.w9=!1,Na.gV=S,Na.suggestions=Ca,P.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Na.correlationId,Na.gV),this.wz.vrd(qb)))}else P.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Gs?this.Gs.correlationId:"",t,Na.gE,Na.w9);else P.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",t)}else P.a.J(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}Rhg(t){const S=
new Date,la=t.Hga,Ca=this.la.pptIconChunkingSuggestionTimeoutMs;return S&&la&&0<Ca&&+S-+la>Ca?(t.r0b=+S-+la,!0):!1}}Object(h.a)(qo,"ReplaceIconManager",null,[]);var Oo=d(705),Ln=d(1003);class Po extends Sys.EventArgs{constructor(t){super();this.QY=t}}Object(h.a)(Po,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class Mn{constructor(){this.shape=null;this.action=0}}Object(h.a)(Mn,"ShowHideReplaceObjectGalleryData",null,[]);class fn{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf){this.rr=
this.tdb=!1;this.ia=S;this.Fa=la;this.ua=Na;this.Yf=Ca;this.fc=qb;this.aIa=Pb;this.wz=fd;this.Fb=we;this.Ea=Sf;this.pa=t;this.Lc=xc;this.vz=ed;this.Jb=dd}get Bh(){return this.rr}setup(){this.Bh||(this.Wu(),this.wb(),this.Ee(),this.rr=!0)}dispose(){this.Bh&&(this.C4e(),this.rr=!1)}Wu(){this.Yf.YPd(Object(n.a)(this,this.Juc,"updateEditState"))}C4e(){this.Yf.ERe(Object(n.a)(this,this.Juc,"updateEditState"))}wb(){this.ia.ra(Va.a.TPa,$a.a.application,Object(n.a)(this,this.TPa,"applyReplaceObjectSuggestion"),
4);this.ia.ra(Va.a.C0a,$a.a.application,Object(n.a)(this,this.C0a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(Va.a.ZMb,$a.a.application,Object(n.a)(this,this.C0a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(Va.a.Jjc,$a.a.application,Object(n.a)(this,this.j0g,"navigateReplaceObjectSuggestion"),4);this.ia.ra(Va.a.Ijc,$a.a.application,Object(n.a)(this,this.j0g,"navigateReplaceObjectSuggestion"),4)}Ee(){const t=this.Fa.Fc(ad.a.kQ),S=this.Fa.Fc(ad.a.sg),la=this.Fa.Fc(ad.a.Xib);
t.bindAction(oc.KeyInputManager.Oa(ua.a.tq,2),Va.a.ZMb);S.bindAction(oc.KeyInputManager.Oa(ua.a.tq,2),Va.a.ZMb);la.bindAction(oc.KeyInputManager.Oa(ua.a.tq,2),Va.a.ZMb);la.bindAction(oc.KeyInputManager.Oa(ua.a.X1,0),Va.a.ZMb);la.bindAction(oc.KeyInputManager.Oa(ua.a.dba,0),Va.a.Jjc);la.bindAction(oc.KeyInputManager.Oa(ua.a.Rga,0),Va.a.Ijc)}Juc(){this.tdb||P.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.tdb=!0}TPa(t,S,la,Ca,Na){if(!this.Bh)return P.a.J(33698392,
829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;S=this.ua.presentation;if(!this.ua.Ba||!S||this.fc.$c(S))return 16;if(1===la)return 32;la=!0;Ca=null;Object(Pk.a)(Oo.a,Na)?Ca=Na:Object(Pk.a)(Ln.a,Na)&&(Ca=Na.XHc,la=!1);Na=new Ze.a(Q.a.VE(Ca.ActiveSlideSid,Ca.ActiveSlideCid),Ca.ShapeId,Ca.SmartArtSubNodeId);const qb=new Po(Na);this.aIa.TPk(qb);const Pb=this.vz.g$a(Na);if(Pb&&Pb.shapeId===Ca.ShapeId){let xc=null;1===Pb.K1&&(xc=this.Ea.yr(Pb.shape));Na=this.Jb.Ad(15,
void 0,()=>{1===Pb.K1||this.pa.Bs()||(this.Lc.Gkd(),this.pa.Rh(),this.Lc.Fkd())},()=>{xc&&(this.Lc.Gkd(),this.pa.selectShape(xc,!0),this.Lc.Fkd())});try{Na.nc(S),Na.jd=Ca.SmartArtSubNodeId?Va.a.QEf:t,S.EKb=Ca,Pb.UHc=Ca.SuggestionSid,Pb.qRd=Ca.Label,Pb.IT=!0,Pb.Ktc=new Date,P.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ca.CorrelationId,t,Ca.SuggestionSid)}finally{Na&&Na.dispose()}Pb.qne=!0;Pb.Cab=!0;la&&Pb.pEe();0===
Pb.K1?this.fc.hw(S,t):xc?this.fc.Qra(S,xc,this.Fb.Ma,t):P.a.J(38854750,808,15,"Invalid smartArtShape")}else P.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}C0a(t,S,la,Ca,Na){if(!this.Bh)return P.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;S=this.ua.presentation;if(!this.ua.Ba||!S||this.fc.$c(S))return 16;if(1===la)return 32;la=null;S=0;if(t===Va.a.C0a){t=Object(D.a)(Mn,Na);if(!t)return 16;la=t.shape;S=t.action}else if(t===
Va.a.ZMb){t=this.pa.Xd();if(1!==t.length)return 32;la=t[0]}if(!la)return P.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;t=this.vz.g$a(la.QY);if(!t||!this.tdb&&t&&0===t.K1)return 2;if(t&&t.gE&&t.shapeId===la.get_shapeId())switch(this.pa.jj(),this.Fa.Ed(),S){case 0:this.wz.Oxl(t.correlationId);break;case 1:this.wz.yB.isVisible||this.wz.MZe(t.correlationId);break;case 2:this.wz.lde(la)}return 32}j0g(t,S,la){if(!this.Bh)return P.a.J(33698396,829,15,
"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;S=this.ua.presentation;return this.ua.Ba&&S&&!this.fc.$c(S)?1===la?32:this.wz.yB.isVisible?t===Va.a.Jjc?(this.wz.Jjc(),32):t===Va.a.Ijc?(this.wz.Ijc(),32):16:16:16}}Object(h.a)(fn,"ReplaceObjectActor",null,[]);class qj{constructor(t,S){this.u$=t;this.v3c=S}initialize(){this.u$.execute(t=>{t.registerSimpleRemoteWorkflow(this.v3c.sG,this.v3c.ssb,this.v3c.mKb,this.v3c.Erb)})}}Object(h.a)(qj,"ReplaceObjectAugLoopRuntimeManager",
null,[]);var ro=d(1100),Pm;(function(t){t[t.textToSmartArt=0]="textToSmartArt";t[t.iconChunking=1]="iconChunking"})(Pm||(Pm={}));Object(h.b)("ReplaceObjectType",Pm);class gn{constructor(t,S){this.e5a=this.yS=this.la=null;this.shapeId=0;this.p6=null;this.K1=0;this.Zca=!1;this.UHc=0;this.qRd=null;this.zke=this.oke=this.Cab=this.IT=!1;this.Jtc=this.Ktc=this.x2e=this.tOb=this.Otc=this.YLa=this.Ltc=this.Hga=null;this.Wvb=this.Fsc=0;this.dKd=this.G5a=this.Upa=null;this.w9=!1;this.suggestions=null;this.r0b=
this.gV=0;this.qne=!1;this.yjb=null;this.Xpc=!1;this.GUe=null;this.SEd=!1;this.KEb=[];this.wi=t;this.fdc=S;this.reset()}XQa(t,S,la,Ca,Na,qb){this.gE&&this.uW(Rg.eed);if(!t)throw Error.argumentNull("slide");const Pb=t.Hxb(new Ze.a(t?t.Cb:null,S,qb));if(!Pb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",S));this.yS=t;this.e5a=Pb;this.shapeId=S;this.p6=qb;this.Upa=Kc.a.create().toString();this.SEd=!0;this.G5a=la;this.dKd=Ca;this.la=Na;this.Hga=new Date;
this.K1=this.Amj();return this.correlationId}lMc(t,S,la,Ca,Na){return this.XQa(t,S,la,Ca,Na,null)}Amj(){const t=this.shape;return this.la.iconChunkingEnabled&&t&&this.p6&&t.get_isSVGBlipFilled()?1:0}uW(t){if(this.gE&&!this.TTj(this.correlationId)){const S={};S.SuggestionCount=this.gV;S.ClientSuggestionTimeoutInMs=this.r0b;S.IsApplied=this.IT;S.AppliedSuggestionId=this.IT?this.UHc.toString():"";S.AppliedSuggestionLabel=this.IT?this.qRd:"";S.IsFloatieShown=this.oke;S.IsGalleryShown=this.zke;S.Trigger=
this.trigger;S.RetriggerReason=this.pTe;S.ResetReason=t;S.IconId=this.la.replaceObjectIconType;S.SlideCID=this.slide.cid;S.SlideSID=this.slide.sid;S.ShapeID=this.shapeId;S.AnimId=this.la.replaceObjectAnimId;S.AnimEnabled=this.la.DKb;S.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;S.ReplaceSuggestionType=Pm[this.K1];S.SeeMoreButtonClicked=this.Xpc;S.SeeMoreIconName=this.Xpc?this.GUe:"";this.Hga&&(S.SessionLiveTimeInMs=+new Date-+this.Hga);this.p6&&(S.SmartArtSubNodeId=this.p6);this.YLa&&
this.tOb&&this.tOb>this.YLa&&(S.SuggestionsReadyInMs=+this.tOb-+this.YLa);0<this.Fsc&&(S.SuggestionsDisplayedForMs=this.Fsc);0<this.Wvb&&(S.FloatieDisplayedForMs=this.Wvb);this.YLa&&this.Hga&&this.YLa>this.Hga&&(S.FloatieReadyInMs=+this.YLa-+this.Hga);this.Hga&&this.Ltc&&this.Hga>this.Ltc&&(S.TriggeredByAugLoopInMs=+this.Hga-+this.Ltc);this.Ktc&&this.Jtc&&this.Jtc>this.Ktc&&(S.SuggestionAppliedInMs=+this.Jtc-+this.Ktc);if(0<this.suggestions.length){t=[];for(let la=0;la<this.suggestions.length;la++)Array.add(t,
this.suggestions[la].labelText);S.SuggestionLabels=Ie.c(t)}1!==this.K1||cb.a.Wa(this.yjb)||(t=ro.a.j$a(this.yjb))&&t.hasChildNodes()&&(ro.a.E3b(),ro.a.xXk(this.yjb));this.wi.r2k(this.correlationId,Ie.c(S),void 0,Object(n.a)(this,this.qkc,"onFailureCallback"));this.ylk(this.correlationId)}this.reset()}reset(){this.SEd=!1;this.yS=null;this.qne=this.zke=this.oke=this.Cab=this.IT=this.Zca=!1;this.dKd=this.G5a=this.Upa="";this.suggestions=[];this.UHc=0;this.qRd="";this.w9=!1;this.r0b=this.gV=0;this.Jtc=
this.Ktc=this.x2e=this.tOb=this.Otc=this.YLa=this.Ltc=this.Hga=null;this.K1=this.Wvb=this.Fsc=0;this.yjb="";this.e5a=null;this.Xpc=!1;this.GUe=""}TTj(t){return this.KEb?Array.contains(this.KEb,t):!1}ylk(t){this.KEb&&!Array.contains(this.KEb,t)&&(Array.add(this.KEb,t),P.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",t,this.KEb.length))}qkc(t){P.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",
t.HttpStatusCode);return!0}pEe(){this.IYg(2,4)}Dlk(){this.IYg(3,3)}IYg(t,S){this.fdc&&this.fdc.execute(la=>{const Ca=Object.assign(new Jo.a,{cardId:gp.a.cyh,actionType:t,actionEngagement:S});la.yed(Ca)})}get slide(){return this.yS}get shape(){return this.e5a}get correlationId(){return this.Upa}get trigger(){return this.G5a}get pTe(){return this.dKd}get gE(){return this.SEd}get appSettings(){return this.la}get QY(){return new Ze.a(this.slide?this.slide.Cb:null,this.shapeId,this.p6)}}Object(h.a)(gn,
"ReplaceObjectContext",null,[766]);class Sk{constructor(){this.va=new bm.a}TPk(t){this.va.raiseEvent("ReplaceObjectBSA",t)}T$h(t){this.va.addHandler("ReplaceObjectBSA",t)}b_k(t){this.va.removeHandler("ReplaceObjectBSA",t)}rfh(t){this.va.raiseEvent("ReplaceObjectSPOver",t)}Dbi(t){this.va.addHandler("ReplaceObjectSPOver",t)}d0k(t){this.va.removeHandler("ReplaceObjectSPOver",t)}qfh(t){this.va.raiseEvent("ReplaceObjectSPOut",t)}Cbi(t){this.va.addHandler("ReplaceObjectSPOut",t)}c0k(t){this.va.removeHandler("ReplaceObjectSPOut",
t)}XPk(t){this.va.raiseEvent("ReplaceObjectViewDE",t)}Nai(t){this.va.addHandler("ReplaceObjectViewDE",t)}G_k(t){this.va.removeHandler("ReplaceObjectViewDE",t)}}Object(h.a)(Sk,"ReplaceObjectEventSource",null,[763,764,765]);class Qo extends lk{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff,Gh,gk,vj,mk,sl,On,Pn){super(qb,t,S,la,Ca,Na,Pb,xc,ed,dd,fd,Sf,Ff,Gh,gk,mk,sl,On,Pn);this.ni=xc.B2f();this.wi=we;this.la=vj}EH(t,S){if(!this.Bh)P.a.J(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.eXa&&S.EE.length)if(t=this.pa.Xd(),1!==t.length)this.ni.gE&&this.closeSession(this.ni,Rg.VU);else{t=t[0];if(this.ni.gE){if(this.ni.shapeId===t.get_shapeId())return;this.closeSession(this.ni,Rg.VU)}this.z0a(t)&&this.$ja(this.ua.Ba,t,hj.selectShape,"")}}dJe(t,S){this.Bh?this.ni.gE&&this.ni.shape===S.shape&&(t=this.ni.shape,this.closeSession(this.ni,Rg.irc),this.z0a(t)&&this.$ja(this.ua.Ba,t,hj.ljb,pc.irc)):P.a.J(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}qEe(t,
S){S.Nzb&&this.zQ(S.actionId)}DB(){this.ni.gE&&this.closeSession(this.ni,Rg.slideNavigation)}X0(t,S){this.ni.gE&&S.f9&&S.shapes&&Array.contains(S.shapes,this.ni.shapeId)&&this.closeSession(this.ni,Rg.GXe)}cJe(t,S){S.correlationId!==this.ni.correlationId?P.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.ni.correlationId,S.correlationId):this.Zag(S,this.ni,this.la)}$Ge(){this.Bh&&this.ni.Cab&&0===this.ni.K1&&!this.fc.$c(this.ua.presentation)&&
(this.ni.Cab=!1,this.wz.ooa(this.ni.shape,!0))}$ja(t,S,la,Ca=""){try{const Na=this.ni.lMc(t,S.get_shapeId(),la,Ca,this.la);this.ni.w9=!0;this.wz.Huc(this.ni.correlationId);this.wi.MZf(t.cid,t.sid,S.get_shapeId(),Na,la,this.lu.KUc(S),this.lu.JUc(S),void 0,Object(n.a)(this,this.jhb,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.$Gb(Na,this.ni.shapeId,this.ni.suggestions,uj.a.pending)}catch(Na){P.a.J(34152532,829,15,"GenerateSuggestion failed!! {0} ",Na.message)}}jhb(t){P.a.J(36966422,829,
15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}zQ(t){this.Bh?this.ni.gE&&!this.d_c(t)&&this.closeSession(this.ni,Rg.ZPb+this.hJ.Z5(t)):P.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(t,S){t.Zca&&this.wz.ooa(t.shape,!0);t.uW(S);this.la.powerPointIdeasIsEnabled&&this.$Gb(t.correlationId,t.shapeId,t.suggestions,uj.a.cJa)}}Object(h.a)(Qo,"ReplaceObjectManager",lk,[]);var Jp=
d(22);class z{constructor(t){this.uO=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.kqe=Array.clone(t)}get_current(){if(-1===this.uO||this.uO>=this.kqe.length)throw Error.invalidOperation();return this.kqe[this.uO]}moveNext(){this.uO++;return this.uO<this.kqe.length}reset(){this.uO=-1}}Object(h.a)(z,"ArrayEnumerator",null,[144]);class Y{constructor(t){this.ZHa=[];this.$$ge=this.getEnumerator;this.wgk=t}getEnumerator(){return new z(this.ZHa)}[Symbol.iterator](){return Object(Jp.a)(this.getEnumerator())}xYc(t,
S){t&&(t.uW(S),Array.remove(this.ZHa,t))}f$a(t){for(const S of this.ZHa)if(S.correlationId===t)return S;return null}g$a(t){for(const S of this.ZHa)if(Ze.a.hrc(t,S.QY))return S;return null}x6f(t,S){for(const la of this.ZHa)if(la.shapeId===t&&(!S&&!la.p6||S&&S===la.p6))return la;return null}s6b(t){return this.x6f(t,null)}B2f(){return 0<this.ZHa.length?this.ZHa[0]:null}XQa(t,S,la,Ca,Na,qb){let Pb=this.g$a(new Ze.a(t.Cb,S,qb));Pb&&this.xYc(Pb,Rg.eed);Pb=this.wgk(t,S,la,Ca,Na,qb);Array.add(this.ZHa,Pb);
return Pb}lMc(t,S,la,Ca,Na){return this.XQa(t,S,la,Ca,Na,null)}get usf(){let t=0;this.ZHa.forEach(S=>{S.gE&&t++});return t}}Object(h.a)(Y,"ReplaceObjectMultipleContextManager",null,[627,142]);class m{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd){this.ua=t;this.pSg=S;this.Agk=la;this.lu=qb;this.$Ha=Na;this.vz=Ca;this.yB=Pb;this.Fa=xc;this.Te=ed;this.Ea=dd;this.rr=!1;this.pzc=-1}get Bh(){return this.rr}get Vxb(){return this.pzc}setup(){this.Bh||(this.$Ha.T$h(Object(n.a)(this,this.R2g,"onBeforeReplaceObjectSuggestionApply")),
this.$Ha.Dbi(Object(n.a)(this,this.u6g,"onReplaceObjectSuggestionPointerOver")),this.$Ha.Cbi(Object(n.a)(this,this.t6g,"onReplaceObjectSuggestionPointerOut")),this.rr=!0)}dispose(){this.Bh&&(this.$Ha.b_k(Object(n.a)(this,this.R2g,"onBeforeReplaceObjectSuggestionApply")),this.$Ha.d0k(Object(n.a)(this,this.u6g,"onReplaceObjectSuggestionPointerOver")),this.$Ha.c0k(Object(n.a)(this,this.t6g,"onReplaceObjectSuggestionPointerOut")),this.rr=!1)}R2g(t,S){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");
(t=this.ua.Ba.Hxb(S.QY))&&this.ooa(t,!1)}u6g(t,S){this.ua.Ba&&(t=new Ze.a(this.ua.Ba.Cb,S.shapeId,S.WY),(t=this.ua.Ba.Hxb(t))&&this.LZe(t,S.jeg))}t6g(t,S){this.ua.Ba&&(t=new Ze.a(this.ua.Ba.Cb,S.shapeId,S.WY),(t=this.ua.Ba.Hxb(t))&&this.p8b(t))}LZe(t,S){let la=t;t.get_smartArtModelId()&&(la=this.Ea.yr(t));if(t=this.k8f(la))this.Iwh(la,!1),t.LZe(S)}p8b(t){let S=t;t.get_smartArtModelId()&&(S=this.Ea.yr(t));if(t=this.k8f(S))this.Iwh(S,!0),t.p8b()}k8f(t){return t&&!t.get_smartArtModelId()&&Object(D.a)(117,
t.sc(this.Te))?this.Agk.ZG(t):null}MTi(t){return t&&Object(D.a)(117,t.sc(this.Te))?this.pSg.ZG(t):null}e$d(t){return t&&Object(D.a)(117,t.sc(this.Te))?this.pSg.IF(t):null}vrd(t){if(!this.Bh)P.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(t){var S=this.MTi(t);if(S){const la=this.vz.g$a(t.QY);!la||la.Zca&&this.Vxb!==la.shapeId||(la.Zca?this.Vxb===la.shapeId&&(S.QOc(),this.pzc=-1):(this.ooa(t,!0,!(this.yB.n_a&&this.yB.isVisible&&Ze.a.hrc(t.QY,
this.yB.n_a.QY))),S.display()),la.Zca=!0)}}}qYk(){if(-1!==this.Vxb&&this.ua.Ba){var t=this.ua.Ba.lT(this.Vxb);t&&this.ooa(t,!0)}}ooa(t,S,la=!0,Ca=!1){this.Bh?t&&(S&&this.p8b(t),la&&this.lde(t),S=this.e$d(t))&&(Ca?(S.NNc(),this.pzc=t.get_shapeId()):(this.Vxb===t.get_shapeId()&&(this.pzc=-1),S.visible&&S.dismiss(),(Ca=this.vz.g$a(t.QY))&&t.get_shapeId()===Ca.shapeId&&(Ca.Zca=!1))):P.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}Huc(t){this.yB.Huc(t)}Oxl(t){if(this.Bh)if(this.yB.isVisible){const S=
this.vz.f$a(t);S&&S.gE&&S.correlationId===t&&this.p8b(S.shape);this.lde(S.shape)}else this.MZe(t);else P.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}lde(t){this.yB.isVisible&&this.yB.n_a&&Ze.a.hrc(this.yB.n_a.QY,t.QY)&&(this.yB.dismiss(),(t=this.e$d(this.yB.n_a.shape))&&t.root&&(t.root.style.zIndex="0"),this.Fa.Ej(ad.a.Xib,!1))}MZe(t){const S=this.vz.f$a(t);if(S&&S.correlationId===t&&S.gE){var la=this.e$d(S.shape);if(la){var Ca=la.root;Ca?this.yB.isVisible&&
this.yB.n_a&&!Ze.a.hrc(this.yB.n_a.QY,S.QY)||(Ca=this.lu.getBounds(Ca),this.yB.show(t,Ca.x,Ca.y),la.root.style.zIndex=String(v.AFrameworkApplication.Aa.erb),this.Fa.Ej(ad.a.Xib,!0),S.zke=!0):P.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else P.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}mhh(t){this.Bh?this.yB.isVisible&&this.MZe(t):P.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}Jjc(){if(this.Bh){var t=
this.yB.Q7d();t&&(-1===t?this.yB.Mw(0,!0):(this.yB.Mw(t,!1),this.yB.Mw(t-1,!0)))}else P.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}Ijc(){if(this.Bh){var t=this.yB.Q7d();t+1!==this.yB.vmj()&&(-1===t?this.yB.Mw(0,!0):(this.yB.Mw(t,!1),this.yB.Mw(t+1,!0)))}else P.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}Iwh(t,S){t&&(t=Object(D.a)(117,t.sc(this.Te)))&&((t=t.xa)?t.Rd(S):P.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(h.a)(m,"ReplaceObjectPresenter",null,[654]);class I{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.jIb=null;this.OKe=0}}Object(h.a)(I,"TaskItem",null,[]);class X{constructor(t,S,la){this.qfb=[];this.wi=t;this.lu=S;this.pug=la}wZi(t,S,la){for(let Ca=0;Ca<this.qfb.length;Ca++)if(this.qfb[Ca].slideSid===t&&this.qfb[Ca].slideCid===S&&this.qfb[Ca].shapeId===la)return this.qfb[Ca];return null}Kph(t){var S=this.wZi(t.slide.sid,
t.slide.cid,t.shapeId);if(S)return S.jIb=t,S.OKe++,1;const la=Object.assign(new I,{slideSid:t.slide.sid,slideCid:t.slide.cid,shapeId:t.shapeId,OKe:0,jIb:null});Array.add(this.qfb,la);t.w9=!0;S=t.correlationId;const Ca=t.slide,Na=t.shape;this.wi.MZf(Ca.cid,Ca.sid,Na.get_shapeId(),S,t.trigger,this.pug?this.lu.KUc(Na):this.lu.D6b(Na),this.pug?this.lu.JUc(Na):this.lu.C6b(Na),()=>{this.Q7g(la)},qb=>{this.Q7g(la);P.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
qb.HttpStatusCode);return!0});return 0}Q7g(t){Array.remove(this.qfb,t);t.jIb&&t.jIb.gE&&(P.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",t.jIb.correlationId,t.OKe-1),this.Kph(t.jIb))}}Object(h.a)(X,"ReplaceObjectRequestManager",null,[626]);class ta{constructor(t){this.hxe=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Rp=t}get_current(){return this.Rp}moveNext(){return this.hxe?(this.hxe=!1,!0):!1}reset(){this.hxe=
!0}}Object(h.a)(ta,"SingleEnumerator",null,[144]);class Fa{constructor(t){this.$$ge=this.getEnumerator;this.ni=t}getEnumerator(){return new ta(this.ni)}[Symbol.iterator](){return Object(Jp.a)(this.getEnumerator())}xYc(t,S){t&&t===this.ni&&t.uW(S)}f$a(){return this.ni}g$a(){return this.ni}s6b(){return this.ni}x6f(){return this.ni}B2f(){return this.ni}XQa(t,S,la,Ca,Na,qb){this.ni.XQa(t,S,la,Ca,Na,qb);return this.ni}lMc(t,S,la,Ca,Na){return this.XQa(t,S,la,Ca,Na,null)}get usf(){return this.ni.gE?1:0}}
Object(h.a)(Fa,"ReplaceObjectSingleContextManager",null,[627,142]);var bb=d(133);class yb{constructor(t,S,la,Ca,Na){this.$ea=null;this.uFb=this.xse=!1;this.Ima=null;this.visible=!1;this.ou=t;this.QT=S;this.O9=la;this.lu=Na;this.jhc=Ca;this.rr=!1}get Bh(){return this.rr}setup(){this.Bh||(this.Ima=new Vb.a,this.$ea=this.jhc.lHi(this.Ima.xa),this.QT&&!this.QT.Al&&this.QT.WU&&(this.QT.WU.appendChild(this.Ima),this.Rd(!1),this.uFb=!0,this.QT.xra(this,3),this.visible=this.QT.BQ||this.QT.Wn),this.rr=!0)}Jm(){P.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}lD(){}Zp(){if(!this.Bh)return P.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.xse||!this.$ea.Bh||!this.$ea.ON)return null;const t=Ac.a.Gn(this.$ea.ON.xa.style.left),S=Ac.a.Gn(this.$ea.ON.xa.style.top),la=Ac.a.Gn(this.$ea.ON.xa.style.width),Ca=Ac.a.Gn(this.$ea.ON.xa.style.height);return new bb.a(new Nb.a(t,S),new Nb.a(t+la,S),new Nb.a(t+la,S+
Ca),new Nb.a(t,S+Ca))}PN(){return!1}Ox(){}Xy(){}setPosition(){}Kj(){this.uFb=!0;this.Xr()}Qq(){this.uFb=!0;this.Xr()}Yu(){this.uFb=!0;this.Xr()}setZIndex(t){this.Ima&&this.Ima.OB(t)}OE(){}bE(){return null}JB(){return[]}draw(){}dispose(){this.O9();this.Bh&&(this.$ea.dispose(),this.Ima.xa.parentNode&&this.Ima.zq(),this.Ima=null,this.rr=!1)}LZe(t){this.Bh?(this.uqc(t),this.Xr()):P.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}p8b(){this.Bh?this.Yra():
P.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}uqc(t){this.Bh?(this.$ea.Loa(t),this.Rd(!0)):P.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}Yra(){this.Bh?(this.$ea.dismiss(),this.Rd(!1)):P.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}Xr(){if(this.xse&&this.uFb){var t=this.lu.D6b(this.ou),S=this.lu.C6b(this.ou);this.lh(t,S);this.Ima&&(t=
this.lu.Eij(this.ou),en.a.setRotation(this.Ima.xa,t));this.uFb=!1}}Rd(t){this.xse=t;this.Ima.Rd(t)}lh(t,S){this.$ea&&this.$ea.lh(t,S)}}Object(h.a)(yb,"ReplaceObjectSuggestionPreviewView",null,[761,762,435,436,106,654]);var Bb=d(267),pb=d(225),Ob=d(252),sc=d(1002),wc=d(1001);class Lb extends Sys.EventArgs{constructor(t){super();this.shape=t}}Object(h.a)(Lb,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class $b{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd){this.rUg=!1;this.y$=this.xWa=null;this.ia=
Na;this.Le=qb;this.ld=Pb;this.vz=xc;this.aIa=ed;this.jhc=Ca;this.O9=la;this.ou=t;this.QT=S;this.kA=!1;this.la=dd;this.hBe=fd;this.rr=this.visible=!1}get Bh(){return this.rr}Lwb(){return this.vz.g$a(this.ou.QY)}setup(){if(!this.Bh){var t=this.Lwb();t=t?t.K1:0;this.rUg=1===t;this.y$=new Vb.a;this.xWa=this.jhc.DEi(this.y$,$b.aJc,Object(n.a)(this,this.Kuk,"onFlyoutAnchorClick"),Object(n.a)(this,this.Luk,"onFlyoutAnchorHover"),t);this.QT&&!this.QT.Al&&this.QT.WU&&(this.Jm(this.QT.WU),this.QT.xra(this,
3));this.rr=!0}}QOc(){this.Bh?this.xWa&&this.xWa.QOc():P.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}NNc(){this.Bh?this.xWa&&this.xWa.NNc():P.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.Bh)P.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.Xr();this.xWa.show();this.visible=!0;this.CPb();var t=this.Lwb();if(t){t.oke=!0;const S=new Date;t.YLa||
(t.YLa=S);t.Otc=S;P.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",t.trigger,t.correlationId)}}}get root(){return this.Bh?this.y$.xa:(P.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.Bh){this.xWa.dismiss();this.visible=!1;var t=this.Lwb();t&&(t.Zca=!1,t.Otc&&(t.Wvb+=+new Date-+t.Otc,P.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
t.Wvb,t.Otc,t.trigger,t.correlationId)))}else P.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}Jm(){this.visible=!1;this.Le.addCssClass(this.y$.xa,"replaceObjectBody");document.body.appendChild(this.y$.xa);this.ld.ZYb(Object(n.a)(this,this.onResize,"onResize"));this.Xr()}lD(){}Zp(){return null}PN(){return!1}Ox(){}Xy(){}setPosition(){}Kj(){}Qq(){}Yu(){}setZIndex(){}OE(t){if(this.Bh){if(t)this.visible=!1,this.CPb();else if(this.kA){const S=new Lb(this.ou);this.aIa.XPk(S)}this.kA=
t}else P.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}bE(){return null}JB(){return[]}draw(){this.Bh?this.Xr():P.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.O9();this.Bh&&(this.ld.Yjh(Object(n.a)(this,this.onResize,"onResize")),this.y$&&(this.y$.xa.parentNode&&this.y$.zq(),this.Le.removeCssClass(this.y$.xa,"replaceObjectBody")),this.dismiss(),this.xWa.dispose(),this.y$=null,this.rr=!1)}CPb(){this.y$.xa.style.visibility=
this.visible?jb.a.visible:jb.a.hidden;const t=this.Lwb();t&&(t.Zca=this.visible)}Xr(){let t=null;var S=this.QT.WU;S&&(t=this.Le.ai(S.xa));t?(S=t.x-($b.aJc+10),this.rUg&&this.QT&&this.QT.Nd&&(S=this.QT.Nd.Md.Pe(this.ou.wx,0),S=t.x+S+10),en.a.Eqc(this.y$.xa,1),this.y$.setPosition(1*S,t.y),this.XDl(1*S,t.y)):P.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}XDl(t,S){if(this.hBe.isVisible){var la=this.Lwb(),Ca=this.hBe.n_a;Ca&&la&&Ca.correlationId===la.correlationId&&
this.hBe.updatePosition(t,S)}}Kuk(t){if(t.uA!==Sys.UI.MouseButton.leftButton)return!1;this.ia.La(Va.a.C0a,2,Object.assign(new Mn,{shape:this.ou,action:0}));return!0}Luk(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const t=this.Lwb();if(t&&1===t.K1)return!1;this.ia.La(Va.a.C0a,2,Object.assign(new Mn,{shape:this.ou,action:1}));return!0}onResize(t,S){this.visible&&(t=null,S&&S.nG&&(t=S.nG.Fd),t&&t.Cb.equals(this.ou.slideId)&&this.Xr())}}$b.aJc=32;Object(h.a)($b,"ShapeReplaceObjectView",null,
[652,653,435,436,106,654]);var Oc=d(649);class md{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we){this.CXa=this.Fea=this.EXa=this.n5=this.Co=null;this.ybd=0;this.Nve=-1;this.vq=this.ni=null;this.Le=t;this.Zc=la;this.xp=S;this.ua=Ca;this.ia=Na;this.nE=ed;this.aIa=qb;this.vz=Pb;this.q0=xc;this.Fa=dd;this.la=fd;this.vhk=!we.Vj;this.rr=this.Vob=!1}get Bh(){return this.rr}get isVisible(){return this.Vob}get n_a(){return this.ni}setup(){this.Bh||(this.Co=Ac.a.Ie(),this.Co.setAttribute("Unselectable","on"),
this.Co.style.position=jb.a.absolute,this.Le.addCssClass(this.Co,"replaceObjectContainer"),this.$Se(null),document.body.appendChild(this.Co),this.goa(),this.nE.a9(ad.a.Xib,ad.a.hj,this.Co,()=>{},()=>{},!0),this.rr=!0)}dispose(){this.Bh&&(this.dismiss(),this.zuc(),this.Co&&this.Co.parentNode&&this.Co.parentNode.removeChild(this.Co),this.rr=!1)}dismiss(){this.Bh?(v.AFrameworkApplication.Aa.RRa(!0),this.setVisibility(!1),this.tGb.style.display=jb.a.none,this.tGb.style.zIndex="-1",this.CXa=this.Fea=null,
this.$Se(null)):P.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(t,S,la){if(!this.Bh)P.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!cb.a.Wa(t)){var Ca=this.vz.f$a(t);Ca&&Ca.correlationId===t&&Ca.gE&&!Ca.w9&&(this.ni=Ca,this.IHk(t,this.ni.suggestions),this.ybd=this.ni.gV,this.Rlh(),v.AFrameworkApplication.Aa.gQa(!0),this.tGb.style.zIndex=String(v.AFrameworkApplication.Aa.pra),this.Co.style.zIndex=String(v.AFrameworkApplication.Aa.erb),
this.tGb.style.visibility=jb.a.hidden,this.tGb.style.display=jb.a.block,this.tGb.style.visibility=jb.a.visible,this.Zka()?this.Le.addCssClass(this.Co,"replaceIconObjectContainer"):this.Le.removeCssClass(this.Co,"replaceIconObjectContainer"),this.updatePosition(S,la),this.setVisibility(!0))}}updatePosition(t,S){let la,Ca;this.setPosition(0,0);if(this.Zka()){la=t+$b.aJc+7;Ca=S;const Na=Oc.a(0,0);la+this.Co.offsetWidth>Na.width&&(la=t+$b.aJc-this.Co.offsetWidth,Ca=S-7-this.Co.offsetHeight)}else la=t,
Ca=S-7-this.Co.offsetHeight;this.setPosition(la,Ca)}vmj(){return this.Bh?this.ybd:(P.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}Q7d(){return this.Bh?this.isVisible?this.Co?this.Co.querySelector(".replaceObjectSuggestionsList")?this.Nve:(P.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(P.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(P.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}Mw(t,S){if(!this.Bh)P.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>t)&&this.isVisible)if(this.Co)if(t>=this.ybd)P.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.ybd,t);else{var la=this.Co.querySelector(".replaceObjectSuggestionsList");
la?(la=la.children)?(la=la[t])?S?(this.Nve=t,gc.FocusManager.Wr(la)&&this.Xwh(la.firstChild)):(this.Rlh(),gc.FocusManager.hAl(la)&&this.Zcg(la.firstChild)):P.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):P.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):P.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else P.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}Huc(t){this.EXa&&(this.EXa.className="ReplaceObjectCorrelation "+t)}IHk(t,S){this.$Se(t);if(t=this.AIi(t,S))S=this.zIi(),this.Co.appendChild(S),this.Co.appendChild(t),this.Zka()&&(t=this.yIi(),this.Co.appendChild(t))}$Se(t){this.Co&&(this.n5&&(this.Zc.yb(ha.a.click,this.n5,Object(n.a)(this,this.e5g,"onLinkClick")),this.n5=null),this.Le.Cu(this.Co),this.EXa=Ac.a.Ie(),this.EXa.setAttribute("Unselectable",
"on"),this.EXa.className=cb.a.Wa(t)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+t,this.EXa.style.position=jb.a.absolute,this.EXa.style.display=jb.a.none,this.Co.appendChild(this.EXa),this.Co.style.zIndex="-1")}zIi(){const t=Ac.a.Sn();t.setAttribute("Unselectable","on");this.Zka()?(t.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.Le.addCssClass(t,"replaceIconObjectContainerTitle")):(t.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.Le.removeCssClass(t,
"replaceIconObjectContainerTitle"));this.Le.addCssClass(t,"UIFont replaceObjectContainerTitle");return t}AIi(t,S){if(cb.a.Wa(t))return P.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!S||!S.length)return P.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const la=Ac.a.R1b();la.id=t;la.setAttribute("Unselectable","on");la.setAttribute(pa.a.af,pa.a.$gi);
this.Le.addCssClass(la,"replaceObjectSuggestionsList");this.Fea||(this.Fea=new Zc.a);this.CXa||(this.CXa=new Zc.a);for(var Ca of S)cb.a.Wa(Ca.imageData)||this.Fea.$(Ca.index,Ca.imageData),this.Zka()&&!cb.a.Wa(Ca.renderData)&&this.CXa.$(Ca.index,Ca.renderData),t=this.ili(Ca.index,Ca.labelText),la.appendChild(t);if(this.vhk&&0<this.CXa.count&&this.Zka()&&(cb.a.Wa(this.ni.yjb)&&(this.ni.yjb=zi.a.create().toString()),(Ca=ro.a.j$a(this.ni.yjb))&&!Ca.hasChildNodes())){Ca.style.position=jb.a.absolute;Ca.style.left=
"0px";Ca.style.top="0px";for(let Na of this.CXa.values)t=Ac.a.SA(),t.src=Na,t.style.display=jb.a.block,t.style.position=jb.a.absolute,Ca.appendChild(t);ro.a.TZb()}return la}yIi(){this.n5=Ac.a.Sn();this.n5.setAttribute("Unselectable","on");this.n5.setAttribute("tabindex","-1");this.n5.setAttribute(pa.a.af,pa.a.gSd);this.Le.addCssClass(this.n5,"UIFont replaceObjectContainerLink");this.Zka()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.rab&&(this.n5.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.Zc.pb(ha.a.click,this.n5,Object(n.a)(this,this.e5g,"onLinkClick")));const t=Ac.a.Ie();t.appendChild(this.n5);return t}goa(){this.Co&&(this.Zc.pb(ha.a.click,this.Co,Object(n.a)(this,this.onClick,"onClick")),this.q0.addHandler(this.Co,ha.a.Xf,Object(n.a)(this,this.GXc,"inputKeyApplyHandler")),this.xp.pb(ha.a.pointerOver,this.Co,Object(n.a)(this,this.cD,"onPointerOver")),this.xp.pb(ha.a.pointerOut,this.Co,Object(n.a)(this,this.Cz,"onPointerOut")))}zuc(){this.Co&&(this.Zc.yb(ha.a.click,this.Co,Object(n.a)(this,
this.onClick,"onClick")),this.q0.removeHandler(this.Co,ha.a.Xf,Object(n.a)(this,this.GXc,"inputKeyApplyHandler")),this.xp.yb(ha.a.pointerOver,this.Co,Object(n.a)(this,this.cD,"onPointerOver")),this.xp.yb(ha.a.pointerOut,this.Co,Object(n.a)(this,this.Cz,"onPointerOut")))}cD(t){t=this.eae(t.Ec);this.Xwh(t);return!0}Cz(t){t=this.eae(t.Ec);this.Zcg(t);return!0}GXc(t){if(this.isVisible&&!t.ctrlKey&&!t.altKey&&(!t.shiftKey||t.keyCode===ua.a.Sq&&this.Zka()))if(t.keyCode===ua.a.tq||t.keyCode===ua.a.pP)t.preventDefault(),
(t=this.Co.querySelector(":focus"))&&t.firstChild.click();else if(t.keyCode===ua.a.Sq&&this.Zka()){const S=this.Co.querySelector(":focus");S&&this.n5&&(S===this.n5?(t.preventDefault(),t.stopPropagation(),this.Mw(0,!0)):S.parentNode&&S.parentNode.className&&0<=S.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(t.preventDefault(),t.stopPropagation(),this.Mw(this.Q7d(),!1),gc.FocusManager.Wr(this.n5)))}}onClick(t){if(t.uA!==Sys.UI.MouseButton.leftButton)return!1;var S=this.eae(t.Ec);if(!this.Nme(S)||
!this.zWj(S))return!0;t=this.X7i(S);const la=this.R6b(S);S=this.ymj(S);cb.a.Wa(t)||cb.a.Wa(la)||(t=Object.assign(new Oo.a,{SuggestionSid:parseInt(la),ShapeId:this.ni.shapeId,CorrelationId:t,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,Label:S,SmartArtSubNodeId:this.ni.p6?this.ni.p6:null,ReplaceObjectType:this.ni.K1}),this.ia.La(Va.a.TPa,2,t));return!0}e5g(){this.ni&&(this.ni.Xpc=!0);this.Gbe();this.ia.processAction(Va.a.a7a,2);return!0}Xwh(t){t&&this.Nme(t)&&(t=this.R6b(t),cb.a.Wa(t)||
(t=this.Zka()?this.CXa.Gb(t)?this.CXa.ga(t):"":this.Fea.Gb(t)?this.Fea.ga(t):"",cb.a.Wa(t)||(t=new wc.a(this.ni.shapeId,t,this.ni.p6),this.aIa.rfh(t))))}Zcg(t){t&&this.Nme(t)&&(t=new sc.a(this.ni.shapeId,this.ni.p6),this.aIa.qfh(t))}eae(t){if(!t)throw Error.argumentNull("sourceElement");return"a"===t.nodeName.toLowerCase()?t:t.parentNode}X7i(t){return t?t.parentNode.parentNode.id:null}R6b(t){if(!t)return null;t=t.id.split("_");return 2!==t.length?null:t[1]}ymj(t){return t?t.title:null}Nme(t){return!!t&&
!cb.a.Wa(t.className)&&-1!==t.className.indexOf("ObjectSuggestionContainer")}zWj(t){return!!t&&!cb.a.Wa(t.className)&&-1===t.className.indexOf("ReplaceObjectSuggestionLoading")}ili(t,S){const la=this.Fea.Gb(t);var Ca=la?this.Fea.ga(t):Qe.a.ZK(Zb.a.Zna);la||P.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Na=Ac.a.SA();Na.setAttribute("Unselectable","on");Na.src=Ca;Na.title=S;Na.setAttribute(pa.a.af,pa.a.pN);this.Le.addCssClass(Na,"replaceObjectSuggestionThumbnail");
Ca=Ac.a.Eca();Ca.id="ROS_"+t;Ca.setAttribute("Unselectable","on");Ca.title=S;Ca.setAttribute(pa.a.af,"none");let qb=this.Zka()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.ni.IT&&this.ni.UHc.toString()===t&&(qb+="Selected");this.Le.addCssClass(Ca,qb);la||this.Le.addCssClass(Ca,"ReplaceObjectSuggestionLoading");Ca.appendChild(Na);t=this.Le.ZKf();t.setAttribute("Unselectable","on");t.setAttribute("tabindex","-1");t.setAttribute(pa.a.af,pa.a.pN);t.setAttribute(pa.a.ns,
S);t.appendChild(Ca);return t}setPosition(t,S){this.Bh?(0>t&&(t=0),0>S&&(S=0),this.Co.style.left=this.Le.Pc(t),this.Co.style.top=this.Le.Pc(S)):P.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(t){if(this.Co){if(this.ni)if(t)this.ni.x2e=new Date,this.ni.Dlk();else{let S;(S=this.ni).Fsc=S.Fsc+(+new Date-+this.ni.x2e)}this.Co.style.visibility=t?jb.a.visible:jb.a.hidden;this.Vob=t;this.Fa.Ej(ad.a.Xib,t)}}Rlh(){this.Nve=-1}Zka(){return!!this.ni&&
1===this.ni.K1}get tGb(){this.vq&&"undefined"!==typeof this.vq||(this.vq=this.Le.Ie(),this.vq.setAttribute("id","ModalDiv"),this.Le.addCssClass(this.vq,"cui-modalDiv"),this.vq.setAttribute("Unselectable","on"),document.body.appendChild(this.vq),Bb.a.instance.pb(ha.a.pointerDown,this.vq,Object(n.a)(this,this.Zfd,"onModalPointerDown")),Bb.a.instance.pb(ha.a.FR,this.vq,Object(n.a)(this,this.$fd,"onModalPointerUp")),Bb.a.instance.pb(ha.a.cmc,this.vq,Object(n.a)(this,this.Fwk,"onModalPointerMove")),Bb.a.instance.pb(ha.a.pointerOut,
this.vq,Object(n.a)(this,this.Gwk,"onModalPointerOut")),pb.a.instance.pb(ha.a.click,this.vq,Object(n.a)(this,this.Ewk,"onModalClick")),Ob.a.instance.pb(ha.a.xGb,this.vq,Object(n.a)(this,this.LIe,"onModalMouseWheel")));return this.vq}Zfd(){return!0}$fd(){return this.Gbe()}Fwk(){return!0}Gwk(){return!0}Ewk(){return this.Gbe()}LIe(){return!0}Gbe(){if(!this.ni||!this.ni.slide)return!0;const t=this.ni.shape;if(!t)return!0;this.ia.La(Va.a.C0a,2,Object.assign(new Mn,{action:2,shape:t}));return!0}}Object(h.a)(md,
"ReplaceObjectSuggestionsGalleryView",null,[624,654]);class zd{constructor(t,S,la,Ca){this.Bgk=t;this.lu=S;this.ua=la;this.la=Ca}z4i(t){if(!this.ua.Ba)return!1;t=this.ua.Ba.lT(t);return this.lvc(t)}lvc(t){return!(t&&t.get_shapeId()&&t.hasText&&this.lu.sbb(t))||t.get_shapeRotation()||t.As||t.m4||t.ux||!this.Bgk.validate(t)?!1:!0}EYj(t){return!Array.contains(this.la.replaceObjectDisabledTriggers,t)}}Object(h.a)(zd,"ReplaceObjectValidationHelper",null,[]);class le{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed){this.Kr=
this.l0=null;this.rr=!1;this.VX=t;this.Zc=S;this.xp=la;this.DO=Ca;this.Vea=Na;this.qe=Pb;this.la=qb;this.hcb=ed}get Bh(){return this.rr}NNc(){this.la.DKb?this.Kr.setAttribute("Src",this.qe.rk("BLUEBOLT_Deactivated.gif")):this.Kr.style.opacity=".3";this.hcb.Pqh(Object(n.a)(this,this.dismiss,"dismiss"))}QOc(){this.la.DKb?this.Kr.setAttribute("Src",this.qe.rk("BLUEBOLT_Reactivated.gif")):this.Kr.style.opacity="initial";this.hcb.disabled=!1}show(){this.la.DKb?this.Kr.setAttribute("Src",this.qe.rk("BLUEBOLT_Entrance.gif")):
this.Kr.setAttribute("Src",this.qe.rk("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.DKb?(this.Kr.setAttribute("Src",this.qe.rk("BLUEBOLT_Exit.gif")),this.hcb.hcl(()=>{this.VX.xa.style.visibility=jb.a.hidden})):(this.Kr.setAttribute("Src",""),this.VX.xa.style.visibility=jb.a.hidden)}setup(){this.Bh||(this.VX?(this.l0=new Vb.a,this.l0.xa.style.visibility=jb.a.inherit,this.l0.xa.style.position=jb.a.absolute,this.Kr=Ac.a.SA(),this.Kr.setAttribute("Unselectable","on"),this.Kr.setAttribute(pa.a.af,
pa.a.pN),this.Kr.className="gifFloatie",this.l0.xa.appendChild(this.Kr),this.VX.appendChild(this.l0),this.goa()):P.a.J(38072903,829,15,"parentElement is null"),this.rr=!0)}J4g(t){let S;switch(this.la.replaceObjectIconType){case 7:S="BLUEBOLT_Hover_on.gif";break;case 8:S="BLUEBOLT_HoverWhite_On.gif";break;default:S="BLUEBOLT_Hover_on.gif"}this.Kr.setAttribute("Src",this.qe.rk(S));return this.Vea(t)}onBlur(){let t;switch(this.la.replaceObjectIconType){case 7:t="BLUEBOLT_Hover_off.gif";break;case 8:t=
"BLUEBOLT_HoverWhite_Off.gif";break;default:t="BLUEBOLT_Hover_off.gif"}this.Kr.setAttribute("Src",this.qe.rk(t));return!0}goa(){this.DO&&this.Zc.pb(ha.a.click,this.Kr,this.DO);this.Vea&&(this.xp.pb(ha.a.pointerOver,this.Kr,Object(n.a)(this,this.J4g,"onHover")),this.xp.pb(ha.a.pointerOut,this.Kr,Object(n.a)(this,this.onBlur,"onBlur")))}L4e(){this.DO&&this.Zc.yb(ha.a.click,this.Kr,this.DO);this.Vea&&(this.xp.yb(ha.a.pointerOver,this.Kr,Object(n.a)(this,this.J4g,"onHover")),this.xp.yb(ha.a.pointerOut,
this.Kr,Object(n.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.L4e();this.rr=!1}}Object(h.a)(le,"GifFlyoutAnchor",null,[786,654]);class df{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff){this.Kr=this.Fv=null;this.VX=t;this.eU=S;this.$$j=la;this.fak=Ca;this.eBg=we.replaceObjectIconType;this.gtg=we.replaceObjectAnimId;this.htg=we.DKb;this.mIa=qb;this.jhc=Na;this.Zc=Pb;this.xp=xc;this.DO=ed;this.Vea=dd;this.Le=fd;this.qik=Sf;this.hcb=Ff;this.rr=!1}get J2b(){return 1===this.qik?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:
this.hcb.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get Bh(){return this.rr}setup(){this.Bh||(this.Fv=new Vb.a,this.Kr=this.jhc.kHi(),this.Fv.xa.style.visibility=jb.a.inherit,this.Xia(),this.rr=!0)}NNc(){this.hcb.Pqh(Object(n.a)(this,this.dismiss,"dismiss"));this.Yra();this.uqc();this.Fv.vAi()||this.Fv.ur("replaceObjectGrayedFlyoutAnchor")}show(){this.Bh?this.uqc(this.htg):P.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}QOc(){this.hcb.disabled=
!1;this.Yra();this.uqc();this.Fv.Nib("replaceObjectGrayedFlyoutAnchor")}uqc(t=!1){this.Bh?this.Kr.Loa(this.Faj(t),""):P.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}Faj(t){const S=this.mIa.uYd(this.eU,this.eU,this.$$j,this.fak,this.J2b,null);this.Le.addCssClass(this.Fv.xa,"replaceObjectFlyoutAnchorBase");this.Le.addCssClass(this.Fv.xa,"replaceObjectFlyoutAnchor"+this.eBg);t&&(this.Le.addCssClass(this.Fv.xa,"replaceObjectFlyoutAnchorAnimBase"),this.Le.addCssClass(this.Fv.xa,
"replaceObjectFlyoutAnchorAnim"+this.gtg));return S}Yra(){this.Bh?(this.Kr.clear(),this.Le.removeCssClass(this.Fv.xa,"replaceObjectFlyoutAnchorBase"),this.Le.removeCssClass(this.Fv.xa,"replaceObjectFlyoutAnchor"+this.eBg),this.htg&&(this.Le.removeCssClass(this.Fv.xa,"replaceObjectFlyoutAnchorAnimBase"),this.Le.removeCssClass(this.Fv.xa,"replaceObjectFlyoutAnchorAnim"+this.gtg))):P.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.Bh&&(this.L4e(),this.Fv&&
this.Fv.xa.parentNode&&this.Fv.zq(),this.dismiss(),this.Kr.dispose(),this.Fv=null,this.rr=!1)}dismiss(){this.Bh?(this.Yra(),this.VX.xa.style.visibility=jb.a.hidden):P.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}Xia(){this.VX?(this.Fv.xa.style.width=this.Le.Pc(this.eU),this.Fv.xa.style.height=this.Le.Pc(this.eU),this.Fv.xa.setAttribute(pa.a.af,pa.a.Au),this.VX.appendChild(this.Fv),this.Kr.Xia(this.Fv.xa),this.goa()):P.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}Wgb(){return!0}goa(){this.DO&&
this.Zc.pb(ha.a.click,this.Fv.xa,this.DO);this.Zc.pb(ha.a.doubleClick,this.Fv.xa,Object(n.a)(this,this.Wgb,"onDoubleClick"));this.Vea&&(this.xp.pb(ha.a.pointerOver,this.Fv.xa,this.Vea),this.xp.pb(ha.a.pointerOver,this.Fv.xa.firstChild,this.Vea),this.xp.pb(ha.a.pointerOver,this.Fv.xa.firstChild.firstChild,this.Vea))}L4e(){this.DO&&this.Zc.yb(ha.a.click,this.Fv.xa,this.DO);this.Zc.yb(ha.a.doubleClick,this.Fv.xa,Object(n.a)(this,this.Wgb,"onDoubleClick"));this.Vea&&(this.xp.yb(ha.a.pointerOver,this.Fv.xa,
this.Vea),this.xp.yb(ha.a.pointerOver,this.Fv.xa.firstChild,this.Vea),this.xp.yb(ha.a.pointerOver,this.Fv.xa.firstChild.firstChild,this.Vea))}}Object(h.a)(df,"ReplaceObjectFlyoutAnchor",null,[786,654]);class bf{constructor(t,S){this.Lz=null;this.ii=t;this.Le=S;this.rr=!1}get Bh(){return this.rr}get ON(){return this.Lz}setup(){this.Bh||(this.Lz=new Vb.a,this.Xia(),this.rr=!0)}Xia(){this.ii?(this.ii.appendChild(this.ON.xa),this.Le.addCssClass(this.ON.xa,"replaceObjectPreviewContainer"),this.ON.setVisibility(!1)):
P.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}Loa(t){if(this.Bh){if(t=this.uja(t))this.loa(),this.ON.xa.appendChild(t),this.ON.setVisibility(!0)}else P.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}lh(t,S){this.Bh?this.ON.lh(t,S):P.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.Bh&&(this.dismiss(),this.ON&&this.ON.xa.parentNode&&(this.ON.zq(),this.Le.removeCssClass(this.ON.xa,
"replaceObjectPreviewContainer")),this.Lz=null)}dismiss(){this.Bh?(this.loa(),this.ON.setVisibility(!1)):P.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}uja(t){if(!cb.a.Wa(t)){const S=Ac.a.SA();S.setAttribute("Unselectable","on");S.src=t;S.style.height="100%";S.style.width="100%";return S}return null}loa(){this.ON.xa.firstChild&&this.ON.xa.removeChild(this.ON.xa.firstChild)}}Object(h.a)(bf,"ReplaceObjectPreviewImageView",null,[654]);var Hg=d(696);class Yh{constructor(t,
S,la,Ca,Na,qb,Pb){this.Zc=t;this.xp=S;this.Le=la;this.mIa=Ca;this.la=Na;this.qe=qb;this.ozg=Pb}DEi(t,S,la,Ca,Na){t=dl.CIl(this.la.replaceObjectIconType,Na)?new le(t,this.Zc,this.xp,la,Ca,this.la,this.qe,this.Le,this.ozg):new df(t,S,"per","PowerPointDesigner_32x32x32",this,this.mIa,this.Zc,this.xp,la,Ca,this.Le,this.la,Na,this.ozg);t.setup();return t}lHi(t){t=new bf(t,this.Le);t.setup();return t}kHi(){return new Hg.a(this.Le)}}Object(h.a)(Yh,"ReplaceObjectViewFactory",null,[]);class Hi{constructor(t,
S,la){this.Le=t;this.ua=la;this.RUg=S}KUc(t){if(!t)throw Error.argumentNull("shape");var S=t.SU;t=this.$tb(S.TopLeft);S=this.$tb(S.TopRight);return Nb.a.lm(t,S)}JUc(t){if(!t)throw Error.argumentNull("shape");var S=t.SU;t=this.$tb(S.TopRight);S=this.$tb(S.BottomRight);return Nb.a.lm(t,S)}D6b(t){return this.KUc(t)*this.F9f()}C6b(t){return this.JUc(t)*this.F9f()}Eij(t){if(!t)throw Error.argumentNull("shape");var S=t.SU;t=this.$tb(S.TopLeft);S=this.$tb(S.TopRight);return Gb.a.YO(Nb.a.MG(t,S))}a_f(){return this.getBounds(this.RUg.Ic.MB)}getBounds(t){return this.Le.ai(t)}F9f(){const t=
this.RUg.Ic;return t?t.tT:1}$tb(t){return new Nb.a(t.X,t.Y)}sbb(t){return t?!!this.ua.Ba&&this.ua.Ba.Cb.equals(t.slideId):!1}}Object(h.a)(Hi,"ReplaceObjectViewHelper",null,[]);var kf=d(440);class ej{constructor(t,S,la){this.D0=this.a0=null;this.TT=t;this.ygk=S;this.Q$c=la}get sG(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get ssb(){this.a0||
(this.a0=Object.assign(new oo.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:kf.a.LXe,outputSchema:kf.a.LXe,func:Object(n.a)(this,this.Lbb,"lambdaBeforeFunc")}));return this.a0}get Erb(){return null}get mKb(){this.D0||(this.D0=Object.assign(new oo.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:kf.a.LXe,outputSchema:"ShapeTextConvertable",func:Object(n.a)(this,this.Kne,"lambdaRemoteFunc")}));return this.D0}Lbb(t,S,la){if(t&&this.ygk.$je())if(t){try{var Ca=Wd.a(t.ContextId)}catch(Na){P.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.sG);la(null);return}this.Q$c.EYj(Ca.t)?this.Q$c.z4i(Ca.shapeId)?la(t):(P.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.sG),la(null)):(P.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.sG),la(null))}else la(null),P.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.sG);else P.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.sG),la(null)}Kne(t,S,la){t?
t?this.TT.execute(Ca=>{Ca.fpc(t.Topic,t.Data,t.ContextId,Na=>{this.DKa(Na)},Na=>{this.BKa(Na)},la)}):la(null):la(null)}DKa(t){if(!v.AFrameworkApplication.Ug&&t&&t.data){var S=t.data.state;if(S){try{var la=Wd.a(t.data.Wd)}catch(Ca){S(null);P.a.J(36804442,375,10,"Try parse aug response failed:{0}",Ca.message);return}S(la)}}}BKa(t){!v.AFrameworkApplication.Ug&&t&&t.data&&(t=t.data.state)&&t(null)}}Object(h.a)(ej,"ReplaceObjectWacALWorkflow",null,[656]);class wi{constructor(){this.bGe=null}lvc(t){return this.validate(t)?
this.bGe?this.bGe.lvc(t):!0:!1}ndl(t){this.bGe=t}}Object(h.a)(wi,"ReplaceObjectWall",null,[]);class Qg extends wi{constructor(){super();this.lu=null}h7f(t){const S=this.lu.D6b(t);t=this.lu.C6b(t);var la=S*t;const Ca=this.lu.a_f().width,Na=this.lu.a_f().height;la=la/(Ca*Na)*100;P.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",S,t,Ca,Na,la);return la}}Object(h.a)(Qg,"AreaRatioWall",wi,[]);class Jk extends Qg{constructor(t,
S){super();this.Mck=t;this.lu=S}validate(t){return this.h7f(t)<=this.Mck}}Object(h.a)(Jk,"MaxAreaRatio",Qg,[]);class km extends wi{constructor(t,S){super();this.Jck=t;this.lu=S}validate(t){return this.lu.C6b(t)<=this.Jck}}Object(h.a)(km,"MaxShapeHeight",wi,[]);class Am extends wi{constructor(t,S){super();this.Ock=t;this.lu=S}validate(t){return this.lu.D6b(t)<=this.Ock}}Object(h.a)(Am,"MaxShapeWidth",wi,[]);class ep extends Qg{constructor(t,S){super();this.bdk=t;this.lu=S}validate(t){return this.h7f(t)>=
this.bdk}}Object(h.a)(ep,"MinAreaRatio",Qg,[]);var Go=d(40);class fp extends wi{constructor(t,S){super();this.adk=t;this.Ea=S}validate(t){return this.Vfj(t,this.Ea)>=this.adk}Vfj(t,S){if(!t)return 0;let la=0;S.NJ(t,Ca=>{Ca.Sa(Go.a.pq)&&(Ca=Ca.eb(Go.a.pq))&&0<Ca.length&&la++});return la}}Object(h.a)(fp,"MinParagraphCount",wi,[]);class Gp extends wi{constructor(t,S){super();this.Zck=t;this.lu=S}validate(t){return this.lu.C6b(t)>=this.Zck}}Object(h.a)(Gp,"MinShapeHeight",wi,[]);class Hp extends wi{constructor(t,
S){super();this.edk=t;this.lu=S}validate(t){return this.lu.D6b(t)>=this.edk}}Object(h.a)(Hp,"MinShapeWidth",wi,[]);class $l{constructor(t,S,la){this.mfa=null;this.la=t;this.Ea=S;this.eGb=la;this.init(this.la.replaceObjectClientWalls)}validate(t){return this.mfa?this.mfa.lvc(t):!0}init(t){t=this.jJi(t);this.Jmi(t)}jJi(t){const S={};if(cb.a.Wa(t))return S;t=t.split(";");for(const la of t)cb.a.Wa(la)||(t=la.split(":"),2===t.length?S[t[0]]=t[1]:P.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
la));return S}Jmi(t){const S=[];"MinParagraphCount"in t&&Array.add(S,new fp(oi.d(t,"MinParagraphCount",0),this.Ea));"MinShapeHeight"in t&&Array.add(S,new Gp(oi.b(t,"MinShapeHeight",0),this.eGb));"MaxShapeHeight"in t&&Array.add(S,new km(oi.b(t,"MaxShapeHeight",Number.MAX_VALUE),this.eGb));"MinShapeWidth"in t&&Array.add(S,new Hp(oi.b(t,"MinShapeWidth",0),this.eGb));"MaxShapeWidth"in t&&Array.add(S,new Am(oi.b(t,"MaxShapeWidth",Number.MAX_VALUE),this.eGb));"MinShapeAreaRatio"in t&&Array.add(S,new ep(oi.b(t,
"MinShapeAreaRatio",0),this.eGb));"MaxShapeAreaRatio"in t&&Array.add(S,new Jk(oi.b(t,"MaxShapeAreaRatio",Number.MAX_VALUE),this.eGb));for(t=0;t<S.length-1;t++)S[t].ndl(S[t+1]);0<S.length&&(this.mfa=S[0])}}Object(h.a)($l,"ReplaceObjectWalls",null,[625]);class co{constructor(){this.K=null;this.xO=this.oxe=this.Rxe=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}Zb(t){this.K=t;(this.xO=this.K.resolve("PowerPointWebEditor.IApplicationContext").qd.vg)&&this.K.register(En.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>
new En.a(v.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));t.register(Sk,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().oa(()=>
new Sk);t.register(Hi,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().oa(()=>new Hi(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.IActiveSlideViewManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));t.register(624,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().oa(()=>new md(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("Common.IPointerInputManager"),t.resolve("Common.IClickInputManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.IInputHandlerManager"),t.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.IBrowserUtils")));t.register(625,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().oa(()=>
new $l(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));t.register(zd,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().oa(()=>new zd(t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.IApplicationSettings")));
t.register(626,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().oa(()=>new X(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));t.register(627,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().oa(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new Y((S,la,Ca,Na,
qb,Pb)=>{const xc=new gn(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider"));xc.XQa(S,la,Ca,Na,qb,Pb);return xc}):new Fa(new gn(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider"))));t.register(628,"PowerPointWebEditor.IReplaceObjectManager").ma().oa(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new Sl(t.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),t.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.IApplicationSettings"),
t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider")):new Qo(t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider")));t.register(m,"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().oa(()=>
new m(t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),
t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("Box4.IPageView").Ma,t.resolve("PowerPointWebEditor.IShapeReader")));t.register(dl,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().oa(()=>new dl(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.ITaskManager")));t.register(Yh,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().oa(()=>new Yh(t.resolve("Common.IClickInputManager"),t.resolve("Common.IPointerInputManager"),
t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPoint.IPathManager"),t.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));t.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().oa(()=>new kd.a((S,la)=>{let Ca=null;const Na=Object(D.a)(117,S.sc(t.resolve("Box4.IPageView").Ma));
Na&&!Na.Al&&Na.WU&&(Ca=new $b(S,Na,la,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),
Ca.setup());return Ca}));t.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().oa(()=>new kd.a((S,la)=>{let Ca=null;const Na=Object(D.a)(117,S.sc(t.resolve("Box4.IPageView").Ma));Na&&!Na.Al&&Na.WU&&(Ca=new yb(S,Na,la,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),Ca.setup());return Ca}));t.register(ej,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>
new ej(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));t.register(qj,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().oa(()=>new qj(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));t.register(fn,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().oa(()=>
new fn(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
t.resolve("Common.Transaction.ITransactionFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.View.IPPTPageView"),t.resolve("PowerPointWebEditor.IShapeReader")));t.register(qo,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().oa(()=>new qo(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),
t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.xO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");const t=this.K.resolve("Common.IAppSettingsManager");t.ff(()=>{const S=new Date;t.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?P.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):P.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");
if(this.Rxe=t.ka("463"))t.ka("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.oxe=t.ka("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();P.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+S)})}dispose(){this.Rxe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.oxe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){e.a.instance.Dc(jc.a(new co,0))}}Object(h.a)(co,"PPTWebEditorReplaceObjectPackage",
null,[2,3]);var aq=d(271),eo=d(398),Ui=d(1080);class nt{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=
!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(h.a)(nt,"AppSettings",null,[]);class is{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(h.a)(is,"ControllerFactoryParameters",null,[]);var nr=d(734),Kp=d(332);class Yi{}Yi.none="None";Yi.vhFailedToLoadVersionList="VHFailedToLoadVersionList";Yi.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";Yi.vhFailedToParseVersionList=
"VHFailedToParseVersionList";Yi.vhFetchFailed="VHFetchFailed";Yi.vhVersioningNotEnabled="VHVersioningNotEnabled";Yi.vhFileNotFound="VHFileNotFound";Yi.vhVersionTooOld="VHVersionTooOld";Yi.wKl="VHFailedToRenderThumbnails";Yi.vKl="VHFailedToRenderSlide";Yi.uKl="VHFailedToRenderNotes";Yi.sKl="VHFailedToRenderDiff";Yi.xKl="VHFailedToShowAnimaitonIcon";Yi.yKl="VHFailedToShowHiddenEffect";Yi.tKl="VHFailedToRenderInitPresInfo";Object(h.a)(Yi,"ErrorName",null,[]);class Ul{constructor(){this.oIa=new rc.a;
this.oIa.add(0,Yi.none);this.oIa.add(100,Yi.vhFailedToLoadVersionList);this.oIa.add(101,Yi.vhFailedToGetDownloadToken);this.oIa.add(102,Yi.vhFailedToParseVersionList);this.oIa.add(103,Yi.vhFetchFailed);this.oIa.add(104,Yi.vhVersioningNotEnabled);this.oIa.add(105,Yi.vhFileNotFound);this.oIa.add(106,Yi.vhVersionTooOld);this.OIa=new rc.a;this.OIa.add(0,Yi.none);this.OIa.add(100,Yi.wKl);this.OIa.add(101,Yi.vKl);this.OIa.add(102,Yi.uKl);this.OIa.add(103,Yi.sKl);this.OIa.add(104,Yi.xKl);this.OIa.add(105,
Yi.yKl);this.OIa.add(106,Yi.tKl)}get ail(){return this.oIa}get MKl(){return this.OIa}static x7f(){Ul.gUe||(Ul.gUe=new Ul);return Ul.gUe}}Ul.eCf="ErrorCode";Ul.gUe=null;Object(h.a)(Ul,"VersionHistoryTelmetryHelper",null,[]);class jn{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff,Gh,gk,vj){this.Hic=this.tE=this.Gzg=this.P9c=this.GBb=this.w4=this.zDe=this.fY=this.oH=null;this.kva=-1;this.lCb=null;if(!vj)throw Error.argumentNull("clientRequestManager");this.ia=t;this.Ew=S;this.Di=la;this.Ha=Ca;this.oc=
Na;this.kYa={};this.Fa=qb;this.Pg=Pb;this.nFb={};this.mc=ed;this.rcd={};this.mfk=xc;this.Xea=dd;this.Xa=fd;this.Rre=[];we&&(this.Gzg=we,this.Gzg.execute(mk=>{this.tE=mk}));this.mO=Sf;this.Vg=Ff;this.Kqe=Gh;this.JFb=gk;this.Ds=vj}wb(){this.ia.ya(u.a.Vrc,E.a.frame,Object(n.a)(this,this.zol,"showVersionHistoryDialogAction"));this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.ya(Va.a.Dbh,E.a.frame,Object(n.a)(this,this.jMe,"pptoShowFileVersion"));this.ia.ya(Va.a.iKh,E.a.frame,Object(n.a)(this,
this.vyj,"handleVersionHistoryCopySlides"))}zol(t,S,la){if(1===la)return t=!1,this.Xa.Pda&&(t=!0),t?2:32;2===la&&(v.AFrameworkApplication.LL("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),v.AFrameworkApplication.LL("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),this.Hic=Kc.a.create().toString(),r.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.Hic),
Za.c(Va.a.Q8g,!0),this.kYa.VersionHistoryLaunchSessionId=this.Hic,this.nFb.VersionHistoryLaunchSessionId=this.Hic,this.kYa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.P9c=[],this.oH||(this.oH=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new is,{ulsLogger:new eo.a,serviceBase:this.Ha.getSetting("VersionHistoryWebServiceBase"),latestStreamServiceBase:this.Ha.ka("PPTVHPodsBootEnabled")?this.Ha.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Ha.getSetting("PodSID"):
"",docId:v.AFrameworkApplication.hh,appSettings:Object.assign(new nt,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ha.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.mc.In,wdEnableRestore:this.mc.In,userSessionId:v.AFrameworkApplication.userSessionId,wacCluster:this.Ha.Ga("WacCluster"),uiLocale:this.Ha.NJa?this.Ha.NJa:"en-us",isRtl:v.AFrameworkApplication.isRtl,disabledChangeGates:this.Ha.Ga("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ha.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),
wdEnableDeleteVersions:this.Ha.ka("PPTVersionHistoryDeleteVersionsIsEnabled")}),perfTelemetryInfos:this.P9c}))),this.oH&&this.oH.setDisableSaveACopy(v.AFrameworkApplication.iG),this.Aol());return 32}jMe(t,S,la){return 1===la&&this.Xa.Pda?2:this.ia.processAction(u.a.Jrc,la)}vyj(t,S,la){if(1===la)return this.nvh()?2:32;this.fY.onCopySlides();return 32}Aol(){var t;if(!document.getElementById("VersionHistoryOverlay")){this.PVk();this.LVk();this.MVk();this.GVk();this.EVk();this.KVk();this.JVk();this.HVk();
const S=document.createElement("div");S.id="VersionHistoryOverlay";S.style.width="100%";S.style.zIndex="998";S.style.display="block";S.style.position="absolute";S.style.top="0px";if(this.Ha.ka("RegionComposerIsEnabled")){const la=(null===(t=document.getElementById("HeaderRegion"))||void 0===t?void 0:t.offsetHeight)||0;S.style.top=la+"px";S.style.bottom="0px";S.style.height=`calc(100vh - ${la}px)`}else S.style.height="calc(100% + "+Ma.AFrame.Yrd+"px)";document.getElementById("WACInnerFrame").appendChild(S);
this.zDe=this.oH.createVersionHistoryDialog(S);this.pkb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.oH.getTipVersion&&this.Ha.ka("PPTVHPodsBootEnabled")&&this.oH.getTipVersion();this.oH.getVersions("");this.o5h()}o5h(){try{this.lCb=this.mfk.r8i();for(let t=0;t<this.lCb.length;t++)this.Pg.Lo(this.lCb[t]);this.Pg.rI(ad.a.QPb)}catch(t){r.ULS.sendTraceTag(512508633,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",t)}}uKi(){try{if(this.lCb)for(let t=
0;t<this.lCb.length;t++)this.Pg.rI(this.lCb[t]);else r.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.Pg.Lo(ad.a.QPb)}catch(t){r.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",t)}}PVk(){this.oH.getFullAppErrorEvent().addListener(t=>{try{const S=Ul.x7f().ail.ga(t);this.nFb[Ul.eCf]=S;r.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",S,this.Hic)}catch(S){r.ULS.sendTraceTag(512508629,
822,10,"Exception in FullAppErrorEvent call back: {0}.",S)}})}LVk(){this.oH.getVersionsReadyEvent().addListener(t=>{this.Klh(t.containerDiv);this.v9h(t.versions);this.Fa.LU("VersionHistoryOverlay",!0);try{this.w4&&this.w4.DownloadUrl.length&&this.fY&&(this.gLh(),this.Xeg(),this.fY.onVersionSelected(this.w4,this.GBb,this.kYa),this.lGf())}catch(S){r.ULS.sendTraceTag(512508628,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",S)}})}v9h(t){const S=this.fY.getAppDataStore();
for(const la of t)S.AddVersionInfoToStore(la)}MVk(){this.oH.getVersionSelectedEvent().addListener(t=>{this.w4=t.currentVersion;this.GBb=t.baseVersion;if(this.fY&&this.w4.DownloadUrl.length)try{this.gLh(),this.Xeg(),this.fY.onVersionSelected(t.currentVersion,t.baseVersion,this.kYa),this.gXk(),this.lGf()}catch(S){r.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",S)}})}gXk(){const t=this.h7b(2);t&&(id.a.addHandler(t,ha.a.Xf,Object(n.a)(this,
this.aA,"keyDownHandler")),nl.a.instance.pb(t,Object(n.a)(this,this.oC,"contextMenuHandler")))}tDl(){const t=this.h7b(2);t&&(id.a.removeHandler(t,ha.a.Xf,Object(n.a)(this,this.aA,"keyDownHandler")),nl.a.instance.yb(t,Object(n.a)(this,this.oC,"contextMenuHandler")))}aA(t){try{if(t.shiftKey&&t.keyCode===ua.a.Dpa||t.keyCode===ua.a.wMa){const S=Ui.a.create(ha.a.contextMenu,t,1);this.oC(S)}}catch(S){r.ULS.sendTraceTag(512508626,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",S)}}oC(t){if(1===
t.Wf){const S=this.h7b(2);S&&(t.clientPoint.x=Pc.a.URc(S)+Zb.a.gsa,t.clientPoint.y=Pc.a.VRc(S)+Zb.a.gsa)}return 32===this.ia.La(Va.a.bJf,2,t)}GVk(){this.oH.getDownloadTokenReadyEvent().addListener(t=>{try{if(r.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.GBb)if(t&&t.updatedVersions&&2<=t.updatedVersions.length){let S=null,la=null;const Ca=jn.t6b(this.w4),Na=jn.t6b(this.GBb);for(const qb of t.updatedVersions){const Pb=jn.t6b(qb);Ca===Pb?S=qb:
Na===Pb&&(la=qb);if(S&&la)break}S&&la?(this.w4=S,this.GBb=la,this.fY.diff(this.w4,this.GBb)):r.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ca,Na)}else r.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");else r.ULS.sendTraceTag(512508624,822,
50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(S){r.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",S)}})}KVk(){this.oH.getSaveACopySelectedEvent().addListener(t=>{r.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",t);this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&jn.Rqk();let S=v.AFrameworkApplication.wAb;this.Ha.ka("VHSaveACopyForOdcOnSpoEnabled")&&
(S=32===this.ia.processAction(Va.a.Dmc,1));t=S?this.ia.La(Va.a.Dmc,2,{["FileDownloadUrl"]:t}):this.ia.La(u.a.xjb,2,{["FileDownloadUrl"]:t});32!==t?(Za.c(Va.a.WVd,!1),r.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",t)):Za.c(Va.a.WVd,!0)})}iEh(t,S){try{(new Promise((la,Ca)=>{this.oH.setRestoreInProgress();this.Xea.wKc(this.Xa.Kk,this.Xa.podSessionId,this.Xa.presentationId.string,this.Ha.getSetting("361"),this.Xa.jaa,!1,!0,()=>{la(!0)},Na=>{Ca("ClosePopWacSessionSync:: "+
Na.error.message)})})).then(()=>{(new Promise((la,Ca)=>{this.Xea.Omd(this.Xa.presentationId.string,t,()=>{la(!0)},Na=>{Ca("RestoreFileVersion:: "+Na.error.message)})})).then(()=>{const la=Date.now()-S;r.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",la);this.nFb.RestoreSucceededTime=la;this.ia.La(Va.a.refresh,2,{["IsSourceVH"]:!0});Za.c(Va.a.p0b,!0)}).catch(la=>{const Ca=Date.now()-S;this.oH.setRestoreFailedAtServer(()=>{this.ia.La(Va.a.refresh,
2,{["IsSourceVH"]:!0})});r.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",la,Ca);this.nFb.RestoreFailedTime=Ca;Za.c(Va.a.p0b,!1)})})}catch(la){r.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",la.message),Za.c(Va.a.p0b,!1)}}JVk(){this.oH.getRestoreVersionSelectedEvent().addListener(t=>{r.ULS.sendTraceTag(512508615,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",
t);const S=Date.now();this.tE?(this.Rre=this.tE.i5b(),0<this.Rre.length?(r.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.Rre.length),Za.c(Va.a.p0b,!1),this.oH.setCoauthRestoreError(),this.Ha.ka("PPTVersionHistoryRestoreSurveyEnabled")&&jn.L_j()):this.iEh(t,S)):(r.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.iEh(t,S))})}HVk(){this.oH.getDownloadVersionSelectedEvent().addListener(t=>{r.ULS.sendTraceTag(512508612,
832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");t=new If.QueryStringBuilder(t);t.Xg(vh.a.X9g,v.AFrameworkApplication.fileName);t=this.ia.La(u.a.downloadACopy,2,{["FileDownloadUrl"]:t.toString()});32!==t?(Za.c(Va.a.VVd,!1),r.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",t)):Za.c(Va.a.VVd,!0)})}gLh(){for(const t of this.P9c){const S=t.TelemetryEventKey?t.TelemetryEventKey:t.telemetryEventKey?t.telemetryEventKey:"",la=t.TelemetryEventData?
t.TelemetryEventData:t.telemetryEventData?t.telemetryEventData:"";cb.a.Wa(S)||cb.a.Wa(la)||(this.kYa[S]=la)}}lGf(){this.P9c=[];this.kYa={}}EVk(){this.oH.getCloseSelectedEvent().addListener(()=>{this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&jn.K_j();this.WGf()})}WGf(){this.uKi();this.Fa.a1("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Ha.Szf&&(this.w4=null);r.ULS.sendTraceTag(512508610,822,50,Wd.c(this.nFb))}Klh(t){try{if(this.fY)Oe.setIsPageLoadForFirstTime(!1),
this.fY.switchParentViewContainer(t);else{Oe.setIsPageLoadForFirstTime(!0);const S=new PowerPointVersionHistory.AppBootSettings;S.RenderServiceBase="";S.IsRtl=v.AFrameworkApplication.isRtl;const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(n.a)(this.Ew,this.Ew.cYd,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(n.a)(this,this.kGi,"createNotesIcon");la.addToF6LoopCallback=Object(n.a)(this,this.d9h,"addToF6Loop");la.copySlideCallback=Object(n.a)(this,
this.copySlideCallback,"copySlideCallback");la.reportViewerErrorCallback=Ca=>{this.nFb[Ul.eCf]=Ul.x7f().MKl.ga(Ca);106!==Ca&&103!==Ca||this.oH.setViewerError(!0);r.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",Ca);0!==Ca&&(v.AFrameworkApplication.zp(Cj.a.Vh(406)),Tf.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};S.IsHighContrast=!1;this.Di&&(S.IsHighContrast=this.Di.isInHighContrastMode);S.IsHighContrast&&(S.ClientColorSettings=
this.Di.highContrastColors.foregroundTextColor+"_"+this.Di.highContrastColors.backgroundColor+"_"+this.Di.highContrastColors.linkColor);if(this.oc){const Ca=this.oc.iTa();S.DefaultSlideWidth=Ca.width;S.DefaultSlideHeight=Ca.height}S.UserSessionId=v.AFrameworkApplication.userSessionId;S.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;S.ProgressImageResourceUrl=Qe.a.ZK(Zb.a.Zna);S.ThumbnailShareOptimizationEnabled=this.Ha.pptvhThumbnailShareOptimizationEnabled;S.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,
{SlidePrefetchEnabled:this.Ha.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ha.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ha.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ha.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ha.getSetting("PPTVHSlidePrefetchDelay")});S.FileExtension=void 0!==this.Ha.MJa&&null!==this.Ha.MJa?cb.a.pQ(this.Ha.MJa).toLowerCase():"";S.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;S.NotesButtonLabel=
ResourceStrings.L_Notes;S.SynchronizerTimeout=this.Ha.getSetting("PptVersionHistorySynchronizerTimeout");S.IsRtl=v.AFrameworkApplication.isRtl;S.IsCopySlidesEnabled=!0;S.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;S.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;S.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;S.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;S.Lcid=v.AFrameworkApplication.lcid;S.EnableOverflowXOnSlideAndNotePane=this.Ha.ka("PodVHEnableOverflowXOnSlideAndNotePane");
S.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;S.IsModernCatchUpUxEnable=!0;S.IsRevisionTrackingFlyoutEnabled=Ab.a("EnableRevisionTrackingFlyoutForVH");S.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.fY=new PowerPointVersionHistory.AppVersionController(S,t,la)}}catch(S){this.oH.setViewerError(!0),r.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",S)}}kGi(){return Ba.createClusteredImage(14,
14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}pkb(){const t=this.Fa.Fc("VersionHistoryOverlay");t.parent=Ma.AFrame.hj;t.dJ=!0;t.gTe=!0;t.kca(S=>{S&&"dialog/modal"===S.name?this.oH.setSaveACopyCanceled():S&&S.name===Ma.AFrame.ZO||(this.kva=-1,this.eFh(!0))});this.Pg.P2("VersionHistoryOverlay");this.Pg.yqc(ad.a.QPb,S=>{this.eFh(S)});this.Pg.eMb(ad.a.QPb,()=>{2===this.kva&&Sys.UI.DomElement.addCssClass(this.h7b(2),"PPTVHViewerElementSelected");3===this.kva&&Sys.UI.DomElement.addCssClass(this.h7b(3),
"PPTVHViewerElementSelected")})}eFh(t){try{const S=this.rVc();(this.kva=this.Vej(t))?1===this.kva?this.zDe.then(la=>{la.enterHeaderFocusTrapZone();return null}):S&&gc.FocusManager.Wr(document.getElementById(S[this.kva])):this.zDe.then(la=>{la.enterFocusTrapZone();return null})}catch(S){r.ULS.sendTraceTag(512508579,822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",S)}}Vej(t){const S=this.rVc();let la=this.kva;do if(t?S&&(la=(la+1)%S.length):S&&(la=0<la?la-1:S.length-1),!la||
1===la||S&&"none"!==document.getElementById(S[la]).style.display)return la;while(la!==this.kva);return 0}Xeg(){const t=jn.t6b(this.w4);this.rcd[t]||(this.rcd[t]=["VersionListPane","vhHeader"],this.kva=-1)}rVc(){if(!this.w4)return this.Ha.Szf?["VersionListPane","vhHeader"]:null;const t=jn.t6b(this.w4);return this.rcd[t]?this.rcd[t]:null}h7b(t){const S=this.rVc();return S&&S.length>t?document.getElementById(S[t]):null}d9h(t){try{const S=this.rVc();S&&S.push(t)}catch(S){r.ULS.sendTraceTag(512508578,
822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",S)}return!0}copySlideCallback(t){if(this.nvh())return!1;const S=Kc.a.create().toString();r.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",S);const la=this.mO.PLc(1,t.SlideIds.length),Ca={};Ca.WacSessionId=v.AFrameworkApplication.userSessionId;Ca.CallerCorrelationId=S;var Na={};Na.Source=t.Source;Na.SlideIds=t.SlideIds;Na.CcpId=la.Jp;Na.PackageAccessKey=la.Cy;t=JSON.stringify(Na);Na=String.format("{0}{1}",
this.Ha.podsWebServiceBase,"vhcopyslide.ashx");const qb=Date.now();try{if(this.Ds.nj(Na,2,t,Ca,!1,0,Pb=>{jn.rKl(Pb,qb,S)},Pb=>{jn.qKl(Pb,qb,S)},null,null),this.Vg.contentWindow&&this.Vg.contentWindow.document&&this.Vg.contentWindow.document.body){Ac.a.j0b(this.Vg);const Pb=Ac.a.Eca();Pb.innerText=Ac.a.O0g;Pb.setAttribute(Kp.a.Jp,la.Jp);Pb.setAttribute(Kp.a.tD,la.tD);Pb.setAttribute(Kp.a.count,la.objectCount.toString());const xc=nr.a(la.dataType);Pb.setAttribute(Kp.a.type,xc);Pb.setAttribute(Kp.a.location,
la.location);Pb.setAttribute(Kp.a.Cy,la.Cy);this.Vg.contentWindow.document.body.appendChild(Pb);this.Kqe.Q_a(this.Vg);this.JFb.copy(this.Vg)}else r.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Pb){r.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",Pb)}return!0}nvh(){return(v.AFrameworkApplication.BM||v.AFrameworkApplication.iG)&&!v.AFrameworkApplication.ORa}dispose(){document.getElementById("VersionHistoryOverlay")&&
"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.WGf();this.tDl()}static t6b(t){return t.RevisionID?t.RevisionID:t.revisionID?t.revisionID:""}static rKl(t,S,la){const Ca=Date.now();try{JSON.parse(t.data.Wd).IsCopied?r.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",Ca-S,la):r.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",Ca-S,la)}catch(Na){r.ULS.sendTraceTag(512508572,
832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Na,la)}}static qKl(t,S,la){const Ca=Date.now();r.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",Ca-S,t.data?t.data.ie:-1,la)}static K_j(){const t=A.a.instance.rb("Common.ISystemInitiatedFeedback");t?(t.logActivity("VersionHistoryExited",null),t.logActivity("VersionHistoryCheckExited",null)):r.ULS.sendTraceTag(512508570,822,
50,"ISystemInitiatedFeedback was null")}static Rqk(){const t=A.a.instance.rb("Common.ISystemInitiatedFeedback");t?t.logActivity("VersionHistoryExited",null):r.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static L_j(){const t=A.a.instance.rb("Common.ISystemInitiatedFeedback");t?t.logActivity("VersionHistoryRestoreCoauthFailed",null):r.ULS.sendTraceTag(512508568,822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}Object(h.a)(jn,"VersionHistoryPaneActor",
null,[670,106]);class js{constructor(){this.vCc=this.Da=null}get name(){return"PowerPointWebEditor.VersionHistory"}Zb(t){this.Da=t}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){v.AFrameworkApplication.g1c()?this.Da.resolve("PowerPointWebEditor.IApplicationSettings").F_c?r.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):(r.ULS.sendTraceTag(39711108,
202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),Pa.a.get_instance().Uj(7,()=>{qn.a(this.Da)("versionHistory").catch(t=>r.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",t)).then(()=>this.HAk()).catch(t=>r.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",t))})):r.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}HAk(){this.x1b();
return null}x1b(){this.Da.register(jn,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").oa(()=>new jn(v.AFrameworkApplication.Ta,this.Da.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Da.resolve("Common.Utils.IHighContrastDetector"),this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Da.resolve("PowerPointWebEditor.IPresentationReader"),gc.FocusManager.instance(),aq.a.instance,this.Da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Da.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Da.resolve("PowerPointWebEditor.IPopWebService"),this.Da.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Da.Ja("PowerpointPresence.IPresenceManager"),this.Da.resolve("PowerPointWebEditor.IClipServiceManager"),this.Da.resolve("PowerPointWebEditor.IDesignModeManager").tCa,this.Da.resolve("PowerPoint.IBrowserHelperManager"),this.Da.resolve("PowerPointWebEditor.ISystemClipboard"),v.AFrameworkApplication.Ke)).ma();this.vCc=this.Da.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");
this.vCc.wb()}dispose(){this.vCc&&this.vCc.dispose()}}Object(h.a)(js,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var ot=d(458),ks=d(732),ri;(function(t){t[t.anyone=0]="anyone";t[t.organization=1]="organization"})(ri||(ri={}));Object(h.b)("AccessControlEnum",ri);var bq=d(382);class to{constructor(){this.token=this.timeStamp=null}}Object(h.a)(to,"CachedAccessToken",null,[]);class uo{constructor(t){this.Nqe={};this.o9j=t}Woi(t,S){if(!cb.a.Wa(t)&&!cb.a.Wa(S)){const la=new to;la.token=S;la.timeStamp=
new Date;this.Nqe[t]=la}}a0f(t){return t in this.Nqe&&(t=Object(D.a)(to,this.Nqe[t]),+new Date-+t.timeStamp<6E4*this.o9j)?t.token:null}}Object(h.a)(uo,"AccessTokenCache",null,[]);class kp{constructor(){this.reject=this.resolve=this.frame=this.Ofa=this.s6e=this.resource=this.appId=this.authority=this.id=null;this.Clb=0;this.FSe=null;this.gmc=0;this.mFh=!1}}Object(h.a)(kp,"DirectAuthRequest",null,[]);class or{constructor(t){this.Cgc={};this.la=t;this.TFb=new uo(this.la.nIk);window.addEventListener("message",
Object(n.a)(this,this.C2k,"requestCompletionMessageHandler"),!1)}h3f(t){const S={},la=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Ca;for(;Ca=la.exec(t);)S[Object(D.a)(String,Ca[1])]=Object(D.a)(String,Ca[2]);return S}C2k(t){if("data"in t){var S;({sv:S}=Wd.d(t.data)).returnValue&&S&&"DirectAuthRequestID"in S&&this.Wxb(S)}}Wxb(t){try{const Ca=t.DirectAuthRequestID;if(Ca in this.Cgc){var S=null,la=Object(D.a)(kp,this.Cgc[Ca]);if(la&&la.id===Ca){P.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",
Ca,"Timeouted"in t,"FromPolling"in t);window.clearTimeout(la.Clb);delete this.Cgc[Ca];window.clearTimeout(la.gmc);const Na=new bq.a;Na.IsSuccess=!1;Na.ErrorCode="";Na.ErrorMessage="";Na.Token="";"Timeouted"in t?(P.a.J(592238722,833,10,"DirectAuth: Request timed out with host: "+window.location.host),Na.ErrorCode="Timeout",Na.ErrorMessage="No response received in time for the authentcation request",la.resolve(Na)):"PopupWindowClosed"in t&&la.Ofa?(Na.ErrorCode="User_aborted",Na.ErrorMessage="User aborted log in by closing the popup window",
la.resolve(Na)):(la.frame?S=this.h3f(la.frame.contentWindow.location.hash):la.Ofa&&!la.Ofa.closed&&(S=this.h3f(la.Ofa.location.hash)),"access_token"in S?(Na.IsSuccess=!0,Na.Token=Object(D.a)(String,S.access_token),this.TFb&&this.TFb.Woi(la.FSe,Na.Token),la.resolve(Na)):(Na.ErrorCode="error"in S?Object(D.a)(String,S.error):"unknown",0<=Array.indexOf(this.la.pIk,Na.ErrorCode)&&la.mFh&&la.frame&&!la.Ofa?this.OHk(la.authority,la.appId,la.resource,la.s6e,this.la.qIk).then(qb=>{la.resolve(qb)}).catch(qb=>
{la.reject(qb)}):(Na.ErrorMessage="error_description"in S?Object(D.a)(String,S.error_description):"unknown",la.resolve(Na))));la.frame?document.body.removeChild(la.frame):la.Ofa&&!la.Ofa.closed&&la.Ofa.close()}else P.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Ca)}else P.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(t))}catch(Ca){P.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
Ca.message)}}fLc(t){const S=window.location.protocol,la=window.location.host;P.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",S,la,"ffc-powerpoint.officeapps.live.com"===la||"ppc-powerpoint.officeapps.live.com"===la);if(void 0===t||null===t){t=window.location.pathname;const Ca=t.lastIndexOf("/");t=0<=Ca?t.substring(0,Ca+1):""}return S+"//"+la+t+"WacDirectAuth.html"}JAl(t,S,la,Ca,Na,qb=!1){return this.Kol(t,S,la,Ca,Na,qb)}OHk(t,S,la,Ca,Na){if(cb.a.Wa(t))throw Error.argumentNull("authority");
if(cb.a.Wa(S))throw Error.argumentNull("appId");if(cb.a.Wa(la))throw Error.argumentNull("resource");if(cb.a.Wa(Ca))throw Error.argumentNull("userUPN");const qb=!cb.a.Wa(Ca)&&Ca.indexOf("@")<Ca.indexOf("."),Pb=this.fLc("/p/"),xc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",t,S,encodeURIComponent(la),encodeURIComponent(Pb));if(this.TFb){const fd=this.TFb.a0f(xc);if(!cb.a.Wa(fd))return P.a.J(593782154,
833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(we=>{const Sf=new bq.a;Sf.IsSuccess=!0;Sf.ErrorCode="";Sf.ErrorMessage="";Sf.Token=fd;we(Sf)})}const ed=Kc.a.create().toString(),dd=String.format("{0}&state={1}",xc,ed);return new Promise((fd,we)=>{const Sf=new kp;Sf.authority=t;Sf.appId=S;Sf.resource=la;Sf.s6e=Ca;Sf.resolve=fd;Sf.reject=we;Sf.id=ed;Sf.FSe=xc;Sf.Ofa=window.open("",ed,"width=400, height=600");Sf.Ofa?(this.Cgc[ed]=Sf,Sf.Ofa.location.replace(dd),P.a.J(593782152,833,
50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",ed,qb),this.Vyh(Sf,1E3*Na).then(()=>{const Ff={};Ff.DirectAuthRequestID=ed;Ff.FromPolling=!0;this.Wxb(Ff)}).catch(Ff=>{"WindowClosed"===Object(D.a)(String,Ff)&&(Ff={},Ff.DirectAuthRequestID=ed,Ff.PopupWindowClosed=!0,P.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+ed),this.Wxb(Ff))}),Sf.Clb=window.setTimeout(()=>{const Ff={};Ff.DirectAuthRequestID=ed;Ff.Timeouted=!0;P.a.J(593782148,833,
10,"DirectAuth: Popup request timedout with ID of: "+ed);this.Wxb(Ff)},1E3*Na)):(P.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",ed),we=new bq.a,we.IsSuccess=!1,we.ErrorCode="fail_to_open_popup",we.ErrorMessage="Failed to create popup window!",we.Token="",fd(we))})}Kol(t,S,la,Ca,Na,qb){if(cb.a.Wa(t))throw Error.argumentNull("authority");if(cb.a.Wa(S))throw Error.argumentNull("appId");if(cb.a.Wa(la))throw Error.argumentNull("resource");if(cb.a.Wa(Ca))throw Error.argumentNull("userUPN");
const Pb=!cb.a.Wa(Ca)&&Ca.indexOf("@")<Ca.indexOf(".");var xc=this.fLc("/p/");const ed=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",t,S,encodeURIComponent(la),encodeURIComponent(xc));if(this.TFb){const we=this.TFb.a0f(ed);if(!cb.a.Wa(we))return P.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Sf=>{const Ff=new bq.a;Ff.IsSuccess=!0;Ff.ErrorCode="";
Ff.ErrorMessage="";Ff.Token=we;Sf(Ff)})}const dd=Kc.a.create().toString();xc=Pb?String.format("{0}&login_hint={1}&state={2}",ed,encodeURIComponent(Ca),dd):String.format("{0}&state={1}",ed,dd);const fd=document.createElement("iframe");fd.style.display="none";fd.src=xc;return new Promise((we,Sf)=>{const Ff=new kp;Ff.authority=t;Ff.appId=S;Ff.resource=la;Ff.s6e=Ca;Ff.frame=fd;Ff.resolve=we;Ff.reject=Sf;Ff.id=dd;Ff.FSe=ed;Ff.mFh=qb;document.body.appendChild(fd);P.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",
dd,Pb);this.Vyh(Ff,1E3*Na).then(()=>{const Gh={};Gh.DirectAuthRequestID=dd;Gh.FromPolling=!0;this.Wxb(Gh)});Ff.Clb=window.setTimeout(()=>{const Gh={};Gh.DirectAuthRequestID=dd;Gh.Timeouted=!0;P.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+dd);this.Wxb(Gh)},1E3*Na);this.Cgc[dd]=Ff})}Vyh(t,S){return new Promise((la,Ca)=>{const Na=S/50;let qb=0;t.gmc=window.setInterval(()=>{try{qb++>Na&&(window.clearInterval(t.gmc),P.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",
S,Na),Ca(""));const Pb=t.frame?t.frame.contentWindow:t.Ofa;if(!Pb||Pb.closed)window.clearInterval(t.gmc),P.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),Ca("WindowClosed");let xc=null,ed=null;try{xc=Pb.location.href,ed=Pb.location.hash}catch(dd){}xc&&"about:blank"!==xc?cb.a.Wa(ed)||(window.clearInterval(t.gmc),la(ed)):P.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===xc)}catch(Pb){P.a.J(594068384,
833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Pb.message)}},50)})}}Object(h.a)(or,"DirectAuthHelper",null,[]);class pr{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=
this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(h.a)(pr,"ILiveActorSettings",null,[]);class Ck{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(h.a)(Ck,"ILiveReaction",null,[]);class qr{constructor(){this.isPaused=this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(h.a)(qr,"ILiveSessionState",
null,[]);class Mq{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(h.a)(Mq,"ILiveSessionURL",null,[]);class Lp{constructor(){this.oLg=this.nLg=null}}Object(h.a)(Lp,"PollObjectInfo",null,[]);var Mp;(function(t){t[t.none=0]="none";t[t.singleLineRibbon=1]="singleLineRibbon";t[t.multipleLineRibbon=2]="multipleLineRibbon";t[t.slideShowToolbar=3]="slideShowToolbar";t[t.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";t[t.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(Mp||(Mp=
{}));Object(h.b)("LiveEntryPoint",Mp);var cq;(function(t){t[t.none=0]="none";t[t.callout=1]="callout";t[t.businessBar=2]="businessBar";t[t.pausedSessionTimeout=3]="pausedSessionTimeout";t[t.slideshowContextMenu=4]="slideshowContextMenu";t[t.accessControlChange=5]="accessControlChange";t[t.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(cq||(cq={}));Object(h.b)("LiveExitPoint",cq);var ig=d(678);class rr{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff){this.va=new bm.a;this.NGa=this.zCb=this.w5c=
this.Sue=this.yyg=!1;this.Odc=this.Eue=this.z5c=!0;this.Ygc=this.CFb=!1;this.Sp=this.sj=this.lea=this.Zn=null;this.PVa=0;this.QDb=-1;this.VEb=30;this.Ifc=-1;this.Gd=this.Lma=this.c0=null;this.OTg=this.ZXg=this.Jad=this.Fad=0;this.icc=this.Qua=this.KVa=null;this.Eye=this.Lcb=0;this.Pkb=null;this.$Ce=new Set;this.ZCe=new Map;this.m8c=null;this.Yfc=1;this.Hfc=this.N4c=this.HO=this.hna=this.bGb=this.vse=null;this.qe=Ca;this.la=t;this.Iyg=!1;this.kb=la;this.oc=qb;this.kq=Pb;this.Oc=xc;this.sz=ed;this.Xa=
dd;this.Hc=fd;this.Ll=we;this.vXa=Sf;this.Fa=Ff;if(this.ut=S)this.lea=S.FF();this.eM=Na;this.PVa=this.mVf?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.vse=new or(this.la));this.Oc.iC(Object(n.a)(this,this.gaa,"onPodSessionRehydrated"));this.sz.hQd(Object(n.a)(this,this.yHb,"onPodSessionUnavailable"));this.bSa()&&this.Ll.execute(Gh=>{Gh.show(ResourceStrings.L_LivePresentations_Disconnected,ig.a.ZGb);Gh.hide()});P.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get vr(){return this.la.powerPointLiveBroadcastEnabled&&
this.z5c}get M8a(){return this.Sue}set M8a(t){(this.Sue=t)&&this.va.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get dr(){return!!this.Sp}get $ca(){return this.Iyg}set $ca(t){this.Iyg=t}get CDa(){return this.yyg}set CDa(t){this.yyg=t}get eSa(){return!!this.Sp&&this.Sp.isPaused}get xWi(){return this.w5c}get DDa(){return this.Odc}set DDa(t){this.Odc=t}get iWi(){return this.M8a&&this.vr&&!!this.Zn}get accessControl(){return this.PVa}set accessControl(t){this.PVa=t}get mVf(){return"true"===
this.o6f("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get hVf(){return this.vr&&this.dr&&this.sj?this.sj.isWelcomeScreenVisible():!1}Jvb(){return this.la.isMicButtonInSlideShowToolbarEnabled&&this.la.gjd&&this.Hc.a4b?this.Hc.Lvb?this.Ygc=!0:this.Hc.yVf||this.Ygc:!0}Mgd(t,S,la,Ca,Na,qb,Pb,xc,ed){if(this.vr){this.kb.aQd(Object(n.a)(this,this.l7g,"onSlideShowEnterEndOfShow"));this.kb.cQd(Object(n.a)(this,this.m7g,"onSlideShowLeaveEndOfShow"));this.kb.XGc(Object(n.a)(this,this.$wa,"onGetCurrentSlideDimensionsHandler"));
this.zCb=!1;this.NGa=!0;try{this.la.ajd&&this.r3i();const dd=this.O8d(Na,Ca);if(this.Zn)(this.CDa||this.eSa)&&this.Zn.FetchDocumentDownloadURL(dd);else{P.a.J(512496259,833,50,"Creating Broadcast monitor ...");const fd=new PowerPointLive.PPTBroadcastMonitorSettings;fd.isBlueChicken=this.la.isBlueChicken;fd.fileDownloadUrl=dd;fd.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;fd.broadcastSubtitlesFromSpeechFrontDoor=!0;fd.pragueInitTimeoutInMS=this.la.sIk;fd.preferredSubtitleLanguage=
this.Hc.qVc();fd.useStateService=this.la.BIk;fd.numMaxAttempts=this.la.vIk;fd.delayInSecsToCloseBroadcasterOnPause=this.la.mIk;fd.batchedRequestsEnabled=this.la.jIk;fd.sharedSessionSettings={};fd.websocketAliveTimeAfterLoseFocusInMs=this.la.CIk;fd.pingTimeoutInMs=this.la.tIk;fd.pongTimeoutInMs=this.la.uIk;fd.enableTransientSessionHandling=this.la.XIk;fd.maxStateServiceRoundtripRaw=v.AFrameworkApplication.fa.Bc("PPTLiveMaxStateServiceRoundtripRaw",300);fd.sharedSessionSettings.MaxStateServiceRoundtripRaw=
fd.maxStateServiceRoundtripRaw;fd.documentSnapshotRequestUrlGenerator=this.la.UIk?()=>this.O8d(this.Xa.podSessionId,this.Xa.qk):null;this.la.ybh&&(fd.sharedSessionSettings.IsAutomation=!0);this.Zn=new PowerPointLive.PPTBroadcastMonitor(fd);this.Zn.RegisterParticipantsCountChangeEventListener(we=>{this.Gd.telemetryData.maxParticipantCount=Math.max(this.Gd.telemetryData.maxParticipantCount,we);this.sj&&this.sj.setParticipantCount(we);this.va.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});
this.Zn.RegisterNewReactionEventListener(Object(n.a)(this,this.qpk,"newReactionHandler"));this.Zn.RegisterConnectionStateEventListener(Object(n.a)(this,this.Xzi,"connectionStateHandler"))}this.Zn.SetCurrentPosition(t,S-1,null);this.Lcb=t;this.CDa&&!this.Sp&&ed?(this.qsc(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.Pp?1:2,Pb,la,Na,xc),this.twi(t),this.Qua=new Set):this.c0&&this.nyb();this.Qua&&this.Qua.add(t)}catch(dd){P.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",
dd.toString())}}}Jzl(){window.setTimeout(()=>{const t=this.Lcb===this.Eye;this.vr&&this.dr&&t&&this.Sp&&!this.Sp.isPaused&&(P.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.zud(0),this.SOb(0))},6E4*this.la.xIk)}Azk(){this.vr&&(this.kb.GRe(Object(n.a)(this,this.l7g,"onSlideShowEnterEndOfShow")),this.kb.IRe(Object(n.a)(this,this.m7g,"onSlideShowLeaveEndOfShow")),this.kb.Yld(Object(n.a)(this,this.$wa,"onGetCurrentSlideDimensionsHandler")),this.NGa=
this.zCb=!1,this.dr&&this.sj&&(this.sj.hideAll(),this.qme()||(this.wFk(),this.inl()),this.bSa()&&this.Ll.instance.hide()))}Krl(t,S,la,Ca,Na,qb){try{const Pb=new PowerPointLive.RendezvousSessionConfig;Pb.userSessionId=t;Pb.webServiceBase=S;Pb.podSessionId=la;Pb.docId=Ca;Pb.sessionId=Na;Pb.accessControl=1===this.PVa?"organization":"anyone";Pb.authTokenFunc=qb;Pb.locale=v.AFrameworkApplication.uiCulture;Pb.presentationName=cb.a.XG(v.AFrameworkApplication.fileName);Pb.slideHeight=this.oc.Hu().height;
Pb.slideWidth=this.oc.Hu().width;Pb.correlationId=this.Gd.telemetryData.correlationId;Pb.showQRCodeAfterFetchingDocDownloadUrl=this.la.dJk;Pb.presenterTenantId=!this.la.isBlueChicken&&this.la.Kbh?v.AFrameworkApplication.fa.Ga("TenantId"):null;Pb.fileSource=v.AFrameworkApplication.fa.Ga("FileHost");this.la.zIk||(Pb.fileName=v.AFrameworkApplication.fileName,Pb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const xc=this.Zn.StartLiveBroadcasting(Pb,this.Gd,!this.la.gMe);this.iGj();if(xc){this.Sp=
new qr;this.Sp.isPrivate=1===this.PVa;this.Sp.isPaused=!1;this.Sp.participantsCount=0;this.Sp.sessionCurrentState=0;const ed=xc.then(dd=>{const fd=new Mq;fd.participantUrl=dd.sessionInfo.shortParticipantUrl;fd.sessionQRCode=dd.sessionInfo.sessionQRCode;this.Sp.sessionCurrentState=1;return fd});this.Sp.sessionURLPromise=ed;this.la.hjd?this.Hfc.then(()=>{this.sj.actOnSessionRequested(this.Sp)}):this.sj.actOnSessionRequested(this.Sp);this.kb.aHc(Object(n.a)(this,this.n7g,"onSlideShowReady"));this.kb.qvf(Object(n.a)(this,
this.onTranscriberStarted,"onTranscriberStarted"));this.kb.dQd(Object(n.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));xc.then(dd=>{this.Gd.telemetryData.pragueDocId=dd.sessionInfo.pragueDocId;this.Gd.telemetryData.sessionCreationWebServiceCallTimeInMS=this.mL()-this.Jad;this.Gd.telemetryData.startAttemptCount=dd.numAttempt;P.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Gd.telemetryData.sessionId,this.Gd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());
this.la.gMe?(this.sqc(),this.Zn.InitializeStateService().then(()=>{this.zth(dd);this.Y_("StartLiveBroadcasting")}).catch(fd=>{this.Gd.telemetryData.sessionEndedBeforePragueInitialized||this.Gd.telemetryData.sessionId!==Na||(P.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Gd.telemetryData.sessionId,fd?fd.toString():""),this.Gd.telemetryData.SetErrorCode(2,fd?fd.toString():""),this.Y_("StartLiveBroadcasting"),this.wrd())})):this.zth(dd);
this.la.WIk&&$addHandler(window,"visibilitychange",Object(n.a)(this,this.mxk,"onPageVisibilityChangedHandler"));this.Y_("StartLiveBroadcasting")}).catch(dd=>{P.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,dd.toString());this.Gd.telemetryData.SetErrorCode(4,dd.toString());this.Y_("StartLiveBroadcasting");this.wrd()})}else this.wrd(),this.Gd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),P.a.J(512496225,
833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Pb){this.wrd(),this.Gd.telemetryData.SetErrorCode(4,Pb.toString()),P.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Gd.telemetryData.sessionId,Pb.toString())}finally{this.Y_("StartLiveBroadcasting")}}zth(t){const S=this.Hc.y6i(this.Hc.Zoa);S?this.Zn.SetDefaultSubtitlesLanguage(S):P.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",
this.Gd.telemetryData.sessionId);this.kb.FOb(!0,this.Zn.GetPragueSessionInfoJSONString());this.kb.IPa(Object(n.a)(this,this.Ykc,"onSlideShowPositionChanged"));this.kb.ovf(Object(n.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.gMe&&!this.sj.isWelcomeScreenVisible()||this.sqc();this.va.raiseEvent("OnLiveSessionStarted",t.sessionInfo);this.Jvb()||!this.Hc.a4b||this.Hc.yVf||this.Ygc||!this.bSa()||(this.CFb=!0,this.Ll.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",
Uh.a.xe(v.AFrameworkApplication.uiCulture).displayName),ig.a.ZGb));this.icc=this.Zn.CreateSurvey(t.authToken,null,null,null);this.icc.then(la=>{if(la){const Ca={};Ca.surveyeeName=v.AFrameworkApplication.userName;Ca.surveyId=la.surveyId;Ca.surveyResponseUrl=la.surveyResponseUrl;this.Zn.SetAudienceFeedbackInfo(JSON.stringify(Ca))}});this.la.ajd&&(this.ZCe.clear(),this.$Ce.forEach(la=>{try{const Ca=la.nLg;this.Zn.CreateSurvey(t.authToken,null,Ca,la.oLg).then(Na=>{Na?this.ZCe.set(Ca,Na.surveyId):P.a.J(512496222,
833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Gd.telemetryData.sessionId)}).catch(Na=>{P.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,Na.toString());this.Gd.telemetryData.SetErrorCode(13,t.toString())})}catch(Ca){P.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Gd.telemetryData.sessionId,Ca.toString())}}));
this.vXa.init()?this.vXa.UPd(Object(n.a)(this,this.Fkc,"onNetworkConnectivityChanged")):P.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Gd.telemetryData.sessionId)}o6f(t){t=new RegExp(String.format("[\\?&]{0}=([^&#]*)",t));return(t=window.location.search.match(t))&&2===t.length?t[1]:""}qsc(t,S,la,Ca,Na){this.bGb=S;this.hna=la;this.HO=Ca;this.N4c=Na;this.Jad=this.mL();this.Fad=this.mL();var qb=this.o6f("wdSetLiveSessionId");qb="rdvSession_"+(qb.length?
qb:Kc.a.create().toString());this.Gd=new PowerPointLive.LiveSessionTelemetry;this.Gd.telemetryData.sessionId=qb;this.Gd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Gd.telemetryData.accessControl=ri[this.PVa];this.Gd.telemetryData.sessionEntryPoint=Mp[t];this.Gd.telemetryData.isSubtitleStartedByLive=this.$ca;this.Gd.telemetryData.isAutomation=this.la.ybh;this.Gd.telemetryData.correlationId=Kc.a.create().toString();this.Y_("StartLiveBroadcasting");try{this.vr&&
this.Zn&&this.J3b()&&!this.Sp?(this.G1j(),this.kb.WYb(Object(n.a)(this,this.B4g,"onGetCurrentSlideShowPosition")),this.kb.getCurrentPosition(),this.h3d()&&this.sj&&this.Hfc&&this.Hfc.then(()=>{this.sj.showOnboardingScreen();this.S6e=!0}),this.Krl(S,la,Ca,Na,qb,()=>this.n5b("StartLiveBroadcasting",this.Gd.telemetryData.sessionId))):(this.Gd.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),P.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),
this.Gd.telemetryData.isMordernSlideShow=!!this.kb&&this.kb instanceof ks.SlideShowCoreFrame}catch(Pb){this.Gd.telemetryData.SetErrorCode(4,Pb.toString()),P.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Gd.telemetryData.sessionId,Pb.toString())}finally{this.Y_("StartLiveBroadcasting")}}wFk(){if(this.vr&&this.dr&&this.Zn&&this.J3b()&&!this.Sp.isPaused){this.zud(2);this.SOb(2);try{this.Gd.telemetryData.sessionPauseCount+=1,this.Gd.telemetryData.sessionActiveDurationInMS+=
this.mL()-this.Fad,P.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Gd.telemetryData.sessionId),this.sj.actOnSessionPaused(),this.Sp.isPaused=!0,this.OTg=this.mL(),this.Zn.PauseLiveBroadcasting(()=>this.n5b("PauseLiveBroadcasting",this.Gd.telemetryData.sessionId)),this.va.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.Rrl(),this.kb.FOb(!1)}catch(t){this.Gd.telemetryData.SetErrorCode(5,t.toString()),P.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",
this.Gd.telemetryData.sessionId,t.toString())}finally{this.Y_("PauseLiveBroadcasting")}}}vmh(){if(this.vr&&this.dr&&this.Zn&&this.J3b()&&this.Sp.isPaused)try{this.Fad=this.mL(),this.Gd.telemetryData.sessionResumeCount+=1,P.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Gd.telemetryData.sessionId),this.Zlh(),this.sj.actOnSessionResumed(),this.Zn.ResumeLiveBroadcasting(()=>this.n5b("ResumeLiveBroadcasting",this.Gd.telemetryData.sessionId)),this.Sp.isPaused=!1,this.va.raiseEvent("OnLiveSessionResumed",
Sys.EventArgs.Empty),this.c0e(),this.kb.FOb(!0,this.Zn.GetPragueSessionInfoJSONString())}catch(t){this.Gd.telemetryData.SetErrorCode(6,t.toString()),P.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Gd.telemetryData.sessionId,t.toString())}finally{this.Y_("ResumeLiveBroadcasting")}}C3b(t){if(this.vr&&this.dr&&this.Zn&&this.J3b()){this.SOb(3);try{this.szl(t,()=>{this.Gd.telemetryData.sessionExitPoint=cq[t];this.Sp.isPaused||(this.Gd.telemetryData.sessionActiveDurationInMS+=
this.mL()-this.Fad);this.c0&&this.nyb();this.c0e();this.bSa()&&this.Ll.instance.hide();P.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Gd.telemetryData.sessionId);this.sj.actOnSessionEnded();this.kb.$ld(Object(n.a)(this,this.n7g,"onSlideShowReady"));this.kb.Rib(Object(n.a)(this,this.Ykc,"onSlideShowPositionChanged"));this.kb.Djh(Object(n.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.kb.Ejh(Object(n.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));
this.vXa.hjh(Object(n.a)(this,this.Fkc,"onNetworkConnectivityChanged"));this.kb.JRe(Object(n.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.NGa&&this.kb.FOb(!1);this.icc=this.Sp=null;this.va.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);this.la.gjd&&this.Hc.a4b&&(this.Ygc=this.CFb=!1);if(3!==t){const S=this.Zn.EndLiveBroadcasting(()=>this.n5b("EndLiveBroadcasting",this.Gd.telemetryData.sessionId));S?S.then(()=>{this.Y_("EndLiveBroadcasting");P.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",
this.Gd.telemetryData.sessionId)}).catch(la=>{this.Gd.telemetryData.SetErrorCode(7,la.toString());this.Y_("EndLiveBroadcasting");P.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,la.toString())}):(this.Gd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),P.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.Zn.CleanUpBroadcastBeforeEnd(),
P.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.Y_("EndLiveBroadcasting")})}catch(S){this.Gd.telemetryData.SetErrorCode(7),P.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Gd.telemetryData.sessionId,S.toString())}finally{3!==t&&this.Qlb(),this.Y_("EndLiveBroadcasting")}}}Arh(){this.vr&&this.Zn&&this.Zn.SetPresenterState("muted")}Brh(){this.vr&&this.Zn&&this.Zn.SetPresenterState("unmuted")}showCallout(t){this.vr&&
this.sj&&(this.w5c=!0,this.sj.showCallout(t))}showWelcomeScreen(){this.vr&&this.sj&&(this.sj.showWelcomeScreen(),this.rWe())}showEndSessionDialog(t,S){this.vr&&this.dr&&this.sj&&this.sj.showEndSessionDialogWithCallbacks(t,S)}wrd(){this.sj.isWelcomeScreenVisible()||this.Sp.isPaused||this.showWelcomeScreen();this.Sp=null;this.sj.onSessionRequestError()}J3b(){if(this.vr&&!this.sj&&this.lea){const t=new pr;t.hostElement=this.lea;t.baseZIndex=50005;t.welcomeScreenBackgroundImageUrl=this.qe.rk("LiveWelcomeScreenBackground.png");
t.welcomeScreenErrorImageUrl=this.qe.rk("LiveWelcomeScreenError.png");t.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";t.calloutContainerId="LiveCalloutContainer";t.urlBarLayerHostId="LiveURLBarLayerHost";t.dialogLayerHostId="LiveDialogLayerHost";t.reactionsBarLayerHostId="LiveReactionBarLayerHost";t.showTryAgainButton=!0;t.isPowerpointLiveReactionEnabled=!Ab.a("PPTLive.ReactionToggleInLiveCallout");t.onboardingScreenHostId="LiveOnboardingScreenLayerHost";t.resourceCDNPath=this.la.Rhb;t.enablePrefetchLiveResource=
this.la.hjd;t.enableNewLiveWelcomeScreen=this.la.hjd;t.userSessionId=this.bGb;t.podsUrl=this.hna;this.sj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(t);this.sj.on("OnWelcomeScreenOpenedAction",()=>{this.WKa("LiveWelcomeScreenLayerHost");this.rWe();this.ZXg=Date.now();this.Gd.telemetryData.welcomeShownCount+=1});this.sj.on("OnWelcomeScreenClosedAction",()=>{this.zCb&&this.sj.hideURLBar();this.gGf();this.kb.restoreFocus();this.Gd.telemetryData.welcomeScreenDurations.push(Date.now()-this.ZXg);this.Gd.telemetryData.welcomeScreenFirstTimeDuration=
this.Gd.telemetryData.welcomeScreenDurations[0];this.Y_("OnWelcomeScreenClosedAction");this.Zn.SetWelcomeScreenState(!1);this.la.ajd&&this.dEh();this.CFb&&this.bSa()&&window.setTimeout(()=>{this.Ll.instance.hide();this.CFb=!1},5E3)});this.sj.on("ResumeSessionAction",()=>{this.vmh();this.zCb||this.sj.showURLBar()});this.sj.on("EndSessionAction",()=>{this.C3b(this.NGa?1:2);this.kb.restoreFocus()});this.sj.on("OnCalloutOpenedAction",()=>{this.w5c=!0;this.va.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);
this.Gd.telemetryData.calloutShownCount+=1});this.sj.on("OnCalloutClosedAction",()=>{this.w5c=!1;this.va.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.kb.restoreFocus()});this.sj.on("OnEndSessionDialogOpenedAction",()=>{this.Qbl()});this.sj.on("OnEndSessionDialogClosedAction",()=>{this.t4k()});this.sj.on("OnCalloutMenuDefinitionChangedAction",()=>{this.va.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.sj.on("OnTryAgainAction",()=>{P.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",
this.Gd.telemetryData.sessionId);this.qsc(5,this.bGb,this.hna,this.HO,this.N4c)});this.sj.on("PresenterDisabledReactions",()=>{this.Eue=!1});this.sj.on("PresenterEnabledReactions",()=>{this.Eue=!0});this.sj.on("OnOnboardingScreenOpenedAction",()=>{this.WKa("LiveOnboardingScreenLayerHost");this.rWe()});this.sj.on("OnOnboardingScreenClosedAction",()=>{this.sqc()})}return!!this.sj}sqc(){this.sj&&(this.h3d()&&this.sj.isOnboardingScreenVisible()?this.WKa("LiveOnboardingScreenLayerHost"):this.sj.isWelcomeScreenVisible()?
this.WKa("LiveWelcomeScreenLayerHost"):(-1!==this.Ifc&&this.gGf(),this.kb.restoreFocus()))}LOj(){const t=document.getElementById("LiveWelcomeScreenLayerHost"),S=document.getElementById("LiveOnboardingScreenLayerHost");let la=!1;t&&(la=t.contains(document.activeElement));return document.activeElement===S||document.activeElement===t||la}rWe(){this.sj&&-1===this.Ifc&&(this.Ifc=window.setInterval(()=>{this.LOj()||this.sqc()},500))}gGf(){window.clearInterval(this.Ifc);this.Ifc=-1}WKa(t){this.lea&&this.sj&&
window.setTimeout(()=>{gc.FocusManager.Wr(this.lea.ownerDocument.getElementById(t))},50)}Qbl(){this.NGa?this.WKa("LiveDialogLayerHost"):(this.Fa.AXc(ad.a.fMe,ad.a.hj,document.getElementById("LiveDialogLayerHost")),this.Fa.Ej(ad.a.fMe,!0))}t4k(){this.NGa?this.kb.restoreFocus():this.Fa.Ej(ad.a.fMe,!1)}zag(){this.la.gjd&&this.Hc.a4b&&(this.bSa()&&this.CFb&&(this.Ll.instance.hide(),this.CFb=!1),this.Ygc=!0)}G1j(){try{this.Hfc||!this.h3d()&&!this.la.hjd||(this.Hfc=qn.a(A.a.instance)("liveActorLazy"))}catch(t){P.a.J(512496205,
833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Gd.telemetryData.sessionId,t.toString())}}n7g(){this.vr&&this.Zn&&(this.eSa?(window.setTimeout(()=>{this.va.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.vmh()):this.Sp&&this.sj&&this.sj.isWelcomeScreenVisible()&&this.sqc())}Ykc(t,S){this.vr&&this.Zn&&(this.Zn.SetCurrentPosition(S.slideId,S.slideIndex,S.Ptc),this.Lcb!==S.slideId&&this.Zlh(),this.Lcb=S.slideId,this.Qua&&(this.KVa&&10>
this.Yfc&&10*this.Qua.size>=this.Yfc*this.KVa.size&&(this.SOb(4),this.Yfc+=1),this.Qua.add(S.slideId)),this.la.ajd&&this.dEh(),t=!!this.KVa&&this.KVa.size>=this.la.wIk,this.Lcb===this.Eye&&t&&this.Jzl())}l7g(){this.zCb=!0;this.vr&&this.dr&&this.sj&&(this.sj.hideURLBar(),this.zud(1),this.SOb(1))}m7g(){this.zCb=!1;this.vr&&this.dr&&this.sj&&this.sj.showURLBar()}onSubtitleUpdated(t,S){this.vr&&this.dr&&this.Zn&&(S.isFinal?this.Zn.UpdateFinalSubtitles(S.IDh):this.Zn.UpdatePartialSubtitles(S.IDh))}onTranscriberStarted(t,
S){this.Gd.telemetryData.transcriberSessionIds+=S.HDh+",";this.vr&&this.dr&&this.kb.FOb(!0,this.Zn.GetPragueSessionInfoJSONString())}Rrl(){P.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",this.Gd.telemetryData.sessionId);-1!==this.QDb&&window.clearInterval(this.QDb);this.VEb=30;this.QDb=window.setInterval(Object(n.a)(this,this.AFk,"pausedSessionAutoExpireTimerCallBack"),6E4)}c0e(){-1!==this.QDb&&(P.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",
this.Gd.telemetryData.sessionId),window.clearInterval(this.QDb),this.QDb=-1)}AFk(){--this.VEb;0>=this.VEb?(P.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Gd.telemetryData.sessionId),this.nyb(),this.C3b(3)):this.c0&&(this.c0.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.VEb.toString()))}inl(){if(!this.c0&&this.ut&&!v.AFrameworkApplication.Ug&&0!==this.Sp.sessionCurrentState){var t=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,
this.VEb.toString());t=new ot.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,t,null);t.closeable=!0;t.e3=Object(n.a)(this,this.Isk,"onBusinessBarClosed");t.image=3;t.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,Object(n.a)(this,this.Ksk,"onBusinessBarResumeSessionButtonClicked"),"");t.vPd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(n.a)(this,this.Jsk,"onBusinessBarEndSessionButtonClicked"));this.ut.businessBar.$h(t,!1);this.ut.Oq();this.c0=t}}qme(){var t=6E4*
this.la.aJk;t=0<t?this.mL()-this.Jad>=t:!1;P.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",t);return t}nyb(){try{this.ut&&this.c0?(this.c0e(),this.ut.businessBar.removeEntry(this.c0),this.ut.Oq(),P.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",!this.c0.businessBar),this.c0=null):P.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.ut,!!this.c0)}catch(t){P.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",
t.toString())}}Isk(t){t===this.c0&&(this.c0=null)}Ksk(t){t===this.c0&&this.sj&&(this.nyb(),this.qme()||v.AFrameworkApplication.Ta.processAction(Va.a.Vya,2))}Jsk(t){t===this.c0&&this.sj&&(this.qme()?this.nyb():this.sj.showEndSessionDialog())}mxk(){const t=this.mL(),S=window.document.hidden;P.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",S?"hidden":"visible",t);S||this.eSa&&18E5<=t-this.OTg&&this.nyb()}e6d(t,S,la){return!this.la.powerPointLiveBroadcastEnabled||
0===this.PVa&&this.la.isBlueChicken?new Promise(Ca=>{Ca(null)}):!la&&!this.eM||la&&!this.vse?(P.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",t,S,la),new Promise((Ca,Na)=>{Na("AuthHelperNotSet")})):new Promise((Ca,Na)=>{let qb=this.la.hostAuthType,Pb="";if("aad"===qb||this.la.isBlueChicken)Pb=this.la.pptLiveResourceUri;else if("msa"===qb)Pb=this.la.$Ik;else{P.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",
t,S);Na("HostAuthTypeInvalid");return}const xc="true"===v.AFrameworkApplication.fa.Ga("IsAnonymousUser").toLowerCase();let ed=v.AFrameworkApplication.fa.Ga(v.AFrameworkApplication.gK);cb.a.Wa(ed)&&(ed="Unset");const dd=new Date;let fd=null;fd=la?this.vse.JAl(this.la.lIk,this.la.kIk,Pb,v.AFrameworkApplication.fa.Ga("UserPrincipalName"),this.la.yIk,this.la.oIk&&"StartLiveBroadcasting"===t&&!this.la.Kbh):this.eM.sV(this.la.pptLiveImplicitAuthAppName,Pb);fd.then(we=>{this.prg(S,t,qb,la,xc,ed,we.IsSuccess,
+new Date-+dd,we.ErrorCode,we.ErrorMessage);we.IsSuccess?Ca(we.Token):Na(we.ErrorCode)}).catch(we=>{this.prg(S,t,qb,la,xc,ed,!1,+new Date-+dd,"exception",we.toString());Na("exception")})})}n5b(t,S){if(!this.la.powerPointLiveBroadcastEnabled||0===this.PVa&&this.la.isBlueChicken)return new Promise(Ca=>{Ca(null)});if("msa"===this.la.hostAuthType)return this.e6d(t,S,!1);const la=this;return new Promise((Ca,Na)=>{la.e6d(t,S,!0).then(qb=>{Ca(qb)}).catch(()=>{la.e6d(t,S,!1).then(qb=>{P.a.J(512496194,833,
50,"LivePresenter::GetToken - WebAuth retry succeeded.");Ca(qb)}).catch(qb=>{Na(qb)})})})}mL(){return(new Date).getTime()}prg(t,S,la,Ca,Na,qb,Pb,xc,ed,dd){const fd={};fd.SessionId=t;fd.Action=S;fd.HostAuthType=la;fd.UseDirectAuth=Ca;fd.IsAnonymousUser=Na;fd.UiHost=qb;fd.IsSuccess=Pb;fd.Latency=xc;fd.ErrorCode=ed;fd.ErrorMessage=dd;P.a.J(51197915,833,50,JSON.stringify(fd))}Y_(t){this.Gd.telemetryData.action=t;this.Gd.telemetryData.sessionDurationInMS=this.mL()-this.Jad;this.Gd.telemetryData.hostAuthType=
this.la.hostAuthType;this.Gd.SetStateServiceMetrics();this.Gd.telemetryData.errorCode.length&&(!this.Gd.telemetryData.errorMessage.length||0>Array.indexOf(this.la.rIk,this.Gd.telemetryData.errorMessage))&&(this.Gd.telemetryData.hasUnexpectedError=!0);t=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==t.indexOf("pptservicescast.officeapps.live.com")?this.Gd.telemetryData.rendezvousServiceEnvironment="prod":-1!==t.indexOf("pptservicescast.edog.officeapps.live.com")?this.Gd.telemetryData.rendezvousServiceEnvironment=
"edog":-1!==t.indexOf("pptservicescast.officeapps.live-int.com")?this.Gd.telemetryData.rendezvousServiceEnvironment="int":this.Gd.telemetryData.rendezvousServiceEnvironment="dev";P.a.J(50706442,833,this.Gd.telemetryData.hasUnexpectedError?15:50,JSON.stringify(this.Gd.telemetryData))}twi(t){if(this.oc)try{var S=this.kq.presentation;if(!S)throw Error.argumentNull("Presentation is null");const la=S.slides||[];this.Eye=la[la.length-1].sid;let Ca=S=!1;this.KVa=new Set;for(const Na of la)S||Na.sid!==t||
(S=!0,Ca=Na.jn),!S||Na.jn&&!Ca||this.KVa.add(Na.sid),Ca&&!Na.jn&&(Ca=!1)}catch(la){this.Gd.telemetryData.SetErrorCode(16,la.toString()),P.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",this.Gd.telemetryData.sessionId,la.toString())}}zud(t){return new Promise(S=>{if(this.vr&&this.Zn&&this.Sp&&this.icc)try{this.icc.then(la=>{let Ca=!1;switch(t){case 2:if(!this.Qua||!this.KVa||10*this.Qua.size<8*this.KVa.size){S(!0);
return}break;case 3:Ca=!0}const Na={triggeredSurveyType:"Survey.AudienceFeedback"};Na.isMandatory=Ca;Na.triggerEventId=Kc.a.create().toString();Na.surveyeeName=v.AFrameworkApplication.userName;la?(Na.surveyId=la.surveyId,Na.surveyResponseUrl=la.surveyResponseUrl):P.a.J(512496192,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Gd.telemetryData.sessionId);this.Zn.TriggerSurvey(JSON.stringify(Na));P.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",
this.Gd.telemetryData.sessionId,t);S(!0)}).catch(la=>{P.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,la.toString());this.Gd.telemetryData.SetErrorCode(13,la.toString());S(!1)})}catch(la){this.Gd.telemetryData.SetErrorCode(17,la.toString()),P.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",
this.Gd.telemetryData.sessionId,la.toString()),S(!1)}else S(!0)})}B4g(t,S){this.kb&&this.Zn&&S&&(this.kb.Qib(Object(n.a)(this,this.B4g,"onGetCurrentSlideShowPosition")),this.Zn.SetCurrentPosition(S.slideId,S.slideIndex,S.Ptc))}$wa(t,S){this.sj&&this.sj.actOnCurrentSlideDimensionChange(S.slideHeight,S.Ixh,S.slideWidth,S.Lxh)}getCalloutMenuDefinition(){return this.J3b()?this.sj.getCalloutMenuDefinition():null}iGj(){const t=String.format("{0}{1}",this.la.Rhb,"reactions/heart/default/240_anim_f/heart.png"),
S=String.format("{0}{1}",this.la.Rhb,"reactions/yes/default/240_anim_f/yes.png"),la=String.format("{0}{1}",this.la.Rhb,"reactions/clap/default/240_anim_f/clap.png"),Ca=String.format("{0}{1}",this.la.Rhb,"reactions/laugh/default/240_anim_f/laugh.png"),Na=String.format("{0}{1}",this.la.Rhb,"reactions/surprised/default/240_anim_f/surprised.png"),qb=String.format("{0}{1}",this.la.Rhb,"reactions/wonder/default/240_anim_f/wonder.png");this.Lma=[Object.assign(new Ck,{react:"yes",reactionCount:0,reactionImagePath:S,
numberOfAnimationFrames:40}),Object.assign(new Ck,{react:"heart",reactionCount:0,reactionImagePath:t,numberOfAnimationFrames:16}),Object.assign(new Ck,{react:"clap",reactionCount:0,reactionImagePath:la,numberOfAnimationFrames:40}),Object.assign(new Ck,{react:"laugh",reactionCount:0,reactionImagePath:Ca,numberOfAnimationFrames:77}),Object.assign(new Ck,{react:"surprised",reactionCount:0,reactionImagePath:Na,numberOfAnimationFrames:68}),Object.assign(new Ck,{react:"wonder",reactionCount:0,reactionImagePath:qb,
numberOfAnimationFrames:70})];this.Pkb=new Map;this.Yfc=1;this.m8c=null}Zlh(){if(this.Lma){for(const t of this.Lma)t.reactionCount=0;this.sj&&this.sj.resetReactions()}}qpk(t){if(this.Pkb){var S=this.Pkb.has(t.slideId)?this.Pkb.get(t.slideId)+1:1;this.Pkb.set(t.slideId,S)}if(this.Lma&&!this.eSa&&this.Eue){for(const la of this.Lma)if(la.react===t.react){la.reactionCount+=1;break}if(this.sj){t=Array(this.Lma.length);for(S=0;S<this.Lma.length;S++)t[S]=Object.assign(new Ck,{react:this.Lma[S].react,reactionCount:this.Lma[S].reactionCount,
reactionImagePath:this.Lma[S].reactionImagePath,numberOfAnimationFrames:this.Lma[S].numberOfAnimationFrames});this.sj.setReactions(t)}}}SOb(t){return new Promise(S=>{if(this.vr&&this.Zn&&this.Sp)try{if(1>this.Pkb.size)P.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",this.Gd.telemetryData.sessionId,t),S(!0);else if(2===t&&(!this.Qua||1>this.Qua.size))P.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",
this.Gd.telemetryData.sessionId,t),S(!0);else{var la=null,Ca=0;this.Pkb.forEach((qb,Pb)=>{qb>Ca&&(la=Pb.toString(),Ca=qb)});if(this.m8c&&la===this.m8c)P.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Gd.telemetryData.sessionId,t),S(!0);else{var Na=this.Zn.TriggerSaveThumbnails(()=>this.n5b("SaveThumbnails",this.Gd.telemetryData.sessionId),la);Na?Na.then(()=>{this.m8c=la;P.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",
this.Gd.telemetryData.sessionId,t);S(!0)}).catch(qb=>{P.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Gd.telemetryData.sessionId,qb.toString(),t);S(!1)}):(this.Gd.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),P.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),S(!1))}}}catch(qb){this.Gd.telemetryData.SetErrorCode(15,
qb.toString()),P.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Gd.telemetryData.sessionId,qb.toString()),S(!1)}else S(!0)})}bSa(){return this.la.pptEditorVoiceUXEnabled&&this.Ll&&this.Ll.instance?!0:!1}Xzi(t){if(this.bSa())switch(t){case 0:this.NGa&&this.Ll.instance.show(ResourceStrings.L_LivePresentations_Disconnected,ig.a.SYa);this.Gd.telemetryData.SetErrorCode(3);this.Y_("DisconnectdToPrague");break;case 1:this.Ll.instance.hide();break;
case 2:this.NGa&&this.Ll.instance.show(ResourceStrings.L_LivePresentations_Connecting,ig.a.ZGb);break;default:P.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Gd.telemetryData.sessionId)}else P.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Gd.telemetryData.sessionId)}Fkc(t,S){this.bSa()?S.isConnected?this.Ll.instance.hide():this.NGa&&this.Ll.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,
ig.a.ZGb):P.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Gd.telemetryData.sessionId)}O8d(t,S){t=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,t,S);this.la.AIk&&(t+="&shareable=true");return t}szl(t,S){try{const la=new ea.a;if(1===t||2===t||4===t)la.add(this.zud(3)),la.add(this.SOb(3));la.count?Promise.all(la.toArray()).then(()=>S()).catch(()=>S()):S()}catch(la){P.a.J(512496150,
833,10,"failed to create end session task promises, error : {0}",la),S()}}get S6e(){const t=Mk.a.get("PPTLivePresentationOnboarded");return t?"true"===t.toLowerCase():!1}set S6e(t){Mk.a.aK("PPTLivePresentationOnboarded",t.toString(),Mk.a.FJ)||P.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",t.toString())}h3d(){return this.la.bJk&&!this.S6e}gaa(){try{if(P.a.J(512496148,833,15,"Pods session rehydrated!"),this.z5c=!0,this.vr&&this.dr&&this.Zn){P.a.J(512496147,833,
15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Gd.telemetryData.sessionId,this.Xa.qk);const t=this.O8d(this.Xa.podSessionId,this.Xa.qk);this.Zn.OnPodSessionUpdated(t)}}catch(t){P.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",t.toString())}}yHb(){this.z5c=!1}onPodSessionExpired(){this.z5c=!1}Qlb(){if(this.la.cJk)try{const t=A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&(P.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),
t.execute(S=>{S.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(t){P.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",t)}}S5f(t){const S=document.createElement("a");S.setAttribute("href",t);return(t=S.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===t.length?t[1]:""}r3i(){var t=this.oc.N7f();let S=1;this.$Ce.clear();for(const la of t){t=la.gk();for(const Ca of t)if(!cb.a.Wa(Ca.Ogb)){t=
this.S5f(Ca.Ogb);const Na=new Lp;Na.nLg=t;Na.oLg=S.toString();this.$Ce.add(Na);S+=1}}}dEh(){var t=this.oc.uEa(this.Lcb).gk();for(const S of t)cb.a.Wa(S.Ogb)||(t=this.S5f(S.Ogb),t=this.ZCe.get(t),cb.a.Wa(t)||this.Zn.SetCurrentPollInfoState(t,this.Lcb))}Oai(t){this.va.addHandler("OnLiveResourcesLoaded",t)}H_k(t){this.va.removeHandler("OnLiveResourcesLoaded",t)}mvf(t){this.va.addHandler("OnLiveSessionStarted",t)}Bjh(t){this.va.removeHandler("OnLiveSessionStarted",t)}kvf(t){this.va.addHandler("OnLiveSessionEnded",
t)}Ajh(t){this.va.removeHandler("OnLiveSessionEnded",t)}V$h(t){this.va.addHandler("OnCalloutDismissed",t)}c_k(t){this.va.removeHandler("OnCalloutDismissed",t)}ivf(t){this.va.addHandler("OnRelaunchPausedSession",t)}yjh(t){this.va.removeHandler("OnRelaunchPausedSession",t)}W$h(t){this.va.addHandler("CalloutMenuDefinitionChanged",t)}d_k(t){this.va.removeHandler("CalloutMenuDefinitionChanged",t)}}Object(h.a)(rr,"LivePresenter",null,[611]);class Nj{constructor(){this.K=null;this.WIg=0}get name(){return"PowerPointWebEditor.Live"}Zb(t){this.K=
t;const S=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(611,"PowerPointLive.ILivePresenter").ma().oa(()=>new rr(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),S,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),A.a.instance.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),this.K.resolve("PowerPointWebEditor.IFocusManager")))}H1j(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.WIg=Date.now(),P.a.J(509441559,
833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),Pa.a.get_instance().Uj(7,()=>{const t=this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw,S=qn.a(this.K),la=new ea.a;la.add(t.loadScript("PPTLiveBroadcast"));la.add(t.loadScript("BroadcastMonitor"));la.add(S("liveActor"));v.AFrameworkApplication.Aa.hb.Pp||la.add(S("uiFabricLazy"));Promise.all(la.toArray()).then(()=>this.kwk()).catch(Ca=>P.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Ca))})):
P.a.J(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(t){P.a.J(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",t)}}Qm(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").VIk){const t=cb.a.pQ((v.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===t||".pps"===t){P.a.J(509441556,
833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==t&&P.a.J(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+t)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").YIk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?P.a.J(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").ZIk&&
(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?P.a.J(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jbh&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?P.a.J(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>
{t.isFeatureEnabled("PowerPointLivePresentations",!1).then(S=>{S?this.H1j():(P.a.J(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else P.a.J(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(t){P.a.J(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",t)}}kwk(){P.a.J(509441549,833,
50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.WIg);this.K.resolve("PowerPointLive.ILivePresenter").M8a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jbh||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Qm,"onFullAppSettingsReady"))}dispose(){}static main(){e.a.instance.Dc(new Nj)}}
Object(h.a)(Nj,"PPTWebEditorLivePackage",null,[2,3]);var ls=d(727);class kn{}Object(h.a)(kn,"LokiTokenResult",null,[]);class Nq{constructor(t){this.WBc=t}ydj(){const t=this.xdj();return t?Nq.lle?new Promise((S,la)=>{this.WBc.continueWith(()=>{this.WBc.Vn||this.WBc.rm?la(Error.create("Error downloading auth library")):this.WBc.result.sV("Loki",t).then(Ca=>{Ca=v.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.Bdj():Ca.IsSuccess&&Ca.Token?Object.assign(new kn,{isSuccess:!0,
token:Ca.Token,errorMessage:null}):Object.assign(new kn,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Ca)});S(Ca);return Ca})})}):Promise.resolve(Object.assign(new kn,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new kn,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",ls.a.B_f())}))}Bdj(){const t=v.AFrameworkApplication.fa.Ga("LokiUserDataSignature")||
"";return Object.assign(new kn,{isSuccess:!0,token:t,errorMessage:null})}xdj(){let t=null;const S=ls.a.RRc();2===S?t=v.AFrameworkApplication.fa.Ga("LokiAADAppId"):1===S&&(t=v.AFrameworkApplication.fa.Ga("LokiMSAAppId"));return t}static get lle(){return v.AFrameworkApplication.fa.ka("IsO365CommercialHost")||v.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(h.a)(Nq,"LokiTokenManager",null,[669]);class dq{get name(){return"Common.App.LivePersonaUtils"}init(){A.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Zb(t){t.register(Nq,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().oa(()=>new Nq(Xe.a.av(t.Ja("Common.App.OAuth.IOAuthManager"))))}static main(){e.a.instance.Dc(new dq)}}Object(h.a)(dq,"LivePersonaUtilsPackage",null,[2,3]);var Oq=d(260);class eq{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(h.a)(eq,"RehearsalCritique",null,[]);class Ee{static kFj(){Ee.AY[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Ee.AY[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
Ee.AY[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Ee.AY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;Ee.MOf=ResourceStrings.L_SubtitleDetection_MicReady;Ee.NOf=ResourceStrings.L_SubtitleDetection_SoundReminder;Ee.ITf=ResourceStrings.L_SubtitleDetection_NoMicrophone;Ee.OTf=ResourceStrings.l_NoCamera;Ee.XZf=ResourceStrings.L_SpeechGenericRetryErrorMessage}}Ee.yCf=20;Ee.Khh=50002;Ee.AY=Array(Ee.yCf);Ee.MOf=null;Ee.NOf=null;Ee.ITf=null;Ee.OTf=null;Ee.XZf=null;Ee.V3d="fillerWords";
Ee.RBk="originality";Ee.uMl="wordsPerMinute";Ee.e$k="sensitivePhrases";Ee.DCi="correctedSensitivePhrases";Ee.THk="positivity";Ee.tbe="grammar";Ee.XEe="monotone";Ee.JNe="pronunciation";Ee.yZd="crutchWords";Ee.wKh="visionFace";Ee.UKl="visionGaze";Ee.TKl="visionGazeGood";Ee.WKl="visionOcclusion";Ee.VKl="visionOcclusionGood";Ee.QKl="visionDistanceGood";Ee.RKl="visionDistanceTooClose";Ee.SKl="visionDistanceTooFar";Ee.V7f="GetStartedButton";Ee.X0j="ListeningButtonPlayPauseButton";Ee.Y0j="ListeningElement";
Ee.rAi="ContainerElement";Ee.zFk="PausedElement";Ee.sqk="NotificationButtonElement";Ee.BLl="WelcomeCheckboxElement";Ee.Mhh="RehearsalFeedbackSettingPane";Ee.dMe="PPTCoachRehearsalFREShown";Object(h.a)(Ee,"RehearsalResourceString",null,[]);const vn=(t,S)=>cb.a.Wa(S)?(r.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):t?S.toLowerCase()in t:!0,sr=(t,S)=>{let la=null;try{if(!t||cb.a.Wa(S))return r.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Na=cb.a.Wa(t.Dld)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(t.Dld,!0);la={};for(let qb in Na){t=qb;var Ca=Na[qb];if(Ca){const Pb=Cb.a.f_b(Ca.split(","));Pb&&S.toLowerCase()in Pb&&(la[t.toLowerCase()]=!0)}}}catch(Na){P.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Na.toString()),la=null}return la},tr=(t,S)=>{if(cb.a.Wa(S)||cb.a.Wa(t.Hah))return null;try{var la=Sys.Serialization.JavaScriptSerializer.deserialize(t.Hah,
!0);if(cb.a.Wa(S)){r.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Ca=null}else Ca=S.split("-")[0].toLowerCase();return la[Ca]}catch(Na){return P.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Na.toString()),null}},Pq=t=>{if(t&&3<t.length){let S="";"ws"===t.substring(0,2)?S="http"+t.substring(2,t.length):"wss"===t.substring(0,3)&&(S="https"+t.substring(3,
t.length));return S}return t},ur=t=>{if(cb.a.Wa(t))return r.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",t),"en-US";switch(t.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return t}};class Qq{constructor(){this.userCritiques=null}}Object(h.a)(Qq,"RehearseRoamingSettings",null,[]);class Np{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(h.a)(Np,"UserCritiqueSettings",null,[]);class vr{constructor(t,S,la,Ca){this.va=new bm.a;this.tJ=this.Rcc=this.pU=null;this.SL=!1;this.zug=null;this.ewa=this.fwa=0;this.Ds=t;this.la=S;this.nHa=la;this.ia=Ca}mHj(){try{this.s6f(()=>{this.va.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(t){P.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",t.toString())}}i0c(){return 2===this.fwa&&2===this.ewa}t4e(){try{0!==
this.fwa&&3!==this.fwa||this.s6f(Object(n.a)(this,this.JPe,"raiseRehearsalGetCritiquesEvent")),0!==this.ewa&&3!==this.ewa||this.m$i()}catch(t){P.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",t.toString())}}h8i(){if(!this.Rcc)return P.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.tJ)for(let t of this.Rcc)this.tJ.contains(t.critique.toLowerCase())?t.optOut=!0:t.optOut=!1}catch(t){P.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
t.toString())}return this.Rcc.toArray()}oGl(t,S){this.oIh(t,S);"vision"===t.toLowerCase()&&(this.SL=!S,t={},t.triggerPoint=Ee.Mhh,this.ia.La(Va.a.zOb,2,t))}l5f(t=!1){let S="";if(this.tJ&&0<this.tJ.count)if(Ab.a("RehearsalFilterOptOutCritiqueEnabled")&&t){a:{var la=this.la;t=this.la.Rxa;var Ca=null;try{if(!la||cb.a.Wa(t)){r.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Na=null;break a}var qb=
cb.a.Wa(la.Dld)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(la.Dld,!0);Ca={};for(let xc in qb){Na=xc;var Pb=qb[xc];if(Pb){const ed=Cb.a.f_b(Pb.split(","));Ca[Na.toLowerCase()]=ed&&t.toLowerCase()in ed?!0:!1}}}catch(xc){P.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",xc.toString()),Ca=null}Na=Ca}if(Pb=Na)for(let xc of this.tJ)if(qb="vision"===xc?Ee.wKh.toLowerCase():xc.toLowerCase(),qb in Pb?Pb[qb]:1)S=cb.a.Wa(S)?
xc.toLowerCase():S+","+xc.toLowerCase()}else for(Ca of this.tJ)S=cb.a.Wa(S)?Ca.toLowerCase():S+","+Ca.toLowerCase();return S}Mnd(){if(2!==this.fwa)P.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.eVj()){P.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var t=new Qq;t.userCritiques=Object.assign(new Np,{critiquesDisabled:this.l5f(),critiquesDisabledByDefault:this.pU.userCritiques.critiquesDisabledByDefault});
var S=Wd.c(t),la=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",v.AFrameworkApplication.hh),Ca={};Ca["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.nj(la,2,S,Ca,!1,2,Na=>{this.Kyk(Na,t)},Object(n.a)(this,this.Jyk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,Oq.a("17"))}else P.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get u3d(){return this.SL}set u3d(t){this.SL=
t;this.oIh("vision",!this.SL);this.i0c()&&this.va.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}Hai(t){this.va.addHandler("OnRehearsalOptOutSettingsRequestFinished",t)}C_k(t){this.va.removeHandler("OnRehearsalOptOutSettingsRequestFinished",t)}Gai(t){this.va.addHandler("OnRehearsalGetCritiquesSucceeded",t)}B_k(t){this.va.removeHandler("OnRehearsalGetCritiquesSucceeded",t)}Fai(t){this.va.addHandler("OnRehearsalGetCritiquesFailed",t)}A_k(t){this.va.removeHandler("OnRehearsalGetCritiquesFailed",
t)}Iai(t){this.va.addHandler("OnRehearsalSettingsUpdatedExternally",t)}D_k(t){this.va.removeHandler("OnRehearsalSettingsUpdatedExternally",t)}oIh(t,S){this.tJ&&(t=t.toLowerCase(),S&&!this.tJ.contains(t)?this.tJ.add(t):!S&&this.tJ.contains(t)&&this.tJ.remove(t),Ab.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.Mnd())}eVj(){let t=!1;try{var S=cb.a.Wa(this.pU.userCritiques.critiquesDisabled);if(!this.tJ||!this.tJ.count&&S)return!1;if(S&&0<this.tJ.count||!S&&!this.tJ.count)return!0;const la=new Set(this.pU.userCritiques.critiquesDisabled.split(","));
if(this.tJ.count!==la.size)return!0;for(S=0;S<this.tJ.count;S++)if(!la.has(this.tJ.ga(S).toLowerCase())){t=!0;break}}catch(la){P.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",la.toString())}return t}Kyk(t,S){this.pU=S;P.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+t.data.qv-+t.data.AI,+t.data.Zt-+t.data.AI)}Jyk(t){const S=this.nHa.hka(t);P.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
S,t.data.state)}s6f(t){const S=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",v.AFrameworkApplication.hh),la={};la["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.nj(S,1,null,la,!1,2,Ca=>{this.nvk(Ca,t)},Ca=>{this.mvk(Ca,t)},null,void 0,void 0,void 0,void 0,Oq.a("16"));this.fwa=1}nvk(t,S){let la=0;try{t.data.Wd&&0<t.data.Wd.trim().length&&(la=t.data.Wd.length,
this.pU=JSON.parse(t.data.Wd));this.pU&&this.pU.userCritiques||(this.pU=new Qq,this.pU.userCritiques=new Np);cb.a.Wa(this.pU.userCritiques.critiquesDisabledByDefault)&&(this.pU.userCritiques.critiquesDisabledByDefault="vision",cb.a.Wa(this.pU.userCritiques.critiquesDisabled)?this.pU.userCritiques.critiquesDisabled="vision":this.pU.userCritiques.critiquesDisabled+=",vision");this.tJ=new ea.a;if(!cb.a.Wa(this.pU.userCritiques.critiquesDisabled)){const Ca=this.pU.userCritiques.critiquesDisabled.split(",");
for(const Na of Ca)this.tJ.add(Na.toLowerCase())}this.SL=!this.tJ.contains("vision");this.fwa=2}catch(Ca){this.fwa=3,P.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Ca.toString())}S&&S();t=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",la,JSON.stringify(t.data.AI),JSON.stringify(t.data.Zt),JSON.stringify(t.data.qv));P.a.J(559548295,822,50,t)}mvk(t,S){this.fwa=3;S&&S();t=this.nHa.hka(t);P.a.J(559548296,
822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",t)}m$i(){try{const S=this.vXi();if(cb.a.Wa(S))P.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var t=new XMLHttpRequest;t.open("GET",S,!0);t.onreadystatechange=()=>{if(4===t.readyState){if(200===t.status){P.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const la=Wd.b(t.responseText);if(la){this.Rcc=new ea.a;for(const Ca of la.critiquesData)this.Rcc.add(Object.assign(new eq,
{category:Ca.category,displayName:Ca.displayName,optOut:!1,critique:Ca.critique.toLowerCase()}));this.zug=la.categoriesData;this.ewa=2}else this.ewa=3}else this.ewa=3;this.JPe()}};t.send("");this.ewa=1}}catch(S){this.ewa=3,this.JPe(),P.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",S.toString())}}vXi(){const t=Wd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",S=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return S&&S.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",S,t,ur(this.la.Rxa)):null}JPe(){0!==this.fwa&&1!==this.fwa&&0!==this.ewa&&1!==this.ewa&&(this.i0c()?this.va.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.va.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(h.a)(vr,"RehearsalFeedbackSettings",null,[604]);class Rq{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(h.a)(Rq,"RehearsalCritiqueWithGroupProps",null,[]);class ql{constructor(t,S,la,Ca,Na){this.fHa=this.Eb=!1;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{this.fHa=!0;P.a.J(559548252,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(qb=>{P.a.J(559548253,822,10,"Failed to load powerpoint-presenter-coach-strings "+
qb.toString())});this.ia=S;this.la=Na;this.nE=la;this.ty=Ca;this.ia.paa(this)}wb(){this.ia.ya(Va.a.srd,$a.a.application,Object(n.a)(this,this.srd,"showRehearsalFeedbackSettingsPane"));this.ia.ya(Va.a.ird,$a.a.application,Object(n.a)(this,this.ird,"showHideRehearsalFeedbackSettingsPane"));this.ia.ra(Va.a.tkd,$a.a.application,Object(n.a)(this,this.tkd,"queryShowHideRehearsalFeedbackSettingsPane"),96)}Ee(){}G5(){}F5(){}srd(t,S,la){if(S.contextId!==$a.a.application||!this.fHa)return 2;if(1===la)return 32;
this.Eb?vb.UISurfaces.zr().then(Ca=>{Ca.setSelectedTaskPane(ad.a.Iib);this.zA(!0);return null}).catch(Ca=>{P.a.J(554447887,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Ca.toString())}):(this.Eb=!0,this.Hhh(),(t=!this.ty.i0c())&&this.ty.t4e(),t=this.yC(t,!1),this.Irc(t),P.a.J(555832795,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}ird(t,S,la){if(S.contextId!==$a.a.application||!this.fHa)return 2;if(1===la)return 32;
(this.Eb=!this.Eb)?(this.Hhh(),(t=!this.ty.i0c())&&this.ty.t4e(),t=this.yC(t,!1),this.Irc(t),P.a.J(559548254,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.Jvi(),P.a.J(559548255,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}tkd(t,S,la,Ca,Na){if(!Object(Pk.a)(ol.a,Na))return 8;Na.Lf(this.Eb);return 32}Irc(t,S=!1){const la=Object.assign(new Tb.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,
width:320,location:2,contentProps:t,onOpen:()=>{},onClose:()=>{this.Eb=!1;this.cMi();this.ty.Mnd()},onHide:()=>{this.ty.Mnd()},isModernPane:!0});t=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.nE.a9(ad.a.Iib,ad.a.hj,t,()=>{this.zA(!0)},()=>{this.zA(!1)});vb.UISurfaces.zr().then(Ca=>{S?this.Eb&&Ca.updateTaskPane(ad.a.Iib,la):Ca.showTaskPane(ad.a.Iib,la);return null}).catch(Ca=>{P.a.J(559548256,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",
Ca.toString())})}Jvi(){vb.UISurfaces.zr().then(t=>{t.hideTaskPane(ad.a.Iib,2);return null}).catch(t=>{P.a.J(559548257,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",t.toString())})}yC(t,S){return Object.assign(new Rq,{groupItems:t||S?null:this.ty.h8i(),categoriesData:this.ty.zug,locale:this.la.Rxa,updateCritiqueState:(la,Ca)=>{this.ty.oGl(la,Ca)},retryToFetchCritiqueSettings:()=>{this.ty.t4e()},showLoadingMessage:t,showErrorMessage:S})}zA(t){const S=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
t&&S&&S.focus()}Hhh(){this.ty.Gai(Object(n.a)(this,this.n6g,"onRehearsalGetCritiquesSucceeded"));this.ty.Fai(Object(n.a)(this,this.m6g,"onRehearsalGetCritiquesFailed"));this.ty.Iai(Object(n.a)(this,this.p6g,"onRehearsalSettingsUpdatedExternally"))}cMi(){this.ty.B_k(Object(n.a)(this,this.n6g,"onRehearsalGetCritiquesSucceeded"));this.ty.A_k(Object(n.a)(this,this.m6g,"onRehearsalGetCritiquesFailed"));this.ty.D_k(Object(n.a)(this,this.p6g,"onRehearsalSettingsUpdatedExternally"))}n6g(){const t=this.yC(!1,
!1);this.Irc(t,!0)}m6g(){const t=this.yC(!1,!0);this.Irc(t,!0)}p6g(){const t=this.yC(!1,!1);t.isExternalUpdated=!0;this.Irc(t,!0)}}Object(h.a)(ql,"RehearsalFeedbackSettingsPane",null,[145]);var Rm;(function(t){t[t.none=0]="none";t[t.ribbon=1]="ribbon";t[t.slideShowToolbar=2]="slideShowToolbar";t[t.summaryPage=3]="summaryPage";t[t.ribbonTopBar=4]="ribbonTopBar";t[t.deepLink=5]="deepLink"})(Rm||(Rm={}));Object(h.b)("RehearsalEntryPoint",Rm);class em{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(h.a)(em,"ICoachActorConfig",null,[]);class wr{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(h.a)(wr,"ICoachFREActorConfig",null,[]);class To{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(h.a)(To,"ICoachSessionConfig",null,[]);class Sq{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(h.a)(Sq,"IDocumentDownloadConfig",null,[]);class Dk{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(h.a)(Dk,"ISlideState",null,[]);class xr{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(h.a)(xr,"IWebcamConfig",null,[]);var lp=d(679);class Uo{constructor(t,S,la,Ca,Na,qb,Pb,xc,ed,dd,fd,we,Sf,Ff){this.uWa=!1;this.Aw=this.mre=this.yX=this.lea=null;this.hhc=0;this.tRg=-1;this.sic=0;this.Fcd=this.ucd=null;this.Hue=this.xue=!1;this.ZAe=this.Mma=0;this.SL=!1;this.va=new bm.a;this.fYa=null;this.Lyg=this.MDe=this.rqe=!1;this.aBe=null;this.jcc=this.Uug=0;this.oUg=this.eyg=!1;this.lyg=v.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.$8j=
la;S&&(this.lea=S.FF());this.kb=Ca;this.ia=t;this.oc=Na;this.ua=qb;this.Xa=Pb;this.la=xc;this.Ll=ed;this.Bea=dd;this.ghc=fd;this.ty=we;this.lO=Sf;this.tB=Ff;this.e4b()&&this.ty.Hai(Object(n.a)(this,this.o6g,"onRehearsalOptOutSettingsRequestFinished"))}wb(){this.ia.ya(Va.a.tsc,$a.a.application,Object(n.a)(this,this.tsc,"startRehearsalManager"));this.ia.ya(Va.a.zOb,$a.a.application,Object(n.a)(this,this.zOb,"toggleRehearsalVisionEnabled"));this.ia.ya(Va.a.yoc,$a.a.application,Object(n.a)(this,this.yoc,
"rehearsePresentationDropDown"));this.ia.ra(Va.a.FJb,$a.a.application,Object(n.a)(this,this.FJb,"queryRehearsalVisionEnabled"),96)}FJb(t,S,la,Ca,Na){if(!Na||!Object(Pk.a)(ol.a,Na))return P.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Na.Lf(this.SL);return 32}yoc(t,S,la){switch(la){case 1:if(this.uWa&&this.ene())return this.ia.processAction(Va.a.Ufa,1);break;default:P.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}zOb(t,
S,la,Ca,Na){switch(la){case 2:return this.SL=!this.SL,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.Pp&&Pd.App.Kb.rG({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.e4b()&&Na&&Na.triggerPoint!==Ee.Mhh&&(this.ty.u3d=this.SL),32;case 1:if(this.uWa&&this.ene())return 32;break;default:P.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}tsc(t,S,la,Ca,Na){switch(la){case 2:return this.Wrl(Na),32;case 1:if(this.uWa&&this.ene())return 32;break;default:P.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}xbc(){try{this.Uug=Date.now();const t=this.$8j.Vw;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{const S=new ea.a;S.add(t.loadScript("CoachActorPackage"));S.add(t.loadScript("CoachPackage"));Promise.all(S.toArray()).then(()=>{this.itk();return null}).catch(la=>{P.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",la);return null})})}catch(t){P.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
t)}}X$h(t){this.va.addHandler("OnCoachResourcesLoaded",t)}e_k(t){this.va.removeHandler("OnCoachResourcesLoaded",t)}itk(){const t=v.AFrameworkApplication.fa.Ga("CoachPackageCssUrl"),S=document.createElement("link");S.setAttribute("rel","stylesheet");S.setAttribute("type","text/css");S.setAttribute("href",t);$addHandler(S,"load",()=>{this.uWa=!0;Ab.a("PollToRefreshCoachEntryPointOnRibbon")&&this.tB&&this.tB.HH();this.va.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);P.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.Uug)});document.body.appendChild(S)}UWk(){this.kb.aHc(Object(n.a)(this,this.t7g,"onSlideshowReady"));this.kb.IPa(Object(n.a)(this,this.Ykc,"onSlideShowPositionChanged"));this.kb.Fia(Object(n.a)(this,this.Dfa,"onSlideshowExitHandler"));this.kb.bHc(Object(n.a)(this,this.jxa,"onSpecialKeyHandler"))}dMi(){this.kb.$ld(Object(n.a)(this,this.t7g,"onSlideshowReady"));this.kb.Rib(Object(n.a)(this,this.Ykc,"onSlideShowPositionChanged"));this.kb.Wfa(Object(n.a)(this,this.Dfa,"onSlideshowExitHandler"));
this.kb.amd(Object(n.a)(this,this.jxa,"onSpecialKeyHandler"))}jxa(t,S){S.key===ua.a.hQb&&this.ZVe()}ZVe(){if(0===this.Mma){var t=this.Aw.getCoachElement(Ee.V7f);t&&this.WKa(t)}else 2===this.Mma?(t=this.Aw.getCoachElement(Ee.zFk))&&this.WKa(t):1===this.Mma&&(t=this.Aw.getCoachElement(Ee.Y0j))&&this.WKa(t)}WKa(t){this.lea&&this.Aw&&window.setTimeout(()=>{gc.FocusManager.Wr(t)},50)}aA(t){try{const Na=this.Aw.getCoachElement(Ee.V7f),qb=this.Aw.getCoachElement(Ee.X0j),Pb=this.Aw.getCoachElement(Ee.BLl),
xc=this.Aw.getCoachElement(Ee.sqk);if(t.keyCode===ua.a.Sq){if(!Ab.a("PresenterCoachTabFix")){var S=!Pb&&!!Na&&t.target===Na||!!Pb&&t.target===Pb,la=!!Na&&!!qb&&qb.contains(t.target),Ca=!!xc&&t.target===xc;(S||la||Ca)&&this.kb.restoreFocus()}}else t.keyCode===ua.a.ZR||t.keyCode===ua.a.Y1?(this.kb.prev(),this.ZVe()):t.keyCode===ua.a.oP||t.keyCode===ua.a.W1?(this.kb.next(),this.ZVe()):t.keyCode===ua.a.tq||t.keyCode===ua.a.NPb||t.shiftKey||this.kb.restoreFocus()}catch(Na){P.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Na)}}eWk(){const t=this.Aw.getCoachElement(Ee.rAi);if(Ab.a("PresenterCoachTabFix")){var S=document.getElementById("HiddenFocusTrapAnchor");this.lea.insertBefore(t,S)}else S=document.getElementById("slideshowEndFocusTrap"),this.lea.insertBefore(t,S);t&&id.a.addHandler(t,ha.a.Xf,Object(n.a)(this,this.aA,"keyDownHandler"))}Wrl(t){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");Ee.kFj();this.UWk();this.e4b()&&(this.ty.Mnd(),this.ty.C_k(Object(n.a)(this,this.o6g,"onRehearsalOptOutSettingsRequestFinished")));
const S=new Dk;this.fYa=sr(this.la,this.la.Rxa);this.SL&&!this.la.pptRehearsalVisionEnabled&&P.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.SL=this.SL&&this.la.pptRehearsalVisionEnabled;var la=new eo.a,Ca=Object(D.a)(115,this.oc.uEa(this.ua.Ba.Cb.sid));S.currentSlideIndex=Ca?Ca.me:0;S.totalSlideCount=this.oc.qj();Ca=this.C6i(S);this.Aw=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Ca,la);this.SL&&(this.ucd=this.Aw.getRehearsalVideoElement(),
this.Fcd=this.Aw.getRehearsalVideoCanvas());this.ZAe=t;t=this.G6d(S,this.ucd,this.Fcd);this.yX=(new CoachPackage.CoachSessionFactory).createCoachManager(t);t=this.D6i();this.mre=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(t,la);Ab.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.lO.enumerateDevices(Object(n.a)(this,this.pkc,"onEnumerateDevicesSuccess"),Object(n.a)(this,this.aZa,"onDevicesFailure"),Object(n.a)(this,this.lZa,"onUnsupported"));this.YUk();this.ZUk();
this.hhc=0;this.Hue=!1;this.eWk();2===this.ZAe&&(la=localStorage.getItem(Ee.dMe),this.lyg&&!la?this.Yyh():this.M_e())}M_e(){this.Mma=0;this.Bea.execute(t=>{t.jD(lp.a.SubtitlesButton,!1);t.jD(lp.a.LiveButton,!1);t.jD(lp.a.CoachButton,!1);t.jD(lp.a.MicButton,!1)});this.yX.startSession(!0)}Yyh(){this.mre.showCoachFREUI(t=>{localStorage.setItem(Ee.dMe,"true");this.oUg=t;this.M_e()})}pkc(t){this.jcc=0;if(t.length)for(var S of t)"audioinput"===S.kind&&(this.jcc+=1);else this.jcc=0;this.eyg=!0;t=new Dk;
S=Object(D.a)(115,this.oc.uEa(this.ua.Ba.Cb.sid));t.currentSlideIndex=S?S.me:0;t.totalSlideCount=this.oc.qj();t=this.G6d(t,this.ucd,this.Fcd);this.yX.updateSessionConfiguration(t)}aZa(t){P.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",t.toString())}lZa(){P.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",xe.a.Wy)}t7g(){const t=localStorage.getItem(Ee.dMe);this.lyg&&!t?this.Yyh():this.M_e()}Ykc(t,
S){t=new Dk;t.currentSlideIndex=S.slideIndex;t.totalSlideCount=this.oc.qj();S=this.G6d(t,this.ucd,this.Fcd);this.yX.updateSessionConfiguration(S);this.Aw.updateCoachSlideComponent(t)}getTraceRequestMetadata(t,S){const la={};if(t)for(let Ca in t)la[Ca]=t[Ca];if(S)for(let Ca in S)la[Ca]=S[Ca];t=Wd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());la.AudienceGroup=t.Ring||"Unknown";la.BuildVersion=v.AFrameworkApplication.buildVersion||"Unknown";la.ClientType="web";la.IdentityProvider=
this.la.hostAuthType||v.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown";la.Locale=this.la.NJa||"Unknown";la.SpeechMode="rehearsal";la.TenantId=v.AFrameworkApplication.fa.Ga("TenantId");la.UserId=this.getUserId();la.WacDatacenter=t.WACDatacenter||"Unknown";la.WacHost=t.Host||"Unknown";la.SourceLanguage=this.la.bHf||ur(this.la.Rxa);return la}getUserId(){let t=v.AFrameworkApplication.fa.Ga("PptEditingUserId");cb.a.Wa(t)&&(t=v.AFrameworkApplication.fa.Ga("LoggableUserId"),r.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",cb.a.Wa(t)));return t}C9k(){if(this.la.wGk){var t=this.yX.getTraceRequestMetadata(),S=this.Aw.getTraceRequestMetadata(),la=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(la&&la.length){var Ca=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",la);la=new XMLHttpRequest;la.open("POST",Ca,!0);Ca=Kc.a.create().toString();la.setRequestHeader("X-Correlation",Ca);try{r.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Ca);const Na=this.getTraceRequestMetadata(t,S);la.send(Wd.c(Na))}catch(Na){r.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Ca)}}else r.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}Dfa(){this.dMi();this.Mma=3;this.yX.stopSession();this.mre.hideCoachFREAndWelcomeUI();this.Aw.hideCoachUI();this.MDe=this.rqe=!1;try{this.yX.getSessionSummary(t=>
{t.timeSpentInSeconds=this.hhc;this.ia.processAction(Va.a.TOc,2);this.ia.processAction(Va.a.SOc,2);window.clearInterval(this.tRg);this.Hue&&this.ghc.instance.rLa(t,this.SL,this.fYa,this.aBe,()=>{this.C9k()})})}catch(t){r.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",t)}}nij(){let t=",visionFace";this.la.lJk&&(t+=","+Ee.UKl+","+Ee.TKl);this.la.mJk&&(t+=","+Ee.WKl+","+Ee.VKl);this.la.kJk&&(t+=","+Ee.QKl+","+Ee.RKl+","+Ee.SKl);return Ee.uMl+(vn(this.fYa,
Ee.V3d)?","+Ee.V3d:"")+","+Ee.e$k+","+Ee.DCi+","+Ee.RBk+","+Ee.THk+(this.la.eMe&&vn(this.fYa,Ee.tbe)?","+Ee.tbe:"")+(this.la.tLe&&vn(this.fYa,Ee.XEe)?","+Ee.XEe:"")+(this.la.pptRehearsalVisionEnabled&&vn(this.fYa,Ee.wKh)?t:"")+(this.la.pptRehearsalPronunciationEnabled&&vn(this.fYa,Ee.JNe)?","+Ee.JNe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&vn(this.fYa,Ee.yZd)?","+Ee.yZd:"")}G6d(t,S,la){const Ca=new To;Ca.disabledCoachRealtimeFeatures="";Ca.userSessionId=v.AFrameworkApplication.userSessionId;var Na=
new Sq;Na.docId=v.AFrameworkApplication.hh;Na.podsSessionId=this.Xa.podSessionId;Na.userDataCenterClusterId=this.Xa.qk;Na.webServiceBase=this.la.podsWebServiceBase;Ca.documentDownloadConfig=Na;Na=new eo.a;Ca.logger=Na;Na={};Na.currentSlideIndex=t.currentSlideIndex.toString();Ca.customSettings=Na;Ca.fEnableServiceSideAggregationForCoach=this.la.jjd;Ca.httpTimeoutForCoachSummaryData=this.la.xJk;Ca.fSendClientMetaDataOnSessionStart=this.la.YRi;Ca.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;Ca.requestedCoachFeatures=
this.nij();this.e4b()&&(this.aBe=this.ty.l5f(!0),Ca.requestedRehearsalOptOutFeatures=this.aBe);Ab.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Ca.enableTimeStampedCritiqueTelemetry=!0);Ca.entryPoint=Rm[this.ZAe];Ca.fEnableVision=this.SL;Ca.fEnableVision&&S&&la&&(Ca.webcamConfig=Object.assign(new xr,{videoView:S,workingCanvas:la,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.oJk}));Ca.supportedRehearsalTemplates=this.Aw.getSupportedRehearsalTemplates();
Ab.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.eyg&&(Ca.audioInputDeviceCount=this.jcc);t=Wd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Ca.userId=this.getUserId();Ca.tenantId=v.AFrameworkApplication.fa.Ga("TenantId");Ca.identityProvider=this.la.hostAuthType||v.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown";Ca.audienceChannel="";Ca.audienceGroup=t.Ring||"Unknown";Ca.buildVersion=v.AFrameworkApplication.buildVersion||"Unknown";Ca.locale=this.la.NJa||
"Unknown";Ca.wacHost=t.Host||"Unknown";Ca.wacDatacenter=t.WACDatacenter||"Unknown";Ca.sourceLanguage=this.la.bHf||ur(this.la.Rxa);P.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.NJa,this.la.Rxa);return Ca}D6i(){const t=new wr;t.rootContainer=this.lea;t.zIndex=Ee.Khh;t.imagesBaseFilePath=v.AFrameworkApplication.fa.Ga("CoachImagesBaseFilePath");return t}C6i(t){const S=new em;S.rootContainer=this.lea;S.slideState=t;S.imagesBaseFilePath=
v.AFrameworkApplication.fa.Ga("CoachImagesBaseFilePath");S.zIndex=Ee.Khh;S.fEnableVision=this.SL;S.fShowRealtimeFeedbackEnabledCheckbox=this.la.vGk;S.fUseNewRealtimePanel=this.la.Cld;S.fUseCountdownWelcomeScreen=v.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");S.speechFDBase=Pq(this.la.pptEditorSpeechHandlerBaseUri);S.fDontShowTooltips=xe.a.fg;S.fUseNewRealtimeCheckbox=Ab.a("UseNewRealtimeCheckbox");return S}FGl(){2!==this.Mma&&(this.hhc+=1,this.Aw&&this.Aw.updateTimer(this.hhc))}YUk(){this.Aw.on("CoachSessionStarted",
()=>{this.Mma=1;this.tRg=window.setInterval(Object(n.a)(this,this.FGl,"updatePresentationTimer"),1E3);this.yX.enableVoiceStreaming();this.eol();this.Hue=!0});this.Aw.on("CoachSessionPaused",()=>{this.Mma=2;this.yX.pauseSession();this.Pja()&&this.Ll.instance.hide()});this.Aw.on("CoachSessionResumed",()=>{this.Mma=1;this.yX.resumeSession()})}ZUk(){this.yX.on("SpeechRecognitionStarted",()=>{this.xue&&this.Pja()&&(this.Ll.instance.hide(),this.xue=!1)});this.yX.on("PPTCoachRealtimeNotification",t=>{this.Asj(t)});
this.yX.on("QualityStatusChanged",t=>{this.$vj(t)});this.yX.on("MediaStatusChanged",t=>{this.Duj(t)});this.yX.on("Error",t=>{this.handleError(t)});this.yX.on("ConnectionRetry",()=>{this.Itj()})}Itj(){this.xue=!0;this.Pja()&&this.Ll.instance.show(Ee.XZf,ig.a.SYa)}Asj(t){this.Aw.updateCoachRealtimeNotification(t)}handleError(t){t=Object(D.a)(String,t);this.Mma=4;t?t.startsWith("ErrorAudio")?(this.Aw&&this.Aw.showCoachDisabledUI(0),this.Pja()&&this.Ll.instance.show(Ee.ITf,ig.a.SYa)):t.startsWith("ErrorVideo")?
(this.Aw&&this.Aw.showCoachDisabledUI(1),this.Pja()&&this.Ll.instance.show(Ee.OTf,ig.a.SYa)):P.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):P.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}Syh(){this.Aw&&(this.SL&&this.Aw.enableCoachVideoUI(),this.Aw.showCoachRealtimeUI(this.oUg));this.Pja()&&this.Ll.instance.show(Ee.MOf,ig.a.xed)}Duj(t){"AudioDeviceConnected"===t.mediaStatus?(this.rqe=!0,this.SL&&!this.MDe||this.Syh()):"VideoSetupCompleted"===t.mediaStatus&&
(this.MDe=!0,this.rqe&&(this.Aw&&this.Aw.enableCoachVideoUI(),this.Syh()))}$vj(t){if(this.la.pptEditorVoiceUXEnabled){var S=t.severity,la=t.shortCode;if(0<la&&la<Ee.yCf&&Ee.AY[la])switch(S){case 0:this.Pja()&&this.Ll.instance.hide();break;case 1:(t=0<la?Ee.AY[la]:t.shortString)&&this.Pja()&&this.Ll.instance.show(t,ig.a.ZGb);break;case 2:(t=0<la?Ee.AY[la]:t.shortString)&&this.Pja()&&this.Ll.instance.show(t,ig.a.SYa)}else P.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}Pja(){return this.la.pptEditorVoiceUXEnabled&&
this.Ll&&this.Ll.instance&&2!==this.Mma?!0:!1}eol(){this.Pja()&&(this.Ll.instance.show(Ee.NOf,ig.a.xed),this.sic=window.setTimeout(Object(n.a)(this,this.kde,"hideSoundReminderNotification"),3E3))}kde(){this.Pja()&&(window.clearTimeout(this.sic),this.Ll.instance.hide())}e4b(){return this.la.PIb&&!!this.ty}ene(){return this.e4b()?this.Lyg:!0}o6g(){this.Lyg=!0;this.SL=this.ty.u3d;Ab.a("PollToRefreshCoachEntryPointOnRibbon")&&this.tB&&this.tB.HH()}}Object(h.a)(Uo,"RehearsalManager",null,[605]);class pt{constructor(t,
S,la){this.Do=t;this.ia=S;this.la=la}rLa(t,S,la,Ca,Na){try{const xc=document.createElement("div");xc.id="SummaryPageOverlay";xc.style.width="100%";xc.style.height="100%";xc.style.zIndex="999";xc.style.display="flex";xc.style.flexDirection="column";xc.style.justifyContent="center";xc.style.position="absolute";var qb=document.getElementById("SummaryPageOverlay");qb&&document.body.removeChild(qb);document.body.insertBefore(xc,document.body.firstChild);const ed=xc.parentNode;id.a.addHandler(ed,ha.a.Xf,
Object(n.a)(this,this.R5g,"onParentNodeKeyDownHandler"));var Pb=t.thumbIndices;if(Pb){qb={};let Sf=0;const Ff=this.llj(Pb);for(let Gh=0;Gh<Pb.length;Gh++)qb[Pb[Gh].toString()]=Ff[Gh],Ff[Gh]||Sf++;P.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Pb.length,Sf);t.slideImageSrcs=qb}else t.slideImageSrcs={},P.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const dd=v.AFrameworkApplication.UE;dd||P.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");la||(la=sr(this.la,this.la.Rxa));Pb={};const fd=Wd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Pb.fFeedbackCardEnabled=this.la.xGk&&dd;Pb.fShowFeedbackButton=dd;Pb.fMonotoneEnabled=this.la.tLe&&vn(la,Ee.XEe);Pb.fGrammarEnabled=this.la.eMe&&vn(la,Ee.tbe);Pb.fFillersCardEnabled=vn(la,Ee.V3d);Pb.locale=this.la.Rxa;Pb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&vn(la,Ee.JNe);Pb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&vn(la,Ee.yZd);Pb.fVisionEnabled=S&&this.la.nJk&&this.la.pptRehearsalVisionEnabled;const we=tr(this.la,this.la.Rxa);cb.a.Wa(we)||(Pb.fPacingGaugeRange=we);cb.a.Wa(fd)||(Pb.clientSessionId=fd);this.la.PIb&&(Pb.rehearsalOptOutFeatures=Ca);(new rehearsalSummaryPage.RehearsalSummaryPageController(xc,t,()=>{P.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Na&&Na();this.ia&&(xc.parentNode.removeChild(xc),this.ia.La(Va.a.Ufa,2,{entryPoint:3}))},()=>{Na&&Na();id.a.removeHandler(ed,ha.a.Xf,Object(n.a)(this,this.R5g,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.zid),()=>{this.zml()},Pb,Pq(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.Wll()})).renderSummaryPage()}catch(xc){P.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",xc.toString())}}R5g(t){"MainApp"===
t.target.id&&(t.preventDefault(),t.stopPropagation())}Wll(){P.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.PIb&&this.ia.La(Va.a.srd,2,null)}zml(){P.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.EIk?this.ia.La(Va.a.Phh,2,null):this.ia.La(u.a.giveFeedback,2,!1))}llj(t){const S=Array(t.length);if(!this.Do)return S;const la=this.Do.rL(),Ca=this.Do.pTa();
for(let Na=0;Na<t.length;Na++){const qb=Ca[la[t[Na]].sid.toString()];qb&&qb.thumbnailImage.length&&(S[Na]=qb.thumbnailImage)}return S}}Object(h.a)(pt,"RehearsalSummaryPageHelper",null,[]);class mp{constructor(t,S,la,Ca,Na){this.uWa=!1;this.va=new bm.a;this.ia=t;this.q6c=new pt(S,this.ia,Ca);this.Uye=la;this.Zad=Na}wb(){this.ia.ya(Va.a.rLa,$a.a.application,Object(n.a)(this,this.hol,"showSummaryPage"));this.ia.ya(Va.a.Phh,$a.a.application,Object(n.a)(this,this.Hml,"showFloodgateSurvey"))}rLa(t,S,la,
Ca,Na){this.q6c.rLa(t,S,la,Ca,Na)}hol(t,S,la,Ca,Na){switch(la){case 2:return this.q6c.rLa(Na,!1,null,null,null),32;case 1:if(this.uWa)return 32;break;default:P.a.J(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}Hml(t,S,la){switch(la){case 2:return this.Zad.execute(Ca=>{Ca.iNb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.uWa)return 32;break;default:P.a.J(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}xbc(){const t=
Date.now();this.Uye("rehearsalSummaryPage").then(()=>{const S=v.AFrameworkApplication.fa.Ga("RehearsalSummaryPageCssUrl"),la=document.createElement("link");la.setAttribute("rel","stylesheet");la.setAttribute("type","text/css");la.setAttribute("href",S);$addHandler(la,"load",()=>{this.uWa=!0;this.va.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);P.a.J(555798673,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-t)});document.body.appendChild(la);return null})}Jai(t){this.va.addHandler("OnRehearsalSummaryResourcesLoaded",
t)}E_k(t){this.va.removeHandler("OnRehearsalSummaryResourcesLoaded",t)}}Object(h.a)(mp,"RehearsalSummaryPageActor",null,[603]);class fq{constructor(t,S,la,Ca,Na){this.ymg=this.Uhg=!1;this.ia=t;this.Ha=S;this.$Ae=la;this.ghc=Ca;this.Ewa=Na;this.$Ae.execute(qb=>{qb.X$h(Object(n.a)(this,this.m3g,"onCoachResourcesLoaded"))});this.ghc.execute(qb=>{qb.Jai(Object(n.a)(this,this.q6g,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.$Ae.instance&&this.$Ae.instance.e_k(Object(n.a)(this,this.m3g,"onCoachResourcesLoaded"));
this.ghc.instance&&this.ghc.instance.E_k(Object(n.a)(this,this.q6g,"onRehearsalSummaryResourcesLoaded"))}m3g(){this.Uhg=!0;this.gEh()}q6g(){this.ymg=!0;this.gEh()}gEh(){this.Uhg&&this.ymg&&Pa.a.get_instance().Uj(10,null).continueWith(()=>{if(this.Ha.Fvh&&this.Ha.jJk){const t=document.getElementById("rehearsal-loading-dialog-modal");t?(t.style.display="none",P.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):P.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(Va.a.Ufa,1))if(this.Ha.Fvh)this.ia.La(Va.a.Ufa,2,{entryPoint:5});else if(!this.Ha.GQ&&this.Ha.Obh&&this.Ha.LIk)try{this.Ewa.continueWith(()=>{this.Ewa.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),P.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(t){P.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",t)}})}}Object(h.a)(fq,
"RehearsalTrigger",null,[606]);class fk{constructor(){this.K=this.ty=null}get name(){return"PowerPointWebEditor.Rehearsal"}szi(){this.K.register(603,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().oa(()=>new mp(v.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),qn.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ja("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").wb()}Zb(t){this.K=
t;this.K.Ja("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.szi()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(604,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().oa(()=>new vr(v.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.ty=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const S=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(605,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().oa(()=>new Uo(v.AFrameworkApplication.Ta,S,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
A.a.instance.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),A.a.instance.Ja("PowerPointWebEditor.ISlideshowToolbar"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.ty,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").wb();this.K.register(606,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().oa(()=>new fq(v.AFrameworkApplication.Ta,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalManager"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Xe.a.av(A.a.instance.Ja("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){v.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jac&&Pa.a.get_instance().Uj(7,
()=>{this.K.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").xbc();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").xbc();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").PIb){const t=new ql(this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw,
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.ty,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));t.wb();t.Ee();this.ty.mHj()}}dispose(){}static main(){e.a.instance.Dc(new fk)}}Object(h.a)(fk,"PPTWebEditorRehearsalPackage",null,[2,3]);class np{constructor(){this.message=null;this.Av=0}}Object(h.a)(np,"HttpRequstToPromiseRejectData",null,[]);class gq{constructor(t){this.Uba=t}GVa(t,S,la,Ca,Na,qb){y.a.sendTelemetryEvent(Object.assign(new G.a,
{name:"Office.Online."+t,dataFields:[Object.assign(new K.a,{name:"EventMessage",string:S}),Object.assign(new K.a,{name:"FormFactor",string:this.Uba.formFactor}),Object.assign(new K.a,{name:"CorrelationId",string:this.Uba.correlationId}),Object.assign(new K.a,{name:"AccountType",string:this.Uba.accountType}),Object.assign(new K.a,{name:"OSVersion",string:this.Uba.osVersion}),Object.assign(new K.a,{name:"AppId",string:this.Uba.appId}),Object.assign(new K.a,{name:"ConsentSurface",string:"AppStart"}),
Object.assign(new K.a,{name:"ConsentLanguage",string:this.Uba.consentLanguage}),Object.assign(new K.a,{name:"EventCode",string:la}),Object.assign(new K.a,{name:"Region",string:this.Uba.region}),Object.assign(new K.a,{name:"ModelType",string:Ca}),Object.assign(new K.a,{name:"ModelId",string:Na}),Object.assign(new K.a,{name:"Platform",string:this.Uba.os}),Object.assign(new K.a,{name:"ReConsentReason",string:""}),Object.assign(new K.a,{name:"ConsentType",string:qb})]}))}}Object(h.a)(gq,"TelemetryLogger",
null,[]);class hq{constructor(t,S,la){this.cQh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.$a=t;this.Yh=S;this.brb=la;this.bca=new gq(la)}D1b(t,S,la=null,Ca=null){return new Promise((Na,qb)=>{const Pb=null!=la?la:2E3,xc=null!=Ca?Ca:2500;let ed=this.$a.Ga("UCNoticeCheckinStateUrl");ed&&ed.length||(ed=this.cQh);this.Yh.cW(ed,1,null,this.d8d(t),null,0,dd=>{try{if(void 0===dd||null===dd||void 0===dd.data||null===dd.data||void 0===dd.data.Wd||null===dd.data.Wd){this.bca.GVa("UnifiedConsent.ConsentGetFailed",
"ConsentGetFailed : invalid response","611",null,null,null);let we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");qb(this.mka(we,dd))}else if(dd.data.ie!==Yc.a.Wv){this.bca.GVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Status Code - ",dd.data.ie.toString(),null,null,null);let we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
dd.data.ie,"UnifiedConsent.ConsentGetFailed");qb(this.mka(we,dd))}else{var fd=S(dd.data.Wd);if(fd)Na(fd);else{this.bca.GVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Consent Values are empty","612",null,null,null);let we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");qb(this.mka(we,dd))}}}catch(we){this.bca.GVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Unexpected Failure","601",
null,null,null),fd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",we,"UnifiedConsent.ConsentGetFailed"),qb(this.mka(fd,dd))}},dd=>{this.bca.GVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Error in service call ",dd.data.ie.toString(),null,null,null);const fd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",dd.data.ie,"UnifiedConsent.ConsentGetFailed");qb(this.mka(fd,
dd))},null,void 0,void 0,Pb,xc)})}mka(t,S){const la=new np;la.message=t;la.Av=S&&S.data?S.data.ie:-1;return la}d8d(t){const S={};S["Accept-Language"]=this.brb.consentLanguage;S.consentsurface="AppStart";S.platform="Web";S.formfactor=xe.a.t$b?"Mobile":"Desktop";S["x-Cid"]=this.brb.correlationId;S.Authorization="Bearer "+t;return S}}Object(h.a)(hq,"HttpRequestToPromiseUtility",null,[]);class Op{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=
this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(h.a)(Op,"WebSdkAdapterProps",null,[]);class el{constructor(t,S,la,Ca){this.lef=this.pxc=this.ppb=this.h4a=null;this.Xmb=Ca;this.$a=t;this.EOh=la;this.Yh=S;this.brb=this.LSc();this.bca=new gq(this.brb)}Zll(){"MSA"===(this.$a.Ga("HostAuthType")||"").toUpperCase()&&this.EOh.execute(t=>{t.sV("Consent",
el.A2h).then(S=>{S.IsSuccess?this.n7i(S.Token).then(la=>{this.pej(la);this.h4a&&""!==this.h4a&&t.sV("Consent",el.C2h).then(Ca=>{Ca.IsSuccess?this.tnl(Ca,this.h4a):this.bca.GVa(el.qFd,"ConsentGetFailed : "+Ca.ErrorMessage,Ca.ErrorCode,this.h4a,this.ppb,this.pxc);return{}});return{}}):this.bca.GVa(el.qFd,"ConsentGetFailed : "+S.ErrorMessage,S.ErrorCode,this.h4a,this.ppb,this.pxc);return{}})})}n7i(t){this.lef=new hq(this.$a,this.Yh,this.brb);return this.lef.D1b(t,Object(n.a)(this,this.YDk,"parseConsentCheckinState")).then(S=>
Promise.resolve(S),S=>Promise.reject("Error while getting result"+S))}YDk(t){({sv:t}=Wd.d(t));return t}pej(t){for(const S of t.consentValues)if(S.needConsent&&!S.maxPromptsReached){this.ppb=S.id;this.pxc=S.consentType;this.h4a=S.modelType;break}}tnl(t,S){if(xb.a("showConsentNotice")){const la=document.createElement("div");document.body.appendChild(la);appChrome.api.showConsentNotice(this.x9i(t.Token,S),la)}else this.bca.GVa(el.qFd,"ConsentGetFailed : appChrome API does not exist","604",this.h4a,this.ppb,
this.pxc)}x9i(t,S){const la=this.brb;la.token=t;la.modelType=S;return la}LSc(){const t=this.Hee(this.$a.Ga("SessionStartInfoJson"));return Object.assign(new Op,{emailId:this.$a.Ga("UserPrincipalName"),userId:this.$a.Ga("LoggableUserId"),accountType:"AAD"===(this.$a.Ga("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.$a.Ga("OfficeApplicationId"),appVersion:this.$a.Ga("appVersion"),appName:"Application"in t?t.Application:"",appEnv:this.Xmb,consentLanguage:this.$a.Ga("UICulture")||"en-US",formFactor:xe.a.t$b?
"Mobile":"Desktop",os:"Os"in t?t.Os:"",osVersion:"OsVersion"in t?t.OsVersion:"",region:this.$a.Ga("region"),correlationId:Kc.a.create().toString(),isDarkMode:this.$a.ka("DarkModeIsOn"),useCache:!0})}Hee(t){let S={};try{S=Wd.b(t)}catch(la){}return S}}el.C2h="https://consentservice.microsoft.com/web";el.A2h="https://consentservice.microsoft.com/checkin";el.qFd="UnifiedConsent.ConsentGetFailed";Object(h.a)(el,"ConsentNoticeManager",null,[662]);class Tq{constructor(){this.Da=null}get name(){return"Common.App.ConsentNoticeDialog"}Zb(t){this.Da=
t;t.register(el,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ma().oa(()=>new el(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ke,t.Ja("Common.App.OAuth.IOAuthManager"),v.AFrameworkApplication.URa))}init(){this.Da.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){e.a.instance.Dc(new Tq)}}Object(h.a)(Tq,"ConsentNoticeDialogPackage",null,[2,3]);var rl=d(12);Type.registerNamespace("Box4.Media");
Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");Type.registerNamespace("PowerPointWebEditor.ImageDescription");
Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");Type.registerNamespace("PowerPointWebEditor.VersionHistory");
Object(rl.c)("Chronos2");Type.registerNamespace("Common.App.AccessibilityChecker");Kb.main();ob.main();Be.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");Nc.main();Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Dc(new Bf);Type.registerNamespace("Common.App.DisplayEnvironmentName");ng.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");bd.main();Type.registerNamespace("Common.App.NewAndOpen.UX");
e.a.instance.Dc(new Ke);Type.registerNamespace("Common.App.OneDriveFilePickerApi");lh.main();Type.registerNamespace("Common.App.PenMinutesManager");mh.main();Type.registerNamespace("Common.App.SaveAsToHost");$h.main();Type.registerNamespace("Common.App.SaveToSharePoint");Qi.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ya.main();Type.registerNamespace("Common.App.SaveACopy");ba.main();Type.registerNamespace("Common.App.PhoneLink");gb.main();Type.registerNamespace("Common.App.SharedFilePicker");
jd.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");De.main();Type.registerNamespace("Common.App.WopiIdentity");Jb.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");Tq.main();cf.main();nf.main();dn.main();Mo.main();dm.main();co.main();e.a.instance.Dc(jc.a(new js,0));Nj.main();Type.registerNamespace("Common.App.LivePersonaUtils");
dq.main();fk.main();Object(rl.b)("Chronos2")},336:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.none=null;h.Tvi="CoAuth";h.Jde="IdeasPaneClosed";h.Hok="MultiSlidesSelected";h.ljb="Retrigger";h.Lod="SessionEnded";h.D$k="SessionRehydrated";h.slideNavigation="SlideNavigation";h.LNb="SuggestionPaneClosed";h.qsd="SuggestionsLoadingTimeout";h.noSuggestion="NoSuggestion";h.typing="Typing";h.ZPb="WebActionId:";h.qXk="Rehydrated";h.HPf="DisallowedRequest";h.SGf="CloseSecondPane";h.eBk=
"OpenEditorPane";Object(J.a)(h,"DesignerResetReason",null,[])},337:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.invalid="Invalid";h.success="Success";h.error="Error";h.pending="Pending";h.cJa="NoResult";Object(J.a)(h,"ProviderResultStatus",null,[])},392:function(J,aa,d){J=d(0);class h{static Uej(){return h._nextEventReceiverId++}}h._nextEventReceiverId=0;Object(J.a)(h,"EventReceiverIdCounter",null,[]);d.d(aa,"a",function(){return e});class e{constructor(r,n){this.aSh=r;this._id=
h.Uej();this.T_h=n}get id(){return this._id}notify(r,n){this.T_h(r,n)}pda(r,n){return this.aSh.uNk(r,n?this:null)}}Object(J.a)(e,"EventReceiver",null,[739])},449:function(J,aa,d){d.d(aa,"a",function(){return r});J=d(0);var h=d(387),e=d(210);class r{static pvh(n){return parseInt(r.Ulb(e.a.xQd,n)||"-1")<=(new Date).getTime()}static R5d(n){return parseInt(r.Ulb(e.a.q6a,n)||"-1")}static oce(n){return Boolean.parse(r.Ulb(e.a.Brb,n)||"false")}static Ulb(n,v){let B=null;try{const y=r.Z9a();if(void 0!==y&&
y){const x=e.a.ERc(n)+v;B=y.getItem(x)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(y){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",n,v)}return B}static Ylb(n,v,B){try{const y=r.Z9a();if(void 0!==y&&y){const x=e.a.ERc(n)+B;y.setItem(x,v)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(y){h.ULS.sendTraceTag(42074648,
220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",n,B)}}static Z9a(){if(!r.WTa)return null;let n=null;try{n=localStorage}catch(v){r.WTa=!1,n=null}return n}}r.WTa=!0;Object(J.a)(r,"AddinUtil",null,[])},540:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=2]="spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=
6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(J.b)("AddinProviderType",h)},541:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";
e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(J.b)("AddinCommandsLaunchOperationType",h)},542:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"OnlineMediaSearchResult",null,[])},543:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r){this.Ydk=e;this.Hgk=r}get L_c(){return this.Ydk}get n3k(){return this.Hgk}}
Object(J.a)(h,"ReportSuggestionSessionActionData",null,[])},544:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.HRf="Provider.UCI.Editor";h.BRf="EntityGroup.UCI.Editor";h.Vxh="Provider.Designer.Slide";h.Uxh="EntityGroup.Designer.Slide.Suggestion";h.dyh="Provider.Designer.TextToSmartArt";h.cyh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(J.a)(h,"InfraredConstant",null,[])},696:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(69);class e{constructor(r){this.U9=
this.ema=null;this.Le=r}dispose(){this.clear();this.ema.parentNode.removeChild(this.ema)}Xia(r){this.ema=this.y1b(r,"prContainerHr");this.U9=this.y1b(this.ema,"prGlyph")}clear(){this.loa()}Loa(r,n){r&&(this.loa(),this.U9.appendChild(r),this.U9.style.backgroundColor=n,this.ema.style.visibility=h.a.visible)}y1b(r,n){const v=this.Le.Ie();this.Le.addCssClass(v,n);r.appendChild(v);return v}loa(){this.U9.firstChild&&this.U9.removeChild(this.U9.firstChild)}}Object(J.a)(e,"ShapePawnGlyph",null,[])},704:function(J,
aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ProviderActionInfo",null,[])},705:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(J.a)(h,"ReplaceObjectSuggestionApplyInfo",null,[])},980:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.authority=
this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static A_f(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(J.a)(h,"WopiAuthContext",null,[719])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.chronos2.js.map