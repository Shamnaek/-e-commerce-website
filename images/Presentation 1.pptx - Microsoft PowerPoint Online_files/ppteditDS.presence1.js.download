'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1E3:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.AVc=this.edd=this.fdd=this.idd=0;this.bac=!1;this.correlationId=this.RA=this.T5=this.V0b=this.errorMessage=null}get eIf(){return this.V0b+"?"+this.T5}}Object(J.a)(h,"FindSessionResponse",null,[])},1040:function(J,aa,d){J=d(0);var h;(function(r){r[r.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";r[r.peopleImageClassName=
1]="peopleImageClassName";r[r.peopleImageClusterPath=4]="peopleImageClusterPath";r[r.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";r[r.imageDimension=6]="imageDimension";r[r.rtl=8]="rtl";r[r.pointerInputManager=9]="pointerInputManager";r[r.clickInputManager=10]="clickInputManager";r[r.vertical=11]="vertical";r[r.zIndex=12]="zIndex";r[r.contextMenuInputManager=13]="contextMenuInputManager";r[r.imageDomElement=14]="imageDomElement";r[r.useIdleTooltip=15]="useIdleTooltip";r[r.viewportBoundsCallback=
16]="viewportBoundsCallback";r[r.flipHorizontalDirection=17]="flipHorizontalDirection";r[r.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";r[r.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";r[r.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(aa,"a",function(){return e});class e{constructor(){this.Qy={}}get(r,n=null){r=h[r];return"number"===typeof n?(n=this.Qy[r])?Number.parseInvariant(n.toString()):0:
this.Qy[r]}add(r,n){this.Qy[h[r]]=n}MD(r,n){h[r]in this.Qy||(this.Qy[h[r]]=n)}remove(r){delete this.Qy[h[r]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])},1041:function(J,aa,d){d.r(aa);J=d(0);var h=d(387),e=d(14),r=d(1066),n=d(352),v=d(18);class B{constructor(x){this.messageId=x;this.$9k=(new Date).getTime();this.Zne=new v.a}}Object(J.a)(B,"MessageLatencyDetails",null,[]);d.d(aa,"ClientToClientMessageTelemetry",function(){return y});class y{constructor(x,A,E){this.tqa=null;this.sGd=this.YKd=
0;this.Jc=A;this.pjf=E;this.QWb=!1;this.rl=x;this.rl.WBa(Object(e.a)(this,this.DSk,"receiveMessage"))}start(){if(this.pjf&&!this.QWb){const x=this.Jc.pnh;this.sGd=this.Jc.mnh;x<=this.sGd?(h.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Jc.pnh,this.Jc.mnh),this.pjf=!1):(this.QWb=!0,this.YKd=window.setInterval(Object(e.a)(this,
this.sendMessage,"sendMessage"),x))}}sendMessage(){if(this.QWb){const x=n.a.create().toString();this.tqa=new B(x);this.rl.LPe(16,x,!1,new r.a);window.setTimeout(()=>{this.E4j(x)},this.sGd)}}E4j(x){this.tqa&&this.tqa.messageId===x&&(0<this.tqa.Zne.count?(x=this.tqa.Zne.toArray().join(","),h.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",x)):h.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.tqa=null)}stop(){this.YKd&&(window.clearInterval(this.YKd),this.QWb=
!1)}DSk(x,A){16===A.type?this.rl.LPe(17,A.Eza,!1,new r.a):17===A.type&&this.QWb&&A.Eza&&this.PLk(A.Eza)}PLk(x){x&&this.tqa&&x.toString()===this.tqa.messageId&&this.tqa.Zne.add((new Date).getTime()-this.tqa.$9k)}static get instance(){return y.Ka}static Gfj(x,A,E){return y.instance||(y.Ka=new y(x,A,E))}}y.Ka=null;Object(J.a)(y,"ClientToClientMessageTelemetry",null,[])},1140:function(J,aa,d){d.r(aa);d.d(aa,"RealtimeChannelMetrics",function(){return v});J=d(0);var h=d(387),e=d(176),r=d(105),n=d(190);
class v{constructor(){this.skf=this.tkf=this.ukf=this.qkf=this.pkf=this.rkf=this.mVb=this.BHd=0;this.Uyc=this.OFd=this.zUb=this.EFd=this.FFd=this.wFd=this.cOa=this.tUb=this.$ob=this.vFd=this.Syc=this.iob=null;this.xGd=this.WUb=this.Fof=this.X9e=0;this.rjf=!1;this.lld=this.dQe;this.gQe=this.hQe;this.mld=this.fQe;this.joc=this.jQe;this.Cgh=this.iQe;this.qQe=this.rQe;this.nQe=this.oQe;this.zib=this.lQe;this.loc=this.mQe;this.xgh=this.eQe;this.MGb=this.RFe;this.Mjc=this.SFe}dQe(){this.BHd++;this.vFd=
new Date;this.iob||(this.iob=new Date)}hQe(){this.mVb++;this.cOa=new Date;this.Syc||(this.Syc=this.cOa);this.zUb=this.cOa;this.Rxi()}fQe(){this.rkf++;this.wFd=new Date}jQe(){this.pkf++;this.$ob=new Date}iQe(){this.qkf++;this.tUb=new Date}oQe(){this.FFd=new Date;this.ukf++}mQe(){this.Uyc||(this.Uyc=new Date);this.tkf++}lQe(){this.EFd=new Date;this.skf++}rQe(){if(!this.rjf&&this.BHd){var B=this.FKc();h.ULS.sendTraceTag(39321871,500,15,r.a.toJSON(B));this.rjf=!0}}eQe(B){let y,x;({Ede:B,Fde:y,$i:x}=n.RtcUtils.SUf(B));
B&&B!==e.a.Wv&&(h.ULS.sendTraceTag(40157596,500,15,r.a.toJSON({["HttpErrorCode"]:B,["HttpErrorStatus"]:y,["Exception"]:x})),e.a.Qhg(B)&&this.X9e++,e.a.cng(B)&&this.Fof++)}RFe(){this.OFd=new Date}SFe(){this.$ob=this.zUb=new Date}FKc(){return{["numberOfConnectionAttempts"]:this.BHd,["numberOfSuccessfulConnections"]:this.mVb,["numberOfFailedConnections"]:this.rkf,["numberOfDisconnectedConnections"]:this.pkf,["numberOfExplicitDisconnectedConnections"]:this.qkf,["numberOfSentMessages"]:this.ukf,["numberOfReceivedMessages"]:this.tkf,
["numberOfLostMessages"]:this.skf,["firstConnectionAttempt"]:this.iob?this.iob:null,["firstMessageReceived"]:this.Uyc?this.Uyc:null,["firstConnectionSuccess"]:this.Syc?this.Syc:null,["lastConnectionAttempt"]:this.vFd?this.vFd:null,["lastConnectionSuccess"]:this.cOa?this.cOa:null,["lastConnectionFailure"]:this.wFd?this.wFd:null,["lastMessageSent"]:this.FFd?this.FFd:null,["lastMessageLost"]:this.EFd?this.EFd:null,["lastDisconnect"]:this.$ob?this.$ob:null,["lastExplicitDisconnect"]:this.tUb?this.tUb:
null,["lastTimeOnline"]:this.zUb?this.zUb:null,["lastTimeOffline"]:this.OFd?this.OFd:null,["maxDisconnectedTimeMs"]:this.WUb,["maxExplicitDisconnectedTimeMs"]:this.xGd,["clientConnectionErrors"]:this.X9e,["serverConnectionErrors"]:this.Fof}}Rxi(){this.iob&&1===this.mVb&&(this.WUb=Math.max(this.WUb,this.cOa.getTime()-this.iob.getTime()));this.$ob&&1<this.mVb&&(this.WUb=Math.max(this.WUb,this.cOa.getTime()-this.$ob.getTime()));this.tUb&&1<this.mVb&&(this.xGd=Math.max(this.xGd,this.cOa.getTime()-this.tUb.getTime()))}static createInstance(B){v.Ka||
(v.Ka=new v,h.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",B));return v.Ka}}v.Ka=null;Object(J.a)(v,"RealtimeChannelMetrics",null,[1345,234])},1141:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r){super();this.DPb=e;this.PPf=r}}Object(J.a)(h,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1142:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.unspecified=0]="unspecified";e[e.word=
1]="word";e[e.excel=2]="excel";e[e.powerPoint=3]="powerPoint";e[e.test=4]="test";e[e.wacFrontEnd=5]="wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.visio=7]="visio";e[e.officeMobile=8]="officeMobile";e[e.cosmosDBChangefeed=9]="cosmosDBChangefeed";e[e.last=10]="last"})(h||(h={}));Object(J.b)("RtcClientAppName",h)},1145:function(J,aa,d){J=d(0);var h=d(387),e=d(14),r=d(238),n=d(239);class v{static b7d(F,na,ka){return v.c7d(F,na,ka,!0)}static c7d(F,na,ka,Ua){const za=document.createElementNS(v.tmb,"svg");
za.setAttribute("viewBox",String.format(v.b_d,v.uvc,v.tvc));za.appendChild(v.jae(F,na,ka,Ua));return za}static jae(F,na,ka,Ua){const za=v.uvc/F,ha=na/2*za,ua=v.tvc/2;let Ga=0;Ua&&(Ga=(F-3*na-4*ka)*za/2);F=document.createElementNS(v.tmb,"g");Sys.UI.DomElement.addCssClass(F,v.a_d);for(Ua=1;3>=Ua;Ua++)F.appendChild(v.B6d(Ua,ha,Ga+(Ua*(na+ka)-na/2)*za,ua));return F}static B6d(F,na,ka,Ua){const za=document.createElementNS(v.tmb,"circle");Sys.UI.DomElement.addCssClass(za,String.format("{0}-{1}",v.DVd,F));
za.setAttribute("cx",String.format("{0}",ka));za.setAttribute("cy",String.format("{0}",Ua));za.setAttribute("r",String.format("{0}",na));return za}}v.tmb="http://www.w3.org/2000/svg";v.a_d="prDancingDots";v.DVd="prAnimateCircle";v.b_d="0 0 {0} {1}";v.tvc=40;v.uvc=120;Object(J.a)(v,"ModernPresenceTooltipDancingDots",null,[]);var B=d(27),y=d(174),x=d(75),A=d(67),E=d(135),u=d(200),K=d(97),G=d(47),O=d(2);class R extends r.a{constructor(F,na){super(F);this.aYb=this.kS=this.y2a=this.iN=this.dN=this.$o=
this.Nn=null;this.nI=na.get(8,!1);this.hS=na.get(6,0);this.LNd=na.get(15,!1);this.Jc=na;this.wSb=0;this.element=F;this.element.className=R.c9a;this.Ws=document.createElement("span");this.element.appendChild(this.Ws);this.XAd=v.b7d(na.get(6,0),4,2);this.QJ(na);this._state=5}fW(F){this.addHandler(n.a.np,F)}k1(F){this.removeHandler(n.a.np,F)}get user(){return this.aYb}get state(){return this._state}dispose(){this.element&&(this.Nn.yb(A.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.Nn.yb(A.a.doubleClick,
this.element,Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(A.a.pointerDown,this.element,Object(e.a)(this,this.dxa,"onPointerDown")),this.$o.yb(A.a.pointerOut,this.element,Object(e.a)(this,this.Cz,"onPointerOut")),this.$o.yb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver")),this.dN.yb(this.element,Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}QJ(F){this.Nn=F.get(10);this.Nn.pb(A.a.click,this.element,Object(e.a)(this,
this.onClick,"onClick"));this.Nn.pb(A.a.doubleClick,this.element,Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior"));this.$o=F.get(9);this.$o.pb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver"));this.$o.pb(A.a.pointerOut,this.element,Object(e.a)(this,this.Cz,"onPointerOut"));this.$o.pb(A.a.pointerDown,this.element,Object(e.a)(this,this.dxa,"onPointerDown"));this.dN=F.get(13);this.dN.pb(this.element,Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior"))}hide(F=
null,na=0,ka=0){this.LNd&&F?this.jZe(F,na,ka):(3===this.state&&this.Koc(),this.visible=!1,this._state=5)}jZe(F,na,ka=0){this.show(F,na,15,4,void 0,ka)}Hrc(F,na,ka,Ua=!1,za=!1,ha=!1,ua=0){this.show(F,na,ka+20,Ua?2:za?1:0,ha,ua)}ZYe(F,na,ka,Ua=!1,za=0){this.show(F,na,ka+20,3,Ua,za)}show(F,na,ka,Ua=3,za=!1,ha=0){!F||Ua===this.state&&this.Kce(na,ka)||(this.POd(Ua,za,ha),this.Yx(F,Ua,ha),this._state=Ua,4===ha||0===ha&&!this.nI?this.element.style.left=na+"px":this.element.style.right=na+"px",this.element.style.top=
ka+"px",this.visible=!0)}Yx(F,na,ka){this.aYb=F;K.a.Cu(this.Ws);u.a.uGf(this.Ws);this.Ws.id="fly_"+F.clientId;this.Ws.style.backgroundColor=F.color;4!==na?(this.Ws.style.height=this.hS+"px",this.Ws.style.lineHeight=this.hS+"px",u.a.NY(this.Ws,"border-radius",this.hS+"px")):4===ka||0===ka&&!this.nI?this.Ws.style.left="0px":this.Ws.style.right="0px";2!==na&&(4===na?K.a.Nx(this.Ws,""):1===na?this.Ws.appendChild(this.XAd):(this.Ws.setAttribute("dir","auto"),ka=G.a.s8d(F.userName,!1),(!F.isAnonymous||
B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ka||0!==na?(F=F.userName,0===na&&(F=ka,u.a.NY(this.Ws,"text-align","center")),K.a.Nx(this.Ws,F)):(this.iN||(this.iN=this.dYd()),this.Ws.appendChild(this.iN),u.a.NY(this.Ws,"text-align","start"))))}onClick(F){if(0===this.state)return this.raiseEvent(n.a.np,new n.a(1,F)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}Cz(F){3===this.state&&
this.raiseEvent(n.a.np,new n.a(3,F));return!1}cD(F){3!==F.Wf&&this.raiseEvent(n.a.np,new n.a(2,F));return!1}dxa(F){if(3!==F.Wf)return!0;this.raiseEvent(n.a.np,new n.a(4,F));return!1}dYd(){const F=document.createElement("img");F.src=y.a.ZK("doughperson_white_glyph.svg");F.setAttribute("Unselectable","on");E.a.eP(F,E.a.af,E.a.pN);return x.createClusteredImageFromClusterWithImageClass(this.hS,this.hS,null,null,R.O4d,"",!1,"",this.element.ownerDocument,F)}POd(F,na=!1,ka=0){if(!this.Vka(this.state)||!this.Vka(F))switch(Sys.UI.DomElement.removeCssClass(this.element,
this.y2a),this.state){case 4:3===F?this.oN(R.d9a,R.P4b):this.Vka(F)&&this.oN(R.b9a,R.P4b);break;case 3:4===F?this.oN(R.f9a,R.O4b):this.Vka(F)&&(na&&this.Koc(),this.oN(R.b9a,R.O4b,na?R.N4d:""));break;case 0:case 1:case 2:4===F?this.oN(R.f9a,R.e9a):3===F&&(na&&this.bPd(),this.oN(R.d9a,R.e9a,na?R.Q4b:"",3===ka?R.Q4d:R.P4d));break;default:4===F?this.oN(R.f9a):3===F?this.oN(R.d9a):this.Vka(F)&&this.oN(R.b9a)}}oN(...F){this.y2a=F.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.y2a)}bPd(){this.wSb=
window.setTimeout(()=>{this.element&&(this.kS=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.kS),this.element.style.zIndex="2",this.kS.style.zIndex="1")},300)}Koc(){window.clearTimeout(this.wSb);this.kS&&(Sys.UI.DomElement.removeCssClass(this.kS,R.e9a+" "+R.Q4b),Sys.UI.DomElement.addCssClass(this.kS,R.M4d),O.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.kS.parentNode&&this.element.parentNode.removeChild(this.kS)}),u.a.uKb(this.element,"z-index"))}Vka(F){return 0===
F||1===F||2===F}Kce(F,na){const ka=u.a.FH(this.element.style.top);return u.a.FH(this.element.style.left)===F&&ka===na}ejb(F){3===F&&u.a.$P(this.element,"left")?(F=u.a.FH(this.element.style.left),u.a.uKb(this.element,"left"),this.element.style.right=-1*F+"px"):4===F&&u.a.$P(this.element,"right")&&(F=u.a.FH(this.element.style.right),u.a.uKb(this.element,"right"),this.element.style.left=-1*F+"px")}}R.c9a="prModernFlyout UIFont";R.f9a="flyoutIdle";R.d9a="flyoutExpanded";R.b9a="flyoutCollapsed";R.P4b=
"flyoutFromIdle";R.O4b="flyoutFromExpanded";R.e9a="flyoutFromCollapsed";R.Q4b="flyoutStacked";R.N4d="flyoutFromStacked";R.M4d="flyoutFadeOut";R.O4d="cui-img-cont-float cui-img-20by20";R.P4d="flyoutLtrDir";R.Q4d="flyoutRtlDir";Object(J.a)(R,"ModernPresenceTooltipFlyoutControl",r.a,[]);class V{constructor(F,na,ka=2,Ua=4){this.offsetTop=F;this.offsetLeft=na;this.mvc=ka;this.s8b=Ua}}Object(J.a)(V,"FlyoutsPositioningInfo",null,[]);var D=d(65);class Q{constructor(F=!1,na=!1){this.Xi=F;this.e3a=na}A8d(F,
na,ka,Ua,za,ha,ua){const Ga=ua.y,sa=ua.height;var Ba=this.t6d(ha);const pa=Ba+na;za=F*ka+(F-1)*za;ka=null;1===F||this.DUd(Ba,za,Ga,sa)?F=new V(0,0,2):(F=this.z4d(pa,za,Ga,sa),F.offsetTop-=Ba);this.e3a?ka=new V(0,0,void 0,this.Xi?4:3):(ha=this.s6d(ha,ua),Ba=Math.max(0,ua.x),ua=ua.width,na=ha+na,this.EUd(ha,Ua,Ba,ua)?ka=new V(0,0,void 0,this.Xi?3:4):this.FUd(na,Ua,Ba)&&(ka=new V(0,0,void 0,this.Xi?4:3)),ka||(ka=this.y4d(ha,na,Ba,ua)));return new V(F.offsetTop,ka.offsetLeft,F.mvc,ka.s8b)}t6d(F){return D.a.VRc(F)}s6d(F,
na){return this.Xi?na.width-D.a.O_f(F):D.a.URc(F)}DUd(F,na,ka,Ua){return F+na<=ka+Ua}z4d(F,na,ka,Ua){let za=1,ha=Math.max(ka,F-na);na>F-ka&&(za=2,ha=na<Ua?Ua-na:ka);return new V(ha,0,za)}EUd(F,na,ka,Ua){return F+na<=ka+Ua}FUd(F,na,ka){return na<=F-ka}y4d(F,na,ka,Ua){Ua-na>=F-ka?F=4:(na=F,F=3);return new V(0,na,void 0,F)}}Object(J.a)(Q,"ModernPresenceTooltipPositioner",null,[]);class Z{constructor(F,na,ka,Ua,za,ha,ua){this.$v=F;this._parent=na;this.gRb=ka;this.uzd=Ua;this.bDd=za;this.I7=ha;this.nI=
ua;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(F,na){if(3!==F)if(5!==F&&this.$v&&this.$v.length){if(4===F){var ka=this.bDd;var Ua=(this.I7-ka)/2;this.element.style.height=this.I7+"px";this.element.style.width=this.I7+"px";F=u.a.FH(this.$v[0].element.style.top);na=u.a.FH(this.nI?this.$v[0].element.style.right:this.$v[0].element.style.left)}else ka=this.gRb,Ua=(this.I7-ka)/2,this.element.style.height=this.I7+"px",this.element.style.width=
this.I6d()+2*Ua+"px",F=u.a.FH(this.$v[this.$v.length-1].element.style.top),na=this.rUd(this.$v[this.$v.length-1].element,ka,na);u.a.NY(this.element,"border-radius",this.I7+"px");this.element.style.top=F-Ua-ka+"px";this.nI?this.element.style.right=na-Ua+"px":this.element.style.left=na-Ua+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}rUd(F,na,ka){return this.nI&&!ka?u.a.FH(F.style.right):
this.nI||ka?this.nI&&ka?-u.a.FH(F.style.left)-na:-u.a.FH(F.style.right)-na:u.a.FH(F.style.left)}I6d(){return this.$v&&this.$v.length?this.gRb+Math.min(this.$v.length-1,2)*this.uzd:0}}Object(J.a)(Z,"ModernPresenceTooltipTarget",null,[]);var P=d(70),ca=d(118),T=d(195);class da extends r.a{constructor(F,na,ka){super(F);this.B7=this.gI=this.xTb=this.yZ=!1;this.Df=[];this.zAa={};this.Jc=ka;this.Xi=ka.get(8,!1);this.jTb=ka.get(15,!1);this.eAd=ka.get(12,0);this.QS=ka.get(6,0);this.k5a=na;this.cYb=ka.get(16);
this.e3a=ka.get(17,!1);this.dDd=ka.get(19,!1);this.bJd=ka.get(20,!1);this.FAa=0;this.XId=new Q(this.Xi,this.e3a);this.Wga=this.H5b();this.C4a=!1;this.$M=[];this.Aha=[];this.element.id=da.p9a();this.element.className=r.a.nub("prControl",this.Xi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Xi;this.Rjb(na);this.jF=this.createElement("div");this.jF.className="prFlyoutContainer";this.element.appendChild(this.jF);this.$v=[];this.pS=new Z(this.ft,this.element,this.QS,4,6,32,this.Xi);
this.$o=ka.get(9);this.$o.pb(A.a.pointerDown,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.pb(A.a.pointerOver,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.pb(A.a.pointerOut,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"))}get Xhb(){return T.a.clone(this.Df)}get ft(){return this.$v}get defaultZIndex(){return this.eAd}get IN(){return this.ft?this.ft.length:0}get qV(){return 0<this.IN?this.ft[0].state:5}get Nab(){return 3===this.qV&&!this.yZ}fW(F){this.addHandler(n.a.np,
F)}k1(F){this.removeHandler(n.a.np,F)}dispose(){if(this.Nab)this.C4a=!0;else{if(this.ft)for(const F of this.ft)F.k1(Object(e.a)(this,this.eG,"onInteractivityChanged")),ca.a.Kx(F);this.$v=null;this.$o.yb(A.a.pointerDown,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.yb(A.a.pointerOver,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.yb(A.a.pointerOut,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));super.dispose()}}nga(){this.ZZ();this.visible=!0}Hkb(){this.visible=
!0;this.Y3b();this.yZ=!0}Kya(){this.Hkb()}hide(){this.Loc();this.RN();this.pS.update(this.qV,this.B7)}Yx(F){const na=this.qV,ka=this.yZ;F.clientId||(F.clientId=(da.Gha++).toString());if(F.clientId in this.zAa){var Ua=this.fT(F.clientId);if(0<=Ua){Ua=this.Df[Ua];if(Ua.color===F.color&&Ua.userName===F.userName)return;this.TJ(F.clientId)}}this.hide();Ua=new R(this.createElement("div"),this.Jc);Ua.fW(Object(e.a)(this,this.eG,"onInteractivityChanged"));this.jF.insertBefore(Ua.element,this.jF.firstChild);
this.zAa[F.clientId]=Ua;Array.add(this.Df,F);Array.add(this.ft,Ua);this.Tuc(na,ka);this.visible=!0}TJ(F){if(this.Nab)Array.add(this.Aha,F);else{var na=this.qV,ka=this.yZ;this.hide();this.poa(F);this.Tuc(na,ka)}}Cgb(F){const na=this.fT(F);if(!(0>=na)){var ka=this.Df[na];F=this.zAa[F];Array.removeAt(this.Df,na);Array.insert(this.Df,0,ka);Array.removeAt(this.ft,na);Array.insert(this.ft,0,F);this.jF.removeChild(F.element);this.jF.appendChild(F.element);this.ZZ()}}Tuc(F,na){0>=this.Df.length?this.hide():
3===F&&na?this.Hkb():this.nga()}mkb(F,na){na?this.IOd(F):this.Eoc(F)}S3b(F){if(this.Nab&&this.dDd)return!1;F=da.e$a(F);if(this.jF!==F&&K.a.nua(this.jF,F))return!0;for(const na of this.ft)if(K.a.nua(na.element,F))return!0;return!1}position(F,na){this.element.style.top=na+"px";this.element.style.left=F+"px"}ZZ(F=!1){if(!F||this.gI){this.xTb&&this.Fqc(!0);var na=Math.min(3,this.IN)-1;F=0;var ka=1,Ua=0;this.B7&&(F=this.Wga,ka=-1,Ua=-this.QS);for(let za=this.IN-1;za>na;za--)this.ft[za].Hrc(this.Df[za],
-4*na*ka+Ua,0,!0,!1,!0,F);for(;0<=na;na--)this.ft[na].Hrc(this.Df[na],-4*na*ka+Ua,0,0<na,Array.contains(this.$M,this.Df[na].clientId),na!==this.FAa,F);this.FAa=0;this.pS.update(0,this.B7);this.zIndex=this.defaultZIndex;this.yZ=!1;this.Loc(0);this.C4a&&this.dispose()}}Y3b(){this.xTb&&this.Fqc(!1);this.zIndex=this.defaultZIndex+1;let F,na,ka;({offsetX:na,offsetY:F,r8b:ka}=this.mWe());for(let Ua=0;Ua<this.IN;Ua++)this.ft[Ua].ZYe(this.Df[Ua],na,F+(this.QS+2)*Ua,Ua!==this.FAa,ka)}RN(){let F=0,na=0;this.B7&&
(F=this.Wga,na=-6);for(let ka=0;ka<this.IN;ka++)this.ft[ka].hide(this.Df[ka],na,F);this.zIndex=this.defaultZIndex;this.visible=this.yZ=!1;this.C4a&&this.dispose()}s7a(F=0){F?(this.gI=!0,O.Task.delay(F).continueWith(()=>{this.jTb?this.mde():this.ZZ(!0);this.gI=!1})):this.jTb?this.hide():this.ZZ()}mde(){this.gI&&this.hide()}ZSd(){if(B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.s9&&P.c()){const F=appChrome.selectors.getShyState();return F.isActive&&0!==F.state}return!1}eG(F,na){F=this.qV;
this.ZSd()||2!==na.type&&(4!==na.type||3===F)?4===na.type&&3===F?(this.gI&&(this.gI=!1),this.s7a()):3!==na.type||3!==F||this.yZ||(1<this.IN?(this.gI=!0,O.Task.delay(250).continueWith(()=>{this.ZZ(!0);this.gI=!1})):this.s7a()):(this.gI&&(this.gI=!1),3!==F&&(this.Y3b(),3===na.Zi.Wf&&this.s7a(2E3)));this.raiseEvent(n.a.np,na)}faa(F){3===F.Wf?this.eG(this,new n.a(4,F)):F.eventName===A.a.pointerOver?this.eG(this,new n.a(2,F)):F.eventName===A.a.pointerOut&&this.eG(this,new n.a(3,F));return!1}Rjb(F){this.element.style.width=
F+"px";this.element.style.height=this.QS+"px"}poa(F){this.Eoc(F);F=this.fT(F);if(!(0>F)){var na=this.Df[F];Array.removeAt(this.Df,F);delete this.zAa[na.clientId];na=this.ft[F];this.jF.removeChild(na.element);this.Jc.get(18,!1)&&na.k1(Object(e.a)(this,this.eG,"onInteractivityChanged"));Array.removeAt(this.ft,F);na.dispose()}}Loc(F=5){if(this.Aha.length){this.visible&&this.RN();for(let na=0;na<this.Aha.length;na++)this.poa(this.Aha[na]);Array.clear(this.Aha);0>=this.Df.length||5===F?this.hide():0===
F&&this.nga()}}fT(F){for(let na=0;na<this.Df.length;na++)if(this.Df[na].clientId===F)return na;return-1}IOd(F){if(-1===this.fT(F))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.$M,F)){if(this.Df[0].clientId===F)return;Array.remove(this.$M,F)}Array.add(this.$M,F);this.Cgb(F);1!==this.qV&&this.ZZ()}}Eoc(F){-1===this.fT(F)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.$M,
F)&&(Array.remove(this.$M,F),this.Df[0].clientId===F&&0<this.$M.length&&this.Cgb(this.$M[this.$M.length-1]),this.Df[0].clientId===F&&1===this.qV&&this.ZZ())}Fqc(F){F?Sys.UI.DomElement.addCssClass(this.jF,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.jF,"prBackgroundSelection")}mWe(){let F,na;na=F=0;var ka=this.Wga;if(this.cYb){const Ua=this.cYb(this);if(!Ua)return{offsetX:F,offsetY:na,r8b:ka};const za=4===this.qV;ka=this.XId.A8d(this.IN,za?6:this.QS,this.QS,150,2,this.element,Ua);
na=ka.offsetTop;this.FAa=this.r8d(ka.mvc,ka.offsetTop);ka=ka.s8b;ka!==this.Wga&&(this.ejb(ka),this.element.dir=3===ka?"rtl":"ltr",this.Wga=ka);ka!==this.H5b()?(F=this.bJd?-2:za?-6:-this.QS,this.B7=!0):this.B7=!1}return{offsetX:F,offsetY:na,r8b:ka}}r8d(F,na){if(1===F)return this.IN-1;F=Math.abs(na);return 0<F?F/(this.QS+2):0}ejb(F){for(let na=0;na<this.IN;na++)this.ft[na].ejb(F)}H5b(){return this.Xi?3:4}static p9a(){return String.format("{0}-{1}","presencetooltip",da.Gha++)}static e$a(F){return F.qc.rawEvent.relatedTarget}}
da.Gha=0;Object(J.a)(da,"ModernPresenceTooltipControl",r.a,[515,106]);var fa=d(225),ma=d(289),ea=d(267);d.d(aa,"a",function(){return ra});class ra{constructor(F){this.Jc=F;this.Jc.MD(10,fa.a.instance);this.Jc.MD(9,ea.a.instance);this.Jc.MD(6,20);this.Jc.MD(13,ma.a.instance);this.Jc.MD(17,!1)}YLc(F,na){this.Jc.MD(15,!1);return new da(F,na,this.Jc)}eub(F){this.Jc.MD(15,!1);return new da(F,20,this.Jc)}}Object(J.a)(ra,"ModernPresenceTooltipFactory",null,[505])},1148:function(J,aa,d){J=d(0);var h=d(14),
e=d(1204),r=d(238),n=d(239),v=d(67),B=d(97);class y extends r.a{constructor(D,Q){super(D);this.Df=null;this.nI=Q.get(8,!1);this.hS=Q.get(6,0);this.element=D;this.element.className=y.c9a;this.I5a=this.createElement("ul");this.element.appendChild(this.I5a);this.Nn=Q.get(10);this.Nn.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.$o=Q.get(9);this.$o.pb(v.a.pointerOut,this.element,Object(h.a)(this,this.Cz,"onPointerOut"));this.$o.pb(v.a.pointerDown,this.element,Object(h.a)(this,
this.Qx,"stopPropagationAndPreventDefaultBehavior"));this.dN=Q.get(13);this.dN.pb(this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior"))}fW(D){this.addHandler(n.a.np,D)}k1(D){this.removeHandler(n.a.np,D)}get bba(){return this.Df}dispose(){this.element&&(this.Nn.yb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.$o.yb(v.a.pointerDown,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(v.a.pointerOut,this.element,
Object(h.a)(this,this.Cz,"onPointerOut")),this.dN.yb(this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(D,Q,Z){this.hide();!D||0>=D.length||(this.nI?this.element.style.right=Q+"px":this.element.style.left=Q+"px",this.element.style.top=Z+"px",this.JPd(D),this.visible=!0)}JPd(D){this.Df=D;B.a.Cu(this.I5a);for(let Q=D.length-1;0<=Q;Q--)this.Yx(D[Q])}Yx(D){const Q=document.createElement("li");Q.style.backgroundColor=D.color;
Q.style.height=this.hS+"px";Q.id="fly_"+D.clientId;Q.style.lineHeight=this.hS+"px";B.a.Nx(Q,D.userName);Q.setAttribute("dir","auto");this.I5a.appendChild(Q)}onClick(){this.hide();return!1}Cz(D){this.raiseEvent(n.a.np,new n.a(3,D));return!1}}y.c9a="prFlyout UIFont";Object(J.a)(y,"PresenceTooltipFlyoutControl",r.a,[]);var x=d(75);class A extends r.a{constructor(D,Q,Z){super(D);this.iN=null;this.Df=[];this.element.className="prGlyph";this.Jc=Q;this.z7=this.Jc.get(9);this.yn=this.Jc.get(10);this.dN=this.Jc.get(13);
this.rde();this.Yx(Z);this.J3a=!1}get TO(){return this.Df.length}get bba(){return this.Df}fW(D){this.addHandler(n.a.np,D)}k1(D){this.removeHandler(n.a.np,D)}dispose(){this.I4e();super.dispose()}Yx(D){Array.add(this.Df,D);2===this.TO?this.Zaa(!0):1===this.TO?this.Zaa(!1):this.Zaa(this.J3a)}TJ(D){this.a4d(D)&&(1<this.TO&&this.Zaa(!0),1===this.TO?this.Zaa(!1):1>this.TO&&this.hide())}show(){this.Zaa(2<=this.TO);this.visible=!0}hide(){this.visible=!1}n8d(D){return D?this.z5b(0,5):this.z5b(1,4)}a4d(D){for(let Q=
0;Q<this.TO;Q++)if(this.Df[Q].clientId===D)return D=this.Df[Q],Array.removeAt(this.Df,Q),D;return null}Zaa(D){this.J3a!==D&&(this.iN&&this.element.removeChild(this.iN),this.iN=this.n8d(D),this.element.appendChild(this.iN),this.J3a=D);this.iN.childNodes[0].style.backgroundColor=this.Df[this.Df.length-1].color}z5b(D,Q){const Z=this.Jc.get(6,0),P=this.Jc.get(14);return x.createClusteredImageFromClusterWithImageClass(Z,Z,this.Jc.get(D),this.Jc.get(Q),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,
P?P.cloneNode(!0):null)}cD(D){3!==D.Wf&&this.raiseEvent(n.a.np,new n.a(2,D));return!1}onClick(D){this.raiseEvent(n.a.np,new n.a(1,D));return!0}Cz(D){3!==D.Wf&&this.raiseEvent(n.a.np,new n.a(3,D));return!1}I4e(){this.element&&(this.z7.yb(v.a.pointerDown,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.z7.yb(v.a.pointerOver,this.element,Object(h.a)(this,this.cD,"onPointerOver")),this.z7.yb(v.a.pointerOut,this.element,Object(h.a)(this,this.Cz,"onPointerOut")),this.yn.yb(v.a.doubleClick,
this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.yn.yb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.dN.yb(this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")))}rde(){this.element&&(this.z7.pb(v.a.pointerDown,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.z7.pb(v.a.pointerOver,this.element,Object(h.a)(this,this.cD,"onPointerOver")),this.z7.pb(v.a.pointerOut,this.element,
Object(h.a)(this,this.Cz,"onPointerOut")),this.yn.pb(v.a.doubleClick,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.yn.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.dN.pb(this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")))}}Object(J.a)(A,"PresenceTooltipGlyph",r.a,[]);var E=d(118);d(65);var u=d(195);class K extends r.a{constructor(D,Q,Z){super(D);this.Df=[];this.gm=[];this.kI=0;this.iia=this.g7=!1;
this.pQb=null;this.zha={};this.Jc=Z;this.Xi=Z.get(8,!1);this.BG=Z.get(11,!1);D=Z.get(12,0);this.imageDimension=Z.get(6,0);this.k5a=Q;this.element.id=K.p9a();this.element.className=r.a.nub("prControl",this.Xi);D&&(this.zIndex=D);this.rtl=this.Xi;this.Rjb(Q);this.Lz=this.createElement("div");this.Lz.className=this.BG?"prContainerV":"prContainerHr";this.element.appendChild(this.Lz);this.ISb=Array(this.kI);for(Q=0;Q<this.kI;Q++)this.kw[Q]=new y(this.createElement("div"),this.Jc),this.kw[Q].fW(Object(h.a)(this,
this.eG,"onInteractivityChanged")),this.element.appendChild(this.kw[Q].element)}get Xhb(){return u.a.clone(this.Df)}getGlyph(D){return this.zha[D]}get kw(){return this.ISb}get xYb(){return this.pQb}get xLa(){return this.imageDimension+2}get width(){return this.BG?this.xLa:this.k5a}get height(){return this.BG?this.k5a:this.xLa}fW(D){this.addHandler(n.a.np,D)}k1(D){this.removeHandler(n.a.np,D)}dispose(){if(this.kw)for(const D of this.kw)D.k1(Object(h.a)(this,this.eG,"onInteractivityChanged")),E.a.Kx(D);
E.a.Knd(this.gm);this.gm=this.ISb=null;super.dispose()}nga(){this.RN();this.Fkb();this.visible=!0;this.g7=!1}Hkb(){!this.gm||1>this.gm.length||(this.RN(),this.visible=!0,this.Fkb(),this.PJa(this.gm[this.gm.length-1]),this.g7=!0)}Kya(){if(this.gm&&!(1>this.gm.length)){this.visible=!0;this.Fkb();var D=0;for(const Q of this.gm)this.PJa(Q,D++);this.g7=!1;this.iia=!0}}hide(){this.visible=!1;this.RN();for(let D=0;D<this.gm.length;D++)this.gm[D].hide();this.g7=!1}c0b(){if(!this.iia)return!1;let D=0;for(const Q of this.kw)Q.visible&&
D++;return this.iia=0<D&&(this.Df.length<=this.kI?D===this.Df.length:D===this.kI)}Yx(D){if(!(0>=this.kI)){D.clientId||(D.clientId=(K.Gha++).toString());if(D.clientId in this.zha){var Q=this.fT(D.clientId);if(0<=Q){Q=this.Df[Q];if(Q.color===D.color&&Q.userName===D.userName)return;this.TJ(D.clientId)}}Q=this.c0b();var Z=0;if(this.Df.length<this.kI){var P=new A(this.createElement("div"),this.Jc,D);P.fW(Object(h.a)(this,this.eG,"onInteractivityChanged"));this.Xi&&!this.BG&&0<this.Df.length?this.Lz.insertBefore(P.element,
this.Lz.firstChild):(this.Lz.appendChild(P.element),Z=this.gm.length);Array.add(this.gm,P)}else this.Xi&&!this.BG?P=this.gm[0]:(Z=this.gm.length-1,P=this.gm[Z]),P.Yx(D);P.show();this.zha[D.clientId]=P;Array.add(this.Df,D);this.Kuc(P,Z);Q&&this.Kya()}}TJ(D){const Q=this.c0b();Q&&this.RN();this.poa(D);this.Df.length>=this.kI&&this.gm.length<this.kI&&this.bQe();0>=this.Df.length?this.hide():Q&&this.Kya()}Cgb(){}poa(D){var Q=this.fT(D);0>Q||(D=this.Df[Q],Array.removeAt(this.Df,Q),Q=this.zha[D.clientId],
delete this.zha[D.clientId],Q.TJ(D.clientId),this.Kuc(Q),0>=Q.TO&&(this.Lz.removeChild(Q.element),Array.remove(this.gm,Q),Q.dispose()))}mkb(){}bQe(){var D=this.y9d();!D||1>=D.bba.length||(D=Array.clone(this.Df),D.forEach(Q=>{this.poa(Q.clientId)}),D.forEach(Q=>{this.Yx(Q)}))}fT(D){for(let Q=0;Q<this.Df.length;Q++)if(this.Df[Q].clientId===D)return Q;return-1}y9d(){return this.Xi&&!this.BG?this.gm[0]:this.gm[this.gm.length-1]}position(D,Q){this.element.style.top=Q+"px";this.element.style.left=D+"px"}Fkb(){for(let D=
0;D<this.gm.length;D++)this.gm[D].show()}RN(){for(let D=0;D<this.kI;D++)this.kw[D].hide();this.iia=!1}PJa(D,Q=0){if(D)if(this.pQb=D,this.BG){const Z=this.imageDimension;if(1<D.bba.length)this.kw[Q].show(D.bba,Z,this.height-this.imageDimension);else{const P=this.Lz.children.length;for(let ca=0;ca<this.Lz.children.length;ca++)D.element===this.Lz.children[ca]&&this.kw[Q].show(D.bba,Z,this.height-(P-ca)*this.xLa+2)}}else this.kw[Q].show(D.bba,this.width,0)}eG(D,Q){var Z=Object(e.a)(A,D);Z=Z?this.p4b(Z):
-1;if(2===Q.type||1===Q.type&&-1!==Z&&!this.kw[Z].visible)this.PJa(D);else if(1===Q.type)this.RN(),this.g7=!1;else if(3===Q.type){if(this.S3b(Q.Zi))return;this.g7||this.RN()}this.raiseEvent(n.a.np,Q)}S3b(D){D=K.e$a(D);let Q=!1;for(const Z of this.kw)if(B.a.nua(Z.element,D)){Q=!0;break}return this.Lz!==D&&B.a.nua(this.Lz,D)||Q}Kuc(D,Q=0){const Z=this.Tie(D);Z&&0>=D.TO?this.kw[Q].hide():Z?this.PJa(D):this.kw[Q].hide()}p4b(D){let Q=0;for(const Z of this.gm){if(D===Z)return Q;Q++}return-1}Tie(D){const Q=
this.p4b(D);return!!this.xYb&&D===this.xYb&&-1!==Q&&this.kw[Q].visible}Rjb(D){this.kI=D===this.imageDimension?1:Math.floor(D/this.xLa);this.BG?(this.element.style.height=D+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=D+"px",this.element.style.height=this.imageDimension+"px")}static p9a(){return String.format("{0}-{1}","presencetooltip",K.Gha++)}static e$a(D){D=D.qc.rawEvent;return D.relatedTarget||D.toElement}}K.Gha=0;Object(J.a)(K,"PresenceTooltipControl",r.a,
[515,106]);var G=d(225),O=d(289),R=d(267);d.d(aa,"a",function(){return V});class V{constructor(D){this.Jc=D;this.Jc.MD(10,G.a.instance);this.Jc.MD(9,R.a.instance);this.Jc.MD(6,16);this.Jc.MD(13,O.a.instance)}YLc(D,Q){return new K(D,Q,this.Jc)}eub(D){return new K(D,16,this.Jc)}}Object(J.a)(V,"PresenceTooltipFactory",null,[505])},1247:function(J,aa,d){d.r(aa);var h=d(0),e=d(387),r=d(14),n=d(18),v=d(78),B=d(82),y=d(37),x=d(2);class A{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,zc=!1){this.NMa=null;this.JBd=
!0;this.cJd=this.xS=this.jyd=null;this.Pa=new v.a;this.NXh=Ta;this.Snf=xb;this.amf=kc;this.$lf=Nc;this.U8e=Ed;A.$d=id;this.IZh=Ja;this.wOa=db;this.z_h=zc;x.Task.WAA(xb,kc).continueWith(Object(r.a)(this,this.FEj,"initOnTaskReady"))}Ufh(){this.Pa.raiseEvent("u",null,this)}FEj(){this.Snf.result&&this.amf.result&&(this.xS=this.Snf.result,this.cJd=this.amf.result,this.xS.fHc(Object(r.a)(this,this.Kkc,"onPresenceUpdated")),this.jyd=new B.a(2,2,this.U8e,Object(r.a)(this,this.cEl,"updateAwayClientsTask"),
88),A.$d.Db(this.jyd))}Kkc(Ta,xb){(this.JBd||this.GSk(xb.DPb))&&A.$d.Y5(this.jyd,0)}GSk(Ta){for(let kc in Ta){var xb=this.$lf.Z5f({key:kc,value:Ta[kc]});if(xb&&xb.clientId&&(xb=xb.clientId.toLowerCase(),(xb=this.NMa[xb]||this.NMa[xb.toUpperCase()])&&2===xb.status))return!0}return!1}cEl(Ta){var xb=this.xS.s4i();if(xb){var kc=new Date,Nc=!1;if(this.JBd){this.NMa=xb;this.JBd=!1;var id=this.NMa;for(var Ed in id){xb=Ed;var Ja=id[Ed];Ja.VAb<kc&&(kc=Ja.VAb);2===Ja.status&&(Nc=!0,this.cJd.Sld(xb))}Nc&&this.Ufh();
A.$d.Y5(Ta,this.T4f(kc))}else{Ja=new n.a;Ed=!1;var db=this.NMa;for(id in db){db=id;if(!(db in this.NMa)||this.NXh.clientId===db)continue;var zc=this.NMa[db];const Hd=xb[db];if(zc&&Hd){zc=zc.status;const Ad=Hd.status;2===zc&&1===Ad?(Ja.add(db),e.ULS.sendTraceTag(38052609,392,50,db+" returned from away")):1===zc&&2===Ad&&(Ed=Nc=!0,this.cJd.Sld(db),e.ULS.sendTraceTag(38052610,392,50,db+" went away"));1===Ad&&Hd.VAb<kc&&(kc=Hd.VAb)}}this.NMa=xb;A.$d.Y5(Ta,this.T4f(kc));(0<Ja.count||Nc)&&this.Ufh();0<
Ja.count&&!this.z_h?(Ta=this.G6i(Ja),this.Dxl(Ta)):Ta=new n.a;(Ed||0<Ta.count)&&this.IZh(y.a.r7a,2)}}}Dxl(Ta){if(Ta.count)for(let xb of Ta)Ta=this.wOa.LCa(String.format(CommonUIStrings.l_EditorsToastArriving,xb),!1),Ta.image=5,Ta.Cda="CoAuth_AuthorStatus_16x16x32",this.wOa.$h(Ta)}G6i(Ta){const xb=this.xS.HRc(),kc=new n.a;for(let Nc in xb){const id={key:Nc,value:xb[Nc]};if(Ta.contains(id.key)){const Ed=this.$lf.Z5f(id);Ed&&(kc.add(Ed.userName),Ta.remove(id.key))}}kc.count||e.ULS.sendTraceTag(38052611,
392,10,"There were no coauthor names found");return kc}T4f(Ta){return Math.max(Ta.getTime()+this.U8e-(new Date).getTime(),0)}}A.$d=null;Object(h.a)(A,"AwayManager",null,[]);var E=d(578),u=d(27),K=d(291),G=d(57),O=d(338),R=d(71),V=d(1142),D=d(1066),Q=d(1E3),Z=d(708),P=d(706),ca=d(190),T=d(999),da=d(29),fa=d(553),ma=d(211),ea=d(28),ra=d(785),F=d(47),na=d(1204),ka=d(24),Ua=d(956),za=d(378),ha=d(40),ua=d(63);class Ga{constructor(Ta,xb){this.shapeNode=Ta;this.Xyh=xb}}Object(h.a)(Ga,"ShapeNodeStartEditingNotificationTracking",
null,[]);class sa{constructor(Ta,xb,kc,Nc,id="",Ed=""){if(!Ta||!xb||0>kc)throw Error.argumentNull("LockEntry");this.zw=Ta;this.xB=xb;this.efa=kc;this.xck=Nc;this.LVg=id;this.CVg=Ed;this.WGg=new Date}get clientId(){return this.zw}get Drd(){return this.xB}get shapeId(){return this.efa}get lockType(){return this.xck}get FBh(){return this.LVg}get rBh(){return this.CVg}get Nng(){return!F.a.Wa(this.CVg)&&!F.a.Wa(this.LVg)}get Kpg(){return this.WGg}set Kpg(Ta){this.WGg=Ta}}Object(h.a)(sa,"LockEntry",null,
[]);class Ba{constructor(Ta,xb,kc,Nc,id="",Ed=""){this.clientId=Ta;this.slideId=xb;this.shapeId=kc;this.lockType=Nc;this.rowId=id;this.cellId=Ed}}Object(h.a)(Ba,"SerializableLockData",null,[]);var pa=d(186),ia=d(218);class Da{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,zc,Hd,Ad,Kd,Pc,tf,xe,ef,Id,qe,jg,of,Cb,Df){this.vqj=new E.a("",ResourceStrings.L_GhostUserName,Ua.a.CNf,new ra.a(1));this.SDb={};this.TDb={};this.RDb={};this.BGg=da.App.Ym;this.vye=null;this.HBe={};this.h3c={};this.k3c={};this.CGg=da.App.Ym;
this.uVg=!0;this.PIg=this.UHg=0;this.i9c=(new Date(0)).getTime();this.j9c=(new Date(0)).getTime();this.mgc=(new Date(0)).getTime();this.Vze=(new Date(0)).getTime();this.tVg=!1;this.cWa=Ta;this.tE=xb;this.aEb=kc;this.dhc=Nc;this.Vb=id;this.zb=Ed;this.pa=Ja;this.e8j=db;this.lr=zc;this.Ea=Hd;this.yc=Ad;this.ugc=Kd;this.cse=Pc.xig;this.Hs=tf;this.gY=xe;this.ua=ef;this.WTg=Id;this.ld=qe;this.ld.Sbi(Object(r.a)(this,this.nzk,"onShapeViewElementRequestUpdateAuthorInfo"));(this.Jv=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&
this.pa.KG(Object(r.a)(this,this.EH,"onSelectionChanged"));this.dhc.WBa(Object(r.a)(this,this.flc,"onUpdateNotificationReceived"));this.Cjk=jg;this.Te=of;this.Aik=Cb;this.Ha=Pc;this.UXa=Df;this.LEj()}LEj(){ea.a.J(509219588,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.cse,this.Hs.E5j());this.Hs.o0d||(0<this.Hs.Oib?this.zb.Db(new B.a(2,2,this.Hs.Oib,Object(r.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):ea.a.J(509219587,
804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.Hs.XNb?(this.zb.Db(new B.a(2,2,this.Hs.XNb/2,Object(r.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.uVg=!1):ea.a.J(509219586,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.Hs.N8b?this.zb.Db(new B.a(2,2,this.Hs.N8b,Object(r.a)(this,this.updateLockIfImeActive,"updateLockIfImeActive"),90,"73")):ea.a.J(509219585,804,50,"IME typing lock notification disabled"),
0<this.Hs.pgb?this.zb.Db(new B.a(2,2,this.Hs.pgb,Object(r.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):ea.a.J(509219584,804,50,"Lock leack detection is disabled"),this.e8j.addHandler(za.a.lIf,(Ta,xb)=>{this.Jxi(xb)}),this.Hs.ONc||this.Osc||(this.ugc.UBa(Object(r.a)(this,this.Q2g,"onBeforeParagraphNodePropertyChanged")),0<this.Hs.$lb?this.zb.Db(new B.a(2,2,this.Hs.$lb,Object(r.a)(this,this.updateLockForActiveShapeNodes,"updateLockForActiveShapeNodes"),90,"75")):ea.a.J(509219555,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),
this.Osc&&(this.Aik.UBa(Object(r.a)(this,this.Ugd,"onTableCellNodePropertyChanged")),this.ugc.UBa(Object(r.a)(this,this.Q2g,"onBeforeParagraphNodePropertyChanged")),this.Cjk.initialize(),0<this.Hs.$lb&&this.zb.Db(new B.a(2,2,this.Hs.$lb,Object(r.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),90,"76")),0<this.Hs.Oib&&this.zb.Db(new B.a(2,2,this.Hs.Oib,Object(r.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get Osc(){return this.Hs.J1d&&
this.Hs.hSf}removeExpiredLock(){var Ta=ia.a(this.SDb);for(const xb of Ta){Ta=Object(na.a)(117,this.SDb[xb]);if(!Ta){delete this.SDb[xb];continue}const kc=Ta.shapeNode;kc&&kc.isConnected?this.gY.a2f(kc)||this.Ojd(xb)||(delete this.SDb[xb],this.gY.J5b(kc)||Ta.Al?ea.a.J(509219554,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):this.zGh(Ta)):delete this.SDb[xb]}}removeExpiredTableCellLock(){var Ta=ia.a(this.TDb);for(const xb of Ta){Ta=Object(na.a)(1120,this.TDb[xb]);
if(!Ta){delete this.TDb[xb];continue}const kc=Ta.tableCellNode;kc&&kc.isConnected?F.a.Wa(this.gY.w5b(kc))&&!this.Ojd(xb)&&(delete this.TDb[xb],this.AGh(Ta)):delete this.TDb[xb]}}detectLockLeak(){const Ta=[],xb=new Date,kc=this.t9f();for(const Nc of kc)Nc.aq&&+xb-+Nc.v2c>this.Hs.pgb&&Ta.push(Nc.shapeNode.Er);0<Ta.length&&ea.a.J(509219553,828,15,"Following objects are locked longer than {0} : {1}",this.Hs.pgb,Ta.join(";"))}switchPendingSveToFidelity(){const Ta=new Date,xb=this.t9f();for(const kc of xb)kc.aq||
kc.shapeNode.ud&&this.Osc||!kc.Wn||kc.jy||!(+Ta-+kc.x2j>this.Hs.XNb)||kc.fB||kc.WNb()}updateLockIfImeActive(){if(this.BGg>=this.CGg&&this.vye){const Ta=this.AZi(this.vye);this.Zvd(Ta)&&this.iqc(Ta.slideId,Ta.get_shapeId(),2)}this.CGg=new Date}updateLockForActiveShapeNodes(){var Ta=ia.a(this.h3c);for(const xb of Ta)Ta=Object(na.a)(4,this.h3c[xb]),this.Zvd(Ta)&&this.iqc(Ta.slideId,Ta.get_shapeId(),3);this.h3c={}}updateLockForActiveTableCellNodes(){var Ta=ia.a(this.k3c);for(const xb of Ta)if(Ta=Object(na.a)(125,
this.k3c[xb]),this.Zvd(Ta)){const kc=this.Ea.en(Ta);this.iqc(kc.slideId,kc.get_shapeId(),3,Ta.rowId.toString(),Ta.cellId.toString())}this.k3c={}}AZi(Ta){return(Ta=this.lr.KI(Ta))?this.Ea.en(Ta.gb):null}Q2g(Ta,xb){xb&&xb.node?(Ta=Object(na.a)(5,xb.node),Ta)?Ta.loading||Ta.bnc||xb.property.id!==ha.a.pq.id||(xb=this.Ea.oda(Ta),Ta=this.yc.wEa(Ta),xb&&(Ta?(xb=this.aSc(xb.slideId,xb.get_shapeId(),Ta.rowId.toString(),Ta.cellId.toString()),this.k3c[xb]=Ta):(Ta=this.Jxb(xb.slideId,xb.get_shapeId()),this.h3c[Ta]=
xb))):ea.a.J(509219551,828,10,"Invalid argument."):ea.a.J(509219552,828,10,"Invalid argument.")}D7k(Ta){const xb=new B.a(2,1,this.Hs.Rrd,Object(r.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");xb.customData=new Ga(Ta,!1);this.zb.Db(xb);this.HBe[this.Jxb(Ta.slideId,Ta.get_shapeId())]=xb}rtcNotifyStartEditing(Ta){Ta=Object(na.a)(Ga,Ta.customData);const xb=Ta.shapeNode;this.Zvd(xb)&&this.tWj(xb)&&this.iqc(xb.slideId,xb.get_shapeId(),1);Ta.Xyh=!0}Zvd(Ta){return Ta?Ta.isConnected:
!1}tWj(Ta){return(Ta=this.$k(Ta))?Ta.fO:!1}$k(Ta){return Object(na.a)(117,Ta.ng(this.Vb.Dn.Ma))}t9f(){const Ta=[];if(!this.ua.Ba)return Ta;var xb=this.ua.Ba.gk();if(!xb)return Ta;for(const kc of xb)(xb=this.$k(kc))&&!xb.Al?Ta.push(xb):ea.a.J(509219549,828,50,"Shape {0} on active slide doesn't have valid view element",kc.Er);return Ta}dzk(Ta){this.rvh(Ta)&&(this.cWa.amIAlone||this.D7k(Ta))}EH(Ta,xb){for(Ta=0;Ta<xb.EE.length;Ta++){const Nc=xb.EE[Ta];var kc=Object(na.a)(4,Nc.context.node);kc&&kc.isConnected&&
(kc=Object(na.a)(117,kc.sc(this.Te)))&&(kc=this.WTg.IF(kc.shapeNode))&&(1===Nc.Oca?kc.wjc():0===Nc.Oca&&kc.vFe())}}czk(Ta){if(this.rvh(Ta)&&!this.Hs.MNc){var xb=this.Jxb(Ta.slideId,Ta.get_shapeId()),kc=Object(na.a)(B.a,this.HBe[xb]);if(kc){const Nc=Object(na.a)(Ga,kc.customData);this.zb.Mg(kc);Nc&&Nc.Xyh&&this.iqc(Ta.slideId,Ta.get_shapeId(),4);this.HBe[xb]=null}}}nzk(Ta,xb){this.f8g(xb.Px)}f8g(Ta){Ta.uL()||Ta.shapeNode.Fab?this.u7h(Ta):this.g8g(Ta)}Ugd(Ta,xb){if((xb=Object(na.a)(pa.TableCellNode,
xb.node))&&(Ta=Object(na.a)(1120,xb.ng(this.Te)))&&xb.isConnected){xb=this.gY.w5b(xb);const kc=this.tOe(Ta.tableCellNode);F.a.Wa(xb)?kc?(this.Moe(Ta,this.lka(kc.clientId,Da.v1d)),this.B5e(Ta)):F.a.Wa(xb)&&(this.tOe(Ta.tableCellNode)||this.AGh(Ta)):(this.Moe(Ta,this.lka(xb,Da.v1d)),this.B5e(Ta))}}Moe(Ta,xb){Ta.lock(xb)}AGh(Ta){Ta.unlock()}iqc(Ta,xb,kc,Nc="",id=""){try{const Ed=new Ba(this.aEb,Ta.Avc,xb,kc,Nc,id);this.dhc.dga(7,Ed)}catch(Ed){ea.a.J(509219548,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",
this.aEb,Ed.stack)}}flc(Ta,xb){this.Ha.pptCoauthSurveyFloodgateEnabled&&!this.tVg&&8===xb.type&&this.UXa&&this.hll(xb)&&(ea.a.J(509219547,814,50,"Log coauth activity"),this.tVg=!0,this.UXa.continueWith(()=>{this.UXa.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===xb.type&&((Ta=xb.Eza)?Ta.clientId===this.aEb?ea.a.J(509219545,828,15,"Lock notification : lock notification from myself recieved"):(ea.a.J(509219544,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",
Ta.clientId,this.aEb),Ta=new sa(Ta.clientId,Ta.slideId,Ta.shapeId,Ta.lockType,Ta.rowId,Ta.cellId),this.J7h(Ta),this.$Lk(Ta)):ea.a.J(509219546,828,10,"Lock notification: invalid lock data recieved"))}g8g(Ta){if(!Ta||Ta.Al)ea.a.J(509219543,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Ta);else{var xb=Ta.shapeNode;if(!(xb.Qf||this.cse&&xb.ud&&(this.Hs.Rub||this.Osc))){var kc=this.gY.J5b(xb);kc?this.u2c(Ta,this.lka(kc,Da.v1d)):(xb=this.gY.a2f(xb))?(this.u2c(Ta,this.lka(xb,Da.VQi)),
this.A5e(Ta)):(xb=this.tOe(Ta.shapeNode))?(this.u2c(Ta,this.lka(xb.clientId,this.S8d(xb.lockType))),this.A5e(Ta)):Ta.aq&&this.zGh(Ta)}}}zGh(Ta){const xb=this.WTg.IF(Ta.shapeNode);xb&&(xb.wvd(null),Ta.unlock(this.uVg||!xb.Hce))}u2c(Ta,xb){Ta.lock(xb);Ta.uL()&&this.pa.Rh()}hll(Ta){if(!Ta||null===Ta.Eza)return!1;Ta=this.AEk(Ta.Eza);for(const xb of Ta)xb&&xb.clientId&&(xb.clientId.toLowerCase()===this.aEb.toLowerCase()?(this.UHg++,this.i9c=this.i9c===(new Date(0)).getTime()?(new Date).getTime():this.i9c,
this.j9c=(new Date).getTime()):this.ARj(xb.clientId)||(this.PIg++,this.mgc=this.mgc===(new Date(0)).getTime()?(new Date).getTime():this.mgc,this.Vze=(new Date).getTime()));return 5<=this.UHg&&5<=this.PIg&&(this.Vze>=this.i9c&&this.mgc<=this.j9c||this.j9c>=this.mgc&&this.j9c<=this.Vze)&&1<=this.tE.uxb()?!0:!1}AEk(Ta){let xb=null;try{xb=Ta}catch(kc){}if(null===xb||!xb.length){let kc=null;try{kc=Ta}catch(Nc){ea.a.J(509219541,828,10,"UpdateHint can't convert to RTC message.")}if(null!==kc)return[kc]}return xb}ARj(Ta){Ta=
this.lka(Ta);const xb=this.lka(this.aEb);return Ta&&xb&&Ta.userName===xb.userName&&Ta.email===xb.email?!0:!1}S8d(Ta){switch(Ta){case 1:return Da.Erl;case 2:return Da.kDj;case 3:return Da.iCl;case 4:return Da.lSi}ea.a.J(509219539,828,10,"Unknown lock type");return"Unknown lock type"}J7h(Ta){if(Ta&&Ta.Drd){var xb=Ta.Nng?this.aSc(new ua.a(Ta.Drd),Ta.shapeId,Ta.FBh,Ta.rBh):this.Jxb(new ua.a(Ta.Drd),Ta.shapeId);if(4===Ta.lockType)this.RDb[xb]=Ta;else{var kc=Object(na.a)(sa,this.RDb[xb]);kc?(kc=this.R8d(kc),
this.R8d(Ta)>kc&&(this.RDb[xb]=Ta)):this.RDb[xb]=Ta}}}R8d(Ta){return this.vdj(Ta.lockType)-(+new Date-+Ta.Kpg)}vdj(Ta){switch(Ta){case 1:return this.Hs.Qrd;case 2:return this.Hs.lXc;case 3:return this.Hs.Fud;case 4:return this.Hs.pvb}ea.a.J(509219536,828,10,"Unknown lock type");return 0}tOe(Ta){if(Object(ka.a)(4,Ta)){Ta=Object(na.a)(4,Ta);if(!Ta.slideId)return null;Ta=this.Jxb(Ta.slideId,Ta.get_shapeId());return this.Ojd(Ta)}if(Object(ka.a)(125,Ta)){Ta=Object(na.a)(125,Ta);let xb=this.Ea.oda(Ta);
if(!xb.slideId)return null;Ta=this.aSc(xb.slideId,xb.get_shapeId(),Ta.rowId.toString(),Ta.cellId.toString());return this.Ojd(Ta)}return null}Ojd(Ta){if(!Ta)return null;const xb=Object(na.a)(sa,this.RDb[Ta]);return xb?0>=this.R8d(xb)?this.RDb[Ta]=null:xb:null}A5e(Ta){const xb=this.lkj(Ta);xb&&(this.SDb[xb]=Ta)}B5e(Ta){const xb=this.Omj(Ta);xb&&(this.TDb[xb]=Ta)}lkj(Ta){return Ta?this.Jxb(Ta.shapeNode.slideId,Ta.shapeNode.get_shapeId()):null}Omj(Ta){if(!Ta)return null;Ta=Ta.tableCellNode;const xb=this.Ea.oda(Ta);
return this.aSc(xb.slideId,xb.get_shapeId(),Ta.rowId.toString(),Ta.cellId.toString())}Jxb(Ta,xb){return String.format("{0}#{1}#{2}",Ta.sid,Ta.cid,xb)}aSc(Ta,xb,kc,Nc){return String.format("{0}#{1}#{2}#{3}#{4}",Ta.sid,Ta.cid,xb,kc,Nc)}dRj(Ta){const xb=Object(na.a)(116,this.ua.Ba);return xb&&ua.a.Jxh(Ta.Drd,xb.Cb.Avc)?!0:!1}$Lk(Ta){if(this.dRj(Ta)){var xb=Ta.shapeId,kc=Ta.clientId;this.ua.Ba&&(xb=this.ua.Ba.lT(xb))&&(Ta.Nng&&this.Hs.J1d?this.mMk(Ta,kc,xb):this.gMk(Ta,kc,xb))}}gMk(Ta,xb,kc){kc.Qf||this.cse&&
kc.ud&&(this.Hs.Rub||this.Osc)||!(kc=this.$k(kc))||(this.u2c(kc,this.lka(xb,this.S8d(Ta.lockType))),this.A5e(kc))}mMk(Ta,xb,kc){if((kc=this.Qmj(kc,Ta.FBh,Ta.rBh))&&kc.isConnected){var Nc=Object(na.a)(1120,kc.ng(this.Te));Nc&&F.a.Wa(this.gY.w5b(kc))&&(this.Moe(Nc,this.lka(xb,this.S8d(Ta.lockType))),this.B5e(Nc))}}Qmj(Ta,xb,kc){Ta=this.yc.NN(Object(na.a)(4,Ta));if(!Ta)return null;var Nc=this.yc.tka(Ta);Ta=null;for(const id of Nc){Nc=this.yc.p$a(id);for(const Ed of Nc)if(Ed.rowId.toString()===xb&&Ed.cellId.toString()===
kc){Ta=Ed;break}}return Ta}u7h(Ta){const xb=new B.a(0,1,0,()=>{this.g8g(Ta)},90,"79");this.zb.Db(xb)}Jxi(Ta){this.BGg=new Date;this.vye=this.JYi(Ta.Ec)}JYi(Ta){return Ta?Ta.querySelector(".Paragraph"):null}lka(Ta,xb=""){const kc=this.tE.lka(Ta);if(kc)return kc;ea.a.J(509219531,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Ta,xb);return this.vqj}rvh(Ta){return!this.Hs.o0d&&!(this.Hs.Rub&&Ta.ud)&&!Ta.Qf}}Da.v1d="EditingBy";Da.VQi="EditingByInSameWorker";Da.Erl="StartEditing";
Da.lSi="EndEditing";Da.kDj="ImeTyping";Da.iCl="Typing";Object(h.a)(Da,"CoauthStateChangesHandler",null,[1251]);class Xa{constructor(Ta){this.Pua={};this.zw=Ta.bD;this.init(Ta)}init(Ta){if(Ta=Ta.i_)for(const xb of Ta)xb.ID!==this.zw&&(this.Pua[xb.ID]=new Date)}y6h(Ta){for(let xb=0;xb<Ta.length;xb++)Ta[xb]in this.Pua||Ta[xb]===this.zw||(this.Pua[Ta[xb]]=new Date)}Gsl(Ta){const xb=this.Pua[Ta];xb&&(ea.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.zw,Ta,(new Date).getTime()-xb.getTime()),delete this.Pua[Ta])}Fsl(Ta){const xb=this.Pua[Ta];xb&&(ea.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.zw,Ta,(new Date).getTime()-xb.getTime()),delete this.Pua[Ta])}Esl(){for(const Ta of Object.keys(this.Pua))ea.a.J(37590345,814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.zw,Ta,(new Date).getTime()-this.Pua[Ta].getTime());this.Pua={}}}Object(h.a)(Xa,"EditorPresenceTracker",null,[1250]);class Ka{constructor(Ta){this.jgk=Ta;this.nM=new D.a;this.nM.Kg(this.jgk)}}Object(h.a)(Ka,"PPTRtcProvider",null,[1249]);var Ma=d(109),Oa=d(1203),qa=d(703);class Ya{constructor(Ta,xb,kc,Nc,id){this.zea=null;this.gU=!1;this.Dre=this.bze=null;this.k8j=Ma.a.create();this.v5c=!1;this.w4b=0;this.nU=id;kc.vg&&(this.findSessionResponse=Ta,Nc.Fvf(Object(r.a)(this,this.C$k,"sessionPropertiesChanged")));
this.QGa=new Oa.a(()=>xb())}get findSessionResponse(){return this.zea}set findSessionResponse(Ta){if(this.gU)ea.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.zea=Ta)this.gU=!0,this.bze=this.zea.eIf,this.Dre=this.zea.RA}get jna(){return this.gU?this.bze:this.QGa.value.jna}set jna(Ta){this.gU?this.bze=Ta:this.QGa.value.jna=Ta}LWe(Ta){this.QGa.value.LWe(Ta)}get RA(){return this.gU?this.Dre:this.QGa.value.RA}set RA(Ta){this.gU?
this.Dre=Ta:this.QGa.value.RA=Ta}aTc(){let Ta;ea.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.gU,this.v5c);return this.gU?(Ta=this.zea.correlationId||this.k8j.toString(),ea.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",Ta),{returnValue:String.format("{0}&{1}={2}",this.zea.T5,u.AFrameworkApplication.RXd,F.a.Ne(Ta)),correlationId:Ta}):this.v5c?this.QGa.value.aTc():(ea.a.J(51140183,
814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}o$d(Ta,xb,kc,Nc,id){ea.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.gU);this.gU?(Ta(this.zea.V0b),kc(new qa.a(this.zea.idd,this.zea.fdd,this.zea.edd,this.zea.AVc))):(this.QGa.value.o$d(Ta,xb,kc,Nc,id),this.v5c=!0);this.nU&&this.nU.$h(26,!this.v5c)}G0d(){ea.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",
this.gU);this.gU?this.gU=!1:this.QGa.value.G0d()}Cna(Ta,xb){ea.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.gU);this.gU||this.QGa.value.Cna(Ta,xb)}C$k(){ea.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",this.gU);this.gU=!1}}Object(h.a)(Ya,"PptAssignRtcMachineStrategy",null,[1248]);var Fb=d(1160);class hc{constructor(){this.oo=null}cZb(Ta,xb){this.oo||(this.oo=
{});this.oo[xb]||(this.oo[xb]=0);this.oo[xb]+=Ta}getData(){return this.oo}reset(){this.oo=null}}Object(h.a)(hc,"MultiSumDataAggregator",null,[1527]);class ec{constructor(Ta,xb){this.Hxd=Fb.a.LW(Ta,xb,new hc,!0)}Ef(Ta){this.Hxd.track(1,Ta)}}Object(h.a)(ec,"MultiCounter",null,[1558]);class Tb{constructor(Ta,xb,kc,Nc){this.xz=Ta;this.Z4=xb;this.jjk=kc;this.kak=Nc;this.xz.WBa(Object(r.a)(this,this.G5k,"rtcOnUpdateNotificationReceived"))}G5k(Ta,xb){0===xb.type&&(this.kak.Ef("CU"),this.jjk||this.DF())}DF(){!u.AFrameworkApplication.Ug&&
this.Z4.kX&&this.Z4.DF(null,null,null)}}Object(h.a)(Tb,"ContentNotificationManager",null,[]);class vb extends Tb{constructor(Ta,xb,kc,Nc){super(Ta,xb,kc,Nc)}static init(){if(da.App.Kb){var Ta=da.App.Kb.Ld;if(Ta&&(Ta.Guf(vb.z2g),Ta=Ta.zi)&&(Ta=Ta.contentReplicator)){var xb=da.App.Jh;if(xb&&xb.vw&&(xb=G.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var kc=u.AFrameworkApplication.fa.ka("Box4ThrottleInboundRequests"),Nc=new ec(11,1);vb.W3c=vb.W3c||new vb(xb,Ta,kc,Nc);vb.W3c.DF()}}}}static z2g(Ta){vb.W3c||
(Ta.ajh(vb.z2g),vb.init())}}vb.W3c=null;Object(h.a)(vb,"PptContentNotificationManager",Tb,[]);var zb=d(105),Xb=d(346),Za;(function(Ta){Ta[Ta.signalRConnectFailed=0]="signalRConnectFailed";Ta[Ta.findSessionFailed=1]="findSessionFailed"})(Za||(Za={}));Object(h.b)("RtcConnectFailureType",Za);var Va=d(261);class tc{constructor(Ta,xb,kc,Nc,id,Ed){this.r9c=this.gIg=this.seb=this.reb=0;this.ceb=this.qHa=this.rma=this.ufc=this.N5c=this.k0=null;this.k6c=this.m6c=this.n6c=this.i6c=this.j6c=!1;this.dTg=Ta;this.xj=
xb;this.iR=kc;this.iR.TGc(Object(r.a)(this,this.tHb,"onNetworkHealthStateChanged"));this.Xj=Nc;this.DBe=Ed;$addHandler(window,"visibilitychange",Object(r.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.Xgk=id;this.Xgk.Ibi(Object(r.a)(this,this.zyk,"onRtcConnectFailed"))}tHb(Ta,xb){xb.y_c||(this.m6c=this.n6c=!0)}onVisibilityChange(){window.document.hidden&&(this.i6c=this.j6c=!0)}zyk(Ta,xb){Ta=xb.kXi;if(xb=xb.errorMessage){if(0===Ta){let Nc,id;({Ede:kc,Fde:Nc,$i:id}=ca.RtcUtils.SUf(xb.ErrorDetails));
xb.HttpErrorCode=kc;xb.HttpErrorStatus=Nc;xb.Exception=id;delete xb.ErrorDetails;if(!kc&&this.DBe&&0<this.DBe.length)try{var kc=!0;const Ed=window.location.hostname.toLowerCase();for(const Ja of this.DBe.split(";"))if(Ed.endsWith(Ja)){kc=!1;break}xb.IsCORS=kc.toString()}catch(Ed){xb.Unexpected=Ed.message}}ea.a.J(41445510,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",this.xj.amIAlone,window.document.hidden,
this.Xj.IQ,Za[Ta],zb.a.toJSON(xb));this.k6c||(this.k6c=this.zVj(Ta,xb))}}zVj(Ta,xb){const kc=Va.c(xb,"HttpErrorCode",-1);return 500<=kc&&599>=kc||1===Ta&&"FindSessionRequestFailed"!==xb.FindSessionFailureReason?!0:!1}jcg(){return this.k0&&1===this.seb?this.j6c||this.n6c:this.rma&&1<this.seb?this.i6c||this.m6c:!1}Czj(){return this.rma&&0<this.r9c?this.i6c||this.m6c:this.k0&&0<this.reb?this.j6c||this.n6c:!1}lld(){this.reb++;this.ufc=new Date;this.k0||(this.k0=new Date,this.j6c=window.document.hidden,
this.n6c=!this.Xj.IQ)}gQe(){this.ygh(0)}ygh(Ta){this.seb++;this.qHa=new Date;this.N5c?this.dLc>this.dTg.jnh&&(Ta={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.seb,["numberOfConnectionAttempts"]:this.reb,["firstConnectionAttempt"]:this.k0?this.k0.toISOString():"",["lastConnectionSuccess"]:this.qHa?this.qHa.toISOString():"",["lastUnexpectedDisconnect"]:this.rma?this.rma.toISOString():"",["lastExplicitDisconnect"]:this.ceb?this.ceb.toISOString():"",["reconnectDurationInMs"]:this.dLc,
["hasPageHiddenOrNetworkIssue"]:this.jcg()},ea.a.J(36804373,500,15,zb.a.toJSON(Ta))):(this.N5c=this.qHa,Xb.a.instance.jc("FirstPresenceUpdated",(new Date).getTime().toString()),this.dLc>this.dTg.jnh&&(Ta={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.reb,["firstConnectionAttempt"]:this.k0?this.k0.toISOString():"",["firstConnectionSuccess"]:this.N5c?this.N5c.toISOString():"",["lastExplicitDisconnect"]:this.ceb?this.ceb.toISOString():"",["connectDurationInMs"]:this.dLc,["connectionDurationFromStopWatchInMs"]:Ta,
["hasPageHiddenOrNetworkIssue"]:this.jcg()},ea.a.J(36804373,500,15,zb.a.toJSON(Ta))))}mld(){this.gIg++;const Ta={["numberOfFailedConnections"]:this.gIg,["numberOfConnectionAttempts"]:this.reb,["firstConnectionAttempt"]:this.k0?this.k0.toISOString():"",["lastConnectionAttempt"]:this.ufc?this.ufc.toISOString():"",["lastExplicitDisconnect"]:this.ceb?this.ceb.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),["disconnectedDurationMs"]:this.iOi,["hasPageHiddenOrNetworkIssue"]:this.Czj()};
this.k6c?e.ULS.sendTraceTag(41702299,500,15,zb.a.toJSON(Ta)):e.ULS.sendTraceTag(36804375,500,15,zb.a.toJSON(Ta))}joc(){this.r9c++;this.rma=new Date;this.i6c=window.document.hidden;this.m6c=!this.Xj.IQ}mTk(){this.Zjl()&&this.mld();this.ceb=new Date;this.Fui()}Fui(){this.r9c=this.seb=this.reb=0;this.qHa=this.rma=this.ufc=this.k0=null;this.k6c=!1}Zjl(){return!!this.ufc&&!this.qHa&&!this.rma}get dLc(){if(this.qHa){if(this.k0&&1===this.seb)return this.xj.jSc(this.k0,this.qHa);if(this.rma&&1<this.seb)return this.xj.jSc(this.rma,
this.qHa)}return 0}get iOi(){return this.rma&&0<this.r9c?this.xj.jSc(this.rma,new Date):this.k0&&0<this.reb?this.xj.jSc(this.k0,new Date):0}}Object(h.a)(tc,"PptRealtimeChannelMetrics",null,[1243]);var Kb=d(76),Pa=d(33),mb=d(39);class qc{constructor(Ta,xb,kc,Nc,id){this.kdk=Ta.toLowerCase();this.xHa=xb;this.Ml=kc;this.Gv=Nc;this.Nq=id;this.Gv.Gia(Object(r.a)(this,this.Skc,"onShapeNodeLoaded"));this.Nq.Kvf(Object(r.a)(this,this.Ukc,"onShapeViewElementUnlocked"))}dispose(){this.Gv.m_a(Object(r.a)(this,
this.Skc,"onShapeNodeLoaded"));this.Nq.Ujh(Object(r.a)(this,this.Ukc,"onShapeViewElementUnlocked"))}nC(Ta){return this.CAi(Ta)||this.OIf(Ta)}OIf(Ta){if(!Ta||Ta.Qf)return!1;const xb=Ta.sa(mb.a.u1d,"");return+new Date-+Ta.v2c<this.xHa&&!!xb&&xb.toLowerCase()!==this.kdk}CAi(Ta){return!!this.J5b(Ta)}a2f(Ta){let xb="";Ta&&this.OIf(Ta)&&(xb=Ta.eb(mb.a.u1d));return xb}J5b(Ta){return Ta?Ta.sa(mb.a.vRf,""):""}w5b(Ta){return Ta?Ta.sa(mb.a.kri,""):""}jHl(Ta){if(Ta&&(Ta.nC=this.nC(Ta),Ta.anchor)){const kc=this.Ml.jsa(Ta);
for(;kc.moveNext();){var xb=kc.currentNode;Pa.ParagraphReader.ae(xb)&&(xb=Object(na.a)(Kb.AParagraphNode,xb))&&(xb.nC=Ta.nC)}}}Ukc(Ta,xb){this.jHl(xb.Px.shapeNode)}Skc(Ta,xb){Ta=xb.node;Ta.cGl();Ta.nC=this.nC(Ta)}}Object(h.a)(qc,"PptWetChangeHandler",null,[1242,106]);class oc{constructor(Ta){this.Nfk=Ta}F3(){return this.Nfk.F3()}}Object(h.a)(oc,"PresenceCache",null,[]);var ib=d(669),$a=d(1141),Db=d(1228),Mb=d(1024),ob=d(1216);class jc extends v.a{constructor(){super();this.m$c=[]}Cia(Ta){Ta&&(ea.a.J(8958528,
814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Ta.clientId,Ta.presence.toString()),Array.add(this.m$c,Ta))}Sld(Ta){(Ta=this.x$a(Ta))&&this.sKb(Ta);return Ta}sKb(Ta){Ta&&(ea.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Ta.clientId,Ta.presence.toString()),Array.remove(this.m$c,Ta))}x$a(Ta){for(const xb of this.m$c)if(xb.clientId===Ta)return xb;return null}F3(){return this.m$c}}Object(h.a)(jc,"PresenceDataManager",v.a,[]);var Gb=d(41),
Gc=d(738);class bc{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,zc,Hd,Ad){this.clientId=Ta;this.data=Ja;this.chatThreadId=xb;this.chatThreadDiscoveryUri=kc;this.inChat=Nc;this.email=id;this.capabilities=Ed;this.userName=db;this.clientType=zc;this.fHasClientEverExperiencedNetworkLoss=Hd;this.isAnonymous=Ad}}Object(h.a)(bc,"SerializablePresenceInfo",null,[]);class dc{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,zc,Hd,Ad){this.Tgc=null;this.zw=Ta.toLowerCase();this.xB=xb;this.KAe=kc;this.Iug=Nc;this.Hug=id;this.qBg=Ed;
this.vdc=Ja;this.vug=db;this.fna=zc;this.aTg=Hd;this.pyg=Ad}x$d(){return new bc(this.zw,this.Iug,this.Hug,this.qBg,this.vdc,this.vug.capabilities,this.KAe?this.KAe.x$d():null,this.fna,this.aTg,this.pyg,u.AFrameworkApplication.kmb||u.AFrameworkApplication.PQ)}Nzj(Ta){if(!(Ta&&this.fk.equals(Ta.slideId)&&this.presence&&this.presence.UU))return!1;for(const xb of this.presence.UU)if(xb===Ta.get_shapeId())return!0;return!1}get presence(){return this.KAe}get clientId(){return this.zw}get chatThreadId(){return this.Iug}get chatThreadDiscoveryUri(){return this.Hug}get inChat(){return this.qBg}get email(){return this.vdc}get capabilities(){return this.vug}get fk(){return this.xB}get userName(){return this.fna}get clientType(){return this.aTg}get fHasClientEverExperiencedNetworkLoss(){return this.pyg}get presenceUser(){return this.Tgc}set presenceUser(Ta){this.Tgc&&
(Ta?!this.Tgc.client||0===this.Tgc.client||Ta.client&&0!==Ta.client||ea.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.zw):ea.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.zw));this.Tgc=Ta}static ZLc(Ta){if(!Ta||!Ta.clientId)return ea.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const xb=Gc.a.ZLc(Ta.data);let kc=0;Ta.clientType&&8>=Ta.clientType&&(kc=Ta.clientType);
return new dc(Ta.clientId,xb.fk,xb,Ta.chatThreadId,Ta.chatThreadDiscoveryUri,Ta.inChat,Ta.email,new ra.a(Ta.capabilities),Ta.userName,kc,Ta.fHasClientEverExperiencedNetworkLoss)}}Object(h.a)(dc,"PresenceEntry",null,[]);class Nb extends Sys.EventArgs{constructor(Ta,xb,kc,Nc,id,Ed){super();this.xB=Ta;this.Tjk=kc;this.Rad=xb;this.xUh=Nc;this.Vhk=id;this.Qfk=Ed}get slideId(){return this.xB}get user(){return this.Tjk}get shapes(){return this.Rad}get f9(){return this.xUh}get Wxh(){return this.Vhk}get sch(){return this.Qfk}}
Object(h.a)(Nb,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var Ac=d(30);class jb extends v.a{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,zc,Hd,Ad,Kd,Pc,tf,xe,ef,Id,qe,jg,of,Cb,Df,Bf,qg,vd,$f,ng){super();this.nR=new jc;this.To=null;this.zvg=[];this.Bvg=null;this.fCb=!0;this.Fdb=!1;this.PGg=new Date;this.eYa=null;this.Ayg=this.qyg=this.EAg=!1;this.l$c=null;this.n$=Ta;Ta.userName||(Ta.userName=qg);this.Qb=xb;this.xz=kc;this.zw=Nc.clientId;this.J$=Nc.Ow;this.Ce=id;this.mc=Cb;this.Qgc=of;this.nU=Df;this.iR=
vd;this.jma=ng;Bf.execute(Qe=>{this.To=Qe});this.XAj();this.xj=Pc;this.Gq=tf;this.qDb=xe.mmg;this.mfc=xe.IVj;this.Iec=xe.podsDefaultToRtcForPresenceEnabled;this.kbk=xe.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.kGg=u.AFrameworkApplication.$z;this.Axe=xe.vg&&xe.pptNoRtcConnectWhenReadOnlyEnabled;this.pa=Ed;this.pa.KG(Object(r.a)(this,this.EH,"onSelectionChanged"));this.Es=Ja;this.Es.Fci(Object(r.a)(this,this.FAk,"onValidShapeIdLoaded"));this.ld=db;this.ld.eW(Object(r.a)(this,this.Frk,
"onActiveSlideDOMReady"));this.mJ=zc;this.mJ.PPd(Object(r.a)(this,this.pfd,"onEditorTableUpdate"));this.ei=ef;this.ei.LA(Object(r.a)(this,this.GB,"onSessionEnd"));this.ei.iC(Object(r.a)(this,this.Eo,"onSessionRehydrated"));this.ei.GPa(Object(r.a)(this,this.Ikc,"onOutboundReplication"));this.r7j=xe.pptAwayStatusTimeGapForPresenceUpdateInMs;this.Gyg=xe.$ol;this.ia=Ad;this.ua=Hd;this.n$c=Kd;this.c5c=Id;this.Zeb=qe;this.nCb=jg;xe.vg&&(this.ei.Evf(Object(r.a)(this,this.Okc,"onSessionAccessTokenExpiring")),
this.ei.gHc(Object(r.a)(this,this.Ona,"onSessionAccessTokenExpired")),this.ei.mQd(Object(r.a)(this,this.Fgd,"onSessionExpired")),this.Qb.ff(()=>{this.n$.userName=this.Qb.appSettings.UserName;this.n$.email||(this.n$.email=u.AFrameworkApplication.fa.Ga("UserPrincipalName"));this.mc.BL||(ea.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.Axe&&this.ei.S7(Object(r.a)(this,this.Hw,"onUnifiedAppStateChanged"))}),this.kGg&&this.ei.kHc(Object(r.a)(this,this.Efa,"onWopiTokenRefreshed")));
ea.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",this.kGg)}wb(){this.ia.ra(Ac.a.XZa,Gb.a.application,Object(r.a)(this,this.XZa,"querySlidePresenceUsers"),96)}XZa(Ta,xb,kc,Nc,id){id.bsc=this.K6b(id.slideId);id.rch=this.uxb();return 32}K6b(Ta){return(Ta=this.E7f(Ta))?Ta.length:0}XAj(){this.xz.k6a(Object(r.a)(this,this.Wzi,"connectionStateChanged"));this.xz.fHc(Object(r.a)(this,this.presenceUpdated,"presenceUpdated"));u.AFrameworkApplication.fa.ka("PPTForceUpdateEditorTableEnabled")&&
this.xz.WBa(Object(r.a)(this,this.lGl,"updateNotificationReceived"));P.a.getInstance().n$h(Object(r.a)(this,this.G4g,"onGotCompletePersistentStateWithMetadata"));this.Gyg&&this.iR.TGc(Object(r.a)(this,this.Owk,"onNetworkHealthChanged"));this.eYa=this.J$.Ei("WebServiceCall","RtcConnection");this.nU.vTi();this.xz.connect()}$gh(){const Ta=this.xz.HRc();this.wIh(new $a.a(Ta,null));this.eqc()}Owk(Ta,xb){xb.y_c||(this.nU.wTi(),this.qyg=!0)}G4g(Ta,xb){this.nU.zTi(xb.wKk);P.a.getInstance().LZk(Object(r.a)(this,
this.G4g,"onGotCompletePersistentStateWithMetadata"))}Wzi(Ta,xb){ea.a.J(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",jb.P6d(xb.oldState),jb.P6d(xb.newState),this.zw);switch(xb.newState){case 2:this.eYa.stop();Ta=this.eYa.Vq;this.nU.uTi();this.$gh();this.Qgc.ygh(Ta);break;case 1:2===xb.oldState&&this.Qgc.joc();this.Qgc.lld();break;case 0:this.fCb?this.Jui():2===xb.oldState&&(window.setTimeout(()=>{this.xz.connect()},0),ea.a.J(512360714,
814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.Ce.z6b().getTime()),this.Qgc.joc())}}getSelectedShapes(){if(!this.mfc)return null;const Ta=[],xb=this.pa.Xd();for(let kc=0;kc<xb.length;++kc)Array.add(Ta,xb[kc].get_shapeId());0<Ta.length&&Ta.sort();return Ta}Jui(){var Ta=this.nR.F3();if(Ta&&Ta.length){Ta=Array.clone(Ta);for(const xb of Ta)this.sKb(xb);this.raiseEvent("PresenceChanged")}}jVe(Ta,xb){try{this.n$.email||(this.n$.email=u.AFrameworkApplication.fa.Ga("UserPrincipalName"));
const kc=new Gc.a(Ta,xb),Nc=new dc(this.n$.clientId,Ta,kc,this.n$.chatThreadId,this.n$.chatThreadDiscoveryUri,this.n$.inChat,this.n$.email,this.n$.capabilities,this.n$.userName,1,this.qyg);this.n$.email||ea.a.J(512360713,814,15,"PresenceManager : SendPresence; empty email for user");this.xz.jVe(Nc.x$d()).continueWith(()=>{ea.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.zw,kc.toString(),this.Ce.z6b().getTime())});
this.PGg=new Date;this.nU.O3j();this.jTk(Ta,xb);ea.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.zw,kc.toString(),this.Ce.z6b().getTime());this.KTk(kc)}catch(kc){ea.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",kc.toString(),this.zw)}}presenceUpdated(Ta,xb){Ta=!!this.To&&this.To.m_;ea.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",
this.zw,Ta);if(!Ta){this.nU.Q3j(xb.DPb);Ta=null;this.J$&&(Ta=this.J$.Ei("ServerNotification","Presence Updated"));try{this.wIh(xb)}finally{Ta&&Ta.stop()}}}lGl(Ta,xb){ea.a.J(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",xb.type,this.zw)}wIh(Ta){this.K7h(Ta.DPb);this.k_a(Ta.PPf);ea.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}eqc(){this.ua.fk?this.jVe(this.ua.fk,
this.getSelectedShapes()):ea.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}EH(){if(this.ua.fk){var Ta=this.getSelectedShapes();(jb.Rzj(this.Bvg,this.ua.fk)||jb.Lce(Ta,this.zvg))&&this.eqc()}else ea.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}Frk(Ta,xb){xb.Ba?this.ua.fk?this.eqc():ea.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):
ea.a.J(512360706,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}FAk(Ta,xb){this.ua.fk?Array.contains(this.getSelectedShapes(),xb.shapeNode.get_shapeId())&&this.eqc():ea.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}rol(Ta,xb,kc){xb=this.F0f(xb);Ta=this.F0f(Ta);this.Ce.H6i().ztc.raiseEvent(jb.y1d,new Db.a(this.xj.bD,null,xb,Ta,null,0,0,kc))}F0f(Ta){const xb=new Mb.a;for(let kc=0;kc<Ta.length;kc++){const Nc=Ta[kc];
if(!Nc)continue;if(Nc.ID===this.xj.bD)continue;if(!Nc.EmailAddress){xb.$(Nc.ID,this.E0f(Nc));continue}const id=this.nR.x$a(this.xj.bD);id&&id.email&&Nc.EmailAddress&&id.email.toUpperCase()===Nc.EmailAddress.toUpperCase()||xb.$(Nc.EmailAddress.toUpperCase(),this.E0f(Nc))}return xb.values}E0f(Ta){const xb=new ob.a;xb.EmailAddress=Ta.EmailAddress;xb.Id=Ta.ID;xb.Name=Ta.Name;return xb}pfd(Ta,xb){this.rol(xb.cqg,xb.Zyf,xb.xOj);if(Ta=this.xj.i_){var kc=xb.cqg;for(var Nc=0;Nc<kc.length;Nc++)this.c5c.Gsl(kc[Nc].ID);
kc=[];xb=xb.Zyf;for(Nc=0;Nc<xb.length;Nc++){let Ed=xb[Nc];const Ja=Ed.ID;if(Ja!==this.xj.bD){const db=this.nR.x$a(Ja);db?this.nCb.rBf(db.email,Ed.EmailAddress):Array.add(kc,Ja)}}this.c5c.y6h(kc);2<=Ta.length&&ea.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.zw,Ta.length);kc=[];xb=[];for(var id of Ta)Array.add(kc,id.ID),id.ID===this.xj.bD||this.nR.x$a(id.ID)||Array.add(xb,id.ID);ea.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",
this.zw,Ta.length,kc.join(","),xb.join(","));for(const Ed of this.nR.F3())({editor:id}=this.xj.Wlb(Ed.clientId)).returnValue?this.Zzj(id.ColorIndex)?(this.GTk(Ed),Ta=this.Zeb.Kta(new ib.a(id.EmailAddress,void 0,id.Name),id.ColorIndex,id.ID,0),Ed.presenceUser=new E.a(Ed.clientId,id.Name,Ta,new ra.a(1),null,null,Ed.clientType),this.n$c.Zkd(new Nb(Ed.fk,Ed.presence.UU,Ed.presenceUser,!0,this.K6b(Ed.fk),this.uxb())),ea.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",
Ed.clientId,Ed.presence.toString(),Ed.presenceUser.color,this.zw)):ea.a.J(512360672,814,50,"PresenceManager : OnEditorTableUpdate; EditorInfo has no color assigned; ClientId: {0};  Presence: {1}; MyClientId: {2};",Ed.clientId,Ed.presence.toString(),this.zw):ea.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",Ed.clientId,Ed.presence.toString(),Ed.presenceUser?Ed.presenceUser.color:"",this.zw);this.raiseEvent("PresenceChanged")}else ea.a.J(512360675,
814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.zw)}GB(Ta,xb){this.c5c.Esl();5!==xb.NE&&(ea.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}Okc(){ea.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.Fdb||(ea.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.Fdb=!0)}Ona(){ea.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");
this.Fdb||(ea.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.Fdb=!0)}Fgd(){ea.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}Efa(Ta,xb){ea.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{xb.T0c?(ea.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",jb.P6d(this.xz.connectionState)),this.Fdb=!1,this.Axe&&!this.mc.BL?ea.a.J(512360661,
814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.fCb||2!==this.xz.connectionState?this.connect():(Ta={},Ta.qs=this.jma.presentationId.string,ea.a.J(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.xz.cmb(Ta))):ea.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(kc){ea.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",kc)}}Eo(Ta,xb){this.kbk&&this.Fdb||
this.Axe&&!this.mc.BL?ea.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.Fdb,this.mc.BL):4!==xb.Uxa||this.fCb?this.connect():(ea.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.$gh())}Hw(Ta,xb){xb.Lke&&!this.mc.BL&&(ea.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){ea.a.J(512360654,
814,50,"PresenceManager : Connect");this.fCb=!1;this.xz.connect()}Ikc(){this.nkl()&&(ea.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.eqc())}nkl(){const Ta=this.xz.Iej();return Ta?2===Ta.status||+new Date-+this.PGg>this.r7j?!0:!1:!1}RTj(){const Ta=this.nR.F3();if(0<Ta.length)for(const xb of Ta)if(xb.presence&&xb.presence.fk)return!0;return!1}Ljl(){return!this.EAg&&this.Iec&&2!==this.xj.Kca}K7h(Ta){for(let kc in Ta){var xb=Ta[kc];try{const Nc=
dc.ZLc(xb);if(!Nc||Nc.clientId===this.zw)continue;const id=Nc.clientId;this.Ljl()&&(this.EAg=!0,this.Gq.Guc(2),ea.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));ea.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",id,Nc.presence.toString());const Ed=Nc.email;if(!this.nCb.m7d(Ed)){let Ja;({editor:Ja}=this.xj.Wlb(id)).returnValue&&this.nCb.rBf(Ed,Ja.EmailAddress)}this.M7h(Nc);this.nU.tTi()}catch(Nc){ea.a.J(512360651,
814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",Nc.toString(),this.zw)}}this.nU.P3j(Ta)}M7h(Ta){this.qSi(Ta);const xb=this.xz.T3(Ta.clientId);xb&&2===xb.status?ea.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Ta.clientId):this.L7h(Ta)}L7h(Ta){const xb=this.nR.x$a(Ta.clientId);if(xb){if(!this.Hzj(xb,Ta))return;ea.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
Ta.clientId,xb.presence.toString(),Ta.presence.toString(),this.zw);this.sKb(xb)}this.b8h(Ta)}sKb(Ta){Ta&&(this.nR.sKb(Ta),Ta.presenceUser&&this.n$c.Zkd(new Nb(Ta.fk,Ta.presence.UU,Ta.presenceUser,!1,this.K6b(Ta.fk),this.uxb())))}nTf(Ta){if(Ta)if(Ta.presenceUser)ea.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Ta.clientId);else{const xb=this.Y5f(Ta.clientId);xb?Ta.presenceUser=xb:ea.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
Ta.clientId)}}b8h(Ta){Ta&&(this.nR.Cia(Ta),this.c5c.Fsl(Ta.clientId),this.nTf(Ta),Ta.presenceUser?this.n$c.Zkd(new Nb(Ta.fk,Ta.presence.UU,Ta.presenceUser,!0,this.K6b(Ta.fk),this.uxb())):ea.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Ta.clientId))}Zzj(Ta){return!this.qDb||Ta?!0:!1}Hzj(Ta,xb){let kc;(kc=!Ta.fk.equals(xb.fk))&&ea.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Ta.fk,xb.fk);(Ta=this.mfc&&jb.Bhl(Ta,
xb))&&ea.a.J(512360646,814,50,"Shape Presence Changed");return kc||Ta}k_a(Ta){if(Ta){for(let xb=0;xb<Ta.length;xb++)Ta[xb]=Ta[xb].toLowerCase();for(const xb of Ta)ea.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",xb),(Ta=this.nR.Sld(xb))?Ta.presenceUser?this.n$c.Zkd(new Nb(Ta.fk,Ta.presence.UU,Ta.presenceUser,!1,this.K6b(Ta.fk),this.uxb())):ea.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):ea.a.J(512360644,
814,15,"PresenceManager : RemovePresence; entry did not exist")}}E7f(Ta){const xb=[];for(const kc of this.nR.F3())kc.fk.equals(Ta)&&kc.presenceUser&&Array.add(xb,kc.presenceUser);return xb}n7f(Ta){const xb=[];for(const kc of this.nR.F3())kc.presence&&kc.Nzj(Ta)&&kc.presenceUser&&Array.add(xb,kc.presenceUser);return xb}i5b(){const Ta=[];for(const xb of this.nR.F3())xb.presenceUser&&Array.add(Ta,xb.presenceUser);return Ta}uxb(){const Ta=this.i5b();return Ta?Ta.length:0}lka(Ta){if(!Ta)return null;Ta=
Ta.toLocaleLowerCase();for(const xb of this.nR.F3())if(xb.presenceUser&&xb.presenceUser.clientId===Ta)return xb.presenceUser;return this.Y5f(Ta)}Sld(Ta){const xb=this.nR.x$a(Ta);this.sKb(xb);ea.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",xb?xb.clientId:Ta+" not found",this.zw)}rbi(Ta){this.addHandler("PresenceChanged",Ta)}F3(){return this.nR.F3()}connectionState(){return this.xz.connectionState}disconnect(){try{ea.a.J(512360640,
814,50,"PresenceManager : Disconnect"),this.fCb||this.Qgc.mTk(),this.fCb=!0,this.xz.disconnect()}catch(Ta){ea.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",Ta.message,Ta.stack)}}jTk(Ta,xb){this.Bvg=Ta;this.zvg=xb}Y5f(Ta){let xb;const kc=({editor:xb}=this.xj.Wlb(Ta)).returnValue;var Nc=this.xz.Lta(Ta),id=!!Nc;if(!kc&&!id)return ea.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Ta),null;
Nc=id?Nc:null;kc||ea.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Ta);id||ea.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Ta);id&&kc&&ea.a.J(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Ta,Nc.clientId!==xb.ID,Nc.email!==xb.EmailAddress);var Ed=kc?new ib.a(xb.EmailAddress,void 0,xb.Name):new ib.a(this.nCb.m7d(Nc.email)||Nc.email,void 0,Nc.userName);Ed=this.Zeb.Kta(Ed,
kc?xb.ColorIndex:null,kc?xb.ID:Nc.clientId,0);id=id?Nc.clientType:0;return new E.a(Ta,kc?xb.Name:Nc.userName,Ed,new ra.a(1),null,null,id)}GTk(Ta){this.ua.fk.equals(Ta.fk)&&Ta.presence.UU&&Ta.presence.UU.length&&ea.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Ta.clientId,Ta.presence.toString(),this.zw,this.Ce.z6b().getTime());ea.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Ta.clientId,Ta.presence.toString(),this.zw,this.Ce.z6b().getTime())}KTk(Ta){const xb=[this.xj.userName];let kc=0;for(var Nc of this.nR.F3())Nc.presence.fk.equals(Ta.fk)&&!jb.Lce(Nc.presence.UU,Ta.UU)&&(kc++,Nc.presenceUser&&Array.add(xb,Nc.presenceUser.userName));if(0<kc){Nc={};let id=0,Ed=0;for(let Ja=0;Ja<xb.length;++Ja){let db=xb[Ja];db&&db.length||(db="anonymous",Ed++);db in Nc||(Nc[db]=!0,id++)}ea.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",
kc+1,Ta.UU&&0<Ta.UU.length?"shape":"slide",id,Ed)}}qSi(Ta){try{!this.nU.WWi()||this.nR.x$a(Ta.clientId)||this.Gyg&&Ta.fHasClientEverExperiencedNetworkLoss||(this.nTf(Ta),this.rSi(Ta.presenceUser))}catch(xb){ea.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",xb.toString())}}rSi(Ta){Ta&&Ta.clientId&&(this.Ayg||this.l$c||(this.Ayg=!0,this.l$c=G.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.l$c&&this.l$c.vSi(Ta.clientId,jb.Tij(Ta)))}static P6d(Ta){let xb=
"";switch(Ta){case 2:xb="Connected";break;case 1:xb="Connecting";break;case 0:xb="Disconnected"}return xb}static Lce(Ta,xb){if(!Ta&&!xb)return!1;if(!Ta&&xb||Ta&&!xb||Ta.length!==xb.length)return!0;for(let kc=0;kc<Ta.length;kc++)if(Ta[kc]!==xb[kc])return!0;return!1}static Rzj(Ta,xb){return!ua.a.Jaa(Ta,xb)}static Bhl(Ta,xb){return Ta.fk.equals(xb.fk)&&jb.Lce(Ta.presence.UU,xb.presence.UU)}static Tij(Ta){return Ta&&1===Ta.client?1:0}}jb.y1d="ETU";Object(h.a)(jb,"PresenceManager",v.a,[1244,1245,1246,
1247]);var Vb=d(1145),Tc=d(1148),wb=d(1040),Rb=d(75),vc=d(49),rd=d(301);class rc{constructor(Ta,xb,kc,Nc,id){this.ju=null;this.Jv=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled");xb=this.ahj(xb,Nc,id);this.ju=this.Jv?(new Vb.a(xb)).eub(Ta):(new Tc.a(xb)).YLc(Ta,kc)}dispose(){this.ju.dispose()}BMe(){return vc.a.ai(document.getElementById(rd.a.r_b))}ahj(Ta,xb,kc){const Nc=new wb.a;Nc.add(0,Rb.getImageClassWithCluster(u.AFrameworkApplication.UN,"MoreUsersGlyph_16x16x32"));Nc.add(5,u.AFrameworkApplication.qm);
Nc.add(1,Rb.getImageClassWithCluster(u.AFrameworkApplication.UN,this.Jv?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));Nc.add(4,u.AFrameworkApplication.qm);Nc.add(6,kc);Nc.add(8,u.AFrameworkApplication.isRtl);Nc.add(12,Ta);Nc.add(11,xb);this.Jv&&(Nc.add(16,Object(r.a)(this,this.BMe,"presenceViewportBoundsCallback")),Nc.add(17,!0));return Nc}Yx(Ta){this.ju?(ea.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Ta.clientId),this.ju.Yx(Ta)):ea.a.J(509219530,
814,10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Ta.clientId)}TJ(Ta){this.ju?(ea.a.J(509219528,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Ta.clientId),this.ju.TJ(Ta.clientId)):ea.a.J(509219529,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Ta.clientId)}clear(){if(this.ju)if(ea.a.J(509219526,814,50,"PresencePawn:Clear at PresencePawn "),this.P8())for(const Ta of this.P8())this.TJ(Ta);
else ea.a.J(509219525,814,50,"PresencePawn:Clear - Pawn has no users");else ea.a.J(509219527,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}P8(){return this.ju?this.ju.Xhb:null}yZe(){this.ju&&(this.Jv&&this.ju.nga(),this.ju.Kya())}ede(){this.ju&&this.ju.nga()}}Object(h.a)(rc,"PresencePawn",null,[458,106]);class cb{hMf(Ta,xb,kc){return new rc(Ta,2,xb,!0,kc)}}Object(h.a)(cb,"PresencePawnFactory",null,[1228]);var Wb=d(32);class Uc{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,
zc,Hd,Ad){this.mAe=[];this.UXa=null;this.nzg=this.mzg=this.uve=0;this.g6c=this.h6c=null;this.I9c=[];if(!xb)throw Error.argumentNull("graphTopologyManager");if(!kc)throw Error.argumentNull("presenceManager");if(!Nc)throw Error.argumentNull("dragInputManager");if(!id)throw Error.argumentNull("coauthStateChangesHandler");this.ld=Ta;this.ua=xb;this.tE=kc;this.eu=Nc;this.pre=id;this.Hma=Ed;this.Tb=Ja;this.Te=db;this.Tfb=zc;this.Gma=Hd;this.gR=Ad;this.Gma.n6a(Object(r.a)(this,this.Hrd,"slidePresenceChanged"));
this.ld.eW(Object(r.a)(this,this.iZa,"onSlideNavigation"));this.ld.iHc(Object(r.a)(this,this.kxa,"onThumbnailRefresh"));this.ld.wrb(Object(r.a)(this,this.yJe,"onThumbnailVisibleRangeChanged"));this.hCg=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceFloodGateSurveyEnabled");(this.Jv=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.hCg&&(this.mzg=u.AFrameworkApplication.fa.Bc("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.nzg=u.AFrameworkApplication.fa.Bc("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",
3),this.uve=0,this.UXa=K.a.av(G.a.instance.Ja("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.ld.XYb(Object(r.a)(this,this.Khl,"shapeViewElementAdded"));this.ld.Ivf(Object(r.a)(this,this.Lhl,"shapeViewElementLocked"));this.ld.Uai(Object(r.a)(this,this.ozk,"onShapeViewElementShowLockHint"));this.ld.Vai(Object(r.a)(this,this.pzk,"onShapeViewElementShowPresenceHint"));this.ld.Sai(Object(r.a)(this,this.izk,"onShapeViewElementHidePresenceHint"))}iZa(){this.ua.fk&&(ea.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",
this.ua.fk),this.FUk(this.ua.fk))}FUk(Ta){if(this.ua.fk&&this.ua.fk.equals(Ta)&&(ea.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Ta),Ta=new Wb.GraphIterator,Ta.set(this.ua.Ba),Ta.Bb(1))){do if(0<Ta.currentNode.eb(mb.a.shapeId)){const xb=Object(na.a)(4,Ta.currentNode);xb&&this.jhh(xb)}while(Ta.Cf(1))}}Hrd(Ta,xb){this.eu.qFa?(ea.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.g6c||(this.g6c=
new B.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(xb)},90,"68"),u.AFrameworkApplication.ye.Db(this.g6c)),xb&&this.I9c.push(xb)):(this.jMk(xb),this.hMk(xb))}handlePendingPresenceChangedEvent(){this.g6c=null;this.DUk();if(this.ua.fk&&0<this.I9c.length){const kc={},Nc={};var Ta=this.ua.fk;for(var xb of this.I9c){if(!Ta.equals(xb.slideId))continue;if(!xb.shapes||!xb.user)continue;xb.user.clientId in Nc||(kc[xb.user.clientId]=xb.user,Nc[xb.user.clientId]=new Mb.a(0));const id=Nc[xb.user.clientId];
for(const Ed of xb.shapes){const Ja=xb.f9?1:0;id.Gb(Ed)?0<(id.ga(Ed)^Ja)&&id.$(Ed,Ja):id.add(Ed,Ja)}}for(let id in kc){Ta=kc[id];xb=id;if(!(xb in Nc))continue;const Ed=[],Ja=[];Nc[xb].forEach((db,zc)=>{0<zc?Ja.push(db):Ed.push(db);return!0});0<Ed.length&&this.Sih(Ed,Ta);0<Ja.length&&this.iuf(Ja,Ta)}this.I9c=[]}}jMk(Ta){Ta.f9?this.Cia(Ta.slideId,Ta.user):this.k_a(Ta.slideId,Ta.user)}kxa(Ta,xb){this.hhh([xb.TCh])}yJe(Ta,xb){this.hhh(xb.Gga)}hhh(Ta){const xb=[];for(const kc of Ta)Ta=this.gR?this.Tb.OUc(kc):
this.Tb.pka(kc),this.gR&&0>=Ta.nV||Ta&&Array.add(xb,Ta);this.ghh(xb)}Cia(Ta,xb){const kc=this.P8f(Ta);kc?(kc.Cia(xb),this.Ooe(),ea.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Ta.toString())):ea.a.J(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Ta.toString())}k_a(Ta,xb){const kc=this.P8f(Ta);kc?kc.k_a(xb):ea.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ta.toString())}P8f(Ta){const xb=
this.Tb.pka(Ta);return xb?Object(na.a)(486,xb.ng(this.Tfb)):(ea.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ta.toString()),null)}DUk(){const Ta=this.ua.presentation;if(!Ta)throw Error.argumentNull("Presentation is null");this.ghh(Ta.slides||[])}ghh(Ta){for(const kc of Ta){var xb=Object(na.a)(116,kc);xb?(Ta=xb.Cb,(xb=Object(na.a)(486,xb.ng(this.Tfb)))?(ea.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",
Ta.toString()),xb.F1a(this.tE.E7f(Ta))):ea.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Ta.toString())):ea.a.J(512263064,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",kc.Cb.toString())}}Ooe(){this.Jv&&this.hCg&&(this.Mzl()||this.UXa&&this.UXa.continueWith(()=>{this.UXa.result.logActivity("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",
this.mzg)&&this.uve++}))}Mzl(){return this.uve>=this.nzg}hMk(Ta){this.ua.fk&&this.ua.fk.equals(Ta.slideId)&&Ta.shapes&&(Ta.f9?this.iuf(Ta.shapes,Ta.user):this.Sih(Ta.shapes,Ta.user))}Khl(Ta,xb){Ta=xb.Px;this.hng(Ta.shapeNode)&&(this.mAe.push(Ta),this.h6c||(this.h6c=new B.a(2,1,0,Object(r.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),u.AFrameworkApplication.ye.Db(this.h6c)))}handlePendingShapePresenceUpdate(){this.h6c=null;for(const Ta of this.mAe){if(!this.hng(Ta.shapeNode))return;
this.jhh(Ta.shapeNode)}Array.clear(this.mAe)}jhh(Ta){const xb=Object(na.a)(117,Ta.sc(this.Te));if(xb&&!Ta.get_smartArtModelId()){var kc=this.tE.n7f(Ta);if(kc)if(kc.length){Ta=this.Hma.ZG(Ta);Ta.oGf();for(const Nc of kc)Ta.Cia(Nc),this.Ooe()}else(kc=this.Hma.IF(Ta))&&kc.oGf();this.pre.f8g(xb)}}iuf(Ta,xb){var kc=this.q7f();let Nc=!1;for(const id of kc){if(!Array.contains(Ta,id.get_shapeId())||id.get_smartArtModelId())continue;kc=Object(na.a)(117,id.sc(this.Te));if(!kc||id.get_smartArtModelId())continue;
const Ed=this.Hma.ZG(id);Ed?(kc.isSelected&&(Ed.zsb=!1),Ed.Cia(xb),this.Ooe(),kc.isSelected&&Ed.wjc()):Nc=!0}Nc||ea.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}Sih(Ta,xb){var kc=this.q7f();for(const Nc of kc)Array.contains(Ta,Nc.get_shapeId())&&(kc=this.Hma.ZG(Nc))&&kc.k_a(xb)}q7f(){let Ta=null;this.ua.Ba&&(Ta=this.ua.Ba.gk());return Ta||[]}hng(Ta){return!!this.ua.Ba&&this.ua.Ba.Cb.equals(Ta.slideId)}Lhl(Ta,xb){this.Hma.ZG(xb.Px.shapeNode).wvd(xb.presenceUser)}ozk(Ta,xb){(xb.Px.aq||
xb.Px.Oqd)&&(Ta=this.Hma.IF(xb.Px.shapeNode))&&Ta.YYe()}pzk(Ta,xb){(Ta=this.Hma.IF(xb.Px.shapeNode))&&Ta.Hll()}izk(Ta,xb){(Ta=this.Hma.IF(xb.Px.shapeNode))&&Ta.v_()}}Object(h.a)(Uc,"PresencePresenter",null,[]);class Ib{constructor(Ta){this.dhc=Ta}Lta(Ta){return this.dhc.Lta(Ta)}T3(Ta){return this.dhc.T3(Ta)}}Object(h.a)(Ib,"PresenceUserInfoGetter",null,[1230,1196]);class Vc{constructor(Ta=null){this.xj=Ta}Z5f(Ta){if(!Ta||!Ta.value)return null;Ta=Ta.value;let xb=Ta.userName;if(!xb&&this.xj){let kc;
({editor:kc}=this.xj.Wlb(Ta.clientId)).returnValue&&(xb=kc.Name)}return Object.assign(new E.a,{clientId:Ta.clientId,chatThreadId:Ta.chatThreadId,chatThreadDiscoveryUri:Ta.chatThreadDiscoveryUri,inChat:Ta.inChat,email:Ta.email,capabilities:new ra.a(Ta.capabilities),userName:xb})}}Object(h.a)(Vc,"PresenceUtils",null,[1241]);var gc;(function(Ta){Ta[Ta.coauthHandlerResponse=0]="coauthHandlerResponse";Ta[Ta.popSessionResponse=1]="popSessionResponse";Ta[Ta.defaultFallback=2]="defaultFallback"})(gc||(gc=
{}));Object(h.b)("RtcDiscoverType",gc);class rb{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,zc,Hd,Ad,Kd,Pc,tf,xe,ef){this.o0d=Ta;this.Rrd=xb;this.Qrd=kc;this.pvb=Nc;this.N8b=id;this.lXc=Ed;this.$lb=Ja;this.Fud=db;this.Oib=zc;this.ONc=Hd;this.MNc=Ad;this.XNb=Kd;this.pgb=Pc;this.Rub=tf;this.hSf=xe;this.J1d=ef}E5j(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.o0d,this.Rrd,this.Qrd,
this.pvb,this.N8b,this.lXc,this.$lb,this.Fud,this.Oib,this.ONc,this.MNc,this.XNb,this.pgb,this.Rub,this.hSf,this.J1d)}}Object(h.a)(rb,"RttLockSettings",null,[]);var Zb=d(340);class Hc{constructor(Ta,xb,kc,Nc){this.Cfc=this.Bfc=null;this.Ugf=!1;this.eik=Ta;this.Ea=xb;this.Ih=kc;this.gY=Nc;this.EFb=new Date;this.xHa=-1}get gb(){return this.eik}get $0c(){return this.Ugf}set $0c(Ta){this.Ugf=Ta}qWi(){return 0<this.xHa&&Date.now()>=this.xHa}Crh(Ta){this.xHa=Ta}a7b(){return""}b7b(){return""}aKb(Ta){this.Bfc=
Ta?this.a7b():this.b7b();this.Cfc=new Date}xVd(){}zVd(){return!1}goh(Ta,xb){Ta=Ta||"";xb=xb||"";if(Ta.length!==xb.length)return null;const kc=[];for(let Nc=0;Nc<Ta.length;Nc+=1)Ta.charAt(Nc)!==xb.charAt(Nc)&&kc.push(Nc);return 0<kc.length?zb.a.SH("Length",Ta.length,"FirstDiffPos",kc[0],"DiffCount",kc.length):null}$Sa(Ta){return F.a.replaceAll(Ta,"\u00a0"," ").trim()}}Object(h.a)(Hc,"ATextContentRecord",null,[]);var Ab=d(36),ad=d(43);class Bd extends Hc{constructor(Ta,xb,kc,Nc){super(Ta,xb,kc,Nc);
this.RXg=Ta.gB}get shapeNode(){return Object(na.a)(4,this.gb)}Dgl(){this.RXg=this.shapeNode.gB}a7b(){const Ta=new n.a;var xb=this.shapeNode.xC();for(const kc of xb)(xb=this.Ih.text(kc))&&0<xb.length&&Ta.add(xb);return Ta.toArray().join(" ")}b7b(){return this.Ea.rda(this.shapeNode)}xVd(){try{const Ta=this.a7b()||"",xb=this.Bfc||"";if(Ta!==xb){const kc=this.$Sa(Ta)===this.$Sa(xb),Nc=this.RXg||this.shapeNode.gB;if(!kc&&!Nc&&!this.shapeNode.ud){const id=zb.a.SH("Shape",this.shapeNode.Er,"Start",ad.a.mf(this.EFb),
"LastSnapshotTime",ad.a.mf(this.Cfc),"EverEdit",this.$0c,"Type",this.getShapeType());id.Expiration=-1<this.xHa?(+new Date(this.xHa)-+this.EFb).toString():null;const Ed=Ta.length-xb.length;Ed?id.TextLengthDelta=Ed:id.SameLengthDiffDetails=this.goh(Ta,xb);ea.a.J(25539747,814,15,Ab.c(id))}}}catch(Ta){ea.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ta)}}zVd(){try{const Ta=this.gY.J5b(this.shapeNode);if(Ta&&0<Ta.length)return!1;const xb=this.b7b()||"",kc=this.Bfc||"";if(xb!==kc&&
0>xb.indexOf(kc)&&!(0<=this.$Sa(xb).indexOf(this.$Sa(kc))||this.shapeNode.ud)){const Nc=zb.a.SH("Shape",this.shapeNode.Er,"Start",ad.a.mf(this.EFb),"LastSnapshotTime",ad.a.mf(this.Cfc),"TextLengthDelta",xb.length-kc.length,"Type",this.getShapeType());ea.a.J(25981903,814,15,Ab.c(Nc))}}catch(Ta){ea.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ta)}return!0}getShapeType(){return this.shapeNode.ud?"Table":this.shapeNode.Qf?"SmartArt":this.shapeNode.ux?"TextBox":this.shapeNode.fl?
"PlaceHolder":this.shapeNode.kla?"Shape":"Unknown"}}Object(h.a)(Bd,"ShapeContentRecord",Hc,[]);class kd{constructor(Ta,xb,kc,Nc,id,Ed,Ja,db,zc,Hd,Ad,Kd,Pc){this.Nfb=this.HFb=null;this.NO={};this.RIa={};this.pa=db;this.mJ=zc;this.Oc=Ta;this.yt=xb;this.E$j=kc;this.Gv=Nc;this.ua=id;this.Yf=Ed;this.gY=Ja;this.Ea=Hd;this.yc=Ad;this.bDe=Kd;this.Hs=Pc;this.pa.xvf(Object(r.a)(this,this.Exk,"onPreSelectionChanged"));this.pa.KG(Object(r.a)(this,this.EHb,"onSetSelectionFinished"));this.mJ.oci(Object(r.a)(this,
this.Xzk,"onTableCellViewElementLocked"));this.Oc.p$h(Object(r.a)(this,this.Jii,"beforeProcessInboundResponse"));this.yt.YYb(Object(r.a)(this,this.lzk,"onShapeViewElementOpenTextEditView"));this.yt.hHc(Object(r.a)(this,this.fzk,"onShapeViewElementCloseTextEditView"));this.yt.Ivf(Object(r.a)(this,this.kzk,"onShapeViewElementLocked"));this.E$j.pvf(Object(r.a)(this,this.Tzk,"onSuccessfulInbound"));this.Gv.kk(Object(r.a)(this,this.ph,"onPropertyChanged"));this.Yf.tI(Object(r.a)(this,this.DB,"onActiveSlideChanged"))}lzk(Ta,
xb){Ta=Object(na.a)(4,Object(na.a)(Zb.a,xb.Px).gb);xb=this.bDe.kZd(Ta);this.NO[Ta.id.toString()]=xb;xb.aKb(!0)}fzk(Ta,xb){Ta=Object(na.a)(4,Object(na.a)(Zb.a,xb.Px).gb).id.toString();Ta in this.NO&&this.NO[Ta].Crh(Date.now()+this.Hs.pvb)}kzk(Ta,xb){Ta=Object(na.a)(4,Object(na.a)(Zb.a,xb.Px).gb).id.toString();Ta in this.NO&&delete this.NO[Ta]}Exk(){this.HFb=this.EMf}EHb(){this.Nfb=this.EMf;if(!(!this.HFb&&!this.Nfb||this.HFb&&this.Nfb&&this.Nfb.id.equals(this.HFb.id))){if(this.HFb){var Ta=this.HFb.id.toString();
Ta in this.NO&&this.NO[Ta].Crh(Date.now()+this.Hs.pvb)}this.Nfb&&(Ta=this.bDe.kZd(this.Nfb),this.NO[this.Nfb.id.toString()]=Ta,Ta.aKb(!0))}}get EMf(){var Ta=this.pa.Na;if(!Ta||!Ta.mb||Ta.mb.Hl)return null;Ta=Ta.mb;return Ta.Ua.node&&Ta.Ua.node.isConnected?this.yc.wEa(Ta.Ua.node):null}Xzk(Ta,xb){Ta=xb.tableCellNode.id.toString();Ta in this.NO&&delete this.NO[Ta]}Jii(){this.nih();for(const Ta of Object.keys(this.NO))this.NO[Ta].aKb(!0)}Tzk(){this.nih();for(const Ta of Object.keys(this.NO))this.NO[Ta].xVd();
for(const Ta of Object.keys(this.RIa))this.RIa[Ta].zVd()&&delete this.RIa[Ta]}ph(Ta,xb){if(xb&&xb.node&&xb.property.id===ha.a.pq.id){Ta=Object(na.a)(5,xb.node);xb=!xb.node.loading;const kc=this.yc.wEa(Ta);if(kc)this.q_g(kc,xb),this.r_g(kc,xb);else if(Ta=this.Ea.oda(Ta))this.q_g(Ta,xb),this.r_g(Ta,xb)}}DB(){this.RIa={}}nih(){for(const Ta of Object.keys(this.NO))this.NO[Ta].qWi()&&delete this.NO[Ta]}q_g(Ta,xb){Ta=Ta.id.toString();if(Ta in this.NO){Ta=this.NO[Ta];const kc=Object(na.a)(Bd,Ta);kc&&kc.Dgl();
Ta.aKb(!0);xb&&(Ta.$0c=!0)}}r_g(Ta,xb){var kc=this.Ea.en(Ta);kc&&this.ua.Ba&&this.ua.Ba.sid===kc.get_sid()&&this.ua.Ba.cid===kc.get_cid()&&(kc=Ta.id.toString(),xb?kc in this.RIa&&delete this.RIa[kc]:(xb=Object(ka.a)(125,Ta)?this.gY.w5b(Object(na.a)(125,Ta)):this.gY.J5b(Object(na.a)(4,Ta)))&&0<xb.length&&(kc in this.RIa?this.RIa[kc].aKb(!1):(Ta=this.bDe.kZd(Ta),this.RIa[kc]=Ta,Ta.aKb(!1))))}}Object(h.a)(kd,"TextContentMonitor",null,[]);class Be extends Hc{constructor(Ta,xb,kc,Nc,id){super(Ta,xb,Nc,
id);this.yc=kc}get tableCellNode(){return Object(na.a)(125,this.gb)}a7b(){const Ta=new n.a;this.yc.Omc(this.tableCellNode,xb=>{(xb=this.Ih.text(xb))&&0<xb.length&&Ta.add(xb)});return Ta.toArray().join(" ")}b7b(){const Ta=new n.a;this.yc.Omc(this.tableCellNode,xb=>{xb.Sa(ha.a.pq)&&(xb=xb.eb(ha.a.pq))&&0<xb.length&&Ta.add(xb)});return Ta.toArray().join(" ")}xVd(){try{const Ta=this.a7b()||"",xb=this.Bfc||"";if(Ta!==xb&&this.$Sa(Ta)!==this.$Sa(xb)){const kc=zb.a.SH("TableCellNode",this.Kth+"/"+this.tableCellNode.Er,
"Start",ad.a.mf(this.EFb),"LastSnapshotTime",ad.a.mf(this.Cfc),"EverEdit",this.$0c);kc.Expiration=-1<this.xHa?(+new Date(this.xHa)-+this.EFb).toString():null;const Nc=Ta.length-xb.length;Nc?kc.TextLengthDelta=Nc:kc.SameLengthDiffDetails=this.goh(Ta,xb);ea.a.J(37748808,814,15,Ab.c(kc))}}catch(Ta){ea.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ta)}}zVd(){try{const Ta=this.gY.w5b(this.tableCellNode);if(Ta&&0<Ta.length)return!1;const xb=this.b7b()||"",kc=this.Bfc||"";if(xb!==
kc&&0>xb.indexOf(kc)&&!(0<=this.$Sa(xb).indexOf(this.$Sa(kc)))){const Nc=zb.a.SH("TableCellNode",this.Kth+"/"+this.tableCellNode.Er,"Start",ad.a.mf(this.EFb),"LastSnapshotTime",ad.a.mf(this.Cfc),"TextLengthDelta",xb.length-kc.length);ea.a.J(37748812,814,15,Ab.c(Nc))}}catch(Ta){ea.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ta)}return!0}get Kth(){const Ta=this.Ea.en(this.tableCellNode);return Ta?Ta.Er:"UnknownShape"}}Object(h.a)(Be,"TableCellContentRecord",Hc,[]);class Qd{constructor(Ta,
xb,kc,Nc){this.Ea=Ta;this.yc=xb;this.Ih=kc;this.gY=Nc}kZd(Ta){return Object(ka.a)(4,Ta)?new Bd(Object(na.a)(4,Ta),this.Ea,this.Ih,this.gY):Object(ka.a)(125,Ta)?new Be(Object(na.a)(125,Ta),this.Ea,this.yc,this.Ih,this.gY):null}}Object(h.a)(Qd,"TextContentRecordFactory",null,[1229]);var ae=d(632);class We{constructor(Ta,xb,kc,Nc,id){this.Fb=Ta;this.Hma=xb;this.pa=kc;this.mJ=Nc;this.yy=id;this.a5c=!1}initialize(){this.pa.KG(Object(r.a)(this,this.EHb,"onSetSelectionFinished"));this.mJ.wci(Object(r.a)(this,
this.c8g,"onTypingLockStatusChanged"))}dispose(){this.pa.PRe(Object(r.a)(this,this.EHb,"onSetSelectionFinished"));this.mJ.H0k(Object(r.a)(this,this.c8g,"onTypingLockStatusChanged"))}EHb(){var Ta=this.pa.yv();let xb=null;for(const kc of Ta)if(Ta=Object(na.a)(pa.TableCellNode,kc))if(Ta=Object(na.a)(1120,Ta.ng(this.Fb.Ma)))if(xb=Ta.t2c)break;this.dJh(xb)}c8g(Ta,xb){this.dJh(xb.$Ji)}dJh(Ta=null){this.pa.o9()?this.Ptl(Ta):this.J4k()}Ptl(Ta=null){if(this.Fb.editingView&&this.Fb.editingView.Wl){const xb=
this.q1f();xb&&(this.Hma.ZG(xb.shapeNode).wvd(Ta),Ta&&(xb.Oqd=!0,this.yy.Dfh(new ae.a(xb)),xb.Oqd=!1));this.a5c||ea.a.J(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.Fb.editingView.disable(!1,14);this.a5c=!0}}J4k(){if(this.Fb.editingView&&this.Fb.editingView.Wl){const Ta=this.q1f();Ta&&Ta.shapeNode.ud&&(this.Hma.ZG(Ta.shapeNode).wvd(null),Ta.fde());this.a5c&&ea.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");
this.Fb.editingView.a1a();this.a5c=!1}}q1f(){let Ta=null;const xb=this.pa.Xd();1===xb.length&&(Ta=Object(na.a)(117,xb[0].sc(this.Fb.Ma)));return Ta}}Object(h.a)(We,"TypingLockHandler",null,[1239,106]);var $d=d(910);class Re{constructor(){this.B6c=this.nh=this.Y4=this.M5c=this.tE=this.K=this.lH=null;this.Lcc=0;this.oad=null;this.$se=!1;this.S2c=null;this.hve=!1;this.C5c=!0}get name(){return"Presence"}ozi(){this.K.register(E.a,"Common.PresenceUser").as("Common.IPresenceUser").ma();this.K.register(Vc,
"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().oa(()=>new Vc(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.$se=!0}Zb(Ta){this.Lcc=(new Date).getTime();this.K!==Ta&&(this.K=Ta,this.Y4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.nh=this.Y4.mEa(1,this.name),this.$se=!1,this.hve=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);this.lH=this.K.resolve("Common.AFrameworkApplication");Ta=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.C5c=!u.AFrameworkApplication.fa.ka("PPTODeprecateRtcFallback");this.$se||this.ozi();const xb=Ta.nsi&&Ta.KPb?!1:Ta.vg,kc=this.CHi(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("Common.IPresenceUser"),xb,Ta["368"]);kc&&(this.K.register(1226,"Common.IRealtimeChannelBasic").ma().oa(()=>kc),this.K.register(1227,"AppRealtimeChannel.IRealtimeChannel").ma().oa(()=>kc),this.lzi(Ta))}lzi(Ta){this.K.register(Ka,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().oa(()=>
new Ka(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(Xa,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().oa(()=>new Xa(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(tc,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().oa(()=>new tc(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),
this.K.resolve("PowerPointWebEditor.Core.INetworkState"),P.a.getInstance(),Ta.rtcAllowCrossDomainAccessOrigins));this.K.register(jb,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().oa(()=>new jb(this.K.resolve("Common.IPresenceUser"),u.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),
this.lH.JS,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),
this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Ta,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").oVc(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(oc,"PowerpointPresence.PresenceCache").ma().oa(()=>new oc(this.K.resolve("PowerpointPresence.IPresenceManager")));this.K.register(Uc,"PowerpointPresence.PresencePresenter").ma().oa(()=>new Uc(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,
this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Ta.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(qc,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().oa(()=>new qc(this.K.resolve("Common.IPresenceUser").clientId,Ta.cil,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").xd(10),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const xb=new rb(Ta.aOi,
Ta.Rrd,Ta.Qrd,Ta.pvb,Ta.N8b,Ta.lXc,Ta.$lb,Ta.Fud,Ta.Oib,Ta.ONc,Ta.MNc,Ta.XNb,Ta.pgb,Ta.Rub,Ta.podsTableRTTEnabled,Ta.podsTableCellLockEnabled);this.K.register(We,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().oa(()=>new We(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(Da,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().oa(()=>new Da(da.App.Jh,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").xd(12),Ta,xb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma,this.K.resolve("Box4.Graph.IGraphInstance").xd(16),K.a.av(G.a.instance.Ja("Common.ISystemInitiatedFeedback"))));this.K.register(1228,"PowerpointPresence.IPresencePawnFactory").ma().oa(()=>new cb);this.K.register(1229,"PowerpointPresence.ITextContentRecordFactory").ma().oa(()=>new Qd(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(kd,"PowerpointPresence.TextContentMonitor").ma().oa(()=>new kd(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),fa.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").xd(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),xb));this.K.register(A,"Common.App.Presence.AwayManager").ma().oa(()=>this.oDi(this.K.resolve("Common.IPresenceUser"),
this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter"),Ta.ka("PeoplesWellExtraButtonInfoIsEnabled")));this.K.register(1230,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().oa(()=>new Ib(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));this.hPc().Qjb("RTCConfigured")}Fhj(Ta){let xb;var kc=Ta;xb=0;if(Ta=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Uij())return kc=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Dqd(),
{LTe:Ta,JTe:xb,e3d:kc};xb=1;if(Ta=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").knh)return kc=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Dqd,{LTe:Ta,JTe:xb,e3d:kc};if(this.C5c)return{LTe:kc,JTe:2,e3d:!0}}BHi(){const Ta=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;0<Ta&&(this.oad=new B.a(2,1,Ta,()=>{this.C5c?this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").xVf=!0:this.K.rb("AppRealtimeChannel.IRealtimeChannel")||ea.a.J(509670485,
828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",Ta);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Ijh(Object(r.a)(this,this.XIe,"onPopsRtcEndpointUrlReady"));this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.Zb(G.a.instance),this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Db(this.oad))}CHi(Ta,xb,kc,Nc){ea.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",kc);xb.clientId=
Ta.clientId;var id=null;xb=null;const Ed=P.a.getInstance();if(kc){xb=Nc+"rtc2";({LTe:xb,JTe:kc,e3d:Nc}=this.Fhj(xb));id=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const Ja=this.C5c&&this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").xVf,db=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Ylg;ea.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",
gc[kc],id,Nc,Ja,db);if(2===kc&&!Ja)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").nbi(Object(r.a)(this,this.XIe,"onPopsRtcEndpointUrlReady")),this.BHi(),null;if(!Nc&&!id)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").OPd(Object(r.a)(this,this.lHb,"onCoauthStatusChanged")),null;id=this.iDi(Ta,xb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Ed)}return O.RealtimeChannel.createInstance(Ta.clientId,Ta.userSessionId,Ta.vnd,Ta.yca,Ta.fqh,
3,Ta.Ow,xb,id,Ed)}oDi(Ta,xb,kc,Nc,id){const Ed=new D.a;Ed.Kg(kc);kc=new D.a;kc.Kg(xb);return new A(Ta,kc.task,Ed.task,Nc,this.K.resolve("Common.ITaskManager"),this.lH.JS.qd.LSd?6E4:this.lH.JS.qd.awayCoauthorThresholdMs,Object(r.a)(this.lH.JS.VG(),this.lH.JS.VG().processAction,"processAction"),ma.App.Y5a.notificationBar,id)}init(){const Ta=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Ta.$h(21,Re.fhc);Ta.$h(22,this.Lcc);Ta.$h(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?
this.hPc().Qjb("PresentationId"):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").vvf(Object(r.a)(this,this.Lkc,"onPresentationIdReady"));this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").azb(()=>{this.hPc().Qjb("B2IFinished")})}Lkc(){this.hPc().Qjb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").Jjh(Object(r.a)(this,this.Lkc,"onPresentationIdReady"))}XIe(){this.oad&&this.K.resolve("Common.ITaskManager").Mg(this.oad);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Ijh(Object(r.a)(this,
this.XIe,"onPopsRtcEndpointUrlReady"));this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.Zb(G.a.instance),this.init())}lHb(Ta,xb){2!==xb.A0g||this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.Zb(G.a.instance),this.init());this.K.rb("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").zRe(Object(r.a)(this,this.lHb,"onCoauthStatusChanged"))}hPc(){this.B6c||(this.B6c=new $d.a(Object(r.a)(this,this.Jyb,"initInternal"),["PresentationId",
"B2IFinished","RTCConfigured"]));return this.B6c}Jyb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").$h(4,this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").IPe);this.K.resolve("PowerpointPresence.IPresencePerfLogger").$h(23,(new Date).getTime());this.GFj();this.yGj();this.B6c=null}yGj(){try{let Ta="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Ta=this.nh.Bu("presencemanager");this.zGj();this.nh.Gu(Ta);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").c0c=
!0;ea.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");da.App.tXd&&(Ta=this.nh.Bu("contentnotification"),vb.init(),this.nh.Gu(Ta));Ta=this.nh.Bu("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").NTi();this.tE=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.lH.JS.qd.vVi&&(ea.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.lH.JS.VG().processAction(y.a.r7a,
2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.lH.JS.qd.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.nh.Gu(Ta);this.K.resolve("PowerpointPresence.IPresencePerfLogger").yTi();
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").U4j()}catch(Ta){ea.a.J(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Ta)}}dispose(){this.tE?this.tE.disconnect():ea.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}zGj(){this.K.resolve("PowerpointPresence.PresenceManager").wb();ea.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}iDi(Ta,
xb,kc,Nc){let id=xb;id=id.endsWith("/")?id+"findsession":id+"/findsession";ea.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",id,Ta.yca.Tga);xb=()=>Z.FindSessionStrategy.qFi(Ta.userSessionId,Ta.yca,id,Ta.Ow,u.AFrameworkApplication.buildVersion,Ta.clientId,Re.y2i(u.AFrameworkApplication.buildVersion),Nc,Ta.fqh,()=>{if(u.AFrameworkApplication.hh)return u.AFrameworkApplication.hh;const Ja=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;
Ja||ea.a.J(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return Ja},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Sij());const Ed=!!this.M5c;return this.hve||Ed?this.S2c=new Ya(this.M5c,xb,kc,Nc,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):xb()}GFj(){var Ta;if(Ta=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").getFindSessionResponse():
this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").p4d)Ta=ca.RtcUtils.deserialize(Ta,"PresencePackage","Deserialize existing FindSession response",!0),this.Khd(Ta)}Khd(Ta){if(Ta)try{this.M5c=Object.assign(new Q.a,{bac:Ta[T.a.aAb],errorMessage:Ta[T.a.errorMessage],V0b:Ta[T.a.VZe],T5:Ta[T.a.T5],RA:Ta[T.a.RA],AVc:Ta[T.a.nbe],edd:Ta[T.a.qgb],fdd:Ta[T.a.$La],idd:Ta[T.a.sgb]}),this.hve&&this.S2c&&(this.S2c.findSessionResponse=this.M5c)}catch(xb){ea.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",
xb)}}static main(){Re.fhc=(new Date).getTime();const Ta=new Re;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")?(Ta.Zb(G.a.instance),Ta.K.rb("AppRealtimeChannel.IRealtimeChannel")&&Ta.init()):R.a.instance.Dc(Ta)}static y2i(Ta){return String.format("{0}, {1}, {2}",Re.uEf(V.a[3]),Re.uEf("browser"),Ta)}static uEf(Ta){return Ta?Ta.charAt(0).toLocaleUpperCase()+Ta.substring(1,Ta.length):Ta}}Re.fhc=0;Object(h.a)(Re,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");Re.main()},190:function(J,aa,d){d.r(aa);d.d(aa,"RtcUtils",function(){return n});J=d(0);var h=d(387),e=d(338),r=d(36);class n{static oVd(v,B=e.RealtimeChannel.xEe){let y;try{y=r.c(v)}catch(x){throw v=String.format("Failed to JSON-serialize payload : {0}",x),h.ULS.sendTraceTag(18637072,500,10,v),Error.argument("payload",v);}if(y.length>
B)throw v=String.format("Payload exceeds maximum length: {0} > {1}.",y.length,B),h.ULS.sendTraceTag(18637074,500,10,v),Error.argument("payload",v);return y}static deserialize(v,B,y){if(!v)return null;if(Object.getType(v)!==String){var x=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",B,Object.getType(v).getName(),y);h.ULS.sendTraceTag(18637075,500,10,x);return null}x=null;try{x=r.a(v)}catch(A){v=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
B,A,y),h.ULS.sendTraceTag(18637077,500,10,v)}return x}static bHb(v){if(!v)return"";if("string"===typeof v)return v.toString();try{return r.c(v)}catch(B){return v.toString()}}static SUf(v){let B,y,x;B=0;x=y=null;if(!v)return{Ede:B,Fde:y,$i:x};try{const A=v.source;A&&Object.getType(A)===String&&(x=A);const E=v.context;E&&(v=E,B=v.status?v.status:0,y=v.statusText?v.statusText:null)}catch(A){}return{Ede:B,Fde:y,$i:x}}}Object(J.a)(n,"RtcUtils",null,[])},238:function(J,aa,d){d.d(aa,"a",function(){return h});
J=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Qx(){return!0}static nub(e,r){return e+(r?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,504])},239:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r){super();this.type=e;this.Zi=r}}h.np="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,
[])},309:function(J,aa,d){d.r(aa);J=d(0);var h=d(387),e=d(14),r=d(105),n;(function(x){x[x.SendNotification=0]="SendNotification";x[x.SendPersistentState=1]="SendPersistentState";x[x.FindSession=2]="FindSession";x[x.Last=3]="Last"})(n||(n={}));Object(J.b)("ApiType",n);var v;(function(x){x[x.AttemptCount=0]="AttemptCount";x[x.SuccessCount=1]="SuccessCount";x[x.DropCount=2]="DropCount";x[x.FailedCount=3]="FailedCount";x[x.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";x[x.LatencyUnderThresholdCount=
5]="LatencyUnderThresholdCount";x[x.ThrottledCount=6]="ThrottledCount";x[x.Last=7]="Last"})(v||(v={}));Object(J.b)("EventCountType",v);var B=d(702);d.d(aa,"FrequentLoggingMetrics",function(){return y});class y{constructor(x){this.vIf=this.TWf=null;this.gZg=this.mZf=0;this.Kt=null;this.Kif=this.rGd=0;this.Yh=x;this.lGj();this.uBd=this.Ccf=this.JGd=!1;this.lGd=0}get xVi(){return this.uBd}Mrl(x){this.Kif=x;window.setInterval(Object(e.a)(this,this.bpe,"logMetricsBatchAndReset"),x);this.rGd=(new Date).getTime()}fH(x,
A){this.pil(x)&&!this.Ccf||this.xVi||!window.navigator.onLine||this.Yh.wFa||(this.Kt[x][A]++,this.JGd=!0)}lGj(){this.Kt=Array(3);for(let x=0;3>x;x++){this.Kt[x]=Array(7);for(let A=0;7>A;A++)this.Kt[x][A]=0}}Nli(){const x={};for(let A=0;3>A;A++)for(let E=0;7>E;E++)this.wYj(A,E)&&(x[n[A]+v[E]]=this.Kt[A][E]);x.FSDomain=this.TWf;x.ConnectionDomain=this.vIf;x.FSRetryInterval=this.mZf;x.MaxPayloadSize=this.gZg;x.LogNumber=this.lGd;1===this.lGd&&(x.FSLatencies=B.a.instance.X$i(),x.ConLatencies=B.a.instance.m7i());
return x}wYj(x,A){return 2===x&&3!==A&&0!==A?!1:!0}pil(x){return 2===x?!1:!0}bpe(){if(this.JGd){this.lGd++;if((new Date).getTime()-this.rGd<5E3+this.Kif){var x=r.a.toJSON(this.Nli());h.ULS.sendTraceTag(50644352,500,15,x)}this.rGd=(new Date).getTime();for(x=0;3>x;x++)for(let A=0;7>A;A++)this.Kt[x][A]=0;this.JGd=!1}}wlk(){this.Ccf=!0}static get instance(){return y.Ka}static create(x){y.instance||(y.Ka=new y(x));return y.instance}}y.Ka=null;Object(J.a)(y,"FrequentLoggingMetrics",null,[1260])},338:function(J,
aa,d){d.r(aa);J=d(0);var h=d(387),e=d(14),r=d(1066),n=d(993),v=d(68),B=d(27);class y{constructor(Oa,qa){this.status=Oa;this.VAb=qa}}Object(J.a)(y,"UserStatusInfo",null,[]);var x=d(81),A=d(702);class E{constructor(Oa,qa){this.data=Oa;this.timeStamp=qa}}Object(J.a)(E,"PresenceData",null,[]);class u{constructor(Oa){this.bra=!1;this.Pqb=0;this.Czd=!1;this.setTimeout=u.u_d;this.clearTimeout=u.k_d;this.c6j=Object(e.a)(this,this.p5j,"logRtcConnectingUsageStatement");this.$r=Oa}utk(){this.bra||(this.Pqb=
this.setTimeout(()=>{this.bra=!1;this.Org()},8E3),this.bra=!0,this.Czd=!1)}duk(){this.uN()}Szk(){this.Org()}Org(){this.uN();this.Czd||(this.Czd=!0,this.c6j())}p5j(){h.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.$r)}uN(){this.bra&&this.clearTimeout(this.Pqb);this.Pqb=0;this.bra=!1}static u_d(Oa,qa){return window.setTimeout(Oa,qa)}static k_d(Oa){window.clearTimeout(Oa)}}Object(J.a)(u,"ConnectedUsageKpiLogger",null,[1406]);class K{constructor(){this.lld=
this.dQe;this.gQe=this.hQe;this.mld=this.fQe;this.joc=this.jQe;this.Cgh=this.iQe;this.qQe=this.rQe;this.nQe=this.oQe;this.zib=this.lQe;this.loc=this.mQe;this.xgh=this.eQe;this.MGb=this.RFe;this.Mjc=this.SFe}dQe(){}hQe(){}fQe(){}jQe(){}iQe(){}oQe(){}mQe(){}lQe(){}rQe(){}eQe(){}RFe(){}SFe(){}}Object(J.a)(K,"NoopRealtimeChannelMetrics",null,[1345,234]);class G{}G.F1a="presenceUpdated";G.updateNotification="updateNotification";G.nah="persistentStateCleared";G.updatePersistentState="persistentStateUpdated";
Object(J.a)(G,"RtcClientMethodNames",null,[]);class O{}O.DBj="realtimeChannelHub";O.F1a="UpdatePresence";O.dga="SendUpdateNotification";O.O6d="GetCompletePersistentStateWithMetadata";O.updatePersistentState="UpdatePersistentState";O.cmb="UpdateClientInfo";Object(J.a)(O,"RtcHubMethodNames",null,[]);class R{constructor(Oa){this.Qz=Oa}FWk(Oa){this.Qz.on(G.F1a,Oa)}fXk(Oa){this.Qz.on(G.updateNotification,Oa)}CWk(Oa){this.Qz.on(G.updatePersistentState,Oa)}BWk(Oa){this.Qz.on(G.nah,Oa)}nDl(Oa){this.Qz.off(G.F1a,
Oa)}sDl(Oa){this.Qz.off(G.updateNotification,Oa)}mDl(Oa){this.Qz.off(G.updatePersistentState,Oa)}lDl(Oa){this.Qz.off(G.nah,Oa)}F1a(Oa){return this.Qz.invoke(O.F1a,Oa)}cmb(Oa){return this.Qz.invoke(O.cmb,Oa)}dga(Oa,qa){return this.Qz.invoke(O.dga,Oa,qa)}O6d(Oa){return this.Qz.invoke(O.O6d,Oa)}updatePersistentState(Oa,qa){return this.Qz.invoke(O.updatePersistentState,Oa,qa)}}Object(J.a)(R,"RealtimeChannelProxy",null,[1403,1404,1405]);class V{constructor(){this.kyd=this.T8e=!1;this.iyd=0;this.lzd=this.pLd=
this.oLd=this.Kxd=!1;this.HBd=0;this.Qnf=!1;this.Pnf=this.Onf=0;this.qKd=!1;this.uKd=this.sKd=this.vKd=this.rKd=0;this.tKd=!1}get LSd(){return this.kyd}get awayCoauthorThresholdMs(){return this.iyd}get jei(){return this.Kxd}get Cjl(){return this.oLd}get Djl(){return this.pLd}get evi(){return this.lzd}get w4b(){return this.HBd}get F5k(){return this.Qnf}get lnh(){return this.Onf}get E5k(){return this.Pnf}get z5k(){return this.qKd}get A5k(){return this.rKd}get pnh(){return this.vKd}get mnh(){return this.sKd}get onh(){return this.uKd}get nnh(){return this.tKd}static createInstance(Oa){const {RealtimeChannel:qa}=
d(338);return Oa?Object.assign(new V,{T8e:Oa.ka("AwayStatusManagerIsEnabled"),kyd:Oa.ka("AwayStatusOneMinuteTimeoutIsEnabled"),iyd:Oa.Bc("AwayCoauthorThresholdMs",9E5),Kxd:Oa.ka("RtcAllowCrossDomainAccessEnabled"),oLd:Oa.ka("ShouldLogOnContentNotification"),pLd:Oa.ka("ShouldLogOnHostSubscriptionNotification"),lzd:Oa.ka("RtcClientMetricsEnabled"),HBd:Oa.Bc("RtcFindSessionRequestTimeoutInMS",6E4),Qnf:Oa.ka("RtcJsClientFrequentlyLogsMetrics"),Onf:Oa.Bc("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),Pnf:Oa.Bc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),qKd:Oa.ka("RtcClientMessageTelemetryEnabled"),rKd:Oa.Bc("RtcClientMessageTelemetrySampleSize",5),vKd:Oa.Bc("RtcSendTelemetryMessageIntervalInMS",3E5),sKd:Oa.Bc("RtcLogClientMessageMetricsTimeOutInMs",2E4),uKd:Oa.Bc("RtcMaxPayloadSizeInCharactersOverride",qa.xEe),tKd:Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new V,{T8e:!1,kyd:!1,iyd:9E5,Kxd:!1,oLd:!1,pLd:!0,lzd:!1,HBd:9E4,
qKd:!1,rKd:5,vKd:3E5,sKd:2E4,uKd:qa.xEe,tKd:!1})}}Object(J.a)(V,"RealtimeChannelSettings",null,[1402]);var D=d(706),Q=d(1204),Z=d(158);class P{constructor(Oa){this.GXb=null;this.hya=0;this.F8a=!1;this.rl=Oa;this.rl.k6a(Object(e.a)(this,this.Cna,"onConnectionStateChanged"))}Cna(Oa,qa){this.hya=qa.newState}jAk(){h.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.rl.Xkd()}bFj(Oa){this.GXb.init(Oa)}}Object(J.a)(P,"ARtcMessageHandler",null,[]);var ca=d(1019);
class T{constructor(){this.Presence=null;this.TimeStamp=0}}Object(J.a)(T,"PresenceDataEntryForClients",null,[]);var da=d(105);class fa{constructor(Oa,qa=""){this.z0h=Oa;this.KAa=qa}send(){return this.z0h()}get messageId(){return this.KAa}}Object(J.a)(fa,"MessageHandler",null,[1387]);var ma=d(733);class ea extends Sys.EventArgs{constructor(Oa,qa,Ya,Fb){super();this.tSe=Oa;this.reconnectDelay=qa;this.reason=Ya;this.ZUe=Fb}}Object(J.a)(ea,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var ra=d(997);
class F{constructor(){this.XLd=this.Dj=null}get Vq(){return this.Dj?this.XLd?this.XLd.getTime()-this.Dj.getTime():(new Date).getTime()-this.Dj.getTime():0}start(){this.Dj=new Date}stop(){this.XLd=new Date}}Object(J.a)(F,"SimpleStopwatch",null,[]);var na=d(998),ka;(function(Oa){Oa[Oa.contentUpdate=0]="contentUpdate";Oa[Oa.editorsTableUpdate=1]="editorsTableUpdate";Oa[Oa.fileNameUpdate=2]="fileNameUpdate";Oa[Oa.wetContentUpdate=3]="wetContentUpdate";Oa[Oa.persistedContentUpdate=4]="persistedContentUpdate";
Oa[Oa.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Oa[Oa.replicationTelemetry=6]="replicationTelemetry";Oa[Oa.lockUpdate=7]="lockUpdate";Oa[Oa.collabServiceContentUpdate=8]="collabServiceContentUpdate";Oa[Oa.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Oa[Oa.saveTargetUpdate=10]="saveTargetUpdate";Oa[Oa.uploadToOcsUpdate=11]="uploadToOcsUpdate";Oa[Oa.labelUpdate=12]="labelUpdate";Oa[Oa.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Oa[Oa.subscribeOrExtend=
14]="subscribeOrExtend";Oa[Oa.elapsedBootTelemetry=15]="elapsedBootTelemetry";Oa[Oa.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";Oa[Oa.clientToClientResponseMessage=17]="clientToClientResponseMessage";Oa[Oa.verifyNotificationPipeline=18]="verifyNotificationPipeline";Oa[Oa.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";Oa[Oa.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Oa[Oa.last=21]="last"})(ka||(ka={}));Object(J.b)("UpdateNotificationType",ka);var Ua=d(931),
za=d(929),ha=d(930);class ua extends P{constructor(Oa,qa,Ya,Fb,hc,ec,Tb,vb,zb,Xb){super(Tb);this.Qz=null;this.Eif=!1;this.KAa=0;this.LId=new Z.a;this.mWh=ua.x7i();this.pId=B.AFrameworkApplication.fa.Ga("OwningFeatureCrewForRtcNotificationKpis");this.Jc=Oa;this.lkf=this.kkf=0;this.GXb=qa;this.GXb.jHc(Object(e.a)(this,this.jAk,"onTooManyUndeliveredMessages"));this._clientId=Ya;this.d_h=hc;this.rl.ybi(Object(e.a)(this,this.eyk,"onRefreshProxyRequired"));this.rl.wbi(Object(e.a)(this,this.cyk,"onRefreshAllPersistentStateRequest"));
this.rl.Lbi(Object(e.a)(this,this.dga,"sendUpdateNotification"));this.rl.u$h(Object(e.a)(this,this.Tvk,"onInternalPresenceUpdated"));this.rl.v$h(Object(e.a)(this,this.Uvk,"onInternalUpdateNotificationReceived"));this.rl.t$h(Object(e.a)(this,this.Svk,"onInternalPersistentStateUpdated"));this.rl.s$h(Object(e.a)(this,this.Rvk,"onInternalPersistentStateCleared"));this.rl.Kbi(Object(e.a)(this,this.iVe,"sendPersistentState"));this.rl.Cci(Object(e.a)(this,this.cmb,"updateClientInfo"));this.Zh=ec;this.$r=
Fb;this.Kt=vb;this.hN=zb;this.XUb=Xb;this.Wmb=Object(Q.a)(String,B.AFrameworkApplication.gd.Application)||""}eyk(Oa,qa){this.Qz=this.d_h(qa.hubConnection);this.GXb.reset();this.Qz.FWk(Object(e.a)(this,this.Kkc,"onPresenceUpdated"));this.Qz.CWk(Object(e.a)(this,this.pgd,"onPersistentStateUpdated"));this.Qz.BWk(Object(e.a)(this,this.VIe,"onPersistentStateCleared"));this.Qz.fXk(Object(e.a)(this,this.flc,"onUpdateNotificationReceived"))}Cna(Oa,qa){this.hya=qa.newState;2===qa.newState&&this.E9k()}E9k(){for(let Oa of this.LId)this.dga(null,
new ra.a(Oa.key,Oa.value,!1,new r.a));this.LId=new Z.a}cyk(Oa,qa){qa.IVd();for(Oa=0;3>Oa;++Oa)this.q9k(Oa,qa)}q9k(Oa,qa){try{this.Qz.O6d(Oa).done(Ya=>{qa.PPb(qa.aXd,"GetCompletePresenceSuccess")&&(qa.Uzi.Szk(),h.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",this.$r),this.rl.vQk(),this.vxk(Oa,Ya),this.rl.yPk(Ya),qa.wUf.Gb(Oa)&&this.rl.wfh(Oa,qa.wUf.ga(Oa),new r.a))}).fail(Ya=>{const {RtcUtils:Fb}=d(190);qa.PPb(qa.aXd,"GetCompletePresenceFail")&&(h.ULS.sendTraceTag(3249541,
500,15,"Failed to retrieve complete session state : {0} for [{1}]",Fb.bHb(Ya),this.$r),this.rl.Xkd())}).always(()=>{qa.Ky&&qa.Ky.stop()})}catch(Ya){h.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",qa.aXd,Ya.message)}}iVe(Oa,qa){var {RtcUtils:Ya}=d(190);Oa=qa.presence;let Fb;const hc=qa.PLa;this.hN.fH(1,0);try{Fb=Ya.oVd(Oa,this.XUb)}catch(Tb){this.hN.fH(1,
3);h.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Tb.message);hc.setException(Tb);return}Ya=new v.a;Ya.$(this._clientId,Object.assign(new T,{Presence:Oa,TimeStamp:(new Date).getTime()}));this.rl.Tfh(qa.type,Ya);if(2!==this.hya)this.Kt.zib(),this.hN.fH(1,2),hc.Kg(null);else{var ec=this.KAa.toString();++this.KAa;Oa=new fa(()=>this.G9k(qa.type,Fb,ec),ec);Oa=this.NCh(0,qa.type).add(Oa);Oa.Yfd(Tb=>{2===Tb&&this.hN.fH(1,6);hc.Kg(null)});
Oa.Xfd(()=>{})}}G9k(Oa,qa,Ya){let Fb=null;const hc=new F,ec=new ma.a;h.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.$r);if(2!==this.hya)return this.Kt.zib(),this.hN.fH(1,2),h.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.$r),ec.oEe(),ec;this.Zh&&20>this.kkf&&(Fb=this.Zh.Ei("WebServiceCall","Send Presence Message"),this.kkf++);hc.start();ec.Wic(1);try{this.Qz.updatePersistentState(Oa,qa).done(()=>{this.Kt.nQe();this.hN.fH(1,
1);h.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",Ya,this.$r);ec.AYa(1);hc&&(hc.stop(),hc.Vq>this.Jc.lnh?this.hN.fH(1,4):this.hN.fH(1,5))}).fail(Tb=>{const {RtcUtils:vb}=d(190);this.F8a||(this.Kt.zib(),this.hN.fH(1,3),h.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Ya,vb.bHb(Tb),this.$r));ec.AYa(2)}).always(()=>{Fb&&Fb.stop()})}catch(Tb){h.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
Tb.message),this.hN.fH(1,3),ec.AYa(2)}return ec}cmb(Oa,qa){({RtcUtils:Oa}=d(190));const Ya=qa.dvi,Fb=qa.PLa;let hc;try{hc=Oa.oVd(Ya,this.XUb)}catch(ec){h.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",ec.message);Fb.setException(ec);return}try{this.Qz.cmb(hc).done(()=>{h.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(ec=>{const {RtcUtils:Tb}=d(190);this.F8a||h.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",
Tb.bHb(ec));Fb.Kg(null)})}catch(ec){h.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",ec.message),Fb.Kg(null)}}dga(Oa,qa){({RtcUtils:Oa}=d(190));const Ya=qa.type,Fb=qa.Eza,hc=qa.$Li,ec=qa.PLa;let Tb;this.hN.fH(0,0);try{Tb=Oa.oVd(Fb,this.XUb)}catch(zb){this.hN.fH(0,3);h.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",zb.message);ec.setException(zb);return}if(2!==this.hya)hc?this.LId.$(Ya,
Fb):(this.Kt.zib(),this.hN.fH(0,2)),ec.Kg(null);else{var vb=this.KAa.toString();++this.KAa;qa=new fa(()=>this.c$k(Ya,Tb,vb),vb);qa=this.NCh(1,Ya).add(qa);qa.Yfd(zb=>{2===zb&&this.hN.fH(0,6);ec.Kg(null)});qa.Xfd(()=>{})}}c$k(Oa,qa,Ya){let Fb=null;const hc=new F,ec=new ma.a;h.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.$r);if(2!==this.hya)return this.Kt.zib(),this.hN.fH(0,2),h.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",
this.$r),ec.oEe(),ec;this.Zh&&3===Oa&&20>this.lkf&&(Fb=this.Zh.Ei("WebServiceCall","Send WetContent Update"),this.lkf++);hc.start();ec.Wic(1);this.Qz.dga(Oa,qa).done(()=>{this.Kt.nQe();this.hN.fH(0,1);h.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",Ya,this.$r);ec.AYa(1);hc&&(hc.stop(),hc.Vq>this.Jc.lnh?this.hN.fH(0,4):this.hN.fH(0,5))}).fail(Tb=>{const {RtcUtils:vb}=d(190);this.F8a||(this.Kt.zib(),this.hN.fH(0,3),h.ULS.sendTraceTag(3249507,500,
15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Ya,vb.bHb(Tb),this.$r));ec.AYa(2)}).always(()=>{Fb&&Fb.stop()});return ec}Dza(){this.Qz.nDl(Object(e.a)(this,this.Kkc,"onPresenceUpdated"));this.Qz.mDl(Object(e.a)(this,this.pgd,"onPersistentStateUpdated"));this.Qz.lDl(Object(e.a)(this,this.VIe,"onPersistentStateCleared"));this.Qz.sDl(Object(e.a)(this,this.flc,"onUpdateNotificationReceived"))}Tvk(Oa,qa){this.Kkc(qa.DPb,qa.PPf)}Kkc(Oa){this.Kt.loc();this.pgd(0,Oa)}Svk(Oa,
qa){this.pgd(qa.type,qa.DPb)}vxk(Oa,qa){const Ya={};for(let Fb in qa)Ya[Fb]=qa[Fb].Presence;this.W5g(Oa,Ya,qa)}pgd(Oa,qa){this.Kt.loc();this.W5g(Oa,qa)}W5g(Oa,qa,Ya=null){var {RtcUtils:Fb}=d(190);if(h.ULS.Jya(500,100))for(var hc in qa);delete qa[this._clientId];if(!da.a.isEmpty(qa)){for(var ec in qa)hc=ec,qa[hc]=Fb.deserialize(qa[ec],"Presence",hc,!1,this.XUb);Fb=new v.a;ec=(new Date).getTime();for(let Tb in qa){hc=qa[Tb];let vb=Tb,zb;Ya?(zb=Ya[vb],zb.Presence=hc):zb=Object.assign(new T,{Presence:hc,
TimeStamp:ec});Fb.$(vb,zb)}this.rl.Tfh(Oa,Fb);switch(Oa){case 0:this.Eif||(h.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.$r),this.Eif=!0,B.AFrameworkApplication.Zg&&B.AFrameworkApplication.Zg.slk());this.rl.lfh(qa,[]);break;default:this.rl.iQk(Oa,qa)}}}Rvk(Oa,qa){this.VIe(qa.$Vd)}VIe(Oa){this.Kt.loc();if(h.ULS.Jya(500,100))for(let qa=0;qa<Oa.length;++qa);Oa.length&&(this.rl.xRk(Oa),this.rl.hQk(Oa),this.rl.lfh({},Oa))}Uvk(Oa,qa){this.flc(qa.type,qa.Eza)}flc(Oa,
qa=null){this.Jc.Cjl&&0===Oa&&h.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===Oa&&this.pId&&0<this.pId.length){var Ya=Object.assign(new Ua.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.pId,vetoPillar:"RealTimeCoauth"});(Ya=ca.a.getInstance(Ya))&&Ya.logKpiUsage(this.mWh)}this.Jc.Djl&&13===Oa&&h.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",
qa||"<none>"));this.Kt.loc();5===Oa?(qa=(Oa=this.sEk(qa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",Oa.reason,Oa.reconnectDelay):"Received client reconnection request from the server without params.",h.ULS.sendTraceTag(18637071,500,50,qa),this.rl.Xkd(Oa)):(qa=d(190).RtcUtils.deserialize(qa,String.format("UpdateNotification-{0}",ka[Oa]),null,!1,this.XUb),this.rl.wRk(Oa,qa))}sEk(Oa){try{if(!Oa||""===Oa)return null;const qa=JSON.parse(Oa);return new ea(qa[na.a.MTe],
qa[na.a.y5k],qa[na.a.C5k],qa[na.a.ZUe])}catch(qa){return h.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",qa.message),null}}NCh(Oa,qa){return this.GXb.Jnj(this.Knj(Oa,qa))}Knj(Oa,qa){return Oa+","+qa}static x7i(){var Oa=new Map;Oa.set("SkipAria","True");Oa=Object.assign(new za.a,{extendedProperties:Oa});return Object.assign(new ha.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:Oa,blockFutureEmissionDurationInMs:3E5})}}Object(J.a)(ua,"RtcMessageHandler",
P,[]);class Ga{jLf(Oa,qa=""){const {MaxOutstandingThrottler:Ya}=d(994);return Ya.createInstance(Oa,qa)}RFi(Oa,qa=""){const {MaxRateThrottler:Ya}=d(996);return Ya.createInstance(Oa,qa)}}Object(J.a)(Ga,"ThrottlerFactory",null,[1347]);var sa=d(78),Ba=d(703);class pa{constructor(Oa){this.Jc=null;this.EP=!1;this.Pa=new sa.a;this.EGd=new v.a;this.CGd=new v.a;this.VMd=Oa;this.sob=this.VMd.jLf(qa=>qa.send(),"GlobalMaxOustandingThrottler");this.sob.jHc(()=>{this.Pa.raiseEvent("TMUDM")})}init(Oa){this.EP||
(this.Jc=Oa,this.sob.init(this.Jc.$La,this.Jc.Bqj),this.EP=!0)}Jnj(Oa){var {MaxRateThrottler:qa}=d(996),{MaxOutstandingThrottler:Ya}=d(994);this.EP||this.init(new Ba.a(qa.pNf,Ya.GNf,Ya.vNf,pa.xmk));({value:qa}=this.EGd.Tf(Oa)).returnValue||(({value:qa}=this.CGd.Tf(Oa)).returnValue||(qa="MaxOutstandingThrottler-"+Oa,qa=this.VMd.jLf(Object(e.a)(this.sob,this.sob.add,"add"),qa),qa.init(this.Jc.$La,this.Jc.wmk),qa.jHc(()=>{this.Pa.raiseEvent("TMUDM")}),this.CGd.add(Oa,qa)),Ya="MaxRateThrottler-"+Oa,qa=
this.VMd.RFi(Object(e.a)(qa,qa.add,"add"),Ya),qa.init(this.Jc.tnk),this.EGd.add(Oa,qa));return qa}reset(){for(let Oa of this.EGd)Oa.value.pQe();for(let Oa of this.CGd)Oa.value.pQe(),Oa.value.reset();this.sob.pQe();this.sob.reset()}jHc(Oa){this.Pa.addHandler("TMUDM",Oa)}}pa.xmk=1E3;Object(J.a)(pa,"ThrottlerManager",null,[1346]);var ia=d(1142);const Da=(Oa,qa,Ya,Fb,hc,ec,Tb,vb,zb=null,Xb=null,Za=null,Va=null)=>{const tc=V.createInstance(B.AFrameworkApplication.fa),Kb=B.AFrameworkApplication.buildVersion?
B.AFrameworkApplication.buildVersion:"1.0",Pa=Xa(Oa,qa,Tb,Kb),mb=tc.evi?d(1140).RealtimeChannelMetrics.createInstance(Pa):new K;var qc=d(309).FrequentLoggingMetrics.create(hc);tc.F5k&&qc.Mrl(tc.E5k);var oc="";oc=zb&&""!==zb?zb:"/rtc2/";qc.TWf=x.a.YD(oc);const ib=oc+"signalr";zb=oc+"findsession";const $a=O.DBj;oc=new Ga;Za=Za||D.a.getInstance();h.ULS.shipAssertTag(556867617,500,tc.onh<=d(338).RealtimeChannel.hZg,"Client attempting to override max payload size beyond absolute limit");const Db=Math.min(tc.onh,
d(338).RealtimeChannel.hZg);qc.gZg=Db;qc=new ua(tc,new pa(oc),Oa,Pa,Mb=>new R(Mb.createHubProxy($a)),vb,Za,mb,qc,Db);Xb||(Xb=d(708).FindSessionStrategy.createInstance(qa,hc,zb,vb,Kb,Tb,Oa,Pa,Za,ec,Fb,Va));Xb.w4b=tc.w4b;qa=new u(Pa);Ya=Ya?Ya.split(","):null;Oa=new (d(338).RealtimeChannel)(Oa,Ya,Pa,vb,()=>$.hubConnection(ib),Xb,qc,qa,Za,mb,tc,hc);Oa.init();return Oa},Xa=(Oa,qa,Ya)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Oa,Ka(ia.a[Ya]),Ka("browser"),qa),Ka=Oa=>Oa?Oa.charAt(0).toLocaleUpperCase()+
Oa.substring(1,Oa.length):Oa;d.d(aa,"RealtimeChannel",function(){return Ma});class Ma{constructor(Oa,qa,Ya,Fb,hc,ec,Tb,vb,zb,Xb,Za,Va){this.VLd=!1;this.qZ=null;this.uS=new v.a;this.qRb=1;this.n2=null;this.vK=!1;this.xFd=(new Date(0)).getTime();this.mpf=0;this._clientId=Oa;this.qFc=qa;this.rZ=0;this.Zh=Fb;this.Bzd=vb;this.k0h=Tb;this.tNh=zb;this.bQh=hc;this.RMa=ec;this.$r=Ya;this.Kt=Xb;this.Jc=Za;this.Yh=Va;this.C1h=1>100*Math.random()}get jna(){return this.RMa.jna}set jna(Oa){this.RMa.jna=Oa}get F_a(){return this.k0h}get rl(){return this.tNh}init(){this.rl.xbi(Object(e.a)(this,
this.PNc,"disconnectAndCreateNewConnection"));this.rl.Eci(Object(e.a)(this,this.yAk,"onUpdatePersistentStateRequestReceivedInternal"));this.rl.Dci(Object(e.a)(this,this.xAk,"onUpdatePersistentStateClearedRequestReceived"));this.Yh.BGc(this.Kt);B.AFrameworkApplication.vga(()=>{const {FrequentLoggingMetrics:Oa}=d(309);this.Kt.qQe();Oa.instance&&Oa.instance.bpe()});this.qLf();this.$Ni();this.rl.Fvf(Object(e.a)(this,this.CEl,"updateConnectionQueryString"))}$Ni(){try{const Ya=$.signalR;if(!Ya)throw Error.invalidOperation("Failed to retrieve Signalr object");
const Fb=Ya.version;if(!Fb)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Fb){var Oa=Ya.transports;if(!Oa)throw Error.invalidOperation("Failed to retrieve transports object");var qa=Oa.longPolling;if(!qa)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!qa.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");qa.supportsKeepAlive=this.WHi()}}catch(Ya){h.ULS.sendTraceTag(6432339,
500,15,"Failed to disable longPolling KeepAlives: {0}",Ya.message)}}WHi(){return()=>!1}qLf(){const Oa=++this.qRb;this.xFd=(new Date(0)).getTime();this.n2=this.bQh();this.rl.rQk(this.n2);this.n2.stateChanged(qa=>{this.ytk(qa,Oa)});this.n2.connectionSlow(Object(e.a)(this,this.Kzk,"onSlowConnection"));this.n2.error(Object(e.a)(this,this.vzk,"onSignalRError"));this.n2.log=Object(e.a)(this,this.wzk,"onSignalRLog")}PPb(Oa,qa){return Oa!==this.qRb?(h.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",
qa),!1):!0}connect(){2!==this.rZ&&1!==this.rZ&&(h.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.$r),this.Bzd.utk(),A.a.instance.Nrl(),this.Cna(1,this.rZ),this.Uyh())}Uyh(){const Oa=this.qRb;this.VLd=!1;this.Kt.lld();this.RMa.o$d(Object(e.a)(this,this.Tzi,"connectSignalrConnection"),Object(e.a)(this,this.g4g,"onFailureToConnect"),Object(e.a)(this.F_a,this.F_a.bFj,"initThrottlerManager"),Object(e.a)(this,this.PPb,"verifyConnectionToken"),Oa)}g4g(Oa=null){this.Kt.mld();
let qa=null;!Oa||"documentsessiondeleted"!==(qa=Oa.toLowerCase())&&"documentsessionexpired"!==qa?this.PNc():(h.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.$r,Oa),this.disconnect())}PNc(Oa,qa=null){h.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.qZ);Oa=(Oa=2===this.rZ||1===this.rZ)&&!this.F_a.F8a;let Ya=!0,Fb=0;qa&&Object.getType(qa)!==Object.getType(Sys.EventArgs.Empty)&&
qa.tSe&&""!==qa.tSe&&(Oa=!0,this.RMa.LWe(qa.tSe),Ya=qa.ZUe,Fb=qa.reconnectDelay);Oa&&this.Cna(1,this.rZ);++this.qRb;this.F_a.Dza();this.Csl(Ya);this.RMa.G0d();this.qLf();Oa&&window.setTimeout(Object(e.a)(this,this.Uyh,"startConnecting"),Math.min(Fb,3E4))}CEl(){let Oa=null;const qa=({correlationId:Oa}=this.RMa.aTc()).returnValue;this.n2.qs=qa;h.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.$r,Oa)}Tzi(Oa){const {FrequentLoggingMetrics:qa}=
d(309);this.xFd=(new Date).getTime();let Ya=null;this.n2.qs=({correlationId:Ya}=this.RMa.aTc()).returnValue;this.Jc.jei&&(this.n2.url=Oa,qa.instance&&(qa.instance.vIf=x.a.YD(Oa)));let Fb=null;this.Zh&&(Fb=this.Zh.Ei("WebServiceCall","ConnectToServer"));h.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.$r);Oa={};this.qFc&&(Oa.transport=1===this.qFc.length?this.qFc[0]:this.qFc);Oa.pingInterval=null;A.a.instance.koc(1,0);Oa.waitForPageLoad=!1;this.n2.start(Oa,null).done(hc=>
{this.Kt.gQe();A.a.instance.koc(1,1,!0);h.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",hc.id,Ya)}).fail(hc=>{h.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.RMa.RA,Ya,this.$r);this.g4g();this.Kt.xgh(hc);A.a.instance.koc(1,1,!1);this.rl.tfh(0,{["CorrelationId"]:Ya,["ErrorDetails"]:hc,["ConnectionState"]:n.a[this.rZ]})}).always(()=>{const {FrequentLoggingMetrics:hc}=
d(309);Fb&&Fb.stop();hc.instance&&(hc.instance.uBd=!1)})}disconnect(){const {FrequentLoggingMetrics:Oa}=d(309);0===this.rZ?h.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.$r):(this.Kt.Cgh(),Oa.instance&&(Oa.instance.uBd=!0),h.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.$r),this.F_a.F8a=!0,this.Bzd.duk(),this.Cna(0,this.rZ),this.PNc(),this.F_a.F8a=!1)}Csl(Oa){const qa=this.Jpi(),Ya=this.n2,Fb=this.qZ,
hc=()=>{if(this.VLd)h.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.VLd=!0,Ya.stop(!0,Oa)}catch(ec){h.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",ec.message)}};0<qa?(h.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Fb,qa),window.setTimeout(hc,qa)):(h.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Fb),hc())}Jpi(){let Oa=0;0===this.n2.state&&(Oa=this.xFd+Ma.jLl-
(new Date).getTime(),0>Oa&&(Oa=0));return Oa}get connectionState(){return this.rZ}k6a(Oa){this.rl.k6a(Oa)}jVe(Oa){return this.iVe(0,Oa)}iVe(Oa,qa){const Ya=new r.a;this.rl.wfh(Oa,qa,Ya);return Ya.task}fHc(Oa){this.rl.fHc(Oa)}Lta(Oa){return this.Qoj(Oa)}HRc(){return this.k4i()}k4i(){const Oa={};for(let qa of this.uS)qa.value.Gb(0)&&(Oa[qa.key]=qa.value.ga(0).data);return Oa}Qoj(Oa){return this.uS.Gb(Oa)&&this.uS.ga(Oa).Gb(0)?this.uS.ga(Oa).ga(0).data:null}yAk(Oa,qa){for(let Ya of qa.nIl)this.uS.Gb(Ya.key)||
this.uS.$(Ya.key,new Z.a),Oa=Ya.value,this.uS.ga(Ya.key).$(qa.type,new E(Oa.Presence,new Date(Oa.TimeStamp))),Ya.key===this._clientId&&0===qa.type&&this.rl.RPk(Oa.Presence)}xAk(Oa,qa){for(const Ya of qa.$Vd)this.uS.remove(Ya)}j4i(){const Oa=new Z.a;if(!this.uS.Gb(this._clientId))return Oa;for(let qa of this.uS.ga(this._clientId))Oa.$(qa.key,qa.value.data);return Oa}dga(Oa,qa=null,Ya=!1){const Fb=new r.a;this.rl.LPe(Oa,qa,Ya,Fb);return Fb.task}WBa(Oa){this.rl.WBa(Oa)}Iej(){return this.T3(this._clientId)}T3(Oa){let qa,
Ya;return({value:qa}=this.uS.Tf(Oa)).returnValue&&({value:Ya}=qa.Tf(0)).returnValue?new y(this.Uoj(Ya),Ya.timeStamp):null}s4i(){const Oa={};for(let qa of this.uS)qa.value.Tf(0).returnValue&&(Oa[qa.key]=this.T3(qa.key));return Oa}cmb(Oa){const qa=new r.a;this.rl.vRk(Oa,qa);return qa.task}get clientId(){return this._clientId}get Iol(){return this.C1h}dispose(){const {FrequentLoggingMetrics:Oa}=d(309);this.vK||(this.F_a.Dza(),this.Yh.Old(this.Kt),this.Kt.qQe(),Oa.instance&&Oa.instance.bpe(),this.vK=
!0)}ytk(Oa,qa){this.PPb(qa,"StateChangedSignalR")&&this.Cna(this.tJf(Oa.newState),this.tJf(Oa.oldState))}Cna(Oa,qa){var {FrequentLoggingMetrics:Ya}=d(309),{ClientToClientMessageTelemetry:Fb}=d(1041);if((1!==this.rZ||0!==qa||1!==Oa)&&this.rZ!==qa){const hc=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.rZ,qa,Oa]));h.ULS.sendTraceTag(3290053,500,10,hc)}if(this.rZ!==Oa){switch(Oa){case 2:Ya.instance&&
Ya.instance.wlk();this.qZ=this.n2.id;h.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.qZ,this.$r);this.T5j(this.n2);h.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");Ya=null;this.Zh&&(Ya=this.Zh.Ei("WebServiceCall","Receive First Presence"));Fb=this.qRb;this.rl.qQk(Object(e.a)(this,this.PPb,"verifyConnectionToken"),Fb,this.Bzd,Object(e.a)(this,this.IVd,"clearExistingPersistentState"),this.j4i(),Ya);this.Jc.z5k&&(Ya=100*Math.random()<=this.Jc.A5k,
d(1041).ClientToClientMessageTelemetry.Gfj(this.rl,this.Jc,Ya).start());break;case 1:2===qa&&h.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.qZ);break;case 0:if(Fb.instance&&Fb.instance.stop(),this.F_a.F8a)h.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.qZ);else{1===qa&&(h.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.qZ),this.Kt.joc());2===qa&&h.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.qZ);this.PNc();return}}this.rZ=Oa;this.rl.bPk(Oa,qa)}}T5j(Oa){if(Oa&&Oa.transport&&Oa.transport.name){Oa=Oa.transport.name;var qa=Oa.toLowerCase();"websockets"===qa?h.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"serversentevents"===qa?h.ULS.sendTraceTag(4290752,
500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"foreverframe"===qa?h.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"longpolling"===qa?h.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"mocktransport"!==qa&&h.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Oa)}else h.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}Kzk(){if(this.Jc.nnh){const Oa=x.a.kT(this.jna,"mid");h.ULS.sendTraceTag(3249544,
500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.qZ,Oa)}else h.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.qZ)}vzk(){h.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.qZ)}wzk(Oa){Oa=d(190).RtcUtils.bHb(Oa);if(this.Jc.nnh&&Oa.startsWith("Keep alive timed out.")){const qa=x.a.kT(this.jna,"mid");h.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",Oa,qa)}else this.Iol&&2E3>this.mpf&&
!Oa.startsWith("Invok")&&!Oa.startsWith("Trigger")&&(h.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Oa),this.mpf++)}IVd(){let Oa;const qa=[];({value:Oa}=this.uS.Tf(this._clientId)).returnValue&&this.uS.remove(this._clientId);for(let Ya of this.uS.keys)Array.add(qa,Ya);for(const Ya of qa)this.uS.remove(Ya);Oa&&this.uS.$(this._clientId,Oa);this.rl.HPk(qa)}tJf(Oa){switch(Oa){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Oa,"Unknown SignalR state");
}}Uoj(Oa){return Oa&&Oa.timeStamp?(new Date).getTime()-Oa.timeStamp.getTime()>(this.Jc.LSd?6E4:this.Jc.awayCoauthorThresholdMs)?2:1:1}static createInstance(Oa,qa,Ya,Fb,hc,ec,Tb,vb=null,zb=null,Xb=null,Za=null,Va=null,tc=null){return Da(Oa,qa,Ya,tc,Fb,hc,ec,Tb,vb,zb,Xb,Va,Za)}}Ma.hZg=31E3;Ma.xEe=8E3;Ma.jLl=15E3;Object(J.a)(Ma,"RealtimeChannel",null,[1227,1226])},702:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.Upf=!1;this.iJd=null;this.L$e=0;this.GBd=this.kMf();
this.lxc=this.kMf();this.C2a=this.nob=0;this.EF=()=>new Date}get ptl(){return this.Upf}kMf(){const e=Array(6);for(let r=0;r<e.length;r++)e[r]=0;return e}X$i(){return this.GBd.toString()}m7i(){return this.lxc.toString()}Nrl(){this.iJd=this.EF()}koc(e,r,n=!1){this.ptl||(n&&(this.Upf=!0),n=this.EF(),0===e&&5<this.nob||1===e&&5<this.C2a||(this.L$e<e?(1===this.nob%2&&(this.GBd[this.nob]=-1,this.nob++),this.L$e=e,1===r&&(this.lxc[this.C2a]=-1,this.C2a++),this.lxc[this.C2a]=this.f0e(n),this.C2a++):0===e?
(this.GBd[this.nob]=this.f0e(n),this.nob++):(this.lxc[this.C2a]=this.f0e(n),this.C2a++)))}f0e(e){const r=e.getTime()-this.iJd.getTime();this.iJd=e;return r}static get instance(){h.Ka||(h.Ka=new h);return h.Ka}static set instance(e){h.Ka=e}}h.Ka=null;Object(J.a)(h,"LatencyMetrics",null,[])},703:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r,n,v){this.tnk=e;this.$La=r;this.wmk=n;this.Bqj=v}}Object(J.a)(h,"ThrottlerManagerSettings",null,[])},706:function(J,aa,d){J=d(0);
class h extends Sys.EventArgs{constructor(Z,P){super();this.newState=Z;this.oldState=P}}Object(J.a)(h,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(Z,P){super();this.dvi=Z;this.PLa=P}}Object(J.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(Z){super();this.presence=Z}}Object(J.a)(r,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class n extends Sys.EventArgs{constructor(Z){super();this.$Vd=Z}}Object(J.a)(n,"PersistentStateClearedEventArgs",
Sys.EventArgs,[]);class v extends Sys.EventArgs{constructor(Z,P){super();this.type=Z;this.DPb=P}}Object(J.a)(v,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var B=d(1141);class y extends Sys.EventArgs{constructor(Z,P=null){super();this.IG=Z;this.T3h=P}get type(){return this.IG}get Eza(){return this.T3h}}Object(J.a)(y,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class x extends Sys.EventArgs{constructor(Z){super();this.wKk=Z}}Object(J.a)(x,"GotCompletePersistentStateWithMetadataEventArgs",
Sys.EventArgs,[]);class A extends Sys.EventArgs{constructor(Z,P,ca,T,da,fa){super();this.PPb=Z;this.aXd=P;this.Uzi=ca;this.wUf=da;this.IVd=T;this.Ky=fa}}Object(J.a)(A,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(Z){super();this.hubConnection=Z}}Object(J.a)(E,"RefreshProxyEventArgs",Sys.EventArgs,[]);class u extends Sys.EventArgs{constructor(Z,P){super();this.kXi=Z;this.errorMessage=P}}Object(J.a)(u,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class K extends Sys.EventArgs{constructor(Z,
P,ca){super();this.type=Z;this.presence=P;this.PLa=ca}}Object(J.a)(K,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var G=d(997);class O extends Sys.EventArgs{constructor(){super()}}Object(J.a)(O,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class R extends Sys.EventArgs{constructor(Z){super();this.$Vd=Z}}Object(J.a)(R,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class V extends Sys.EventArgs{constructor(Z,P){super();this.type=Z;this.nIl=P}}Object(J.a)(V,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var D=d(78);d.d(aa,"a",function(){return Q});class Q{constructor(){this.Pa=new D.a}bPk(Z,P){this.Pa.raiseEvent("CSC",new h(Z,P))}rQk(Z){this.Pa.raiseEvent("RP",new E(Z))}Xkd(Z){this.Pa.raiseEvent("RC",Z)}vQk(){this.Pa.raiseEvent("RMID")}qQk(Z,P,ca,T,da,fa){this.Pa.raiseEvent("RPS",new A(Z,P,ca,T,da,fa))}Tfh(Z,P){this.Pa.raiseEvent("UPSR",new V(Z,P))}lfh(Z,P){this.Pa.raiseEvent("PU",new B.a(Z,P))}RPk(Z){this.Pa.raiseEvent("MPU",new r(Z))}LPe(Z,P,ca,T){this.Pa.raiseEvent("SUN",new G.a(Z,
P,ca,T))}wRk(Z,P){this.Pa.raiseEvent("UNR",new y(Z,P))}wfh(Z,P,ca){this.Pa.raiseEvent("SP",new K(Z,P,ca))}iQk(Z,P){this.Pa.raiseEvent("PSU",new v(Z,P))}hQk(Z){this.Pa.raiseEvent("PSC",new n(Z))}HPk(Z){this.Pa.raiseEvent("IPSC",new n(Z))}xRk(Z){this.Pa.raiseEvent("UPSC",new R(Z))}EQk(Z,P){this.Pa.raiseEvent("SPC",new O(Z,P))}tfh(Z,P){this.Pa.raiseEvent("RCF",new u(Z,P))}yPk(Z){this.Pa.raiseEvent("CPSWM",new x(Z))}vRk(Z,P){this.Pa.raiseEvent("UCI",new e(Z,P))}k6a(Z){this.Pa.addHandler("CSC",Z)}ybi(Z){this.Pa.addHandler("RP",
Z)}xbi(Z){this.Pa.addHandler("RC",Z)}Ebi(Z){this.Pa.addHandler("RMID",Z)}wbi(Z){this.Pa.addHandler("RPS",Z)}Eci(Z){this.Pa.addHandler("UPSR",Z)}fHc(Z){this.Pa.addHandler("PU",Z)}u$h(Z){this.Pa.addHandler("IPU",Z)}Cci(Z){this.Pa.addHandler("UCI",Z)}Lbi(Z){this.Pa.addHandler("SUN",Z)}v$h(Z){this.Pa.addHandler("IUNR",Z)}WBa(Z){this.Pa.addHandler("UNR",Z)}t$h(Z){this.Pa.addHandler("IPSU",Z)}s$h(Z){this.Pa.addHandler("IPSC",Z)}Dci(Z){this.Pa.addHandler("UPSC",Z)}Kbi(Z){this.Pa.addHandler("SP",Z)}Fvf(Z){this.Pa.addHandler("SPC",
Z)}Ibi(Z){this.Pa.addHandler("RCF",Z)}n$h(Z){this.Pa.addHandler("CPSWM",Z)}LZk(Z){this.Pa.removeHandler("CPSWM",Z)}static getInstance(){return Q.Ka||(Q.Ka=new Q)}}Q.Ka=null;Object(J.a)(Q,"RtcEventHub",null,[1254])},708:function(J,aa,d){d.r(aa);J=d(0);var h=d(387),e=d(14),r=d(18),n=d(993),v=d(999),B=d(27),y=d(81),x=d(65),A=d(453),E=d(498),u=d(105),K=d(47),G=d(109),O=d(1E3);class R{}R.clientId="ClientId";R.RIl="UserApp";R.userSessionId="usid";R.userType="UserType";R.fJl="UserVersion";R.Pnc="qs";R.gvi=
"clientProtocol";R.zpk="NoAuth";Object(J.a)(R,"RtcFindSessionInputQueryParamConstants",null,[]);class V{constructor(ea,ra,F,na,ka,Ua){this.I4a=null;const {FindSessionStrategy:za}=d(708);this.h_h=ea;ea=String.format("{0}={1}",R.clientId,K.a.Ne(na));ea=String.format("{0}&{1}={2}",ea,R.userSessionId,K.a.Ne(ka));ea=String.format("{0}&{1}={2}",ea,R.RIl,K.a.Ne(F.toString()));ea=String.format("{0}&{1}={2}",ea,R.userType,K.a.Ne("1"));ea=String.format("{0}&{1}={2}",ea,R.fJl,K.a.Ne(ra));ea=String.format("{0}&{1}={2}",
ea,R.gvi,K.a.Ne(za.fvi));(ra=V.R4i(F,Ua))&&(ea=String.format("{0}&{1}",ea,ra));this.dQh=ea}ihh(){this.I4a=this.h_h()}p2i(){this.I4a&&""!==this.I4a||(this.ihh(),h.ULS.sendTraceTag(575784194,500,this.I4a&&""!==this.I4a?50:15,"Query signature delegate called for refresh returned: {0} ",this.I4a));const ea=String.format("{0}={1}",R.Pnc,K.a.Ne(this.I4a));return String.format("{0}&{1}",ea,this.dQh)}static R4i(ea,ra){return 4===ea?String.format("{0}={1}",R.zpk,"1"):ra?ra.Yoj():null}}Object(J.a)(V,"FindSessionQueryStringGenerator",
null,[]);var D=d(309),Q=d(702),Z=d(190),P=d(703);class ca{}ca.zZi="FSType";Object(J.a)(ca,"RtcFindSessionRequestHeaders",null,[]);class T{}T.sSk="polling";Object(J.a)(T,"RtcFindSessionTypes",null,[]);var da=d(998);class fa{}fa.cKl="RTC-TokenProofkey";fa.PYj="RTC-IsWacJsBootFsRequest";Object(J.a)(fa,"RtcRequestHeaders",null,[]);d.d(aa,"FindSessionStrategy",function(){return ma});class ma{constructor(ea,ra,F,na,ka,Ua,za,ha,ua,Ga,sa,Ba,pa=null){this.Chf=(new Date(0)).getTime();this.Oif=0;this.iBc=!1;
this.Gof=null;this.zQe=36E5;this.Enb=ma.Yeg;this.sSb=0;this.hjb=null;this.hya=0;this.aLb=this.wIf=null;this.O_h=[v.a.aAb,v.a.errorMessage,v.a.VZe,v.a.RA,v.a.T5,v.a.nbe,v.a.qgb,v.a.$La,v.a.sgb];this.N_h=[v.a.aAb,v.a.errorMessage];this.RA=this.jna=null;this.wcf=new V(sa?sa:()=>B.AFrameworkApplication.hh,ka,Ua,za,ea,ra);this.XQb=Ba;this.Zh=na;this.Yh=ra;this.CSh=F;this.$r=ha;this.rl=ua;this.ESb=pa;this.xcf=!1;this.w4b=9E4;Ga&&Ga.execute(ia=>{ia.cHc(()=>{h.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
this.$r);this.wcf.ihh()})});2>=100*Math.random()&&(this.zQe=3E5);D.FrequentLoggingMetrics.instance&&(D.FrequentLoggingMetrics.instance.mZf=this.zQe)}LWe(ea){this.aLb=ea}init(){this.rl.Ebi(Object(e.a)(this,this.e3k,"resetGetMachineIdDelay"));this.rl.k6a(Object(e.a)(this,this.Cna,"onConnectionStateChanged"))}Cna(ea,ra){this.hya=ra.newState;2===ra.newState&&(this.sSb=0)}aTc(){let ea;ea=this.hjb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.hjb.T5,ma.RXd,K.a.Ne(ea)),correlationId:ea}}o$d(ea,
ra,F,na,ka){this.p9k(()=>{na(ka,"GetMachineIdSuccess")&&(h.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.RA,this.$r),ea(this.Gof),F(this.Lnj()))},Ua=>{na(ka,"GetMachineIdFailure")&&(h.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.$r),ra(Ua))},na,ka)}G0d(){this.hGf();this.EDj()}p9k(ea,ra,F,na){h.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.RA);this.RA?ea():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(ea,ra,F,na)},this.qpi())}sendFindSessionRequestToServerInternal(ea,ra,F,na){F(na,"RequestMachineId")&&(this.Chf=(new Date).getTime(),F=x.a.vj(),this.v2f(ka=>{const Ua=x.a.vj();this.Khd(ka);this.tWe();ea();ka=x.a.vj()-Ua;h.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ka)},ka=>{const Ua=x.a.vj();this.hGf();D.FrequentLoggingMetrics.instance&&D.FrequentLoggingMetrics.instance.fH(2,3);ra(ka);
ka=x.a.vj()-Ua;h.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ka)},!1),F=x.a.vj()-F,h.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",F))}EDj(){this.Enb+=ma.Hdj;this.Enb=Math.min(this.Enb,ma.qmk)}qpi(){let ea=this.Chf+this.Enb-(new Date).getTime();0>ea&&(ea=0);return ea}Khd(ea){try{this.hjb=ea,this.jna=ea.eIf,this.RA=ea.RA,this.wIf=ea.T5,this.Gof=ea.V0b}catch(ra){h.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",
ra.toString())}}hGf(){this.RA=null;this.iGf()}tWe(){this.iGf();this.iBc=!0;this.Oif=window.setTimeout(Object(e.a)(this,this.zUk,"refreshMachineId"),this.zQe)}iGf(){this.iBc&&(window.clearTimeout(this.Oif),this.iBc=!1)}zUk(){this.iBc=!1;this.v2f(ea=>{const ra=this.wIf!==ea.T5,F=this.RA!==ea.RA,na=this.RA;this.Khd(ea);0!==this.hya&&(F?(h.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",na||"null",ea.RA),this.rl.Xkd()):(this.rl.EQk(ra,F),this.tWe()))},
()=>{D.FrequentLoggingMetrics.instance&&D.FrequentLoggingMetrics.instance.fH(2,3);this.tWe()},!0)}e3k(){this.Enb=ma.Yeg}Lnj(){return new P.a(this.hjb.idd,this.hjb.fdd,this.hjb.edd,this.hjb.AVc)}dzl(ea){if(Object.getType(ea)!==Object)return null;for(let ra in ea);return this.BEi(ea)}BEi(ea){if(!(v.a.aAb in ea))return null;const ra=ea[v.a.aAb];var F=ra?this.O_h:this.N_h;for(const na of F)if(!(na in ea))return null;F=Object.assign(new O.a,{bac:ea[v.a.aAb],errorMessage:ea[v.a.errorMessage],correlationId:G.a.create().toString()});
ra&&(F.V0b=ea[v.a.VZe],F.T5=ea[v.a.T5],F.RA=ea[v.a.RA],F.AVc=ea[v.a.nbe],F.edd=ea[v.a.qgb],F.fdd=ea[v.a.$La],F.idd=ea[v.a.sgb]);return F}Y$i(ea,ra){h.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.ESb.xZi.continueWith(()=>{this.ESb.xZi.result?(h.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),ea(this.ESb.yZi)):(h.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),ra(this.ESb.yZi))})}zlh(ea,
ra,F,na,ka=!1){return Ua=>{Q.a.instance.koc(0,1);ea&&ea.stop();this.XQb=this.aLb=null;this.Krg(Ua.data,!0,ra);var za=Z.RtcUtils.deserialize(Ua.data.Wd,"FindSession",null);if(za)if(za=this.dzl(za)){if(za.bac&&za.T5&&za.RA){h.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.$r);this.t3j(Ua.data);F(za);return}ra.FindSessionFailureReason="FindSessionInvalidResponse";ra.IsRtcEnabled=za.bac;ra.IsQueryStringEmpty=!za.T5;ra.IsConnectionStringEmpty=!za.RA;h.ULS.sendTraceTag(4290720,
500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.$r,za.bac,!za.T5,!za.RA)}else ra.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",h.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.$r);else ra.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",h.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",
this.$r);this.ufh(ra,ka);na(null)}}rlh(ea,ra,F,na=!1){return ka=>{Q.a.instance.koc(0,1);ea&&ea.stop();this.XQb=this.aLb=null;this.Krg(ka.data,!1,ra);let Ua=null;var za="unknown";let ha="unknown";ka.data&&((za=ka.data.tj)&&ma.Ipc in za&&(Ua=za[ma.Ipc].toString()),za=E.a[ka.data.status],ha=ka.data.ie.toString());ra.FindSessionFailureReason="FindSessionRequestFailed";ra.HttpErrorCode=ha;ra.HttpErrorStatus=za;ra[ma.Ipc]=Ua;h.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",
za,ha,this.$r,Ua,na);this.ufh(ra,na);F(ha)}}v2f(ea,ra,F=!1){let na=null;h.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.$r);const ka={};var Ua=this.wcf.p2i();ka[A.a.FCa]=G.a.create().toString();this.aLb&&""!==this.aLb?Ua=String.format("{0}&{1}={2}",Ua,da.a.MTe,this.aLb):this.XQb&&""!==this.XQb&&(Ua=String.format("{0}&{1}={2}",Ua,da.a.MTe,this.XQb),ka[fa.cKl]="True",ka[fa.PYj]="True");Ua=this.CSh+"?"+Ua;F&&(ka[ca.zZi]=T.sSk);const za={};za.IsNetworkOfflineBeforeSendRequest=
this.Yh.wFa;za.HasAvailableConnectionsBeforeSendRequest=this.Yh.Fbg;za.MaxConnectionsAllowed=this.Yh.cZg;za.IsRefreshMachineId=F;this.ESb&&!this.xcf?(this.Y$i(this.zlh(null,za,ea,ra,F),this.rlh(null,za,ra,F)),this.xcf=!0):(this.Zh&&(na=this.Zh.Ei("WebServiceCall","GetMachineIdFromTheServer")),D.FrequentLoggingMetrics.instance&&D.FrequentLoggingMetrics.instance.fH(2,0),0>this.Yh.cW(Ua,1,null,ka,[ma.ELc,ma.Ipc,ma.Zjc,ma.KTe,ma.V_g,ma.P1g,ma.O1g],1,this.zlh(na,za,ea,ra,F),this.rlh(na,za,ra,F),null,null,
!1,null,this.w4b,"3",null,!0)&&(5<this.sSb&&200>this.sSb&&h.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.sSb),window.setTimeout(()=>{this.sSb++;ra("-1")},1E3)))}Krg(ea,ra,F){F||(F={});F.IsNetworkOfflineAfterRequestComplete=this.Yh.wFa;F.IsRequestSucceeded=ra;ea&&(F.EnqueueTime=ea.AI,F.InvokedTime=ea.Zt,F.CompletedTime=ea.qv,ea.tj&&(ma.ELc in ea.tj&&(F.CorrelationId=ea.tj[ma.ELc]),ma.Zjc in ea.tj&&(F[ma.Zjc]=
ea.tj[ma.Zjc])));h.ULS.sendTraceTag(38633565,500,ra?50:15,Z.RtcUtils.bHb(F))}ufh(ea,ra){ea||(ea={});ea.ConnectionState=n.a[this.hya];ra||this.rl.tfh(1,ea)}t3j(ea){try{var ra=!1,F=!1,na=ea.tj,ka=y.a.YD(ea.request.get_url());if(na&&ma.KTe in na){const Ga=na[ma.KTe].toString().toLocaleLowerCase();F="true"===Ga;ra="false"===Ga}na=!1;const ua=0<=ka.toLocaleLowerCase().indexOf("collab");F&&!ua?na=!0:ra&&ua&&(na=!0);if(na){ra={};ra.HostName=ka;ra.Status=E.a[ea.status];ra.HttpStatus=ea.ie.toString();var Ua=
ea.request.get_headers();for(let Ga in Ua){var za=Ua[Ga];(ka=Ga)&&0<ka.length&&(F=0,za&&(F=za.toString().length),ra["r_"+ka]=F)}if(ea.tj){const Ga=new r.a;Ga.add(ma.ELc);Ga.add(ma.Zjc);Ga.add(ma.Ipc);Ga.add(ma.P1g);Ga.add(ma.O1g);Ga.add(ma.V_g);ma.k8h(ra,ea.tj,Ga)}ma.f8h(ea.request.get_url(),ra);var ha=u.a.toJSON(ra);h.ULS.sendTraceTag(559437006,500,15,ha)}}catch(ua){h.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",ua.toString())}}static createInstance(ea,ra,F,na,ka,Ua,
za,ha,ua,Ga,sa,Ba=null){return ma.fMc(ea,ra,F,na,ka,Ua,za,ha,ua,Ga,null,sa,Ba)}static qFi(ea,ra,F,na,ka,Ua,za,ha,ua,Ga,sa=null){return ma.fMc(ea,ra,F,na,ka,3,Ua,za,ha,ua,Ga,sa,null)}static fMc(ea,ra,F,na,ka,Ua,za,ha,ua,Ga,sa,Ba,pa=null){ea=ea||G.a.create().toString();ea=new ma(ea,ra,F,na,ka,Ua,za,ha,ua,Ga,sa,Ba,pa);ea.init();return ea}static k8h(ea,ra,F){for(let na of F)na in ra&&(ea[na]=ra[na])}static f8h(ea,ra){if(ea){var F=ea.indexOf("?");if(-1!==F)for(ea=ea.substr(F+1).split("&"),F=0;F<ea.length;++F){var na=
ea[F].split("=");if(2===na.length){const ka=na[0];if(ka&&0<ka.length){let Ua=0;if(na=na[1])Ua=na.length;ra["q_"+ka]=Ua}}}}}}ma.Hdj=3E3;ma.qmk=3E5;ma.fvi="1.0";ma.Yeg=1E3;ma.ELc="X-CorrelationId";ma.RXd="corrid";ma.Ipc="RtcErrorCode";ma.Zjc="X-OfficeCluster";ma.KTe="X-NewEnv";ma.V_g="X-MSEdge-Ref";ma.O1g="X-OFFICEFD";ma.P1g="X-OfficeFE";Object(J.a)(ma,"FindSessionStrategy",null,[1248])},733:function(J,aa,d){J=d(0);class h{constructor(){this.u9e=this.yzd=!1;this.callback=null}kkc(r){this.callback=r;
this.TDh()}CYg(r){this.yzd||(this.yzd=!0,this.ZPh=r,this.TDh())}TDh(){this.yzd&&this.callback&&!this.u9e&&(this.u9e=!0,this.callback(this.ZPh))}}Object(J.a)(h,"CompletionTask",null,[]);d.d(aa,"a",function(){return e});class e{constructor(){this.ojf=new h;this.mjf=new h}Yfd(r){this.ojf.kkc(r)}Xfd(r){this.mjf.kkc(r)}Wic(r){this.ojf.CYg(r)}AYa(r){this.mjf.CYg(r)}oEe(){this.Wic(2);this.AYa(2)}}Object(J.a)(e,"MessageStatus",null,[1386])},993:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;
(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(h||(h={}));Object(J.b)("ChannelConnectionState",h)},994:function(J,aa,d){d.r(aa);d.d(aa,"MaxOutstandingThrottler",function(){return n});J=d(0);var h=d(14),e=d(78);aa=d(995);var r=d(733);class n extends aa.a{constructor(v,B=""){super(v,B);this.qgb=this.$La=0;this.Pa=new e.a;this.Sob=!1;this.UBc=this.Fxc=this.mxc=this.UMd=0;this.jFc=[];this.clearTimeout=n.k_d}add(v){this.Tob||this.init(n.GNf,
n.vNf);this.z5a++;const B=new r.a;this.Ozb?this.Ypd(v,B):this.UBc<this.qgb?this.gqc(v,B):(this.Ypd(v,B),this.Sob=!1);return B}gqc(v,B){v=this.Cof(v);const y=this.setTimeout(Object(h.a)(this,this.Awk,"onMessageWaitTimeExpired"),this.$La);++this.UBc;Array.add(this.jFc,y);const x=this.mxc;v.Yfd(A=>{B.Wic(A)});v.Xfd(A=>{this.mxc===x&&(this.zwk(x,y),B.AYa(A))})}zwk(v,B){this.mxc===v&&(--this.UBc,this.clearTimeout(B),Array.remove(this.jFc,B),this.Ozb&&this.Y9k())}Y9k(){this.Ozb&&!this.Sob&&(this.UMd=this.setTimeout(Object(h.a)(this,
this.Z9k,"sendThrottledMessageFromTimer"),0),this.Sob=!0)}Z9k(){this.Sob=!1;if(this.Ozb){const v=this.fFc,B=this.Oqb;this.m0b(!1);this.gqc(v,B)}}Awk(){++this.Fxc;this.Fxc>Math.floor(this.qgb/2)&&(this.Fxc=-1E9,this.Pa.raiseEvent("TMUDM"))}jHc(v){this.Pa.addHandler("TMUDM",v)}reset(){this.z5a=this.FXb=this.cSb=this.Fxc=0;++this.mxc;for(const v of this.jFc)this.clearTimeout(v);this.UBc=0;this.jFc=[];this.m0b(!0);this.Sob&&(this.clearTimeout(this.UMd),this.UMd=0,this.Sob=!1)}init(v,B){this.Tob||(this.$La=
v,this.qgb=B,this.Tob=!0)}static createInstance(v,B=""){return new n(v,B)}static k_d(v){window.clearTimeout(v)}}n.GNf=15E3;n.vNf=5;Object(J.a)(n,"MaxOutstandingThrottler",aa.a,[1367,1368])},995:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(387);class e{constructor(r,n=""){this.cSb=this.FXb=0;this.uEd=!1;this.Oqb=this.fFc=null;this.Tob=!1;this.Cof=r;this.OCh=n;this.setTimeout=e.u_d;this.z5a=this.FXb=this.cSb=0}pQe(){0<this.z5a&&0<this.cSb&&h.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",
this.OCh,this.cSb,this.z5a);0<this.z5a&&0<this.FXb&&h.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.OCh,this.FXb,this.z5a)}get Ozb(){return this.uEd}Ypd(r,n){this.FXb++;this.m0b(!0);this.uEd=!0;this.fFc=r;this.Oqb=n}m0b(r){this.uEd=!1;this.Oqb&&r&&(this.cSb++,this.Oqb.oEe());this.Oqb=this.fFc=null}static u_d(r,n){return window.setTimeout(r,n)}}Object(J.a)(e,"ThrottlerBase",null,[])},996:function(J,aa,d){d.r(aa);d.d(aa,"MaxRateThrottler",function(){return r});
J=d(0);var h=d(14);aa=d(995);var e=d(733);class r extends aa.a{constructor(n,v=""){super(n,v);this.sgb=0;this.yUb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(n){this.Tob||(this.sgb=n,this.Tob=!0)}add(n){this.Tob||this.init(r.pNf);this.z5a++;const v=this.currentTime(),B=new e.a;this.yUb>v&&(this.yUb=v);this.Ozb?(this.m0b(!0),this.Ypd(n,B)):this.yUb+this.sgb<=v?this.gqc(n,B):(this.Ypd(n,B),this.setTimeout(Object(h.a)(this,this.X9k,"sendThrottledMessage"),this.yUb+this.sgb-
v));return B}X9k(){if(this.Ozb){const n=this.fFc,v=this.Oqb;this.m0b(!1);this.gqc(n,v)}}gqc(n,v){this.yUb=this.currentTime();n=this.Cof(n);n.Yfd(B=>{v.Wic(B)});n.Xfd(B=>{v.AYa(B)})}static createInstance(n,v=""){return new r(n,v)}}r.pNf=200;Object(J.a)(r,"MaxRateThrottler",aa.a,[1369,1368])},997:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r,n,v){super();this.type=e;this.Eza=r;this.$Li=n;this.PLa=v}}Object(J.a)(h,"SendUpdateNotificationEventArgs",
Sys.EventArgs,[])},998:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.MTe="rr";h.C5k="rd";h.y5k="rbp";h.ZUe="sa";Object(J.a)(h,"RtcReconnectParams",null,[])},999:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.sgb="throttling_messageDelay";h.aAb="enabled";h.$La="throttling_timeToWaitForResponse";h.qgb="throttling_maxNumberOfOutstandingMessages";h.nbe="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.VZe="url";h.T5="queryString";
h.RA="connectionString";Object(J.a)(h,"RtcFindSessionOutputFieldNameConstants",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.presence1.js.map