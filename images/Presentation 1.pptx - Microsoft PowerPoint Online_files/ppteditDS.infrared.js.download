'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1249:function(J,aa,d){d.r(aa);J=d(0);var h=d(71),e=d(28),r=d(192),n=d(52),v=d(30);class B{constructor(ua,Ga){this.ia=ua;this.ia.ra(v.a.jCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.kCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.lCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.mCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.nCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.oCj,
n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.pCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.VBj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.WBj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.XBj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.YBj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.ZBj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.$Bj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.aCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.UBj,
n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.bCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.cCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.eCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.fCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.gCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.hCj,n.a.application,r.ActionManager.vv,4);this.ia.ra(v.a.iCj,n.a.application,r.ActionManager.vv,4);this.Fvg=JSON.parse(Ga.Ga("674"));for(const sa of this.Fvg)sa.regex=
new RegExp(sa.pattern)}trackAction(ua){for(const Ga of this.Fvg)Ga.regex.test(ua)&&this.ia.processAction(Ga.actionId,2)}}Object(J.a)(B,"IdeasActionTracker",null,[958]);class y{constructor(){this.zdb=this.eDe=this.mCe=null;this.OPj=this.$Pl}addSlideSuggestionsListener(ua){this.mCe=ua}addTextToSmartArtSuggestionListener(ua){this.eDe=ua}iPd(ua){this.zdb=ua}notifySlideSuggestion(ua,Ga){this.mCe&&(this.mCe(ua,Ga),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",Ga?Ga.suggestions.length:0,Ga?
Ga.correlationId:"0"))}notifyTextToSmartArtSuggestion(ua,Ga){this.eDe&&(this.eDe(ua,Ga),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",Ga?Ga.suggestions.length:0,Ga?Ga.correlationId:"0"))}yed(ua){this.zdb&&this.zdb(ua)}}Object(J.a)(y,"InfraredDesignerServiceProvider",null,[955]);class x{constructor(){this.zdb=null}iPd(ua){this.zdb=ua}yed(ua){this.zdb&&this.zdb(ua)}}Object(J.a)(x,"InfraredTelemetryListener",null,[954]);var A=d(195),E=d(1024),u=d(47),K=d(14),G=d(36);class O{}Object(J.a)(O,
"EntityGroup",null,[]);class R extends O{}Object(J.a)(R,"Idea",O,[]);var V=d(544);class D{}Object(J.a)(D,"ProviderResult",null,[]);var Q=d(337),Z=d(440),P=d(439),ca=d(336),T=d(543),da=d(27),fa=d(270);class ma{}ma.dIk="PowerPoint";ma.eLl="WAC";Object(J.a)(ma,"ApplicationPropertiesConstants",null,[]);class ea{}Object(J.a)(ea,"EnterpriseUserInfo",null,[]);class ra{}Object(J.a)(ra,"Message",null,[]);class F extends ra{}F.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(J.a)(F,
"PowerPointTextTileChangedMessage",ra,[]);class na{}Object(J.a)(na,"RankerConfiguration",null,[]);class ka{constructor(ua){this.cYg=ua}D3i(ua,Ga){return new Promise((sa,Ba)=>{this.cYg&&ua&&Ga||Ba("wopiIdentityManager or tokenParameter or clientWoipId is null");this.cYg.getAccessToken(ua,Ga).then(pa=>{pa?sa(pa.accessToken):Ba("auth token is null")},pa=>{Ba(pa)})})}}Object(J.a)(ka,"AuthenticationProvider",null,[871]);class Ua{constructor(ua,Ga,sa,Ba,pa=""){this.resource=ua;this.scope=Ga;this.silentLogin=
sa;this.options=Ba;this.correlationId=pa}}Object(J.a)(Ua,"InfraredTokenParameters",null,[272]);class za{constructor(ua,Ga,sa,Ba,pa,ia,Da,Xa,Ka){this.wBg=this.uqe=this.sef=null;this.gBg=!1;this.Dye=null;this.UBe=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.pFb=ua;this.Y$j=Da;this.pwe=Ka;this.Gck=ua.ka("659");this.xFb=ua.Ga("750");Da=window.location.hostname;Ka=ua.Ga("816");Da&&0<Da.length&&Ka&&0<Ka.length&&0<=Ka.toLowerCase().indexOf(Da.toLowerCase())&&(this.xFb=
"");this.IWa=Ga;this.udc=ia;if(this.xkk=ua.ka("688"))this.wBg=ua.Ga("689"),this.uqe=new ka(Xa);this.IWa.addSlideSuggestionsListener(Object(K.a)(this,this.Dzk,"onSlideSuggestion"));this.IWa.addTextToSmartArtSuggestionListener(Object(K.a)(this,this.cAk,"onTextToSmartArtSuggestion"));this.IWa.iPd(Object(K.a)(this,this.M4g,"onIdeasSessionTelemetry"));sa.iPd(Object(K.a)(this,this.M4g,"onIdeasSessionTelemetry"));this.udc&&this.udc.execute(Ma=>{Ma.avf(Object(K.a)(this,this.ZHe,"onEditorCritiques"))});this.ia=
Ba;(this.TT=pa)&&this.TT.execute(Ma=>{Ma.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new P.a,{name:"InfraredSlideTextTileLambda",inputSchema:Z.a.csc,outputSchema:Z.a.csc,func:(Oa,qa,Ya)=>{this.Ezk(Oa);Ya(null)}}))});this.mhl()}get vyb(){return this.sef}mhl(){var ua=JSON.parse(this.pFb.Ga("612"));ua=Object.assign(new na,{rankingOrder:ua});var Ga=IdeasInfraredConnector,sa=Ga.setup,Ba=e.a.J,pa=Object(K.a)(this,this.qCj,"ideasPaneVisibilityStatusCallback"),ia=this.pFb;const Da=
{};Da.appName=2===da.AFrameworkApplication.Aa.hb.Uk?ma.dIk:"unknown";Da.appVersion=da.AFrameworkApplication.buildVersion;Da.appPlatform=ma.eLl;Da.lcid=da.AFrameworkApplication.lcid;var Xa=fa.a.xe(da.AFrameworkApplication.lcid);Xa=Xa?Xa.name:null;const Ka=Xa.split("-");Da.market=Ka[Ka.length-1];Da.uiLanguage=Xa;Da.sessionId=da.AFrameworkApplication.userSessionId;Da.tenantRoot=ia.Ga("748");Da.shredderServiceEndpoint=ia.Ga("749");this.sef=sa.call(Ga,ua,Ba,pa,Da,this.Y$j,Object(K.a)(this,this.r7f,"getShredderServiceAuthTokenPromise"))}qCj(ua){this.gBg=
ua;(this.IWa.OPj=ua)?(this.ia.processAction(v.a.Qvb,2),this.Zch()):this.ia.La(v.a.uoa,2,new T.a(!0,ca.a.Jde))}Dzk(ua,Ga){const sa=[];sa.push(Object.assign(new R,{providerId:V.a.Vxh,groupTypeId:V.a.Uxh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ga}));try{this.vyb.pushProviderResult(Object.assign(new D,{providerId:V.a.Vxh,resultStatus:ua,entityGroups:sa}))}catch(Ba){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Ba)}"Success"===ua&&(A.a.Wa(Ga.suggestions)||this.pwe.Ptd(0))}cAk(ua,Ga){const sa=[];sa.push(Object.assign(new R,{providerId:V.a.dyh,groupTypeId:V.a.cyh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ga}));try{this.vyb.pushProviderResult(Object.assign(new D,{providerId:V.a.dyh,resultStatus:ua,entityGroups:sa}))}catch(Ba){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Ba)}}M4g(ua){try{this.vyb.trackIdeasProviderAction(ua.cardId,
ua.actionType,ua.actionEngagement)}catch(Ga){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",Ga)}}Ezk(ua){if(this.Gck)if(ua)if(ua){try{const Ga=G.a(ua.Content);this.Yhi(this.Dye,Ga)&&(this.Dye=Ga,this.UBe=!0)}catch(Ga){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.gBg&&this.Zch()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}Yhi(ua,
Ga){if(!ua&&Ga||ua&&!Ga)return!0;if(!ua&&!Ga)return!1;if(!ua.drawingElems&&Ga.drawingElems||ua.drawingElems&&!Ga.drawingElems)return!0;const sa=new E.a;for(const Ba of ua.drawingElems)if(ua=Ba.text)for(const pa of ua.paragraphs)pa&&(u.a.Wa(pa.id)||u.a.Wa(pa.chars)||sa.$(pa.id,pa.chars));for(const Ba of Ga.drawingElems)if(Ga=Ba.text)for(const pa of Ga.paragraphs)if(pa&&!(u.a.Wa(pa.id)||u.a.Wa(pa.chars)||sa.Gb(pa.id)&&sa.ga(pa.id)===pa.chars))return!0;return!1}Zch(){if(this.UBe){try{this.vyb.postMessage(Object.assign(new F,
{messageType:F.PowerPointTextTileChangedMessageType,data:this.Dye}))}catch(ua){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",ua)}this.pwe.Ptd(1);this.UBe=!1}}ZHe(ua,Ga){try{ua=[],ua.push(Object.assign(new R,{groupTypeId:V.a.BRf,providerId:V.a.HRf,notificationConfidence:Ga.Jka?Ga.Jka.notificationConfidence:0,shouldRaiseNotification:Ga.Jka?Ga.Jka.shouldRaiseNotification:!1,confidence:Ga.Jka?Ga.Jka.confidence:0,data:Ga.q3b})),this.vyb.pushProviderResult(Object.assign(new D,
{providerId:V.a.HRf,resultStatus:Ga.Jka?Ga.Jka.resultStatus:Q.a.invalid,entityGroups:ua}))}catch(sa){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",sa)}Ga.Jka&&"Success"===Ga.Jka.resultStatus&&Ga.q3b&&!A.a.Wa(Ga.q3b.critiques)&&this.pwe.Ptd(2)}r7f(){if(!this.uqe)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.xFb&&0<this.xFb.length)return this.uqe.D3i(new Ua(this.xFb,"user_impersonation",!0,
{}),this.wBg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(ua){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",ua),null}}w$i(){return new Promise(ua=>{const Ga=this.pFb.Ga("749"),sa=this.r7f();Ga&&Ga.length&&sa?sa.then(Ba=>{Ba&&Ba.length?(Ba=new ea,Ba.CountryCode="US",Ba.IsEnabled=!1,Ba.IsEnterpriseEnabled=!0,Ba.IsGoLocal=!1,Ba.ServiceEndpoint=Ga,Ba.TenantRoot="",ua(Ba)):ua(null)},()=>{ua(null)}):
ua(null)})}}Object(J.a)(za,"PPTWebEditorInfraredRuntimeManager",null,[852]);class ha{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}Zb(ua){this.K=ua;this.K.register(y,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().oa(()=>new y);this.K.register(x,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().oa(()=>new x);this.K.register(B,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().oa(()=>
new B(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(za,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().oa(()=>new za(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Ja("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const ua=this.K.resolve("Common.IAppSettingsManager");ua.ff(()=>{ua.ka("610")&&(e.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),
this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){h.a.instance.Dc(new ha)}}Object(J.a)(ha,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");ha.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.infrared.js.map