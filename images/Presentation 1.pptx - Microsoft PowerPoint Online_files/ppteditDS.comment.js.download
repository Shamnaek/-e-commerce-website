'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1244:function(J,aa,d){d.r(aa);var h=d(0),e=d(27),r=d(387),n=d(18),v=d(24);class B{}B.beginDraftingAsync="OSC:BDA";B.h0i="OSC:FEQ";B.selectComment="OSC:SC";Object(h.a)(B,"CommentTaskNames",null,[]);class y{constructor(ba){this.SGa=ba;this.n9j=[]}get handler(){return this.SGa}get w8(){return this.n9j}}Object(h.a)(y,"RegisteredListener",null,[]);class x{constructor(ba,Aa){this.type=0;this.payload=null;this.type=
ba;this.payload=Aa}}Object(h.a)(x,"OfficeSharedCommentsEvent",null,[1522]);class A{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(h.a)(A,"ViewContainerEvent",null,[1522]);var E=d(670);class u{constructor(ba){this.Ive=!1;this.PX=new n.a;this.zb=ba}QVk(ba){ba=new y(ba);this.PX.add(ba)}FGh(ba){for(let Aa=0;Aa<this.PX.count;++Aa)if(this.PX.ga(Aa).handler===ba){this.PX.removeAt(Aa);break}}Doa(ba=!1){const Aa=()=>{if(e.AFrameworkApplication.Ug)r.ULS.sendTraceTag(40420181,
201,50,"Skipped processing comment pane events since app is shutting down.");else for(let nb=0;nb<this.PX.count;++nb){const lc=this.PX.ga(nb);for(;0<lc.w8.length;){var Wa=Array.dequeue(lc.w8);if(Object(v.a)(A,Wa)){var gb=lc.handler;gb(Wa)}else Object(v.a)(x,Wa)&&(gb=lc.handler,gb(Wa.type,Wa.payload))}}};ba?Aa():this.Ive||(this.Ive=!0,E.a.prb(this.zb,()=>{Aa();this.Ive=!1},B.h0i))}}Object(h.a)(u,"GenericEventHost",null,[]);class K extends u{constructor(ba){super(ba)}iXk(ba){this.QVk(ba)}vDl(ba){this.FGh(ba)}bth(ba){ba=
this.JDi(ba);for(let Aa=0;Aa<this.PX.count;++Aa)Array.enqueue(this.PX.ga(Aa).w8,ba);this.Doa(!0)}JDi(ba){const Aa=new A;Aa.eventType=3;Aa.viewContainerVisibilityState=ba;return Aa}r0i(){const ba=this.fJi();for(let Aa=0;Aa<this.PX.count;++Aa)Array.enqueue(this.PX.ga(Aa).w8,ba);this.Doa(!0)}fJi(){const ba=new A;ba.eventType=2;return ba}}Object(h.a)(K,"ViewContainerEventHost",u,[1501]);class G{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=
this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(h.a)(G,"BasicEventPayload",null,[1552]);class O{constructor(ba){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ba}}Object(h.a)(O,"CommentContextDetails",null,[]);class R{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(h.a)(R,"ContextChangeWithSelectedThreadIndex",null,[1552]);class V{constructor(){this.tasks=this.comments=null}}Object(h.a)(V,"LoadCommentsNoVirtualization",null,[1552]);class D extends u{constructor(ba){super(ba);this.c0h=0}hWk(ba,Aa,Wa,gb,nb,lc,jd=0){ba=new y(ba);lc&&Array.enqueue(ba.w8,this.tDi(lc,this.c0h));lc=Aa?Aa.length:0;Array.enqueue(ba.w8,
this.qKf(lc,Wa,gb,jd,null));lc&&Array.enqueue(ba.w8,this.cLf(Aa,nb));this.PX.add(ba);this.Doa()}P4e(ba){this.FGh(ba)}dVe(ba,Aa,Wa,gb=0,nb=null){this.kUa(this.qKf(ba,Aa,Wa,gb,nb));this.Doa()}k9k(ba,Aa,Wa,gb,nb=null){this.kUa(this.NDi(ba,Aa,Wa,gb,nb));this.Doa()}Iph(ba,Aa,Wa){this.kUa(this.QDi(ba,Aa,Wa));this.Doa()}hVe(ba,Aa){this.kUa(this.cLf(ba,Aa));this.Doa()}selectComment(ba){this.kUa(this.KLf(ba,6));this.Doa()}highlightComment(ba){this.kUa(this.KLf(ba,7));this.Doa()}E1a(ba,Aa){this.kUa(this.iGi(ba,
Aa));this.Doa()}HHk(ba,Aa){this.kUa(this.nIi(ba,Aa));this.Doa()}tDi(ba,Aa=0){const Wa=new G;Wa.modelCapabilityFlags=ba;Wa.richTextCapabilityFlags=Aa;return new x(12,Wa)}qKf(ba,Aa,Wa,gb,nb=null){const lc=new G;lc.numberOfComments=ba;lc.numberOfThreads=Aa;lc.contextDetails=Object.assign(new O(Wa),{nextPopulatedContextDetails:gb});lc.contextDrafts=nb;lc.rehydrationDrafts=null;return new x(0,lc)}NDi(ba,Aa,Wa,gb,nb=null){const lc=new R;lc.numberOfComments=ba;lc.numberOfThreads=Aa;lc.selectedThreadIndex=
Wa;lc.contextDetails=Object.assign(new O(gb),{nextPopulatedContextDetails:0});lc.contextDrafts=nb;lc.rehydrationDrafts=null;return new x(0,lc)}QDi(ba,Aa,Wa){const gb=new G;gb.comments=ba;gb.numberOfThreads=Aa;gb.tasks=Wa;return new x(2,gb)}cLf(ba,Aa){const Wa=new V;Wa.comments=ba;Wa.tasks=Aa;return new x(1,Wa)}KLf(ba,Aa){const Wa=new G;Wa.commentId="";ba&&(Wa.commentId=ba);return new x(Aa,Wa)}iGi(ba,Aa){const Wa=new G;Wa.changes=[];Wa.contextDetails=Object.assign(new O(Aa),{nextPopulatedContextDetails:ba});
return new x(10,Wa)}nIi(ba,Aa){const Wa=new G;Wa.commentId=ba;Wa.smartReplies=Aa;return new x(15,Wa)}kUa(ba){for(let Aa=0;Aa<this.PX.count;++Aa)Array.enqueue(this.PX.ga(Aa).w8,ba)}}Object(h.a)(D,"OfficeSharedCommentsEventHost",u,[1543]);var Q=d(1203);class Z{constructor(){this.Oof=this.Wpf=!1;this.n3h=[]}get OOb(){return this.n3h}get clb(){return this.Wpf}set clb(ba){this.Wpf=ba;for(const Aa of this.OOb)Aa.clb=ba}get Yjb(){return this.Oof}set Yjb(ba){this.Oof=ba;for(const Aa of this.OOb)Aa.Yjb=ba}eMa(ba){for(const Aa of this.OOb)ba=
Aa.eMa(ba);return ba}}Object(h.a)(Z,"AggregateCommentTaskPersonTransformer",null,[1578]);var P=d(109);class ca{constructor(ba,Aa,Wa,gb,nb=!1){this.priority=this.completion=-1;this.type=ba;this.user=Aa;this.time=Wa;this.recordId=gb;this.isLossy=nb}}Object(h.a)(ca,"HistoryRecord",null,[]);class T{constructor(ba,Aa){this.tWh=new Q.a(()=>Aa.eMa(ba.value))}L8i(){return new Date}ICa(ba,Aa,Wa){if(0===ba)throw r.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),
Error.argument("recordType");const gb=P.a.create().toString();Wa=new ca(ba,this.tWh.value,Wa,gb,!1);Wa.commentId=Aa;r.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",ba);return Wa}}Object(h.a)(T,"HistoryRecordFactory",null,[1579]);class da{constructor(){this.endDate=this.startDate=null}}Object(h.a)(da,"CommentTaskSchedule",null,[]);class fa{constructor(ba,Aa,Wa,gb,nb,lc){this.isLossy=ba;this.title=Aa;this.assignees=Wa;this.schedule=gb;this.completion=nb;this.priority=
lc}}Object(h.a)(fa,"CommentTaskState",null,[]);class ma{constructor(){this.commentId=null}}Object(h.a)(ma,"HistoryItem",null,[]);class ea{constructor(ba,Aa,Wa,gb,nb,lc,jd){this.ODd=!1;if(1!==Aa.type)throw Error.argument("createRecord");this.JRb=Wa;this.GRb=gb;this.HRb=nb;this.Zjf=1;this.Jzc=ba;this.MXh=lc;this._state=new fa(!1,this.JRb,jd,new da,this.HRb,this.GRb);this._history=[];this.nLf(Aa)}pub(ba,Aa){if(1!==ba.type)throw Error.argument("createRecordTemplate");const Wa=ea.Hmj(ba,this.Zjf);this.Zjf++;
return Object.assign(new ca(Aa,ba.user,ba.time,Wa),{commentId:ba.commentId})}get zpg(){return this.history[this.history.length-1]}get Qbg(){return this.state.completion===this.HRb}get Pbg(){return this.state.priority===this.GRb}get Rbg(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Sbg(){return this.state.title===this.JRb}nLf(ba){ba=Object.assign(new ma,{commentId:ba.commentId,records:[ba]});
this.history.push(ba)}w_f(ba){let Aa=-1;for(let Wa=0;Wa<this.state.assignees.length;Wa++)if(this.Jzc.equals(this.state.assignees[Wa],ba)){Aa=Wa;break}return Aa}kil(ba){const Aa=this.zpg,Wa=Aa.records[Aa.records.length-1];return this.Jzc.equals(Wa.user,ba.user)&&Aa.commentId===ba.commentId&&Wa.time.getTime()===ba.time.getTime()?!0:!1}kIl(ba){switch(ba.type){case 2:-1===this.w_f(ba.assignee)&&this.state.assignees.push(ba.assignee);break;case 3:const Aa=this.w_f(ba.assignee);0<=Aa&&this.state.assignees.splice(Aa,
1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=ba.schedule;break;case 6:this.state.completion=ba.completion;break;case 9:this.state.title=ba.title;break;case 10:this.state.priority=ba.priority;break;case 0:this.state.isLossy=!0;break;case 1:r.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.ODd=!0;break;case 8:this.ODd=!1;break;case -1:r.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;
default:this.state.isLossy=!0}ba.isLossy&&(this.state.isLossy=!0);this.kil(ba)?this.zpg.records.push(ba):this.nLf(ba)}get isDeleted(){return this.ODd}get state(){return this._state}get history(){return this._history}dbj(ba){if(!ba)return this.history;const Aa=Array.clone(this.history),Wa=Aa[0],gb=Wa.records.shift();if(!this.MXh){var nb=this.pub(gb,4);Wa.records.unshift(nb)}!ba.Qbg&&this.Qbg&&(nb=this.pub(gb,6),nb.completion=this.HRb,Wa.records.unshift(nb));!ba.Pbg&&this.Pbg&&(nb=this.pub(gb,10),nb.priority=
this.GRb,Wa.records.unshift(nb));!ba.Rbg&&this.Rbg&&(nb=this.pub(gb,5),nb.schedule=new da,Wa.records.unshift(nb));!ba.Sbg&&this.Sbg&&(nb=this.pub(gb,9),nb.title=this.JRb,Wa.records.unshift(nb));ba.isDeleted&&(ba=this.pub(gb,8),Wa.records.unshift(ba));return Aa}static Hmj(ba,Aa){return"Synthesized-"+ba.recordId+"-"+Aa}}Object(h.a)(ea,"CommentTaskStateBuilder",null,[]);var ra=d(722);class F{constructor(ba,Aa,Wa,gb){this.id=ba;this.commentId=Aa;this.currentState=Wa;this.history=gb}}Object(h.a)(F,"CommentTaskItem",
null,[]);class na{constructor(ba,Aa="",Wa="",gb=""){this.IsCurrentUser=!1;this.UserId=ba;this.Provider=Aa;this.DisplayName=Wa;this.Email=gb}}Object(h.a)(na,"CommentTaskPerson",null,[1572]);const ka=ba=>{const Aa=new na(ba.UserId,ba.Provider,ba.DisplayName,ba.Email);Aa.IsCurrentUser=ba.IsCurrentUser;return Aa};var Ua=d(1024);d(287);class za{constructor(ba){this.extensions=ba}}Object(h.a)(za,"ExtensionList",null,[]);class ha{static clone(ba){ba=ha.wvi(ba.extensions);return new za(ba)}static MGf(ba){return ba?
ha.clone(ba):null}static isEmpty(ba){return!ba.extensions||!ba.extensions.count}static Wa(ba){return!ba||ha.isEmpty(ba)}static wvi(ba){if(!ba)return null;const Aa=new Ua.a;ba.forEach((Wa,gb)=>{Aa.add(Wa,gb);return!0});return Aa}}Object(h.a)(ha,"ExtensionListExtensions",null,[]);class ua{static clone(ba){var Aa=ka(ba.user);Aa=new ca(ba.type,Aa,ba.time,ba.recordId,ba.isLossy);Aa.commentId=ba.commentId;Aa.anchorExtensionList=ha.MGf(ba.anchorExtensionList);Aa.recordExtensionList=ha.MGf(ba.recordExtensionList);
ba.assignee&&(Aa.assignee=ka(ba.assignee));if(ba.schedule){var Wa=ba.schedule;const gb=new da;gb.startDate=Wa.startDate;gb.endDate=Wa.endDate;Aa.schedule=gb}Aa.completion=ba.completion;Aa.title=ba.title;Aa.priority=ba.priority;Aa.undoId=ba.undoId;return Aa}}Object(h.a)(ua,"HistoryRecordExtensions",null,[]);class Ga{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd=!1){this.Jzc=ba;this.ICc=Aa;this.Iqa=Wa;this.lQh=gb;this.JRb=nb;this.GRb=lc;this.HRb=jd;this.rAc=xd}LIi(ba,Aa,Wa,gb=null){if(!ba)throw r.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Aa)throw r.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Wa||!Wa.length)throw r.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Wa[0].type)throw r.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var nb=[],lc=null,jd=this.rMk(Wa);for(var xd of Wa)if(!jd.contains(xd.recordId))if(Wa=
this.h9f(xd.commentId,gb),Wa=this.u3i(xd,Wa),1===Wa.type){let Zc=[];this.rAc&&lc&&lc.state&&(Zc=lc.state.assignees);lc=new ea(this.Jzc,Wa,this.JRb,this.GRb,this.HRb,this.rAc,Zc);nb.push(lc)}else if(lc)lc.kIl(Wa);else throw r.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");jd=null;xd=[];if(lc){lc.isDeleted||
(jd=lc.state);lc=null;for(var Kc of nb)nb=Kc.dbj(lc),Array.addRange(xd,nb),lc=Kc}Kc=this.h9f(Aa,gb);jd&&(jd.completion=this.Pxi(Aa,gb,jd.completion));return new F(ba,Kc,jd,xd)}O2i(ba,Aa,Wa,gb=null){if(!Aa)throw r.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Wa&&!ba)throw r.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const nb=[],lc=this.Iqa.L8i();if(Wa){var jd=this.Iqa.ICa(1,ba,lc);nb.push(jd)}jd=
null;if(Aa.assigneeUpdate){if(!Aa.assigneeUpdate.assigneesToAdd||!Aa.assigneeUpdate.assigneesToRemove)throw r.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var xd=0;xd<Aa.assigneeUpdate.assigneesToAdd.length;xd++){var Kc=this.oLf(2,Aa.assigneeUpdate.assigneesToAdd[xd],ba,lc);Kc&&nb.push(Kc)}for(xd=0;xd<Aa.assigneeUpdate.assigneesToRemove.length;xd++)(Kc=this.oLf(3,Aa.assigneeUpdate.assigneesToRemove[xd],ba,lc))&&nb.push(Kc)}else Aa.assignee&&
(Wa||(jd=this.Iqa.ICa(4,ba,lc),nb.push(jd)),xd=this.Iqa.ICa(2,ba,lc),jd=this.ICc.eMa(Aa.assignee),xd.assignee=jd,nb.push(xd));Aa.title?(gb=this.Iqa.ICa(9,ba,lc),gb.title=Aa.title,nb.push(gb)):Wa&&gb&&(xd=this.Iqa.ICa(9,ba,lc),xd.title=this.lQh.roj(gb,jd),nb.push(xd));if(Aa.schedule){if(Aa.schedule.startDate>Aa.schedule.endDate)throw r.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");gb=this.Iqa.ICa(5,ba,lc);gb.schedule=Aa.schedule;nb.push(gb)}if(void 0!==
Aa.completion&&null!==Aa.completion){gb=Aa.completion;if(0>gb||100<gb)throw r.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Wa||r.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",gb);Wa=this.Iqa.ICa(6,ba,lc);Wa.completion=gb;nb.push(Wa)}if(void 0!==Aa.priority&&null!==Aa.priority){Aa=Aa.priority;if(0>Aa||10<Aa)throw r.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");ba=this.Iqa.ICa(10,
ba,lc);ba.priority=Aa;nb.push(ba)}return nb}oLf(ba,Aa,Wa,gb){if(2!==ba&&3!==ba)return r.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;ba=this.Iqa.ICa(ba,Wa,gb);ba.assignee=this.ICc.eMa(Aa);return ba}rMk(ba){const Aa=new ra.a,Wa=new ra.a;for(let gb=ba.length-1;0<=gb;gb--){const nb=ba[gb],lc=Wa.contains(nb.recordId);lc||-1!==nb.type||(Wa.contains(nb.undoId)?r.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
Wa.add(nb.undoId));if(lc||-1===nb.type)Aa.contains(nb.recordId)?r.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Aa.add(nb.recordId)}return Aa}u3i(ba,Aa){const Wa=ua.clone(ba);Wa.commentId=Aa;Wa.user=this.ICc.eMa(ba.user);Wa.assignee=this.ICc.eMa(ba.assignee);return Wa}Pxi(ba,Aa,Wa){let gb=Wa;ba&&Aa&&(({value:Aa}=Aa.Tf(ba)).returnValue?(gb=Aa.ResolveState?100:100===Wa?0:Wa,gb!==Wa&&r.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",ba)):r.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",ba));return gb}h9f(ba,Aa){let Wa=ba;ba&&Aa&&(({value:Aa}=Aa.Tf(ba)).returnValue?Wa=Aa.CommentId:(r.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",ba),Wa=ba));return Wa}}Object(h.a)(Ga,"CommentTaskTranslatorImpl",null,[1126]);class sa{constructor(){this.T2a=
{};this.T2a.ops=[]}$Hj(ba){const Aa=this.T2a.ops;if(Aa.length){var Wa=Aa.length-1;const gb=Aa[Wa];if(!gb.attributes){gb.insert+=ba;Aa[Wa]=gb;this.T2a.ops=Aa;return}}Wa={};Wa.insert=ba;Array.add(Aa,Wa)}zHj(ba,Aa,Wa){var gb={};gb.fullName=Aa.fullName;gb.email=Aa.email;gb.resolveState=Aa.resolveState;Aa={};Aa.atmention=gb;ba=this.NYd(ba,Aa);Wa&&(gb={},gb.contentId=Wa.contentId,Wa={},Wa.atmention=gb,ba.optional=Wa);Array.add(this.T2a.ops,ba)}insertImage(ba,Aa){ba=this.NYd(ba,{});const Wa={};Wa.base64=
Aa.base64;Aa={};Aa.image=Wa;ba.optional=Aa;Array.add(this.T2a.ops,ba)}insertHyperLink(ba,Aa){const Wa={};Wa.link=Aa.link;this.Ael(Wa,Aa);Array.add(this.T2a.ops,this.NYd(ba,Wa))}j9i(){return Sys.Serialization.JavaScriptSerializer.serialize(this.T2a)}NYd(ba,Aa){const Wa={};Wa.insert=ba;Wa.attributes=Aa;return Wa}Ael(ba,Aa){this.Njb(Aa.weight>=sa.Enk,ba,"weight",Aa.weight);this.Njb(Aa.italic,ba,"italic",!0);this.Njb(Aa.underline,ba,"underline",!0);this.Njb(Aa.strikethrough,ba,"strikethrough",!0);this.Njb(!!Aa.highlight,
ba,"highlight",Aa.highlight);this.Njb(!!Aa.color,ba,"color",Aa.color);this.Njb(!!Aa.paragraph,ba,"paragraph",Aa.paragraph)}Njb(ba,Aa,Wa,gb){ba&&(Aa[Wa]=gb)}static I1f(ba){return Sys.Serialization.JavaScriptSerializer.deserialize(ba,!0)}}sa.Enk=700;Object(h.a)(sa,"DeltaFormatCreator",null,[1542]);var Ba=d(529),pa=d(1151);class ia{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}roj(ba,Aa){if(!ba)throw r.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Wa=sa.I1f(ba)}catch(Kc){throw r.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var gb=ba=0,nb=0;const lc=RegExp("\\s+","g"),jd=new Sys.StringBuilder;for(var xd of Wa.ops)xd.attributes&&xd.attributes.atmention&&xd.attributes.atmention.email&&Aa&&(Wa=xd.attributes.atmention.email,0<Wa.length&&(Wa===Aa.UserId||Wa===Aa.Email||Wa===Ba.a.L8a(Aa.UserId))&&(gb=ba,nb=gb+xd.insert.length)),Wa=xd.insert.replace(lc,
" "),ba+=Wa.length,jd.append(Wa);!nb&&Aa&&r.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Aa.Provider);Aa=jd.toString().trimEnd();ba=Aa.length;255<ba?(xd=(255-(nb-gb))/2,0>gb-xd?(ba=pa.a.instance.l6d(Aa,255-this.ellipsis.length),nb=Aa.substring(0,ba)+this.ellipsis,ba="Trimmed End"):nb+xd>ba?(gb=pa.a.instance.hTc(Aa,ba-255+this.ellipsis.length),nb=this.ellipsis+Aa.substring(gb,ba),ba="Trimmed Start"):(gb=pa.a.instance.hTc(Aa,gb-xd+this.ellipsis.length),ba=pa.a.instance.l6d(Aa,
nb+xd-this.ellipsis.length),nb=this.ellipsis+Aa.substring(gb,ba)+this.ellipsis,ba="Trimmed Both")):(ba="No Trim",nb=Aa);r.ULS.sendTraceTag(592998804,327,50,ba);return nb}}Object(h.a)(ia,"ContentExtractor",null,[]);class Da{constructor(ba,Aa){this.UTh=ba;this.uWh=Aa;this.Yjb=this.clb=!1}eMa(ba){if(!ba)return null;if(void 0===ba.UserId||null===ba.UserId)throw r.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(ba.IsCurrentUser||!this.UTh.equals(this.uWh.value,
ba))return ba;ba=ka(ba);ba.IsCurrentUser=!0;return ba}}Object(h.a)(Da,"EnsureIsCurrentUserSetTransformer",null,[1578]);class Xa{constructor(){this.Yjb=this.clb=!1}eMa(ba){if(!ba)return null;if(void 0===ba.UserId||null===ba.UserId)return ba;if(!ba.Email||""===ba.Email){let Aa;if(Aa=Ba.a.L8a(ba.UserId))return ba=ka(ba),ba.Email=Aa,ba}return ba}}Object(h.a)(Xa,"RestoreEmailTransformer",null,[1578]);class Ka{constructor(){this.Yjb=this.clb=!1}eMa(ba){if(!ba)return null;if(void 0!==ba.UserId&&null!==ba.UserId)return ba;
switch(this.clb?this.Yjb?2:1:0){case 0:if(void 0===ba.UserId||null===ba.UserId)throw r.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");ba=ka(ba);break;case 1:if(void 0===ba.Id||null===ba.Id)throw r.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===ba.Email||null===ba.Email)throw r.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Aa=Ka.q$g(ba.Id,ba.Email,null);
if(!Aa||""===Aa)throw r.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Wa=e.AFrameworkApplication.fa.Ga("HostAuthType")||"";if("aad"!==Wa.toLowerCase()||Aa.startsWith("S::")){if("msa"===Wa.toLowerCase())throw r.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");r.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Wa)}else throw r.ULS.sendTraceTag(593368211,327,
10,"Unexpected UserID format"),Error.argument("userId");ba=new na(Aa,"AD",ba.DisplayName,ba.Email);break;case 2:if(void 0===ba.UserPrincipalName||null===ba.UserPrincipalName)throw r.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==ba.SuggestionSubtype&&null!==ba.SuggestionSubtype)if("OrganizationUser"===ba.SuggestionSubtype)Aa="AD";else throw r.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
ba.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw r.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Wa=Ka.q$g(ba.Id,ba.UserPrincipalName,ba.AadObjectId);if(!Wa||""===Wa)throw r.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Aa&&!Wa.startsWith("S::"))throw r.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
ba=new na(Wa,Aa,ba.Name,ba.UserPrincipalName);break;default:throw r.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return ba}static q$g(ba,Aa,Wa){if(!Aa||""===Aa)return r.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),ba;if(Wa&&""!==Wa)return"S::"+Aa+"::"+Wa;if(!ba||""===ba)return r.ULS.sendTraceTag(593368217,327,50,"Missing ID"),ba;if(ba.startsWith("S::"))return ba;if(-1!==ba.indexOf("@")){Wa=ba.split("@");if(P.a.isValid(Wa[0]))return"S::"+Aa+"::"+
Wa[0];r.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return ba}}Object(h.a)(Ka,"UserIdCanonicalizationTransformer",null,[1578]);class Ma{constructor(ba,Aa,Wa=!1,gb=!1){this.URh=ba;this.G9e=Aa;this.OWh=Wa;this.rAc=gb}HDi(){const ba=new Ba.a;var Aa=new Q.a(Ma.z8i);const Wa=new Z;this.G9e&&(Wa.OOb.push(new Ka),Wa.OOb.push(new Xa));this.URh&&Wa.OOb.push(new Da(ba,Aa));Wa.clb=this.G9e;Wa.Yjb=this.OWh;Aa=new T(Aa,Wa);const gb=new ia;return new Ga(ba,Wa,Aa,gb,Ma.sLi,Ma.eLi,
Ma.fLi,this.rAc)}static z8i(){const ba=new na(e.AFrameworkApplication.fa.Ga("PresenceUserId")||"",e.AFrameworkApplication.fa.Ga("PresenceProvider")||"",e.AFrameworkApplication.userName||"");ba.IsCurrentUser=!0;return ba}}Ma.sLi="";Ma.eLi=5;Ma.fLi=0;Object(h.a)(Ma,"CommentTaskTranslatorFactory",null,[1571]);class Oa{constructor(){this.iLd=this.c8e=!1;this.sqb=this.Ts=this.Mef=this.vif=this.trf=this.Flf=this.lqf=this.t$e=this.Vw=this.UWb=null}initialize(ba,Aa,Wa,gb=null,nb=null,lc=null,jd=null,xd=null,
Kc=null,Zc=null){this.Vw=ba;this.t$e=Aa;this.lqf=Wa;this.Flf=gb;this.trf=nb;this.vif=lc;this.Mef=jd;this.Ts=xd;this.c8e=!0;this.sqb=Kc;this.UWb=Zc}k9b(ba=null,Aa=null){if(!this.c8e)return r.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Wa,gb)=>{gb(E.a.Ys(-2130915313))});if(this.iLd)return r.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>
{});this.UWb||(e.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.UWb=appResourceLoader.loadChunk("sharedComments"):this.UWb=this.Vw.loadScript("sharedComments"));return this.UWb.then(()=>{ba&&ba();this.iLd||(this.sqb&&this.sqb.execute(Wa=>{Wa.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Aa&&Aa(),sharedComments.instantiate(this.t$e,this.lqf,this.Flf,this.trf,this.vif,this.Mef,this.Ts));this.iLd=!0})}}Object(h.a)(Oa,"CommentActivationManager",
null,[1573]);var qa=d(14);class Ya{constructor(){this.actionBehavior=this.actionType=0}}Object(h.a)(Ya,"CommentUIActionPayload",null,[]);var Fb=d(259);class hc{constructor(ba,Aa){this.Ca=ba;this.c2a=Aa;this.ixd=new Fb.a;for(let Wa of this.c2a)this.ixd.$(Wa.value.canvasActionId,Wa.key),ba=Wa.value,ba.delayActionsUntilRegistration||this.ya(ba)}ya(ba){ba.withFlags?this.Ca.ra(ba.canvasActionId,ba.canvasContextId,Object(qa.a)(this,this.tYb,"actionHandler"),97):this.Ca.ya(ba.canvasActionId,ba.canvasContextId,
Object(qa.a)(this,this.tYb,"actionHandler"))}Sxa(ba,Aa){this.c2a.Gb(ba)&&(this.c2a.ga(ba).delayActionsUntilRegistration&&this.ya(this.c2a.ga(ba)),this.c2a.ga(ba).registeredCallback=Aa)}tYb(ba,Aa,Wa,gb,nb){if(this.ixd.Gb(ba)){var lc=this.ixd.ga(ba);if(!this.c2a.Gb(lc))return 8;const jd=this.c2a.ga(lc);if(jd.preCallback){const xd=jd.preCallback(ba,Aa,Wa,gb,nb);if(2!==xd)return xd}if(!jd.registeredCallback)return 1===Wa?8:2;lc=Object.assign(new Ya,{actionType:lc});1===Wa&&(lc.actionBehavior=1);lc=jd.registeredCallback(lc);
return jd.postCallback?jd.postCallback(lc,ba,Aa,Wa,gb,nb):lc?32:8}return 2}}Object(h.a)(hc,"OfficeSharedCommentsActionHost",null,[1545]);var ec=d(346),Tb=d(37),vb=d(192);class zb{}Object(h.a)(zb,"CommentActivityData",null,[]);var Xb=d(142),Za=d(73);class Va{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc,Zc=null,Sc=null){this.ysf={["CancelCommentCreateThreadAction"]:Tb.a.$th,["CommitComment"]:Tb.a.auh,["CommitDraftAction"]:Tb.a.buh,["CommitDraftCreateAction"]:Tb.a.OXe,["CommitDraftEditAction"]:Tb.a.QXe,["CommitDraftReplyAction"]:Tb.a.NXe,
["CreateReplyAction"]:Tb.a.NXe,["CreateReplyWithMentions"]:Tb.a.cuh,["CreateReplyWithTaskAssigned"]:Tb.a.duh,["CreateThreadAction"]:Tb.a.OXe,["CreateThreadWithMentions"]:Tb.a.euh,["CreateThreadWithTaskAssigned"]:Tb.a.fuh,["DeletePostAction"]:Tb.a.guh,["DeleteThreadAction"]:Tb.a.huh,["DeleteThreadWithTask"]:Tb.a.iuh,["DiscardDraftAsync"]:Tb.a.juh,["PresentLinkToCommentAction"]:Tb.a.kuh,["ResolveThreadAction"]:Tb.a.ouh,["ResolveThreadWithTask"]:Tb.a.puh,["ReopenThreadAction"]:Tb.a.luh,["ReopenThreadWithTask"]:Tb.a.muh,
["RequestInitCommentSession"]:Tb.a.nuh,["SelectCommentAction"]:Tb.a.quh,["UpdateCommentBodyAction"]:Tb.a.QXe};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=ba;this.appVersion=Aa;this.releaseAudience=Wa;this.releaseChannel=gb;this.sessionId=nb;this.ring=lc;this.dataCenter=jd;this.disableUpload=xd;this.sovereignEnvironmentName=Sc;this.Ca=Kc;this.Hlf=Zc;this.bHj()}bHj(){this.Ca.ya(Tb.a.$th,
Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.auh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.buh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.NXe,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.cuh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.duh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.OXe,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.euh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.fuh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.guh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.huh,
Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.iuh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.juh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.kuh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.ouh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.puh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.luh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.muh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.nuh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.quh,Za.a.frame,vb.ActionManager.Ng);this.Ca.ya(Tb.a.QXe,
Za.a.frame,vb.ActionManager.Ng)}sendULSTrace(ba,Aa,Wa,gb){r.ULS.sendTraceTag(ba,Aa,Wa,gb)}recordActivity(ba){this.ysf[ba]&&this.Ca.processAction(this.ysf[ba],2)}sendOtelEvent(ba){Xb.a.sendOtelEvent(ba)}recordPerfData(ba,Aa){this.Hlf&&(ba=Object.assign(new zb,{durationMs:Aa,name:ba}),this.Hlf.doa(ba))}}Object(h.a)(Va,"OfficeSharedCommentsTelemetry",null,[]);var tc=d(270);class Kb{constructor(ba,Aa,Wa,gb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ba;
this.appLocale=Aa;this.uiCulture=Wa;this.dataCulture=gb}}Object(h.a)(Kb,"LocalizationDetails",null,[]);var Pa=d(291),mb=d(67),qc=d(93);class oc{constructor(ba,Aa){this.q4h=ba;this.Ubf=Aa}getViewContainer(){return this.q4h}registerForViewContainerEvents(ba){this.Ubf.iXk(ba)}unregisterForViewContainerEvents(ba){this.Ubf.vDl(ba)}}Object(h.a)(oc,"ViewContainerProvider",null,[1500]);var ib=d(71),$a=d(1204),Db=d(36),Mb=d(29),ob=d(250),jc=d(211),Gb=d(28),Gc=d(237),bc=d(639);class dc{static F3f(ba){return ba===
dc.create?0:ba===dc.reply?1:ba===dc.edit?2:ba===dc.metadata?3:null}}dc.create="CREATE";dc.reply="REPLY";dc.edit="EDIT";dc.metadata="METADATA";Object(h.a)(dc,"CommentSessionType",null,[]);class Nb{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(h.a)(Nb,"InitCommentSessionResult",null,[]);class Ac extends Nb{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(h.a)(Ac,"BeginDraftingHostResult",
Nb,[]);class jb{constructor(ba,Aa="",Wa="",gb="",nb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=ba;this.Provider=Aa;this.DisplayName=Wa;this.Email=gb;this.IsCurrentUser=nb}}Object(h.a)(jb,"OfficeSharedCommentUser",null,[]);var Vb=d(47),Tc=d(57),wb=d(193),Rb=d(35);class vc{constructor(ba,Aa,Wa){this.Lq=ba;this.X8j=Aa;this.$7j=Wa;this.ayg=null;this.dFg=!1}get LQa(){return this.Lq}get uC(){return this.X8j}get commentId(){return this.$7j}get z8(){return this.ayg}set z8(ba){this.ayg=
ba}get p0c(){return this.dFg}set p0c(ba){this.dFg=ba}}Object(h.a)(vc,"ActiveCommentSession",null,[]);var rd=d(687);class rc{static get vmk(){return 50}static y4i(ba){return rc.f7i(ba)}static Fgj(ba){if(""===ba)return"";let Aa=0,Wa="";try{const gb=sa.I1f(ba);for(const nb of gb.ops)if(rc.iua(nb))Aa||(Wa+=rc.daj(nb.attributes.atmention.fullName)),Aa+=1;else{const lc=nb.insert?nb.insert:"";" "!==lc&&0<lc.length&&(Aa=0,Wa+=lc)}}catch(gb){r.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Wa}static f7i(ba){ba=
rc.Fgj(ba);return 0<ba.length&&ba.split(" ").length<=rc.vmk?ba:null}static daj(ba){let Aa="";ba&&(ba=ba.split(" "),0<ba.length&&(Aa=ba[0]));return Aa}static iua(ba){return!!ba.attributes&&!!ba.attributes.atmention}}Object(h.a)(rc,"BaseCommentSmartReplyHelpers",null,[]);class cb{constructor(ba){this.yre=ba}LJl(ba,Aa,Wa,gb){-1===Wa||Aa||(Aa=gb[Wa],Wa=Aa.author?Aa.author.IsCurrentUser:!1,Aa&&Aa.commentBody&&!Wa&&(Aa=rc.y4i(Aa.commentBody))&&this.yre.invoke(ba,Aa))}}Object(h.a)(cb,"CommentSmartReplyHelpers",
null,[]);var Wb=d(55),Uc=d(76),Ib=d(33),Vc=d(90),gc=d(92),rb=d(51);class Zb{constructor(){this.eBd=this.TLd=this.HOa=null;this.Obg=!1;this.etd=this.ftd=this.endPos=this.startPos=0}get paragraphs(){return this.HOa}get cV(){return this.TLd}set cV(ba){this.TLd=ba;this.HOa=[];this.HOa.push(this.TLd)}get u3(){return this.eBd}set u3(ba){this.eBd=ba;this.HOa&&this.vac&&this.HOa.push(this.eBd)}RWi(){for(const ba of this.HOa){const Aa=Object($a.a)(5,ba);if(Aa&&-1!==Aa.Twb().indexOf("\ufffc"))return!0}return!1}dog(ba){const Aa=
(this.etd&4294967295)>>>0;ba.TextBodyLength!==this.ftd||Aa===ba.TextBodyHash||Zb.Znh.contains(this.etd)||(Zb.Znh.add(this.etd),Gb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.RWi()));return ba.TextBodyLength===this.ftd}get Yfh(){let ba=0;if(this.isValid)if(this.vac){ba+=Ib.ParagraphReader.textLength(this.cV)-this.startPos;ba+=this.endPos;for(let Aa=1;Aa<this.paragraphs.length-1;Aa++){const Wa=this.paragraphs[Aa];Wa&&
(ba+=Ib.ParagraphReader.textLength(Wa)+1)}}else ba=this.endPos-this.startPos;return ba}get SLa(){if(!this.isValid)return Vc.a.auto;var ba=rb.a.Mj(this.cV,this.startPos+1);if(!ba)return Vc.a.auto;ba=gc.a.xs(ba);return ba?(ba=ba.cache)&&ba.V3?ba.fontColor:Vc.a.auto:Vc.a.auto}get isValid(){return!!this.cV&&!!this.u3&&!!this.paragraphs}get vac(){return!this.cV.equals(this.u3)}Q7h(ba){this.HOa&&ba&&this.HOa.push(ba)}bJj(){if(this.isValid&&(this.cV.Cv(16,!0),this.vac))for(let ba=1;ba<this.paragraphs.length;ba++){const Aa=
this.paragraphs[ba];Aa&&Aa.Cv(16,!0)}}GMj(ba,Aa){if(!this.isValid)return!1;const Wa=Object($a.a)(Uc.AParagraphNode,ba.node),gb=Object($a.a)(Uc.AParagraphNode,Aa.node);return!(Wa&&gb&&Array.contains(this.paragraphs,Wa)&&Array.contains(this.paragraphs,gb))||Wa.equals(this.cV)&&(0>ba.Qa||ba.Qa<this.startPos)||gb.equals(this.u3)&&(0>Aa.Lb||Aa.Lb>this.endPos)?!1:!0}Z1f(ba){let Aa=3;ba&&(!this.vac&&this.cV.equals(ba)?Aa=2:this.cV.equals(ba)?Aa=0:this.u3.equals(ba)&&(Aa=1));return Aa}}Zb.Znh=new ra.a;Object(h.a)(Zb,
"TextAnchorParagraphInfo",null,[]);class Hc{static Kvb(ba,Aa){return ba||Aa?ba&&Aa?ba.commentId===Aa.commentId:!1:!0}static JPc(ba){return!!ba.Children&&0<ba.Children.length}static Zfj(ba,Aa){ba=ba.Twb()+"\r";for(let Wa=0;Wa<ba.length;Wa++){let gb=ba.charCodeAt(Wa);160===gb&&(gb=32);Aa=(Aa<<5>>>0)+Aa+gb}return Aa}static HN(ba){return!!ba&&!!ba.textAnchoringInfo&&ba.textAnchoringInfo.EndPos>ba.textAnchoringInfo.StartPos&&0<ba.textAnchoringInfo.TextBodyLength}static Z6b(ba,Aa){if(!Hc.HN(ba))return null;
if(!Aa||1>Aa.xC().length)return Gb.a.J(509220243,805,Aa?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!Aa),null;let Wa=null,gb=null,nb=null;ba.textAnchoringInfo.AnchoringShape&&(ba.textAnchoringInfo.AnchoringShape.TableCell?(Wa=P.a.Gf(ba.textAnchoringInfo.AnchoringShape.TableCell.RowId),gb=P.a.Gf(ba.textAnchoringInfo.AnchoringShape.TableCell.ColId)):ba.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(nb=ba.textAnchoringInfo.AnchoringShape.SmartArtNodeId,
nb.startsWith("{")||(nb="{"+nb),nb.endsWith("}")||(nb+="}")));let lc=ba.textAnchoringInfo.StartPos;ba=ba.textAnchoringInfo.EndPos;let jd=0,xd=0;const Kc=new Zb;Aa=Aa.xC();for(let Sc=0;Sc<Aa.length;Sc++){const ld=Aa[Sc],Dg=Ib.ParagraphReader.textLength(Object($a.a)(Uc.AParagraphNode,ld));if(Wa&&gb){var Zc=ld.lL();if(!Zc||!Wa.equals(Zc.rowId)||!gb.equals(Zc.cellId))continue}else if(nb&&(!ld.get_smartArtModelId()||nb!==ld.get_smartArtModelId()))continue;if(!Kc.isValid&&(Dg>lc||Kc.cV)){if(!Kc.cV&&(Kc.cV=
Object($a.a)(Uc.AParagraphNode,ld),Kc.startPos=lc,!Kc.cV))return null;Zc=Sc===Aa.length-1||!!nb&&Hc.LRj(nb,Aa[Sc+1])||!!Wa&&!!gb&&Hc.KRj(Wa,gb,Aa[Sc+1]);Zc=Dg<ba&&0<Dg&&Zc;if((Dg>=ba||Zc)&&!Kc.u3){if(Zc&&(ba=Dg),Kc.u3=Object($a.a)(Uc.AParagraphNode,ld),Kc.endPos=ba,!Kc.u3)return null}else ld.equals(Kc.cV)||Kc.Q7h(Object($a.a)(Uc.AParagraphNode,ld))}jd+=Dg+1;xd=Hc.Zfj(ld,xd);Kc.cV||(lc-=Dg+1);ba-=Dg+1}Kc.ftd=jd;Kc.etd=xd;return Kc}static LRj(ba,Aa){return Aa.get_smartArtModelId()&&Aa.get_smartArtModelId()===
ba?!1:!0}static KRj(ba,Aa,Wa){return(Wa=Wa.lL())&&ba.equals(Wa.rowId)&&Aa.equals(Wa.cellId)?!1:!0}static knj(ba,Aa,Wa,gb){Wa=gb=-1;if(!ba)return Gb.a.J(509220242,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,ALa:Wa,uDa:gb};let nb=Object($a.a)(5,Aa.Ua.node);const lc=Object($a.a)(5,Aa.Ye.node);if(!nb||!lc)return Gb.a.J(509220241,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!nb,!lc),{returnValue:null,ALa:Wa,uDa:gb};const jd=Aa.Ua.Z5a,xd=Aa.Ye.yYb;var Kc=Ib.ParagraphReader.textLength(Aa.Ua.node);Aa=Ib.ParagraphReader.textLength(Aa.Ye.node);if(0>jd||0>=xd||jd===xd&&nb===lc||jd>Kc||xd>Aa)return Gb.a.J(509220240,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",jd,xd,Kc,Aa),{returnValue:null,ALa:Wa,uDa:gb};ba=ba.xC();if(!ba)return Gb.a.J(509220239,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,ALa:Wa,uDa:gb};Kc=0;for(const Zc of ba){if(lc.get_smartArtModelId()){if(Zc.get_smartArtModelId()!==lc.get_smartArtModelId())continue;nb.get_smartArtModelId()!==lc.get_smartArtModelId()&&(nb=Zc)}if(lc.Cs()){if(Zc.lL()!==lc.lL())continue;nb.lL()!==lc.lL()&&(nb=Zc)}nb===Zc&&(Wa=jd+Kc);lc===Zc&&(gb=xd+Kc);if(0<=Wa&&0<=gb)return{returnValue:nb,ALa:Wa,uDa:gb};Kc+=Zc.Twb().length+1}0<=
Wa&&-1===gb&&(nb.get_smartArtModelId()||nb.Cs())&&(gb=Kc-1);return{returnValue:nb,ALa:Wa,uDa:gb}}static get JIc(){return Wb.a.fg||Wb.a.IUa}static get NPc(){return!Wb.a.Pi}}Object(h.a)(Hc,"CommentUtilities",null,[]);const Ab=(ba,Aa)=>{var Wa,gb;if(null===ba||void 0===ba||!ba.ReactionList)return ba;for(const nb in ba.ReactionList)ba.ReactionList[nb].ReactionInstances=null===(gb=null===(Wa=ba.ReactionList[nb])||void 0===Wa?void 0:Wa.ReactionInstances)||void 0===gb?void 0:gb.filter(lc=>lc.User.UserId!=
Aa.UserId);ba.ReactionList=ba.ReactionList.filter(nb=>0!=nb.ReactionInstances.length);0==ba.ReactionList.length&&(ba.ReactionList=void 0);return ba},ad=ba=>ba.ka("PPTOCommentReactionsUIEnabled");class Bd{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc,Zc,Sc,ld,Dg,De,gi,pk){this.n9c=!1;this.kb=ba;this.zHa=Aa;this.Rse=Wa;this.K6j=gb;this.zb=nb;this.Qb=lc;this.ecd=jd;this.f8j=xd;this.Uva=Kc;this.yre=Sc;this.s9j=ld;this.qva=Dg;this.$9c=De;this.Y7j=gi;this.ia=pk}beginDraftingAsync(ba){if(!ba)return new Promise((Wa,
gb)=>{gb(E.a.Ys(-2130915327))});const Aa=dc.F3f(ba.sessionType);return void 0===Aa||null===Aa?new Promise((Wa,gb)=>{gb(E.a.Ys(-2130915317))}):2===Aa&&ba.commentId===Bd.OGb?new Promise((Wa,gb)=>{gb(E.a.Ys(-2130915324))}):new Promise((Wa,gb)=>{E.a.prb(this.zb,()=>{var nb=this.kb.u9d(),lc=null;let jd=-1;Gb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",Aa);try{switch(Aa){case 0:if(this.$9c)try{jd=this.kb.z3f(!0)}catch(Sc){Gb.a.J(512496832,801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",
Sc),jd=nb.length}else jd=nb.length;lc=new vc(Aa,ba,"");this.n9c=!0;break;case 1:if(!ba.threadId||!ba.threadId.length)throw E.a.Ys(-2130915324);jd=Bd.Lbj(nb,ba.threadId);if(-1===jd)throw E.a.Ys(-2130915323);if(this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var xd=ba.threadId;(new cb(this.yre)).LJl(xd,Bd.Ryj(nb,xd),Bd.p8d(nb,xd),nb)}lc=new vc(Aa,ba,ba.threadId);break;case 2:if(!ba.commentId||!ba.commentId.length)throw E.a.Ys(-2130915324);jd=Bd.p8d(nb,ba.commentId);
if(-1===jd)throw E.a.Ys(-2130915323);lc=new vc(Aa,ba,ba.commentId);break;case 3:jd=Bd.p8d(nb,ba.threadId);lc=new vc(Aa,ba,ba.threadId);break;default:throw E.a.Ys(-2130915322);}if(!lc)throw E.a.Ys(-2130915322);var Kc=this.kb.hEj(lc);if(Kc)throw Kc;}catch(Sc){gb(Sc);return}nb=new Ac;lc=this.Qb.Ga("UserName");Kc=this.Qb.Ga("387");xd=this.Qb.Ga("388");const Zc=Rb.a("PPTPlumbEmailThroughCG")?Ba.a.L8a(Kc||""):"";Kc=new jb(Kc,xd,lc,Zc,!0);nb.author=Kc;nb.insertIndex=jd;nb.authorName=lc;nb.authorIdentity=
new String;Wa(nb)})})}commit(ba,Aa,Wa){if(!this.kb.HMc)throw Gb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.kb.dxi),E.a.Ys(-2130915320);var gb=this.kb.HMc.uC;if(!gb)throw Gb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),E.a.Ys(-2130915320);const nb=dc.F3f(gb.sessionType);if(void 0===nb||null===nb)throw E.a.Ys(-2130915317);if(ba!==gb.draftId)throw E.a.Ys(-2130915327);const lc=this.qva?wb.e(P.a.create().toString()):
"";this.kb.BPf();switch(nb){case 0:return Gb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",lc),gb={},this.kb.B1k(lc),gb.commentId=lc,this.n9c=!1,this.kb.B0g=lc,Bd.lEh(Wa),Bd.kEh(),this.createComment(Aa,gb,Wa);case 1:return Gb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",gb.threadId,lc),ba={},ba.parentId=gb.threadId,ba.commentId=lc,Bd.lEh(Wa),Bd.kEh(),this.createComment(Aa,ba,Wa);case 2:return Gb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",gb.commentId),
Wa={},Wa.commentBody=Aa,this.vEl(gb.commentId,Wa),ba;case 3:return Gb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",gb.threadId),ad(this.Qb)?this.wEl(gb.threadId,Wa):this.lHh(gb.threadId,Wa),gb.threadId;default:throw E.a.Ys(-2130915322);}}endCommentSession(ba){Gb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",ba);this.kb.endCommentSession(ba,this.n9c?9:1);this.n9c=!1}createComment(ba,Aa,Wa){const gb=this.ecd.$td(ba,new Date);let nb="";this.qva&&(nb=Vb.a.Wa(Aa.commentId)?
P.a.create().toString():Aa.commentId);let lc=null;void 0!==Wa&&null!==Wa&&(lc=this.ecd.fzl(nb,Wa.Task,ba));ba=this.kb.rod;if(Wa=Aa.parentId?null:this.kb.lnj())ba=this.kb.Q8k;this.zHa.i6h(nb,gb.plainText,Aa.parentId,ba,this.kb.anchorNode,gb.w0g,lc,Wa);return Vb.a.Wa(nb)?Bd.OGb:nb}deleteComment(ba){if(ba===Bd.OGb)throw E.a.Ys(-2130915327);Gb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",ba);this.zHa.deleteComment(ba)}selectComment(ba){ba!==Bd.OGb&&this.kb.cga(ba,0,!1)}highlightComment(ba){ba!==
Bd.OGb&&this.kb.l5h(ba)}kHh(ba,Aa,Wa){const gb=Array.clone(this.kb.u9d());var nb=null;for(var lc of gb)if(lc.commentId===ba){nb=lc;break}if(!nb)throw Gb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),E.a.Ys(-2130915323);(lc=e.AFrameworkApplication.userName)&&0<lc.length&&lc!==nb.author.DisplayName&&Gb.a.J(512496794,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",e.AFrameworkApplication.kmb||e.AFrameworkApplication.PQ);lc=new Date;
nb=this.ecd.$td(nb.commentBody,null).plainText;Aa=this.ecd.$td(Aa.commentBody,lc);this.zHa.KQi(Aa.plainText,ba,Aa.w0g);Wa||nb!==Aa.plainText||this.Rse.Iph(gb,this.kb.C1g,Array.clone(this.kb.h5f()))}vEl(ba,Aa){if(ba===Bd.OGb)throw E.a.Ys(-2130915327);Aa.commentBody&&(this.Qb.ka("896")?this.kHh(ba,Aa,!0):E.a.prb(this.zb,()=>{this.kHh(ba,Aa,!1)}))}wEl(ba,Aa){if(!((null===Aa||void 0===Aa?0:Aa.Resolve)||(null===Aa||void 0===Aa?0:Aa.Reaction)))throw E.a.Ys(-2130915327);(null===Aa||void 0===Aa?0:Aa.Resolve)&&
this.lHh(ba,Aa);(null===Aa||void 0===Aa?0:Aa.Reaction)&&this.yEl(ba,Aa)}lHh(ba,Aa){if(void 0===Aa.Resolve||null===Aa.Resolve)throw E.a.Ys(-2130915327);const Wa=Aa.Resolve.isResolved;let gb=Wa?100:0;void 0!==Aa.Task&&null!==Aa.Task&&(gb=Aa.Task.completion);this.zHa.mHh(ba,Wa?1:0,gb);Wa&&this.kb.Mal()}yEl(ba,Aa){if(ad(this.Qb)){if(null==(null===Aa||void 0===Aa?void 0:Aa.Reaction))throw E.a.Ys(-2130915327);a:{switch(Aa.Reaction.reactionType){case 1:var Wa="\ud83d\udc4d";break a;default:Gb.a.J(509220244,
805,50,"Unsupported reaction type")}Wa=void 0}void 0!==Wa&&(this.zHa.zEl(ba,Wa,Aa.Reaction.isActive),this.kb.qtk())}}setThreadResolvedState(ba,Aa){this.zHa.mHh(ba,Aa?1:0,Aa?100:0);Aa&&this.kb.GOf(ba)}selectFirstThreadInNextCommentContext(){this.kb.A8k()}selectLastThreadInPreviousCommentContext(){this.kb.D8k()}presentLinkToComment(ba){if(ba=this.zHa.alj(ba)){ba=JSON.stringify({["sId"]:ba.sid,["cId"]:ba.cid});var Aa={};Aa.nav=rd.a(ba);Aa.mode="copy";Gb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",
ba);this.ia.La(Tb.a.Xsa,2,Aa)}else Gb.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(ba){this.Y7j.mej().then(Aa=>{this.Rse.hWk(ba,this.kb.u9d(),this.kb.C1g,this.kb.isReadOnly,this.kb.h5f(),Aa,this.f8j.K1c)})}unregisterForCommentEvents(ba){this.Rse.P4e(ba)}registerForAction(ba,Aa){this.K6j.Sxa(ba,Aa);this.kb.AUk()}unregisterForAction(){}loadThreads(){Gb.a.J(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(ba=>{e.AFrameworkApplication.fa.ff(()=>
{this.Uva?this.Uva.atMentionsEnabledAsync().then(Aa=>{ba(Aa);return null}):ba(!1)})})}resolveSupported(){return this.s9j}static Lbj(ba,Aa){let Wa=!1;for(let gb=0;gb<ba.length;gb++){if(Wa&&ba[gb].commentId!==Aa&&ba[gb].parentId!==Aa)return gb;ba[gb].commentId===Aa&&(Wa=!0)}return Wa?ba.length:-1}static Ryj(ba,Aa){let Wa=!1;for(let gb=0;gb<ba.length;gb++)if(ba[gb].commentId===Aa&&(Wa=!0),Wa&&ba[gb].parentId===Aa)return!0;return!1}static p8d(ba,Aa){for(let Wa=0;Wa<ba.length;Wa++)if(ba[Wa].commentId===
Aa)return Wa;return-1}static kEh(){if(Rb.a("CommentsFpsIsEnabled"))try{const ba=Tc.a.instance.Ja("Common.ISystemInitiatedFeedback");ba&&ba.execute(Aa=>{Aa.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(ba){Gb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",ba)}}static lEh(ba){if(Rb.a("CommentsTasksFpsIsEnabled")&&ba&&ba.Task)try{const Aa=Tc.a.instance.Ja("Common.ISystemInitiatedFeedback");Aa&&Aa.execute(Wa=>{Wa.logActivity("PPTWebCommitTaskActivity",
"CommentsTasksFpsIsEnabledBRS")})}catch(Aa){Gb.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",Aa)}}}Bd.OGb="temp-id";Object(h.a)(Bd,"CommentAPI",null,[1257,1258]);var kd=d(195),Be=d(352),Qd=d(692);class ae{constructor(ba,Aa,Wa){this.Flc=ba;this.commentId=Aa;this.state=Wa}}Object(h.a)(ae,"CommentTextAnchorToHighlight",null,[]);class We extends Sys.EventArgs{constructor(ba){super();this.zhl=ba}}Object(h.a)(We,"CommentsVisibilityOnSmartArtChangeEventArgs",
Sys.EventArgs,[]);class $d{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc,Zc){this.$Tg=[];this.Wcd=null;this.Fqd=!1;if(!Zc)throw Error.argumentNull("viewElementEventNotifier");this.Kc=Aa;this.bCe=this.Shc=!1;this.d4c=ba;this.jhk=Wa;this.Icb=this.kWa=null;this.hl=gb;this.pa=nb;this.VVa=lc;this.vGa=jd;this.Dea=xd;this.a8j=Kc;this.EJ=Zc;this.Dea.LQe(this.a8j)}get DW(){return this.kWa&&this.kWa.isConnected?this.kWa:null}get Pxh(){return this.Shc}Hqc(ba,Aa,Wa=!1,gb=!1){const nb=this.jhk.ZG(ba);if(nb)switch(Aa){case 0:nb.display(Wa,
gb);this.kWa=ba;break;case 1:nb.activate();this.Icb=ba;break;case 2:nb.dismiss();this.kWa=null;break;case 3:this.DW&&this.DW===ba&&this.P7a&&this.r3d(this.P7a,ba)?nb.display(Hc.HN(this.P7a),gb):nb.dismiss();this.Icb=null;break;case 4:nb.BOi(Wa),this.kWa=ba}}Qpd(ba){if(this.Kc&&this.Kc.Ic)switch(ba){case 0:this.Kc.Ic.highlight();this.Shc=!0;break;case 2:this.Kc.Ic.tGh();this.Shc=!1;break;case 1:this.Kc.Ic.highlight();this.bCe=!0;break;case 3:this.Kc.Ic.tGh(),this.bCe=!1}}rNc(){this.d4c&&(this.Shc?
this.Qpd(2):this.DW&&this.Hqc(this.DW,2),this.Pub(null))}r3d(ba,Aa){if(!Hc.HN(ba))return!0;ba=this.hl.$y();return kd.a.any(ba,Wa=>!Hc.HN(Wa)&&Wa.anchorShape===Aa.get_shapeId())}OUe(ba,Aa,Wa,gb=!1,nb=!1){if(this.d4c&&ba&&(!gb||$d.avb(this.hl.$y(),ba))){gb=this.E8(ba);var lc=this.DW!==gb&&!!this.DW;lc&&this.pa.s8(this.DW);this.rNc();if(gb){const jd=Hc.HN(ba);this.Icb===gb?this.r3d(ba,gb)?this.Hqc(gb,4,jd,jd&&lc):this.kWa=gb:this.r3d(ba,gb)?this.Hqc(gb,0,jd,Wa&&lc):this.kWa=gb;Aa=!!Aa&&Aa===ba.commentId;
(jd||Aa)&&nb||this.i9k(gb,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,ba.authorName,ba.dt.toDateString(),ba.dt.toLocaleTimeString()))}else this.Qpd(0),this.Kc&&this.Kc.Ic&&this.Kc.Ic.Fd&&this.yod(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Kc.Ic.Fd.me+1).toString(),this.Kc.Ic.Fd.title));!nb&&lc&&this.pa.selectShape(this.DW,!0,!1);this.Pub(null)}}k5h(ba){if(this.d4c){var Aa=this.E8(ba);Aa?Hc.HN(ba)?this.Icb=Aa:this.Hqc(Aa,1):this.Qpd(1);this.Pub(ba)}}UMc(){this.Icb&&
this.Hqc(this.Icb,3);this.bCe&&!this.Shc&&this.Qpd(3);this.Pub(null)}E8(ba){if(!ba)return null;try{return this.vGa.JRc(ba)}catch(Aa){return Gb.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",Aa),null}}Pub(ba){const Aa=[];var Wa=this.Icb;ba&&!Wa&&(Wa=this.DW);const gb=this.DW?this.DW:this.pa.kp();gb||ba&&Wa||this.jEh(Aa);let nb=null;const lc=[];var jd=!1;if(Hc.HN(ba)&&Wa&&0<Wa.xC().length&&(!this.P7a||ba.commentId!==this.P7a.commentId)){var xd=Hc.Z6b(ba,
Wa);xd&&xd.isValid&&(jd=Be.a.Gf("{"+ba.commentId+"}{1}"),Aa.push(new ae(xd,jd,1)),jd=!0,Wa=this.vGa.$k(Wa))&&(lc.push(Wa),(Wa=Wa.shapeNode)&&Wa.Qf&&(nb=Wa))}if(this.Fqd||gb&&0<gb.xC().length)if(Wa=this.hl.$y())for(var Kc of Wa){if(!Hc.HN(Kc)||!this.Fqd&&Kc.anchorShape!==gb.get_shapeId()||jd&&Kc.commentId===ba.commentId)continue;xd=this.Fqd?this.E8(Kc):gb;if(!xd)continue;let Zc=Hc.Z6b(Kc,xd);if(!Zc||!Zc.isValid)continue;let Sc=5;(Wa=!!this.P7a&&Kc.commentId===this.P7a.commentId)&&(Sc=0);const ld=Be.a.Gf("{"+
Kc.commentId+"}{1}");Aa.push(new ae(Zc,ld,Sc));if(xd=this.vGa.$k(xd))lc.push(xd),xd=xd.shapeNode,!nb&&xd&&Wa&&xd.Qf&&(nb=xd)}for(const Zc of this.$Tg)!Zc||Array.contains(lc,Zc)||Zc.shapeNode&&Zc.shapeNode.Qf||(Zc.hke=!1,Zc.aq||!Zc.Wn||Zc.jy||Zc.WNb());ba=null;for(const Zc of lc)(Kc=Zc.shapeNode)&&Kc.Qf?(ba||(ba=Kc),nb||gb!==Kc||(nb=Kc)):(Zc.hke=!0,Zc.Wn||(Gb.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),Zc.ysd()));nb||this.pa.HL()||
!ba||(nb=ba);this.$Tg=lc;this.EJ.aPk(new We(nb));this.jEh(Aa)}jEh(ba){ba=Object.assign(new Qd.a,{action:0,type:0,Ada:ba,aib:this.Dea.Nbb?this.Dea.Nbb.Ada:null});this.Dea.fpd(ba)}yod(ba){this.VVa.Sfa(ba)}i9k(ba,Aa){this.VVa.ogh(ba,Aa)}JVe(ba){this.d4c=ba}get P7a(){return this.Wcd&&this.Wcd.vLb?this.Wcd.vLb.comment:null}static avb(ba,Aa){if(ba)for(const Wa of ba)if(Aa.commentId===Wa.commentId)return!0;return!1}}Object(h.a)($d,"CommentAnchoringHighlightsHelper",null,[]);var Re=d(43);class Ta{constructor(ba,
Aa,Wa,gb,nb,lc,jd){this.oc=ba;this.ua=Aa;this.L5c=Wa;this.nO=gb;this.rhk=nb;this.Rb=lc;this.zb=jd;this.vhf=0}E1a(ba,Aa){if(ba||1!==this.K1c)if(2>this.oc.qj())this.q5h?this.vWe(5):this.vWe(1);else{const Wa=Re.a.zk("UpdateNextPopulatedContextDetails",2);this.L5c.i4d((gb,nb,lc)=>{this.Euk(gb,nb,lc,Wa,Aa)},Wa)}}get K1c(){return this.vhf}Euk(ba,Aa,Wa,gb,nb){let lc=1;if(this.ua.Ba){const jd=this.ua.Ba.me;let xd=!1,Kc=!1,Zc=!1;Aa&&ba&&(ba=ba.me,ba<jd?xd=!0:ba===jd?Kc=!0:(Zc=!0,Wa||(xd=!0)));0<=nb&&(nb<jd?
xd=!0:nb===jd?Kc=!0:Zc=!0);Zc?lc=xd||Kc?3:2:xd?lc=4:Kc&&(lc=5)}this.vWe(lc);gb.finish();E.a.prb(this.zb,()=>{this.Rb.updateCommandUI()})}vWe(ba){this.vhf=ba;this.rhk.E1a(ba,1===this.Rb.mode)}get q5h(){return!!this.ua.Ba&&this.nO.OPi(this.ua.Ba)}}Object(h.a)(Ta,"CommentContextDetailsUpdateHelper",null,[1128]);var xb=d(39);class kc{Nal(ba){if(null===ba)throw Error.argumentNull("comment");ba.setValue(xb.a.commentId,"")}Jal(ba,Aa){if(null===ba)throw Error.argumentNull("comment");ba.setValue(xb.a.YVd,
Aa)}Lal(ba){if(null===ba)throw Error.argumentNull("comment");if(ba=Object($a.a)(1199,ba))ba.Ltb=ResourceStrings.anonymousCommentAuthor}cMb(ba){if(null===ba)throw Error.argumentNull("comment");ba.setValue(xb.a.I0b,!0)}Hqh(ba,Aa,Wa,gb){if(null===ba)throw Error.argumentNull("comment");if(ba=Object($a.a)(1199,ba))ba.authorName=Aa,ba.MZb=Wa,ba.pIc=gb}Pal(ba,Aa){if(null===ba)throw Error.argumentNull("comment");ba.setValue(xb.a.J0b,Aa)}Oal(ba,Aa){if(!ba)throw Error.argumentNull("comment");Aa=Db.c(Aa);ba.setValue(xb.a.reactions,
Aa)}}Object(h.a)(kc,"CommentEditor",null,[1256]);var Nc=d(32),id=d(84),Ed=d(58);class Ja{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(h.a)(Ja,"Comment",null,[]);var db=d(299),zc=d(903),Hd=d(283),Ad=d(30);class Kd{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc,Zc,Sc,ld,Dg,De,gi){this.kea=null;this.PBb=
gb;this.Jb=nb;this.ua=lc;this.kB=jd;this.G9=xd;this.Qb=Kc;this.Pb=Zc;this.pa=Sc;this.lE=ld;this.ase=Dg;this.ic=De;this.pR=gi;this.tR=ba;this.Z7j=Wa;this.r9j=0===Aa;this.SGh();this.Soe()}dispose(){}get userName(){return this.Qb.appSettings.UserName}get userId(){return this.Qb.appSettings["387"]}get providerId(){return this.Qb.appSettings["388"]}get isTasksHistoryEnabled(){return this.Qb.ka("TasksHistoryEnabled")}get C9b(){return this.Qb.ka("PPTOBlueDotsForComments")}get Kkg(){return Rb.a("Comments.LogTasksTelemetry")}get FDa(){return this.Qb.ka("SlideResizePerfImprovementEnabled")}addComment(ba,
Aa,Wa){this.Psf("",ba,Aa,Wa,null,null,null,null)}i6h(ba,Aa,Wa,gb,nb,lc,jd,xd){this.Psf(ba,Aa,Wa,gb,nb,lc,jd,xd)}Psf(ba,Aa,Wa,gb,nb,lc,jd,xd){const Kc=this.tR.Ei("UserAction","AddComment");e.AFrameworkApplication.fa.Nda?this.Rsf(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc):this.Qb.ff(()=>{this.Rsf(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc)})}Rsf(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc){this.Z7j.kub().then(Zc=>{Kd.Onh&&(Gb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.r9j,Zc),this.lE.m3j(Zc),
Kd.Onh=!1);this.h6h(ba,Aa,Wa,gb,nb,lc,jd,xd);Kc&&Kc.stop();return Zc}).catch(Zc=>{Gb.a.J(512262930,805,10,JSON.stringify(Zc));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}h6h(ba,Aa,Wa,gb,nb,lc,jd,xd){if(this.qzb()){var Kc=!1,Zc=0,Sc=0;gb&&(Kc=!0,Zc=gb.x,Sc=gb.y);gb=this.Jb.oe(15);try{var ld=this.kea;gb.nc(ld);const Dg=Nc.GraphIterator.nb(ld),De=Object($a.a)(id.a,this.PBb.createInstance(1074135127));this.G9.cMb(De);this.G9.Nal(De);this.G9.Jal(De,ba);ld=
null;const gi=Object($a.a)(1199,De);if(gi){if(gi.Ntb=Kc)gi.Aca=Object.assign(new zc.a,{X:Zc,Y:Sc});gi.XCh=this.ase.Snj();gi.kIc=lc;if(ld=Object($a.a)(4,nb))gi.G0b=ld.get_shapeId();Wa&&(gi.uxa=Wa);jd&&(gi.taskInfo=jd);xd&&(gi.textAnchoringInfo=xd);gi.csa=Aa}let pk=this.userId;nb=!pk;const Kh=!this.providerId,Yd=!this.userName;(nb||Kh)&&Gb.a.J(512262928,805,nb&&!Kh?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",nb,Kh,Yd);Rb.a("Comments.UseNameInPlaceOfUserId")&&nb&&
!Kh&&(pk=Yd?ResourceStrings.anonymousCommentAuthor:this.userName);this.G9.Hqh(De,this.userName,pk,this.providerId);Yd&&this.G9.Lal(De);Dg.Cl(De,1);Gb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",ba,!!jd,!!xd,!!ld)}finally{gb&&gb.dispose()}this.E2j(ba,Wa,Aa,xd,jd)}else Gb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}E2j(ba,Aa,
Wa,gb,nb){this.Kkg?Aa?(Aa=this.vta(Aa))?(Aa=this.qta(Aa))?this.lE.F2j(ba,Wa.length-1,!!gb,Aa.taskInfo,nb):Gb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):Gb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.lE.G2j(ba,Wa.length-1,!!gb,!!nb):this.lE.Poe(ba,Wa.length-1,!!gb,!!nb)}deleteComment(ba){this.lE.z5j();if(this.qzb()){var Aa=this.Jb.Ad(15);try{Aa.nc(this.kea),this.D_d(ba,this.kea),
Aa.jd=Ad.a.deleteComment}finally{Aa&&Aa.dispose()}}else Gb.a.J(512262924,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}D_d(ba,Aa){Rb.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.pa.C_()&&(Gb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.pa.Rh());const Wa=this.c7i(ba,Aa);if(Wa&&0<Wa.count){this.G9.cMb(Aa);for(let gb of Wa)Aa=Nc.GraphIterator.nb(gb),Aa.rc(39),Aa.Oi();Gb.a.J(512262922,
805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",ba)}else Gb.a.J(512262921,805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",ba);this.lE.STk()}qRa(){const ba=Date.now();this.lE.q3j();const Aa=this.$y();if(Aa){var Wa=this.Jb.Ad(15);try{Wa.nc(this.ua.Ba);for(const gb of Aa)this.D_d(gb.commentId,this.kea);Wa.jd=Ad.a.qRa}finally{Wa&&Wa.dispose()}Gb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-ba)}else Gb.a.J(512262920,
805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}v2b(ba){const Aa=Date.now();ba?this.lE.r3j():this.lE.p3j();const Wa=this.ua.presentation;if(Wa){var gb=Wa.slides;if(gb){var nb=this.Jb.Ad(15);try{nb.nc(Wa);for(const lc of gb){const jd=Object($a.a)(116,lc);if(!jd||!jd.XD()){Gb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",jd);continue}const xd=Nc.GraphIterator.nb(jd).Bb(16);for(const Kc of this.rta(jd.XD()))(ba?
1===Kc.status:1)&&this.D_d(Kc.commentId,xd)}nb.jd=ba?Ad.a.Iub:Ad.a.Hub}finally{nb&&nb.dispose()}Gb.a.J(512262917,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-Aa,ba)}}}editComment(ba,Aa){this.kRf(ba,Aa,null)}KQi(ba,Aa,Wa){this.kRf(ba,Aa,Wa)}kRf(ba,Aa,Wa){if(this.qzb()){var gb=this.vta(Aa);if(gb){const nb=this.Jb.oe(15);try{nb.nc(gb);this.G9.cMb(gb);const lc=Object($a.a)(1199,gb);lc&&(lc.csa=ba,lc.kIc=Wa)}finally{nb&&nb.dispose()}Gb.a.J(512262915,
805,50,"CommentManager::EditCommentInternal - Edited comment {0}",Aa)}else Gb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",Aa);this.lE.v3j()}else Gb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}zGb(ba,Aa){if(this.qzb()){var Wa=this.vta(ba);if(Wa){if(null===Aa)throw Error.argumentNull("pos");const gb=this.Jb.oe(15);try{gb.nc(Wa),this.G9.cMb(Wa),Object($a.a)(1199,Wa).Aca=Object.assign(new zc.a,{X:Aa.x,
Y:Aa.y})}finally{gb&&gb.dispose()}Gb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",ba)}else Gb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",ba);this.lE.H4j(ba)}else Gb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}zEl(ba,Aa,Wa){this.Qb.ff(()=>{this.AEl(ba,Aa,Wa)})}AEl(ba,Aa,Wa){if(this.qzb()){var gb=this.vta(ba);if(gb){var nb=this.Jb.oe(15);try{nb.nc(gb);this.G9.cMb(gb);const Zc=Object($a.a)(1199,
gb);if(Zc){var lc=Zc.reactions,jd={DisplayName:this.userName,Email:void 0,FullName:this.userName,ProviderId:this.providerId,UserId:this.userId};if(Wa){let Sc;Sc=Ab(lc,jd);a:{ba=Sc;var xd;let ld={Time:new Date,User:jd};if(ba&&ba.ReactionList){for(const [Dg,De]of ba.ReactionList.entries())if(De.Type===Aa){null===(xd=ba.ReactionList[Dg].ReactionInstances)||void 0===xd?void 0:xd.push(ld);Sc=ba;break a}ba.ReactionList.push({Type:Aa,ReactionInstances:[ld]})}else ba={ReactionList:[{Type:Aa,ReactionInstances:[ld]}]};
Sc=ba}var Kc=Sc}else Kc=Ab(lc,jd);this.G9.Oal(gb,Kc)}else Gb.a.J(509215366,805,10,"CommentManager::updateCommentReactionsInternal - Failed to cast to comment node {0}",ba)}finally{null===nb||void 0===nb?void 0:nb.dispose()}}else Gb.a.J(509219337,805,10,"CommentManager::updateCommentReactionsInternal - Failed to find comment node {0}",ba)}else Gb.a.J(509613472,805,10,"CommentManager::updateCommentReactionsInternal - CommentContentNode is unavailable")}mHh(ba,Aa,Wa){if(this.qzb()){var gb=this.vta(ba);
if(gb){const nb=this.Jb.oe(15);try{nb.nc(gb),this.G9.cMb(gb),this.G9.Pal(gb,Aa),Object($a.a)(1199,gb).plb=Wa,this.isTasksHistoryEnabled&&this.G9.Hqh(gb,this.userName,this.userId,this.providerId)}finally{nb&&nb.dispose()}if(this.Kkg){Wa=this.qta(gb);if(!Wa){Gb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===Aa?this.lE.i5j(!!Wa.taskInfo):0===Aa&&this.lE.Z5j(!!Wa.taskInfo)}else 1===Aa&&this.lE.j5j();Gb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",
ba,Aa)}else Gb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",ba)}else Gb.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}$y(){return this.rta(this.kea)}rta(ba){const Aa=[];if(!ba||39!==ba.type)return Aa;ba=Nc.GraphIterator.nb(ba);for(var Wa=ba.Ii();Wa;){if(40===Wa.type){const gb=Object($a.a)(1199,Wa).uxa;Wa=this.qta(Wa);if(gb)for(const nb of Aa)nb.commentId===gb&&(nb.Children||(nb.Children=[]),nb.Children.push(Wa));
else Aa.push(Wa)}Wa=ba.lp()}return Aa}SGh(){const ba=this.ua.Ba;this.kea=ba?Nc.GraphIterator.nb(ba).Bb(16):null}Iaj(){if(!this.kea)return!1;const ba=Nc.GraphIterator.nb(this.kea);if(this.kB.Q0f(this.kea))return!0;let Aa=ba.Ii();for(;Aa;){if(this.kB.Q0f(Aa))return!0;Aa=ba.lp()}return!1}SYi(ba,Aa){return this.wWf(ba,Aa,!1)}dZi(ba,Aa){return this.wWf(ba,Aa,!0)}wWf(ba,Aa,Wa){if(!ba)return null;if(ba=ba.XD()){ba=this.Pb.Mc(ba);let gb=Wa?ba.p7b():ba.Ii();for(;gb;){if(!(this.kB.j0c(gb)||Aa&&0!==this.kB.qSc(gb)))return this.qta(gb);
gb=Wa?ba.Mta():ba.lp()}}return null}OPi(ba){return ba?(ba=ba.XD())?!!this.Pb.Mc(ba).Ii():!1:!1}rSc(ba){if(!ba)return 0;var Aa=ba.XD();ba=0;if(Aa){Aa=this.Pb.Mc(Aa);let Wa=Aa.Ii();for(;Wa;)this.kB.j0c(Wa)||ba++,Wa=Aa.lp()}return ba}qzb(){return!!this.kea&&this.kea.isConnected}c7i(ba,Aa){Aa=Nc.GraphIterator.nb(Aa);var Wa=Aa.Ii();const gb=new n.a;for(;Wa;){const nb=this.kB.oSc(Wa),lc=Object($a.a)(1199,Wa).uxa;ba!==nb&&ba!==lc||gb.add(Wa);Wa=Aa.lp()}return gb}vta(ba){const Aa=Nc.GraphIterator.nb(this.kea);
let Wa=Aa.Ii();for(;Wa;){const gb=this.kB.oSc(Wa);if(ba===gb)return Wa;Wa=Aa.lp()}return null}l$d(ba){ba=this.vta(ba);if(!ba)return null;const Aa=Object($a.a)(1199,ba).uxa;return Vb.a.Wa(Aa)?ba:this.vta(Aa)}qta(ba){if(Rb.a("GetCommentFromGraphNodeNullSafety")){var Aa=Object($a.a)(1199,ba);if(!Aa)return null;var Wa=new Ja;Wa.dt=Aa.U1b;Wa.text=Aa.csa;Wa.status=this.kB.qSc(ba);Wa.userId=Aa.MZb;Wa.commentId=this.kB.oSc(ba);Wa.authorName=Aa.authorName;Wa.providerId=Aa.pIc;Wa.anchorShape=Aa.G0b;Wa.pos=
Object.assign(new db.a,{X:Aa.Aca.X,Y:Aa.Aca.Y});Wa.taskInfo=Aa.taskInfo;Wa.textAnchoringInfo=Aa.textAnchoringInfo;this.C9b&&(Wa.changesData=Aa.changesData,Wa.isUnread=this.pR.instance&&this.pR.instance.Xhg(Aa));ad(this.Qb)&&(Wa.reactions=Aa.reactions);return Wa}if(ba){Aa=this.kB.oSc(ba);Wa=new Ja;const gb=Object($a.a)(1199,ba);if(gb){Wa.dt=gb.U1b;Wa.anchorShape=gb.G0b;const nb=gb.Aca;Wa.pos=Object.assign(new db.a,{X:nb.X,Y:nb.Y});Wa.text=gb.csa;Wa.authorName=gb.authorName;Wa.userId=gb.MZb;Wa.providerId=
gb.pIc;this.C9b&&(Wa.changesData=gb.changesData,Wa.isUnread=this.pR.instance&&this.pR.instance.Xhg(gb));ad(this.Qb)&&(Wa.reactions=gb.reactions)}Wa.status=this.kB.qSc(ba);Wa.commentId=Aa;Wa.taskInfo=Object($a.a)(1199,gb).taskInfo;Wa.textAnchoringInfo=Object($a.a)(1199,gb).textAnchoringInfo;return Wa}return null}C9a(ba){if(!ba)return[];const Aa=this.rta(ba.XD());if(!Aa||this.FDa&&!Aa.length){if(!Aa)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return Aa}Aa.sort((Wa,
gb)=>{var nb=this.ic.H$d(ba,Wa.anchorShape);nb=nb?nb.mD:new Ed.a(0,0);var lc=this.ic.H$d(ba,gb.anchorShape);lc=lc?lc.mD:new Ed.a(0,0);nb.y+=Wa.pos.Y;lc.y+=gb.pos.Y;nb.x+=Wa.pos.X;lc.x+=gb.pos.X;let jd=nb.y-lc.y;jd||(jd=nb.x-lc.x)||(jd=+Wa.dt-+gb.dt);return jd});return Aa}alj(ba){var Aa=this.ua.presentation;if(!Aa)return null;Aa=Aa.slides;if(!Aa)return null;for(const Wa of Aa)if(Aa=Object($a.a)(Hd.a,Wa))for(const gb of this.rta(Aa.XD())){if(ba===gb.commentId)return Wa;if(gb.Children)for(const nb of gb.Children)if(ba===
nb.commentId)return Wa}return null}Soe(){let ba=0,Aa=0;var Wa=this.ua.presentation;if(Wa){var gb=Wa.slides;if(gb){Wa=new n.a;for(const nb of gb)if((gb=Object($a.a)(Hd.a,nb))&&gb.XD())for(const lc of this.rta(gb.XD()))Hc.HN(lc)?Aa+=1:lc.textAnchoringInfo&&Wa.add(lc.commentId),ba+=1;this.lE.Soe(ba,Aa,Wa)}}}}Kd.Onh=!0;Object(h.a)(Kd,"CommentManager",null,[1200,1201,106]);var Pc=d(133);class tf{constructor(ba,Aa,Wa,gb){this.nO=ba;this.Kc=Aa;this.Fb=Wa;this.yc=gb}kkj(ba){if(null===ba)throw Error.argumentNull("comment");
if(ba=this.JRc(ba))if(ba=this.$k(ba))return ba.xa.xa;return null}w4i(ba){if(null===ba)throw Error.argumentNull("comment");if(ba=this.JRc(ba)){if(ba.ud){var Aa=this.yc.NN(ba);if(!Aa)return Gb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",ba.get_shapeId()),null;Aa=Aa.sc(this.Fb.Ma);return Aa&&Aa.htmlElement?Pc.a.fda(new Sys.UI.Bounds(Aa.htmlElement.clientLeft,Aa.htmlElement.clientTop,Aa.htmlElement.clientWidth,Aa.htmlElement.clientHeight)):(Gb.a.J(595133521,
805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",ba.get_shapeId()),null)}if(ba=this.$k(ba))return ba=ba.xa.xa,Pc.a.fda(new Sys.UI.Bounds(ba.clientLeft,ba.clientTop,ba.clientWidth,ba.clientHeight))}return null}JRc(ba){if(null===ba)throw Error.argumentNull("comment");if(!ba.anchorShape)return null;ba=this.nO.l$d(ba.commentId);ba=this.nO.qta(ba);if(!ba)return null;const Aa=this.Kc.Ic?this.Kc.Ic.Fd:null;return Aa?Aa.zC(ba.anchorShape):(Gb.a.J(557090388,805,50,"ActiveSlide is null"),
null)}x4i(ba){if(null===ba)throw Error.argumentNull("comment");if(!ba.anchorShape)return 0;if(ba=this.JRc(ba))if(ba=this.$k(ba))return ba.rotation;return 0}$k(ba){if(null===ba)throw Error.argumentNull("shapeNode");return Object($a.a)(117,ba.sc(this.Fb.Ma))}}Object(h.a)(tf,"CommentMarkerAnchorHelper",null,[1122]);var xe=d(583),ef=d(115);class Id{constructor(ba,Aa,Wa){this.N9=ba;this.Kc=Aa;this.wre=Wa}NPi(ba){const Aa=Object($a.a)(1199,this.wre.vta(ba.commentId));if(!Aa)throw r.ULS.sendTraceTag(595203538,
805,10,"There is no graph node for comment {0}",ba.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!Aa.Aca}lij(ba,Aa){if(!ba)throw Error.argumentNull("commentMarkerViewElement");if(!Aa)throw Error.argumentNull("comment");if(!this.wre.vta(Aa.commentId))return r.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",Aa.commentId),new Ed.a(0,Number.MIN_VALUE);const Wa=ba.fp;ba=ba.Ghd;if(!this.NPi(Aa)||!Aa.pos.X&&!Aa.pos.Y){if(Wa)return Aa=
new Ed.a(Wa.$b-Wa.hc-Id.Hnd.width-Id.Knh.width,Id.Knh.height),Id.ebg(Aa,Wa,ba),Aa;if(this.Kc.Ic&&this.Kc.Ic.MB)return new Ed.a(this.Kc.Ic.MB.clientWidth-Id.Hnd.width,0);r.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new Ed.a(0,0)}Aa=new Ed.a(this.N9.Pe(Aa.pos.X,0),this.N9.Pe(Aa.pos.Y,1));Aa=new Ed.a(Aa._x-Id.H_a._x,Aa._y-Id.H_a._y);Wa&&(Aa._x=Math.max(0,Aa._x),Aa._y=Math.max(0,Aa._y),Aa._x=
Math.min(Aa._x,Wa.$b-Wa.hc-Id.Hnd.width),Aa._y=Math.min(Aa._y,Wa.Yb-Wa.kc-Id.Hnd.height),Id.ebg(Aa,Wa,ba));return Aa}xEl(ba,Aa){var Wa=new Ed.a(ba.element.offsetLeft,ba.element.offsetTop);Wa=new Ed.a(Wa._x+Id.H_a._x,Wa._y+Id.H_a._y);const gb=ba.fp;gb&&ba.Ghd%360&&Id.lyf(Wa,0-ba.Ghd,gb.Vf());Aa.pos.X=this.N9.qf(Wa._x,0);Aa.pos.Y=this.N9.qf(Wa._y,1);this.wre.zGb(Aa.commentId,new Ed.a(Aa.pos.X,Aa.pos.Y))}static ebg(ba,Aa,Wa){if(Aa&&Wa%360){var gb=new Ed.a(ba._x+Id.H_a._x,ba._y+Id.H_a._y);Id.lyf(gb,Wa,
Aa.Vf());ba.update(gb._x-Id.H_a._x,gb._y-Id.H_a._y)}}static lyf(ba,Aa,Wa){ba.pM(0-Wa._x,0-Wa._y);Aa=xe.a.y_d(Aa);ba.update(ba._x*Math.cos(Aa)-ba._y*Math.sin(Aa)+Wa._x,ba._x*Math.sin(Aa)+ba._y*Math.cos(Aa)+Wa._y)}}Id.Hnd=new ef.a(20,20);Id.Knh=new ef.a(4,4);Id.H_a=new Ed.a(4,20);Object(h.a)(Id,"CommentMarkerPositionHelper",null,[1123]);var qe=d(135),jg=d(75),of=d(49);class Cb{constructor(ba,Aa){this.yIa=this.LHa=this.Uze=null;this.Hcc=ba;this.Mq=Aa}Dv(){return!0}Uu(ba){if(!ba)return!1;this.yIa=this.Hcc.element.style;
this.Uze=new Ed.a(ba.clientPoint.x,ba.clientPoint.y);this.LHa=new Ed.a(parseInt(this.yIa.left),parseInt(this.yIa.top));this.Gw(ba);return!0}Gw(ba){if(!ba)return!1;ba=this.M4f(new Ed.a(ba.clientPoint.x,ba.clientPoint.y),this.Uze);this.yIa.left=of.a.Pc(this.LHa._x+ba._x);this.yIa.top=of.a.Pc(this.LHa._y+ba._y);return!0}fo(ba){if(ba){ba=this.M4f(new Ed.a(ba.clientPoint.x,ba.clientPoint.y),this.Uze);var Aa=this.LHa._x+ba._x,Wa=this.LHa._y+ba._y,gb=this.Hcc.fp;gb&&(Aa=Math.max(gb.hc,Aa),Aa=Math.min(gb.$b-
this.Hcc.element.clientWidth,Aa),Wa=Math.max(gb.kc,Wa),Wa=Math.min(gb.Yb-this.Hcc.element.clientHeight,Wa),ba._x=Aa-this.LHa._x,ba._y=Wa-this.LHa._y);this.yIa.left=of.a.Pc(Aa);this.yIa.top=of.a.Pc(Wa);this.Hcc.D_g(ba)}}pu(){this.yIa.left=of.a.Pc(this.LHa._x);this.yIa.top=of.a.Pc(this.LHa._y)}M4f(ba,Aa){ba=Ed.a.fV(ba,Aa);return new Ed.a(this.Mq.Sm(ba.x),this.Mq.Sm(ba.y))}}Object(h.a)(Cb,"CommentMarkerDragAdapter",null,[244]);class Df{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd){this.R9=null;this.sWa=this.tWa=
!1;if(!Aa)throw Error.argumentNull("parentElement");this.vCb=xd;this.F9=ba;this.lq=Wa;this.$la=gb;this.LC=nb;this.y5c=jd;this.ym=document.createElement("div");this.ym.className=Hc.JPc(ba)?this.LC.SYg:this.LC.RYg;this.ym.title=ResourceStrings.L_CommentMarkerTooltip;this.ym.style.display=this.y5c||this.vCb?"none":"block";this.ym.setAttribute("data-pptcommentid",String.format("{0}",ba.commentId));this.iA=document.createElement("img");this.iA.alt=ResourceStrings.L_CommentMarkerTooltip;this.iA.src=Wa.frame.rk(Wa.frame.US+
".png");this.iA.setAttribute(qe.a.af,qe.a.Au);this.ym.appendChild(this.iA);this.z1a();this.frame.Zc.pb(mb.a.click,this.ym,Object(qa.a)(this,this.lC,"clickHandler"));Hc.NPc&&(qc.a.addHandler(this.ym,mb.a.mq,Object(qa.a)(this,this.Qwa,"mouseOverHandler")),qc.a.addHandler(this.ym,mb.a.Ns,Object(qa.a)(this,this.tjc,"mouseOutHandler")));Hc.JIc&&qc.a.addHandler(this.iA,mb.a.mouseDown,Object(qa.a)(this,this.Vmc,"preventNativeDragMouseDownHandler"));Aa.appendChild(this.ym);lc||this.pYd()}dispose(){this.iA&&
(Hc.JIc&&qc.a.removeHandler(this.iA,mb.a.mouseDown,Object(qa.a)(this,this.Vmc,"preventNativeDragMouseDownHandler")),this.frame.Zc.yb(mb.a.click,this.ym,Object(qa.a)(this,this.lC,"clickHandler")),this.iA.parentNode&&this.iA.parentNode.removeChild(this.iA),this.iA=null);this.ym&&(Hc.NPc&&(qc.a.removeHandler(this.ym,mb.a.mq,Object(qa.a)(this,this.Qwa,"mouseOverHandler")),qc.a.removeHandler(this.ym,mb.a.Ns,Object(qa.a)(this,this.tjc,"mouseOutHandler"))),this.$la&&(this.$la.OUd(),this.$la.aF(this.ym,this.R9)),
this.ym.parentNode&&this.ym.parentNode.removeChild(this.ym));this.lq=this.F9=null}get comment(){return this.F9}get element(){return this.ym}get frame(){return this.lq.frame}pYd(){this.$la&&(this.R9=new Cb(this,Tc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.$la.PJ(this.ym,this.R9))}updatePosition(ba){this.ym.style.left=of.a.Pc(ba._x-(this.lq.isRightToLeft?this.LC.sEe:0));this.ym.style.top=of.a.Pc(ba._y)}D_g(ba){this.lq.zGb(this.F9,ba)}select(ba){this.tWa=ba;this.z1a()}activate(ba){this.sWa=
ba;this.z1a()}xwh(){}setVisibility(ba){this.ym.style.display=ba&&!this.vCb?"block":"none"}z1a(){this.vCb||(this.iA.className=Hc.JPc(this.F9)?this.tWa?jg.getImageClassWithCluster(this.frame.US,this.LC.VYg):this.sWa?jg.getImageClassWithCluster(this.frame.US,this.LC.TYg):jg.getImageClassWithCluster(this.frame.US,this.LC.UYg):this.tWa?jg.getImageClassWithCluster(this.frame.US,this.LC.QYg):this.sWa?jg.getImageClassWithCluster(this.frame.US,this.LC.rEe):jg.getImageClassWithCluster(this.frame.US,this.LC.Yic))}get fp(){return null}get Ghd(){return 0}lC(ba){if(ba.uA!==
Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.F9,null,!1,!0,ba.Wf,1,!1);ba=ba.qc;ba.preventDefault();ba.stopPropagation();return!0}Qwa(){this.frame.drb(this.F9,1)}tjc(){this.frame.drb(null,1)}Vmc(ba){ba.preventDefault()}}Object(h.a)(Df,"LegacyCommentMarkerViewElement",null,[1212]);var Bf=d(97),qg=d(644);class vd{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc){this.R9=null;this.vyg=this.sWa=this.tWa=!1;if(!Aa)throw Error.argumentNull("parentElement");this.F9=ba;this.lq=Wa;this.$la=gb;
this.LC=nb;this.vGa=lc;this.b4c=jd;this.y5c=Kc;this.ym=document.createElement("div");this.ym.className=Hc.JPc(ba)?this.LC.SYg:this.LC.RYg;Sys.UI.DomElement.addCssClass(this.ym,"CommentMarker");this.ym.title=ResourceStrings.L_CommentMarkerTooltip;this.ym.style.display="none";this.ym.setAttribute("data-pptcommentid",String.format("{0}",ba.commentId));this.iA=document.createElement("img");this.iA.alt=ResourceStrings.L_CommentMarkerTooltip;this.iA.src=Wa.frame.rk(Wa.frame.US+".png");this.iA.setAttribute(qe.a.af,
qe.a.Au);this.ym.appendChild(this.iA);this.z1a();this.frame.Zc.pb(mb.a.click,this.ym,Object(qa.a)(this,this.lC,"clickHandler"));Hc.NPc&&(qc.a.addHandler(this.ym,mb.a.mq,Object(qa.a)(this,this.Qwa,"mouseOverHandler")),qc.a.addHandler(this.ym,mb.a.Ns,Object(qa.a)(this,this.tjc,"mouseOutHandler")));Hc.JIc&&qc.a.addHandler(this.iA,mb.a.mouseDown,Object(qa.a)(this,this.Vmc,"preventNativeDragMouseDownHandler"));Aa.appendChild(this.ym);xd||this.pYd()}dispose(){this.iA&&(Hc.JIc&&qc.a.removeHandler(this.iA,
mb.a.mouseDown,Object(qa.a)(this,this.Vmc,"preventNativeDragMouseDownHandler")),this.frame.Zc.yb(mb.a.click,this.ym,Object(qa.a)(this,this.lC,"clickHandler")),this.iA.parentNode&&this.iA.parentNode.removeChild(this.iA),this.iA=null);this.ym&&(Hc.NPc&&(qc.a.removeHandler(this.ym,mb.a.mq,Object(qa.a)(this,this.Qwa,"mouseOverHandler")),qc.a.removeHandler(this.ym,mb.a.Ns,Object(qa.a)(this,this.tjc,"mouseOutHandler"))),this.$la&&(this.$la.OUd(),this.$la.aF(this.ym,this.R9)),this.ym.parentNode&&this.ym.parentNode.removeChild(this.ym));
this.lq=this.F9=null}get comment(){return this.F9}get element(){return this.ym}get frame(){return this.lq.frame}pYd(){this.$la&&(this.R9=new Cb(this,Tc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.$la.PJ(this.ym,this.R9))}updatePosition(){const ba=this.b4c.lij(this,this.comment);this.ym.style.left=ba._x+"px";this.ym.style.top=ba._y+"px"}D_g(){this.b4c.xEl(this,this.comment)}select(ba){this.tWa=ba;this.z1a();this.onVisibilityChange()}activate(ba){this.sWa=ba;this.z1a();this.onVisibilityChange()}xwh(ba){this.vyg=
ba;this.z1a();this.onVisibilityChange()}setVisibility(ba){this.y5c=!ba;this.onVisibilityChange()}onVisibilityChange(){!this.y5c&&(this.tWa||this.sWa||this.vyg)?(this.updatePosition(this.frame.DCa(this.comment.pos.X,this.comment.pos.Y)),this.ym.style.display="block",Bf.a.BI(this.ym,qg.a.UKc)):(this.ym.style.display="none",Bf.a.tKa(this.ym,qg.a.UKc))}get fp(){return this.vGa.w4i(this.F9)}get Ghd(){return this.vGa.x4i(this.F9)}z1a(){this.iA.className=Hc.JPc(this.F9)?this.tWa?jg.getImageClassWithCluster(this.frame.US,
this.LC.VYg):this.sWa?jg.getImageClassWithCluster(this.frame.US,this.LC.TYg):jg.getImageClassWithCluster(this.frame.US,this.LC.UYg):this.tWa?jg.getImageClassWithCluster(this.frame.US,this.LC.QYg):this.sWa?jg.getImageClassWithCluster(this.frame.US,this.LC.rEe):jg.getImageClassWithCluster(this.frame.US,this.LC.Yic)}lC(ba){if(ba.uA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.F9,null,!1,!0,ba.Wf,1,!1);ba=ba.qc;ba.preventDefault();ba.stopPropagation();return!0}Qwa(){this.iA.className=
jg.getImageClassWithCluster(this.frame.US,this.LC.rEe)}tjc(){this.iA.className=jg.getImageClassWithCluster(this.frame.US,this.LC.Yic)}Vmc(ba){ba.preventDefault()}}Object(h.a)(vd,"ModernCommentMarkerViewElement",null,[1212]);class $f{constructor(ba,Aa,Wa,gb,nb,lc){this.vGa=ba;this.b4c=Aa;this.LC=Wa;this.Kdc=nb;this.vCb=lc;gb.kub().then(jd=>{jd||this.kXe(!1)})}dispose(){this.LC=null}create(ba,Aa,Wa,gb,nb,lc){if(this.Kdc){const jd=this.vGa.kkj(ba);return new vd(ba,jd||Aa,Wa,gb,this.LC,this.vGa,this.b4c,
nb,lc)}return new Df(ba,Aa,Wa,gb,this.LC,nb,lc,this.vCb)}kXe(ba){this.vCb=this.Kdc=ba;this.LC.kXe(ba)}}Object(h.a)($f,"CommentMarkerViewElementFactory",null,[1124,106]);var ng=d(78);class Qe extends ng.a{constructor(){super()}lci(ba){this.addHandler(Qe.qzh,ba)}h1g(){this.raiseEvent(Qe.qzh)}}Qe.qzh="S";Object(h.a)(Qe,"ATransactionCompletedProcessor",ng.a,[1209]);var Gf=d(40);class Jf extends Qe{constructor(ba,Aa,Wa){super();this.Hjk=ba;this.b6c=Aa;this.GX=Wa}get index(){return 0}run(){this.Hjk()}WHf(ba,
Aa){Aa.property!==xb.a.Aca&&Aa.property!==xb.a.csa&&Aa.property!==xb.a.commentId&&Aa.property!==xb.a.I0b&&Aa.property!==xb.a.J0b&&Aa.property!==xb.a.ptc&&Aa.property!==xb.a.otc&&Aa.property!==xb.a.reactions||this.h1g()}GHf(ba,Aa){Aa.property!==Gf.a.TA&&Aa.property!==xb.a.I0b||this.h1g()}WAj(){this.b6c.xd(39).kk(Object(qa.a)(this,this.GHf,"commentContentPropertyChanged"));this.b6c.xd(40).kk(Object(qa.a)(this,this.WHf,"commentPropertyChanged"));this.GX.kal(this)}uCl(){this.b6c.xd(40).Rm(Object(qa.a)(this,
this.WHf,"commentPropertyChanged"));this.b6c.xd(39).Rm(Object(qa.a)(this,this.GHf,"commentContentPropertyChanged"))}}Object(h.a)(Jf,"CommentPropertyTracker",Qe,[]);var xh=d(663),he=d(143);class de extends xh.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new he.a,{T_:de.getTypeName(),B_:de.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(h.a)(de,"CommentSmartReplySignal",
xh.a,[]);var xf=d(611);class re extends xf.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new he.a,{T_:re.getTypeName(),B_:re.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(h.a)(re,"SmartReply",xf.a,[]);var Ih=d(348),Le=d(379);class Cd{constructor(ba,Aa){this.VPh=ba;this.K8e=Aa}initialize(){this.K8e.execute(ba=>
{const Aa=re.getTypeName();ba.tia(Aa);ba.oKa(Aa,Object(qa.a)(this,this.u_,"handleAnnotationEvent"))})}invoke(ba,Aa){const Wa=Object.assign(new Ih.a,{parentPath:["Signal",de.getTypeName()],items:[Object.assign(new Le.a,{body:Object.assign(new de,{commentId:ba,comment:Aa})})]});this.K8e.execute(gb=>{gb.submitOperation(Wa)})}u_(ba){if(ba){var Aa=new n.a;if(ba&&ba.CommentId&&ba.ResultSets&&0<ba.ResultSets.length&&ba.ResultSets[0].Documents&&0<ba.ResultSets[0].Documents.length){for(const Wa of ba.ResultSets[0].Documents)Aa.add(Wa.Caption);
0<Aa.count&&this.VPh.HHk(ba.CommentId,Aa.toArray())}else Gb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else Gb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(h.a)(Cd,"CommentSmartReplyProvider",null,[]);var Lc=d(314),Td=d(288),Ge=d(282),Xc=d(98),jf=d(181),Mh=d(126),bd=d(63),Bc=d(437);class Hf{constructor(ba,Aa,Wa,gb,nb){this.zre=this.mse=this.Kse=this.l3c=0;this.evg=new n.a;this.aDe=this.svg=this.Bre=this.phc=this.vze=0;this.VAe=new n.a;this.Tpe=
this.Spe=this.Upe=this.Rpe=0;this.dtg=new n.a;this.Had=new n.a;this.kse=this.ise=this.jse=this.lse=this.Iwe=this.Hwe=this.Jwe=this.Kwe=0;this.o3c=this.Gve=this.e4c=Mb.App.Ym;this.jXa=null;this.WCe=this.XCe=this.Obd=this.lcd=this.V$c=this.Qpe=0;if(!ba)throw Error.argumentNull("coreEventHandler");if(!Aa)throw Error.argumentNull("appSettingsManager");this.Oc=ba;this.Qb=Aa;this.ua=Wa;this.kB=gb;this.ure=nb;this.Oc.iC(Object(qa.a)(this,this.Eo,"onSessionRehydrated"));this.Oc.LA(Object(qa.a)(this,this.GB,
"onSessionEnd"))}get JWd(){return this.Qb.ka("CommentTextAnchoringCreateNewEnabled")}get Dvl(){return this.Qb.ka("TasksForCommentsEnabled")}Poe(ba,Aa,Wa,gb){this.l3c+=1;this.zre+=Aa;Wa&&(this.Rpe+=1,this.VAe.add(ba));gb&&(this.Qpe+=1)}G2j(ba,Aa,Wa,gb){this.Obd=gb?this.Obd+1:this.Obd;this.Poe(ba,Aa,Wa,gb)}F2j(ba,Aa,Wa,gb,nb){(nb=!!nb)&&gb?this.XCe+=1:nb&&(this.WCe+=1);this.Poe(ba,Aa,Wa,nb)}L5j(){this.Upe+=1}I5j(){this.Spe+=1}J5j(){this.Tpe+=1}K5j(ba,Aa,Wa,gb){this.tkg(ba.commentId)||(Wa&&!this.oXj(Aa,
Wa.xC(),gb)?this.Wrg(ba,Wa,!0):this.Wrg(ba,Wa,!1))}STk(){this.mse+=1}z5j(){this.lse+=1}q3j(){this.jse+=1}p3j(){this.ise+=1}r3j(){this.kse+=1}v3j(){this.Kse+=1}H4j(ba){this.evg.contains(ba)||(this.vze+=1,this.evg.add(ba))}i5j(ba){this.V$c=ba?this.V$c+1:this.V$c;this.phc+=1}Z5j(ba){this.lcd=ba?this.lcd+1:this.lcd}j5j(){this.phc+=1}Soe(ba,Aa,Wa){this.Bre=ba;this.aDe=Aa;this.dtg=Wa;this.Frg()}m3j(ba){this.svg=ba?1:2}mtk(ba){this.e4c===Mb.App.Ym&&(this.e4c=new Date,this.cGa("OnCollabCornerCommentsEnabled",
this.e4c,ba),this.cVe("CollabCornerCommentsEnabled",this.e4c))}Iuk(ba){this.Gve===Mb.App.Ym&&(this.Gve=new Date,this.cGa("OnFloatingCommentsRendered",this.Gve,ba))}isk(ba){this.o3c===Mb.App.Ym&&(this.o3c=new Date,this.cGa("OnAllFloatingContainersVisible",this.o3c,ba),this.cVe("AllFloatingContainersVisible",this.o3c))}Ktk(ba){const Aa=new Date;this.cGa("OnDeepLinkedCommentSelected",Aa,ba);this.cVe("DeepLinkedCommentSelected",Aa)}tkg(ba){return this.dtg.contains(ba)||this.Had.contains(ba)}oXj(ba,Aa,
Wa){let gb=0;for(const lc of Aa)if(Aa=Object($a.a)(1035,lc.sc(Wa))){Aa=Aa.htmlElement.getElementsByClassName(Xc.a.Y1b);for(let jd=0;jd<Aa.length;jd++){var nb=Aa[jd];const xd=Lc.a.Be(nb,Xc.a.HWd);xd&&(gb+=kd.a.contains(xd,ba)?1:0);(nb=Lc.a.Be(nb,Xc.a.DWd))&&(gb+=kd.a.contains(nb,ba)?1:0);if(2===gb)return!0}}return!1}Wrg(ba,Aa,Wa){if(ba&&ba.textAnchoringInfo&&!this.tkg(ba.commentId))if(ba.textAnchoringInfo.EndPos<=ba.textAnchoringInfo.StartPos){if(Aa){if(Wa){this.Iwe+=1;this.Had.add(ba.commentId);return}this.Jwe+=
1}else this.Kwe+=1;this.Had.add(ba.commentId)}else 0>=ba.textAnchoringInfo.TextBodyLength&&(this.VAe.contains(ba.commentId)?this.VAe.remove(ba.commentId):(this.Hwe+=1,this.Had.add(ba.commentId)))}cGa(ba,Aa,Wa){const gb={};gb.Event=ba;gb.Time=Aa.getTime();gb.SlideId=Wa.toString();gb.LandingSlide=this.ycj();gb.SessionDimensions=this.y$d();gb.PerfMetrics=this.J4i();gb.CommentPerfMetrics=this.e7i();gb.CommentFileType=this.ure;gb.CommentDeepLinkedOpen=!!this.Qb.Ga("CurrentCommentId");gb.StandaloneCommentJsEnabled=
!0;gb.LoadSharedCommentsEarly=!0;gb.FetchFullAppSettingsOnBoot=this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",!1);gb.PrefetchCommentCloudPolicy=this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",!1);Gb.a.J(509703831,805,15,Db.c(gb))}Frg(){Gb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.Bre,this.ure);Gb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.aDe);Gb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",
this.JWd,this.Dvl)}log(){Gb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.l3c,this.Kse,this.mse,this.zre/this.l3c,this.vze,this.phc,this.Bre,this.ure,this.svg);Gb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.aDe,this.Rpe,this.Upe,
this.Spe,this.Tpe,this.Jwe,this.Hwe,this.Kwe,this.Iwe);Gb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.lse,this.jse,this.ise,this.kse);this.G5j()}G5j(){Gb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.Qpe);const ba={};ba.ResolvedTasksCount=this.V$c;ba.UnresolvedTasksCount=this.lcd;ba.TasksCreatedNewThreadCount=this.Obd;ba.TasksReassignedInReplyCount=this.XCe;ba.TasksCreatedInReplyCount=this.WCe;Gb.a.J(509703823,845,15,Db.c(ba))}Eo(){this.Frg()}GB(){this.log()}ycj(){if(this.jXa)return this.jXa;
this.jXa={};var ba=parseInt(this.Qb.Ga("CurrentSlideId"));ba=ba!==bd.a.empty.sid?bd.a.VE(ba,0):this.ua.presentation.m$a(0);if(!ba)return this.jXa;this.jXa.SlideId=ba.toString();if(ba=this.ua.presentation.Q$d(ba.sid))ba=Object($a.a)(116,ba).XD(),this.jXa.HasComments=this.kB.Mbg(ba),this.jXa.HasActiveComments=this.kB.Cbg(ba);return this.jXa}y$d(){const ba={};ba.Ring=e.AFrameworkApplication.gd.Ring;ba.Host=e.AFrameworkApplication.gd.Host;ba.UiHost=e.AFrameworkApplication.gd.UiHost;ba.SessionOrigin=e.AFrameworkApplication.gd.SessionOrigin;
ba.ApplicationMode=e.AFrameworkApplication.gd.ApplicationMode;ba.Browser=e.AFrameworkApplication.gd.Browser;ba.Os=e.AFrameworkApplication.gd.Os;return ba}J4i(){const ba={};ba[Td.a.MPb]=ec.a.instance.ih(Td.a.MPb);ba.DocPageNavigationStart=ec.a.instance.ih("DocPageNavigationStart");ba[Td.a.$4b]=ec.a.instance.ih(Td.a.$4b);ba[Bc.a.MSe]=ec.a.instance.ih(Bc.a.MSe);ba[Bc.a.LSe]=ec.a.instance.ih(Bc.a.LSe);ba[Bc.a.wlh]=ec.a.instance.ih(Bc.a.wlh);ba[Bc.a.U2d]=ec.a.instance.ih(Bc.a.U2d);ba[Bc.a.V2d]=ec.a.instance.ih(Bc.a.V2d);
ba[Bc.a.T2d]=ec.a.instance.ih(Bc.a.T2d);ba[Bc.a.CVd]=ec.a.instance.ih(Bc.a.CVd);ba[Td.a.iwd]=0<Ge.a.instance.Qgh();return ba}e7i(){const ba={};ba[bc.a.GWd]=ec.a.instance.ih(bc.a.GWd);ba[bc.a.LWd]=ec.a.instance.ih(bc.a.LWd);ba[bc.a.T8b]=ec.a.instance.ih(bc.a.T8b);ba[bc.a.Eee]=ec.a.instance.ih(bc.a.Eee);ba[bc.a.PXe]=ec.a.instance.ih(bc.a.PXe);ba[bc.a.k9b]=ec.a.instance.ih(bc.a.k9b);ba[bc.a.Fee]=ec.a.instance.ih(bc.a.Fee);ba[bc.a.Boe]=ec.a.instance.ih(bc.a.Boe);ba[bc.a.F4d]=ec.a.instance.ih(bc.a.F4d);
ba[bc.a.G4d]=ec.a.instance.ih(bc.a.G4d);ba[bc.a.xqd]=ec.a.instance.ih(bc.a.xqd);ba[bc.a.KYd]=ec.a.instance.ih(bc.a.KYd);ba[bc.a.JYd]=ec.a.instance.ih(bc.a.JYd);return ba}ckj(){const ba=ec.a.instance.ih("DocPageNavigationStart");if(!ec.a.instance.ih(Td.a.MPb))return ba;const Aa=ec.a.instance.ih(Td.a.MPb);return 6E4>ba-Aa?Aa:ba}cVe(ba,Aa){const Wa=[];Array.add(Wa,Object.assign(new Mh.a,{name:"EventName",string:ba}));Xb.a.sendActivityEvent(Object.assign(new jf.a,{name:"CommentsBootEvents",durationMs:Aa.getTime()-
this.ckj(),dataFields:Wa}))}}Object(h.a)(Hf,"CommentTelemetryManager",null,[1197]);var Me=d(689),Tf=d(690),Sd=d(691);class lf extends Me.a{constructor(ba,Aa){super();this.Sak=ba;this.Di=Aa;this.gwe=[new Tf.a(Xc.a.JHf,null),new Tf.a(Xc.a.KHf,null),new Tf.a(Xc.a.LHf,null),new Tf.a(Xc.a.OHf,null),new Tf.a(Xc.a.SHf,null),new Tf.a(Xc.a.THf,null),new Tf.a(Xc.a.RHf,null),new Tf.a(Xc.a.MHf,null),new Tf.a(Xc.a.NHf,null),new Tf.a(Xc.a.PHf,null),new Tf.a(Xc.a.QHf,null)]}get isInHighContrastMode(){return!!this.Di&&
this.Di.isInHighContrastMode}get pyb(){return this.Sak}get pde(){return this.gwe}Jkc(ba,Aa){var Wa=this.w_.vja;if(Wa&&0===Wa.type&&(Wa=this.w_.vja.Ada,Wa=Object(v.a)(Array,Wa)?Wa:null)){var gb=null,nb=null,lc=new Ua.a;for(const jd of Wa)jd.Flc.isValid&&Array.contains(jd.Flc.paragraphs,ba)&&(0===jd.state?gb=jd.commentId:1===jd.state&&(nb=jd.commentId),lc.$(jd.commentId,jd.Flc));this.Afi(Aa.querySelectorAll("*"),lc,ba,gb,nb)}}p9b(ba,Aa){ba=Object(v.a)(Array,ba)?Array.isArray(ba)?ba:null:null;if(!ba||
0<ba.length&&!Object($a.a)(ae,ba[0]))return Aa;for(const Wa of ba)if(Wa.Flc.isValid)for(const gb of Wa.Flc.paragraphs)gb&&(Sd.b(gb),Aa.add(gb));return Aa}NWi(ba,Aa){ba=ba.SLa;const Wa=Aa?lf.u8j:lf.v8j;Aa=Vc.a.H0f(ba,Aa?lf.kck:lf.lck);ba=Vc.a.H0f(ba,Wa);return Aa<ba}Afi(ba,Aa,Wa,gb,nb){const lc=new ra.a,jd=new ra.a;for(let Zc=0;Zc<ba.length;Zc++){const Sc=ba[Zc];this.Ild(Sc);if(!Sc.parentNode)continue;var xd=Lc.a.Be(Sc,Xc.a.HWd),Kc=Lc.a.Be(Sc,Xc.a.DWd);const ld=[!1,!1,!1];if(xd)for(const Dg of xd)if(Aa.Gb(Dg)){xd=
Aa.ga(Dg).Z1f(Wa);if(Aa.ga(Dg).Obg||(2===xd||0===xd)&&!this.isInHighContrastMode&&this.NWi(Aa.ga(Dg),Dg===nb))Aa.ga(Dg).Obg=!0,lc.add(Dg);jd.add(Dg);this.TOf(Aa,Wa,Dg,gb,nb,ld,!0)}if(Kc)for(const Dg of Kc)jd.contains(Dg)&&(jd.remove(Dg),lc.remove(Dg),this.TOf(Aa,Wa,Dg,gb,nb,ld,!1));if(0!==Sd.a(Sc)){Kc=(xd=0<lc.count)&&!!nb&&lc.contains(nb);const Dg=!!gb&&jd.contains(gb),De=!!nb&&jd.contains(nb);0<jd.count&&!this.isInHighContrastMode&&0<=Sc.parentNode.className.indexOf(Xc.a.TLa)&&(Bf.a.BI(Sc.parentNode,
Xc.a.JHf),De?Bf.a.BI(Sc.parentNode,Kc?Xc.a.NHf:Xc.a.MHf):Dg?(Bf.a.BI(Sc.parentNode,Xc.a.KHf),xd=Sc.parentNode.className.match(new RegExp("\\b"+Xc.a.hdg+"\\b")),(!xd||1>xd.length)&&Bf.a.BI(Sc.parentNode,Xc.a.LHf)):Bf.a.BI(Sc.parentNode,xd?Xc.a.THf:Xc.a.SHf));ld[1]?Bf.a.BI(Sc,Kc?Xc.a.QHf:Xc.a.PHf):ld[0]?Bf.a.BI(Sc,Xc.a.OHf):ld[2]&&Bf.a.BI(Sc,Xc.a.RHf)}}}TOf(ba,Aa,Wa,gb,nb,lc,jd){ba=ba.ga(Wa).Z1f(Aa);if(2===ba||(jd?0===ba:1===ba))gb&&gb.equals(Wa)&&(lc[0]=!0),nb&&nb.equals(Wa)&&(lc[1]=!0),lc[2]=!0}}
lf.lck="#F5E7F6";lf.v8j="#503355";lf.kck="#F2E1F4";lf.u8j="#4C3050";Object(h.a)(lf,"CommentTextAnchorHighlightActor",Me.a,[]);class fb{constructor(ba){let Aa;this.jXh=20;Aa=ba?ba="SharedCommentBubble":ba="SharedCommentBubbleSelected";this.eXh=this.qSa("SharedCommentBubble");this.dXh=this.qSa("SharedCommentBubbleHover");this.Vif=this.qSa(ba);this.iXh=this.qSa("SharedCommentBubble");this.hXh=this.qSa("SharedCommentBubbleHover");this.Wif=this.qSa(Aa);this.fXh="ModernCommentMarkerElementSingle cui-img-cont-float";
this.gXh="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get RYg(){return this.fXh}get SYg(){return this.gXh}get sEe(){return this.jXh}get Yic(){return this.eXh}get rEe(){return this.dXh}get QYg(){return this.Vif}get UYg(){return this.iXh}get TYg(){return this.hXh}get VYg(){return this.Wif}kXe(ba){const Aa=ba?this.Yic:"SharedCommentBubbleSelected";ba=ba?this.Yic:Aa;this.Vif=this.qSa(Aa);this.Wif=this.qSa(ba)}qSa(ba){return String.format("{0}_{1}x{2}x32",ba,this.sEe,this.sEe)}}Object(h.a)(fb,
"CommentViewHelper",null,[]);class Qb{constructor(ba,Aa,Wa,gb,nb,lc){this.Oc=ba;this.ua=Aa;this.zb=Wa;this.jRg=gb;this.kb=lc;this.jRg.wF(Object(qa.a)(this,this.Lgd,"onSlideOrderChanged"));this.Oc.V9h(Object(qa.a)(this,this.o3g,"onCommentsChanged"))}dispose(){this.Oc.yZk(Object(qa.a)(this,this.o3g,"onCommentsChanged"));this.jRg.bP(Object(qa.a)(this,this.Lgd,"onSlideOrderChanged"))}o3g(){const ba=this.ua.Ba;E.a.prb(this.zb,()=>{this.YHk(ba)})}Lgd(ba,Aa){if(2===Aa.VZ){const Wa=this.ua.Ba;E.a.prb(this.zb,
()=>{this.nbh(Wa)})}}nbh(ba){this.ua.Ba===ba&&ba&&this.kb.E1a(!0)}YHk(ba){this.nbh(ba)}}Object(h.a)(Qb,"CommentsChangeListener",null,[106]);var ac=d(141),Jc=d(279),pd=d(173);class qd{static JCa(ba,Aa,Wa,gb,nb,lc,jd){const xd=of.a.SA();xd.alt=lc;xd.className=jg.getImageClassWithCluster(Aa,nb);xd.setAttribute(qe.a.af,qe.a.Au);xd.src=ba.rk(Aa+".png");xd.setAttribute("Unselectable","on");ba=of.a.Sn();ba.className=Wa+" cui-img-cont-float";ba.setAttribute(qe.a.af,qe.a.Au);ba.appendChild(xd);Wa=of.a.Sn();
Wa.className=gb;Wa.setAttribute("Unselectable","on");Wa.setAttribute(qe.a.af,qe.a.Au);Wa.appendChild(ba);gb=of.a.Eca();gb.className=qd.T5k+" cui-ctl";gb.title=lc;gb.setAttribute(qe.a.af,qe.a.Au);gb.setAttribute(qe.a.ns,lc);gb.appendChild(Wa);jd&&(lc=of.a.Sn(),lc.className="cui-ctl-mediumlabel",lc.setAttribute("Unselectable","on"),lc.setAttribute(qe.a.af,qe.a.Au),lc.innerText=jd,gb.appendChild(lc));return gb}static KCa(ba,Aa){return qd.JCa(ba,ba.US,"cui-img-16by16","cui-ctl-iconContainer",Aa,CommonUIStrings.l_DialogClose,
null)}}qd.R5k="CommentPaneLTR";qd.S5k="CommentPaneRTL";qd.T5k="CommentPaneWithBorderButton";qd.g6k=300;Object(h.a)(qd,"CommentPaneHelper",null,[]);var sd=d(48);class ze{constructor(ba,Aa,Wa,gb,nb){this.lec=this.fIa=null;new Jc.a(0,0,0,0);this.TWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.gvg=null;this.bvh=!1;this.tH=nb;this.nJ=ba;this.Rb=Aa;this.tH||(this.fIa=document.createElement("div"),this.fIa.className="CommentPanel",this.fIa.style.position=
"absolute");this.Eb=!1;this.yO=Wa;this.TVg=gb}dispose(){}layout(ba,Aa){if(this.TWa)return ba;if(null===ba)throw Error.argumentNull("availableArea");const Wa=Aa?ba.oD(this.width):ba.pD(this.width);this.isVisible&&(Aa?Wa.oD(1):Wa.pD(1));this.tH||of.a.z1(this.fIa,Wa);return ba}Cde(ba){this.lec=ba}Qal(ba){this.gvg=ba}Ap(ba,Aa){this.Eb=ba;this.TWa?this.tH?this.IM(this.Eb):this.TVg.IM(this,this.Eb,ResourceStrings.L_Comments,sd.a.Kp):(this.Rb.Kgb(this.yO&&Aa?1:2),this.nJ.updateCommandUI())}IM(ba){ac.UISurfaces.zr().then(Aa=>
{ba?Aa.showTaskPane(sd.a.Kp,this.gvg):Aa.hideTaskPane(sd.a.Kp,2);return null}).catch(Aa=>{Gb.a.J(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",Aa.toString(),ba.toString())})}UUe(){ac.UISurfaces.zr().then(ba=>{ba.setSelectedTaskPane(sd.a.Kp);return null}).catch(ba=>{Gb.a.J(572339909,833,10,"CommentsPane::SelectPane exception: {0}",ba.toString())})}w8k(){try{this.tH?this.UUe():this.TVg.UUe(sd.a.Kp)}catch(ba){Gb.a.J(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",
ba)}}Kgb(ba){this.Rb.Kgb(this.yO&&ba?1:2)}get isVisible(){return this.Eb}get xa(){return this.fIa}get order(){return 18}get width(){return this.isVisible?qd.g6k+1:0}}Object(h.a)(ze,"CommentsPane",null,[1129,552,106,1192]);class Wd{constructor(){this.t_a=this.BLa=0;this.Uc=this.Y_a=this.hja=null}}Object(h.a)(Wd,"FindCommentContext",null,[]);var ye;(function(ba){ba[ba.findNextComment=0]="findNextComment";ba[ba.findPreviousComment=1]="findPreviousComment";ba[ba.findNextActiveComment=2]="findNextActiveComment";
ba[ba.findPreviousActiveComment=3]="findPreviousActiveComment"})(ye||(ye={}));Object(h.b)("FindCommentRequestType",ye);class Yc{constructor(ba,Aa,Wa,gb,nb,lc){this.oc=ba;this.ua=Aa;this.zve=Wa;this.nO=gb;this.LCg=nb;this.Bd=new Wd;this.g$j=lc}get zCa(){return this.g$j.value}dispose(){this.zve.dispose();this.Bd=this.zve=null}h4d(ba,Aa,Wa){this.d4d(0,!1,ba,Aa,Wa)}o4d(ba,Aa,Wa){this.d4d(1,!1,ba,Aa,Wa)}i4d(ba,Aa){this.d4d(0,!0,ba,Aa,!1)}d4d(ba,Aa,Wa,gb,nb){var lc=this.ua.presentation;if(!lc)throw Error.argumentNull("Presentation is null");
gb||(gb=Re.a.zk("FindComment",0),gb.Va("FindCommentRequestType",ye[ba]));gb.Va(Yc.WTd,"true");if(this.LCg&&this.ua.Ba){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const jd=this.ua.Ba.me;lc=lc.slides||[];this.Bd.hja=Wa;this.Bd.t_a=Yc.V$i(ba,nb);this.Bd.Uc=gb;Aa?this.e4d(lc[jd>=lc.length-1?0:jd+1]):1===ba?this.LWf(lc,jd-1,nb):this.IWf(lc,jd+1,nb)}else gb.Va(Yc.Tni,this.LCg.toString()),Wa(null,null,!1,!1)}IWf(ba,Aa,Wa){this.Bd.Y_a=null;this.Bd.BLa=Aa;for(let gb=Aa;gb<ba.length;gb++)if(ba[gb]&&
this.ong(ba[gb])){const nb=this.$$i(ba[gb],Wa);if(nb){this.Bd.hja(ba[gb],nb,!1,!1);return}}else{this.e4d(ba[gb]);return}0<Aa?this.gZi(Wa):this.notFound()}LWf(ba,Aa,Wa){this.Bd.Y_a=null;this.Bd.BLa=Aa;for(let gb=Aa;-1<gb;gb--)if(ba[gb]&&this.ong(ba[gb])){const nb=this.Ecj(ba[gb],Wa);if(nb){this.Bd.hja(ba[gb],nb,!1,!1);return}}else{this.e4d(ba[gb]);return}Aa<ba.length-1?this.oZi(Wa):this.notFound()}e4d(ba){this.Bd.Uc.Zm(Yc.zoi,new Date);ba&&this.zve.find(ba.Cb,this.Bd.t_a,Object(qa.a)(this,this.Xyk,
"onServerFindSucceeded"),Object(qa.a)(this,this.Wyk,"onServerFindFailed"))}Xyk(ba){this.Bd.Uc.SB(Yc.WTd,"false");this.Bd.Uc.Zm(Yc.MCf,new Date);this.Bd.Uc.Va(Yc.uCf,"true");ba?(this.Bd.Y_a=ba,-1===this.G6b(this.Bd.Y_a.TargetSlideId)?this.notFound():this.Bd.hja(this.Axl(this.Bd.Y_a.TargetSlideId),this.Bd.Y_a.TargetComment,this.Bd.Y_a.IsFirstComment,this.Bd.Y_a.IsLastComment)):this.notFound()}Wyk(){this.Bd.Uc.SB(Yc.WTd,"false");this.Bd.Uc.Zm(Yc.MCf,new Date);this.Bd.Uc.Va(Yc.uCf,"false");Gb.a.J(512496786,
805,50,"OnServerFindFailed");this.notFound()}gZi(ba){var Aa=this.ua.presentation;if(!Aa)throw Error.argumentNull("Presentation is null");Aa=Aa.slides||[];kd.a.Wa(Aa)?this.notFound():this.IWf(Aa,0,ba)}oZi(ba){var Aa=this.ua.presentation;if(!Aa)throw Error.argumentNull("Presentation is null");Aa=Aa.slides||[];kd.a.Wa(Aa)?this.notFound():this.LWf(Aa,Aa.length-1,ba)}$$i(ba,Aa){ba=this.oc.zl(ba.Cb);if(this.zCa){const Wa=(ba=this.nO.C9a(ba))?ba.length:0;for(let gb=0;gb<Wa;gb++){const nb=ba[gb];if(Yc.Bog(nb,
Aa))return nb}return null}return this.nO.SYi(ba,Aa)}Ecj(ba,Aa){ba=this.oc.zl(ba.Cb);if(this.zCa){var Wa=(ba=this.nO.C9a(ba))?ba.length:0;for(--Wa;0<=Wa;Wa--){const gb=ba[Wa];if(Yc.Bog(gb,Aa))return gb}return null}return this.nO.dZi(ba,Aa)}ong(ba){return ba.eE}G6b(ba){var Aa=this.ua.presentation;if(!Aa)throw Error.argumentNull("Presentation is null");if(ba){Aa=Aa.slides||[];ba=new bd.a(ba);for(let Wa=0;Wa<Aa.length;Wa++)if(Aa[Wa]&&bd.a.M0b(Aa[Wa].Cb,ba))return Wa}return-1}Axl(ba){return ba?this.oc.pka(new bd.a(ba)):
null}notFound(){this.Bd.hja&&this.Bd.hja(null,null,!1,!1)}static V$i(ba,Aa){if(Aa)switch(ba){case 0:return 2;case 1:return 3}return ba}static Bog(ba,Aa){return!Aa||0===ba.status}}Yc.WTd="IsCompletedSearchInClient";Yc.zoi="ServerSearchStartTime";Yc.MCf="ServerSearchEndTime";Yc.uCf="IsServerSearchSucceeded";Yc.Tni="IsBRSOn";Object(h.a)(Yc,"FindCommentLogic",null,[1127,106]);var Ae=d(82);class hd{constructor(){this.type=0;this.hja=this.Uc=null;this.COd=!1}}Object(h.a)(hd,"Entry",null,[]);class oe{constructor(ba,
Aa){this.m5c=null;this.Rp=ba;this.zb=Aa;this.Jma=[];this.oze=0}dispose(){this.Rp.dispose();this.Jma=this.Rp=null;Gb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.oze)}h4d(ba,Aa,Wa){this.enqueue(1,ba,Aa,Wa)}o4d(ba,Aa,Wa){this.enqueue(0,ba,Aa,Wa)}i4d(ba,Aa){this.enqueue(2,ba,Aa,!1)}enqueue(ba,Aa,Wa,gb){Wa.Va("AlreadyQueuedEntryCount",this.Jma.length.toString());ba=Object.assign(new hd,{type:ba,hja:(nb,lc,jd,xd)=>{Aa(nb,lc,jd,xd);this.m5c=null;this.W$g()},Uc:Wa,COd:gb});Array.enqueue(this.Jma,ba);
this.oze=Math.max(this.oze,this.Jma.length);this.W$g()}W$g(){0<this.Jma.length&&!this.m5c&&(this.m5c=new Ae.a(2,1,0,Object(qa.a)(this,this.SLk,"processOneEntry"),90,"49"),this.zb.Db(this.m5c))}SLk(){const ba=Array.dequeue(this.Jma);1===ba.type?this.Rp.h4d(ba.hja,ba.Uc,ba.COd):0===ba.type?this.Rp.o4d(ba.hja,ba.Uc,ba.COd):this.Rp.i4d(ba.hja,ba.Uc)}}Object(h.a)(oe,"FindCommentLogicDecorator",null,[1127,106]);var Xe=d(389),Ke=d(110);class me extends Ke.a{constructor(ba,Aa){super();this.StartSlideId=null;
this.RequestType=0;this.FFindModernComments=!1;if(null===ba)throw Error.argumentNull("slideId");this.RequestType=Aa;this.StartSlideId=ba.toString();this.FFindModernComments=!0}Zk(){return 88}}Object(h.a)(me,"FindCommentRequest",Ke.a,[]);class Uf extends Xe.a{constructor(ba){super();this.zwa=null;this.sSg=0;this.BIa=this.OGa=null;this.enabled=2;this.fEb=0;this.Hk=!1;this.Mm=ba;this.Mm.register(this)}dispose(){this.Hk||(1===this._state&&this.Mm.unregister(this),this.Hk=!0,this.fEb=0)}find(ba,Aa,Wa,
gb){0<this.fEb&&null!==Wa&&(Gb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.fEb),Wa(null));this.zwa=ba;this.sSg=Aa;this.DF(Wa,gb,null)}zka(){return 0<this.fEb&&!this.Hk}QN(){return!1}NTa(){return this.Emg||this.zka()}FKb(){if(1===this._state)this.Vd.JH=new me(this.zwa,this.sSg),this.Vd.status=1,this._state=3;else if(3===this._state&&this.Emg)if(Gb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.Vd.Amd,this.Vd.Zt,
this.Vd.qv),2===this.Vd.statusCode&&this.Vd.Qr&&1===this.Vd.Qr.length){const ba=this.Vd.Qr[0];0!==ba.StatusCode?this.DH(ba):this.V0(ba)}else this.DH()}DF(ba,Aa){this.fEb++;this.BIa=ba;this.OGa=Aa;this.Mm.zaa()}forceOutbound(){}DH(ba=null){Gb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.Vd.Av,this.Vd.statusCode,ba?ba.StatusCode:-1);this.R4g(ba,!1)}V0(ba){this.R4g(ba,!0)}get Emg(){return!!this.Vd&&2===
this.Vd.status}R4g(ba,Aa){this.fEb--;this._state=1;if(Aa){Aa=null;try{Aa=Sys.Serialization.JavaScriptSerializer.deserialize(ba.FindCommentResult)}catch(Wa){Gb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",Wa)}this.BIa(Aa)}else this.OGa(null,-1)}}Object(h.a)(Uf,"FindCommentReplicator",Xe.a,[106]);class yf{constructor(){this.Ts=null;this.rwc=this.bmf=this.J8e=this.VEc=this.zrf=this.Xjf=this.knf=!1}Ikj(){this.Ts||(r.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.ysh());return this.Ts}mej(){return new Promise((ba,Aa)=>{this.rwc?ba(this.G4f()):this.tqh().then(()=>{ba(this.G4f())}).catch(Wa=>{Aa(Wa)})})}G4f(){this.rwc||r.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ba;ba=33;this.J8e&&(ba|=2);this.knf&&(ba|=8);this.zrf&&(ba|=16);this.Xjf&&(ba|=4);this.VEc&&(ba|=64);this.bmf&&(ba|=128);return ba}}Object(h.a)(yf,"OfficeSharedCommentsAppCapabilities",
null,[1544]);class Cf extends yf{constructor(ba,Aa,Wa,gb,nb,lc){super();this.Qb=ba;this.Ha=Aa;this.rJg=Wa;this.e9c=lc;this.Efl(gb,nb);this.ysh();this.tqh()}Efl(ba,Aa){this.VEc=this.Qb.ka("TasksForCommentsEnabled")&&!ba;this.zrf=!1;this.knf=Aa;this.bmf=this.Xjf=!0}ysh(){this.Ts={};const ba=this.VEc&&this.Ha.gXj;this.Ts.CommentsFluentUI="true";this.Ts.CommentsFluentUIV2="true";this.Ts.CommentTasks=this.VEc.toString();Rb.a("DeprecateIE.SharedCommentAppCapabilities")?this.Ts.DisabledChangeGates=this.Qb.Ga("DisabledChangeGatesInSharedComments"):
this.Ts.DisabledChangeGates=Wb.a.Gj?"WebThemeIntegrationHighContrastFixes,":""+this.Qb.Ga("DisabledChangeGatesInSharedComments");this.Ts.DiscreteHostedComments="true";this.Ts.CommentReactions=ad(this.Qb).toString();this.Ts.NewCommentButton="true";this.Ts.PersonaColor="true";this.Ts.LivePersonaPicker="true";this.Ts.AtMentionFloodgateSurvey=e.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.Ts.CommentTasksFromReply=ba.toString();this.Ts.LogDraftCommentIdPair=this.e9c.toString();
this.Ts.HyperlinksInComments="true";this.Ts.SmartReplies=this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.Ts.NewModelState="true";this.Ts.TaskPaneWithNewInfrastructure=this.Ha.MWd.toString();this.Ts.NewSelectionInteractions="true";this.Ts.ExtendedDrafting="true";this.Ts.LinkToComment="true";this.Ts.PersonaIconImageForWeb="true";this.Ts.NoDiscardOnFocusLoss="true";this.Ts.WebThemeIntegration="true";this.Ts.TaskHistoryRecordIDs=this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1).toString()}tqh(){return new Promise((ba,Aa)=>{this.rJg?this.rJg.atMentionsEnabledAsync().then(Wa=>{this.J8e=Wa;this.rwc=!0;ba(this.rwc)}):(r.ULS.sendTraceTag(509645712,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Aa(E.a.Ys(-2130915320)))})}}Object(h.a)(Cf,"PPTSharedCommentAppCapabilities",yf,[]);class Ld{constructor(ba){this.Ag=ba}display(ba,Aa){this.Ag.X4e(ba?0:2,Aa);this.Ag.setVisibility()}dismiss(){this.Ag.eui();
this.Ag.setVisibility()}activate(){this.Ag.X4e(1);this.Ag.setVisibility()}BOi(ba){this.Ag.X4e(ba?0:2)}Jm(ba){this.Ag.Jm(ba)}lD(ba){this.Ag.lD(ba)}Zp(){return this.Ag.Zp()}PN(ba){return this.Ag.mzb(ba)}Ox(ba){this.Ag.Ox(ba)}dispose(){this.Ag.dispose()}Xy(){this.Ag.Xy()}bE(ba){return this.Ag.bE(ba)}JB(ba){return this.Ag.JB(ba)}draw(ba,Aa){this.Ag.draw(ba,Aa)}get visible(){return this.Ag.visible}set visible(ba){this.Ag.visible=ba}setPosition(ba,Aa){this.Ag.setPosition(ba,Aa)}Kj(ba){this.Ag.Kj(ba)}Qq(ba){this.Ag.Qq(ba)}Yu(ba){this.Ag.Yu(ba)}setZIndex(ba){this.Ag.setZIndex(ba)}OE(ba,
Aa){this.Ag.OE(ba,Aa)}setSelection(){}}Object(h.a)(Ld,"ShapeCommentsAnchoredSelectionView",null,[1195,435,436,106]);class od{constructor(ba,Aa){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ba;this.canvasContextId=Aa}}Object(h.a)(od,"CommentUIAction",null,[]);var ug=d(65),Kf=d(651),Vf=d(121),Ch=d(180),xg=d(1125),lh=d(534);class Oi{constructor(){this.draftId=null;
this.insertIndex=0;this.anchorHintText=null}}Object(h.a)(Oi,"CurrentContextDraft",null,[]);class ph{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(h.a)(ph,"IContentAnchorPosition",null,[]);class Dh{constructor(){this.y=this.x=this.height=this.width=0}}Object(h.a)(Dh,"IViewportInfo",null,[]);class mh{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=
this.paneOpenedCallback=this.paneClosedCallback=null}}Object(h.a)(mh,"FloatingContainerManagerCreationParams",null,[]);var Od=d(140),Ue=d(53),yh=d(827),Hj=d(418),fe=d(385),Zh=d(906),Pi;(function(ba){ba[ba.line=0]="line";ba[ba.lineInv=1]="lineInv";ba[ba.triangle=2]="triangle";ba[ba.rtTriangle=3]="rtTriangle";ba[ba.rect=4]="rect";ba[ba.diamond=5]="diamond";ba[ba.parallelogram=6]="parallelogram";ba[ba.trapezoid=7]="trapezoid";ba[ba.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";ba[ba.pentagon=9]="pentagon";
ba[ba.hexagon=10]="hexagon";ba[ba.heptagon=11]="heptagon";ba[ba.octagon=12]="octagon";ba[ba.decagon=13]="decagon";ba[ba.dodecagon=14]="dodecagon";ba[ba.star4=15]="star4";ba[ba.star5=16]="star5";ba[ba.star6=17]="star6";ba[ba.star7=18]="star7";ba[ba.star8=19]="star8";ba[ba.star10=20]="star10";ba[ba.star12=21]="star12";ba[ba.star16=22]="star16";ba[ba.star24=23]="star24";ba[ba.star32=24]="star32";ba[ba.roundRect=25]="roundRect";ba[ba.round1Rect=26]="round1Rect";ba[ba.round2SameRect=27]="round2SameRect";
ba[ba.round2DiagRect=28]="round2DiagRect";ba[ba.snipRoundRect=29]="snipRoundRect";ba[ba.snip1Rect=30]="snip1Rect";ba[ba.snip2SameRect=31]="snip2SameRect";ba[ba.snip2DiagRect=32]="snip2DiagRect";ba[ba.plaque=33]="plaque";ba[ba.ellipse=34]="ellipse";ba[ba.teardrop=35]="teardrop";ba[ba.homePlate=36]="homePlate";ba[ba.chevron=37]="chevron";ba[ba.pieWedge=38]="pieWedge";ba[ba.pie=39]="pie";ba[ba.blockArc=40]="blockArc";ba[ba.donut=41]="donut";ba[ba.noSmoking=42]="noSmoking";ba[ba.rightArrow=43]="rightArrow";
ba[ba.leftArrow=44]="leftArrow";ba[ba.upArrow=45]="upArrow";ba[ba.downArrow=46]="downArrow";ba[ba.stripedRightArrow=47]="stripedRightArrow";ba[ba.notchedRightArrow=48]="notchedRightArrow";ba[ba.bentUpArrow=49]="bentUpArrow";ba[ba.leftRightArrow=50]="leftRightArrow";ba[ba.upDownArrow=51]="upDownArrow";ba[ba.leftUpArrow=52]="leftUpArrow";ba[ba.leftRightUpArrow=53]="leftRightUpArrow";ba[ba.quadArrow=54]="quadArrow";ba[ba.leftArrowCallout=55]="leftArrowCallout";ba[ba.rightArrowCallout=56]="rightArrowCallout";
ba[ba.upArrowCallout=57]="upArrowCallout";ba[ba.downArrowCallout=58]="downArrowCallout";ba[ba.leftRightArrowCallout=59]="leftRightArrowCallout";ba[ba.upDownArrowCallout=60]="upDownArrowCallout";ba[ba.quadArrowCallout=61]="quadArrowCallout";ba[ba.bentArrow=62]="bentArrow";ba[ba.uturnArrow=63]="uturnArrow";ba[ba.circularArrow=64]="circularArrow";ba[ba.leftCircularArrow=65]="leftCircularArrow";ba[ba.leftRightCircularArrow=66]="leftRightCircularArrow";ba[ba.curvedRightArrow=67]="curvedRightArrow";ba[ba.curvedLeftArrow=
68]="curvedLeftArrow";ba[ba.curvedUpArrow=69]="curvedUpArrow";ba[ba.curvedDownArrow=70]="curvedDownArrow";ba[ba.swooshArrow=71]="swooshArrow";ba[ba.cube=72]="cube";ba[ba.can=73]="can";ba[ba.lightningBolt=74]="lightningBolt";ba[ba.heart=75]="heart";ba[ba.sun=76]="sun";ba[ba.moon=77]="moon";ba[ba.smileyFace=78]="smileyFace";ba[ba.irregularSeal1=79]="irregularSeal1";ba[ba.irregularSeal2=80]="irregularSeal2";ba[ba.foldedCorner=81]="foldedCorner";ba[ba.bevel=82]="bevel";ba[ba.frame=83]="frame";ba[ba.halfFrame=
84]="halfFrame";ba[ba.corner=85]="corner";ba[ba.diagStripe=86]="diagStripe";ba[ba.chord=87]="chord";ba[ba.arc=88]="arc";ba[ba.leftBracket=89]="leftBracket";ba[ba.rightBracket=90]="rightBracket";ba[ba.leftBrace=91]="leftBrace";ba[ba.rightBrace=92]="rightBrace";ba[ba.bracketPair=93]="bracketPair";ba[ba.bracePair=94]="bracePair";ba[ba.straightConnector1=95]="straightConnector1";ba[ba.bentConnector2=96]="bentConnector2";ba[ba.bentConnector3=97]="bentConnector3";ba[ba.bentConnector4=98]="bentConnector4";
ba[ba.bentConnector5=99]="bentConnector5";ba[ba.curvedConnector2=100]="curvedConnector2";ba[ba.curvedConnector3=101]="curvedConnector3";ba[ba.curvedConnector4=102]="curvedConnector4";ba[ba.curvedConnector5=103]="curvedConnector5";ba[ba.callout1=104]="callout1";ba[ba.callout2=105]="callout2";ba[ba.callout3=106]="callout3";ba[ba.accentCallout1=107]="accentCallout1";ba[ba.accentCallout2=108]="accentCallout2";ba[ba.accentCallout3=109]="accentCallout3";ba[ba.borderCallout1=110]="borderCallout1";ba[ba.borderCallout2=
111]="borderCallout2";ba[ba.borderCallout3=112]="borderCallout3";ba[ba.accentBorderCallout1=113]="accentBorderCallout1";ba[ba.accentBorderCallout2=114]="accentBorderCallout2";ba[ba.accentBorderCallout3=115]="accentBorderCallout3";ba[ba.wedgeRectCallout=116]="wedgeRectCallout";ba[ba.wedgeRoundRectCallout=117]="wedgeRoundRectCallout";ba[ba.wedgeEllipseCallout=118]="wedgeEllipseCallout";ba[ba.cloudCallout=119]="cloudCallout";ba[ba.cloud=120]="cloud";ba[ba.ribbon=121]="ribbon";ba[ba.ribbon2=122]="ribbon2";
ba[ba.ellipseRibbon=123]="ellipseRibbon";ba[ba.ellipseRibbon2=124]="ellipseRibbon2";ba[ba.leftRightRibbon=125]="leftRightRibbon";ba[ba.verticalScroll=126]="verticalScroll";ba[ba.horizontalScroll=127]="horizontalScroll";ba[ba.wave=128]="wave";ba[ba.doubleWave=129]="doubleWave";ba[ba.plus=130]="plus";ba[ba.flowChartProcess=131]="flowChartProcess";ba[ba.flowChartDecision=132]="flowChartDecision";ba[ba.flowChartInputOutput=133]="flowChartInputOutput";ba[ba.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";
ba[ba.flowChartInternalStorage=135]="flowChartInternalStorage";ba[ba.flowChartDocument=136]="flowChartDocument";ba[ba.flowChartMultidocument=137]="flowChartMultidocument";ba[ba.flowChartTerminator=138]="flowChartTerminator";ba[ba.flowChartPreparation=139]="flowChartPreparation";ba[ba.flowChartManualInput=140]="flowChartManualInput";ba[ba.flowChartManualOperation=141]="flowChartManualOperation";ba[ba.flowChartConnector=142]="flowChartConnector";ba[ba.flowChartPunchedCard=143]="flowChartPunchedCard";
ba[ba.flowChartPunchedTape=144]="flowChartPunchedTape";ba[ba.flowChartSummingJunction=145]="flowChartSummingJunction";ba[ba.flowChartOr=146]="flowChartOr";ba[ba.flowChartCollate=147]="flowChartCollate";ba[ba.flowChartSort=148]="flowChartSort";ba[ba.flowChartExtract=149]="flowChartExtract";ba[ba.flowChartMerge=150]="flowChartMerge";ba[ba.flowChartOfflineStorage=151]="flowChartOfflineStorage";ba[ba.flowChartOnlineStorage=152]="flowChartOnlineStorage";ba[ba.flowChartMagneticTape=153]="flowChartMagneticTape";
ba[ba.flowChartMagneticDisk=154]="flowChartMagneticDisk";ba[ba.flowChartMagneticDrum=155]="flowChartMagneticDrum";ba[ba.flowChartDisplay=156]="flowChartDisplay";ba[ba.flowChartDelay=157]="flowChartDelay";ba[ba.flowChartAlternateProcess=158]="flowChartAlternateProcess";ba[ba.flowChartOffpageConnector=159]="flowChartOffpageConnector";ba[ba.actionButtonBlank=160]="actionButtonBlank";ba[ba.actionButtonHome=161]="actionButtonHome";ba[ba.actionButtonHelp=162]="actionButtonHelp";ba[ba.actionButtonInformation=
163]="actionButtonInformation";ba[ba.actionButtonForwardNext=164]="actionButtonForwardNext";ba[ba.actionButtonBackPrevious=165]="actionButtonBackPrevious";ba[ba.actionButtonEnd=166]="actionButtonEnd";ba[ba.actionButtonBeginning=167]="actionButtonBeginning";ba[ba.actionButtonReturn=168]="actionButtonReturn";ba[ba.actionButtonDocument=169]="actionButtonDocument";ba[ba.actionButtonSound=170]="actionButtonSound";ba[ba.actionButtonMovie=171]="actionButtonMovie";ba[ba.gear6=172]="gear6";ba[ba.gear9=173]=
"gear9";ba[ba.funnel=174]="funnel";ba[ba.mathPlus=175]="mathPlus";ba[ba.mathMinus=176]="mathMinus";ba[ba.mathMultiply=177]="mathMultiply";ba[ba.mathDivide=178]="mathDivide";ba[ba.mathEqual=179]="mathEqual";ba[ba.mathNotEqual=180]="mathNotEqual";ba[ba.cornerTabs=181]="cornerTabs";ba[ba.squareTabs=182]="squareTabs";ba[ba.plaqueTabs=183]="plaqueTabs";ba[ba.chartX=184]="chartX";ba[ba.chartStar=185]="chartStar";ba[ba.chartPlus=186]="chartPlus"})(Pi||(Pi={}));Object(h.b)("ST_ShapeType",Pi);var Zj=d(154);
class Wg{constructor(){this.RowId=this.ColId=null}}Object(h.a)(Wg,"TableCellInfo",null,[]);var $h=d(905),Fe=d(52),Ph=d(186),rg=d(124),zg=d(168),lj=d(1122),pg=d(933),Nh=d(934),Ha=d(351),kb=d(107);class Hb{constructor(ba,Aa){this.jwa=this.$Bb=null;this.tFg=!1;this.RBe=ba;this.Pg=Aa}get uWj(){return this.tFg}nKb(ba,Aa){Aa&&ba.removeNotification(Aa);return Aa}WXk(ba){this.$Bb=this.nKb(ba,this.$Bb);this.nKb(ba,this.jwa);this.jwa=this.$Bb=null}Rnl(ba,Aa,Wa){ba?this.RBe.zm.isVisible&&1===ba.DM.length&&Aa.Ba&&
bd.a.Jaa(ba.Z8a.Cb,Aa.Ba.Cb)||ac.UISurfaces.oL().then(gb=>{this.jwa=this.nKb(gb,this.jwa);this.jwa=null;var nb=Object.assign(new lj.a,{label:ba.XIb,onExecute:()=>{ba.primaryButtonAction(this.RBe,Aa);Aa.Ba.me!==ba.Z8a.me&&Wa.IJ(ba.Z8a.me);this.nKb(gb,this.jwa);this.jwa=null}}),lc=Object.assign(new lj.a,{label:ba.Und,onExecute:()=>{this.tFg=!0;this.nKb(gb,this.jwa);this.jwa=null}});lc=Object.assign(new pg.a,{target:".EditingRibbonPanel",title:ba.title,content:ba.content,primaryButtonProps:nb,secondaryButtonProps:lc,
useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new Nh.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.Pg.Lo(sd.a.v0a)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});nb=Object.assign(new Ha.a,{onShow:()=>{this.Pg.rI(sd.a.v0a)}});lc=gb.callout(lc);this.jwa=gb.addNotification(lc,nb)}):Gb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}jwh(ba,Aa){const Wa=
new kb.StandardDialog;Wa.yd=4;Wa.Gx(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,Aa?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,gb=>{1===gb?(ba.v2b(Aa),this.RBe.n3d(Aa)?this.kwh():this.iwh(Aa?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),Gb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",
Aa)):Gb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",Aa)})}kwh(){const ba=new kb.StandardDialog;ba.yd=0;ba.Gx(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}iwh(ba){const Aa=()=>{this.Pg.rI(sd.a.v0a)},Wa=()=>{this.Pg.Lo(sd.a.v0a)};ac.UISurfaces.oL().then(gb=>{this.nKb(gb,this.$Bb);this.$Bb=null;var nb=Object.assign(new pg.a,{target:".EditingRibbonPanel",
title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:ba,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new Nh.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Wa,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const lc=Object.assign(new Ha.a,{onShow:Aa});nb=gb.callout(nb);this.$Bb=gb.addNotification(nb,lc)})}}Object(h.a)(Hb,"CommentCalloutDialogManager",null,[]);var ic=d(967);class Qc{constructor(ba){this.zHa=ba;this.Jma=[];this.hse=new ic.a(1E3,Object(qa.a)(this,
this.perform,"perform"))}VHk(ba){Array.contains(this.Jma,ba)||Array.add(this.Jma,ba);this.hse.perform()}perform(){const ba=this.Jma;this.Jma=[];for(let Aa=0;Aa<ba.length;Aa++){const Wa=ba[Aa];this.zHa.zGb(Wa.commentId,new Ed.a(Wa.pos.X,Wa.pos.Y))}}}Object(h.a)(Qc,"CommentKeyboardMoveController",null,[]);class Jd{constructor(ba,Aa,Wa,gb,nb){this.hGa=this.mwa=null;this.Tea=[];if(!ba)throw Error.argumentNull("parentElement");if(!Aa)throw Error.argumentNull("frame");this.UDb=Wa;this.ii=ba;this.kb=Aa;
this.Eyg=gb;this.Nyg=nb}dispose(){this.bRe();this.kb=this.ii=null}bRe(){this.hGa=this.mwa=null;if(this.Tea&&0<this.Tea.length){for(const ba of this.Tea)ba&&ba.dispose();Array.clear(this.Tea)}}l_(ba){if(!this.FDa)return!0;if(!ba||!ba.length)return!1;ba=zg.e(ba,Aa=>0===Aa.status);return!!ba&&0<ba.length}qld(ba){this.bRe();if(ba&&this.ii){var Aa=this.kb.isReadOnly?null:this.kb.eu;for(const Wa of ba)this.Tea.push(this.UDb.create(Wa,this.ii,this,Aa,this.kb.isReadOnly,Hc.HN(Wa)||!this.Nyg));this.l_(ba)&&
this.C5e()}}selectComment(ba,Aa){if(!(!ba&&!this.mwa||this.mwa&&Hc.Kvb(ba,this.mwa.comment))&&(this.mwa&&this.mwa.select(!1),this.mwa=null,ba))for(const Wa of this.Tea){if(Hc.Kvb(Wa.comment,ba)){this.mwa=Wa;Wa.select(!0);break}if(Aa&&Wa.comment.Children)for(const gb of Wa.comment.Children)if(Hc.Kvb(gb,ba)){this.mwa=Wa;Wa.select(!0);return}}}drb(ba,Aa){if(!(!ba&&!this.hGa||this.hGa&&Hc.Kvb(ba,this.hGa.comment))&&(this.hGa&&this.hGa.activate(!1),this.hGa=null,ba))for(const Wa of this.Tea){if(Hc.Kvb(Wa.comment,
ba)){this.hGa=Wa;Wa.activate(!0);break}if(Aa&&Wa.comment.Children)for(const gb of Wa.comment.Children)if(Hc.Kvb(gb,ba)){this.hGa=Wa;Wa.activate(!0);return}}}ywh(ba){for(const Aa of this.Tea)Aa.xwh(ba)}C5e(){for(const ba of this.Tea)ba.updatePosition(this.kb.DCa(ba.comment.pos.X,ba.comment.pos.Y))}zGb(ba,Aa){Aa=this.kb.AJf(Aa._x,Aa._y);ba.pos.X+=Aa._x;ba.pos.Y+=Aa._y;Aa=new Ed.a(ba.pos.X,ba.pos.Y);this.kb.selectComment(ba,null,!0,!1,0,1,!1);this.kb.manager.zGb(ba.commentId,Aa)}dGl(ba){for(const Aa of this.Tea)if(Aa.comment===
ba){Aa.updatePosition(this.kb.DCa(Aa.comment.pos.X,Aa.comment.pos.Y));break}}eGl(ba){for(const Aa of ba)for(const Wa of this.Tea)Wa.comment.commentId===Aa.commentId&&Wa.updatePosition(this.kb.DCa(Wa.comment.pos.X,Wa.comment.pos.Y))}setVisibility(ba){this.Nyg=ba;for(const Aa of this.Tea)Aa.setVisibility(!Hc.HN(Aa.comment)&&ba)}get frame(){return this.kb}get isRightToLeft(){return this.Eyg}set isRightToLeft(ba){this.Eyg=ba}get parentElement(){return this.ii}set parentElement(ba){this.ii=ba}get vLb(){return this.mwa}get FDa(){return!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(h.a)(Jd,"CommentMarkerView",null,[]);class yd{constructor(){this.comment=this.slide=null;this.direction=0;this.NUe=null}}Object(h.a)(yd,"CommentSelectContext",null,[]);var He;(function(ba){ba[ba.previous=0]="previous";ba[ba.next=1]="next"})(He||(He={}));Object(h.b)("CommentSelectDirection",He);class sf{constructor(ba,Aa){if(!ba||1>ba.length)throw Error.argument("ISlideNode[] slides");if(!Aa)throw Error.argumentNull("ICommentGraphManager graphManager");
this.Xhk=ba;this.hl=Aa;this.oBe=[];this.init()}get GJa(){return this.Xhk}get DM(){return this.oBe}get Z8a(){return this.DM[this.DM.length-1]}get XIb(){return 1<this.DM.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get Und(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.tpl()}init(){for(const ba of this.GJa)for(const Aa of this.hl.rta(ba.XD()))if(1===
Aa.status){this.oBe.push(ba);break}if(1>this.oBe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}tpl(){switch(this.DM.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.DM[1].me+1,this.DM[0].me+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.DM[2].me+1,this.DM[1].me+1,this.DM[0].me+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.DM[3].me+1,this.DM[2].me+1,this.DM[1].me+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.DM[this.DM.length-1].me+1,this.DM[this.DM.length-2].me+1,this.DM[this.DM.length-3].me+1,this.DM.length-3)}}haj(){for(const ba of this.hl.C9a(this.Z8a))if(1===ba.status)return ba;return null}primaryButtonAction(ba,Aa){if(!Aa.presentation||!Aa.presentation.slides)return Gb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
Aa.presentation?"Presentation.Slides":"Presentation"),null;const Wa=this.haj();if(!Wa)return null;ba.zm.isVisible||ba.Xqd();if(Aa.Ba&&bd.a.Jaa(Aa.Ba.Cb,this.Z8a.Cb))ba.cga(Wa.commentId,1,!0);else for(const gb of Aa.presentation.slides)if(bd.a.Jaa(gb.Cb,this.Z8a.Cb))return Object.assign(new yd,{slide:this.Z8a,comment:Wa,direction:1,NUe:Re.a.zk("SelectResolvedCommentCrossSlide",1)});return null}}Object(h.a)(sf,"ResolvedCommentsCalloutParams",null,[]);class bg{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(h.a)(bg,"SharedCommentsTaskPaneProps",null,[]);var Ag=d(976),Ii=d(436),aj=d(158);class Xg{constructor(ba,Aa,Wa,gb,nb,lc,jd,xd,Kc,Zc,Sc,ld,Dg,De,gi,pk,Kh,Yd,Kk,zi,Vi,hi,xa,sb,Jb,uc,Gd,ee,se,$e,gg,Th,Uh,Qj,Xd,Wf,yk,ak,Im,ml,Lk,Jm,Mk,vh,Ij,nj,am,pn,lm,Km,mm,$k,nl,Af,yl,oj,zl,Bm){this.JBe=this.pn=null;this.gdb=!0;this.So=this.Xte=this.Ndc=this.Fte=this.idb=!1;this.teb=0;this.xad=this.bFb=!1;this.wGa=this.G$c=this.hi=this.SVa=this.zfb=this.D$=this.ftg=null;this.Hyg=this.XWa=
!1;this.Jr=null;this.VBe=this.pte=!1;this.ySg=null;this.kCf=[sd.a.Ez,sd.a.Kp,sd.a.vW,sd.a.Swi];this.Amb=2147483647;this.pBb=0;this.RGg=-1;this.bvg=0;this.Xfc=null;this.J9c=this.t$c=this.sre=!1;this.jZa=(va,Ki)=>{Ki.slide===this.ua.Ba&&(va=this.pR.instance.jce||this.pR.instance.kce,!Ki.slide.isUnread||va)&&(Ki=this.hl.$y(),this.dKb(Ki,e.AFrameworkApplication.isRtl,!0))};if(!Wf)throw Error.argumentNull("appSettingsManager");if(!hi)throw Error.argumentNull("commentEventHost");if(!Aa)throw Error.argumentNull("commentTelemetryManager");
if(nl.Ln&&!Bm)throw Error.argumentNull("sorterViewActorLazy");this.tH=mm;this.ia=Wa;this.Rb=gb;this.zm=nb;this.eu=lc;this.Zc=jd;this.Fa=xd;this.Pg=Kc;this.qe=Zc;this.pa=Sc;this.Kc=Dg;this.yy=De;this.yt=gi;this.hl=ba;this.lE=Aa;this.Zbk=new Qc(ba);this.WX=pk;this.ua=Kh;this.Qbd=Yd.xd(40);this.$Ig=Rb.a("PreventCommentDraftDeletionOnPageContentChange")?Yd.xd(7):Yd.xd(8);this.qEb=ld;this.BO=Dg.Ic?Dg.Ic.FWd:null;this.Eva=Jb;this.zb=zi;this.e0=hi;this.hgb=xa;this.QHg=Vi;this.qad=sb;this.tre=uc;this.L5c=
Gd;this.Ge=$e;this.D9c=ee;this.Nq=se;this.l4c=gg;this.xt=Th;this.UDb=Uh;this.tR=Qj;this.$n=Xd;this.Qb=Wf;this.Es=ak;this.iyg=Im;this.r4=new n.a;this.Sd=ml;this.Xa=Lk;this.wfb=Mk;this.qva=Jm;this.Lc=vh;this.Ea=am;this.Zgk=pn;this.lJ=lm;this.Rdc=Km;this.Ha=nl;this.Ik=Af;this.zX=yl;this.Kdc=nj;this.oHa=!1;this.ia.paa(this);this.Ccb=new Hb(this,this.Pg);this.pR=oj;this.f5=zl;this.cYa=Bm;if(!yk)throw Error.argumentNull("InteractiveViewManagerFuture");this.OBg=yk;this.O6j=this.OCi();this.tH&&this.zm.Qal(this.Ufj());
this.Pb=$k;Ij.kub().then(va=>{va||this.JVe(!1)})}get HPc(){return this.iyg}get t3d(){return this.Qb.ka("195")}get jVf(){return this.qva}get p2b(){return this.Qb.Ga("CurrentCommentId")}get h_d(){return this.Qb.Ga("CurrentSlideId")}get K0b(){return this.Qb.ka("PptReactTabbedTaskPanesM2IsEnabled")}get qJk(){return this.Qb.ka("PPTSafeLinksIsEnabledForModernComments")}get fxi(){return this.Qb.ka("CommentTextAnchoringReadWriteEnabled")}get JWd(){return this.Qb.ka("CommentTextAnchoringCreateNewEnabled")}get ZRf(){return this.Qb.ka("EnableDeleteAllComments")}get FDa(){return this.Qb.ka("SlideResizePerfImprovementEnabled")}get ovb(){return Rb.a("CompactingDHCsEnabled")}get $Uf(){return Rb.a("CanvasToCommentFocusFixV2")}get C9b(){return this.Qb.ka("PPTOBlueDotsForComments")}initialize(){this.So=
1===this.Rb.mode;this.tH||(this.Eva?Sys.UI.DomElement.addCssClass(this.qEb,qd.S5k):Sys.UI.DomElement.addCssClass(this.qEb,qd.R5k));const ba=this.Fa.Fc(sd.a.Kp);ba.dJ=!0;ba.M1a=!0;ba.kca(Wa=>{const gb=!Rb.a("FixAltF12KeboardingInCommentPane")||!Wa||Wa.name!==sd.a.OM;this.rkc(!0,!Wa||Wa.name!==sd.a.Ez&&gb,!0)});ba.OBa((Wa,gb)=>{Wa=(gb.name===sd.a.ZO||gb.name===sd.a.waa)&&Wa.name===sd.a.Kp;this.rkc(!1,!1,gb.name===sd.a.Kp||gb.name===sd.a.sg||gb.name===sd.a.Ez||gb.name===sd.a.vW||this.K0b&&gb.name===
sd.a.OM||Wa)});const Aa=this.Fa.Fc(sd.a.Ez);Aa.kca((Wa,gb)=>{this.Vxk(Wa,gb)});Aa.OBa(()=>{this.Uxk()});this.tH||this.Zc.kKb(mb.a.click,this.qEb,Object(qa.a)(this,this.mHb,"onCommentPaneParentDivClick"),null,ba.M1a);this.wb();this.yy.VPd(Object(qa.a)(this,this.mJa,"onBeforeSlideSwitched"));this.yy.eW(Object(qa.a)(this,this.a5e,"updateCommentsWhenNavigateSlide"));this.yt.FPa(Object(qa.a)(this,this.vsf,"activeSlideDOMDisplayed"));this.Nq.hbi(Object(qa.a)(this,this.O5g,"onPageViewZoomChanged"));this.Es.Hvf(Object(qa.a)(this,
this.onShapeSelected,"onShapeSelected"));this.Es.Mbi(Object(qa.a)(this,this.M6g,"onShapeDeselected"));this.yy.YYb(Object(qa.a)(this,this.X6g,"onShapeTextSelected"));this.yy.pQd(Object(qa.a)(this,this.Wkc,"onSlideBackgroundClicked"));this.Kdc&&(this.yy.ZYb(Object(qa.a)(this,this.Bzk,"onSlideSizeUpdated")),this.yy.Tbi(Object(qa.a)(this,this.V6g,"onShapeRotatedOrBoundsUpdated")),this.yy.Pbi(Object(qa.a)(this,this.V6g,"onShapeRotatedOrBoundsUpdated")));this.Qbd.kk(Object(qa.a)(this,this.R7g,"onTextAnchorPropertyChanged"));
this.$Ig.wF(Object(qa.a)(this,this.FB,"onChildTopologyChanged"));this.Qbd.TBa(Object(qa.a)(this,this.T2g,"onBeforeTextAnchorDisconnect"));this.wfb.kk(Object(qa.a)(this,this.Tkc,"onShapePropertyChange"));this.wfb.ebi(Object(qa.a)(this,this.Q6g,"onShapeInvalidation"));this.Lc.g$h(Object(qa.a)(this,this.b4g,"onF6FocusDocument"));this.Lc.ZGc(Object(qa.a)(this,this.hhb,"onSetFocus"));this.C9b&&this.f5.execute(Wa=>{Wa.qQd(this.jZa)});this.l4c.mQd(Object(qa.a)(this,this.Fgd,"onSessionExpired"));this.l4c.LA(Object(qa.a)(this,
this.ixa,"onSessionEnded"));this.Kc.Ic&&this.Kc.Ic.FWd&&(this.mJa(this,null),this.a5e(this,null));this.Rb.RK(Object(qa.a)(this,this.A2g,"onAppModeSwitched"));this.Rb.HPa(Object(qa.a)(this,this.nY,"onSetOffline"));this.yt.XYb(Object(qa.a)(this,this.Hgd,"onShapeViewElementAddedOrRemoved"));this.yt.Jvf(Object(qa.a)(this,this.Hgd,"onShapeViewElementAddedOrRemoved"));this.pa.KG(Object(qa.a)(this,this.EH,"onSelectionChanged"))}Hgd(ba,Aa){this.pn&&(ba=Aa.Px)&&ba.shapeNode&&this.HVj(ba.shapeNode.slideId)&&
this.pn.qld(this.hl.$y())}HVj(ba){return!!this.ua&&!!this.ua.fk&&this.ua.fk.equals(ba)}JVe(ba){this.qva=this.iyg=ba;this.$n.JVe(ba)}Bzk(){this.pn&&this.pn.C5e()}V6g(ba,Aa){if(this.pn){const Wa=Aa.Px.shapeNode;if(Wa){if((ba=this.hl.$y())&&ba.length){Aa=[];for(const gb of ba)gb.anchorShape===Wa.get_shapeId()&&Aa.push(gb);this.pn.eGl(Aa)}}else Gb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}CFl(){try{if(this.K0b&&this.zm){const ba=Object($a.a)(1192,this.zm);
ba&&(ba.bvh=!!this.hi)}}catch(ba){Gb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",ba)}}eVf(){return this.hi&&this.hi.z8&&this.ua.Ba?!bd.a.Jaa(this.hi.z8,this.ua.Ba.Cb):!1}Dvb(){return this.hi&&this.ua.Ba?!this.hi.z8||bd.a.Jaa(this.hi.z8,this.ua.Ba.Cb):!1}mkh(){if(this.Jr&&this.Jr.isIntegratedExtensionEnabled()){const ba=this.hl.$y(),Aa=!this.FDa||!this.oHa;ba&&0<ba.length&&(this.JR(!0,!0,Aa),this.mmd());this.Dvb()&&this.lkh(this.hi)}}nxk(){if(this.Jr){this.CFl();
this.mkh();const ba=this.sLb;ba&&0!==ba.status&&this.mMa(1)}}oxk(){this.z2b();const ba=!this.FDa||!(this.l_()&&this.oHa);this.JR(!1,!1,ba)}Bxk(ba){this.pBb!==ba&&(this.pBb=ba,this.Kc&&this.Kc.Ic&&this.Kc.Ic.kIh(2,!1,this.pBb))}Seg(){const ba=Object.assign(new mh,{paneClosedCallback:Object(qa.a)(this,this.nxk,"onPaneClosedCallback"),paneOpenedCallback:Object(qa.a)(this,this.oxk,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(qa.a)(this,this.Bxk,"onPositionUpdatedScrollHeightCallback")});
ba.allContainersVisibleCallback=Object(qa.a)(this,this.hsk,"onAllContainersVisible");this.Jr=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(ba)}JGj(){this.qJk&&this.Zgk.execute(ba=>{const Aa=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();Aa?Aa.registerSafelinksNavigator(Object(qa.a)(ba,ba.qud,"tryNavigate")):Gb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}rEj(){this.Seg();
this.JR(!0,!1,!0);this.pte=!0;const ba=this.B5b();qc.a.xld(ba,[mb.a.contextMenu]);if(this.Jr){this.Jr.setDhcContainerPanel(ba,this.Eva);var Aa=Object.assign(new Dh,{width:parseFloat(ba.style.width),height:this.Amb,x:0,y:0});this.Jr.updateViewport(Aa);this.Jr.setCompactContainers(this.ovb)}this.mmd();this.lE.Iuk(this.ua.fk);Aa=this.Fa.Fc(sd.a.vW);Aa.dJ=!0;Aa.M1a=!0;Aa.kca(Wa=>{this.rkc(!0,!Wa||Wa.name!==sd.a.Ez,!0)});Aa.OBa((Wa,gb)=>{Wa=(gb.name===sd.a.ZO||gb.name===sd.a.waa)&&Wa.name===sd.a.vW;this.rkc(!1,
!1,gb.name===sd.a.Kp||gb.name===sd.a.sg||gb.name===sd.a.Ez||gb.name===sd.a.vW||this.K0b&&gb.name===sd.a.OM||Wa)});this.Fa.AXc(sd.a.vW,sd.a.hj,ba);this.yhh();this.ia.ya(Ad.a.m6,Za.a.frame,Object(qa.a)(this,this.m6,"showHideComments"))}mmd(){const ba=this.hl.$y();this.ikh(ba)}yhh(){if(this.Jr){const ba=this.B5b();if(ba){const Aa=this.Fa.Fc(sd.a.vW);this.Zc.kKb(mb.a.click,ba,Object(qa.a)(this,this.mHb,"onCommentPaneParentDivClick"),null,Aa.M1a)}}}IGh(){if(this.Jr){const ba=this.B5b();ba&&this.Zc.yb(mb.a.click,
ba,Object(qa.a)(this,this.mHb,"onCommentPaneParentDivClick"))}}B5b(){const ba=this.Kc&&this.Kc.Ic?this.Kc.Ic.Bca:null;return ba?ba.xa:null}ikh(ba){if(this.Kc.Ic&&this.pte){if(!this.Jr)try{this.Seg(),Gb.a.J(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.Jr)}catch(gb){Gb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",gb);return}var Aa=Date.now();if((ba=this.HOf(ba))&&
ba.length){var Wa=this.B5b();Wa.setAttribute(qe.a.af,"group");if(Wa){this.r4=this.u7i(ba);Gb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.r4.count);if(!this.r4.count&&!this.BUa){this.JR(!1,!1,!0);Gb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-Aa);return}this.Jr.setDhcContainerPanel(Wa,this.Eva);this.Jr.attachContainers(this.r4.toArray());this.JR(!0,!1,!0)}Gb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",
Date.now()-Aa)}}}HOf(ba){if(!ba||!ba.length)return ba;const Aa=new n.a;for(const Wa of ba)0!==Wa.status?this.GOf(Wa.commentId):Aa.add(Wa);return Aa.toArray()}fHl(){this.sre=!1;if(!this.$n.Pxh&&!this.$n.DW&&this.Kc.Ic){var ba=this.hl.C9a(this.Kc.Ic.Fd);for(const Aa of ba)if(0===Aa.status){this.selectComment(Aa,null,!0,!0,0,0,!1);break}}}clj(){if(!this.Kc||!this.Kc.Ic||!this.Kc.Ic.Fd)return this.Amb;var ba=this.Kc.Ic.Fd;if(isNaN(ba.Vk))return this.Amb;ba=ba.Vk;return 0>ba?this.Amb:ba}l_f(ba){var Aa=
this.$n.E8(ba);ba=ba.pos.Y;Aa&&(ba+=Aa.mD.y,Aa.Og&&(Aa=this.Ea.ys(Aa),ba+=Aa&&Aa.mD?Aa.mD.y:0));return this.DCa(0,ba).y}e5e(){if(this.Jr){const ba=this.clj();ba!==this.RGg&&(this.RGg=ba,this.Jr.setSlideHeight(ba))}}lkh(ba){if(ba&&0===ba.LQa){var Aa=0;if(this.ovb)Aa=-this.Amb,this.e5e();else{const Wa=this.pa.kp();Wa&&(Aa=this.DCa(0,Wa.mD.y).y)}Aa=Object.assign(new ph,{contentId:ba.uC.draftId,containerContentType:0,anchorTop:Aa,anchorLeft:0});this.JR(!0,!0,!0);this.Jr.setDhcContainerPanel(this.B5b(),
this.Eva);this.Jr.updateDrafting(Aa,!0);this.Jr.selectContainer(ba.uC.draftId,!0)}}B1k(ba){if(this.r4){var Aa=0,Wa="";if(this.ovb){var gb=this.pa.kp();gb&&(Aa=this.DCa(0,gb.mD.y).y);if(gb=this.hl.$y())for(const nb of gb)Vb.a.Wa(nb.commentId)||this.l_f(nb)!==Aa||(Wa=nb.commentId)}Aa=Object.assign(new ph,{contentId:ba,containerContentType:0,anchorTop:Aa,anchorLeft:0});this.ovb?this.Jr.updateDraftingAndPosition(Aa,!1,Wa):this.Jr.updateDrafting(Aa,!1);this.Jr.selectContainer(ba,!0)}}GOf(ba){if(this.Jr&&
this.r4){for(let Aa of this.r4)Xg.XYg(Aa,ba)&&(this.Jr.detachContainers([Aa]),this.r4.remove(Aa));this.l_()||this.BUa||this.JR(!1,!1,!0)}}Mal(){this.sre=!0}aPc(){this.K0b&&this.zm&&this.zm.isVisible&&this.zm.w8k()}oWi(){var ba=this.ua.presentation;if(!ba)return!1;ba=ba.slides;if(!ba)return!1;for(const Aa of ba)if(ba=Object($a.a)(Hd.a,Aa))for(const Wa of this.hl.rta(ba.XD()))if(Hc.HN(Wa))return!0;return!1}S$d(ba){var Aa=this.ua.presentation;if(!Aa)return null;Aa=Aa.slides;if(!Aa)return null;for(const Wa of Aa)if(Aa=
Object($a.a)(Hd.a,Wa),bd.a.Jaa(Aa.Cb,ba))return Aa;return null}gWi(){return this.JWd||this.fxi&&this.oWi()}r8f(){const ba=this.pa.Na.mb,Aa=this.pa.Na.w6;if(!ba||!Aa)return null;var Wa=Object($a.a)(5,ba.Ua.node),gb=Object($a.a)(5,Aa.Ua.node);if(!Wa||!gb)return null;Wa=Object($a.a)(Ph.TableCellNode,Wa.lL());gb=Object($a.a)(Ph.TableCellNode,gb.lL());return Wa&&gb?Wa.rowIndex>gb.rowIndex?ba:Aa:null}lnj(){if(!this.gWi()||!this.pa.C_())return null;Gb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");
var ba=0,Aa=0;if(this.pa.Na.Hl){var Wa=this.r8f();if(!Wa)return Gb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var gb=Wa}else gb=this.pa.Na.mb;if(!gb)return Gb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const nb=({ALa:ba,uDa:Aa}=Hc.knj(this.pa.q_(),gb,ba,Aa)).returnValue;if(!nb||0>ba||0>Aa||0>=Aa-ba)return Gb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",
!nb,Aa,ba),null;Wa=new $h.a;Wa.StartPos=ba;Wa.EndPos=Aa;if(this.pa.eVa()&&nb.get_smartArtModelId()){Gb.a.J(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Wa.AnchoringShape=new Zh.a;ba=P.a.Gf(nb.get_smartArtModelId()).toString();if(!ba||!P.a.isValid(ba))return Gb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!ba),null;Wa.AnchoringShape.SmartArtNodeId=ba;
this.lE.I5j()}else if(nb.Cs()){Gb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");Aa=Object($a.a)(Ph.TableCellNode,nb.lL());if(!Aa)return Gb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;ba=Aa.rowId.toString();Aa=Aa.cellId.toString();if(!(ba&&Aa&&P.a.isValid(ba)&&P.a.isValid(Aa)))return Gb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",
!ba,!Aa),null;Wa.AnchoringShape=new Zh.a;Wa.AnchoringShape.TableCell=new Wg;Wa.AnchoringShape.TableCell.RowId=ba;Wa.AnchoringShape.TableCell.ColId=Aa;this.lE.J5j()}ba=Object($a.a)(5,gb.Ua.node);gb=Object($a.a)(5,gb.Ye.node);ba!==gb&&this.lE.L5j();Gb.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Wa}KMi(ba){if(this.Jr&&ba){for(const Aa of this.r4.toArray()){let Wa=!1;for(const gb of ba)if(Xg.XYg(Aa,gb.commentId)){Wa=!0;break}Wa||(this.Jr.detachContainers([Aa]),
this.r4.remove(Aa),Gb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",Aa.contentId))}this.l_()||this.BUa||this.JR(!1,!1,!0)}}z2b(){if(this.Jr){for(const ba of this.r4.toArray())this.Jr.detachContainers([ba]);this.r4.clear()}this.l_()||this.BUa||(this.FDa&&!this.oHa?this.JR(!1,!1,!1):this.JR(!1,!1,!0))}r_e(ba){if(!ba)return null;ba.sort((Aa,Wa)=>{var gb=this.$n.E8(Aa);gb=gb?gb.mD:new Ed.a(0,0);var nb=this.$n.E8(Wa);nb=nb?nb.mD:new Ed.a(0,0);gb.y+=Aa.pos.Y;nb.y+=Wa.pos.Y;
gb.x+=Aa.pos.X;nb.x+=Wa.pos.X;let lc=gb.y-nb.y;lc||(lc=gb.x-nb.x)||(lc=+Aa.dt-+Wa.dt);return lc});return ba}u7i(ba){const Aa=new n.a;if(ba){this.ovb&&this.e5e();for(const Wa of ba)Vb.a.Wa(Wa.commentId)||(ba=this.l_f(Wa),ba=Object.assign(new ph,{contentId:Wa.commentId,containerContentType:0,anchorTop:ba,anchorLeft:0}),Aa.add(ba))}return Aa}nY(ba){this.Z4g(ba)}hih(ba,Aa){for(let Wa=0;Wa<ba.Ra.length;Wa++){const gb=ba.Ra.ga(Wa);if(!gb.yg)continue;const nb=[];for(let lc=0;lc<gb.yg.length;lc++){const jd=
gb.yg.ga(lc);jd.wI.equals(Aa)&&nb.push(jd)}if(!(1>nb.length))try{ba.epa=!0;for(const lc of nb)gb.yg.remove(lc)}catch(lc){Gb.a.J(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",lc.toString())}finally{ba.epa=!1}}}Qsf(ba,Aa,Wa){ba.yg||(ba.yg=new Hj.a(ba));const gb=ba.yg.He.paragraph;Aa=new yh.a(ba.yg.He,null,Aa,Wa);ba.yg.add(Aa);gb.gv()}RLc(ba){return Be.a.Gf("{"+ba+"}{1}")}EYb(ba,Aa,Wa,gb){let nb=null;for(let lc=0;lc<ba.Ra.length;lc++){let jd=
ba.Ra.ga(lc);if(jd.cp>=Wa){try{ba.epa=!0;if(jd.cp>Wa||!jd.formatting)this.lJ.rga(ba,lc,Wa,nb),jd=ba.Ra.ga(lc);this.Qsf(jd,Aa,gb)}catch(xd){Gb.a.J(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",xd.toString())}finally{ba.epa=!1}return}jd.formatting&&(nb=jd.formatting)}if(Ib.ParagraphReader.textLength(ba)>=Wa)try{ba.epa=!0;this.lJ.rga(ba,ba.Ra.length,Wa,nb);const lc=ba.Ra.ga(ba.Ra.length-1);this.Qsf(lc,Aa,gb)}catch(lc){Gb.a.J(512496736,
805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",lc.toString())}finally{ba.epa=!1}}j3b(){var ba=this.hl.$y();if(ba){var Aa=Date.now(),Wa=!1,gb=new Ua.a;for(var nb of ba){var lc=Hc.Z6b(nb,this.$n.E8(nb));gb.$(nb.commentId,lc)}for(var jd of ba)if(jd.textAnchoringInfo&&(nb=this.$n.E8(jd))&&(lc=gb.ga(jd.commentId),!lc||!lc.isValid||lc.dog(jd.textAnchoringInfo)))for(var xd of nb.xC())this.hih(Object($a.a)(Uc.AParagraphNode,xd),this.RLc(jd.commentId));
for(const Kc of ba)if((ba=gb.ga(Kc.commentId))&&ba.isValid&&ba.dog(Kc.textAnchoringInfo)&&(this.zm.isVisible||0===Kc.status)){Wa=this.RLc(Kc.commentId);this.EYb(ba.cV,Wa,ba.startPos,!0);if(ba.vac)for(jd=1;jd<ba.paragraphs.length;jd++){if(xd=ba.paragraphs[jd])this.EYb(xd,Wa,0,!0),ba.u3.equals(xd)?this.EYb(ba.u3,Wa,ba.endPos,!1):this.EYb(xd,Wa,Ib.ParagraphReader.textLength(xd),!1)}else this.EYb(ba.u3,Wa,ba.endPos,!1);ba.bJj();Wa=!0}Wa&&Gb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",
Date.now()-Aa)}}R7g(ba,Aa){if((ba=this.hl.qta(Aa.node))&&(Aa.property===xb.a.ptc||Aa.property===xb.a.otc||Aa.property===xb.a.ctd||Aa.property===xb.a.dtd)){const Wa=Hc.HN(ba);Wa&&this.j3b();!ba.textAnchoringInfo||Wa||Aa.property!==xb.a.dtd&&Aa.property!==xb.a.ctd||this.lE.K5j(ba,this.RLc(ba.commentId),this.$n.E8(ba),this.Kc.Ic.Ma)}}uSf(){this.hi&&this.D$&&(this.e0.dVe(this.D$.length,this.teb,this.So,this.tre.K1c),this.e0.hVe(Array.clone(this.D$),Array.clone(this.zfb)),this.dFf(2))}lWj(ba,Aa){Aa=this.Pb.Mc(Aa);
for(var Wa=Aa.Bb(2);Wa;Wa=Aa.Cf(2))if((Wa=Object($a.a)(115,Wa))&&bd.a.Jaa(Wa.Cb,ba))return!0;return!1}FB(ba,Aa){Aa&&(ba=Object($a.a)(532,Aa.node),Aa=Aa.VZ,ba&&2===Aa&&((Aa=this.WX.xf)&&Aa.slides&&0>=Aa.slides.length&&this.zm.isVisible&&this.soc(!1,!1),this.hi&&(Aa=this.hi.z8,!Aa&&this.ua.Ba&&(Aa=this.ua.Ba.Cb),this.lWj(Aa,ba)||this.uSf())))}T2g(ba,Aa){if((ba=this.hl.qta(Aa.node))&&Hc.HN(ba)&&(Aa=this.$n.E8(ba)))for(const Wa of Aa.xC())this.hih(Object($a.a)(Uc.AParagraphNode,Wa),this.RLc(ba.commentId))}Q6g(ba,
Aa){(ba=Object($a.a)(4,Aa.node))&&0<ba.xC().length&&(Aa.xgg&192||Aa.xgg&4)&&this.j3b()}Tkc(ba,Aa){ba=Aa.property;Aa=Aa.node;if(ba===Gf.a.Ay||ba===Gf.a.By)if(ba=this.hl.$y()){for(const Wa of ba)Wa.pos.Y=Aa.mD.y,Wa.pos.X=Aa.mD.x;this.mmd()}}Fgd(){Gb.a.J(512496734,805,this.J$a?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.J$a)}ixa(ba,Aa){Gb.a.J(512496733,805,this.J$a?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",Ii.a[Aa.NE],this.J$a)}dispose(){this.pn&&
(this.pn.dispose(),this.pn=null);this.UDb&&(this.UDb.dispose(),this.UDb=null);this.yy.kjh(Object(qa.a)(this,this.mJa,"onBeforeSlideSwitched"));this.yy.Yxa(Object(qa.a)(this,this.a5e,"updateCommentsWhenNavigateSlide"));this.yy.xKb(Object(qa.a)(this,this.vsf,"activeSlideDOMDisplayed"));this.Nq.V_k(Object(qa.a)(this,this.O5g,"onPageViewZoomChanged"));this.Es.Tjh(Object(qa.a)(this,this.onShapeSelected,"onShapeSelected"));this.Es.i0k(Object(qa.a)(this,this.M6g,"onShapeDeselected"));this.yy.gmd(Object(qa.a)(this,
this.X6g,"onShapeTextSelected"));this.yy.Wjh(Object(qa.a)(this,this.Wkc,"onSlideBackgroundClicked"));this.wfb.Rm(Object(qa.a)(this,this.Tkc,"onShapePropertyChange"));this.wfb.S_k(Object(qa.a)(this,this.Q6g,"onShapeInvalidation"));this.Lc.FZk(Object(qa.a)(this,this.b4g,"onF6FocusDocument"));this.Lc.KRe(Object(qa.a)(this,this.hhb,"onSetFocus"));this.C9b&&this.f5.execute(ba=>{ba.TRe(this.jZa)});this.Qbd.Rm(Object(qa.a)(this,this.R7g,"onTextAnchorPropertyChanged"));this.$Ig.bP(Object(qa.a)(this,this.FB,
"onChildTopologyChanged"));this.Qbd.vKa(Object(qa.a)(this,this.T2g,"onBeforeTextAnchorDisconnect"));this.Rb.CY(Object(qa.a)(this,this.A2g,"onAppModeSwitched"));this.l4c.Qjh(Object(qa.a)(this,this.Fgd,"onSessionExpired"));this.l4c.qaa(Object(qa.a)(this,this.ixa,"onSessionEnded"));this.Rb.AKb(Object(qa.a)(this,this.nY,"onSetOffline"));this.tH||this.Zc.yb(mb.a.click,this.qEb,Object(qa.a)(this,this.mHb,"onCommentPaneParentDivClick"));this.IGh();this.BO=this.qEb=null;this.yt.fmd(Object(qa.a)(this,this.Hgd,
"onShapeViewElementAddedOrRemoved"));this.yt.n0k(Object(qa.a)(this,this.Hgd,"onShapeViewElementAddedOrRemoved"));this.pa.yKa(Object(qa.a)(this,this.EH,"onSelectionChanged"))}get isReadOnly(){return this.So}get BUa(){return!!this.hi}get hasFocus(){return this.Fte}OCi(){const ba=new aj.a;var Aa=new od(Ad.a.jUa,Fe.a.application);Aa.preCallback=Object(qa.a)(this,this.bKc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.APf,"disableOnEmptyDeckAndReadOnly");ba.$(0,Aa);Aa=new od(Ad.a.deleteComment,Fe.a.application);
Aa.preCallback=Object(qa.a)(this,this.bKc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.APf,"disableOnEmptyDeckAndReadOnly");ba.$(3,Aa);Aa=new od(Ad.a.JMe,Fe.a.application);Aa.preCallback=Object(qa.a)(this,this.bKc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.fbh,"postCommentAction");ba.$(2,Aa);Aa=new od(Ad.a.$Fe,Fe.a.application);Aa.preCallback=Object(qa.a)(this,this.bKc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.fbh,"postCommentAction");ba.$(1,Aa);Aa=new od(Tb.a.yOb,Fe.a.application);
Aa.preCallback=Object(qa.a)(this,this.Pml,"showHideActionPreCallback");Aa.postCallback=Object(qa.a)(this,this.Oml,"showHideActionPostCallback");Aa.delayActionsUntilRegistration=this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Rb.a("DelayCommentsShowHideAction");ba.$(6,Aa);return ba}Pml(ba,Aa,Wa,gb,nb){if(1===Wa)return!this.ua.Ba||this.isDisabled?8:2;Gb.a.J(36983504,805,50,"New Comment Pane opened.");this.zm.Kgb(!!nb&&nb.AutoShowHide);return 2}Oml(ba,Aa,Wa,gb,
nb,lc){if(1===gb)return ba&&this.lE.mtk(this.ua.fk),ba?32:8;this.hwf(this.zm.isVisible,!!lc&&lc.AutoShowHide);return ba?32:8}bKc(ba,Aa,Wa,gb,nb){if(1===Wa&&this.pa.uUa())return 8;1!==Wa&&((this.Ndc=!!nb&&nb.ShouldCanvasTakeFocus)||this.Ksa(),this.pa.ey(),this.Xte=!0);return 2}fbh(ba,Aa,Wa,gb){if(1===gb&&(this.XWa||!this.D$))return 8;this.Ndc=!1;return ba?32:8}APf(ba,Aa,Wa,gb){return(1!==gb||!this.So&&this.D$)&&this.Kc.Ic?ba?32:8:8}DCa(ba,Aa){return new Ed.a(this.D9c.Pe(ba,0),this.D9c.Pe(Aa,1))}AJf(ba,
Aa){return new Ed.a(this.D9c.qf(ba,0),this.D9c.qf(Aa,1))}Fwb(ba){ba=this.hl.vta(ba);return this.hl.qta(ba)}cga(ba,Aa,Wa){!this.eVf()||ba!==this.hi.uC.draftId&&ba!==this.hi.commentId?this.Dvb()&&ba===this.hi.uC.draftId?(this.e0.selectComment(ba),this.Jr&&this.Jr.selectContainer(ba,!0),this.$Uf&&!this.hasFocus&&1!==Aa&&this.Ksa()):this.selectComment(this.Fwb(ba),null,!0,!0,0,Aa,Wa):(ba=this.S$d(this.hi.z8),ba)?1!==Aa&&(this.hi.p0c=!0,this.Ha.Ln?this.cYa.IJ(ba.me):this.Ge.IJ(ba.me)):(Gb.a.J(512496732,
805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.hi.uC.draftId,0))}selectComment(ba,Aa,Wa,gb,nb,lc,jd){this.pa.ey();Aa=this.sLb?this.sLb.commentId:null;jd||this.aPc();0!==lc?ba?this.e0.selectComment(ba.commentId):this.e0.selectComment(null):0===lc&&(lc=this.$n.E8(ba))&&lc.TK&&this.$n.yod(Pi[lc.TK]);this.pn&&this.pn.selectComment(ba,!0);!this.zm.isVisible&&this.Jr&&ba&&ba!==this.SVa&&(lc=this.hl.l$d(ba.commentId))&&
(lc=this.hl.qta(lc),this.Jr.selectContainer(lc.commentId,!this.Ndc&&!jd&&!this.Xte),this.Xte=!1,this.Kc&&this.Kc.Ic&&this.Kc.Ic.nvd(5,!1,this.pBb));jd||this.Ndc||this.Ksa();!this.$n||!this.zm.isVisible&&this.zm.isVisible||(this.$n.OUe(ba,Aa,!0,!1,jd),Hc.HN(ba)&&!jd&&this.j3b());this.Rb.updateCommandUI()}get sLb(){return this.pn&&this.pn.vLb?this.pn.vLb.comment:null}A8k(){if(!this.XWa){const ba=Re.a.zk("SelectNextCommentCrossSlide",1),Aa=!this.zm.isVisible;this.XWa=!0;this.L5c.h4d((Wa,gb)=>{this.r4g(Wa,
gb,1,ba)},ba,Aa)}}D8k(){if(!this.XWa){const ba=Re.a.zk("SelectPreviousCommentCrossSlide",1),Aa=!this.zm.isVisible;this.XWa=!0;this.L5c.o4d((Wa,gb)=>{this.r4g(Wa,gb,0,ba)},ba,Aa)}}r4g(ba,Aa,Wa,gb){gb.Zm("FindCommentEndTime",new Date);this.zb.Db(new Ae.a(2,1,100,()=>{this.XWa&&(this.XWa=!1,this.Jjl(ba,Aa,Wa)?this.cga(this.hi.commentId||this.hi.uC.draftId,0,!1):Aa&&ba&&this.Kc.Ic.Fd?ba.Cb.equals(this.Kc.Ic.Fd.Cb)?(this.selectComment(Aa,null,!0,!0,2,1,!1),gb.Va("CircularSelectCommentInSingleSlide",He[Wa]),
gb.finish()):(this.wGa=Object.assign(new yd,{slide:ba,comment:Aa,direction:Wa,NUe:gb}),this.Ha.Ln?this.cYa.IJ(ba.me):this.Ge.IJ(ba.me)):(this.Rb.updateCommandUI(),gb.Va("NoCommentFound",He[Wa]),gb.finish()))},90,"47"))}D3f(){let ba=-1;if(!this.hi)return ba;if(this.hi.z8){const Aa=this.S$d(this.hi.z8);Aa&&(ba=Aa.me)}else this.Kc.Ic&&this.Kc.Ic.Fd&&(ba=this.Kc.Ic.Fd.me);return ba}Jjl(ba,Aa,Wa){if(!this.hi||this.hi.uC.sessionType!==dc.create)return!1;const gb=this.D3f();if(0>gb)return!1;if(!Aa||!ba)return!0;
Aa=this.Kc.Ic.Fd.me;if(1===Wa)return Wa=gb<=Aa&&Aa<ba.me,Aa=ba.me<=Aa&&Aa<gb,gb<=ba.me&&!Wa||Aa;Wa=gb>=Aa&&Aa>ba.me;Aa=ba.me>=Aa&&Aa>gb;return gb>ba.me&&!Wa||Aa}mMa(ba){0!==ba&&this.e0.selectComment(null);this.pn&&this.pn.selectComment(null,!1);if(this.Jr&&(this.Jr.deselectContainer(),this.Kc&&this.Kc.Ic)){let Aa=5;const Wa=this.pa.kp();Wa&&Wa.Qf&&(Aa=2);this.Kc.Ic.nvd(Aa,!1,this.pBb)}this.$n&&0!==ba&&(this.$n.rNc(),this.$n.UMc());this.Rb.updateCommandUI()}l5h(ba){this.drb(this.Fwb(ba),0)}drb(ba,
Aa){this.SVa!==ba&&(this.$n&&(ba?this.$n.k5h(ba):this.$n.UMc()),this.SVa=ba,0!==Aa&&(this.SVa?this.e0.highlightComment(this.SVa.commentId):this.e0.highlightComment(null)),this.pn&&this.pn.drb(this.SVa,!0))}y8k(){if(this.p2b){var ba=this.Fwb(this.p2b),Aa=this.Kc.Ic.Fd.sid,Wa=Aa===parseInt(this.h_d);ba?(1!==ba.status&&2!==ba.status||this.Xqd(),this.selectComment(ba,null,!0,!0,0,1,!1),this.lE.Ktk(this.ua.fk),Gb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",
this.p2b,this.h_d)):(Wa&&this.Sd.zs(Object.assign(new Zj.a,{Code:389,Source:4}),this.Xa.podSessionId),Gb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.p2b,this.h_d,parseInt(Aa)))}}get manager(){return this.hl}get US(){return"per"}get WYg(){return this.BO}set WYg(ba){this.BO=ba;this.pn&&(this.pn.parentElement=ba)}get B0g(){return this.Xfc}set B0g(ba){this.Xfc=ba}qld(ba){this.dKb(ba,void 0,!0)}DU(ba,Aa){Aa=!Rb.a("FixAltF12KeboardingInCommentPane")||
Aa;this.rkc(ba,Aa,!0)}DQe(){!this.tH&&this.zm&&(this.qEb.style.display=this.zm.isVisible?"flex":"none");this.pn&&(this.pn.setVisibility(this.gdb),this.pn.ywh(this.idb),this.$n.Pub(this.SVa))}soc(ba,Aa){this.CFh(ba,Aa);this.DQe();this.hwf(ba,Aa)}O5g(){this.pn&&!this.Kdc&&this.pn.C5e();this.mmd();this.ovb&&this.e5e()}lch(){this.XWa=!1;this.MSf();this.pn&&this.pn.bRe();this.bFb=!1;this.IGh()}MSf(){this.hl.SGh()}mJa(){this.oHa=this.l_()||this.Dvb();this.$n&&this.oHa&&(this.$n.rNc(),this.$n.UMc());this.t3d&&
(this.lch(),this.Pzf())}lkl(){return this.hi&&this.hi.z8&&this.ua.Ba?this.hi.p0c&&bd.a.Jaa(this.hi.z8,this.ua.Ba.Cb):!1}a5e(){this.t3d||this.lch();this.ua.Ba||this.mJa(this,null);this.MSf();this.Kc.Ic&&(this.WYg=this.Kc.Ic.FWd);const ba=this.Kc&&this.Kc.Ic?this.hl.C9a(this.Kc.Ic.Fd):this.hl.$y(),Aa=this.Mbj(ba),Wa=this.l_()||this.Dvb();this.t$c||Wa||(this.Ik.caa(this.Ik.SUd,this.Ik.IWd),this.t$c=!0);this.zm.isVisible||(Wa?(this.z2b(),this.mkh()):this.l_()?(this.z2b(),this.JR(!0,!1,!0)):this.FDa&&
!this.oHa?this.JR(!1,!1,!1):this.JR(!1,!1,!0),this.yhh());this.dKb(ba,e.AFrameworkApplication.isRtl,!1,Aa);this.lkl()?(this.cga(this.hi.commentId||this.hi.uC.draftId,0,!1),this.hi.p0c=!1):-1<Aa&&this.cga(ba[Aa].commentId,0,!1);this.wGa&&(this.wGa.NUe.finish(),this.wGa=null);this.E1a(!1);-1!==Aa&&this.pn&&(this.pn.drb(null,!1),this.pn.selectComment(ba[Aa],!1));this.t3d||this.Pzf()}vsf(){if(this.VBe){try{this.Ccb.Rnl(this.ySg,this.ua,this.Ge)}catch(ba){Gb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",
ba)}this.VBe=!1}}E1a(ba){const Aa=this.D3f();this.tre.E1a(ba,Aa)}VEl(ba){this.hi&&!this.hi.z8&&(this.hi.z8=ba)}onShapeSelected(ba,Aa){this.HPc&&(ba=Aa.shapeNode,this.JXe(ba),ba&&0<ba.xC().length&&this.j3b())}X6g(ba,Aa){this.HPc&&(this.JXe(Aa.Px.shapeNode),this.j3b())}EH(ba,Aa){if(Aa&&Aa.ll&&this.pa.C_()&&(ba=this.hl.$y())){Aa=!1;for(var Wa of ba)if(Hc.HN(Wa)){Aa=!0;break}Aa&&((Wa=this.pa.q_())?this.JXe(Wa):Gb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}JXe(ba){ba.get_shapeId()&&
(this.$n&&ba!==this.$n.DW&&this.mMa(1),this.lph(ba.get_shapeId(),!0))}lph(ba,Aa){var Wa=this.hl.$y();if(Wa){var gb=null,nb=null,lc=0,jd=null;for(const xd of Wa)if((this.zm.isVisible||0===xd.status)&&xd.anchorShape===ba)if(this.pa.C_()&&Hc.HN(xd)){Wa=this.pa.Na.mb.Ua;const Kc=this.pa.Na.mb.Ye,Zc=Hc.Z6b(xd,this.$n.E8(xd));Zc&&Zc.isValid?(this.sLb&&this.sLb.commentId===xd.commentId||Zc.ftd===xd.textAnchoringInfo.TextBodyLength)&&Zc.GMj(Wa,Kc)&&(nb?(Wa=Zc.Yfh,Wa<lc&&(nb=xd,lc=Wa)):(nb=xd,lc=Zc.Yfh)):
(gb=xd,Gb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else nb||jd||Hc.HN(xd)||(jd=xd);nb?this.cga(nb.commentId,1,Aa):jd?this.cga(jd.commentId,1,Aa):this.pa.C_()&&!gb?this.$n&&this.mMa(1):gb&&this.cga(gb.commentId,1,Aa)}}M6g(){if(this.HPc){var ba=this.$6d();this.$n.yod(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,ba.toString()));this.mMa(1)}}$6d(){const ba=this.hl.$y();let Aa=[];ba&&(Aa=zg.e(ba,Wa=>0===Wa.status));
return Aa.length}Wkc(){this.HPc&&this.mMa(1)}b4g(ba,Aa){Aa.Hgb===sd.a.sg&&this.$n.yod(ResourceStrings.l_SlidePanel+", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.$6d().toString()));Aa.UIb===sd.a.sg&&this.mMa(1)}hhb(ba,Aa){this.$Uf&&Aa.Hgb!==sd.a.vW&&(Aa.UIb===sd.a.vW||sd.a.Ez)&&this.J$a&&this.mMa(1)}Mbj(ba){let Aa=-1;if(this.wGa&&this.Kc.Ic)if(this.wGa.slide!==this.Kc.Ic.Fd)Gb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");
else if(ba&&0<ba.length){if(this.zm.isVisible)Aa=1===this.wGa.direction?0:ba.length-1;else if(1===this.wGa.direction)for(var Wa=0;Wa<ba.length;Wa++){if(0===ba[Wa].status){Aa=Wa;break}}else for(Wa=ba.length-1;0<=Wa;Wa--)if(0===ba[Wa].status){Aa=Wa;break}0<=Aa&&Aa<ba.length&&(ba=ba[Aa],Wa=this.wGa.comment,Wa.dt===ba.dt&&Wa.commentId===ba.commentId&&Wa.authorName===ba.authorName||Gb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return Aa}JHe(){!this.hl.Iaj()||
this.J9c?(this.dKb(this.hl.$y(),e.AFrameworkApplication.isRtl,!0),this.J9c&&(this.J9c=!1)):this.hi&&(0===this.hi.LQa||1===this.hi.LQa?(this.jVf&&this.dKb(this.hl.$y(),e.AFrameworkApplication.isRtl,!0),0===this.hi.LQa&&(this.xad=!0)):this.hi&&2===this.hi.LQa&&this.jVf&&this.dKb(this.hl.$y(),e.AFrameworkApplication.isRtl,!0))}qtk(){ad(this.Qb)&&(this.J9c=!0,this.JHe())}get rod(){const ba=this.pa.kp();if(ba){const Aa=ba.mD;this.JBe=new Ed.a(e.AFrameworkApplication.isRtl?Aa.x:Aa.x+ba.wx,Aa.y)}else this.JBe=
null;return this.JBe}get Q8k(){if(!this.pa.C_())return null;var ba=Object($a.a)(5,this.pa.Na.mb.Ye.node);if(!ba)return null;const Aa=Object($a.a)(1035,ba.sc(this.Kc.Ic.Ma));if(!Aa)return null;var Wa=null,gb=Aa.htmlElement.getElementsByClassName("Selected");if(0<gb.length)Wa=gb[gb.length-1];else if(this.pa.Na.Hl){if(gb=this.r8f())if(gb=Object($a.a)(5,gb.Ye.node))if(gb!==ba){if(ba=Object($a.a)(1035,gb.sc(this.Kc.Ic.Ma)))Wa=ba.htmlElement}else Wa=Aa.htmlElement}else return null;ba=this.pa.kp();if(!ba||
!Wa)return null;ba=Object($a.a)(117,ba.sc(this.Kc.Ic.Ma));if(!ba)return null;Wa=ug.a.ai(Wa);ba=ug.a.ai(ba.qq);if(0>=Wa.width+Wa.height&&0>=ba.width+ba.height)return null;ba=Ed.a.fV(new Ed.a(Wa.x,Wa.y),new Ed.a(ba.x,ba.y));return this.AJf(ba.x+Wa.width-5,ba.y+10)}get anchorNode(){const ba=this.pa.kp();return this.ftg=ba?ba:this.Kc.Ic.Fd}CFh(ba,Aa){this.zm&&(Aa||this.Iqh(),this.hgb.bth(ba?3:1),!this.isDisabled&&ba&&Rb.a("CommentShimmerBugFix")&&this.zX&&this.zX.isVisible&&(this.zX.bdg(),this.Rb.Kgb(1)),
this.JR(!ba,!1,!0),this.zm.Ap(!this.isDisabled&&ba,Aa),this.zm.isVisible&&(this.gdb=!0))}JR(ba,Aa,Wa){const gb=this.l_();Wa&&(!gb&&!this.oHa||gb&&this.oHa)&&Gb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!this.l_()&&!this.BUa&&ba&&!Aa||this.zm.isVisible&&ba&&!Aa||this.l_()&&this.zX&&this.zX.isVisible&&!ba&&!Aa||!this.Kc.Ic||!(Aa=this.Kc.Ic.Bca)||(Aa.setVisibility(ba),ba=new Ag.a(ba),
this.yy.Qeh(ba),Wa?this.Rb.Kgb(1):Gb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Kc.Ic.nvd(5,!1,this.pBb))}SBl(ba){this.zm&&(this.gdb=!this.isDisabled&&ba,this.gdb||(this.hgb.bth(1),this.zm.Ap(!1,!1),this.Fa.Ej(sd.a.Kp,!1)))}Ufj(){const ba=new bg;ba.focusCallback=Object(qa.a)(this,this.PQc,"focusFirstPaneElement");return Object.assign(new Kf.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.nPl?
300:320),contentProps:ba,location:2,onOpen:Aa=>{qc.a.xld(Aa,[mb.a.contextMenu]);const Wa=this.Fa.Fc(sd.a.Kp);this.Zc.kKb(mb.a.click,Aa,Object(qa.a)(this,this.mHb,"onCommentPaneParentDivClick"),null,Wa.M1a)},onClose:Aa=>{this.soc(!1,!1);this.Zc.yb(mb.a.click,Aa,Object(qa.a)(this,this.mHb,"onCommentPaneParentDivClick"))},isModernPane:!0})}Pzf(){if(!this.Hyg){var ba=this.hl.$y();ba=!!ba&&0<ba.length;Gb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",ba);ba?this.l_()&&
this.JR(!0,!1,!0):(this.z2b(),this.FDa&&!this.oHa?this.JR(!1,!1,!1):this.JR(!1,!1,!0))}}Xqd(){this.zm.isVisible||this.ia.processAction(Ad.a.m6,2);this.aPc()}zAj(){this.zm.isVisible&&this.ia.processAction(Ad.a.m6,2)}rk(ba){return this.qe.rk(ba)}get isDisabled(){const ba=this.WX.xf;return ba?ba.M$a:!0}Stf(){this.G$c||(this.G$c=new Ae.a(0,1,0,Object(qa.a)(this,this.rUk,"refreshCommentsTask"),90,"48"),this.zb.Db(this.G$c))}A2g(ba){this.Z4g(1===ba.mode)}Z4g(ba){this.So=ba;this.Stf();Rb.a("PreventCommentPaneCloseOnReadOnlyChanged")?
this.uSf():this.zm.isVisible&&this.So&&this.zAj()}u9d(){return this.D$?this.D$:[]}h5f(){return this.zfb?this.zfb:[]}get C1g(){return this.teb}get HMc(){return this.hi}z3f(ba){const Aa=this.Kc&&this.Kc.Ic?this.hl.C9a(this.Kc.Ic.Fd):this.r_e(this.hl.$y());if(!Aa||!Aa.length)return 0;let Wa=null;this.rod&&(Wa=this.DCa(this.rod.x,this.rod.y));let gb=-1,nb=0;for(let Kc=0;Kc<Aa.length;Kc++){var lc=this.$n.E8(Aa[Kc]);if(!Wa&&lc)break;if(lc&&Wa){var jd=lc.mD.x,xd=lc.mD.y;jd+=Aa[Kc].pos.X;xd+=Aa[Kc].pos.Y;
lc.Og&&(lc=this.Ea.ys(lc),jd+=lc&&lc.mD?lc.mD.x:0,xd+=lc&&lc.mD?lc.mD.y:0);xd=this.DCa(jd,xd);jd=xd.y;xd=xd.x;if(Wa.y<jd)break;if(Wa.y>jd||Wa.y===jd&&Wa.x>=xd)gb=Kc,Aa[Kc].Children&&ba&&(nb+=Aa[Kc].Children.length)}else lc||(gb=Kc,Aa[Kc].Children&&ba&&(nb+=Aa[Kc].Children.length))}return gb+nb+1}hEj(ba){if(!this.pte)throw Gb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),E.a.Ys(-2130915320);if(this.hi)return Gb.a.J(512496720,
805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),E.a.Ys(-2130915319);if(null===ba)throw Error.argumentNull("session");if(!ba.commentId.length&&0!==ba.LQa)return E.a.Ys(-2130915327);this.hi=ba;this.E1a(!0);0===ba.LQa&&(this.mMa(0),this.zm.isVisible||this.lkh(ba));if(this.zm.isVisible||!this.zm.isVisible)this.Ksa(),this.URi();let Aa="";ba.uC&&(Aa=ba.uC.draftId);Gb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",Aa);return null}endCommentSession(ba,
Aa){if(this.hi){if(this.hi.uC&&this.hi.uC.draftId!==ba)throw Gb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",ba,this.hi.uC.draftId),E.a.Ys(-2130915327);this.bvg=Aa}9!==Aa||this.zm.isVisible||this.Fa.iD(sd.a.sg);this.hi=null;this.Rb.updateCommandUI();if(this.Jr&&!this.zm.isVisible){const Wa=[Object.assign(new ph,{contentId:ba,containerContentType:0,anchorTop:0,anchorLeft:0})];this.Jr.detachContainers(Wa);this.l_()||this.JR(!1,
!1,!0)}this.qad.Kmg&&this.BPf();Gb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",ba,Aa)}get dxi(){return this.bvg}g6(){this.Ksa()}POf(ba){if(this.Ha.ka("CommentCopyPasteEnabled")&&!this.Ccb.uWj)for(const Aa of ba)for(const Wa of this.hl.rta(Aa.XD()))if(1===Wa.status){this.ySg=new sf(ba,this.hl);this.VBe=!0;return}}wb(){1!==this.Rdc.jja&&(this.ia.ya(Ad.a.Krc,Fe.a.application,Object(qa.a)(this,this.m6,"showHideComments")),this.ia.ra(Ad.a.HOe,Fe.a.application,
Object(qa.a)(this,this.iKa,"queryShowHideComments"),97));this.ZRf&&(this.ia.ya(Ad.a.qRa,Fe.a.application,Object(qa.a)(this,this.v2b,"deleteAllComments")),this.ia.ya(Ad.a.Hub,Fe.a.application,Object(qa.a)(this,this.v2b,"deleteAllComments")),this.ia.ya(Ad.a.Iub,Fe.a.application,Object(qa.a)(this,this.v2b,"deleteAllComments")));this.ia.ya(Ad.a.YMb,Fe.a.application,Object(qa.a)(this,this.m6,"showHideComments"));this.ia.ra(Tb.a.oPe,Za.a.frame,Object(qa.a)(this,this.iKa,"queryShowHideComments"),97);this.ia.ra(Ad.a.iKa,
Fe.a.application,Object(qa.a)(this,this.iKa,"queryShowHideComments"),97);this.ia.ra(Ad.a.KJb,Fe.a.application,Object(qa.a)(this,this.iKa,"queryShowHideComments"),97);this.ia.ra(Ad.a.skd,Fe.a.application,Object(qa.a)(this,this.iKa,"queryShowHideComments"),97);this.ia.ya(Ad.a.kFe,Fe.a.application,Object(qa.a)(this,this.Aed,"nudgeCommentMarker"));this.ia.ya(Ad.a.lFe,Fe.a.application,Object(qa.a)(this,this.Aed,"nudgeCommentMarker"));this.ia.ya(Ad.a.mFe,Fe.a.application,Object(qa.a)(this,this.Aed,"nudgeCommentMarker"));
this.ia.ya(Ad.a.nFe,Fe.a.application,Object(qa.a)(this,this.Aed,"nudgeCommentMarker"));this.ia.ya(Ad.a.xOb,Fe.a.application,Object(qa.a)(this,this.xOb,"toggleCommentAnchoringFocus"));this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.ya(Tb.a.avb,Fe.a.application,Object(qa.a)(this,this.avb,"doesCommentExist")),this.ia.ya(Tb.a.F0b,Fe.a.application,Object(qa.a)(this,this.F0b,"commentActivitySelected")));this.Ee()}Ee(){var ba=this.Fa.Fc(Vf.AFrame.hj),Aa=
this.Fa.Fc(sd.a.Ez);const Wa=this.Fa.Fc(sd.a.QR);ba.bindAction(Ch.KeyInputManager.Oa(pd.a.Pza,1),Ad.a.xOb);Aa.bindAction(Ch.KeyInputManager.Oa(pd.a.Pza,1),Ad.a.xOb);Wa.bindAction(Ch.KeyInputManager.Oa(pd.a.Pza,1),Ad.a.xOb);ba=this.Fa.Fc(sd.a.Kp);Aa=[ba,this.Fa.Fc(rg.a.PD),this.Fa.Fc(rg.a.Y2),this.Fa.Fc(sd.a.sg),this.Fa.Fc(sd.a.kQ)];for(const gb of Aa)gb.bindAction(Ch.KeyInputManager.Oa(pd.a.Vga,Ch.KeyInputManager.Oe|(Wb.a.wk?4:1)),Ad.a.jUa);ba.bindAction(Ch.KeyInputManager.Oa(pd.a.Qza,1),Ad.a.jUa)}dKb(ba,
Aa,Wa,gb=-1){this.Eva=Aa;!this.pn&&this.BO&&(this.pn=new Jd(this.BO,this,this.UDb,this.Eva,this.gdb),this.$n.Wcd=this.pn);if(ba){Xg.g3j(ba);Aa=null;this.pa.C_()&&(Aa=this.pa.Na);var nb=0<ba.length?ba[ba.length-1]:null;if(this.pn){var lc=this.pn.vLb?this.pn.vLb.comment:null;const jd=lc?lc.commentId:null;this.pn.isRightToLeft=this.Eva;this.pn.qld(ba);this.$n&&(this.l_()||this.Dvb())&&(this.$n.rNc(),this.$n.UMc());this.pn.selectComment(null,!1);if(this.hi)lc=this.Fwb(this.hi.commentId),this.$n&&this.$n.OUe(lc,
jd,!1),this.pn.selectComment(lc,!0);else if(Wa&&lc){const xd=this.Fwb(lc.commentId);this.$n&&(this.zm.isVisible||!xd||1!==xd.status&&2!==xd.status)&&(this.pn.selectComment(lc,!1),this.$n.OUe(lc,jd,!1,!0))}else this.xad&&nb&&(this.cga(nb.commentId,1,!1),this.pn.selectComment(nb,!1));this.pn.ywh(this.idb);this.idb&&this.$n.Pub(this.SVa)}this.teb=ba.length;ba=this.r_e(ba);this.D$=this.QHg.azl(ba,this.So);this.zfb=this.QHg.$yl(ba);Wa?(this.E1a(!0),this.e0.Iph(Array.clone(this.D$),this.teb,Array.clone(this.zfb)),
this.xad&&nb&&this.e0.selectComment(nb.commentId)):(Wa=[],this.Dvb()&&(Wa=this.z3f(!1),Wa=[Object.assign(new Oi,{draftId:this.hi.uC.draftId,insertIndex:0>gb?0:Wa})]),0>gb?this.e0.dVe(this.D$.length,this.teb,this.So,this.tre.K1c,Wa):this.e0.k9k(this.D$.length,this.teb,gb,this.So,Wa),this.e0.hVe(Array.clone(this.D$),Array.clone(this.zfb)));if(this.Xfc){if(gb=this.Fwb(this.Xfc))this.selectComment(gb,null,!0,!0,0,1,!1),this.Xfc=null}else Aa&&this.pa.RE(Aa);ba=this.HOf(ba);this.r4&&ba&&this.r4.count>ba.length&&
this.KMi(ba);this.ikh(ba);this.sre&&this.fHl();this.xad=!1}else this.e0.dVe(0,0,this.So,1),this.e0.hVe([],[]),this.teb=0,this.pn&&(this.pn.isRightToLeft=this.Eva,this.pn.qld(null)),this.zfb=this.D$=null,this.CFh(!1,!1),this.z2b()}Ksa(){this.K0b&&this.aPc();this.hasFocus?this.hi&&this.qad.Kmg&&!this.eVf()&&this.Fa.iD(sd.a.Ez):this.Fa.iD(this.zm.isVisible?sd.a.Kp:sd.a.vW)}rUk(){this.G$c=null;this.JHe()}mHb(){this.Ksa();this.pa.ey();return!1}dFf(ba){if(this.hi){if(!this.hi.uC)throw Gb.a.J(512496716,
805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",ba),E.a.Ys(-2130915320);this.endCommentSession(this.hi.uC.draftId,ba)}else Gb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",ba),this.endCommentSession("",ba)}URi(){this.bFb=this.Fa.Ae.name===(this.zm.isVisible?sd.a.Kp:sd.a.vW);this.qad.cwf(!0)}BPf(){this.qad.cwf(!1);this.bFb&&(this.Fa.iD(this.zm.isVisible?sd.a.Kp:sd.a.vW),
this.bFb=!1)}Vxk(ba,Aa){if(ba&&ba.name!==sd.a.Kp&&ba.name!==sd.a.vW&&Aa.name===sd.a.Ez)if(this.zm.isVisible)this.PQc();else if(this.hi){ba="";switch(this.hi.LQa){case 0:ba=this.hi.uC?this.hi.uC.draftId:"";break;case 1:case 2:if(Aa=this.hl.l$d(this.hi.commentId))ba=this.hl.qta(Aa).commentId}this.Jr.selectContainer(ba,!0)}this.bFb=!0}Uxk(){this.bFb=!1}PQc(){this.zm.isVisible&&this.hgb.r0i()}rkc(ba,Aa,Wa){this.Fte=ba;this.Rb.updateCommandUI();(Rb.a("FixAltF12KeboardingInCommentPane")||!this.tH)&&this.Fte&&
Aa&&this.PQc();ba||Wa||this.mMa(1)}n3d(ba){var Aa=this.ua.presentation;if(!Aa)return!1;Aa=Aa.slides;if(!Aa)return!1;for(const Wa of Aa)if(Aa=Object($a.a)(Hd.a,Wa))if(Aa=this.hl.rta(Aa.XD()),ba)for(const gb of Aa){if(1===gb.status)return!0}else{if(Aa&&0<Aa.length)return!0}else Gb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}JLi(){this.hl.qRa();const ba=this.hl.$y();ba&&ba.length?this.Ccb.kwh():this.Ccb.iwh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}Aed(ba,
Aa,Wa){if(1===Wa)return 32;if(null!==this.vph){Aa=this.vph;switch(ba){case Ad.a.kFe:Aa.pos.Y+=20;break;case Ad.a.lFe:Aa.pos.X-=20;break;case Ad.a.mFe:Aa.pos.X+=20;break;case Ad.a.nFe:Aa.pos.Y-=20}this.pn.dGl(Aa);this.Zbk.VHk(Aa)}return 32}v2b(ba,Aa,Wa){return!this.ZRf||this.So||this.hi&&this.hi.uC?8:1===Wa?this.f9i(ba):this.HLi(ba)}f9i(ba){switch(ba){case Ad.a.qRa:return this.hl.$y()&&this.hl.$y().length?32:8;case Ad.a.Hub:return this.n3d(!1)?32:8;case Ad.a.Iub:return 1!==this.Rdc.jja&&this.n3d(!0)?
32:8;default:return Gb.a.J(512496712,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",ba),2}}HLi(ba){switch(ba){case Ad.a.qRa:this.JLi();break;case Ad.a.Hub:this.Ccb.jwh(this.hl,!1);break;case Ad.a.Iub:this.Ccb.jwh(this.hl,!0);break;default:return Gb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",ba),2}return 32}m6(ba,Aa,Wa,gb,nb){if(1===Wa)return!this.ua.Ba||this.isDisabled?8:32;Aa=!this.zm.isVisible;
Wa=this.tR.Ei("UserAction",String.format("ShowHideComments: {0}",Aa?"ShowPane":"HidePane"));Gb.a.J(36983504,805,50,"New Comment Pane opened.");ba===Ad.a.YMb?(this.SBl(!this.gdb),this.DQe()):ba===Ad.a.Krc?(this.idb=!this.idb,this.$n.Fqd=this.idb,this.DQe()):this.soc(Aa,!!nb&&nb.AutoShowHide);Wa&&Wa.stop();return 32}LSi(){this.zm.isVisible&&this.cga(this.hi.uC.draftId,1,!1)}xOb(){var ba=this.Fa.Ae.name;if(this.hi&&this.hi.uC)return ba===sd.a.sg?(this.Ksa(),Rb.a("FixAltF12KeboardingInCommentPane")||
Rb.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.LSi()):this.Fa.rf(sd.a.sg),32;if(this.$n.Pxh||this.$n.DW){if(ba===sd.a.sg||ba===sd.a.QR){var Aa=this.$n.DW;this.zm.isVisible||(ba=0,Aa&&(ba=Aa.get_shapeId()),this.lph(ba,!1));this.Ksa();return 32}if(kd.a.contains(this.kCf,ba)){if((Aa=this.sLb)&&Hc.HN(Aa)){if(ba=Hc.Z6b(Aa,this.$n.DW),ba.isValid){const Wa=[];for(let nb=0;nb<ba.paragraphs.length;nb++){const lc=ba.paragraphs[nb];lc&&Wa.push(Ue.SelectionFactory.k3(lc,ba.cV.equals(lc)?ba.startPos:
0,ba.u3.equals(lc)?ba.endPos:Ib.ParagraphReader.textLength(lc)))}const gb=new Od.SelectionCollection(Wa,0);Aa.textAnchoringInfo.AnchoringShape&&Aa.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Fa.rf(sd.a.QR),this.OBg.execute(nb=>{(nb=Object($a.a)(308,nb.Qd))&&this.OBg.instance.ath(Object($a.a)(fe.a,nb),gb)})):(this.Fa.rf(sd.a.sg),this.pa.RE(gb))}}else this.Fa.rf(sd.a.sg);return 32}}else{if(kd.a.contains(this.kCf,ba))this.Fa.rf(sd.a.sg);else{ba=null;ba=this.Kc&&this.Kc.Ic?this.hl.C9a(this.Kc.Ic.Fd):
this.r_e(this.hl.$y());if(!kd.a.Wa(ba))for(Aa of ba)if(this.zm.isVisible||0===Aa.status){this.cga(Aa.commentId,1,!1);break}this.Ksa()}return 32}return 8}hwf(ba,Aa){ba&&!Aa?this.tH?this.aPc():(this.Fa.Ej(sd.a.Kp,!0),this.Ksa(),this.PQc()):Aa?ba&&this.Fa.a9(sd.a.Kp,sd.a.hj,this.zm,!1):0<this.$6d()||this.hi&&this.hi.uC?this.Fa.Ej(sd.a.vW,!0):this.Fa.Ej(sd.a.Kp,!1);Aa||this.Iqh()}hsk(){this.t$c||(this.Ik.daa(this.Ik.SUd,this.Ik.IWd),this.Ik.baa(this.Ik.SUd,this.Ik.IWd),this.t$c=!0,this.lE.isk(this.ua.fk));
this.zX&&this.zX.eXi()}Iqh(){const ba=this.hl.$y();ba&&0<ba.length&&(this.Hyg=!0)}l_(){var ba=this.hl.$y();if(!ba||!ba.length)return!1;ba=zg.e(ba,Aa=>0===Aa.status);return!!ba&&0<ba.length}iKa(ba,Aa,Wa,gb,nb){ba===Ad.a.iKa?nb[xg.a.On]=this.zm.isVisible:ba===Ad.a.KJb||ba===Tb.a.oPe?nb[lh.a.On]=this.zm.isVisible:ba===Ad.a.skd?nb[lh.a.On]=this.gdb:ba===Ad.a.HOe&&(nb[lh.a.On]=this.idb);return!this.ua.Ba||this.isDisabled?16:32}avb(ba,Aa,Wa,gb,nb){return 2!==Wa?32:(ba=this.WUf(nb))&&this.findComment(ba)?
32:8}F0b(ba,Aa,Wa,gb,nb){return 2!==Wa?32:(ba=this.WUf(nb))&&this.Sok(ba)?32:8}WUf(ba){if(!ba)return null;ba=ba.NavigationId;if(!ba)return null;try{return JSON.parse(ba)}catch(Aa){return Gb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",Aa),null}}Sok(ba){if(ba.sId!==this.Kc.Ic.Fd.sid){var Aa=bd.a.VE(ba.sId,ba.cId);Aa=this.S$d(Aa);if(!Aa)return!1;this.Ha.Ln?this.cYa.IJ(Aa.me):this.Ge.IJ(Aa.me)}Aa=this.findComment(ba);if(!Aa)return!1;1!==Aa.status&&2!==Aa.status||this.Xqd();
this.cga(ba.commentId,1,!1);return!0}findComment(ba){var Aa=this.ua.presentation;if(!Aa)return null;Aa=Aa.slides;if(!Aa)return null;for(const Wa of Aa)if((Aa=Object($a.a)(Hd.a,Wa))&&Aa.sid===ba.sId){Aa=this.hl.rta(Aa.XD());for(const gb of Aa){if(gb.commentId===ba.commentId)return gb;if(gb.Children&&gb.Children.length)for(const nb of gb.Children)if(nb.commentId===ba.commentId)return nb}}return null}isCollapsed(){return!1}get vph(){return null}clearSelection(){}AUk(){this.Rb.updateCommandUI()}get J$a(){return!!this.hi}cui(){this.hi&&
this.dFf(8)}G5(ba){2===ba.behavior&&ba.actionId===Ad.a.GZa&&(ba=this.xt.ESc(!0),ba!==Ad.a.Vhd&&ba!==Ad.a.iQ&&ba!==Ad.a.qRa&&ba!==Ad.a.Hub&&ba!==Ad.a.Iub||ac.UISurfaces.oL().then(Aa=>{this.Ccb.WXk(Aa)}))}F5(){}static XYg(ba,Aa){return ba.contentId===Aa}static g3j(ba){let Aa="";if(ba){for(const Wa of ba)if(Aa+=Wa.commentId+";",Wa.Children)for(const gb of Wa.Children)Aa+=gb.commentId+";";Gb.a.J(512496659,805,15,"LogCommentIds() - {0}",Aa)}}}Object(h.a)(Xg,"SharedCommentFrame",null,[1193,106,1194,145]);
class Qi{constructor(ba,Aa,Wa,gb,nb,lc,jd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ba;this.parentId=Aa;this.commentBody=Wa;this.author=gb;this.date=nb;this.commentFlags=lc;this.usersByReactionType=jd}}Object(h.a)(Qi,"OfficeSharedCommentModel",null,[]);class Jh{constructor(ba,Aa){this.CommentId=ba;this.ResolveState=Aa}}Object(h.a)(Jh,"CommentProperties",null,[]);class Og{constructor(){this.email=
this.fullName="";this.resolveState=0}}Object(h.a)(Og,"AtMentionAttributes",null,[]);class Qh{constructor(){this.contentId=""}}Object(h.a)(Qh,"AtMentionOptionalAttributes",null,[]);class Yg{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(h.a)(Yg,"DeltaAttributes",null,[]);var If;(function(ba){ba[ba.Undo=-1]="Undo";ba[ba.Unknown=0]="Unknown";ba[ba.Create=1]=
"Create";ba[ba.Assign=2]="Assign";ba[ba.Unassign=3]="Unassign";ba[ba.UnassignAll=4]="UnassignAll";ba[ba.Schedule=5]="Schedule";ba[ba.Progress=6]="Progress";ba[ba.Delete=7]="Delete";ba[ba.Restore=8]="Restore";ba[ba.SetTitle=9]="SetTitle";ba[ba.Priority=10]="Priority"})(If||(If={}));Object(h.b)("HistoryRecordType",If);class mj{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(h.a)(mj,"CommentAtMention",null,[]);var xi=d(904);class Bj{constructor(){this.UserId=this.ProviderId=
this.FullName=this.Email=this.DisplayName=null}}Object(h.a)(Bj,"UserInfo",null,[]);class yi{constructor(ba,Aa){this.plainText=ba;this.w0g=Aa}}Object(h.a)(yi,"TextTranslationResult",null,[]);var Zg=d(68);class ya{constructor(ba,Aa,Wa){this.d4k="[";this.uhi=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.F0j=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.vhi=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.dsg=!1;this.$Ii=gb=>{if(!gb)return null;let nb={};for(const lc of gb){a:{switch(lc.Type){case "\ud83d\udc4d":gb=
1;break a;default:Gb.a.J(509220245,805,50,"Unsupported reaction type")}gb=void 0}void 0!==gb&&(nb[gb.toString()]=this.aMk(lc.ReactionInstances))}return nb};this.aMk=gb=>{let nb=[];for(const lc of gb)gb=lc.User,nb.push({DateUtc:lc.Time,DisplayName:gb.DisplayName,Email:gb.Email,Provider:gb.ProviderId,UserId:gb.UserId,IsCurrentUser:this.isCurrentUser(lc.User.UserId,lc.User.ProviderId)});return nb};this.Qb=ba;this.SBe=Aa;this.hye=Wa}get userId(){return this.Qb.appSettings["387"]}get providerId(){return this.Qb.appSettings["388"]}Hkj(ba,
Aa){let Wa=0;if(1===ba.status||2===ba.status)Wa|=8;Aa&&(Wa|=1);this.fkl(ba)&&(Wa|=16);this.Qb.ka("PPTOBlueDotsForComments")&&ba.isUnread&&(Wa|=32);return Wa}isCurrentUser(ba,Aa){return ba?"Author"===ba||this.userId===ba&&Aa===Aa?!0:!1:!1}nMj(ba){return this.isCurrentUser(ba.userId,ba.providerId)}fkl(ba){return""===ba.userId||"Author"===ba.userId||!this.jKl(ba.userId)||this.userId===ba.userId&&this.providerId===ba.providerId?!1:!0}jKl(ba){return 3===ba.split("::").length}NDh(ba,Aa,Wa){var gb;if(null===
ba)throw Error.argumentNull("comment");const nb=this.czl(ba.text);var lc=ba.authorName,jd=Rb.a("PPTPlumbEmailThroughCG")?Ba.a.L8a(ba.userId||""):"";const xd=ba.dt;Wa=this.Hkj(ba,Wa);lc=new jb(ba.userId,ba.providerId,lc,jd,this.nMj(ba));return ad(this.Qb)&&(null===ba||void 0===ba?0:ba.reactions)?(jd=this.$Ii(null===(gb=ba.reactions)||void 0===gb?void 0:gb.ReactionList),new Qi(ba.commentId,Aa,nb,lc,xd,Wa,jd)):new Qi(ba.commentId,Aa,nb,lc,xd,Wa)}azl(ba,Aa){if(null===ba)throw Error.argumentNull("comments");
const Wa=new n.a;for(const gb of ba)if(Wa.add(this.NDh(gb,"",Aa)),gb.Children&&0<gb.Children.length)for(const nb of gb.Children)Wa.add(this.NDh(nb,gb.commentId,Aa));return Wa.toArray()}gzl(ba,Aa,Wa,gb){const nb=Object.assign(new xi.a,{Asignees:[]});ba=this.SBe.O2i(ba,Aa,!Aa.taskId,Wa);for(const lc of ba)2===lc.type?lc.assignee?(ba=Object.assign(new Bj,{DisplayName:lc.assignee.DisplayName,FullName:lc.assignee.DisplayName,UserId:lc.assignee.UserId,ProviderId:lc.assignee.Provider,Email:lc.assignee.Email}),
nb.Asignees.push(ba)):Gb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===lc.type&&(nb.Title=lc.title);if(!nb.Asignees)return Gb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),null;nb.Title||(Gb.a.J(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),nb.Title=gb);return nb}ezl(ba,Aa){const Wa=new xi.a;if(ba.assignee){const gb=new Bj,
nb=ba.assignee;gb.DisplayName=nb.Name;gb.FullName=nb.Name;gb.UserId=nb.UserPrincipalName;gb.ProviderId="O365";gb.Email=nb.UserPrincipalName;Wa.Asignees=[gb]}Wa.Title=ba.title?ba.title:Aa;return Wa}fzl(ba,Aa,Wa){if(!Aa)return null;try{const gb=this.$td(Wa,new Date).plainText,nb=this.hye?this.gzl(ba,Aa,Wa,gb):this.ezl(Aa,gb);if(!nb)return null;nb.CompletionPercentage=Aa.completion?Aa.completion:0;return nb}catch(gb){Gb.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",
gb)}return null}$yl(ba){if(null===ba)throw Error.argumentNull("comments");const Aa=new n.a;for(const Wa of ba)Wa.taskInfo&&Wa.taskInfo.Asignees&&0<Wa.taskInfo.Asignees.length&&(ba=this.Zyl(Wa))&&Aa.add(ba);return Aa.toArray()}Zyl(ba){if(this.hye&&this.SBe&&0<ba.taskInfo.TaskHistoryRecords.length)try{const Aa=ya.ABi(ba.taskInfo.TaskHistoryRecords),Wa=new Zg.a;Wa.add(ba.commentId,new Jh(ba.commentId,100===ba.taskInfo.CompletionPercentage));const gb=this.SBe.LIi(ba.commentId,ba.commentId,Aa,Wa);ya.gsi(ba,
gb,this.hye);return gb}catch(Aa){return Gb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",Aa.message),this.MDh(ba)}else return this.MDh(ba)}MDh(ba){var Aa=new da;Aa.startDate=ba.taskInfo.StartDate;Aa.endDate=ba.taskInfo.DueDate;const Wa=new na(ba.taskInfo.Asignees[0].UserId);Wa.DisplayName=ba.taskInfo.Asignees[0].DisplayName;Wa.Provider=ba.taskInfo.Asignees[0].ProviderId;Wa.Email=ba.taskInfo.Asignees[0].Email;const gb=Array(1);gb[0]=Wa;Aa=new fa(!1,ba.taskInfo.Title,
gb,Aa,ba.taskInfo.CompletionPercentage,0);return new F(ba.commentId,ba.commentId,Aa,[])}czl(ba){if(null===ba)throw Error.argumentNull("nativeText");const Aa=new sa;ba=ba.split(this.vhi);for(const gb of ba){var Wa=this.uhi.exec(gb);Wa&&3===Wa.length?(ba=new Og,Wa[0].substring(0,1)===this.d4k?(ba.fullName=Wa[2],ba.resolveState=1):(ba.fullName=Wa[1],ba.resolveState=0),ba.email="UnknownEmail",Wa=new Qh,Wa.contentId="Pre-existing Mention",Aa.zHj("@"+ba.fullName,ba,Wa),this.dsg||(this.dsg=!0,Gb.a.J(512496653,
845,15,"Rendering mention when AtMentions are disabled."))):(ba=this.F0j.exec(gb))&&1===ba.length?(ba=ba[0],Aa.insertHyperLink(ba,Object.assign(new Yg,{link:ba}))):Aa.$Hj(gb)}return Aa.j9i()}$td(ba,Aa){var Wa=Sys.Serialization.JavaScriptSerializer.deserialize(ba);ba=[];Aa||(Aa=new Date);const gb=new Sys.StringBuilder;for(const nb of Wa.ops)if(nb.attributes){if(nb.attributes.atmention){const lc=1<nb.insert.length?nb.insert.substring(1,nb.insert.length):"";if(nb.optional&&nb.optional.atmention&&nb.optional.atmention.contentId)Wa=
ya.K3f(lc,1===nb.attributes.atmention.resolveState);else{Wa=ya.K3f(lc,1===nb.attributes.atmention.resolveState);const jd=ya.Qej(Aa,1===nb.attributes.atmention.resolveState);Array.add(ba,Object.assign(new mj,{FullName:nb.attributes.atmention.fullName,DispName:lc,Id:jd,Email:nb.attributes.atmention.email}));Aa=new Date(Aa.getTime()+1)}}else nb.attributes.link||Gb.a.J(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Wa=nb.insert;gb.append(Wa)}else gb.append(nb.insert);
return new yi(gb.toString(),ba)}static ZBi(ba){switch(ba){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static WBi(ba){var Aa=null;ba.User&&(Aa=new na(ba.User.UserId,ba.User.ProviderId,ba.User.DisplayName));Aa=new ca(ya.ZBi(ba.HistoryRecordType),Aa,ba.DtTime,ba.RecordId);Aa.commentId=ba.CommentId;ba.Assignee&&(Aa.assignee=new na(ba.Assignee.UserId,ba.Assignee.ProviderId,
ba.Assignee.DisplayName));ba.StartDate&&ba.DueDate?(Aa.schedule=new da,Aa.schedule.startDate=ba.StartDate?ba.StartDate:null,Aa.schedule.endDate=ba.DueDate?ba.DueDate:null):ba.StartDate&&!ba.DueDate?Gb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):!ba.StartDate&&ba.DueDate&&Gb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Wa=ba.Priority;0<Wa?Aa.priority=Wa:Gb.a.J(512496649,
845,10,"Priority is negative");Wa=ba.CompletionPercentage;0<=Wa?Aa.completion=Wa:Gb.a.J(512496648,845,10,"Percent complete is negative");Aa.title=ba.Title;Aa.undoId=ba.UndoId;return Aa}static ABi(ba){const Aa=ba.length,Wa=Array(Aa);for(let gb=0;gb<Aa;++gb)Wa[gb]=ya.WBi(ba[gb]);return Wa}static gsi(ba,Aa,Wa){const gb=Aa.currentState,nb=ba.taskInfo;let lc=!1;const jd=Rb.a("SetTaskFromTaskStateInsteadOfHistory");nb.StartDate.toString()!==gb.schedule.startDate.toString()&&(jd&&(gb.schedule.startDate=
nb.StartDate),lc=!0,Gb.a.J(512496647,845,10,"Start Date does not match."));nb.DueDate.toString()!==gb.schedule.endDate.toString()&&(jd&&(gb.schedule.endDate=nb.DueDate),lc=!0,Gb.a.J(512496646,845,10,"End Date does not match."));nb.CompletionPercentage!==gb.completion&&(jd&&(gb.completion=nb.CompletionPercentage),lc=!0,Gb.a.J(512496645,845,10,"Completion percentage does not match."));nb.Title!==gb.title&&(jd&&(gb.title=nb.Title),lc=!0,Gb.a.J(512496644,845,10,"Title does not match."));nb.Asignees[0].UserId!==
gb.assignees[0].UserId&&(jd&&(gb.assignees[0].UserId=nb.Asignees[0].UserId),lc=!0,Gb.a.J(512496643,845,10,"Assigned to user id does not match."));nb.Asignees[0].DisplayName!==gb.assignees[0].DisplayName&&(jd&&(gb.assignees[0].DisplayName=nb.Asignees[0].DisplayName),lc=!0,Gb.a.J(512496642,845,10,"Assigned to display name does not match."));nb.Asignees[0].ProviderId!==gb.assignees[0].Provider&&(jd&&(gb.assignees[0].Provider=nb.Asignees[0].ProviderId),lc=!0,Gb.a.J(512496641,845,10,"Assigned to provider id does not match."));
nb.Asignees[0].Email!==gb.assignees[0].Email&&(jd&&(gb.assignees[0].Email=nb.Asignees[0].Email),Wa||(lc=!0,Gb.a.J(512496640,845,10,"Assigned to email does not match.")));if(lc&&Wa&&(ya.F5j(ba,Aa),Rb.a("IsThrowForTaskStateMismatchEnabled")))throw Gb.a.J(0,845,10,"There was a mismatch between the state and state as determined by history"),Error.create("TaskStateMismatch");}static F5j(ba,Aa){const Wa=new n.a;for(const gb of Aa.history)for(const nb of gb.records)Wa.add(If[nb.type]);if(Wa.count!==ba.taskInfo.TaskHistoryRecords.length){Aa=
new n.a;for(const gb of ba.taskInfo.TaskHistoryRecords)Aa.add(If[gb.HistoryRecordType]);Gb.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static Qej(ba,Aa){ba=ba._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return Aa?ba+"_Z":ba}static K3f(ba,Aa){return Aa?"[@"+ba+"]":"<@"+ba+">"}}Object(h.a)(ya,"SharedCommentModelTranslator",null,[1190]);class La{constructor(ba,Aa,Wa){this.TWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled")&&
e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");this.xgf=!1;this.Fa=ba;this.Pg=Aa;this.TBb=Wa}cwf(ba){ba?(this.TWa&&this.TBb&&this.TBb.isVisible||this.Pg.rI(sd.a.Ez),this.Pg.Lo(sd.a.Kp),this.Fa.iD(sd.a.Ez)):(this.Pg.Lo(sd.a.Ez),this.TBb.isVisible&&!this.TWa&&this.Pg.rI(sd.a.Kp));this.xgf=ba}get Kmg(){return this.xgf}}Object(h.a)(La,"SharedCommentsRTEFocusActionHelper",null,[1125]);class Qa{constructor(ba,Aa,Wa,gb){this.cancelButton=this.confirmButton=this.body=this.title=
null;this.title=ba;this.body=Aa;this.confirmButton=Wa;this.cancelButton=gb}}Object(h.a)(Qa,"ViewContainerModalDialogStrings",null,[]);class Eb{constructor(ba,Aa,Wa){this.containerType="full-pane";this.identifier=null;this.kb=ba;this.Fa=Aa;this.identifier=Wa}closeView(){this.kb.soc(!1,!1)}openView(){this.kb.soc(!0,!1)}invokeModalConfirmationDialog(ba,Aa,Wa){const gb=new kb.StandardDialog;Wa&&Wa.title&&Wa.body&&Wa.confirmButton&&Wa.cancelButton||(Gb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),
Wa=new Qa("","","",""));gb.yd=1;gb.Xe(1,Wa.confirmButton);gb.Xe(0,Wa.cancelButton);gb.e8a=this.Fa.Ae.name;gb.Ujc=!0;gb.Gx(Wa.title,Wa.body,1,nb=>{1===nb?(ba(),gb.e8a=null):Aa()})}}Object(h.a)(Eb,"ViewContainerAPI",null,[1184,1185]);class fc extends Sys.EventArgs{constructor(){super()}}Object(h.a)(fc,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var mc=d(280);class Mc{constructor(){this.kHg=this.WVg=this.hgb=this.HXg=this.Uva=this.a4c=this.fIa=this.c4c=this.YQ=this.K=null;this.edb=this.qva=this.wCb=
!1;this.tR=this.Are=null;this.bJg="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.nO=null;this.TWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.tH=!1}Zb(ba){this.K=ba;this.tH=this.K.resolve("PowerPointWebEditor.IApplicationSettings").MWd;this.tR=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.hgb=new K(e.AFrameworkApplication.ye,"CommentPane");ba.register(kc,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().oa(()=>
new kc);const Aa=this.K.resolve("PowerPointWebEditor.IFileInfo").jja,Wa=2===Aa||3===Aa;this.wCb=Wa;this.edb=1===Aa;ba.register(Hf,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().oa(()=>new Hf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),Aa));ba.register(Kd,
"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().oa(()=>new Kd(this.tR,Aa,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.Ja("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));const gb=this.wCb||!this.edb;this.nO=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");gb&&ba.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().oa(()=>
new mc.a((Kc,Zc)=>{let Sc=null;const ld=Object($a.a)(117,Kc.sc(ba.resolve("Box4.IPageView").Ma));ld&&!ld.Al&&(Kc=ba.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").dZd(ba.resolve("PowerPointWebEditor.IPptSelectionManager"),null,Kc,Zc,ld.WU),Sc=new Ld(Kc),Sc.Jm(ld.WU),ld.xra(Sc,5),Sc.visible=ld.BQ||ld.Wn);return Sc}));this.K.register(1122,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().oa(()=>new tf(this.nO,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),ba.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(1123,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().oa(()=>new Id(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Md,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.nO));const nb=this.wCb||!this.edb;this.K.register(1124,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().oa(()=>new $f(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),
this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new fb(nb),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),nb,nb));this.K.register(lf,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().oa(()=>new lf(!this.edb,this.K.resolve("Common.Utils.IHighContrastDetector")));const lc=new $d(gb,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),gb?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):
null,this.nO,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));ba.register(1125,"PowerPointWebEditor.IRTEFocusActionHelper").ma().oa(()=>new La(ba.resolve("Common.IFocusManager"),
ba.resolve("Common.IF6Manager"),ba.resolve("PowerPointWebEditor.ICommentsPane")));this.K.register(D,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().oa(()=>new D(this.K.resolve("Common.ITaskManager")));const jd=this.K.resolve("Common.IAppSettingsManager").ka("TasksHistoryEnabled");jd&&this.K.register(1126,"Common.Comments.ICommentTaskTranslator").ma().oa(()=>(new Ma(!0,jd,!0)).HDi());this.K.register(ya,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().oa(()=>
new ya(this.K.resolve("Common.IAppSettingsManager"),jd?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,jd));this.K.register(Oa,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().oa(()=>new Oa);this.qva=this.K.resolve("Common.IAppSettingsManager").ka("896")&&(Wa||!this.edb);this.K.register(Xg,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().oa(()=>new Xg(this.nO,
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").xa,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),
this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.hgb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),e.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Md,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.tR,lc,this.K.resolve("Common.IAppSettingsManager"),this.K.Ja("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),gb,ba.resolve("PowerPointWebEditor.IErrorHandler"),ba.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.qva,ba.resolve("Box4.Graph.IGraphInstance").xd(10),ba.resolve("PowerPointWebEditor.View.IViewEventSource"),
ba.resolve("PowerPointWebEditor.ICommentCloudPolicy"),nb,ba.resolve("PowerPointWebEditor.IShapeReader"),ba.Ja("Common.App.SafeLinks.ISafeLinksManager"),ba.resolve("Box4.ICharacterPropertiesEditor"),ba.resolve("PowerPointWebEditor.IFileInfo"),this.tH,ba.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").XIa?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):
null,this.K.Ja("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.Ja("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ln?this.K.resolve("PowerPointWebEditor.ISorterViewActorLazy"):null));this.K.register(hc,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().oa(()=>new hc(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").O6j));
this.K.register(Eb,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().oa(()=>new Eb(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.bJg));const xd=new Yc(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new Uf(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.nO,this.K.resolve("Common.IAppSettingsManager").ka("459"),
this.K.ke("PowerPointWeb.Comments.ICommentFrame"));this.K.register(1127,"PowerPointWebEditor.IFindCommentLogic").ma().oa(()=>new oe(xd,this.K.resolve("Common.ITaskManager")));this.K.register(Qb,"PowerPointWebEditor.CommentsChangeListener").ma().oa(()=>new Qb(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").xd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(1128,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().oa(()=>new Ta(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.nO,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));
this.K.register(Jf,"PowerPointWebEditor.CommentPropertyTracker").ma().oa(()=>new Jf(Object(qa.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").JHe,"onCommentPropertiesUpdated"),Mb.App.lP.kV,ob.GraphTransactionManager.instance));this.K.register(1129,"PowerPointWebEditor.ICommentsPane").ma().oa(()=>new ze(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Cua,
this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.tH));this.K.register(Cd,"PowerPointWebEditor.CommentSmartReplyProvider").ma().oa(()=>new Cd(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){ec.a.instance.jc(bc.a.LWd,(new Date).getTime());const ba=this.tR.Ei("UserAction","InitCommentsPackage"),Aa={};this.tH||(this.fIa=this.K.resolve("PowerPointWebEditor.ICommentsPane").xa);this.YQ=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");
this.YQ.initialize();var Wa=ba.Vq;Aa.CommentFrameInitMS=Wa;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.c4c=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");this.c4c.WAj();const gb=ba.Vq;Aa.CommentPropertyTrackerInitMS=gb-Wa;this.Are=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");this.HXg=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var nb=Db.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Wa=nb.Ring||"Unknown";
nb=nb.WACDatacenter||"Unknown";const lc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").FKj;var jd=e.AFrameworkApplication.fa.Ga("LokiComplianceEnvironment");jd=jd&&""!==jd?jd:e.AFrameworkApplication.fa.Ga("SovereignEnvironmentName");this.WVg=new Va("PowerPoint",e.AFrameworkApplication.buildVersion,null,null,e.AFrameworkApplication.userSessionId,Wa,nb,!lc,this.K.resolve("Common.IActionManagerExtended"),null,jd);Wa=tc.a.xe(e.AFrameworkApplication.lcid);this.kHg=new Kb(e.AFrameworkApplication.isRtl,
Wa?Wa.name:Sys.CultureInfo.CurrentCulture.name,e.AFrameworkApplication.uiCulture,e.AFrameworkApplication.dataCulture);this.tH||(this.fIa.id=this.bJg);this.T8b();e.AFrameworkApplication.fa.ff(Object(qa.a)(this,this.Qm,"onFullAppSettingsReady"));(Wa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Wa.$Ok(new fc);Wa=ba.Vq;Aa.CommentReactPaneInitMS=Wa-gb;this.iEj();Aa.CommentPaneInitMS=ba.Vq-Wa;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",
!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();ba.stop();Gb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",Aa,this.K.resolve("Common.IAppSettingsManager").ka("896"))}iEj(){const ba=this.K.resolve("PowerPointWebEditor.ICommentsPane"),Aa=this.K.resolve("PowerPointWebEditor.IPaneManager");this.tH||(!this.TWa||this.TWa&&!document.getElementsByClassName("CommentPanel").length)&&Aa.RP(ba);Aa.aBb(2);
this.K.resolve("PowerPointWebEditor.IFocusManager").a9(sd.a.Kp,sd.a.hj,ba,!ba.isVisible)}T8b(){ec.a.instance.jc(bc.a.T8b,(new Date).getTime());const ba=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").kub().then(Aa=>{ec.a.instance.jc(bc.a.Eee,(new Date).getTime());Pa.a.av(ba.K.Ja("Common.App.People.IExternalPeopleAPI")).continueWith(Wa=>{ba.Uva=Wa.result;ba.Uva||Gb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");ba.K.resolve("PowerPointWebEditor.IApplicationSettings").vg&&
(Wa=ba.K.resolve("Common.IAppSettingsManager").Ga("368"),ba.Uva.h9g(Wa+"p"));Wa=[mb.a.contextMenu];ba.tH||qc.a.xld(ba.fIa,Wa);const gb=Aa&&(ba.wCb||!ba.edb),nb=ba.K.resolve("Common.IAppSettingsManager").ka("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");ba.K.register(Cf,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().oa(()=>new Cf(ba.K.resolve("Common.IAppSettingsManager"),ba.K.resolve("PowerPointWebEditor.IApplicationSettings"),
ba.Uva,ba.edb,gb,ba.qva));ba.K.register(Bd,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().oa(()=>new Bd(ba.K.resolve("PowerPointWeb.Comments.ICommentFrame"),ba.nO,ba.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),ba.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),ba.K.resolve("Common.ITaskManager"),ba.K.resolve("Common.IAppSettingsManager"),ba.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),ba.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
ba.Uva,ba.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),ba.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),gb,ba.qva,nb,ba.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),ba.K.resolve("Common.IActionManagerExtended"),ba.K.resolve("PowerPointWebEditor.IApplicationSettings")));ba.a4c=ba.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{ba.a4c&&ba.a4c.checkAtMentionCapability().then(Wa=>{Wa&&((Wa=ba.K.Ja("Common.ISystemInitiatedFeedback"))?
Wa.execute(gb=>{gb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):Gb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});ba.gEj()})})}gEj(){ec.a.instance.jc(bc.a.PXe,(new Date).getTime());const ba=this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw,Aa=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Wa=this.K.resolve("Common.Comments.ICommentActivationManager");
ec.a.instance.jc("CommentActivationManagerInitStart",(new Date).getTime());Wa.initialize(ba,this.a4c,this.WVg,this.Uva,new oc(this.HXg,this.hgb),this.kHg,null,Aa.Ikj());ec.a.instance.jc(bc.a.k9b,(new Date).getTime());Wa.k9b().then(()=>{ec.a.instance.jc(bc.a.Fee,(new Date).getTime());this.YQ.JGj();ec.a.instance.jc(bc.a.Boe,(new Date).getTime());Gc.a(this.K)("floatingContainerManager").then(()=>{ec.a.instance.jc(bc.a.F4d,(new Date).getTime());this.YQ.rEj();ec.a.instance.jc(bc.a.G4d,(new Date).getTime());
if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").zgi){const gb=this.nO.$y();gb&&0<gb.length?(this.YQ.y8k(),ec.a.instance.jc(bc.a.xqd,(new Date).getTime()),jc.App.ALb(null,bc.a.xqd)):Gb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(gb=>{Gb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+gb.toString())})})}Qm(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.c4c&&
this.c4c.uCl();this.YQ&&this.YQ.dispose();this.Are&&this.Are.dispose();this.Uva=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){ec.a.instance.jc(bc.a.GWd,(new Date).getTime());ib.a.instance.Dc(new Mc)}}Object(h.a)(Mc,"CommentsPackage",null,[2,3]);var nd=d(12);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("RichContentEditAPI");Object(nd.c)("Comment");Mc.main();Object(nd.b)("Comment")},280:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(1024);class e{constructor(r){this.kl=new h.a;this.tYa=r}ZG(r){const n=r.id;let v=null;this.kl.Gb(n)?v=this.kl.ga(n):(this.tYa&&(v=this.tYa(r,()=>{this.Ioc(n)})),v&&this.kl.$(n,v));return v}IF(r){r=r.id;return this.kl.Gb(r)?this.kl.ga(r):null}Ioc(r){this.kl.remove(r)}}Object(J.a)(e,"ShapeComponentViewManager",null,[403])},689:function(J,
aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(18),e=d(97),r=d(29),n=d(50);d(98);class v{constructor(){this.w_=null}get pyb(){return!1}$Dh(B,y){let x=new h.a;const A=new n.GraphTransaction(3);try{A.kd(r.App.Kb.Ld.Dn.xg),this.Qac(y)&&(x=this.p9b(y,x)),y!==B&&this.Qac(B)&&(x=this.p9b(B,x))}finally{A&&A.dispose()}return x.toArray()}Qac(B){return!!B}Ild(B){let y=!1;for(const x of this.pde)y||!Sys.UI.DomElement.containsCssClass(B,x.className)&&!Sys.UI.DomElement.containsCssClass(B,x.w7b)||(y=!0),
e.a.tKa(B,x.className),e.a.tKa(B,x.w7b)}}Object(J.a)(v,"AHighlightActor",null,[966])},690:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r){this.className=e;this.w7b=r}}Object(J.a)(h,"HighlightCssClassPair",null,[])},691:function(J,aa,d){d.d(aa,"b",function(){return n});d.d(aa,"a",function(){return v});var h=d(97);d(29);var e=d(50);d(33);d(94);var r=d(98);const n=B=>{const y=new e.GraphTransaction(3);try{y.kd(B),B.Cv(32,!0)}finally{y&&y.dispose()}},v=B=>{if(B){B=h.a.cka(B);
if(-1===B.indexOf(r.a.l8)&&-1!==B.indexOf(r.a.rN)&&-1===B.indexOf(r.a.Z1b))return 2;if(-1===B.indexOf(r.a.l8)&&(-1!==B.indexOf(r.a.Y1b)||-1!==B.indexOf(r.a.FN)||-1!==B.indexOf(r.a.Z1b)||-1!==B.indexOf(r.a.SKc)||-1!==B.indexOf(r.a.FMc)||-1!==B.indexOf(r.a.DMc)||-1!==B.indexOf(r.a.CMc)||-1!==B.indexOf(r.a.FZd)||-1!==B.indexOf(r.a.AZd)||-1!==B.indexOf(r.a.CZd)||-1!==B.indexOf(r.a.EMc)||-1!==B.indexOf(r.a.zZd)))return 1;if(-1!==B.indexOf("WACImageContainer"))return 3}return 0}},692:function(J,aa,d){d.d(aa,
"a",function(){return h});J=d(0);class h{constructor(){this.type=this.action=0;this.aib=this.Ada=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.comment.js.map