'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1040:function(J,aa,d){J=d(0);var h;(function(r){r[r.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";r[r.peopleImageClassName=1]="peopleImageClassName";r[r.peopleImageClusterPath=4]="peopleImageClusterPath";r[r.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";r[r.imageDimension=6]="imageDimension";r[r.rtl=8]="rtl";r[r.pointerInputManager=9]="pointerInputManager";r[r.clickInputManager=
10]="clickInputManager";r[r.vertical=11]="vertical";r[r.zIndex=12]="zIndex";r[r.contextMenuInputManager=13]="contextMenuInputManager";r[r.imageDomElement=14]="imageDomElement";r[r.useIdleTooltip=15]="useIdleTooltip";r[r.viewportBoundsCallback=16]="viewportBoundsCallback";r[r.flipHorizontalDirection=17]="flipHorizontalDirection";r[r.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";r[r.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";r[r.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||
(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(aa,"a",function(){return e});class e{constructor(){this.Qy={}}get(r,n=null){r=h[r];return"number"===typeof n?(n=this.Qy[r])?Number.parseInvariant(n.toString()):0:this.Qy[r]}add(r,n){this.Qy[h[r]]=n}MD(r,n){h[r]in this.Qy||(this.Qy[h[r]]=n)}remove(r){delete this.Qy[h[r]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])},1051:function(J,aa,d){J=d(0);class h{constructor(r,n,v){this.YPc=r;this.xGh=n;this.C6e=v}}Object(J.a)(h,"ThemeData",null,[]);
d.d(aa,"a",function(){return e});class e{}e.bza=[new h("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",4),new h("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new h("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new h("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new h("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new h("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new h("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new h("0507925b-6ac9-4358-8e18-c330545d08f8",
"Slice",4),new h("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new h("98dff888-2449-4d28-977c-6306c017633e","Banded",4),new h("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new h("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new h("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new h("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new h("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new h("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new h("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
"Celestial",4),new h("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new h("4c5440d6-04d2-4954-96cf-f251137069b2","Metropolitan",8),new h("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new h("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new h("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new h("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(J.a)(e,"DesignManager_data",null,[])},1148:function(J,aa,d){J=d(0);var h=d(14),e=d(1204),r=d(238),n=d(239),v=d(67),B=d(97);class y extends r.a{constructor(D,
Q){super(D);this.Df=null;this.nI=Q.get(8,!1);this.hS=Q.get(6,0);this.element=D;this.element.className=y.c9a;this.I5a=this.createElement("ul");this.element.appendChild(this.I5a);this.Nn=Q.get(10);this.Nn.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.$o=Q.get(9);this.$o.pb(v.a.pointerOut,this.element,Object(h.a)(this,this.Cz,"onPointerOut"));this.$o.pb(v.a.pointerDown,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior"));this.dN=Q.get(13);this.dN.pb(this.element,
Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior"))}fW(D){this.addHandler(n.a.np,D)}k1(D){this.removeHandler(n.a.np,D)}get bba(){return this.Df}dispose(){this.element&&(this.Nn.yb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.$o.yb(v.a.pointerDown,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(v.a.pointerOut,this.element,Object(h.a)(this,this.Cz,"onPointerOut")),this.dN.yb(this.element,Object(h.a)(this,this.Qx,
"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(D,Q,Z){this.hide();!D||0>=D.length||(this.nI?this.element.style.right=Q+"px":this.element.style.left=Q+"px",this.element.style.top=Z+"px",this.JPd(D),this.visible=!0)}JPd(D){this.Df=D;B.a.Cu(this.I5a);for(let Q=D.length-1;0<=Q;Q--)this.Yx(D[Q])}Yx(D){const Q=document.createElement("li");Q.style.backgroundColor=D.color;Q.style.height=this.hS+"px";Q.id="fly_"+D.clientId;Q.style.lineHeight=this.hS+"px";B.a.Nx(Q,
D.userName);Q.setAttribute("dir","auto");this.I5a.appendChild(Q)}onClick(){this.hide();return!1}Cz(D){this.raiseEvent(n.a.np,new n.a(3,D));return!1}}y.c9a="prFlyout UIFont";Object(J.a)(y,"PresenceTooltipFlyoutControl",r.a,[]);var x=d(75);class A extends r.a{constructor(D,Q,Z){super(D);this.iN=null;this.Df=[];this.element.className="prGlyph";this.Jc=Q;this.z7=this.Jc.get(9);this.yn=this.Jc.get(10);this.dN=this.Jc.get(13);this.rde();this.Yx(Z);this.J3a=!1}get TO(){return this.Df.length}get bba(){return this.Df}fW(D){this.addHandler(n.a.np,
D)}k1(D){this.removeHandler(n.a.np,D)}dispose(){this.I4e();super.dispose()}Yx(D){Array.add(this.Df,D);2===this.TO?this.Zaa(!0):1===this.TO?this.Zaa(!1):this.Zaa(this.J3a)}TJ(D){this.a4d(D)&&(1<this.TO&&this.Zaa(!0),1===this.TO?this.Zaa(!1):1>this.TO&&this.hide())}show(){this.Zaa(2<=this.TO);this.visible=!0}hide(){this.visible=!1}n8d(D){return D?this.z5b(0,5):this.z5b(1,4)}a4d(D){for(let Q=0;Q<this.TO;Q++)if(this.Df[Q].clientId===D)return D=this.Df[Q],Array.removeAt(this.Df,Q),D;return null}Zaa(D){this.J3a!==
D&&(this.iN&&this.element.removeChild(this.iN),this.iN=this.n8d(D),this.element.appendChild(this.iN),this.J3a=D);this.iN.childNodes[0].style.backgroundColor=this.Df[this.Df.length-1].color}z5b(D,Q){const Z=this.Jc.get(6,0),P=this.Jc.get(14);return x.createClusteredImageFromClusterWithImageClass(Z,Z,this.Jc.get(D),this.Jc.get(Q),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,P?P.cloneNode(!0):null)}cD(D){3!==D.Wf&&this.raiseEvent(n.a.np,new n.a(2,D));return!1}onClick(D){this.raiseEvent(n.a.np,
new n.a(1,D));return!0}Cz(D){3!==D.Wf&&this.raiseEvent(n.a.np,new n.a(3,D));return!1}I4e(){this.element&&(this.z7.yb(v.a.pointerDown,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.z7.yb(v.a.pointerOver,this.element,Object(h.a)(this,this.cD,"onPointerOver")),this.z7.yb(v.a.pointerOut,this.element,Object(h.a)(this,this.Cz,"onPointerOut")),this.yn.yb(v.a.doubleClick,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.yn.yb(v.a.click,
this.element,Object(h.a)(this,this.onClick,"onClick")),this.dN.yb(this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")))}rde(){this.element&&(this.z7.pb(v.a.pointerDown,this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.z7.pb(v.a.pointerOver,this.element,Object(h.a)(this,this.cD,"onPointerOver")),this.z7.pb(v.a.pointerOut,this.element,Object(h.a)(this,this.Cz,"onPointerOut")),this.yn.pb(v.a.doubleClick,this.element,Object(h.a)(this,
this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.yn.pb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.dN.pb(this.element,Object(h.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")))}}Object(J.a)(A,"PresenceTooltipGlyph",r.a,[]);var E=d(118);d(65);var u=d(195);class K extends r.a{constructor(D,Q,Z){super(D);this.Df=[];this.gm=[];this.kI=0;this.iia=this.g7=!1;this.pQb=null;this.zha={};this.Jc=Z;this.Xi=Z.get(8,!1);this.BG=Z.get(11,!1);D=Z.get(12,0);this.imageDimension=
Z.get(6,0);this.k5a=Q;this.element.id=K.p9a();this.element.className=r.a.nub("prControl",this.Xi);D&&(this.zIndex=D);this.rtl=this.Xi;this.Rjb(Q);this.Lz=this.createElement("div");this.Lz.className=this.BG?"prContainerV":"prContainerHr";this.element.appendChild(this.Lz);this.ISb=Array(this.kI);for(Q=0;Q<this.kI;Q++)this.kw[Q]=new y(this.createElement("div"),this.Jc),this.kw[Q].fW(Object(h.a)(this,this.eG,"onInteractivityChanged")),this.element.appendChild(this.kw[Q].element)}get Xhb(){return u.a.clone(this.Df)}getGlyph(D){return this.zha[D]}get kw(){return this.ISb}get xYb(){return this.pQb}get xLa(){return this.imageDimension+
2}get width(){return this.BG?this.xLa:this.k5a}get height(){return this.BG?this.k5a:this.xLa}fW(D){this.addHandler(n.a.np,D)}k1(D){this.removeHandler(n.a.np,D)}dispose(){if(this.kw)for(const D of this.kw)D.k1(Object(h.a)(this,this.eG,"onInteractivityChanged")),E.a.Kx(D);E.a.Knd(this.gm);this.gm=this.ISb=null;super.dispose()}nga(){this.RN();this.Fkb();this.visible=!0;this.g7=!1}Hkb(){!this.gm||1>this.gm.length||(this.RN(),this.visible=!0,this.Fkb(),this.PJa(this.gm[this.gm.length-1]),this.g7=!0)}Kya(){if(this.gm&&
!(1>this.gm.length)){this.visible=!0;this.Fkb();var D=0;for(const Q of this.gm)this.PJa(Q,D++);this.g7=!1;this.iia=!0}}hide(){this.visible=!1;this.RN();for(let D=0;D<this.gm.length;D++)this.gm[D].hide();this.g7=!1}c0b(){if(!this.iia)return!1;let D=0;for(const Q of this.kw)Q.visible&&D++;return this.iia=0<D&&(this.Df.length<=this.kI?D===this.Df.length:D===this.kI)}Yx(D){if(!(0>=this.kI)){D.clientId||(D.clientId=(K.Gha++).toString());if(D.clientId in this.zha){var Q=this.fT(D.clientId);if(0<=Q){Q=this.Df[Q];
if(Q.color===D.color&&Q.userName===D.userName)return;this.TJ(D.clientId)}}Q=this.c0b();var Z=0;if(this.Df.length<this.kI){var P=new A(this.createElement("div"),this.Jc,D);P.fW(Object(h.a)(this,this.eG,"onInteractivityChanged"));this.Xi&&!this.BG&&0<this.Df.length?this.Lz.insertBefore(P.element,this.Lz.firstChild):(this.Lz.appendChild(P.element),Z=this.gm.length);Array.add(this.gm,P)}else this.Xi&&!this.BG?P=this.gm[0]:(Z=this.gm.length-1,P=this.gm[Z]),P.Yx(D);P.show();this.zha[D.clientId]=P;Array.add(this.Df,
D);this.Kuc(P,Z);Q&&this.Kya()}}TJ(D){const Q=this.c0b();Q&&this.RN();this.poa(D);this.Df.length>=this.kI&&this.gm.length<this.kI&&this.bQe();0>=this.Df.length?this.hide():Q&&this.Kya()}Cgb(){}poa(D){var Q=this.fT(D);0>Q||(D=this.Df[Q],Array.removeAt(this.Df,Q),Q=this.zha[D.clientId],delete this.zha[D.clientId],Q.TJ(D.clientId),this.Kuc(Q),0>=Q.TO&&(this.Lz.removeChild(Q.element),Array.remove(this.gm,Q),Q.dispose()))}mkb(){}bQe(){var D=this.y9d();!D||1>=D.bba.length||(D=Array.clone(this.Df),D.forEach(Q=>
{this.poa(Q.clientId)}),D.forEach(Q=>{this.Yx(Q)}))}fT(D){for(let Q=0;Q<this.Df.length;Q++)if(this.Df[Q].clientId===D)return Q;return-1}y9d(){return this.Xi&&!this.BG?this.gm[0]:this.gm[this.gm.length-1]}position(D,Q){this.element.style.top=Q+"px";this.element.style.left=D+"px"}Fkb(){for(let D=0;D<this.gm.length;D++)this.gm[D].show()}RN(){for(let D=0;D<this.kI;D++)this.kw[D].hide();this.iia=!1}PJa(D,Q=0){if(D)if(this.pQb=D,this.BG){const Z=this.imageDimension;if(1<D.bba.length)this.kw[Q].show(D.bba,
Z,this.height-this.imageDimension);else{const P=this.Lz.children.length;for(let ca=0;ca<this.Lz.children.length;ca++)D.element===this.Lz.children[ca]&&this.kw[Q].show(D.bba,Z,this.height-(P-ca)*this.xLa+2)}}else this.kw[Q].show(D.bba,this.width,0)}eG(D,Q){var Z=Object(e.a)(A,D);Z=Z?this.p4b(Z):-1;if(2===Q.type||1===Q.type&&-1!==Z&&!this.kw[Z].visible)this.PJa(D);else if(1===Q.type)this.RN(),this.g7=!1;else if(3===Q.type){if(this.S3b(Q.Zi))return;this.g7||this.RN()}this.raiseEvent(n.a.np,Q)}S3b(D){D=
K.e$a(D);let Q=!1;for(const Z of this.kw)if(B.a.nua(Z.element,D)){Q=!0;break}return this.Lz!==D&&B.a.nua(this.Lz,D)||Q}Kuc(D,Q=0){const Z=this.Tie(D);Z&&0>=D.TO?this.kw[Q].hide():Z?this.PJa(D):this.kw[Q].hide()}p4b(D){let Q=0;for(const Z of this.gm){if(D===Z)return Q;Q++}return-1}Tie(D){const Q=this.p4b(D);return!!this.xYb&&D===this.xYb&&-1!==Q&&this.kw[Q].visible}Rjb(D){this.kI=D===this.imageDimension?1:Math.floor(D/this.xLa);this.BG?(this.element.style.height=D+"px",this.element.style.width=this.imageDimension+
"px"):(this.element.style.width=D+"px",this.element.style.height=this.imageDimension+"px")}static p9a(){return String.format("{0}-{1}","presencetooltip",K.Gha++)}static e$a(D){D=D.qc.rawEvent;return D.relatedTarget||D.toElement}}K.Gha=0;Object(J.a)(K,"PresenceTooltipControl",r.a,[515,106]);var G=d(225),O=d(289),R=d(267);d.d(aa,"a",function(){return V});class V{constructor(D){this.Jc=D;this.Jc.MD(10,G.a.instance);this.Jc.MD(9,R.a.instance);this.Jc.MD(6,16);this.Jc.MD(13,O.a.instance)}YLc(D,Q){return new K(D,
Q,this.Jc)}eub(D){return new K(D,16,this.Jc)}}Object(J.a)(V,"PresenceTooltipFactory",null,[505])},1162:function(J,aa,d){J=d(0);class h{}h.taskPaneWidth=330;Object(J.a)(h,"AppsForOfficeConstants",null,[]);d.d(aa,"a",function(){return e});class e{constructor(){this.wW=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.ANc=this.dialogTop=this.FNc=this.dialogLeft=null;this.taskPaneWidth=h.taskPaneWidth;this.XE=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings=
{};this.onExtensionLaunchCallback=this.onTaskPaneClose=null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1;this.GNc=this.CNc=!0}}Object(J.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1237:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.isEnabled=1]="isEnabled";e[e.execute=2]="execute";e[e.animation=3]="animation"})(h||(h={}));Object(J.b)("ActionBehavior",h)},1238:function(J,aa,d){d.d(aa,"a",function(){return B});
J=d(0);var h=d(79),e=d(121),r=d(27),n=d(95),v=d(221);class B extends h.a{constructor(y,x=!1){super(y,!1,x)}get Pzb(){return!1}get iL(){return v.a.C2b+"/modeless"}get WAb(){return null}set WAb(y){}get SAb(){return null}set SAb(y){}aj(y,x=null,A=null){this.MK&&(A.isModal=!1);super.aj(y,x,A)}hide(){if(r.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Hb)this.YHh(),r.AFrameworkApplication.Aa.Pw.Lo(e.AFrame.z5),super.hide()}E6h(){const y=
r.AFrameworkApplication.Aa.Pw,x=r.AFrameworkApplication.Aa.Vr;y.P2(this.iL);y.yia(this.iL);x.Fc(this.iL).parent=e.AFrame.hj}tra(){n.FocusManager.UM()&&(super.tra(),this.E6h(),r.AFrameworkApplication.Aa.Pw.rI(e.AFrame.z5))}Pib(){if(n.FocusManager.UM()&&!r.AFrameworkApplication.Ug){const y=n.FocusManager.instance();y.a1(this.iL);const x=y.uQ(this.iL);x&&x.wj.ZE(null);y.tKb(this.iL)}}oaa(){"DL"===this.kra||"DP"===this.kra?super.oaa():r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?
(this.YHh(),this.Izf()&&this.Axh(this.Hb.clientHeight,this.Hb.clientWidth)):this.BA()}BA(){this.Axh(h.a.caf,h.a.faf)}Axh(y,x){if(this.SAb&&this.WAb){let A,E;A=v.a.qmc+this.WAb;E=v.a.pmc+this.SAb;A+y>this.kka()&&(A=this.kka()-y);E+x>this.Bta()&&(E=this.Bta()-x);this.Crd(A,E)}else super.BA()}r9d(y){if(!y)return null;y.endsWith("px")&&(y=y.substring(0,y.length-2));return v.a.Wzb(y)?((y=parseInt(y))||(y=1),y):null}YHh(){if(this.Hb&&this.Hb.style){var y=this.r9d(this.Hb.style.top);y&&(this.WAb=y-v.a.qmc);
if(y=r.AFrameworkApplication.isRtl?this.r9d(this.Hb.style.right):this.r9d(this.Hb.style.left))this.SAb=y-v.a.pmc}}}Object(J.a)(B,"ModelessCustomDialog",h.a,[])},1241:function(J,aa,d){d.r(aa);var h=d(0),e=d(387),r=d(1205),n=d(1206),v=d(14),B=d(1204),y;(function(z){z[z.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";z[z.cloudPolicySettings=1]="cloudPolicySettings";z[z.alternateAuthToken=2]="alternateAuthToken"})(y||(y={}));Object(h.b)("ApplicationFeatureHelperRequestType",y);class x{constructor(){this.message=
null;this.Av=0}}Object(h.a)(x,"HttpRequstToPromiseRejectData",null,[]);var A=d(96),E=d(81),u=d(176),K=d(472);class G{constructor(z,Y){this.$a=z;this.Yh=Y}D1b(z,Y,m,I=null,X=null,ta=null,Fa=null,bb=null){const yb=y[m],Bb=yb+"RequestFailure";A.Health.instance.recordKpiUsage(Bb,0,"jpittsdirects",null);return new Promise((pb,Ob)=>{e.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",yb);const sc=null!=Fa?Fa:this.$a.Bc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),wc=null!=bb?bb:this.$a.Bc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Yh.cW(z,1,null,this.d8d(m,I),ta,1,Lb=>{e.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",yb);try{if(void 0===Lb||null===Lb||void 0===Lb.data||null===Lb.data||void 0===Lb.data.Wd||null===Lb.data.Wd){A.Health.instance.recordKpiFailure(Bb,"Invalid RequestSucceededEventArgs",!1,!0,null);let Oc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
yb);Ob(this.mka(Oc,Lb))}else if(Lb.data.ie!==u.a.Wv){A.Health.instance.recordKpiFailure(Bb,"HttpStatusCode_"+Lb.data.ie.toString(),!1,!0,null);let Oc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Lb.data.ie,yb);Ob(this.mka(Oc,Lb))}else{void 0!==X&&null!==X&&void 0!==Lb.data.tj&&null!==Lb.data.tj&&X(Lb.data.tj);var $b=Y(Lb.data.Wd);if($b)e.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",yb),pb($b);else{A.Health.instance.recordKpiFailure(Bb,"Parse Failure",!1,!0,null);let Oc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",yb);Ob(this.mka(Oc,Lb))}}}catch(Oc){A.Health.instance.recordKpiFailure(Bb,"Unexpected Failure",!1,!0,null),$b=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Oc,yb),Ob(this.mka($b,Lb))}},Lb=>{if(Lb.data){A.Health.instance.recordKpiFailure(Bb,"HttpStatusCode_"+Lb.data.ie.toString(),!1,!0,null);var $b=K.a.Bxb(Lb.data.Wd||"No Data");$b=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Lb.data.ie,$b,yb)}else A.Health.instance.recordKpiFailure(Bb,"Invalid RequestFailedEventArgs",!1,!0,null),$b=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
yb);Ob(this.mka($b,Lb))},null,void 0,void 0,sc,wc)})}mka(z,Y){const m=new x;m.message=z;m.Av=Y&&Y.data?Y.data.ie:-1;return m}d8d(z,Y){const m={};m["x-UserDataSignature"]=this.$a.Ga("UserDataSignature");m["x-LicensingIsEnabled"]=this.$a.ka("LicensingIsEnabled").toString();m["x-CacheIsEnabled"]=this.$a.ka("LicensingRedisIsEnabled").toString();m["x-OcpsIsEnabled"]=this.$a.ka("OcpsIsEnabled").toString();m["x-LicensingAADIdIsEnabled"]=this.$a.ka("LicensingAadIdIsEnabled").toString();0===z&&(m["x-LicenseCheckOnTenantEnabled"]=
"true",m["x-SupportUserConsentDependentFeatures"]="true",m["x-AFHUserConsentGroupValue"]="0",m["x-UseShellServiceForUserConsentGroup"]="true",m["x-SMBUserLicensingEnabled"]="true",m["x-AFHPIPLComplianceEnabled"]=E.a.kT(window.location.href,"wd_afhpipl")||"false");if(Y)for(let I of Y.keys)m[I]=Y.ga(I);return m}}Object(h.a)(G,"HttpRequestToPromiseUtility",null,[]);var O=d(27),R;(function(z){z[z.loki=0]="loki";z[z.augloopACLP=1]="augloopACLP"})(R||(R={}));Object(h.b)("AlternateAuthSupportApp",R);var V=
d(226),D=d(36);class Q{constructor(){this.Token=null;this.ExpirationTime=0}}Object(h.a)(Q,"WacAlternateAuthToken",null,[]);class Z{constructor(z,Y){this.Yxl=3E5;if(void 0===z||null===z||void 0===Y||null===Y)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.$a=z;this.mwc=new r.a(n.a.Hn());this.oTb=new G(z,Y);void 0!==V.OAuthManagerSettings.rpe&&null!==V.OAuthManagerSettings.rpe&&void 0!==V.OAuthManagerSettings.K2c&&null!==V.OAuthManagerSettings.K2c&&0<V.OAuthManagerSettings.K2c&&
(z=new Q,z.Token=V.OAuthManagerSettings.rpe,z.ExpirationTime=V.OAuthManagerSettings.K2c,this.mwc.$("loki",z))}u4i(){let z=null;this.mwc.Gb(R[0])&&(z=this.mwc.ga(R[0]));return void 0===z||null===z||this.CXj(z)?this.NXi():Promise.resolve(z.Token)}CXj(z){return z.ExpirationTime-Date.now()<this.Yxl}NXi(){const z=new r.a(n.a.Hn());z.$("X-AlternateAuthApp",R[0]);return this.oTb.D1b(this.OSa("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.MDk,"parseAlternateAuthTokenResponse"),2,z).then(Y=>
{e.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",R[0]);this.mwc.$(R[0],Y);return Y.Token},Y=>{Y=Object(B.a)(x,Y);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Y.message,Y.Av);return null})}MDk(z){let Y=null;({sv:Y}=D.d(z));e.ULS.sendTraceTag(545821457,3004,Y?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",z);return Y}OSa(z){return String.format("{0}{1}?{2}",
this.$a.Ga("WebServiceBase"),z,O.AFrameworkApplication.hh)}}Object(h.a)(Z,"AlternateAuthHelper",null,[446]);var P=d(1067);class ca{constructor(z,Y,m){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=z;this.isEnabled=Y;this.tierName=m}}Object(h.a)(ca,"FeatureStateChangeArgs",null,[]);var T=d(222),da=d(214),fa=d(55),ma=d(105),ea=d(109),ra;(function(z){z[z.Enabled=0]="Enabled";z[z.Disabled=1]="Disabled"})(ra||(ra={}));Object(h.b)("FeatureState",ra);var F=d(57),na=d(37),ka=d(89);
class Ua{constructor(z,Y,m=null,I=null,X=null){this.iSa=this.SV=this.hnf=this.eOa=this.BEc=null;this.oTb=new G(z,Y);this.$a=z;this.HWh=z.Bc("LicensingMaxRetryAttempts",0);this.sAc=z.ka("IsO365ConsumerHost");this.xEd=z.ka("IsO365CommercialHost");this.eEd=z.ka("PremiumUpsellIsEnabled");this.Mob=!1;this.SFd=0;this.g$e=m;this.orf=I;this.Ca=X;this.dOa=z.ka("LicensingIsEnabled");this.s4a=z.ka("OcpsIsEnabled")&&this.xEd;this.QNd=z.ka("ShowPrivacyDialog")&&!!I;this.DDd=z.ka("IsAnonymousUser");this.WPc=new Promise(ta=>
{ta(!1)});this.q1a=new Promise(ta=>{ta(!0)});this.hSa=new r.a(n.a.Hn());this.KFc=!0;this.gif=this.Tcj();this.lle()&&!this.DDd?(void 0!==O.AFrameworkApplication.Aa&&null!==O.AFrameworkApplication.Aa&&(this.BEc=O.AFrameworkApplication.Aa.lV,void 0!==this.BEc&&null!==this.BEc&&(this.eOa=this.BEc.nGb("WebServiceCall","ApplicationFeatureHelperService"))),this.iSa=this.Z3e()):this.iSa=new Promise(ta=>{ta({})});this.iSa.catch(ta=>{ta=Object(B.a)(x,ta);e.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",
ta?ta.Av.toString():"Unknown")});this.KFc&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ta=>{this.Mob=ta;return null})}Tcj(){const z=this.$a.Eu("AllLicensedFeatures")?this.$a.YA("AllLicensedFeatures"):[],Y=new P.a;for(let m=0;m<z.length;m++)Y.add(z[m]);return Y}lle(){return this.xEd||this.sAc}Z3e(z=0,Y=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Y);const m=T.a.Uz();m&&(m.set("retryAttempt",z.toString()),m.set("forceRefresh",Y.toString()),
m.set("isO365ConsumerHost",this.sAc.toString()),m.set("isO365CommercialHost",this.xEd.toString()),m.set("isFreemiumUpsellSettingEnabled",this.eEd.toString()));A.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",m);A.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",m);void 0!==this.eOa&&null!==this.eOa&&this.eOa.start();let I=null;Y&&(I=new r.a(n.a.Hn()),I.$("x-LicensingForceRefresh","true"));this.hnf=new Date;return(this.dOa?
this.oTb.D1b(this.OSa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(v.a)(this,this.PDk,"parseApplicationFeatureHelperResponse"),0,I,Object(v.a)(this,this.lLk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(X=>{const ta=Object.assign(new ka.a,{durationMs:this.zzh()});ta.extendedProperties=m;ta.extendedProperties&&X&&(ta.extendedProperties.set("featureCount",ma.a.count(X).toString()),ta.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in
X).toString()),ta.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in X).toString()),"FreemiumUpsell"in X&&ta.extendedProperties.set("isFreemiumUpsellEnabled",X.FreemiumUpsell.toString()),this.SV&&ta.extendedProperties.set("fromCache",(this.SV<this.hnf).toString()));A.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ta);return X},X=>{const ta=Object.assign(new ka.a,{durationMs:this.zzh()}),Fa=Object(B.a)(x,X);if(!Fa)return e.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),
A.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ta),new Promise((bb,yb)=>{yb(X)});ta.extendedProperties=m;ta.extendedProperties&&ta.extendedProperties.set("status",Fa.Av.toString());A.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ta);return 408===Fa.Av&&++z<=this.HWh?this.Z3e(z):new Promise((bb,yb)=>{yb(Fa)})})}PDk(z){(z=D.b(z))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),
e.ULS.sendTraceTag(50938594,3004,50,"{0}",z)):e.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return z.Features}OSa(z){var Y=String.format("{0}{1}",this.$a.Ga("WebServiceBase"),z);this.$a.Eu("ApplicationFeatureHelperHttpCachingEnabled")&&this.$a.ka("ApplicationFeatureHelperHttpCachingEnabled")&&(z=Ua.JTc(this.$a))&&0<z.length&&(this.KFc&&(z+="ucbf"),Y=new da.QueryStringBuilder(Y),Y.Xg("afhskey",z),Y=Y.toString());
return Y}isFeatureEnabled(z,Y){if(!this.s4a&&!this.QNd&&!this.dOa)return this.q1a;e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",z);if("ConnectedServices"===z){var m=this.s4a?this.g$e.J3("ControllerConnectedServicesEnabled"):this.q1a;const ta=this.QNd?this.orf.getSettings().then(Fa=>2!==Fa.pC,()=>Y):this.q1a;return m.then(Fa=>Fa?ta:this.WPc)}if("FreemiumUpsell"===z&&(!this.eEd||!this.sAc||this.DDd))return this.WPc;m=
null;m=this.s4a?this.g$e.isFeatureEnabled(z):this.q1a;let I=null;I=this.dOa?this.kOj(z,Y):this.q1a;let X=null;X=this.QNd?this.orf.isFeatureEnabled(z):this.q1a;return m.then(ta=>ta?X.then(Fa=>Fa?I:this.WPc):this.WPc).then(ta=>{this.org(z,ta,!0);return ta},()=>{this.org(z,Y,!1);return Y})}org(z,Y,m){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",z,Y,m)}getFeatureTier(z,Y){if(!this.dOa)return new Promise(m=>{m(2)});e.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
z);return this.iSa.then(m=>this.gVc(z,m,Y),()=>Y)}isFreemiumUpsellEnabled(){if(this.eEd&&this.sAc&&!this.DDd){if(this.Mob&&2!==this.SFd||!this.Mob&&1!==this.SFd)e.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.Mob.toString()),this.SFd=this.Mob?2:1;return this.Mob}return!1}launchUpsellExperience(z,Y=null){e.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
z));var m=T.a.Uz();m&&(m.set("experienceId",z),Y&&m.set("campaignId",Y));A.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",m);if(m=F.a.instance.rb("Common.IInProductMessagingUIManager")){const I=Object(v.a)(this,this.btj,"handleDimeTaskComplete");m.Qpg(z,I,Y)}else e.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),A.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ca.La(na.a.oRc,2,{["experience"]:z})}Gib(z,
Y){if(!this.dOa)return null;if(!z||!Y)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const m=ea.a.create().toString();this.hSa.Gb(z)||this.hSa.$(z,new r.a(n.a.Hn()));this.hSa.ga(z).add(m,Y);e.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",m,z));return m}oKb(z,Y){this.dOa&&(z&&this.hSa.Gb(z)?Y&&ea.a.isValid(Y)?this.hSa.ga(z).Gb(Y)?
(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",Y,z)),this.hSa.ga(z).remove(Y)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Y,z)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Y,
z)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",z)))}gVc(z,Y,m){return this.KFc?z in Y?Y[z].LicenseTier:m:z in Y?this.zEk(Y[z],m):m}zEk(z,Y){switch(z.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Y}}btj(){e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.iSa.then(z=>{this.dhh(z)}).catch(()=>{this.dhh({})})}dhh(z){e.ULS.sendTraceTag(594051087,
3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const Y=this.Z3e(0,!0);Y.then(m=>{this.iSa=Y;ma.a.count(m)>ma.a.count(z)?A.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):A.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let I of this.hSa.keys)if(I in m){const X=this.gVc(I,m,0);I in z?this.gVc(I,z,0)!==X&&this.tGe(I,!0,X):this.tGe(I,!0,X)}else I in z&&this.tGe(I,!1,this.gVc(I,z,0))}).catch(m=>{A.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"LicensingRefreshFailed",!1,!0,null);e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(m))})}tGe(z,Y,m){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",z,Y,m);Y=new ca(z,Y,m);m=this.hSa.ga(z);for(let I of m)try{I.value(Y)}catch(X){e.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
z,I.key,X.message))}}jOj(z,Y){if(this.dOa){const m=this.gif.contains(z);let I=!0,X="",ta=!1;return this.iSa.then(Fa=>{z in Fa?(Fa=Fa[z],X=ra[Fa.FeatureState],I=1!==Fa.FeatureState):I=!m;this.yrg(z,m,X,ta,Y,I);return I},()=>{ta=!0;m&&(I=Y);this.yrg(z,m,X,ta,Y,I);return I})}return this.q1a}yrg(z,Y,m,I,X,ta){e.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",z,Y,I,m,X,ta)}kOj(z,Y){if(this.KFc)return this.jOj(z,
Y);if(this.dOa){if(this.gif.contains(z))return this.iSa.then(m=>z in m,()=>Y);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",z)}return this.q1a}lLk(z){try{z&&"Date"in z&&(this.SV=new Date(z.Date),e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.SV.toString()))}catch(Y){e.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
Y)}}zzh(){if(void 0!==this.eOa&&null!==this.eOa){const z=this.eOa.Vq;this.eOa.stop();return z}return null}static JTc(z){try{if(fa.a.Q0e){const Y=z.Ga("UserDataSignature").split(".");if(1<Y.length){const m=window.self.atob(Y[1]),I=JSON.parse(m).LocalStorageKey;if(void 0!==I&&null!==I&&0<I.length)return I}}}catch(Y){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",Y.toString())}return null}}Object(h.a)(Ua,"ApplicationFeatureHelper",null,[447]);var za=d(18);class ha{constructor(z,
Y){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=z.PolicySettings;z=new Date;z.setMinutes(z.getMinutes()+Y);this.ExpirationTime=z.getTime()}}Object(h.a)(ha,"CloudPolicySettingsCacheData",null,[]);var ua=d(373),Ga=d(240),sa=d(284);class Ba{static txh(){return O.AFrameworkApplication.fa.ka("SideCarIsEnabled")?Ba.Rnd&&Ba.yZc?new Promise(z=>{z(!0)}):new Promise((z,Y)=>{Ba.Rnd=sa.a.create(O.AFrameworkApplication.fa.Ga("SideCarUrl"));Ga.a.fy(Ba.Rnd);Ba.Rnd.HS((m,I)=>{(Ba.yZc=I.succeeded)?
z(I.succeeded):Y(I.succeeded)})}):new Promise(z=>{z(!1)})}}Ba.yZc=!1;Ba.Rnd=null;Object(h.a)(Ba,"SideCarLoader",null,[]);class pa{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(h.a)(pa,"CloudPolicySettingsData",null,[]);class ia{constructor(z,Y){this.dzd=0;this.zKc=null;this.oTb=new G(z,Y);this.$a=z;Y=z.Ga("HostAuthType");this.s4a=z.ka("OcpsIsEnabled")&&z.ka("IsO365CommercialHost")&&!(void 0===Y||null===Y)&&"aad"===Y.toLowerCase();this.wkf=D.b(z.Ga("OcpsDefaultSettings")||
"{}");this.KUb=this.JTc();Y=this.$a.Eu("ServicesControlsMicrosoftControllerServicesList")?this.$a.YA("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Bxc=new P.a;for(let m=0;m<Y.length;m++)this.Bxc.add(Y[m]);this.s4a&&!z.ka("IsAnonymousUser")&&z.ka("SideCarIsEnabled")?this.zKc=this.dBl():this.zKc=this.Y3e(this.s4a,this.OSa("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.WDk,"parseCloudPolicySettingsResponse"));this.zKc.then(()=>null).catch(m=>{m=Object(B.a)(x,m);e.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",m?m.Av.toString():"Unknown")})}J3(z,Y=!0){if(!this.s4a){const ta=this;return new Promise(Fa=>{Fa(ta.d6b(z))})}let m=this,I=this;const X=this.zKc.then(ta=>{try{let Fa=null;ta.PolicySettings&&"unknown"in ta.PolicySettings&&(Fa=ta.PolicySettings.unknown);if(Fa){if(z in Fa&&void 0!==Fa[z]&&null!==Fa[z])return new Promise(yb=>{yb("0"!==Fa[z])});const bb=z.toLowerCase();if(bb in Fa&&void 0!==Fa[bb]&&null!==Fa[bb])return new Promise(yb=>
{yb("0"!==Fa[bb])});e.ULS.sendTraceTag(51512667,3004,50,"Policy"+z+" not found, using default");return new Promise(yb=>{yb(m.d6b(z))})}return new Promise(bb=>{bb(m.d6b(z))})}catch(Fa){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+z+" policy value. Error Message: {0}",Fa.message),m.handleError(Fa.toString(),Y,m.d6b(z))}},ta=>I.handleError(ta,Y,I.d6b(z)));X.then(ta=>{e.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",z,ta);
return null});return X}isFeatureEnabled(z,Y=!0){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.mOj(z,Y);let m=new Promise(X=>{X(!0)}),I="";this.Bxc.contains(z)&&(I="ControllerConnectedServicesEnabled",m=this.J3(I,Y));m.then(X=>{e.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",z,X,I);return null});return m}mOj(z,Y=!0){let m=new Promise(X=>
{X(!0)}),I="";"mso_sendASmile"===z?I="Enabled":"Survey"===z||"FloodgateSurvey"===z?I="SurveyEnabled":this.Bxc.contains(z)&&(I="ControllerConnectedServicesEnabled");""!==I&&(m=this.J3(I,Y));m.then(X=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",z,X,I);return null});return m}handleError(z,Y,m){return Y?new Promise(I=>{I(m)}):new Promise((I,X)=>{X(z)})}Y3e(z,Y,m){if(!z)return Promise.resolve(new pa);let I=!1,X=
null;A.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ta=this.bYd("GetCloudPolicySettings");return(new Promise((Fa,bb)=>{if(void 0!==this.KUb&&null!==this.KUb&&0<this.KUb.length){const yb=this.KAl();if(void 0!==yb&&null!==yb){I=!0;Fa(yb);return}}this.oTb.D1b(Y,m,1,null,Object(v.a)(this,this.sLk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.$a.Bc("CloudPolicySettingsRequestQueueTimeout",15E3),this.$a.Bc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(yb=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.QBl(yb);Fa(yb);return yb},yb=>{bb(yb);return null})})).then(Fa=>{({Ky:ta,returnValue:X}=this.$rd(ta));var bb=T.a.Uz();bb&&bb.set("FromCache",I.toString());bb=Object.assign(new ka.a,{durationMs:X,extendedProperties:bb});A.Health.instance.recordKpiSuccess("GetCloudPolicySettings",bb);return Fa})}dBl(){return Ba.txh().then(()=>{e.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}OSa(z){return String.format("{0}{1}",this.$a.Ga("WebServiceBase"),z)}WDk(z){let Y=null;({sv:Y}=D.d(z));z=!!Y;e.ULS.sendTraceTag(50622687,3004,z?50:10,"ParseCloudPolicySettingsResponse: Success={0}",z);return Y}sLk(z){try{if(void 0!==z&&null!==z&&"CheckIn-Interval"in z){const Y=parseInt(z["CheckIn-Interval"]);void 0!==Y&&null!==Y&&0<Y&&(this.dzd=Y)}}catch(Y){e.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",
Y)}}d6b(z){return z in this.wkf?"0"!==this.wkf[z]:!0}KAl(){try{const z=ua.a.instance.getItem(this.KUb);if(void 0===z||null===z)return e.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",z);const Y=JSON.parse(z);if(void 0===Y||null===Y)return e.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===Y.ExpirationTime||null===Y.ExpirationTime)return e.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Y.ExpirationTime)).getTime()<Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const m=new pa;m.PolicySettings=Y.PolicySettings;m.ControllerConnectedServicesFeatureNames=new za.a;this.$a.Eu("ServicesControlsMicrosoftControllerServicesList")&&
this.$a.YA("ServicesControlsMicrosoftControllerServicesList");for(let I of this.Bxc)m.ControllerConnectedServicesFeatureNames.add(I);e.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return m}catch(z){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",z.toString()),null}}QBl(z){try{if(void 0===z||null===z||void 0===z.PolicySettings||null===z.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,
"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.dzd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const Y=new ha(z,this.dzd),m=JSON.stringify(Y);e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",m);ua.a.instance.setItem(this.KUb,m);e.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(Y){e.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",Y.toString())}}JTc(){const z=Ua.JTc(this.$a);return z&&0<z.length?"OCPS"+z:null}bYd(z){const Y=F.a.instance.rb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Y&&null!==Y?Y.Ei("WebServiceCall",z):null}$rd(z){if(void 0!==z&&null!==z){const Y=z.Vq;z.stop();return{returnValue:Y,Ky:null}}return{returnValue:null,Ky:z}}}Object(h.a)(ia,"CloudPolicySettingsHelper",null,[444]);class Da{constructor(){this.JQf=this.GJh=this.pC=
0;this.KQf=this.HJh=this.E7a="";this.QLd=this.Jza=2}clone(){const z=new Da;z.pC=this.pC;z.GJh=this.GJh;z.JQf=this.JQf;z.E7a=this.E7a;z.HJh=this.HJh;z.KQf=this.KQf;z.Jza=this.Jza;z.QLd=this.src;return z}get src(){return this.QLd}serialize(z=null){const Y={};if(!z||z.contains(Da.Pgb))Y[Da.Pgb]=this.pC;if(!z||z.contains(Da.akc))Y[Da.akc]=this.E7a;if(!z||z.contains(Da.bkc))Y[Da.bkc]=this.Jza;return JSON.stringify(Y)}static create(z,Y=null){const m=new Da;m.QLd=z;void 0!==Y&&null!==Y&&(Da.Pgb in Y&&(m.pC=
Y[Da.Pgb]),Da.akc in Y&&(m.E7a=Y[Da.akc]),Da.bkc in Y&&(m.Jza=Y[Da.bkc]));return m}static deserialize(z,Y){try{const m=JSON.parse(z);if(void 0!==m&&null!==m)return Da.create(Y,m);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",z);throw Error.argument("settingsData");}catch(m){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",m.toString()),m;}}}Da.Pgb="CCS";Da.akc="CCSTime";Da.bkc="OfficePrivacyRoamedNoticeShown";
Object(h.a)(Da,"UserPrivacySettings",null,[]);var Xa=d(212);class Ka{constructor(z,Y){if(void 0===z||null===z||void 0===Y||null===Y)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.$a=z;this.Yh=Y;this.gLd=this.Jc=null}OSa(z){var Y=String.format("{0}RoamingServiceHandler.ashx?action=",this.$a.appSettings.RoamingServiceHandlerWebServiceBase||"");Y=new Sys.StringBuilder(Y);Y.append(z);Y.append("&");Y.append(O.AFrameworkApplication.hh);return Y.toString()}executeRequest(z,Y,m,
I=null){return this.Yh.krb(z,Y,I,null,2,m,"33",!1,null,6E4)}saveSettings(z){return new Promise((Y,m)=>{try{if(void 0===this.Jc||null===this.Jc||void 0===z||null===z)e.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),m("Can't determine setting changes to save");else{var I=this.Jc.pC!==z.pC;if(2===this.Jc.src&&I)this.g7k(z),Y(!0);else{var X=this.n$k(z);if(void 0===X||null===X||!X.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),
m("No changes to save");else if(1===this.Jc.src)Y(this.yFh(X));else if(0===this.Jc.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",X);const ta=this.executeRequest(this.OSa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",X);ta.continueWith(()=>{if(ta.Vn||ta.rm)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),Y(!1);else{var Fa=ta.result;void 0!==Fa.Yi&&null!==Fa.Yi&&void 0!==Fa.Yi.data&&null!==
Fa.Yi.data&&Fa.Yi.data.ie===u.a.Wv?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Y(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Y(!1))}})}}}}catch(ta){e.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ta.toString()),Y(!1)}})}n$k(z){if(void 0===this.Jc||null===this.Jc||void 0===z||null===z)throw Error.invalidOperation("User Privacy settings have not been initialized");const Y=new za.a;
0===z.src?(this.Jc.pC!==z.pC&&(Y.add(Da.Pgb),Y.add(Da.akc)),this.Jc.Jza!==z.Jza&&Y.add(Da.bkc)):1===z.src&&this.Jc.pC!==z.pC&&Y.add(Da.Pgb);return Y.count?z.serialize(Y):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.gLd){const z=this;this.gLd=new Promise(Y=>{try{z.Jc?Y(z.Jc.clone()):z.TAl().then(m=>{z.Jc=m;Y(z.Jc.clone());return null},()=>{z.RAl().then(m=>{z.Jc=m;Y(z.Jc.clone());return null},()=>{z.SAl().then(m=>{z.Jc=
m;Y(z.Jc.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");z.Jc=new Da;Y(z.Jc.clone());return null});return null});return null})}catch(m){e.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",m.toString()),z.Jc=new Da,Y(z.Jc.clone())}})}return this.gLd}TAl(){return new Promise((z,Y)=>{try{const I=-1!==window.location.href.indexOf("&wd_pn=2");if(this.$a.ka("PrivacyDialogShouldCheckRoaming")||
I){var m=this.executeRequest(this.OSa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");m.continueWith(()=>{try{if(m.Vn||m.rm)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const X=m.result;if(X&&X.Yi&&X.Yi.data)if(X.Yi.data.ie!==u.a.Wv)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",X.Yi.data.ie);else{if(X.Yi.data.Wd){z(Ka.parse(X.Yi.data.Wd,0));e.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",X.Yi.data.Wd);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Y("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(X){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
X.toString()),Y("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Y("Roaming should not be used")}catch(I){e.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",I.toString()),Y("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}RAl(){return new Promise((z,Y)=>{try{const m=Xa.a.get("WacUPToggleState");let I=null;void 0!==m&&null!==
m&&0<m.length&&(I=decodeURIComponent(m));if(void 0!==I&&null!==I&&0<I.length){const X=Ka.parse(I,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",X.toString());z(X)}else{const X=Da.create(1),ta=new za.a;ta.add(Da.Pgb);const Fa=X.serialize(ta);this.yFh(Fa)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Fa),z(X)):(e.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",
Fa),Y("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(m){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",m.toString()),Y("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}SAl(){return new Promise(z=>{try{var Y=-1!==window.location.href.indexOf("&wdccsoff=1");let m=Da.create(2);Y?(m.pC=2,O.AFrameworkApplication.vPf(),e.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",
m.toString())):(m.pC=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",m.toString()));z(m)}catch(m){e.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",m.toString()),Y=Da.create(2),Y.pC=1,z(Y)}})}g7k(z){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===z.pC?O.AFrameworkApplication.vPf():O.AFrameworkApplication.HRi();e.ULS.sendTraceTag(51258454,
3004,50,"SaveSettingsToQueryParam saved settings = {0}",z)}yFh(z){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",z);const Y=this.$a.Ga("PrivacyCookieDomain")||"";if(!Y||!Y.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",z);return Xa.a.fth("WacUPToggleState",z,Xa.a.FJ,Y)}catch(Y){return e.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",
Y.toString()),!1}}isFeatureEnabled(z){return this.getSettings().then(Y=>{const m=this.$a.Eu("ServicesControlsMicrosoftControllerServicesList")?this.$a.YA("ServicesControlsMicrosoftControllerServicesList"):[],I=new P.a;for(let X=0;X<m.length;X++)I.add(m[X]);return I.contains(z)?2!==Y.pC:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",z);return!0})}static parse(z,Y){try{return e.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
z,Y),Da.deserialize(z,Y)}catch(m){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",m.toString()),m;}}}Object(h.a)(Ka,"UserPrivacySettingsHelper",null,[445]);var Ma=d(71);class Oa{constructor(){this.Da=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Zb(z){this.Da=z;this.Da.register(444,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().oa(()=>new ia(O.AFrameworkApplication.fa,O.AFrameworkApplication.Ke));
this.Da.register(445,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().oa(()=>new Ka(O.AFrameworkApplication.fa,O.AFrameworkApplication.Ke));this.Da.register(446,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().oa(()=>new Z(O.AFrameworkApplication.fa,O.AFrameworkApplication.Ke));this.Da.register(447,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().oa(()=>new Ua(O.AFrameworkApplication.fa,O.AFrameworkApplication.Ke,this.Da.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),
this.Da.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),O.AFrameworkApplication.Ta))}init(){O.AFrameworkApplication.fa.ff(()=>{const z=this.Da.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");O.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(z.isFeatureEnabled("LicensingTestFeature",!1).then(Y=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
Y,O.AFrameworkApplication.fa.Ga("IsAnonymousUser"));return null}),z.getFeatureTier("LicensingTestFeature",0).then(Y=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Y,O.AFrameworkApplication.fa.Ga("IsAnonymousUser"));return null}));this.Da.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.Yvl()})}dispose(){}Yvl(){try{O.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Ba.txh().then(z=>
{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",z);return z})}catch(z){}}static main(){Ma.a.instance.Dc(new Oa)}}Object(h.a)(Oa,"ApplicationFeatureHelperPackage",null,[2,3]);var qa=d(514),Ya=d(6);class Fb{constructor(z,Y){this.Yh=z;this.FD=Y}Lx(z,Y,m,I=null){return this.sPi(z,I,X=>this.Yh.krb(X,2,m,Y,2,void 0,void 0,void 0,void 0,void 0,"2"))}sPi(z,Y,m){const I=!!Y&&""!==Y;let X=z;I&&(X=E.a.f6a(z,"perfTag",Y));const ta=new Date;return qa.a.then(m(X),
Fa=>{const bb=+new Date-+ta;if(!Fa||!Fa.Yi||!Fa.Yi.data)return Fa;I&&Fa.Yi.data.request&&this.F9k(Fa.Yi.data.request.getResolvedUrl(),Y,bb);return Fa})}F9k(z,Y,m){z=this.FD.oij(z);if(z.count&&(z=Ya.last(z))){const I={Message:"Request durations for activities calls."};I.PerfTag=Y;I.CustomDuration=m;I.PerformanceDuration=z.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(I))}}}Object(h.a)(Fb,"CatchUpNetworkingWrapper",null,[565]);var hc=d(380);class ec extends hc.a{constructor(z,Y){super(z,
Y)}Zk(){return 6}}Object(h.a)(ec,"GetActivityFeedRequest",hc.a,[]);class Tb extends hc.a{constructor(z,Y,m,I,X,ta){super(z,Y);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=m;this.ActivityStatesToSet=I;this.ActivityStatesToReset=X;this.ResetUnseenCount=ta}Zk(){return 7}}Object(h.a)(Tb,"UpdateActivityFeedStateRequest",hc.a,[]);var vb=d(528);class zb{constructor(z,Y,m){this.Sjf=z;this.p2a=Y;this.A2a=m}getActivityFeed(z){return qa.a.then(this.A2a.execute(new ec(this.p2a(),
null),(Y,m,I)=>this.Sjf.Lx(Y,m,I,"ActivityFeed"),z),Y=>{if(!Y)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!Y.Yi)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!Y.Yi.data)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!Y.Yi.data.Wd)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;Y=vb.a.a8a(Y.Yi.data.Wd);
return Y?Y:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}KDl(z,Y,m,I,X){return qa.a.then(this.A2a.execute(new Tb(this.p2a(),null,Y,m,I,X),(ta,Fa,bb)=>this.Sjf.Lx(ta,Fa,bb,"UpdateActivityFeedState"),z),ta=>{try{return ta.succeeded}catch(Fa){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+Fa.message),!1}})}}Object(h.a)(zb,"CatchUpRequestHandler",null,[564]);var Xb=d(216);class Za{constructor(z){this.sqb=z;this.Dif=new Xb.a}$2j(){this.S3j()}S3j(){if(this.sqb){var z=
Y=>{this.Dif.contains("CatchUpChangesFeedback")||(this.Dif.add("CatchUpChangesFeedback"),Y.logActivity("CatchUpChangesFeedback",null))};this.sqb.execute(Y=>{window.setTimeout(()=>{z(Y)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(h.a)(Za,"FloodgateEventLogger",null,[]);class Va{constructor(z){this.mZh=z}get duration(){return this.mZh.duration}}Object(h.a)(Va,"PerformanceResourceTimingWrapper",null,[]);class tc{constructor(z){this.FD=
z}oij(z){const Y=new za.a;if(!this.FD)return Y;z=this.FD.getEntriesByName(z,"resource");if(!z)return Y;for(const m of z)Y.add(new Va(m));return Y}}Object(h.a)(tc,"PerformanceWrapper",null,[]);class Kb{constructor(){this.Da=null}get name(){return"Common.App.CatchUpActivity"}Zb(z){this.Da=z;this.Da.register(Fb,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().oa(()=>new Fb(O.AFrameworkApplication.Ke,new tc(window.performance)));this.Da.register(zb,
"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().oa(()=>new zb(this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>O.AFrameworkApplication.hh,new vb.a));this.Da.register(Za,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().oa(()=>new Za(this.Da.Ja("Common.ISystemInitiatedFeedback")))}init(){this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Da.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){Ma.a.instance.Dc(new Kb)}}
Object(h.a)(Kb,"CatchUpActivityPackage",null,[2,3]);var Pa=d(1203),mb=d(107);class qc{constructor(z,Y,m){this.rZe=this.sZe=this.tZe=!1;this.FZe=!z&&!Y;this.GZe=!z&&!m;this.FZe||this.GZe||(this.tZe=!z,this.sZe=!Y,this.rZe=!m)}}Object(h.a)(qc,"RenameDisabledDialogInfo",null,[]);class oc extends mb.StandardDialog{constructor(z,Y,m,I,X){super();this.Z1e=[];this.w2=new qc(z,Y,m);this.tPa=I;this.XNa=X;this.ig="RenameDisabledDialog";this.yd=0;this.Xe(1,CommonUIStrings.l_DialogClose);this.Qfl();this.i1k()}Qfl(){this.w2.FZe?
this.Rrc(this.tPa?this.XNa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.w2.GZe?this.Rrc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.s7h();this.lGc(this.Z1e)}Rrc(z){Array.add(this.Z1e,z)}s7h(){const z=[];this.w2.tZe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.w2.sZe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.w2.rZe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<z.length&&Array.add(this.Z1e,z)}}Object(h.a)(oc,"ReactRenameDisabledDialogBase",mb.StandardDialog,[]);class ib extends oc{constructor(z,Y,m,I,X){super(z,Y,m,I,X)}i1k(){this.pGb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(h.a)(ib,"ReactRenameDisabledDialog",oc,[]);var $a=d(79);class Db{static get eg(){return $a.a.VA(Db.En,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Db.En="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(h.a)(Db,"RenameDisabledDialogHtml",null,[]);class Mb extends $a.a{constructor(z,Y,m,I,X){super();this.w2=new qc(z,Y,m);this.tPa=I;this.XNa=X;this.ig="RenameDisabledDialog";this.yd=0;this.Xe(1,CommonUIStrings.l_DialogClose);this.eg=Db.eg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.f6("RenameRow")}axa(){if(this.w2.FZe){let z;z=this.tPa?this.XNa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;
Mb.Rrc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),z)}else this.w2.GZe?Mb.Rrc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.QAj()}QAj(){this.w2.tZe&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.w2.sZe&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.w2.rZe&&
(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Rrc(z,Y,m){z.style.display="none";Y.innerText=m}}Object(h.a)(Mb,"RenameDisabledDialog",$a.a,[]);var ob=d(47),jc=d(73);class Gb{constructor(z,Y){this.e4a=0;this.Ca=z;this.Zpa=Y}initialize(z){if(!this.Ca||!this.Zpa)return!1;this.e4a=z;this.wb();return!0}wb(){this.Ca.ya(na.a.WKc,jc.a.frame,Object(v.a)(this,this.WKc,"commitNewDocumentTitle"))}WKc(z,Y,m,I,X){if(1===m)return this.Ca.processAction(na.a.renameFile,1);
z=ob.a.XG(this.Zpa.$w);X=(0,X.getNewDocumentTitle)();X.length>this.e4a&&(X=X.substr(0,this.e4a));if(32!==this.Ca.La(na.a.renameFile,2,X))return this.BPb(z),8;this.BPb(X);return 32}BPb(z){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(z))}static wC(){return new Gb(O.AFrameworkApplication.Ta,O.AFrameworkApplication.St)}}Object(h.a)(Gb,"ReactRenameUIHandler",null,[663]);var Gc=d(265),bc=d(674),dc=d(576),Nb=d(67),Ac=d(180),jb=d(267),Vb=d(135),Tc=d(65);class wb{constructor(z,Y,m,I,X,ta,Fa,
bb,yb,Bb,pb,Ob){this._initialized=!1;this._element=null;this.e4a=0;this.SKd=this.fDd=!1;this.Ca=z;this.oyd=Y;this.Rg=m;this.$o=I;this.Zpa=X;this.gof=ta;this.VDc=Fa;this.jzd=bb;this.kqa=yb;this.hgf=Bb;this.lj=pb;this.$Dd=Ob}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(z,Y,m){if(!(this.Ca&&this.Zpa&&this.gof&&this.VDc&&this.jzd&&Y)||0>=z)return!1;this._element=Y;this._element.title=m;this._element.setAttribute(Vb.a.af,Vb.a.Au);this._element.setAttribute("Unselectable",
"on");this.e4a=z;this.QJ();return this._initialized=!0}QJ(){this.oyd&&(this.oyd.pb(Nb.a.blur,this._element,Object(v.a)(this,this.onBlur,"onBlur")),this.oyd.pb(Nb.a.paste,this._element,Object(v.a)(this,this.txk,"onPaste")));this.Rg.pb(Nb.a.Xf,this._element,Object(v.a)(this,this.onKeyDown,"onKeyDown"));this.$o.pb(Nb.a.pointerDown,this._element,Object(v.a)(this,this.dxa,"onPointerDown"));this.$o.pb(Nb.a.FR,this._element,Object(v.a)(this,this.WIe,"onPointerUp"))}onBlur(){this.isActive&&!this.fDd&&(this.hgf||
this.jzd(this._element),this.YHf(),this.f_d(!1));return this.fDd=!1}txk(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(z){return this.isActive?this.$vk(z):this.awk(z)}$vk(z){let Y=!1;switch(z.qc.keyCode){case Sys.UI.Key.enter:this.YHf();this.f_d(this.lj||this.$Dd);Y=!0;break;case Sys.UI.Key.tab:this.hgf&&this.jzd(this._element);break;case Sys.UI.Key.esc:this.hTe(),this.f_d(this.lj||this.$Dd),Y=!0}return Y}awk(z){let Y=!1;switch(z.qc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.sEh(this.$Dd),
this.isActive&&this.VDc(this._element),Y=!0}return Y}dxa(){this.isActive||(this.sEh(!1),this.isActive&&(this._element.focus(),this.VDc(this._element),this.SKd=!0));return!1}WIe(){return this.SKd?(this.VDc(this._element),this.SKd=!1,!0):!1}hAb(){return 32===this.Ca.processAction(na.a.renameFile,1)}YHf(){const z=ob.a.XG(this.Zpa.$w);let Y=this._element.innerText.trim();Y.length>this.e4a&&(Y=Y.substr(0,this.e4a));Y!==z&&""!==Y?32!==this.Ca.La(na.a.renameFile,2,Y)?this.hTe():this.BPb(Y):this.hTe()}hTe(){this.BPb(ob.a.XG(this.Zpa.$w))}BPb(z){this._initialized&&
(this._element.innerText=z,this.gof())}sEh(z){this.hAb()?this.isActive||(z&&(this.fDd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Vb.a.af,Vb.a.Wyf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Gc.CuiHelper.tRf),this.kqa&&this.kqa.execute(Y=>{Y.pfh(!0)}),z&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.processAction(na.a.eNb,
2)}f_d(z){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Vb.a.af,Vb.a.Au);Sys.UI.DomElement.removeCssClass(this._element,Gc.CuiHelper.tRf);this.kqa&&this.kqa.execute(Y=>{Y.pfh(!1)});z&&(this._element.blur(),this._element.focus())}static K_a(){bc.a.K_a(O.AFrameworkApplication.isRtl)}static wC(){return new wb(O.AFrameworkApplication.Ta,dc.a.instance,Ac.KeyInputManager.instance,jb.a.instance,O.AFrameworkApplication.St,wb.K_a,
Tc.a.t8k,Tc.a.sGf,F.a.instance.Ja("Common.App.Header.HeaderEventSource"),fa.a.NF,fa.a.Pi,fa.a.fg)}}Object(h.a)(wb,"RenameUIHandler",null,[663]);class Rb{static get instance(){return O.AFrameworkApplication.Aa.hb.dO?Rb.Ka||(Rb.Ka=Gb.wC()):Rb.Ka||(Rb.Ka=wb.wC())}}Rb.Ka=null;Object(h.a)(Rb,"RenameUIHandlerFactory",null,[]);class vc{constructor(){this.VFe=this.gpk=this.RJi=null}}Object(h.a)(vc,"RenameMruEntryProperties",null,[]);var rd=d(175),rc=d(127),cb=d(438),Wb;(function(z){z[z.unknown=-1]="unknown";
z[z.success=0]="success";z[z.renameInvalidFileName=1]="renameInvalidFileName";z[z.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";z[z.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";z[z.permissionDenied=4]="permissionDenied";z[z.serverCommunicationFailure=5]="serverCommunicationFailure";z[z.fileNameTooLong=6]="fileNameTooLong"})(Wb||(Wb={}));Object(h.b)("CommonOperationResult",Wb);class Uc{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob){this.sgf=z;this.Ca=Y;this.gha=m;this.gF=
I;this.V3a=X;this.c4h=ta;this.tPa=Fa;this.Zqf=bb;this.C_h=yb;this.XNa=Bb;this.$a=pb;this.B_h=Ob}wb(){O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.dO||this.An.ya(na.a.U8b,jc.a.frame,Object(v.a)(this,this.U8b,"initializeRenameUIHandler"));this.An.ya(na.a.eNb,jc.a.frame,Object(v.a)(this,this.eNb,"showRenameDisabledDialog"));this.An.ya(na.a.renameFile,jc.a.frame,Object(v.a)(this,this.renameFile,"renameFile"));this.An.ra(na.a.fileNameUpdate,jc.a.frame,Object(v.a)(this,this.xUk,"refreshFilename"),
64);this.An.ra(na.a.Sdd,jc.a.frame,Object(v.a)(this,this.Sdd,"moveToFolderCompleteByHost"),64);this.An.ya(na.a.Bgb,jc.a.frame,Object(v.a)(this,this.Bgb,"moveToFolder"));(O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||O.AFrameworkApplication.Aa&&(O.AFrameworkApplication.fa.ka("PostMessageEmbedded")||O.AFrameworkApplication.fa.ka("IsJsApi"))&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&O.AFrameworkApplication.nT().execute(z=>{z.yu(rc.a.J_g);z.KB(rc.a.J_g,Uc.ESk);z.yu(rc.a.M3d);z.KB(rc.a.M3d,Uc.CSk)})}hAb(){return 0===this.B_h.v6f()?32:8}VIl(){return this.QA?this.tPa?this.QA.Q0d:this.QA.TDa:!0}U8b(){return Rb.instance.initialize(O.AFrameworkApplication.eQc,O.AFrameworkApplication.pOc,O.AFrameworkApplication.bkh||CommonUIStrings.l_RenameFileTooltip)?32:8}eNb(){const z=this.VIl(),Y=this.c4h();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.V3a,Y,z,this.tPa);O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.IC&&O.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new ib(this.V3a,!Y,!z,this.tPa,this.XNa()):new Mb(this.V3a,!Y,!z,this.tPa,this.XNa());return 32}renameFile(z,Y,m,I,X){if(1===m)return this.hAb();if(!O.AFrameworkApplication.D8a)return 8;if(8===this.hAb())return this.An.processAction(na.a.eNb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");O.AFrameworkApplication.D8a(X,Object(v.a)(this,
this.Mkc,"onRenameFileSuccess"),Object(v.a)(this,this.kyk,"onRenameFileFailure"));O.AFrameworkApplication.L0k=!0;return 32}Mkc(z,Y){z?0!==z.OperationResult?this.cag(z.OperationResult):(this.z9k(Y,z.NewName),this.WDl(z,Object(v.a)(O.AFrameworkApplication.Aa.hb,O.AFrameworkApplication.Aa.hb.nIh,"updateOpenInClientDocumentUrl")),O.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&O.AFrameworkApplication.Aa.updateCommandUI(),this.C_h.VGh()):this.cag(5)}z9k(z,Y){const m={};m[rd.a.gYi]=
Y;z.sendMessage(rc.a.M3d,m)}WDl(z,Y){this.gEl(z);O.AFrameworkApplication.JNc=z.DirectInvokeDavUrl;Y=Y(z.EditDocInClientUrl);const m=new vc;m.VFe=this.gF.$w;m.RJi=Y;m.gpk=z.EditDocInClientUrl;this.An.La(na.a.ckh,2,m)}cag(z){switch(z){case 1:z=new mb.StandardDialog,z.yd=0,z.fP(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.omh()}}gEl(z){this.gF.$w=Uc.Uei(this.gF.$w,z.NewName);z.BreadcrumbFolderName&&(this.gF.breadcrumbFolderName=z.BreadcrumbFolderName);
z.BreadcrumbFolderUrl&&(this.gF.breadcrumbFolderUrl=z.BreadcrumbFolderUrl);this.Zqf(z.NewName)}kyk(z){const Y=new mb.StandardDialog;Y.yd=0;switch(z){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Y.Ikb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Y.Ikb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:z}),Y.Ikb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}O.AFrameworkApplication.nT().execute(m=>{m.sendMessage(rc.a.fYi,{["FailureMessage"]:Wb[z]})});this.omh()}xUk(z,Y,m){if(1===m)return this.hAb();if(!O.AFrameworkApplication.Msa)return 8;O.AFrameworkApplication.Msa(Object(v.a)(this,this.BHb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.zgd,"onRefreshFilenameFailure"),
!1);return 32}Bgb(z,Y,m,I,X){if(1===m)return O.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===m){const ta={};z=O.AFrameworkApplication.Dbb;Y=O.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");z=(!z||z&&Y)&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ta[rd.a.ytl]=z;X&&X.MoveButtonClickedTime&&(ta[rd.a.iok]=X.MoveButtonClickedTime.getTime());O.AFrameworkApplication.nT().execute(Fa=>{Fa.sendMessage(rc.a.Bgb,ta)});
X&&X.MoveButtonClickedTime&&((z=T.a.Uz())&&z.set("MovePostDuration",((new Date).getTime()-X.MoveButtonClickedTime.getTime()).toString()),A.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",z));return 32}return 8}Sdd(z,Y,m,I,X){if(1===m)return O.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.hAb():8;if(2===m){if(!O.AFrameworkApplication.fqc)return A.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!X)return A.Health.instance.recordKpiFailure("MoveToFolder",
"Null actiondata",!1,!1,null),8;if(X[rd.a.VMj])if(X[rd.a.jJh])if(z=X[rd.a.jJh].toLowerCase(),Y=O.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),m=O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Y&&O.AFrameworkApplication.Dbb&&m){const ta={};ta[rd.a.$Jb]="1";ta[rd.a.documentUrl]=z;ta[rd.a.reason]=cb.a.iUe;A.Health.instance.recordKpiSuccess("MoveToFolder",null);O.AFrameworkApplication.nT().execute(Fa=>{Fa.sendMessage(rc.a.mDa,ta)})}else if(!O.AFrameworkApplication.Dbb&&
m)A.Health.instance.recordKpiSuccess("MoveToFolder",null),Tc.a.vn(z,Tc.a.hba(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return A.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else A.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else O.AFrameworkApplication.Msa(Object(v.a)(this,this.BHb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.zgd,"onRefreshFilenameFailure"),!1),O.AFrameworkApplication.fqc(),A.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32}mll(z,Y){return z&&Y?z!==this.gF.breadcrumbFolderName||Y!==this.gF.breadcrumbFolderUrl:!1}BHb(z,Y){z&&(z.NewName!==ob.a.XG(this.gF.$w)||this.mll(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl))&&this.Mkc(z,Y)}zgd(){}omh(){this.Zqf(ob.a.XG(this.gF.$w))}get An(){return this.Ca.value}get QA(){return this.gha.value}static get instance(){return Uc.Ka||(Uc.Ka=Uc.t9a())}static t9a(){return new Uc(O.AFrameworkApplication.V$b,new Pa.a(()=>O.AFrameworkApplication.Ta),new Pa.a(()=>O.AFrameworkApplication.QA),
O.AFrameworkApplication.St,O.AFrameworkApplication.PQ,()=>O.AFrameworkApplication.evc,O.AFrameworkApplication.Toc,Object(v.a)(Rb.instance,Rb.instance.BPb,"updateTitle"),F.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>O.AFrameworkApplication.HT,O.AFrameworkApplication.fa,F.a.instance.resolve("Common.IRenameProps"))}static Uei(z,Y){z=ob.a.pQ(z);return Y+z}static ESk(z){const Y=z.Values[rd.a.wRj];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Y);
Y?O.AFrameworkApplication.Ta.La(na.a.Sdd,2,z.Values):A.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static CSk(z){O.AFrameworkApplication.Ta.La(na.a.renameFile,2,z.Values.NewName)}}Uc.Ka=null;Object(h.a)(Uc,"RenameActor",null,[]);var Ib=d(388),Vc=d(658),gc=d(597),rb=d(199);class Zb{constructor(z,Y){this.Ca=z;this.rAd=Y}wb(){this.Ca.ya(na.a.AZe,jc.a.frame,Object(v.a)(this,this.Pnl,"showRenameDialogAction"))}Pnl(z,Y,m){z=32;if(1===m)return rb.SessionStatusManager.instance.Aka||
O.AFrameworkApplication.JQ?8:32;2===m&&(32!==this.Ca.processAction(na.a.renameFile,1)?(this.Ca.processAction(na.a.eNb,2),Ib.a.instance.Xb(Vc.a.Qja,{["Reason"]:gc.a.K0k}),z=8):32===this.Ca.processAction(na.a.Qrc,1)?this.Ca.processAction(na.a.Qrc,2):this.rAd.value.create().j6());return z}}Object(h.a)(Zb,"RenameDialogActor",null,[645]);class Hc{constructor(z,Y,m){this.dialog=null;this.Ca=z;this.gF=Y;this.zNa=m}iij(){const z={};z.nameInputProps={["type"]:"AppInputProps",["id"]:Hc.Zub,["label"]:CommonUIStrings.l_RenameDialogLabel,
["value"]:ob.a.XG(this.gF.$w),["maxLength"]:this.zNa};return z}j6(){const z={["id"]:"RenameDialog",["bodyControls"]:this.iij()};this.dialog=new $a.a(!1,!1,!0);this.dialog.yd=1;this.dialog.ig="RenameDialog";this.dialog.aj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.XRe,"renameDialogHandler"),z)}XRe(z,Y){if(Y&&1===z){if(Y[Hc.Zub]&&(z=ob.a.XG(this.gF.$w),Y=(Y[Hc.Zub]||"").trim(),Y!==z&&""!==Y)){this.Ca.La(na.a.renameFile,2,Y);return}Ib.a.instance.Xb(Vc.a.Q2b,{["Reason"]:gc.a.gWf})}}}Hc.Zub=
"txtDocumentName";Object(h.a)(Hc,"ReactRenameDialog",null,[666]);class Ab{static get eg(){return $a.a.VA(Ab.En,CommonUIStrings.l_RenameDialogLabel)}}Ab.En="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(Ab,"RenameDialogHtml",null,[]);class ad extends $a.a{constructor(z,Y,m){super();this.Ca=z;this.gF=Y;this.zNa=
m;this.ig="RenameDialog";this.eg=Ab.eg}j6(){var z={["txtDocumentName"]:ob.a.XG(this.gF.$w)};this.aj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.XRe,"renameDialogHandler"),z);z=document.getElementById(ad.Zub);0<this.zNa&&(z.maxLength=this.zNa);z.focus()}XRe(z,Y){if(1===z&&(z=ob.a.XG(this.gF.$w),Y=(Y[ad.Zub]||"").trim(),Y!==z&&""!==Y)){this.Ca.La(na.a.renameFile,2,Y);return}Ib.a.instance.Xb(Vc.a.Q2b,{["Reason"]:gc.a.gWf})}}ad.Zub="txtDocumentName";Object(h.a)(ad,"RenameDialog",$a.a,[666]);
class Bd{constructor(z){this.Zpa=null;this.zNa=0;this.Ca=z;this._initialized=!1}initialize(z,Y){this.Zpa=z;this.zNa=Y;this._initialized=!0}create(){return this._initialized?O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.IC&&O.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new Hc(this.Ca,this.Zpa,this.zNa):new ad(this.Ca,this.Zpa,this.zNa):null}}Object(h.a)(Bd,"RenameDialogFactory",null,[644]);var kd=d(121),Be=d(102),Qd=d(70),ae=d(82),We=d(134);class $d{constructor(z,Y){this.Ca=
z;this.Od=Y}wb(){this.Ca.ya(na.a.Qrc,jc.a.frame,Object(v.a)(this,this.Qnl,"showRenameFlyoutAction"))}xqi(){return Qd.d("setDocumentTitleFlyoutOpened")&&O.AFrameworkApplication.Aa.hb.dO}Qnl(z,Y,m){if(1===m)return this.xqi()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}x8h(){$d.RVj&&O.AFrameworkApplication.vua&&We.a.instance.Db(new ae.a(5,1,5E3,()=>{32===this.Ca.processAction(na.a.Qrc,1)&&this.Od&&this.Od.Ae.name===kd.AFrame.EW&&(Be.a("RenameFloatieShownOnNewDocumentLoad",
!0),this.Ca.processAction(na.a.Qrc,2))}))}static get RVj(){$d.zAc&&null!=$d.zAc||(O.AFrameworkApplication.dGa("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),$d.zAc=O.AFrameworkApplication.fa?O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return $d.zAc}}$d.zAc=null;Object(h.a)($d,"RenameFlyoutActor",null,[643]);class Re{constructor(z,Y,m,I,X){this.qWd=null;this.gha=X;this.tgf=m;this.sgf=I;this.e4h=
z;this.XNa=Y}get QA(){return this.gha.value}v6f(){if(!this.sgf())return 5;if(this.XNa())return 1;if(this.QA){if(this.tgf&&!this.QA.Q0d)return 3;if(!this.tgf&&!this.QA.TDa)return 4}return this.e4h()?0:2}}Object(h.a)(Re,"RenameProps",null,[641]);var Ta=d(68);class xb{constructor(z,Y,m,I,X,ta){this.ZB=!1;this.KFd=new Ta.a;this.Vnb=Y;this.Txc=m;this.fxc=I;this.$a=X;this.kia=ta}enable(){this.ZB||(this.VGh(),this.U_e(),this.ZB=!0)}generateKey(z,Y,m){return String.format("{0}/{1}/{2}",m,z,Y)}mcj(){const z=
ob.a.XG(this.Vnb().$w);return this.generateKey(this.Vnb().breadcrumbFolderName,this.Vnb().breadcrumbFolderUrl,z)}ncj(z,Y,m){return z&&Y?this.generateKey(z,Y,m):m}JNi(z,Y,m){return z&&z!==this.Vnb().breadcrumbFolderName||Y&&Y!==this.Vnb().breadcrumbFolderUrl?!0:m!==ob.a.XG(this.Vnb().$w)}VGh(){const z=this.mcj();this.KFd.$(z,new Date)}YKe(z){this.Sjl(z)&&this.isf(z)}Sjl(z){const Y=this.fxc();return Y?this.kia&&this.kia.ebb||!Y.ike||!O.AFrameworkApplication.Msa?(this.Ezh(z),this.ZB=!1):!0:!1}v7g(z,
Y,m,I){const X=this.JNi(z,Y,m);z=this.ncj(z,Y,m);Y=this.KFd.Tf(z).returnValue;X&&!Y&&(this.fag(I),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Oua));X||this.KFd.$(z,this.Txc())}}Object(h.a)(xb,"ARenamedFileChecker",null,[563]);class kc extends xb{constructor(z,Y,m,I,X,ta,Fa,bb){super(z,Y,m,I,X,ta);this.Pmf=X;this.A_h=Fa;this.UCd=bb}get Oua(){return"RenamedFileCheckerUsingSettingsRefresh"}U_e(){this.Pmf.fQd(Object(v.a)(this,this.jbg,"handleSettingsRefresh"))}jbg(z,Y){Y&&Y.Ojc&&
Y.vrk&&(Y.sAb("BreadcrumbDocName")||Y.sAb("BreadcrumbFolderName")||Y.sAb("BreadcrumbFolderUrl")||Y.sAb("DirectInvokeDAVUrl")||Y.sAb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Oua),this.YKe(Y))}Ezh(){this.Pmf.Cjh(Object(v.a)(this,this.jbg,"handleSettingsRefresh"))}isf(z){if(z&&z.Ojc){const Y=z.Ojc;this.v7g(Y.Ga("BreadcrumbFolderName"),Y.Ga("BreadcrumbFolderUrl"),Y.Ga("BreadcrumbDocName"),z)}}fag(z){const Y={OperationResult:0,classId:1};z=z.Ojc;
Y.BreadcrumbFolderName=z.Ga("BreadcrumbFolderName");Y.BreadcrumbFolderUrl=z.Ga("BreadcrumbFolderUrl");Y.DirectInvokeDavUrl=z.Ga("DirectInvokeDAVUrl");Y.EditDocInClientUrl=z.Ga("EditDocInClientUrl");z=z.Ga("BreadcrumbDocName");Y.NewName=O.AFrameworkApplication.kOc?z:ob.a.XG(z);this.UCd.execute(m=>{this.zJj(Y,m)})}zJj(z,Y){this.A_h().Mkc(z,Y)}}Object(h.a)(kc,"RenamedFileCheckerUsingSettingsRefresh",xb,[]);class Nc extends xb{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb){super(z,m,I,X,ta,yb);this.mWb=this.SFc=
null;this.rZh=Y;this.Ca=Fa;this.$d=bb;Bb&&Bb.execute(pb=>{this.jXk(pb)})}get Oua(){return"RenamedFileCheckerUsingTask"}jXk(z){this.SFc=z;this.SFc.eHc(Object(v.a)(this,this.S7b,"handleVisibilityChange"))}S7b(z,Y){!this.ZB||0!==Y.newState&&1!==Y.newState||this.mWb||(this.U_e(),this.YKe(this.mWb))}U_e(){this.mWb=new ae.a(3,2,this.rZh(),Object(v.a)(this,this.YKe,"performRenameFileCheckTick"),89);this.$d.Db(this.mWb)}Ezh(z){this.$d.Mg(z)}isf(z){this.SFc&&2===this.SFc.s6a?this.pYk(z):O.AFrameworkApplication.Msa(Object(v.a)(this,
this.BHb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.zgd,"onRefreshFilenameFailure"),!0)}pYk(z){this.$d.Mg(z);this.mWb=null}BHb(z){z&&this.v7g(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl,z.NewName,null)}fag(){this.Ca.processAction(na.a.fileNameUpdate,2)}zgd(){}}Object(h.a)(Nc,"RenamedFileCheckerUsingTask",xb,[]);var id=d(95);class Ed{constructor(){this.$a=this.Da=null}get name(){return"Common.App.RenameFile"}Zb(z){this.Da=z;this.$a=O.AFrameworkApplication.fa;this.Da.register(Zb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").oa(()=>
new Zb(O.AFrameworkApplication.Ta,this.Da.ke("Common.App.Rename.IRenameDialogFactory"))).ma();this.Da.register(Bd,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").oa(()=>new Bd(O.AFrameworkApplication.Ta)).ma();this.Da.register(563,"Common.App.Rename.IRenamedFileChecker").oa(()=>this.jHi()).ma();this.Da.register($d,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").oa(()=>new $d(O.AFrameworkApplication.Ta,id.FocusManager.instance())).ma()}jHi(){if(this.$a.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const z=
this.Da.rb("Common.IRefreshableAppSettings");if(z&&z.sUj)return new kc(()=>z.Bc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>O.AFrameworkApplication.St,()=>new Date,()=>O.AFrameworkApplication.QA,z,this.Da.rb("Common.ISessionStatus"),()=>Uc.instance,this.Da.Ja("Postmessage.IHostPostmessenger"))}return new Nc(()=>this.$a.Bc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.$a.Bc("RenamedFileCheckerPingIntervalInMs",12E4),()=>O.AFrameworkApplication.St,()=>new Date,()=>O.AFrameworkApplication.QA,
O.AFrameworkApplication.fa,O.AFrameworkApplication.Ta,O.AFrameworkApplication.ye,this.Da.rb("Common.ISessionStatus"),this.Da.Ja("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.$a.ff(Object(v.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){const z=O.AFrameworkApplication.Aa.hb.dO;O.AFrameworkApplication.V$b()&&Rb.instance.initialize(O.AFrameworkApplication.eQc,z?null:O.AFrameworkApplication.pOc,z?null:O.AFrameworkApplication.bkh||CommonUIStrings.l_RenameFileTooltip)&&(this.Da.register(Re,
"Common.App.Rename.RenameProps").as("Common.IRenameProps").oa(()=>new Re(()=>O.AFrameworkApplication.evc,()=>O.AFrameworkApplication.HT,O.AFrameworkApplication.Toc,O.AFrameworkApplication.V$b,new Pa.a(()=>O.AFrameworkApplication.QA))).ma(),Uc.instance.wb(),this.$a.ka("RenameDialogIsEnabled")&&(this.Da.resolve("Common.App.Rename.RenameDialogFactory").initialize(O.AFrameworkApplication.St,O.AFrameworkApplication.eQc),this.Da.resolve("Common.App.Rename.IRenameDialogActor").wb()),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").wb(),
O.AFrameworkApplication.Toc&&this.Da.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").x8h())}dispose(){}}Object(h.a)(Ed,"PackageManager",null,[2,3]);const Ja=z=>{try{return D.a(z)}catch(Y){}return null};class db{constructor(z,Y,m,I,X,ta){this.t2=!1;this.xS=null;this.NId=!1;this.Ca=z;this.Yh=Y;this.gha=m;this.dif=I;this.$a=X;this.AWh=ta}init(z,Y){Y&&z.Ja("Common.Interface.IRtcBasicProvider").execute(Object(v.a)(this,this.KSd,"awaitRtc"))}KSd(z){const Y=
z.nM.task;Y.continueWith(()=>{this.xS=Y.result;this.NId&&(this.xS.dga(2,null,!0),this.NId=!1);this.xS.WBa((m,I)=>{2===I.type&&this.An.processAction(na.a.fileNameUpdate,2)});this.xS.k6a((m,I)=>{2===I.newState&&this.An.processAction(na.a.fileNameUpdate,2)});2===this.xS.connectionState&&this.An.processAction(na.a.fileNameUpdate,2)})}Msa(z){this.qUf(z,!0)}qUf(z,Y){const m=this.jmi(z.Cxh),I={};I[db.UIf]=db.VIf;this.ulh.nj(m,2,"",I,!1,2,Object(v.a)(this,this.BHb,"onRefreshFilenameSuccess"),Y?Object(v.a)(this,
this.dyk,"onRefreshFilenameFailureRetry"):Object(v.a)(this,this.l6g,"onRefreshFilenameFailureNoRetry"),z)}BHb(z){this.t2=!1;const Y=Ja(z.data.Wd);z.data.state.onSuccess(Y,this.dif.value)}dyk(z){5!==z.data.status||this.t2?this.l6g(z):(this.t2=!0,this.qUf(z.data.state,!1))}l6g(z){z.data.state.Bz(-1)}D8a(z){this.rUf(z,!0)}rUf(z,Y){const m=this.kmi(),I={};I[db.UIf]=db.VIf;I[db.Gyj]=ob.a.Ne(z.Elh);I[db.Eyj]=this.AWh.value.qWd;this.ulh.nj(m,2,"",I,!1,2,Object(v.a)(this,this.Mkc,"onRenameFileSuccess"),Y?
Object(v.a)(this,this.lyk,"onRenameFileFailureRetry"):Object(v.a)(this,this.r6g,"onRenameFileFailureNoRetry"),z)}kmi(){return this.wBf()}jmi(z){let Y=this.wBf();return Y=E.a.Ni(Y,db.Kyj,z?"2":"1")}wBf(){let z=(this.$a.value.appSettings.RenameWebServiceBase||"")+db.Fyj;z=E.a.Ni(z,db.Hyj,ob.a.Ne(O.AFrameworkApplication.hh));this.QA&&this.QA.ike&&(z=E.a.Ni(z,db.Jyj,"1"));return z}Mkc(z){this.t2=!1;const Y=Ja(z.data.Wd);z.data.state.onSuccess(Y,this.dif.value);this.j1g()}j1g(){this.xS?this.xS.dga(2,null,
!0):this.NId=!0}lyk(z){5!==z.data.status||this.t2?this.r6g(z):(this.t2=!0,this.rUf(z.data.state,!1))}r6g(z){z.data.state.Bz(-1)}get An(){return this.Ca.value}get ulh(){return this.Yh.value}get QA(){return this.gha.value}static get instance(){return db.Ka||(db.Ka=db.t9a())}static t9a(){return new db(new Pa.a(()=>O.AFrameworkApplication.Ta),new Pa.a(()=>O.AFrameworkApplication.Ke),new Pa.a(()=>O.AFrameworkApplication.QA),new Pa.a(()=>F.a.instance.resolve("Postmessage.IHostPostmessenger")),new Pa.a(()=>
O.AFrameworkApplication.fa),new Pa.a(()=>F.a.instance.resolve("Common.IRenameProps")))}}db.UIf="Content-Type";db.VIf="application/json; charset=utf-8";db.Fyj="renamehandler.ashx";db.Hyj="qs";db.Gyj="n";db.Jyj="sl";db.Eyj="X-CoauthLockId";db.Kyj="u";db.Ka=null;Object(h.a)(db,"ExecuteRenameFileHandler",null,[]);class zc{constructor(){this.Bz=this.onSuccess=null;this.Cxh=!1}}Object(h.a)(zc,"ExecuteRefreshFilenameData",null,[]);class Hd{constructor(){this.Bz=this.onSuccess=this.Elh=null}}Object(h.a)(Hd,
"ExecuteRenameFileData",null,[]);class Ad{constructor(){this.Da=null;this.tBd=db.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Zb(z){this.Da=z}init(){O.AFrameworkApplication.fa.ff(Object(v.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){O.AFrameworkApplication.V$b()&&(db.instance.init(this.Da,O.AFrameworkApplication.Toc),O.AFrameworkApplication.D8a=Object(v.a)(this,this.D8a,"executeRenameFile"),O.AFrameworkApplication.Msa=Object(v.a)(this,this.Msa,"executeRefreshFilename"),O.AFrameworkApplication.fqc=
Object(v.a)(this,this.fqc,"sendFileNameAndLocationUpdateNotification"))}D8a(z,Y,m){const I=new Hd;I.Elh=z;I.onSuccess=Y;I.Bz=m;this.tBd.D8a(I)}Msa(z,Y,m){const I=new zc;I.onSuccess=z;I.Bz=Y;I.Cxh=m;this.tBd.Msa(I)}fqc(){this.tBd.j1g()}dispose(){}}Object(h.a)(Ad,"PackageManager",null,[2,3]);class Kd{constructor(z,Y,m,I,X,ta){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=z;this.WebAffinitizedUrl=
Y;this.PolicyCookie=m;this.PolicyCookieTTL=I;this.WasServiceDown=X;this.AffinitizedUrl=ta}}Object(h.a)(Kd,"SafeLinksData",null,[]);class Pc{constructor(z,Y){this.Tsd=z;this.Ky=Y}}Object(h.a)(Pc,"SafeLinksGetUrlReputationRequestData",null,[]);class tf{constructor(z,Y,m,I){this.$a=z;this.Yh=Y;this.mTh=m;tf.Zh=I}qud(z,Y,m){try{var I=null;tf.Zh&&(I=tf.Zh.Ei("WebServiceCall","SafeLinksGetUrlReputation"));const X=new Pc(Y,I);I={};I.AffinitizedUrl=z;I.TargetUrl=Y;I.PolicyCookie=m;const ta=D.c(I);this.Yh.nj(this.mTh,
2,ta,null,!1,2,Object(v.a)(this,this.lvk,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.kvk,"onGetUrlReputationFailureCallback"),X,void 0,void 0,3E3,3E3,"36");return!0}catch(X){e.ULS.sendTraceTag(588788033,378,10,X.message)}return!1}lvk(z){let Y="OnGetUrlReputationSuccessCallback: ",m=10;const I=z.data.state;try{const X=D.b(z.data.Wd).reputationResults[0],ta=X.navigateUrl.length,Fa=I.Tsd.length,bb=X.navigateUrl===I.Tsd;X.navigateUrl&&0<X.navigateUrl.length&&(I.Tsd=X.navigateUrl);Y+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",
z.data.ie,X.verdict,Fa.toString(),ta.toString(),bb.toString());m=50}catch(X){Y+=String.format("Exception {0}",X.message)}this.kag(I,Y,m)}kvk(z){let Y="OnGetUrlReputationFailureCallback: ";const m=z.data.state;try{Y+=String.format("HttpStatus {0}",z.data.ie)}catch(I){Y+=String.format("Exception {0}",I.message)}this.kag(m,Y,10)}kag(z,Y,m){z.Ky&&(z.Ky.stop(),z.Ky=null);e.ULS.sendTraceTag(588788034,378,m,Y);Tc.a.vn(z.Tsd,void 0,"noopener,noreferrer","SafeLinksNav")}}tf.Zh=null;Object(h.a)(tf,"SafeLinksNavigationHelper",
null,[]);var xe;(function(z){z[z.enabledByPolicy=0]="enabledByPolicy";z[z.disabledByPolicy=1]="disabledByPolicy";z[z.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";z[z.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(xe||(xe={}));Object(h.b)("SafeLinksNavigationState",xe);var ef=d(498);class Id{constructor(z,Y,m,I=!1,X=null,ta=null){this.n3a=this.m3a=0;this.b$b=this.mzc=!1;this.JOa=null;this.Uob=!0;this.cEc=null;e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.$a=z;this.Yh=Y;this.Jpa=m;Id.Zh=ta;this.x4h=I?this.$a.Ga("SafeLinksHandlerWebServiceBase"):this.$a.Ga("WebServiceBase");this.f4h=this.$a.Ga("SafeLinksHashedUserId");this.yMl=this.$a.Ga("SafeLinksWorkloadIdHeaderValue");this.mBc=this.$a.Bc("SafeLinksMaxGetPolicyBootRetries",2);this.nBc=this.$a.Bc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.eAc=this.WUj();this.dAc=this.VUj();e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.eAc,this.dAc);
if(this.eAc&&this.dAc){Y=(z=this.ywb())?z.IsSafeLinksEnabled.toLowerCase():"";m=this.Hle();e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",Y,m);var Fa=!z||"unknown"===Y||z.WasServiceDown||m,bb=T.a.Uz();bb&&(bb.set("shouldGetSafeLinksDataFromServer",Fa.toString()),bb.set("isSafeLinksEnabledCacheValue",Y.toString()));X?(this.Uob=!1,X.execute(yb=>{yb.isFeatureEnabled("MsoUrlreputation",!0).then(Bb=>{this.Uob=Bb;bb.set("isUserLicensedForSafeLinks",
this.Uob.toString());A.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",bb);this.Uob&&Fa&&this.zUc(!0);return null})})):(A.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",bb),Fa&&this.zUc(!0))}}get appName(){return this.Jpa}get nwd(){return this.x4h}get userId(){return this.f4h}get Ngj(){const z=this.nwd?this.nwd+"/":"",Y=new da.QueryStringBuilder("SafeLinksHandler.ashx");Y.Xg("app",this.appName);this.$a.ka("SafeLinksUseDebugHeader")&&Y.Xg("action","debug");
this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&Y.Xg("s2satpop","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&Y.Xg("s2se03","1");return String.format("{0}{1}&{2}",z,Y.toString(),O.AFrameworkApplication.hh)}get Ioj(){const z=this.nwd?this.nwd+"/":"",Y=new da.QueryStringBuilder("SafeLinksHandler.ashx");Y.Xg("app",this.appName);this.$a.ka("SafeLinksUseDebugHeader")&&Y.Xg("action","debug");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&Y.Xg("s2satpop","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&Y.Xg("s2saat","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&Y.Xg("s2se03","1");Y.Xg("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",z,Y.toString(),O.AFrameworkApplication.hh)}get Vok(){Id.CKd||(Id.CKd=new tf(this.$a,this.Yh,this.Ioj,Id.Zh));return Id.CKd}qud(z){if(!z)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),
!1;var Y=this.LPj(z);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",Y,this.eAc,this.dAc,this.Uob);if(!(Y&&this.eAc&&this.dAc&&this.Uob))return!1;Y=0;const m=({state:Y}=this.kll()).returnValue;e.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",xe[Y]);const I=T.a.Uz();I&&I.set("SafeLinksNavigationState",xe[Y]);A.Health.instance.recordKpiUsage("SafeLinksNavigations",
0,"jpittsdirects",I);if(!m)return 2!==Y&&3!==Y||A.Health.instance.recordKpiFailure("SafeLinksNavigations",xe[Y],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.wll())return this.Hle()?!1:this.Vok.qud(this.e4i(),z,this.Q5f());if(!this.Hle())return this.hFh(z),!0;this.JOa=z;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.b$b=!1;this.zUc();return!0}LPj(z){z=z.toLowerCase();const Y=this.$a.YA("SafeLinksUnsupportedProtocols");
if(Y)for(let m=0;m<Y.length;m++)if(z.startsWith(Y[m]))return!1;return!0}zUc(z=!1){var Y=T.a.Uz();Y&&Y.set("isOnBootRequest",z.toString());A.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",Y);A.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",Y);Y=this.bYd("SafeLinksGetPolicy");this.Yh.nj(this.Ngj,1,null,null,!0,2,Object(v.a)(this,this.ejj,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.djj,"getSafeLinksDataFromServer_OnFailureCallback"),
Y,void 0,void 0,void 0,void 0,"23");this.b$b=z;this.mzc=!0;z?this.m3a++:this.n3a++}ejj(z){let Y=u.a.Xpk,m="";try{this.mzc=this.b$b=!1;var I=z.data.state;const Ob=({Ky:I}=this.$rd(I)).returnValue,sc=Object.assign(new ka.a,{durationMs:Ob});A.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",sc);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",z.data.ie,z.data.Wd.length,Ob);if(z.data.ie!==u.a.Wv)m="Unexpected httpStatus: "+
z.data.ie.toString();else{I=null;try{I=D.b(z.data.Wd)}catch(wc){m="Exception:"+wc.toString()+" deserializing response";return}if(I){var X=I.IsSafeLinksEnabled;if(void 0===X||null===X||0>=X.length)m="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",X);var ta=Id.AKe(X);if(void 0===I.WebAffinitizedUrl||null===I.WebAffinitizedUrl||0>=I.WebAffinitizedUrl.length)m="Invalid WebAffinitizedUrl";else if(void 0===I.PolicyCookie||null===I.PolicyCookie||
0>=I.PolicyCookie.length)m="Invalid PolicyCookie";else if(void 0===I.PolicyCookieTTL||null===I.PolicyCookieTTL)m="Invalid PolicyCookieTTL";else{var Fa=I.WebAffinitizedUrl,bb=I.PolicyCookie,yb=I.AffinitizedUrl,Bb=new Date;Bb.setMinutes(Bb.getMinutes()+(5<I.PolicyCookieTTL?I.PolicyCookieTTL-5:0));var pb=new Kd(X,Fa,bb,Bb.getTime(),!1,yb);this.yqh(pb);Y=z.data.ie;this.JOa&&(ta?(this.hFh(this.JOa),this.n3a=this.m3a=0):(e.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),
A.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Tc.a.RQc(this.JOa)),this.JOa=null)}}}else m="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Ob){m="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Ob.toString()}finally{Y!==u.a.Wv&&this.jag(Y,m)}}djj(z){this.mzc=!1;let Y=500,m="";try{let I=z.data.state;const X=({Ky:I}=this.$rd(I)).returnValue,ta=Object.assign(new ka.a,{durationMs:X});Y=z.data.ie;A.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+Y.toString(),!1,!0,ta);m="Request Failed, Status="+ef.a[z.data.status]+" Duration: "+X}catch(I){m="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+I.toString()}finally{this.jag(Y,m)}}jag(z,Y=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",z,Y),this.m3a<this.mBc&&this.n3a<this.nBc)this.zUc(this.b$b);else{this.b$b=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.m3a,this.n3a,z,Y);Y=null;const m=T.a.Uz();m&&(m.set("HttpStatus",z.toString()),Y=Object.assign(new ka.a,{extendedProperties:m}));A.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,Y);const I=new Kd("false","","",0,!0,"");this.yqh(I);this.JOa&&(e.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),A.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Tc.a.RQc(this.JOa),this.JOa=null)}}catch(m){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",m.toString())}}hFh(z){const Y=this.Q5f(),m=this.Apj(),I={};I.Url=z;I.SafeLinksCookie=Y;I.CorrelationId=ea.a.create().toString();I.WorkloadId=this.yMl;I.UserAgentInfo=fa.a.Wy+"|"+this.appName;e.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",I.CorrelationId);Tc.a.Vid(Tc.a.hba(4),m,I)}WUj(){const z=this.$a.Ga("IsSafeLinksEnabledForUser");
return z?Id.AKe(z):!1}VUj(){const z=this.$a.YA("SafeLinksDisabledBrowsers");if(fa.a.zT){if(this.$a.Eu("SafeLinksForTeamsIsEnabled")&&this.$a.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(z,"Electron"))return!1}else if(Array.contains(z,fa.a.Wy))return!1;return"officecomhwa"===(this.$a.Ga(O.AFrameworkApplication.gK)||"").toLowerCase()?!1:!0}wll(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",
!1)&&fa.a.t$b?!0:fa.a.zT}kll(){let z;z=0;const Y=this.ywb(),m=Y?Y.IsSafeLinksEnabled:"";if(""!==m)return Y.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===m.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:Id.AKe(m),state:z};if(this.mzc)return z=3,e.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:z};if(this.m3a>=
this.mBc||this.n3a>=this.nBc)return z=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.m3a,this.mBc,this.n3a,this.nBc),{returnValue:!1,state:z};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.mBc+this.nBc-(this.m3a+this.n3a));return{returnValue:!0,state:z}}Q5f(){const z=
this.ywb();return z?z.PolicyCookie:""}Apj(){const z=this.ywb();return z?z.WebAffinitizedUrl:""}e4i(){const z=this.ywb();return z?z.AffinitizedUrl:""}H$i(){const z=new Date;try{const Y=this.ywb();z.setTime(Y?Y.PolicyCookieTTL:0)}catch(Y){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",Y)}return z}Hle(){const z=this.H$i();return!!z&&z.getTime()<Date.now()}ywb(){if(!this.cEc){const z=ua.a.instance.getItem(this.userId);if(!z||""===z)return null;this.cEc=
JSON.parse(z)}return this.cEc}yqh(z){if(void 0===z||null===z)throw Error.argumentNull("safeLinksData");if(void 0===z.IsSafeLinksEnabled||null===z.IsSafeLinksEnabled||0>=z.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.cEc=z;z.WasServiceDown||this.FMl(z)}FMl(z){z=JSON.stringify(z);ua.a.instance.setItem(this.userId,z)}bYd(z){return void 0!==Id.Zh&&null!==Id.Zh?Id.Zh.Ei("WebServiceCall",z):null}$rd(z){if(void 0!==z&&null!==z){const Y=z.Vq;z.stop();return{returnValue:Y,
Ky:null}}return{returnValue:null,Ky:z}}static AKe(z){return"false"!==z.toLowerCase()?!0:!1}}Id.Zh=null;Id.CKd=null;Object(h.a)(Id,"SafeLinksManager",null,[533]);const qe=z=>{switch(z){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},jg=z=>{switch(z){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var of=d(213);class Cb{constructor(){this.K=null}get name(){return"PowerPointSafeLinks"}Zb(z){this.K=z}init(){O.AFrameworkApplication.fa.ff(Object(v.a)(this,
this.Qm,"onFullAppSettingsReady"))}Qm(){const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Y=z?z.vg:!1;z.pptSafeLinksIsEnabled&&(this.K.register(Id,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().oa(()=>new Id(O.AFrameworkApplication.fa,O.AFrameworkApplication.Ke,String.format("{0}-{1}",qe(O.AFrameworkApplication.Aa.hb.Uk),jg(O.AFrameworkApplication.Aa.hb.gJa)),Y)).ma(),this.K.rb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){Ma.a.instance.Dc(of.a(new Cb,
0))}}Object(h.a)(Cb,"SafeLinksPackage",null,[2,3]);var Df=d(346),Bf=d(288),qg=d(1209),vd=d(87),$f=d(29),ng=d(173),Qe=d(93),Gf=d(1042);class Jf{constructor(z,Y,m,I,X,ta){this.CG=z;this._id=Y;this.GAd=I;this.tRh=X;this.uRh=ta;this.cyc=this.Aub;void 0!==m&&null!==m&&(this.Aub=m)}get defaultValue(){return this.cyc}get lcid(){return this.CG}get id(){return this._id}get Aub(){return(this.tRh||Jf.lbf)(this.GAd)}set Aub(z){(this.uRh||Jf.mbf)(this.GAd,z)}get Uf(){return this.GAd}static qr(){Jf.lbf=()=>null;
Jf.mbf=()=>{}}}Jf.lbf=null;Jf.mbf=null;Object(h.a)(Jf,"GrammarSettingOption",null,[848]);Jf.qr();class xh{constructor(z,Y,m){this.v4d=z;this.DUe=Y;this.mpk=m}}Object(h.a)(xh,"TwoLevelCacheKey",null,[]);var he=d(34),de=d(218),xf=d(2);class re extends $a.a{constructor(z,Y,m,I){super();this.XJd=this.M7=this.Wcf=this.CRb=null;this.No=I;this.Ozd=z;this.ig=re.id;this.vYh=()=>{this.CRb=m?ma.a.Yqc(m):{};this.Wcf=m?ma.a.Yqc(m):{};const X=this.Iki(),ta=re.WDi(X,re.Iod(Object(v.a)(this,this.VDi,"createCritiqueTypeSettingsTracker"))(re.yxi(bb=>
this.CRb=bb)));ta(m||{});var Fa=re.Iod(re.VIi())(bb=>bb.cloneNode(!0));re.XDi(X,re.uDi(re.nHi(Y),re.UDi(Fa))(m))(z.toString());this.XJd=this.nmi();Fa=bb=>{if("click"===bb.type||bb.keyCode===ng.a.tq||bb.keyCode===ng.a.NPb)this.CRb[z.toString()]={},X.reset(),re.S2k(ta)};Qe.a.addHandler(this.v_a,Nb.a.click,Fa);Qe.a.addHandler(this.v_a,Nb.a.Xf,Fa)};this.eg=""}get v_a(){return this.XJd}dYj(){var z=re.fRe(this.CRb),Y=re.fRe(this.Wcf);if(!z&&!Y)return!1;let m;try{m=z?Object(B.a)(Object,z[this.Ozd.toString()]):
{};var I=Y?Object(B.a)(Object,Y[this.Ozd.toString()]):{}}catch(Fa){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!m&&!I)return!1;m=m?m:{};I=I?I:{};z=String.format("language: {0}",this.Ozd.toString());Y=!1;for(let Fa in m){var X=Fa,ta=m[Fa];X in I&&I[X]===ta||(Y=!0,z=String.format("{0}, [{1}, {2}]",z,X,ta))}for(let Fa in I)I=Fa,I in m||(Y=!0,z=String.format("{0}, [{1}, default]",z,I));Y&&e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",z);return Y}aj(z,
Y,m){super.aj(z,Y,m);this.ASk()}DN(z){return z.Ec.id===re.Mlh?!1:super.DN(z)}B8k(){this.No.yl().Ldd();this.M7=this.No.yl().wj.d_}ASk(){this.No.yl().scope.Dp(id.FocusManager.instance().Wqa);this.No.yl().scope.Dp(id.FocusManager.instance().Xqa);this.No.yl().scope.bindAction(id.FocusManager.instance().Wqa,he.a.u7b);this.No.yl().scope.bindAction(id.FocusManager.instance().Xqa,he.a.t7b);this.No.yl().scope.bindAction(Ac.KeyInputManager.Oa(ng.a.dba,0),he.a.GVc);this.No.yl().scope.bindAction(Ac.KeyInputManager.Oa(ng.a.Rga,
0),he.a.FVc);this.No.yl().scope.bindAction(Ac.KeyInputManager.Oa(ng.a.fZ,0),he.a.GVc);this.No.yl().scope.bindAction(Ac.KeyInputManager.Oa(ng.a.O6,0),he.a.FVc)}get settings(){return re.fRe(this.CRb)}axa(){super.axa();this.vYh()}Iki(){const z=re.dli(),Y=re.d_b("WACDialogRow",z);this.PP.insertBefore(Y,this.PP.firstChild);return z}VDi(z){const Y=Gf.a.merge(null,z);return m=>{m.Aub===(z&&z[m.lcid]?z[m.lcid][m.id]:null)||m.Aub!==m.defaultValue?re.o5f(Y,m.lcid)[m.id]=m.Aub:delete re.o5f(Y,m.lcid)[m.id];
this.M7=this.oaj(m.Uf);return Y}}oaj(z){return z?(z=z.getElementsByTagName(Sys.UI.DomElement.containsCssClass(z,re.$Zj)?"select":"input"))?z[0]:null:null}dispose(){this.v_a&&(Qe.a.dih(this.v_a),this.XJd=null);super.dispose()}nmi(){const z=document.createElement("input");z.id=re.Mlh;z.type="reset";z.setAttribute("form",re.HYf);z.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";z.value=CommonUIStrings.l_ResetAll;const Y=re.d_b("GrammarSettingsDialogResetButtonContainer",
z),m=document.getElementById("WACDialogButtonPanel");m.parentNode.insertBefore(Y,m);return z}static get V1b(){return"CritiqueType"}static yxi(z){return Y=>m=>z(Y(m))}static Iod(z){return Y=>m=>Y(z(m))}static fRe(z){const Y={};ma.a.forEach(z,(m,I)=>{0<de.a(I).length&&(Y[m]=I)},null);return Y}static dli(){const z=document.createElement("form");z.id=re.HYf;Sys.UI.DomElement.addCssClass(z,"WACDialogList");Sys.UI.DomElement.addCssClass(z,re.qJi);return z}static WDi(z,Y){const m=re.HRk(z,Nb.a.change);return I=>
{const X=Y(I);m(ta=>{ta=ta.target.parentNode;Sys.UI.DomElement.containsCssClass(ta,re.V1b)&&X(ta[re.mzf])})}}static HRk(z,Y){let m=null;return I=>{m&&Qe.a.removeHandler(z,Y,m);Qe.a.addHandler(z,Y,I);m=I}}static o5f(z,Y){return z[Y]=z[Y]||{}}static S2k(z){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");z(null)}static nHi(z){let Y=null;return m=>{Y=m;return z.request(Number.parseInvariant(m)).CWRCo(I=>Y===m?I.result:null,re.i_d)}}static XDi(z,Y){const m=re.U4i(I=>re.txl(I.children));
return I=>{const X=m(I,z);z.innerHTML="";(X?xf.Task.gt(X):Y(I)).continueWith(ta=>{ta=ta.result;for(let Fa=0;Fa<ta.length;Fa++)z.appendChild(ta[Fa])},re.i_d)}}static uDi(z,Y){return m=>I=>z(I).CWRCo(X=>Ya.toArray(Ya.select(Ya.asEnumerable(X.result),ta=>Y(m,ta,I))),re.i_d)}static txl(z){const Y=[];for(let m=0;m<z.length;m++)Y.push(z[m]);return Y}static U4i(z){const Y={};let m=null;return(I,X)=>{m&&!Y[m]&&(X=z(X))&&(Y[m]=X);m=I;return Y[I]}}static VIi(){const z={};return Y=>{z[Y.v4d]=z[Y.v4d]||{};const m=
z[Y.v4d];m[Y.DUe]=m[Y.DUe]||Y.mpk();return m[Y.DUe]}}static UDi(z){return(Y,m,I)=>{const X=z(new xh(I,m.Id,()=>re.Qki(m)));X.setAttribute("role","group");const ta=re.AEf+m.Name;X.setAttribute("aria-labelledby",ta);for(const Fa of m.CritiqueTypeInfoList){const bb=re.B2i(I,Fa,Y,z);X.appendChild(bb);bb.setAttribute("aria-labelledby",ta)}return X}}static B2i(z,Y,m,I){I=I(new xh(z,Y.Id,()=>Y.IsBinaryCritiqueType?re.Oki(Y):re.Wli(Y)));z=new Jf(z,Y.Id,m&&m[z]?m[z][Y.Id]:null,I,Y.IsBinaryCritiqueType?X=>
X.children[0].checked:X=>X.children[1].selectedIndex,Y.IsBinaryCritiqueType?(X,ta)=>{X.children[0].checked=ta}:(X,ta)=>{X.children[1].selectedIndex=ta});I[re.mzf]=z;return I}static Qki(z){z=re.Rki(z.Name);z.className="WACWritingStylesDialogCategoryTitle";return re.d_b("CritiqueCategory",z)}static Oki(z){const Y=re.Ski();Y.id=z.Id;0<z.DefaultCritiqueValue&&Y.setAttribute("checked","checked");z=re.iBf(z.Name,z.Id);z.className="WACDialogLabel";const m=re.d_b(re.V1b,Y,z);m.appendChild(Y);m.appendChild(z);
return m}static Wli(z){z=re.Gli(z.Id,z.Name,re.ami(z.CritiqueTypeValues,z.DefaultCritiqueValue),z.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(z,re.V1b);return z}static ami(z,Y){return Ya.toArray(Ya.Si(Ya.asEnumerable(z||[]),(m,I)=>{m=re.$li(m,I.toString());I===Y&&m.setAttribute("selected","selected");return m}))}static Gli(z,Y,m,I){Y=re.iBf(Y,z);const X=document.createElement("select");X.id=z;X.className="WACDialogList";m=m||[];for(z=0;z<m.length;z++)X.appendChild(m[z]),I===z&&(m[z].selected=
!0);return re.d_b("GrammarSettingsDialogLabeledInlineList",Y,X)}static $li(z,Y){const m=document.createElement("option");m.text=z;m.value=Y;return m}static Ski(){const z=document.createElement("input");z.type="checkbox";z.className="WACDialogCheckBox";return z}static iBf(z,Y){const m=document.createElement("label");m.innerText=z;m.setAttribute("for",Y);return m}static Rki(z){const Y=document.createElement("div");Y.innerText=z;Y.id=re.AEf+z;return Y}static d_b(z=null,...Y){const m=document.createElement("div");
m.className=z;for(const I of Y)m.appendChild(I);return m}}re.id="GrammarSettingsDialog";re.HYf="CritiqueTypeSettings";re.qJi="CritiquesList";re.$Zj="GrammarSettingsDialogLabeledInlineList";re.Mlh="ResetButton";re.AEf="WritingStylesCategory_";re.i_d=11;re.mzf="CritiqueType";Object(h.a)(re,"GrammarSettingsDialog",$a.a,[]);var Ih=d(141),Le=d(315),Cd=d(1131),Lc=d(41),Td=d(350),Ge=d(60),Xc=d(155),jf=d(48),Mh=d(896),bd=d(28),Bc=d(30);class Hf{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=
this.Degree=0}}Object(h.a)(Hf,"EffectDataInfo",null,[]);var Me=d(859);class Tf{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(h.a)(Tf,"AddAnimationInfo",null,[]);class Sd{constructor(){this.TargetEffects=null}}Object(h.a)(Sd,"DeleteAnimationInfo",null,[]);class lf{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(h.a)(lf,"TargetEffect",null,[]);class fb{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=
null}}Object(h.a)(fb,"ReplaceAnimationInfo",null,[]);class Qb{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(h.a)(Qb,"ModifyAnimationInfo",null,[]);class ac{constructor(){this.StartType=0;this.TargetEffects=null}}Object(h.a)(ac,"ChangeAnimationRelationshipInfo",null,[]);var Jc=d(352),pd=d(149),qd=d(90);class sd{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(h.a)(sd,"ChangeAnimationBuildTypeInfo",
null,[]);class ze{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(h.a)(ze,"ReorderAnimationEffectsInfo",null,[]);var Wd=d(35),ye=d(39);class Yc{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob,sc,wc){this.q6="Existing";this.vLa="ExistingInMenu";this.w_e="AnimationExisting";this.x_e="AnimationExistingInMenu";this.Mea=!1;this.Ghb=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;$b=this.pa.uk();if(!$b||!Lb||!Lb.length)return 8;if(1===Oc)return 32;Oc=this.oka(Lb,$b);zd.MenuItems=this.Kki(Lb,$b,
Oc);return 32};this.$na=(Lb,$b,Oc,md,zd)=>{Lb=zd.queryResult;zd=zd.SourceControlId;md=$b=-1;zd!==this.q6&&({effectType:md,effectId:$b}=this.Gk.PSc(zd));var le=this.zo.vy;if(!this.pa.uk())return 8;if(1!==Oc)return 32;Oc=this.Gk.QSc(zd);var df=Oc.label;if(zd===this.q6||zd===this.vLa)df=ResourceStrings.L_ExistingButtonDescription;this.o9a(zd,Oc.image,Oc.label,Lb,df);let bf=df=!1;const Hg=0==le.length?0:le[0].EffectId,Yh=0==le.length?0:le[0].EffectType,Hi=!this.Gk.wzb(le);le=this.Gk.S9b(le);Hi||le||(df=
$b===Hg&&md===Yh,bf=this.Gk.BZc(Yh,Hg));zd===this.q6?(bf=this.qNk(this.q6,Lb,le,bf,Hi,Oc.image,Yh,Hg),Lb.ZU(Hi||le||bf)):zd===this.vLa?(bf=Yc.oNk(Lb,le,Hi,bf),Lb.ZU(Hi||le||bf)):Lb.ZU(df);return 32};this.Fz=(Lb,$b,Oc,md,zd)=>{$b=this.zo.vy;var le=this.pa.uk();let df=!0;md=this.getSelectedShapes();if(!md||!md.length)if(df=!1,md=this.oka($b,le),!md||!md.length)return bd.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;if(!Yc.Ymg(le,md)||this.Bua(md))return 8;if(1===
Oc)return le=0<$b.length&&!this.Gk.wzb($b),Oc=Yc.nVj(md),le&&Oc?8:Lb===Bc.a.LLb||Lb===Bc.a.b0a?(md=0<$b.length&&this.Gk.S9b($b),Oc=!1,le||md||(Oc=this.Gk.BZc(0<$b.length?$b[0].EffectType:-1,0<$b.length?$b[0].EffectId:-1)),Lb===Bc.a.b0a&&(Oc=le?!0:!1),le||md||Oc?32:16):Lb===Bc.a.KLb?Yc.oVj(md)?32:16:32;Lb=zd.SourceControlId;if(!Lb)return 8;if(Lb===this.q6||Lb===this.vLa||Lb===this.w_e||Lb===this.x_e)return 32;Lb=this.Gk.PSc(Lb);(Lb=Yc.B4i(md,Lb.effectId,Lb.effectType,df,$b))&&this.k_(le,Lb);return 32};
this.x_g=(Lb,$b,Oc)=>{const md=this.zo.vy;$b=this.pa.uk();if(!$b||!md||!md.length)return 8;var zd=this.oka(md,$b);if(!zd||!zd.length)return bd.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),8;if(this.Bua(zd))return 8;switch(Lb){case Bc.a.gFe:Lb=!1;break;case Bc.a.hFe:Lb=!0;break;default:return 8}zd=this.Gk.yej($b,md,Lb);if(1===Oc)return zd.isEnabled?32:8;if(!zd.old)return bd.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),
8;Oc=Yc.T8(md);Oc=Yc.DLf(Oc,zd.old,Lb);this.k_($b,Oc);return 32};this.uya=(Lb,$b,Oc,md,zd)=>{$b=this.zo.vy;Lb=this.pa.uk();if(!Lb||!$b||!$b.length)return 8;md=this.oka($b,Lb);if(!md||!md.length)return bd.a.J(509677842,800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.Bua(md))return 8;if(1===Oc)return 32;Oc=pd.Box4ColorHelper.YR(zd);if(!Oc)return bd.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;Oc=pd.Box4ColorHelper.gjb(Oc,Lb.Jd);if(!Oc)return bd.a.J(509677840,
800,10,"AnimationActor::setAnimationColor:  color is null"),8;zd=new Me.a;zd.AnimationAction=1;md=new Qb;md.TargetEffects=Yc.T8($b);md.ModifyAnimPropType=3;$b=new Hf;$b.Color=[Oc.r,Oc.g,Oc.b];$b.EffectDataPropType=1;md.EffectData=$b;zd.ModifyAnimationInfo=md;this.k_(Lb,zd);return 32};this.VNe=()=>{const Lb=this.zo.vy;var $b=this.pa.uk();if(!$b||!Lb||!Lb.length)return 8;$b=this.oka(Lb,$b);return $b&&$b.length?this.Gk.eqi($b,this.Ea,Lb)?32:16:(bd.a.J(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),
8)};this.$_a=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;$b=this.pa.uk();if(!$b||!Lb||!Lb.length)return 8;md=this.oka(Lb,$b);if(!md||!md.length)return bd.a.J(509677838,800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),8;if(this.Bua(md))return 8;if(1===Oc)return 32;Oc=this.Gk.I5b(zd.MenuItemId);zd=new Me.a;zd.AnimationAction=1;md=new Qb;md.TargetEffects=Yc.T8(Lb);md.ModifyAnimPropType=2;md.Direction=Oc;zd.ModifyAnimationInfo=md;this.k_($b,zd);return 32};this.NZa=(Lb,$b,Oc,md,zd)=>
{Lb=this.zo.vy;if(!this.pa.uk()||!Lb||!Lb.length)return 8;$b=zd.queryResult;zd=this.Gk.I5b(zd.MenuItemId);Yc.nKj(Lb)&&$b.Lf(Lb[0].Direction===zd);return 32};this.TKa=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;$b=this.pa.uk();if(!$b||!Lb||!Lb.length)return 8;md=this.oka(Lb,$b);if(!md||!md.length)return bd.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.Bua(md))return 8;if(1===Oc)return 32;Oc=zd.MenuItemId;zd=new Me.a;zd.AnimationAction=5;md=new sd;md.TargetEffects=
Yc.T8(Lb);md.BuildType=Yc.z5i(Oc);zd.ChangeAnimationBuildTypeInfo=md;this.k_($b,zd);return 32};this.aoa=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;if(!this.pa.uk()||!Lb||!Lb.length)return 8;$b=zd.queryResult;zd=this.Gk.w$d(zd.MenuItemId);Yc.lKj(Lb)&&$b.Lf(Lb[0].BuildType===zd);return 32};this.a0a=(Lb,$b,Oc,md,zd)=>{$b=this.zo.vy;Lb=this.pa.uk();if(!Lb||!$b||!$b.length)return 8;md=this.oka($b,Lb);if(!md||!md.length)return bd.a.J(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),
8;if(this.Bua(md))return 8;if(1===Oc)return 32;md=zd.MenuItemId;Oc=new Me.a;Oc.AnimationAction=1;zd=new Qb;zd.TargetEffects=Yc.T8($b);zd.ModifyAnimPropType=3;$b=this.$9i(md);if(!$b)return bd.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;zd.EffectData=$b;Oc.ModifyAnimationInfo=zd;this.k_(Lb,Oc);return 32};this.OZa=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;if(!this.pa.uk()||!Lb||!Lb.length)return 8;zd.queryResult.Lf(this.Gk.bIf(Yc.a$i(Lb[0].EffectData),zd.MenuItemId));
return 32};this.Y$k=(Lb,$b,Oc,md,zd)=>{$b=this.zo.vy;Lb=this.pa.uk();if(!Lb||!$b||!$b.length)return 8;md=this.oka($b,Lb);if(!md||!md.length)return bd.a.J(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.Bua(md))return 8;if(1===Oc)return 32;Oc=zd.CommandValueId;if(!Oc||!Oc.trim().length)return bd.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;Oc=Yc.Mlj(Oc);if(3==Oc)return bd.a.J(509703437,800,
15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;for(var le of $b)le.StartType=Oc;le=Yc.T8($b);le=Yc.nKf(le,Oc);this.k_(Lb,le);return 32};this.jJb=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;if(!this.pa.uk()||!Lb||!Lb.length)return Yc.BVe(zd,3),32;$b=Lb[0].StartType;Oc=!0;for(const le of Lb)if($b!=le.StartType){Oc=!1;break}Oc?Yc.BVe(zd,$b):Yc.BVe(zd,3);return 32};this.X$k=(Lb,$b,Oc,md,zd)=>{Lb=this.pa.uk();$b=this.zo.vy;if(!Lb||!$b||!$b.length)return 8;md=this.oka($b,Lb);if(!md||
!md.length)return bd.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),8;if(this.Bua(md))return 8;const le=!this.Gk.wzb($b);if(Yc.Xmg(md)&&le)return 8;if(1===Oc)return 32;(Oc=Math.floor(1E3*zd.Number))||(Oc=10);for(var df of $b)df.Duration=Oc;df=Yc.T8($b);df=Yc.WLc(df,1,Oc);this.k_(Lb,df);return 32};this.aKa=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;if(!this.pa.uk()||!Lb||!Lb.length)return this.MLb(zd,"0.00"),32;$b=Lb[0].Duration;Oc=!0;for(const le of Lb)if($b!=
le.Duration){Oc=!1;break}Oc?this.MLb(zd,Number($b/1E3).toFixed(2)):this.MLb(zd,"0.01");return 32};this.Dxj=(Lb,$b,Oc)=>1==Oc?32:Xc.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.Mea.toString(),Lb,()=>{(this.Mea=!this.Mea)?this.Frc(!1):this.Jcg();return 32});this.fnc=(Lb,$b,Oc,md,zd)=>{zd&&zd.Lf(this.Mea);return 32};this.Frc=Lb=>{const $b=this.yC();var Oc=Object(v.a)(this,this.zrj,"applyAnimationAction");$b.cPl=Oc;Oc=Object(v.a)(this,this.Brj,"handleAnimationSelectionChangeFromPane");
$b.mY=Oc;Oc=this.getSelectedShapes();$b.POl=!Oc||!Oc.length;if(Oc=this.pa.uk()){$b.UOl=!Oc.GEa;var md=Oc.gk();Oc=Oc.LRc(md);$b.hW=Oc.sort((le,df)=>le.EffectNodeId-df.EffectNodeId);$b.QPl=this.zo.vy.map(le=>le.EffectNodeId);var zd={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:$b.TCk,location:2,contentProps:$b,onOpen:()=>{},onClose:()=>{this.Mea=!1},isModernPane:!0};Ih.UISurfaces.zr().then(le=>{Lb?this.Mea&&le.updateTaskPane(jf.a.RPa,zd):le.showTaskPane(jf.a.RPa,zd);return null}).catch(le=>
{bd.a.J(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",le.toString())})}else bd.a.J(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.mY=()=>{if(this.zo&&this.zo.SQ){var Lb=this.zo.lz;Lb?(Lb=Lb.gk())&&Lb.length&&(this.zo.OIh(),this.Mea&&this.Frc(!0)):bd.a.J(509145116,800,10,"AnimationActor::onSelectionChange: current active slide is null")}};this.onActiveSlideDomReady=(Lb,$b)=>{$b&&this.zo&&((Lb=this.zo.lz)?($b=Object(B.a)(116,$b.Ba))&&Lb.Cb!==
$b.Cb&&(this.zo.eHl($b),this.Mea&&this.Frc(!0)):bd.a.J(509145115,800,10,"AnimationActor::onActiveSlideDomReady: current active slide is null"))};this.Cfa=(Lb,$b)=>{$b&&this.zo&&(this.zo.dHl($b.qfa),this.Mea&&(this.zo.SQ||this.Jcg()))};this.ph=(Lb,$b)=>{$b&&$b.property===ye.a.aRd&&this.zo&&this.zo.SQ&&((Lb=this.zo.lz,Lb)?this.ic.jg($b.node)===Lb&&(this.zo.cHl(),this.Mea&&this.Frc(!0)):bd.a.J(509145114,800,10,"AnimationActor::onPropertyChanged: current active slide is null"))};this.zrj=Lb=>{switch(Lb.actionType){case 0:this.mrj();
break;case 2:this.Twj(Lb);break;case 1:this.Psj(Lb);break;case 3:this.Fuj(Lb);break;case 4:this.ksj(Lb);break;case 5:break;case 6:this.Swj(Lb);break;default:bd.a.J(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};this.Brj=Lb=>{const $b=this.pa.uk();$b&&Lb&&Lb.length?this.zo.wPd(Lb,$b):bd.a.J(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.mrj=()=>{var Lb=this.getSelectedShapes();
const $b=this.pa.uk();$b&&Lb&&Lb.length?(Lb=Yc.c_f(Lb,10,0,!1))&&this.k_($b,Lb):bd.a.J(509642374,800,10,"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};this.Twj=Lb=>{if(Lb&&Lb.Fkh){var $b=Lb.Fkh.effectId,Oc=Lb.Fkh.effectType,md=this.zo.vy;(Lb=this.pa.uk())&&md&&md.length?($b=Yc.w6f(md,$b,Oc))&&this.k_(Lb,$b):bd.a.J(509642372,800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else bd.a.J(509642373,800,10,"AnimationActor::applyReplaceAnimation: replace animation info is null")};
this.Psj=Lb=>{if(Lb&&Lb.KLi){var $b=this.pa.uk();Lb=Lb.KLi.VNl;$b&&Lb&&Lb.length?(Lb=Yc.cnj(Lb),Lb=Yc.yKf(Lb),this.k_($b,Lb)):bd.a.J(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else bd.a.J(509616840,800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};this.yC=()=>({type:"AnimationPaneProps",TCk:Mh.a,SOl:!0});this.VDl=()=>{if(this.Mea)return this.Frc(!0),32};this.Jcg=()=>{Ih.UISurfaces.zr().then(Lb=>{Lb.hideTaskPane(jf.a.RPa,
2);return null}).catch(Lb=>{bd.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",Lb.toString())})};this.W$k=(Lb,$b,Oc,md,zd)=>{$b=this.zo.vy;Lb=this.pa.uk();if(!Lb||!$b||!$b.length)return 8;md=this.oka($b,Lb);if(!md||!md.length)return bd.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.Bua(md))return 8;const le=!this.Gk.wzb($b);if(Yc.Xmg(md)&&le)return 8;if(1===Oc)return 32;Oc=Math.floor(1E3*zd.Number);for(var df of $b)df.Delay=
Oc;df=Yc.T8($b);df=Yc.WLc(df,0,Oc);this.k_(Lb,df);return 32};this.$Ja=(Lb,$b,Oc,md,zd)=>{Lb=this.zo.vy;if(!this.pa.uk()||!Lb||!Lb.length)return this.MLb(zd,"0.00"),32;$b=Lb[0].Delay;Oc=!0;for(const le of Lb)if($b!=le.Delay){Oc=!1;break}Oc?this.MLb(zd,Number($b/1E3).toFixed(2)):this.MLb(zd,"0.00");return 32};this.Kki=(Lb,$b,Oc)=>{var md;const zd=new Le.a;zd.Id="AnimationMenuEffectOptions";zd.UpdateDynamically=!0;zd.Title=ResourceStrings.L_EffectOptions;zd.MenuSectionList=[];if(!this.Gk.S9b(Lb)){const le=
Lb[0];zd.MenuSectionList.push(this.Gk.sUc(le.EffectId,le.EffectType,"Direction","2289594085","3782857737"));if(this.Gk.fne(le))if(zd.MenuSectionList.push(Td.f($b.Jd,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),zd.MenuSectionList.push(Td.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.mKj(Lb)){const df=null===(md=le.EffectData)||void 0===md?void 0:md.Color;md=new qd.a(qd.a.Imh(df));
Td.h(zd,md,$b.Jd)}else Td.h(zd,null,$b.Jd);zd.MenuSectionList.push(this.Gk.sUc(le.EffectId,le.EffectType,"EffectData","2949363495","4132852551"))}zd.MenuSectionList.push(this.Gk.Ohj(Oc,this.Ea,Lb));return zd};this.$9i=Lb=>{let $b=new Hf;const Oc=this.Gk.n7d(Lb);return Lb.toLowerCase().startsWith("spin")?($b.Degree=parseFloat(Oc),$b.EffectDataPropType=0,$b):Lb.toLowerCase().startsWith("transparency")?($b.Transparency=parseFloat(Oc),$b.EffectDataPropType=2,$b):Lb.toLowerCase().startsWith("growshrink")?
($b.Scale=parseFloat(Oc),$b.EffectDataPropType=3,$b):null};this.qNk=(Lb,$b,Oc,md,zd,le,df,bf)=>{if(zd)return!1;if(Oc)return this.o9a(Lb,le,ResourceStrings.L_AnimationMultiple,$b,ResourceStrings.L_AnimationMultiple),md;md&&(le=this.Gk.QUc(df,bf),{image:le,label:Oc}=this.Gk.QSc(le),this.o9a(Lb,le,Oc,$b,Oc));return md};this.o9a=(Lb,$b,Oc,md,zd)=>{let le;le=Lb===this.q6?"298832323":Lb===this.vLa?"1264919631":"2676673376";$b=$b.substring((Ge.a.Ulc+"_").length,$b.length-6);const df=new Cd.a;df.Id=Lb;df.ExternalId=
"Animation"+Lb;df.Icon=$b;df.Command=le;df.QueryCommand="1852964326";df.LabelText=Oc;df.FullIconStyle={root:{width:"32px",height:"32px"}};df.PreviewIconStyle={root:{width:"24px",height:"24px"}};df.Alt=zd;md.E3=df};this.getSelectedShapes=()=>{let Lb=[];const $b=this.pa.Xd();if(!$b)return Lb;for(const Oc of $b)Oc.get_smartArtModelId()?Lb.push(this.Ea.yr(Oc)):Oc.Og?Lb.push(this.Ea.ys(Oc)):Lb.push(Oc);return Lb};this.oka=(Lb,$b)=>{const Oc=[];if(!Lb||!Lb.length||!$b)return Oc;const md=$b.gk();if(!md||
!md.length)return Oc;$b=new Map;for(const zd of md)$b.set(zd.id.toString(),zd);for(const zd of Lb){Lb=Jc.a.Gf(zd.ShapeId);Lb=$b.get(Lb.toString());if(!Lb)return[];Oc.push(Lb)}return Oc};this.k_=(Lb,$b)=>{const Oc=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{Oc.nc(Lb),Lb.Era=$b}finally{Oc&&Oc.dispose()}};this.Bua=Lb=>{if(!Lb||0==Lb.length)return!1;for(const $b of Lb)if(this.fc.$c($b))return!0;return!1};this.MLb=(Lb,$b)=>{Lb.queryResult.Kaa=$b};if(!z)throw Error.argumentNull("actionManager");
if(!Y)throw Error.argumentNull("selectionManager");if(!m)throw Error.argumentNull("focusManager");if(!I)throw Error.argumentNull("transactionFactory");if(!X)throw Error.argumentNull("animationHelper");if(!ta)throw Error.argumentNull("graphActionBlockingManager");if(!Fa)throw Error.argumentNull("shapeReader");if(!bb)throw Error.argumentNull("pathManager");if(!yb)throw Error.argumentNull("effectSelectionManager");if(!pb)throw Error.argumentNull("viewElementEventHandler");if(!Ob)throw Error.argumentNull("graphNodeEventHandlers");
if(!sc)throw Error.argumentNull("viewEventNotifier");if(!wc)throw Error.argumentNull("slideReader");this.ia=z;this.pa=Y;this.Fa=m;this.Jb=I;this.Agc=bb.rk(Ge.a.fid);this.Gk=X;this.fc=ta;this.Ea=Fa;this.zo=yb;this.la=Bb;this.yt=pb;this.Gv=Ob;this.je=sc;this.ic=wc}wb(){this.ia.ra(Bc.a.FHc,Lc.a.application,this.Y$k,4);this.ia.ra(Bc.a.jJb,Lc.a.application,this.jJb,97);this.ia.ra(Bc.a.Tod,Lc.a.application,this.X$k,4);this.ia.ra(Bc.a.aKa,Lc.a.application,this.aKa,97);this.ia.ra(Bc.a.Awh,Lc.a.application,
this.Dxj,4);this.ia.ra(Bc.a.fnc,Lc.a.application,this.fnc,96);this.ia.ra(Bc.a.Sod,Lc.a.application,this.W$k,4);this.ia.ra(Bc.a.$Ja,Lc.a.application,this.$Ja,97);this.ia.ra(Bc.a.$na,Lc.a.application,this.$na,97);this.ia.ra(Bc.a.Fz,Lc.a.application,this.Fz,5);this.ia.ra(Bc.a.KLb,Lc.a.application,this.Fz,5);this.ia.ra(Bc.a.LLb,Lc.a.application,this.Fz,5);this.ia.ra(Bc.a.b0a,Lc.a.application,this.Fz,5);this.ia.ra(Bc.a.WNe,Lc.a.application,this.VNe,100);this.ia.ra(Bc.a.$_a,Lc.a.application,this.$_a,5);
this.ia.ra(Bc.a.NZa,Lc.a.application,this.NZa,97);this.ia.ra(Bc.a.a0a,Lc.a.application,this.a0a,4);this.ia.ra(Bc.a.OZa,Lc.a.application,this.OZa,96);this.ia.ra(Bc.a.Uod,Lc.a.application,this.TKa,5);this.ia.ra(Bc.a.Vod,Lc.a.application,this.TKa,5);this.ia.ra(Bc.a.Wod,Lc.a.application,this.TKa,5);this.ia.ra(Bc.a.Xod,Lc.a.application,this.TKa,5);this.ia.ra(Bc.a.aoa,Lc.a.application,this.aoa,97);this.ia.ra(Bc.a.Ghb,Lc.a.application,this.Ghb,96);this.ia.ra(Bc.a.uya,Lc.a.application,this.uya,4);this.ia.ra(Bc.a.gFe,
Lc.a.application,this.x_g,4);this.ia.ra(Bc.a.hFe,Lc.a.application,this.x_g,4);this.ia.ra(Bc.a.Y4e,Lc.a.application,this.VDl,4);this.la.eB&&Wd.a("AnimationGalleryActionAIEnabled")&&this.ia.ra(Bc.a.$Qd,Lc.a.application,Object(v.a)(this,this.Dbe,"handleAnimationGalleryActionAI"),4);this.pa.KG(this.mY);this.yt.pQd(this.mY);this.yt.eW(this.onActiveSlideDomReady);this.Gv.kk(this.ph);this.je.m6a(this.Cfa)}Ee(){}Dbe(z,Y){if(Y.contextId!==Lc.a.application)return 2;z=this.getSelectedShapes();return!Yc.Ymg(this.pa.uk(),
z)||this.Bua(z)?8:32}ksj(z){if(z&&z.zri){var Y=this.zo.vy,m=this.pa.uk();m&&Y&&Y.length?(z=z.zri,Y=Yc.T8(Y),Y=Yc.nKf(Y,z.hQl),this.k_(m,Y)):bd.a.J(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else bd.a.J(509444174,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}Fuj(z){if(z&&z.$nk){var Y=this.zo.vy,m=this.pa.uk();m&&Y&&Y.length?(Y=Yc.T8(Y),(z=Yc.Y6i(z.$nk,Y))?this.k_(m,z):bd.a.J(509444170,
800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed")):bd.a.J(509444171,800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else bd.a.J(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}Swj(z){var Y=z.soa;if(z&&Y){var m=this.zo.vy,I=z.soa.vPl;if((z=this.pa.uk())&&m&&m.length&&I){var X=new lf;X.EffectNodeId=I.tRi;X.ShapeId=I.shapeId;m=Yc.T8(m);Y=Yc.DLf(m,X,Y.ROl);this.k_(z,Y)}else bd.a.J(509444168,
800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else bd.a.J(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static Y6i(z,Y){switch(z.ZOl){case 0:return Yc.WLc(Y,0,z.delay);case 1:return Yc.WLc(Y,1,z.duration);default:return null}}mKj(z){var Y;if(!(z&&z.length&&!this.Gk.S9b(z)&&this.Gk.fne(z[0])&&z[0].EffectData&&z[0].EffectData.Color))return!1;const m=null===(Y=z[0].EffectData)||void 0===Y?void 0:Y.Color;for(const I of z){if(!I.EffectData||
!I.EffectData.Color)return!1;z=I.EffectData.Color;if(z[0]!=m[0]||z[1]!=m[1]||z[2]!=m[2])return!1}return!0}static nKf(z,Y){const m=new Me.a;m.AnimationAction=4;const I=new ac;I.TargetEffects=z;I.StartType=Y;m.ChangeAnimationRelationshipInfo=I;return m}static WLc(z,Y,m){const I=new Me.a;I.AnimationAction=1;const X=new Qb;X.TargetEffects=z;X.ModifyAnimPropType=Y;1===Y?X.Duration=m:X.Delay=m;I.ModifyAnimationInfo=X;return I}static DLf(z,Y,m){const I=new Me.a;I.AnimationAction=6;const X=new ze;X.TargetEffects=
z;X.IsLater=m;X.RefEffect=Y;I.ReorderAnimationEffectsInfo=X;return I}static BVe(z,Y){let m="";switch(Y){case 0:m=ResourceStrings.l_AnimationStartOptionOnClick;break;case 1:m=ResourceStrings.l_AnimationStartOptionWithPrevious;break;case 2:m=ResourceStrings.l_AnimationStartOptionAfterPrevious}z.$Z=m;z.mqc()}}Yc.cnj=z=>{const Y=[];if(!z||!z.length)return Y;for(const m of z)z=new lf,z.EffectNodeId=m.tRi,z.ShapeId=m.shapeId,Y.push(z);return Y};Yc.z5i=z=>{switch(z){case "AsOneObject":return 1;case "AllAtOnce":return 2;
case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}};Yc.B4i=(z,Y,m,I,X)=>0==Y&&0==m?Yc.g9i(X):I?Yc.c_f(z,Y,m,!0):Yc.w6f(X,Y,m);Yc.w6f=(z,Y,m)=>{let I=new Me.a;I.AnimationAction=2;let X=new fb;if(!z||!z.length)return bd.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;X.TargetEffects=Yc.T8(z);X.EffectId=Y;X.EffectType=m;I.ReplaceAnimationInfo=X;return I};Yc.g9i=z=>z&&z.length?Yc.yKf(Yc.T8(z)):(bd.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),
null);Yc.c_f=(z,Y,m,I)=>{let X=new Me.a;X.AnimationAction=0;let ta=new Tf;ta.EffectId=Y;ta.EffectType=m;ta.ShapeIds=[];ta.FRemoveExisting=I;for(const Fa of z)ta.ShapeIds.push(Fa.id.toString());X.AddAnimationInfo=ta;return X};Yc.yKf=z=>{const Y=new Me.a;Y.AnimationAction=3;const m=new Sd;m.TargetEffects=z;Y.DeleteAnimationInfo=m;return Y};Yc.Mlj=z=>{switch(z.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};Yc.T8=z=>{if(!z||!z.length)return null;
const Y=[];for(const m of z)z=new lf,z.EffectNodeId=m.EffectNodeId,z.ShapeId=m.ShapeId,Y.push(z);return Y};Yc.nVj=z=>{if(!z||0==z.length)return!1;for(const Y of z)if(Y.a4)return!0;return!1};Yc.Xmg=z=>{if(!z||0==z.length)return!1;for(const Y of z)if(1===Y.mediaType||2===Y.mediaType)return!0;return!1};Yc.Ymg=(z,Y)=>{if(!z||!Y||!Y.length)return!1;for(const m of Y)if(m.wT||m.Dq||m.Op)return!1;return!0};Yc.oVj=z=>{if(!z||!z.length)return!1;for(const Y of z)if(Y.ud||Y.hr||Y.Op)return!1;return!0};Yc.nKj=
z=>{if(!z||!z.length)return!1;const Y=z[0].Direction;for(let m=1;m<z.length;m++)if(z[m].Direction!=Y)return!1;return!0};Yc.lKj=z=>{if(!z||!z.length)return!1;const Y=z[0].BuildType;for(let m=1;m<z.length;m++)if(z[m].BuildType!=Y)return!1;return!0};Yc.a$i=z=>{if(!z)return"";switch(z.EffectDataPropType){case 0:return z.Degree.toString();case 3:return z.Scale.toString();case 2:return z.Transparency.toString()}return""};Yc.oNk=(z,Y,m,I)=>{m?(z.m9a=ResourceStrings.L_AnimationExisting,I&&(I=!1)):Y&&(z.m9a=
ResourceStrings.L_AnimationMultiple);return I};Object(h.a)(Yc,"AnimationActor",null,[365]);class Ae{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(h.a)(Ae,"EditAnimationInfo",
null,[]);var hd;(function(z){z[z.invalid=0]="invalid";z[z.basicBlockList=1]="basicBlockList";z[z.alternatingHexagons=2]="alternatingHexagons";z[z.pictureCaptionList=3]="pictureCaptionList";z[z.linedList=4]="linedList";z[z.verticalBulletList=5]="verticalBulletList";z[z.verticalBoxList=6]="verticalBoxList";z[z.verticalBracketList=7]="verticalBracketList";z[z.varyingWidthList=8]="varyingWidthList";z[z.tabList=9]="tabList";z[z.horizontalBulletList=10]="horizontalBulletList";z[z.squareAccentList=11]="squareAccentList";
z[z.pictureAccentList=12]="pictureAccentList";z[z.bendingPictureAccentList=13]="bendingPictureAccentList";z[z.stackedList=14]="stackedList";z[z.increasingCircleProcess=15]="increasingCircleProcess";z[z.pieProcess=16]="pieProcess";z[z.detailedProcess=17]="detailedProcess";z[z.groupedList=18]="groupedList";z[z.horizontalPictureList=19]="horizontalPictureList";z[z.continuousPictureList=20]="continuousPictureList";z[z.pictureStrips=21]="pictureStrips";z[z.verticalPictureList=22]="verticalPictureList";
z[z.alternatingPictureBlocks=23]="alternatingPictureBlocks";z[z.verticalPictureAccentList=24]="verticalPictureAccentList";z[z.titledPictureAccentList=25]="titledPictureAccentList";z[z.verticalBlockList=26]="verticalBlockList";z[z.verticalChevronList=27]="verticalChevronList";z[z.verticalAccentList=28]="verticalAccentList";z[z.verticalArrowList=29]="verticalArrowList";z[z.trapezoidList=30]="trapezoidList";z[z.descendingBlockList=31]="descendingBlockList";z[z.tableList=32]="tableList";z[z.segmentedProcess=
33]="segmentedProcess";z[z.verticalCurvedList=34]="verticalCurvedList";z[z.pyramidList=35]="pyramidList";z[z.targetList=36]="targetList";z[z.hierarchyList=37]="hierarchyList";z[z.verticalCircleList=38]="verticalCircleList";z[z.tableHierarchy=39]="tableHierarchy";z[z.architectureLayout=40]="architectureLayout";z[z.basicProcess=41]="basicProcess";z[z.stepUpProcess=42]="stepUpProcess";z[z.stepDownProcess=43]="stepDownProcess";z[z.accentProcess=44]="accentProcess";z[z.pictureAccentProcess=45]="pictureAccentProcess";
z[z.alternatingFlow=46]="alternatingFlow";z[z.continuousBlockProcess=47]="continuousBlockProcess";z[z.increasingArrowsProcess=48]="increasingArrowsProcess";z[z.interconnectedBlockProcess=49]="interconnectedBlockProcess";z[z.continuousArrowProcess=50]="continuousArrowProcess";z[z.convergingText=51]="convergingText";z[z.processArrows=52]="processArrows";z[z.circleAccentTimeline=53]="circleAccentTimeline";z[z.basicTimeline=54]="basicTimeline";z[z.circleProcess=55]="circleProcess";z[z.basicChevronProcess=
56]="basicChevronProcess";z[z.chevronAccentProcess=57]="chevronAccentProcess";z[z.closedChevronProcess=58]="closedChevronProcess";z[z.chevronList=59]="chevronList";z[z.subStepProcess=60]="subStepProcess";z[z.phasedProcess=61]="phasedProcess";z[z.randomtoResultProcess=62]="randomtoResultProcess";z[z.verticalProcess=63]="verticalProcess";z[z.staggeredProcess=64]="staggeredProcess";z[z.processList=65]="processList";z[z.circleArrowProcess=66]="circleArrowProcess";z[z.basicBendingProcess=67]="basicBendingProcess";
z[z.repeatingBendingProcess=68]="repeatingBendingProcess";z[z.verticalBendingProcess=69]="verticalBendingProcess";z[z.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";z[z.upwardArrow=71]="upwardArrow";z[z.descendingProcess=72]="descendingProcess";z[z.circularBendingProcess=73]="circularBendingProcess";z[z.equation=74]="equation";z[z.verticalEquation=75]="verticalEquation";z[z.funnel=76]="funnel";z[z.gear=77]="gear";z[z.arrowRibbon=78]="arrowRibbon";z[z.opposingArrows=79]="opposingArrows";
z[z.convergingArrows=80]="convergingArrows";z[z.divergingArrows=81]="divergingArrows";z[z.basicCycle=82]="basicCycle";z[z.textCycle=83]="textCycle";z[z.blockCycle=84]="blockCycle";z[z.nondirectionalCycle=85]="nondirectionalCycle";z[z.continuousCycle=86]="continuousCycle";z[z.multidirectionalCycle=87]="multidirectionalCycle";z[z.segmentedCycle=88]="segmentedCycle";z[z.basicPie=89]="basicPie";z[z.hexagonRadial=90]="hexagonRadial";z[z.radialCycle=91]="radialCycle";z[z.basicRadial=92]="basicRadial";z[z.divergingRadial=
93]="divergingRadial";z[z.radialVenn=94]="radialVenn";z[z.cycleMatrix=95]="cycleMatrix";z[z.radialCluster=96]="radialCluster";z[z.organizationChart=97]="organizationChart";z[z.pictureOrganizationChart=98]="pictureOrganizationChart";z[z.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";z[z.halfCircleOrganizationChart=100]="halfCircleOrganizationChart";z[z.circlePictureHierarchy=101]="circlePictureHierarchy";z[z.hierarchy=102]="hierarchy";z[z.labeledHierarchy=103]="labeledHierarchy";
z[z.horizontalOrganizationChart=104]="horizontalOrganizationChart";z[z.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";z[z.horizontalHierarchy=106]="horizontalHierarchy";z[z.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";z[z.balance=108]="balance";z[z.circleRelationship=109]="circleRelationship";z[z.hexagonCluster=110]="hexagonCluster";z[z.opposingIdeas=111]="opposingIdeas";z[z.plusandMinus=112]="plusandMinus";z[z.reverseList=113]="reverseList";z[z.counterbalanceArrows=
114]="counterbalanceArrows";z[z.segmentedPyramid=115]="segmentedPyramid";z[z.nestedTarget=116]="nestedTarget";z[z.convergingRadial=117]="convergingRadial";z[z.radialList=118]="radialList";z[z.tabbedArc=119]="tabbedArc";z[z.basicTarget=120]="basicTarget";z[z.basicVenn=121]="basicVenn";z[z.linearVenn=122]="linearVenn";z[z.stackedVenn=123]="stackedVenn";z[z.interconnectedRings=124]="interconnectedRings";z[z.basicMatrix=125]="basicMatrix";z[z.titledMatrix=126]="titledMatrix";z[z.gridMatrix=127]="gridMatrix";
z[z.basicPyramid=128]="basicPyramid";z[z.invertedPyramid=129]="invertedPyramid";z[z.accentedPicture=130]="accentedPicture";z[z.circularPictureCallout=131]="circularPictureCallout";z[z.radialPictureList=132]="radialPictureList";z[z.snapshotPictureList=133]="snapshotPictureList";z[z.spiralPicture=134]="spiralPicture";z[z.captionedPictures=135]="captionedPictures";z[z.bendingPictureCaption=136]="bendingPictureCaption";z[z.pictureFrame=137]="pictureFrame";z[z.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";
z[z.bendingPictureBlocks=139]="bendingPictureBlocks";z[z.bendingPictureCaptionList=140]="bendingPictureCaptionList";z[z.titledPictureBlocks=141]="titledPictureBlocks";z[z.pictureGrid=142]="pictureGrid";z[z.pictureAccentBlocks=143]="pictureAccentBlocks";z[z.themePictureAccent=144]="themePictureAccent";z[z.themePictureGrid=145]="themePictureGrid";z[z.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";z[z.alternatingPictureCircles=147]="alternatingPictureCircles";z[z.titlePictureLineup=
148]="titlePictureLineup";z[z.pictureLineup=149]="pictureLineup";z[z.framedTextPicture=150]="framedTextPicture";z[z.bubblePictureList=151]="bubblePictureList";z[z.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";z[z.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";z[z.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";z[z.accentHomeChevronProcess=155]="accentHomeChevronProcess";z[z.basicProcessNew=156]="basicProcessNew";z[z.basicTimelineNew=157]="basicTimelineNew";
z[z.chevronBlockProcess=158]="chevronBlockProcess";z[z.hexagonTimeline=159]="hexagonTimeline";z[z.horizontalActionList=160]="horizontalActionList";z[z.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";z[z.roundedRectangleTimeline=162]="roundedRectangleTimeline";z[z.verticalDownArrowProcess=163]="verticalDownArrowProcess";z[z.verticalHollowActionList=164]="verticalHollowActionList";z[z.verticalSolidActionList=165]="verticalSolidActionList";z[z.dropPinTimeline=166]="dropPinTimeline";z[z.horizontalLabelsTimeline=
167]="horizontalLabelsTimeline";z[z.horizontalPathTimeline=168]="horizontalPathTimeline";z[z.iconLabelList=169]="iconLabelList";z[z.iconCircleList=170]="iconCircleList";z[z.iconLabelDescriptionList=171]="iconLabelDescriptionList";z[z.iconVerticalSolidList=172]="iconVerticalSolidList";z[z.iconCircleLabelList=173]="iconCircleLabelList";z[z.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";z[z.iconLeafLabelList=175]="iconLeafLabelList";z[z.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";
z[z.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(hd||(hd={}));Object(h.b)("SmartArtLayout",hd);var oe;(function(z){z[z.title=0]="title";z[z.body=1]="body";z[z.centerTitle=2]="centerTitle";z[z.subTitle=3]="subTitle";z[z.slideNum=5]="slideNum";z[z.footer=6]="footer";z[z.object=8]="object";z[z.graph=9]="graph";z[z.table=10]="table";z[z.clipArt=11]="clipArt";z[z.orgChart=12]="orgChart";z[z.media=13]="media";z[z.picture=15]="picture"})(oe||(oe={}));Object(h.b)("PlaceholderType",
oe);class Xe{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb){this.q6="Existing";this.vLa="ExistingInMenu";this.w_e="AnimationExisting";this.x_e="AnimationExistingInMenu";this.ia=z;this.kq=Y;this.pa=m;this.Agc=Bb.rk(Ge.a.fid);this.Jb=X;this.Fa=I;this.Gk=ta;this.fc=Fa;this.Mak=bb.pptAnimationMarkersEnabled;this.Ea=yb;this.la=bb;this.Xxe=Wd.a("SetAnimationTelemetryCustomDataEnabled")}wb(){this.ia.ra(Bc.a.$na,Lc.a.application,Object(v.a)(this,this.$na,"queryAnimationGallery"),97);this.ia.ra(Bc.a.uOe,Lc.a.application,
Object(v.a)(this,this.uOe,"queryMoreAnimationGallery"),96);this.ia.ra(Bc.a.Fz,Lc.a.application,Object(v.a)(this,this.Fz,"setAnimation"),5|(this.Xxe?8:0));this.ia.ra(Bc.a.KLb,Lc.a.application,Object(v.a)(this,this.Fz,"setAnimation"),5|(this.Xxe?8:0));this.ia.ra(Bc.a.LLb,Lc.a.application,Object(v.a)(this,this.Fz,"setAnimation"),5);this.ia.ra(Bc.a.b0a,Lc.a.application,Object(v.a)(this,this.Fz,"setAnimation"),5);this.ia.ra(Bc.a.WNe,Lc.a.application,Object(v.a)(this,this.VNe,"queryEffectOptions"),100);
this.ia.ra(Bc.a.$_a,Lc.a.application,Object(v.a)(this,this.$_a,"setAnimationDirection"),5);this.ia.ra(Bc.a.NZa,Lc.a.application,Object(v.a)(this,this.NZa,"queryAnimationDirection"),97);this.ia.ra(Bc.a.a0a,Lc.a.application,Object(v.a)(this,this.a0a,"setAnimationEffectData"),4);this.ia.ra(Bc.a.OZa,Lc.a.application,Object(v.a)(this,this.OZa,"queryAnimationEffectData"),96);this.ia.ra(Bc.a.Uod,Lc.a.application,Object(v.a)(this,this.TKa,"setAnimationSequence"),5);this.ia.ra(Bc.a.Vod,Lc.a.application,Object(v.a)(this,
this.TKa,"setAnimationSequence"),5);this.ia.ra(Bc.a.Wod,Lc.a.application,Object(v.a)(this,this.TKa,"setAnimationSequence"),5);this.ia.ra(Bc.a.Xod,Lc.a.application,Object(v.a)(this,this.TKa,"setAnimationSequence"),5);this.ia.ra(Bc.a.aoa,Lc.a.application,Object(v.a)(this,this.aoa,"queryAnimationSequence"),97);this.ia.ra(Bc.a.kSe,Lc.a.application,Object(v.a)(this,this.saa,"reorderAnimation"),4);this.ia.ra(Bc.a.lSe,Lc.a.application,Object(v.a)(this,this.saa,"reorderAnimation"),4);this.ia.ra(Bc.a.Ghb,
Lc.a.application,Object(v.a)(this,this.Ghb,"populateAnimationEffectOptions"),96);this.ia.ra(Bc.a.uya,Lc.a.application,Object(v.a)(this,this.uya,"setAnimationColor"),4);this.la.eB&&Wd.a("AnimationGalleryActionAIEnabled")&&this.ia.ra(Bc.a.$Qd,Lc.a.application,Object(v.a)(this,this.Dbe,"handleAnimationGalleryActionAI"),4)}Ee(){}Ghb(z,Y,m,I,X){z=this.vQ();Y=this.pa.uk();if(!Y||!z)return 8;if(1===m)return 32;m=Xe.R3(Y,z);if(!m||0===m.EffectId)return 16;X.MenuItems=this.Jki(m,Y,z);return 32}$na(z,Y,m,I,
X){z=X.queryResult;X=X.SourceControlId;var ta=I=-1;X!==this.q6&&({effectType:ta,effectId:I}=this.Gk.PSc(X));Y=this.vQ();var Fa=this.pa.uk();if(!Fa||!Y)return 8;if(1!==m)return 32;({image:m,label:Bb}=this.Gk.QSc(X));var bb=Bb;if(X===this.q6||X===this.vLa)bb=ResourceStrings.L_ExistingButtonDescription;this.o9a(X,m,Bb,z,bb);var yb=Xe.R3(Fa,Y);var Bb=yb?yb.EffectId:0;bb=yb?yb.EffectType:0;const pb=!this.Gk.Kab(yb,Y);yb=this.Gk.jle(yb,Y);this.Mak&&(Fa=Fa?Fa.lTa(Y):null,yb=yb&&!this.Gk.ZUj(Fa));I=!pb&&
!yb&&I===Bb&&ta===bb;ta=pb?!1:this.Gk.BZc(bb,Bb);X===this.q6||X===this.vLa?(ta=X===this.q6?this.rNk(this.q6,z,yb,ta,m,bb,Bb):Xe.pNk(z,yb,ta),z.ZU(pb||yb||ta)):Y&&z.ZU(I);return 32}Dbe(z,Y){if(Y.contextId!==Lc.a.application)return 2;z=this.vQ();return!this.pa.uk()||!z||z.wT||z.Dq||z.Op?8:this.fc.$c(z)?16:32}rNk(z,Y,m,I,X,ta,Fa){m?this.o9a(z,X,ResourceStrings.L_AnimationMultiple,Y,ResourceStrings.L_AnimationMultiple):I&&(X=this.Gk.QUc(ta,Fa),{image:X,label:m}=this.Gk.QSc(X),this.o9a(z,X,m,Y,m));return I}o9a(z,
Y,m,I,X){let ta;ta=z===this.q6?"298832323":z===this.vLa?"1264919631":"2676673376";Y=Y.substring((Ge.a.Ulc+"_").length,Y.length-6);z=Object.assign(new Cd.a,{Id:z,ExternalId:"Animation"+z,Icon:Y,Command:ta,QueryCommand:"1852964326",LabelText:m,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:X});I.E3=z}uOe(z,Y){if(Y.contextId!==Lc.a.application)return 2;z=this.vQ();return!this.pa.uk()||!z||z.wT||z.Dq||z.Op?8:this.fc.$c(z)?16:32}Fz(z,Y,m,I,X){Y=
this.vQ();var ta=this.pa.uk();if(!ta||!Y||Y.wT||Y.Dq||Y.Op)return 8;if(this.fc.$c(Y))return 16;var Fa=Xe.R3(ta,Y),bb=Fa?Fa.EffectId:-1,yb=Fa?Fa.EffectType:-1;if(1===m)return z===Bc.a.LLb||z===Bc.a.b0a?(I=this.Gk.BZc(yb,bb),ta=!!Fa&&!this.Gk.Kab(Fa,Y),z===Bc.a.b0a&&(I=ta?!0:!1),Y=!!Fa&&this.Gk.jle(Fa,Y),Y=ta||Y,I||Y?32:16):z===Bc.a.KLb?Y.ud||Y.hr||Y.Op?16:32:32;z=X.SourceControlId;if(!z)return 8;if(z===this.q6||z===this.vLa||z===this.w_e||z===this.x_e)return 32;({effectType:X,effectId:m}=this.Gk.PSc(z));
bb=this.Gk.T8i(z);yb=this.Gk.Q8i(z);I&&this.Xxe&&(I.CN=m,I.o3=X);Fa=Y.yab()?Xe.A6b(ta,Y):Fa;Fa||(Fa=new Ae,Fa.Id=Y.id.toString(),Fa.BuildIds=[ta.g3b+1],Fa.HasTrigger=!1,Fa.BuildId=ta.g3b+1,Fa.SequenceIndex=0,Fa.IsTextRangeType=!1);Fa.HasExisting=!1;Fa.HasMultiple=!1;Fa.EffectType=X;Fa.SequenceId=1;Fa.EffectId=m;Fa.Direction=bb;Fa.EffectData=yb;Fa.IsTrigger=!1;this.X3b(ta,Y,Fa);e.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",z,ta.Cb.sid,
Y.id);this.A5j(ta);return 32}uya(z,Y,m,I,X){Y=this.kq.presentation;if(!Y)throw Error.argumentNull("Presentation is null");z=this.vQ();if(!z)return 8;Y=Object(B.a)(116,Y.AC(z.slideId));if(!Y)return 8;I=Xe.R3(Y,z);if(!(I&&X&&Y&&z))return 8;if(this.fc.$c(z))return 16;if(1===m)return 32;m=pd.Box4ColorHelper.YR(X);m=pd.Box4ColorHelper.gjb(m,Y.Jd);if(!m)return 8;I.EffectData=String.format("{0},{1},{2}",m.r.toString(16),m.g.toString(16),m.b.toString(16));this.X3b(Y,z,I);return 32}VNe(){const z=this.vQ();
var Y=this.pa.uk();return Y&&z?this.fc.$c(z)?16:(Y=Xe.R3(Y,z))&&this.Gk.dqi(z,this.Ea,Y)?32:16:8}saa(z,Y,m){Y=this.vQ();const I=this.pa.uk();if(!I||!Y)return 8;if(this.fc.$c(Y))return 16;const X=Xe.A6b(I,Y);let ta;switch(z){case Bc.a.kSe:ta=!1;break;case Bc.a.lSe:ta=!0;break;default:return 8}let Fa=!1;if(Y&&(Fa=!!X&&!X.HasTrigger&&1===X.BuildIds.length)){let bb=!1,yb=!1;({D_b:bb,F_b:yb}=Xe.iqi(I,X));Fa=ta?yb&&Fa:bb&&Fa}if(1===m)return Fa?32:8;if(Fa){m=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});
try{m.nc(I),m.jd=z,I.saa(Y,ta)}finally{m&&m.dispose()}}return 32}$_a(z,Y,m,I,X){z=this.vQ();Y=this.pa.uk();if(!Y||!z)return 8;if(1===m)return 32;if(this.fc.$c(z))return 16;m=Xe.A6b(Y,z);if(!m)return 8;X=X.MenuItemId;m.Direction=this.Gk.I5b(X);this.X3b(Y,z,m);e.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.Gk.QUc(m.EffectType,m.EffectId),X,Y.sid,z.id);return 32}NZa(z,Y,m,I,X){Y=this.vQ();I=this.pa.uk();
if(!I||!Y)return 8;z=X.queryResult;X=this.Gk.I5b(X.MenuItemId);Y=Xe.R3(I,Y);1===m&&Y&&z.Lf(Y.Direction===X);return 32}TKa(z,Y,m,I,X){z=X.MenuItemId;Y=this.vQ();I=this.pa.uk();if(!I||!Y)return 8;if(1===m)return 32;if(this.fc.$c(Y))return 16;m=Xe.A6b(I,Y);if(!m)return 8;m.SequenceId=this.Gk.w$d(z);this.X3b(I,Y,m);return 32}aoa(z,Y,m,I,X){z=this.vQ();Y=this.pa.uk();if(!Y||!z)return 8;z=Xe.R3(Y,z);Y=X.queryResult;X=this.Gk.w$d(X.MenuItemId);1===m&&z&&Y.Lf(z.SequenceId===X);return 32}a0a(z,Y,m,I,X){z=
this.vQ();Y=this.pa.uk();if(!Y||!z)return 8;if(1===m)return 32;if(this.fc.$c(z))return 16;m=Xe.A6b(Y,z);if(!m)return 8;if(!X)return 2;m.EffectData=this.Gk.n7d(X.MenuItemId);this.X3b(Y,z,m);return 32}OZa(z,Y,m,I,X){z=this.vQ();Y=this.pa.uk();if(!Y||!z)return 8;z=Xe.R3(Y,z);1===m&&z&&X.queryResult.Lf(this.Gk.bIf(z.EffectData,X.MenuItemId));return 32}X3b(z,Y,m){const I=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{I.nc(z),z.Iqc(Y,m)}finally{I&&I.dispose()}}Jki(z,Y,m){const I=Object.assign(new Le.a,
{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});Array.add(I.MenuSectionList,this.Gk.sUc(z.EffectId,z.EffectType,"Direction","2289594085","3782857737"));this.Gk.Whg(z)&&(Array.add(I.MenuSectionList,Td.f(Y.Jd,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(I.MenuSectionList,Td.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker",
"679168237",!1)));Array.add(I.MenuSectionList,this.Gk.sUc(z.EffectId,z.EffectType,"EffectData","2949363495","4132852551"));Array.add(I.MenuSectionList,this.Gk.Nhj(m,this.Ea,z));return I}A5j(z){if(z){var Y=z.gk(),m=String.format("{0}#{1}",z.sid,z.cid);if(Y&&0<Y.length)for(const I of Y)if(Y=z.sEa(I)){const X=Y.EffectId,ta=Y.EffectType,Fa=Y.Direction,bb=this.Gk.QUc(ta,X),yb=this.Ea.d3f(I),Bb=Xe.wkj(I,yb);e.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",
bb,X,ta,Fa,I.xC().length,yb,Bb,Y.SequenceId,m,I.id)}}}vQ(){const z=this.pa.kp();return z?z.get_smartArtModelId()?this.Ea.yr(z):z.Og?this.Ea.ys(z):z:null}static pNk(z,Y,m){Y?z.m9a=ResourceStrings.L_AnimationMultiple:(z.m9a=ResourceStrings.L_AnimationExisting,m&&(m=!1));return m}static iqi(z,Y){let m,I;if(!Y)return{D_b:!1,F_b:!1};const X=z.q1d,ta=z.g3b,Fa=Y.BuildIds[0];I=m=!0;0===Y.StartType?m=Fa>X?!0:!1:I=Fa<ta?!0:!1;if(Fa===X||Fa===ta){if(!Fa)return{D_b:!1,F_b:I};for(const bb of z.jQ)if(bb.Id!==Y.Id)for(const yb of bb.BuildIds)if(0===
Y.StartType){if(yb>=Fa)return I=!0,{D_b:m,F_b:I}}else if(yb===Fa)return m=!0,{D_b:m,F_b:I};0===Y.StartType?I=!1:m=!1}return{D_b:m,F_b:I}}static R3(z,Y){return z&&Y?z.R3(Y):null}static A6b(z,Y){return z&&Y?z.sEa(Y):null}static wkj(z,Y){return 24===Y?hd[z.smartArtInfo.SmartArtLayout]:1===Y?z.shapeType.toString():14===Y?oe[z.Jj]:"Unknown"}}Object(h.a)(Xe,"AnimationActorLegacy",null,[365]);class Ke{constructor(z,Y,m,I){this.Af=null;this.Ca=z;this.Cnb=Y;this.tTh=m;this.kJd=I;this.kJd.init();this.Cnb.init()}wb(){this.Ca.ra(he.a.MHb,
Lc.a.application,Object(v.a)(this,this.MHb,"openGrammarSettings"),1028);this.Ca.ya(he.a.u7b,jc.a.frame,Object(v.a)(this,this.q$f,"grammarDialogTabFocusHandler"));this.Ca.ya(he.a.t7b,jc.a.frame,Object(v.a)(this,this.q$f,"grammarDialogTabFocusHandler"));this.Ca.ya(he.a.GVc,jc.a.frame,Object(v.a)(this,this.p$f,"grammarDialogOptionFocusHandler"));this.Ca.ya(he.a.FVc,jc.a.frame,Object(v.a)(this,this.p$f,"grammarDialogOptionFocusHandler"))}MHb(z,Y,m,I,X){z=this.o1f();if(1===m)return this.kJd.request(z).result&&
this.kJd.request(z).result.length?6===this.Cnb.a4a.status?32:8:8;this.Af=this.tTh(z,this.Cnb.a4a.result);this.Af.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,ta=>{e.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===ta?"OK":0===ta?"Cancel":"");1===ta&&(this.Af.dYj()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.Cnb.saveSettings(this.Af.settings)):e.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});z=m="";X&&(m+=X.SourceControlId,
z+=X.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+m+", Alt: "+z);return 32}o1f(){return O.AFrameworkApplication.lcid}q$f(z){if(!this.Af)return 2;var Y=this.Af.No.yl().wj.d_;if(Y===this.Af.Yv&&z===he.a.u7b||Y===this.Af.v_a&&z===he.a.t7b)this.Af.M7?this.Af.No.yl().wj.ZE(this.Af.M7):this.Af.B8k();else if(Sys.UI.DomElement.containsCssClass(Y,re.V1b)||Y.parentNode&&Sys.UI.DomElement.containsCssClass(Y.parentNode,re.V1b))Y=null,z===he.a.u7b?Y=this.Af.v_a:z===
he.a.t7b&&(Y=this.Af.Yv),this.Af.No.yl().wj.ZE(Y);else if(z===he.a.u7b)this.Af.No.yl().AGb();else if(z===he.a.t7b)this.Af.No.yl().yGb();else return 2;return 32}p$f(z){if(!this.Af)return 2;let Y=this.Af.No.yl().wj.d_;if(Y===this.Af.Yv||Y===this.Af.v_a||Y===this.Af.wD)return 2;z===he.a.FVc&&this.Af.No.yl().AGb();z===he.a.GVc&&this.Af.No.yl().yGb();Y=this.Af.No.yl().wj.d_;Y===this.Af.v_a?this.Af.No.yl().yGb():Y===this.Af.Yv?this.Af.No.yl().AGb():this.Af.M7=Y;return 32}}Object(h.a)(Ke,"GrammarSettingsActor",
null,[]);class me extends Ke{constructor(z,Y,m,I,X,ta,Fa){super(z,Y,m,I);this.ob=X;this.pye=ta;this.Ea=Fa}o1f(){let z=O.AFrameworkApplication.lcid;if(this.ob.P_(this.ob.Na)){var Y=this.ob.Xd();Y&&1===Y.length&&(Y=this.Ea.WSa(Y[0]),0<Y&&(z=Y))}else this.ob.Na.mb&&(Y=this.pye.DTc(this.ob.Qj),0<Y&&(z=Y));return z}}Object(h.a)(me,"EditorSettingsActor",Ke,[]);var Uf=d(63),yf=d(325),Cf=d(231),Ld=d(446),od=d(43);class ug{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob){this.jVd=null;this.obg=(sc,wc,Lb)=>{var $b;
wc=this.pa.Qe();if(!wc||!wc.length)return bd.a.J(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),8;for(const Oc of wc)if(!Oc||this.fc.$c(Oc))return bd.a.J(509362199,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.Uil(wc))return bd.a.J(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),8;if(1===Lb)return 32;null===($b=od.a.Ib)||void 0===
$b?void 0:$b.Va("SlideCount",wc.length.toString());Lb=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()});try{Lb.nc(this.ua.Ba);Lb.jd=sc;for(const Oc of wc)Oc.ipc=!0}finally{Lb&&Lb.dispose()}return 32};this.ia=z;this.Fa=Y;this.fc=m;this.pa=I;this.Jb=X;this.WX=ta;this.ua=Fa;this.rB=bb;this.kR=yb;this.Oye=Bb;this.Sd=pb;this.Ha=Ob}wb(){this.ia.ra(Bc.a.eta,Lc.a.application,Object(v.a)(this,this.rbg,"handleSlidesSolidFill"),4);this.ia.ra(Bc.a.fRc,Lc.a.application,Object(v.a)(this,this.rbg,"handleSlidesSolidFill"),
4);this.ia.ra(Bc.a.m5d,Lc.a.application,Object(v.a)(this,this.qbg,"handleSlidesPicture"),4);this.ia.ra(Bc.a.JYf,Lc.a.application,Object(v.a)(this,this.qbg,"handleSlidesPicture"),4);this.ia.ra(Bc.a.l5d,Lc.a.application,Object(v.a)(this,this.Hxj,"handleSlidesFinalizePicture"),4);this.ia.ra(Bc.a.dRc,Lc.a.application,Object(v.a)(this,this.I$f,"handleApplyAll"),4);this.ia.ra(Bc.a.IYf,Lc.a.application,Object(v.a)(this,this.I$f,"handleApplyAll"),4);this.ia.ra(Bc.a.CLe,Lc.a.application,Object(v.a)(this,this.Hvj,
"handlePopulateFillMenu"),96);this.ia.ra(Bc.a.Zah,Lc.a.application,Object(v.a)(this,this.Ivj,"handlePopulateFillMenuForCanvasContextMenu"),96);this.ia.ra(Bc.a.ZEe,Lc.a.application,Object(v.a)(this,this.Luj,"handleMoreFormatBackgroundColors"),96);this.ia.ra(Bc.a.bjd,Lc.a.application,Object(v.a)(this,this.Muj,"handleMoreFormatBackgroundColorsResponse"),4);this.ia.ra(Bc.a.eRc,Lc.a.application,this.obg,4);this.ia.ra(Bc.a.KYf,Lc.a.application,this.obg,4)}Ee(){}Hvj(z,Y,m,I,X){z=this.ua.Ba;if(!z||this.fc.$c(z))return 16;
if(1===m)return 32;if(!X)return bd.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;m=z.Jd;if(!m)return bd.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;z=this.WX.xf.g8;Y=Object.assign(new Le.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(Y.MenuSectionList,Td.f(m,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(Y.MenuSectionList,Td.d("Standard Colors","Color.Menu.Controls",
"standardColor","FormatBackgroundStandardColors","3049223287",!1));z&&0<z.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(Y.MenuSectionList,Td.c(z,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(Y.MenuSectionList,Td.a("More Format Background Color","Color.Menu.Controls",
"3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));X.MenuItems=Y;return 32}Ivj(z,Y,m,I,X){z=this.ua.Ba;if(!z||this.fc.$c(z))return 16;if(1===m)return 32;if(!X)return bd.a.J(512623376,822,10,"HandlePopulateFillMenuForCanvasContextMenu requires actionData"),8;Y=z.Jd;if(!Y)return bd.a.J(512623374,822,10,"HandlePopulateFillMenuForCanvasContextMenu failed to get theme information from slide"),
8;m=this.WX.xf.g8;I=Bc.a.fRc.toString();z=Object.assign(new Le.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});z.MenuSectionList.push(Td.f(Y,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColorsFromCanvas",I,1));z.MenuSectionList.push(Td.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromCanvas",I,!1));Y=Bc.a.bjd.toString();m&&0<m.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!1)),z.MenuSectionList.push(Td.c(m,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",Y,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));z.MenuSectionList.push(Td.a("More Format Background Color","Color.Menu.Controls",Bc.a.ZEe.toString(),ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));
X.MenuItems=z;return 32}rbg(z,Y,m,I,X){Y=this.pa.Qe();if(!Y||!Y.length)return 16;for(const ta of Y)if(!ta||this.fc.$c(ta))return 16;if(1===m)return 32;m=ug.Hhd(X);if(!m)return 8;od.a.Ib&&od.a.Ib.Va("SlideCount",Y.length.toString());X=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()});try{X.nc(this.ua.Ba);X.jd=z;for(const ta of Y)ta.qsb=m}finally{X&&X.dispose()}return 32}qbg(z,Y,m){this.jVd=this.ua.Ba;z=this.pa.Qe();if(!z||!z.length)return 16;for(const I of z)if(!I||this.fc.$c(I)||Uf.a.mx(I.Cb))return 16;
if(1===m)return 32;this.xrd(!1);return 32}I$f(z,Y,m){Y=this.ua.Ba;if(!Y||this.fc.$c(Y))return 16;if(1===m)return 32;m=Y.Cb;Y=this.WX.xf;if(!Y)return 8;const I=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()});try{I.nc(Y),I.jd=z,Y.Trb=m}finally{I&&I.dispose()}return 32}Uil(z){const Y=this.WX.xf;if(!Y)return bd.a.J(509362197,822,10,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),!1;for(const I of z)if((z=I.LS)&&-1==z.indexOf("/BgSource/ContentMaster")&&-1==z.indexOf("/BgSource/MainMaster")){var m=
Y.DZi(I.ij,I.Cn);if(!m)return bd.a.J(509362196,822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null"),!0;m=m.LS;if(!m||!z.match(m))return!0}return!1}Hxj(z,Y,m,I,X){Y=this.pa.Qe();if(!Y||!Y.length)return 16;for(const Fa of Y)if(!Fa||!Fa.isConnected)return 16;if(1===m)return 32;this.kR.Dhb=new Date;const ta=od.a.Ib;this.rB.W_e(X,Fa=>{od.a.DI(ta,()=>{this.Jxj(Fa,z)})},Fa=>{this.R7b(Fa.error)});this.ua.Ba===this.jVd&&(this.Fa.Ed(),this.pa.Rh());return 32}Luj(z,
Y,m,I,X){z=this.ua.Ba;if(!z||this.fc.$c(z))return bd.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Ha.HC&&Wd.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.pa.Qe().length:1!==this.pa.Qe().length)return 16;if(1===m)return this.ia.La(Bc.a.renderColorPicker,1,X);m=Cf.a.parse(z.LS);if(!m)return 8;X=m.aMa();m=null;X&&(m=pd.Box4ColorHelper.gta(X));X={};X.currentColor=m;X.handleCommand=Bc.a.bjd;return this.ia.La(Bc.a.renderColorPicker,2,X)}Muj(z,Y,m,I,
X){if(1===m)return this.ia.La(Bc.a.eta,m,X);if(!X)return bd.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;z=this.ia.La(Bc.a.eta,m,X);32===z&&this.ia.La(Bc.a.QBa,m,X);return z}xrd(z){this.Oye?Ld.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.rB&&(this.rB.FPb=1,this.rB.Edh(z))}Jxj(z,Y){this.kR.wZa=new Date;(z=z.result)?this.Ori(z,Y):(Y=Object.assign(new yf.a,{Code:94}),this.R7b(Y))}Ori(z,Y){const m=this.pa.Qe(),I=this.Jb.Ad(15);
try{I.nc(this.jVd);I.jd=Y;for(const X of m)X.DC=z.ItemId}finally{I&&I.dispose()}if(z=od.a.Ib)z.actionName="FormatBackgroundPicture",z.Va("PictureUploadStart",od.a.mf(this.kR.Dhb)),z.Va("PictureUploadDurationMS",(+this.kR.wZa-+this.kR.Dhb).toString())}R7b(z){this.kR.wZa=new Date;this.Sd.cH(z.Code,Y=>{Y.mC=1;Y.$Ra=z.ExtraErrorParam;return!1})}static Hhd(z){return Cf.a.parse(z.Color)}}Object(h.a)(ug,"FormatBackgroundActor",null,[365]);var Kf=d(76),Vf=d(33),Ch=d(419),xg=d(32),lh=d(154);const Oi=z=>{let Y=
z.isBold?"b:1;":"";Y+=z.isItalic?"i:1;":"";Y+=z.hE?"u:1;":"";Y+=z.PF?"s:1;":"";Y+=z.isSuperscript?"sup:1;":"";return Y+=z.QF?"sub:1;":""},ph=(z,Y,m)=>{let I=null;for(var X,ta=Vf.ParagraphReader.text(z),Fa=0;z.Ra&&Fa<z.Ra.length;){var bb=z.Ra.ga(Fa),yb=bb.cp;X=Fa<z.Ra.length-1?z.Ra.ga(Fa+1).cp:Vf.ParagraphReader.textLength(z);if(-1!==Y&&X<=Y)Fa++;else{if(-1!==m&&yb>m)break;var Bb="";bb.formatting?Bb=Oi(bb.formatting.cache):(bb=Ch.c(z.Ra,bb.cp).N1c)&&(Bb=Oi(bb.cache));bb=yb;-1!==Y&&(bb=Math.max(Y,yb));
yb=X;-1!==m&&(yb=Math.min(m,X));yb=ob.a.substring(ta,bb,yb);0<yb.length&&(X=document.createElement("span"),X.setAttribute("style",Bb),X.innerText=yb,I||(I=document.createElement("p")),I.appendChild(X));Fa++}}if(I&&Vf.ParagraphReader.cX(z)){Y=I;m=Y.setAttribute;Fa=new xg.GraphIterator;Fa.set(z);Fa.rc(11);Fa.Jg(11);ta="";if(z.Rf.lw(Fa))switch(Fa=z.Rf.lw(Fa),z=Vf.ParagraphReader.thb(z),Bb=Fa.lX,Fa.listType){case 0:switch(Fa.listStyle){case 1:ta="decimal";break;case 2:ta="loweralpha";break;case 3:ta=
"lowerroman";break;case 4:ta="upperalpha";break;case 5:ta="upperroman";break;default:ta="decimal"}ta=String.format("lt:{0};in:{1};li:{2}",ta,z,Bb);break;case 1:switch(Fa.listStyle){case 1:ta="disc";break;case 2:ta="circle";break;case 3:ta="square";break;default:ta="disc"}ta=String.format("lt:{0};in:{1}",ta,z)}m.call(Y,"style",ta)}return I},Dh=z=>{if(z){var Y;(Y=F.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?Y=Y.NN(z):(bd.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),
Y=null);if(Y){z=null;Y=Y.q$a();for(let m=0;m<Y.length;m++){const I=mh(Object(B.a)(Kf.AParagraphNode,Y[m].B4b));z=Od(I,z)}return z}z=Array.isArray(z.xC())?z.xC():null;return mh(z&&0<z.length?z[0]:null)}return null},mh=z=>{let Y=null;for(;z;){const m=ph(z,-1,-1);Y=Od(m,Y);z=Vf.ParagraphReader.Ata(z,!1,!0,!1)}return Y},Od=(z,Y)=>{z&&(Y||(Y=document.createElement("div")),Y.appendChild(z));return Y},Ue=z=>{const Y=Object.assign(new lh.a,{Source:6});F.a.instance.resolve("PowerPointWebEditor.IErrorHandler").zs(Y,
z,m=>{m.mC=1;m.sCa=0;m.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;m.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};class yh{constructor(z,Y,m,I){this.pBg=!1;this.Aad="";this.ia=z;this.Fa=Y;this.ob=m;const X=new Date;I("immersiveReader").then(()=>{this.pBg=!0;bd.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+X)}).catch(ta=>{const Fa=+new Date-+X;bd.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",
Fa,ta.toString());const bb=new Map;bb.set("JSLoadDurationInMs",Fa.toString());bb.set("Exception",ta.toString());A.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new ka.a,{extendedProperties:bb}))})}wb(){this.ia.ya(Bc.a.immersiveReader,Lc.a.view,Object(v.a)(this,this.seg,"immersiveReaderHandler"));this.ia.ya(Bc.a.$de,Lc.a.view,Object(v.a)(this,this.seg,"immersiveReaderHandler"))}Ee(){this.Fa.Fc(jf.a.kQ).bindAction(Ac.KeyInputManager.Oa(ng.a.Qvc,Ac.KeyInputManager.Oe|
4),Bc.a.immersiveReader)}n4i(z){let Y="";for(z=Object(B.a)(Kf.AParagraphNode,z.node);z;){const m=Vf.ParagraphReader.Ata(z,!0,!0,!1);if(m)z=m;else break}for(;z;)Y+="\n"+Vf.ParagraphReader.text(z),z=Vf.ParagraphReader.Ata(z,!1,!0,!1);return Y}wli(){var z=this.ob.Qe();let Y=null;if(!z)return null;for(const m of z)if(z=m.mTa())for(const I of z)z=Dh(I),Y=Od(z,Y);return Y}vli(){let z=null;var Y=this.ob.Na;if(!Y)return null;for(let X of Y)if(X)for(Y=0;Y<X.length;Y++){var m=X.ga(Y),I=null;if(m.contextId===
Lc.a.outline||m.contextId===Lc.a.Of)if(Vf.ParagraphReader.ae(m.node)){for(m=Object(B.a)(Kf.AParagraphNode,m.node);m;)if(I=Vf.ParagraphReader.Ata(m,!0,!0,!1))m=I;else break;I=mh(m)}else I=Dh(Object(B.a)(4,m.node));else m.contextId!==Lc.a.endOfParagraph&&Vf.ParagraphReader.ae(m.node)&&(I=ph(Object(B.a)(Kf.AParagraphNode,m.node),m.Qa,m.Lb));z=Od(I,z)}return z}Ali(){let z;return(z=this.ob.Bs()?this.wli():this.vli())?z.innerHTML:""}qnj(){let z="";const Y=this.ob.Na.mb;if(Y)for(let m=0;m<Y.length;m++){const I=
Y.ga(m),X=I.Qa,ta=I.Lb-X;let Fa;if(Vf.ParagraphReader.ae(I.node))switch(Fa=I.node.characterData,I.contextId){case Lc.a.paragraph:z+=Fa+"\r";break;case Lc.a.textRange:0<ta&&(z+=Fa.substr(X,ta));break;case Lc.a.endOfParagraph:z+="\r";break;case Lc.a.Of:z+=this.n4i(I)}}return z}Tpg(){const z=new XMLHttpRequest,Y=F.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var m=F.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;m=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",
m,Y);z.open("GET",m,!0);const I=ea.a.create().toString();z.setRequestHeader("X-UserSessionId",O.AFrameworkApplication.userSessionId);z.setRequestHeader("X-CorrelationID",I);z.setRequestHeader("X-WacCluster",F.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").qk);let X=null;const ta=new Map;z.onreadystatechange=()=>{if(4===z.readyState)if(200===z.status){var Fa=+new Date-+X;bd.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",Fa);ta.set("AuthTokenDurationInMs",
Fa.toString());Fa=z.responseText.replace('"',"");const bb=new Date,yb=Wd.a("EnableSendingHTMLToIR")?[{["content"]:this.Aad,["mimeType"]:"text/html"}]:[{["content"]:this.Aad}];immersiveReader.launchAsync(Fa,null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:yb},null).then(Bb=>{Bb=(Bb=Object(B.a)(Object,Bb))?Bb.sessionId:"";const pb=+new Date-+bb,Ob=+new Date-+X;bd.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",
pb,Bb);ta.set("LaunchAsyncDurationInMs",pb.toString());ta.set("IRResponseSessionId",Bb);ta.set("UserPerceivedDurationInMs",Ob.toString());A.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new ka.a,{extendedProperties:ta}))}).catch(Bb=>{Ue(Y);const pb=+new Date-+bb,Ob=+new Date-+X;bd.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",pb,Bb);ta.set("LaunchAsyncDurationInMs",pb.toString());ta.set("ErrorJson",Bb.toString());ta.set("UserPerceivedDurationInMs",
Ob.toString());A.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new ka.a,{extendedProperties:ta}))})}else Ue(Y),Fa=+new Date-+X,bd.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Fa,z.status,I),ta.set("CorrelationId",I),ta.set("StatusCode",z.status.toString()),ta.set("UserPerceivedDurationInMs",Fa.toString()),A.Health.instance.recordKpiFailure("ImmersiveReaderTriggered",
"RequestForAuthTokenFailed",!1,!0,Object.assign(new ka.a,{extendedProperties:ta}));else bd.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",I,z.status)};X=new Date;bd.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",X.getTime(),I);m=new Map;m.set("CorrelationId",I);m.set("Info","RequestingAuthToken");A.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,m);z.send(null)}seg(z,
Y,m){if(1===m||6===this.ia.xq){if(!this.pBg)return 8;this.Aad=Wd.a("EnableSendingHTMLToIR")?this.Ali():this.qnj();if(""===this.Aad)return 8}2===m&&this.Tpg();return 32}}Object(h.a)(yh,"ImmersiveReaderActor",null,[365]);var Hj=d(584),fe=d(793);class Zh{constructor(z){this.customData=null;this.nQ=z}}Object(h.a)(Zh,"PropertySetChangedState",null,[]);class Pi{static pLk(z,Y,m){if(z&&Y){var I=new Zh(Y),X=(ta,Fa,bb)=>{m.oLk(ta,Fa,bb,I)};z=new fe.a(Y,z);z.lHc=X;z.RJc=X;z.imd=X;z.Qfa()}}}Object(h.a)(Pi,"PropertySetChangedManager",
null,[]);class Zj{constructor(z){this.YZh=z}oLk(z,Y,m,I){const X=this.YZh[z.id.toString()];X&&X(z,Y,m,I)}}Object(h.a)(Zj,"PropertyChangedProcessor",null,[]);var Wg=d(1101),$h=d(441),Fe=d(61),Ph=d(583),rg=d(402),zg=d(968);class lj{constructor(){this.LNe=this.m2c=this.zXc=null}}Object(h.a)(lj,"ParagraphDialogResults",null,[]);class pg extends $a.a{constructor(z,Y,m){super(void 0,void 0,!0);this.nva=null;if(null===z)throw Error.argumentNull("properties");this.Gea=z.clone();this.k$=z.clone();this.oB=
m;this.ia=Y;this.agk=new Pa.a(Object(v.a)(this,this.cHi,"createPropertyChangedHandlers"))}brd(){this.ig="ParagraphDialog";const z={};z.bodyControls=this.o6d();this.aj(ResourceStrings.L_ParagraphDialogTitle,Object(v.a)(this,this.f0d,"dialogResultHandler"),z)}f0d(z,Y){1===z&&(this.IGl(Y),z=Object.assign(new lj,{zXc:this.Gea,m2c:this.k$,LNe:this.agk}),this.ia.La(Bc.a.ZHf,2,z));this.dispose()}o6d(){this.nva=pg.i7d();const z={};this.Yyi(z);this.lyi(z);var Y=zg.a("Inch",3,0,56,.1);const m=zg.a("Character",
2,0,56,.1);Y=[Y,m];this.Azi(z,Y);this.qyi(z,Y);Y=[zg.a("Point",5,0,1584,1)];this.ryi(z,Y);this.kyi(z,Y);this.Zyi(z);return z}IGl(z){this.PDl(z);this.AHl(z);this.dEl(z);this.eEl(z);this.NDl(z);this.WFl(z)}cHi(){const z={};z[Fe.a.iE.id.toString()]=Object(v.a)(this.oB,this.oB.xZj,"justificationChangedHandler");z[Fe.a.UHb.id.toString()]=Object(v.a)(this.oB,this.oB.G9g,"paraIndentLeftChangedHandler");z[Fe.a.VHb.id.toString()]=Object(v.a)(this.oB,this.oB.G9g,"paraIndentLeftChangedHandler");z[Fe.a.qga.id.toString()]=
Object(v.a)(this.oB,this.oB.z_e,"specialIndentChangedHandler");z[Fe.a.tNb.id.toString()]=Object(v.a)(this.oB,this.oB.z_e,"specialIndentChangedHandler");z[Fe.a.uNb.id.toString()]=Object(v.a)(this.oB,this.oB.z_e,"specialIndentChangedHandler");z[Fe.a.xx.id.toString()]=Object(v.a)(this.oB,this.oB.x0j,"lineSpacingChangedHandler");z[Fe.a.YHb.id.toString()]=Object(v.a)(this.oB,this.oB.J9g,"paraSpacingAfterChangedHandler");z[Fe.a.XHb.id.toString()]=Object(v.a)(this.oB,this.oB.J9g,"paraSpacingAfterChangedHandler");
z[Fe.a.aIb.id.toString()]=Object(v.a)(this.oB,this.oB.L9g,"paraSpacingBeforeChangedHandler");z[Fe.a.$Hb.id.toString()]=Object(v.a)(this.oB,this.oB.L9g,"paraSpacingBeforeChangedHandler");return z}Zyi(z){var Y=pg.Xcj(this.Gea),m="multiple"===Y;z.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:zg.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:Y,["allowFreeForm"]:!1};Y=0;let I=!1;this.Gea.Sa(Fe.a.xx)&&m&&(Y=this.Gea.eb(Fe.a.xx),0<=Y&&(I=!0));m=[zg.a("none",0,0,9.99,.5)];m={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,
["unitType"]:"none",["validUnits"]:m,["numberFormatInfo"]:this.nva,["validReservedValues"]:[""]};m.value=I?Y:"";z.atSpinButtonProps=m}kyi(z,Y){z.afterSpacingSpinButtonProps=pg.dqd(pg.I_f(this.Gea,Fe.a.YHb,Fe.a.XHb),{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Ph.a.i1b(5),["validUnits"]:Y,["numberFormatInfo"]:this.nva,["validReservedValues"]:[""]})}ryi(z,
Y){z.beforeSpacingSpinButtonProps=pg.dqd(pg.I_f(this.Gea,Fe.a.aIb,Fe.a.$Hb),{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Ph.a.i1b(5),["validUnits"]:Y,["numberFormatInfo"]:this.nva,["validReservedValues"]:[""]})}qyi(z,Y){let m,I;({X8g:I,Y8g:m}=pg.w3f(this.Gea,Fe.a.VHb,Fe.a.UHb,!1));Y={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Ph.a.i1b(m),["validUnits"]:Y,["numberFormatInfo"]:this.nva,["validReservedValues"]:[""]};Y=pg.dqd(I,Y);z.beforeTextSpinButtonProps=Y}Azi(z,Y){var m={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,
["options"]:zg.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},I=this.Gea.Sa(Fe.a.qga)?this.Gea.eb(Fe.a.qga):-1;pg.vng(I)?m.selectedKey=I.toString():m.defaultSelectedKey="";z.specialIndentationComboBoxProps=m;({X8g:m,Y8g:I}=pg.w3f(this.Gea,Fe.a.uNb,Fe.a.tNb,1!==I&&2!==I));Y={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Ph.a.i1b(I),["validUnits"]:Y,["numberFormatInfo"]:this.nva};Y=pg.dqd(m,Y);z.bySpinButtonProps=Y}lyi(z){const Y={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:zg.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,
Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},m=this.Gea.Sa(Fe.a.iE)?this.Gea.eb(Fe.a.iE):0;pg.DQj(m)?Y.selectedKey=m.toString():Y.defaultSelectedKey="";z.alignmentComboBoxProps=Y}Yyi(z){z.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};z.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};z.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}WFl(z){if(z.lineSpacingComboBoxProps){const Y=z.lineSpacingComboBoxProps.selectedKey.toString();let m=zg.c(Y);"multiple"===Y&&(z=z.atSpinButtonProps)&&(m=parseFloat(z.value.toString()));this.k$.setValue(Fe.a.xx,m);this.k$.setValue(Fe.a.nX,2)}}NDl(z){if(z.afterSpacingSpinButtonProps){z=
z.afterSpacingSpinButtonProps;var Y=Ph.a.h1b(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(Y=4===Y?2:4,this.k$.setValue(Fe.a.YHb,parseInt(z.value.toString())),this.k$.setValue(Fe.a.XHb,Y))}}eEl(z){if(z.beforeSpacingSpinButtonProps){z=z.beforeSpacingSpinButtonProps;var Y=Ph.a.h1b(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(Y=4===Y?2:4,this.k$.setValue(Fe.a.aIb,parseInt(z.value.toString())),this.k$.setValue(Fe.a.$Hb,Y))}}dEl(z){if(z.beforeTextSpinButtonProps){var Y=
z.beforeTextSpinButtonProps;z=Ph.a.h1b(Y.unitType.toString().toLowerCase());if(""!==Y.value.toString()){Y=parseFloat(Y.value.toString());let m;2===z?m=2:(m=1,Y=Ph.a.QFh(Y,z));this.k$.setValue(Fe.a.VHb,Y);this.k$.setValue(Fe.a.UHb,m)}}}AHl(z){var Y=z.bySpinButtonProps,m=z.didChangeSpecialIndentationComboBoxValue;if(Y&&""!==Y.value.toString()||m)if(z.specialIndentationComboBoxProps&&(z=z.specialIndentationComboBoxProps,m=-1,z.selectedKey&&(z=z.selectedKey.toString(),m=parseInt(z)),pg.vng(m)&&this.k$.setValue(Fe.a.qga,
m)),Y){z=parseFloat(Y.value.toString());Y=Ph.a.h1b(Y.unitType.toString().toLowerCase());if(0>z||isNaN(z))z=0;2===Y?m=2:(m=1,z=Ph.a.QFh(z,Y));this.k$.setValue(Fe.a.uNb,z);this.k$.setValue(Fe.a.tNb,m)}}PDl(z){z.alignmentComboBoxProps&&(z=z.alignmentComboBoxProps,z.selectedKey&&(z=parseInt(z.selectedKey.toString()),0<=z&&this.k$.setValue(Fe.a.iE,z)))}static I_f(z,Y,m){if(z.Sa(Y)&&z.Sa(m)){m=z.eb(m);if(2!==m&&4!==m)return Number.NaN;z=z.eb(Y);2===m&&(z*=pg.EGk);return z}return Number.NaN}static dqd(z,
Y){Y.value=isNaN(z)?"":z;return Y}static i7d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static w3f(z,Y,m,I){let X=3;Wd.a("BySpinButtonDefaultvalueFix")&&I?Y=0:z.Sa(Y)&&z.Sa(m)&&!I?(Y=z.eb(Y),2===z.eb(m)?X=2:Y=Ph.a.eKl(Y,X)):Y=Number.NaN;return{X8g:Y,Y8g:X}}static DQj(z){return 1===z||2===z||3===z||6===z}static vng(z){return 1===z||2===z||0===z}static Xcj(z){if(pg.nzj(z)){z=
z.eb(Fe.a.xx);var Y="multiple";rg.a.fz(z,1)?Y="1.00":rg.a.fz(z,1.5)?Y="1.50":rg.a.fz(z,2)&&(Y="2.00");return Y}}static nzj(z){return z.Sa(Fe.a.xx)&&z.Sa(Fe.a.nX)&&2===z.eb(Fe.a.nX)?!0:!1}}pg.EGk=72;Object(h.a)(pg,"ReactParagraphDialog",$a.a,[]);class Nh{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb){this.sse=[];this.ia=z;this.pa=Y;this.Yea=m;this.p$=I;this.Jb=X;this.Ih=ta;this.OHa=Fa;this.Ea=bb;this.oB=yb;this.Wea=Bb;this.XVg=pb}wb(){this.ia.ra(Bc.a.$Ab,Lc.a.application,Object(v.a)(this,this.aDk,"paragraphDialogHandler"),
4);this.ia.ra(Bc.a.ZHf,Lc.a.application,Object(v.a)(this,this.lxi,"commitParagraphDialogHandler"),4);this.ia.ra(Bc.a.oeh,Lc.a.view,$h.a.h1,96);this.ia.ra(Bc.a.eeh,Lc.a.view,$h.a.h1,96);this.ia.ra(Bc.a.Beh,Lc.a.view,$h.a.h1,96);this.ia.ra(Bc.a.Ceh,Lc.a.view,$h.a.h1,96);this.ia.ra(Bc.a.Aeh,Lc.a.view,$h.a.h1,96);this.ia.ra(Bc.a.zeh,Lc.a.view,$h.a.h1,96);this.ia.ra(Bc.a.ieh,Lc.a.view,$h.a.h1,96);this.ia.ra(Bc.a.jeh,Lc.a.view,$h.a.h1,96);this.ia.ya(Bc.a.K8g,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.Eyh,Lc.a.view,
$h.a.dH);this.ia.ya(Bc.a.Eeg,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.Hyh,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.Gyh,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.L8g,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.M8g,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.G8g,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.Fyh,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.F8g,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.O8g,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.N8g,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.Iyh,Lc.a.view,$h.a.dH);this.ia.ya(Bc.a.Ujd,Lc.a.paragraph,Object(v.a)(this,this.rhj,"getPropertiesForParagraphDialog"));
this.ia.ya(Bc.a.Ujd,Lc.a.view,this.Wea);this.ia.le(Bc.a.Ujd,96)}Ee(){}aDk(z,Y,m){if(this.pa.Bs()||this.pa.o9())return 16;z=this.pa.Xd();if(!this.Ea.r_(z,!0).length&&!this.pa.fla())return 16;if(1===m)return 32;this.XVg&&bd.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.ia.xq,"PptRibbon.Home"===this.ia.asa);Array.clear(this.sse);this.ia.processAction(Bc.a.Ujd,2);return(m=Hj.APropertySet.ccj(this.sse))?((new pg(m,this.ia,this.oB)).brd(),32):16}lxi(z,Y,m,
I,X){if(1===m)return 32;if(!(X&&X.zXc&&X.m2c&&X.LNe))return 16;Y=this.pa.uk();this.oB.pEj();m=this.Jb.oe(15);try{m.nc(Y),m.jd=z,X.zXc.equals(X.m2c)||this.Nvi(),Pi.pLk(X.zXc,X.m2c,new Zj(X.LNe.value))}finally{m&&m.dispose()}if(this.XVg){let ta;({xMh:z,yMh:X,AMh:Y,zMh:m,wMh:I,BMh:ta}=this.oB.Lvl());bd.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",z,X,Y,m,I,ta)}od.a.nP(!0,
!0);return 32}rhj(z,Y,m){if(1===m)return 32;Y=Y.node;z=new Wg.DictionaryPropertySet;z.setValue(Fe.a.iE,this.Ih.KN(Y));m=this.Yea.dTa(Y);z.setValue(Fe.a.nX,m.unit);z.setValue(Fe.a.xx,m.value);m=this.Yea.QW(Y);z.setValue(Fe.a.$Hb,m.beforeSpacing.unit);z.setValue(Fe.a.aIb,m.beforeSpacing.value);z.setValue(Fe.a.XHb,m.afterSpacing.unit);z.setValue(Fe.a.YHb,m.afterSpacing.value);m=this.p$.N8(Y);z.setValue(Fe.a.UHb,1);z.setValue(Fe.a.VHb,m.WM);Y=this.OHa.nTa(Y);z.setValue(Fe.a.qga,Y.specialIndentType);z.setValue(Fe.a.tNb,
Y.unit);z.setValue(Fe.a.uNb,Y.value);this.sse.push(z);return 32}Nvi(){if(this.pa.gH()){var z=this.pa.Xd();z=this.Ea.r_(z);for(const Y of z)Y.dta()}}}Object(h.a)(Nh,"ParagraphDialogActor",null,[365]);var Ha;(function(z){z[z.unspecified=-1]="unspecified";z[z.none=0]="none";z[z.left=1]="left";z[z.center=2]="center";z[z.right=3]="right";z[z.inner=4]="inner";z[z.outer=5]="outer";z[z.both=6]="both";z[z.distribute=7]="distribute";z[z.margin=8]="margin";z[z.highKashida=9]="highKashida";z[z.lowKashida=10]=
"lowKashida";z[z.mediumKashida=11]="mediumKashida";z[z.numTab=12]="numTab";z[z.thaiDistribute=13]="thaiDistribute";z[z.start=14]="start";z[z.end=15]="end"})(Ha||(Ha={}));Object(h.b)("Justification",Ha);var kb=d(580);class Hb{constructor(){this.value=this.unit=0}}Object(h.a)(Hb,"ParagraphSpacingCommandData",null,[]);class ic{constructor(){this.Ayh=this.H9g=this.K9g=this.M9g=!1}}Object(h.a)(ic,"PptPropertySetChangedState",null,[]);class Qc{constructor(z){this.Fme=this.Mke=this.Dme=this.Eme=this.$ke=
this.Tke=!1;this.pfc={};this.ia=z;this.vEj()}xZj(z,Y,m){m&&(z=this.pfc[Ha[m]],void 0!==z&&null!==z&&(this.ia.processAction(z,2),this.Tke=!0))}x0j(z,Y,m){void 0!==m&&null!==m&&(this.ia.La(Bc.a.Sna,2,m),this.$ke=!0)}L9g(z,Y,m,I){void 0!==m&&null!==m&&(z=Qc.WRc(I),!z.M9g&&null!==I&&I.nQ.Sa(Fe.a.$Hb)&&I.nQ.Sa(Fe.a.aIb)&&(Y=I.nQ.eb(Fe.a.aIb),I=I.nQ.eb(Fe.a.$Hb),z.M9g=!0,this.ia.La(Bc.a.ikb,2,Object.assign(new Hb,{value:Y,unit:I})),this.Eme=!0))}J9g(z,Y,m,I){void 0!==m&&null!==m&&(z=Qc.WRc(I),!z.K9g&&null!==
I&&I.nQ.Sa(Fe.a.XHb)&&I.nQ.Sa(Fe.a.YHb)&&(Y=I.nQ.eb(Fe.a.YHb),I=I.nQ.eb(Fe.a.XHb),z.K9g=!0,this.ia.La(Bc.a.hkb,2,Object.assign(new Hb,{value:Y,unit:I})),this.Dme=!0))}G9g(z,Y,m,I){void 0!==m&&null!==m&&(Y=Qc.WRc(I),!Y.H9g&&null!==I&&I.nQ.Sa(Fe.a.UHb)&&I.nQ.Sa(Fe.a.VHb)&&(z=I.nQ.eb(Fe.a.VHb),I=I.nQ.eb(Fe.a.UHb),Y.H9g=!0,Y=new kb.a,Y.unit=I,Y.value=z,this.ia.La(Bc.a.Ika,2,Y),this.Mke=!0))}z_e(z,Y,m,I){void 0!==m&&null!==m&&(m=Qc.WRc(I),!m.Ayh&&null!==I&&I.nQ.Sa(Fe.a.tNb)&&I.nQ.Sa(Fe.a.uNb)&&(Y=0,I.nQ.Sa(Fe.a.qga)&&
(Y=I.nQ.eb(Fe.a.qga)),z=I.nQ.eb(Fe.a.uNb),I=I.nQ.eb(Fe.a.tNb),m.Ayh=!0,m=0,1===Y?m=Bc.a.oMb:2===Y?m=Bc.a.qMb:0===Y&&(m=Bc.a.sMb),Y=new kb.a,Y.unit=I,Y.value=z,this.ia.La(m,2,Y),this.Fme=!0))}Lvl(){return{xMh:this.Tke,yMh:this.$ke,AMh:this.Eme,zMh:this.Dme,wMh:this.Mke,BMh:this.Fme}}pEj(){this.Fme=this.Mke=this.Dme=this.Eme=this.$ke=this.Tke=!1}vEj(){this.pfc.left=he.a.leftJustify;this.pfc.center=he.a.centerJustify;this.pfc.right=he.a.rightJustify;this.pfc.both=he.a.fullJustify}static WRc(z){z.customData||
(z.customData=new ic);return z.customData}}Object(h.a)(Qc,"ParagraphLevelPropertyChangedHandlers",null,[541]);var Jd=d(534),yd=d(195),He=d(270),sf=d(349),bg=d(40),Ag=d(51),Ii=d(84),aj=d(161);class Xg{constructor(z,Y){this.wvb=z;this.Hh=Y}}Object(h.a)(Xg,"DoNotCheckCritiqueTypeActionData",null,[]);var Qi=d(24);class Jh{e7a(z){return(z=Object(B.a)(Xg,z))?Object(Qi.a)(sf.a,z.Hh):!1}uJe(z,Y){if(Y=Object(B.a)(Xg,Y)){const m=Y.Hh;m&&(m.dMa(z,Y.wvb),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",
Y.wvb))}}}Object(h.a)(Jh,"DoNotCheckCritiqueTypeCallback",null,[962]);var Og=d(466),Qh=d(50);class Yg extends Og.a{constructor(z,Y,m,I,X,ta,Fa){super();this.sDe=null;this.init(z);this.Pl("WholePresentationOperation");this.QEa(O.AFrameworkApplication.Ta,Y,m,I,X);this.zeb=0;this.$Xg=Fa;this.jAg=ta;this.gGa=X;this.Ubc=Y;this.e7a()?1===this.behavior&&(this.Gp=32,this.KY()):(this.Gp=8,this.KY())}run(){0===this.zeb&&this.BXe();1===this.zeb&&this.uNe();2===this.zeb&&this.E1e();3===this.zeb&&this.s4d()}e7a(){return this.$Xg.e7a(this.gGa)}uJe(){this.$Xg.uJe(this.Ubc,
this.gGa)}BXe(){this.sDe=new Qh.GraphTransaction(3);this.sDe.nc(this.jAg.node);this.zeb=1}uNe(){this.ax||this.Sjb(this.jAg.CE);1!==this.Yna()&&(this.zeb=2)}E1e(){this.uJe();this.sDe.dispose();this.zeb=3}s4d(){this.KY()}}Object(h.a)(Yg,"WholePresentationOperation",Og.a,[]);var If=d(52);class mj{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob){this.KEa=!1;this.ia=z;this.wsg=Y;this.bG=m;this.Jb=I;this.n4c=X;this.ua=ta;this.Ea=Fa;this.x$=pb;this.pye=bb;this.PC=yb;this.ob=Ob;this.Pad=Bb.Mth;this.Ebk=Bb.pptProofingRemoveWholeDocTargetCritiquesEnabled;
this.dbk=Bb.pptHideProofingErrorIsEnabled;this.$Fj()}get W1b(){return this.bG.WUa?this.n4c.instance:null}wb(){this.ia.ra(Bc.a.oJb,If.a.application,Object(v.a)(this,this.oJb,"queryLanguage"),96);this.ia.ra(Bc.a.ihd,If.a.application,Object(v.a)(this,this.zBk,"openPPTLanguageDialogView"),4);this.bG.Yjg&&this.ia.ra(he.a.eXc,Lc.a.Of,Object(v.a)(this,this.eXc,"ignoreProofingError"),4);this.bG.Uje&&(this.Ebk?(this.ia.ya(he.a.Xub,Lc.a.paragraph,Object(v.a)(this,this.rQf,"doNotCheckThisCritiqueTypeForNode")),
this.ia.ya(he.a.Xub,Lc.a.section,Object(v.a)(this,this.rQf,"doNotCheckThisCritiqueTypeForNode")),this.ia.aW(he.a.Xub,Lc.a.Of,Object(v.a)(this,this.lPi,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.ra(Bc.a.O2b,Lc.a.Of,Object(v.a)(this,this.O2b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.ra(he.a.Xub,Lc.a.Of,Object(v.a)(this,this.O2b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.dbk&&(this.ia.ra(Bc.a.Ljd,If.a.application,Object(v.a)(this,this.Ljd,"queryHideProofingErrors"),
100),this.ia.ra(Bc.a.$cg,If.a.application,Object(v.a)(this,this.Jxl,"toggleHideProofingErrors"),4))}Ee(){}$Fj(){this.KEa=mj.hde;e.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.KEa);this.KEa&&this.Xcg(this.KEa)}Ljd(z,Y,m,I,X){if(1===m)return 32;if(!X)return 8;X[Jd.a.On]=this.KEa;return 32}Jxl(z,Y,m,I,X){if(1===m)return 32;if(!(X&&Jd.a.On in X))return 8;this.KEa=X[Jd.a.On];mj.hde=this.KEa;this.Xcg(this.KEa);e.ULS.sendTraceTag(37237071,375,50,"User hide proofing errors: {0}",
this.KEa);return 32}rQf(z,Y,m,I,X){if(!Y)return 8;z=Y.node;if(!z)return 8;if(Y.contextId===Lc.a.section&&!z.sa(aj.a.fjg,!1))return 32;if(Y.contextId===Lc.a.paragraph&&z.sa(aj.a.Uda,!1)){Y=Object(B.a)(Xg,X);if(!Y)return 8;X=Y.Hh;if(!X)return 8;Y.wvb+=this.Gih(z,X.typeId,X.lcid)}return 2}lPi(z,Y,m,I,X){var ta=this.y8i();ta=new Xg(0,ta);this.ia.pi(m,Bc.a.O2b,I,!1,X,ta);m=Ag.a.create(Object(B.a)(Ii.a,this.ua.presentation));e.ULS.sendTraceTag(37012126,375,50,"User click do not check this critique for whole doc with behavior: {0}",
I);return new Yg(z,Y,I,X,ta,m,new Jh)}O2b(z,Y,m,I,X){z=Object(B.a)(Xg,X);if(!z)return 8;I=z.Hh;if(!I)return 8;if(1===m)return 32;if(!Y.node)return 8;e.ULS.sendTraceTag(36790874,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",I.lcid,I.typeId);z.wvb+=this.YYk(I.typeId,I.lcid);this.W1b&&this.W1b.UNi(I.lcid.toString(),I.typeId);return 32}eXc(z,Y,m){if(1===m)return 32;e.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");m=this.PC.PSa(Y);if(!m||!m.Hh)return 8;
Y=Y.node;var I=this.ua.Ba;if(!Y||!I)return 8;I=this.Jb.oe(mj.koj(m));try{I.nc(Y),this.PC.uKa(Y,[m],!0),Y.setValue(bg.a.GIf,!0)}finally{I&&I.dispose()}m.Hh.dMa(z,1);this.ob.eVa()||od.a.nP(!0,!1);e.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}Xcg(z){this.x$.pYe=z}y8i(){var z=this.ob.Na.mb;if(!z)return null;z=this.PC.PSa(z.Ua);if(!z||!z.Hh)return null;z=Object(B.a)(sf.a,z.Hh);return!z||0>=z.lcid?null:z}YYk(z,Y){const m=new Date;if(!this.ua.Ba)return 0;const I=
this.ua.Ba.gk();if(!I)return 0;let X=0,ta=0;const Fa=this.Jb.oe(3);try{Fa.nc(this.ua.Ba);for(const bb of I)this.Ea.NJ(bb,yb=>{++ta;yb.Sa(bg.a.pq)&&yb.sa(aj.a.Uda,!1)&&(X+=this.Gih(yb,z,Y))})}finally{Fa&&Fa.dispose()}e.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+m,ta,I.length,X);return X}Gih(z,Y,m){const I=this.PC.GF(z,X=>{X=Object(B.a)(sf.a,X.Hh);return!!X&&X.typeId===Y&&X.lcid===
m});if(yd.a.Wa(I))return 0;this.PC.uKa(z,I);return I.length}oJb(z,Y,m,I,X){X.TIc=this.Acj();return 32}Acj(){let z=O.AFrameworkApplication.lcid;if(this.ob.P_(this.ob.Na)){var Y=this.ob.Xd();if(1<Y.length||1!==Y.length)return"";Y=this.Ea.WSa(Y[0]);0<Y&&(z=Y)}else this.ob.Na.mb&&(Y=this.pye.DTc(this.ob.Qj),0<Y&&(z=Y));return He.a.xe(z)?He.a.xe(z).displayName:He.a.xe(O.AFrameworkApplication.lcid).displayName}FVj(){const z=this.ob.Xd();return 1===z.length&&z[0].d0c}zBk(z,Y,m){if(2!==m)return 32;this.Pad&&
this.ob.P_(this.ob.Na)&&this.FVj()?(e.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.wsg.value.getInstance(!0).Prc()):this.ob.Na.mb&&(e.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.wsg.value.getInstance(!1).Prc());return 32}static get hde(){const z=Xa.a.get("PowerPointHideProofingErrors");return z?"true"===z.toLowerCase():!1}static set hde(z){Xa.a.aK("PowerPointHideProofingErrors",z.toString(),30)||e.ULS.sendTraceTag(37237069,375,
10,"Failed to set cookie for hide proofing errors to {0}",z.toString())}static koj(z){return 1===z.Hh.proofingType?15:3}}Object(h.a)(mj,"ProofingActor",null,[365]);var xi=d(273),Bj=d(586);class yi{constructor(z,Y){this.Jd=z.toLowerCase();this.variant=Y}}Object(h.a)(yi,"ThemeVariant",null,[]);var Zg=d(1051);class ya{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob){this.X4c=null;this.Y4c=0;this.syg=this.W4c=!1;this.UGg=null;this.Nsb=new yi("",0);this.zWg={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",
["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=z;this.Fa=Y;this.fc=m;this.pa=X;this.Jb=I;this.Vb=Fa;this.ua=bb;this.oc=yb;this.hjk=Bb;this.A7c=pb;this.$Bg=Ob}wb(){this.ia.ra(Bc.a.iw,If.a.application,Object(v.a)(this,this.wbg,"handleThemeChange"),4);this.ia.ra(Bc.a.nCa,If.a.application,Object(v.a)(this,this.wbg,
"handleThemeChange"),4);this.ia.ra(Bc.a.Pjd,If.a.application,Object(v.a)(this,this.Pjd,"queryMoreThemeGallery"),96);this.ia.ra(Bc.a.vOe,If.a.application,Object(v.a)(this,this.vOe,"queryMoreVariantGallery"),96);this.ia.ra(Bc.a.Dz,If.a.application,Object(v.a)(this,this.Dz,"queryThemes"),97);this.ia.ra(Bc.a.$nc,If.a.application,Object(v.a)(this,this.$nc,"queryThemeVariants"),97);this.ia.ra(Bc.a.Tid,If.a.application,Object(v.a)(this,this.Tid,"populateVariantGallery"),96)}Ee(){}Dz(z,Y,m,I,X){X&&X.aV&&
(z=this.zWg[X.aV]===this.bEa().Jd,X.WZa.Lf(z));return 32}$nc(z,Y,m,I,X){if(X&&X.aV){z=this.bEa();Y=z.Jd;m=X.aV;try{var ta=Number.parseInvariant(m.substring(m.length-1,m.length))}catch(Fa){ta=0}X=X.WZa;X.Lf(z.variant===ta);ta=ya.WZf(m,ta,Y);X.E3=ta}return 32}Pjd(z,Y,m){if(Y.contextId!==Lc.a.application)return 2;z=this.pa.uk();var I=this.bEa();Y=ya.Nxb(I.Jd);I=I.variant-1;return this.fc.$c(z)?16:1!==m||(e.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
Y,I),this.oc.qj())?32:8}vOe(z,Y,m){if(Y.contextId!==Lc.a.application)return 2;var I=this.pa.uk();Y=this.bEa();z=ya.Nxb(Y.Jd);Y=Y.variant-1;if(this.fc.$c(I))return 16;if(1===m)if(m=ya.g7b(this.bEa().Jd),I=this.hjk.HYj(m),m&&I)e.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",z,Y);else return 16;return 32}wbg(z,Y,m,I,X){Y=this.pa.Qe();I=this.ua.Ba;if(!I||z===Bc.a.nCa&&this.bEa()===this.Nsb||this.fc.$c(I))return 16;if(1===
m)return 32;m=Object(B.a)(String,X);if(null===m)return 8;X=this.zWg[m];return z===Bc.a.iw?this.JFk(I,X,Y):z===Bc.a.nCa?this.KFk(I,m):8}JFk(z,Y,m){if(!z)return 16;1>=this.SJf()||this.$Bg&&m&&1<m.length?(this.PRd(z,Y,0,!1,m),e.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",ya.Nxb(Y),0,z.Cb.sid)):(this.X4c=Y,this.Y4c=0,this.W4c=!1,z=new mb.StandardDialog,z.yd=1,z.fP(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,
Object(v.a)(this,this.REf,"changeThemeHandler")));return 32}KFk(z,Y){if(!z)return 16;const m=this.bEa();let I;try{if(I=Number.parseInvariant(Y.substring(7,Y.length))-1,0>I||I>ya.g7b(m.Jd))I=-1}catch(X){I=-1}1>=this.SJf()?(this.PRd(z,m.Jd,I,!0,null),e.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",ya.Nxb(m.Jd),I,z.Cb.sid)):(this.X4c=m.Jd,this.Y4c=I,this.W4c=!0,z=new mb.StandardDialog,z.yd=1,z.fP(ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_MultipleMainMastersMessage,Object(v.a)(this,this.REf,"changeThemeHandler")));return 32}bEa(){let z=null;var Y=this.ua.Ba;if(Y){Y=Y.ij;const I=this.oc.HI();if(I&&Y)for(var m of I)if(m.Id===Y){z=m;break}}if(!z)return this.syg?this.UGg:this.Nsb;if(Object(Wd.a)("EnableNonEmptyGuidFixForThemeActor")){if(!z.ThemeFamilyId||ya.Nxb(z.ThemeFamilyId)===ya.QCf)return this.Nsb}else if(!z.ThemeFamilyId||z.ThemeFamilyId===ya.moi)return this.Nsb;m="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===z.ThemeFamilyId||
"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===z.ThemeFamilyId;return!this.A7c&&m?this.Nsb:new yi(z.ThemeFamilyId,z.VariantIndex+1)}SJf(){const z=this.oc.HI();let Y=0;if(z)for(const m of z)m.InContent&&(Y+=1);return Y}REf(z){const Y=this.ua.Ba;if(Y){var m=this.X4c,I=this.Y4c,X=this.W4c;this.X4c=null;this.Y4c=-1;this.W4c=!1;1===z&&(this.PRd(Y,m,I,X,null),e.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",ya.Nxb(m),I,Y.Cb.sid))}}PRd(z,Y,
m,I,X){this.UGg=(this.syg=I)?new yi(Y,0):this.Nsb;const ta=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},void 0,!0);try{if(ta.nc(z),ta.jd=I?Bc.a.nCa:Bc.a.iw,this.$Bg&&X)for(const Fa of X)Fa.setValue(ye.a.s2e,Y),Fa.setValue(ye.a.eba,m),Fa.setValue(ye.a.igi,1<X.length);else z.setValue(ye.a.s2e,Y),z.setValue(ye.a.eba,m)}finally{ta&&ta.dispose()}this.fc.YZb(this.Vb.xf,z,"ChangeTheme")}Tid(z,Y,m,I,X){if(1===m)return 32;z=Math.max(ya.g7b(this.bEa().Jd),4);Y=this.bEa().Jd;X.MenuItems=ya.Rhj(z,Y);
return 32}static g7b(z){for(let Y=0;Y<Zg.a.bza.length;++Y)if(Zg.a.bza[Y].YPc===z)return Zg.a.bza[Y].C6e;return 0}static Nxb(z){for(let Y=0;Y<Zg.a.bza.length;++Y)if(Zg.a.bza[Y].YPc===z)return Zg.a.bza[Y].xGh;return ya.QCf}static oXi(z){let Y="";for(let m=0;m<Zg.a.bza.length;++m)Zg.a.bza[m].YPc===z&&(Y=Zg.a.bza[m].xGh.replace(" ",""));return Y}static Rhj(z,Y){const m=Object.assign(new Le.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var I=Object.assign(new xi.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",
DisplayMode:"Size85by48",ControlList:[]});Array.add(m.MenuSectionList,I);const X=Object.assign(new Bj.a,{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(I.ControlList,X);for(I=1;I<=z;++I)Array.add(X.GalleryItems,ya.WZf("Variant"+I,I,Y));return m}static WZf(z,Y,m){m=!ya.g7b(m)||Y>ya.g7b(m)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",
ya.oXi(m),Y);return Object.assign(new Cd.a,{Id:z,ExternalId:z,Icon:m,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,Y),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}ya.moi="00000000-0000-0000-0000-000000000000";ya.QCf="Unsupported Theme";Object(h.a)(ya,"ThemeActor",null,[365]);var La=d(475);class Qa{}Qa.none=0;Qa.cut=0;Qa.random=1;Qa.blinds=2;Qa.AVd=3;Qa.GCa=4;Qa.dissolve=
5;Qa.fade=6;Qa.kMa=7;Qa.TPe=8;Qa.pwd=9;Qa.wipe=10;Qa.Jth=11;Qa.split=13;Qa.vhl=17;Qa.Ahl=18;Qa.wedge=19;Qa.push=20;Qa.vWd=21;Qa.Ewf=23;Qa.wheel=26;Qa.Gth=27;Qa.wvc=28;Qa.ZKb=29;Qa.DEa=30;Qa.wpc=39;Qa.$0e=42;Qa.flip=43;Qa.AM=44;Qa.CLl=47;Qa.w3d=48;Qa.d1d=49;Qa.dKi=50;Qa.V6e=51;Qa.DKk=52;Qa.k1i=53;Qa.tJi=54;Qa.NKe=55;Qa.q9g=56;Qa.hKe=57;Qa.PQd=58;Qa.WJe=59;Qa.morph=60;Qa.pan=36;Qa.B5d=38;Qa.JXd=37;Qa.W0d=33;Qa.window=34;Qa.M4b=32;Qa.zoom=31;Qa.SMl=22;Object(h.a)(Qa,"TransitionTypes",null,[]);class Eb{constructor(z,
Y,m,I,X,ta,Fa,bb,yb,Bb,pb){this.ia=z;this.Vb=Y;this.ua=m;this.pa=X;this.Fa=ta;this.Jb=I;this.tn=Fa;this.fc=bb;this.VEg=yb.FSj;this.nn=yb.HC;this.H7c=yb.JTj;this.Agc=Bb.rk(Ge.a.fid);this.YGa=yb.eB;this.Fb=pb}wb(){this.H7c?(this.VEg?(this.ia.ra(Bc.a.Rj,Lc.a.application,Object(v.a)(this,this.qfl,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.ra(Bc.a.Aj,Lc.a.application,Object(v.a)(this,this.bOk,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.ra(Bc.a.Poa,Lc.a.application,Object(v.a)(this,
this.rfl,"setSlidesTransitionGalleryExisting"),5),this.ia.ra(Bc.a.Cya,Lc.a.application,Object(v.a)(this,this.sfl,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.ra(Bc.a.coa,Lc.a.application,Object(v.a)(this,this.cOk,"querySlidesTransitionGalleryExisting"),97),this.ia.ra(Bc.a.Pxa,Lc.a.application,Object(v.a)(this,this.dOk,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.ra(Bc.a.Rj,Lc.a.application,Object(v.a)(this,this.UWe,"setSlidesTransitionGallery"),5),this.ia.ra(Bc.a.Aj,Lc.a.application,
Object(v.a)(this,this.MOe,"querySlidesTransitionGallery"),97),this.ia.ra(Bc.a.Poa,Lc.a.application,Object(v.a)(this,this.UWe,"setSlidesTransitionGallery"),5),this.ia.ra(Bc.a.Cya,Lc.a.application,Object(v.a)(this,this.UWe,"setSlidesTransitionGallery"),5),this.ia.ra(Bc.a.coa,Lc.a.application,Object(v.a)(this,this.MOe,"querySlidesTransitionGallery"),97),this.ia.ra(Bc.a.Pxa,Lc.a.application,Object(v.a)(this,this.MOe,"querySlidesTransitionGallery"),97)),this.ia.ra(Bc.a.Sqc,Lc.a.application,Object(v.a)(this,
this.pfl,"setSlidesTransitionEffectOption"),5),this.ia.ra(Bc.a.Dkd,Lc.a.application,Object(v.a)(this,this.$Nk,"querySlidesTransitionEffectOption"),97),this.ia.ra(Bc.a.wib,Lc.a.application,Object(v.a)(this,this.aOk,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.ra(Bc.a.tIb,Lc.a.application,Object(v.a)(this,this.FHk,"populateSlidesTransitionEffectOptions"),96),this.ia.ra(Bc.a.Oxa,Lc.a.application,Object(v.a)(this,this.ZNk,"querySlidesTransitionDuration"),97),this.ia.ra(Bc.a.lkb,Lc.a.application,
Object(v.a)(this,this.ofl,"setSlidesTransitionDuration"),5)):(this.VEg?(this.ia.ra(Bc.a.Rj,Lc.a.application,Object(v.a)(this,this.jgl,"setTransitionGalleryExceptExisting"),5),this.ia.ra(Bc.a.Aj,Lc.a.application,Object(v.a)(this,this.tOk,"queryTransitionGalleryExceptExisting"),97),this.ia.ra(Bc.a.Poa,Lc.a.application,Object(v.a)(this,this.kgl,"setTransitionGalleryExisting"),5),this.ia.ra(Bc.a.Cya,Lc.a.application,Object(v.a)(this,this.lgl,"setTransitionGalleryExistingInMenu"),5),this.ia.ra(Bc.a.coa,
Lc.a.application,Object(v.a)(this,this.coa,"queryTransitionGalleryExisting"),97),this.ia.ra(Bc.a.Pxa,Lc.a.application,Object(v.a)(this,this.Pxa,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.ra(Bc.a.Rj,Lc.a.application,Object(v.a)(this,this.hXe,"setTransitionGallery"),5),this.ia.ra(Bc.a.Aj,Lc.a.application,Object(v.a)(this,this.Aj,"queryTransitionGallery"),97),this.ia.ra(Bc.a.Poa,Lc.a.application,Object(v.a)(this,this.hXe,"setTransitionGallery"),5),this.ia.ra(Bc.a.Cya,Lc.a.application,Object(v.a)(this,
this.hXe,"setTransitionGallery"),5),this.ia.ra(Bc.a.coa,Lc.a.application,Object(v.a)(this,this.Aj,"queryTransitionGallery"),97),this.ia.ra(Bc.a.Pxa,Lc.a.application,Object(v.a)(this,this.Aj,"queryTransitionGallery"),97)),this.ia.ra(Bc.a.Sqc,Lc.a.application,Object(v.a)(this,this.igl,"setTransitionEffectOption"),5),this.ia.ra(Bc.a.Dkd,Lc.a.application,Object(v.a)(this,this.sOk,"queryTransitionEffectOption"),97),this.ia.ra(Bc.a.wib,Lc.a.application,Object(v.a)(this,this.wib,"queryTransitionEffectOptionsAnchor"),
100),this.ia.ra(Bc.a.tIb,Lc.a.application,Object(v.a)(this,this.tIb,"populateTransitionEffectOptions"),96),this.ia.ra(Bc.a.Oxa,Lc.a.application,Object(v.a)(this,this.Oxa,"queryTransitionDuration"),97),this.ia.ra(Bc.a.lkb,Lc.a.application,Object(v.a)(this,this.lkb,"setTransitionDuration"),5));this.ia.ra(Bc.a.kkb,Lc.a.application,Object(v.a)(this,this.kkb,"setTransitionApplyAll"),4);this.ia.ra(Bc.a.VJb,Lc.a.application,Object(v.a)(this,this.VJb,"queryTransitionApplyAll"),96)}Ee(){}tIb(z,Y,m,I,X){if(this.nn&&
1!==this.pa.Qe().length)return 16;if(1===m)return 32;z=(z=this.ua.Ba)?z.jo:null;if(!z)return 16;if(!X)return 8;z=this.tn.Pxb(z);z.next&&(X.MenuItems=this.BBf(z));return 32}Aj(z,Y,m,I,X){if(!X)return 8;z=X.queryResult;X=X.SourceControlId;Y=this.tn.xQ(X);if(!Y)return 8;z.SDa=Eb.F5d(Y.uc,Y.pc,this.Agc);Y=this.ua.Ba;if(!Y)return 16;1===m&&((m=Y.jo)?(m=this.tn.rTa(m),z.ZU(!m&&"TransitionExisting"===X||m===X)):z.ZU("TransitionNone"===X));return 32}tOk(z,Y,m,I,X){if(!X||z!==Bc.a.Aj)return 8;z=X.queryResult;
X=X.SourceControlId;Y=this.tn.xQ(X);if(!Y)return 8;I=Y.uc.split("_")[1]+"_24";Y=Eb.xSa(X,X,I,"2024601249","149145197",Y.pc,Y.pc);z.E3=Y;Y=this.ua.Ba;if(!Y)return 16;1===m&&((m=Y.jo)?(m=this.tn.rTa(m),z.ZU(m===X)):z.ZU("TransitionNone"===X));return 32}coa(z,Y,m,I,X){if(!X||z!==Bc.a.coa)return 8;z=X.queryResult;X=X.SourceControlId;if(!X||"TransitionExisting"!==X)return 16;Y=this.tn.xQ(X);if(!Y)return 8;I=Y.uc.split("_")[1]+"_24";Y=Eb.xSa(X,X,I,"3752636652","3476251476",Y.pc,Y.pc);z.E3=Y;Y=this.ua.Ba;
if(!Y)return 16;if(1===m&&(m=Y.jo)){m=this.tn.rTa(m);Y=this.tn.W0c(m,this.tn.$wb());if(m&&!Y){I=this.tn.xQ(m);if(!I)return 8;const ta=I.uc.split("_")[1]+"_24";X=Eb.xSa(X,X,ta,"3752636652","3476251476",I.pc,I.pc);z.E3=X}z.ZU(!m||!!m&&!Y)}return 32}Pxa(z,Y,m,I,X){if(!X||z!==Bc.a.Pxa)return 8;z=X.queryResult;X=X.SourceControlId;if(!X||"TransitionExistingInMenu"!==X)return 16;Y=this.tn.xQ(X);if(!Y)return 8;I=Y.uc.split("_")[1]+"_24";X=Eb.xSa(X,X,I,"4036532528","2831233208",Y.pc,Y.pc);z.E3=X;X=this.ua.Ba;
if(!X)return 16;1===m&&(m=X.jo)&&(m=this.tn.rTa(m),z.ZU(!m));return 32}wib(z,Y,m){z=this.ua.Ba;if(!z)return 16;z=this.tn.Pxb(z.jo);return!z||!z.next||this.nn&&1!==this.pa.Qe().length?16:1===m?32:8}hXe(z,Y,m,I,X){if(!X)return 8;Y=X.SourceControlId;X=z===Bc.a.Poa||z===Bc.a.Cya;I=this.ua.Ba;if(!I||this.fc.$c(I)||this.nn&&1!==this.pa.Qe().length)return 16;var ta=I.jo;const Fa=!!this.tn.qTa(ta);if(X&&(!ta||Fa))return 16;if(1===m)return 32;ta=this.tn.xQ(Y);if(!ta)return 8;if(!X&&2===m&&Y){od.a.Ak("SlideCount",
"1");m=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{m.nc(I),m.jd=z,I.jo=ta.tc}finally{m&&m.dispose()}e.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Y,ta.next||"null",I.Cb.sid)}return 32}jgl(z,Y,m,I,X){if(!X)return 8;Y=X.SourceControlId;I=this.ua.Ba;if(!I)return 16;if(z!==Bc.a.Rj)return 8;if(this.fc.$c(I)||this.nn&&1!==this.pa.Qe().length)return 16;if(1===m)return 32;X=this.tn.xQ(Y);if(!X)return 8;
if(2===m&&Y){od.a.Ak("SlideCount","1");m=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{m.nc(I),m.jd=z,I.jo=X.tc}finally{m&&m.dispose()}e.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Y,X.next||"null",I.Cb.sid)}return 32}kgl(z,Y,m,I,X){if(!X)return 8;Y=this.ua.Ba;if(!Y)return 16;if(z!==Bc.a.Poa)return 8;if(this.nn&&1!==this.pa.Qe().length)return 16;if(1!==m)return 8;z=Y.jo;m=!!this.tn.qTa(z);
Y=this.tn.Pxb(z);Y=this.tn.W0c(Y?Y.parent:null,this.tn.$wb());return z&&!m||!Y?32:16}lgl(z,Y,m,I,X){if(!X)return 8;Y=this.ua.Ba;if(!Y)return 16;if(z!==Bc.a.Cya)return 8;if(this.nn&&1!==this.pa.Qe().length)return 16;if(1!==m)return 8;z=Y.jo;m=!!this.tn.qTa(z);return!z||m?16:32}kkb(z,Y,m){Y=this.ua.Ba;if(!Y||this.fc.$c(Y)||this.nn&&1!==this.pa.Qe().length)return 16;if(1===m)return 32;od.a.Ak("SlideCount","1");m=this.Vb.xf;const I=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{I.nc(m),I.jd=
z,m.Urb=Y.Cb}finally{I&&I.dispose()}e.ULS.sendTraceTag(512499933,801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}VJb(z,Y,m,I,X){z=this.ua.Ba?!0:!1;if(!X)return 8;X=X.queryResult;X.SDa=Eb.F5d("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.Agc);X.ZU(z);return z?32:16}igl(z,Y,m,I,X){if(!X)return 8;Y=X.MenuItemId;if(this.nn&&1!==this.pa.Qe().length)return 16;if(1===m)return 32;m=this.ua.Ba;if(!m||this.fc.$c(m))return 16;I=m?m.jo:null;X=this.tn.xQ(Y);
if(!I||!X||!X.tc)return 16;I.TransitionType=X.tc.TransitionType;I.Direction=X.tc.Direction;I.Duration=X.tc.Duration;od.a.Ak("SlideCount","1");const ta=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{ta.nc(m),ta.jd=z,m.jo=I}finally{ta&&ta.dispose()}e.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",X.parent,Y,m.Cb.sid);return 32}sOk(z,Y,m,I,X){if(!X)return 8;z=X.queryResult;X=X.MenuItemId;
Y=this.ua.Ba;if(!Y)return 16;1===m&&z.Lf(this.tn.qTa(Y.jo)===X);return 32}Oxa(z,Y,m,I,X){z=this.ua.Ba;if(!z)return 16;if(!X)return 8;z=z.jo;if(X=X.queryResult)X.Kaa=z?(z.Duration/1E3).toString():"0";return 32}lkb(z,Y,m,I,X){Y=this.ua.Ba;if(!Y||this.fc.$c(Y))return 16;if(!X)return 8;if(this.nn&&1!==this.pa.Qe().length)return 16;I=Math.floor(1E3*X.Number);X=Y.jo;if(!X)return 16;od.a.Ib&&(od.a.Ib.actionName="SetTransitionDuration");if(1===m)return"TransitionNone"===this.tn.rTa(X)?16:32;if(2===m){X.Duration=
I;const ta=this.Fa.Ae;od.a.Ak("SlideCount","1");m=this.Jb.Ad(15,void 0,()=>{this.pa.jj();!ta||ta.name!==jf.a.sg&&ta.name!==jf.a.Ez||this.Fa.Ed()});try{m.nc(Y),m.jd=z,Y.jo=X}finally{m&&m.dispose()}}return 32}FHk(z,Y,m,I,X){if(1===m)return 32;if(!X)return 8;Y=this.pa.Qe();if(!Y||!Y.length)return 16;z=Y[0].jo;if(!z)return 16;z=this.tn.Pxb(z);if(1<Y.length)for(const ta of Y){Y=ta.jo;if(!Y)return 16;Y=this.tn.Pxb(Y);if(z.parent!==Y.parent)return 16}z.next&&(X.MenuItems=this.BBf(z));return 32}MOe(z,Y,m,
I,X){if(!X)return 8;z=X.queryResult;X=X.SourceControlId;Y=this.tn.xQ(X);if(!Y)return 8;z.SDa=Eb.F5d(Y.uc,Y.pc,this.Agc);Y=this.pa.Qe();if(!Y||!Y.length)return 16;1===m&&(m="",({lpa:m}=this.xRa(Y)).returnValue&&z.ZU(!m&&"TransitionExisting"===X||m===X));return 32}bOk(z,Y,m,I,X){if(!X||z!==Bc.a.Aj)return 8;z=X.queryResult;X=X.SourceControlId;Y=this.tn.xQ(X);if(!Y)return 8;I=Y.uc.split("_")[1]+"_24";Y=Eb.xSa(X,X,I,"2024601249","149145197",Y.pc,Y.pc);z.E3=Y;Y=this.pa.Qe();if(!Y||!Y.length)return 16;1===
m&&(m="",({lpa:m}=this.xRa(Y)).returnValue&&z.ZU(m===X));return 32}cOk(z,Y,m,I,X){if(!X||z!==Bc.a.coa)return 8;z=X.queryResult;X=X.SourceControlId;if(!X||"TransitionExisting"!==X)return 16;Y=this.tn.xQ(X);if(!Y)return 8;I=Y.uc.split("_")[1]+"_24";Y=Eb.xSa(X,X,I,"3752636652","3476251476",Y.pc,Y.pc);z.E3=Y;Y=this.pa.Qe();if(!Y||!Y.length)return 16;if(1===m&&(m="",({lpa:m}=this.xRa(Y)).returnValue)){Y=this.tn.W0c(m,this.tn.$wb());if(m&&!Y){I=this.tn.xQ(m);if(!I)return 8;const ta=I.uc.split("_")[1]+"_24";
X=Eb.xSa(X,X,ta,"3752636652","3476251476",I.pc,I.pc);z.E3=X}z.ZU(!m||!!m&&!Y)}return 32}dOk(z,Y,m,I,X){if(!X||z!==Bc.a.Pxa)return 8;z=X.queryResult;X=X.SourceControlId;if(!X||"TransitionExistingInMenu"!==X)return 16;Y=this.tn.xQ(X);if(!Y)return 8;I=Y.uc.split("_")[1]+"_24";X=Eb.xSa(X,X,I,"4036532528","2831233208",Y.pc,Y.pc);z.E3=X;X=this.pa.Qe();if(!X||!X.length)return 16;1===m&&(m="",({lpa:m}=this.xRa(X)).returnValue&&z.ZU(!m));return 32}aOk(z,Y,m){z=this.pa.Qe();if(!z||!z.length)return 16;Y=this.tn.Pxb(z[0].jo);
return!Y||!Y.next||1<z.length&&!this.xRa(z).returnValue?16:1===m?32:8}UWe(z,Y,m,I,X){if(!X)return 8;Y=X.SourceControlId;X=z===Bc.a.Poa||z===Bc.a.Cya;I=this.pa.Qe();if(!I||!I.length)return 16;for(var ta of I)if(this.fc.$c(ta))return 16;ta="";const Fa=({lpa:ta}=this.xRa(I)).returnValue;if(X&&(!Fa||ta))return 16;if(1===m)return 32;ta=this.tn.xQ(Y);if(!ta)return 8;if(!X&&2===m&&Y){od.a.Ak("SlideCount",I.length.toString());m=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{m.nc(this.Vb.xf);m.jd=
z;for(const bb of I)bb.jo=ta.tc}finally{m&&m.dispose()}e.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",Y,ta.next||"null")}return 32}ukl(){if(!Object(Wd.a)("ToggleMorphTransitionToNoneForActionAi")||!this.YGa)return!1;const z=this.pa.Qe();let Y=!0;for(const m of z)if(!m.jo||m.i_e!==Qa.morph){Y=!1;break}return Y}qfl(z,Y,m,I,X){if(!X)return 8;Y=X.SourceControlId;this.ukl()&&(Y="TransitionNone");if(z!==Bc.a.Rj)return 8;
I=this.pa.Qe();if(!I||!I.length)return 16;for(var ta of I)if(this.fc.$c(ta))return 16;if(1===m)return 32;ta=this.tn.xQ(Y);if(!ta)return 8;if(2===m&&Y){od.a.Ak("SlideCount",I.length.toString());m=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()},()=>{1===this.Fb.Fl&&this.Fa.Ej(jf.a.PB,!0)});try{m.nc(this.Vb.xf);m.jd=z;for(const Fa of I)Fa.jo=ta.tc}finally{m&&m.dispose()}e.ULS.sendTraceTag(512499930,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",
Y,ta.next||"null")}return 32}rfl(z,Y,m,I,X){if(!X)return 8;Y=this.pa.Qe();if(!Y||!Y.length)return 16;if(z!==Bc.a.Poa||1!==m)return 8;I="";z=({lpa:I}=this.xRa(Y)).returnValue;m=!!I;Y=I&&0<I.length?this.tn.xQ(I):null;Y=this.tn.W0c(Y?Y.parent:null,this.tn.$wb());return!z||m&&Y?16:32}sfl(z,Y,m,I,X){if(!X)return 8;Y=this.pa.Qe();if(!Y||!Y.length)return 16;if(z!==Bc.a.Cya||1!==m)return 8;z="";return!({lpa:z}=this.xRa(Y)).returnValue||z?16:32}pfl(z,Y,m,I,X){if(!X)return 8;Y=X.MenuItemId;if(1===m)return 32;
m=this.pa.Qe();if(!m||!m.length)return 16;for(var ta of m)if(this.fc.$c(ta)||!ta.jo)return 16;ta=this.tn.xQ(Y);if(!ta||!ta.tc)return 16;od.a.Ak("SlideCount",m.length.toString());I=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{I.nc(this.Vb.xf);I.jd=z;for(const Fa of m){let bb=Fa.jo;bb.TransitionType=ta.tc.TransitionType;bb.Direction=ta.tc.Direction;bb.Duration=ta.tc.Duration;Fa.jo=bb}}finally{I&&I.dispose()}e.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",
ta.parent,Y);return 32}$Nk(z,Y,m,I,X){if(!X)return 8;z=X.queryResult;X=X.MenuItemId;Y=this.pa.Qe();if(!Y||!Y.length)return 16;1===m&&(m="",({lpa:m}=this.tPi(Y)).returnValue&&z.Lf(m===X));return 32}ZNk(z,Y,m,I,X){if(!X)return 8;z=this.pa.Qe();if(!z||!z.length)return 16;if(X=X.queryResult)z=Eb.olj(z),X.Kaa=z;return 32}ofl(z,Y,m,I,X){if(!X)return 8;Y=this.pa.Qe();if(!Y||!Y.length)return 16;for(const ta of Y)if(this.fc.$c(ta))return 16;X=Math.floor(1E3*X.Number);for(const ta of Y)if(!ta.jo)return 16;
od.a.Ib&&(od.a.Ib.actionName="SetTransitionDuration");if(1===m){for(const ta of Y)if("TransitionNone"===this.tn.rTa(ta.jo))return 16;return 32}if(2===m){const ta=this.Fa.Ae;od.a.Ak("SlideCount",Y.length.toString());m=this.Jb.Ad(15,void 0,()=>{this.pa.jj();!ta||ta.name!==jf.a.sg&&ta.name!==jf.a.Ez||this.Fa.Ed()});try{m.nc(this.Vb.xf);m.jd=z;for(const Fa of Y){const bb=Fa.jo;bb.Duration=X;Fa.jo=bb}}finally{m&&m.dispose()}}return 32}xRa(z){let Y;Y="";if(!z||!z.length)return{returnValue:!1,lpa:Y};Y=this.tn.rTa(z[0].jo);
let m=!0;if(1<z.length)for(const I of z)if(z=this.tn.rTa(I?I.jo:null),Y!==z){m=!1;break}m||(Y="");return{returnValue:m,lpa:Y}}tPi(z){let Y;Y="";if(!z||!z.length)return{returnValue:!1,lpa:Y};Y=this.tn.qTa(z[0].jo);let m=!0;if(1<z.length)for(const I of z)if(z=this.tn.qTa(I?I.jo:null),Y!==z){m=!1;break}m||(Y="");return{returnValue:m,lpa:Y}}BBf(z){const Y=Object.assign(new Le.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,MenuSectionList:[]}),
m=Object.assign(new xi.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});Array.add(Y.MenuSectionList,m);let I=null;for(z=({key:I}=this.tn.V4f(z)).returnValue;z;)Array.add(m.ControlList,Object.assign(new La.a,{Command:"961566706",Id:I,ExternalId:"TransitionEffectOptions"+I,QueryCommand:"3535869262"})),{key:I,returnValue:z}=this.tn.V4f(z);return Y}static olj(z){let Y;if(!z||!z.length)return"0";const m=z[0].jo;Y=m?(m.Duration/1E3).toString():
"0";let I=!0;if(1<z.length)for(const X of z)if((z=X?X.jo:null)||m){if(!z&&m||z&&!m){I=!1;break}if(Y!==(z.Duration/1E3).toString()){I=!1;break}}I||(Y="0");return Y}static F5d(z,Y,m){z=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',z,m);Y=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',Y);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',z,Y)}static xSa(z,
Y,m,I,X,ta,Fa){return Object.assign(new Cd.a,{Id:z,ExternalId:Y,Icon:m,Command:I,QueryCommand:X,LabelText:ta,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Fa})}}Object(h.a)(Eb,"TransitionActor",null,[365]);var fc=d(1024);class mc{constructor(){this.effectId=this.effectType=0;this.labelText=this.Se=this.Fn=this.Un=null}}Object(h.a)(mc,"AnimInfo",null,[]);class Mc{constructor(){this.Ij=this.labelText=this.Se=this.id=null}}Object(h.a)(Mc,"EffectOption",
null,[]);class nd extends Mc{constructor(){super();this.value=null}}Object(h.a)(nd,"EffectData",Mc,[]);class ba{constructor(z){this.UVa=z;ba.Gl||(ba.Gl=new fc.a,ba.Gl.add("FromBottom",Object.assign(new Mc,{id:"FromBottom",Se:ba.ef("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,Ij:CommonUIStrings.l_AnimationFromBottomKeytip})),ba.Gl.add("FromBottomLeft",Object.assign(new Mc,{id:"FromBottomLeft",Se:ba.ef("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,
Ij:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),ba.Gl.add("FromLeft",Object.assign(new Mc,{id:"FromLeft",Se:ba.ef("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Ij:CommonUIStrings.l_AnimationFromLeftKeytip})),ba.Gl.add("FromTopLeft",Object.assign(new Mc,{id:"FromTopLeft",Se:ba.ef("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Ij:CommonUIStrings.l_AnimationFromTopLeftKeytip})),ba.Gl.add("FromTop",Object.assign(new Mc,
{id:"FromTop",Se:ba.ef("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Ij:CommonUIStrings.l_AnimationFromTopKeytip})),ba.Gl.add("FromTopRight",Object.assign(new Mc,{id:"FromTopRight",Se:ba.ef("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,Ij:CommonUIStrings.l_AnimationFromTopRightKeytip})),ba.Gl.add("FromRight",Object.assign(new Mc,{id:"FromRight",Se:ba.ef("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,
Ij:CommonUIStrings.l_AnimationFromRightKeytip})),ba.Gl.add("FromBottomRight",Object.assign(new Mc,{id:"FromBottomRight",Se:ba.ef("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Ij:CommonUIStrings.l_AnimationFromBottomRightKeytip})),ba.Gl.add("ToBottom",Object.assign(new Mc,{id:"ToBottom",Se:ba.ef("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Ij:CommonUIStrings.l_AnimationFromBottomKeytip})),ba.Gl.add("ToBottomLeft",
Object.assign(new Mc,{id:"ToBottomLeft",Se:ba.ef("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Ij:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),ba.Gl.add("ToLeft",Object.assign(new Mc,{id:"ToLeft",Se:ba.ef("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,Ij:CommonUIStrings.l_AnimationFromLeftKeytip})),ba.Gl.add("ToTopLeft",Object.assign(new Mc,{id:"ToTopLeft",Se:ba.ef("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,
Ij:CommonUIStrings.l_AnimationFromTopLeftKeytip})),ba.Gl.add("ToTop",Object.assign(new Mc,{id:"ToTop",Se:ba.ef("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Ij:CommonUIStrings.l_AnimationFromTopKeytip})),ba.Gl.add("ToTopRight",Object.assign(new Mc,{id:"ToTopRight",Se:ba.ef("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Ij:CommonUIStrings.l_AnimationFromTopRightKeytip})),ba.Gl.add("ToRight",Object.assign(new Mc,{id:"ToRight",
Se:ba.ef("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,Ij:CommonUIStrings.l_AnimationFromRightKeytip})),ba.Gl.add("ToBottomRight",Object.assign(new Mc,{id:"ToBottomRight",Se:ba.ef("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,Ij:CommonUIStrings.l_AnimationFromBottomRightKeytip})),ba.Gl.add("Horizontal",Object.assign(new Mc,{id:"Horizontal",Se:ba.ef("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,
Ij:CommonUIStrings.l_AnimationHorizontalKeytip})),ba.Gl.add("HorizontalIn",Object.assign(new Mc,{id:"HorizontalIn",Se:ba.ef("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Ij:CommonUIStrings.l_AnimationHorizontalInKeytip})),ba.Gl.add("HorizontalOut",Object.assign(new Mc,{id:"HorizontalOut",Se:ba.ef("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,Ij:CommonUIStrings.l_AnimationHorizontalOutKeytip})),ba.Gl.add("Vertical",
Object.assign(new Mc,{id:"Vertical",Se:ba.ef("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Ij:CommonUIStrings.l_AnimationVerticalKeytip})),ba.Gl.add("VerticalIn",Object.assign(new Mc,{id:"VerticalIn",Se:ba.ef("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,Ij:CommonUIStrings.l_AnimationVerticalInKeytip})),ba.Gl.add("VerticalOut",Object.assign(new Mc,{id:"VerticalOut",Se:ba.ef("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,
Ij:CommonUIStrings.l_AnimationVerticalOutKeytip})),ba.Gl.add("LeftDown",Object.assign(new Mc,{id:"LeftDown",Se:ba.ef("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Ij:CommonUIStrings.l_AnimationLeftDownKeytip})),ba.Gl.add("LeftUp",Object.assign(new Mc,{id:"LeftUp",Se:ba.ef("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,Ij:CommonUIStrings.l_AnimationLeftUpKeytip})),ba.Gl.add("RightDown",Object.assign(new Mc,{id:"RightDown",
Se:ba.ef("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,Ij:CommonUIStrings.l_AnimationRightDownKeytip})),ba.Gl.add("RightUp",Object.assign(new Mc,{id:"RightUp",Se:ba.ef("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,Ij:CommonUIStrings.l_AnimationRightUpKeytip})),ba.Gl.add("In",Object.assign(new Mc,{id:"In",Se:ba.ef("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionIn,Ij:CommonUIStrings.l_AnimationInKeytip})),
ba.Gl.add("InBottom",Object.assign(new Mc,{id:"InBottom",Se:ba.ef("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Ij:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),ba.Gl.add("InCenter",Object.assign(new Mc,{id:"InCenter",Se:ba.ef("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,Ij:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),ba.Gl.add("InSlightly",Object.assign(new Mc,{id:"InSlightly",Se:ba.ef("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Ij:CommonUIStrings.l_AnimationInSlightlyKeytip})),ba.Gl.add("Out",Object.assign(new Mc,{id:"Out",Se:ba.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Ij:CommonUIStrings.l_AnimationOutKeytip})),ba.Gl.add("OutBottom",Object.assign(new Mc,{id:"OutBottom",Se:ba.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,Ij:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),ba.Gl.add("OutCenter",
Object.assign(new Mc,{id:"OutCenter",Se:ba.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,Ij:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),ba.Gl.add("OutSlightly",Object.assign(new Mc,{id:"OutSlightly",Se:ba.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,Ij:CommonUIStrings.l_AnimationOutSlightlyKeytip})),ba.Gl.add("FloatUp",Object.assign(new Mc,{id:"FloatUp",Se:ba.ef("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,
Ij:CommonUIStrings.l_AnimationOutKeytip})),ba.Gl.add("FloatDown",Object.assign(new Mc,{id:"FloatDown",Se:ba.ef("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Ij:CommonUIStrings.l_AnimationDownKeytip})),ba.Gl.add("ObjectCenter",Object.assign(new Mc,{id:"ObjectCenter",Se:ba.ef("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Ij:CommonUIStrings.l_AnimationObjectCenterKeytip})),ba.Gl.add("SlideCenter",Object.assign(new Mc,
{id:"SlideCenter",Se:ba.ef("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Ij:CommonUIStrings.l_AnimationSlideCenterKeytip})),ba.Gl.add("ObjectCenterOut",Object.assign(new Mc,{id:"ObjectCenterOut",Se:ba.ef("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Ij:CommonUIStrings.l_AnimationObjectCenterKeytip})),ba.Gl.add("SlideCenterOut",Object.assign(new Mc,{id:"SlideCenterOut",Se:ba.ef("AnimEffectPropFadedZoomInFromCenter"),
labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Ij:CommonUIStrings.l_AnimationSlideCenterKeytip})),ba.Gl.add("Clockwise",Object.assign(new Mc,{id:"Clockwise",Se:ba.ef("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Ij:CommonUIStrings.l_AnimationClockWiseKeytip})),ba.Gl.add("CounterClockwise",Object.assign(new Mc,{id:"CounterClockwise",Se:ba.ef("AnimEffectPropCounterclockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Ij:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),
ba.Gl.add("Across",Object.assign(new Mc,{id:"Across",Se:ba.ef("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Ij:CommonUIStrings.l_AnimationAcrossKeytip})),ba.Gl.add("Up",Object.assign(new Mc,{id:"Up",Se:ba.ef("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,Ij:CommonUIStrings.l_AnimationUpKeytip})),ba.Gl.add("Down",Object.assign(new Mc,{id:"Down",Se:ba.ef("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,
Ij:CommonUIStrings.l_AnimationDownKeytip})),ba.Gl.add("GrowShrinkHorizontal",Object.assign(new Mc,{id:"GrowShrinkHorizontal",Se:ba.ef("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Ij:CommonUIStrings.l_AnimationHorizontalKeytip})),ba.Gl.add("GrowShrinkVertical",Object.assign(new Mc,{id:"GrowShrinkVertical",Se:ba.ef("AnimEffectPropGrowShrinkVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Ij:CommonUIStrings.l_AnimationVerticalKeytip})),
ba.Gl.add("GrowShrinkBoth",Object.assign(new Mc,{id:"GrowShrinkBoth",Se:ba.ef("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Ij:CommonUIStrings.l_AnimationBothKeytip})));ba.bT||(ba.bT=new fc.a,ba.bT.add("Spin_Quarter",Object.assign(new nd,{id:"Spin_Quarter",Se:ba.ef("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Ij:CommonUIStrings.l_AnimationQuarterSpinKeytip})),ba.bT.add("Spin_Half",Object.assign(new nd,{id:"Spin_Half",Se:ba.ef("AnimEffectPropHalfSpin"),
labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Ij:CommonUIStrings.l_AnimationHalfSpinKeytip})),ba.bT.add("Spin_Full",Object.assign(new nd,{id:"Spin_Full",Se:ba.ef("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Ij:CommonUIStrings.l_AnimationFullSpinKeytip})),ba.bT.add("Spin_Two",Object.assign(new nd,{id:"Spin_Two",Se:ba.ef("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,value:"720",Ij:CommonUIStrings.l_AnimationTwoSpinKeytip})),
ba.bT.add("Transparency_25",Object.assign(new nd,{id:"Transparency_25",Se:ba.ef("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Ij:CommonUIStrings.l_Animation25PerKeytip})),ba.bT.add("Transparency_50",Object.assign(new nd,{id:"Transparency_50",Se:ba.ef("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",Ij:CommonUIStrings.l_Animation50PerKeytip})),ba.bT.add("Transparency_75",Object.assign(new nd,
{id:"Transparency_75",Se:ba.ef("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",Ij:CommonUIStrings.l_Animation75PerKeytip})),ba.bT.add("Transparency_100",Object.assign(new nd,{id:"Transparency_100",Se:ba.ef("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Ij:CommonUIStrings.l_Animation100PerKeytip})),ba.bT.add("GrowShrink_Tiny",Object.assign(new nd,{id:"GrowShrink_Tiny",Se:ba.ef("AnimEffectPropTiny"),
labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Ij:CommonUIStrings.l_AnimationTinyKeytip})),ba.bT.add("GrowShrink_Smaller",Object.assign(new nd,{id:"GrowShrink_Smaller",Se:ba.ef("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",Ij:CommonUIStrings.l_AnimationSmallerKeytip})),ba.bT.add("GrowShrink_Larger",Object.assign(new nd,{id:"GrowShrink_Larger",Se:ba.ef("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,
value:"150",Ij:CommonUIStrings.l_AnimationLargerKeytip})),ba.bT.add("GrowShrink_Huge",Object.assign(new nd,{id:"GrowShrink_Huge",Se:ba.ef("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Ij:CommonUIStrings.l_AnimationHugeKeytip})));if(!ba.im)if(ba.im=new fc.a,ba.im.add("Existing",Object.assign(new mc,{effectType:-1,effectId:-1,Se:ba.ef("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,Un:[],Fn:[]})),ba.im.add("None",Object.assign(new mc,{effectType:0,
effectId:0,Se:ba.ef("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,Un:[],Fn:[]})),ba.im.add("Appear",Object.assign(new mc,{effectType:0,effectId:1,Se:ba.ef("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,Un:[],Fn:[]})),ba.im.add("FadeIn",Object.assign(new mc,{effectType:0,effectId:10,Se:ba.ef("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,Un:[],Fn:[]})),this.UVa){ba.im.add("FlyIn",Object.assign(new mc,{effectType:0,effectId:2,Se:ba.ef("AnimFxEntranceFlyIn"),
labelText:ResourceStrings.L_AnimationFlyIn,Un:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),Fn:[]}));ba.im.add("Wipe",Object.assign(new mc,{effectType:0,effectId:22,Se:ba.ef("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,Un:["FromBottom","FromLeft","FromRight","FromTop"],Fn:[]}));ba.im.add("Zoom",Object.assign(new mc,{effectType:0,effectId:53,Se:ba.ef("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,
Un:["ObjectCenter","SlideCenter"],Fn:[]}));ba.im.add("Checkerboard",Object.assign(new mc,{effectType:0,effectId:5,Se:ba.ef("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,Un:["Across","Down"],Fn:[]}));ba.im.add("BasicZoom",Object.assign(new mc,{effectType:0,effectId:23,Se:ba.ef("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,Un:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),Fn:[]}));ba.im.add("Blinds",Object.assign(new mc,{effectType:0,
effectId:3,Se:ba.ef("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,Un:["Horizontal","Vertical"],Fn:[]}));let Y;ba.im.add("Box",(Y=new mc,Y.effectType=0,Y.effectId=4,Y.Se=ba.ef("AnimFxEntranceShape"),Y.labelText=ResourceStrings.L_AnimationBox,Y.Un=["In","Out"],Y.Fn=[],Y));let m;ba.im.add("PeekIn",(m=new mc,m.effectType=0,m.effectId=12,m.Se=ba.ef("AnimFxEntranceGeneric"),m.labelText=ResourceStrings.L_AnimationPeekIn,m.Un=["FromBottom","FromLeft","FromRight","FromTop"],m.Fn=[],
m));let I;ba.im.add("Expand",(I=new mc,I.effectType=0,I.effectId=55,I.Se=ba.ef("AnimFxEntranceGeneric"),I.labelText=ResourceStrings.L_AnimationExpand,I.Un=[],I.Fn=[],I));let X;ba.im.add("GrowAndTurn",(X=new mc,X.effectType=0,X.effectId=31,X.Se=ba.ef("AnimFxEntranceGrowAndTurn"),X.labelText=ResourceStrings.L_AnimationGrowAndTurn,X.Un=[],X.Fn=[],X));let ta;ba.im.add("RandomBars",(ta=new mc,ta.effectType=0,ta.effectId=14,ta.Se=ba.ef("AnimFxEntranceRandomBars"),ta.labelText=ResourceStrings.L_AnimationRandomBars,
ta.Un=["Horizontal","Vertical"],ta.Fn=[],ta));let Fa;ba.im.add("RiseUp",(Fa=new mc,Fa.effectType=0,Fa.effectId=37,Fa.Se=ba.ef("AnimFxEntranceGeneric"),Fa.labelText=ResourceStrings.L_AnimationRiseUp,Fa.Un=[],Fa.Fn=[],Fa));let bb;ba.im.add("Split",(bb=new mc,bb.effectType=0,bb.effectId=16,bb.Se=ba.ef("AnimFxEntranceSplit"),bb.labelText=ResourceStrings.L_AnimationSplit,bb.Un=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],bb.Fn=[],bb));let yb;ba.im.add("Strips",(yb=new mc,yb.effectType=0,
yb.effectId=18,yb.Se=ba.ef("AnimFxEntranceGeneric"),yb.labelText=ResourceStrings.L_AnimationStrips,yb.Un=["LeftDown","LeftUp","RightDown","RightUp"],yb.Fn=[],yb));let Bb;ba.im.add("Stretch",(Bb=new mc,Bb.effectType=0,Bb.effectId=17,Bb.Se=ba.ef("AnimFxEntranceGeneric"),Bb.labelText=ResourceStrings.L_AnimationStretch,Bb.Un=["Across","FromBottom","FromLeft","FromRight","FromTop"],Bb.Fn=[],Bb));let pb;ba.im.add("Exit_Disappear",(pb=new mc,pb.effectType=1,pb.effectId=1,pb.Se=ba.ef("AnimFxExitDisappear"),
pb.labelText=ResourceStrings.L_AnimationDisappear,pb.Un=[],pb.Fn=[],pb));let Ob;ba.im.add("Exit_Fade",(Ob=new mc,Ob.effectType=1,Ob.effectId=10,Ob.Se=ba.ef("AnimFxExitFadeOut"),Ob.labelText=ResourceStrings.L_AnimationFade,Ob.Un=[],Ob.Fn=[],Ob));let sc;ba.im.add("Exit_FlyOut",(sc=new mc,sc.effectType=1,sc.effectId=2,sc.Se=ba.ef("AnimFxExitFlyOut"),sc.labelText=ResourceStrings.L_AnimationFlyOut,sc.Un="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),sc.Fn=[],
sc));let wc;ba.im.add("Exit_Wipe",(wc=new mc,wc.effectType=1,wc.effectId=22,wc.Se=ba.ef("AnimFxExitWipe"),wc.labelText=ResourceStrings.L_AnimationWipe,wc.Un=["FromBottom","FromLeft","FromRight","FromTop"],wc.Fn=[],wc));let Lb;ba.im.add("Exit_Zoom",(Lb=new mc,Lb.effectType=1,Lb.effectId=53,Lb.Se=ba.ef("AnimFxExitFadedZoom"),Lb.labelText=ResourceStrings.L_AnimationZoom,Lb.Un=["ObjectCenterOut","SlideCenterOut"],Lb.Fn=[],Lb));let $b;ba.im.add("Exit_Checkerboard",($b=new mc,$b.effectType=1,$b.effectId=
5,$b.Se=ba.ef("AnimFxExitGeneric"),$b.labelText=ResourceStrings.L_AnimationCheckerboard,$b.Un=["Across","Up"],$b.Fn=[],$b));let Oc;ba.im.add("Exit_BasicZoom",(Oc=new mc,Oc.effectType=1,Oc.effectId=23,Oc.Se=ba.ef("AnimFxExitGeneric"),Oc.labelText=ResourceStrings.L_AnimationBasicZoom,Oc.Un="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),Oc.Fn=[],Oc));let md;ba.im.add("Exit_Blinds",(md=new mc,md.effectType=1,md.effectId=3,md.Se=ba.ef("AnimFxExitGeneric"),md.labelText=ResourceStrings.L_AnimationBlinds,
md.Un=["Horizontal","Vertical"],md.Fn=[],md));let zd;ba.im.add("Exit_Box",(zd=new mc,zd.effectType=1,zd.effectId=4,zd.Se=ba.ef("AnimFxExitShape"),zd.labelText=ResourceStrings.L_AnimationBox,zd.Un=["In","Out"],zd.Fn=[],zd));let le;ba.im.add("Exit_PeekOut",(le=new mc,le.effectType=1,le.effectId=12,le.Se=ba.ef("AnimFxExitGeneric"),le.labelText=ResourceStrings.L_AnimationPeekOut,le.Un=["ToBottom","ToLeft","ToRight","ToTop"],le.Fn=[],le));let df;ba.im.add("Exit_RandomBars",(df=new mc,df.effectType=1,df.effectId=
14,df.Se=ba.ef("AnimFxExitRandomBars"),df.labelText=ResourceStrings.L_AnimationRandomBars,df.Un=["Horizontal","Vertical"],df.Fn=[],df));let bf;ba.im.add("Exit_Split",(bf=new mc,bf.effectType=1,bf.effectId=16,bf.Se=ba.ef("AnimFxExitSplit"),bf.labelText=ResourceStrings.L_AnimationSplit,bf.Un=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],bf.Fn=[],bf));let Hg;ba.im.add("Exit_Strips",(Hg=new mc,Hg.effectType=1,Hg.effectId=18,Hg.Se=ba.ef("AnimFxExitGeneric"),Hg.labelText=ResourceStrings.L_AnimationStrips,
Hg.Un=["LeftDown","LeftUp","RightDown","RightUp"],Hg.Fn=[],Hg));let Yh;ba.im.add("Exit_Stretchy",(Yh=new mc,Yh.effectType=1,Yh.effectId=17,Yh.Se=ba.ef("AnimFxExitGeneric"),Yh.labelText=ResourceStrings.L_AnimationStretchy,Yh.Un=[],Yh.Fn=[],Yh));let Hi;ba.im.add("Exit_Zoom",(Hi=new mc,Hi.effectType=1,Hi.effectId=53,Hi.Se=ba.ef("AnimFxExitFadedZoom"),Hi.labelText=ResourceStrings.L_AnimationZoom,Hi.Un=["ObjectCenterOut","SlideCenterOut"],Hi.Fn=[],Hi));let kf;ba.im.add("Emphasis_Spin",(kf=new mc,kf.effectType=
2,kf.effectId=8,kf.Se=ba.ef("AnimFxEmphasisSpin"),kf.labelText=ResourceStrings.L_AnimationSpin,kf.Un=["Clockwise","CounterClockwise"],kf.Fn=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],kf));let ej;ba.im.add("Emphasis_Transparency",(ej=new mc,ej.effectType=2,ej.effectId=9,ej.Se=ba.ef("AnimFxEmphasisTransparency"),ej.labelText=ResourceStrings.L_AnimationTransparency,ej.Un=[],ej.Fn=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],ej));let wi;ba.im.add("Emphasis_GrowShrink",
(wi=new mc,wi.effectType=2,wi.effectId=6,wi.Se=ba.ef("AnimFxEmphasisGrowShrink"),wi.labelText=ResourceStrings.L_AnimationGrowShrink,wi.Un=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],wi.Fn=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],wi));let Qg;ba.im.add("Emphasis_FillColor",(Qg=new mc,Qg.effectType=2,Qg.effectId=1,Qg.Se=ba.ef("AnimFxEmphasisChangeFillColor"),Qg.labelText=ResourceStrings.L_AnimationFillColor,Qg.Un=[],Qg.Fn=[],Qg));let Jk;ba.im.add("Emphasis_FontColor",
(Jk=new mc,Jk.effectType=2,Jk.effectId=3,Jk.Se=ba.ef("AnimFxEmphasisChangeFontColor"),Jk.labelText=ResourceStrings.L_AnimationFontColor,Jk.Un=[],Jk.Fn=[],Jk));let km;ba.im.add("Emphasis_LineColor",(km=new mc,km.effectType=2,km.effectId=7,km.Se=ba.ef("AnimFxEmphasisChangeLineColor"),km.labelText=ResourceStrings.L_AnimationLineColor,km.Un=[],km.Fn=[],km))}else ba.im.add("FlyIn",Object.assign(new mc,{effectType:0,effectId:2,Se:ba.ef("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,Un:["FromBottom",
"FromLeft","FromTop","FromRight"],Fn:[]}))}k5b(z,Y){let m=null;ba.im.forEach((I,X)=>{X.effectType===z&&X.effectId===Y&&(m=X);return!0});return m}QUc(z,Y){let m=null;ba.im.forEach((I,X)=>{X.effectType===z&&X.effectId===Y&&(m=I);return!0});return m}sUc(z,Y,m,I,X){const ta=Object.assign(new xi.a,{Id:"MenuSectionEffectOptions"+m,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});z=this.k5b(Y,z);if(!z)return ta;if((z=ba.b$i(z,m))&&z.length)for(Y=0;Y<z.length;Y++){const Fa=
ba.c$i(z[Y],m),bb="AnimationEffectOptions"+("Direction"===m?"Direction":"Data")+Fa.id;Array.add(ta.ControlList,Object.assign(new La.a,{Command:I,Id:Fa.id,ExternalId:bb,QueryCommand:X}))}return ta}PSc(z){var Y;return(Y=ba.im.ga(z))?(z=Y.effectType,Y=Y.effectId,{returnValue:!0,effectType:z,effectId:Y}):{returnValue:!1,effectType:-1,effectId:-1}}QSc(z){let Y,m;Y=ba.ef("AnimFxMultiple");m=ResourceStrings.L_AnimationExisting;if(z=ba.im.ga(z))Y=z.Se,m=z.labelText;return{image:Y,label:m}}BZc(z,Y){if(0===
z){if(0!==Y&&1!==Y&&2!==Y&&10!==Y)return!0}else if(0<z)return!0;return!1}Kab(z,Y){return z&&Y?this.UVa?(Y=Y.yab()?z.IsTrigger:z.HasTrigger,!!this.k5b(z.EffectType,z.EffectId)&&!Y):!z.HasExisting:!0}s0c(z){return z?this.wzb(Array(z)):!0}wzb(z){if(!z||!z.length)return!0;for(const Y of z)if(null==this.k5b(Y.EffectType,Y.EffectId))return!1;return!0}jle(z,Y){return Y&&z&&this.UVa?Y.yab()?!1:z.HasMultiple:!1}S9b(z){if(!z||!z.length)return!1;const Y=z[0].EffectId,m=z[0].EffectType;for(let I=1;I<z.length;I++){const X=
z[I];if(X.EffectId!=Y||X.EffectType!=m)return!0}return!1}Whg(z){if(z&&this.UVa&&2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}fne(z){if(!z)return!1;if(2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}T8i(z){z=ba.im.ga(z);return this.I5b(z.Un[0])}Q8i(z){return(z=ba.im.ga(z))&&z.Fn.length?this.n7d(z.Fn[0]):""}I5b(z){switch(z){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;
case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;
case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;default:return 0}}n7d(z){return(z=ba.bT.ga(z))?
z.value:""}bIf(z,Y){return(Y=ba.bT.ga(Y))&&parseFloat(z)===parseFloat(Y.value)?!0:!1}w$d(z){switch(z){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}bqi(z){if(null===z)throw Error.argumentNull("animation");const Y=this.k5b(z.EffectType,z.EffectId);return!!Y&&(0<Y.Un.length||0<Y.Fn.length||this.Whg(z))}cqi(z){if(!z)return!1;const Y=this.k5b(z.EffectType,z.EffectId);return!!Y&&(0<Y.Un.length||0<Y.Fn.length||this.fne(z))}dqi(z,
Y,m){return this.Kab(m,z)&&!this.jle(m,z)&&(this.bqi(m)||this.yDf(z,Y,m)||this.yUd(z,Y,m)||this.wDf(z,Y,m)||this.zUd(z,m))}eqi(z,Y,m){if(!(z&&Y&&m&&m.length&&this.wzb(m)))return!1;z=ba.eKf(z,m);Y=this.zDf(Y,z)||this.BDf(Y,z)||this.xDf(Y,z)||this.DDf(z);let I;this.S9b(m)||(I=this.cqi(m[0]));return I||Y}Nhj(z,Y,m){const I=Object.assign(new xi.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",ControlList:[]});this.yDf(z,Y,m)&&Array.add(I.ControlList,
Object.assign(new La.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.wDf(z,Y,m)&&this.UVa&&Array.add(I.ControlList,Object.assign(new La.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.yUd(z,Y,m)&&Array.add(I.ControlList,Object.assign(new La.a,{Command:"3467781846",Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));
this.zUd(z,m)&&Array.add(I.ControlList,Object.assign(new La.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return I}Ohj(z,Y,m){const I=new xi.a;I.Id="MenuSectionEffectOptionsSequence";I.ControlsId="MenuSectionEffectOptionsSequence.Controls";I.DisplayMode="Menu32";I.ControlList=[];if(!(z&&z.length&&Y&&m&&m.length))return I;z=ba.eKf(z,m);this.zDf(Y,z)&&(m=new La.a,m.Command="1850236812",m.Id="AsOneObject",m.ExternalId="AnimationEffectOptionsSequenceAsOneObject",
m.QueryCommand="1125291975",I.ControlList.push(m));this.xDf(Y,z)&&(m=new La.a,m.Command="2048458448",m.Id="AllAtOnce",m.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",m.QueryCommand="1125291975",I.ControlList.push(m));this.BDf(Y,z)&&(Y=new La.a,Y.Command="3467781846",Y.Id="ByParagraph",Y.ExternalId="AnimationEffectOptionsSequenceByParagraph",Y.QueryCommand="1125291975",I.ControlList.push(Y));this.DDf(z)&&(Y=new La.a,Y.Command="1486892994",Y.Id="OneByOne",Y.ExternalId="AnimationEffectOptionsSequenceOneByOne",
Y.QueryCommand="1125291975",I.ControlList.push(Y));return I}ZUj(z){let Y=!0,m=0;if(!z)return!1;for(const I of z)if(Y)m=I.EffectId,Y=!1;else if(I.EffectId!==m)return!1;return!0}yej(z,Y,m){const I={isEnabled:!1,old:null};if(!z||!Y||!Y.length)return I;z=ba.Idj(z);if(!z.length||ba.oKj(z))return I;const X=z.map(ta=>ta.EffectNodeId);Y=Y.map(ta=>ta.EffectNodeId).sort((ta,Fa)=>ta-Fa);if(!ba.lVj(Y,X))return I;if(m){m=X.indexOf(Y[Y.length-1]);if(-1==m||m==X.length-1)return I;I.isEnabled=!0;I.old=ba.A8f(z[m+
1])}else{m=X.indexOf(Y[0]);if(-1==m||0==m)return I;I.isEnabled=!0;I.old=ba.A8f(z[m-1])}return I}static eKf(z,Y){const m=new Map;for(const I of z)m.set(I.id.toString(),I);z=new Map;for(const I of Y)Y=Jc.a.Gf(I.ShapeId),Y=m.get(Y.toString()),z.set(I,Y);return z}static A8f(z){const Y=new lf;Y.EffectNodeId=z.EffectNodeId;Y.ShapeId=z.ShapeId;return Y}static lVj(z,Y){if(!(z&&z.length&&Y&&Y.length)||z.length>Y.length)return!1;const m=z[z.length-1],I=Y.indexOf(z[0]);return Y.indexOf(m)-I+1==z.length}static Idj(z){const Y=
[];if(!z)return Y;z=z.hW;if(!z||!z.Sequences)return Y;for(const m of z.Sequences[0].Effects)Y.push(m);return Y.sort((m,I)=>m.EffectNodeId-I.EffectNodeId)}static oKj(z){if(!z)return!1;const Y=new Set;for(const m of z){z=`${m.ShapeId}${m.GroupId}`;if(Y.has(z))return!0;Y.add(z)}return!1}yDf(z,Y,m){return 0!==m.SequenceId&&0!==m.EffectId&&this.Kab(m,z)&&(z.Qf||2!==m.EffectType||1!==m.EffectId&&7!==m.EffectId)&&(z.m4||this.zUd(z,m)||this.yUd(z,Y,m))}gqi(z,Y,m){return z&&0!==m.BuildType&&0!==m.EffectId&&
this.s0c(m)&&(z.Qf||2!==m.EffectType||1!==m.EffectId&&7!==m.EffectId)&&(z.m4||this.CDf(z,m)||this.ADf(z,Y,m))}zDf(z,Y){for(let [m,I]of Y)if(!this.gqi(I,z,m))return!1;return!0}wDf(z,Y,m){return 0!==m.SequenceId&&!z.m4&&!z.ud&&0!==m.EffectId&&this.Kab(m,z)&&(z.Qf||2!==m.EffectType||1!==m.EffectId&&7!==m.EffectId)&&(z.fl||z.Qf||z.isEditable&&0<Y.rda(z).length)}fqi(z,Y,m){return z&&0!==m.BuildType&&!z.m4&&!z.ud&&0!==m.EffectId&&this.s0c(m)&&(z.Qf||2!==m.EffectType||1!==m.EffectId&&7!==m.EffectId)&&(z.fl||
z.Qf||z.isEditable&&0<Y.rda(z).length)}xDf(z,Y){for(let [m,I]of Y)if(!this.fqi(I,z,m))return!1;return!0}yUd(z,Y,m){return 0!==m.SequenceId&&!z.Qf&&!z.m4&&!z.ud&&0!==m.EffectId&&this.Kab(m,z)&&(2!==m.EffectType||1!==m.EffectId&&7!==m.EffectId)&&(z.fl||z.isEditable&&0<Y.rda(z).length)}ADf(z,Y,m){return z&&0!==m.BuildType&&!z.Qf&&!z.m4&&!z.ud&&0!==m.EffectId&&this.s0c(m)&&(2!==m.EffectType||1!==m.EffectId&&7!==m.EffectId)&&(z.fl||z.isEditable&&0<Y.rda(z).length)}BDf(z,Y){for(let [m,I]of Y)if(!this.ADf(I,
z,m))return!1;return!0}zUd(z,Y){return 0!==Y.SequenceId&&z.Qf&&0!==Y.EffectId&&this.Kab(Y,z)}CDf(z,Y){return z&&0!==Y.BuildType&&z.Qf&&0!==Y.EffectId&&this.s0c(Y)}DDf(z){for(let [Y,m]of z)if(!this.CDf(m,Y))return!1;return!0}static ef(z){return Ge.a.Ulc+"_"+z+"_32x32x32"}static b$i(z,Y){switch(Y){case "Direction":return z.Un;case "EffectData":return z.Fn;default:return null}}static c$i(z,Y){switch(Y){case "Direction":return ba.Gl.ga(z);case "EffectData":return ba.bT.ga(z);default:return null}}}ba.Gl=
null;ba.bT=null;ba.im=null;Object(h.a)(ba,"AnimationHelper",null,[651]);class Aa{constructor(z,Y,m,I,X,ta,Fa){this.kE=null;this.k1e=!1;this.CHa=m;this.pa=z;(this.yva=I)&&X.execute(bb=>{this.kE=bb});this.ta=Fa;this.ia=Y;this.jma=ta}selectShape(){this.pa&&!this.pa.jX(this.ta)&&this.pa.selectShape(this.ta,!0)}onVolumeChanged(z){const Y={ActionFromPlayer:!0};.2>=z?(Y.SourceControlId="SetVolumeLow",this.ia.La(Bc.a.fqd,2,Y)):.2<z&&.8>z?(Y.SourceControlId="SetVolumeMedium",this.ia.La(Bc.a.gqd,2,Y)):.8<=
z&&(Y.SourceControlId="SetVolumeHigh",this.ia.La(Bc.a.eqd,2,Y));this.selectShape()}onPlayToggled(z){const Y={ActionFromPlayer:!0};z?this.ia.La(Bc.a.mIc,2,Y):this.ia.La(Bc.a.KZb,2,Y);this.selectShape()}onMuteToggled(z){if(z)this.ia.La(Bc.a.hqd,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ta.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(z){z&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(z){z||
this.pa.vme(this.ta)||(z=this.jL())&&z.showHidePlayer(!1)}onPlayerClicked(){this.yva&&this.ia.processAction(Bc.a.fPb,2)}onPlayerError(z){bd.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",z);z&&-1<z.indexOf("PIPELINE_ERROR_READ")&&this.CHa.b9d(this.jma.podSessionId,this.ta).then(Y=>{const m=this.jL();m&&m.setAudioSrc(Y)})}onKeyDown(z){z===ng.a.lmb?(z=this.jL())&&z.removeFocusFromPlayer():z===ng.a.Sq&&(this.k1e=!0)}onBlur(){const z=this.jL();z&&(this.k1e?z.setFocusOnPlayer():
z.removeFocusFromPlayer());this.k1e=!1}jL(){return this.yva&&this.kE?this.kE.jL(this.ta):null}}Object(h.a)(Aa,"AudioLibraryCallback",null,[667]);class Wa{constructor(z,Y,m,I,X,ta){this.CHa=z;this.pa=Y;this.ia=m;this.yva=I;this.pcb=ta;this.jma=X}jDi(z){return new Aa(this.pa,this.ia,this.CHa,this.yva,this.pcb,this.jma,z)}}Object(h.a)(Wa,"AudioLibraryCallbackFactory",null,[543]);class gb{constructor(z,Y,m,I){this.volume=z;this.mute=Y;this.repeat=m;this.rewind=I}}Object(h.a)(gb,"MediaProperties",null,
[]);class nb{constructor(z,Y,m,I){this.m7j=z;this.Uye=Y;this.CHa=m;this.jma=I}createAudioManager(z,Y,m){return new Promise((I,X)=>{this.Uye("audioPlayback").then(()=>{window.self.audioPlayback?(bd.a.J(512497818,801,50,"audio script is loaded successfully"),I(this.kDi(z,Y,m))):(bd.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),X("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(ta=>{bd.a.J(512497817,
801,10,"Failed to load audio script "+ta.toString());X("Failed to load audio script ")})})}kDi(z,Y,m){const I=Y.media;let X=null;I&&(X=new gb(I.vlmField,I.mteField,I.repeatField,I.rewindField));const ta=audioPlayback.pptAudioFactoryGlobal.createAudioManager(z,m,this.m7j.jDi(Y),X);this.CHa.b9d(this.jma.podSessionId,Y).then(Fa=>{ta&&ta.setAudioSrc(Fa)});return ta}}Object(h.a)(nb,"AudioManagerFactory",null,[544]);var lc=d(1256);class jd{constructor(){this.DBb=new lc.a}VUk(z,Y){Y&&this.DBb.$(Y.id,z)}DGh(z){z&&
this.DBb.Gb(z.id)&&(this.DBb.ga(z.id).dispose(),this.DBb.remove(z.id))}jL(z){return z&&this.DBb.Gb(z.id)?this.DBb.ga(z.id):null}}Object(h.a)(jd,"AudioManagerStore",null,[542]);class xd{HYj(z){return!xd.$wb(xd.fKl)||z>xd.C6e?!0:!1}static $wb(z){return(z=document.getElementById(z))?z:null}}xd.fKl="PptRibbon.Design.ThemeVariants-MaxSize";xd.C6e=4;Object(h.a)(xd,"ThemeHelper",null,[647]);class Kc{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=0}}Object(h.a)(Kc,
"EditTransitionInfo",null,[]);class Zc{constructor(){this.next=this.parent=this.tc=this.Ix=this.uc=this.pc=null}}Object(h.a)(Zc,"Transition",null,[]);class Sc{}Sc.none=0;Sc.l0i=5;Sc.m0i=4;Sc.Owl=1;Sc.Oqj=1;Sc.$ii=2;Sc.D8=0;Sc.sSa=1;Sc.PDa=2;Sc.iwb=3;Sc.rRc=4;Sc.qRc=5;Sc.uRc=6;Sc.tRc=7;Sc.CVc=2;Sc.pUa=1;Sc.Dqj=1;Sc.HTd=0;Sc.Ymi=1;Sc.Xmi=2;Sc.Fqj=0;Sc.Eqj=1;Sc.j$f=2;Sc.Pqj=3;Sc.obe=0;Sc.m7b=1;Sc.BVc=0;Sc.B$a=1;Sc.tji=1;Sc.mAf=0;Sc.myh=2;Sc.eql=0;Sc.Qwl=3;Sc.Pwl=1;Sc.wheel=1;Sc.Tmh=29;Sc.gZf=0;Sc.C1i=
1;Sc.L1i=2;Sc.V1i=3;Sc.fZf=8;Sc.B1i=9;Sc.K1i=10;Sc.U1i=11;Sc.hZf=12;Sc.F1i=13;Sc.N1i=14;Sc.Y1i=15;Sc.iZf=4;Sc.G1i=5;Sc.O1i=6;Sc.Z1i=7;Sc.M1i=0;Sc.W1i=1;Sc.Q1i=2;Sc.D1i=3;Sc.bZf=4;Sc.X1i=5;Sc.R1i=6;Sc.E1i=7;Object(h.a)(Sc,"TransitionEffectOptions",null,[]);class ld{constructor(z,Y){let m=0;this.Ac=new fc.a;this.YGa=Y;this.Ac.$("TransitionExisting",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionExisting,uc:ld.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Ac.$("TransitionExistingInMenu",
Object.assign(new Zc,{pc:ResourceStrings.L_TransitionExisting,uc:ld.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Ac.$("TransitionNone",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionNone,uc:ld.Gc("TransitionNone"),tc:Object.assign(new Kc,{TransitionType:Qa.none,Direction:Sc.$ii,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Ac.$("TransitionFade",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFade,uc:ld.Gc("TransitionFadeSmoothly"),tc:Object.assign(new Kc,
{TransitionType:Qa.Ewf,Direction:Sc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Ac.$("TransitionFadeSmoothly",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionSmoothly,Ix:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,uc:ld.Gc("TransitionFadeSmoothly"),tc:Object.assign(new Kc,{TransitionType:Qa.Ewf,Direction:Sc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Ac.$("TransitionFadeThroughBlack",
Object.assign(new Zc,{pc:ResourceStrings.L_TransitionThroughBlack,Ix:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,uc:ld.Gc("TransitionFadeThroughBlack"),tc:Object.assign(new Kc,{TransitionType:Qa.fade,Direction:Sc.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let I=[];if(z){I=z.toLowerCase().split(",");for(let X=0;X<I.length;X++)I[X]=I[X].trim()}Array.contains(I,"push")||(this.Ac.$("TransitionPush",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionPush,uc:ld.Gc("TransitionPushUp"),
tc:Object.assign(new Kc,{TransitionType:Qa.push,Direction:Sc.sSa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Ac.$("TransitionPushFromBottom",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromBottom,Ix:CommonUIStrings.l_TransitionPushFromBottomKeytip,uc:ld.Gc("TransitionPushUp"),tc:Object.assign(new Kc,{TransitionType:Qa.push,Direction:Sc.sSa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Ac.$("TransitionPushFromLeft",
Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromLeft,Ix:CommonUIStrings.l_TransitionPushFromLeftKeytip,uc:ld.Gc("TransitionPushRight"),tc:Object.assign(new Kc,{TransitionType:Qa.push,Direction:Sc.PDa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),this.Ac.$("TransitionPushFromRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromRight,Ix:CommonUIStrings.l_TransitionPushFromRightKeytip,uc:ld.Gc("TransitionPushLeft"),tc:Object.assign(new Kc,
{TransitionType:Qa.push,Direction:Sc.D8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Ac.$("TransitionPushFromTop",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTop,Ix:CommonUIStrings.l_TransitionPushFromTopKeytip,uc:ld.Gc("TransitionPushDown"),tc:Object.assign(new Kc,{TransitionType:Qa.push,Direction:Sc.iwb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(I,"cut")||(this.Ac.$("TransitionCut",Object.assign(new Zc,
{pc:ResourceStrings.L_TransitionCut,uc:ld.Gc("TransitionCut"),tc:Object.assign(new Kc,{TransitionType:Qa.cut,Direction:Sc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Ac.$("TransitionCutNone",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionNone,Ix:CommonUIStrings.l_TransitionCutNoneKeytip,uc:ld.Gc("TransitionCut"),tc:Object.assign(new Kc,{TransitionType:Qa.cut,Direction:Sc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),
this.Ac.$("TransitionCutThroughBlack",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionThroughBlack,Ix:CommonUIStrings.l_TransitionCutThroughBlackKeytip,uc:ld.Gc("TransitionCutThroughBlack"),tc:Object.assign(new Kc,{TransitionType:Qa.cut,Direction:Sc.Owl,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(I,"wipe")||(this.Ac.$("TransitionWipe",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionWipe,uc:ld.Gc("TransitionWipeLeft"),tc:Object.assign(new Kc,{TransitionType:Qa.wipe,
Direction:Sc.D8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Ac.$("TransitionWipeFromRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromRight,Ix:CommonUIStrings.l_TransitionWipeFromRightKeytip,uc:ld.Gc("TransitionWipeLeft"),tc:Object.assign(new Kc,{TransitionType:Qa.wipe,Direction:Sc.D8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Ac.$("TransitionWipeFromTop",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTop,
Ix:CommonUIStrings.l_TransitionWipeFromTopKeytip,uc:ld.Gc("TransitionWipeDown"),tc:Object.assign(new Kc,{TransitionType:Qa.wipe,Direction:Sc.iwb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Ac.$("TransitionWipeFromLeft",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromLeft,Ix:CommonUIStrings.l_TransitionWipeFromLeftKeytip,uc:ld.Gc("TransitionWipeRight"),tc:Object.assign(new Kc,{TransitionType:Qa.wipe,Direction:Sc.PDa,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Ac.$("TransitionWipeFromBottom",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromBottom,Ix:CommonUIStrings.l_TransitionWipeFromBottomKeytip,uc:ld.Gc("TransitionWipeUp"),tc:Object.assign(new Kc,{TransitionType:Qa.wipe,Direction:Sc.sSa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Ac.$("TransitionWipeFromTopRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTopRight,
Ix:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,uc:ld.Gc("TransitionStripsLeftDown"),tc:Object.assign(new Kc,{TransitionType:Qa.pwd,Direction:Sc.uRc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Ac.$("TransitionWipeFromBottomRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromBottomRight,Ix:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,uc:ld.Gc("TransitionStripsLeftUp"),tc:Object.assign(new Kc,{TransitionType:Qa.pwd,
Direction:Sc.rRc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Ac.$("TransitionWipeFromTopLeft",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTopLeft,Ix:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,uc:ld.Gc("TransitionStripsRightDown"),tc:Object.assign(new Kc,{TransitionType:Qa.pwd,Direction:Sc.tRc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Ac.$("TransitionWipeFromBottomLeft",
Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromBottomLeft,Ix:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,uc:ld.Gc("TransitionStripsRightUp"),tc:Object.assign(new Kc,{TransitionType:Qa.pwd,Direction:Sc.qRc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));this.YGa&&Wd.a("MorphTransitionActionAIEnabled")&&this.Ac.$("TransitionMorphActionAI",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionMorph,uc:ld.Gc("TransitionByObject"),tc:Object.assign(new Kc,{TransitionType:Qa.morph,
Direction:Sc.HTd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"}));Array.contains(I,"morph")||(this.Ac.$("TransitionMorph",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionMorph,uc:ld.Gc("TransitionByObject"),tc:Object.assign(new Kc,{TransitionType:Qa.morph,Direction:Sc.HTd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Ac.$("TransitionMorphByObject",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionByObject,
Ix:CommonUIStrings.l_TransitionMorphObjectsKeytip,uc:ld.Gc("TransitionByObject"),tc:Object.assign(new Kc,{TransitionType:Qa.morph,Direction:Sc.HTd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Ac.$("TransitionMorphByWord",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionByWord,Ix:CommonUIStrings.l_TransitionMorphWordsKeytip,uc:ld.Gc("TransitionByWord"),tc:Object.assign(new Kc,{TransitionType:Qa.morph,Direction:Sc.Ymi,Duration:2E3,IsManualAdvance:!0}),
parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Ac.$("TransitionMorphByChar",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionByChar,Ix:CommonUIStrings.l_TransitionMorphCharactersKeytip,uc:ld.Gc("TransitionByChar"),tc:Object.assign(new Kc,{TransitionType:Qa.morph,Direction:Sc.Xmi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(I,"split")||(this.Ac.$("TransitionSplit",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionSplit,uc:ld.Gc("TransitionSplitOutVertical"),
tc:Object.assign(new Kc,{TransitionType:Qa.split,Direction:Sc.j$f,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),this.Ac.$("TransitionSplitVerticalOut",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionVerticalOut,Ix:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,uc:ld.Gc("TransitionSplitOutVertical"),tc:Object.assign(new Kc,{TransitionType:Qa.split,Direction:Sc.j$f,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),
this.Ac.$("TransitionSplitHorizontalIn",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionHorizontalIn,Ix:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,uc:ld.Gc("TransitionSplitInHorizontal"),tc:Object.assign(new Kc,{TransitionType:Qa.split,Direction:Sc.Eqj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Ac.$("TransitionSplitHorizontalOut",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionHorizontalOut,Ix:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,
uc:ld.Gc("TransitionSplitOutHorizontal"),tc:Object.assign(new Kc,{TransitionType:Qa.split,Direction:Sc.Fqj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Ac.$("TransitionSplitVerticalIn",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionVerticalIn,Ix:CommonUIStrings.l_TransitionSplitVerticalInKeytip,uc:ld.Gc("TransitionSplitInVertical"),tc:Object.assign(new Kc,{TransitionType:Qa.split,Direction:Sc.Pqj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));
if(!Array.contains(I,"randombars")){this.Ac.$("TransitionRandomBars",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionRandomBars,uc:ld.Gc("TransitionRandomBarsVertical"),tc:Object.assign(new Kc,{TransitionType:Qa.TPe,Direction:Sc.B$a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));this.Ac.$("TransitionRandomBarsVertical",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionVertical,Ix:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,uc:ld.Gc("TransitionRandomBarsVertical"),
tc:Object.assign(new Kc,{TransitionType:Qa.TPe,Direction:Sc.B$a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let X,ta;this.Ac.$("TransitionRandomBarsHorizontal",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionHorizontal,ta.Ix=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,ta.uc=ld.Gc("TransitionRandomBarsHorizontal"),ta.tc=(X=new Kc,X.TransitionType=Qa.TPe,X.Direction=Sc.BVc,X.Duration=1E3,X.IsManualAdvance=!0,X),ta.parent="TransitionRandomBars",
ta))}if(!Array.contains(I,"shape")){let X,ta;this.Ac.$("TransitionShape",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionShape,ta.uc=ld.Gc("TransitionShapeCircle"),ta.tc=(X=new Kc,X.TransitionType=Qa.Gth,X.Direction=Sc.none,X.Duration=800,X.IsManualAdvance=!0,X),ta.parent="TransitionShape",ta.next="TransitionShapeCircle",ta));let Fa,bb;this.Ac.$("TransitionShapeCircle",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionCircle,bb.Ix=CommonUIStrings.l_TransitionShapeCircleKeytip,bb.uc=ld.Gc("TransitionShapeCircle"),
bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.Gth,Fa.Direction=Sc.none,Fa.Duration=800,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionShape",bb.next="TransitionShapeDiamond",bb));let yb,Bb;this.Ac.$("TransitionShapeDiamond",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionDiamond,Bb.Ix=CommonUIStrings.l_TransitionShapeDiamondKeytip,Bb.uc=ld.Gc("TransitionShapeDiamond"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.vhl,yb.Direction=Sc.none,yb.Duration=800,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionShape",Bb.next=
"TransitionShapePlus",Bb));let pb,Ob;this.Ac.$("TransitionShapePlus",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionPlus,Ob.Ix=CommonUIStrings.l_TransitionShapePlusKeytip,Ob.uc=ld.Gc("TransitionShapePlus"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.Ahl,pb.Direction=Sc.none,pb.Duration=1E3,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionShape",Ob.next="TransitionShapeIn",Ob));let sc,wc;this.Ac.$("TransitionShapeIn",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionIn,wc.Ix=CommonUIStrings.l_TransitionShapeInKeytip,
wc.uc=ld.Gc("TransitionBoxIn"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.Jth,sc.Direction=Sc.m7b,sc.Duration=1200,sc.IsManualAdvance=!0,sc),wc.parent="TransitionShape",wc.next="TransitionShapeOut",wc));let Lb,$b;this.Ac.$("TransitionShapeOut",($b=new Zc,$b.pc=ResourceStrings.L_TransitionOut,$b.Ix=CommonUIStrings.l_TransitionShapeOutKeytip,$b.uc=ld.Gc("TransitionBoxOut"),$b.tc=(Lb=new Kc,Lb.TransitionType=Qa.Jth,Lb.Direction=Sc.obe,Lb.Duration=1200,Lb.IsManualAdvance=!0,Lb),$b.parent="TransitionShape",
$b))}if(!Array.contains(I,"reveal")){let X,ta;this.Ac.$("TransitionReveal",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionReveal,ta.uc=ld.Gc("TransitionRevealSmoothlyFromRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.wpc,X.Direction=Sc.myh,X.Duration=3400,X.IsManualAdvance=!0,X),ta.parent="TransitionReveal",ta.next="TransitionRevealSmoothlyFromRight",ta));let Fa,bb;this.Ac.$("TransitionRevealSmoothlyFromRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionSmoothlyFromRight,bb.uc=ld.Gc("TransitionRevealSmoothlyFromRight"),
bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.wpc,Fa.Direction=Sc.myh,Fa.Duration=3400,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionReveal",bb.next="TransitionRevealSmoothlyFromLeft",bb));let yb,Bb;this.Ac.$("TransitionRevealSmoothlyFromLeft",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionSmoothlyFromLeft,Bb.uc=ld.Gc("TransitionRevealSmoothlyFromLeft"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.wpc,yb.Direction=Sc.eql,yb.Duration=3400,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionReveal",Bb.next="TransitionRevealFromRight",
Bb));let pb,Ob;this.Ac.$("TransitionRevealFromRight",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionThroughBlackFromRight,Ob.uc=ld.Gc("TransitionRevealFromRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.wpc,pb.Direction=Sc.Qwl,pb.Duration=3400,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionReveal",Ob.next="TransitionRevealFromLeft",Ob));let sc,wc;this.Ac.$("TransitionRevealFromLeft",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionThroughBlackFromLeft,wc.uc=ld.Gc("TransitionRevealFromLeft"),wc.tc=(sc=new Kc,
sc.TransitionType=Qa.wpc,sc.Direction=Sc.Pwl,sc.Duration=3400,sc.IsManualAdvance=!0,sc),wc.parent="TransitionReveal",wc))}if(!Array.contains(I,"cover")){let X,ta;this.Ac.$("TransitionCover",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionCover,ta.uc=ld.Gc("TransitionCoverLeft"),ta.tc=(X=new Kc,X.TransitionType=Qa.GCa,X.Direction=Sc.D8,X.Duration=1E3,X.IsManualAdvance=!0,X),ta.parent="TransitionCover",ta.next="TransitionCoverFromRight",ta));let Fa,bb;this.Ac.$("TransitionCoverFromRight",(bb=new Zc,bb.pc=
ResourceStrings.L_TransitionFromRight,bb.uc=ld.Gc("TransitionCoverLeft"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.GCa,Fa.Direction=Sc.D8,Fa.Duration=1E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionCover",bb.next="TransitionCoverFromTop",bb));let yb,Bb;this.Ac.$("TransitionCoverFromTop",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromTop,Bb.uc=ld.Gc("TransitionCoverDown"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.GCa,yb.Direction=Sc.iwb,yb.Duration=1E3,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionCover",
Bb.next="TransitionCoverFromLeft",Bb));let pb,Ob;this.Ac.$("TransitionCoverFromLeft",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromLeft,Ob.uc=ld.Gc("TransitionCoverRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.GCa,pb.Direction=Sc.PDa,pb.Duration=1E3,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionCover",Ob.next="TransitionCoverFromBottom",Ob));let sc,wc;this.Ac.$("TransitionCoverFromBottom",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromBottom,wc.uc=ld.Gc("TransitionCoverUp"),wc.tc=(sc=new Kc,
sc.TransitionType=Qa.GCa,sc.Direction=Sc.sSa,sc.Duration=1E3,sc.IsManualAdvance=!0,sc),wc.parent="TransitionCover",wc.next="TransitionCoverFromTopRight",wc));let Lb,$b;this.Ac.$("TransitionCoverFromTopRight",($b=new Zc,$b.pc=ResourceStrings.L_TransitionFromTopRight,$b.uc=ld.Gc("TransitionCoverLeftDown"),$b.tc=(Lb=new Kc,Lb.TransitionType=Qa.GCa,Lb.Direction=Sc.uRc,Lb.Duration=1E3,Lb.IsManualAdvance=!0,Lb),$b.parent="TransitionCover",$b.next="TransitionCoverFromBottomRight",$b));let Oc,md;this.Ac.$("TransitionCoverFromBottomRight",
(md=new Zc,md.pc=ResourceStrings.L_TransitionFromBottomRight,md.uc=ld.Gc("TransitionCoverLeftUp"),md.tc=(Oc=new Kc,Oc.TransitionType=Qa.GCa,Oc.Direction=Sc.rRc,Oc.Duration=1E3,Oc.IsManualAdvance=!0,Oc),md.parent="TransitionCover",md.next="TransitionCoverFromTopLeft",md));let zd,le;this.Ac.$("TransitionCoverFromTopLeft",(le=new Zc,le.pc=ResourceStrings.L_TransitionFromTopLeft,le.uc=ld.Gc("TransitionCoverRightDown"),le.tc=(zd=new Kc,zd.TransitionType=Qa.GCa,zd.Direction=Sc.tRc,zd.Duration=1E3,zd.IsManualAdvance=
!0,zd),le.parent="TransitionCover",le.next="TransitionCoverFromBottomLeft",le));let df,bf;this.Ac.$("TransitionCoverFromBottomLeft",(bf=new Zc,bf.pc=ResourceStrings.L_TransitionFromBottomLeft,bf.uc=ld.Gc("TransitionCoverRightUp"),bf.tc=(df=new Kc,df.TransitionType=Qa.GCa,df.Direction=Sc.qRc,df.Duration=1E3,df.IsManualAdvance=!0,df),bf.parent="TransitionCover",bf))}if(!Array.contains(I,"uncover")){let X,ta;this.Ac.$("TransitionUncover",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionUncover,ta.uc=ld.Gc("TransitionUncoverLeft"),
ta.tc=(X=new Kc,X.TransitionType=Qa.kMa,X.Direction=Sc.D8,X.Duration=750,X.IsManualAdvance=!0,X),ta.parent="TransitionUncover",ta.next="TransitionUncoverFromRight",ta));let Fa,bb;this.Ac.$("TransitionUncoverFromRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromRight,bb.uc=ld.Gc("TransitionUncoverLeft"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.kMa,Fa.Direction=Sc.D8,Fa.Duration=750,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionUncover",bb.next="TransitionUncoverFromTop",bb));let yb,Bb;this.Ac.$("TransitionUncoverFromTop",
(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromTop,Bb.uc=ld.Gc("TransitionUncoverDown"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.kMa,yb.Direction=Sc.iwb,yb.Duration=750,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionUncover",Bb.next="TransitionUncoverFromLeft",Bb));let pb,Ob;this.Ac.$("TransitionUncoverFromLeft",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromLeft,Ob.uc=ld.Gc("TransitionUncoverRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.kMa,pb.Direction=Sc.PDa,pb.Duration=750,pb.IsManualAdvance=
!0,pb),Ob.parent="TransitionUncover",Ob.next="TransitionUncoverFromBottom",Ob));let sc,wc;this.Ac.$("TransitionUncoverFromBottom",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromBottom,wc.uc=ld.Gc("TransitionUncoverUp"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.kMa,sc.Direction=Sc.sSa,sc.Duration=750,sc.IsManualAdvance=!0,sc),wc.parent="TransitionUncover",wc.next="TransitionUncoverFromTopRight",wc));this.Ac.$("TransitionUncoverFromTopRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTopRight,
uc:ld.Gc("TransitionUncoverLeftDown"),tc:Object.assign(new Kc,{TransitionType:Qa.kMa,Direction:Sc.uRc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Ac.$("TransitionUncoverFromBottomRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromBottomRight,uc:ld.Gc("TransitionUncoverLeftUp"),tc:Object.assign(new Kc,{TransitionType:Qa.kMa,Direction:Sc.rRc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));
this.Ac.$("TransitionUncoverFromTopLeft",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTopLeft,uc:ld.Gc("TransitionUncoverRightDown"),tc:Object.assign(new Kc,{TransitionType:Qa.kMa,Direction:Sc.tRc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Ac.$("TransitionUncoverFromBottomLeft",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromBottomLeft,uc:ld.Gc("TransitionUncoverRightUp"),tc:Object.assign(new Kc,{TransitionType:Qa.kMa,
Direction:Sc.qRc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(I,"menusectionexciting")){if(!Array.contains(I,"fallover")){this.Ac.$("TransitionFallOver",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFallOver,uc:ld.Gc("TransitionFallOverLeft"),tc:Object.assign(new Kc,{TransitionType:Qa.w3d,Direction:Sc.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let X,ta;this.Ac.$("TransitionFallOverLeft",(ta=new Zc,
ta.pc=ResourceStrings.L_TransitionGoLeft,ta.uc=ld.Gc("TransitionFallOverLeft"),ta.tc=(X=new Kc,X.TransitionType=Qa.w3d,X.Direction=Sc.none,X.Duration=2E3,X.IsManualAdvance=!0,X),ta.parent="TransitionFallOver",ta.next="TransitionFallOverRight",ta));let Fa,bb;this.Ac.$("TransitionFallOverRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionGoRight,bb.uc=ld.Gc("TransitionFallOverRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.w3d,Fa.Direction=Sc.pUa,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionFallOver",
bb))}if(!Array.contains(I,"drape")){let X,ta;this.Ac.$("TransitionDrape",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionDrape,ta.uc=ld.Gc("TransitionDrapeLeft"),ta.tc=(X=new Kc,X.TransitionType=Qa.d1d,X.Direction=Sc.none,X.Duration=2E3,X.IsManualAdvance=!0,X),ta.parent="TransitionDrape",ta.next="TransitionDrapeLeft",ta));let Fa,bb;this.Ac.$("TransitionDrapeLeft",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionGoLeft,bb.uc=ld.Gc("TransitionDrapeLeft"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.d1d,Fa.Direction=
Sc.none,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionDrape",bb.next="TransitionDrapeRight",bb));let yb,Bb;this.Ac.$("TransitionDrapeRight",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionGoRight,Bb.uc=ld.Gc("TransitionDrapeRight"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.d1d,yb.Direction=Sc.pUa,yb.Duration=2E3,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionDrape",Bb))}if(!Array.contains(I,"curtains")){let X,ta;this.Ac.$("TransitionCurtains",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionCurtains,
ta.uc=ld.Gc("TransitionCurtains"),ta.tc=(X=new Kc,X.TransitionType=Qa.dKi,X.Direction=Sc.none,X.Duration=6E3,X.IsManualAdvance=!0,X),ta.parent="TransitionCurtains",ta))}if(!Array.contains(I,"wind")){let X,ta;this.Ac.$("TransitionWind",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionWind,ta.uc=ld.Gc("TransitionWindRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.V6e,X.Direction=Sc.none,X.Duration=2E3,X.IsManualAdvance=!0,X),ta.parent="TransitionWind",ta.next="TransitionWindRight",ta));let Fa,bb;this.Ac.$("TransitionWindRight",
(bb=new Zc,bb.pc=ResourceStrings.L_TransitionGoRight,bb.uc=ld.Gc("TransitionWindRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.V6e,Fa.Direction=Sc.none,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionWind",bb.next="TransitionWindLeft",bb));let yb,Bb;this.Ac.$("TransitionWindLeft",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionGoLeft,Bb.uc=ld.Gc("TransitionWindLeft"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.V6e,yb.Direction=Sc.pUa,yb.Duration=2E3,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionWind",
Bb))}if(!Array.contains(I,"prestige")){let X,ta;this.Ac.$("TransitionPrestige",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionPrestige,ta.uc=ld.Gc("TransitionPrestige"),ta.tc=(X=new Kc,X.TransitionType=Qa.DKk,X.Direction=Sc.none,X.Duration=2E3,X.IsManualAdvance=!0,X),ta.parent="TransitionPrestige",ta))}if(!Array.contains(I,"fracture")){let X,ta;this.Ac.$("TransitionFracture",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionFracture,ta.uc=ld.Gc("TransitionFracture"),ta.tc=(X=new Kc,X.TransitionType=Qa.k1i,
X.Direction=Sc.none,X.Duration=2E3,X.IsManualAdvance=!0,X),ta.parent="TransitionFracture",ta))}if(!Array.contains(I,"crush")){let X,ta;this.Ac.$("TransitionCrush",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionCrush,ta.uc=ld.Gc("TransitionCrush"),ta.tc=(X=new Kc,X.TransitionType=Qa.tJi,X.Direction=Sc.none,X.Duration=2E3,X.IsManualAdvance=!0,X),ta.parent="TransitionCrush",ta))}if(!Array.contains(I,"peeloff")){let X,ta;this.Ac.$("TransitionPeelOff",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionPeelOff,
ta.uc=ld.Gc("TransitionPeelOffLeft"),ta.tc=(X=new Kc,X.TransitionType=Qa.NKe,X.Direction=Sc.none,X.Duration=1250,X.IsManualAdvance=!0,X),ta.parent="TransitionPeelOff",ta.next="TransitionPeelOffLeft",ta));let Fa,bb;this.Ac.$("TransitionPeelOffLeft",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionGoLeft,bb.uc=ld.Gc("TransitionPeelOffLeft"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.NKe,Fa.Direction=Sc.none,Fa.Duration=1250,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionPeelOff",bb.next="TransitionPeelOffRight",
bb));let yb,Bb;this.Ac.$("TransitionPeelOffRight",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionGoRight,Bb.uc=ld.Gc("TransitionPeelOffRight"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.NKe,yb.Direction=Sc.pUa,yb.Duration=1250,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionPeelOff",Bb))}if(!Array.contains(I,"pagecurl")){let X,ta;this.Ac.$("TransitionPageCurl",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionPageCurl,ta.uc=ld.Gc("TransitionTwoPageCurlFromRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.hKe,X.Direction=
Sc.none,X.Duration=1250,X.IsManualAdvance=!0,X),ta.parent="TransitionPageCurl",ta.next="TransitionPageCurlDoubleLeft",ta));let Fa,bb;this.Ac.$("TransitionPageCurlDoubleLeft",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionEffectOptionDoubleLeft,bb.uc=ld.Gc("TransitionTwoPageCurlFromRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.hKe,Fa.Direction=Sc.none,Fa.Duration=1250,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionPageCurl",bb.next="TransitionPageCurlDoubleRight",bb));let yb,Bb;this.Ac.$("TransitionPageCurlDoubleRight",
(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionEffectOptionDoubleRight,Bb.uc=ld.Gc("TransitionTwoPageCurlFromLeft"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.hKe,yb.Direction=Sc.pUa,yb.Duration=1250,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionPageCurl",Bb.next="TransitionPageCurlSingleLeft",Bb));let pb,Ob;this.Ac.$("TransitionPageCurlSingleLeft",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionEffectOptionSingleLeft,Ob.uc=ld.Gc("TransitionPageCurlFromRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.q9g,pb.Direction=
Sc.none,pb.Duration=1250,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionPageCurl",Ob.next="TransitionPageCurlSingleRight",Ob));let sc,wc;this.Ac.$("TransitionPageCurlSingleRight",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionEffectOptionSingleRight,wc.uc=ld.Gc("TransitionPageCurlFromLeft"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.q9g,sc.Direction=Sc.pUa,sc.Duration=1250,sc.IsManualAdvance=!0,sc),wc.parent="TransitionPageCurl",wc))}if(!Array.contains(I,"airplane")){let X,ta;this.Ac.$("TransitionAirplane",
(ta=new Zc,ta.pc=ResourceStrings.L_TransitionAirplane,ta.uc=ld.Gc("TransitionAirplaneRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.PQd,X.Direction=Sc.none,X.Duration=1250,X.IsManualAdvance=!0,X),ta.parent="TransitionAirplane",ta.next="TransitionAirplaneRight",ta));let Fa,bb;this.Ac.$("TransitionAirplaneRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionGoRight,bb.uc=ld.Gc("TransitionAirplaneRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.PQd,Fa.Direction=Sc.none,Fa.Duration=1250,Fa.IsManualAdvance=!0,
Fa),bb.parent="TransitionAirplane",bb.next="TransitionAirplaneLeft",bb));let yb,Bb;this.Ac.$("TransitionAirplaneLeft",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionGoLeft,Bb.uc=ld.Gc("TransitionAirplaneLeft"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.PQd,yb.Direction=Sc.pUa,yb.Duration=1250,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionAirplane",Bb))}if(!Array.contains(I,"origami")){let X,ta;this.Ac.$("TransitionOrigami",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionOrigami,ta.uc=ld.Gc("TransitionOrigamiRight"),
ta.tc=(X=new Kc,X.TransitionType=Qa.WJe,X.Direction=Sc.none,X.Duration=3250,X.IsManualAdvance=!0,X),ta.parent="TransitionOrigami",ta.next="TransitionOrigamiRight",ta));let Fa,bb;this.Ac.$("TransitionOrigamiRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionGoRight,bb.uc=ld.Gc("TransitionOrigamiRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.WJe,Fa.Direction=Sc.none,Fa.Duration=3250,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionOrigami",bb.next="TransitionOrigamiLeft",bb));let yb,Bb;this.Ac.$("TransitionOrigamiLeft",
(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionGoLeft,Bb.uc=ld.Gc("TransitionOrigamiLeft"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.WJe,yb.Direction=Sc.pUa,yb.Duration=3250,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionOrigami",Bb))}Array.contains(I,"dissolve")||this.Ac.$("TransitionDissolve",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionDissolve,uc:ld.Gc("TransitionDissolve"),tc:Object.assign(new Kc,{TransitionType:Qa.dissolve,Direction:Sc.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));
Array.contains(I,"checker")||(this.Ac.$("TransitionChecker",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionChecker,uc:ld.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new Kc,{TransitionType:Qa.AVd,Direction:Sc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Ac.$("TransitionCheckerFromLeft",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromLeft,uc:ld.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new Kc,{TransitionType:Qa.AVd,
Direction:Sc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Ac.$("TransitionCheckerFromTop",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTop,uc:ld.Gc("TransitionCheckerboardDown"),tc:Object.assign(new Kc,{TransitionType:Qa.AVd,Direction:Sc.Dqj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(I,"blinds")){this.Ac.$("TransitionBlinds",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionBlinds,
uc:ld.Gc("TransitionBlindsVertical"),tc:Object.assign(new Kc,{TransitionType:Qa.blinds,Direction:Sc.mAf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let X,ta;this.Ac.$("TransitionBlindsVertical",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionVertical,ta.uc=ld.Gc("TransitionBlindsVertical"),ta.tc=(X=new Kc,X.TransitionType=Qa.blinds,X.Direction=Sc.mAf,X.Duration=1600,X.IsManualAdvance=!0,X),ta.parent="TransitionBlinds",ta.next="TransitionBlindsHorizontal",
ta));let Fa,bb;this.Ac.$("TransitionBlindsHorizontal",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionHorizontal,bb.uc=ld.Gc("TransitionBlindsHorizontal"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.blinds,Fa.Direction=Sc.tji,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionBlinds",bb))}if(!Array.contains(I,"wheel")){let X,ta;this.Ac.$("TransitionWheel",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionWheel,ta.uc=ld.Gc("TransitionWheelClockwise1"),ta.tc=(X=new Kc,X.TransitionType=Qa.wheel,X.Direction=
Sc.wheel,X.Duration=1E3,X.IsManualAdvance=!0,X),ta.parent="TransitionWheel",ta.next="TransitionWheelClockwise",ta));let Fa,bb;this.Ac.$("TransitionWheelClockwise",(bb=new Zc,bb.pc=ResourceStrings.l_TransitionWheelClockWise,bb.uc=ld.Gc("TransitionWheelClockwise1"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.wheel,Fa.Direction=Sc.wheel,Fa.Duration=1E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionWheel",bb.next="TransitionWheelCounterclockwise",bb));let yb,Bb;this.Ac.$("TransitionWheelCounterclockwise",
(Bb=new Zc,Bb.pc=ResourceStrings.l_TransitionWheelCounterClockWise,Bb.uc=ld.Gc("TransitionWheelCounterclockwise1"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.CLl,yb.Direction=Sc.wheel,yb.Duration=1E3,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionWheel",Bb.next="TransitionWheelWedge",Bb));let pb,Ob;this.Ac.$("TransitionWheelWedge",(Ob=new Zc,Ob.pc=ResourceStrings.l_TransitionWheelWedge,Ob.uc=ld.Gc("TransitionWedge"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.wedge,pb.Direction=Sc.none,pb.Duration=1E3,pb.IsManualAdvance=
!0,pb),Ob.parent="TransitionWheel",Ob))}if(!Array.contains(I,"ripple")){let X,ta;this.Ac.$("TransitionRipple",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionRipple,ta.uc=ld.Gc("TransitionRipple"),ta.tc=(X=new Kc,X.TransitionType=Qa.ZKb,X.Direction=Sc.Tmh,X.Duration=1400,X.IsManualAdvance=!0,X),ta.parent="TransitionRipple",ta.next="TransitionRippleCenter",ta));let Fa,bb;this.Ac.$("TransitionRippleCenter",(bb=new Zc,bb.pc=ResourceStrings.L_EffectOptionsDirectionCenter,bb.uc=ld.Gc("TransitionRipple"),
bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.ZKb,Fa.Direction=Sc.Tmh,Fa.Duration=1400,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionRipple",bb.next="TransitionRippleBottomLeft",bb));let yb,Bb;this.Ac.$("TransitionRippleBottomLeft",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromBottomLeft,Bb.uc=ld.Gc("TransitionRippleBottomLeft"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.ZKb,yb.Direction=Sc.qRc,yb.Duration=1500,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionRipple",Bb.next="TransitionRippleBottomRight",Bb));
let pb,Ob;this.Ac.$("TransitionRippleBottomRight",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromBottomRight,Ob.uc=ld.Gc("TransitionRippleBottomRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.ZKb,pb.Direction=Sc.rRc,pb.Duration=1500,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionRipple",Ob.next="TransitionRippleTopRight",Ob));let sc,wc;this.Ac.$("TransitionRippleTopRight",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromTopRight,wc.uc=ld.Gc("TransitionRippleTopRight"),wc.tc=(sc=new Kc,sc.TransitionType=
Qa.ZKb,sc.Direction=Sc.uRc,sc.Duration=1500,sc.IsManualAdvance=!0,sc),wc.parent="TransitionRipple",wc.next="TransitionRippleTopLeft",wc));let Lb,$b;this.Ac.$("TransitionRippleTopLeft",($b=new Zc,$b.pc=ResourceStrings.L_TransitionFromTopLeft,$b.uc=ld.Gc("TransitionRippleTopLeft"),$b.tc=(Lb=new Kc,Lb.TransitionType=Qa.ZKb,Lb.Direction=Sc.tRc,Lb.Duration=1500,Lb.IsManualAdvance=!0,Lb),$b.parent="TransitionRipple",$b))}if(!Array.contains(I,"glitter")){let X,ta;this.Ac.$("TransitionGlitter",(ta=new Zc,
ta.pc=ResourceStrings.L_TransitionGlitter,ta.uc=ld.Gc("TransitionGlitterHexagonLeft"),ta.tc=(X=new Kc,X.TransitionType=Qa.DEa,X.Direction=Sc.bZf,X.Duration=3900,X.IsManualAdvance=!0,X),ta.parent="TransitionGlitter",ta.next="TransitionGlitterHexagonLeft",ta));let Fa,bb;this.Ac.$("TransitionGlitterHexagonLeft",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionHexagonsFromLeft,bb.uc=ld.Gc("TransitionGlitterHexagonLeft"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.DEa,Fa.Direction=Sc.bZf,Fa.Duration=3900,Fa.IsManualAdvance=
!0,Fa),bb.parent="TransitionGlitter",bb.next="TransitionGlitterHexagonTop",bb));let yb,Bb;this.Ac.$("TransitionGlitterHexagonTop",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionHexagonsFromTop,Bb.uc=ld.Gc("TransitionGlitterHexagonTop"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.DEa,yb.Direction=Sc.X1i,yb.Duration=3900,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionGlitter",Bb.next="TransitionGlitterHexagonRight",Bb));let pb,Ob;this.Ac.$("TransitionGlitterHexagonRight",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionHexagonsFromRight,
Ob.uc=ld.Gc("TransitionGlitterHexagonRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.DEa,pb.Direction=Sc.R1i,pb.Duration=3900,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionGlitter",Ob.next="TransitionGlitterHexagonBottom",Ob));let sc,wc;this.Ac.$("TransitionGlitterHexagonBottom",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionHexagonsFromBottom,wc.uc=ld.Gc("TransitionGlitterHexagonBottom"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.DEa,sc.Direction=Sc.E1i,sc.Duration=3900,sc.IsManualAdvance=!0,sc),wc.parent=
"TransitionGlitter",wc.next="TransitionGlitterDiamondLeft",wc));let Lb,$b;this.Ac.$("TransitionGlitterDiamondLeft",($b=new Zc,$b.pc=ResourceStrings.L_TransitionDiamondsFromLeft,$b.uc=ld.Gc("TransitionGlitterDiamondLeft"),$b.tc=(Lb=new Kc,Lb.TransitionType=Qa.DEa,Lb.Direction=Sc.M1i,Lb.Duration=3900,Lb.IsManualAdvance=!0,Lb),$b.parent="TransitionGlitter",$b.next="TransitionGlitterDiamondTop",$b));let Oc,md;this.Ac.$("TransitionGlitterDiamondTop",(md=new Zc,md.pc=ResourceStrings.L_TransitionDiamondsFromTop,
md.uc=ld.Gc("TransitionGlitterDiamondTop"),md.tc=(Oc=new Kc,Oc.TransitionType=Qa.DEa,Oc.Direction=Sc.W1i,Oc.Duration=3900,Oc.IsManualAdvance=!0,Oc),md.parent="TransitionGlitter",md.next="TransitionGlitterDiamondRight",md));let zd,le;this.Ac.$("TransitionGlitterDiamondRight",(le=new Zc,le.pc=ResourceStrings.L_TransitionDiamondsFromRight,le.uc=ld.Gc("TransitionGlitterDiamondRight"),le.tc=(zd=new Kc,zd.TransitionType=Qa.DEa,zd.Direction=Sc.Q1i,zd.Duration=3900,zd.IsManualAdvance=!0,zd),le.parent="TransitionGlitter",
le.next="TransitionGlitterDiamondBottom",le));let df,bf;this.Ac.$("TransitionGlitterDiamondBottom",(bf=new Zc,bf.pc=ResourceStrings.L_TransitionDiamondsFromBottom,bf.uc=ld.Gc("TransitionGlitterDiamondBottom"),bf.tc=(df=new Kc,df.TransitionType=Qa.DEa,df.Direction=Sc.D1i,df.Duration=3900,df.IsManualAdvance=!0,df),bf.parent="TransitionGlitter",bf))}if(!Array.contains(I,"vortex")){let X,ta;this.Ac.$("TransitionVortex",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionVortex,ta.uc=ld.Gc("TransitionVortexFromLeft"),
ta.tc=(X=new Kc,X.TransitionType=Qa.wvc,X.Direction=Sc.PDa,X.Duration=4E3,X.IsManualAdvance=!0,X),ta.parent="TransitionVortex",ta.next="TransitionVortexFromLeft",ta));let Fa,bb;this.Ac.$("TransitionVortexFromLeft",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromLeft,bb.uc=ld.Gc("TransitionVortexFromLeft"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.wvc,Fa.Direction=Sc.PDa,Fa.Duration=4E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionVortex",bb.next="TransitionVortexFromTop",bb));let yb,Bb;this.Ac.$("TransitionVortexFromTop",
(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromTop,Bb.uc=ld.Gc("TransitionVortexFromTop"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.wvc,yb.Direction=Sc.iwb,yb.Duration=4E3,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionVortex",Bb.next="TransitionVortexFromRight",Bb));let pb,Ob;this.Ac.$("TransitionVortexFromRight",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromRight,Ob.uc=ld.Gc("TransitionVortexFromRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.wvc,pb.Direction=Sc.D8,pb.Duration=4E3,pb.IsManualAdvance=
!0,pb),Ob.parent="TransitionVortex",Ob.next="TransitionVortexFromBottom",Ob));let sc,wc;this.Ac.$("TransitionVortexFromBottom",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromBottom,wc.uc=ld.Gc("TransitionVortexFromBottom"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.wvc,sc.Direction=Sc.sSa,sc.Duration=4E3,sc.IsManualAdvance=!0,sc),wc.parent="TransitionVortex",wc))}Array.contains(I,"switch")||(this.Ac.$("TransitionSwitch",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionSwitch,uc:ld.Gc("TransitionSwitchRight"),
tc:Object.assign(new Kc,{TransitionType:Qa.$0e,Direction:Sc.CVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Ac.$("TransitionSwitchRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionGoRight,uc:ld.Gc("TransitionSwitchRight"),tc:Object.assign(new Kc,{TransitionType:Qa.$0e,Direction:Sc.CVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Ac.$("TransitionSwitchLeft",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionGoLeft,
uc:ld.Gc("TransitionSwitchLeft"),tc:Object.assign(new Kc,{TransitionType:Qa.$0e,Direction:Sc.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(I,"flip")){this.Ac.$("TransitionFlip",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFlip,uc:ld.Gc("TransitionFlipRight"),tc:Object.assign(new Kc,{TransitionType:Qa.flip,Direction:Sc.CVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Ac.$("TransitionFlipRight",Object.assign(new Zc,
{pc:ResourceStrings.L_TransitionGoRight,uc:ld.Gc("TransitionFlipRight"),tc:Object.assign(new Kc,{TransitionType:Qa.flip,Direction:Sc.CVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let X,ta;this.Ac.$("TransitionFlipLeft",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionGoLeft,ta.uc=ld.Gc("TransitionFlipLeft"),ta.tc=(X=new Kc,X.TransitionType=Qa.flip,X.Direction=Sc.none,X.Duration=1250,X.IsManualAdvance=!0,X),ta.parent="TransitionFlip",ta))}if(!Array.contains(I,
"galleryicon")){let X,ta;this.Ac.$("TransitionGalleryIcon",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionGallery,ta.uc=ld.Gc("TransitionGalleryRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.B5d,X.Direction=Sc.D8,X.Duration=1600,X.IsManualAdvance=!0,X),ta.parent="TransitionGalleryIcon",ta.next="TransitionGalleryIconFromRight",ta));let Fa,bb;this.Ac.$("TransitionGalleryIconFromRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromRight,bb.uc=ld.Gc("TransitionGalleryRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=
Qa.B5d,Fa.Direction=Sc.D8,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionGalleryIcon",bb.next="TransitionGalleryIconFromLeft",bb));let yb,Bb;this.Ac.$("TransitionGalleryIconFromLeft",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromLeft,Bb.uc=ld.Gc("TransitionGalleryLeft"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.B5d,yb.Direction=Sc.PDa,yb.Duration=1600,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionGalleryIcon",Bb))}if(!Array.contains(I,"cube")){let X,ta;this.Ac.$("TransitionCube",
(ta=new Zc,ta.pc=ResourceStrings.L_TransitionCube,ta.uc=ld.Gc("TransitionCubeFromRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.AM,X.Direction=Sc.gZf,X.Duration=1200,X.IsManualAdvance=!0,X),ta.parent="TransitionCube",ta.next="TransitionCubeFromRight",ta));let Fa,bb;this.Ac.$("TransitionCubeFromRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromRight,bb.uc=ld.Gc("TransitionCubeFromRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.AM,Fa.Direction=Sc.gZf,Fa.Duration=1200,Fa.IsManualAdvance=!0,Fa),bb.parent=
"TransitionCube",bb.next="TransitionCubeFromBottom",bb));let yb,Bb;this.Ac.$("TransitionCubeFromBottom",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromBottom,Bb.uc=ld.Gc("TransitionCubeFromBottom"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.AM,yb.Direction=Sc.C1i,yb.Duration=1200,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionCube",Bb.next="TransitionCubeFromLeft",Bb));let pb,Ob;this.Ac.$("TransitionCubeFromLeft",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromLeft,Ob.uc=ld.Gc("TransitionCubeFromLeft"),
Ob.tc=(pb=new Kc,pb.TransitionType=Qa.AM,pb.Direction=Sc.L1i,pb.Duration=1200,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionCube",Ob.next="TransitionCubeFromTop",Ob));let sc,wc;this.Ac.$("TransitionCubeFromTop",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromTop,wc.uc=ld.Gc("TransitionCubeFromTop"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.AM,sc.Direction=Sc.V1i,sc.Duration=1200,sc.IsManualAdvance=!0,sc),wc.parent="TransitionCube",wc))}if(!Array.contains(I,"doors")){let X,ta;this.Ac.$("TransitionDoors",
(ta=new Zc,ta.pc=ResourceStrings.L_TransitionDoors,ta.uc=ld.Gc("TransitionDoorsVertical"),ta.tc=(X=new Kc,X.TransitionType=Qa.W0d,X.Direction=Sc.B$a,X.Duration=1400,X.IsManualAdvance=!0,X),ta.parent="TransitionDoors",ta.next="TransitionDoorsVertical",ta));let Fa,bb;this.Ac.$("TransitionDoorsVertical",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionVertical,bb.uc=ld.Gc("TransitionDoorsVertical"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.W0d,Fa.Direction=Sc.B$a,Fa.Duration=1400,Fa.IsManualAdvance=!0,Fa),bb.parent=
"TransitionDoors",bb.next="TransitionDoorsHorizontal",bb));let yb,Bb;this.Ac.$("TransitionDoorsHorizontal",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionHorizontal,Bb.uc=ld.Gc("TransitionDoorsHorizontal"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.W0d,yb.Direction=Sc.BVc,yb.Duration=1400,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionDoors",Bb))}if(!Array.contains(I,"box")){let X,ta;this.Ac.$("TransitionBox",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionBox,ta.uc=ld.Gc("TransitionBoxFromRight"),ta.tc=(X=
new Kc,X.TransitionType=Qa.AM,X.Direction=Sc.fZf,X.Duration=1600,X.IsManualAdvance=!0,X),ta.parent="TransitionBox",ta.next="TransitionBoxFromRight",ta));let Fa,bb;this.Ac.$("TransitionBoxFromRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromRight,bb.uc=ld.Gc("TransitionBoxFromRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.AM,Fa.Direction=Sc.fZf,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionBox",bb.next="TransitionBoxFromBottom",bb));let yb,Bb;this.Ac.$("TransitionBoxFromBottom",
(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromBottom,Bb.uc=ld.Gc("TransitionBoxFromBottom"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.AM,yb.Direction=Sc.B1i,yb.Duration=1600,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionBox",Bb.next="TransitionBoxFromLeft",Bb));let pb,Ob;this.Ac.$("TransitionBoxFromLeft",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromLeft,Ob.uc=ld.Gc("TransitionBoxFromLeft"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.AM,pb.Direction=Sc.K1i,pb.Duration=1600,pb.IsManualAdvance=!0,pb),
Ob.parent="TransitionBox",Ob.next="TransitionBoxFromTop",Ob));let sc,wc;this.Ac.$("TransitionBoxFromTop",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromTop,wc.uc=ld.Gc("TransitionBoxFromTop"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.AM,sc.Direction=Sc.U1i,sc.Duration=1600,sc.IsManualAdvance=!0,sc),wc.parent="TransitionBox",wc))}if(!Array.contains(I,"comb")){let X,ta;this.Ac.$("TransitionComb",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionComb,ta.uc=ld.Gc("TransitionCombHorizontal"),ta.tc=(X=new Kc,
X.TransitionType=Qa.vWd,X.Direction=Sc.none,X.Duration=1E3,X.IsManualAdvance=!0,X),ta.parent="TransitionComb",ta.next="TransitionCombHorizontal",ta));let Fa,bb;this.Ac.$("TransitionCombHorizontal",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionHorizontal,bb.uc=ld.Gc("TransitionCombHorizontal"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.vWd,Fa.Direction=Sc.BVc,Fa.Duration=1E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionComb",bb.next="TransitionCombVertical",bb));let yb,Bb;this.Ac.$("TransitionCombVertical",
(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionVertical,Bb.uc=ld.Gc("TransitionCombVertical"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.vWd,yb.Direction=Sc.B$a,yb.Duration=1E3,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionComb",Bb))}if(!Array.contains(I,"zoom")){let X,ta;this.Ac.$("TransitionZoom",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionZoom,ta.uc=ld.Gc("TransitionZoomIn"),ta.tc=(X=new Kc,X.TransitionType=Qa.zoom,X.Direction=Sc.m7b,X.Duration=900,X.IsManualAdvance=!0,X),ta.parent="TransitionZoom",
ta.next="TransitionZoomIn",ta));let Fa,bb;this.Ac.$("TransitionZoomIn",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionIn,bb.uc=ld.Gc("TransitionZoomIn"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.zoom,Fa.Direction=Sc.m7b,Fa.Duration=900,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionZoom",bb.next="TransitionZoomOut",bb));let yb,Bb;this.Ac.$("TransitionZoomOut",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionOut,Bb.uc=ld.Gc("TransitionZoomOut"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.zoom,yb.Direction=Sc.obe,
yb.Duration=900,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionZoom",Bb.next="TransitionZoomAndRotate",Bb));let pb,Ob;this.Ac.$("TransitionZoomAndRotate",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionZoomAndRotate,Ob.uc=ld.Gc("TransitionNewsFlash"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.SMl,pb.Direction=Sc.none,pb.Duration=1500,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionZoom",Ob))}if(!Array.contains(I,"random")){let X,ta;this.Ac.$("TransitionRandom",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionRandom,
ta.uc=ld.Gc("TransitionRandom"),ta.tc=(X=new Kc,X.TransitionType=Qa.random,X.Direction=Sc.Oqj,X.Duration=1500,X.IsManualAdvance=!0,X),ta.parent="TransitionRandom",ta))}}if(!Array.contains(I,"menusectiondynamiccontent")){if(!Array.contains(I,"pan")){let X,ta;this.Ac.$("TransitionPan",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionPan,ta.uc=ld.Gc("TransitionPanFromBottom"),ta.tc=(X=new Kc,X.TransitionType=Qa.pan,X.Direction=Sc.sSa,X.Duration=1300,X.IsManualAdvance=!0,X),ta.parent="TransitionPan",ta.next=
"TransitionPanFromBottom",ta));this.Ac.$("TransitionPanFromBottom",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromBottom,uc:ld.Gc("TransitionPanFromBottom"),tc:Object.assign(new Kc,{TransitionType:Qa.pan,Direction:Sc.sSa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Ac.$("TransitionPanFromLeft",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromLeft,uc:ld.Gc("TransitionPanFromLeft"),tc:Object.assign(new Kc,{TransitionType:Qa.pan,Direction:Sc.PDa,
Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Ac.$("TransitionPanFromRight",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromRight,uc:ld.Gc("TransitionPanFromRight"),tc:Object.assign(new Kc,{TransitionType:Qa.pan,Direction:Sc.D8,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Ac.$("TransitionPanFromTop",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionFromTop,uc:ld.Gc("TransitionPanFromTop"),
tc:Object.assign(new Kc,{TransitionType:Qa.pan,Direction:Sc.iwb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(I,"conveyor")){this.Ac.$("TransitionConveyor",Object.assign(new Zc,{pc:ResourceStrings.L_TransitionConveyor,uc:ld.Gc("TransitionConveyorRight"),tc:Object.assign(new Kc,{TransitionType:Qa.JXd,Direction:Sc.D8,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let X,ta;this.Ac.$("TransitionConveyorFromRight",
(ta=new Zc,ta.pc=ResourceStrings.L_TransitionFromRight,ta.uc=ld.Gc("TransitionConveyorRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.JXd,X.Direction=Sc.D8,X.Duration=1600,X.IsManualAdvance=!0,X),ta.parent="TransitionConveyor",ta.next="TransitionConveyorFromLeft",ta));let Fa,bb;this.Ac.$("TransitionConveyorFromLeft",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromLeft,bb.uc=ld.Gc("TransitionConveyorLeft"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.JXd,Fa.Direction=Sc.PDa,Fa.Duration=1600,Fa.IsManualAdvance=
!0,Fa),bb.parent="TransitionConveyor",bb))}if(!Array.contains(I,"rotate")){let X,ta;this.Ac.$("TransitionRotate",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionRotate,ta.uc=ld.Gc("TransitionRotateLeft"),ta.tc=(X=new Kc,X.TransitionType=Qa.AM,X.Direction=Sc.iZf,X.Duration=2E3,X.IsManualAdvance=!0,X),ta.parent="TransitionRotate",ta.next="TransitionRotateFromRight",ta));let Fa,bb;this.Ac.$("TransitionRotateFromRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromRight,bb.uc=ld.Gc("TransitionRotateLeft"),
bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.AM,Fa.Direction=Sc.iZf,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionRotate",bb.next="TransitionRotateFromBottom",bb));let yb,Bb;this.Ac.$("TransitionRotateFromBottom",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromBottom,Bb.uc=ld.Gc("TransitionRotateTop"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.AM,yb.Direction=Sc.G1i,yb.Duration=2E3,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionRotate",Bb.next="TransitionRotateFromLeft",Bb));let pb,Ob;this.Ac.$("TransitionRotateFromLeft",
(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromLeft,Ob.uc=ld.Gc("TransitionRotateRight"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.AM,pb.Direction=Sc.O1i,pb.Duration=2E3,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionRotate",Ob.next="TransitionRotateFromTop",Ob));let sc,wc;this.Ac.$("TransitionRotateFromTop",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromTop,wc.uc=ld.Gc("TransitionRotateBottom"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.AM,sc.Direction=Sc.Z1i,sc.Duration=2E3,sc.IsManualAdvance=!0,sc),
wc.parent="TransitionRotate",wc))}if(!Array.contains(I,"window")){let X,ta;this.Ac.$("TransitionWindow",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionWindow,ta.uc=ld.Gc("TransitionWindowVertical"),ta.tc=(X=new Kc,X.TransitionType=Qa.window,X.Direction=Sc.B$a,X.Duration=1500,X.IsManualAdvance=!0,X),ta.parent="TransitionWindow",ta.next="TransitionWindowVertical",ta));let Fa,bb;this.Ac.$("TransitionWindowVertical",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionVertical,bb.uc=ld.Gc("TransitionWindowVertical"),
bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.window,Fa.Direction=Sc.B$a,Fa.Duration=1500,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionWindow",bb.next="TransitionWindowHorizontal",bb));let yb,Bb;this.Ac.$("TransitionWindowHorizontal",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionHorizontal,Bb.uc=ld.Gc("TransitionWindowHorizontal"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.window,yb.Direction=Sc.BVc,yb.Duration=1500,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionWindow",Bb))}if(!Array.contains(I,"orbit")){let X,
ta;this.Ac.$("TransitionOrbit",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionOrbit,ta.uc=ld.Gc("TransitionOrbitFromRight"),ta.tc=(X=new Kc,X.TransitionType=Qa.AM,X.Direction=Sc.hZf,X.Duration=1600,X.IsManualAdvance=!0,X),ta.parent="TransitionOrbit",ta.next="TransitionOrbitFromRight",ta));let Fa,bb;this.Ac.$("TransitionOrbitFromRight",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionFromRight,bb.uc=ld.Gc("TransitionOrbitFromRight"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.AM,Fa.Direction=Sc.hZf,Fa.Duration=
1600,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionOrbit",bb.next="TransitionOrbitFromBottom",bb));let yb,Bb;this.Ac.$("TransitionOrbitFromBottom",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionFromBottom,Bb.uc=ld.Gc("TransitionOrbitFromBottom"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.AM,yb.Direction=Sc.F1i,yb.Duration=1600,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionOrbit",Bb.next="TransitionOrbitFromLeft",Bb));let pb,Ob;this.Ac.$("TransitionOrbitFromLeft",(Ob=new Zc,Ob.pc=ResourceStrings.L_TransitionFromLeft,
Ob.uc=ld.Gc("TransitionOrbitFromLeft"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.AM,pb.Direction=Sc.N1i,pb.Duration=1600,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionOrbit",Ob.next="TransitionOrbitFromTop",Ob));let sc,wc;this.Ac.$("TransitionOrbitFromTop",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionFromTop,wc.uc=ld.Gc("TransitionOrbitFromTop"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.AM,sc.Direction=Sc.Y1i,sc.Duration=1600,sc.IsManualAdvance=!0,sc),wc.parent="TransitionOrbit",wc))}if(!Array.contains(I,
"flythrough")){let X,ta;this.Ac.$("TransitionFlyThrough",(ta=new Zc,ta.pc=ResourceStrings.L_TransitionFlyThrough,ta.uc=ld.Gc("TransitionFlyThroughIn"),ta.tc=(X=new Kc,X.TransitionType=Qa.M4b,X.Direction=Sc.m7b,X.Duration=800,X.IsManualAdvance=!0,X),ta.parent="TransitionFlyThrough",ta.next="TransitionFlyThroughIn",ta));let Fa,bb;this.Ac.$("TransitionFlyThroughIn",(bb=new Zc,bb.pc=ResourceStrings.L_TransitionIn,bb.uc=ld.Gc("TransitionFlyThroughIn"),bb.tc=(Fa=new Kc,Fa.TransitionType=Qa.M4b,Fa.Direction=
Sc.m7b,Fa.Duration=800,Fa.IsManualAdvance=!0,Fa),bb.parent="TransitionFlyThrough",bb.next="TransitionFlyThroughOut",bb));let yb,Bb;this.Ac.$("TransitionFlyThroughOut",(Bb=new Zc,Bb.pc=ResourceStrings.L_TransitionOut,Bb.uc=ld.Gc("TransitionFlyThroughOut"),Bb.tc=(yb=new Kc,yb.TransitionType=Qa.M4b,yb.Direction=Sc.obe,yb.Duration=800,yb.IsManualAdvance=!0,yb),Bb.parent="TransitionFlyThrough",Bb.next="TransitionFlyThroughInWithBounce",Bb));let pb,Ob;this.Ac.$("TransitionFlyThroughInWithBounce",(Ob=new Zc,
Ob.pc=ResourceStrings.L_TransitionInWithBounce,Ob.uc=ld.Gc("TransitionFlyThroughIn"),Ob.tc=(pb=new Kc,pb.TransitionType=Qa.M4b,pb.Direction=Sc.l0i,pb.Duration=900,pb.IsManualAdvance=!0,pb),Ob.parent="TransitionFlyThrough",Ob.next="TransitionFlyThroughOutWithBounce",Ob));let sc,wc;this.Ac.$("TransitionFlyThroughOutWithBounce",(wc=new Zc,wc.pc=ResourceStrings.L_TransitionOutWithBounce,wc.uc=ld.Gc("TransitionFlyThroughOut"),wc.tc=(sc=new Kc,sc.TransitionType=Qa.M4b,sc.Direction=Sc.m0i,sc.Duration=900,
sc.IsManualAdvance=!0,sc),wc.parent="TransitionFlyThrough",wc))}}this.Ac.forEach((X,ta)=>{X===ta.parent&&++m;return!0})}qTa(z){let Y=null;z?this.Ac.forEach((m,I)=>{I.tc&&I.tc.TransitionType===z.TransitionType&&I.tc.Direction===z.Direction&&(Y=m);return!0}):Y="TransitionNone";return Y}xQ(z){return this.Ac.ga(z)}Pxb(z){return(z=this.qTa(z))?this.Ac.ga(this.Ac.ga(z).parent):null}rTa(z){return(z=this.qTa(z))?this.Ac.ga(z).parent:null}V4f(z){let Y,m=null;Y=null;z&&z.next&&(Y=z.next,m=this.xQ(Y));return{returnValue:m,
key:Y}}$wb(){var z=[ld.j2i,ld.PRk,ld.QRk];for(const Y of z)if(z=document.getElementById(Y))return z;return null}W0c(z,Y){return z&&Y&&Y.childNodes?z.startsWith(ld.k2i)?Y.contains(document.getElementById(z)):!1:!Y&&z?"TransitionExisting"===z||"TransitionNone"===z||"TransitionMorph"===z||"TransitionCut"===z||"TransitionFade"===z||"TransitionPush"===z||"TransitionWipe"===z:!1}static Gc(z){return Ge.a.Ulc+"_"+z+"_32x32x32"}}ld.j2i="PptRibbon.Transition.Gallery-MaxSize-1-0";ld.PRk="Transitions";ld.QRk=
"Transitions-previewWrapper";ld.k2i="Transition";Object(h.a)(ld,"TransitionHelper",null,[646]);var Dg=d(237);class De{constructor(z){this.J5e=(Y,m,I,X,ta)=>1===I?32:ta?32:16;this.ia=z}wb(){this.ia.ra(Bc.a.eHh,Lc.a.application,this.J5e,4);this.ia.ra(Bc.a.qHh,Lc.a.application,this.J5e,4);this.ia.ra(Bc.a.JIh,Lc.a.application,this.J5e,4)}Ee(){}}Object(h.a)(De,"PictureEnhancementActor",null,[365]);class gi{constructor(){this.nh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}Zb(z){this.K=z;
this.nh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").mEa(0,this.name);this.K.register(541,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().oa(()=>new Qc(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").YP){const Y=Dg.a(this.K);this.K.register(542,"PowerPointWebEditor.IAudioManagerStore").ma().oa(()=>new jd);this.K.register(543,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().oa(()=>new Wa(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").YP,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Ja("PowerPointWebEditor.IAudioManagerStore")));this.K.register(544,"PowerPointWebEditor.IAudioManagerFactory").ma().oa(()=>new nb(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),Y,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));
this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let z=this.nh.Bu("resolve");var Y=this.K.resolve("Common.AFrameworkApplication");const m=this.K.resolve("PowerPointWebEditor.IApplicationContext"),I=m.qd;Y=Y.wq;const X=this.K.resolve("Common.IActionManagerExtended"),ta=this.K.resolve("PowerPointWebEditor.IFocusManager");Y=Y.Ld;const Fa=this.K.resolve("Common.Transaction.ITransactionFactory"),bb=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
yb=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Bb=this.K.resolve("PowerPointWebEditor.PictureContext"),pb=this.K.resolve("PowerPoint.IPathManager");var Ob=this.K.resolve("PowerPointWebEditor.IPresentationReader");const sc=this.K.resolve("PowerPointWebEditor.IShapeReader"),wc=this.K.resolve("PowerPointWebEditor.IPictureUploader"),Lb=this.K.ke("PowerPointWebEditor.IPPTLanguageDialogFactory"),$b=this.K.resolve("Box4.IParagraphReader");this.nh.Gu(z);z=this.nh.Bu("regactors");
Ob=[new Nh(X,bb,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),$b,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),sc,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),$f.App.ULa.TLc(12),I.telemetryForPptParagraphSettingEnabled),new ya(X,ta,yb,Fa,bb,pb,Y,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ob,new xd,I.blg,this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled")),
new Eb(X,Y,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Fa,bb,ta,new ld(I.fMa,this.K.resolve("PowerPointWebEditor.IApplicationSettings").eB),yb,I,pb,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];I.Nrb?Ob.push(new Yc(X,bb,ta,Fa,new ba(I.TRd),yb,sc,pb,this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").xd(8),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ISlideReader"))):Ob.push(new Xe(X,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bb,ta,Fa,new ba(I.TRd),yb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),sc,pb));I.powerPointFormatBackgroundEnabled&&Ob.push(new ug(X,ta,yb,bb,Fa,Y,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wc,Bb,O.AFrameworkApplication.PQ,this.K.resolve("PowerPointWebEditor.IErrorHandler"),
I));I.NYf&&Ob.push(new De(X));for(const Oc of Ob)Oc.wb(),Oc.Ee();this.nh.Gu(z);O.AFrameworkApplication.fa.ff(()=>{z=this.nh.Bu("regfullactors");const Oc=[],md=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");md.WUa=this.K.resolve("Common.IAppSettingsManager").ka("299");m.qd.eJb&&Oc.push(new mj(X,Lb,md,this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.Ja("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),bb));this.K.resolve("PowerPointWebEditor.IApplicationSettings").O8b&&Oc.push(new yh(X,ta,bb,Dg.a(this.K)));for(const zd of Oc)zd.wb(),zd.Ee();md.WUa&&(new me(X,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(zd,le)=>new re(zd,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),le,this.K.resolve("Common.IFocusManager")),
this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),bb,this.K.resolve("Box4.ILanguageReader"),sc)).wb();this.nh.Gu(z)})}dispose(){}}Object(h.a)(gi,"AdvancedPackage",null,[2,3]);class pk{get container(){return F.a.instance.resolve("PowerPointWebEditor.IRibbonPane").xa}}Object(h.a)(pk,"PPTFloatPaneContainer",null,[496]);class Kh{constructor(z,Y,m=null){this.Zfb=new fc.a(0);this.wZa=null;this.Dhb=this.wZa=$f.App.Ym;this.Fue=z;this.sXg=1E3*Y;this.bAg=m||(()=>(new Date).getTime())}Yii(z){this.Fue&&
this.Zfb.add(z,(new Date).getTime())}GSf(z){this.Fue&&(this.Zfb.remove(z),this.kyl(this.bAg()-this.sXg))}kyl(z){if(this.Zfb.count){var Y=[];this.Zfb.forEach((m,I)=>{I<z&&Y.push(m);return!0});for(const m of Y)this.Zfb.remove(m)}}get rjg(){return this.Dhb<=this.wZa}Lyj(){if(!this.Fue||!this.Zfb.count)return!1;let z=!1;const Y=this.bAg();this.Zfb.forEach((m,I)=>Y-I<this.sXg?(z=!0,!1):!0);return z}}Object(h.a)(Kh,"PictureContext",null,[549]);var Yd=d(908),Kk=d(437);class zi{constructor(){this.$db=this.Zye=
this.qHg=this.rHg=!1;this.nh=this.Y4=this.uEb=this.MHg=this.K=null;this.cdc=[new gi];this.TX=[]}get name(){return"PowerPointWebEditor.Chronos"}Zb(z){this.K=z;this.Y4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.Y4.mEa(0,this.name);for(let Y=0;Y<this.cdc.length;++Y)Array.add(this.TX,of.a(this.cdc[Y],0));for(const Y of this.TX)Y.Zb(z);zi.Hyi(z);this.K.register(Kh,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().oa(()=>new Kh(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}Nkc(z,Y){z=Df.a.instance;for(let I=0;I<Y.entries.length;I++){var m=Y.entries[I];m.url=E.a.removeParameter(m.url,O.AFrameworkApplication.$V);const X=E.a.joa(m.url);let ta=!1;if("about:blank"===m.url||X.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===X&&"2"===E.a.kT(m.url,"u")||this.$db&&(ta=X.endsWith("PowerPoint.ashx"))&&m.url.endsWith("ib=1"))m.behavior=1;else{if(ta||X.endsWith("PowerPoint.ashx")||
X.endsWith("GetUpdates")||X.endsWith("images.ashx")||X.endsWith("GetThumb"))m.behavior=2;if(!this.rHg&&X.endsWith("PowerPoint.ashx")&&"true"===E.a.kT(m.url,vd.a.xDk))m=m.QB,z.jc(Bf.a.rXd,parseInt(String(m.fetchStart))),z.jc(Bf.a.WAi,parseInt(String(m.responseStart))),z.jc(Bf.a.OAi,parseInt(String(m.responseEnd-m.responseStart))),this.rHg=!0;else if(!this.qHg&&X.endsWith("PowerPoint.ashx")&&"true"===E.a.kT(m.url,"dSlide")){this.qHg=!0;m=m.QB;z.jc("SlideImageFetchStart",parseInt(String(m.fetchStart)));
z.jc("SlideImageResponseStart",parseInt(String(m.responseStart)));z.jc("SlideImageDownloadDuration",parseInt(String(m.responseEnd-m.responseStart)));let Fa;({transferSize:Fa}=zi.HFh(m)).returnValue&&z.jc("SlideImageSize",Fa)}else if(!this.Zye&&X.endsWith("images.ashx")&&"true"===E.a.kT(m.url,"minimalboot")&&E.a.kT(m.url,"index")===this.MHg){this.Zye=!0;m=m.QB;z.jc("MBootFetchStart",parseInt(String(m.fetchStart)));z.jc("MBootResponseStart",parseInt(String(m.responseStart)));z.jc("MBootDownload",parseInt(String(m.responseEnd-
m.responseStart)));let Fa;({transferSize:Fa}=zi.HFh(m)).returnValue&&z.jc("MBootSize",Fa)}}}}ddl(){const z=window.self.FirstSlideRequestIndex;void 0===z||null===z?this.Zye=!0:this.MHg=z.toString()}init(){bd.a.J(512497358,809,50,"ChronosPackage::Init");const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Y=this.K.resolve("Common.ITaskManager");for(var m of this.TX)this.nh.Bu(m.name),m.init(),this.nh.Gu(m.name);this.K.resolve("Common.IAppSettingsManager").ff(()=>{if(z.podsAnimationSuggestionEnabled){const I=
this.nh.Bu("animationpreview");this.sFj();this.nh.Gu(I)}});this.K.resolve("Common.IActionManagerExtended").paa(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));m=F.a.instance.resolve("Box4.IProofingManager");if(null!==m){let I=this.nh.Bu("proofingresume");m.resume();this.nh.Gu(I)}if(z.wua||!z.dVa)m=this.nh.Bu("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").bzh(),this.nh.Gu(m);this.ddl();this.$db=z.podsUseRealtimeCoauthReplicationTimerForInbound;m=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");
m.Zb(30,0);m.Kuf(Object(v.a)(this,this.Nkc,"onResourceTimingEntriesAvailable"));m.activate();z.PUa&&(this.uEb=window.self.PerfMeterData,void 0!==this.uEb&&null!==this.uEb&&(Y.Db(new ae.a(3,2,6E4,Object(v.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),bd.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").LA(()=>{this.collectPerfMeterData(null)})));z.ka("IsPasteTextFloatieEnabled")&&this.K.resolve("Common.IActionManagerExtended").paa(this.K.resolve("Box4.ITextPasteFloatieManager"));
this.e1j(z)}e1j(z){bd.a.J(512497356,809,50,"Start to download chronos1 js file");if(z.Buc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1245)));else{z=qg.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1245)));const Y=this.K.resolve("PowerPointWebEditor.ISessionState");z.HS(()=>{Y&&Y.U5("Chronos1DownloadFinished")});Ga.a.fy(z)}}collectPerfMeterData(){if(0<this.uEb.length){const z=[];for(const Y of this.uEb)z.push({["Id"]:Y.Id,
["Value"]:Y.Value.toFixed(2),["Start"]:Y.Start.toFixed(2),["Duration"]:Y.Duration.toFixed(2)});bd.a.J(512497355,813,50,JSON.stringify(z));this.uEb.length=0}}dispose(){for(var z of this.TX)z.dispose();z=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");z.deactivate(!0);z.djh(Object(v.a)(this,this.Nkc,"onResourceTimingEntriesAvailable"))}sFj(){const z=qg.a.create("pptedit.animationpreview",null,()=>d.e(18).then(d.bind(null,1259)));try{Ga.a.fy(z)}catch(Y){bd.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",
Y.toString())}}static Hyi(z){z.register(496,"Common.IFloatPaneContainer").ma().oa(()=>new pk)}static HFh(z){z=parseInt(String(Yd.a(z,"transferSize")));return{returnValue:!z.toString().startsWith("NaN"),transferSize:z}}static main(){O.AFrameworkApplication.Ug&&fa.a.fg?bd.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(Df.a.instance.jc(Kk.a.CVd,(new Date).getTime()),Ma.a.instance.Dc(of.a(new zi,0)))}}Object(h.a)(zi,"ChronosPackage",null,[2,3]);class Vi{constructor(z,
Y,m,I,X,ta,Fa){this.rFb=this.SQ=!1;this.ua=z;this.ic=Y;this.Gv=m;this.yt=I;this.icb=ta;this.je=X;this.lz=this.ua.Ba;this.Kc=Fa}initialize(){this.Gv.kk(Object(v.a)(this,this.ph,"onPropertyChanged"));this.je.m6a(Object(v.a)(this,this.Cfa,"onRibbonTabSwitched"));this.yt.eW(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.yt.XYb(Object(v.a)(this,this.hZa,"onShapeViewElementAdded"));this.yt.Vbi(Object(v.a)(this,this.a7g,"onShapesAllSelected"))}dispose(){this.Gv.Rm(Object(v.a)(this,
this.ph,"onPropertyChanged"));this.je.Qoc(Object(v.a)(this,this.Cfa,"onRibbonTabSwitched"));this.yt.Yxa(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.yt.fmd(Object(v.a)(this,this.hZa,"onShapeViewElementAdded"));this.yt.p0k(Object(v.a)(this,this.a7g,"onShapesAllSelected"))}ph(z,Y){Y.property===ye.a.vRc&&this.SQ&&this.ic.jg(Y.node)===this.lz&&this.g_a(this.SQ)}Cfa(z,Y){if(this.SQ=!!Y.qfa&&0<=Y.qfa.indexOf("Animation"))this.rFb=!0;this.g_a(this.SQ)}hZa(z,Y){(z=this.ua.Ba)&&
z.KQ&&z===this.lz&&(Y=Y.Px)&&Y.shapeNode&&this.lz&&this.sbb(this.lz.Cb,Y.shapeNode)&&this.g_a(this.SQ)}sbb(z,Y){return z&&Y?z.equals(Y.slideId):!1}onActiveSlideDomReady(z,Y){(z=Object(B.a)(116,Y.Ba))&&this.lz&&this.lz.Cb!==z.Cb&&(this.lz=z,this.g_a(this.SQ))}a7g(){this.Baa()}Baa(){if(this.SQ&&this.lz&&this.lz.GEa&&this.rFb){var z=this.lz.gk();if(z&&0<z.length)for(const Y of z)Y&&Y.yab()&&(z=this.icb.ZG(Y))&&(z.h0b(),z.Baa(!0))}}g_a(z){if(this.rFb&&this.lz&&this.lz.KQ&&this.Kc.Ic&&this.Kc.Ic.EHc){var Y=
this.lz.gk();if(Y&&0<Y.length)for(const m of Y)m&&(Y=this.icb.ZG(m))&&(Y.visible=z,Y.Fib())}}}Object(h.a)(Vi,"AnimationMarkerManagerLegacy",null,[106]);var hi=d(78),xa=d(58);class sb{constructor(z,Y){this.height=z;this.top=Y}}Object(h.a)(sb,"ParagraphProperties",null,[]);var Jb=d(49),uc=d(69),Gd=d(138),ee=d(169),se=d(197),$e=d(188);class gg{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob,sc,wc,Lb){this.Ufc=this.kA=this.tfb=this.Hk=this.Eb=!1;this.va=new hi.a;this.lgc=this.vd=1;this.rn=this.qn=this.ah=
this.xb=this.qb=null;this.Jm=$b=>{$b&&this.BO?(this.qb=new Gd.a,this.qb.ur("AnimationMarkerView"),this.BO.appendChild(this.qb.xa),this.xb=new $e.a,this.xb.$j(0),this.qb.appendChild(this.xb.viewport),this.ah=new ee.a,this.ah.$j(1),this.ah.setVisibility(!1),this.xb.appendChild(this.ah),this.qn=new Gd.a,this.qn.ur("ShapeAnimationMarkerContainer"),this.qn.xa.id=this.ta.id.toString(),this.qn.lh(20,this.qb.xa.clientHeight),this.qn.$j(1),this.qb.appendChild(this.qn),this.rn=new Gd.a,this.rn.ur("TextAnimationMarkerContainer"),
this.rn.xa.id=this.ta.id.toString(),this.rn.lh(20,this.qb.xa.clientHeight),this.rn.$j(1),this.qb.appendChild(this.rn),this.Zf.pb(Nb.a.mq,this.qn.xa,this.dD),this.Zf.pb(Nb.a.Ns,this.qn.xa,this.dD),this.Zf.pb(Nb.a.mq,this.rn.xa,this.dD),this.Zf.pb(Nb.a.Ns,this.rn.xa,this.dD),this.Zf.pb(Nb.a.GJ,this.qn.xa,this.wTa),this.Zf.pb(Nb.a.GJ,this.rn.xa,this.wTa),this.Zf.pb(Nb.a.mouseDown,this.qn.xa,this.wTa),this.Zf.pb(Nb.a.mouseDown,this.rn.xa,this.wTa),this.Zc.pb(Nb.a.click,this.rn.xa,this.SVc),this.Zc.pb(Nb.a.click,
this.qn.xa,this.SVc),this.setVisibility()):bd.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",$b?"m_markerViewParentElement":"parent")};this.PN=()=>!0;this.wTa=$b=>{if(!$b&&!$b.Ec.id.startsWith(Ge.a.Mrb)&&!$b.Ec.id.startsWith("overlappedMarker"))return bd.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;$b.eventName==Nb.a.GJ&&this.IIe($b);$b=$b.qc;$b.preventDefault();$b.stopPropagation();return!0};this.SVc=$b=>{$b=$b.qc;$b.preventDefault();
$b.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let $b=this.Eb&&!this.kA;this.ta&&this.ta.isHiddenShape&&($b=!1);this.qb&&this.qb.Rd($b);this.qn&&this.qn.Rd($b);this.rn&&this.rn.Rd($b)};this.Baa=$b=>{if(this.Sda()){this.tfb=$b;$b=[this.qn.xa.childNodes,this.rn.xa.childNodes];for(const Oc of $b)for($b=0;Oc&&$b<Oc.length;$b++)this.Zpc(Oc[$b],this.tfb)}};this.E8k=$b=>{if(this.Sda()){var Oc=[this.qn.xa.childNodes,this.rn.xa.childNodes];for(const md of Oc)for(Oc=0;md&&Oc<
md.length;Oc++){const zd=this.l5b(md[Oc]);for(const le of $b)zd.includes(le)&&this.Zpc(md[Oc],!0)}}};this.l5b=$b=>{if(!$b||!this.ta)return null;$b=$b.getAttribute("AnimProps");if(!$b||!$b.toString()||!$b.toString().trim().length)return null;$b=$b.toString().split(" ");if(!$b||!$b.length)return null;const Oc=[];for(const md of $b){if(!md||!md.trim().length)return null;Oc.push(Number.parseInvariant(md.trim()))}return Oc};this.Sda=()=>{const $b=!!this.ta&&!!this.BO&&!!this.qn&&!!this.rn;$b||bd.a.J(509682579,
800,10,"AnimationMarkerView: the containers are not exist.");return $b};this.CQa=()=>{this.eja(!0);this.eja(!1)};this.eja=$b=>{if(this.Zf&&this.Zc&&this.Sda()&&($b=$b?this.rn.xa:this.qn.xa)&&$b.childNodes&&0<$b.childNodes.length){const Oc=$b.childNodes;for(const md=0;md<Oc.length;)$b.removeChild(Oc[md])}};this.JOd=()=>{if(this.Sda()){var $b=this.ic.jg(this.ta);if($b)if(($b=$b.Zwb(this.ta))&&$b.length){var Oc=!1,md=!1,zd=[];for(const le of $b)le.IsTextRangeType?md=!0:(Oc=!0,zd.push(le));this.Ufc=Oc&&
md;this.nMa(!0);this.nMa(!1);this.eja(!1);0<zd.length&&(this.d3b(zd,this.Ri.GM(this.ta.fp.kc,this.vd),this.Ri.GM(this.ta.fp.Yb-this.ta.fp.kc,this.vd),!1,-1)||bd.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));md?this.q2d():this.eja(!0)}else this.CQa();else bd.a.J(509682578,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.q2d=()=>{const $b=new ae.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,90,"26");this.zb.Db($b)};this.ensureTextIsRenderedAndDrawMarkers=
()=>{this.Hk||(this.Pse(),this.e3b())};this.e3b=()=>{this.eja(!0);if(this.Pce()){var $b=this.J$d();if($b&&$b.length){var Oc;if(({top:Oc}=this.R$d()).returnValue){var md=0;for(let le=0;le<$b.length;le++){var zd=this.ic.jg(this.ta);if(!zd){bd.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");return}(zd=zd.A9d(this.ta,le))&&0<zd.length&&$b[le]&&(md+=this.d3b(zd,$b[le].top-Oc,$b[le].height,!0,le))}md||bd.a.J(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else bd.a.J(509682575,
800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else bd.a.J(509682576,800,50,"AnimationMarkerView: the paragrph view is not rendered")}};this.J$d=()=>{const $b=[];var Oc=xg.GraphIterator.nb(this.ta);Oc=this.Ml.h3(Oc,Oc.currentNode);for(var md;Oc.moveNext();)(md=Oc.currentNode)&&this.Ih.ae(md)&&md&&(md=md.sc(this.zz))&&md.htmlElement&&(md=this.Cta(md.htmlElement))&&md.height&&$b.push(md);return $b};this.Cta=$b=>{if(!$b)return bd.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),
null;$b=$b.querySelectorAll(".TextRun");if(!$b||!$b.length)return null;let Oc=0,md=0;let zd,le=!1;for(let bf=0;bf<$b.length&&$b[bf];bf++){var df=$b[bf].getClientRects();({top:df,bottom:zd}=this.b4d(df)).returnValue&&(bf?(Oc=Oc>df?df:Oc,md=md<zd?zd:md):(Oc=df,md=zd),le=!0)}if(le)return new sb(md-Oc,Oc);bd.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.d3b=($b,Oc,md,zd)=>{if(!this.Sda()||!$b||!$b.length)return 0;const le=zd?this.rn.xa:this.qn.xa;
md=(md=Math.floor(this.Ri.Sm(md)/21))?md:1;let df=0,bf=null,Hg=null,Yh=!0,Hi=!1;for(let wi=0;wi<$b.length;wi++){const Qg=$b[wi];var kf=new Gd.a;kf.xa.id=Ge.a.Mrb+Qg.ClickOrder;kf.lh(20,16);kf.$j(1);if(Qg.IsTrigger){var ej=this.nZd();kf.xa.appendChild(ej)}else kf.xa.innerText=Qg.ClickOrder.toString();let Jk=ej=!1;wi<md?(zd&&(kf.xa.style.position=uc.a.absolute,kf.xa.style.top=Jb.a.Pc(this.Ri.Sm(Oc)+21*df)),Hi=this.tfb||this.zo.lXd(Qg.EffectNodeId),kf.xa.setAttribute(uc.a.Xra,Hi?"animMarkerSelected":
"animMarkerUnselected"),le.appendChild(kf.xa),df++):wi===md?(Yh=Yh&&Qg.EffectId===bf.EffectId,ej=!0,Jk=bf.IsTrigger):Yh=Yh&&Qg.EffectId===bf.EffectId;ej&&Hg.xa.appendChild(this.ATd(Jk,Yh,Hi));bf=Qg;Hg||(Hg=kf);zd?(kf=[],(ej=this.l5b(Hg.xa))&&kf.push(...ej),kf.push(Qg.EffectNodeId),Hg.xa.setAttribute("AnimProps",kf.join(" "))):kf.xa.setAttribute("AnimProps",Qg.EffectNodeId)}this.PM();return df};this.ATd=($b,Oc,md)=>{const zd=new Gd.a;zd.xa.id="overlappedMarker";zd.xa.style.marginTop=$b?"3px":"-13px";
zd.xa.setAttribute(uc.a.Xra,"overlappedMarker "+(md?"animMarkerSelected":"animMarkerUnselected"));Oc&&this.A1(zd.xa,"SameEffectOverlapped",1);return zd.xa};this.PM=()=>{this.UCe(this.qb.xa,!0)};this.Pce=()=>{var $b=this.ic.jg(this.ta);if(!$b)return bd.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;$b=$b.Zwb(this.ta);if(!$b||!$b.length)return!1;for(const Oc of $b)if(Oc.IsTextRangeType)return!0;return!1};this.nMa=$b=>{if(this.Sda()){var Oc=$b?this.qn.xa:this.rn.xa,
md,zd;Oc&&({x:md,y:zd}=this.Z8d($b)).returnValue&&(Oc.style.position=uc.a.absolute,Oc.style.left=Jb.a.Pc(md),Oc.style.zIndex="20000",$b?Oc.style.top=Jb.a.Pc(zd):this.e3b())}};this.IIe=$b=>{if(this.va&&$b&&this.Fa&&$b.Ec){var Oc=$b.Ec.id.startsWith("overlappedMarker")&&$b.Ec.offsetParent?$b.Ec.offsetParent:$b.Ec;(Oc=this.l5b(Oc))?($b.ctrlKey?this.zo.Arj(Oc,this.ic.jg(this.ta)):(this.zo.tsa(),this.zo.wPd(Oc,this.ic.jg(this.ta))),this.va.raiseEvent("OnMarkerClick",$b),this.Fa.Ed()):bd.a.J(509682566,
800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.Rl=()=>{this.xb&&(this.yPb(),this.xb.Rl())};this.yPb=()=>{if(this.ta&&this.ah){var $b=this.ta.fp.points;$b=gg.Bra($b,this.Gxb());this.ah.Et($b)}};this.Gxb=()=>{let $b=Ge.a.wLb;this.ta.Qf||!this.ta.Eua&&!this.ta.fl||($b+=6);return $b};this.Zp=()=>{this.xb&&this.lgc!==this.vd&&this.Fib();return null};this.Qq=()=>{};this.Yu=()=>{};this.Kj=$b=>{this.lgc=this.vd;this.vd=$b};this.setZIndex=$b=>{this.xb&&this.xb.OB($b)};this.draw=
()=>{this.Fib()};this.Fib=()=>{this.qb&&this.BO&&this.Eb&&!this.kA&&(this.CQa(),this.JOd());this.setVisibility()};this.dD=$b=>{if(!this.va||!$b)return!1;this.va.raiseEvent("OnSelectionAreaHover",$b);$b.eventName===Nb.a.mq?this.A1($b.Ec,"animMarkerHovered",1):$b.eventName===Nb.a.Ns&&this.A1($b.Ec,"animMarkerHovered",2);return!0};this.Zpc=($b,Oc)=>{$b?Oc?(this.A1($b,"animMarkerUnselected",2),this.A1($b,"animMarkerSelected",1)):(this.A1($b,"animMarkerSelected",2),this.A1($b,"animMarkerUnselected",1)):
bd.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.A1=($b,Oc,md)=>{const zd=this.mWc($b);switch(md){case 0:$b.setAttribute(uc.a.Xra,Oc);zd&&$b.lastChild.setAttribute(uc.a.Xra,Oc);break;case 1:Sys.UI.DomElement.addCssClass($b,Oc);zd&&Sys.UI.DomElement.addCssClass($b.lastChild,Oc);break;case 2:Sys.UI.DomElement.removeCssClass($b,Oc),zd&&Sys.UI.DomElement.removeCssClass($b.lastChild,Oc)}};this.mWc=$b=>!!$b&&!!$b.lastChild&&!!$b.lastChild.id&&"overlappedMarker"===$b.lastChild.id;
this.setPosition=()=>{};this.OE=$b=>{this.kA=$b;this.kA||(this.Xr(),this.Baa(!0));this.setVisibility()};this.bE=()=>null;this.Ox=()=>{};this.JB=()=>[];this.Xy=()=>{};this.lD=()=>{};this.Xr=()=>{!this.Hk&&this.BO&&(this.nMa(!0),this.nMa(!1))};this.nZd=()=>{const $b=new se.a;$b.lh(10,10);$b.xa.setAttribute(uc.a.Xra,"pointer-events-none");$b.Dya("0 0 2048 2048");const Oc=new ee.a;Oc.v1("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
Oc.PE("#E67E22");Oc.Zu("#FFFF00");Oc.mr(5);$b.appendChild(Oc);return $b.xa};if(!z)throw Error.argumentNull("shapeNode");if(!Y)throw Error.argumentNull("slideReader");if(!m)throw Error.argumentNull("traverserFactory");if(!I)throw Error.argumentNull("paragraphReader");if(!Fa)throw Error.argumentNull("activeSlideViewManager");if(!bb)throw Error.argumentNull("mouseInputManager");if(!yb)throw Error.argumentNull("clickInputManager");if(!Bb)throw Error.argumentNull("focusManagers");if(!Lb)throw Error.argumentNull("effectSelectionManager");
if(!Ob)throw Error.argumentNull("pptUnitConversion");this.ta=z;this.ic=Y;this.Ml=m;this.Ih=I;this.zz=ta;this.UCe=X;this.BO=Fa.Ic?Fa.Ic.EHc:null;this.cCe=Fa.Ic?Fa.Ic.asc:null;this.Zf=bb;this.Zc=yb;this.Fa=Bb;this.zb=pb;this.O9=sc;this.Pse=wc;this.Ri=Ob;this.zo=Lb}dispose(){this.Hk||(this.O9(),this.Hk=!0,this.Eb=!1,this.CQa(),this.Zc&&this.qn&&this.Zc.yb(Nb.a.click,this.qn.xa,this.SVc),this.Zf&&this.qn&&(this.Zf.yb(Nb.a.mq,this.qn.xa,this.dD),this.Zf.yb(Nb.a.Ns,this.qn.xa,this.dD),this.Zf.yb(Nb.a.GJ,
this.qn.xa,this.wTa),this.Zf.yb(Nb.a.mouseDown,this.qn.xa,this.wTa)),this.qn=null,this.Zc&&this.rn&&this.Zc.yb(Nb.a.click,this.rn.xa,this.SVc),this.Zf&&this.rn&&(this.Zf.yb(Nb.a.mq,this.rn.xa,this.dD),this.Zf.yb(Nb.a.Ns,this.rn.xa,this.dD),this.Zf.yb(Nb.a.GJ,this.rn.xa,this.wTa),this.Zf.yb(Nb.a.mouseDown,this.rn.xa,this.wTa)),this.Fa=this.Ih=this.ta=this.Ml=this.ic=this.Ri=this.zo=this.xb=this.ah=this.BO=this.qb=this.rn=null)}get visible(){return this.Eb}set visible(z){this.Eb=z}get MB(){return this.xb}get qq(){return this.ah}get te(){return this.qb}R$d(){return this.getClientRects(this.cCe)}getClientRects(z){let Y,
m;Y=m=0;if(!z)return bd.a.J(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:Y,top:m};z=z.getClientRects();if(!z||!z.length||!z[0])return bd.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:Y,top:m};m=Math.round(z[0].top);Y=Math.round(z[0].left);return{returnValue:!0,left:Y,top:m}}b4d(z){let Y,m;Y=m=0;if(!z||!z.length||!z[0])return bd.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:Y,bottom:m};Y=z[0].top;m=z[0].bottom;for(let I=1;I<z.length&&z[I];I++)Y=z[I].top>Y?Y:z[I].top,m=z[I].bottom<m?m:z[I].bottom;return{returnValue:!0,top:Y,bottom:m}}Z8d(z){let Y,m;Y=m=0;if(!this.ta)return{returnValue:!1,x:Y,y:m};var I=Object(B.a)(117,this.ta.sc(this.zz));if(!I)return{returnValue:!1,x:Y,y:m};I=I.us();if(!I)return{returnValue:!1,x:Y,y:m};Y=z?I.hc-(this.Ufc?61:35):I.hc-20-15;m=I.kc;return{returnValue:!0,x:Y,y:m}}}gg.Bra=(z,Y)=>[new xa.a(z[0]._x-Y,z[0]._y-Y),new xa.a(z[1]._x+
Y,z[1]._y-Y),new xa.a(z[2]._x+Y,z[2]._y+Y),new xa.a(z[3]._x-Y,z[3]._y+Y)];Object(h.a)(gg,"AnimationMarkerView",null,[522,435,436,106]);class Th{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob,sc,wc){this.y7c=this.tfb=this.Hk=this.Eb=!1;this.bWa=this.Dcc=-1;this.Ufc=this.kA=!1;this.va=new hi.a;this.lgc=this.vd=1;this.rn=this.qn=this.ah=this.xb=this.qb=null;this.ta=z;this.ic=Y;this.Ml=m;this.Ih=I;this.zz=ta;this.UCe=X;this.BO=Fa.Ic?Fa.Ic.EHc:null;this.cCe=Fa.Ic?Fa.Ic.asc:null;this.Zf=bb;this.Zc=yb;this.Fa=
Bb;this.zb=pb;this.O9=sc;this.Pse=wc;this.Ri=Ob}dispose(){this.Hk||(this.O9(),this.Hk=!0,this.Eb=!1,this.h0b(),this.CQa(),this.Zf&&this.qn&&(this.Zf.yb(Nb.a.mq,this.qn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.yb(Nb.a.Ns,this.qn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover"))),this.qn=null,this.Zf&&this.rn&&(this.Zf.yb(Nb.a.mq,this.rn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.yb(Nb.a.Ns,this.rn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover"))),this.xb=
this.ah=this.BO=this.qb=this.rn=null)}get visible(){return this.Eb}set visible(z){this.Eb=z}get MB(){return this.xb}get qq(){return this.ah}get te(){return this.qb}Jm(z){z&&this.BO?(this.qb=new Gd.a,this.qb.ur("AnimationMarkerView"),this.BO.appendChild(this.qb.xa),this.xb=new $e.a,this.xb.$j(0),this.qb.appendChild(this.xb.viewport),this.ah=new ee.a,this.ah.$j(1),this.ah.setVisibility(!1),this.xb.appendChild(this.ah),this.qn=new Gd.a,this.qn.ur("ShapeAnimationMarkerContainer"),this.qn.xa.id=this.ta.id.toString(),
this.qn.lh(20,this.qb.xa.clientHeight),this.qn.$j(1),this.qb.appendChild(this.qn),this.rn=new Gd.a,this.rn.ur("TextAnimationMarkerContainer"),this.rn.xa.id=this.ta.id.toString(),this.rn.lh(20,this.qb.xa.clientHeight),this.rn.$j(1),this.qb.appendChild(this.rn),this.Zf.pb(Nb.a.mq,this.qn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.pb(Nb.a.Ns,this.qn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.pb(Nb.a.mq,this.rn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.pb(Nb.a.Ns,
this.rn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.setVisibility()):bd.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",z?"m_markerViewParentElement":"parent")}PN(z){let Y=!1;z&&z.Ec.id.startsWith(Ge.a.Mrb)||z.Ec.id.startsWith("overlappedMarker")?(this.IIe(z),Y=!0):(this.h0b(),this.Baa(!0));return Y}setSelection(z){if(z&&!this.y7c||!z)this.Baa(z),this.h0b()}setVisibility(){let z=this.Eb&&!this.kA;this.ta&&this.ta.isHiddenShape&&(z=!1);this.qb&&this.qb.Rd(z);this.qn&&this.qn.Rd(z);
this.rn&&this.rn.Rd(z)}Baa(z){if(this.Sda()){this.tfb=z;z=[this.qn.xa.childNodes,this.rn.xa.childNodes];for(const Y of z)for(z=0;Y&&z<Y.length;z++)this.Zpc(Y[z],this.tfb)}}l5b(z){if(!z||!this.ta)return null;z=z.getAttribute("AnimProps");if(!z||!z.toString()||!z.toString().trim().length)return null;z=z.toString().split(" ");if(!z||4!==z.length)return null;const Y=[];for(const m of z){if(!m||!m.trim().length)return null;Y.push(Number.parseInvariant(m.trim()))}return Y}Sda(){const z=!!this.ta&&!!this.BO&&
!!this.qn&&!!this.rn;z||bd.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return z}CQa(){this.eja(!0);this.eja(!1)}eja(z){if(this.Zf&&this.Zc&&this.Sda()&&(z=z?this.rn.xa:this.qn.xa)&&z.childNodes&&0<z.childNodes.length){const Y=z.childNodes;for(const m=0;m<Y.length;)z.removeChild(Y[m])}}JOd(){if(this.Sda()){var z=this.m_f(this.ta);if(z&&z.length){var Y=!1,m=!1,I=[];for(const X of z)X.IsTextRangeType?m=!0:(Y=!0,I.push(X));this.Ufc=Y&&m;this.nMa(!0);this.nMa(!1);this.eja(!1);
0<I.length&&(bd.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.d3b(I,this.Ri.GM(this.ta.fp.kc,this.vd),this.Ri.GM(this.ta.fp.Yb-this.ta.fp.kc,this.vd),!1,-1)||bd.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));m?this.q2d():this.eja(!0);if(!m&&-1!==this.bWa||-1!==this.bWa&&-1===this.bWa&&!Y)this.RVd(),this.Baa(!0)}else this.CQa()}}q2d(){const z=new ae.a(2,1,0,Object(v.a)(this,this.ensureTextIsRenderedAndDrawMarkers,"ensureTextIsRenderedAndDrawMarkers"),
90,"26");this.zb.Db(z)}ensureTextIsRenderedAndDrawMarkers(){this.Hk||(this.Pse(),this.e3b())}e3b(){this.eja(!0);if(this.Pce(this.ta)){var z=this.J$d();if(z&&z.length){var Y;if(({top:Y}=this.R$d()).returnValue){var m=0;bd.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let X=0;X<z.length;X++){var I=this.ic.jg(this.ta);if(!I)return;(I=I.fUc(this.ta,X))&&0<I.length&&z[X]&&(m+=this.d3b(I,z[X].top-Y,z[X].height,!0,X))}m||bd.a.J(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else bd.a.J(509682531,
800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else bd.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}J$d(){const z=[];var Y=xg.GraphIterator.nb(this.ta);Y=this.Ml.h3(Y,Y.currentNode);for(var m;Y.moveNext();)(m=Y.currentNode)&&this.Ih.ae(m)&&m&&(m=m.sc(this.zz))&&m.htmlElement&&(m=this.Cta(m.htmlElement))&&m.height&&z.push(m);return z}R$d(){return this.getClientRects(this.cCe)}getClientRects(z){let Y,m;Y=m=0;if(!z)return bd.a.J(509682528,800,10,
"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:Y,top:m};z=z.getClientRects();if(!z||!z.length||!z[0])return bd.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:Y,top:m};m=Math.round(z[0].top);Y=Math.round(z[0].left);return{returnValue:!0,left:Y,top:m}}Cta(z){if(!z)return bd.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),null;z=z.querySelectorAll(".TextRun");if(!z||!z.length)return null;let Y=0,m=0;let I,X=
!1;for(let Fa=0;Fa<z.length&&z[Fa];Fa++){var ta=z[Fa].getClientRects();({top:ta,bottom:I}=this.b4d(ta)).returnValue&&(Fa?(Y=Y>ta?ta:Y,m=m<I?I:m):(Y=ta,m=I),X=!0)}if(X)return new sb(m-Y,Y);bd.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}b4d(z){let Y,m;Y=m=0;if(!z||!z.length||!z[0])return bd.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:Y,bottom:m};Y=z[0].top;m=z[0].bottom;for(let I=1;I<z.length&&
z[I];I++)Y=z[I].top>Y?Y:z[I].top,m=z[I].bottom<m?m:z[I].bottom;return{returnValue:!0,top:Y,bottom:m}}d3b(z,Y,m,I,X){if(!this.Sda()||!z||!z.length)return 0;const ta=I?this.rn.xa:this.qn.xa;m=(m=Math.floor(this.Ri.Sm(m)/21))?m:1;let Fa=0,bb=null,yb=new Gd.a,Bb=!1,pb=!1;const Ob=X===this.bWa&&z.length<this.Dcc+1;for(let wc=0;wc<z.length;wc++){const Lb=z[wc],$b=new Gd.a;$b.xa.id=Ge.a.Mrb+Lb.BuildId;$b.lh(20,16);$b.$j(1);if(Lb.IsTrigger){var sc=this.nZd();$b.xa.appendChild(sc)}else $b.xa.innerText=Lb.BuildId.toString();
let Oc=sc=!1;wc<m?(I&&($b.xa.style.position=uc.a.absolute,$b.xa.style.top=Jb.a.Pc(this.Ri.Sm(Y)+21*Fa)),$b.xa.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",wc,X,Lb.BuildId,Lb.EffectId)),pb=this.tfb||Ob&&z.length-1===wc||this.y7c&&this.Dcc===wc&&this.bWa===X,$b.xa.setAttribute(uc.a.Xra,pb?"animMarkerSelected":"animMarkerUnselected"),ta.appendChild($b.xa),Fa++):wc===m&&yb.xa?(Bb=Bb&&Lb.EffectId===bb.EffectId,sc=!0,Oc=bb.IsTrigger):Bb=Bb&&Lb.EffectId===bb.EffectId;sc&&yb.xa.appendChild(this.ATd(Oc,
Bb,pb));yb=$b;bb=Lb}this.PM();return Fa}ATd(z,Y,m){const I=new Gd.a;I.xa.id="overlappedMarker";I.xa.style.marginTop=z?"3px":"-13px";I.xa.setAttribute(uc.a.Xra,"overlappedMarker "+(m?"animMarkerSelected":"animMarkerUnselected"));Y&&this.A1(I.xa,"SameEffectOverlapped",1);return I.xa}PM(){this.UCe(this.qb.xa,!0)}m_f(z){if(!z)return null;const Y=this.ic.jg(z);return Y?Y.lTa(z):null}Pce(z){z=this.m_f(z);if(!z||!z.length)return!1;for(const Y of z)if(Y.IsTextRangeType)return!0;return!1}nMa(z){if(this.Sda()){var Y=
z?this.qn.xa:this.rn.xa,m,I;Y&&({x:m,y:I}=this.Z8d(z)).returnValue&&(Y.style.position=uc.a.absolute,Y.style.left=Jb.a.Pc(m),Y.style.zIndex="20000",z?Y.style.top=Jb.a.Pc(I):this.e3b())}}Z8d(z){let Y,m;Y=m=0;if(!this.ta)return{returnValue:!1,x:Y,y:m};var I=Object(B.a)(117,this.ta.sc(this.zz));if(!I)return{returnValue:!1,x:Y,y:m};I=I.us();if(!I)return{returnValue:!1,x:Y,y:m};Y=z?I.hc-(this.Ufc?61:35):I.hc-20-15;m=I.kc;return{returnValue:!0,x:Y,y:m}}IIe(z){if(this.va&&z&&this.Fa&&z.Ec){var Y=z.Ec.id.startsWith("overlappedMarker")&&
z.Ec.offsetParent?z.Ec.offsetParent:z.Ec;this.Ial(Y);this.mWc(Y)&&!this.$Uj(Y)&&this.RVd();this.Baa(!1);this.Zpc(Y,!0);this.va.raiseEvent("OnMarkerClick",z);this.Fa.Ed()}}h0b(){this.y7c=!1;this.bWa=this.Dcc=-1;this.RVd()}Ial(z){(z=this.l5b(z))?(this.y7c=!0,this.Dcc=z[0],this.bWa=z[1],this.ta.oya=this.Dcc,this.ta.PKa=this.bWa):bd.a.J(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}RVd(){this.ta&&(this.ta.oya=-1,this.ta.PKa=-1)}Rl(){this.xb&&(this.yPb(),this.xb.Rl())}yPb(){if(this.ta&&
this.ah){var z=this.ta.fp.points;z=Th.Bra(z,this.Gxb());this.ah.Et(z)}}Gxb(){let z=Ge.a.wLb;this.ta.Qf||!this.ta.Eua&&!this.ta.fl||(z+=6);return z}Zp(){this.xb&&this.lgc!==this.vd&&this.Fib();return null}Qq(){}Yu(){}Kj(z){this.lgc=this.vd;this.vd=z}setZIndex(z){this.xb&&this.xb.OB(z)}draw(){this.Fib()}Fib(){this.qb&&this.BO&&this.Eb&&!this.kA&&this.JOd();this.setVisibility()}dD(z){if(!this.va||!z)return!1;this.va.raiseEvent("OnSelectionAreaHover",z);z.eventName===Nb.a.mq?this.A1(z.Ec,"animMarkerHovered",
1):z.eventName===Nb.a.Ns&&this.A1(z.Ec,"animMarkerHovered",2);return!0}Zpc(z,Y){z&&(Y?(this.A1(z,"animMarkerUnselected",2),this.A1(z,"animMarkerSelected",1)):(this.A1(z,"animMarkerSelected",2),this.A1(z,"animMarkerUnselected",1)))}A1(z,Y,m){const I=this.mWc(z);switch(m){case 0:z.setAttribute(uc.a.Xra,Y);I&&z.lastChild.setAttribute(uc.a.Xra,Y);break;case 1:Sys.UI.DomElement.addCssClass(z,Y);I&&Sys.UI.DomElement.addCssClass(z.lastChild,Y);break;case 2:Sys.UI.DomElement.removeCssClass(z,Y),I&&Sys.UI.DomElement.removeCssClass(z.lastChild,
Y)}}mWc(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&"overlappedMarker"===z.lastChild.id}$Uj(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&0<=z.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}OE(z){(this.kA=z)?this.h0b():(this.Xr(),this.Baa(!0));this.setVisibility()}bE(){return null}Ox(){}JB(){return[]}Xy(){}lD(){}Xr(){!this.Hk&&this.BO&&(this.nMa(!0),this.nMa(!1))}nZd(){const z=new se.a;z.lh(10,10);z.xa.setAttribute(uc.a.Xra,"pointer-events-none");z.Dya("0 0 2048 2048");const Y=
new ee.a;Y.v1("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");Y.PE("#E67E22");Y.Zu("#FFFF00");Y.mr(5);z.appendChild(Y);return z.xa}static Bra(z,Y){return[new xa.a(z[0]._x-Y,z[0]._y-Y),new xa.a(z[1]._x+Y,z[1]._y-Y),new xa.a(z[2]._x+Y,z[2]._y+Y),new xa.a(z[3]._x-Y,z[3]._y+Y)]}}Object(h.a)(Th,"AnimationMarkerViewLegacy",
null,[521,435,436,106]);var Uh=d(280),Qj=d(1237),Xd=d(189);class Wf{constructor(z,Y,m,I,X,ta,Fa){this.rFb=this.SQ=!1;this.vy=[];this.zad=new Set;if(!z)throw Error.argumentNull("actionManager");if(!Y)throw Error.argumentNull("graphTopologyManager");if(!m)throw Error.argumentNull("slideReader");if(!I)throw Error.argumentNull("viewEventNotifier");if(!X)throw Error.argumentNull("animationMarkerViewManager");if(!ta)throw Error.argumentNull("activeSlideViewManager");if(!Fa)throw Error.argumentNull("selectionManager");
this.ia=z;this.ua=Y;this.ic=m;this.icb=X;this.je=I;this.lz=this.ua.Ba;this.Kc=ta;this.pa=Fa}initialize(){}dispose(){this.ia=this.zad=this.vy=this.lz=this.ic=this.pa=this.je=null}OIh(){const z=this.pa.Xd();this.i7a();const Y=this.lz.gk(),m=new Set;for(const I of z)m.add(I.id);for(const I of Y)m.has(I.id)?this.huf(I):this.Rih(I)}cHl(){this.g_a(this.SQ);this.hHl();this.je.Gy(new Xd.a(7))}Arj(z,Y){Y&&z&&z.length&&(this.lXd(z[0])?(Y=this.vy.filter(m=>!z.includes(m.EffectNodeId)),this.i7a(),this.tsa(),
this.xPd(Y)):(Y=this.ic.n_f(z,Y),this.YOd(Y),Y=Object.assign([],this.vy),this.i7a(),this.tsa(),this.xPd(Y)),this.ia.La(Bc.a.Y4e,Qj.a.execute,null))}tsa(){const z=this.pa.Xd();this.pa.tsa(z)}wPd(z,Y){Y&&z&&z.length&&(this.i7a(),z=this.ic.n_f(z,Y),this.xPd(z),this.ia.La(Bc.a.Y4e,Qj.a.execute,null))}lXd(z){return this.zad.has(z)}dHl(z){if(this.SQ=!!z&&0<=z.indexOf("Animation"))this.rFb=!0;this.g_a(this.SQ);this.SQ?(this.OIh(),this.je.Gy(new Xd.a(7))):this.i7a()}eHl(z){this.lz=z;this.i7a();this.g_a(this.SQ)}hHl(){var z=
this.pa.Xd();this.i7a();const Y=this.lz.gk();if(Y&&Y.length)if(z&&z.length){var m=new Set;for(const I of z)m.add(I.id);for(const I of Y)m.has(I.id)?this.huf(I):this.Rih(I)}else z=this.lz.LRc(Y),z.length&&(z=z.filter(I=>I.IsModifiedPreviously).map(I=>I.EffectNodeId),this.wPd(z,this.lz))}xPd(z){if(z&&z.length&&this.lz){this.YOd(z);var Y=this.lz.gk();if(Y&&Y.length){z=new Map;for(var m of this.vy){var I=Jc.a.Gf(m.ShapeId);if(!I){bd.a.J(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");
return}I=I.toString();z.has(I)||z.set(I,new Set);I=z.get(I);null===I||void 0===I?void 0:I.add(m.EffectNodeId)}for(const X of Y)if(m=this.icb.ZG(X))m.Baa(!1),Y=X.id.toString(),(Y=z.has(Y)?z.get(Y):null)&&Y.size&&m.E8k(Array.from(Y));this.je.Gy(new Xd.a(7))}}}huf(z){if(z){var Y=this.ic.jg(z);Y&&(Y=Y.Zwb(z),this.YOd(Y),this.icb.ZG(z).Baa(!0))}}Rih(z){z&&(z=this.icb.ZG(z))&&z.Baa(!1)}YOd(z){if(z&&z.length)for(const Y of z)this.lXd(Y.EffectNodeId)||(this.vy.push(Y),this.zad.add(Y.EffectNodeId))}g_a(z){if(this.rFb&&
this.lz&&this.lz.KQ&&this.Kc.Ic&&this.Kc.Ic.EHc){var Y=this.lz.gk();if(Y&&Y.length)for(const m of Y)if(Y=this.icb.ZG(m))Y.visible=z,Y.Fib()}}i7a(){this.zad.clear();this.vy.length=0}}Object(h.a)(Wf,"EffectSelectionManager",null,[520,106]);class yk{constructor(){this.K=null;this.ZCb=!1}get name(){return"PowerPointWebEditor.Animations"}Zb(z){this.K=z;(this.ZCb=this.K.resolve("PowerPointWebEditor.IApplicationContext").qd.Nrb)?(this.K.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().oa(()=>
new Uh.a((Y,m)=>{let I=null;const X=Object(B.a)(117,Y.sc(this.K.resolve("Box4.IPageView").Ma));X&&!X.Al&&X.xa&&(I=new gg(Y,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(X,X.PM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),O.AFrameworkApplication.ye,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),m,()=>{X.yDa()},this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager")),I.Jm(X.xa),I.setZIndex(4),I.visible=!1,X.PM(I.te.xa,!0),X.xra(I,4));return I})),this.K.register(Wf,"PowerPointWebEditor.Animations.IEffectSelectionManager").ma().oa(()=>new Wf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))):(this.K.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").ma().oa(()=>
new Uh.a((Y,m)=>{let I=null;const X=Object(B.a)(117,Y.sc(this.K.resolve("Box4.IPageView").Ma));X&&!X.Al&&X.xa&&(I=new Th(Y,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(X,X.PM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),O.AFrameworkApplication.ye,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),m,()=>{X.yDa()}),I.Jm(X.xa),I.setZIndex(4),I.visible=!1,X.PM(I.te.xa,!0),X.xra(I,4));return I})),this.K.register(Vi,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").ma().oa(()=>new Vi(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").xd(8),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.ZCb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.ZCb?
this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){Ma.a.instance.Dc(of.a(new yk,0))}}Object(h.a)(yk,"PPTWebEditorAnimationsPackage",null,[2,3]);var ak=d(1047),Im=d(124);class ml{constructor(z,Y,m,I){this.ia=z;this.Fa=Y;this.Cve=m;this.oc=I}wb(){this.ia.ya(Bc.a.find,Lc.a.view,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Bc.a.find,Lc.a.notes,Object(v.a)(this,
this.findText,"findText"));this.ia.ya(Bc.a.find,Lc.a.Of,Object(v.a)(this,this.findText,"findText"));this.ia.ya(na.a.findInDocument,Lc.a.view,Object(v.a)(this,this.findInDocument,"findInDocument"));this.ia.le(Bc.a.find,0);this.ia.ya(Bc.a.l1,Lc.a.view,Object(v.a)(this,this.l1,"replaceText"));this.ia.ya(Bc.a.l1,Lc.a.notes,Object(v.a)(this,this.l1,"replaceText"));this.ia.ya(Bc.a.l1,Lc.a.Of,Object(v.a)(this,this.l1,"replaceText"));this.ia.le(Bc.a.l1,4)}Ee(){const z=[this.Fa.Fc(Im.a.PD),this.Fa.Fc(Im.a.Y2),
this.Fa.Fc(jf.a.sg),this.Fa.Fc(jf.a.kQ)];for(const Y of z)Y.bindAction(Ac.KeyInputManager.Oa(ng.a.Cpa,Ac.KeyInputManager.Oe),Bc.a.find),Y.bindAction(Ac.KeyInputManager.Oa(ng.a.Emb,Ac.KeyInputManager.Oe),Bc.a.l1)}findText(z,Y,m){return Y.contextId!==Lc.a.view&&Y.contextId!==Lc.a.notes&&Y.contextId!==Lc.a.Of?2:1===m?this.oc.qj()?32:8:2===m?(this.Cve.Zyh(Y),bd.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}l1(z,Y,m){return Y.contextId!==Lc.a.view&&Y.contextId!==Lc.a.notes&&Y.contextId!==
Lc.a.Of?2:1===m?this.oc.qj()?32:8:2===m?(this.Cve.Yrl(Y),bd.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(z,Y,m,I,X){if(Y.contextId!==Lc.a.view&&Y.contextId!==Lc.a.notes&&Y.contextId!==Lc.a.Of)return 2;if(1===m)return 32;if(2===m){if(!X)return 8;z=X.CommandValueId||"";bd.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",z.length);this.Cve.Frl(Y,z);bd.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(h.a)(ml,"FindReplaceTextActor",
null,[365]);var Lk=d(1238);class Jm extends Lk.a{constructor(z,Y,m){super(!1,!0);this.gte=!1;this.vad=null;this.VDb=!1;this.Oxg=this.bzg=null;this.Bve=!0;this.Lve=this.Mve=this.Kve=!1;this.Nma=null;this.O$c=!1;this.gBe=!0;this.tUg=this.Nxe=!1;this.$Rg=this.bSg=null;this.IHg=0;this.Fa=z;this.M9=Y;this.Xik="FindReplaceTextDialog";this.h0=ResourceStrings.l_FindTextTitle;m&&(this.h0=ResourceStrings.l_ReplaceTextTitle);this.Qxe=m;this.KV=!1}j6(){this.aj(this.h0,this.M9,this.I8());this.gte=!1}dispose(){super.dispose();
this.gte=!0}WNi(){this.Kve=this.Bve=!1;this.K6(this.h0,this.M9,this.I8())}bSf(z){z&&(this.Fa.rf(kd.AFrame.z5),this.Kve=!0);this.Bve=!0;this.K6(this.h0,this.M9,this.I8())}m8b(){this.hide()}Ual(z){this.vad=z.searchString;this.VDb=z.matchCase;this.Nma=z.replaceString}Al(){return this.gte}k0a(z,Y){this.Oxg=z;this.IHg=Y;this.tUg=0===Y;this.K6(this.h0,this.M9,this.I8())}kpd(z){this.bzg=z;this.K6(this.h0,this.M9,this.I8())}Gpd(z){this.bSg=z;this.K6(this.h0,this.M9,this.I8())}IWe(z){this.$Rg=z;this.K6(this.h0,
this.M9,this.I8())}get O_a(){return this.vad}set O_a(z){this.vad=z}get matchCase(){return this.VDb}set matchCase(z){this.VDb=z}get qSe(){return this.Nma}set qSe(z){this.Nma=z}XRi(z){z&&(this.Fa.rf(kd.AFrame.z5),this.Mve=!0);this.O$c=!0;this.K6(this.h0,this.M9,this.I8())}n0d(){this.Mve=this.O$c=!1;this.K6(this.h0,this.M9,this.I8())}WRi(z){z&&(this.Fa.rf(kd.AFrame.z5),this.Lve=!0);this.gBe=!0;this.K6(this.h0,this.M9,this.I8())}YNi(){this.Lve=this.gBe=!1;this.K6(this.h0,this.M9,this.I8())}Ztl(){this.h0=
ResourceStrings.l_ReplaceTextTitle;this.Qxe=!0;this.O$c=!1;this.K6(this.h0,this.M9,this.I8());this.Fa.rf(kd.AFrame.z5)}VRi(){this.Nxe=!0;this.K6(this.h0,this.M9,this.I8())}m5i(){return{["searchString"]:this.vad,["findNextButtonAriaLabel"]:this.bzg,["errorMessage"]:this.Oxg,["findNextButtonIsEnabled"]:this.Bve,["focusFindNextButton"]:this.Kve,["focusDialog"]:Object(v.a)(this,this.o0i,"focusDialog"),["isReplaceActive"]:this.Qxe,["replaceButtonIsEnabled"]:this.O$c,["replaceAllButtonIsEnabled"]:this.gBe,
["showMessageAsError"]:this.tUg,["messageStatus"]:this.IHg,["focusReplaceButton"]:this.Mve,["focusReplaceAllButton"]:this.Lve,["replaceButtonAriaLabel"]:this.bSg,["replaceAllButtonAriaLabel"]:this.$Rg,["readOnlyModeEnabled"]:this.Nxe}}I8(){return{["id"]:this.Xik,["bodyControls"]:this.m5i(),["isModal"]:!1}}o0i(){this.Fa.rf(kd.AFrame.z5)}}Object(h.a)(Jm,"ReactFindReplaceTextDialog",Lk.a,[559]);class Mk{constructor(z){this.Fa=z}getInstance(z,Y){return new Jm(this.Fa.value,z,Y)}}Object(h.a)(Mk,"FindReplaceTextDialogFactory",
null,[499]);class vh{constructor(){this.z6=this.Ega=this.paragraphIndex=this.PR=this.slideIndex=0}reset(){this.slideIndex=this.PR=this.paragraphIndex=0;this.Ega=this.z6=-1}clone(){const z=new vh;z.slideIndex=this.slideIndex;z.PR=this.PR;z.paragraphIndex=this.paragraphIndex;z.Ega=this.Ega;z.z6=this.z6;return z}}Object(h.a)(vh,"TextPosition",null,[]);class Ij{constructor(){this.uye=this.t4c=null;this.gP=new vh;this.km=new vh;this.state=this.Qya=0;this.$sb=this.G2d=!1;this.pattern=this.d2b=this.f2b=
null;this.matchCase=!1;this.reset()}reset(){this.Qya=0;this.gP.reset();this.km.reset();this.state=0;this.$sb=this.G2d=!1;this.uye=this.gRa=this.d2b=this.f2b=null}get gRa(){return this.t4c}set gRa(z){if(this.t4c=z)this.uye=this.t4c}get g_j(){return this.uye}}Object(h.a)(Ij,"FindContext",null,[]);var nj=d(53),am=d(94);class pn{constructor(){this.ShouldMatchCase=!1}}Object(h.a)(pn,"MatchTextInfo",null,[]);class lm{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=
null}}Object(h.a)(lm,"ReplaceAllTextInfo",null,[]);var Km=d(966),mm=d(162),$k=d(977),nl=d(327);class Af{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob,sc,wc,Lb,$b,Oc,md,zd,le,df,bf,Hg){this.VHa=this.vm=this.mE=null;this.Bd=new Ij;this.Nma=this.$F="";this.Mfc=!1;this.XEb=this.Aeb=0;this.WEb=Date.now();this.N$c=-1;this.Ave=0;this.r$c=-1;this.ia=z;this.Udc=Y;this.Fa=m;this.Nq=I;this.oc=X;this.Ea=ta;this.Yl=Fa;this.Nva=bb;this.Fb=yb;this.zb=Bb;this.Vb=pb;this.ua=Ob;this.Pb=sc;this.Jb=$b;this.je=wc;this.Iq=
Lb;this.lJ=Oc;this.uIa=md;this.cHg=zd;this.afb=le;this.Cfk=df;this.NL=Hg;this.aSg=bf}Zyh(z){this.mE=z;this.vm=this.cHg.value.getInstance(Object(v.a)(this,this.RWf,"findReplaceTextDialogResultHandler"),!1);this.$F&&(this.vm.O_a=this.$F,this.r$c=-1);this.vm.j6();3!=this.ia.mode&&this.vm.VRi();this.YUa()&&this.l0d()}Frl(z,Y){this.YUa()||(this.$F=Y);this.Zyh(z);this.YUa()||(this.vm.O_a=this.$F,this.vm.j6(),this.v3e(Y,!1))}Yrl(z){this.mE=z;this.vm=this.cHg.value.getInstance(Object(v.a)(this,this.RWf,"findReplaceTextDialogResultHandler"),
!0);this.$F&&(this.vm.O_a=this.$F);this.vm.j6();this.YUa()&&this.l0d()}RWf(z,Y){if(Y)switch(this.vm.Ual(Y),z){case 1:this.atk();break;case 2:this.btk();break;case 3:this.ctk(this.vm.qSe);break;default:this.Rll(),this.clearSelection(),this.Bd.reset(),this.vm.m8b()}else bd.a.J(512496416,820,10,"Got null control value for findreplace dialog")}Dbg(){return this.Bd.f2b&&this.EOd!==this.Bd.f2b.me}v3e(z,Y){this.xPf();if(0===this.Bd.state||3===this.Bd.state||z!==this.$F||Y!==this.Mfc||this.Dbg())this.qEj(z,
Y),this.r$c=-1;this.Bd.$sb=!1;this.wfd()}get EOd(){return this.ua.Ba?this.ua.Ba.me:0}qEj(z,Y){const m=z===this.$F&&3===this.Bd.state&&!this.Dbg(),I=this.Bd.gP.clone();this.Bd.reset();this.$F=z;this.Mfc=Y;m?this.Bd.gP=I.clone():(this.Bd.gP.slideIndex=this.EOd,this.iaj());this.Bd.km=this.Bd.gP.clone()}wfd(){this.KZi(this.$F,this.Mfc)?4!==this.Bd.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.B3b())}KZi(z,Y){var m=this.ua.presentation;if(!m)throw Error.argumentNull("Presentation is null");
if(m=m.slides||[],m.length){this.Bd.Qya=m.length;const I=m.length+this.Bd.gP.slideIndex;for(;this.Bd.km.slideIndex<=I;){const X=this.Bd.km.slideIndex%m.length,ta=this.MZi(m[X],z,Y,this.Bd.km.slideIndex===I?this.Bd.gP.PR:Af.wEe);if(ta&&(this.Bd.f2b=this.oc.zl(ta.Cb)))return!0;if(7===this.Bd.state)return this.Bd.$sb&&(bd.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.Bd.state=0),this.IFk(m[X]?m[X].Cb:null,z,Y);if(3===this.Bd.state)break;let Fa;(Fa=this.Bd.km).slideIndex=Fa.slideIndex+
1;this.Bd.km.PR=0}}else this.Bd.state=1;return!1}MZi(z,Y,m,I){if(!z)return null;var X=this.oc.zl(z.Cb),ta=this.Pb.Mc(X);X=X.mTa()||[];(ta=ta.Bb(27))&&X.push(ta);if(!X.length)return this.Bd.state=7,null;for(;this.Bd.km.PR<=Math.min(X.length-1,I);){if(this.Bd.d2b=this.LZi(X[this.Bd.km.PR],Y,m,this.Bd.km.PR===I?this.Bd.gP.paragraphIndex:Af.wEe))return z;let Fa;(Fa=this.Bd.km).PR=Fa.PR+1;this.Bd.km.paragraphIndex=0}return null}LZi(z,Y,m,I){if(!this.Yl.yFa(z)&&z.gB)return null;const X=am.a.createInstance(z);
let ta=0;for(;X.moveNext()&&this.Bd.km.paragraphIndex<=I;){const Fa=X.currentNode;if(Vf.ParagraphReader.ae(Fa)&&ta++===this.Bd.km.paragraphIndex){if(this.Bd.gRa=this.IZi(Fa,Y,m,this.Bd.km.paragraphIndex===I?this.Bd.gP.Ega:Af.wEe))return z;let bb;(bb=this.Bd.km).paragraphIndex=bb.paragraphIndex+1;this.Bd.km.Ega=this.Bd.km.z6=-1}}return null}IZi(z,Y,m,I){if(!Vf.ParagraphReader.ae(z))return null;let X=z.Twb();if(!X.length)return null;X=X.substring(0,Math.min(X.length,I));return this.NZi(X,Math.max(0,
this.Bd.km.z6),Y,m)?z:null}NZi(z,Y,m,I){let X=z,ta=m;I||(X=z.toLowerCase(),ta=m.toLowerCase());z=X.indexOf(ta,-1===Y?0:Y);if(-1!==z)return this.Bd.km.Ega=z,this.Bd.km.z6=z+ta.length,this.Bd.state=2,this.Bd.G2d=!0;this.Bd.state=1;return!1}iaj(){var z=mm.b(this.mE);z=z?z.Mb:null;if(!z||!z.Na)e.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(z.Na.mb){var Y=z.Na.mb.Ua;if(Vf.ParagraphReader.ae(Y.node)){z=Object(B.a)(5,Y.node);this.Bd.gP.Ega=Y.Qa;this.Bd.gP.z6=Y.Qa;const m=this.Ea.oda(Y.node);
m?(this.Bd.gP.PR=m.get_zIndex()-1,this.Bd.gP.paragraphIndex=this.B5f(z)):this.Yl.rxb(Y.node)&&(Y=this.ua.Ba?this.ua.Ba.mTa():null,this.Bd.gP.PR=Y?Y.length:0,this.Bd.gP.paragraphIndex=this.B5f(z))}else this.Ea.MFa(Y.node)&&(this.Bd.gP.PR=Y.node.get_zIndex()-1)}}B5f(z){z=this.Pb.Mc(z);if(!z.G6(m=>10===m.type||60===m.type||16===m.type))return 0;z.zc();const Y=z.yq;z.zc();return Math.max(0,z.GSa(Y))}o0g(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");return this.Bd.gP.slideIndex||
this.Bd.gP.PR?this.Bd.km.slideIndex<(z.slides||[]).length:!1}l$f(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");this.Bd.km.slideIndex=z.slides?z.slides.length:0;this.Bd.$sb=!1;this.wfd()}sZc(){return this.vm.Al()}vsk(z){if(!this.sZc()){bd.a.J(512496409,820,50,"OnBackendFindSucceeded");var Y=Uf.a.empty;({slideId:Y}=Uf.a.QEh(z));(z=this.oc.pka(Y))?(Y=z.slideIndex,Y>this.Bd.gP.slideIndex&&Y<this.Bd.km.slideIndex?this.B3b():this.Vb.Ba!==z?(this.Nq.eW(Object(v.a)(this,
this.hHb,"onActiveSlideDomChanged")),this.Vb.Ba=z):(this.Bd.state=5,this.Bd.$sb=!0,this.Bd.km.slideIndex=this.Bd.km.slideIndex>Y?Y+this.Bd.Qya:Y,this.Bd.km.PR=0,this.Bd.km.paragraphIndex=0,this.Bd.km.Ega=-1,this.Bd.km.z6=-1,this.wfd())):this.o0g()?this.l$f():this.B3b()}}hHb(){bd.a.J(512496408,820,50,"OnActiveSlideDomChanged");this.Nq.Yxa(Object(v.a)(this,this.hHb,"onActiveSlideDomChanged"));this.sZc()||this.VHa||(this.VHa=new ae.a(3,1,0,Object(v.a)(this,this.YIe,"onPostActiveSlideDomChangedTask"),
90,"30"),this.zb.Db(this.VHa))}YIe(){bd.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.VHa=null;if(!this.sZc())if(4===this.Bd.state){const z=this.EOd;this.Bd.km.slideIndex=this.Bd.km.slideIndex>z?z+this.Bd.Qya:z;this.Bd.state=5;this.Bd.$sb=!0;this.wfd()}else 2===this.Bd.state?this.setSelection():this.B3b()}usk(){this.sZc()||(bd.a.J(512496406,820,50,"OnBackendFindFailed"),this.o0g()?this.l$f():this.B3b())}IFk(z,Y,m){bd.a.J(512496405,820,50,"PerformBackendFind");this.Udc.findText(Y,m,
z.toString(),Object(v.a)(this,this.vsk,"onBackendFindSucceeded"),Object(v.a)(this,this.usk,"onBackendFindFailed"));this.Bd.state=4;return!0}B3b(){this.Bd.state=this.Bd.G2d?3:1;bd.a.J(512496404,820,50,"End of Find: {0}",this.Bd.state);this.clearSelection();this.k0a(0,"")}getShapeType(z){return z.ux?ResourceStrings.L_TextBox:z.hr?ResourceStrings.l_Chart:z.ud?ResourceStrings.L_Table:z.Qf?ResourceStrings.L_SmartArt:z.Op?ResourceStrings.L_Media:z.Hj?ResourceStrings.l_Picture:z.fl?ResourceStrings.l_Placeholder:
ResourceStrings.l_ShapeObject}setSelection(){var z=this.Bd.gRa,Y=this.Bd.f2b;if(this.Vb.Ba!==Y)this.Nq.eW(Object(v.a)(this,this.hHb,"onActiveSlideDomChanged")),this.Vb.Ba=Y;else{z=nj.SelectionFactory.k3(z,this.Bd.km.Ega,this.Bd.km.z6);if(this.Yl.yFa(this.Bd.d2b))this.ia.La(Bc.a.pLa,2,new Km.a(!0)),this.Fa.rf(Im.a.Y2),this.Nva.setSelection(z),this.k0a(this.Bd.km.slideIndex%this.oc.qj()+1,ResourceStrings.l_NotesPaneType);else{Y=this.Bd.d2b;const m=this.Bd.d2b.ng(this.Fb.Ma);if(m)if(m.aq){let I;(I=this.Bd.km).PR=
I.PR+1;this.Bd.km.paragraphIndex=0;this.Bd.km.Ega=0;this.Bd.km.z6=0;m.ord()}else this.Cfk&&Y.Qf?(this.je.Efh(new nl.a(Y)),this.uIa.setSelection(z)):(this.Fa.rf(jf.a.sg),this.Fb.setSelection(z));this.k0a(this.Bd.km.slideIndex%this.oc.qj()+1,this.getShapeType(Y))}bd.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.Bd.km.slideIndex,this.Bd.km.PR,this.Bd.km.paragraphIndex,this.Bd.km.Ega,this.Bd.km.z6);this.G1d()}}clearSelection(){var z=mm.b(this.mE);if(z=z?z.Mb:null){var Y=this.Bd.g_j;Y&&
(Y=nj.SelectionFactory.Sg(Y,0),z.setSelection(Y))}else bd.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}k0a(z,Y){const m=new Sys.StringBuilder,I=new Sys.StringBuilder;let X=!1;z!=this.r$c?(this.r$c=z,this.Ave=1):this.Ave++;switch(this.Bd.state){case 1:X=!0;m.append(ResourceStrings.l_FindTextNotFound);break;case 3:m.append(ResourceStrings.l_FindTextFindOver);break;case 6:X=!0;m.append(ResourceStrings.l_FindTextFindAgain);break;case 2:I.append(String.format(ResourceStrings.l_FindTextMessageWithCount,
this.Ave,z,Y));break;default:bd.a.J(512496400,820,50,"Find Text: {0}",this.Bd.state)}this.cdl(m.toString(),X,I.toString());this.G1d()}Hzl(z){z=this.F1k(z);32===z&&this.v3e(this.$F,this.Mfc);16===z&&(this.vm.k0a(ResourceStrings.l_ReplaceTextErrorMessage,0),this.vm.n0d(),this.vm.bSf(!0))}F1k(z){return od.a.M2d("SingleReplaceAction",Bc.a.l1,()=>{z||(z="",bd.a.J(512496399,820,50,"Replacing with empty string"));var Y=this.Bd.gRa;if(!Y)return bd.a.J(512496398,820,10,"ParagraphNode not set in findContext"),
16;var m=this.Bd.km.Ega;const I=this.Bd.km.z6;if(-1===m||-1===I)return bd.a.J(512496397,820,10,"Invalid start or end position of current text selection."),16;const X=this.Iq.oe(15);X.kd(Y);this.lJ.replaceTextRange(Ag.a.createTextRange(Y,m,I),z,!0,!1,Bc.a.l1);Y=m+z.length;m=Y!==this.Bd.km.z6;this.Bd.km.z6=Y;X.dispose();m&&this.setSelection();return 32})}G1d(){this.vm.bSf(1===this.Aeb);this.gSf();this.vm.WRi(3===this.Aeb)}gSf(){this.Bd.gRa?this.vm.XRi(2===this.Aeb):this.vm.n0d()}xPf(){this.vm.WNi();
this.vm.n0d();this.vm.YNi()}cdl(z,Y,m){2===this.Aeb?(this.vm.Gpd(ResourceStrings.l_ReplaceTextReplaced+". "+m),this.vm.kpd("")):(this.vm.kpd(m),this.vm.Gpd(""));this.vm.IWe("");this.vm.k0a(z,Y?0:1)}UUi(z,Y){const m=od.a.zk("FindNext");m.Va("CommandId",z.toString());m.Va("IsReadOnlyModeEnabled",this.vm.Nxe.toString());try{Y()}finally{m.finish(!0)}}atk(){ob.a.Wa(this.vm.O_a)||this.UUi(Bc.a.find,()=>{bd.a.J(512496396,820,50,"Find Text Started");this.Aeb=1;this.v3e(this.vm.O_a,this.vm.matchCase);return 32})}btk(){this.vm.Qxe?
(bd.a.J(512496394,820,50,"Replace Text Started"),this.Aeb=2,this.Hzl(this.vm.qSe)):(this.vm.Ztl(),bd.a.J(512496395,820,50,"Find dialog switched to replace dialog"),this.gSf())}ctk(z){this.YUa()?bd.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.XEb,Date.now()-this.XEb):ob.a.Wa(this.vm.O_a)||(Wd.a("FixReplaceAllTimeOutError")&&(this.ua.presentation.Yfa=-16),this.$F=this.vm.O_a,this.Nma=z?z:"",this.XEb=Date.now(),this.Aeb=3,this.l0d(),this.IYi(this.ua.Ba,
this.$F,this.Nma,this.Mfc),0<this.aSg&&(this.N$c=window.setTimeout(()=>{this.s6g()},this.aSg)),16===this.replaceAll()&&(this.WEb=Date.now(),this.pGf(),this.s6g()))}replaceAll(){return od.a.M2d("ReplaceAllAction",Bc.a.l1,()=>{bd.a.J(512496392,820,50,"ReplaceAll Text Started");const z=this.ua.presentation;if(z){const Y=this.Jb.Ad(15);try{Y.nc(z),this.afb.kk(Object(v.a)(this,this.dhb,"onPresentationPropertyChange")),z.CKb=Object.assign(new lm,{NewStr:this.Nma,OldStr:this.$F,ActiveSlideCid:this.ua.Ba.cid,
ActiveSlideSid:this.ua.Ba.sid,MatchTxtInfo:Object.assign(new pn,{ShouldMatchCase:this.vm.matchCase})})}finally{Y&&Y.dispose()}return 32}return 16})}IYi(z,Y,m,I){if(z){z=this.oc.zl(z.Cb);var X=this.Pb.Mc(z);z=z.mTa()||[];(X=X.Bb(27))&&z.push(X);if(z.length)for(X=0;X<=z.length-1;)this.RZi(z[X],Y,m,I),X++}else bd.a.J(512496391,820,50,"slide must not be null.")}RZi(z,Y,m,I){if(this.Yl.yFa(z)||!z.gB)for(z=am.a.createInstance(z);z.moveNext();){const X=z.currentNode;if(!Vf.ParagraphReader.ae(X))continue;
let ta=null;(ta=this.JZi(X,Y,I))&&ta.characterData.replace(Y,m)}}JZi(z,Y,m){if(!Vf.ParagraphReader.ae(z))return bd.a.J(512496390,820,50,"node must be ParagraphNode"),null;const I=z.Twb();return I.length?this.OZi(I,Y,m)?z:null:null}OZi(z,Y,m){let I=z,X=Y;m||(I=z.toLowerCase(),X=Y.toLowerCase());return-1!==I.indexOf(X,0)?!0:!1}dhb(z,Y){if(!this.YUa())bd.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(Y.property===ye.a.mSe){this.pGf();z=Object(B.a)(532,Y.node);if(-1!==z.Yfa){var m=2;if(0===
z.Yfa){Y=ResourceStrings.l_FindTextNotFound;var I=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;m=0;var X=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===z.Yfa?(Y=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,z.Yfa,this.$F,this.Nma),I=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,z.Yfa,this.$F,this.Nma)):(Y=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,z.Yfa,this.$F,this.Nma),I=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,
z.Yfa,this.$F,this.Nma)),X=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else X=ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,Y=I=ResourceStrings.l_ReplaceAllErrorMessage,m=0,bd.a.J(512496388,820,10,"Invalid ReplaceAllTextCount");this.WEb=Date.now();bd.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.WEb-this.XEb);this.aSf(Y,m);this.afb.Rm(Object(v.a)(this,this.dhb,"onPresentationPropertyChange"));this.vm.Al()&&this.TYe(X,I,10);z.Yfa=-16}}YUa(){return this.XEb>
this.WEb}l0d(){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.$F);this.vm.k0a(z,3);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.$F);this.vm.IWe(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.$F);this.vm.Gpd(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.$F);
this.vm.kpd(z);this.xPf()}aSf(z,Y){this.vm.k0a(z,Y);this.vm.IWe(z);this.vm.Gpd("");this.vm.kpd("");this.G1d()}Rll(){if(this.YUa()){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.$F);this.TYe(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,z,1024)}}TYe(z,Y,m){this.NL?(this.NL.r0d(),bd.a.J(512496385,820,50,"Callout notification called for Replace All operation"),z=Object.assign(new $k.a,{title:z,message:Y,timeoutInSeconds:m}),z=this.NL.dwh(z),z.DUa&&bd.a.J(512496384,820,
10,"Error in callout notification: Error:{0}",z.message)):bd.a.J(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}s6g(){let z=!1;this.YUa()&&(z=!0,this.WEb=Date.now());bd.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",z,this.WEb-this.XEb);this.aSf(ResourceStrings.l_ReplaceAllErrorMessage,0);this.afb.Rm(Object(v.a)(this,this.dhb,"onPresentationPropertyChange"));this.vm.Al()&&this.TYe(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,
ResourceStrings.l_ReplaceAllErrorMessage,10);this.ua.presentation.Yfa=-16}pGf(){-1!==this.N$c&&(window.clearTimeout(this.N$c),this.N$c=-1)}}Af.wEe=1024;Object(h.a)(Af,"FindReplaceTextHandler",null,[500]);class yl{constructor(z){this.xHg=this.hVg=null;this.VDb=!1;this.Z4=z}findText(z,Y,m,I,X){this.xHg=z;this.VDb=Y;this.hVg=m;this.Z4.DF(I,X,null)}get asl(){return this.hVg}get matchCase(){return this.VDb}get $cd(){return this.xHg}}Object(h.a)(yl,"FindTextManager",null,[498]);var oj=d(389),zl=d(110);
class Bm extends zl.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}Zk(){return 54}static eXd(z,Y,m){const I=new Bm;I.SlideID=m;I.MatchText=z;I.MatchCase=Y;return I}}Object(h.a)(Bm,"FindTextRequest",zl.a,[]);class va extends oj.a{constructor(z,Y,m,I){super();this.OGa=this.BIa=null;this.vO=this.x4=!1;this.Xcc=null;this.Sd=m;this.d3c=!1;this.Udc=Y;this.Xa=I;this.Mm=z;this.enabled=2;this.Mm.register(this)}DF(z,Y){this.d3c=!0;this.BIa=z;this.OGa=Y;this.Mm.zaa()}forceOutbound(){}zka(){return this.d3c&&
!this.x4}QN(){return!1}NTa(){return this.Vd&&2===this.Vd.status?!0:this.zka()}FKb(){if(1===this._state)this.Xcc=this.Xa.podSessionId,this.Vd.JH=Bm.eXd(this.Udc.value.$cd,this.Udc.value.matchCase,this.Udc.value.asl),this.Vd.status=1,this._state=3;else if(3===this._state&&this.Vd&&2===this.Vd.status){if(2!==this.Vd.statusCode)this.DH();else{if(!this.Vd.Qr||1!==this.Vd.Qr.length){this.DH();return}const z=this.Vd.Qr[0];0===z.StatusCode?(this.V0(),this.BIa&&this.BIa(z.SlideID)):(this.DH(z),124===z.StatusCode&&
this.Sd.zs(z.ServerError,this.Xcc))}this.Xcc=null}}DH(z=null){this.d3c=!1;this._state=1;bd.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",z?z.StatusCode:-1,this.Vd?ef.a[this.Vd.statusCode]:"NULL",this.Vd?this.Vd.Av:-1,this.vO,this.Xcc||"NULL");this.vO=!0;this.OGa&&this.OGa(-1,-1)}V0(){this.d3c=!1;this._state=1;bd.a.J(25012056,818,this.vO?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",
this.vO,this.Xcc||"NULL");this.vO=!1}dispose(){this.x4||(1===this._state&&this.Mm.unregister(this),this.x4=!0)}}Object(h.a)(va,"FindTextReplicator",oj.a,[106]);class Ki{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}Zb(z){this.K=z;this.K.register(498,"PowerPointWebEditor.IFindTextManager").ma().oa(()=>new yl(new va(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.ke("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.K.register(499,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().oa(()=>new Mk(this.K.ke("PowerPointWebEditor.IFocusManager")));const Y=new ak.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),this.K.resolve("PowerPointWebEditor.IRibbonPane").xa);this.K.register(500,"PowerPointWebEditor.IFindReplaceTextHandler").ma().oa(()=>new Af(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.ke("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").xd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
this.K.resolve("Common.IAppSettingsManager").Bc("ReplaceAllClientTimeoutMS",0),Y))}init(){let z=new ml(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),this.K.resolve("PowerPointWebEditor.IPresentationReader"));z.wb();z.Ee()}dispose(){}static main(){Ma.a.instance.Dc(of.a(new Ki,0))}}Object(h.a)(Ki,"PPTWebEditorFindTextPackage",null,[2,3]);class Jj{constructor(z){this.Ha=z}get fRd(){return"PowerPoint"}get vDf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get eNj(){return this.Ha.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get IAb(){return this.Ha.powerPointEditorFirstRunExperienceUIIsEnabled}get cog(){return this.Ha.powerPointEditorFirstRunExperienceTestIsEnabled}get S_i(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get TZg(){return 24}get Umh(){return 4E3}get Bpc(){return this.Ha.roamingServiceHandlerWebServiceBase||
""}}Object(h.a)(Jj,"FirstRunExperienceLauncherSettings",null,[519]);class al{constructor(z){this.fzg=z}Bml(z){this.fzg&&this.fzg.aZe(z)}}Object(h.a)(al,"FirstRunExperienceManager",null,[497]);class gh{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}Zb(z){if(!z)throw Error.argumentNull("container");this.K=z;this.K.register(497,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().oa(()=>new al(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").ff(()=>
{this.aZe()})}dispose(){}aZe(){var z=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!z)throw Error.argumentNull("appSettings");const Y=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");Y&&(z=new Jj(z),Y.Bml(z))}static main(){Ma.a.instance.Dc(new gh)}}Object(h.a)(gh,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var Nk=d(179),Pd=d(398);class bl{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(h.a)(bl,"CatchUpConfiguration",null,[]);class Lm{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(h.a)(Lm,"SharedControllerFactoryParameters",null,[]);const fj=(z,Y)=>{if(!z)throw Error.create(String.format("Argument {0} is null.",Y));},Ai=z=>{if(!z.navigationId)return bd.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const Y=window.atob(z.navigationId);return Y&&""!==Y?{["NavigationId"]:Y}:null}catch(Y){return bd.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",Y),null}};class dg{constructor(z){fj(z,"ActivityContentManager.IActionManagerExtended");
this.ia=z}doesContentExist(z){if(!z)return bd.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(z=Ai(z))?32===this.ia.La(na.a.avb,2,z):!1;default:return!1}}}Object(h.a)(dg,"ActivityContentManager",null,[463]);class Mm{constructor(z){this.An=z}shouldShowEmptyExperienceButton(){return O.AFrameworkApplication.g1c()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.An.La(na.a.Vrc,
2,null)}onInviteOthersButtonClick(){this.An.La(na.a.Xsa,2,null)}}Object(h.a)(Mm,"EmptyCatchUpBehaviorManager",null,[466]);class nc{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(h.a)(nc,"Person",null,[]);var nm=d(653),Rc=d(233),pf=d(168);class jk extends zl.a{constructor(z){super();this.StartTime=null;this.StartTime=z}Zk(){return 93}}Object(h.a)(jk,"GetFileRevisionHistoryRequest",zl.a,[]);class hg{constructor(z,Y,m){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=z;this.UserId=Y;this.ProviderId=m}}Object(h.a)(hg,"Author",null,[]);const qh=(z,Y)=>z&&Y?z.providerIdField===Y.ProviderId?z.userIdField===Y.UserId:z.userNameField===Y.UserName:!1;var Cj=d(246);class mf{constructor(z,Y,m){this.$5c=this.qcb=null;this.wi=z;this.Gcb=m;this.Gcb.mai(Object(v.a)(this,this.p4g,"onFileRevisionHistoryReady"));Y.ff(()=>{this.qcb=new hg(Y.Ga("UserName"),Y.Ga("387"),Y.Ga("388"))})}dispose(){this.Gcb.n_k(Object(v.a)(this,this.p4g,"onFileRevisionHistoryReady"));
this.qcb=null}R$i(z,Y,m){z&&m&&(this.$5c=m,z=new Cj.a(new jk(z),I=>{this.Lrg(I,Y);this.Agd(I)},I=>{this.Lrg(I,Y);return this.fhb(I)}),this.wi.Db(z))}p4g(z,Y){z=null;const m=[];ob.a.Wa(Y.gQc)||(({gQc:Y}=this.qBl(Y.gQc)).returnValue?pf.b(Y.fileRevisionEntriesField,I=>this.rSj(I.changesDataField),I=>{m.push(I.changesDataField)}):z="ErrorGetFileRevisionHistoryParseJsonException");this.eIe(m,z)}Agd(z){let Y=null;z.ServerError&&0!==z.ServerError.Code?Y=Rc.a[z.ServerError.Code]:0!==z.StatusCode&&(Y=nm.a[z.StatusCode]);
Y&&this.eIe(null,Y)}fhb(z){bd.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+z.toString());this.eIe(null,"ErrorGetFileRevisionHistoryFailed");return!0}eIe(z,Y){this.$5c&&(z=this.R3i(z),this.$5c(z,Y),this.$5c=null)}qBl(z){let Y;Y=null;try{Y=Sys.Serialization.JavaScriptSerializer.deserialize(z)}catch(m){bd.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+m)}return{returnValue:!!Y,gQc:Y}}rSj(z){return!qh(z,this.qcb)}Lrg(z,Y){z.aya&&Y.Zm("GetAuthorNamesRequestInvokedTime",
z.aya);Y.Va("GetAuthorNamesRequestCorrelationId",z.Kh)}R3i(z){if(!z)return[];const Y=Array(z.length);for(let I=0;I<z.length;I++){var m=z[I];m=Object.assign(new nc,{displayName:m.userNameField,id:m.userIdField,provider:m.providerIdField});Y[I]=m}return Y}}Object(h.a)(mf,"FileRevisionHistoryService",null,[485,106]);class L{constructor(z,Y){fj(z,"FlyoutFocus.IF6Manager");fj(Y,"FlyoutFocus.IFocusManagerHelper");this.Pg=z;this.nE=Y}initialize(){this.nE.a9(jf.a.Z6a,jf.a.hj,null,Object(v.a)(this,this.p0i,
"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.Pg.rI(jf.a.Z6a)}disableF6Focus(){this.Pg.Lo(jf.a.Z6a)}p0i(){const z=document.getElementById("flyoutItem0");z&&(bd.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),z.focus())}}Object(h.a)(L,"FlyoutFocus",null,[484]);class Cn{constructor(z,Y,m,I){this.J3c=null;this.cug=this.uAg=this.gDb=this.k7c=!1;fj(Y,"FlyoutRibbonButton.IActionManagerExtended");fj(m,"FlyoutRibbonButton.IFocusManager");fj(I,"FlyoutRibbonButton.FloodgateEventLogger");
this.Rb=z;this.ia=Y;this.Fa=m;this.T9j=I;this.X9j=new Date}initialize(){O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Wd.a("DelayRegisterCatchUpActions")||this.wb()}registerButtonClickedEvent(z){this.J3c&&bd.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.J3c=z.buttonClickedCallback}onFlyoutInitialized(){this.k7c&&bd.a.J(571532948,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");
const z=(new Date).getTime()-this.X9j.getTime();bd.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",z);this.k7c=!0;Be.c(na.a.dri,!0,Be.e,0,0,z);O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Wd.a("DelayRegisterCatchUpActions")&&this.wb();this.Rb&&this.Rb.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(z){this.gDb!==z.flyoutIsVisible&&(this.gDb=z.flyoutIsVisible,this.Rb&&this.Rb.updateCommandUI(!0),
this.gDb&&this.cug?this.Fa.rf(jf.a.Z6a):this.gDb||this.Fa.rf(jf.a.hj),this.gDb||this.T9j.$2j())}wb(){this.ia.ya(na.a.jDh,jc.a.frame,Object(v.a)(this,this.gAk,"onToggleCatchUpFlyout"));this.ia.ra(na.a.Geh,jc.a.frame,Object(v.a)(this,this.Rxk,"onQueryToggleCatchUpFlyout"),96)}gAk(z,Y,m){if(1===m)return this.k7c?(this.uAg||(this.uAg=!0,bd.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.J3c)return 8;this.cug=!0;this.J3c();return 32}Rxk(z,Y,m,I,X){X[Jd.a.Visible]=!0;X[Jd.a.On]=this.gDb&&
this.k7c;return 32}}Object(h.a)(Cn,"FlyoutRibbonButton",null,[483]);const oi=z=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+z)};class pj{constructor(z,Y,m,I,X,ta){fj(z,"PowerPointActivityNavigationManager.IActionManagerExtended");fj(Y,"PowerPointActivityNavigationManager.IPresentationReader");fj(m,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");fj(I,"PowerPointActivityNavigationManager.IRibbonUser");fj(ta,"PowerPointActivityNavigationManager.IActivityContentManager");
this.ia=z;this.oc=Y;this.Ge=m;this.tB=I;this.Lgk=X;this.P6j=ta}navigateToActivity(z){if(z.fromSummaryString)return this.ecl(),this.Nqj(),this.Kqj(),this.Ull(),Promise.resolve(1);z=z.activity;if(!z)return bd.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!z.navigationId)return bd.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),Promise.resolve(4);if(!this.P6j.doesContentExist(z))return Promise.resolve(2);switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:z=
Ai(z);if(!z)return Promise.resolve(5);z=this.ia.La(na.a.F0b,2,z);return Promise.resolve(32===z?1:6);default:return Promise.resolve(7)}}ecl(){const z=this.oc.$m;z?z.EDa=!0:bd.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}Nqj(){this.tB.selectRibbonTabById(this.Lgk)}Kqj(){var z=this.oc.$m;if(z&&z.slides){var Y=null;for(const m of z.slides)if(m&&(z=this.oc.zl(m.Cb))&&z.isUnread){Y=z;break}Y?(this.Ge.lpd(),this.Ge.IJ(Y.me)):bd.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else bd.a.J(570831451,
3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}Ull(){this.ia.La(Bc.a.Gkb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(h.a)(pj,"PowerPointActivityNavigationManager",null,[464]);var Nl=d(669);class Bi{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(Bi,"ActivityFeedEntry",null,[]);const Li=(z,Y)=>Y.a1c?Ya.toArray(Ya.select(Ya.asEnumerable(z),m=>{if(!m||!m.activityFeedItemPayload)return m;
const I=JSON.parse(m.activityFeedItemPayload);var X=I.actor;if(!X||X.pictureUrl)return m;const ta=X.userPrincipalName||X.email;if(!ta)return m;X=Y.rub(ta,X.provider,O.AFrameworkApplication.hh,0);if(!X)return m;I.actor.pictureUrl=X;return Object.assign(new Bi,{id:m.id,type:m.type,collectionId:m.collectionId,activityState:m.activityState,activityFeedItemPayload:JSON.stringify(I),timestamp:m.timestamp})})):z,Dj=(z,Y)=>{const m=new Map,I=new Map;for(const X of z){if(!X||!X.activityFeedItemPayload)continue;
z=JSON.parse(X.activityFeedItemPayload).actor;if(!z)continue;const ta=z.email||z.userPrincipalName;ta&&!I.has(ta)&&I.set(ta,new Nl.a(ta,null,z.name))}I.forEach(X=>{const ta=Y.Kta(X,6);m.set(X.UserId,ta)});return m};class zk{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(zk,"ActivityFeedItem",null,[]);class Ne{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(h.a)(Ne,"ActivityFeedPayload",
null,[]);class Ig{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(h.a)(Ig,"ActivityRequestPayload",null,[]);var Ok=d(537);class gj{constructor(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(h.a)(gj,"Activity",null,[]);class Ce{constructor(z,Y,m,I,X,ta,Fa,bb,
yb,Bb){this.Pf=this.Gye=null;fj(z,"PowerPointActivityRequestManager.IJsonpHelperManager");fj(Y,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");fj(m,"PowerPointActivityRequestManager.IFileRevisionHistoryService");fj(I,"PowerPointActivityRequestManager.IAppSettingsManager");fj(X,"PowerPointActivityRequestManager.IApplicationSettings");fj(ta,"PowerPointActivityRequestManager.IActionManagerExtended");fj(Fa,"PowerPointActivityRequestManager.ICatchUpRequestHandler");fj(bb,"PowerPointActivityRequestManager.IUserProfilePictureUtilsV2");
fj(yb,"PowerPointActivityRequestManager.IPeopleColorUtils");this.nHa=z;this.ukk=Y;this.L9j=m;this.Qb=I;this.ia=ta;this.Q3c=Fa;this.Sfk=bb;this.M9c=yb;this.MTg=Bb}requestWYWAActivities(){return new Promise((z,Y)=>{this.Pf=od.a.zk("ShowWYWACallout",2);this.ukk.O4k(m=>{m=this.cMk(m);Ce.isExpectedError(m)?z(Ce.aNc):m?(bd.a.J(509223009,3012,10,"OnReadRoamingSucceeded() - Error: {0}",m),Y(m)):this.L9j.R$i(this.Gye,this.Pf,(I,X)=>{X&&(bd.a.J(509223008,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",
X),Y(X));z(Ce.oBi(I))})},m=>{const I=!!m.data&&Ce.gOj(m.data.ie);m=this.nHa.hka(m);bd.a.J(509223007,3012,I?50:10,"OnReadRoamingFailed() - Error: {0}",m);I?z(Ce.aNc):Y(m)})})}requestActivities(){return Promise.resolve(Ce.aNc)}requestRelevantActivities(){return Promise.resolve(Ce.aNc)}requestActivityFeed(){return this.Q3c?Ok.b(this.Q3c.getActivityFeed(this.MTg)).then(z=>{z=Ce.Yyl(z);return{activityFeedItems:Li(z,this.Sfk),personaColorMap:Dj(z,this.M9c)}}):Promise.resolve(Object.assign(new Ne,{activityFeedItems:[]}))}updateActivityState(z){return this.Q3c?
Ok.b(this.Q3c.KDl(this.MTg,z.itemIds,z.activityStatesToSet||0,z.activityStatesToReset||0,z.resetUnseenCount)):Promise.resolve(!1)}cMk(z){z=z.data.Wd;if(!z)return"ErrorReadRoamingEmptyResponseBody";let Y;try{Y=JSON.parse(z)}catch(m){return m.toString()}z=null;if(!Y.Error){if(!Y.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");z=Y.Timestamp}this.Gye=this.ZHl(z);bd.a.J(509223006,3012,100,"Timestamp for retrieving activities: "+this.Gye);return Y.Error}ZHl(z){const Y={};
var m=this.Qb.Bc("AppWaterlineOverrideTimestampValue",0);return m?(z=new Date(1E3*m),Y.timestamp=z,this.ia.La(Bc.a.trd,2,Y),z.format("yyyy-MM-ddTHH:mm:ssZ")):z?(m=this.Qb.Bc("AppWaterlineOverrideDaysValue",0))?(z=new Date(+new Date(z)-+new Date(864E5*m)),Y.timestamp=z,this.ia.La(Bc.a.trd,2,Y),z.format("yyyy-MM-ddTHH:mm:ssZ")):z:null}static oBi(z){return z?Object.assign(new Ig,{actors:z}):null}static Yyl(z){const Y=[];if(!z)return Y;for(const m of z)Y.push(Object.assign(new zk,{id:m.id,type:m.type,
collectionId:m.collectionId,activityState:m.activityState,activityFeedItemPayload:m.activityFeedItemPayload,timestamp:m.timestamp}));return Y}static isExpectedError(z){return"ErrorDocNotInRoamingList"===z||"ErrorLastViewedDocListIsEmpty"===z}static gOj(z){return 403===z}}Ce.aNc=Object.assign(new Ig,{activities:[],actors:[],hasMore:!1,highWaterline:"",lowWaterline:"",wywaWaterline:""});Object.assign(new Ig,{activities:[Object.assign(new gj,{activityId:"activityId1",type:3,actors:[Object.assign(new nc,
{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new gj,{activityId:"activityId2",type:4,actors:[Object.assign(new nc,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});Object.assign(new Ne,{activityFeedItems:[Object.assign(new zk,{id:"FeedItemId1",type:"UserAtMentioned",
collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new zk,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(h.a)(Ce,"PowerPointActivityRequestManager",null,[465]);var Al=d(260);class qk{constructor(z,Y,m,I,X,ta){this.Vdb=!1;this.XGg=null;this.Oc=z;this.Ds=Y;this.Ugk=m;this.nHa=I;this.zb=X;this.pFb=ta}initialize(){this.Oc&&(this.Oc.LPa(Object(v.a)(this,this.kHb,"onBeforeSessionEnd")),this.Oc.LA(Object(v.a)(this,this.tM,"onSessionClosed")));this.I7k()}O4k(z,Y){const m=this.G6f("getPPTDocLastViewedTimestamp");this.Lx(m,1,z,Y)}kHb(){this.eLh()}tM(){this.Vdb=!0}I7k(){if(this.zb){var z=
new ae.a(3,2,3E4,Object(v.a)(this,this.N2k,"requestWriteWaterline"),90,"29");this.zb.Db(z)}}N2k(){!this.Vdb&&3E4<+od.a.gbc-+this.XGg&&(this.eLh(),this.XGg=od.a.gbc)}eLh(){const z=this.G6f("savePPTDocLastViewedTimestamp");this.pFb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.Ds.qya(z,""):this.Lx(z,2,Object(v.a)(this,this.RAk,"onWriteWaterlineSucceeded"),Object(v.a)(this,this.QAk,"onWriteWaterlineFailed"))}RAk(z){let Y=null;try{const m=z.data.Wd;Y=m?JSON.parse(m).Error:"ErrorWriteRoamingEmptyResponseBody"}catch(m){Y=
"ErrorWriteRoamingParseJsonResponseException",bd.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+m)}finally{Y&&this.asg(Y)}bd.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.qv-+z.data.AI,+z.data.Zt-+z.data.AI)}QAk(z){this.asg("ErrorReadRoamingFailed");bd.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.nHa.hka(z))}G6f(z){return this.Ugk+String.format("RoamingServiceHandler.ashx?action={0}&{1}",z,O.AFrameworkApplication.hh)}Lx(z,
Y,m,I){const X={};X["X-StatelessPopsAffinityRoutingEnabled"]=this.pFb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Ds.nj(z,Y,null,X,!1,1,m,I,null,void 0,void 0,void 0,void 0,Al.a("5"))}asg(z){bd.a.J(572555924,811,50,z)}}Object(h.a)(qk,"PowerPointWaterlineUpdater",null,[]);class eg{get name(){return"PowerPointWebEditor.Activity"}get Vie(){return O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(v.a)(this,
this.FLi,"delayedInit"))}Zb(z){this.K=z}dispose(){this.K=this.P3c=null}Pil(z){return!z||z.ka("IsAnonymousUser")?!1:z.ka("PPTCatchUpFlyoutIsEnabled")}FLi(){const z=this.K.resolve("Common.IAppSettingsManager");this.Pil(z)&&(oi("Begin"),this.YPi(),this.H3j())}YPi(){Nk.a.get_instance().Uj(7,()=>{oi("ScriptDownload");Dg.a(this.K)("catchUpActivity").catch(()=>{bd.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>this.fEj()).catch(()=>{bd.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}H3j(){bd.a.J(589608192,
3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Vie&&bd.a.J(526718752,3012,50,"ActivityFeedData is enabled")}fEj(){const z=new mf(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),Y=this.K.resolve("Common.AFrameworkApplication");this.K.register(qk,"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().oa(()=>new qk(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
O.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(463,"Common.App.CatchUpActivity.IActivityContentManager").ma().oa(()=>new dg(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(464,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().oa(()=>
new pj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),Ge.a.eSk,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let m=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").vg&&(m=this.K.resolve("Common.IAppSettingsManager").Ga("368")+"p");this.K.register(465,"Common.App.CatchUpActivity.IActivityRequestManager").ma().oa(()=>
new Ce(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),z,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),this.K.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.K.resolve("Common.App.People.IPeopleColorUtils"),m));this.K.register(Cn,
"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().oa(()=>new Cn(Y.wq,O.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(L,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().oa(()=>new L(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));
this.K.register(466,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().oa(()=>new Mm(this.K.resolve("Common.IActionManagerExtended")));this.P3c=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new Lm,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),
dataCulture:O.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.Vie?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:O.AFrameworkApplication.uiCulture,ulsLogger:new Pd.a}));if(!this.P3c)return Promise.reject("Failure to create CatchUpApp");this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();
this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.P3c.setWebpackPublicPath(O.AFrameworkApplication.tga);oi("InitializeCatchUpApp");return this.P3c.initialize(Object.assign(new bl,{activityFeedDataEnabled:this.Vie,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){Ma.a.instance.Dc(of.a(new eg,0))}}Object(h.a)(eg,"PPTWebEditorActivityPackage",null,[2,3]);
var Lf=d(737);class om extends Sys.EventArgs{constructor(z,Y){super();this.shape=z;this.EDa=Y}}Object(h.a)(om,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class yc{constructor(z,Y,m,I,X,ta,Fa){this.Pf=null;this.ia=z;this.ua=Y;this.pR=m;this.gad=I;this.Tb=X;this.Lc=ta;this.mfb=Fa}dispose(){this.Pf&&(this.Pf=null)}Ee(){}wb(){this.ia.ya(Bc.a.lEe,If.a.application,Object(v.a)(this,this.Cuj,"handleMarkAsRead"));this.ia.ya(Bc.a.Gkb,If.a.application,Object(v.a)(this,this.Exj,"handleShowHideChanges"));
this.ia.ra(Bc.a.IOe,Lc.a.application,Object(v.a)(this,this.iwj,"handleQueryShowHideChanges"),96);this.ia.ra(Bc.a.trd,If.a.application,Object(v.a)(this,this.Fxj,"handleShowRevisionTrackingWithUrlOverrides"),96)}Cuj(z,Y,m,I,X){if(1===m)return this.Tb.qj()?32:8;z=new Date;if(!X)throw Error.argumentNull("actionData is null");if(X.SlideNode){if(X=Object(B.a)(116,X.SlideNode))bd.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",X.slideIndex+1)),this.pR.Vac?this.pR.Vcd(X,!0):
(X.mX=z,this.pR.BQe(X))}else this.mEe(z);return 32}mEe(z){const Y=this.ua.presentation;if(!Y)throw Error.argumentNull("Presentation is null");this.Pf=od.a.zk("MarkActivitiesAsRead",1);bd.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.pR.Vac?this.pR.mEe():(pf.b(Y.slides||[],null,m=>{if(m=Object(B.a)(116,m))m.mX=z}),this.pR.ahh())}Exj(z,Y,m,I,X){if(1===m)return this.Tb.qj()?32:8;const ta=this.Tb.$m;z=this.ua.Ba;if(!(ta&&z&&z.isConnected&&X))return 16;m=
Y=!1;switch(X.ShowRevisionTrackingStatus){case 0:m=Y=!1;break;case 2:Y=!0;m=!1;break;case 3:m=Y=!0;break;case 1:Y=ta.EDa&&!this.pR.XVd?!0:!ta.EDa;m=!0;break;default:return 8}if(this.pR.XVd&&!m)return 32;X=X.InvokeSource;ta.EDa=Y;this.pR.XVd=Y&&m;m&&this.mfb.m5j(X,Y);X=z.gk();pf.b(X,null,Fa=>{this.gad.cRk(new om(Fa,ta.EDa))});this.Lc.Gy(new Xd.a(1));return 32}iwj(z,Y,m,I,X){z=this.Tb.$m;if(!z)return 16;X.Lf(z.EDa);return 32}Fxj(z,Y,m,I,X){z=this.ua.presentation;if(!X||!z||!z.slides)return 8;X=X.timestamp;
if(!X)return 8;for(const ta of z.slides)Object(B.a)(116,ta).mX=X;this.pR.CQe(z.slides);return 32}}Object(h.a)(yc,"RevisionTrackingActor",null,[365,106]);class Dn{constructor(z){this.backgroundColor=this.foregroundColor=null;z&&z.isInHighContrastMode&&z.highContrastColors?(this.foregroundColor=z.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=z.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=this.foregroundColor="#006BFF"}}Object(h.a)(Dn,"RevisionTrackingColorProvider",
null,[]);class Ol{constructor(){this.va=new hi.a}gRk(z){this.va.raiseEvent("SlideUSC",z)}qQd(z){this.va.addHandler("SlideUSC",z)}TRe(z){this.va.removeHandler("SlideUSC",z)}KQk(z){this.va.raiseEvent("ShapeUSC",z)}Nbi(z){this.va.addHandler("ShapeUSC",z)}j0k(z){this.va.removeHandler("ShapeUSC",z)}cRk(z){this.va.raiseEvent("ShowHideSC",z)}Ybi(z){this.va.addHandler("ShowHideSC",z)}q0k(z){this.va.removeHandler("ShowHideSC",z)}}Object(h.a)(Ol,"RevisionTrackingEventSource",null,[487,488,489]);class ii extends Sys.EventArgs{constructor(z,
Y){super();this.shape=z;this.slide=Y}}Object(h.a)(ii,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class zh{constructor(){this.cid=this.sid=0}}Object(h.a)(zh,"Slide",null,[]);class Wi{constructor(z,Y){this.dt=this.mk=null;this.mk=Object.assign(new zh,{sid:z.sid,cid:z.cid});this.dt=Y}}Object(h.a)(Wi,"SlideLastViewedVersion",null,[]);class ch{constructor(){this.v=0;this.lv=this.defLv=null;this.v=1}}Object(h.a)(ch,"SlideLastViewedVersions",null,[]);class M extends Sys.EventArgs{constructor(z){super();
this.slide=z}}Object(h.a)(M,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class N{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob,sc,wc,Lb,$b){this.Ocb=this.qcb=null;this.ezg=!1;this.Bwe=null;this.o8c=0;this.NDb=this.wfc=null;this.nAe=[];this.u$c=null;this.Ead=!1;this.Ixa=null;this.kce=this.jce=this.XVd=!1;bd.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");this.xBe=z;this.ua=Y;this.zb=m;this.ic=I;this.Tb=X;this.ld=ta;this.Aic=Fa;this.Oc=bb;this.Qk=yb;this.gad=pb;
this.UTg=Bb;this.Qb=sc;this.Akk=Ob.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.fFg=Ob.JUj;this.kUg=!0;this.xH=!1;this.eIa=new fc.a;this.Oc.gHc(Object(v.a)(this,this.Ona,"onSessionAccessTokenExpired"));O.AFrameworkApplication.$z&&this.Oc.kHc(Object(v.a)(this,this.Efa,"onWopiTokenRefreshed"));this.Qb.ff(()=>{this.jce=!0;this.initialize();this.ahh();this.jce=!1});this.mfb=wc;this.Fb=Lb;this.Qhk=$b}get Vac(){return Wd.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.qcb&&(this.ld.Yxa(Object(v.a)(this,
this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.ld.fmd(Object(v.a)(this,this.hZa,"onShapeViewElementAdded")),this.Aic.BRe(Object(v.a)(this,this.$gb,"onMarkedUndo")),this.Oc.QRe(Object(v.a)(this,this.kHb,"onBeforeSessionEnd")),this.Oc.qaa(Object(v.a)(this,this.tM,"onSessionClosed")),this.Oc.Xfa(Object(v.a)(this,this.Eo,"onSessionRehydrated")),this.Qk.u0k(Object(v.a)(this,this.h7g,"onSlideChangesDataChanged")),this.Qk.$_k(Object(v.a)(this,this.g6g,"onPresentationLastModifiedTimeReceived")),
this.fFg&&this.UTg.Rm(Object(v.a)(this,this.U6g,"onShapePropertyChanged")),this.Oc.Pjh(Object(v.a)(this,this.Ona,"onSessionAccessTokenExpired")))}initialize(){bd.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.Bwe=new Date;this.o8c=this.Bwe.getTime();this.gal();this.ld.eW(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.ld.XYb(Object(v.a)(this,this.hZa,"onShapeViewElementAdded"));this.Aic.UYb(Object(v.a)(this,this.$gb,"onMarkedUndo"));this.Oc.LPa(Object(v.a)(this,
this.kHb,"onBeforeSessionEnd"));this.Oc.LA(Object(v.a)(this,this.tM,"onSessionClosed"));this.Oc.iC(Object(v.a)(this,this.Eo,"onSessionRehydrated"));this.Qk.dci(Object(v.a)(this,this.h7g,"onSlideChangesDataChanged"));this.Qk.sbi(Object(v.a)(this,this.g6g,"onPresentationLastModifiedTimeReceived"));this.fFg&&this.UTg.kk(Object(v.a)(this,this.U6g,"onShapePropertyChanged"));this.Ixa=this.ua.Ba;this.Ocb=this.X8i();this.getSlideLastViewedVersions();const z=new ae.a(3,2,this.Akk,()=>{this.getSlideLastViewedVersions()},
90,"12");this.zb.Db(z)}onActiveSlideDomReady(z,Y){z=Object(B.a)(116,Y.Ba);this.Ixa&&z!==this.Ixa&&this.hYe()&&(this.Ixa.isConnected&&(this.Ixa.isUnread&&this.Vcd(this.Ixa,!0),!this.Vac&&this.Ixa.changesData&&(this.Ixa.mX=this.Ixa.changesData.dtField)),z&&z.isUnread&&this.khh(z));this.Ixa=z;this.o8c=Date.now()}$gb(z,Y){Y.actionId!==he.a.gUa&&Y.Nzb&&(z=this.ua.Ba)&&z.isConnected&&z.isUnread&&this.hYe()&&this.Vcd(z,!0)}kHb(){this.hYe()&&this.JDl();this.Cwd()}tM(){this.mfb.log();this.xH=!0}Eo(){this.xH=
!1;this.wfc&&this.XGh(this.wfc)}XGh(z){var Y=this.ua.presentation;if(!Y)throw Error.argumentNull("Presentation is null");Y=Y.slides||[];0<Y.length&&(this.tHl(Y,z),this.CQe(Y))}Yxk(z){this.kce=!0;bd.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");z&&(this.eIa=new fc.a,this.forEach(z.lv,I=>{const X=I.mk.sid;(!this.eIa.Gb(X)||this.eIa.ga(X).dt<I.dt)&&this.eIa.$(X,I)}));const Y=od.a.gbc;let m=!1;this.NDb&&this.xBe.dZj&&Y!==this.NDb&&(this.wfc&&D.c(this.PZf())===D.c(this.wfc)||(m=!0));z&&z.defLv&&
(this.Ocb=z.defLv,this.kUg=!1,z.lv&&0<z.lv.length&&this.XGh(z));m&&this.Cwd();this.NDb=od.a.gbc;this.kce=!1}h7g(z,Y){this.forEach(Y.slides,m=>{this.tje(m.changesData)||(this.ua.Ba&&m.Cb!==this.ua.Ba.Cb||this.Xzj(Object(B.a)(116,m)))&&this.BQe(Object(B.a)(116,m))})}g6g(z,Y){this.kUg&&(this.Ocb=Y.BKk)}U6g(z,Y){z=Y.property;Y=Object(B.a)(4,Y.node);z===ye.a.YKb&&(z=this.ic.jg(Y),z===this.ua.Ba&&z.isUnread&&Y.changesData.dtField<=z.changesData.dtField&&(bd.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",
Date.now()-this.o8c),this.AQe(this.ua.Ba,Y)))}hZa(z,Y){z=Y.Px.shapeNode;this.ua.Ba.isUnread&&this.sbb(this.ua.Ba.Cb,z)&&!this.tje(z.changesData)&&(this.nAe.push(z),this.u$c||(this.u$c=new ae.a(2,1,0,Object(v.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),90,"13"),this.zb.Db(this.u$c)))}getSlideLastViewedVersions(){this.xH||this.Ead||this.xBe.getSlideLastViewedVersionInfo(Object(v.a)(this,this.Yxk,"onReceiveLastViewedVersionInfo"))}Cwd(){if(!this.xH&&!this.Ead){var z=this.PZf();
this.xBe.putSlideLastViewedVersionInfo(z);this.wfc=z}}PZf(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");const Y=Object.assign(new ch,{defLv:this.Ocb}),m=[];this.forEach(z.slides||[],I=>{I=I.Cb;const X=this.Tb.zl(I);X&&X.mX&&(!I.cid&&this.eIa.Gb(I.sid)?I=Uf.a.VE(I.sid,this.eIa.ga(I.sid).mk.cid):I.cid&&this.eIa.Gb(I.sid)&&I.cid!==this.eIa.ga(I.sid).mk.cid&&bd.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",I.sid,
this.eIa.ga(I.sid),I.cid),m.push(new Wi(I,X.mX)))});Y.lv=m;return Y}tHl(z,Y){const m=Y.lv;this.forEach(z,I=>{const X=Object(B.a)(116,I);this.forEach(m,ta=>{X&&this.Mgi(X,ta.mk)&&(!X.mX||X.mX<ta.dt)&&(X.mX=ta.dt)})})}Mgi(z,Y){return z.cid&&Y.cid?z.sid===Y.sid&&z.cid===Y.cid:z.sid===Y.sid}CQe(z){this.forEach(z,Y=>{this.BQe(Object(B.a)(116,Y))})}ahh(){var z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");z=z.slides||[];0<z.length&&this.CQe(z)}khh(z){this.yKh(z,Y=>{this.AQe(z,
Y)})}BQe(z){if(z&&z.isConnected&&z.changesData){const Y=this.YYc(z.changesData,this.FTc(z));Y!==z.isUnread&&(this.OYg(z,Y),this.CBl(),z===this.ua.Ba&&this.khh(z))}}AQe(z,Y){if(Y&&Y.isConnected&&Y.Sa(ye.a.YKb)){const m=this.YYc(Y.changesData,this.FTc(z));this.MYg(z,Y,m)}}MYg(z,Y,m){m!==Y.isUnread&&(bd.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",Y.isUnread,m),Y.isUnread=m,this.gad.KQk(new ii(Y,z)))}OYg(z,Y){Y!==z.isUnread&&(bd.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",
z.isUnread,Y,z.Cb.toString()),z.isUnread=Y,this.gad.gRk(new M(z)))}Vcd(z,Y){if(this.Vac){if(!z)throw Error.argumentNull("ISlideNode is null");this.sHl(z);bd.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",z.Cb.toString(),z.isUnread,Y);if(!z.isUnread)return!1}this.yKh(z,m=>{this.MYg(z,m,!1)});this.OYg(z,!1);this.Vac&&Y&&this.Cwd();return!0}mEe(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");let Y=!1;this.forEach(z.slides,
m=>{m=this.Vcd(Object(B.a)(116,m),!1);Y||(Y=m)});bd.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",Y);Y&&this.Cwd()}yKh(z,Y){z&&(z=z.gk(),this.forEach(z,m=>{Y(m)}))}forEach(z,Y){pf.b(z,null,Y)}tje(z){return qh(z,this.qcb)}YYc(z,Y){return!!z&&!!z.dtField&&!this.tje(z)&&z.dtField>Y}X8i(){const z=this.Tb.$m;if(z&&z.yMe)return z.yMe;bd.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}Xhg(z){const Y=Object(B.a)(116,this.Qhk.y7f(z));return Y&&
Y.isUnread&&z&&this.YYc(z.changesData,this.FTc(Y))}gal(){this.qcb=new hg(this.Qb.Ga("UserName"),this.Qb.Ga("387"),this.Qb.Ga("388"))}sHl(z){z.mX=z&&z.changesData?z.changesData.dtField:this.Ocb}JDl(){const z=this.ua.Ba;z&&(z.mX=z.changesData?z.changesData.dtField:this.Ocb)}FTc(z){return z.mX||this.Ocb}CBl(){this.ezg||(this.ezg=!0,bd.a.J(512262741,804,50,"First revision tracking view render completed!"))}Xzj(z){return z.isConnected&&z.changesData&&z.changesData.dtField?z.changesData.dtField<=this.Bwe&&
this.YYc(z.changesData,this.FTc(z)):!1}sbb(z,Y){return z.equals(Y.slideId)}tryHighlightInsertedShapes(){bd.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.o8c);this.u$c=null;const z=this.ua.Ba;if(z&&z.isUnread){const Y=z.Cb;for(const m of this.nAe)this.sbb(Y,m)&&this.AQe(z,m)}Array.clear(this.nAe)}Ona(){this.Ead=!0}Efa(z,Y){try{Y.T0c?(bd.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),
this.Ead=!1):bd.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(m){bd.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",m)}}hYe(){return 1!==this.Fb.Fl}}Object(h.a)(N,"RevisionTrackingManager",null,[]);class Ia{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb){this.ua=z;this.Tb=Y;this.uBe=m;this.ld=I;this.f5=X;this.Ea=ta;this.Z3c=Fa;this.Tfb=bb;this.Te=yb;this.hHa=Bb;this.ibk=pb;this.gJg=!1;this.ld.wrb(Object(v.a)(this,this.l8g,
"onVisibleThumbnailRangeChanged"));this.ld.iHc(Object(v.a)(this,this.kxa,"onThumbnailRefresh"));this.ld.Rbi(Object(v.a)(this,this.T6g,"onShapePresenceStateChanged"));this.ld.qci(Object(v.a)(this,this.W7g,"onThumbnailPresenceStateChanged"));this.ld.Wai(Object(v.a)(this,this.qzk,"onShapeViewElementShowRevisionTrackingHint"));this.ld.Tai(Object(v.a)(this,this.jzk,"onShapeViewElementHideRevisionTrackingHint"));this.f5.qQd(Object(v.a)(this,this.jZa,"onSlideUnreadStateChanged"));this.f5.Nbi(Object(v.a)(this,
this.Z6g,"onShapeUnreadStateChanged"));this.f5.Ybi(Object(v.a)(this,this.c7g,"onShowHideStateChanged"))}dispose(){this.ld.Zjh(Object(v.a)(this,this.l8g,"onVisibleThumbnailRangeChanged"));this.ld.VRe(Object(v.a)(this,this.kxa,"onThumbnailRefresh"));this.ld.m0k(Object(v.a)(this,this.T6g,"onShapePresenceStateChanged"));this.ld.C0k(Object(v.a)(this,this.W7g,"onThumbnailPresenceStateChanged"));this.f5.TRe(Object(v.a)(this,this.jZa,"onSlideUnreadStateChanged"));this.f5.j0k(Object(v.a)(this,this.Z6g,"onShapeUnreadStateChanged"));
this.f5.q0k(Object(v.a)(this,this.c7g,"onShowHideStateChanged"))}l8g(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");pf.b(z.slides||[],null,Y=>{(Y=this.Tb.zl(Y.Cb))&&Y.isUnread&&this.HZe(Y)})}kxa(z,Y){z=this.Tb.zl(Y.TCh);z.isUnread&&this.HZe(z)}jZa(z,Y){z=Y.slide;z.isUnread?this.HZe(z):this.fZk(z)}Z6g(z,Y){z=Y.shape;Y=Y.slide;z&&(z.isUnread?Y===this.ua.Ba&&this.DZe(z):this.uRe(z))}T6g(z,Y){z=Y.shape;z.As?this.uRe(z):z.isUnread&&this.DZe(z,!0)}W7g(z,Y){z=Y.slide;
z.As&&!this.DYe?this.kZk(z):z.isUnread&&this.ool(z)}c7g(z,Y){z=Y.shape;Y.EDa&&z.isUnread?this.DZe(z):this.uRe(z)}get DYe(){return this.ibk}HZe(z){z&&z.isConnected&&this.Cvd(z,Y=>{Y.cxh();z.As&&!this.DYe||this.buf(Y)})}fZk(z){z&&z.isConnected&&this.Cvd(z,Y=>{Y.Mih();Y.rRe()})}ool(z){z.As&&!this.DYe||this.Cvd(z,Object(v.a)(this,this.buf,"addRevisionTrackingPawnForThumbnail"))}kZk(z){this.Cvd(z,Y=>{Y.rRe()})}tvh(){const z=this.Tb.$m;return!this.hHa||this.hHa&&z.EDa}DZe(z,Y=!1){this.tvh()&&!z.As&&z.Sa(ye.a.YKb)&&
(Object(B.a)(117,z.sc(this.Te))?(this.uBe.ZG(z).display(()=>this.Ea.wUc(z)),this.gBl(),bd.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",Y)):bd.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}uRe(z){const Y=this.uBe.IF(z);Y?Y.dismiss():this.tvh()&&z.isUnread&&bd.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Cvd(z,Y){z&&((z=Object(B.a)(486,z.ng(this.Tfb)))?
Y(z):bd.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}buf(z){z.tPd(this.Z3c.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}qzk(z,Y){this.SIh(Y.Px.shapeNode,!0)}jzk(z,Y){this.SIh(Y.Px.shapeNode,!1)}SIh(z,Y){(z=this.uBe.IF(z))&&(Y?z.Mya():z.v_())}gBl(){this.gJg||(this.gJg=!0,Be.c(na.a.eri))}}Object(h.a)(Ia,"RevisionTrackingPresenter",null,[]);class lb{kLf(){const z=new se.a;z.lh(10,10);z.Dya("0 0 10 10");z.xa.setAttribute("class",
"ModernRevisionTrackingIconSVG");const Y=new ee.a;Y.v1("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");Y.xa.setAttribute("class","ModernRevisionTrackingIconPath");z.appendChild(Y);return z.xa}}Object(h.a)(lb,"RevisionTrackingSVGProvider",null,[462]);class Sb{constructor(){this.had=this.Wbd=this.Vbd=this.Cze=0}P5j(){this.Wbd+=1}m5j(z,Y){switch(z){case 2:Y&&(this.Vbd+=1);break;case 0:Y?(this.had+=1,bd.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):bd.a.J(39068551,
804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:Y&&(this.Cze+=1)}}log(){bd.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",this.Cze,this.Vbd,this.Wbd,this.had);0<this.Vbd+this.Wbd+this.had&&Be.c(na.a.VUd)}}Object(h.a)(Sb,"RevisionTrackingTelemetry",null,[]);var Wc=d(1040),td=d(1148),wd=d(75),be=d(578);class hb{constructor(z,
Y,m,I,X){this.ncb=null;this.dIa=z;this.mfb=Y;this.lc=X;this.Vb=m;this.pa=I;this.dIa.fW(Object(v.a)(this,this.eG,"onInteractivityChanged"))}dispose(){this.dIa&&this.dIa.dispose();this.ncb=this.dIa=null}display(z,Y){this.ncb||(this.ncb=new be.a);this.ncb.color=z;this.ncb.userName=Y;this.dIa.Yx(this.ncb)}dismiss(){this.dIa.TJ(this.ncb.clientId)}Mya(){this.dIa.Kya()}v_(){this.dIa.nga()}get oSd(){const z=this.dIa.Xhb;return 0<z.length?z[0]:null}eG(z,Y){z={InvokeSource:2,ShowRevisionTrackingStatus:null};
1===Y.type?(this.Vb.Ba!==this.lc?(this.lc&&(this.Vb.Ba=this.lc,this.pa.ey()),z.ShowRevisionTrackingStatus=3):z.ShowRevisionTrackingStatus=1,O.AFrameworkApplication.Ta.La(Bc.a.Gkb,2,z)):2===Y.type?this.lc&&this.Vb.Ba===this.lc&&(z.ShowRevisionTrackingStatus=2,O.AFrameworkApplication.Ta.La(Bc.a.Gkb,2,z),this.mfb.P5j()):3===Y.type&&this.lc&&this.Vb.Ba===this.lc&&(z.ShowRevisionTrackingStatus=0,O.AFrameworkApplication.Ta.La(Bc.a.Gkb,2,z))}}Object(h.a)(hb,"ThumbnailRevisionTrackingPawn",null,[511,106]);
d(301);class hf{constructor(z,Y,m,I,X,ta){this.Le=z;z=wd.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");Y=Y.rk("pegal.png");m=m.kLf();this.Ofk=this.SIi(O.AFrameworkApplication.isRtl,z,Y,m);this.mfb=I;this.Vb=X;this.pa=ta}JGi(z,Y){return new hb(this.Ofk.eub(z),this.mfb,this.Vb,this.pa,Y)}Pc(z){return this.Le.Pc(z)}SIi(z,Y,m,I){const X=new Wc.a;X.add(1,Y);X.add(4,m);X.add(6,16);X.add(8,z);X.add(12,2);X.add(11,!1);X.add(14,I);return new td.a(X)}}Object(h.a)(hf,"RevisionTrackingThumbnailGadgetsFactory",
null,[461]);class Xf{constructor(z,Y,m){this.m7c=this.ofc=!0;this.Ds=z;this.nHa=Y;this.la=m}get dZj(){return this.ofc}getSlideLastViewedVersionInfo(z){if(this.m7c){bd.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var Y=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTSlideLastViewedMetadata",O.AFrameworkApplication.hh),m={};m["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.nj(Y,1,null,m,!1,2,Object(v.a)(this,this.pvk,"onGetVersionInfoSucceeded"),Object(v.a)(this,this.ovk,"onGetVersionInfoFailed"),z,void 0,void 0,void 0,void 0,Al.a("12"));this.m7c=!1}else bd.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(z){if(this.ofc){bd.a.J(25203106,824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var Y=D.c(z),m=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;
if(Y.length>m)bd.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",z.lv.length,Y.length,m);else{m=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",O.AFrameworkApplication.hh);if(O.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.Ds.qya(m,Y);else{const I={};I["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.nj(m,2,Y,I,!1,2,Object(v.a)(this,this.Oxk,"onPutVersionInfoSucceeded"),Object(v.a)(this,this.Nxk,"onPutVersionInfoFailed"),z.lv.length,void 0,void 0,void 0,void 0,Al.a("13"))}this.ofc=!1}}else bd.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}pvk(z){this.m7c=!0;let Y=0;try{let m=null;z.data.Wd&&0<z.data.Wd.trim().length&&(Y=z.data.Wd.length,m=JSON.parse(z.data.Wd,Object(v.a)(this,this.sZj,
"jsonDateReviver")));const I=z.data.state;I(m)}catch(m){bd.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",m.toString())}z=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",Y,JSON.stringify(z.data.AI),JSON.stringify(z.data.Zt),JSON.stringify(z.data.qv));bd.a.J(25203139,824,50,z)}ovk(z){this.m7c=!0;z=this.nHa.hka(z);bd.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",z)}Oxk(z){this.ofc=!0;
bd.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.qv-+z.data.AI,+z.data.Zt-+z.data.AI)}Nxk(z){this.ofc=!0;const Y=this.nHa.hka(z);bd.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",Y,z.data.state)}sZj(z,Y){return"dt"===z||"defLv"===z?new Date(Y):Y}}Object(h.a)(Xf,"RoamingCacheProxy",null,[460,106]);var Bg=d(693),ji=d(116);class pi{constructor(z,Y,m){this.Ag=z;this.yJ=Object(B.a)(Bg.a,this.Ag.Lth);this.Z3c=Y;this.sik=
m;this.Ag.Wkg=!0}display(z){let Y;Y=this.sik.kLf();this.yJ.auf(this.Z3c.backgroundColor,z,Y);this.Ag.jPb(this.Z3c.foregroundColor);this.Ag.setVisibility()}dismiss(){this.yJ.clear();this.Ag.jPb(ji.a.none);this.Ag.setVisibility()}Jm(z){this.Ag.Jm(z)}lD(z){this.Ag.lD(z)}Zp(){return this.Ag.Zp()}PN(z){return this.Ag.mzb(z)}Ox(z){this.Ag.Ox(z)}dispose(){this.Ag.dispose()}Xy(){this.Ag.Xy()}bE(z){return this.Ag.bE(z)}JB(z){return this.Ag.JB(z)}draw(z,Y){this.Ag.draw(z,Y)}get visible(){return this.Ag.visible}set visible(z){this.Ag.visible=
z}setPosition(z,Y){this.Ag.setPosition(z,Y)}Kj(z){this.Ag.Kj(z)}Qq(z){this.Ag.Qq(z)}Yu(z){this.Ag.Yu(z)}setZIndex(z){this.Ag.setZIndex(z)}OE(z,Y){this.Ag.OE(z,Y)}Mya(){this.yJ.Mya()}v_(){this.yJ.v_()}setSelection(){}}Object(h.a)(pi,"ShapeRevisionTrackingView",null,[482,435,436,106]);class Oe{constructor(){this.K=null;this.hHa=this.nDb=this.xO=this.M4=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}Zb(z){this.K=z;z.resolve("Common.IAppSettingsManager").ff(()=>{this.xO=z.resolve("PowerPointWebEditor.IApplicationContext").qd.vg;
this.nDb=z.resolve("PowerPointWebEditor.IApplicationContext").qd.tTj;this.M4=z.resolve("PowerPointWebEditor.IApplicationContext").qd.sme;this.hHa=z.resolve("PowerPointWebEditor.IApplicationContext").qd.sle;this.register();this.resolve()})}dispose(){this.M4&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const z=
this.K;this.xO&&this.nDb&&z.register(Lf.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new Lf.a(O.AFrameworkApplication.Ke,z.resolve("PowerPointWebEditor.ISessionInfoOwner"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),z.resolve("PowerPointWebEditor.IErrorHandler"),z.resolve("Common.ITaskManager"),z.resolve("Common.IAppSettingsManager")));this.M4&&(z.register(Sb,"RevisionTrackingTelemetry").ma().oa(()=>new Sb),z.register(N,
"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().oa(()=>new N(z.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("Common.ITaskManager"),z.resolve("PowerPointWebEditor.ISlideReader"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),z.resolve("Box4.Graph.IGraphInstance").xd(10),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),z.resolve("PowerPointWebEditor.IApplicationSettings"),z.resolve("Common.IAppSettingsManager"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.View.IPPTPageView"),z.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),z.register(Ia,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().oa(()=>
new Ia(z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),z.resolve("PowerPointWebEditor.IShapeReader"),z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),
z.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,z.resolve("Box4.IPageView").Ma,z.resolve("PowerPointWebEditor.IApplicationSettings").sle,z.resolve("Common.IAppSettingsManager").ka("PPTCanvasPresenceBubbleUXEnabled"))),z.register(460,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().oa(()=>new Xf(O.AFrameworkApplication.Ke,z.resolve("PowerPointWebEditor.IJsonpHelperManager"),z.resolve("PowerPointWebEditor.IApplicationSettings"))),z.register(461,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().oa(()=>
new hf(z.resolve("PowerPoint.IBrowserHelperManager"),z.resolve("PowerPoint.IPathManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),z.resolve("PowerPointWebEditor.IPptSelectionManager"))),z.register(Ol,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().oa(()=>
new Ol),z.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().oa(()=>new Uh.a((Y,m)=>{let I=null;const X=Object(B.a)(117,Y.sc(z.resolve("Box4.IPageView").Ma));X&&!X.Al&&(Y=z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").dZd(z.resolve("PowerPointWebEditor.IPptSelectionManager"),(ta,Fa,bb)=>z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").OHi(ta,Fa,bb,z.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
Y,m,X.WU),I=new pi(Y,z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),I.Jm(X.WU),X.xra(I,1),I.visible=X.BQ||X.Wn);return I})),z.register(Dn,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().oa(()=>new Dn(z.resolve("Common.Utils.IHighContrastDetector"))),z.register(462,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().oa(()=>new lb),this.xO&&
this.hHa&&z.register(yc,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().oa(()=>new yc(z.resolve("Common.IActionManagerExtended"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.View.IViewEventSource"),z.resolve("RevisionTrackingTelemetry"))))}resolve(){this.xO&&
this.nDb&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.M4&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.hHa)){const z=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");z.wb();z.Ee()}}static main(){Ma.a.instance.Dc(of.a(new Oe,0))}}Object(h.a)(Oe,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var Ri=d(408),Rj=d(205),dh=d(131);class ff{constructor(z){this.iPa=[he.a.$sc,he.a.atc,he.a.btc,he.a.ctc,he.a.dtc];this.Daf=z}O1f(z){return this.Daf?this.Daf.KSc(z.Ua):null}create(z){return z?(z=this.I1b(z))?dh.m(z):"":""}iEi(z){z=z.suggestions;if(!z||!z.count)return null;z=({iOf:Y}=this.BIi(z)).returnValue;var Y=ff.jFi(Y);const m=Object.assign(new Ri.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:wd.getImageClassWithCluster(O.AFrameworkApplication.UN,ff.FNi),Image16by16:O.AFrameworkApplication.qm,Menu:Object.assign(new Le.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});z&&Array.add(m.Menu.MenuSectionList,z);Array.add(m.Menu.MenuSectionList,Y);return m}BIi(z){let Y;const m=Object.assign(new xi.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
Y=null;for(let I=0,X=Math.min(this.iPa.length,z.count);I<X;++I){if(!Y&&""===z.ga(I).suggestion){Y=this.iPa[I].toString();continue}const ta=Object.assign(new Rj.a,{ExternalId:"btnDictationCorrectionSuggestion"+I,Command:this.iPa[I].toString(),LabelText:z.ga(I).suggestion});Array.add(m.ControlList,ta)}return m.ControlList.length?{returnValue:m,iOf:Y}:{returnValue:null,iOf:Y}}I1b(z){if(z=this.iEi(z)){const Y=Object.assign(new xi.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});
Array.add(Y.ControlList,z);return Y}return null}static jFi(z){const Y=Object.assign(new xi.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),m=Object.assign(new Rj.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(Y.ControlList,m);z&&(z=Object.assign(new Rj.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:z,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(Y.ControlList,z));return Y}}ff.FNi="Insertaudio_16x16x32";Object(h.a)(ff,"DictationCorrectionContextMenuManager",null,[481]);var Kj=d(442);class Mf{constructor(z,Y){this.Mxc=null;this.sr=z;this.wZ=Y}get key(){return"DICTATIONCORRECTION"}get i8(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(z){this.sr.ae(z.node)?this.Mxc=z.node:this.Mxc=null}muc(z){let Y;Y=null;if(!this.Mxc)return{returnValue:!1,
KBa:Y};z=this.wZ.t9i(this.Mxc,z);if(!z)return{returnValue:!1,KBa:Y};Y=Object.assign(new Kj.a,{e1:this.key,bQ:z,description:this.R6d()});return{returnValue:!0,KBa:Y}}R6d(){return O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(h.a)(Mf,"DictationCorrectionDetailsProvider",null,[509,510]);var ke=d(616),vf=d(142);class fo{constructor(z,Y,m=-1){this.TriggerType="click";this.TreatedInUX=
"true";this.PhraseId=z.XFk;this.CorrectionId=z.id;switch(Y){case 0:this.EditType="alternate";this.AlternateId=m;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(h.a)(fo,"CorrectionEvent",null,[]);class go{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(h.a)(go,"CorrectionTelemetry",null,[]);class ho{constructor(){this.Id=
"Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(h.a)(ho,"CorrectionsSessionTelemetry",null,[]);class Of{constructor(){this.rS=!1;this.dxd=this.NFd=0}start(){this.rS||(this.rS=!0,this.NFd=this.getTime())}stop(){this.rS&&(this.dxd+=this.getTime()-this.NFd,this.rS=!1)}get Vq(){return this.dxd+(this.rS?this.getTime()-this.NFd:0)}getTime(){return(new Date).getTime()}}Object(h.a)(Of,"DictationCorrectionsSessionTimer",null,[]);class io{constructor(){this.StartTime=
"";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(h.a)(io,"SessionInfo",null,[]);class eh{constructor(){this.FinalText="";this.PhraseIds=null}}Object(h.a)(eh,"TextInfo",null,[]);var rk=d(181),cf=d(126);class qn{constructor(z){this.ikf=this.wHd=this.xHd=0;this.pNh="Office.Voice.Online.DictationCorrectionsSession";this.b5a=null;this.jqb=Object.assign(new io,{TextInfo:[new eh]});this.fdf=z}startSession(){this.b5a||(this.jqb.StartTime=(new Date).toISOString(),
this.b5a=new Of);this.b5a.start()}pauseSession(){this.b5a.stop()}endSession(){this.b5a.stop();var z=new rk.a;z.name=this.pNh;z.samplingPolicy=2;z.durationMs=this.b5a.Vq;z.dataFields=[];Array.add(z.dataFields,Object.assign(new cf.a,{name:"CorrectionSessionId",string:this.sya}));Array.add(z.dataFields,Object.assign(new cf.a,{name:"StartTime",string:this.jqb.StartTime}));Array.add(z.dataFields,Object.assign(new cf.a,{name:"NumberOfCorrectionsMarked",int64:this.xHd}));Array.add(z.dataFields,Object.assign(new cf.a,
{name:"NumberOfCorrectionsMade",int64:this.wHd}));Array.add(z.dataFields,Object.assign(new cf.a,{name:"NumberOfCorrectionsDismissed",int64:this.ikf}));vf.a.sendActivityEvent(z);if($f.App.h_&&0<$f.App.h_.pah.length){this.jqb.AlternateEditCount=this.wHd;this.jqb.Duration=Math.floor(this.b5a.Vq/1E3);this.jqb.TextInfo[0].PhraseIds=$f.App.h_.pah;var Y=new ho;Y.ClientSessionId=this.sya;Y.SessionInfo=this.jqb;if(z=this.fdf())Y=D.c(Y),z.jrg(Y)}}Wtk(z){this.xHd+=z}I3g(z,Y,m=-1){0===Y?this.wHd++:1===Y&&this.ikf++;
var I=new go;I.ClientSessionId=this.sya;I.CorrectionEvents=[new fo(z,Y,m)];if(z=this.fdf())I=D.c(I),z.jrg(I)}get sya(){return $f.App.h_?$f.App.h_.sya:""}}Object(h.a)(qn,"DictationCorrectionsTelemetry",null,[]);var Lj=d(44),Ie=d(42);class $m{constructor(z,Y,m){this.xN=z;this.Lb=Y;this.QG=m}}Object(h.a)($m,"DictationCorrectionRange",null,[]);var Pl=d(362);class Pf{constructor(z,Y,m){this.bca=this.Tq=null;this.znb=z;this.dAa=Y;this.zCc=new Pl.a(new ke.a);this.Exc=m;this.goa()}wie(z){this.dAa.fDa&&Vf.ParagraphReader.ae(z)&&
this.zCc.contains(z.id)&&this.znb.wie(z)}Crl(){this.dAa.fDa=!0;this.Tq=new qn(()=>this.bca);this.Tq.startSession()}usl(){this.dAa.fDa=!1;var z=$f.App.Kb.Ld.Dn.xg;if(z){z=z.Gh;for(let Y of this.zCc){const m=z.Be(Y);m&&Vf.ParagraphReader.ae(m)&&this.znb.pui(m)}}this.Exc.clear();this.zCc.clear();this.Tq.endSession()}s4k(z){if(this.dAa.fDa){var Y=z.sa(Ie.a.g0d,null);if(!yd.a.Wa(Y)){var m=new za.a,I=Math.min(Y.length,z.Ra.length);for(let X=0;X<I;X++){const ta=this.Exc.U7i(Y[X]);if(ta){const Fa=z.Ra.ga(X).cp;
m.add(new $m(Fa,Fa+ta.source.length,ta))}}this.znb.qlk(z,m)}}}d5e(z,Y){if(!Y)return!1;if(!this.dAa.fDa||!z)return Y.add(null),!1;Y.add(z.tv?z.tv.QG.key:null);return!!z.tv}W6k(z,Y){this.dAa.fDa&&Y&&Ya.AT(Y,m=>!!m)?z.we(Ie.a.g0d,Y.toArray()):z.removeProperty(Ie.a.g0d)}Dhh(z){this.bca=z}goa(){this.znb.$9h(Object(v.a)(this,this.Ttk,"onDictationCorrectionMarkerAdded"));Qe.a.addHandler(window.self,Nb.a.blur,()=>{this.Tq&&this.dAa.fDa&&this.Tq.pauseSession()});Qe.a.addHandler(window.self,Nb.a.focus,()=>
{this.Tq&&this.dAa.fDa&&this.Tq.startSession()});this.znb.a$h(Object(v.a)(this,this.Utk,"onDictationCorrectionMarkerRemoved"))}Utk(z,Y){this.Exc.dYk(Y.QJf)}Ttk(z,Y){this.zCc.add(Y.eDk);this.Tq&&this.Tq.Wtk(Y.Tlk);this.Exc.t6h(Y.QJf)}Stk(z,Y){this.Tq&&this.Tq.I3g(z,0,Y)}Vtk(z){this.Tq&&this.Tq.I3g(z,1)}t9i(z,Y){if(!this.dAa.fDa)return null;z=Ag.a.Mj(z,Y);return this.znb.KSc(z)}}Object(h.a)(Pf,"DictationCorrectionManager",null,[480]);class Jg extends Sys.EventArgs{constructor(z,Y){super();this.eDk=
z;this.Tlk=Y?Y.count:0;this.QJf=Y}}Object(h.a)(Jg,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Ho{constructor(z,Y,m,I,X){this.oZh=z;this._id=Y;this.$Ph=I;this.tXb=X;this.Ot=m;this.lUb=String.format("{0}_{1}",z,Y)}get XFk(){return this.oZh}get id(){return this._id}get source(){return this.Ot}get confidence(){return this.$Ph}get suggestions(){return this.tXb}get key(){return this.lUb}ank(z){this.suggestions.addRange(z.suggestions)}}Object(h.a)(Ho,"DictationCorrectionDetails",null,[]);
class an{constructor(z,Y,m){this.Pn=z;this.yQh=Y;this.uYh=m}get QG(){return this.yQh}get H4g(){return this.uYh}get He(){return this.Pn}ee(z){return new an(z||this.He,this.QG,this.H4g)}}Object(h.a)(an,"DictationCorrectionObject",null,[148]);class sk{constructor(z,Y){this.source=z;this.suggestion=Y}}Object(h.a)(sk,"DictationCorrectionSuggestion",null,[]);class Ef{constructor(z){this.gh=z;this.Pa=new hi.a}$9h(z){this.Pa.addHandler("ADCM",z)}a$h(z){this.Pa.addHandler("RDCM",z)}qlk(z,Y){this.Alk(z,Y)}Alk(z,
Y){if(z&&Y&&Y.count&&(Y=Ef.RJl(z,Y))&&Y.count){this.Cui(z,Y);var m=new za.a;for(var I of Y)m.add(I.xN),m.add(I.Lb);z.a2d(m);for(let X of Y)I=z.Ra.iT(X.xN),I.tv=new an(I,X.QG,Object(v.a)(this,this.jvj,"handleParagraphSplit")),I.isFromErrorRangeSplit=!0,I=z.Ra.iT(X.Lb),I.isDictationCorrectionEnd=!0,I.isFromErrorRangeSplit=!0;0<Y.count&&this.Pa.raiseEvent("ADCM",new Jg(z.id,Y))}}N1f(z){const Y=new za.a;if(z){let m=null,I=-1;for(let X=0;X<z.Ra.length;X++){const ta=z.Ra.ga(X);ta.tv?(I=ta.cp,m=ta.tv.QG):
ta.isDictationCorrectionEnd&&(m?Y.add(new $m(I,ta.cp,m)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),m=null)}}return Y}Hoc(z,Y){if(z&&Y&&Y.count){for(let m of Y){let I=z.Ra.iT(m.xN);I&&(I.tv=null);if(I=z.Ra.iT(m.Lb))I.isDictationCorrectionEnd=!1}this.Pa.raiseEvent("RDCM",new Jg(z.id,Y))}}pui(z){if(z)for(let Y=0;Y<z.Ra.length;Y++){const m=z.Ra.ga(Y);m.tv&&(m.tv=null);m.isDictationCorrectionEnd&&(m.isDictationCorrectionEnd=!1)}}KSc(z){if(!z||!Lj.SelectionEditor.ik(z)&&
!Lj.SelectionEditor.Tg(z))return null;const Y=z.node;let m=z.Qa;z=z.Lb;let I=0,X=null;for(let ta=0;ta<Y.Ra.length;ta++){const Fa=Y.Ra.ga(ta);if(Fa.tv&&m>=Fa.cp)X=Fa.tv,I=Fa.cp;else if(X&&Fa.isDictationCorrectionEnd){if(z<=Fa.cp)return new $m(I,Fa.cp,X.QG);X=null}}return null}SJl(z,Y,m){if(!z)return!1;z=Vf.ParagraphReader.text(z);return Ef.aKh(z,Y.source,m)}wie(z){if(z){var Y=this.N1f(z);if(Y&&0<Y.count){const m=new za.a,I=Vf.ParagraphReader.text(z);for(let X of Y)Ef.$Jh(I,X)||m.add(X);this.Hoc(z,
m)}}}Cui(z,Y){Y.ga(0);Y.ga(Y.count-1);const m=this.N1f(z);let I=0,X=0;const ta=new za.a;for(;X<Y.count&&I<m.count;){const Fa=Y.ga(X),bb=m.ga(I);Fa.Lb<bb.xN?X++:(bb.Lb>Fa.xN&&ta.add(bb),I++)}this.Hoc(z,ta)}jvj(z,Y){const m=Y.He;for(var I=z.Ra.dxb(m.cp)+1;I<z.Ra.length;I++){const X=z.Ra.ga(I);if(X.isDictationCorrectionEnd){let ta;this.Hoc(z,(ta=new za.a,ta.add(new $m(m.cp,X.cp,Y.QG)),ta));break}}}Ozk(z,Y){(z=$f.App.Kb.Ld.Dn.xg)&&(Y=z.Gh.Be(Jc.a.Gf(Y.nodeId)))&&Vf.ParagraphReader.ae(Y)&&this.eYk(Y)}eYk(z){if(z){var Y=
0,m=!1,I=!1,X=new za.a;for(let ta=0;ta<z.Ra.length;ta++){const Fa=z.Ra.ga(ta);Fa.tv&&(Y=ta,m=!0);m&&(Fa.Vp||Fa.IL)&&(I=!0);Fa.isDictationCorrectionEnd&&m&&(m=!1,I&&(I=z.Ra.ga(Y),I.tv&&I.tv.QG&&X.add(new $m(I.cp,Fa.cp,I.tv.QG)),I.tv=null,I=Fa.isDictationCorrectionEnd=!1))}this.Pa.raiseEvent("RDCM",new Jg(z.id,X))}}static RJl(z,Y){if(!Y.count)return Y;Y.Sc((I,X)=>I.xN!==X.xN?I.xN-X.xN:I.Lb-X.Lb);z=Vf.ParagraphReader.text(z);const m=new za.a;for(let I=0;I<Y.count;I++){const X=Y.ga(I);if(X.xN>z.length||
X.Lb>z.length)break;if(!Ef.$Jh(z,X))continue;if(!m.count){m.add(X);continue}const ta=m.ga(m.count-1);X.xN>ta.Lb?m.add(X):ta.xN===X.xN&&ta.Lb===X.Lb&&ta.QG.ank(X.QG)}return m}static aKh(z,Y,m){if(m+Y.length<=z.length){for(let I=0;I<Y.length;I++)if(Y.charAt(I)!==z.charAt(I+m))return!1;return!0}return!1}static $Jh(z,Y){return!z||Y.xN>z.length||Y.Lb>z.length||!Y.QG||!Y.QG.source?!1:Ef.aKh(z,Y.QG.source,Y.xN)}}Object(h.a)(Ef,"DictationCorrectionRangeEditor",null,[479]);class bm{constructor(){this.fDa=
!1}}Object(h.a)(bm,"DictationCorrectionSettings",null,[]);var rh=d(15);class ie{constructor(){this.qXb=new rh.ScriptSharpLegacyMap}t6h(z){if(z&&z.count)for(let Y of z)Y.QG?(z=Y.QG.key,this.qXb.Gb(z)||this.qXb.add(z,Y.QG)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}dYk(z){if(z&&z.count)for(let Y of z)Y.QG?this.qXb.remove(Y.QG.key):e.ULS.sendTraceTag(593285259,394,10,"Correction details is null.")}U7i(z){if(!z)return null;let Y;return({value:Y}=this.qXb.Tf(z)).returnValue?Y:
null}clear(){this.qXb=new rh.ScriptSharpLegacyMap}}Object(h.a)(ie,"DictationCorrectionStorage",null,[508]);class Bl{constructor(z,Y,m,I,X,ta,Fa){this.gh=z;this.QRb=Y;this.wZ=m;this.Ca=I;this.Tc=X;this.jf=ta;this.Bk=Fa}wb(){this.Ca.ya(he.a.$sc,Lc.a.Of,Object(v.a)(this,this.etc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(he.a.atc,Lc.a.Of,Object(v.a)(this,this.etc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(he.a.btc,Lc.a.Of,Object(v.a)(this,this.etc,"takeSuggestedDictationCorrectionAction"));
this.Ca.ya(he.a.ctc,Lc.a.Of,Object(v.a)(this,this.etc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(he.a.dtc,Lc.a.Of,Object(v.a)(this,this.etc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(he.a.Zsc,Lc.a.Of,Object(v.a)(this,this.Zsc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.ya(he.a.$sc,Lc.a.view,Object(v.a)(this,this.Jtb,"collapseIpThenExecuteAction"));this.Ca.ya(he.a.atc,Lc.a.view,Object(v.a)(this,this.Jtb,"collapseIpThenExecuteAction"));this.Ca.ya(he.a.btc,Lc.a.view,Object(v.a)(this,
this.Jtb,"collapseIpThenExecuteAction"));this.Ca.ya(he.a.ctc,Lc.a.view,Object(v.a)(this,this.Jtb,"collapseIpThenExecuteAction"));this.Ca.ya(he.a.dtc,Lc.a.view,Object(v.a)(this,this.Jtb,"collapseIpThenExecuteAction"));this.Ca.ya(he.a.Zsc,Lc.a.view,Object(v.a)(this,this.Jtb,"collapseIpThenExecuteAction"));this.Ca.le(he.a.$sc,96);this.Ca.le(he.a.atc,96);this.Ca.le(he.a.btc,96);this.Ca.le(he.a.ctc,96);this.Ca.le(he.a.dtc,96);this.Ca.le(he.a.Zsc,96)}tfi(z,Y,m){const I=this.Bk.oe(15);try{I.kd(z);let X;
this.QRb.Hoc(z,(X=new za.a,X.add(Y),X));const ta=Y.QG.suggestions.ga(m);if(this.QRb.SJl(z,ta,Y.xN)){const Fa=Ag.a.createTextRange(z,Y.xN,Y.xN+ta.source.length);this.gh.replaceTextRange(Fa,ta.suggestion);this.wZ.Stk(Y.QG,m)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{I&&I.dispose()}}etc(z,Y,m){2===m&&Y.al&&(m=this.QRb.KSc(Y))&&this.tfi(Y.node,m,this.W7i(z));return 32}Jtb(z,Y,m,I,X){if(2===m){Y=this.Tc.Na.mb;if(!Y)return 2;Y=this.jf.Sl(Y,!0,!1);return this.Ca.pi(Y.Ua,
z,m,!1,I,X)}return 32}Zsc(z,Y,m){if(2===m&&Y.al&&(z=this.QRb.KSc(Y))){let I;this.QRb.Hoc(Y.node,(I=new za.a,I.add(z),I));this.wZ.Vtk(z.QG)}return 32}W7i(z){switch(z){case he.a.$sc:return 0;case he.a.atc:return 1;case he.a.btc:return 2;case he.a.ctc:return 3;case he.a.dtc:return 4;default:return-1}}}Object(h.a)(Bl,"DictationCorrectionsActor",null,[507]);var jo=d(321),Ql=d(64);class Io{constructor(){this.Eaf=this.Da=null}get name(){return"Box4.DictationCorrections"}Zb(z){this.Da=z;this.Da.register(479,
"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().oa(()=>new Ef(this.Da.resolve("Box4.ICharacterPropertiesEditor")));this.Da.register(480,"Box4.DictationCorrections.IDictationCorrectionManager").ma().oa(()=>new Pf(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new bm,new ie));this.Da.register(481,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().oa(()=>new ff(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager");
this.Eaf=new Bl(this.Da.resolve("Box4.ICharacterPropertiesEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),O.AFrameworkApplication.Ta,Ql.a.instance,jo.a.instance,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"));this.Eaf.wb();this.oVk(this.Da.Ja("Box4.Accessibility.IAccessibilityContextManager"),this.Da.resolve("Box4.IParagraphReader"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));
const z=this.Da.rb("Box4.Proofing.IErrorRangeEditor"),Y=this.Da.rb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");O.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&z&&Y&&z.iai(Object(v.a)(Y,Y.Ozk,"onSpellingErrorRangesChangedEventHandler"));$f.App.Kb.updateCommandUI()}dispose(){}oVk(z,Y,m){z&&z.execute(I=>{I.h_a(new Mf(Y,m))})}}Object(h.a)(Io,"DictationCorrectionsPackageManager",null,[2,3]);d(1217);d(722);var bn=d(485);class Sj{constructor(z,Y,m,I=null,X=null){this.Pn=
z;this.IG=Y;this.KVh=m;this._id=I;this.yDd=X}get He(){return this.Pn}get type(){return this.IG}get xk(){return this.KVh}get id(){return this._id}get ggg(){return this.yDd}ee(z){return new Sj(z,this.type,this.xk,this.id,this.ggg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,this.xk,this.id?this.id.toString():"<null>")}}Object(h.a)(Sj,"IntentObject",null,[148]);d(604);class ki{constructor(z,Y,m,I=null,X=null){bn.a(z);this.IG=z;this.qyd=Y;this.cBd=m;this._id=I;this.yDd=
X}get type(){return this.IG}get begin(){return this.qyd}get end(){return this.cBd}get id(){return this._id}get ggg(){return this.yDd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(h.a)(ki,"IntentRange",null,[221]);d(361);d(158);d(215);class nf{constructor(z){this.gh=z}}Object(h.a)(nf,"IntentRangeEditor",null,[478]);class li{constructor(){this.Da=null}get name(){return"Box4.Intent"}Zb(z){this.Da=
z;this.Da.register(nf,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().oa(()=>new nf(this.Da.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){Ma.a.instance.Dc(new li)}}Object(h.a)(li,"PackageManager",null,[2,3]);var cn=d(1162),dn=d(1125),En=d(304),Pk=d(1126),bk=d(935),uj=d(799);class og{}og.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");
og.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");og.XKl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");og.hii=["en-US","en-CA","en-GB","en-AU","en-IN"];og.iii="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");
og.VKi="en-US";og.vNi="btnStartDictation";og.GNi="btnDictationFloatieToggle";og.ANi="Dictation";og.HNi="DictationFloatieToggle";og.hPf="Insertaudio_32x32x32";og.gPf="Insertaudio_16x16x32";og.zNi="JotInsertAudioRecordingShort_32x32x32";og.yNi="JotInsertAudioRecordingShort_16x16x32";og.Eql="speechOn.wav";og.Dql="speechOff.wav";Object(h.a)(og,"DictationConstants",null,[]);class ol{constructor(z){this.nhf=z;this.qNa=(z=He.a.xe(z))?z.displayName:this.nhf;this.CG=z?z.LCID:ol.b0j}get G1c(){return this.nhf}get displayName(){return this.qNa}get LCID(){return this.CG}}
ol.b0j=1033;Object(h.a)(ol,"DictationLanguage",null,[]);class ck{constructor(z,Y,m,I,X,ta,Fa,bb,yb){this.SAc=null;this.wdf=!1;this.vba=null;this.Rqb=!1;this.Fjd=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;wc&&(Bb=!!O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Pp,this.vba?wc[Bb?Jd.a.On:dn.a.On]=this.vba.isVisible():(Ob=this.r2.GI(),Ob=(pb=2===Ob)||1===Ob,Bb?(wc[Jd.a.On]=Ob,wc[En.a.IconSet]=pb?(new Pk.a("JotInsertAudioRecordingShort_20")).iconSet:O.AFrameworkApplication.Aa.hb.Voa?(new Pk.a("InsertAudio_32")).iconSet:
(new Pk.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(wc[dn.a.On]=Ob,pb?(wc[dn.a.Image32by32Class]=wd.getImageClass(og.zNi),wc[dn.a.Image16by16Class]=wd.getImageClass(og.yNi)):(wc[dn.a.Image32by32Class]=wd.getImageClass(og.hPf),wc[dn.a.Image16by16Class]=wd.getImageClass(og.gPf)))));return 32};this.Glb=(Bb,pb,Ob,sc,wc)=>{if(2===Ob){if(!this.vba||(null===wc||void 0===wc?0:wc.fPf))return this.L2d(wc);this.mDh()}return 32};this.Htd=(Bb,pb,Ob)=>2!==Ob?32:this.L2d(void 0);this.jmc=(Bb,pb,Ob,
sc,wc)=>{if(1===Ob)return 32;this.bHk(wc,Bb===he.a.Wah);return 32};this.EOe=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;wc&&((Bb=wc.MenuItemId)&&Bb===this.ug.YS?(wc[Jd.a.On]=!0,this.SAc=wc.SourceControlId):wc[Jd.a.On]=!1);return 32};this.TNe=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;wc&&(wc[bk.a.Value]=(new ol(this.ug.YS)).displayName);return 32};this.QVe=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;wc&&(Bb=wc.SourceControlId,this.SAc!==Bb&&(this.ug.YS=wc.MenuItemId,this.WHh(this.SAc),this.WHh(Bb),this.SAc=Bb,
2===this.r2.GI()&&this.dV()));return 32};this.RVe=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;if(wc){Bb=wc.MenuItemId;if(this.ug.YS!==Bb){this.ug.YS=Bb;if(this.vba)this.vba.onDictationLanguageChanged(Bb);2===this.r2.GI()&&this.dV()}this.h5e()}return 32};this.showHelpPane=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;Bb=this.mOh.value;if(!Bb)return 0;wc&&(wc={},wc.query="AssetID="+(this.ug.AIl?ck.BTh:ck.JCd),wc=Object.assign(new cn.a,{nonPersistedSettings:wc}),Bb.lga(ck.ICd,wc));return 32};this.Hxl=(Bb,pb,Ob,
sc,wc)=>{if(1===Ob)return this.ug.hje?32:8;wc&&this.ug&&(this.ug.useAutoPunctuation=wc[Jd.a.On]);2===this.r2.GI()&&this.dV();this.h5e();return 32};this.Uxl=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return this.ug.pne?32:8;wc&&this.ug&&(this.ug.LPb=wc[Jd.a.On]);2===this.r2.GI()&&(this.r2.dV(),this.pPb());this.vHh();return 32};this.qOk=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;wc&&this.ug&&(wc[Jd.a.On]=this.ug.useAutoPunctuation);return 32};this.rOk=(Bb,pb,Ob,sc,wc)=>{if(1===Ob)return 32;wc&&this.ug&&(wc[Jd.a.On]=
this.ug.LPb);return 32};this.Xtk=(Bb,pb,Ob)=>{2===Ob&&this.UOc();return 32};this.uxk=(Bb,pb,Ob)=>{2===Ob&&this.ug.zL&&2===this.r2.GI()&&this.dV();return 32};this.xuk=(Bb,pb,Ob)=>{2===Ob&&this.ug.zL&&this.UOc();return 32};this.nHb=(Bb,pb,Ob)=>{2===Ob&&(this.ug.zL?this.UOc():this.dV());return 32};this.zuk=(Bb,pb,Ob)=>{2===Ob&&this.dV();return 32};this.$tk=(Bb,pb,Ob)=>{2===Ob&&this.pPb();return 32};this.auk=(Bb,pb,Ob)=>{2===Ob&&(this.r2.dV(),this.pPb());return 32};this.Ztk=(Bb,pb,Ob,sc,wc)=>{2===Ob&&
wc&&(Bb=He.a.xe(this.ug.YS),this.Jf.vqc(this.yP.xs(wc),Bb.LCID,wc.Lb));return 32};this.Ytk=(Bb,pb,Ob)=>{2===Ob&&this.dV();return 32};this.cuk=(Bb,pb,Ob)=>{2===Ob&&this.dV();return 32};this.buk=(Bb,pb,Ob)=>2===Ob&&this.ug&&this.ug.nNj?this.ug.zL&&this.vba&&!this.vba.isVisible()?(this.mDh(),32):this.L2d(void 0):32;this.Ca=z;this.wZ=$f.App.i1a;this.gyc=$f.App.h_;this.r2=m;this.FDc=Y;this.Jf=I;this.yP=X;this.ug=Fa;this.Od=yb;this.ug.zL&&(this.vba=ta);this.mOh=bb}wb(){this.Ca.ra(he.a.jmc,Lc.a.view,this.jmc,
96);this.Ca.ra(he.a.QVe,Lc.a.view,this.QVe,1028);this.Ca.ra(he.a.EOe,Lc.a.view,this.EOe,96);this.Ca.ra(he.a.Glb,Lc.a.view,this.Glb,1028);this.Ca.ra(he.a.Fjd,Lc.a.view,this.Fjd,96);this.Ca.ra(he.a.cPf,Lc.a.view,this.nHb,64);this.Ca.ra(he.a.iPf,Lc.a.view,this.nHb,64);this.Ca.ra(he.a.lPf,Lc.a.view,this.$tk,64);this.Ca.ra(he.a.mPf,Lc.a.view,this.auk,64);this.Ca.ra(he.a.jPf,Lc.a.view,this.Ztk,64);this.Ca.ra(he.a.ePf,Lc.a.view,this.Ytk,64);this.Ca.ra(he.a.oPf,Lc.a.view,this.zuk,64);this.Ca.ra(he.a.kPf,
Lc.a.view,this.cuk,64);this.Ca.ra(he.a.Wah,Lc.a.view,this.jmc,96);this.Ca.ra(he.a.RVe,Lc.a.view,this.RVe,1028);this.Ca.ra(he.a.TNe,Lc.a.view,this.TNe,96);this.Ca.ra(he.a.CNi,Lc.a.view,this.showHelpPane,96);this.Ca.ra(he.a.DNi,Lc.a.view,this.showHelpPane,96);this.Ca.ra(he.a.BNi,Lc.a.view,this.Hxl,96);this.Ca.ra(he.a.jNk,Lc.a.view,this.qOk,96);this.Ca.ra(he.a.ENi,Lc.a.view,this.Uxl,96);this.Ca.ra(he.a.kNk,Lc.a.view,this.rOk,96);this.Ca.ra(he.a.Htd,Lc.a.view,this.Htd,1028);this.Ca.ra(he.a.dPf,Lc.a.view,
this.Xtk,1028);this.Ca.ra(he.a.xNi,Lc.a.view,this.uxk,96);this.Ca.ra(he.a.wNi,Lc.a.view,this.xuk,96);const z=Ac.KeyInputManager.Oa(ng.a.NJh,1);this.Od.Fc(kd.AFrame.hj).bindAction(z,he.a.nPf);this.Ca.ra(he.a.nPf,Lc.a.view,this.buk,1028)}JSc(){return O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Pp?this.ug.zL?og.HNi:og.ANi:this.ug.zL?og.GNi:og.vNi}s6h(){const z=Object.assign(new xi.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",
ControlList:[]}),Y=Object.assign(new La.a,{Id:"DictationLanguageList_"+this.JSc(),ExternalId:"DictationLanguageList_"+this.JSc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.JSc(),QueryCommand:"2417470717",Image16by16Class:wd.getImageClass(og.gPf),Image32by32Class:wd.getImageClass(og.hPf),Visible:!0,AriaLabel:Vb.a.chi});Array.add(z.ControlList,Y);return z}bHk(z,Y){z.MenuItems=Object.assign(new Le.a,{Id:Y?"DictationSettingsLanguageList":"DictationLanguageList",
MenuSectionList:[],UpdateDynamically:!0});if(!Y){var m=this.s6h();Array.add(z.MenuItems.MenuSectionList,m)}m=this.ug.Adh;0<m.length&&(m=ck.jMc(m,"dictationProdcutionLanguages","",Y),Array.add(z.MenuItems.MenuSectionList,m));m=this.ug.zch;0<m.length&&(Y=ck.jMc(m,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,Y),Array.add(z.MenuItems.MenuSectionList,Y));z.PopulationXML=dh.l(z.MenuItems);this.wdf=!0}pPb(){const z=this.FDc.value;if(z){const Y=this.JSc();if(O.AFrameworkApplication.Aa&&
O.AFrameworkApplication.Aa.hb.Pp){const m={};m[Y]=this.ug.zL?"ToggleButtonModel":"SplitButtonModel";this.wdf&&!this.ug.zL&&(m["DictationLanguageList_"+Y]="ToggleButtonModel");z.nPb(m)}this.h5e();this.vHh()}}h5e(){if(this.ug.zL){const z=this.FDc.value;O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Pp&&z.nPb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}vHh(){if(this.ug.zL){const z=this.FDc.value;O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Pp&&z.nPb({DictationSettingsVoiceCommands:"CheckboxModel"})}}WHh(z){const Y=
this.FDc.value;if(Y&&O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Pp){const m={};m[z]="ToggleButtonModel";Y.nPb(m)}}mDh(){this.Rqb||(this.Rqb=!0,this.vba.isVisible()?(this.UOc(),this.Rqb=!1):this.showFloatie(),this.pPb())}showFloatie(){this.vba.showFloatie((new ol(this.ug.YS)).displayName).then(()=>{0===this.r2.GI()&&this.r2.Tkb(void 0).then(()=>{this.Rqb=!1}).catch(z=>{this.Rqb=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",z)});this.ug.O9b&&this.wZ&&this.wZ.Crl();
this.gyc&&this.gyc.startSession()}).catch(()=>{this.Rqb=!1})}L2d(z){const Y=this.r2.GI();if(1===Y||3===Y)return 1;0===Y?this.Tkb(null===z||void 0===z?void 0:z.fPf):this.dV();return 32}UOc(){const z=this.r2.GI();1!==z&&(this.vba&&this.vba.hideFloatie(),this.wZ&&this.wZ.usl(),0!==z&&this.dV(),this.gyc&&this.gyc.endSession(),this.pPb())}dV(){this.r2.dV();this.pPb()}Tkb(z){this.r2.Tkb(z).then(()=>{}).catch(Y=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",Y)})}static createInstance(z,
Y,m,I,X,ta,Fa,bb){return ck.Ka||(ck.Ka=new ck(O.AFrameworkApplication.Ta,z,Y,m,I,X,ta,Fa,bb))}static jMc(z,Y,m,I){m=Object.assign(new xi.a,{DisplayMode:"Menu",Title:m,Id:Y,ControlsId:"ctr"+Y,ControlList:[]});for(const X of z){z=Y+"_"+X.G1c;const ta=X.displayName,Fa=X.G1c;I?(z=Object.assign(new uj.a,{Id:z,ExternalId:z,LabelText:ta,Command:"3662249320",MenuItemId:Fa,Visible:!0}),Array.add(m.ControlList,z)):(z=Object.assign(new La.a,{Id:z,ExternalId:z,LabelText:ta,Command:"2863762275",MenuItemId:Fa,
QueryCommand:"2739750502",Visible:!0,AriaLabel:Vb.a.esb}),Array.add(m.ControlList,z))}return m}}ck.Ka=null;ck.ICd="FA000000012";ck.JCd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";ck.BTh="78766431-0933-4603-abf5-5bcc1dee9dda";Object(h.a)(ck,"DictationActor",null,[514]);var Nm=d(271),Fn=d(1123),en=d(157);class Cl{constructor(z,Y){this.xZ=null;this.Fba=!1;this.jNa=null;this.iRh=z;this.ug=Y}isVisible(){return this.Fba}NYc(){return this.Fba&&!!this.xZ}YSi(){if(this.xZ)return!0;this.xZ=this.iRh.value;if(!this.xZ)return!1;
this.xZ.ZPl(he.a.Htd);this.xZ.TPl(he.a.dPf);Qe.a.addHandler(window.self,Nb.a.resize,()=>{this.zyj()});const z=id.FocusManager.instance().Fc(en.AppFrame.d8a);z.Q7(Y=>{this.Y_i(Y)});z.OBa((Y,m)=>{this.X_i(m)});z.dJ=!0;z.gTe=!0;Nm.a.instance.P2(en.AppFrame.d8a,!0);Nm.a.instance.Lo(en.AppFrame.d8a);return!0}Y_i(z){this.NYc()&&z.name!==kd.AFrame.ZO&&this.xZ.focus()}X_i(z){this.NYc()&&z.name!==kd.AFrame.ZO&&this.xZ.blur()}showFloatie(z){return this.Fba?Promise.resolve(null):this.YSi()?new Promise((Y,m)=>
{this.xZ.MOl().then(()=>{this.xZ.showDictationFloatie(this.Xwb(),!1,z,this.ug.useAutoPunctuation);this.jNa=z;this.Fba=!0;Nm.a.instance.rI(en.AppFrame.d8a);Y(null)}).catch(()=>{m("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.NYc()&&(this.xZ.dismissDictationFloatie(),Nm.a.instance.Lo(en.AppFrame.d8a),this.Fba=!1)}showDictationWarning(z){this.NYc()&&this.xZ.showDictationWarning(z)}onDictationLanguageChanged(z){this.jNa=z}Xwb(){var z=
$f.App.Kb.k8a.getBoundingClientRect();const Y=z.left+z.width/2-44;z=z.top+z.height-70;return Object.assign(new Fn.a,{x:Y,y:z})}zyj(){this.Fba&&this.xZ&&(this.xZ.dismissDictationFloatie(),this.xZ.showDictationFloatie(this.Xwb(),!1,this.jNa,this.ug.useAutoPunctuation))}}Object(h.a)(Cl,"DictationFloatieManager",null,[]);class Nd{constructor(){this.Sha=this.MAa=0;this.Eyc=null;this.Iba=!0;this.Wvc="";this.ug=this.Eh=null;this.NAa=this.Nba=this.CNa=this.It=this.Dj=0;this.fBd=this.qZ="";this.iWb=this.pRb=
0;this.zBd=this.QBd=this.PBd=!1;this.NLd="";this.SVb=this.RSb=this.Zh=this.q2=null;this.Nzd=this.sBc=this.rBc=this.mNd=this.Eqf=this.A5a=this.y5a=0}set Vzi(z){this.qZ=z}get sya(){return $f.App.h_?$f.App.h_.sya:""}get v1a(){return $f.App.h_?$f.App.h_.v1a:""}set v1a(z){$f.App.h_&&($f.App.h_.v1a=z)}onFragment(z){this.CNa||(this.CNa=(new Date).getTime());this.RSb&&(this.RSb.stop(),this.y5a+=this.RSb.Vq,this.RSb.start());this.MAa++;this.NAa+=z.split(" ").length}onFinalPhrase(z){this.CNa||(this.CNa=(new Date).getTime());
this.SVb&&(this.SVb.stop(),this.A5a+=this.SVb.Vq,this.SVb.start());this.NAa=0;this.Sha++;this.Nba+=z.split(" ").length}onConnectionStarted(z){this.pRb=(new Date).getTime();this.Vzi=z;this.Zh&&(this.RSb=this.Zh.Ei("WebServiceCall","FragmentResponse"),this.SVb=this.Zh.Ei("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.iWb=(new Date).getTime()}onMicrophoneError(z){this.onCustomError("MicrophoneError",z)}onCustomError(z,Y=null){this.Iba=!1;this.Eyc=z;this.setEndReason(Y||z)}setEndReason(z){this.fBd=
z}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(z,Y){this.Nzd=Y;z?(this.mNd+=Y,Y>this.sBc&&(this.sBc=Y)):(this.Eqf=Y,Y>this.rBc&&(this.rBc=Y))}onFocusLost(){this.PBd=!0}onFocusLostWhileStarting(){this.QBd=!0}onFailedToStartTurn(){this.zBd=!0}onSpeechSessionStarted(z){this.NLd=z}setDictationLatency(z){this.q2=z}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(h.a)(Nd,"AbstractDictationSessionTelemetry",null,[558]);class Ah{}Ah.seen="Seen";Ah.tried="Tried";Ah.kept="Kept";Object(h.a)(Ah,"FunnelStatus",null,[]);class Se{constructor(){this.dataFields=this.name=null}}Object(h.a)(Se,"Contract",null,[]);class Mj extends Nd{constructor(z,Y){super();this.p$e=this.o$e=this.L8e=!1;this.DGd=this.yGd=this.HJd=0;this.NGd=this.MGd=2147483647;this.lNd=this.jNd=0;this.ug=z;this.Dj=(new Date).getTime();this.Zh=Y;this.v1a=ea.a.create().toString();this.Eh=new rk.a;
this.Eh.dataFields=[];this.Wvc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(z,Y,m){z=z+this.Nzd-(this.HJd+(Y+m)/1E4);this.jNd+=z;this.yGd<z&&(this.yGd=z);this.MGd>z&&(this.MGd=z)}onPartialResultAnnotationResponse(z,Y,m){z=z+this.Nzd-(this.HJd+(Y+m)/1E4);this.lNd+=z;this.DGd<z&&(this.DGd=z);this.NGd>z&&(this.NGd=z)}setRecordingStartTime(z){this.HJd=z}onCommandCalled(){this.o$e=!0}onAugloopError(z){this.Iba=!1;this.L8e=!0;this.Eyc=z}onCommandError(){this.p$e=!0}endActivity(){this.Nba+=
this.NAa;this.It=(new Date).getTime();this.Eh.succeeded=this.Iba;this.Eh.durationMs=this.It-this.Dj;Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"Success",bool:this.Iba}));this.Iba||Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"error",string:this.Eyc}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"SessionID",string:this.sya}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"SpeechSessionID",string:this.NLd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,
{name:"TurnID",string:this.v1a}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"NumberOfWords",int64:0<this.NAa?this.NAa+this.Nba:this.Nba}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"NumberOfFragments",int64:this.MAa}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"NumberOfFinalPhrases",int64:this.Sha}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"Language",string:this.ug.YS}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"connectionID",
string:this.qZ}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"IsUsingFloatie",bool:this.ug.zL}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"UseAutoPunctuation",bool:this.ug.useAutoPunctuation}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"EndReason",string:this.fBd}));this.CNa&&Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"TimeToGetFirstResult",int64:this.CNa-
this.pRb}));this.Iba&&(Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"TimeToStartRecording",int64:this.iWb-this.Dj})),Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"TimeToOpenConnection",int64:this.pRb-this.iWb})));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"FocusLost",bool:this.PBd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"FocusLostWhileStarting",bool:this.QBd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"FailedToStartTurn",
bool:this.zBd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"MaxTimeToInsertFragment",int64:this.rBc}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"MaxTimeToInsertPhrase",int64:this.sBc}));var z=Ah.seen;this.Iba&&0<this.Nba&&(z=0<this.Sha?Ah.kept:Ah.tried);Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"DictationFunnel",contract:Object.assign(new Se,{name:"Office.System.Funnel",dataFields:[Object.assign(new cf.a,{name:"Name",string:"Dictation"}),Object.assign(new cf.a,
{name:"State",string:z})]})}));this.Eh.name=this.Wvc;this.Eh.samplingPolicy=2;Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"AugloopFailed",bool:this.L8e}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"CommandsUsed",bool:this.o$e}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"CommandsFailed",bool:this.p$e}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.yGd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.MGd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.DGd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.NGd}));z=0<this.Sha?this.jNd/this.Sha:0;const Y=0<this.MAa?this.lNd/this.MAa:0;Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"AverageFinalResultUserPerceivedLatency",double:z}));Array.add(this.Eh.dataFields,
Object.assign(new cf.a,{name:"AveragePartialResultUserPerceivedLatency",double:Y}));vf.a.sendActivityEvent(this.Eh)}}Object(h.a)(Mj,"AugloopDictationTelemetry",Nd,[]);var ue=d(219);class Dl{constructor(z){this.T6=z}play(){this.T6.play()}pause(){this.T6.pause()}get paused(){return this.T6.paused}get currentTime(){return this.T6.currentTime}set currentTime(z){this.T6.currentTime=z}get duration(){return this.T6.duration}get error(){const z=this.T6.error;return z?z.code:0}get readyState(){return this.T6.readyState}get src(){return this.T6.getAttribute("src")}set src(z){this.T6.setAttribute("src",
z)}get preload(){return this.T6.getAttribute("preload")}set preload(z){this.T6.setAttribute("preload",z)}get Uf(){return this.T6}}Object(h.a)(Dl,"AudioElement",null,[]);class bj{constructor(){this.DHd=this.CHd=this.A5a=this.y5a=this.BAd=0}onAudioData(){this.BAd||(this.BAd=(new Date).getTime())}onFragment(z){this.y5a+=this.V8f(z);this.CHd++}wxk(z){this.A5a+=this.V8f(z);this.DHd++}E_f(){return this.DHd?this.A5a/this.DHd:0}W4i(){return this.CHd?this.y5a/this.CHd:this.E_f()}V8f(z){if(!z)return 0;const Y=
(new Date).getTime();let m=null;return({sv:m}=D.d(z)).returnValue?Y-this.BAd-(m.Offset+m.Duration)/1E4:0}}Object(h.a)(bj,"DictationLatency",null,[]);class $g{constructor(z,Y){this.e7=0;this.LLd=this.MLd=null;this.hUb=!1;this.yBc=null;this.hAc=!1;this.q2=this.Tq=null;this.xG=Y;this.Aba=z}onFinalText(z,Y){if(2===this.e7){var m=z.size;if(1!==m&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",m),!m))return;Y=Y.get("JsonResult");this.q2&&this.q2.wxk(Y);this.xG.onFinalPhrase(z.values().next().value,
Y)}}onFragmentText(z,Y){if(2===this.e7){var m=z.size;if(1!==m&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",m),!m))return;Y=Y.get("JsonResult");if(this.q2)this.q2.onFragment(Y);this.xG.onFragment(z.values().next().value)}}onError(z){if(0!==this.e7&&3!==this.e7&&"ErrorNone"!==z){this.e7=3;switch(z){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.xG.Ark(z);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.xG.wtk(z);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.xG.uM(z);break;case "ErrorInitialSilenceTimeout":this.xG.Jvk(z);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.xG.onMicrophoneError(z);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.xG.mIe("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.xG.mIe("NotFoundError");break;case "ErrorAudioNotReadableError":this.xG.mIe("NotReadableError");break;default:this.xG.uAk(z)}this.e7=0}}onSpeechRecognitionStarted(z){window.self.document.hasFocus()?(this.e7=2,this.hUb=!1,this.xG.onRecordingStarted(),this.xG.onConnectionStarted(z),this.MLd||
(this.MLd=Object.assign(new Dl(document.createElement("audio")),{src:ue.a.box4Image(og.Eql)})),this.MLd.play()):(this.M4e(),this.xG.onFocusLost())}onSpeechEnd(){this.M4e();0!==this.GI()&&(this.e7=3,this.xG.byk(),this.e7=0,this.LLd||(this.LLd=Object.assign(new Dl(document.createElement("audio")),{src:ue.a.box4Image(og.Dql)})),this.LLd.play())}onAudioData(z){if(this.q2)this.q2.onAudioData();if(this.Aba){var Y=0;for(const m of z)Y+=Math.pow(m,2);z=Math.sqrt(Y/z.length)>$g.rql;!this.hUb&&z?(this.hUb=
!0,this.yBc=null):this.hUb&&!z&&(this.yBc?(new Date).getTime()>=this.yBc+$g.Ank&&(this.hUb=!1):this.yBc=(new Date).getTime())}}onSpeechSessionStarted(z){this.xG.onSpeechSessionStarted(z)}onEventUpdate(z){if(this.Aba&&"QualityStatusUpdate"===z.eventName)switch(z.shortCode){case 13:case 2:this.Aba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.Aba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.Aba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}P0a(z,
Y){this.xG.wDa(!1);this.xG.Mx=z;this.xG.ohg=Y;this.DVk();this.Tq=z;this.e7=1;this.q2=new bj;this.Tq&&this.Tq.setDictationLatency(this.q2)}GI(){return this.e7}DVk(){this.hAc||(Qe.a.addHandler(window.self,Nb.a.blur,Object(v.a)(this,this.y4g,"onFocusLostEventHandler")),this.hAc=!0)}M4e(){this.hAc&&(Qe.a.removeHandler(window.self,Nb.a.blur,Object(v.a)(this,this.y4g,"onFocusLostEventHandler")),this.hAc=!1)}y4g(){if(1===this.e7){if(this.Tq)this.Tq.onFocusLostWhileStarting()}else 2===this.e7&&(this.M4e(),
this.xG.onFocusLost())}}$g.rql=350;$g.Ank=350;Object(h.a)($g,"FrontdoorSpeechClientObserver",null,[987]);class Gn extends $g{constructor(z,Y){super(z,Y);this.ENa=new $g(z,Y)}onFinalText(z,Y){this.ENa.onFinalText(z,Y)}onFragmentText(z,Y){this.ENa.onFragmentText(z,Y)}onError(z){this.ENa.onError(z)}onSpeechRecognitionStarted(z){this.ENa.onSpeechRecognitionStarted(z)}onSpeechEnd(){this.ENa.onSpeechEnd()}onAudioData(z){this.ENa.onAudioData(z)}P0a(z,Y){this.ENa.P0a(z,Y)}GI(){return this.ENa.GI()}}Object(h.a)(Gn,
"AugloopFrontdoorSpeechObserverAbstractDecorator",$g,[]);class Hn extends Gn{constructor(z,Y,m){super(z,Y);this.Tc=m}onFinalText(z,Y){super.onFinalText(z,Y)}onFragmentText(z,Y){if(this.mme())super.onFragmentText(z,Y)}onError(z){super.onError(z)}onSpeechRecognitionStarted(z=null){const Y=ea.a.create().toString();super.onSpeechRecognitionStarted(z?z:Y)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(z){super.onAudioData(z)}P0a(z,Y){super.P0a(z,Y)}GI(){return super.GI()}mme(){const z=this.Tc.Na.mb.Ua;
return z.Lb!==z.Qa?!1:!0}}Object(h.a)(Hn,"AugloopFrontdoorSpeechObserverDecorator",Gn,[]);class gp{constructor(z){this.Arf=z}onVoiceCommand(z){this.Arf.onVoiceCommand(z)}setDictationSessionTelemetry(z){this.Arf.setDictationSessionTelemetry(z)}}Object(h.a)(gp,"AugloopVoiceCommandObserverAbstractDecorator",null,[985]);class Jo extends gp{constructor(z,Y,m){super(z);this.m2=Y;this.Tc=m}onVoiceCommand(z){this.mme()&&this.m2.nQl();super.onVoiceCommand(z)}setDictationSessionTelemetry(z){super.setDictationSessionTelemetry(z)}mme(){const z=
this.Tc.Na.mb.Ua;return z.Lb!==z.Qa?!1:!0}}Object(h.a)(Jo,"AugloopVoiceCommandObserverDecorator",gp,[]);class rn{constructor(z){this.ug=z}jrg(z){const Y=O.AFrameworkApplication.Ke;if(Y){var m=this.ug.lZf;m&&""!==m&&Y.nj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",m),2,z,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(h.a)(rn,"FrontdoorCorrectionsTelemetryLogger",null,[986]);class ko{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(h.a)(ko,"SpeechDictationSettings",null,[]);class cj{constructor(z,Y,m,I){this.AAd=this.Oy=null;this.m2=z;this.Aba=Y;this.xG=m;this.wnb=I;this.initializeCommandsDictionary()}onVoiceCommand(z){if(this.AAd)this.AAd.onCommandCalled();var Y=4;if(({value:Y}=this.Oy.Tf(z.commandId,0)).returnValue&&4!==Y){let m=null;z.commandValue&&(m=new r.a(n.a.Hn()),m.add("commandValue",z.commandValue));this.xG.wDa(!1);Y=this.m2.executeCommand(Y,m);if(z.offset&&
z.duration)this.wnb.onCommandFinished(z.commandId,Y,z.offset,z.duration)}}setDictationSessionTelemetry(z){this.AAd=z}initializeCommandsDictionary(){this.Oy=new r.a(n.a.Hn());this.Oy.add("Word.Editing.Undo",2);this.Oy.add("Word.Editing.Bold",5);this.Oy.add("Word.Editing.Italics",6);this.Oy.add("Word.Editing.Underline",10);this.Oy.add("Word.Editing.StrikeThrough",20);this.Oy.add("Word.Editing.Subscript",19);this.Oy.add("Word.Editing.Superscript",18);this.Oy.add("Word.Editing.RemoveBold",11);this.Oy.add("Word.Editing.RemoveUnderline",
13);this.Oy.add("Word.Editing.RemoveItalics",12);this.Oy.add("Word.Editing.RemoveStrikeThrough",21);this.Oy.add("Word.Editing.RemoveSubscript",22);this.Oy.add("Word.Editing.RemoveSuperscript",24);this.Oy.add("Word.Editing.Paste",7);this.Oy.add("Word.Editing.InsertTable",8);this.Oy.add("Word.Editing.InsertComment",9);this.Oy.add("Word.Editing.InsertBullet",23);this.Oy.add("Word.Editing.FullJustify",14);this.Oy.add("Word.Editing.CenterJustify",15);this.Oy.add("Word.Editing.LeftJustify",16);this.Oy.add("Word.Editing.RightJustify",
17);this.Oy.add("Command.Exit",1);this.Oy.add("Command.Pause",0);this.Oy.add("Command.ShowHelp",26);this.Oy.add("Command.ShowCommand",27);this.Oy.add("Word.Editing.RemoveFormatting",28)}}Object(h.a)(cj,"VoiceCommandObserver",null,[985]);var ne=d(978);class Xi{constructor(z,Y,m,I,X,ta,Fa){this.Tq=this.eYb=null;this.rCj=0;this.wnb=X;this.ug=Fa;X=new ko;X.dictationLanguage=Fa.YS;X.useAutoPunctuation=Fa.useAutoPunctuation?"Intelligent":"Explicit";X.useCorrections=Fa.O9b.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
X;this.G7=new Hn(z,ta,I);this.Brf=new Jo(new cj(Y,z,ta,this.wnb),Y,I);this.twc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.s8e=Array(m);this.twc.setAnnotationResultCallback(Object.assign(new ne.a,{handler:bb=>{for(const yb of this.s8e)yb.onAnnotationResult(bb)}}));this.kXb=new alVoiceClient.SpeechToTextClient(this.twc,this.G7,Fa.jmb||Fa.Ivd,!1);this.Dsf(this.kXb.getAnnotationObserver());this.dYb=new alVoiceClient.VoiceCommandingClient(this.twc,this.Brf,this.G7);this.Dsf(this.dYb.getAnnotationObserver());
Fa.O9b&&(z=new rn(Fa),(Y=$f.App.i1a)&&Y.Dhh(z))}ffg(z,Y){return new Promise(m=>{const I=new ko;I.dictationLanguage=z;I.useAutoPunctuation=this.ug.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=I;this.Tq=Y;m(this.DFj())})}Tkb(z){if(!this.kXb)return 3;this.eYb.startVoiceSessionFromMicrophoneInput();this.G7.P0a(this.Tq,z);z=this.ug.LPb;this.kXb.initializeAsync(z?[1]:[1,0],this.Tq);z&&this.hsl();return 0}dV(z){if(z&&this.G7)this.G7.onSpeechEnd();this.kXb&&
this.kXb.uninitializeAsync();this.eYb&&(this.eYb.stopVoiceSession(),this.eYb=null);this.Tq=null;this.ug.LPb&&this.Hsl()}GI(){return this.G7.GI()}DFj(){this.ug.LPb&&this.Brf.setDictationSessionTelemetry(this.Tq);this.eYb=new alVoiceClient.VoiceSession(this.twc,this.G7,this.ug.jmb,this.wnb,this.Tq);return 0}hsl(){this.dYb&&this.dYb.initializeAsync(this.Tq)}Hsl(){this.dYb&&this.dYb.uninitializeAsync()}Dsf(z){this.s8e[this.rCj++]=z}}Object(h.a)(Xi,"AugloopSpeechClientProxy",null,[528]);class gd extends Nd{constructor(z,
Y){super();this.ug=z;this.Dj=(new Date).getTime();this.Zh=Y;this.v1a=ea.a.create().toString();this.Eh=new rk.a;this.Eh.dataFields=[];this.Wvc="Office.Voice.Online.DictationSession"}endActivity(){this.Nba+=this.NAa;this.It=(new Date).getTime();this.Eh.succeeded=this.Iba;this.Eh.durationMs=this.It-this.Dj;Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"Success",bool:this.Iba}));this.Iba||Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"error",string:this.Eyc}));Array.add(this.Eh.dataFields,
Object.assign(new cf.a,{name:"SessionID",string:this.sya}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"SpeechSessionID",string:this.NLd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"TurnID",string:this.v1a}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"NumberOfWords",int64:0<this.NAa?this.NAa+this.Nba:this.Nba}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"NumberOfFragments",int64:this.MAa}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,
{name:"NumberOfFinalPhrases",int64:this.Sha}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"Language",string:this.ug.YS}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"connectionID",string:this.qZ}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"IsUsingFloatie",bool:this.ug.zL}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"UseAutoPunctuation",bool:this.ug.useAutoPunctuation}));
Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"EndReason",string:this.fBd}));this.CNa&&Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"TimeToGetFirstResult",int64:this.CNa-this.pRb}));this.Iba&&(Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"TimeToStartRecording",int64:this.iWb-this.Dj})),Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"TimeToOpenConnection",int64:this.pRb-this.iWb})));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"FocusLost",
bool:this.PBd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"FocusLostWhileStarting",bool:this.QBd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"FailedToStartTurn",bool:this.zBd}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"AverageFragmentLatency",double:this.q2?this.q2.W4i():0<this.MAa?this.y5a/this.MAa:0}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"AveragePhraseLatency",double:this.q2?this.q2.E_f():0<this.Sha?this.A5a/this.Sha:0}));
Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"AveragePhraseInsertionLatency",double:0<this.Sha?this.mNd/this.Sha:0}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"AverageFragmentInsertionLatency",double:0<this.MAa?this.Eqf/this.MAa:0}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"MaxTimeToInsertFragment",int64:this.rBc}));Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"MaxTimeToInsertPhrase",int64:this.sBc}));let z=Ah.seen;this.Iba&&0<this.Nba&&
(z=0<this.Sha?Ah.kept:Ah.tried);Array.add(this.Eh.dataFields,Object.assign(new cf.a,{name:"DictationFunnel",contract:Object.assign(new Se,{name:"Office.System.Funnel",dataFields:[Object.assign(new cf.a,{name:"Name",string:"Dictation"}),Object.assign(new cf.a,{name:"State",string:z})]})}));this.Eh.name=this.Wvc;this.Eh.samplingPolicy=2;vf.a.sendActivityEvent(this.Eh)}}Object(h.a)(gd,"DictationSessionTelemetry",Nd,[]);var Tj=d(1157);class fg{constructor(z,Y){this.VBc=z;this.GUh=Y}getAccessToken(z){this.GUh&&
this.VBc?this.VBc.sV("OfficeDictation",O.AFrameworkApplication.fa.Ga("DictationResourceID")).then(Y=>{Y.IsSuccess?z(Y.Token):z(fg.f1d)}).catch(()=>{z(fg.f1d)}):z(fg.f1d)}}fg.f1d="dictation access token";Object(h.a)(fg,"AuthenticationProvider",null,[]);class Ip{constructor(z){this.NUh=z;this.tFc=new Pd.a}debugAssertTag(z,Y,m,I){this.Bwd(I);this.tFc.debugAssertTag(z,Y,m,I)}debugTraceTag(z,Y,m,I){this.Bwd(I);this.tFc.debugTraceTag(z,Y,m,I)}sendTraceTag(z,Y,m,I){this.Bwd(I);this.tFc.sendTraceTag(z,Y,
m,I)}shipAssertTag(z,Y,m,I){this.Bwd(I);this.tFc.shipAssertTag(z,Y,m,I)}Bwd(z){if(this.NUh){const Y=window.console;Y&&Y.log(String.format("FDSpeechService: {0}",z))}}}Object(h.a)(Ip,"FrontdoorExternalLogger",null,[263]);class hp{constructor(){this.accessToken=null}}Object(h.a)(hp,"IAuthenticationProvider",null,[]);class El{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=
null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(h.a)(El,"ISpeechConfig",null,[]);class Cm{constructor(z,Y,m,I,X){this.Tq=this.xqb=null;this.$Ld=!1;this.G7=new $g(m,I);this.DV=z;this.ug=Y;this.FOh=new fg(X,Y.mNj);this.ug.O9b&&(z=new rn(Y),(Y=$f.App.i1a)&&Y.Dhh(z))}ffg(z,Y){return new Promise(m=>{this.FOh.getAccessToken(I=>{m(this.fFj(z,Y,I))})})}fFj(z,Y,m){this.Tq=Y;z=this.mYd(z);m=Object.assign(new hp,{accessToken:m});Y=
new Ip(this.ug.uZc);this.xqb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(z,this.G7,m,null,Y);return this.xqb?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}Tkb(z){if(!this.xqb)return 3;this.G7.P0a(this.Tq,z);this.xqb.startSpeechRecognition();return 0}dV(z){if(!this.$Ld){this.$Ld=!0;if(this.xqb)try{this.xqb.stopSpeechRecognition()}catch(Y){e.ULS.shipAssertTag(593277727,394,!1,Y.message)}if(z&&this.G7)this.G7.onSpeechEnd();this.Tq=null;this.$Ld=
!1}}GI(){return this.G7.GI()}mYd(z){const Y=new El;Y.speechMode="Dictation";Y.sourceLanguage=z;(z=this.ug.lZf)&&""!==z&&(Y.speechFDBase=String.format("wss://{0}/",z));Y.properties=new Map;this.DV&&(Y.properties.set("DictationInsertionPointLeft",this.DV.yae()),Y.properties.set("DictationInsertionPointRight",this.DV.F8f()));Y.properties.set("Corrections","true");Y.properties.set("punctuation",this.ug&&this.ug.useAutoPunctuation?"Intelligent":"Explicit");this.ug.uZc&&Y.properties.set("EnableAudioLogging",
this.ug.uZc.toString());switch(Tj.a.pRd){case "Word":Y.clientApp=1;break;case "PowerPoint":Y.clientApp=0;break;case "OneNote":Y.clientApp=2}return Y}}Object(h.a)(Cm,"FrontdoorSpeechClientProxy",null,[528]);class Kg{static zll(){Kg.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static Yll(){Kg.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static nnl(z){Kg.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
z)}static xol(){Kg.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(z,Y){Kg.Af||(Kg.Af=new mb.StandardDialog,Kg.Af.Ar=O.AFrameworkApplication.Kda,Kg.Af.yd=0,Kg.Af.Xe(1,CommonUIStrings.l_DialogClose),Kg.Af.fP(z,Y,()=>{Kg.Af=null}))}}Kg.Af=null;Object(h.a)(Kg,"Dialogs",null,[]);class Uj{constructor(z,Y,m,I,X,ta,Fa,bb){this.qpb=this.Wqb=!1;this.Mx=null;this.DV=z;this.ohg=Y;this.Ca=m;this.YMa=I;this.ug=X;this.m2=ta;this.mRb=
Fa;this.Aba=bb;this.ymf=new P.a;for(z=0;z<Uj.xmf.length;z++)this.ymf.add(Uj.xmf.charAt(z).toString())}onFinalPhrase(z,Y=null){let m=!0;if(this.Mx)this.Mx.onFinalPhrase(z);if(this.mRb&&this.m2){var I=this.mRb.oPl(z);if(I){this.wDa(!1);this.m2.executeCommand(I.commandId,null);return}}I=(new Date).getTime();if(1===z.length&&"\n"===z)this.Jbe("",null),this.kUf();else{let X=z.indexOf("\n");for(0<X&&X!==z.length-1&&(m=!1);0<=X;)this.Jbe(z.substr(0,X),m?Y:null),this.kUf(),z=z.substr(X+1),X=z.indexOf("\n"),
m=!1;this.Jbe(z,m?Y:null)}z=(new Date).getTime();if(this.Mx)this.Mx.onTextInserted(!0,z-I)}onFragment(z){if(this.Wqb)var Y=this.dVc(z);else{if(!this.vsc())return;Y=this.qpb?this.dVc(z):z}if(this.Mx)this.Mx.onFragment(z);z=!0;const m=(new Date).getTime();this.DV&&!this.DV.sxf(Y)&&(this.dag(),z=!1);Y=(new Date).getTime();if(this.Mx)this.Mx.onTextInserted(!1,Y-m);z&&this.m2&&this.m2.hPl()}onRecordingStarted(){this.Ca.processAction(he.a.lPf,2);if(this.Mx)this.Mx.onRecordingStarted()}onMicrophoneError(z=
""){this.Aag(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,z)}nHb(z){if(this.Mx)this.Mx.onCustomError(z);this.Ca.La(he.a.cPf,2,z)}Ark(z){this.nHb(z);Kg.zll()}wtk(z){this.nHb(z);Kg.Yll()}uAk(z){this.nHb(z);Kg.xol()}uM(z){this.Mx&&this.Mx.setEndReason(z);this.Ca.La(he.a.kPf,2,z)}Jvk(z){this.uM(z);this.$nl()}byk(){this.wDa(!1);this.Ca.processAction(he.a.mPf,2)}onConnectionStarted(z){if(this.Mx)this.Mx.onConnectionStarted(z)}mIe(z){this.Aag(this.cej(z),z)}onFocusLost(){if(this.Mx)this.Mx.onFocusLost();
this.Ca.processAction(he.a.ePf,2)}qWj(z){return this.ohg&&!ob.a.rne(z)&&!this.ymf.contains(z.toString())}dVc(z){return 0<z.length&&this.qWj(z.charAt(0))?" "+z:z}vsc(){if(this.Wqb)return!0;if(this.DV){const z=this.DV.yae();this.qpb=!1;z&&0<z.length&&(this.qpb=!ob.a.rne(z.charAt(z.length-1))&&!z.endsWith("\u201c"));return this.Wqb=this.DV.vsc()}if(this.Mx)this.Mx.onFailedToStartTurn();this.m2&&this.m2.jPl();return!1}wDa(z){this.qpb=this.Wqb=!1;this.DV&&(z&&this.DV.p_g(),this.DV.wDa())}onSpeechSessionStarted(z){if(this.Mx)this.Mx.onSpeechSessionStarted(z);
this.ug.uZc&&this.XYe(z)}Aag(z,Y=""){if(this.Mx)this.Mx.onMicrophoneError(Y);this.Ca.processAction(he.a.iPf,2);Kg.nnl(z)}cej(z){z=z.trimStart();return z.startsWith("NotAllowedError")||z.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:z.startsWith("NotFoundError")||z.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:z.startsWith("NotReadableError")||z.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}$nl(){this.YMa&&this.YMa.execute(z=>{z.mml()})}XYe(z){this.YMa&&this.YMa.execute(Y=>{Y.XYe(String.format("ServiceSessionID:{0} ClientSessionId: {1}",z,this.hvi))})}Jbe(z,Y){if(this.Wqb||this.vsc()){if(this.DV){const m=this.qpb?this.dVc(z):z;(this.ug.O9b&&Object(Qi.a)(527,this.DV)?this.DV.OOl(m,Y,0<z.length&&z.charAt(0)!==m.charAt(0)):this.DV.Lfg(this.qpb?this.dVc(z):z))||this.dag()}this.wDa(!0)}}dag(){if(this.Mx)this.Mx.onTextInsertionError();
this.Ca.processAction(he.a.oPf,2)}kUf(){this.Ca.processAction(he.a.CB,2)}get hvi(){return $f.App.h_?$f.App.h_.sya:""}}Uj.xmf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(h.a)(Uj,"SpeechClientObserverController",null,[]);class kk{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob){this.pBa=null;this.KLd=new Map;this.mRb=this.m2=this.Aba=this.Tq=null;this.Vw=z;this.jRh=Y;this.Tc=m;this.YMa=I;this.Zh=X;this.ug=ta;this.VBc=pb;this.Sof=Ob;this.ug.zL&&(this.Aba=Fa);if(this.ug.Iig||this.ug.jmb)this.m2=
bb;this.ug.Iig&&(this.mRb=yb);this.wnb=Bb}Tkb(z){this.YMa&&this.YMa.execute(I=>{I.BAj()});const Y=this.jRh.value,m=null!==z&&void 0!==z?z:"Box4.Dictation.IDictationHost";return new Promise((I,X)=>{this.KLd.has(m)?(this.pBa=this.KLd.get(m),this.vUf(I,X)):this.U1j().then(()=>{if(Y){const ta=Y.hEi(m);this.pBa=this.qIi(ta);this.KLd.set(m,this.pBa);this.vUf(I,X)}else X(4)}).catch(()=>{X(2)})})}vUf(z,Y){this.P0a().then(m=>{0===m?z(0):Y(m)}).catch(m=>{Y(m)})}P0a(){return new Promise((z,Y)=>{this.Tq=new gd(this.ug,
this.Zh);if(this.ug.Ivd||this.ug.jmb)this.Tq=new Mj(this.ug,this.Zh);this.pBa.ffg(this.ug.YS,this.Tq).then(m=>{0!==m?z(m):z(this.pBa.Tkb(this.Log()))}).catch(m=>{Y(m)})})}U1j(){return this.ug.Ivd||this.ug.jmb?this.Lqg("alVoiceClient",!0):this.Lqg("PPTSpeechClient")}Lqg(z,Y=!1){return!Y&&this.Sof&&O.AFrameworkApplication.Aa.hb.hjg?(Y=O.AFrameworkApplication.Bj(z,2),Ok.a(this.Sof.iBb(Y))):this.Vw?this.Vw.loadScript(z):new Promise((m,I)=>{I("Unable to load speech client "+z)})}dV(z=!0){0!==this.GI()&&
(this.pBa&&this.pBa.dV(z),this.Tq&&(this.Tq.endActivity(),this.Tq=null))}GI(){return this.pBa?this.pBa.GI():0}Log(){return"zh-CN"!==this.ug.YS&&"ja-JP"!==this.ug.YS}qIi(z){const Y=new Uj(z,this.Log(),O.AFrameworkApplication.Ta,this.YMa,this.ug,this.m2,this.mRb,this.Aba);return this.ug.Ivd||this.ug.jmb?new Xi(this.Aba,this.m2,2,this.Tc,this.wnb,Y,this.ug):new Cm(z,this.ug,this.Aba,Y,this.VBc)}}Object(h.a)(kk,"DictationManager",null,[]);class lo{constructor(){this.Nlf=[];this.v1a=this.bLd=""}startSession(){this.bLd=
ea.a.create().toString();this.Nlf=[]}endSession(){this.bLd=""}get sya(){return this.bLd}get pah(){return this.Nlf}}Object(h.a)(lo,"DictationSessionInfo",null,[477]);class pm{constructor(z,Y,m){this.NNd=this.$Xb=this.KNd=this.ZXb=!1;this.jNa="";this.$a=z?z:O.AFrameworkApplication.fa;this.Q3a=Y;this.Tc=m}get useAutoPunctuation(){if(!this.zL||!this.hje)return!1;if(this.KNd)return this.ZXb;const z=ua.a.instance.getItem("WACDictationFUseAutoPunctuation");this.ZXb=void 0===z||null===z?this.$a.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?
Array.contains(og.hii,this.YS):!1:Boolean.parse(z);this.KNd=!0;return this.ZXb}set useAutoPunctuation(z){this.zL&&this.hje&&(this.ZXb=z,this.KNd=!0,ua.a.instance.setItem("WACDictationFUseAutoPunctuation",this.ZXb.toString()))}get LPb(){if(!this.zL||!this.pne)return!1;if(this.NNd)return this.$Xb;const z=ua.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.$Xb=void 0===z||null===z?!0:Boolean.parse(z);this.NNd=!0;return this.$Xb}set LPb(z){this.zL&&this.pne&&(this.$Xb=z,this.NNd=!0,ua.a.instance.setItem("WACDictationFloatieUseVoiceCommands",
this.$Xb.toString()))}get hje(){return Array.contains(og.iii,this.YS)}get pne(){return this.jmb&&Array.contains(og.XKl,this.YS)}get YS(){""===this.jNa&&(this.jNa=this.S8i());return this.jNa}set YS(z){z&&(this.jNa=z)}get O9b(){return this.zL}get zL(){return this.$a.ka("WacBox4DictationFloatieIsEnabled")}get AIl(){return this.$a.ka("WacBox4DictationInternalArticle")}get lZf(){return this.$a.Ga("DictationFrontdoorDomain")}get Ivd(){return this.$a.ka("WacBox4DictationUseAugloopService")}get Iig(){return this.$a.ka("WacBox4DictationCommandsIsEnabled")&&
this.zL}get jmb(){return this.$a.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get mNj(){return this.$a.ka("WacDictationAuthenticationEnabled")}get uZc(){return this.$a.ka("DictationDebugModeEnabled")}get Adh(){return this.getSupportedLanguages(0)}get zch(){return this.getSupportedLanguages(1)}get nNj(){return fa.a.uAh&&this.$a.ka("UserCanUseDictation")}getSupportedLanguages(z){const Y=[];z=0===z?og.productionLanguages:og.previewLanguages;for(const m of z)Array.add(Y,new ol(m));Y.sort((m,I)=>
m.displayName.localeCompare(I.displayName));return Y}S8i(){if(this.Q3a&&this.Tc){const z=this.Q3a.DTc(this.Tc.Qj);for(const Y of this.Adh)if(Y.LCID===z)return Y.G1c;for(const Y of this.zch)if(Y.LCID===z)return Y.G1c}return og.VKi}}Object(h.a)(pm,"DictationSettings",null,[]);class qm{constructor(){this.Caf=this.Da=null}get name(){return"Box4.Dictation"}Zb(z){this.Da=z;const Y=F.a.instance.rb("Common.IDynamicScriptLoaderProvider");let m=null;Y&&(m=Y.Vw);const I=F.a.instance.ke("Box4.Dictation.IDictationHostFactory");
this.Da.register(pm,"Box4.Dictation.DictationSettings").ma().oa(()=>new pm(this.Da.resolve("Common.IAppSettingsManager"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.ISelectionManager")));const X=F.a.instance.ke("Common.IDictationFloatieController");this.Da.register(Cl,"Box4.Dictation.DictationFloatieManager").ma().oa(()=>new Cl(X,this.Da.resolve("Box4.Dictation.DictationSettings")));this.Da.register(kk,"Box4.Dictation.DictationManager").ma().oa(()=>new kk(m,I,this.Da.resolve("Box4.ISelectionManager"),
z.Ja("Box4.IBusinessBarController"),z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.rb("Box4.DictationCommands.IDictationCommandManager"),this.Da.rb("Box4.DictationCommands.IDictationCommandParser"),this.Da.rb("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Da.resolve("Common.App.OAuth.IOAuthManager"),this.Da.resolve("Common.ISharedDependencyLoader")));this.Da.register(477,
"Box4.Dictation.IDictationSessionInfo").ma().oa(()=>new lo)}init(){this.Da.resolve("Box4.Dictation.IDictationSessionInfo");this.Caf=ck.createInstance(this.Da.ke("Common.IRibbonButtonUpdater"),this.Da.resolve("Box4.Dictation.DictationManager"),this.Da.resolve("Box4.IFormattingEditor"),this.Da.resolve("Box4.IFormattingReader"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.ke("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
id.FocusManager.instance());this.Caf.wb();$f.App.Kb.updateCommandUI()}dispose(){}}Object(h.a)(qm,"DictationPackageManager",null,[2,3]);class rm{constructor(z){this.K=z}hEi(z){return this.K.resolve(z)}}Object(h.a)(rm,"DictationHostFactory",null,[491]);class cm{constructor(z,Y,m){this.UX=null;this.UF=this.AX=-1;this.DCb=!1;this.lJ=z;this.pa=Y;this.ia=m}yae(){return this.I8f(!1)}F8f(){return this.I8f(!0)}vsc(){this.UX&&this.wDa();const z=this.pa.Na.mb;if(z){const Y=z.Ua;if(Y&&Vf.ParagraphReader.ae(Y.node))return this.UX=
Y.node,this.UF=z.Ua.Z5a,this.AX=z.Ua.yYb,this.DCb=!0}return!1}wDa(){this.UX=null;this.DCb=!1;this.AX=this.UF=-1}sxf(z){if(this.UX){const Y=new Qh.GraphTransaction(15);try{Y.kd(this.UX);const m=this.DCb&&this.UF!==this.AX?Ag.a.createTextRange(this.UX,this.UF,this.AX):Ag.a.Mj(this.UX,this.AX);this.lJ.replaceTextRange(m,z);this.AX=this.DCb?this.UF+z.length:this.AX+z.length;const I=nj.SelectionFactory.Sg(this.UX,this.AX);this.pa.setSelection(I);this.DCb=!1;return!0}finally{Y&&Y.dispose()}}return!1}Lfg(z){if(this.UX){const Y=
new Qh.GraphTransaction(15);try{Y.kd(this.UX);const m=this.UF!==this.AX?Ag.a.createTextRange(this.UX,this.UF,this.AX):Ag.a.Mj(this.UX,this.AX);this.lJ.replaceTextRange(m,z);this.AX=this.UF+z.length;const I=nj.SelectionFactory.Sg(this.UX,this.AX);this.pa.setSelection(I);this.DCb=!1;return!0}finally{Y&&Y.dispose()}}return!1}p_g(){var z=this.u9i();this.ia&&z&&z.Z5a!==z.yYb&&0<=z.Z5a&&(z=Ag.a.createTextRange(z.node,z.Z5a,z.yYb),this.ia.La(he.a.jPf,2,z))}u9i(){return this.UX?this.UF!==this.AX?Ag.a.createTextRange(this.UX,
this.UF,this.AX):Ag.a.Mj(this.UX,this.AX):null}I8f(z){var Y=this.pa.Na.mb;if(Y){var m=Y.Ua;if(m&&(Y=m.node,Vf.ParagraphReader.ae(Y)&&(m=z?m.yYb:m.Z5a,Y=Vf.ParagraphReader.text(Y),m<=Y.length)))return z?Y.substring(m,Y.length):Y.substring(0,m)}return""}}Object(h.a)(cm,"DictationHost",null,[475]);class mo{get name(){return"PowerPointWebEditor.Dictation"}Zb(z){z.register(rm,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().oa(()=>new rm(z));z.register(cm,
"PowerPointWebEditor.Dictation.DictationHost").as("Box4.Dictation.IDictationHost").ma().oa(()=>new cm(z.resolve("Box4.ICharacterPropertiesEditor"),z.resolve("Box4.ISelectionManager"),O.AFrameworkApplication.Ta))}init(){}dispose(){}static main(){Ma.a.instance.Dc(new mo)}}Object(h.a)(mo,"PPTWebEditorDictationPackage",null,[2,3]);var In=d(458);class Fl{constructor(z,Y,m=null){this.id=z.Id;m||(m="");this.ISk=m;this.sensitivityLabel=z}}Object(h.a)(Fl,"AutoPolicyLabelData",null,[]);class Qk{constructor(z,
Y){this.Z7=z;this.displayName=Y}}Object(h.a)(Qk,"PolicyLabelRequestState",null,[]);class sm{constructor(){this.IUe=this.eGe=""}}Object(h.a)(sm,"PolicyStrings",null,[]);class Rl{static get Bne(){return Rl.zZj}}Rl.zZj="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(h.a)(Rl,"JustificationDialogHtml",null,[]);class Yf extends $a.a{constructor(z,Y){super(!1,!1,Yf.U1);this.$Na=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.hDc=null;this.gDc=!1;this.WDc=z;this.xD=Y;this.eg=this.gli();this.yd=1;this.ig=Yf.id;this.Xe(1,CommonUIStrings.l_DialogChange);this.jD(1,!1);this.wya(0)}oZe(){if(Yf.U1)this.aj(CommonUIStrings.l_SensitivityJustificationTitle,
Object(v.a)(this,this.bgh,"reactJustificationDialogHandler"),this.p6f(this.gDc));else{const z={};for(let Y=0;Y<this.$Na.length;Y++)z[Yf.xPe+Y]=!1;z[Yf.stc]="";this.aj(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.yZj,"justificationDialogHandler"),z);this.KQe();Qe.a.addHandler($get(Yf.stc),Nb.a.input,Object(v.a)(this,this.ewl,"textAreaHandler"))}}validate(){if(Yf.U1)return this.cKh(this.hDc);const z=$get(Yf.stc);return z.disabled?!0:this.cKh(z.value)}cKh(z){const Y=2>z.length,
m=500<z.length,I=RegExp("[{|}|;|\\\\]").test(z);z=""===ob.a.dRe(z);return!Y&&!m&&!I&&!z}yZj(z,Y){let m="";if(1===z)for(let I=0;I<this.$Na.length;I++)if(Y[Yf.xPe+I]){m=I===this.$Na.length-1?Y[Yf.stc]:this.$Na[I];break}this.xD(z,this.WDc,m)}bgh(z){let Y="";1===z&&this.hDc&&(Y=this.hDc);this.xD(z,this.WDc,Y)}Yvk(z){this.hDc=z;z=this.validate();this.gDc!==z&&(this.gDc=z,this.K6(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.bgh,"reactJustificationDialogHandler"),this.p6f(this.gDc)))}p6f(z){return{["id"]:this.ig,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!z},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(v.a)(this,this.Yvk,"onJustificationUpdated")}}ewl(z){z.target&&this.jD(1,this.validate())}gli(){return $a.a.VA(Yf.Bne,O.AFrameworkApplication.qm,wd.getImageClass(Yf.LEa),CommonUIStrings.l_SensitivityJustificationMessage,this.$Na[0],this.$Na[1],this.$Na[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}KQe(){const z=document.getElementsByName(Yf.S0j);for(let Y=0;Y<z.length;Y++)Qe.a.addHandler(z[Y],Nb.a.focus,Object(v.a)(this,this.Ekd,"radioButtonFocusHandler")),
Qe.a.addHandler(z[Y],Nb.a.click,Object(v.a)(this,this.Ekd,"radioButtonFocusHandler"))}Ekd(z){if(z=z.target){z.checked=!0;var Y=$get(Yf.stc);z.id===Yf.xPe+(this.$Na.length-1)?(Y.disabled=!1,Sys.UI.DomElement.setVisible(Y,!0),Y.focus()):(Y.disabled=!0,z.focus());this.jD(1,this.validate())}}static get U1(){return O.AFrameworkApplication.Aa.hb.IC&&O.AFrameworkApplication.Aa.hb.Sle}}Yf.Bne=Rl.Bne;Yf.S0j="ListRadioBox";Yf.xPe="radiobox";Yf.stc="txtJustification";Yf.LEa="Info_32x32x32";Yf.id="JustificationDialog";
Object(h.a)(Yf,"JustificationDialog",$a.a,[]);class Jn extends $a.a{constructor(z,Y,m){super(!1,!1,!0);if(z&&m){var I={["id"]:"MandatoryLabellingDialog"};this.fRh=m;this.WFd=Y;if(!O.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.WFd&&""!==this.WFd)I.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.WFd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
Y={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(Y.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:z});I.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:Y};z={["id"]:"MandatoryLabellingDialog",["bodyControls"]:I};I.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;I.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.aj(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(v.a)(this,this.hlk,"mandatoryLabellingDialogHandler"),z)}else e.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}hlk(z,Y){1===z&&Y.selectedLabel&&(z=Y.selectedLabel,""!==z&&this.fRh(z))}}Object(h.a)(Jn,"MandatoryLabellingDialog",$a.a,[]);class Ak{constructor(){this.nqa=!!O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.IC}QFi(z,Y,m){this.nqa&&new Jn(z,Y,m)}static get instance(){return Ak.Ka||
(Ak.Ka=new Ak)}}Ak.Ka=null;Object(h.a)(Ak,"MandatoryLabellingDialogFactory",null,[523]);class Ye{}Ye.msl="sbProtectForm14";Ye.psl="SBStatusBarMarkAsReadOnly14";Ye.d0j="Info_16x16x32";Ye.jFf="QuickSearchCompletedToday_16x16x32";Ye.UPe="CommonControlCheckboxCheck_16";Ye.iDh="On";Ye.visible="Visible";Ye.n0i="ImageIsVisible";Ye.aV="SourceControlId";Ye.menuItemId="MenuItemId";Ye.menu="Menu";Ye.Ywf="AppLockId";Ye.value="Value";Ye.labelText="LabelText";Ye.alt="Alt";Ye.Ydg="Image16by16";Ye.yyb="Image16by16Class";
Ye.lsl="SBProtectForm_16";Ye.osl="SBStatusBarMarkAsReadOnly_16";Ye.icon="Icon";Ye.iconColor="IconColor";Ye.customTooltip="CustomTooltip";Ye.jSk="MipTagDynamicFillWithOutline_20";Ye.kSk="MipTagLockDynamicFillWithOutline_20";Ye.iSk="MipTagErrorOutline_20";Ye.lSk="MipTagQuestionOutline_20";Ye.l3e="transparent";Ye.qCl="UILocation";Object(h.a)(Ye,"PolicyConstants",null,[]);class cl extends $a.a{constructor(z,Y,m){super(!1,!1,cl.U1);this.WDc=z;this.D2=Y;this.xD=m;this.yd=1;this.ig=cl.id;this.wya(1);this.wya(0)}QZe(){const z=
{["id"]:"UserDefinedPermissionsDialog"};cl.U1&&this.aj("Defined Permissions",Object(v.a)(this,this.ZIl,"userDefinedPermissionsDialogHandler"),z)}ZIl(z){1!==z&&this.xD(z,this.WDc,"",this.D2)}static get U1(){return O.AFrameworkApplication.Aa.hb.IC&&O.AFrameworkApplication.Aa.hb.Sle}}cl.id="UserDefinedPermissionsDialog";Object(h.a)(cl,"UserDefinedPermissionsDialog",$a.a,[]);var ip=d(587),pl=d(193),Ej=d(471);class ai{constructor(z,Y,m,I){this.rFd=this.oUb=null;this.Sff=this.GEd=this.fFd=this.YTb=this.ihf=
this.Rif=this.dAd=!1;this.Dnb=this.iAa=this.$Aa=this.SMa=this.D2=this.kv=this.$ha=this.Fh=null;this.rQh=this.hyd=0;this.DBd=this.Qgf=this.$8e=this.TId=null;this.Ca=z;this.Sh=Y;this.$a=m;this.ak=I;this.YUb={};this.Rlf={};this.Tif={};this.y9b=m.ka("WacApplyManualPolicyLabelIsEnabled");this.ak.value.oQd(Object(v.a)(this,this.YMe,"processAutoSensitivityLabel"));this.ak.value.Gvf(Object(v.a)(this,this.YMe,"processAutoSensitivityLabel"));this.ak.value.SPd(Object(v.a)(this,this.wAk,"onUpdateLabelInfo"));
O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.RK(Object(v.a)(this,this.vUk,"refreshDocumentPolicyLabelsOnModeChange"));m.ka("SupportsPolicies")&&m.Ga("AppliedPolicyId")&&(this.oUb=m.Ga("IrmPolicyTitle"),this.rFd=m.Ga("IrmPolicyDescription"));this.pJd=m.ka("ProtectedFile");this.IOh=this.$a.Bc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.JOh=this.$a.Bc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get vua(){return O.AFrameworkApplication.vua||!!this.Qgf&&this.Qgf()}wb(){this.Ca.ya(na.a.MJe,
jc.a.frame,Object(v.a)(this,this.lOc,"documentLabelPaneHandler"));this.Ca.ra(na.a.tJb,jc.a.frame,Object(v.a)(this,this.tJb,"queryPolicyLabel"),96);Qd.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel")&&(this.Ca.ya(na.a.w8g,jc.a.frame,Object(v.a)(this,this.lOc,"documentLabelPaneHandler")),this.Ca.ra(na.a.znc,jc.a.frame,Object(v.a)(this,this.znc,"queryPolicyShortLabel"),96));this.Ca.ya(na.a.Hlb,jc.a.frame,Object(v.a)(this,this.Hlb,"toggleSensitivity"));
this.Ca.ya(na.a.Hhb,jc.a.frame,Object(v.a)(this,this.Hhb,"populateSensitivityFlyout"));this.Ca.ya(na.a.dkb,jc.a.frame,Object(v.a)(this,this.dkb,"setSensitivity"));this.Ca.ra(na.a.Enc,jc.a.frame,Object(v.a)(this,this.Enc,"querySensitivity"),96);this.Ca.ya(na.a.oib,jc.a.frame,Object(v.a)(this,this.oib,"querySensitivityToggleButton"));this.Ca.ya(na.a.nib,jc.a.frame,Object(v.a)(this,this.nib,"querySensitivitySubFlyout"));this.uYb(na.a.Hlb)||this.Ca.le(na.a.Hlb,4);this.uYb(na.a.Hhb)||this.Ca.le(na.a.Hhb,
4);this.uYb(na.a.dkb)||this.Ca.le(na.a.dkb,4);this.uYb(na.a.oib)||this.Ca.le(na.a.oib,4);this.uYb(na.a.nib)||this.Ca.le(na.a.nib,4);this.Sh.updateCommandUI();O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Qd.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.ak.value.PZk(Object(v.a)(this,this.phh,"registerActionsHandler"))}phh(){this.wb()}CGh(){this.Ca.RJ(na.a.MJe,
jc.a.frame,Object(v.a)(this,this.lOc,"documentLabelPaneHandler"));this.Ca.RJ(na.a.tJb,jc.a.frame,Object(v.a)(this,this.tJb,"queryPolicyLabel"));Qd.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel")&&(this.Ca.RJ(na.a.w8g,jc.a.frame,Object(v.a)(this,this.lOc,"documentLabelPaneHandler")),this.Ca.RJ(na.a.znc,jc.a.frame,Object(v.a)(this,this.znc,"queryPolicyShortLabel")));this.Ca.RJ(na.a.Hlb,jc.a.frame,Object(v.a)(this,this.Hlb,"toggleSensitivity"));
this.Ca.RJ(na.a.Hhb,jc.a.frame,Object(v.a)(this,this.Hhb,"populateSensitivityFlyout"));this.Ca.RJ(na.a.dkb,jc.a.frame,Object(v.a)(this,this.dkb,"setSensitivity"));this.Ca.RJ(na.a.Enc,jc.a.frame,Object(v.a)(this,this.Enc,"querySensitivity"));this.Ca.RJ(na.a.oib,jc.a.frame,Object(v.a)(this,this.oib,"querySensitivityToggleButton"));this.Ca.RJ(na.a.nib,jc.a.frame,Object(v.a)(this,this.nib,"querySensitivitySubFlyout"))}Hlb(){return 32}u_f(z){const Y="mandatoryLabelling_"+z.Id;this.Tif[Y]=z.Id;return{["type"]:"AppToggleButtonProps",
["id"]:Y,["label"]:z.DisplayName,["hideLabel"]:!1,["customTooltip"]:z.Tooltip}}Cbb(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}Kdj(){const z=[],Y=this.$ha;for(let I in Y){var m=Y[I];const X=this.kv[I];if(X&&X.Enabled&&!X.HasUserDefinedPermissions)if(m.count){const ta={["sections"]:[],["shouldAutoOpen"]:!1},Fa={["id"]:"mandatoryLabelling_flyoutMenuSection_"+X.Id,["controls"]:[]};for(let bb of m)(m=this.kv[bb])&&m.Enabled&&!m.HasUserDefinedPermissions&&Array.add(Fa.controls,
this.u_f(m));Array.add(ta.sections,Fa);Array.add(z,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+X.Id,["label"]:X.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:ta})}else Array.add(z,this.u_f(X))}return z}Hhb(z,Y,m,I,X){if(1===m||!this.ak.value.dsb(!0))return 32;X.MenuItems=Object.assign(new Le.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(X.MenuItems.MenuSectionList,this.jMc(!this.isReactRibbonEnabled()));this.Fh.CustomUrl&&
Array.add(X.MenuItems.MenuSectionList,this.vFi(this.isReactRibbonEnabled()?this.Fh.CustomUrl:ob.a.ue(this.Fh.CustomUrl)));this.isReactRibbonEnabled()||(X.PopulationXML=dh.l(X.MenuItems));return 32}Enc(z,Y,m,I,X){if(1===m||!X||!this.y9b)return 32;this.Fh=this.ak.value.wu;if(this.ak.value.dsb(!0)&&(X[Ye.visible]=!0,this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.ihf||(Be.a("MipLabelsAvailable"),this.ihf=!0):Be.a("MipLabelsAvailable"),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",
!1)&&this.Fh&&this.Fh.AreLabelsAvailable&&(z=F.a.instance.Ja("Common.ISystemInitiatedFeedback")))){const ta=ai.Wa(this.Fh.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";z.execute(Fa=>{Fa.logActivity(ta,null)})}return 32}oib(z,Y,m,I,X){if(1===m||!X)return 32;let ta,Fa;X[Ye.iDh]=!!(ta=X[Ye.menuItemId])&&!!(Fa=this.YUb[ta])&&Fa===this.Fh.AppliedPolicyId;return 32}nib(z,Y,m,I,X){if(1===m||!X)return 32;let ta,Fa,bb;z=!!(ta=X[Ye.aV])&&!!(Fa=this.YUb[ta])&&
!!(bb=this.$ha[Fa])&&bb.contains(this.Fh.AppliedPolicyId);X[Ye.n0i]=z;X[Ye.iDh]=z;return 32}dkb(z,Y,m,I,X){if(1===m||!X)return 32;z=this.YUb[X[Ye.aV]];Y=this.rCl(X[Ye.qCl]);m=new cf.a;m.name="SensitivityPickerLocation";m.int64=Y;Be.a("SensitivityPickerUsage",void 0,void 0,[m]);return this.fLa(z,X,2)}xZc(){return!!O.AFrameworkApplication.Aa&&1===O.AFrameworkApplication.Aa.mode}vUk(){this.GEd&&!this.xZc()&&(this.GEd=!1,this.ak.value.uUk())}lzl(){this.Fh.DefaultLabelId&&this.Fh.MandatoryLabelingEnforced?
this.dAd||this.xZc()?this.Fh.AppliedPolicyId?this.z2d(""):(this.ak.value.FUj(this.ak.value.jbc)||this.xZc())&&this.HSf():this.Mqh():this.Fh.DefaultLabelId?this.Mqh():this.Fh.MandatoryLabelingEnforced&&(this.Fh.AppliedPolicyId?this.z2d(""):this.HSf())}Qkg(){return this.Fh.MandatoryLabelingEnforced?this.Fh&&this.Fh.AreLabelsAvailable?this.$a.ka("TestOverrideIsReactDialogEnabled")||this.Sh&&this.Sh.hb&&this.Sh.hb.IC?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),
!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(e.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}HSf(){!this.Qkg()||O.AFrameworkApplication.JQ||this.Rif||(this.Rif=O.AFrameworkApplication.JQ=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.ak.value.afh("",1),this.ak.value.nPd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,
CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.flk()}))}z2d(z){this.Qkg()&&O.AFrameworkApplication.JQ&&(O.AFrameworkApplication.JQ=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.ak.value.mRe(),this.ak.value.afh(z,2))}flk(){Ak.instance.QFi(this.Kdj(),this.Fh.CustomUrl,Object(v.a)(this,this.glk,"mandatoryLabellingDialogCallback"))}glk(z){this.z2d(this.Tif[z])}Rzf(){return this.$a.ka("CoAuthForProtectedFilesEnabled")&&
this.$a.ka("SupportsOfficeClientCoauthoring")&&this.$a.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.DBd&&this.vua}fLa(z,Y,m,I=null){this.ak.value.IQk(m);let X=32,ta=!1,Fa=!0;const bb=2===m||8===m||16===m,yb=z===this.Fh.AppliedPolicyId;if(this.$8e&&this.$8e(z,bb))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",m),this.Sh.updateCommandUI();else if(Y&&Ye.Ywf in Y&&this.ak.value.sWe(Y[Ye.Ywf]),
z)if(this.ak.value.fng()||this.Rzf()&&this.fFd)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",m),this.Sh.updateCommandUI(),bb&&this.yHc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.$a.ka("HasDocumentEditRights"))if(this.ak.value.Aqi(z))if(!this.Cbb()&&this.kv[z]&&this.kv[z].HasUserDefinedPermissions&&!yb)e.ULS.sendTraceTag(540608323,
306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",m),1!==m&&4!==m&&this.fei();else if(bb&&this.Fh.MandatoryLabelingEnforced&&yb)e.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",m),this.yHc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(bb&&this.$a.ka("WacLabelingJustificationDialogIsEnabled")&&this.Fh.RequiredDowngradeJustification&&
(yb||this.kv[z].RequiredDowngradeJustification)&&(this.Cbb()?!this.Sff&&!I:!this.D2))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",m),this.oZe(z),X;if(this.Cbb()&&this.kv[z].HasUserDefinedPermissions&&!yb)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",m),this.QZe(z,I),X;if(this.Rzf()&&!this.DBd())this.hyd<this.IOh?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",
this.hyd,m),this.fFd=!0,this.hyd++,xf.Task.delay(this.JOh).continueWith(()=>{this.fFd=!1;this.fLa(z,Y,m)})):(e.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",m),ta=1!==m,Fa=!1,X=8);else{if(this.SSj(z)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",m),1===m||8===m||4===m))return X;e.ULS.sendTraceTag(570972056,306,
50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",m);this.setPolicyLabel(yb?"":z,this.Cbb()?I:this.D2,"",m);return X}}else e.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",m),this.Sh.updateCommandUI(),bb&&this.yHc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",
m),this.Sh.updateCommandUI(),bb&&this.yHc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",m),this.Sh.updateCommandUI(),ta=bb,Fa=!1,X=8;this.ak.value.yfh(0,m,ta,Fa);return X}$xf(z,Y,m=null,I=!1){A.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.$a.ka("SupportsOfficeClientCoauthoring")&&
this.$a.ka("CoAuthForProtectedFilesIsEnabled")?(this.YTb=!1,(this.Fh=this.ak.value.wu)&&!this.Fh.AppliedPolicyId?this.YTb=!0:this.Fh&&this.Fh.PolicyLabelAssignmentMethod&&(this.YTb=pl.e(this.Fh.PolicyLabelAssignmentMethod)===pl.e("standard"))):this.YTb=I;z=ai.Wa(z)?null:this.kv[z];(Y=ai.Wa(Y)?null:this.kv[Y])?this.$Aa=new Fl(Y,!0,m):(this.ak.value.Wxa(29),this.iAa=null);z?this.SMa=new Fl(z,!1):this.Dnb=null;this.YMe(null,null)}Lfi(z){this.fLa(z,null,16)}mcl(){this.kv={};if(this.Fh=this.ak.value.wu)for(const z of this.Fh.SensitivityLabels)this.kv[z.Id]=
z}SSj(z){if(this.$ha&&z in this.$ha){z=this.$ha[z];for(let Y of z)if((z=this.kv[Y])&&z.Enabled)return!0}return!1}Jdl(){this.$ha={};if(this.Fh=this.ak.value.wu){for(const z of this.Fh.SensitivityLabels)z.ParentId||(this.$ha[z.Id]=new za.a);for(const z of this.Fh.SensitivityLabels){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemoveDisabledLabelsFromChildLabel",!1)){if(!(z.ParentId&&z.ParentId in this.$ha&&z.Enabled))continue}else if(!(z.ParentId&&z.ParentId in this.$ha))continue;
this.$ha[z.ParentId].add(z.Id)}}}TNk(){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.Fh=this.ak.value.wu;const z=this.y9b&&this.isReactRibbonEnabled()&&this.ak.value.dsb();ai.ajb(z)}else this.y9b&&this.isReactRibbonEnabled()?(this.Fh=this.ak.value.wu,this.ak.value.dsb()?(ai.ajb(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))):ai.ajb(!1)):ai.ajb(!1)}zVk(z){this.DBd=z}Mqh(){if(this.$a.ka("WacApplyDefaultPolicyLabelIsEnabled"))if(this.xZc())this.GEd=
!0;else if(!this.dAd)if(this.dAd=!0,this.Fh=this.ak.value.wu,this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.Fh&&this.Fh.DefaultLabelId)if(!this.Fh.AppliedPolicyId)e.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Fh.DefaultLabelType),this.fLa(this.Fh.DefaultLabelId,null,1);else if(n.a.Hn().equals(this.Fh.DefaultLabelType,"documentLibraryDefault")){const z=this.kv[this.Fh.AppliedPolicyId],Y=this.kv[this.Fh.DefaultLabelId];
this.Fh.AppliedPolicyId!==this.Fh.DefaultLabelId&&n.a.Hn().equals(this.Fh.PolicyLabelAssignmentMethod,"standard")&&z.Order<Y.Order&&(e.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Fh.DefaultLabelType),this.fLa(this.Fh.DefaultLabelId,null,1))}}else this.Fh&&this.Fh.DefaultLabelId&&!this.Fh.AppliedPolicyId&&(e.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.Fh.DefaultLabelId),this.fLa(this.Fh.DefaultLabelId,null,1))}YMe(){if(!this.ak.value.fng()){var z=
this.kv[this.Fh.AppliedPolicyId];this.YTb&&this.SMa&&this.Dnb!==this.SMa.id&&(!z||z.Order<this.SMa.sensitivityLabel.Order)&&(z=this.fLa(this.SMa.id,{},4),32!==z?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+z):(this.Dnb=this.SMa.id,this.iAa&&(z=this.kv[this.iAa])&&z.Order<=this.SMa.sensitivityLabel.Order&&(this.ak.value.Wxa(29),this.iAa=null)));z=this.kv[this.ak.value.wu.AppliedPolicyId];if(this.$Aa&&this.iAa!==this.$Aa.id&&(!z||
z.Order<this.$Aa.sensitivityLabel.Order)){const Y=this.$Aa.id;this.ak.value.Wxa(29);this.ak.value.nGc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.K9d(this.$Aa.sensitivityLabel))+" "+this.$Aa.ISk,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.fLa(Y,{},8)});this.iAa=this.$Aa.id}this.$Aa=this.SMa=null}}setPolicyLabel(z,Y,m,I=2){this.Cbb()?Y&&(this.Sff=!0):this.D2=Y;this.ak.value.setPolicyLabel(z);this.Sh.updateCommandUI();
m=new Qk(I,this.K9d(this.kv[z]));this.ak.value.EWe(z,this.Cbb()?Y:this.D2,m)}jBi(z,Y,m,I){1===z&&this.setPolicyLabel(Y,I,m)}iBi(z,Y,m){1===z?this.Cbb()?this.fLa(Y,null,2,m):this.setPolicyLabel(Y===this.Fh.AppliedPolicyId?"":Y,m,""):this.Sh.updateCommandUI()}oZe(z){(new Yf(z,Object(v.a)(this,this.iBi,"continueToSetPolicyLabelFromJustificationDialog"))).oZe()}QZe(z,Y){(new cl(z,Y,Object(v.a)(this,this.jBi,"continueToSetPolicyLabelFromUDPDialog"))).QZe()}yHc(z="",Y=""){const m=new mb.StandardDialog;
m.Ar=O.AFrameworkApplication.Kda;m.yd=0;m.Xe(1,CommonUIStrings.l_DialogClose);m.fP(z,Y,null)}Bji(z){1===z&&this.ak.value.qRk()}fei(){const z=new mb.StandardDialog;z.Ar=O.AFrameworkApplication.Kda;z.yd=1;z.Xe(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);z.Xe(0,CommonUIStrings.l_DialogClose);z.fP(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(v.a)(this,this.Bji,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Sh&&
!!this.Sh.hb&&this.Sh.hb.Po}cAb(){return this.Sh&&this.Sh.hb?this.Sh.hb.cAb:!1}lOc(){return 32}tJb(z,Y,m,I,X){if(1===m)return 32;this.Fh=this.ak.value.wu;if(!this.Fh||!X)return 32;X[Ye.value]="";X[Ye.labelText]="";X[Ye.alt]=null;X[Ye.Ydg]=null;X[Ye.yyb]=null;X[Ye.customTooltip]="";X[Ye.visible]=!1;X[Ye.iconColor]="";m=Y=z=X[Ye.icon]="";if(!this.Fh.AreLabelsAvailable){if(!this.oUb)return 32;z=this.oUb;m=Ye.l3e;this.rFd&&(Y=this.rFd)}else if(this.Fh.AppliedPolicyId){I=null;if(Qd.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel"))this.kv&&(I=this.kv[this.Fh.AppliedPolicyId]);else for(const ta of this.Fh.SensitivityLabels)if(ta.Id.toLowerCase()===this.Fh.AppliedPolicyId.toLowerCase()){I=ta;break}I&&(z=this.K9d(I),Y=I.Tooltip,this.pJd=O.AFrameworkApplication.iG=I.IsEndpointProtectionEnabled,m=this.J0f(I))}this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(z?(X[Ye.value]=z,X[Ye.labelText]=z,X[Ye.customTooltip]=
Y,this.rrh(m,this.pJd,X)):(X[Ye.iconColor]=Ye.l3e,this.Fh.MandatoryLabelingEnforced?(X[Ye.value]=X[Ye.labelText]=this.lUc().IUe,X[Ye.icon]=Ye.iSk):(X[Ye.value]=X[Ye.labelText]=this.lUc().eGe,X[Ye.icon]=Ye.lSk)),X[Ye.visible]=!0):z&&(X[Ye.value]=z,X[Ye.labelText]=z,this.cAb()?X[Ye.customTooltip]=Y:X[Ye.alt]=Y,this.rrh(m,this.pJd,X),X[Ye.visible]=!0);return 32}znc(z,Y,m,I,X){if(1===m)return 32;this.Fh=this.ak.value.wu;if(!this.Fh||!X)return 32;X[Ye.labelText]="";if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",
!1)&&this.Fh.HideBarByDefault)return 32;z="";if(this.Fh.AreLabelsAvailable)if(this.Fh.AppliedPolicyId){if(!this.kv)return 32;(Y=this.kv[this.ak.value.wu.AppliedPolicyId])&&(z=Y.ParentId&&this.kv[Y.ParentId]?this.kv[Y.ParentId].DisplayName:Y.DisplayName)}else z=this.Fh.MandatoryLabelingEnforced?this.lUc().IUe:this.lUc().eGe;else{if(!this.oUb)return 32;z=this.oUb}X[Ye.labelText]=z;return 32}K9d(z){return z?this.kv?z.ParentId&&this.kv[z.ParentId]?this.kv[z.ParentId].DisplayName+"\\"+z.DisplayName:z.DisplayName:
(e.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),z.DisplayName):""}rrh(z,Y,m){this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(m[Ye.icon]=this.y8f(Y),m[Ye.iconColor]=this.z8f(z)):this.cAb()?m[Ye.icon]=Y?Ye.lsl:Ye.osl:(m[Ye.Ydg]=O.AFrameworkApplication.qm,m[Ye.yyb]=Y?wd.getImageClass(Ye.msl):wd.getImageClass(Ye.psl))}vFi(z){const Y=this.Rt("LearnMoreSection",!0);z=Object.assign(new Rj.a,{Id:"SensitivityLearnMore",
ExternalId:"SensitivityLearnMore",MenuItemId:z,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:O.AFrameworkApplication.qm,Image16by16Class:wd.getImageClass(Ye.d0j),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(Y.ControlList,z);return Y}iMf(z,Y,m=!1){let I;I="Toggle_"+z.Id;I="Sensitivity_"+I;const X=z.DisplayName,ta=z.Tooltip;var Fa=z.Id===this.Fh.AppliedPolicyId,bb=m?ob.a.ue(I):I;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)?(Fa=this.J0f(z),Y=Object.assign(new La.a,{Id:bb,ExternalId:bb,LabelText:m?ob.a.ue(X):X,Command:"2935633379",MenuItemId:bb,QueryCommand:"991261903",Visible:!0,Alt:m?ob.a.ue(ta):ta,AriaLabel:Vb.a.esb,IconColor:this.z8f(Fa),KeyTip:Y}),Y.ExternalImageId=this.y8f(z.IsEndpointProtectionEnabled)):(bb=Object.assign(new ip.a,{Id:bb,ExternalId:bb,LabelText:m?ob.a.ue(X):X,Command:"2935633379",MenuItemId:bb,QueryCommand:"991261903",CheckedImage:O.AFrameworkApplication.qm,Visible:!0,Alt:m?ob.a.ue(ta):ta,IsChecked:Fa,
AriaLabel:Vb.a.esb,KeyTip:Y}),this.isReactRibbonEnabled()?(bb.CheckedImageClass=wd.getImageClass(Ye.UPe),bb.ExternalImageId=Ye.UPe):bb.CheckedImageClass=wd.getImageClass(Ye.jFf),Y=bb);bb=I;this.YUb[bb]=z.Id;this.Rlf[z.Id]=bb;return Y}Rt(z,Y=!1){return Object.assign(new xi.a,{Title:"",Id:z,DisplayMode:Ye.menu,ShowMenuSectionSeparator:Y,ControlsId:"Ctrl_"+z,ControlList:[]})}wIi(z,Y,m,I){z=ai.akh()?this.Rt(z+"Sub"):this.Rt(Y+"Sub");Y=1;for(let X of m)(m=this.kv[X])&&m.Enabled&&(Array.add(z.ControlList,
this.iMf(m,Y.toString(),I)),Y++);return z}jMc(z=!1){const Y=this.Rt("SensitivitySection");let m=1;const I=this.$ha;for(let ta in I){const Fa=I[ta],bb=this.kv[ta];if(bb&&bb.Enabled){if(Fa.count){const yb="Sensitivity_"+bb.Name;var X=z?ob.a.ue(yb):yb;X=ai.akh()?"Label"+this.rQh++:X;const Bb=Object.assign(new Ri.a,{Id:X,ExternalId:X,LabelText:z?ob.a.ue(bb.DisplayName):bb.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new Le.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),
ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Vb.a.esb,KeyTip:m.toString(),Alt:z?ob.a.ue(bb.Tooltip):bb.Tooltip});this.isReactRibbonEnabled()?Bb.ExternalImageId=Ye.UPe:(Bb.Image16by16=O.AFrameworkApplication.qm,Bb.Image16by16Class=wd.getImageClass(Ye.jFf));Array.add(Bb.Menu.MenuSectionList,this.wIi(X,yb,Fa,z));Array.add(Y.ControlList,Bb);this.YUb[Bb.Id]=bb.Id;this.Rlf[bb.Id]=Bb.Id}else Array.add(Y.ControlList,this.iMf(bb,m.toString(),z));m++}}return Y}uYb(z){return!!this.Ca.hT(z)&&
!!this.Ca.hT(z).flags&&!!this.Ca.hT(z).flags.length}wAk(z,Y){Y.onSuccess&&this.kv&&(z=this.kv[this.ak.value.wu.AppliedPolicyId])&&(this.iAa&&(Y=this.kv[this.iAa])&&Y.Order<=z.Order&&(this.ak.value.Wxa(29),this.iAa=null),this.Dnb&&this.Dnb!==z.Id&&(this.ak.value.Wxa(28),this.Dnb=null))}y8f(z){return z?Ye.kSk:Ye.jSk}z8f(z){return z?z:Ye.l3e}J0f(z){if(z.Color||!z.ParentId)return z.Color;const Y=this.kv[z.ParentId];return Y?Y.Color:z.Color}rCl(z){switch(z){case 2:case 14:case 15:return 1;case 21:return 2;
default:return 0}}lUc(){this.TId||(this.TId=Object.assign(new sm,{eGe:HeaderStrings.NoSensitivityLabel,IUe:HeaderStrings.SelectASensitivityLabel}));return this.TId}static akh(){if(null!=ai.tDc)return ai.tDc;O.AFrameworkApplication.dGa("ce2ai523-t;6f627846-c");ai.tDc=O.AFrameworkApplication.fa?O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RenameCLPControlIds",!1):!1;return ai.tDc}static ajb(z){O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)||(z?(Ej.a.daa("ribbon","sensitivity"),Ej.a.baa("ribbon","sensitivity")):Ej.a.caa("ribbon","sensitivity"));O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Qd.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!z))}static Wa(z){return z&&z.length?!1:!0}}ai.tDc=null;Object(h.a)(ai,"PolicyActor",null,[506]);var tk=d(1207),no;(function(z){z[z.unknown=0]="unknown";z[z.boot=
1]="boot";z[z.refresh=2]="refresh";z[z.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(no||(no={}));Object(h.b)("GetPolicyLabelsReason",no);class oo extends Sys.EventArgs{constructor(z,Y,m,I,X,ta){super();this.Lsb=z;this.title=Y;this.message=m;this.buttonText=I;this.l_b=X;this.h0c=ta}}Object(h.a)(oo,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Ji extends Sys.EventArgs{constructor(z,Y,m,I,X){super();this.Lsb=z;this.title=Y;this.message=m;this.buttonText=I;this.l_b=X}}Object(h.a)(Ji,
"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var uk;(function(z){z[z.none=0]="none";z[z.reasonDefaultLabel=1]="reasonDefaultLabel";z[z.reasonManual=2]="reasonManual";z[z.reasonAutomatic=4]="reasonAutomatic";z[z.reasonRecommended=8]="reasonRecommended";z[z.reasonMandatory=16]="reasonMandatory"})(uk||(uk={}));Object(h.b)("ApplyLabelFlags",uk);class Ko extends Sys.EventArgs{constructor(z,Y,m){super();this.aHf=z;this.$Gf=Y;this.existingLabelPriority=m}}Object(h.a)(Ko,"AutoCLPSecurityNodesEventArgs",
Sys.EventArgs,[]);class Gl extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Gl,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class Ci extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Ci,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class dk{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=
this.DefaultLabelId=null;this.AreLabelsAvailable=this.HideBarByDefault=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl="";this.HideBarByDefault=!1}}Object(h.a)(dk,"GetPolicyLabelsData",null,[]);class Rk extends Sys.EventArgs{constructor(z=!1){super();this.onSuccess=z}}Object(h.a)(Rk,"LabelInfoUpdateEventArgs",
Sys.EventArgs,[]);class Lo extends Sys.EventArgs{constructor(z,Y){super();this.zYg=z;this.eRd=Y}}Object(h.a)(Lo,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class Kn extends Sys.EventArgs{constructor(z,Y,m,I){super();this.title=z;this.KGk=Y;this.buttonText=m;this.Lsk=I}}Object(h.a)(Kn,"PolicyTipEventArgs",Sys.EventArgs,[]);class sn extends Sys.EventArgs{constructor(z,Y){super();this.Lsb=z;this.h0c=Y}}Object(h.a)(sn,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class tn extends Sys.EventArgs{constructor(){super()}}
Object(h.a)(tn,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class po extends Sys.EventArgs{constructor(z,Y){super();this.Pah=z;this.Z7=Y}}Object(h.a)(po,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class ve extends Sys.EventArgs{constructor(z,Y,m,I=null,X=null,ta=null,Fa=null){super();this.errorType=z;this.lnl=m;this.title=I;this.message=X;this.buttonText=ta;this.l_b=Fa}}Object(h.a)(ve,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class un extends Sys.EventArgs{constructor(){super()}}
Object(h.a)(un,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class Mo extends Sys.EventArgs{constructor(z){super();this.Njl=z}}Object(h.a)(Mo,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var dm=d(694),Hl=d(453);class Om{static Dbl(z,Y){if(!z||!Y||z.count!==Y.count)return!1;for(let m of z)if(!Y.contains(m))return!1;return!0}static toArray(z){if(!z)return null;const Y=Array(z.count);let m=0;for(let I of z)Y[m]=I,m++;return Y}}Object(h.a)(Om,"HashSetUtils",null,[]);var Bh=d(783);class Rg{constructor(z,
Y,m,I=0,X=null){this.$zd=this.ubf=null;this.dPa=this.ZSb=this.$Sb=0;this.$ga="";this.a5a=this.hhf=this.Yxd=this.JDd=this.Uza=this.kGd=null;this.Uff=!1;this.l2a=null;this.QCd=0;this.NCc=this.d5a=this.k3a=this.MCc=null;this.Pa=new hi.a;this.Aqc=this.i6b=this.xS=null;this.EDd=!1;this.jbc=null;this.$a=z;this.Yh=Y;this.Zh=m;this.pBc=I;this.wu=new dk;this.Qlf=this.$a.Ga("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.tG=X;this.y9b=z.ka("WacApplyManualPolicyLabelIsEnabled");this.H9b=z.ka("CoAuthForProtectedFilesIsEnabled");
this.elb=z.ka("SupportsOfficeClientCoauthoring");this.EVj=!1;this.Rdl=3E4;this.$d=We.a.instance;z.ka("SupportsPolicies")&&Be.a("MipSupportsPolicies");this.H9b&&this.elb&&Be.a("MipSupportsOfficeClientCoauthoring")}get gje(){return this.EDd}mbi(z){this.Pa.addHandler("PolicyTipEvent",z)}SPd(z){this.Pa.addHandler("LabelInfoUpdateEvent",z)}PZk(z){this.Pa.removeHandler("LabelInfoUpdateEvent",z)}oQd(z){this.Pa.addHandler("SetPolicyLabelEventKey",z)}Sjh(z){this.Pa.removeHandler("SetPolicyLabelEventKey",z)}Gvf(z){this.Pa.addHandler("SetPolicyLabelFailureEventKey",
z)}m$h(z){this.Pa.addHandler("GetAutoPolicyLabelEventKey",z);this.gje&&(e.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.FPe(new Gl(0)))}X9h(z){this.Pa.addHandler("CreateAutoCLPSecurityNodesEventKey",z)}zci(z){this.Pa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",z)}Aci(z){this.Pa.addHandler("UpdateAutoCLPSITNodesEventKey",z)}B9h(z){this.Pa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",z)}Abi(z){this.Pa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",
z)}C9h(z){this.Pa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",z)}Bbi(z){this.Pa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}G$h(z){this.Pa.addHandler("MandatoryLabellingAppHandlerEventKey",z)}xci(z){this.Pa.addHandler("UDPLabelingAppHandlerEventKey",z)}get eOj(){if(!this.ubf)return!1;for(const z of this.ubf.V5d())if(!z.Capabilities||!z.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get Jmg(){return!!this.xS}KEj(z){z&&this.H9b&&this.elb&&z.execute(Object(v.a)(this,
this.KSd,"awaitRtc"))}dWk(z){this.JDd=z}Osi(){return this.JDd?this.JDd():!1}UUk(z){this.Yxd=z}EF(){return(new Date).getTime()}KSd(z){if(!this.Jmg){var Y=z.nM.task;Y.continueWith(()=>{this.xS=Y.result;this.xS.WBa(Object(v.a)(this,this.dwk,"onLabelChangeUpdateOverRtc"))})}}dwk(z,Y){12===Y.type&&(this.hhf?this.hhf():this.KSa(this.$ga,2,this.Uza,!0))}V1f(){this.Zh&&(this.MCc=this.Zh.Ei("WebServiceCall","Call Get Policy Endpoint On Server"));var z=Bh.a.MCa(1,1);this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(z=new dm.a(this.txb("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,z),this.Yh.send(z).hKb(Object(v.a)(this,this.y3g,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.x3g,"onDataLossPolicyFailureCallback"))):this.Yh.nj(this.txb("datalosspolicy"),1,null,null,!0,2,Object(v.a)(this,this.y3g,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.x3g,"onDataLossPolicyFailureCallback"),null);this.$Sb++;e.ULS.sendTraceTag(25565151,
306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.Qlf,this.$Sb)}uUk(){this.KSa(this.$ga,2,this.Uza)}KSa(z,Y=0,m=null,I=!1){A.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.u7d(void 0,Y));this.i6b=this.EF();const X=this.xYd(Y);this.NSc(z,X,m,I,Y);this.ySe(!0)}y3g(z){this.Oah();let Y="";({data:Y}=this.U3e(z)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.$Sb=0,this.Zh&&
(this.NCc=this.Zh.Ei("Task","Parse and Handle Get Policy Response")),this.ODk(Y),this.NCc&&(this.NCc.stop(),this.NCc=null))}x3g(z){this.Oah();this.$Sb<=this.pBc?this.V1f():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",z?z.data?z.data.OKb:null:null),this.$Sb=0)}fng(){return 0<this.dPa}setPolicyLabel(z){this.wu.AppliedPolicyId=z}EWe(z,Y,m=null){const I=this.dFi(m);this.Qdl(z,Y,I,m)}J6g(z){this.d5a&&(this.d5a.stop(),this.d5a=null);let Y,
m;({sph:Y,Urh:m}=this.f7f(z));const I=z.data.state,X=I?I.Z7:2;let ta="";({data:ta}=this.U3e(z)).returnValue?(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",X),this.dPa=0,this.uEk(ta,Y,m,I)):this.wTe(X)}IQk(z){A.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.u7d(z));this.Aqc=this.EF();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Pa.raiseEvent("SetPolicyLabelTriggeredEventKey",new un(z))}vqk(){this.H9b&&
this.elb&&this.Jmg&&this.xS.dga(12,null,!0)}I6g(z){this.d5a&&(this.d5a.stop(),this.d5a=null);let Y;({sph:m,Urh:Y}=this.f7f(z));if(this.dPa<=this.pBc)this.EWe(m,Y);else{var m=(m=z.data.state)?m.Z7:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",z?z.data?z.data.OKb:null:null,m);this.jbc="WACServerConnectionFailed";this.dPa=0;this.wTe(m)}}FUj(z){if(z&&("LabelNotSupported"===z||"LabelErrorRetryLater"===z||"CoherencyFailure"===z||
"LabelIdNotFound"===z||"LabelDisabled"===z))return e.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",z),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",z);return!1}Aqi(z){if(!z)return!1;let Y=null,m=null;for(const I of this.wu.SensitivityLabels)I.Id===z&&(Y=I),I.Id===this.$ga&&(m=I);if(!Y)return!1;if(this.H9b&&this.elb){if(this.Yxd&&this.Yxd()||this.eOj)return!0}else if(O.AFrameworkApplication.QA&&O.AFrameworkApplication.QA.TDa||this.Uza&&this.Uza())return!0;
return Y.IsEndpointProtectionEnabled===(!!m&&m.IsEndpointProtectionEnabled)}nGc(z,Y,m,I,X){28===z?this.Meh(new oo(z,Y,m,I,X,!1)):this.Meh(new oo(z,Y,m,I,X,!0))}Wxa(z){28===z?this.ofh(new sn(z,!1)):this.ofh(new sn(z,!0))}ePk(z,Y,m){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.Pa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new Ko(z,Y,m))}tRk(z){e.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Pa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",
new Ko(null,null,z))}uRk(z,Y){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Pa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new Ko(z,Y,null))}afh(z,Y){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===Y?"Reading":"Edit")+" switch event.");this.Pa.raiseEvent("MandatoryLabellingAppHandlerEventKey",new Lo(z,Y))}nPd(z,Y,m,I,X){37===z&&this.JOk(new Ji(37,Y,m,I,X))}mRe(){this.sQk(new tn)}qRk(){e.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");
this.Pa.raiseEvent("UDPLabelingAppHandlerEventKey",new Mo(!0))}dsb(z=!1){const Y=!!this.wu&&this.wu.AreLabelsAvailable&&!!this.wu.SensitivityLabels&&0<this.wu.SensitivityLabels.length&&yd.a.any(this.wu.SensitivityLabels,m=>!!m&&m.Enabled);Y||z||ai.ajb(!1);return Y}D4g(z){this.k3a&&(this.k3a.stop(),this.k3a=null);var Y="";this.ySe(!1);({data:Y}=this.U3e(z)).returnValue?(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.ZSb=0,Y=this.eEk(Y),z=this.R5f(z.data),A.Health.instance.recordKpiSuccess("MipGetPolicyLabel",
this.FRc(void 0,z,this.i6b)),this.i6b=null,z=new Gl(z),this.xPk(z),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?Y&&this.oil()?this.gje?this.aEl():(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.KLc(),this.FPe(z),this.EDd=!0):Y||this.Skd():!this.gje&&Y&&this.$a.ka("WacApplyManualPolicyLabelIsEnabled")&&this.Fyf()?(this.FPe(z),this.EDd=!0):Y||this.Skd()):this.Skd()}oil(){if(!this.$a.ka("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,
306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.Fyf())return!1;if(""===this.$ga)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.l2a===this.QCd)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");
return!0}KLc(){this.aHh();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.a5a.count,this.l2a);const z=Om.toArray(this.a5a);this.ePk(z,z,this.l2a)}aEl(){var z=this.a5a;this.aHh();Om.Dbl(z,this.a5a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.a5a.count),z=Om.toArray(this.a5a),this.uRk(z,z));this.Uff&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",
this.l2a),this.tRk(this.l2a))}aHh(){const z=new tk.a(n.a.Hn());for(const Y of this.wu.SensitivityLabels)if(Y&&Y.AutoLabelingSensitiveTypeIds&&0<Y.AutoLabelingSensitiveTypeIds.length)for(const m of Y.AutoLabelingSensitiveTypeIds)m&&z.add(m);this.a5a=z}C4g(z){const Y=this.R5f(z.data);A.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.FRc(void 0,Y,this.i6b));this.i6b=null;this.k3a&&(this.k3a.stop(),this.k3a=null);if(this.ZSb<=this.pBc){if(this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const m=
z.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in m&&m[Bh.a.vUe]&&"HostAttributionInfo.ScenarioTypeParamName"in m&&m[Bh.a.wUe]){z.data.request.get_headers();z.data.request.get_headers();z=this.xYd(Y);this.NSc(this.$ga,z,this.Uza,void 0,Y);return}}this.KSa(this.$ga,Y,this.Uza)}else e.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",z?z.data?z.data.OKb:null:null),this.Skd(),this.ZSb=0,this.ySe(!1)}R5f(z){return z.state?z.state:0}txb(z,
Y=!1){let m=String.format("{0}{1}?action={2}&{3}",this.$a.Ga("PolicyHandlerWebServiceBase")||O.AFrameworkApplication.Aa.hb.tna,this.Qlf,z,O.AFrameworkApplication.hh);"setpolicylabel"===z&&O.AFrameworkApplication.QA&&O.AFrameworkApplication.QA.ike&&(m=E.a.Ni(m,"sl","1"));Y&&(m=E.a.Ni(m,"cbd","1"));return m}f7f(z){let Y,m;Y=m=null;z&&z.data&&z.data.request&&z.data.request.get_headers()&&(Y=z.data.request.get_headers()[Hl.a.tph],m=z.data.request.get_headers()[Hl.a.Vrh]);return{sph:Y,Urh:m}}U3e(z){z=
z?z.data?z.data.Wd:null:null;return z&&z.length&&!this.AVj(z)?{returnValue:!0,data:z}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:z})}ODk(z){let Y;try{Y=D.b(z)}catch(m){e.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(Y)if(Y.IsPolicyTipAvailable)switch(Y.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");
break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.$zd=Y.NavigateUrl;this.Dnl(Y.GeneralText,Object(v.a)(this,this.Jtk,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",Y.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else e.ULS.sendTraceTag(25565185,
306,10,"policyData is null after deserializing DataLossPrevention response.")}YBi(z){switch(z){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;
case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}uEk(z,Y,m,I){var X=I?I.Z7:2;let ta=0,Fa="",bb;if(({sv:bb}=D.d(z)).returnValue)if(bb){Fa="Success";z=this.xYd(3);if(bb.IsSuccessful){A.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.FRc(X,void 0,this.Aqc));this.jbc=this.Aqc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",X);2===X&&this.Wxa(29);
this.Pel(Y,X);this.vqk();this.Wxa(28);I&&4===X&&this.nGc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,I.displayName),CommonUIStrings.l_DialogOk,()=>{});Be.a("MipAppliedLabels",void 0,void 0,[Object.assign(new cf.a,{name:"SetPolicyLabelApplyFlag",string:uk[X]})]);this.NSc(Y,z,this.Uza,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",
X,bb.FailureReason);this.jbc=bb.FailureReason;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",!1)?ta=this.YBi(bb.FailureReason):"FileTooLarge"===bb.FailureReason?ta=7:"LabelNotSupported"===bb.FailureReason?ta=13:"LabelDisabled"===bb.FailureReason?ta=9:"MinorVersionLimitExceeded"===bb.FailureReason&&(ta=15);this.EVj&&0<=bb.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(I=new ae.a(2,1,this.Rdl,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",
this.dPa);this.dPa<=this.pBc&&this.EWe(Y,m)}),this.$d.Db(I));this.H9b&&this.elb&&this.NSc(this.wu.AppliedPolicyId,z,this.Uza,!0,3)}else Fa="setPolicyLabelData null.",e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",X);else Fa="TryDeserialize failed.",e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",X);this.wTe(X,ta);X=this.FRc(X,void 0,this.Aqc);this.Aqc=
null;X.extendedProperties.set("SetPolicyLabelDataFailureReason",this.jbc);X.extendedProperties.set("SetPolicyLabelDataParseStatus",Fa.toString());A.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,X)}wTe(z,Y=0){const m=2===z||8===z||16===z;this.setPolicyLabel(this.$ga);this.Zeh(new Rk);this.yfh(Y,z,m,!1)}Pel(z,Y){this.setPolicyLabel(this.$ga=z);if(""===z)O.AFrameworkApplication.iG=!1,O.AFrameworkApplication.y3b=!1;else for(const m of this.wu.SensitivityLabels)if(m.Id===
z){O.AFrameworkApplication.iG=m.IsEndpointProtectionEnabled;break}this.HQk(new po(z,Y))}PFl(){for(const z of this.wu.SensitivityLabels)z&&z.Enabled&&(z.Id===this.$ga&&(this.Uff=this.l2a!==z.Order,this.l2a=z.Order),z.Order>this.QCd&&(this.QCd=z.Order))}eEk(z){if(!({sv:z}=D.d(z)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!z)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),
!1;if(!z.AreLabelsAvailable)return!1;this.wu=z;this.$ga=z.AppliedPolicyId;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.PFl();this.dsb()&&e.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.Zeh(new Rk(!0));return!0}Fyf(){if(!this.dsb())return e.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const z of this.wu.SensitivityLabels)if(z&&
z.AutoLabelingSensitiveTypeIds&&0<z.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}Zeh(z){e.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Pa.raiseEvent("LabelInfoUpdateEvent",z)}xPk(z){e.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Pa.raiseEvent("GetPolicyLabelEventKey",z)}Skd(){ai.ajb(!1);this.Pa.raiseEvent("GetPolicyLabelFailureEventKey",
new Ci)}FPe(z){this.tG&&this.tG.execute(Y=>{Y=[Y.isFeatureEnabled("MsoClpSpTwo",!0),Y.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(Y).then(m=>{yd.a.any(m,I=>I)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.Pa.raiseEvent("GetAutoPolicyLabelEventKey",z),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.KLc(),Be.a("MipAutoClassificationEnabled"));return null})})}u7d(z=null,Y=null){const m=new Map;
m.set("ClpCoauth",this.elb.toString());null!=z&&m.set("ApplyLabelFlags",uk[z]);null!=Y&&m.set("GetPolicyLabelsReason",no[Y]);return m}FRc(z=null,Y=null,m=null){const I=new ka.a;I.extendedProperties=this.u7d(z,Y);null!=m&&(I.durationMs=this.EF()-m);return I}HQk(z){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Pa.raiseEvent("SetPolicyLabelEventKey",z)}Meh(z){e.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");z&&z.h0c&&Be.a("MipRecommendations");
this.Pa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",z)}ofh(z){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Pa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",z)}JOk(z){e.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Pa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",z)}sQk(z){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");
this.Pa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}Dnl(z,Y=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Pa.raiseEvent("PolicyTipEvent",new Kn(CommonUIStrings.l_PolicyBusinessBarTitle,z,CommonUIStrings.l_PolicyOverrideButton,Y))}yfh(z,Y,m,I=!0){e.ULS.sendTraceTag(42074656,306,I?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",Y);I=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let X=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,
ta=null,Fa=null;switch(z){case 2:I=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;X=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:X=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:I=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;X=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:I=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
X=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:I=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;X=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:X=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:I=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;X=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 15:I=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,X=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,ta=CommonUIStrings.l_LearnMore,Fa=()=>{this.Sdl()}}z=new ve(z,Y,m,I,X,ta,Fa);this.Pa.raiseEvent("SetPolicyLabelFailureEventKey",z)}sWe(z){this.kGd=z}Jtk(){this.$zd?(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),Tc.a.RQc(this.$zd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}AVj(z){if(!z.startsWith("<")||
-1===z.indexOf("Error")&&-1===z.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}Oah(){this.MCc&&(this.MCc.stop(),this.MCc=null)}J3i(z){if(!z)return"manual";switch(z.Z7){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}O4i(z){if(!z)return"privileged";
z=z.Z7;let Y="privileged";if(4===z||1===z)Y="standard";return Y}NSc(z,Y,m=null,I=!1,X=0){this.$a.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.$ga=z,this.Uza=m,this.Zh&&(this.k3a=this.Zh.Ei("WebServiceCall","Call Get Policy Endpoint On Server")),m={},m[Hl.a.jfi]=z,this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new dm.a(this.txb("getpolicylabels",I),1,null,m,!0,2,X,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Y),this.Yh.send(z).hKb(Object(v.a)(this,
this.D4g,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.C4g,"onGetPolicyLabelsFailureCallback"))):this.Yh.nj(this.txb("getpolicylabels",I),1,null,m,!0,2,Object(v.a)(this,this.D4g,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.C4g,"onGetPolicyLabelsFailureCallback"),X,void 0,void 0,void 0,void 0,"22"),this.ZSb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.ZSb))}Qdl(z,Y,m,I=null){if(this.y9b){this.Zh&&(this.d5a=this.Zh.Ei("WebServiceCall",
"Call Set Policy Endpoint On Server"));var X={};X[Hl.a.tph]=z;Y&&(X[Hl.a.Vrh]=encodeURIComponent(Y));this.kGd&&(X[Hl.a.Iei]=this.kGd);I?(X[Hl.a.Srh]=this.J3i(I),X[Hl.a.Trh]=this.O4i(I),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)&&1===I.Z7&&this.wu.DefaultLabelType&&(X[Hl.a.Pdl]=this.wu.DefaultLabelType)):(X[Hl.a.Srh]="manual",X[Hl.a.Trh]="privileged");this.elb&&this.wu&&(X[Hl.a.JGk]=this.wu.PolicyLabelVersionToken);this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(z=new dm.a(this.txb("setpolicylabel",!0),1,null,X,!0,2,I,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,m),this.Yh.send(z).hKb(Object(v.a)(this,this.J6g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.I6g,"onSetPolicyLabelFailureCallback"))):this.Yh.nj(this.txb("setpolicylabel",!0),1,null,X,!0,2,Object(v.a)(this,this.J6g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.I6g,"onSetPolicyLabelFailureCallback"),I,void 0,void 0,void 0,void 0,"32");
this.dPa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.dPa)}else e.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}Sdl(){const z=new mb.StandardDialog,Y=this.$a.Ga("BreadcrumbFolderUrl");Y?(z.yd=11,z.Xe(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),z.Xe(2,CommonUIStrings.l_DialogOk)):(z.yd=0,z.Xe(1,CommonUIStrings.l_DialogOk));
z.hPd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");z.jYk();z.fP(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,m=>{1===m&&Y&&Tc.a.vn(Y,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}xYd(z){switch(z){case 1:return Bh.a.MCa(1,1);case 2:return Bh.a.MCa(7,1);case 3:return Bh.a.MCa(8,
1);default:return Bh.a.MCa(7,0)}}dFi(z=null){if(!z)return Bh.a.MCa(8,0);switch(z.Z7){case 1:case 16:return Bh.a.MCa(1,1);case 4:case 2:case 8:return Bh.a.MCa(8,1);default:return Bh.a.MCa(8,0)}}ySe(z){this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",z)}}Object(h.a)(Rg,"PolicyManager",null,[476]);class lk{constructor(){this.eLd=this.UId=this.Sif=this.Nmf=this.Q8e=this.xn=this.LOa=this.Da=this.ak=null}get name(){return"Common.App.Policy"}init(){O.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&
(O.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&O.AFrameworkApplication.Aa&&(this.ak=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.ak.mbi(Object(v.a)(this,this.Cnl,"showPolicyBusinessBar")),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),Nk.a.get_instance().Uj(6,()=>{this.ak.V1f()})),O.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&O.AFrameworkApplication.fa.ka("SupportsPolicies")?Nk.a.get_instance().Uj(6,Object(v.a)(this,
this.Srk,"onAfterRibbonBehaviorAttached")):ai.ajb(!1))}dispose(){}Zb(z){z.register(476,"Common.App.Policy.Contracts.IPolicyManager").ma().oa(()=>new Rg(O.AFrameworkApplication.fa,O.AFrameworkApplication.Ke,O.AFrameworkApplication.Aa.lV,O.AFrameworkApplication.fa.Bc("MaxGetPolicyRetries",1),z.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),O.AFrameworkApplication.Aa.hb.Uk));z.register(ai,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().oa(()=>
new ai(O.AFrameworkApplication.Ta,O.AFrameworkApplication.Aa,O.AFrameworkApplication.fa,z.ke("Common.App.Policy.Contracts.IPolicyManager")));this.Da=z}Srk(){this.xn=this.Da.rb("CommonUI.BusinessBar");this.ak||(this.ak=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.LOa=this.Da.resolve("Common.App.Policy.PolicyActor");O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Qd.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.ak.SPd(Object(v.a)(this.LOa,this.LOa.phh,"registerActionsHandler")):this.LOa.wb();this.ak.SPd(Object(v.a)(this,this.OFl,"updateLabelInfo"));O.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&(this.ak.Gvf(Object(v.a)(this,this.xxj,"handleSetPolicyLabelFailure")),this.ak.B9h(Object(v.a)(this,this.nGc,"addAutoPolicyBusinessBarEntry")),this.ak.Abi(Object(v.a)(this,this.Wxa,"removeAutoPolicyBusinessBarEntry")),
this.ak.C9h(Object(v.a)(this,this.nPd,"addMandatoryLabellingBusinessBarEntry")),this.ak.Bbi(Object(v.a)(this,this.mRe,"removeMandatoryLabellingBusinessBarEntry")))}OFl(){this.LOa.Jdl();this.LOa.mcl();this.LOa.TNk();const z=this.ak.Osi();O.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&!z?this.LOa.lzl():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",O.AFrameworkApplication.fa.ka("HasDocumentEditRights"),
z);O.AFrameworkApplication.Aa.updateCommandUI()}Cnl(z,Y){this.UId&&this.xn.Mda(38)&&this.xn.removeEntry(this.UId);z=this.P5f(Y.title,Y.KGk,38,Y.Lsk,Y.buttonText);O.AFrameworkApplication.Aa.hb.pGc(z,!0)?(this.UId=z,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}xxj(z,Y){Y.lnl&&(this.eLd&&this.xn.Mda(21)&&this.xn.removeEntry(this.eLd),
z=this.P5f(Y.title,Y.message,21,null,null,Y.l_b,Y.buttonText),O.AFrameworkApplication.Aa.hb.pGc(z,!0)?(this.eLd=z,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Wxa(z,Y){(z=Y.h0c?this.Nmf:this.Q8e)&&this.xn&&this.xn.Mda(Y.Lsb)&&this.xn.removeEntry(z)}nGc(z,Y){this.xn&&(this.ak.Wxa(Y.Lsb),z=new In.a(Y.title,Y.message,
null),z.id=Y.Lsb,z.closeable=!0,z.image=3,z.addButton(Y.buttonText,Y.l_b,Y.buttonText,!0),this.xn.$h(z,!1),Y.h0c?this.Nmf=z:this.Q8e=z)}nPd(z,Y){this.xn&&(z=new In.a(Y.title,Y.message,null),z.id=Y.Lsb,z.closeable=!1,z.image=3,z.addButton(Y.buttonText,Y.l_b,Y.buttonText,!1),this.xn.$h(z,!1),this.Sif=z)}mRe(){const z=this.Sif;z&&this.xn&&this.xn.Mda(z.id)&&this.xn.removeEntry(z)}P5f(z,Y,m,I=null,X=null,ta=null,Fa=null){z=new In.a(z,Y,null);z.id=m;z.closeable=!0;I&&z.Ftf(X,I);ta&&z.addButton(Fa,ta,Fa);
return z}static main(){Ma.a.instance.Dc(new lk)}}Object(h.a)(lk,"PackageManager",null,[2,3]);var pc=d(291),hj=d(320),No=d(143);class Sl extends hj.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new No.a,{T_:Sl.getTypeName(),B_:Sl.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}Object(h.a)(Sl,"SecurityShared",hj.a,[]);class dl extends Sl{constructor(){super();this.existingLabelPriority=null;
this.H_=Object.assign(new No.a,{T_:dl.getTypeName(),B_:dl.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(h.a)(dl,"CLP",Sl,[]);var Ze=d(348),qo=d(379),Oo=d(695);class Ln extends zl.a{constructor(z){super();this.TenantId=null;this.TenantId=z}Zk(){return 103}}Object(h.a)(Ln,"GetAppliedPolicyIdRequest",zl.a,[]);class Po extends Sys.EventArgs{constructor(z){super();this.Iia=z}}Object(h.a)(Po,"OnAppliedPolicyReceivedEventArgs",
Sys.EventArgs,[]);class Mn{constructor(z,Y,m){this.N0=this.Tve=this.Z5c=null;this.va=new hi.a;this.s$b=!1;this.wi=z;this.Gcb=Y;this.Qb=m;this.Gcb.M$h(Object(v.a)(this,this.B2g,"onAppliedPolicyIdReady"));this.Gcb.wai(Object(v.a)(this,this.Y4g,"onIsManuallyAppliedReady"))}N$h(z){this.va.addHandler("AppliedPolicyEventReceivedKey",z)}dispose(){this.Gcb.YZk(Object(v.a)(this,this.B2g,"onAppliedPolicyIdReady"));this.Gcb.u_k(Object(v.a)(this,this.Y4g,"onIsManuallyAppliedReady"))}v_f(z,Y){z?(this.N0=z,this.Z5c=
Y,z=new Cj.a(new Ln(z),m=>{this.Agd(m)},m=>this.fhb(m)),this.wi.Db(z)):bd.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}fcj(z,Y){!Y||ob.a.Wa(z)?bd.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.N0=z,this.Tve=Y,z=new Cj.a(new Ln(z),m=>{this.Agd(m)},m=>this.fhb(m)),this.wi.Db(z))}B2g(z,Y){z="";ob.a.Wa(Y.Iia)||(z=Y.Iia);"00000000-0000-0000-0000-000000000000"===z?(Y=ob.a.Wa(this.N0)?this.Qb.Ga("TenantId"):this.N0,this.v_f(Y,this.Z5c)):
this.ZGe(z,null)}Y4g(z,Y){this.Wvk(Y.s$b)}Agd(z){let Y=null;z.ServerError&&0!==z.ServerError.Code?Y=Rc.a[z.ServerError.Code]:0!==z.StatusCode&&(Y=nm.a[z.StatusCode]);Y&&this.ZGe("",Y)}fhb(){bd.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.ZGe("","ErrorGetAppliedPolicyIdFailed");return!0}ZGe(z,Y){Y&&bd.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+Y);this.Z5c?this.Z5c(z,Y):bd.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");bd.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");
z=new Po(z);this.va.raiseEvent("AppliedPolicyEventReceivedKey",z)}Wvk(z){this.Tve?this.Tve(z,null):bd.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(h.a)(Mn,"AppliedPolicyIdService",null,[455,106]);class fn{constructor(z,Y,m,I){this.zEb=z;this.jGa=Y;this.mU=m;this.la=I}u_(z){var Y=z.automatic||{},m=Y.sensitivityLabel||{};Y=this.fje()?Y.id:m.id;m=z.recommended||{};const I=m.sensitivityLabel||{};z=this.fje()?m.id:I.id;m=this.fje()?m.policyTip:I.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?
this.zEb.$xf(Y,z,m,!this.mU.wu.AppliedPolicyId||!this.jGa.s$b):this.zEb.$xf(Y,z,m,!this.mU.wu.AppliedPolicyId)}fje(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(h.a)(fn,"AutoClpAnnotationEventHandler",null,[]);class qj{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(h.a)(qj,"PolicyInfo",null,[]);var ro=d(1009);class Pm{constructor(){this.mIb=
this.startTime=null}}Object(h.a)(Pm,"PollingData",null,[]);class gn{constructor(z,Y,m,I,X,ta,Fa,bb,yb,Bb,pb,Ob){this.eUg=this.jDb=!1;this.P4c=null;this.EDg=!1;this.ia=z;this.zEb=Y;this.mU=m;this.N0=I;this.xvg=new za.a;this.k$j=X;this.jGa=ta;this.zb=Fa;this.cUg=bb;this.Gq=yb;this.mJ=Bb;this.Mv=pb;this.mc=Ob;this.pLg=O.AFrameworkApplication.fa.Bc("ClpLabelPollingIntervalMs",3E4);this.zAe=O.AFrameworkApplication.fa.Bc("ClpLabelPollingTimeoutMs",3E5);this.fna=O.AFrameworkApplication.fa.Ga("UserName");
this.Ujk=O.AFrameworkApplication.fa.Ga("UserPrincipalName");this.Q8j=this.G9i()}G9i(){let z;if(O.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(z=O.AFrameworkApplication.fa.Ga("EditDocInClientUrl"))return bd.a.J(512263634,822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),z;bd.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(z=O.AFrameworkApplication.fa.Ga("WOPISrc"))||bd.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");
bd.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return z}dispose(){this.zEb=null;if(this.jDb){this.mU.Sjh(Object(v.a)(this,this.H6g,"onSetLabelSucceeded"));for(let z of this.xvg)this.mU.Sjh(z)}}init(){this.zEb.wb();this.zEb.Ee();if(O.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&O.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const z=Object(B.a)(ro.a,$f.App.Jh);z&&this.mU.UUk(Object(v.a)(z,z.rgi,"areAllCoauthorsInSessionClientMipTrusted"));this.mU.KEj(this.k$j);
0<this.pLg&&0<this.zAe&&this.jGa.N$h(Object(v.a)(this,this.iuk,"onDocumentContentPolicyChanged"));O.AFrameworkApplication.vua&&this.cUg.zVk(()=>this.Gq.qLh);this.Gq.n4&&(bd.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.Gq.n4),this.mU.sWe(this.Gq.n4));this.mJ.B$h(()=>{bd.a.J(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.Gq.n4);this.mU.sWe(this.Gq.n4)})}this.mU.xci(Object(v.a)(this,this.ogi,"applyUdpLabeling"));this.mU.dWk(Object(v.a)(this,
this.iMj,"isClpBlockedByAppSpecificScenario"));this.mU.G$h(Object(v.a)(this,this.Kfi,"applyMandatoryLabeling"));this.mU.oQd(Object(v.a)(this,this.H6g,"onSetLabelSucceeded"));this.jDb=!0}ogi(z,Y){Y.Njl&&O.AFrameworkApplication.Ta.processAction(Bc.a.openInClient,2)}iMj(){const z=!this.mc.getState(2)&&!this.mc.ilg;this.eUg!==z&&(this.mc.Srg(),bd.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",z),this.eUg=z);return z}get Iia(){return this.mU.wu.AppliedPolicyId}rWk(z){this.mU.oQd(z);
this.xvg.add(z)}TFk(z,Y,m){const I=new qj;I.TenantId=this.N0;I.LabelId=z;I.ApplyLabelType=Y;I.LabelJson=gn.q_i(D.c(m));I.SkipContentMarking=!1;I.UserName=this.fna;I.UserPrincipalName=this.Ujk;I.DocLocation=this.Q8j;bd.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");this.ia.La(Bc.a.qbh,2,I)}Kfi(z,Y){if(Y&&0!==Y.eRd){(z=1===Y.eRd)?this.Mv.KAh():(this.Mv.HAh(),""!==Y.zYg&&this.cUg.Lfi(Y.zYg));Y=z?1:3;var m=O.AFrameworkApplication.Ta.mode;Y!==m?bd.a.J(512263625,822,
10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",Y,m):this.EDg=z}else bd.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}H6g(z,Y){this.TFk(Y.Pah,Y.Z7,this.mU.wu);bd.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}l3d(z){z&&this.Iia?z=this.Iia.toLowerCase()===z.toLowerCase():(bd.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",
!z,!this.Iia),z=z===this.Iia);bd.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",z);return z}OGk(z){const Y=Object(B.a)(Pm,z.customData);if(Y){var m=+new Date-+Y.startTime;bd.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",m);this.l3d(Y.mIb)||m>this.zAe||Y.mIb!==this.P4c?(bd.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.l3d(Y.mIb),m>this.zAe,Y.mIb!==this.P4c),
this.zb.Mg(z)):(bd.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.mU.KSa(Y.mIb,void 0,gn.PPa,!0))}else bd.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.zb.Mg(z)}itl(z){bd.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const Y=new ae.a(2,2,this.pLg,Object(v.a)(this,this.OGk,"pollingTaskCallback"),90,"113");Y.customData=Object.assign(new Pm,{startTime:new Date,mIb:z});this.zb.Db(Y)}iuk(z,
Y){bd.a.J(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");Y.Iia||bd.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.P4c=Y.Iia;this.l3d(this.P4c)?bd.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.itl(Y.Iia)}static PPa(){const z=$f.App.Jh.amIAlone,Y=$f.App.Jh.PPa;let m=!1;const I=Object(B.a)(ro.a,$f.App.Jh);I&&(m=I.sgi());bd.a.J(512263585,822,50,
"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",z,Y,m);return z||Y&&m}static q_i(z){z=z.replace(RegExp(":null","gi"),':""');return z=z.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(h.a)(gn,"PptPolicyManager",null,[106]);class Sk{constructor(z,Y,m,I){this.N6j=z;this.oc=Y;this.Jb=m;this.la=I}wb(){this.N6j.ra(Bc.a.qbh,If.a.application,Object(v.a)(this,this.Lrj,"handleApplySensitivity"),4)}Ee(){}Lrj(z,Y,m,I,X){if(!(O.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&
O.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&O.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;if(Y.contextId!==If.a.application)return 2;if(!X||!Object(Qi.a)(qj,X))return 8;z=Object(B.a)(qj,X);if(ob.a.Wa(z.TenantId))return bd.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),8;if(ob.a.Wa(z.LabelJson))return bd.a.J(41793042,808,10,"The label json of policy info is empty or null"),
8;if(1===m)return 32;m=this.oc.$m;Y=this.Jb.Ad(7);try{Y.nc(m),m.nIb=z}finally{Y&&Y.dispose()}return 32}}Object(h.a)(Sk,"SetPolicyActor",null,[365]);class Qo{constructor(){this.kcc=this.e$c=this.Qb=this.jGa=this.K=null;this.PRg=!0}get name(){return"PowerPointWebEditor.Policy"}Zb(z){this.K=z;this.K.register(455,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().oa(()=>new Mn(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),
this.K.resolve("Common.IAppSettingsManager")))}init(){this.Qb=this.K.resolve("Common.IAppSettingsManager");this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.Qb.bzb(Object(v.a)(this,this.Qm,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").ff(Object(v.a)(this,this.Qm,"onFullAppSettingsReady"))}dispose(){}Qm(){if(this.Qb.ka("WacLabelingPoliciesIsEnabled")&&this.Qb.ka("SupportsPolicies")&&this.Qb.ka("890"))this.jGa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),
Nk.a.get_instance().Uj(10,Object(v.a)(this,this.Trk,"onAfterRibbonDisplayed")),pc.a.av(this.K.Ja("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const Y=new Sk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));z=z.result;this.e$c=new gn(this.K.resolve("Common.IActionManagerExtended"),Y,z,this.Qb.Ga("TenantId"),
this.K.Ja("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.e$c.init()});else if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").tjb){const z=
this.K.resolve("PowerPointWebEditor.IPPTRumTracker");z.caa(z.b6,z.Yph)}}Trk(){pc.a.av(this.K.Ja("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const Y=z.result;O.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(bd.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.kcc=new Pa.a(()=>new fn(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),Y,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.Qb.Ga("TenantId"))),Y.m$h(Object(v.a)(this,this.WUk,"registerAutoClpAnnotationEventHandler")),O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(Y.X9h(Object(v.a)(this,this.KLc,"createAutoCLPSecurityNodes")),Y.zci(Object(v.a)(this,this.ZDl,"updateAutoCLPLabelPriorityNode")),Y.Aci(Object(v.a)(this,this.$Dl,"updateAutoCLPSITNodes"))));(z=this.Qb.Ga("AppliedPolicyId"))||O.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&O.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?
O.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?Y.KSa(z,void 0,gn.PPa):Y.KSa(z):(z=this.Qb.Ga("TenantId"),ob.a.Wa(z)?bd.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(bd.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),this.jGa.v_f(z,(m,I)=>{I&&bd.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+I);ob.a.Wa(m)&&(m="",bd.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));
O.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?Y.KSa(m,void 0,gn.PPa):Y.KSa(m)}),this.jGa.fcj(z,(m,I)=>{I?bd.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+I):this.jGa.s$b=m}),this.e$c.rWk(Object(v.a)(this,this.MFl,"updateIsManuallyApplied"))))})}WUk(){const z=this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.PRg&&(z.In||this.e$c.EDg&&z.S$b)&&(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Y=>
{bd.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?(Y.tia("AugLoop_SecurityClp_LabellingAnnotation"),Y.oKa("AugLoop_SecurityClp_LabellingAnnotation",Object(v.a)(this.kcc.value,this.kcc.value.u_,"handleAnnotationEvent"))):(Y.tia("AugLoop_Automatic_Clp_LabellingAnnotation"),Y.oKa("AugLoop_Automatic_Clp_LabellingAnnotation",Object(v.a)(this.kcc.value,
this.kcc.value.u_,"handleAnnotationEvent")))}),this.PRg=!1)}KLc(z,Y){z=[Object.assign(new qo.a,{id:"clp",body:Object.assign(new dl,{existingLabelPriority:Y.existingLabelPriority,partialDocSITs:Y.aHf,fullDocSITs:Y.$Gf})})];const m=Object.assign(new Ze.a,{parentPath:["session","doc","security"],items:z});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(I=>{bd.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");I.submitOperation(m)})}ZDl(z,
Y){z=[Object.assign(new qo.a,{id:"clp",body:Object.assign(new dl,{existingLabelPriority:Y.existingLabelPriority})})];const m=Object.assign(new Oo.a,{parentPath:["session","doc","security"],items:z});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(I=>{bd.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");I.submitOperation(m)})}$Dl(z,Y){z=[Object.assign(new qo.a,{id:"clp",body:Object.assign(new dl,{partialDocSITs:Y.aHf,
fullDocSITs:Y.$Gf})})];const m=Object.assign(new Oo.a,{parentPath:["session","doc","security"],items:z});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(I=>{bd.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");I.submitOperation(m)})}MFl(z,Y){Y&&(this.jGa.s$b=Y.Pah&&0!==Y.Z7?2===Y.Z7||8===Y.Z7||16===Y.Z7?!0:!1:!1)}static main(){Ma.a.instance.Dc(new Qo)}}Object(h.a)(Qo,"PPTWebEditorPolicyPackage",null,[2,3]);var Jp=d(12);
Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");
Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Object(Jp.c)("Chronosslim");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Oa.main();Type.registerNamespace("Common.App.CatchUpActivity");Kb.main();Type.registerNamespace("Common.Comments");
Type.registerNamespace("Common.App.Rename");Ma.a.instance.Dc(new Ed,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");Ma.a.instance.Dc(new Ad);Type.registerNamespace("Common.App.SafeLinks");Cb.main();zi.main();yk.main();Ki.main();gh.main();eg.main();Oe.main();Ma.a.instance.Dc(new Io);li.main();Ma.a.instance.Dc(new qm);mo.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");lk.main();
Qo.main();Object(Jp.b)("Chronosslim")},213:function(J,aa,d){J=d(0);var h=d(57);class e{constructor(v,B,y,x,A){this.eHa=!1;this.TCb=v;this.ZBb=B;this.rcc=y;this.$ak=A;this.mEb=x.mEa(y,B.name)}get KBf(){return this.rcc}Zb(v){this.mEb.bAf();this.ZBb.Zb(v);this.mEb.vSf()}init(){this.mEb.Bu(this.ZBb.name+"_d");this.$ak?this.TCb.IEj(this,this.rcc):this.TCb.HEj(this,this.rcc)}GEj(){this.mEb.Gu(this.ZBb.name+"_d");this.mEb.dAf();this.ZBb.init();this.eHa=!0;this.mEb.ySf()}dispose(){this.eHa&&this.ZBb.dispose()}get name(){return this.ZBb.name}}
Object(J.a)(e,"DelayLoadedPackage",null,[524,2,3]);class r{constructor(v,B){this.TCb=null;v.execute(y=>{this.TCb=y});this.B7j=B}create(v,B,y){return this.TCb?new e(this.TCb,v,B,this.B7j.value,y):v}static get instance(){return r.Ka||(r.Ka=new r(h.a.instance.Ja("PowerPointWebEditor.DelayLoadedPackageInitializer"),h.a.instance.ke("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}r.Ka=null;Object(J.a)(r,"DelayLoadedPackageFactory",null,[]);d.d(aa,"a",function(){return n});const n=(v,B)=>r.instance.create(v,
B,!1)},238:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=
String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Qx(){return!0}static nub(e,r){return e+(r?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,504])},239:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r){super();this.type=e;this.Zi=r}}h.np="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},280:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(1024);class e{constructor(r){this.kl=new h.a;this.tYa=r}ZG(r){const n=r.id;let v=null;this.kl.Gb(n)?v=this.kl.ga(n):(this.tYa&&(v=this.tYa(r,()=>{this.Ioc(n)})),v&&this.kl.$(n,v));return v}IF(r){r=r.id;return this.kl.Gb(r)?this.kl.ga(r):null}Ioc(r){this.kl.remove(r)}}Object(J.a)(e,"ShapeComponentViewManager",null,[403])},448:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(67),e=d(14),r=d(330),
n=d(116);class v{constructor(B,y,x,A,E,u,K,G,O,R,V,D){this.s_b=1;this.eU=y;this.ii=B;this.jre=x;this.Le=O;this.xp=R;this.Zc=V;this.mIa=G;this.JHa=E;this.KHa=A;this.DO=u;this.Le.addCssClass(this.ii,"prControl");this.ii.style.width=this.Le.Pc(y);this.Kr=K.QLf();this.RGa=K.PLf();this.Kr.Xia(B);this.RGa.Xia(B,y,y);this.IXa=D;this.goa()}dispose(){this.zuc();this.clear();this.Kr.dispose();this.RGa.dispose();this.Le.removeCssClass(this.ii,"prControl")}get Ifa(){return n.a.none}clear(){this.Yra();this.Ctb();
this.QKb()}setZIndex(B){this.ii.style.zIndex=String(B)}ejc(){this.IXa.xa.style.zIndex=String(this.s_b+r.a.jba)}QKb(){this.IXa.xa.style.zIndex="0"}opd(B,y,x=null){B=this.mIa.uYd(this.eU,this.eU,this.jre,B,"",x);this.Kr.Loa(B,y)}d6a(B,y){this.RGa.add(B,y)}Ctb(){this.RGa.clear()}Yra(){this.Kr.clear()}onClick(){return!0}goa(){this.KHa&&this.xp.pb(h.a.pointerOver,this.ii,this.KHa);this.JHa&&this.xp.pb(h.a.pointerOut,this.ii,this.JHa);this.DO?this.Zc.pb(h.a.click,this.ii,this.DO):this.Zc.pb(h.a.click,this.ii,
Object(e.a)(this,this.onClick,"onClick"));this.Zc.pb(h.a.doubleClick,this.ii,Object(e.a)(this,this.onClick,"onClick"))}zuc(){this.KHa&&this.xp.yb(h.a.pointerOver,this.ii,this.KHa);this.JHa&&this.xp.yb(h.a.pointerOut,this.ii,this.JHa);this.DO?this.Zc.yb(h.a.click,this.ii,this.DO):this.Zc.yb(h.a.click,this.ii,Object(e.a)(this,this.onClick,"onClick"));this.Zc.yb(h.a.doubleClick,this.ii,Object(e.a)(this,this.onClick,"onClick"))}}Object(J.a)(v,"ShapePawn",null,[404])},693:function(J,aa,d){d.d(aa,"a",function(){return x});
J=d(0);var h=d(1204),e=d(14),r=d(102),n=d(37),v=d(28),B=d(448),y=d(116);class x{constructor(A,E,u,K,G,O){this.B4a=this.IGa=null;this.kr=Object(h.a)(B.a,K.cZd(A,E,u,Object(e.a)(this,this.cD,"onPointerOver"),Object(e.a)(this,this.Cz,"onPointerOut"),G));this.RHa=0;this.Oc=O;this.Oc.LA(Object(e.a)(this,this.GB,"onSessionEnd"));this.clear()}dispose(){this.kr.dispose();this.IGa=null}get Ifa(){return this.B4a}setZIndex(A){this.kr.setZIndex(A)}auf(A,E,u){this.B4a=A;this.IGa=E;this.kr.opd("UnreadNotification_16x16x32",
this.Ifa,u)}clear(){this.kr.clear();this.B4a=y.a.none}Mya(){this.v_();this.kr.d6a(this.Ifa,this.J2b);this.kr.ejc()}v_(){this.kr.Ctb();this.kr.QKb()}GB(){v.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.RHa);0<this.RHa&&r.c(n.a.VUd)}get J2b(){return this.IGa?this.IGa():""}cD(){this.Mya();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.RHa+=1;return!0}Cz(){this.v_();return!0}}Object(J.a)(x,"ShapeRevisionTrackingPawn",null,[404])},694:function(J,aa,d){d.d(aa,
"a",function(){return h});J=d(0);class h{constructor(e,r,n,v,B,y,x,A=null,E=null,u=!1,K=null,G=null,O=null,R=null,V=!1,D=null,Q=null,Z=null,P=null,ca=null,T=null){this.url=e;this.hKl=r;this.body=n;this.headers=v;this.CYe=B;this.priority=y;this.state=x;this.GKh=A;this.gpc=E;this.Qi=u;this.COk=K;this.f$k=G;this.name=O;this.qhb=R;this.j5d=V;this.rhd=D;this.Zy=Q;this.czb=Z;this.NKb=P;this.aBj=ca;this.responseType=T}}Object(J.a)(h,"ClientRequest",null,[])},695:function(J,aa,d){d.d(aa,"a",function(){return e});
J=d(0);aa=d(520);var h=d(143);class e extends aa.a{constructor(){super();this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(J.a)(e,"UpdateOperation",aa.a,[])},737:function(J,aa,d){J=d(0);var h=d(27),e=d(109),r=d(82),n=d(14),v=d(36),B=d(87),y=d(28),x=d(260);class A{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=
null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(J.a)(A,"PodsInfo",null,[]);d.d(aa,"a",function(){return E});class E{constructor(u,K,G,O,R,V,D){y.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Qb=D;this.Ds=u;this.Xa=K;this.Oc=G;this.sz=O;this.Sd=R;this.zb=V;this.jDb=!1;this.HXa=0;this.Qb.ff(Object(n.a)(this,this.initialize,
"initialize"))}initialize(){y.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.Oc.iC(Object(n.a)(this,this.Eo,"onSessionRehydrated"));this.sz.urb(Object(n.a)(this,this.zfa,"onPodSessionRefreshed"));this.jDb=!0}dispose(){this.jDb&&(this.Oc.Xfa(Object(n.a)(this,this.Eo,"onSessionRehydrated")),this.sz.Tib(Object(n.a)(this,this.zfa,"onPodSessionRefreshed")),this.jDb=!1)}sendInfoToPods(){var u=this.Qb.Ga("361"),K=this.Xa.podSessionId;const G=this.Xa.qk,O=h.AFrameworkApplication.userSessionId,
R=e.a.create().toString();y.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",R);u=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",u,K);K={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};K["X-UserSessionId"]=O;K["X-CorrelationID"]=R;K["X-WacCluster"]=G;try{const V=Object.assign(new A,{UserName:this.Qb.Ga(B.a.DDk),UserId:this.Qb.Ga("387"),ProviderId:this.Qb.Ga("388"),FileSource:this.Qb.Ga("FileSource"),LoggableUserId:this.Qb.Ga("LoggableUserId"),
TenantId:this.Qb.Ga("TenantId"),BrowserCacheAllowed:this.Qb.ka("535")&&this.Qb.ka("431"),EnableMacrosForProtectedFile:h.AFrameworkApplication.y3b,ServerDocId:this.Qb.Ga("ServerDocId"),ComplianceDomainPrefix:h.AFrameworkApplication.fa.Ga("ComplianceDomainPrefix"),IsO365CommercialHost:this.Qb.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.Qb.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.Qb.ka("PPTClpSwitchEnabled")&&this.Qb.ka("SupportsOfficeClientCoauthoring")}),D=v.c(V);this.Ds.nj(u,2,
D,K,!1,1,Object(n.a)(this,this.Vyk,"onSendUserInfoSucceeded"),Object(n.a)(this,this.Uyk,"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,x.a("6"))}catch(V){y.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",V)}}Vyk(){y.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.HXa=0}Uyk(){y.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.HXa?this.S4k():this.zqj()}S4k(){this.HXa++;y.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",
this.HXa);const u=new r.a(1,1,5E3,Object(n.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.zb.Db(u)}zqj(){y.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.HXa);this.Sd.cH(307,null);this.HXa=0}Eo(){this.HXa=0;y.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}zfa(){this.HXa=0;y.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(J.a)(E,"PodsInfoSender",null,
[])},977:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.message=this.title=null;this.lcg=!1;this.XIb=null;this.qcg=!1;this.Und=null;this.f8k=this.UKk=0;this.g8k=this.VKk=null;this.timeoutInSeconds=0}}Object(J.a)(h,"CalloutNotificationMessageAttributes",null,[])},978:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.handler=null}}Object(J.a)(h,"SetAnnotationResultCallbackParameters",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.chronosslim.js.map