'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1040:function(J,aa,d){J=d(0);var h;(function(r){r[r.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";r[r.peopleImageClassName=1]="peopleImageClassName";r[r.peopleImageClusterPath=4]="peopleImageClusterPath";r[r.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";r[r.imageDimension=6]="imageDimension";r[r.rtl=8]="rtl";r[r.pointerInputManager=9]="pointerInputManager";r[r.clickInputManager=
10]="clickInputManager";r[r.vertical=11]="vertical";r[r.zIndex=12]="zIndex";r[r.contextMenuInputManager=13]="contextMenuInputManager";r[r.imageDomElement=14]="imageDomElement";r[r.useIdleTooltip=15]="useIdleTooltip";r[r.viewportBoundsCallback=16]="viewportBoundsCallback";r[r.flipHorizontalDirection=17]="flipHorizontalDirection";r[r.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";r[r.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";r[r.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||
(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(aa,"a",function(){return e});class e{constructor(){this.Qy={}}get(r,n=null){r=h[r];return"number"===typeof n?(n=this.Qy[r])?Number.parseInvariant(n.toString()):0:this.Qy[r]}add(r,n){this.Qy[h[r]]=n}MD(r,n){h[r]in this.Qy||(this.Qy[h[r]]=n)}remove(r){delete this.Qy[h[r]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])},1145:function(J,aa,d){J=d(0);var h=d(387),e=d(14),r=d(238),n=d(239);class v{static b7d(F,na,ka){return v.c7d(F,na,ka,!0)}static c7d(F,
na,ka,Ua){const za=document.createElementNS(v.tmb,"svg");za.setAttribute("viewBox",String.format(v.b_d,v.uvc,v.tvc));za.appendChild(v.jae(F,na,ka,Ua));return za}static jae(F,na,ka,Ua){const za=v.uvc/F,ha=na/2*za,ua=v.tvc/2;let Ga=0;Ua&&(Ga=(F-3*na-4*ka)*za/2);F=document.createElementNS(v.tmb,"g");Sys.UI.DomElement.addCssClass(F,v.a_d);for(Ua=1;3>=Ua;Ua++)F.appendChild(v.B6d(Ua,ha,Ga+(Ua*(na+ka)-na/2)*za,ua));return F}static B6d(F,na,ka,Ua){const za=document.createElementNS(v.tmb,"circle");Sys.UI.DomElement.addCssClass(za,
String.format("{0}-{1}",v.DVd,F));za.setAttribute("cx",String.format("{0}",ka));za.setAttribute("cy",String.format("{0}",Ua));za.setAttribute("r",String.format("{0}",na));return za}}v.tmb="http://www.w3.org/2000/svg";v.a_d="prDancingDots";v.DVd="prAnimateCircle";v.b_d="0 0 {0} {1}";v.tvc=40;v.uvc=120;Object(J.a)(v,"ModernPresenceTooltipDancingDots",null,[]);var B=d(27),y=d(174),x=d(75),A=d(67),E=d(135),u=d(200),K=d(97),G=d(47),O=d(2);class R extends r.a{constructor(F,na){super(F);this.aYb=this.kS=
this.y2a=this.iN=this.dN=this.$o=this.Nn=null;this.nI=na.get(8,!1);this.hS=na.get(6,0);this.LNd=na.get(15,!1);this.Jc=na;this.wSb=0;this.element=F;this.element.className=R.c9a;this.Ws=document.createElement("span");this.element.appendChild(this.Ws);this.XAd=v.b7d(na.get(6,0),4,2);this.QJ(na);this._state=5}fW(F){this.addHandler(n.a.np,F)}k1(F){this.removeHandler(n.a.np,F)}get user(){return this.aYb}get state(){return this._state}dispose(){this.element&&(this.Nn.yb(A.a.click,this.element,Object(e.a)(this,
this.onClick,"onClick")),this.Nn.yb(A.a.doubleClick,this.element,Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(A.a.pointerDown,this.element,Object(e.a)(this,this.dxa,"onPointerDown")),this.$o.yb(A.a.pointerOut,this.element,Object(e.a)(this,this.Cz,"onPointerOut")),this.$o.yb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver")),this.dN.yb(this.element,Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}QJ(F){this.Nn=
F.get(10);this.Nn.pb(A.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.Nn.pb(A.a.doubleClick,this.element,Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior"));this.$o=F.get(9);this.$o.pb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver"));this.$o.pb(A.a.pointerOut,this.element,Object(e.a)(this,this.Cz,"onPointerOut"));this.$o.pb(A.a.pointerDown,this.element,Object(e.a)(this,this.dxa,"onPointerDown"));this.dN=F.get(13);this.dN.pb(this.element,
Object(e.a)(this,this.Qx,"stopPropagationAndPreventDefaultBehavior"))}hide(F=null,na=0,ka=0){this.LNd&&F?this.jZe(F,na,ka):(3===this.state&&this.Koc(),this.visible=!1,this._state=5)}jZe(F,na,ka=0){this.show(F,na,15,4,void 0,ka)}Hrc(F,na,ka,Ua=!1,za=!1,ha=!1,ua=0){this.show(F,na,ka+20,Ua?2:za?1:0,ha,ua)}ZYe(F,na,ka,Ua=!1,za=0){this.show(F,na,ka+20,3,Ua,za)}show(F,na,ka,Ua=3,za=!1,ha=0){!F||Ua===this.state&&this.Kce(na,ka)||(this.POd(Ua,za,ha),this.Yx(F,Ua,ha),this._state=Ua,4===ha||0===ha&&!this.nI?
this.element.style.left=na+"px":this.element.style.right=na+"px",this.element.style.top=ka+"px",this.visible=!0)}Yx(F,na,ka){this.aYb=F;K.a.Cu(this.Ws);u.a.uGf(this.Ws);this.Ws.id="fly_"+F.clientId;this.Ws.style.backgroundColor=F.color;4!==na?(this.Ws.style.height=this.hS+"px",this.Ws.style.lineHeight=this.hS+"px",u.a.NY(this.Ws,"border-radius",this.hS+"px")):4===ka||0===ka&&!this.nI?this.Ws.style.left="0px":this.Ws.style.right="0px";2!==na&&(4===na?K.a.Nx(this.Ws,""):1===na?this.Ws.appendChild(this.XAd):
(this.Ws.setAttribute("dir","auto"),ka=G.a.s8d(F.userName,!1),(!F.isAnonymous||B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ka||0!==na?(F=F.userName,0===na&&(F=ka,u.a.NY(this.Ws,"text-align","center")),K.a.Nx(this.Ws,F)):(this.iN||(this.iN=this.dYd()),this.Ws.appendChild(this.iN),u.a.NY(this.Ws,"text-align","start"))))}onClick(F){if(0===this.state)return this.raiseEvent(n.a.np,new n.a(1,F)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,
302,50,"User clicked on presence pill.");return!1}Cz(F){3===this.state&&this.raiseEvent(n.a.np,new n.a(3,F));return!1}cD(F){3!==F.Wf&&this.raiseEvent(n.a.np,new n.a(2,F));return!1}dxa(F){if(3!==F.Wf)return!0;this.raiseEvent(n.a.np,new n.a(4,F));return!1}dYd(){const F=document.createElement("img");F.src=y.a.ZK("doughperson_white_glyph.svg");F.setAttribute("Unselectable","on");E.a.eP(F,E.a.af,E.a.pN);return x.createClusteredImageFromClusterWithImageClass(this.hS,this.hS,null,null,R.O4d,"",!1,"",this.element.ownerDocument,
F)}POd(F,na=!1,ka=0){if(!this.Vka(this.state)||!this.Vka(F))switch(Sys.UI.DomElement.removeCssClass(this.element,this.y2a),this.state){case 4:3===F?this.oN(R.d9a,R.P4b):this.Vka(F)&&this.oN(R.b9a,R.P4b);break;case 3:4===F?this.oN(R.f9a,R.O4b):this.Vka(F)&&(na&&this.Koc(),this.oN(R.b9a,R.O4b,na?R.N4d:""));break;case 0:case 1:case 2:4===F?this.oN(R.f9a,R.e9a):3===F&&(na&&this.bPd(),this.oN(R.d9a,R.e9a,na?R.Q4b:"",3===ka?R.Q4d:R.P4d));break;default:4===F?this.oN(R.f9a):3===F?this.oN(R.d9a):this.Vka(F)&&
this.oN(R.b9a)}}oN(...F){this.y2a=F.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.y2a)}bPd(){this.wSb=window.setTimeout(()=>{this.element&&(this.kS=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.kS),this.element.style.zIndex="2",this.kS.style.zIndex="1")},300)}Koc(){window.clearTimeout(this.wSb);this.kS&&(Sys.UI.DomElement.removeCssClass(this.kS,R.e9a+" "+R.Q4b),Sys.UI.DomElement.addCssClass(this.kS,R.M4d),O.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===
this.kS.parentNode&&this.element.parentNode.removeChild(this.kS)}),u.a.uKb(this.element,"z-index"))}Vka(F){return 0===F||1===F||2===F}Kce(F,na){const ka=u.a.FH(this.element.style.top);return u.a.FH(this.element.style.left)===F&&ka===na}ejb(F){3===F&&u.a.$P(this.element,"left")?(F=u.a.FH(this.element.style.left),u.a.uKb(this.element,"left"),this.element.style.right=-1*F+"px"):4===F&&u.a.$P(this.element,"right")&&(F=u.a.FH(this.element.style.right),u.a.uKb(this.element,"right"),this.element.style.left=
-1*F+"px")}}R.c9a="prModernFlyout UIFont";R.f9a="flyoutIdle";R.d9a="flyoutExpanded";R.b9a="flyoutCollapsed";R.P4b="flyoutFromIdle";R.O4b="flyoutFromExpanded";R.e9a="flyoutFromCollapsed";R.Q4b="flyoutStacked";R.N4d="flyoutFromStacked";R.M4d="flyoutFadeOut";R.O4d="cui-img-cont-float cui-img-20by20";R.P4d="flyoutLtrDir";R.Q4d="flyoutRtlDir";Object(J.a)(R,"ModernPresenceTooltipFlyoutControl",r.a,[]);class V{constructor(F,na,ka=2,Ua=4){this.offsetTop=F;this.offsetLeft=na;this.mvc=ka;this.s8b=Ua}}Object(J.a)(V,
"FlyoutsPositioningInfo",null,[]);var D=d(65);class Q{constructor(F=!1,na=!1){this.Xi=F;this.e3a=na}A8d(F,na,ka,Ua,za,ha,ua){const Ga=ua.y,sa=ua.height;var Ba=this.t6d(ha);const pa=Ba+na;za=F*ka+(F-1)*za;ka=null;1===F||this.DUd(Ba,za,Ga,sa)?F=new V(0,0,2):(F=this.z4d(pa,za,Ga,sa),F.offsetTop-=Ba);this.e3a?ka=new V(0,0,void 0,this.Xi?4:3):(ha=this.s6d(ha,ua),Ba=Math.max(0,ua.x),ua=ua.width,na=ha+na,this.EUd(ha,Ua,Ba,ua)?ka=new V(0,0,void 0,this.Xi?3:4):this.FUd(na,Ua,Ba)&&(ka=new V(0,0,void 0,this.Xi?
4:3)),ka||(ka=this.y4d(ha,na,Ba,ua)));return new V(F.offsetTop,ka.offsetLeft,F.mvc,ka.s8b)}t6d(F){return D.a.VRc(F)}s6d(F,na){return this.Xi?na.width-D.a.O_f(F):D.a.URc(F)}DUd(F,na,ka,Ua){return F+na<=ka+Ua}z4d(F,na,ka,Ua){let za=1,ha=Math.max(ka,F-na);na>F-ka&&(za=2,ha=na<Ua?Ua-na:ka);return new V(ha,0,za)}EUd(F,na,ka,Ua){return F+na<=ka+Ua}FUd(F,na,ka){return na<=F-ka}y4d(F,na,ka,Ua){Ua-na>=F-ka?F=4:(na=F,F=3);return new V(0,na,void 0,F)}}Object(J.a)(Q,"ModernPresenceTooltipPositioner",null,[]);
class Z{constructor(F,na,ka,Ua,za,ha,ua){this.$v=F;this._parent=na;this.gRb=ka;this.uzd=Ua;this.bDd=za;this.I7=ha;this.nI=ua;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(F,na){if(3!==F)if(5!==F&&this.$v&&this.$v.length){if(4===F){var ka=this.bDd;var Ua=(this.I7-ka)/2;this.element.style.height=this.I7+"px";this.element.style.width=this.I7+"px";F=u.a.FH(this.$v[0].element.style.top);na=u.a.FH(this.nI?this.$v[0].element.style.right:
this.$v[0].element.style.left)}else ka=this.gRb,Ua=(this.I7-ka)/2,this.element.style.height=this.I7+"px",this.element.style.width=this.I6d()+2*Ua+"px",F=u.a.FH(this.$v[this.$v.length-1].element.style.top),na=this.rUd(this.$v[this.$v.length-1].element,ka,na);u.a.NY(this.element,"border-radius",this.I7+"px");this.element.style.top=F-Ua-ka+"px";this.nI?this.element.style.right=na-Ua+"px":this.element.style.left=na-Ua+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&
this.element.parentNode.removeChild(this.element)}rUd(F,na,ka){return this.nI&&!ka?u.a.FH(F.style.right):this.nI||ka?this.nI&&ka?-u.a.FH(F.style.left)-na:-u.a.FH(F.style.right)-na:u.a.FH(F.style.left)}I6d(){return this.$v&&this.$v.length?this.gRb+Math.min(this.$v.length-1,2)*this.uzd:0}}Object(J.a)(Z,"ModernPresenceTooltipTarget",null,[]);var P=d(70),ca=d(118),T=d(195);class da extends r.a{constructor(F,na,ka){super(F);this.B7=this.gI=this.xTb=this.yZ=!1;this.Df=[];this.zAa={};this.Jc=ka;this.Xi=
ka.get(8,!1);this.jTb=ka.get(15,!1);this.eAd=ka.get(12,0);this.QS=ka.get(6,0);this.k5a=na;this.cYb=ka.get(16);this.e3a=ka.get(17,!1);this.dDd=ka.get(19,!1);this.bJd=ka.get(20,!1);this.FAa=0;this.XId=new Q(this.Xi,this.e3a);this.Wga=this.H5b();this.C4a=!1;this.$M=[];this.Aha=[];this.element.id=da.p9a();this.element.className=r.a.nub("prControl",this.Xi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Xi;this.Rjb(na);this.jF=this.createElement("div");this.jF.className="prFlyoutContainer";
this.element.appendChild(this.jF);this.$v=[];this.pS=new Z(this.ft,this.element,this.QS,4,6,32,this.Xi);this.$o=ka.get(9);this.$o.pb(A.a.pointerDown,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.pb(A.a.pointerOver,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.pb(A.a.pointerOut,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"))}get Xhb(){return T.a.clone(this.Df)}get ft(){return this.$v}get defaultZIndex(){return this.eAd}get IN(){return this.ft?this.ft.length:
0}get qV(){return 0<this.IN?this.ft[0].state:5}get Nab(){return 3===this.qV&&!this.yZ}fW(F){this.addHandler(n.a.np,F)}k1(F){this.removeHandler(n.a.np,F)}dispose(){if(this.Nab)this.C4a=!0;else{if(this.ft)for(const F of this.ft)F.k1(Object(e.a)(this,this.eG,"onInteractivityChanged")),ca.a.Kx(F);this.$v=null;this.$o.yb(A.a.pointerDown,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.yb(A.a.pointerOver,this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));this.$o.yb(A.a.pointerOut,
this.pS.element,Object(e.a)(this,this.faa,"onHitTarget"));super.dispose()}}nga(){this.ZZ();this.visible=!0}Hkb(){this.visible=!0;this.Y3b();this.yZ=!0}Kya(){this.Hkb()}hide(){this.Loc();this.RN();this.pS.update(this.qV,this.B7)}Yx(F){const na=this.qV,ka=this.yZ;F.clientId||(F.clientId=(da.Gha++).toString());if(F.clientId in this.zAa){var Ua=this.fT(F.clientId);if(0<=Ua){Ua=this.Df[Ua];if(Ua.color===F.color&&Ua.userName===F.userName)return;this.TJ(F.clientId)}}this.hide();Ua=new R(this.createElement("div"),
this.Jc);Ua.fW(Object(e.a)(this,this.eG,"onInteractivityChanged"));this.jF.insertBefore(Ua.element,this.jF.firstChild);this.zAa[F.clientId]=Ua;Array.add(this.Df,F);Array.add(this.ft,Ua);this.Tuc(na,ka);this.visible=!0}TJ(F){if(this.Nab)Array.add(this.Aha,F);else{var na=this.qV,ka=this.yZ;this.hide();this.poa(F);this.Tuc(na,ka)}}Cgb(F){const na=this.fT(F);if(!(0>=na)){var ka=this.Df[na];F=this.zAa[F];Array.removeAt(this.Df,na);Array.insert(this.Df,0,ka);Array.removeAt(this.ft,na);Array.insert(this.ft,
0,F);this.jF.removeChild(F.element);this.jF.appendChild(F.element);this.ZZ()}}Tuc(F,na){0>=this.Df.length?this.hide():3===F&&na?this.Hkb():this.nga()}mkb(F,na){na?this.IOd(F):this.Eoc(F)}S3b(F){if(this.Nab&&this.dDd)return!1;F=da.e$a(F);if(this.jF!==F&&K.a.nua(this.jF,F))return!0;for(const na of this.ft)if(K.a.nua(na.element,F))return!0;return!1}position(F,na){this.element.style.top=na+"px";this.element.style.left=F+"px"}ZZ(F=!1){if(!F||this.gI){this.xTb&&this.Fqc(!0);var na=Math.min(3,this.IN)-1;
F=0;var ka=1,Ua=0;this.B7&&(F=this.Wga,ka=-1,Ua=-this.QS);for(let za=this.IN-1;za>na;za--)this.ft[za].Hrc(this.Df[za],-4*na*ka+Ua,0,!0,!1,!0,F);for(;0<=na;na--)this.ft[na].Hrc(this.Df[na],-4*na*ka+Ua,0,0<na,Array.contains(this.$M,this.Df[na].clientId),na!==this.FAa,F);this.FAa=0;this.pS.update(0,this.B7);this.zIndex=this.defaultZIndex;this.yZ=!1;this.Loc(0);this.C4a&&this.dispose()}}Y3b(){this.xTb&&this.Fqc(!1);this.zIndex=this.defaultZIndex+1;let F,na,ka;({offsetX:na,offsetY:F,r8b:ka}=this.mWe());
for(let Ua=0;Ua<this.IN;Ua++)this.ft[Ua].ZYe(this.Df[Ua],na,F+(this.QS+2)*Ua,Ua!==this.FAa,ka)}RN(){let F=0,na=0;this.B7&&(F=this.Wga,na=-6);for(let ka=0;ka<this.IN;ka++)this.ft[ka].hide(this.Df[ka],na,F);this.zIndex=this.defaultZIndex;this.visible=this.yZ=!1;this.C4a&&this.dispose()}s7a(F=0){F?(this.gI=!0,O.Task.delay(F).continueWith(()=>{this.jTb?this.mde():this.ZZ(!0);this.gI=!1})):this.jTb?this.hide():this.ZZ()}mde(){this.gI&&this.hide()}ZSd(){if(B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.s9&&
P.c()){const F=appChrome.selectors.getShyState();return F.isActive&&0!==F.state}return!1}eG(F,na){F=this.qV;this.ZSd()||2!==na.type&&(4!==na.type||3===F)?4===na.type&&3===F?(this.gI&&(this.gI=!1),this.s7a()):3!==na.type||3!==F||this.yZ||(1<this.IN?(this.gI=!0,O.Task.delay(250).continueWith(()=>{this.ZZ(!0);this.gI=!1})):this.s7a()):(this.gI&&(this.gI=!1),3!==F&&(this.Y3b(),3===na.Zi.Wf&&this.s7a(2E3)));this.raiseEvent(n.a.np,na)}faa(F){3===F.Wf?this.eG(this,new n.a(4,F)):F.eventName===A.a.pointerOver?
this.eG(this,new n.a(2,F)):F.eventName===A.a.pointerOut&&this.eG(this,new n.a(3,F));return!1}Rjb(F){this.element.style.width=F+"px";this.element.style.height=this.QS+"px"}poa(F){this.Eoc(F);F=this.fT(F);if(!(0>F)){var na=this.Df[F];Array.removeAt(this.Df,F);delete this.zAa[na.clientId];na=this.ft[F];this.jF.removeChild(na.element);this.Jc.get(18,!1)&&na.k1(Object(e.a)(this,this.eG,"onInteractivityChanged"));Array.removeAt(this.ft,F);na.dispose()}}Loc(F=5){if(this.Aha.length){this.visible&&this.RN();
for(let na=0;na<this.Aha.length;na++)this.poa(this.Aha[na]);Array.clear(this.Aha);0>=this.Df.length||5===F?this.hide():0===F&&this.nga()}}fT(F){for(let na=0;na<this.Df.length;na++)if(this.Df[na].clientId===F)return na;return-1}IOd(F){if(-1===this.fT(F))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.$M,F)){if(this.Df[0].clientId===F)return;Array.remove(this.$M,F)}Array.add(this.$M,F);this.Cgb(F);1!==this.qV&&this.ZZ()}}Eoc(F){-1===
this.fT(F)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.$M,F)&&(Array.remove(this.$M,F),this.Df[0].clientId===F&&0<this.$M.length&&this.Cgb(this.$M[this.$M.length-1]),this.Df[0].clientId===F&&1===this.qV&&this.ZZ())}Fqc(F){F?Sys.UI.DomElement.addCssClass(this.jF,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.jF,"prBackgroundSelection")}mWe(){let F,na;na=F=0;var ka=this.Wga;if(this.cYb){const Ua=this.cYb(this);if(!Ua)return{offsetX:F,
offsetY:na,r8b:ka};const za=4===this.qV;ka=this.XId.A8d(this.IN,za?6:this.QS,this.QS,150,2,this.element,Ua);na=ka.offsetTop;this.FAa=this.r8d(ka.mvc,ka.offsetTop);ka=ka.s8b;ka!==this.Wga&&(this.ejb(ka),this.element.dir=3===ka?"rtl":"ltr",this.Wga=ka);ka!==this.H5b()?(F=this.bJd?-2:za?-6:-this.QS,this.B7=!0):this.B7=!1}return{offsetX:F,offsetY:na,r8b:ka}}r8d(F,na){if(1===F)return this.IN-1;F=Math.abs(na);return 0<F?F/(this.QS+2):0}ejb(F){for(let na=0;na<this.IN;na++)this.ft[na].ejb(F)}H5b(){return this.Xi?
3:4}static p9a(){return String.format("{0}-{1}","presencetooltip",da.Gha++)}static e$a(F){return F.qc.rawEvent.relatedTarget}}da.Gha=0;Object(J.a)(da,"ModernPresenceTooltipControl",r.a,[515,106]);var fa=d(225),ma=d(289),ea=d(267);d.d(aa,"a",function(){return ra});class ra{constructor(F){this.Jc=F;this.Jc.MD(10,fa.a.instance);this.Jc.MD(9,ea.a.instance);this.Jc.MD(6,20);this.Jc.MD(13,ma.a.instance);this.Jc.MD(17,!1)}YLc(F,na){this.Jc.MD(15,!1);return new da(F,na,this.Jc)}eub(F){this.Jc.MD(15,!1);return new da(F,
20,this.Jc)}}Object(J.a)(ra,"ModernPresenceTooltipFactory",null,[505])},1250:function(J,aa,d){d.r(aa);J=d(0);var h=d(346),e=d(71),r=d(437),n=d(1204),v=d(75);class B{constructor(Da){this.qe=Da}uYd(Da,Xa,Ka,Ma,Oa,qa){const Ya=this.qe.rk(Ka+".png");Ka=v.getImageClassWithCluster(Ka,Ma);return v.createClusteredImageFromClusterWithImageClass(Da,Xa,Ka,Ya,32===Da&&32===Xa?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,Oa,null,qa)}}Object(J.a)(B,"ShapeGlyphImageFactory",null,
[406]);var y=d(448),x=d(69);class A{constructor(Da,Xa){this.P5c=this.l0=null;this.dse=this.fHg=0;this.Le=Da;this.Kc=Xa}dispose(){this.clear();this.l0.parentNode.removeChild(this.l0)}add(Da,Xa){this.XVe(!1);Da=this.r7h(Da,Xa);this.JOj()||this.jWj(Da)?this.WVe(-1*(Math.ceil(Da.offsetWidth)+2)):this.WVe(this.dse);this.XVe(!0)}clear(){this.Le.Cu(this.P5c);this.XVe(!1);this.WVe(0)}Xia(Da,Xa,Ka){this.fHg=Ka;this.dse=Xa;this.l0=this.Le.Ie();this.l0.className="prFlyout UISmallFont";Da.appendChild(this.l0);
this.P5c=this.Le.R1b();this.l0.appendChild(this.P5c)}r7h(Da,Xa){const Ka=this.Le.ZKf();Ka.style.backgroundColor=Da;Ka.style.lineHeight=this.Le.Pc(this.fHg);this.Le.Nx(Ka,Xa);this.P5c.appendChild(Ka);return Ka}jWj(Da){Da=this.Le.ai(Da);const Xa=this.Le.ai(this.Kc.Ic.MB);return Da.x+Da.width+this.dse>Xa.x+Xa.width}JOj(){return 0>this.Le.Gn(this.l0.style.left)}XVe(Da){this.l0.style.visibility=Da?x.a.visible:x.a.hidden}WVe(Da){this.l0.style.left=this.Le.Pc(Da)}}Object(J.a)(A,"ShapePawnFlyout",null,[468]);
var E=d(696),u=d(1040),K=d(1145),G=d(27),O=d(14),R=d(330),V=d(28),D=d(49),Q=d(116);class Z{constructor(Da,Xa,Ka,Ma,Oa){this.s_b=1;this.Vgc=[];this.Jcb=null;this.Tcc=this.HEb=!1;this.IXa=this.ii=this.ju=null;(this.Jv=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))?(this.ii=Da,this.IXa=Oa,this.XGi()):this.kr=Object(n.a)(y.a,Ma.cZd(Da,Xa,Ka,Object(O.a)(this,this.cD,"onPointerOver"),Object(O.a)(this,this.Cz,"onPointerOut"),Oa))}P8(){if(this.Jv)return this.bhj();const Da=Array.clone(this.Pfa);
if(this.AW){let Xa=!1;for(const Ka of this.Pfa)if(Ka.clientId===this.AW.clientId){Xa=!0;break}Xa||Array.add(Da,this.AW)}return Da}dispose(){this.Jv?this.MOi():(this.Vgc=this.Jcb=null,this.kr.dispose())}Yx(Da){if(this.Jv)this.t9h(Da);else if(Da){for(const Xa of this.Pfa)if(Xa.clientId===Da.clientId)return;Array.add(this.Pfa,Da);this.refresh()}}TJ(Da){if(this.Jv)this.lZk(Da);else if(Da)for(const Xa of this.Pfa)if(Xa.clientId===Da.clientId){Array.remove(this.Pfa,Xa);this.refresh();break}}clear(){this.Jv?
this.hui():(this.Vgc=[],this.kr.clear())}get AW(){return this.Jcb}set AW(Da){this.Jcb!==Da&&(this.Jcb=Da,this.Jcb||(this.Tcc=!1),this.Jv||this.refresh())}YYe(){this.Jv||(this.AW?(this.Tcc=!0,this.fKb()):V.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}yZe(){this.Jv?this.Fnl():(this.HEb=!0,this.Jcb&&(this.Tcc=!0),this.fKb())}ede(){this.Jv?this.NAj():(this.HEb=!1,this.fKb())}setZIndex(Da){this.Jv?this.Lgl(Da):this.kr.setZIndex(Da)}get Ifa(){return this.AW?
this.AW.color:this.Pfa&&this.Pfa.length?this.Pfa[this.Pfa.length-1].color:Q.a.none}lWc(){return!!this.Jcb||0<this.Vgc.length}get Pfa(){return this.Jv?this.ju.Xhb:this.Vgc}DAj(){this.kr.QKb();this.kr.Ctb()}Cz(){this.lWc()&&(this.HEb=!1,this.fKb());return!0}cD(){this.lWc()&&(this.HEb=!0,this.fKb());return!0}tFl(){this.lWc()?this.kr.opd(1<this.Vgc.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.Ifa):this.kr.Yra()}refresh(){this.tFl();this.fKb()}fKb(){this.DAj();if(this.HEb)if(this.AW){this.kr.d6a(this.AW.color,
String.format(ResourceStrings.l_TypingHint,this.AW.userName));for(const Da of this.Pfa)this.AW.clientId!==Da.clientId&&this.kr.d6a(Da.color,Da.userName)}else for(const Da of this.Pfa)this.kr.d6a(Da.color,Da.userName);else this.Tcc&&(this.AW?this.kr.d6a(this.AW.color,String.format(ResourceStrings.l_TypingHint,this.AW.userName)):V.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));(this.HEb||this.Tcc)&&this.kr.ejc()}mkb(Da,Xa){this.ju&&
this.ju.mkb(Da,Xa)}MOi(){this.ju&&this.ju.dispose()}BMe(){return D.a.ai(document.body)}t9h(Da){Da?this.ju?(V.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",Da.clientId),this.ju.Yx(Da)):V.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):V.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}lZk(Da){Da?this.ju?(V.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",
Da.clientId),this.ju.TJ(Da.clientId)):V.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):V.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}hui(){if(this.ju){V.a.J(42472543,814,50,"ShapePresencePawn:Clear at PresencePawn ");var Da=this.P8();if(Da)for(const Xa of Da)this.TJ(Xa);else V.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else V.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}bhj(){return this.ju?
this.ju.Xhb:null}Fnl(){this.ju&&(this.ju.nga(),this.ju.Kya())}NAj(){this.ju&&this.ju.nga()}Lgl(Da){this.ii.style.zIndex=String(Da)}Ynj(Da){const Xa=new u.a;Xa.add(0,v.getImageClassWithCluster(G.AFrameworkApplication.UN,"MoreUsersGlyph_16x16x32"));Xa.add(5,G.AFrameworkApplication.qm);Xa.add(1,v.getImageClassWithCluster(G.AFrameworkApplication.UN,"DoughboyWhiteGlyph_20x20x32"));Xa.add(4,G.AFrameworkApplication.qm);Xa.add(6,20);Xa.add(8,G.AFrameworkApplication.isRtl);Xa.add(12,Da);Xa.add(11,!1);Xa.add(16,
Object(O.a)(this,this.BMe,"presenceViewportBoundsCallback"));return new K.a(Xa)}XGi(){this.ju=this.Ynj(this.y4f()).eub(this.ii);Sys.UI.DomElement.addCssClass(this.ju.element,"ShapePawnContainer")}Uui(){const Da=this.P8();if(Da)for(const Xa of Da)this.mkb(Xa.clientId,!1)}y4f(){return this.s_b+R.a.jba+R.a.jba}ejc(){this.IXa.xa.style.zIndex=String(this.y4f())}}Object(J.a)(Z,"ShapePresencePawn",null,[457,458,106,404]);var P=d(693);class ca{constructor(Da,Xa,Ka,Ma,Oa){this.xp=Da;this.Zc=Xa;this.Le=Ka;
this.mIa=Ma;this.Kc=Oa}OHi(Da,Xa,Ka,Ma){this.Le.addCssClass(Da,"ShapeModernCatchupPawnContainer");return new P.a(Da,Xa,"pegal",this,Ka,Ma)}MHi(Da,Xa,Ka){this.Le.addCssClass(Da,"ShapePawnContainer");return new Z(Da,Xa,"per",this,Ka)}cZd(Da,Xa,Ka,Ma,Oa,qa){return new y.a(Da,Xa,Ka,Ma,Oa,null,this,this.mIa,this.Le,this.xp,this.Zc,qa)}PLf(){return new A(this.Le,this.Kc)}QLf(){return new E.a(this.Le)}}Object(J.a)(ca,"ShapePawnFactory",null,[405]);var T=d(55),da=d(583),fa=d(133),ma=d(167),ea=d(58),ra=d(60),
F=d(644),na=d(138),ka=d(169),Ua=d(188),za=d(187);class ha{constructor(Da,Xa,Ka,Ma,Oa,qa=16){this.fCg=!1;this.un=null;this.Odb=!1;this.Sic=this.BB=this.AB=0;this.vd=1;this.Ldc=!1;this.Eb=this.ncc=!0;this.kA=!1;this.hU=!0;this.Tse=!1;this.eU=qa;this.nIa=new na.a;this.b0=new Ua.a;this.yx=new ka.a;this.XF=new ka.a;this.rH=new ka.a;this.V4=new na.a;this.vE=new za.a;this.nu=new za.a;this.ob=Da;this.kr=Xa?Xa(this.V4.xa,this.eU,Oa):null;this.ta=Ka;this.O9=Ma}dispose(){this.O9();this.nIa&&(this.nIa.xa.parentNode&&
this.nIa.zq(),this.b0&&this.b0.viewport&&this.b0.viewport.zq(),this.yx&&this.yx.zq(),this.XF&&this.XF.zq(),this.rH&&this.XF.zq());this.kr&&this.kr.dispose();this.V4=this.rH=this.XF=this.yx=this.b0=this.nIa=null;this.Eb=!1}get Lth(){return this.kr}get shape(){return this.ta}get zab(){return this.fCg}set zab(Da){this.eU=Da?20:16;this.fCg=Da}get Wkg(){return this.Odb}set Wkg(Da){this.eU=16;this.Odb=Da}Jm(Da){this.nIa.appendChild(this.b0.viewport);this.nIa.appendChild(this.V4);this.yx.PE(Q.a.none);this.Odb?
this.yx.mr(ra.a.EXe):this.yx.mr(ra.a.HXe);this.XF.PE(Q.a.none);this.XF.mr(F.a.RKc);this.rH.PE(Q.a.none);this.rH.mr(F.a.EWd);this.b0.appendChild(this.rH);this.b0.appendChild(this.XF);this.b0.appendChild(this.yx);this.setVisibility();this.ZQf();Da.appendChild(this.nIa)}lD(){}Zp(){return this.b0.Zp()}mzb(){return!1}Ox(){}setVisibility(){const Da=this.Eb&&(!this.kA||!this.hU);this.V4.Rd(Da);this.yx.Rd(Da);this.XF.Rd(Da);this.rH.Rd(Da);this.nIa.Rd(this.Eb)}Xy(){}bE(){return null}JB(){return[]}ZQf(){this.un=
this.ta.fp.copy();this.yx.mr(this.Tse?F.a.UHf:this.Odb?ra.a.EXe:ra.a.HXe);this.XF.mr(F.a.RKc);this.rH.mr(F.a.EWd);this.Xr();this.setVisibility()}draw(){this.visible=!0;this.ZQf()}get visible(){return this.Eb}set visible(Da){this.Eb!==Da&&(this.Eb=Da,this.setVisibility(),this.Xr())}get zsb(){return this.ncc}set zsb(Da){this.ncc=Da;this.yx.Rd(this.Eb&&this.ncc);this.XF.Rd(this.Eb&&this.ncc);this.rH.Rd(this.Eb&&this.ncc)}setPosition(Da,Xa){this.AB=Da;this.BB=Xa;this.Xr()}Kj(Da){this.vd=Da;this.Xr()}Qq(Da){this.vE=
Da;this.Xr()}Yu(Da){this.nu=Da;this.Xr()}setZIndex(Da){this.Sic=Da;this.nIa.OB(this.Sic);this.b0.OB(this.Sic);this.V4.OB(this.Sic);this.kr&&this.kr.setZIndex(this.Sic)}OE(Da,Xa){this.kA=Da;this.hU=Xa;this.setVisibility()}jPb(Da=null){this.kr&&this.yx.Zu(Da||this.kr.Ifa);this.yx&&(this.yx.Noa(""),this.yx.PE(Q.a.none),this.Odb?this.yx.mr(ra.a.EXe):this.yx.mr(ra.a.HXe),this.yx.NY(""))}eui(){this.yx&&this.XF&&this.rH&&(this.Tse=!1,this.yx.NY(""),this.XF.NY(""),this.yx.Zu(Q.a.none),this.yx.Bya(0),this.XF.Zu(Q.a.none),
this.XF.Bya(0),this.rH.Zu(Q.a.none),this.rH.Bya(0))}X4e(Da,Xa=!1){if(this.yx&&this.XF&&this.rH){this.Tse=!0;var Ka=0===Da;this.yx.mr(F.a.UHf);this.XF.mr(2===Da?F.a.Zwi:F.a.RKc);this.rH.mr(F.a.EWd);this.yx.Zu(Ka?Q.a.none:F.a.Xwi);this.XF.Zu(Ka?Q.a.none:F.a.Twi);switch(Da){case 2:this.rH.Zu(F.a.Wwi);break;case 1:this.rH.Zu(F.a.Uwi);break;default:this.rH.Zu(F.a.Vwi)}1===Da?this.AVf():Xa?this.AVf():(this.yx.Bya(1),this.XF.Bya(1),this.rH.Bya(1))}}AVf(){this.BVf(0)}BVf(Da){this.yx&&this.XF&&this.rH&&!(1<
Da)&&(Da+=.05,this.yx.Bya(Da),this.XF.Bya(Da),this.rH.Bya(Da),window.setTimeout(()=>{this.BVf(Da)},10))}Xr(){if(this.un){var Da=this.un.copy();this.vE.El(Da);this.nu.El(Da);Da.move(this.AB,this.BB);Da.scale(this.vd,this.vd);this.fEl(Da);this.yGl(Da)}}fEl(Da){if(this.yx&&this.XF&&this.rH&&Da){var Xa=this.dDf(F.a.Ywi,Da),Ka=this.dDf(F.a.RKc,Xa);this.rH.Et(Ka.points);this.b0.Rl();this.rH.Rd(this.Eb&&(!this.kA||!this.hU));this.XF.Et(Xa.points);this.b0.Rl();this.XF.Rd(this.Eb&&(!this.kA||!this.hU));this.yx.Et(Da.points);
this.b0.Rl();this.yx.Rd(this.Eb&&(!this.kA||!this.hU));T.a.cbb&&this.ta&&this.ta.ud&&this.ob.ihg()&&this.b0.viewport.lh(this.b0.viewport.width,0)}}wjc(){if(this.zab){var Da=this.V4.x,Xa=this.V4.y;this.ob.jX(this.ta)&&!this.Ldc&&(this.V4.setPosition(Da,Xa-18),this.Ldc=!0)}}vFe(){if(this.zab){var Da=this.V4.x,Xa=this.V4.y;this.Ldc&&!this.ob.jX(this.ta)&&(this.V4.setPosition(Da,Xa+18),this.Ldc=!1)}}dDf(Da,Xa){var Ka=Xa.sk(ma.a.DE),Ma=Xa.sk(ma.a.Ru);Ka=da.a.YO(ea.a.MG(Ma,Ka));new ea.a(0,0);let Oa;new ea.a(0,
0);let qa;new ea.a(0,0);new ea.a(0,0);Xa.rotate(-Ka);const Ya=Xa.points;Ma=new ea.a(Ya[0]._x+Da,Ya[0]._y+Da);Oa=new ea.a(Ya[1]._x-Da,Ya[1]._y+Da);qa=new ea.a(Ya[2]._x-Da,Ya[2]._y-Da);Da=new ea.a(Ya[3]._x+Da,Ya[3]._y-Da);Da=new fa.a(Ma,Oa,qa,Da);Da.rotate(Ka);Xa.rotate(Ka);return Da}yGl(Da){if(Da){var Xa=Da.sk(ma.a.DE),Ka=Da.sk(ma.a.Ru),Ma=da.a.YO(ea.a.MG(Ka,Xa));Xa=Da.sk(ma.a.DE);Ka=Da.sk(ma.a.Ru);90<=Ma&&(Xa=Da.sk(ma.a.Ru),Ka=Da.sk(ma.a.RH));180<=Ma&&(Xa=Da.sk(ma.a.RH),Ka=Da.sk(ma.a.WE));270<=Ma&&
(Xa=Da.sk(ma.a.WE),Ka=Da.sk(ma.a.DE));Ma=ea.a.MG(Ka,Xa);var Oa=this.ygj(Ma);Da=Math.cos(Ma)*Oa;Ma=Math.sin(Ma)*Oa;Oa=this.zab?this.eU/2-1:this.Odb?this.eU/2:this.eU;this.Odb?this.V4.setPosition(Ka.x-Oa,Ka.y-Oa):this.V4.setPosition(Xa.x-Da,Xa.y-Ma-Oa);this.V4.Rd(this.Eb&&(!this.kA||!this.hU));this.zab&&(this.Ldc=!1,this.wjc())}}ygj(Da){return(this.zab?10:15)-da.a.YO(Da)/6}}Object(J.a)(ha,"ShapePawnView",null,[456]);class ua{dZd(Da,Xa,Ka,Ma,Oa){return new ha(Da,Xa,Ka,Ma,Oa,16)}}Object(J.a)(ua,"ShapePawnViewFactory",
null,[407]);class Ga extends Sys.EventArgs{constructor(Da){super();this.shape=Da}}Object(J.a)(Ga,"ShapeViewElementPresenceStateChangedEventArgs",Sys.EventArgs,[]);class sa{constructor(Da,Xa){this.Ag=Da;this.ta=this.Ag.shape;this.ta.As=!1;this.hug=new Ga(this.ta);this.fj=Object(n.a)(Z,this.Ag.Lth);this.JXg=Xa;(this.fyg=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.Ag&&(this.Ag.zab=!0)}Jm(Da){this.Ag.Jm(Da)}lD(Da){this.Ag.lD(Da)}Zp(){return this.Ag.Zp()}PN(Da){return this.Ag.mzb(Da)}Ox(Da){this.Ag.Ox(Da)}wjc(){this.Ag.wjc()}vFe(){this.Ag.vFe()}dispose(){this.Ag.dispose()}Xy(){this.Ag.Xy()}bE(Da){return this.Ag.bE(Da)}JB(Da){return this.Ag.JB(Da)}draw(Da,
Xa){this.Ag.draw(Da,Xa)}get visible(){return this.Ag.visible}set visible(Da){this.Ag.visible=Da}setPosition(Da,Xa){this.Ag.setPosition(Da,Xa)}Kj(Da){this.Ag.Kj(Da)}Qq(Da){this.Ag.Qq(Da)}Yu(Da){this.Ag.Yu(Da)}setZIndex(Da){this.Ag.setZIndex(Da)}OE(Da,Xa){this.Ag.OE(Da,Xa)}setSelection(){}Cia(Da){Da&&(this.dQa(),this.fj.Yx(Da),this.Ag.jPb(),this.Ag.setVisibility(),V.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",Da.clientId,this.fj.Ifa,
this.ta?this.ta.Er:"null_moniker"))}k_a(Da){if(Da&&this.fj){this.fj.TJ(Da);this.Ag.jPb();var Xa=this.fj.P8();Xa&&Xa.length?V.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",Da.clientId,this.fj.Ifa,this.ta?this.ta.Er:""):V.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",Da.clientId,this.ta?this.ta.Er:"null_moniker");this.Ag.setVisibility();
this.XBa()}}oGf(){this.fj.clear();this.Ag.jPb();this.XBa()}YYe(){this.fj.YYe()}Hll(){this.fj.yZe()}v_(){this.fj.ede()}wvd(Da){Da&&this.dQa();this.fj&&(this.fj.AW=Da);this.Ag.jPb();this.fyg&&this.fj&&(this.fj.AW?this.fj.mkb(Da.clientId,!0):this.fj.Uui());Da||this.XBa()}get Whb(){return this.fj}get Hce(){return this.fj.lWc()}get zsb(){return this.Ag.zsb}set zsb(Da){this.Ag.zsb=Da}dQa(){this.ta.As||this.Hce||(this.ta.As=!0,this.JXg.Cfh(this.hug))}XBa(){this.ta.As&&!this.Hce&&(this.ta.As=!1,this.JXg.Cfh(this.hug))}}
Object(J.a)(sa,"ShapePresenceView",null,[434,435,436,106]);var Ba=d(280);class pa{get name(){return"PowerPointWebEditor.ShapePresence"}Zb(Da){Da.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").ma().oa(()=>new Ba.a((Xa,Ka)=>{let Ma=null;const Oa=Object(n.a)(117,Xa.sc(Da.resolve("Box4.IPageView").Ma));Oa&&!Oa.Al&&(Xa=Da.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").dZd(Da.resolve("PowerPointWebEditor.IPptSelectionManager"),
(qa,Ya,Fb)=>Object(n.a)(404,Da.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").MHi(qa,Ya,Fb)),Xa,Ka,Oa.WU),Ma=new sa(Xa,Da.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),Ma.Jm(Oa.WU),Oa.xra(Ma,1),Ma.visible=Oa.BQ||Oa.Wn);return Ma}));Da.register(405,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").ma().oa(()=>new ca(Da.resolve("Common.IPointerInputManager"),Da.resolve("Common.IClickInputManager"),Da.resolve("PowerPoint.IBrowserHelperManager"),Da.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),
Da.resolve("PowerPointWebEditor.IActiveSlideViewManager")));Da.register(406,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").ma().oa(()=>new B(Da.resolve("PowerPoint.IPathManager")));Da.register(407,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").ma().oa(()=>new ua)}init(){}dispose(){}static main(){e.a.instance.Dc(new pa)}}Object(J.a)(pa,"PPTWebEditorShapePresencePackage",null,[2,3]);class ia{constructor(){this.K=null;this.TX=[new pa]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}Zb(Da){this.K=
Da;for(const Xa of this.TX)Xa.Zb(Da)}init(){for(const Da of this.TX)Da.init();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").kjg=!0;h.a.instance.jc(r.a.T2d,(new Date).getTime())}dispose(){}static main(){h.a.instance.jc(r.a.V2d,(new Date).getTime());e.a.instance.Dc(new ia)}}Object(J.a)(ia,"PptExtCommonPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.ShapePresence");Type.registerNamespace("Common.App.CollabControls");ia.main();
pa.main()},238:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=
String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Qx(){return!0}static nub(e,r){return e+(r?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,504])},239:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r){super();this.type=e;this.Zi=r}}h.np="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},280:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(1024);class e{constructor(r){this.kl=new h.a;this.tYa=r}ZG(r){const n=r.id;let v=null;this.kl.Gb(n)?v=this.kl.ga(n):(this.tYa&&(v=this.tYa(r,()=>{this.Ioc(n)})),v&&this.kl.$(n,v));return v}IF(r){r=r.id;return this.kl.Gb(r)?this.kl.ga(r):null}Ioc(r){this.kl.remove(r)}}Object(J.a)(e,"ShapeComponentViewManager",null,[403])},448:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(67),e=d(14),r=d(330),
n=d(116);class v{constructor(B,y,x,A,E,u,K,G,O,R,V,D){this.s_b=1;this.eU=y;this.ii=B;this.jre=x;this.Le=O;this.xp=R;this.Zc=V;this.mIa=G;this.JHa=E;this.KHa=A;this.DO=u;this.Le.addCssClass(this.ii,"prControl");this.ii.style.width=this.Le.Pc(y);this.Kr=K.QLf();this.RGa=K.PLf();this.Kr.Xia(B);this.RGa.Xia(B,y,y);this.IXa=D;this.goa()}dispose(){this.zuc();this.clear();this.Kr.dispose();this.RGa.dispose();this.Le.removeCssClass(this.ii,"prControl")}get Ifa(){return n.a.none}clear(){this.Yra();this.Ctb();
this.QKb()}setZIndex(B){this.ii.style.zIndex=String(B)}ejc(){this.IXa.xa.style.zIndex=String(this.s_b+r.a.jba)}QKb(){this.IXa.xa.style.zIndex="0"}opd(B,y,x=null){B=this.mIa.uYd(this.eU,this.eU,this.jre,B,"",x);this.Kr.Loa(B,y)}d6a(B,y){this.RGa.add(B,y)}Ctb(){this.RGa.clear()}Yra(){this.Kr.clear()}onClick(){return!0}goa(){this.KHa&&this.xp.pb(h.a.pointerOver,this.ii,this.KHa);this.JHa&&this.xp.pb(h.a.pointerOut,this.ii,this.JHa);this.DO?this.Zc.pb(h.a.click,this.ii,this.DO):this.Zc.pb(h.a.click,this.ii,
Object(e.a)(this,this.onClick,"onClick"));this.Zc.pb(h.a.doubleClick,this.ii,Object(e.a)(this,this.onClick,"onClick"))}zuc(){this.KHa&&this.xp.yb(h.a.pointerOver,this.ii,this.KHa);this.JHa&&this.xp.yb(h.a.pointerOut,this.ii,this.JHa);this.DO?this.Zc.yb(h.a.click,this.ii,this.DO):this.Zc.yb(h.a.click,this.ii,Object(e.a)(this,this.onClick,"onClick"));this.Zc.yb(h.a.doubleClick,this.ii,Object(e.a)(this,this.onClick,"onClick"))}}Object(J.a)(v,"ShapePawn",null,[404])},693:function(J,aa,d){d.d(aa,"a",function(){return x});
J=d(0);var h=d(1204),e=d(14),r=d(102),n=d(37),v=d(28),B=d(448),y=d(116);class x{constructor(A,E,u,K,G,O){this.B4a=this.IGa=null;this.kr=Object(h.a)(B.a,K.cZd(A,E,u,Object(e.a)(this,this.cD,"onPointerOver"),Object(e.a)(this,this.Cz,"onPointerOut"),G));this.RHa=0;this.Oc=O;this.Oc.LA(Object(e.a)(this,this.GB,"onSessionEnd"));this.clear()}dispose(){this.kr.dispose();this.IGa=null}get Ifa(){return this.B4a}setZIndex(A){this.kr.setZIndex(A)}auf(A,E,u){this.B4a=A;this.IGa=E;this.kr.opd("UnreadNotification_16x16x32",
this.Ifa,u)}clear(){this.kr.clear();this.B4a=y.a.none}Mya(){this.v_();this.kr.d6a(this.Ifa,this.J2b);this.kr.ejc()}v_(){this.kr.Ctb();this.kr.QKb()}GB(){v.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.RHa);0<this.RHa&&r.c(n.a.VUd)}get J2b(){return this.IGa?this.IGa():""}cD(){this.Mya();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.RHa+=1;return!0}Cz(){this.v_();return!0}}Object(J.a)(x,"ShapeRevisionTrackingPawn",null,[404])},696:function(J,aa,d){d.d(aa,
"a",function(){return e});J=d(0);var h=d(69);class e{constructor(r){this.U9=this.ema=null;this.Le=r}dispose(){this.clear();this.ema.parentNode.removeChild(this.ema)}Xia(r){this.ema=this.y1b(r,"prContainerHr");this.U9=this.y1b(this.ema,"prGlyph")}clear(){this.loa()}Loa(r,n){r&&(this.loa(),this.U9.appendChild(r),this.U9.style.backgroundColor=n,this.ema.style.visibility=h.a.visible)}y1b(r,n){const v=this.Le.Ie();this.Le.addCssClass(v,n);r.appendChild(v);return v}loa(){this.U9.firstChild&&this.U9.removeChild(this.U9.firstChild)}}
Object(J.a)(e,"ShapePawnGlyph",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.extcommon.js.map