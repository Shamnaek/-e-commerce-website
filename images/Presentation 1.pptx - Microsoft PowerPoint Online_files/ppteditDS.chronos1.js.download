'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1004:function(J,aa,d){d.r(aa);var h=d(0),e=d(144),r=d(383),n=d(263),v=d(156),B=d(171),y=d(170),x=d(117),A=d(104),E=d(305);class u{constructor(ya){this.ub=ya}$D(){return"ActionAI"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La,Qa=!1,Eb,fc=null){Eb=new y.a(ya);if(!fc||Array.contains(fc,24))if(this.vkl()||!A.a.MF(ya)){fc=new B.a(24);var mc=A.a.MF(ya);Qa&&(Qa=null,A.a.j4()&&(Qa=A.a.PCa(mc?"":ya.zf,1,Object.assign(new E.a,
{landingTab:"ActionAI"}))),this.ub.tda?Qa&&x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Qa)):(ya=[],Qa&&ya.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Qa)),appChrome.api.dispatch(ya)));fc.ls(new v.a("ActionAIFromTellMe",25,null,null,1));Eb.Uq(fc)}La.resultsUpdated(Eb)}vkl(){return A.a.j4()&&this.ub.MYc}}Object(h.a)(u,"ActionAIResultsProvider",null,[602]);var K=d(711);class G{constructor(ya,La){this.Hxd=ya;this.Uh=La}resultsUpdated(ya){this.Hxd.vel(this.Uh,
ya)}}Object(h.a)(G,"AggregatorResultsProviderCallback",null,[900]);class O{constructor(ya){this.lba=null;this.ub=ya;this.ub.x6a&&(this.lba=null)}$D(){return"AppsForOffice"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La,Qa,Eb,fc=null){Qa=new y.a(ya);if(!fc||Array.contains(fc,1))fc=new B.a(1),this.lba.QNl(fc,ya.zf),Qa.Uq(fc);La.resultsUpdated(Qa)}}Object(h.a)(O,"AppsForOfficeRecommendationResultsProvider",null,[602]);var R=d(987),V=d(80),D=d(224),Q=d(24);class Z{constructor(ya,La){this.Ia=
ya;this.q9j=La}isMatch(ya,La){if(!Object(Q.a)(975,ya))throw Error.argument("objToTest","Expected feature bundle");let Qa;return({value:Qa}=ya.Tm(this.Ia.pca)).returnValue?this.Ia.B6e.isMatch(Qa,La):this.q9j}}Object(h.a)(Z,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1014]);class P{constructor(ya,La){this.Ia=ya;this.fue=La}isMatch(ya){if(!Object(Q.a)(975,ya))throw Error.argument("objToTest","Expected feature bundle");return!!(this.fue^ya.Tm(this.Ia.pca).returnValue)}}Object(h.a)(P,"AnnotatedWithAnnotationFilter",
null,[1014]);class ca{constructor(ya){this.Ia=ya}isMatch(ya,La){if(!Object(Q.a)(977,ya))throw Error.argument("objToTest","Expected struct value");return this.Ia.B6e.isMatch(ya.QSa(this.Ia.Wsa),La)}}Object(h.a)(ca,"FieldValueMatchesStructFilter",null,[1014]);class T{constructor(ya,La){ya&&(this.Wsa=ya.ga(0),this.B6e=La.M8(ya.ga(1)))}}Object(h.a)(T,"FieldValueMatchesStructFilterInit",null,[]);class da{constructor(ya){this.fue=ya}isMatch(ya){if(!Object(Q.a)(975,ya))throw Error.argument("objToTest","Expected feature bundle");
return!!(this.fue^ya.pce)}}Object(h.a)(da,"HasAnnotationsAnnotationFilter",null,[1014]);class fa{constructor(ya,La){this.Ia=ya;this.Lq=La}isMatch(ya,La){if(!Object(Q.a)(976,ya))throw Error.argument("objToTest","Expected list value");switch(this.Lq){case 0:for(const Qa of ya.items)if(this.Ia.filter.isMatch(Qa,La))return!0;return!1;case 1:for(const Qa of ya.items)if(!this.Ia.filter.isMatch(Qa,La))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(fa,"ItemTestListFilter",null,[1014]);
class ma{constructor(ya){this.Ia=ya}isMatch(ya,La){if(!Object(Q.a)(976,ya))throw Error.argument("objToTest","Expected list value");return this.Ia.filter.isMatch(ya.items.length,La)}}Object(h.a)(ma,"LengthMatchesListFilter",null,[1014]);class ea{constructor(ya,La){this.Ia=ya;this.Lq=La}isMatch(ya,La,Qa=null){let Eb=0===this.Lq;for(const fc of this.Ia.yFf)if((Eb=fc.isMatch(ya,La,Qa))?1===this.Lq:0===this.Lq)return Eb;2===this.Lq&&(Eb=!Eb);return Eb}}Object(h.a)(ea,"NonterminalFilter",null,[1014]);class ra{constructor(ya,
La){if(ya){var Qa=ya.ga(0);this.yFf=Array(Qa);for(let Eb=0;Eb<Qa;++Eb)this.yFf[Eb]=La.M8(ya.ga(1+Eb))}}}Object(h.a)(ra,"NonterminalFilterInit",null,[]);class F{constructor(ya,La){this.Ia=ya;this.Lq=La}isMatch(ya,La){if("number"!==typeof ya)throw Error.argument("objToTest","Expected number value");let Qa=this.Ia.number;if(this.Ia.query){La=this.Ia.query.qp(null,La);if("number"!==typeof La)throw Error.invalidOperation("Query did not return number");Qa+=La}switch(this.Lq){case 0:return ya===Qa;case 1:return ya<
Qa;case 2:return ya<=Qa;case 3:return ya>Qa;case 4:return ya>=Qa;default:throw Error.notImplemented();}}}Object(h.a)(F,"NumberFilter",null,[1014]);class na{constructor(ya,La){ya&&(this.number=ya.ga(0),this.query=ya.ga(1)?La.VD(ya.ga(1)):null)}}Object(h.a)(na,"NumberFilterInit",null,[]);class ka{constructor(ya,La,Qa){this.ZSc=this.N$i;this.FHa=ya;this.Uyg=La;this.Syg=Qa}$Ud(ya){this.Uyg=ya}N$i(ya){if(!ya)throw Error.argument("name","Invalid named feature bundle reference");const La=ya.substr(1);return 1===
ya.charCodeAt(0)&&La===this.FHa?this.Uyg:this.Syg?this.Syg.ZSc(ya):null}}Object(h.a)(ka,"SimpleNamedFeatureBundleResolver",null,[1040]);class Ua{constructor(ya){this.Ia=ya}isMatch(ya,La){if(!Object(Q.a)(975,ya))throw Error.argument("objToTest","Expected feature bundle");ya=this.Ia.query.qp(null,new ka(this.Ia.awd,ya,La));if("boolean"!==typeof ya)throw Error.invalidOperation("Query did not return bool");return ya}}Object(h.a)(Ua,"PredicateAnnotationFilter",null,[1014]);class za{constructor(ya,La){ya&&
(this.awd=La.BC(ya.ga(0)),this.query=La.VD(ya.ga(1)))}}Object(h.a)(za,"PredicateAnnotationFilterInit",null,[]);class ha{constructor(ya){this.Ia=ya}isMatch(ya,La){if("boolean"!==typeof ya)throw Error.argument("objToTest","Expected bool value");La=this.Ia.query.qp(null,La);if("boolean"!==typeof La)throw Error.invalidOperation("Query did not return bool");return ya===La}}Object(h.a)(ha,"QueryBooleanFilter",null,[1014]);class ua{constructor(ya,La){this.Ia=ya;this.Lq=La}isMatch(ya,La){if("number"!==typeof ya)throw Error.argument("objToTest",
"Expected integer");La=this.Ia.query.qp(null,La);if("number"!==typeof La)throw Error.invalidOperation("Query did not return an enum value");switch(this.Lq){case 0:return ya===La;case 1:return 0!==(ya&La);case 2:return ya===(ya&La);case 3:return La===(ya&La);default:throw Error.notImplemented();}}}Object(h.a)(ua,"QueryEnumFilter",null,[1014]);class Ga{constructor(ya,La){ya&&(this.x_c=1===ya.ga(0),this.query=La.VD(ya.ga(1)))}}Object(h.a)(Ga,"QueryEnumFilterInit",null,[]);class sa{constructor(ya,La){this.Ia=
ya;this.Lq=La}isMatch(ya,La){if(!Object(Q.a)(976,ya))throw Error.argument("objToTest","Expected list value");La=this.Ia.query.qp(null,La);if(!Object(Q.a)(976,La))throw Error.invalidOperation("Query did not return list value");if(ya.BU!==La.BU)return!1;switch(this.Lq){case 0:return V.Annotations.T1a(V.Annotations.odj(ya.BU),ya,La);case 1:for(const Qa of ya.items)for(const Eb of La.items)if(V.Annotations.T1a(ya.BU,Qa,Eb))return!0;return!1;case 2:for(const Qa of ya.items)for(const Eb of La.items)if(!V.Annotations.T1a(ya.BU,
Qa,Eb))return!1;return!0;case 3:for(const Qa of La.items)for(const Eb of ya.items)if(!V.Annotations.T1a(ya.BU,Qa,Eb))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(sa,"QueryListFilter",null,[1014]);class Ba{constructor(ya,La){this.Ia=ya;this.Lq=La}isMatch(ya,La){if("string"!==typeof ya)throw Error.argument("objToTest","Expected string");La=this.Ia.query.qp(null,La);if("string"!==typeof La)throw Error.invalidOperation("Query did not return string");this.Ia.rje&&(ya=ya.toUpperCase(),
La=La.toUpperCase());switch(this.Lq){case 0:return ya===La;case 1:return 0<=ya.indexOf(La);case 2:return ya.startsWith(La);case 3:return ya.endsWith(La);case 4:return 0<=La.indexOf(ya);case 5:return La.startsWith(ya);case 6:return La.endsWith(ya);default:throw Error.notImplemented();}}}Object(h.a)(Ba,"QueryStringFilter",null,[1014]);class pa{constructor(ya,La){ya&&(this.query=La.VD(ya.ga(0)),this.rje=1===ya.ga(1))}}Object(h.a)(pa,"QueryStringFilterInit",null,[]);class ia{constructor(ya){this.Ia=ya}isMatch(ya,
La){if(!Object(Q.a)(977,ya))throw Error.argument("objToTest","Expected struct value");La=this.Ia.query.qp(null,La);if(!Object(Q.a)(977,La))throw Error.invalidOperation("Query did not return struct value");return ya.isEqual(ya)}}Object(h.a)(ia,"QueryStructFilter",null,[1014]);class Da{constructor(ya){this.Ia=ya}isMatch(ya,La){ya=this.Ia.query.qp(null,La);if("boolean"!==typeof ya)throw Error.invalidOperation("Query did not return bool");return ya}}Object(h.a)(Da,"QueryWhereConstraintFilter",null,[1014]);
class Xa{constructor(ya){this.Ia=ya}isMatch(ya){if("string"!==typeof ya)throw Error.argument("objToTest","Expected string");return this.Ia.regex.test(ya)}}Object(h.a)(Xa,"RegexStringFilter",null,[1014]);class Ka{constructor(ya,La){ya&&(this.regex=La.q6f(ya.ga(0)))}}Object(h.a)(Ka,"RegexStringFilterInit",null,[]);class Ma{constructor(ya,La){ya&&(this.filter=La.M8(ya.ga(0)))}}Object(h.a)(Ma,"SingleFilterFilterInit",null,[]);class Oa{constructor(ya,La){ya&&(this.query=La.VD(ya.ga(0)))}}Object(h.a)(Oa,
"SingleQueryFilterInit",null,[]);class qa{constructor(ya){this.Ia=ya}isMatch(ya){if("boolean"!==typeof ya)throw Error.argument("objToTest","Expected bool value");return ya===this.Ia.value}}Object(h.a)(qa,"StoredValueBooleanFilter",null,[1014]);class Ya{constructor(ya){ya&&(this.value=1===ya.ga(0))}}Object(h.a)(Ya,"StoredValueBooleanFilterInit",null,[]);class Fb{constructor(ya,La){this.Ia=ya;this.Lq=La}isMatch(ya){if("number"!==typeof ya)throw Error.argument("objToTest","Expected integer");switch(this.Lq){case 0:return this.Ia.x_c?
this.Ia.value?!!(ya&this.Ia.value):!ya:ya===this.Ia.value;case 1:return this.Ia.x_c?(ya&this.Ia.value)===this.Ia.value:32>ya&&(1<<ya&this.Ia.value)===this.Ia.value;case 2:return this.Ia.x_c?!!(ya&this.Ia.value):32>ya&&!!(1<<ya&this.Ia.value);default:throw Error.notImplemented();}}}Object(h.a)(Fb,"StoredValueEnumFilter",null,[1014]);class hc{constructor(ya){ya&&(this.x_c=1===ya.ga(0),this.value=ya.ga(1))}}Object(h.a)(hc,"StoredValueEnumFilterInit",null,[]);class ec{constructor(){this.IDk=null;this.NTd=
this.aab=0}}Object(h.a)(ec,"WHEREConstraintData",null,[]);class Tb{constructor(ya){this.Ia=ya}isMatch(ya,La){if(!Object(Q.a)(ec,ya))throw Error.argument("objToTest","Expected WHERE constraint data");let Qa=-1,Eb=-1;const fc=ya.IDk;switch(this.Ia.TUd){case 4:Qa=fc.E4b;Eb=fc.y_e;break;case 5:Qa=ya.aab;Eb=fc.E4b-ya.aab;break;case 6:Qa=fc.E4b+fc.y_e;Eb=ya.aab+ya.NTd-Qa;break;case 1:case 2:case 3:let mc=!1;for(let Mc=fc.dOl;Mc;Mc=Mc.next)if(this.Ia.YIl===Mc.name){mc=!0;1===this.Ia.TUd?(Qa=Mc.E4b,Eb=Mc.y_e):
2===this.Ia.TUd?(Qa=ya.aab,Eb=Mc.E4b-ya.aab):(Qa=Mc.E4b+Mc.y_e,Eb=ya.aab+ya.NTd-Qa);break}if(!mc)return!1;break;case 7:Qa=ya.aab;Eb=ya.NTd;break;default:throw Error.notImplemented();}return null!==this.Ia.frl.COl(fc.gQl,Qa,Eb,Qa,!0,2,La)}}Object(h.a)(Tb,"SubSreWhereConstraintFilter",null,[1014]);class vb{constructor(ya,La){if(ya){var Qa=La.BC(ya.ga(0));this.TUd=Qa.charCodeAt(0);this.YIl=Qa.substr(1);this.frl=La.Zij(ya.ga(1))}}}Object(h.a)(vb,"SubSreWhereConstraintFilterInit",null,[]);class zb{constructor(ya){this.Ia=
ya}isMatch(ya,La,Qa=null){if(!Object(Q.a)(975,ya))throw Error.argument("objToTest","Expected feature bundle");if(null==Qa)throw Error.argumentNull("parentTextForSpan");if(this.Ia.Rwf&&!this.Ia.Rwf.isMatch(ya,La))return!1;if(this.Ia.$1e){let Eb;if(({value:Eb}=ya.Tm(this.Ia.zql)).returnValue){if(!this.Ia.$1e.isMatch(Eb,La))return!1}else{let fc,mc;if(!({value:fc}=ya.Tm(this.Ia.zyh)).returnValue||!({value:mc}=ya.Tm(this.Ia.yyh)).returnValue||0>fc||0>mc||fc+mc>Qa.length||!this.Ia.$1e.isMatch(Qa.substr(fc,
mc),La))return!1}}if(this.Ia.azh){let Eb;if(!({value:Eb}=ya.Tm(this.Ia.zyh)).returnValue||!this.Ia.azh.isMatch(Eb,La))return!1}if(this.Ia.fqg){let Eb;if(!({value:Eb}=ya.Tm(this.Ia.yyh)).returnValue||!this.Ia.fqg.isMatch(Eb,La))return!1}return!0}}Object(h.a)(zb,"TextSpanFilter",null,[1014]);class Xb{constructor(ya,La){ya&&(this.annotations=La.annotations,this.zyh=ya.ga(0),this.yyh=ya.ga(1),this.zql=ya.ga(2),this.$1e=ya.ga(3)?La.M8(ya.ga(3)):null,this.Rwf=ya.ga(4)?La.M8(ya.ga(4)):null,this.azh=ya.ga(5)?
La.M8(ya.ga(5)):null,this.fqg=ya.ga(6)?La.M8(ya.ga(6)):null)}}Object(h.a)(Xb,"TextSpanFilterInit",null,[]);class Za{constructor(ya,La){ya&&(this.annotations=La.annotations,this.pca=ya.ga(0),this.B6e=ya.ga(1)?La.M8(ya.ga(1)):null)}}Object(h.a)(Za,"ValueFilterAnnotationFilterInit",null,[]);var Va=d(281);class tc{M8(ya,La){const Qa=ya.ga(0),Eb=new Va.a;Eb.uSa(ya,1,ya.count-1);switch(Qa){case 1:return new ea(new ra(Eb,La),0);case 2:return new ea(new ra(Eb,La),1);case 3:return new ea(new ra(Eb,La),2);
case 101:return new Xa(new Ka(Eb,La));case 103:return new Ba(new pa(Eb,La),0);case 104:return new Ba(new pa(Eb,La),1);case 105:return new Ba(new pa(Eb,La),2);case 106:return new Ba(new pa(Eb,La),3);case 107:return new Ba(new pa(Eb,La),4);case 108:return new Ba(new pa(Eb,La),5);case 109:return new Ba(new pa(Eb,La),6);case 201:return new qa(new Ya(Eb));case 202:return new ha(new Oa(Eb,La));case 301:return new F(new na(Eb,La),0);case 302:return new F(new na(Eb,La),1);case 303:return new F(new na(Eb,
La),2);case 304:return new F(new na(Eb,La),3);case 305:return new F(new na(Eb,La),4);case 401:return new Fb(new hc(Eb),0);case 402:return new Fb(new hc(Eb),1);case 403:return new Fb(new hc(Eb),2);case 404:return new ua(new Ga(Eb,La),0);case 405:return new ua(new Ga(Eb,La),1);case 406:return new ua(new Ga(Eb,La),2);case 407:return new ua(new Ga(Eb,La),3);case 501:return new ca(new T(Eb,La));case 502:return new ia(new Oa(Eb,La));case 601:return new fa(new Ma(Eb,La),0);case 602:return new fa(new Ma(Eb,
La),1);case 603:return new ma(new Ma(Eb,La));case 604:return new sa(new Oa(Eb,La),0);case 605:return new sa(new Oa(Eb,La),1);case 606:return new sa(new Oa(Eb,La),2);case 607:return new sa(new Oa(Eb,La),3);case 701:return new da(!1);case 702:return new da(!0);case 703:return new P(new Za(Eb,La),!1);case 704:return new P(new Za(Eb,La),!0);case 705:return new Z(new Za(Eb,La),!1);case 706:return new Z(new Za(Eb,La),!0);case 707:return new Ua(new za(Eb,La));case 901:return new zb(new Xb(Eb,La));case 1002:return new Da(new Oa(Eb,
La));case 1001:return new Tb(new vb(Eb,La));default:throw Error.argument("initData");}}}Object(h.a)(tc,"FilterFactory",null,[973]);var Kb=d(139);class Pa{constructor(ya){this.Ia=ya}get gy(){return this.Ia.gy}get RU(){return this.Ia.RU}get ssd(){return this.Ia.ssd}get iZc(){return this.Ia.iZc}load(ya,La){return this.qp(ya,ya?new ka("root",ya,La):La)}store(ya,La,Qa){this.BNb(ya,La,ya?new ka("root",ya,Qa):Qa,null)}qp(ya,La){if(!this.iZc&&!this.Ia.annotations.Jzb(this.gy,ya))throw Error.argument("input",
"Input value not of expected type");let Qa=this.Ia.AXf;for(;Qa;)ya=Qa.load(ya,La),Qa=Qa.next;return ya}BNb(ya,La,Qa,Eb){if(!this.ssd)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.iZc&&!this.Ia.annotations.Jzb(this.gy,ya))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ia.annotations.Jzb(this.RU,La))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ia.AXf.store(ya,La,Qa,Eb)}static iHf(ya,La,Qa,Eb){if(Qa===
Eb)return La;if(V.Annotations.TB(Qa)&&V.Annotations.TB(Eb)){Qa=V.Annotations.hEa(Qa);Eb=V.Annotations.hEa(Eb);const fc=new Kb.a(ya,Eb);for(const mc of La.items)Array.add(fc.items,Pa.iHf(ya,mc,Qa,Eb));return fc}if(Qa===V.Annotations.npa){if(Eb===V.Annotations.Waa)return La;if(Eb===V.Annotations.dZ)return La.toString()}else if(Qa===V.Annotations.Waa){if(Eb===V.Annotations.npa)return Math.floor(La);if(Eb===V.Annotations.dZ)return La.toString()}else if(Qa===V.Annotations.dZ){if(Eb===V.Annotations.npa)return parseInt(La);
if(Eb===V.Annotations.Waa)return parseFloat(La)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(h.a)(Pa,"AnnotationQuery",null,[1018]);class mb{constructor(){this.RU=this.gy=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}lEa(ya){if(this.next)return{returnValue:this.next,bpa:ya};if(ya){const La=ya.cJf;ya=ya.Bch;return{returnValue:La,bpa:ya}}return{returnValue:null,bpa:ya}}}Object(h.a)(mb,"AnnotationQueryStep",null,[1067]);class qc extends mb{constructor(ya){super();
this.Ia=ya}load(ya,La){La=this.Ia.query.qp(ya,La);if(V.Annotations.TB(this.gy)){var Qa=V.Annotations.hEa(this.gy);let fc=new Kb.a(this.Ia.annotations,Qa);if(V.Annotations.TB(this.Ia.query.RU)){if(ya.items.length!==La.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let mc=0,Mc=ya.items.length;mc<Mc;++mc)Array.add(fc.items,this.pJc(ya.items[mc],La.items[mc],Qa===V.Annotations.Waa))}else for(var Eb of ya.items)Array.add(fc.items,this.pJc(Eb,La,Qa===
V.Annotations.Waa));return fc}if(V.Annotations.TB(this.Ia.query.RU)){Eb=new Kb.a(this.Ia.annotations,this.gy);for(Qa of La.items)Array.add(Eb.items,this.pJc(ya,Qa,this.gy===V.Annotations.Waa));return Eb}return this.pJc(ya,La,this.gy===V.Annotations.Waa)}pJc(ya,La,Qa){ya=this.Vsb(ya,La);return Qa?ya:Math.floor(ya)}}Object(h.a)(qc,"NumericAnnotationQueryStep",mb,[]);class oc extends qc{constructor(ya){super(ya)}Vsb(ya,La){return ya+La}}Object(h.a)(oc,"AddAnnotationQueryStep",qc,[]);class ib extends mb{constructor(ya){super();
this.Ia=ya}load(ya,La){if(this.gy===V.Annotations.Mga&&this.Ia.query.RU===V.Annotations.Mga){let fc;if(({result:fc}=this.WDf(ya)).returnValue)return fc}if(V.Annotations.TB(this.gy)){var Qa=new Kb.a(this.Ia.annotations,V.Annotations.Mga);La=this.Ia.query.qp(ya,La);if(V.Annotations.TB(this.Ia.query.RU)){if(ya.items.length!==La.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let fc=0,mc=ya.items.length;fc<mc;++fc)Array.add(Qa.items,this.T0b(La.items[fc],
ya.items[fc]))}else for(var Eb of ya.items)Array.add(Qa.items,this.T0b(La,Eb));return Qa}Eb=this.Ia.query.qp(ya,La);if(V.Annotations.TB(this.Ia.query.RU)){La=new Kb.a(this.Ia.annotations,V.Annotations.Mga);for(Qa of Eb.items)Array.add(La.items,this.T0b(Qa,ya));return La}return this.T0b(Eb,ya)}}Object(h.a)(ib,"BinaryBooleanAnnotationQueryStep",mb,[]);class $a extends ib{constructor(ya){super(ya)}WDf(ya){return{returnValue:!ya,result:!1}}T0b(ya,La){return ya&&La}}Object(h.a)($a,"AndAnnotationQueryStep",
ib,[]);class Db{constructor(ya){ya&&(this.annotations=ya)}}Object(h.a)(Db,"AnnotationsOnlyQueryStepInit",null,[]);class Mb extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){La=this.Ia.query.qp(ya,La);ya=ya.clone();V.Annotations.TB(this.Ia.query.RU)?Array.addRange(ya.items,La.items):Array.add(ya.items,La);return ya}}Object(h.a)(Mb,"AppendAnnotationQueryStep",mb,[]);class ob extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){if(this.gy===V.Annotations.SM)return this.W3b(ya,La);const Qa=
new Kb.a(this.Ia.annotations,V.Annotations.SM);for(const Eb of ya.items)Array.add(Qa.items,this.W3b(Eb,La));return Qa}W3b(ya,La){const Qa=new D.a(this.Ia.annotations);Qa.ECa(ya);ya=new D.a(this.Ia.annotations);this.Ia.script.y8(null,new ka("Input",Qa,new ka("Output",ya,La)));return ya}}Object(h.a)(ob,"ApplyAnnotationQueryStep",mb,[]);class jc extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){if(this.gy===V.Annotations.SM)return La=this.W3b(ya,La),La.Tm(this.Ia.Qwf).returnValue||new Kb.a(this.Ia.annotations,
V.Annotations.SM),La;const Qa=new Kb.a(this.Ia.annotations,V.Annotations.SM);for(const Eb of ya.items)if(ya=this.W3b(Eb,La),({value:ya}=ya.Tm(this.Ia.Qwf)).returnValue)for(const fc of ya.items)Array.add(Qa.items,fc);return Qa}W3b(ya,La){const Qa=new D.a(this.Ia.annotations);Qa.ECa(ya);ya=new D.a(this.Ia.annotations);this.Ia.script.y8(null,new ka("Input",Qa,new ka("Output",ya,La)));return ya}}Object(h.a)(jc,"ApplyExpandAnnotationQueryStep",mb,[]);class Gb{constructor(ya,La){ya&&(this.annotations=La.annotations,
this.script=La.u9a(ya.ga(0)),this.Qwf=ya.ga(1))}}Object(h.a)(Gb,"ApplyExpandQueryStepInit",null,[]);class Gc{constructor(ya,La){ya&&(this.annotations=La.annotations,this.script=La.u9a(ya.ga(0)))}}Object(h.a)(Gc,"ApplyQueryStepInit",null,[]);class bc extends mb{constructor(ya){super();this.Ia=ya}load(ya){if(this.gy===V.Annotations.SM)return this.q2c(ya);const La=new Kb.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.pca));for(const Qa of ya.items)Array.add(La.items,this.q2c(Qa));
return La}store(ya,La,Qa,Eb){if(this.gy===V.Annotations.SM){var fc=La,mc=({bpa:Eb}=this.lEa(Eb)).returnValue;mc&&(fc=mc.store(V.Annotations.XK(this.q2c(ya)),La,Qa,Eb));ya.su(this.Ia.pca,fc)}else{var Mc=La;if(fc=({bpa:Eb}=this.lEa(Eb)).returnValue){Mc=new Kb.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.pca));for(mc of ya.items)Array.add(Mc.items,this.q2c(mc));Mc=fc.store(Mc,La,Qa,Eb)}La=Mc;if(La.items.length!==ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");
for(let nd=0,ba=ya.items.length;nd<ba;++nd)Qa=ya.items[nd],Qa.isReadOnly&&(Qa=Qa.clone(),ya.items[nd]=Qa),Qa.su(this.Ia.pca,La.items[nd])}return ya}q2c(ya){({value:ya}=ya.Tm(this.Ia.pca)).returnValue||(ya=this.Ia.annotations.P4i(this.Ia.pca));return ya}}Object(h.a)(bc,"AttrAnnotationQueryStep",mb,[]);class dc{constructor(ya,La){ya&&(this.annotations=La,this.pca=ya.ga(0))}}Object(h.a)(dc,"AttrQueryStepInit",null,[]);class Nb extends mb{constructor(ya){super();this.Ia=ya}load(ya){const La=new D.a(this.Ia.annotations);
La.ECa(ya);return this.Ia.module.execute(La)}}Object(h.a)(Nb,"CallModuleAnnotationQueryStep",mb,[]);class Ac{constructor(ya,La){ya&&(this.annotations=La.annotations,this.module=La.i9d(ya.ga(0)))}}Object(h.a)(Ac,"CallModuleQueryStepInit",null,[]);class jb extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){if(V.Annotations.TB(this.gy)){var Qa=this.Ia.query.qp(ya,La);La=new Kb.a(this.Ia.annotations,V.Annotations.dZ);let mc="string"===typeof Qa;for(var Eb of ya.items)if(mc)Array.add(La.items,Eb+
Qa);else for(var fc of Qa.items)Array.add(La.items,Eb+fc);return La}Eb=this.Ia.query.qp(ya,La);if("string"===typeof Eb)return ya+Eb;fc=new Kb.a(this.Ia.annotations,V.Annotations.dZ);for(Qa of Eb.items)Array.add(fc.items,ya+Qa);return fc}}Object(h.a)(jb,"ConcatAnnotationQueryStep",mb,[]);class Vb extends mb{constructor(ya){super();this.Ia=ya}load(ya){return Pa.iHf(this.Ia.annotations,ya,this.gy,this.RU)}}Object(h.a)(Vb,"ConvertAnnotationQueryStep",mb,[]);class Tc extends mb{constructor(){super()}load(ya){return ya.items.length}}
Object(h.a)(Tc,"CountAnnotationQueryStep",mb,[]);class wb extends qc{constructor(ya){super(ya)}Vsb(ya,La){return ya/La}}Object(h.a)(wb,"DivideAnnotationQueryStep",qc,[]);class Rb extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){La=new ka(this.Ia.awd,null,La);for(const Qa of ya.items)if(La.$Ud(Qa),this.Ia.query.qp(Qa,La))return!0;return!1}}Object(h.a)(Rb,"ExistsAnnotationQueryStep",mb,[]);class vc extends qc{constructor(ya){super(ya)}Vsb(ya,La){return Math.pow(ya,La)}}Object(h.a)(vc,"ExpAnnotationQueryStep",
qc,[]);class rd{constructor(ya,La){ya&&(this.Vsa=La.BC(ya.ga(0)))}}Object(h.a)(rd,"FeatureBundleNameQueryStepInit",null,[]);class rc extends mb{constructor(ya){super();this.Ia=ya}load(ya){if(V.Annotations.TB(this.gy)){const La=new Kb.a(this.Ia.annotations,this.Ia.annotations.o$a(V.Annotations.hEa(this.gy),this.Ia.Wsa));for(const Qa of ya.items)Array.add(La.items,Qa.QSa(this.Ia.Wsa));return La}return ya.QSa(this.Ia.Wsa)}store(ya,La,Qa,Eb){if(V.Annotations.TB(this.gy)){var fc=La,mc=({bpa:Eb}=this.lEa(Eb)).returnValue;
if(mc){fc=new Kb.a(this.Ia.annotations,this.Ia.annotations.o$a(V.Annotations.hEa(this.gy),this.Ia.Wsa));for(var Mc of ya.items)Array.add(fc.items,Mc.QSa(this.Ia.Wsa));fc=mc.store(fc,La,Qa,Eb)}La=fc;if(La.items.length!==ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let nd=0,ba=ya.items.length;nd<ba;++nd)Qa=ya.items[nd],Qa.isReadOnly&&(Qa=Qa.clone(),ya.items[nd]=Qa),Qa.VVe(this.Ia.Wsa,La.items[nd])}else mc=La,(Mc=({bpa:Eb}=this.lEa(Eb)).returnValue)&&
(mc=Mc.store(V.Annotations.XK(ya.QSa(this.Ia.Wsa)),La,Qa,Eb)),ya.VVe(this.Ia.Wsa,mc);return ya}}Object(h.a)(rc,"FieldAnnotationQueryStep",mb,[]);class cb{constructor(ya,La){ya&&(this.annotations=La,this.Wsa=ya.ga(0))}}Object(h.a)(cb,"FieldQueryStepInit",null,[]);class Wb extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){for(const Qa of ya.items)if(this.Ia.filter.isMatch(Qa,La))return Qa;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ya,La,Qa,Eb){let fc=
La,mc=-1;for(let nd=0,ba=ya.items.length;nd<ba;nd++)if(this.Ia.filter.isMatch(ya.items[nd],Qa)){mc=nd;break}if(0>mc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Mc=({bpa:Eb}=this.lEa(Eb)).returnValue;Mc&&(fc=Mc.store(V.Annotations.XK(ya.items[mc]),La,Qa,Eb));ya.items[mc]=fc;return ya}}Object(h.a)(Wb,"FirstItemMatchingAnnotationQueryStep",mb,[]);class Uc extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){La=new ka(this.Ia.awd,null,La);for(const Qa of ya.items)if(La.$Ud(Qa),
!this.Ia.query.qp(Qa,La))return!1;return!0}}Object(h.a)(Uc,"ForAllAnnotationQueryStep",mb,[]);class Ib extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){ya=La?La.ZSc(this.Ia.Vsa):null;if(!ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Vsa+'"');return ya}store(ya,La,Qa,Eb){ya=Qa?Qa.ZSc(this.Ia.Vsa):null;if(!ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Vsa+'"');let fc=La;const mc=({bpa:Eb}=this.lEa(Eb)).returnValue;mc&&(fc=mc.store(ya,
La,Qa,Eb));ya!==fc&&ya.ECa(fc);return ya}}Object(h.a)(Ib,"GetAnnotationQueryStep",mb,[]);class Vc{constructor(ya,La){this.pQh=ya;this.GZh=La}get cJf(){return this.pQh}get Bch(){return this.GZh}}Object(h.a)(Vc,"AnnotationQueryStoreContinuation",null,[1079]);class gc extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){return this.Ia.btd.qp(ya,La)?this.Ia.rEh.qp(ya,La):this.Ia.XPc?this.Ia.XPc.qp(ya,La):ya}store(ya,La,Qa,Eb){var fc=this.Ia.btd.qp(ya,Qa);this.next&&(Eb=new Vc(this.next,Eb));if(fc)return this.Ia.rEh.BNb(ya,
La,Qa,Eb);if(this.Ia.XPc)return this.Ia.XPc.BNb(ya,La,Qa,Eb);fc=La;let mc=null;Eb&&(mc=Eb.cJf,Eb=Eb.Bch);mc&&(fc=mc.store(V.Annotations.XK(ya),La,Qa,Eb));return fc}}Object(h.a)(gc,"IfAnnotationQueryStep",mb,[]);class rb{constructor(ya,La){ya&&(this.btd=La.VD(ya.ga(0)),this.rEh=La.VD(ya.ga(1)),this.XPc=ya.ga(2)?La.VD(ya.ga(2)):null)}}Object(h.a)(rb,"IfQueryStepInit",null,[]);class Zb{constructor(ya,La){ya&&(this.ODj=La.VD(ya.ga(0)),this.Rog=La.VD(ya.ga(1)))}}Object(h.a)(Zb,"IndexAndItemQueryStepInit",
null,[]);class Hc extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){const Qa=this.Ia.ODj.qp(ya,La);La=this.Ia.Rog.qp(ya,La);ya=ya.clone();if(0>Qa||Qa>ya.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(V.Annotations.TB(this.Ia.Rog.RU))for(let Eb=0;Eb<La.items.length;++Eb)Array.insert(ya.items,Qa+Eb,La.items[Eb]);else Array.insert(ya.items,Qa,La);return ya}}Object(h.a)(Hc,"InsertAtAnnotationQueryStep",mb,[]);class Ab extends mb{constructor(ya){super();
this.Ia=ya}load(ya,La){return!(!La||!La.ZSc(this.Ia.Vsa))}}Object(h.a)(Ab,"IsDefinedAnnotationQueryStep",mb,[]);class ad extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){La=this.cxb(ya,La);return ya.items[La]}store(ya,La,Qa,Eb){const fc=this.cxb(ya,Qa);let mc=La;const Mc=({bpa:Eb}=this.lEa(Eb)).returnValue;Mc&&(mc=Mc.store(V.Annotations.XK(ya.items[fc]),La,Qa,Eb));ya.items[fc]=mc;return ya}cxb(ya,La){La=this.Ia.query.qp(ya,La);if(0>La||La>=ya.items.length)throw Error.invalidOperation("Index out of range in Item store step");
return La}}Object(h.a)(ad,"ItemAnnotationQueryStep",mb,[]);class Bd extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){const Qa=new Kb.a(this.Ia.annotations,V.Annotations.hEa(this.gy));for(const Eb of ya.items)this.Ia.filter.isMatch(Eb,La)&&Array.add(Qa.items,Eb);return Qa}}Object(h.a)(Bd,"ItemsMatchingAnnotationQueryStep",mb,[]);class kd extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){La=this.cxb(ya,La);return ya.items[ya.items.length-La-1]}store(ya,La,Qa,Eb){const fc=this.cxb(ya,
Qa);let mc=La;const Mc=({bpa:Eb}=this.lEa(Eb)).returnValue;Mc&&(mc=Mc.store(V.Annotations.XK(ya.items[ya.items.length-fc-1]),La,Qa,Eb));ya.items[ya.items.length-fc-1]=mc;return ya}cxb(ya,La){La=this.Ia.query?this.Ia.query.qp(ya,La):0;if(0>La||La>=ya.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return La}}Object(h.a)(kd,"LastItemAnnotationQueryStep",mb,[]);class Be extends mb{constructor(ya){super();this.Ia=ya}load(ya){if(V.Annotations.TB(this.gy)){const La=
new Kb.a(this.Ia.annotations,V.Annotations.npa);for(const Qa of ya.items)Array.add(La.items,Qa.length);return La}return ya.length}}Object(h.a)(Be,"LengthAnnotationQueryStep",mb,[]);class Qd extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){if(V.Annotations.TB(this.gy)){const Qa=new Kb.a(this.Ia.annotations,V.Annotations.Mga);for(const Eb of ya.items)Array.add(Qa.items,this.Ia.filter.isMatch(Eb,La));return Qa}return this.Ia.filter.isMatch(ya,La)}}Object(h.a)(Qd,"MatchesAnnotationQueryStep",
mb,[]);class ae extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){return this.Ia.filter.isMatch(ya,La)}}Object(h.a)(ae,"MatchesAsListAnnotationQueryStep",mb,[]);class We extends qc{constructor(ya){super(ya)}Vsb(ya,La){return ya%La}}Object(h.a)(We,"ModuloAnnotationQueryStep",qc,[]);class $d extends qc{constructor(ya){super(ya)}Vsb(ya,La){return ya*La}}Object(h.a)($d,"MultiplyAnnotationQueryStep",qc,[]);class Re extends mb{constructor(ya){super();this.Ia=ya}load(ya){if(V.Annotations.TB(this.gy)){const La=
new Kb.a(this.Ia.annotations,V.Annotations.Mga);for(const Qa of ya.items)Array.add(La.items,!Qa);return La}return!ya}}Object(h.a)(Re,"NotAnnotationQueryStep",mb,[]);class Ta extends ib{constructor(ya){super(ya)}WDf(ya){return{returnValue:ya,result:!0}}T0b(ya,La){return ya||La}}Object(h.a)(Ta,"OrAnnotationQueryStep",ib,[]);class xb extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){const Qa=this.Ia.T_e.qp(ya,La);ya=this.Ia.s1b.qp(ya,La);La=new Kb.a(this.Ia.annotations,V.Annotations.npa);for(let Eb=
0;Eb<ya;++Eb)Array.add(La.items,Qa+Eb);return La}}Object(h.a)(xb,"RangeAnnotationQueryStep",mb,[]);class kc{constructor(ya,La){ya&&(this.annotations=La.annotations,this.filter=La.M8(ya.ga(0)))}}Object(h.a)(kc,"SingleFilterQueryStepInit",null,[]);class Nc{constructor(ya,La){ya&&(this.annotations=La.annotations,this.query=ya.ga(0)?La.VD(ya.ga(0)):null)}}Object(h.a)(Nc,"SingleOptionalQueryQueryStepInit",null,[]);class id{constructor(ya,La){ya&&(this.annotations=La.annotations,this.query=La.VD(ya.ga(0)))}}
Object(h.a)(id,"SingleQueryQueryStepInit",null,[]);class Ed{constructor(ya,La){ya&&(this.annotations=La.annotations,this.T_e=La.VD(ya.ga(0)),this.s1b=ya.ga(1)?La.VD(ya.ga(1)):null)}}Object(h.a)(Ed,"StartAndCountOrLengthQueryStepInit",null,[]);class Ja extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){let Qa;({BLa:La,length:Qa}=this.TUc(ya,La));const Eb=new Kb.a(this.Ia.annotations,ya.BU);for(let fc=0;fc<Qa;++fc)Array.add(Eb.items,ya.items[La+fc]);return Eb}store(ya,La,Qa,Eb){let fc,mc;({BLa:fc,
length:mc}=this.TUc(ya,Qa));var Mc=La;const nd=({bpa:Eb}=this.lEa(Eb)).returnValue;if(nd){Mc=new Kb.a(this.Ia.annotations,ya.BU);for(let ba=0;ba<mc;++ba)Array.add(Mc.items,ya.items[fc+ba]);Mc=nd.store(Mc,La,Qa,Eb)}La=Mc;for(Qa=0;Qa<mc;++Qa)Array.removeAt(ya.items,fc);for(let ba=0,Aa=La.items.length;ba<Aa;++ba)Array.insert(ya.items,fc+ba,La.items[ba]);return ya}TUc(ya,La){let Qa;Qa=this.Ia.T_e.qp(ya,La);if(0>Qa)throw Error.invalidOperation("Invalid start index in Sublist() query step");La=this.Ia.s1b?
this.Ia.s1b.qp(ya,La):ya.items.length-Qa;if(0>La||Qa+La>ya.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{BLa:Qa,length:La}}}Object(h.a)(Ja,"SublistAnnotationQueryStep",mb,[]);class db extends mb{constructor(ya){super();this.Ia=ya}load(ya,La){if(V.Annotations.TB(this.gy)){const Qa=new Kb.a(this.Ia.annotations,V.Annotations.dZ);for(let Eb=0,fc=ya.items.length;Eb<fc;++Eb)Array.add(Qa.items,this.getSubstring(ya.items[Eb],La));return Qa}return this.getSubstring(ya,
La)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(ya,La){let Qa;({BLa:La,length:Qa}=this.TUc(ya,La));return ya.substr(La,Qa)}TUc(ya,La){let Qa;Qa=this.Ia.T_e.qp(ya,La);if(0>Qa)throw Error.invalidOperation("Invalid start index in Substring() query step");La=this.Ia.s1b?this.Ia.s1b.qp(ya,La):ya.length-Qa;if(0>La||Qa+La>ya.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{BLa:Qa,length:La}}}
Object(h.a)(db,"SubstringAnnotationQueryStep",mb,[]);class zc extends qc{constructor(ya){super(ya)}Vsb(ya,La){return ya-La}}Object(h.a)(zc,"SubtractAnnotationQueryStep",qc,[]);class Hd extends mb{constructor(ya){super();this.Ia=ya}load(ya){const La=new Kb.a(this.Ia.annotations,V.Annotations.dZ);for(let Qa=0;Qa<ya.length;++Qa)Array.add(La.items,ya.charAt(Qa).toString());return La}}Object(h.a)(Hd,"ToCharListAnnotationQueryStep",mb,[]);class Ad extends mb{constructor(ya){super();this.Ia=ya}load(ya){const La=
new Kb.a(this.Ia.annotations,this.gy);Array.add(La.items,ya);return La}}Object(h.a)(Ad,"ToListAnnotationQueryStep",mb,[]);class Kd extends mb{constructor(ya){super();this.Ia=ya}load(){return this.Ia.value}}Object(h.a)(Kd,"ValueAnnotationQueryStep",mb,[]);class Pc{constructor(ya,La){if(ya){var Qa=ya.ga(0),Eb=1;this.value=({W3:Eb}=La.usa(Qa,ya,Eb,null,null,null)).returnValue;V.Annotations.Xbb(this.value)}}}Object(h.a)(Pc,"ValueQueryStepInit",null,[]);class tf{constructor(ya,La){ya&&(this.awd=La.BC(ya.ga(0)),
this.query=La.VD(ya.ga(1)))}}Object(h.a)(tf,"VarNameAndQueryQueryStepInit",null,[]);class xe{constructor(ya,La){this.Dcf=null;if(ya){this.annotations=La.annotations;var Qa=0;this.gy=ya.ga(Qa);++Qa;this.RU=ya.ga(Qa);++Qa;this.ssd=1===ya.ga(Qa);++Qa;this.iZc=1===ya.ga(Qa);++Qa;var Eb=ya.ga(Qa);++Qa;if(Eb){var fc=Qa,mc=Qa+Eb,Mc=Qa+2*Eb;Qa+=3*Eb;var nd=ya.count-Qa,ba=null;for(let Wa=0;Wa<Eb;++Wa){var Aa=Qa+ya.ga(Mc+Wa);const gb=(Wa===Eb-1?nd:ya.ga(Mc+Wa+1))-ya.ga(Mc+Wa),nb=new Va.a;nb.uSa(ya,Aa,gb);Aa=
xe.Sej(ya.ga(mc+Wa),nb,La);Aa.gy=ya.ga(fc+Wa);Aa.RU=Wa===Eb-1?this.RU:ya.ga(fc+Wa+1);ba?ba.next=Aa:this.Dcf=Aa;ba=Aa}}}}get AXf(){return this.Dcf}static Sej(ya,La,Qa){switch(ya){case 1:return new Ib(new rd(La,Qa));case 2:return new Ab(new rd(La,Qa));case 3:return new bc(new dc(La,Qa.annotations));case 4:return new rc(new cb(La,Qa.annotations));case 5:return new gc(new rb(La,Qa));case 6:return new Qd(new kc(La,Qa));case 43:return new ae(new kc(La,Qa));case 45:return new ob(new Gc(La,Qa));case 49:return new jc(new Gb(La,
Qa));case 46:return new Kd(new Pc(La,Qa.annotations));case 51:return new Nb(new Ac(La,Qa));case 52:return new xb(new Ed(La,Qa));case 53:return new Vb(new Db(Qa.annotations));case 13:return new ad(new id(La,Qa));case 14:return new kd(new Nc(La,Qa));case 15:return new Tc;case 18:return new Wb(new kc(La,Qa));case 16:return new Uc(new tf(La,Qa));case 17:return new Rb(new tf(La,Qa));case 22:return new Hc(new Zb(La,Qa));case 24:return new Mb(new id(La,Qa));case 26:return new Ja(new Ed(La,Qa));case 27:return new Bd(new kc(La,
Qa));case 30:return new Ad(new Db(Qa.annotations));case 31:return new db(new Ed(La,Qa));case 32:return new jb(new id(La,Qa));case 47:return new Be(new Db(Qa.annotations));case 48:return new Hd(new Db(Qa.annotations));case 34:return new oc(new id(La,Qa));case 35:return new zc(new id(La,Qa));case 36:return new $d(new id(La,Qa));case 37:return new wb(new id(La,Qa));case 38:return new We(new id(La,Qa));case 39:return new vc(new id(La,Qa));case 40:return new $a(new id(La,Qa));case 41:return new Ta(new id(La,
Qa));case 42:return new Re(new Db(Qa.annotations));default:throw Error.argument("currStepInitData");}}}Object(h.a)(xe,"AnnotationQueryInit",null,[]);class ef{constructor(ya){this.Ia=ya}execute(ya,La){this.y8(ya,ya?new ka("root",ya,La):La)}y8(ya,La){for(const Qa of this.Ia.commands)La=Qa.execute(ya,La)}}Object(h.a)(ef,"AnnotationScript",null,[1017]);class Id{constructor(ya){this.Ia=ya}execute(ya,La){const Qa=this.Ia.wHj.qp(ya,La),Eb=this.Ia.qCk.qp(ya,La);this.Ia.script.y8(ya,new ka("Input",Qa,new ka("Output",
Eb,La)));return La}}Object(h.a)(Id,"ApplyAnnotationScriptCommand",null,[1075]);class qe{constructor(ya,La){ya&&(this.wHj=La.VD(ya.ga(0)),this.qCk=La.VD(ya.ga(1)),this.script=La.u9a(ya.ga(2)))}}Object(h.a)(qe,"ApplyScriptCommandInit",null,[]);class jg{constructor(ya){this.Ia=ya}execute(ya,La){const Qa=this.Ia.WTe.qp(ya,La);this.Ia.M2c.BNb(ya,Qa,La,null);return La}}Object(h.a)(jg,"AssignAnnotationScriptCommand",null,[1075]);class of{constructor(ya){this.Ia=ya}execute(ya,La){const Qa=this.Ia.M2c.qp(ya,
La);ya=this.Ia.WTe.qp(ya,La);Qa!==ya&&Qa.ECa(ya);return La}}Object(h.a)(of,"CopyAnnotationScriptCommand",null,[1075]);class Cb{constructor(ya){this.Ia=ya}execute(ya,La){let Qa=this.Ia.yoe.qp(ya,La);if(this.Ia.yoe.ssd){Qa=V.Annotations.XK(Qa);var Eb=new ka(this.Ia.Vsa,null,La);for(let mc=0,Mc=Qa.items.length;mc<Mc;++mc){var fc=this.dUf(ya,Qa.items[mc],Eb);if(0>this.Ia.Pmd)Qa.items[mc]=fc;else if(({value:fc}=fc.Tm(this.Ia.Pmd)).returnValue)Qa.items[mc]=fc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.Ia.yoe.BNb(ya,Qa,La,null)}else{Eb=new ka(this.Ia.Vsa,null,La);for(let mc=0,Mc=Qa.items.length;mc<Mc;++mc)this.dUf(ya,Qa.items[mc],Eb)}return La}dUf(ya,La,Qa){let Eb;0>this.Ia.Pmd?Eb=V.Annotations.XK(La):(Eb=new D.a(this.Ia.annotations),Eb.su(this.Ia.Pmd,La));Qa.$Ud(Eb);this.Ia.Eji.y8(ya,Qa);return Eb}}Object(h.a)(Cb,"EnumerateAnnotationScriptCommand",null,[1075]);class Df{constructor(ya,La){ya&&(this.annotations=La.annotations,this.Vsa=La.BC(ya.ga(0)),this.yoe=La.VD(ya.ga(1)),this.Eji=La.u9a(ya.ga(2)),
this.Pmd=ya.ga(3))}}Object(h.a)(Df,"EnumerateScriptCommandInit",null,[]);class Bf{constructor(ya){this.Ia=ya}execute(ya,La){this.Ia.btd.qp(ya,La)?this.Ia.aAl.y8(ya,La):this.Ia.NVf&&this.Ia.NVf.y8(ya,La);return La}}Object(h.a)(Bf,"IfAnnotationScriptCommand",null,[1075]);class qg{constructor(ya,La){ya&&(this.btd=La.VD(ya.ga(0)),this.aAl=La.u9a(ya.ga(1)),this.NVf=ya.ga(2)?La.u9a(ya.ga(2)):null)}}Object(h.a)(qg,"IfScriptCommandInit",null,[]);class vd{constructor(ya,La){ya&&(this.annotations=La.annotations,
this.M2c=La.VD(ya.ga(0)),this.WTe=La.VD(ya.ga(1)))}}Object(h.a)(vd,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class $f{constructor(ya){this.Ia=ya}execute(ya,La){const Qa=this.Ia.WTe.qp(this.Ia.M2c.qp(ya,La),La);this.Ia.M2c.BNb(ya,Qa,La,null);return La}}Object(h.a)($f,"ModifyAnnotationScriptCommand",null,[1075]);class ng{constructor(ya){this.Ia=ya}execute(ya,La){const Qa=new D.a(this.Ia.annotations);this.Ia.query&&Qa.ECa(this.Ia.query.qp(ya,La));return La=new ka(this.Ia.Vsa,Qa,La)}}Object(h.a)(ng,
"NewAnnotationScriptCommand",null,[1075]);class Qe{constructor(ya,La){ya&&(this.annotations=La.annotations,this.Vsa=La.BC(ya.ga(0)),this.query=ya.ga(1)?La.VD(ya.ga(1)):null)}}Object(h.a)(Qe,"NewScriptCommandInit",null,[]);class Gf{constructor(ya){this.Ia=ya}execute(ya,La){ya=this.Ia.query.qp(ya,La);if(this.Ia.query.RU===V.Annotations.SM)ya.Jld(this.Ia.pca);else for(const Qa of ya.items)Qa.Jld(this.Ia.pca);return La}}Object(h.a)(Gf,"RemoveAnnotationScriptCommand",null,[1075]);class Jf{constructor(ya,
La){ya&&(this.annotations=La.annotations,this.query=La.VD(ya.ga(0)),this.pca=ya.ga(1))}}Object(h.a)(Jf,"RemoveScriptCommandInit",null,[]);class xh{constructor(ya,La){if(ya){var Qa=0,Eb=ya.ga(Qa);++Qa;if(Eb){var fc=Qa,mc=Qa+Eb;Qa+=2*Eb;var Mc=ya.count-Qa;this.commands=Array(Eb);for(let nd=0;nd<Eb;++nd){const ba=Qa+ya.ga(mc+nd),Aa=(nd===Eb-1?Mc:ya.ga(mc+nd+1))-ya.ga(mc+nd),Wa=new Va.a;Wa.uSa(ya,ba,Aa);this.commands[nd]=xh.Oej(ya.ga(fc+nd),Wa,La)}}}}static Oej(ya,La,Qa){switch(ya){case 1:return new jg(new vd(La,
Qa));case 2:return new $f(new vd(La,Qa));case 3:return new Gf(new Jf(La,Qa));case 6:return new ng(new Qe(La,Qa));case 7:return new Cb(new Df(La,Qa));case 8:return new Bf(new qg(La,Qa));case 9:return new of(new vd(La,Qa));case 10:return new Id(new qe(La,Qa));default:throw Error.argument("initData");}}}Object(h.a)(xh,"AnnotationScriptInit",null,[]);var he=d(709);class de{constructor(ya){this.ZH=ya;this.eN=0}BY(){const ya=this.ZH.ru(this.eN,4);this.eN+=4;return ya}get GZb(){return this.ZH}get offset(){return this.eN}set offset(ya){this.eN=
ya}}Object(h.a)(de,"ByteArrayReader",null,[]);class xf{constructor(){this.KC=null;this.VAg=this.rz=0}ga(ya){if(0>ya||ya>=this.rz)throw Error.argumentOutOfRange("index");return this.KC.ru(this.VAg+4*ya,4)}get count(){return this.rz}static MEi(ya,La,Qa){const Eb=new xf;Eb.KC=ya;Eb.VAg=La;Eb.rz=Qa;return Eb}}Object(h.a)(xf,"ReadOnlyListOverByteArray",null,[1011]);class re{constructor(ya,La){this.Kyg=this.ryg=!1;this.Gr=this.Iwa=this.Ype=this.Vyg=null;try{this.Gr=La.annotations;const Qa=La.ESa(ya.ga(0)),
Eb=new de(Qa);if(-914743053!==Eb.BY())throw Error.argument("Input does not represent a flat lexicon");this.ryg=1===Eb.BY();this.Kyg=1===Eb.BY();const fc=Eb.BY();Eb.offset+=fc;const mc=Eb.BY();this.Ype=re.NDk(Eb,mc,this.Gr);const Mc=Eb.BY();this.Vyg=re.$Dk(Eb,Mc);const nd=Eb.BY();this.Iwa=new he.a(Eb.GZb,Eb.offset);Eb.offset+=nd}catch(Qa){throw Error.argument("initData");}}get trie(){return this.Iwa}P5i(ya){return"i"===ya&&this.Kyg?"\u0130":ya.toUpperCase()}rje(){return this.ryg}v4i(ya){let La;La=
new Kb.a(this.Gr,V.Annotations.SM);if(1!==ya)if(0===ya)ya=new D.a(this.Gr),Array.add(La.items,ya);else if(ya&1073741824){ya=this.Vyg[ya&-1073741825];for(let Eb=0;Eb<ya.length;++Eb){var Qa=ya[Eb];Qa=0===Qa?new D.a(this.Gr):this.Ype[Qa-2];Array.add(La.items,Qa)}}else Array.add(La.items,this.Ype[ya-2]);return{returnValue:!0,r0j:La}}static NDk(ya,La,Qa){if(La%4)throw Error.argument("reader");const Eb=xf.MEi(ya.GZb,ya.offset,La/4);ya.offset+=La;ya=[];for(La=0;La<Eb.count;){const fc=({W3:La}=Qa.usa(V.Annotations.SM,
Eb,La,null,null,null)).returnValue;Array.add(ya,fc)}return ya}static $Dk(ya,La){La=ya.offset+La;const Qa=[];for(;ya.offset<La;){const Eb=ya.BY(),fc=Array(Eb);for(let mc=0;mc<Eb;++mc){const Mc=ya.BY();fc[mc]=Mc}Array.add(Qa,fc)}return Qa}}Object(h.a)(re,"RawFlatLexicon",null,[1016]);var Ih=d(699),Le=d(700);class Cd{constructor(ya){if(null==ya)throw Error.argumentNull("base64String");const La=ya.length;if(La%4)throw Error.argument("base64String's length must be a multiple of 4");this.rz=.75*La;this.lva=
Array(Math.ceil(this.rz/4));ya.endsWith("==")?this.rz-=2:ya.endsWith("=")&&--this.rz;let Qa=0;for(let Eb=0;Eb<La;Eb+=4){const fc=Cd.Gnd[ya.charCodeAt(Eb)-43]<<18|Cd.Gnd[ya.charCodeAt(Eb+1)-43]<<12|Cd.Gnd[ya.charCodeAt(Eb+2)-43]<<6|Cd.Gnd[ya.charCodeAt(Eb+3)-43];let mc=fc>>16&255;this.lva[Math.floor(Qa/4)]|=mc<<Qa%4*8;++Qa;mc=fc>>8&255;this.lva[Math.floor(Qa/4)]|=mc<<Qa%4*8;++Qa;mc=fc&255;this.lva[Math.floor(Qa/4)]|=mc<<Qa%4*8;++Qa}}get length(){return this.rz}ga(ya){if(0>ya||ya>=this.rz)throw Error.argumentOutOfRange("i");
return this.V_f(ya)}ru(ya,La){if(0>ya||0>La||ya+La>this.rz)throw Error.argument("Bad range");let Qa=0;for(let Eb=0;Eb<La;++Eb)Qa|=this.V_f(ya+Eb)<<8*Eb;return Qa}vSk(ya,La){let Qa=0,Eb=0,fc=Math.floor(ya/8);for(ya%=8;Eb<La;){const mc=8-ya>La-Eb?La-Eb:8-ya,Mc=this.ga(fc);Qa|=(Mc>>ya&~(255<<mc))<<Eb;Eb+=mc;++fc;ya=0}return Qa}V_f(ya){return this.lva[Math.floor(ya/4)]>>ya%4*8&255}}Cd.Gnd=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(h.a)(Cd,"ByteArray",null,[]);class Lc{constructor(ya,La,Qa){this.uy=ya;this.N9j=La;this.hdk=Qa;this.CBg=Array(ya.b?ya.b.length:0);this.ICe=new Ih.a(new Le.a(this.ESa(this.uy.s)));this.IX=Array(ya.t.length);this.dOh=new V.Annotations(this.BSa(0),this)}get annotations(){return this.dOh}get UPi(){return this.uy.d}tej(){if(!(""in this.uy.m))throw Error.argument("name","Unrecognized module");return this.i9d(this.uy.m[""])}ESa(ya){if(0>
ya||!this.uy.b||ya>=this.uy.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.CBg[ya]||(this.CBg[ya]=new Cd(this.uy.b[ya]))}BC(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.uy.t[ya])throw Error.argument("blobID","Requested blob is not a string");if(null==this.IX[ya]){const La=this.BSa(ya).ga(0);this.IX[ya]=this.ICe.BC(La)}return this.IX[ya]}q6f(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.uy.t[ya])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.IX[ya]){var La=this.BSa(ya);const Qa=this.BC(La.ga(0));La=1===La.ga(1);this.IX[ya]=new RegExp(Qa,La?"i":"")}return this.IX[ya]}Zij(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.uy.t[ya])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}i9d(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.uy.t[ya])throw Error.argument("blobID","Requested blob is not an NL module");
return this.IX[ya]||(this.IX[ya]=this.hdk.Jej(this.BSa(ya),this))}VD(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.uy.t[ya])throw Error.argument("blobID","Requested blob is not an annotation query");return this.IX[ya]||(this.IX[ya]=new Pa(new xe(this.BSa(ya),this)))}u9a(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.uy.t[ya])throw Error.argument("blobID","Requested blob is not an annotation script");return this.IX[ya]||
(this.IX[ya]=new ef(new xh(this.BSa(ya),this)))}M8(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.uy.t[ya])throw Error.argument("blobID","Requested blob is not a filter");return this.IX[ya]||(this.IX[ya]=this.N9j.M8(this.BSa(ya),this))}Jhj(ya){if(1>ya||ya>=this.uy.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.uy.t[ya])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.IX[ya]||(this.IX[ya]=new re(this.BSa(ya),
this))}BSa(ya){const La=this.uy.n[ya];ya=(ya<this.uy.t.length-1?this.uy.n[ya+1]:this.uy.n.length)-La;if(0>La||0>ya||La+ya>this.uy.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+La+","+ya+")");const Qa=new Va.a;Qa.pRc(this.uy.n,La,ya);return Qa}}Object(h.a)(Lc,"ObjectFetcher",null,[972]);class Td{constructor(ya,La,Qa){if(!ya)throw Error.argumentNull("prediction");if(!La)throw Error.argumentNull("fieldNames");if(!Qa)throw Error.argumentNull("values");if(La.length!==
Qa.length)throw Error.argument("values","fieldNames and values do not have same length");this.wZh=ya;this.jdb=La;this.bgb=Qa}get prediction(){return this.wZh}get aWf(){return this.jdb.length}z7d(ya){return 0<=ya&&ya<this.jdb.length?this.jdb[ya]:null}eb(ya){return 0<=ya&&ya<this.bgb.length?this.bgb[ya]:null}}Object(h.a)(Td,"PredictionData",null,[]);class Ge{constructor(ya,La){if(!ya)throw Error.argumentNull("predictions");if(!La)throw Error.argumentNull("tokenAttributes");this.Ifk=ya;this.tjk=La}U9d(){return this.Ifk}h_f(){return this.tjk}}
Object(h.a)(Ge,"PredictionDataWithTokenAttributes",null,[]);class Xc{constructor(ya,La){this.prediction=null;this.score=0;this.prediction=ya;this.score=La}}Object(h.a)(Xc,"PredictionWithScore",null,[]);class jf{constructor(ya,La){if(!ya)throw Error.argumentNull("predictions");if(!La)throw Error.argumentNull("attributes");this.xZh=ya;this.AOh=La}U9d(){return this.xZh}h_f(){return this.AOh}}Object(h.a)(jf,"PredictionsWithTokenAttributes",null,[]);class Mh{constructor(ya,La,Qa){if(!ya)throw Error.argumentNull("attributeName");
if(!La)throw Error.argumentNull("fieldNames");if(!Qa)throw Error.argumentNull("values");if(La.length!==Qa.length)throw Error.argument("values","fieldNames and values do not have same length");this.zOh=ya;this.jdb=La;this.bgb=Qa}get attributeName(){return this.zOh}get aWf(){return this.jdb.length}z7d(ya){return 0<=ya&&ya<this.jdb.length?this.jdb[ya]:null}eb(ya){return 0<=ya&&ya<this.bgb.length?this.bgb[ya]:null}}Object(h.a)(Mh,"TokenAttributes",null,[]);var bd=d(14),Bc=d(22);class Hf{constructor(ya,
La,Qa,Eb,fc){this.Kvc=0;this.j7e=null;this.Lvc=this.dQb=0;this.Iwd=this.wmb=this.iba=this.eQb=null;this.k7e=0;this.m4a=this.Py=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.jK=ya;this.vLh=this.ALh=La;this.uLh=this.xLh=Qa;this.Gvc=this.wLh=Eb;this.Hvc=this.yLh=fc}Fwd(){this.Lvc=0;return this.cQb}cQb(){if(!(this.Lvc<this.Gvc))return this.Jvc;this.eQb=this.vLh.items[this.Lvc+this.uLh];this.iba=new D.a(this.jK.Ia.annotations);
1!==this.Gvc&&this.jK.Ia.G9b||this.iba.ECa(this.eQb);if(0<=this.jK.Ia.Xdd){({value:this.wmb}=this.iba.Tm(this.jK.Ia.Xdd)).returnValue?this.wmb=this.wmb.XK():this.wmb=new Kb.a(this.jK.Ia.annotations,V.Annotations.SM);this.Iwd=this.Hvc.items;this.k7e=this.Iwd.length;for(this.Kvc=0;this.Kvc<this.k7e;++this.Kvc)this.j7e=this.Iwd[this.Kvc],Array.add(this.wmb.items,this.j7e);this.iba.su(this.jK.Ia.Xdd,this.wmb)}else 0<=this.jK.Ia.ZZe?this.iba.su(this.jK.Ia.ZZe,this.Hvc.items[0]):0<=this.jK.Ia.gTd?this.iba.su(this.jK.Ia.gTd,
!0):this.jK.Ia.Alg?this.Hvc.items[0].WQc((ya,La)=>this.iba.su(ya,La)):(this.iba.ECa(this.Hvc.items[0]),1!==this.Gvc&&this.jK.Ia.G9b||(({value:this.dQb}=this.eQb.Tm(this.jK.Ia.KS)).returnValue&&this.iba.su(this.jK.Ia.KS,this.dQb),({value:this.dQb}=this.eQb.Tm(this.jK.Ia.lW)).returnValue&&this.iba.su(this.jK.Ia.lW,this.dQb),this.eQb.Tm(this.jK.Ia.$Pa).returnValue&&this.iba.su(this.jK.Ia.$Pa,this.dQb)));this.Py=this.iba;this._state=2;return this.Hwd}Jvc(){this._state=3}Gwd(){this.Lvc++;return this.cQb}Hwd(){return 1<
this.Gvc&&this.jK.Ia.G9b?this.Jvc:this.Gwd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Hf(this.jK,this.ALh,this.xLh,this.wLh,this.yLh)).getEnumerator()}[Symbol.iterator](){return Object(Bc.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.m4a=this.Fwd());for(;1===this._state;)this.m4a=this.m4a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Py}}
Object(h.a)(Hf,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[106,142,144]);class Me{constructor(ya,La,Qa){this.nec=this.WAg=0;this.XBb=null;this.TCe=this.Mqe=this.KBb=this.o4c=this.Ore=0;this.o5c=!1;this.tze=ya;this.jDe=La;this.eek=Qa}R4f(){null===this.XBb&&({zCh:this.XBb,Hdg:this.Ore,length:this.o4c,rWi:ya}=this.tze.a9f(this.jDe.items[this.nec],this.eek),this.o5c=ya||this.o5c);if(this.KBb<this.o4c){var ya=this.XBb.charAt(this.Ore+
this.KBb);++this.KBb;return{returnValue:!0,ch:ya}}if(this.nec===this.jDe.items.length-1)return{returnValue:!1,ch:"\x00"};++this.nec;this.KBb=0;this.XBb=null;return{returnValue:!0,ch:" "}}VQe(ya,La){this.KBb===this.o4c&&this.XBb&&(this.TCe=La,this.Mqe=this.nec-this.WAg+1)}w3k(ya){if(0>ya||ya>=this.jDe.items.length)throw Error.argumentOutOfRange("iToken");this.nec=this.WAg=ya;this.XBb=null;this.Mqe=this.KBb=this.o4c=this.Ore=0;this.TCe=-1;this.o5c=!1}Edj(){return{Zmi:this.Mqe,LZj:this.TCe,eWi:this.o5c}}}
Object(h.a)(Me,"TriePrefixVisitor",null,[1030]);class Tf{constructor(ya){this.Ia=ya}execute(ya){if(!({value:Qa}=ya.Tm(this.Ia.Mra)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let La;({value:La}=ya.Tm(this.Ia.cCa)).returnValue||(La=null);var Qa=this.d4i(Qa,La);ya=V.Annotations.XK(ya);ya.su(this.Ia.Mra,Qa);return ya}d4i(ya,La){let Qa=null;const Eb=this.Ia.flatLexicon.trie,fc=new Me(this,ya,La);let mc=null;this.Ia.flatLexicon.rje()&&(mc=Object(bd.a)(this.Ia.flatLexicon,
this.Ia.flatLexicon.P5i,"getCaseInsensitiveForm"));let Mc=0,nd;var ba;let Aa;for(;Mc<ya.items.length;){const Wa=ya.items[Mc];fc.w3k(Mc);Eb.xKh(fc,mc);({Zmi:nd,LZj:ba,eWi:Aa}=fc.Edj());if(0<nd){({r0j:ba}=this.Ia.flatLexicon.v4i(ba));for(let gb of this.hGi(ya,Mc,nd,ba)){1<nd&&this.Ia.G9b&&this.NGi(ya,La,Mc,Wa,nd,Aa,gb);if(!Qa)for(Qa=new Kb.a(this.Ia.annotations,V.Annotations.SM),ba=0;ba<Mc;++ba)Array.add(Qa.items,ya.items[ba]);Array.add(Qa.items,gb)}Mc+=nd}else Qa&&Array.add(Qa.items,Wa),++Mc}return Qa||
ya}NGi(ya,La,Qa,Eb,fc,mc,Mc){if(mc)mc=!0;else if(this.Ia.hlg){mc=!1;var nd=-1;for(var ba=0;ba<fc;ba++){var Aa=ya.items[Qa+ba];let lc;var Wa=void 0;if(!({value:lc}=Aa.Tm(this.Ia.KS)).returnValue||!({value:Wa}=Aa.Tm(this.Ia.lW)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<ba){if(lc>nd+1){mc=!0;break}if(0>nd||null===La||nd>=La.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==La.charAt(nd)){mc=!0;break}}nd=lc+Wa}}else mc=!1;if(mc){Wa=new Sys.StringBuilder;for(mc=0;mc<fc;++mc)({zCh:nd,Hdg:ba,length:Aa}=this.a9f(ya.items[Qa+mc],La)),0<mc&&Wa.append(" "),Wa.append(nd.substr(ba,Aa));Mc.su(this.Ia.$Pa,Wa.toString())}ya=ya.items[Qa+fc-1];let gb,nb;({value:Eb}=Eb.Tm(this.Ia.KS)).returnValue&&({value:gb}=ya.Tm(this.Ia.KS)).returnValue&&({value:nb}=ya.Tm(this.Ia.lW)).returnValue?(Mc.su(this.Ia.KS,Eb),Mc.su(this.Ia.lW,gb+nb-Eb)):(Mc.Jld(this.Ia.KS),Mc.Jld(this.Ia.lW))}hGi(ya,
La,Qa,Eb){return new Hf(this,ya,La,Qa,Eb)}a9f(ya,La){let Qa,Eb;if(({value:Qa}=ya.Tm(this.Ia.$Pa)).returnValue)Eb=!0,La=0,ya=Qa.length;else{Eb=!1;if(null===La)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Qa=La;if(!({value:La}=ya.Tm(this.Ia.KS)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:ya}=ya.Tm(this.Ia.lW)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>La||0>ya||La+ya>Qa.length)throw Error.argument("Token start/length values out of range","token");}return{zCh:Qa,Hdg:La,length:ya,rWi:Eb}}}Object(h.a)(Tf,"FlatLexiconNLModule",null,[1010]);class Sd{constructor(ya,La){this.gTd=this.Xdd=this.ZZe=this.$Pa=this.lW=this.KS=this.cCa=this.Mra=0;this.Alg=this.hlg=this.G9b=!1;this.flatLexicon=null;this.annotations=La.annotations;let Qa=0;try{this.Mra=ya.ga(Qa),++Qa,this.cCa=ya.ga(Qa),++Qa,this.KS=ya.ga(Qa),++Qa,this.lW=ya.ga(Qa),++Qa,this.$Pa=ya.ga(Qa),
++Qa,this.ZZe=ya.ga(Qa),++Qa,this.Xdd=ya.ga(Qa),++Qa,this.gTd=ya.ga(Qa),++Qa,this.G9b=1===ya.ga(Qa),++Qa,this.hlg=1===ya.ga(Qa),++Qa,this.Alg=1===ya.ga(Qa),++Qa,this.flatLexicon=La.Jhj(ya.ga(Qa))}catch(Eb){throw Error.argument("initData");}}}Object(h.a)(Sd,"FlatLexiconNLModuleInit",null,[]);class lf{constructor(){this.F8b=0;this.W3d=null;this.Vpc=0}}Object(h.a)(lf,"FeatureGenStackRec",null,[]);class fb{constructor(ya){this.T2e=Array(ya);this.HOb=Array(ya);this.h0e=[];this.Lzh=[]}}Object(h.a)(fb,"TokenStringLattice",
null,[]);const Qb=(ya,La,Qa)=>{for(let Eb=0;Eb<ya.length;Eb++)Qa=La(Qa,ya[Eb]);return Qa},ac=(ya,La)=>{const Qa=Array(ya.length);for(let Eb=0;Eb<ya.length;Eb++)Qa[Eb]=La(ya[Eb]);return Qa},Jc=(ya,La)=>{La=Array(Math.min(La,ya.length));for(let Qa=0;Qa<La.length;Qa++)La[Qa]=ya[Qa];return La},pd=(ya,La)=>{const Qa=[];for(const Eb of ya)La(Eb)&&Array.add(Qa,Eb);return Qa};class qd{constructor(ya,La){this.key=ya;this.value=La}}Object(h.a)(qd,"KeyValuePair",null,[]);const sd=(ya,La)=>({returnValue:La in
ya,value:ya[La]}),ze=ya=>{const La=[];for(let Qa in ya){const Eb=new qd(Qa,ya[Qa]);Array.add(La,Eb)}return La};class Wd{constructor(ya){this.$8f=this.Wnj;this.Ia=ya;this.U8c=this.ize=this.jze=0;for(const La of this.Ia.$Pc)this.jze=Math.max(this.jze,La.pMe),this.ize=Math.max(this.ize,La.MLe),this.U8c=Math.max(this.U8c,La.oNb.length)}get EYi(){return this.Ia.Mtd.trie}execute(ya){if(!ya)throw Error.argumentNull("input");let La,Qa;({tokens:La,o_j:Qa}=this.Xnj(ya));let Eb=null,fc=null,mc={};if(this.Ia.$9b){La=
V.Annotations.XK(La);for(var Mc=0;Mc<La.items.length;++Mc)La.items[Mc]=V.Annotations.XK(La.items[Mc])}else({SVf:fc,returnValue:Eb}=this.p5f(ya,mc));Mc=Array(this.U8c);const nd=Array(this.U8c);for(var ba=0;ba<nd.length;++ba)nd[ba]=new lf;for(ba=-this.jze;ba<La.items.length+this.ize;++ba){let Aa=null;this.Ia.$9b&&(Aa=La.items[ba],mc={},{SVf:fc,returnValue:Eb}=this.p5f(Aa,mc));for(const Wa of this.Ia.$Pc){if(0>ba&&-ba>Wa.pMe||ba>=La.items.length&&ba-La.items.length+1>Wa.MLe)continue;let gb=!0;for(let nb=
0;nb<Wa.oNb.length;++nb){const lc=ba+Wa.oNb[nb];Mc[nb]=lc;if(0>lc?0>this.Ia.qMe:lc>=La.items.length?0>this.Ia.NLe:!Qa.HOb[lc]){gb=!1;break}}gb&&({OJi:Eb,PJi:fc}=this.AIj(Wa,Qa,Eb,fc,mc,nd,Mc))}this.Ia.$9b&&(Aa.su(this.Ia.nFa?this.Ia.lsb:this.Ia.jsb,Eb),this.Ia.nFa&&Aa.su(this.Ia.ksb,fc))}ya=V.Annotations.XK(ya);this.Ia.$9b?ya.su(this.Ia.Mra,La):(ya.su(this.Ia.nFa?this.Ia.lsb:this.Ia.jsb,Eb),this.Ia.nFa&&ya.su(this.Ia.ksb,fc));return ya}Xnj(ya){let La,Qa;if(!ya||!({value:La}=ya.Tm(this.Ia.Mra)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Eb;({value:Eb}=ya.Tm(this.Ia.cCa)).returnValue||(Eb="");Qa=new fb(La.items.length);const fc=pd(this.Ia.X2e,mc=>!mc.X8b||mc.X8b.isMatch(ya,null));for(let mc=0;mc<La.items.length;++mc){const Mc=La.items[mc];let nd=null;Qa.T2e[mc]=Qa.h0e.length;let ba=Qa.HOb[mc]=0;for(const Aa of fc)0<Aa.$ic&&Qa.HOb[mc]+ba>=Aa.$ic||Aa.Wtc&&!Aa.Wtc.isMatch(Mc,null)||({Xtc:nd,p_b:ba}=Aa.apply(this,Mc,mc,Qa,Eb,nd,ba))}return{tokens:La,o_j:Qa}}AIj(ya,La,Qa,Eb,fc,mc,Mc){let nd=0;mc[0].F8b=-1;for(mc[0].W3d=ya.Wmh;;){var ba=
Mc[nd],Aa=0>ba||ba>=La.HOb.length?1:La.HOb[ba];let nb=!1;for(;mc[nd].F8b<Aa-1;){++mc[nd].F8b;var Wa=void 0,gb=void 0;0>ba?(Wa=this.Ia.qMe,gb=1):ba>=La.T2e.length?(Wa=this.Ia.NLe,gb=1):(gb=La.T2e[ba]+mc[nd].F8b,Wa=La.h0e[gb],gb=La.Lzh[gb]);mc[nd].Vpc=gb*(nd?mc[nd-1].Vpc:ya.score);if(({value:Wa}=sd(mc[nd].W3d,Wa.toString())).returnValue){nd===ya.oNb.length-1?(ba=Wa,mc[nd].Vpc&&(({value:Aa}=sd(fc,ba.toString())).returnValue||(Aa=-1),0>Aa&&(Qa=V.Annotations.XK(Qa),Array.add(Qa.items,ba)),this.Ia.nFa&&
(Eb=V.Annotations.XK(Eb),0>Aa?Array.add(Eb.items,mc[nd].Vpc):Eb.items[Aa]+=mc[nd].Vpc),0>Aa&&(this.Ia.vog||this.Ia.nFa)&&(fc[ba.toString()]=Qa.items.length-1))):(++nd,mc[nd].F8b=-1,mc[nd].W3d=Wa);nb=!0;break}}if(!nb&&(--nd,0>nd))break}return{OJi:Qa,PJi:Eb}}p5f(ya,La){let Qa;if(({value:Qa}=ya.Tm(this.Ia.nFa?this.Ia.lsb:this.Ia.jsb)).returnValue)for(let Eb=0;Eb<Qa.items.length;++Eb)La[Qa.items[Eb].toString()]=Eb;else Qa=new Kb.a(this.Ia.annotations,V.Annotations.npa);if(this.Ia.nFa){if(({value:La}=
ya.Tm(this.Ia.ksb)).returnValue||(La=new Kb.a(this.Ia.annotations,V.Annotations.Waa)),La.items.length!==Qa.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ia.annotations.Z1(V.Annotations.SM,ya));}else La=null;return{returnValue:Qa,SVf:La}}get byl(){return this.Ia.Mtd}Wnj(ya,La){var Qa;if(({value:Qa}=La.Tm(this.Ia.$Pa)).returnValue)ya=Qa;else{if(!({value:Qa}=La.Tm(this.Ia.KS)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:La}=La.Tm(this.Ia.lW)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Qa||0>La||Qa+La>ya.length)throw Error.argument("Token indices are out of range");ya=ya.substr(Qa,La)}return ya}}Object(h.a)(Wd,"NGramNLModule",null,[1010,1012]);class ye{constructor(ya){this.oNb=null;this.score=this.MLe=this.pMe=0;this.Wmh=null;if(ya){var La=0;try{if(ya.ga(La)!==ye.Q6a)throw Error.argument("initData","Input does not represent a feature template");++La;const Qa=ya.ga(La);++La;this.oNb=
Array(Qa);for(let Eb=0;Eb<Qa;++Eb)this.oNb[Eb]=ya.ga(La),++La;this.pMe=ya.ga(La);++La;this.MLe=ya.ga(La);++La;this.score=ya.ga(La);++La;this.Wmh=({Edg:La}=ye.hgh(ya,La)).returnValue}catch(Qa){throw Error.argument("initData");}}}static hgh(ya,La){const Qa=ya.ga(La);++La;const Eb={};for(let fc=0;fc<Qa;++fc){const mc=ya.ga(La);++La;ya.ga(La)?Eb[mc.toString()]=({Edg:La}=ye.hgh(ya,La)).returnValue:(++La,Eb[mc.toString()]=ya.ga(La),++La)}return{returnValue:Eb,Edg:La}}}ye.Q6a=240803228;Object(h.a)(ye,"FeatureTemplate",
null,[1038]);var Yc=d(547);class Ae{constructor(ya,La){this.nFa=this.vog=this.$9b=!1;this.$Pa=this.lW=this.KS=this.Mra=this.cCa=this.ksb=this.lsb=this.jsb=0;this.Mtd=null;this.NLe=this.qMe=0;this.$Pc=this.X2e=null;if(ya){this.annotations=La.annotations;var Qa=0;try{this.$9b=1===ya.ga(Qa);++Qa;this.vog=1===ya.ga(Qa);++Qa;this.nFa=1===ya.ga(Qa);++Qa;this.jsb=ya.ga(Qa);++Qa;this.lsb=ya.ga(Qa);++Qa;this.ksb=ya.ga(Qa);++Qa;this.cCa=ya.ga(Qa);++Qa;this.Mra=ya.ga(Qa);++Qa;this.KS=ya.ga(Qa);++Qa;this.lW=
ya.ga(Qa);++Qa;this.$Pa=ya.ga(Qa);++Qa;this.Mtd=this.wEk(La.ESa(ya.ga(Qa)));++Qa;this.qMe=ya.ga(Qa);++Qa;this.NLe=ya.ga(Qa);++Qa;const Eb=ya.ga(Qa);++Qa;this.X2e=Array(Eb);for(let mc=0;mc<Eb;++mc){const Mc=ya.ga(Qa);++Qa;const nd=this.Mtd.trie,ba=new Va.a;ba.uSa(ya,Qa,Mc);this.X2e[mc]=this.BEk(ba,La,nd);Qa+=Mc}const fc=ya.ga(Qa);++Qa;this.$Pc=Array(fc);for(La=0;La<fc;++La){const mc=ya.ga(Qa);++Qa;const Mc=new Va.a;Mc.uSa(ya,Qa,mc);this.$Pc[La]=this.aEk(Mc);Qa+=mc}}catch(Eb){throw Error.argument("initData");
}}}wEk(ya){return new Ih.a(new Le.a(ya))}BEk(ya,La,Qa){return Yc.a.create(ya,La,Qa)}aEk(ya){return new ye(ya)}}Object(h.a)(Ae,"NGramNLModuleInit",null,[]);class hd{constructor(ya){this.Ia=ya}execute(ya){if(!ya)throw Error.argumentNull("input");ya=ya.clone();this.Ia.script.execute(ya,null);return ya}}Object(h.a)(hd,"ScriptNLModule",null,[1010]);class oe{constructor(ya,La){ya&&(this.script=La.u9a(ya.ga(0)))}}Object(h.a)(oe,"ScriptNLModuleInit",null,[]);const Xe=ya=>{ya=ac(ya,La=>La*La);return Math.sqrt(Qb(ya,
(La,Qa)=>La+Qa,0))},Ke=ya=>Qb(ya,(La,Qa)=>La>Qa?La:Qa,ya[0]);class me{constructor(ya){this.Ia=ya}execute(ya){if(!ya)throw Error.argumentNull("input");var La=[],Qa=[];this.uwi(ya,La,Qa);this.Vci(La,Qa);const Eb={};for(let mc=0;mc<La.length;++mc){var fc=La[mc];const Mc=this.Ia.mgg.ga(fc);fc=this.Ia.ngg.ga(fc);for(let nd=0;nd<fc;++nd){const ba=this.Ia.Iti.ga(this.Ia.HFf.ga(Mc+nd)),Aa=this.Ia.IFf.ga(Mc+nd);let Wa;({value:Wa}=sd(Eb,ba)).returnValue||(Wa=0);Eb[ba]=Wa+Qa[mc]*Aa}}Qa=ze(Eb);Qa.sort((mc,Mc)=>
{var nd=mc.value,ba=Mc.value;(nd=-(nd>ba?1:nd<ba?-1:0))||(nd=mc.key.localeCompare(Mc.key));return nd});La=new Kb.a(this.Ia.annotations,V.Annotations.SM);for(const mc of Jc(Qa,this.Ia.gmk))Qa=new D.a(this.Ia.annotations),Qa.su(this.Ia.Khi,mc.key),Qa.su(this.Ia.Mhi,mc.value),Array.add(La.items,Qa);ya.su(this.Ia.Lhi,La);return ya}uwi(ya,La,Qa){if(({value:ya}=ya.Tm(this.Ia.Jhi)).returnValue){let Eb;if(({value:Eb}=ya.Tm(this.Ia.lsb)).returnValue){let fc;if(!({value:fc}=ya.Tm(this.Ia.ksb)).returnValue||
Eb.items.length!==fc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.GKc(Eb,fc,La,Qa)}if(({value:Eb}=ya.Tm(this.Ia.Ohi)).returnValue){let fc;if(!({value:fc}=ya.Tm(this.Ia.Phi)).returnValue||Eb.items.length!==fc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.GKc(Eb,fc,La,Qa)}({value:Eb}=ya.Tm(this.Ia.jsb)).returnValue&&this.GKc(Eb,null,La,Qa);
({value:Eb}=ya.Tm(this.Ia.Nhi)).returnValue&&this.GKc(Eb,null,La,Qa)}}GKc(ya,La,Qa,Eb){for(let mc=0;mc<ya.items.length;++mc){var fc=void 0;ya.BU===V.Annotations.dZ?({value:fc}=sd(this.Ia.gRf,ya.items[mc])).returnValue||(fc=-1):(fc=ya.items[mc],fc=fc>=this.Ia.QEe&&fc<=this.Ia.zmk?this.Ia.hGe?this.Ia.hGe.ga(fc-this.Ia.QEe)-1:fc-this.Ia.QEe:-1);if(0<=fc){let Mc;Mc=La?La.items[mc]:1;0<Mc&&(Array.add(Qa,fc),Array.add(Eb,Mc))}}}Vci(ya,La){if(ya.length){switch(this.Ia.sNk){case 0:break;case 1:for(var Qa=
0;Qa<La.length;++Qa)La[Qa]=1+Math.log(La[Qa]);break;case 2:Qa=Ke(La);for(let Eb=0;Eb<La.length;++Eb)La[Eb]=.5+La[Eb]/Qa*.5;break;case 3:for(Qa=0;Qa<La.length;++Qa)La[Qa]=1;break;default:throw Error.notImplemented();}if(this.Ia.tYc)for(Qa=0;Qa<La.length;++Qa)La[Qa]*=this.Ia.tYc.ga(ya[Qa]);ya=Xe(La);for(Qa=0;Qa<La.length;++Qa)La[Qa]/=ya}}}Object(h.a)(me,"TfIdfRankerNLModule",null,[1010]);class Uf{constructor(ya,La=0){if(!ya)throw Error.argumentNull("byteArray");this.sJ=La;if(604662927!==ya.ru(this.sJ+
0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Xk=ya.ru(this.sJ+4,4);this.Rtg=ya.ru(this.sJ+8,4);this.C7j=ya}ga(ya){if(0>ya||ya>=this.count)throw Error.argumentOutOfRange("index");return this.C7j.vSk(8*this.sJ+96+ya*this.Rtg,this.Rtg)}get count(){return this.Xk}}Object(h.a)(Uf,"CompactIntArray",null,[1011]);const yf=(ya,La)=>{La=Array(La);for(let mc=0;mc<La.length;mc++){var Qa=mc,Eb=ya.BY(),fc=1===(Eb>>31&1)?-1:1;const Mc=Eb&8388607;Eb=Eb>>23&255;256===
Eb+1?fc=Mc?Number.NaN:1===fc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Eb?(Eb-=127,fc=fc*Cf(Mc,1)*Math.pow(2,Eb)):fc=fc*Cf(Mc,0)*Math.pow(2,-126);La[Qa]=fc}return La},Cf=(ya,La)=>{let Qa=0;for(let Eb=0;23>Eb;Eb++)Qa+=(ya>>22-Eb&1)/Math.pow(2,Eb+1);return La+Qa};class Ld{constructor(ya,La){this.hGe=null;this.w1g=0;this.ngg=this.mgg=this.tYc=null;this.v1g=0;this.IFf=this.HFf=null;this.annotations=La.annotations;let Qa=0;this.Nhi=ya.ga(Qa);++Qa;this.jsb=ya.ga(Qa);++Qa;this.Ohi=ya.ga(Qa);++Qa;
this.Phi=ya.ga(Qa);++Qa;this.lsb=ya.ga(Qa);++Qa;this.ksb=ya.ga(Qa);++Qa;this.Jhi=ya.ga(Qa);++Qa;this.Lhi=ya.ga(Qa);++Qa;this.Khi=ya.ga(Qa);++Qa;this.Mhi=ya.ga(Qa);++Qa;var Eb=ya.ga(Qa);++Qa;var fc=Array(Eb);for(var mc=0;mc<Eb;++mc)fc[mc]=La.BC(ya.ga(Qa)),++Qa;this.Iti=Va.a.WYd(fc);this.gmk=ya.ga(Qa);++Qa;this.sNk=ya.ga(Qa);++Qa;Eb=ya.ga(Qa);++Qa;this.gRf={};for(fc=0;fc<Eb;++fc){mc=La.BC(ya.ga(Qa));++Qa;const Mc=ya.ga(Qa);++Qa;this.gRf[mc]=Mc}this.QEe=ya.ga(Qa);++Qa;this.zmk=ya.ga(Qa);++Qa;Eb=ya.ga(Qa);
++Qa;0<Eb&&(Eb=La.ESa(ya.ga(Qa)),++Qa,this.hGe=this.Ihd(new de(Eb)));++Qa;ya=La.ESa(ya.ga(Qa));this.lEk(ya)}Ihd(ya){return new Uf(ya.GZb,ya.offset)}lEk(ya){try{const La=new de(ya);this.w1g=La.BY();1===La.BY()?this.tYc=Va.a.WYd(yf(La,this.w1g)):this.tYc=null;const Qa=La.BY();this.mgg=this.Ihd(La);La.offset+=Qa;const Eb=La.BY();this.ngg=this.Ihd(La);La.offset+=Eb;this.v1g=La.BY();const fc=La.BY();this.HFf=this.Ihd(La);La.offset+=fc;this.IFf=Va.a.WYd(yf(La,this.v1g))}catch(La){throw Error.argument("byteReader");
}}}Object(h.a)(Ld,"TfIdfRankerNLModuleInit",null,[]);class od{constructor(ya,La,Qa,Eb){this.wKe=ya;this.mXf=Qa;this.tokens=Eb;this.o8=La;this.BLb=-1;this.God=0}}Object(h.a)(od,"TokenizerData",null,[]);class ug{constructor(ya){this.Ia=ya}execute(ya){if(!ya)throw Error.argumentNull("input");if(!({value:Eb}=ya.Tm(this.Ia.cCa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let La;({value:La}=ya.Tm(this.Ia.KS)).returnValue||(La=0);let Qa;({value:Qa}=
ya.Tm(this.Ia.lW)).returnValue||(Qa=Eb.length-La);if(0>La||La>Eb.length)throw Error.argument("input","Start index out of range");if(0>Qa||Qa>Eb.length)throw Error.argument("input","Length out of range");if(La+Qa>Eb.length)throw Error.argument("input","Bad start-length range");var Eb=new od(Eb,La,La+Qa,new Kb.a(this.Ia.annotations,V.Annotations.SM));this.cyl(Eb);ya=ya.isReadOnly?ya.clone():ya;ya.su(this.Ia.Mra,Eb.tokens);return ya}cyl(ya){for(;ya.o8<ya.mXf;){if(this.Ia.zbe){var La=this.Ia.zbe.hsg(ya.wKe,
ya.o8,ya.mXf-ya.o8,null);!La.succeeded&&La.G0g&&(La=La.G0g);if(La.succeeded){this.y5g(ya,La.length,this.Ia.C$f);ya.o8+=La.length;continue}}La=ya.wKe.substr(ya.o8);let Qa=-1,Eb=-1,fc=-1;for(let mc=0;mc<this.Ia.wnd.length;++mc){const Mc=this.Ia.wnd[mc].exec(La);Mc&&0<Mc[1].length&&(0>Qa||Mc[0].length>Eb)&&(Qa=mc,Eb=Mc[0].length,fc=Mc[1].length)}0<=Qa?(this.y5g(ya,fc,this.Ia.NTe[Qa]),ya.o8+=fc):ya.o8+=1}}y5g(ya,La,Qa){if(this.Ia.bng)Qa!==ug.Koi&&(0>ya.BLb&&(ya.BLb=ya.o8),ya.God=ya.o8+La-ya.BLb,Qa===
ug.Joi&&(0<=ya.BLb&&0<ya.God&&(La=new D.a(this.Ia.annotations),La.su(this.Ia.KS,ya.BLb),La.su(this.Ia.lW,ya.God),La.su(this.Ia.sSd,ug.Loi),La.su(this.Ia.cCa,ya.wKe),Array.add(ya.tokens.items,La)),ya.BLb=-1,ya.God=0));else{let Eb=new D.a(this.Ia.annotations);Eb.su(this.Ia.KS,ya.o8);Eb.su(this.Ia.lW,La);Eb.su(this.Ia.sSd,Qa);Array.add(ya.tokens.items,Eb)}}}ug.Koi="GAP";ug.Joi="EOS_CHUNK";ug.Loi="SENTENCE";Object(h.a)(ug,"TokenizerNLModule",null,[1010]);class Kf{constructor(ya,La){this.lW=this.KS=this.sSd=
this.Mra=this.cCa=0;this.bng=!1;this.NTe=this.wnd=this.C$f=this.zbe=null;if(ya){this.annotations=La.annotations;var Qa=0;try{this.cCa=ya.ga(Qa);++Qa;this.Mra=ya.ga(Qa);++Qa;this.sSd=ya.ga(Qa);++Qa;this.KS=ya.ga(Qa);++Qa;this.lW=ya.ga(Qa);++Qa;this.bng=1===ya.ga(Qa);++Qa;var Eb=ya.ga(Qa);++Qa;0<Eb&&(this.zbe=La.i9d(Eb).EYi);this.C$f=ya.ga(Qa)?La.BC(ya.ga(Qa)):"";++Qa;const fc=ya.ga(Qa);++Qa;this.wnd=Array(fc);this.NTe=Array(fc);for(Eb=0;Eb<fc;++Eb)this.wnd[Eb]=new RegExp(La.BC(ya.ga(Qa))),++Qa,this.NTe[Eb]=
La.BC(ya.ga(Qa)),++Qa}catch(fc){throw Error.argument("initData");}}}}Object(h.a)(Kf,"TokenizerNLModuleInit",null,[]);class Vf{constructor(ya){this.Ia=ya}execute(ya){if(!ya)throw Error.argumentNull("input");let La;if(!({value:La}=ya.Tm(this.Ia.szf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Qa of this.Ia.K_e)La=Qa.apply(La);ya=V.Annotations.XK(ya);ya.su(this.Ia.tzf,La);return ya}static RRd(ya,La){const Qa=new Sys.StringBuilder;for(let Eb=
0;Eb<ya.length;++Eb)Qa.append(La(ya.substr(Eb,1)));return Qa.toString()}}Object(h.a)(Vf,"TransliteratorNLModule",null,[1010]);class Ch{constructor(ya){ya&&(this.style=ya.ga(0))}apply(ya){return Vf.RRd(ya,La=>Ch.Cri(La,this.style))}static Cri(ya,La){switch(La){case 0:return ya.toLowerCase();case 1:return"I"===ya?"\u0131":ya.toLowerCase();case 2:return ya.toUpperCase();case 3:return"i"===ya?"\u0130":ya.toUpperCase();default:throw Error.invalidOperation();}}}Ch.S6a=0;Object(h.a)(Ch,"ChangeCaseTransliterationStage",
null,[1028]);class xg{apply(ya){return Vf.RRd(ya,xg.Syl)}static Syl(ya){const La=ya.charCodeAt(0);return 65281<=La&&65374>=La?String.fromCharCode(La-65248):ya}}xg.S6a=4;Object(h.a)(xg,"LatinFullWidthToHalfWidthTransliterationStage",null,[1028]);class lh{constructor(ya,La){ya&&(this.regex=La.q6f(ya.ga(0)),this.M1k=La.BC(ya.ga(1)))}apply(ya){return ya.replace(this.regex,this.M1k)}}lh.S6a=1;Object(h.a)(lh,"RegexReplaceTransliterationStage",null,[1028]);class Oi{constructor(ya,La){if(ya){var Qa=ya.ga(0),
Eb=La.BC(ya.ga(1)),fc=new Uf(La.ESa(ya.ga(2)));ya=0>ya.ga(3)?null:new Uf(La.ESa(ya.ga(3)));this.C0e={};for(La=0;La<Qa;++La)this.C0e[Eb.charAt(La).toString()]=Eb.substr(fc.ga(La),ya?ya.ga(La):1)}}apply(ya){return Vf.RRd(ya,La=>La in this.C0e?this.C0e[La]:La)}}Oi.S6a=2;Object(h.a)(Oi,"SingleCharSubstitutionsTransliterationStage",null,[1028]);class ph{constructor(ya,La){this.tzf=this.szf=0;this.K_e=null;if(ya){this.annotations=La.annotations;var Qa=0;try{this.szf=ya.ga(Qa);++Qa;this.tzf=ya.ga(Qa);++Qa;
const Eb=ya.ga(Qa);++Qa;this.K_e=Array(Eb);for(let fc=0;fc<Eb;++fc){const mc=ya.ga(Qa);++Qa;const Mc=ya.ga(Qa);++Qa;const nd=new Va.a;nd.uSa(ya,Qa,Mc);Qa+=Mc;this.K_e[fc]=this.vEk(mc,nd,La)}}catch(Eb){throw Error.argument("initData");}}}vEk(ya,La,Qa){switch(ya){case Ch.S6a:return new Ch(La);case lh.S6a:return new lh(La,Qa);case Oi.S6a:return new Oi(La,Qa);case xg.S6a:return new xg;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(h.a)(ph,"TransliteratorNLModuleInit",
null,[]);class Dh{Jej(ya,La){const Qa=ya.ga(0),Eb=new Va.a;Eb.uSa(ya,1,ya.count-1);switch(Qa){case 0:return new hd(new oe(Eb,La));case 2:return new ug(new Kf(Eb,La));case 3:return new Wd(new Ae(Eb,La));case 5:return new Tf(new Sd(Eb,La));case 9:return new Vf(new ph(Eb,La));case 10:return new me(new Ld(Eb,La));default:throw Error.notImplemented();}}}Object(h.a)(Dh,"NLModuleFactory",null,[971]);class mh{constructor(ya){this.Eoi=";";if(!ya)throw Error.argumentNull("resource");this.T4=new Lc(ya,new tc,
new Dh);this.tze=this.T4.tej();this.Dtg=this.T4.annotations.m5b("Text.Text");this.Btg=this.T4.annotations.m5b("Classification.Predictions");this.qqe=this.T4.annotations.m5b("Classification.PredictionString");this.Ctg=this.T4.annotations.m5b("Classification.Probability");this.l7j=this.T4.annotations.m5b("NLMod.Tokens");if(0>this.Dtg||0>this.Btg||0>this.qqe||0>this.Ctg)throw Error.argument("resourceObj","Resource does not represent a ranker");}g5i(){const ya=[];this.J2d(void 0,this.L_f(ya),null);return ya}i5i(ya,
La){const Qa=[],Eb=[];this.J2d(ya,this.L_f(Qa),(fc,mc)=>{const Mc=this.T4.annotations.x_f(fc),nd=[],ba=[];La&&La.length&&-1===Array.indexOf(La,Mc)||(fc=this.T4.annotations.getAttributeType(fc),this.dbh(fc,mc,nd,ba),mc=new Mh(Mc,nd,ba),Array.add(Eb,mc))});return new jf(Qa,Eb)}h5i(ya){const La=[];this.J2d(ya,Qa=>{let Eb;if(({value:Eb}=Qa.Tm(this.qqe)).returnValue){let fc;({value:fc}=Qa.Tm(this.Ctg)).returnValue&&Array.add(La,new Xc(Eb,fc))}},null);return La}J2d(ya,La,Qa){var Eb=new D.a(this.T4.annotations);
Eb.su(this.Dtg,ya);ya=this.tze.execute(Eb);if(({value:Eb}=ya.Tm(this.Btg)).returnValue)for(const fc of Eb.items)La(fc);if(Qa&&({value:La}=ya.Tm(this.l7j)).returnValue)for(const fc of La.items)fc.WQc(Qa)}dbh(ya,La,Qa,Eb){if(V.Annotations.TB(ya))for(var fc of La.items)this.dbh(La.BU,fc,Qa,Eb);else if(V.Annotations.TFh(ya)){fc=this.T4.annotations.b5f(ya);for(let mc=0;mc<fc;mc++)Array.add(Qa,this.T4.annotations.c8f(ya,mc)),Array.add(Eb,this.T4.annotations.Z1(this.T4.annotations.o$a(ya,mc),La.QSa(mc)))}else Array.add(Qa,
"VALUE"),Array.add(Eb,this.T4.annotations.Z1(ya,La))}L_f(ya){return La=>{let Qa;({value:Qa}=La.Tm(this.qqe)).returnValue&&Array.add(ya,this.Ygj(Qa))}}Ygj(ya){const La=ya.indexOf(this.Eoi);return 0>La?ya:ya.substring(0,La)}}Object(h.a)(mh,"Ranker",null,[]);var Od=d(335),Ue=d(384),yh=d(27);class Hj{constructor(ya,La){this.Phf="";this.vJd=null;this.wJd=!1;this.lba=null;this.COh=["TellMe.TellMeParamCollection"];this.ub=ya;this.QAa=La;this.ub.x6a&&(this.lba=null)}get $jd(){if(!this.vJd&&!this.wJd){let ya=
null;try{ya=window.TellMeModel}catch(La){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("QueryRanker","TellMeModel not found. Exception: "+La)}if(ya){try{this.vJd=new mh(ya)}catch(La){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+La)}this.wJd=!0}else if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("QueryRanker","Classifier model not found")}return this.vJd}$D(){return"Command"}pL(){return 0===
this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La,Qa=!1,Eb=e.a.tellMe,fc=null){const mc=new y.a(ya);if((!fc||Array.contains(fc,0))&&!A.a.MF(ya)){if(!this.$jd&&this.wJd){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.ub.x6a&&this.lba&&this.lba.initialize();if(Od.CommandResultsUtility.yje(ya.zf)&&(fc=Od.CommandResultsUtility.O0f(ya.zf),0<fc.results.length)){fc.displayName=
"Classifier Debug";mc.Uq(fc);La.resultsUpdated(mc);return}fc=ya?this.Phf=ya.zf:this.Phf;if(yh.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){fc=this.$gj(fc);var Mc=this.nSc(fc.U9d());fc=fc.h_f()}else fc=this.Zgj(fc),Mc=this.$6i(fc),fc=[];Od.CommandResultsUtility.y2c(Mc,!1,"Classifier","TFIDF");Mc=Od.CommandResultsUtility.vUc(ya,Mc,this.ub,this.lba,this.QAa,fc,0,1);0<Mc.results.length&&Eb!==e.a.contextMenu&&(Mc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Qa||Mc.results.length||
this.ub.bFa||this.ub.Tya||(ya=new v.a("lookupNoResults",14,ya.zf,null,1),Mc.ls(ya));0<Mc.results.length&&mc.Uq(Mc);mc.attributes=fc}La.resultsUpdated(mc)}U9d(){let ya=[];try{ya=this.$jd.g5i()}catch(La){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("GetPredictions","Exception: "+La)}return ya}Zgj(ya){let La=[];try{La=this.$jd.h5i(ya)}catch(Qa){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("GetPredictionsWithScore","Exception: "+Qa)}return La}$gj(ya){try{return this.$jd.i5i(ya,
this.COh)}catch(La){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("GetPredictionsWithTokenAttributes","Exception: "+La)}return new jf([],[])}nSc(ya){const La=[];if(ya)for(const Qa of ya)La.push(new Ue.a(Qa,-99999));return La}$6i(ya){const La=[];if(ya)for(const Qa of ya)La.push(new Ue.a(Qa.prediction,Qa.score));return La}}Object(h.a)(Hj,"CommandResultsProvider",null,[602]);var fe=d(990);class Zh{constructor(ya){this.ub=ya}$D(){return"Feedback"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?
1:2}iB(ya,La,Qa,Eb,fc=null){ya=new y.a(ya);if(!fc||Array.contains(fc,21))fc=[],fc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(fc),fc=new B.a(22),fc.displayName="",fc.ls(new v.a("TellMeFeedback",23,null,null,1)),ya.Uq(fc);La.resultsUpdated(ya)}}Object(h.a)(Zh,"FeedbackResultsProvider",null,[602]);class Pi{constructor(ya,La,Qa,Eb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ya;this.CommandId=La;
this.CommandValueId=Qa;this.InputText=Eb}}Object(h.a)(Pi,"FindInDocumentProp",null,[]);var Zj=d(47);class Wg{constructor(ya){this.zGd=2;this.j4a=[];this.tOa=[];this.ub=ya;Wg.Tja=ya.BWf;Wg.GWf="FindInDocumentSuggestion";Wg.mah="FindInDocumentSuggestion3";this.pWh=Object.assign(new E.a,{landingTab:"Indoc",data:null});this.P0h=this.ub.OMb||!!yh.AFrameworkApplication.Aa&&yh.AFrameworkApplication.Aa.hb.OMb}$D(){return"FindInDocument"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:3===this.ub.Aq?this.ub.Dxh?
2:3:2}iB(ya,La,Qa=!1,Eb,fc=null){const mc=new y.a(ya);if(fc&&!Array.contains(fc,2))La.resultsUpdated(mc);else if(Array.clear(this.j4a),A.a.MF(ya)){if(Qa&&this.wvh()){Qa=new B.a(2);Qa.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;fc=1;Eb="";if(0<this.tOa.length&&!this.ub.PMb)for(var Mc of this.tOa)if(""!==Mc.Label.toLowerCase()){if(fc>=this.zGd)break;this.BIh(Qa,Mc.Label,Mc.CommandValueId,Wg.GWf+fc,Mc.InputText);fc++}Mc="";this.ub.QH?(mc.Uq(Qa),Qa=new B.a(3),Mc=this.ub.XPa?A.a.CSa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):Mc=CommonUIStrings.l_TellMeOpenFindPaneText;Eb=this.N0f("");this.BIh(Qa,Mc,Eb,Wg.mah,"");mc.Uq(Qa)}La.resultsUpdated(mc)}else Mc="",Qa&&(Qa=this.N0f(ya.zf),Eb=[],this.ub.iVa?(this.ub.MYe&&Eb.push(appChrome.actions.setControlIconSet(Wg.Tja,{"default":"FindInDocument_20"})),Mc=this.ub.Kme?A.a.V7d(ya.zf,CommonUIStrings.l_FindInDocumentScopedButtonText):ya.zf+CommonUIStrings.l_FindInDocumentScopedButtonText):this.ub.QH?(Mc=this.ub.XPa?A.a.CSa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
ya.zf)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,ya.zf),Eb.push(appChrome.actions.setControlIconSet(Wg.Tja,{"default":"FindInDocument_20"}))):Mc=this.ub.PMb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,ya.zf),this.ub.tda?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Wg.Tja,Mc)),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Wg.Tja,Qa))):(Eb.push(appChrome.actions.setControlLabel(Wg.Tja,
Mc)),Eb.push(appChrome.actions.setButtonCommandValueId(Wg.Tja,Qa)),appChrome.api.dispatch(Eb)),this.Drh(Mc,Wg.Tja,Qa,ya.zf)),this.ub.Dxh?(Mc=new v.a(Wg.Tja,8,ya.zf),Qa=new B.a(2),Qa.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,Qa.ls(Mc),mc.Uq(Qa),La.resultsUpdated(mc)):this.ub.W$i().then(nd=>{const ba=new v.a(Wg.Tja,8,ya.zf,null,1);ba.count=nd;nd=new B.a(2);nd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;nd.ls(ba);mc.Uq(nd);La.resultsUpdated(mc)},nd=>{x.TellMeActor.instance.Hd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+nd);nd=new v.a(Wg.Tja,8,ya.zf,null,1);const ba=new B.a(2);ba.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ba.ls(nd);mc.Uq(ba);La.resultsUpdated(mc)})}wvh(){return!!this.ub&&this.ub.Mqd}BIh(ya,La,Qa,Eb,fc=null){const mc=[];La&&mc.push(appChrome.actions.setControlLabel(Eb,La));this.ub.QH&&mc.push(appChrome.actions.setControlIconSet(Eb,{"default":"FindInDocument_20"}));mc.push(appChrome.actions.setButtonCommandValueId(Eb,Qa));appChrome.api.dispatch(mc);
this.Drh(La,Eb,Qa,"");ya.ls(new v.a(Eb,8,fc,null,1,-99999))}N0f(ya){return this.P0h?A.a.PCa(ya,15,this.pWh):Zj.a.ue(ya)}Drh(ya,La,Qa,Eb){this.wvh()&&this.j4a.length<this.zGd&&(ya=new Pi(ya,La,Qa,Eb),Array.add(this.j4a,ya))}$cl(ya){for(let La=0;La<this.j4a.length;La++)if(this.j4a[La].CommandId===ya){const Qa=this.j4a[La].Label;let Eb=!1;if(0<this.tOa.length){let fc=0;for(const mc of this.tOa){if(mc.Label===Qa){Array.removeAt(this.tOa,fc);Eb=!0;break}fc++}}!Eb&&this.tOa.length>=this.zGd-1&&Array.removeAt(this.tOa,
1);Array.insert(this.tOa,0,this.j4a[La])}}}Wg.Tja=null;Wg.GWf=null;Wg.mah=null;Object(h.a)(Wg,"FindInDocumentResultsProvider",null,[602]);var $h=d(988);class Fe{constructor(ya){this.ub=ya}$D(){return"Insights"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La,Qa=!1,Eb,fc=null){Eb=new y.a(ya);if(!fc||Array.contains(fc,13))if(this.Fkl()||!A.a.MF(ya)){fc=new B.a(13);var mc=""===ya.zf.trim(),Mc=mc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",nd=new v.a(Mc,10,ya.zf,null,1);Qa&&(Qa=null,
A.a.j4()?mc?mc=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(mc=this.ub.PMb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ya.zf),Qa=A.a.PCa(ya.zf,1)):(mc=String.format(CommonUIStrings.l_InsightsButtonText,ya.zf),Qa=A.a.aZd(ya.zf)),this.ub.tda?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Mc,mc)),Qa&&x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Qa))):
(ya=[],ya.push(appChrome.actions.setControlLabel(Mc,mc)),Qa&&ya.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Qa)),appChrome.api.dispatch(ya)),nd.label=mc);fc.ls(nd);Eb.Uq(fc)}La.resultsUpdated(Eb)}Fkl(){return A.a.j4()&&this.ub.Pvl&&!this.ub.t3}}Object(h.a)(Fe,"InsightsResultsProvider",null,[602]);var Ph=d(986);class rg{constructor(ya){this.ub=ya}$D(){return"Learning"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La,Qa,Eb,fc=null){Qa=new y.a(ya);fc&&!Array.contains(fc,
21)||!A.a.MF(ya)||(fc=[],Eb=this.ub.f0j,fc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Eb)),Eb=rg.uaj(Eb),fc.push(appChrome.actions.setControlLabel("LearningForSearch",Eb)),appChrome.api.dispatch(fc),ya=new v.a("LearningForSearch",22,ya.zf,null,1),fc=new B.a(21),fc.ls(ya),Qa.Uq(fc));La.resultsUpdated(Qa)}static uaj(ya){const La=[];Array.add(La,new Ph.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(La,new Ph.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(La,new Ph.a(600,ya));Array.add(La,new Ph.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ya={};ya.parts=La;return JSON.stringify(ya)}}Object(h.a)(rg,"LearningProvider",null,[602]);var zg=d(1067);class lj{constructor(ya,La){this.Yob=this.Yqb=this.NOa=this.BBc=null;this.aw=!1;this.opb=ya;this.NQh=La;ya&&this.VUf(ya)}nud(){this.opb.nud()&&this.VUf(this.opb)}Bmj(ya){let La=[];var Qa=[];ya=lj.Tpk(ya);var Eb="";Array.clear(Qa);for(let fc=0;fc<ya.length;fc++){const mc=ya.charAt(fc);-1!==
" ".indexOf(mc)?(Eb.length&&Array.add(Qa,Eb),Eb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(mc)?(Eb.length&&Array.add(Qa,Eb),Eb=mc,Array.add(Qa,Eb),Eb=""):Eb+=mc}Eb.length&&Array.add(Qa,Eb);for(ya=0;ya<Qa.length;ya++)Eb=this.Z6i(Qa[ya]),Eb=this.JBi(Eb),La=lj.Xmk(La,Eb);return La=this.c8h(La)}fle(){this.aw||this.nud();return this.aw}WMc(ya){return this.BBc[ya.toString()]}c8h(ya){for(let La=0;La<ya.length;La++){const Qa=this.NOa[La];if(ya[La].commandId!==this.WMc(Qa[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Eb;(Eb=ya[La]).score=Eb.score+Qa[1]}return ya}JBi(ya){const La=[];for(var Qa=0;Qa<this.NOa.length;Qa++)La.push(new Ue.a(this.WMc(this.NOa[Qa][0]),-5));Qa=new zg.a;for(var Eb=0;Eb<ya.length;Eb++)Qa.add(this.WMc(ya[Eb][0]));for(Eb=0;Eb<La.length;Eb++){const mc=La[Eb];for(let Mc=0;Mc<ya.length;Mc++){var fc=ya[Mc];const nd=this.WMc(fc[0]);fc=fc[1];if(nd===mc.commandId){mc.score=fc;Qa.remove(nd);break}}if(!Qa.count)break}return La}Z6i(ya){const La=1>ya.length;for(let Mc=0;2>=Mc;Mc++){const nd=this.Yob;
for(let ba in nd){var Qa=nd[ba],Eb=ya,fc=ba;const Aa=fc.length+1,Wa=Array((Eb.length+1)*Aa);for(var mc=0;mc<=Eb.length;mc++)Wa[mc*Aa]=mc;for(mc=0;mc<=fc.length;mc++)Wa[mc]=mc;for(mc=0;mc<fc.length;mc++)for(let gb=0;gb<Eb.length;gb++)Wa[(gb+1)*Aa+(mc+1)]=Eb.charAt(gb)===fc.charAt(mc)?Wa[gb*Aa+mc]:Math.min(Math.min(Wa[gb*Aa+(mc+1)]+1,Wa[(gb+1)*Aa+mc]+1),Wa[gb*Aa+mc]+1);Eb=Wa[Eb.length*Aa+fc.length];if((!Eb||!La)&&Eb<=Mc)return Qa}}return this.Yqb}VUf(ya){this.BBc=ya.h9d();this.NOa=ya.lhj();this.Yqb=
ya.yoj();this.Yob=ya.tcj();if(this.aw=!!this.BBc&&!!this.NOa&&!!this.Yob&&!!this.Yqb)this.aw=0<this.NOa.length&&lj.dje(this.NOa);this.aw&&(this.aw=0<this.Yqb.length&&lj.dje(this.Yqb));this.aw&&(this.Yob=lj.apj(this.Yob));this.aw||(this.Yob=this.Yqb=this.NOa=this.BBc=null)}doj(ya){ya=this.Bmj(ya);return this.qYi(ya,this.NQh)}qYi(ya,La){let Qa=[];for(let Eb=0;Eb<ya.length;Eb++)ya[Eb].score>=La&&Qa.push(ya[Eb]);Qa.sort((Eb,fc)=>Eb.score<fc.score?1:Eb.score>fc.score?-1:0);0<Qa.length-10&&(Qa=Qa.slice(0,
10));return Qa}static Xmk(ya,La){if(!ya.length)return La;if(ya.length!==La.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Qa=0;Qa<ya.length;Qa++){if(ya[Qa].commandId!==La[Qa].commandId)throw Error.create("Incorrect CommandId");let Eb;(Eb=ya[Qa]).score=Eb.score+La[Qa].score}return ya}static Tpk(ya){return Zj.a.rg(ya)}static dje(ya){for(let La=0;La<ya.length;La++)if(2!==ya[La].length)return!1;return!0}static apj(ya){const La={};for(let fc in ya){var Qa=
fc,Eb=ya[fc];const mc=Eb;mc.length&&lj.dje(mc)&&(La[Qa]=Eb)}return La}}Object(h.a)(lj,"NaiveBayesClassifierModel",null,[]);class pg{constructor(ya,La){this.lba=null;this.ub=ya;this.dVb=new lj(La,ya.N4f);this.ub.x6a&&(this.lba=null)}$D(){return"NBCommand"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La,Qa=!1,Eb=e.a.tellMe,fc=null){const mc=new y.a(ya);if((!fc||Array.contains(fc,0))&&!A.a.MF(ya)){if(Od.CommandResultsUtility.yje(ya.zf)&&(fc=Od.CommandResultsUtility.O0f(ya.zf),0<fc.results.length)){fc.displayName=
"Classifier Debug";mc.Uq(fc);La.resultsUpdated(mc);return}if(!this.dVb.fle()){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.ub.x6a&&this.lba&&this.lba.initialize();fc=this.dVb.doj(ya.zf);Od.CommandResultsUtility.y2c(fc,!1,"Classifier","NaiveBayesian");fc=Od.CommandResultsUtility.vUc(ya,fc,this.ub,this.lba,null,null,0,1);0<fc.results.length&&
Eb!==e.a.contextMenu&&(fc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Qa||fc.results.length||this.ub.bFa||this.ub.Tya||(ya=new v.a("lookupNoResults",14,ya.zf,null,1),fc.ls(ya));0<fc.results.length&&mc.Uq(fc)}La.resultsUpdated(mc)}}Object(h.a)(pg,"NaiveBayesCommandProvider",null,[602]);class Nh{constructor(){this.g4a=null;this.aw=!1;this.nud()}nud(){this.aw||(this.g4a=window.NBCRM)&&4===this.g4a.length&&(this.aw=!0);return this.aw}lhj(){return this.aw?this.g4a[1]:null}yoj(){return this.aw?
this.g4a[2]:null}tcj(){return this.aw?this.g4a[3][0]:null}h9d(){return this.aw?this.g4a[0][0]:null}}Object(h.a)(Nh,"NaiveBayesModelAdapter",null,[869]);var Ha=d(193);class kb{constructor(ya){this.ub=ya}$D(){return"OfficeScript"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La){const Qa=new y.a(ya);if(!A.a.MF(ya)){ya=Ha.d(ya.zf);var Eb=new B.a(27);Eb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Eb=this.Ytf(ya,kb.OCl,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Eb);Eb=this.Ytf(ya,kb.y1i,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Eb);Qa.Uq(Eb)}La.resultsUpdated(Qa)}Ytf(ya,La,Qa,Eb,fc,mc){const Mc=[];for(const nd of La)if(Ha.a(ya,nd)){this.ub.tda?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Qa,fc)),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Qa,Eb))):(Mc.push(appChrome.actions.setControlLabel(Qa,fc)),Mc.push(appChrome.actions.setButtonCommandValueId(Qa,
Eb)),appChrome.api.dispatch(Mc));mc.ls(new v.a(Qa,27,null,null,1));break}return mc}}kb.OCl="unhide row rows col cols column columns".split(" ");kb.y1i=["freeze","selection","pane","panes"];Object(h.a)(kb,"OfficeScriptsSamplesProvider",null,[602]);var Hb=d(18),ic=d(16),Qc=d(452),Jd=d(306),yd=d(451),He=d(36),sf=d(109),bg=d(125);class Ag{constructor(ya){this.jI=null;this.gS=-1;this.AEe=14;this.BEe=12;this.attributes=this.BNd=this.query=null;this.bAb=!1;this.Zpb=[];this.Yh=yh.AFrameworkApplication.Ke;
yh.AFrameworkApplication.fa&&(this.AEe=yh.AFrameworkApplication.fa.Bc("TellMeMaxTermedResults",this.AEe),this.BEe=yh.AFrameworkApplication.fa.Bc("TellMeMaxZeroTermResults",this.BEe));this.ZL=ya}get Lk(){return this.Zpb}get Pud(){return this.BNd}Uq(ya){let La=!1;for(let Qa=0;Qa<this.Lk.length;Qa++)if(29!==this.Lk[Qa].groupType&&this.Lk[Qa].groupType===ya.groupType){this.rPd(this.Lk[Qa],ya);La=!0;break}La||this.Lk.push(ya)}rPd(ya,La){for(let Qa=0;Qa<La.results.length;Qa++)ya.ls(La.results[Qa])}Kih(ya){const La=
[];for(const Qa of this.Lk)Qa.groupType!==ya&&La.push(Qa);this.Lk.length!==La.length&&(this.Zpb=La)}LYk(ya){let La=null,Qa=null,Eb=null;for(let fc=0;fc<ya.length;fc++){const mc=ya[fc];if(mc&&mc.Lk&&mc.Lk.length)for(const Mc of mc.Lk)if(17===Mc.groupType||18===Mc.groupType)La=Mc;else if(0===Mc.groupType||16===Mc.groupType)Qa=Mc,Eb=mc}La&&Qa&&0<Qa.results.length&&(17===La.groupType&&({ePd:Qa,DPd:La}=Od.CommandResultsUtility.a7h(Qa,La,this.ZL.WG()?this.ZL.WG().m6i:-.6)),Eb.Kih(Qa.groupType))}kql(){new Hb.a;
this.isc(this.ZL.ESg)}yac(ya,La){return this.query.zf.length>this.ZL.WG().Dhj&&this.PTj(ya,La)||this.query.zf.length>this.ZL.WG().Ehj&&this.yWj(ya,La)?!0:!1}yWj(ya,La){return ya&&ya.length&&La&&La.length?-1===La.toLowerCase().indexOf(ya.toLowerCase())?!1:!0:!1}PTj(ya,La){return ya&&ya.length&&La&&La.length?La.toLowerCase().startsWith(ya.toLowerCase()):!1}DYi(ya){const La=[];for(const Qa of this.ZL.WG().QH?this.Pud:this.Lk)ya.contains(Qa.groupType)||La.push(Qa);this.ZL.WG().QH?this.BNd=La:this.Zpb=
La}SGl(ya,La){const Qa=[];for(const Eb of this.Lk){const fc=Eb;if(13!==fc.groupType||24!==fc.groupType){const mc=ya[Jd.a[fc.groupType].toLowerCase()];let Mc="False";mc<La&&(Mc="True");fc.displayName=fc.displayName+" ("+Mc+": "+mc+")"}Qa.push(fc)}this.Zpb=Qa}isc(ya,La=!1,Qa=null){if(this.ZL.WG().QH){if(!La)for(this.BNd=Array(this.Lk.length),La=0;La<this.Lk.length;La++)this.Pud[La]=this.Lk[La];this.ZL.uUg.isc(this.Lk,this.Pud,this.query,ya,Qa)}else{for(Qa=new Hb.a;this.Lk.length;){La=this.Lk.pop();
const Eb=Jd.a[La.groupType].toLowerCase(),fc=ya[Eb];if(bg.b(fc))throw Error.create("GroupId "+Eb+" missed from group SortingOrder");Qa.add(new ic.a(fc,La))}Qa.Sc((Eb,fc)=>Eb.key<fc.key?-1:1);for(ya=0;ya<Qa.count;ya++)La=Qa.ga(ya).value,this.Lk.push(La)}}lql(){var ya=!1;let La=!1,Qa=!1;for(let fc=0;fc<this.Lk.length;fc++){var Eb=this.Lk[fc];const mc=Eb.groupType;if(8===mc||15===mc||14===mc){Eb=Eb.results;for(let Mc=0;Mc<Eb.length;Mc++){if(8===mc&&this.yac(this.query.zf,Eb[Mc].label)){ya=!0;break}if(15===
mc&&this.yac(this.query.zf,Eb[Mc].label)){La=!0;break}if(14===mc){if(this.yac(this.query.zf,Eb[Mc].label)||this.yac(this.query.zf,Eb[Mc].description)){Qa=!0;break}const nd=Eb[Mc].label.split(" ");for(const ba of nd)if(this.yac(this.query.zf,ba)){Qa=!0;break}}}}}ya=this.ZL.Xij(ya,La,Qa);this.isc(ya)}ihb(ya,La,Qa,Eb,fc,mc){if(fc===this.jI){var Mc=ya.data.Wd;fc=null;try{fc=He.b(Mc)}catch(xd){x.TellMeActor.instance.Hd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+
xd);return}if("RankerResults"in fc&&fc.RankerResults){this.gja();var nd=fc.RankerResults,ba=new Hb.a,Aa=new Hb.a;Mc=0;for(var Wa of nd){nd=Wa.ProviderId;var gb=Wa.Score;Mc+=gb;ba.add(new ic.a(nd,gb))}ba.Sc((Kc,Zc)=>Kc.value>Zc.value?-1:1);gb=mc?mc.$jj:1E-6;Wa={};nd={};let xd=0;for(var nb=0;nb<ba.count;nb++){let Kc=parseInt(ba.ga(nb).key),Zc=ba.ga(nb).value/Mc;1===Kc&&(nd.answer=xd++,nd.entity=xd++,nd.definition=xd++,nd.wolframanswer=xd++,Zc<gb&&(Aa.add(9),Aa.add(11),Aa.add(10),Aa.add(12)),Wa.answer=
Zc,Wa.entity=Zc,Wa.definition=Zc,Wa.wolframanswer=Zc);2===Kc&&(nd.assistance=xd++,Zc<gb&&Aa.add(8),Wa.assistance=Zc);3===Kc&&(nd.classifier=xd++,nd.serviceclassifier=xd++,Zc<gb&&(Aa.add(0),Aa.add(17)),Wa.classifier=Zc,Wa.serviceclassifier=Zc);4===Kc&&(nd.people=xd++,Zc<gb&&Aa.add(14),Wa.people=Zc);5===Kc&&(nd.document=xd++,Zc<gb&&Aa.add(15),Wa.document=Zc);6===Kc&&(nd.findindocument=xd++,Zc<gb&&Aa.add(2),Wa.findindocument=Zc);7===Kc&&(nd.notes=xd++,Zc<gb&&Aa.add(20),Wa.notes=Zc);8===Kc&&(nd.image=
xd++,Zc<gb&&Aa.add(19),Wa.image=Zc)}ba=new Hb.a;ba.add("classifier");ba.add("serviceclassifier");ba.add("appsforoffice");ba.add("addin");ba.add("findindocument");ba.add("assistance");ba.add("document");ba.add("people");ba.add("answer");ba.add("wolframanswer");ba.add("definition");ba.add("entity");ba.add("image");ba.add("template");ba.add("officescript");for(nb=0;nb<ba.count;nb++)ba.ga(nb)in nd||(nd[ba.ga(nb)]=xd++);nd.learning=xd++;nd.insights=xd++;nd.actionai=xd++;nd.feedback=xd++;mc&&mc.rRj&&this.SGl(Wa,
gb);mc&&mc.sRj&&this.DYi(Aa);Aa={};for(var lc in Wa)Aa[lc]=Wa[lc]*Mc;this.isc(nd,!0,Aa)}if(mc.w0c&&"Intents"in fc&&fc.Intents){lc=fc.Intents;for(var jd of lc)if(this.gne(jd)&&"Serplet"===jd.GroupType&&jd.ConfidenceScore>jd.ConfidenceThreshold){lc=!1;fc=0;if(mc.pme){Mc=new v.a("",31);for(Aa=0;Aa<this.Lk.length;Aa++)if((ba=this.Lk[Aa].results)&&0<ba.length){fc=Aa;Mc=ba[0];break}2===Mc.groupType&&(lc=!0)}Mc=new B.a(13);lc&&mc.pme&&(Mc=new B.a(13,CommonUIStrings.l_TellMeWebTitle));Aa=new v.a("SmartLookupFromTellMeQueryTermAtTop",
10,this.query.zf,null,0);ba=[];Wa=null;Wa=A.a.j4()?A.a.PCa(this.query.zf,1):A.a.aZd(this.query.zf);ba.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Wa));Wa=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.zf);ba.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Wa));appChrome.api.dispatch(ba);Mc.ls(Aa);Aa=[];if(lc&&mc.pme)for(Aa.push(this.Lk[fc]),Aa.push(Mc),lc=fc+1;lc<this.Lk.length;lc++)(fc=this.Lk[lc].results)&&
0<fc.length&&Aa.push(this.Lk[lc]);else for(Aa.push(Mc),lc=0;lc<this.Lk.length;lc++)(fc=this.Lk[lc].results)&&0<fc.length&&Aa.push(this.Lk[lc]);this.Zpb=Aa}}if(mc.Gac&&!mc.QH){jd=lc=-1;for(fc=0;fc<this.Lk.length;fc++)switch(this.Lk[fc].groupType){case 23:lc=fc;break;case 0:case 17:case 2:-1===jd&&(jd=fc)}if(-1!==lc){jd=-1===jd?0:lc>jd?jd+1:jd;lc=this.Lk[lc];fc=Array(this.Lk.length);Mc=0;for(Aa=0;Aa<fc.length;Aa++)Aa===jd?fc[Aa]=lc:(23===this.Lk[Mc].groupType&&Mc++,fc[Aa]=this.Lk[Mc],Mc++);this.Zpb=
fc}}Eb.resultsUpdated(this);Eb=x.TellMeActor.instance.Hd;Eb.I5(La.length,"RankerInference",ya.data.ie.toString(),Math.round(window.performance.now()-Qa),yd.a.gCh,!0,Qc.a.Tta);this.bAb&&Eb&&(ya=this.query.QZa,La=Eb.Pxc,mc.N0c&&ya>La&&!mc.QH&&(Eb.hpe(this.query.zf),Eb.OVe(ya)))}}gne(ya){if("GroupType"in ya&&ya.GroupType&&"ConfidenceScore"in ya&&"ConfidenceThreshold"in ya)return!0;x.TellMeActor.instance.Hd.onError("IsValidIntentGroup","Invalid intents found");return!1}Xgb(ya,La,Qa,Eb,fc){Eb===this.jI&&
(this.gja(),x.TellMeActor.instance.Hd.I5(La.length,"RankerInference",ya.data.ie.toString(),Math.round(window.performance.now()-Qa),yd.a.gCh,!1,Qc.a.Tta));fc.resultsUpdated(this)}gja(){-1!==this.gS&&(window.clearTimeout(this.gS),this.gS=-1)}mql(ya){let La;La=this.ZL.WG().QH?x.TellMeActor.instance.Hd.fae(this.Pud,this.query.zf):x.TellMeActor.instance.Hd.fae(this.Lk,this.query.zf);var Qa=this.ZL.WG().Zjj;""!==Qa&&(Qa="_"+Qa);let Eb="";this.ZL.WG().ele&&(Eb="RankerInference"+Qa+",");this.ZL.WG().w0c&&
(Eb+="SerpletClassifier");","===Eb.charAt(Eb.length-1)&&(Eb=Eb.substring(0,Eb.length-1));Qa=x.TellMeActor.instance.Hd.D8f(Eb);const fc=this.jI=sf.a.create().toString();Qa["Client-Request-Id"]=fc;const mc=window.performance.now(),Mc=this.ZL.WG()?this.ZL.WG().akj:600;this.gja();this.gS=window.setTimeout(()=>{if(fc===this.jI){this.jI="";this.gS=-1;ya.resultsUpdated(this);const nd={};nd[r.a.provider]="Ranker";nd[r.a.gib]=this.query.QZa;x.TellMeActor.instance.Hd.CH(n.a.timedOut,Mc,nd)}},Mc);this.Yh.nj(x.TellMeActor.instance.Hd.E8f(),
2,La,Qa,!1,0,nd=>{this.ihb(nd,this.query.zf,mc,ya,fc,this.ZL.WG())},nd=>{this.Xgb(nd,this.query.zf,mc,fc,ya)},null,null,!1,4E3,6E3)}Rzl(){var ya=0,La=new Hb.a,Qa=this.ZL.CSg,Eb=this.ZL.DSg;for(var fc=0;fc<this.Lk.length;fc++){var mc=this.Lk[fc],Mc=Jd.a[mc.groupType].toLowerCase(),nd=Qa[Mc];ya+=mc.results.length;mc.results.length>nd&&(Mc=Eb[Mc],bg.b(Mc)||La.add(new ic.a(Mc,mc)))}Eb=!this.query||""===this.query.zf.trim();fc=ya-(Eb?this.BEe:this.AEe);if(!(0>=fc)){Eb=window.performance.now();ya=ya.toString()+
" total,"+fc.toString()+" to remove.";if(0<La.count)for(La.Sc((ba,Aa)=>ba.key>Aa.key?-1:1),mc=0;mc<La.count&&0<fc;mc++){Mc=La.ga(mc).value;nd=Jd.a[Mc.groupType].toLowerCase();let ba=Mc.results.length-Qa[nd];ba>fc&&(ba=fc);0<ba&&(Mc.qRe(ba),ya+=nd+": "+ba.toString()+" results removed.",fc-=ba)}if(0<fc){ya+=fc.toString()+" results left after trimming.";La=new Hb.a;Qa=this.ZL.HSg;for(mc=0;mc<this.Lk.length;mc++)Mc=this.Lk[mc],nd=Qa[Jd.a[Mc.groupType].toLowerCase()],bg.b(nd)||La.add(new ic.a(nd,Mc));
La.Sc((ba,Aa)=>ba.key<Aa.key?-1:1);for(Qa=0;0<fc;)mc=La.ga(Qa++).value,fc>=mc.results.length?(Array.remove(this.Lk,mc),ya+=Jd.a[mc.groupType]+": "+mc.results.length.toString()+" results force removed.",fc-=mc.results.length):(mc.qRe(fc),ya+=Jd.a[mc.groupType]+": "+fc.toString()+" results force removed.",fc=0)}x.TellMeActor.instance.Hd&&(La={},La[r.a.message]=ya,x.TellMeActor.instance.Hd.CH("ShowOptimal",window.performance.now()-Eb,La))}}}Object(h.a)(Ag,"CombineResultsUpdatedEventArgs",null,[807]);
var Ii=d(697);class aj{constructor(ya,La,Qa,Eb=!1,fc=""){this.IId=this.$Jd=!1;this.xD=ya;this.Q4a=[];this.vmf=La.length;this.ub=x.TellMeActor.instance.WG();this.EAc=Eb;this.qPa=fc;this.Gqb={};for(ya=0;ya<La.length;++ya)this.Gqb[ya.toString()]=Qa?0:La[ya].pL()}vel(ya,La){La&&La.query&&La.query.QZa<x.TellMeActor.instance.Vba||(this.Q4a[ya]=La,this.IId?this.$Jd=!0:(!this.ub||3!==this.ub.Aq||3!==this.Gqb[ya.toString()]||this.qPf())&&this.AYc())}vFk(){this.IId=!0}XCl(){this.IId=!1;this.$Jd&&(this.$Jd=
!1,this.AYc())}qPf(){if(this.Q4a.length<this.vmf)return!1;for(let ya=0;ya<this.vmf;++ya)if(!this.Q4a[ya])return!1;return!0}AYc(){var ya=this.qPf();const La=window.performance.now(),Qa=new Ag(x.TellMeActor.instance.sdf);Qa.LYk(this.Q4a);for(var Eb=0;Eb<this.Q4a.length;++Eb){var fc=this.Q4a[Eb];if(fc&&fc.Lk&&fc.Lk.length&&(Qa.query=fc.query,fc.attributes&&0<fc.attributes.length&&(Qa.attributes=fc.attributes),fc&&fc.Lk&&(ya||this.iti(Eb,this.Q4a))))for(const mc of fc.Lk)Qa.Uq(mc)}Qa.Lk&&Qa.Lk.length&&
(Qa.bAb=ya,this.ub&&this.ub.D3e&&Qa.Rzl(),Ii.a.tng()&&(this.ub&&this.ub.SUj&&Qa.query.zf&&0<Qa.query.zf.length?Qa.lql():Qa.kql()),Ii.a.tng()&&this.ub&&(this.ub.ele||this.ub.w0c)&&this.EAc&&Qa.query.zf&&0<Qa.query.zf.length&&Qa.bAb&&this.qPa!==e.a.contextMenu?(3===this.ub.Aq&&ya||this.xD.resultsUpdated(Qa),Qa.mql(this.xD)):this.xD.resultsUpdated(Qa),ya=x.TellMeActor.instance.Hd,Qa.bAb&&ya&&(Eb=Qa.query.QZa,fc=ya.Pxc,Qa.query.zf&&0<Qa.query.zf.length&&this.EAc&&this.ub.N0c&&this.qPa!==e.a.contextMenu&&
Eb>fc&&!this.ub.ele&&!this.ub.QH&&(ya.hpe(Qa.query.zf),ya.OVe(Eb)),ya.CH(n.a.H4k,window.performance.now()-La)))}iti(ya,La){if(!(this.Gqb&&ya.toString()in this.Gqb)||La.length<=ya||!La[ya])return!1;if(!La[ya].Lk.length)return!0;const Qa=this.Gqb[ya.toString()];if(0===Qa)return!0;const Eb=this.Gqb;for(let mc in Eb){var fc=Eb[mc];const Mc=Number.parseInvariant(mc);if(Mc!==ya&&fc===Qa&&!(La.length>Mc&&La[Mc]))return!1}return!0}}Object(h.a)(aj,"ResultsAggregator",null,[]);var Xg=d(1015);class Qi{constructor(){this.rOb=
this.sOb=this.qOb=this.logCount=this.logRank=this.invertedRank=0}F6h(ya,La){switch(ya){case 1:this.invertedRank=La;break;case 3:this.logRank=La;break;case 2:this.logCount=La;break;case 5:this.qOb=La;break;case 4:this.sOb=La;break;case 6:this.rOb=La}}}Object(h.a)(Qi,"CommandFeatures",null,[]);class Jh{constructor(ya){this.icf=0;this.ppb=ya;this.QPh={}}get modelId(){return this.ppb}get featureIntercept(){return this.icf}get z0b(){return this.QPh}L5h(ya,La,Qa){0===La?this.icf=Qa:(this.z0b[ya]||(this.z0b[ya]=
new Qi),this.z0b[ya].F6h(La,Qa))}}Object(h.a)(Jh,"CoefficientsModel",null,[]);const Og=(ya,La)=>Math.pow(10,-La/(60*Math.LN10/Math.LN2*ya));class Qh{constructor(ya,La){this.Xk=1;this.Lyc=new Qi;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=ya?1/ya:0;this.features.logRank=2/Math.pow(2,ya);this.features.qOb=Og(10,La);this.features.sOb=Og(2,La);this.features.rOb=Og(1,La)}get count(){return this.Xk}get features(){return this.Lyc}FDj(){this.Xk=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}LGl(ya){const La=2/Math.pow(2,ya);this.features.invertedRank=Math.max(this.features.invertedRank,ya?1/ya:0);this.features.logRank=Math.max(this.features.logRank,La)}YHl(ya){const La=Og(10,ya),Qa=Og(2,ya);ya=Og(1,ya);this.features.qOb=Math.max(this.features.qOb,La);this.features.sOb=Math.max(this.features.sOb,Qa);this.features.rOb=Math.max(this.features.rOb,ya)}}Object(h.a)(Qh,"CommandModel",null,[]);class Yg{constructor(ya){this.fRb=null;if(!ya&&x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("PredictionEngine",
"IModelAdapter can't be null");this.opb=ya;this.ABc=this.Doe()}Doe(){const ya=this.opb.nej(),La=this.opb.h9d();if(void 0===ya||null===ya||void 0===La||null===La)return!1;try{window.performance.now();this.fRb={};for(let Qa=0;Qa<ya.length;Qa++){const Eb=ya[Qa],fc=La[Eb[0].toString()].trim(),mc=Eb[1],Mc=0!==mc?La[Eb[2].toString()].trim():"",nd=Eb[3];fc in this.fRb||(this.fRb[fc]=new Jh(fc));this.fRb[fc].L5h(Mc,mc,nd)}}catch(Qa){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("LoadModelData",
"Error Loading Suggestions Model: "+Qa);return!1}return!0}V2i(){const ya=this.opb.Sbj(),La={};if(!ya)return La;let Qa=1;for(let Eb=0;Eb<ya.length;Eb++){const fc=ya[Eb];fc.Id in La?(La[fc.Id].FDj(),La[fc.Id].LGl(Qa),La[fc.Id].YHl(fc.TimeElapsedSinceClick)):La[fc.Id]=new Qh(Qa,fc.TimeElapsedSinceClick);Qa++}return La}fle(){this.ABc||(this.ABc=this.Doe());return this.ABc}Wgj(){let ya=[];if(!this.ABc){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("GetPredictedCommands","IModelAdapter returned no data");
return ya}const La=this.V2i(),Qa=this.fRb;for(let fc in Qa){const mc=Qa[fc],Mc=mc.modelId;let nd=0;for(let ba in La){var Eb=ba;const Aa=La[ba].features;(Eb=Eb in mc.z0b?mc.z0b[Eb]:null)&&(nd+=Aa.invertedRank*Eb.invertedRank+Aa.logRank*Eb.logRank+Aa.logCount*Eb.logCount+Aa.qOb*Eb.qOb+Aa.sOb*Eb.sOb+Aa.rOb*Eb.rOb)}nd+=mc.featureIntercept;ya.push(new Ue.a(Mc,nd))}ya.sort((fc,mc)=>fc.score<mc.score?1:fc.score>mc.score?-1:0);0<ya.length-10&&(ya=ya.slice(0,10));return ya}}Object(h.a)(Yg,"PredictionEngine",
null,[]);class If{constructor(){this.zof={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}nSc(ya,
La){return La&&"word"===La.application.toLowerCase()&&ya in this.zof?this.zof[ya]:[]}}Object(h.a)(If,"SuggestionResultsUtility",null,[]);class mj{constructor(ya,La,Qa){this.ub=La;this.dVb=new Yg(ya);this.sS=Qa;this.Vpf=new If}$D(){return"Suggestion"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(ya,La,Qa,Eb=e.a.tellMe,fc=null){Qa=new y.a(ya);x.TellMeActor.instance.bvc=!1;if((!fc||Array.contains(fc,16))&&A.a.MF(ya)){if(!this.dVb.fle()){if(x.TellMeActor.instance.Hd)x.TellMeActor.instance.Hd.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.kme()&&0<this.Vpf.nSc(x.TellMeActor.instance.KMc,this.ub).length){const Mc=this.Vpf.nSc(x.TellMeActor.instance.KMc,this.ub);fc=[];for(var mc of Mc)this.ub.Mqd&&"Find"===mc||fc.push(new Ue.a(mc,0));x.TellMeActor.instance.bvc=!0}else fc=this.dVb.Wgj();Od.CommandResultsUtility.y2c(fc,!0,"Recommended","LRE");mc=[];for(const Mc of fc)this.sS&&this.sS.iXd(Mc.commandId)||
mc.push(Mc);ya=Od.CommandResultsUtility.vUc(ya,mc,this.ub,null,null,null,16,1);0<ya.results.length&&Eb!==e.a.contextMenu&&(ya.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<ya.results.length&&Qa.Uq(ya)}La.resultsUpdated(Qa)}kme(){return!!this.ub&&(this.ub.kme||this.ub.hZj)}}Object(h.a)(mj,"SuggestionResultsProvider",null,[602]);class xi{Sbj(){return x.TellMeActor.instance.vzd}nej(){return window.TellMeSuggestionModel}h9d(){return window.CoefficientModelIdMap}}Object(h.a)(xi,"SuggestionsModelAdapter",
null,[866]);var Bj=d(1049),yi=d(989);d.d(aa,"AggregatorResultsProvider",function(){return Zg});class Zg{constructor(ya=!1){this.Mpb={};this.Mpb[e.a.tellMe]=[];this.Mpb[e.a.contextMenu]=[];this.EAc=ya}Qog(ya,La,Qa,Eb,fc=null){let mc;var Mc=!1;switch(Eb){case e.a.contextMenu:mc=this.Mpb[e.a.contextMenu];Mc=!0;break;default:mc=this.Mpb[e.a.tellMe]}La=new aj(La,mc,Mc,this.EAc,Eb);La.vFk();for(let nd=0;nd<mc.length;++nd){const ba=window.performance.now(),Aa=new G(La,nd);(Mc=x.TellMeActor.instance.WG())&&
Mc.dki?window.setTimeout(()=>{mc[nd].iB(ya,Aa,Qa,Eb,fc);if(x.TellMeActor.instance.Hd){const Wa={};Wa[r.a.provider]=mc[nd].$D();Wa[r.a.gib]=ya.QZa;x.TellMeActor.instance.Hd.CH(n.a.iB,window.performance.now()-ba,Wa)}},0):(mc[nd].iB(ya,Aa,Qa,Eb,fc),x.TellMeActor.instance.Hd&&(Mc={},Mc[r.a.provider]=mc[nd].$D(),Mc[r.a.gib]=ya.QZa,x.TellMeActor.instance.Hd.CH(n.a.iB,window.performance.now()-ba,Mc)))}La.XCl()}$D(){return"Aggregator"}pL(){return 0}iB(ya,La,Qa=!1,Eb=e.a.tellMe,fc=null){if(x.TellMeActor.instance.Wnk)this.Qog(ya,
La,Qa,Eb,fc);else{const mc=window.performance.now();x.TellMeActor.instance.kLl.then(()=>{x.TellMeActor.instance.Hd&&x.TellMeActor.instance.Hd.CH(n.a.Xnk,window.performance.now()-mc);this.Qog(ya,La,Qa,Eb,fc);return!0})}}Uy(ya,La){this.Mpb[La].push(ya)}w7h(ya){switch(ya){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const La=this.Mpb[e.a.tellMe];for(const Qa of La)if("FindInDocument"===Qa.$D()){Qa.$cl(ya);break}}}static createInstance(ya,La,Qa,Eb){const fc=
La.t3;var mc=Eb&&A.a.lYe(La),Mc=mc&&La.KJe&&!fc;const nd=La.Xme&&!A.a.wbb()&&!fc,ba=La.nle&&!fc,Aa=new Zg(mc);if(La.Gkl&&!fc){var Wa=new rg(La);Aa.Uy(Wa,e.a.tellMe)}Wa=La.Po?yh.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):yh.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const gb=!Wa&&yh.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");Aa.Uy(new fe.a(ya,La.ABl,gb,!1),e.a.tellMe);Wa&&!fc&&Aa.Uy(new mj(new xi,La,ya),e.a.tellMe);ya=yh.AFrameworkApplication.Aa.hb.Yng?
new pg(La,new Nh):new Hj(La,Qa);Aa.Uy(ya,e.a.contextMenu);(mc&&La.LJe||Mc)&&Aa.Uy(Bj.a.cMf(La,!0),e.a.tellMe);Aa.Uy(ya,e.a.tellMe);!La.bZi||fc||"Word"===La.application&&La.CWf||Aa.Uy(new Wg(La),e.a.tellMe);La.x6a&&!fc&&(Mc=new O(La),Aa.Uy(Mc,e.a.tellMe),Aa.Uy(Mc,e.a.contextMenu));!La.isb||La.rrc||La.qrc||fc||Aa.Uy(new R.a(La),e.a.tellMe);Eb&&(La.bFa||A.a.j4())&&(Mc=new Fe(La),Aa.Uy(Mc,e.a.tellMe),Aa.Uy(Mc,e.a.contextMenu));mc&&Aa.Uy(Bj.a.cMf(La,!1),e.a.tellMe);Eb&&!La.E0e&&A.a.kYe(La)&&!fc&&(Aa.Uy(new Xg.a(La),
e.a.tellMe),La.ltl&&Aa.Uy(new Xg.a(La),e.a.contextMenu));nd&&Aa.Uy(new Zh(La),e.a.tellMe);!La.UMb&&!La.QH||fc||Aa.Uy(new $h.a(La),e.a.tellMe);La.Gac&&!fc&&Aa.Uy(new yi.a(La),e.a.tellMe);La.MYc&&(mc=new u(La),Aa.Uy(mc,e.a.tellMe),Aa.Uy(mc,e.a.contextMenu));Eb&&La.OYc&&!fc&&Aa.Uy(new K.AddinResultsProvider(La),e.a.tellMe);ba&&"Excel"===La.application&&!fc&&Aa.Uy(new kb(La),e.a.tellMe);return Aa}}Object(h.a)(Zg,"AggregatorResultsProvider",null,[602])},1015:function(J,aa,d){J=d(0);var h=d(144),e=d(675),
r=d(383),n=d(263);class v{constructor(ea,ra,F,na,ka,Ua){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=ea;this.url=ra;this.spWebUrl=F;this.uniqueId=na;this.size=ka;this.lastModified=Ua}}Object(J.a)(v,"FileInfo",null,[]);var B=d(452);class y{constructor(ea,ra){this.DimensionValue=this.DimensionName=null;this.DimensionName=ea;this.DimensionValue=ra}}Object(J.a)(y,"Dimension",null,[]);class x{constructor(ea,ra,F,na,ka){this.Query=this.EntityType=null;
this.Size=this.From=0;this.Filter=null;this.EntityType=ea;this.Query=ra;this.From=F;this.Size=na;ka&&(this.Filter=ka)}}Object(J.a)(x,"EntityRequest",null,[]);class A{constructor(ea){this.QueryString=null;this.QueryString=ea}}Object(J.a)(A,"Query",null,[]);var E=d(156);class u{constructor(ea,ra){this.Dimensions=this.Name=null;this.Name=ea;this.Dimensions=ra}}Object(J.a)(u,"Scenario",null,[]);var K=d(171),G=d(170);class O{constructor(ea,ra,F,na){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=
null;this.EntityRequests=ea;this.TimeZone=ra;this.Cvid=F;this.Scenario=na}}Object(J.a)(O,"SubstrateBody",null,[]);var R=d(451),V=d(117),D=d(104),Q=d(27),Z=d(940),P=d(939),ca=d(305),T=d(36),da=d(47),fa=d(109);d.d(aa,"a",function(){return ma});class ma{constructor(ea){this.rVb=this.YOa=this.MBc=this.DSb=this.QVb=0;this.dkf=this.Klf=this.jI=null;this.PFd=0;this.gS=-1;this.sXb="";this.aCd=!1;this.Yh=Q.AFrameworkApplication.Ke;this.ub=ea;this.DEc=this.gae();this.W4a=new e.a;this.bjf=this.ub.D3e?3:2;this.HMd=
this.ub.D3e&&this.ub.Twh?5:3;this.pOd=this.ub.Mqd?2:3;this.Wrf=1;this.oBc=this.ub.d5f;this.tpf=this.ub.oWj;this.sWb=ea.F7f;Q.AFrameworkApplication.fa&&(this.Klf=Q.AFrameworkApplication.fa.Ga("AppCatalogUrl")+Q.AFrameworkApplication.fa.Ga("SearchPersonaPhotoBaseUrl"),this.aCd=this.ub.t3||this.ub.ROc);this.ub.t3&&(this.pOd=this.HMd=5)}$D(){return"Substrate"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:3}iB(ea,ra,F,na=h.a.tellMe,ka=null){const Ua=new G.a(ea);if(!ka||Array.contains(ka,14)||Array.contains(ka,
15)||Array.contains(ka,20))if(!this.PFd||window.performance.now()-this.PFd>=D.a.Ltd)if(F=this.W4a.h8f())this.PFd=window.performance.now(),F.then(za=>{za&&""!==za?(this.sXb=za,""!==this.jI&&this.g8f(ea,na,this.sXb,ra,ka)):(V.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ra.resultsUpdated(Ua))},za=>{V.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+za);ra.resultsUpdated(Ua)});else{if(V.TellMeActor.instance.Hd)V.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");ra.resultsUpdated(Ua)}else this.sXb&&""!==this.sXb?this.g8f(ea,na,this.sXb,ra,ka):(ra.resultsUpdated(Ua),V.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ra.resultsUpdated(Ua)}n1(){this.YOa=this.rVb=this.MBc=this.DSb=this.QVb=0}g8f(ea,ra,F,na,ka){this.n1();const Ua=new G.a(ea),za=this.jI=fa.a.create().toString();this.gja();this.gS=window.setTimeout(()=>{if(za===this.jI){this.jI="";this.gS=-1;na.resultsUpdated(Ua);
const Ga={};Ga[r.a.provider]=this.$D();Ga[r.a.gib]=ea.QZa;V.TellMeActor.instance.Hd.CH(n.a.timedOut,this.sWb,Ga)}},this.sWb);const ha={"Content-Type":"application/json",Accept:"application/json"};ha.Authorization="Bearer "+F;ha["X-Office-Version"]=Q.AFrameworkApplication.buildVersion;ha["X-Office-Application"]=Q.AFrameworkApplication.fa.Ga("Application");ha["X-Office-Platform"]="WAC";ha["X-TellMe-SessionId"]=V.TellMeActor.instance.bVc();ha["X-TellMe-Culture"]=Q.AFrameworkApplication.uiCulture;ha["X-TellMe-ProcessSessionId"]=
Q.AFrameworkApplication.userSessionId;ha["Client-Request-Id"]=za;const ua=window.performance.now();this.Yh.nj(this.omj(),2,this.pmj(ea.zf,this.ub.application,V.TellMeActor.instance.bVc(),D.a.MF(ea)),ha,!1,0,Ga=>{this.ihb(Ga,ea,na,za,ua,ra,ka)},Ga=>{this.Xgb(Ga,ea,na,za,ua)},null,null,!1,4E3,6E3)}gja(){-1!==this.gS&&(window.clearTimeout(this.gS),this.gS=-1)}ihb(ea,ra,F,na,ka,Ua,za){V.TellMeActor.instance.Hd.I5(ra.zf.length,this.DEc.join(","),ea.data.ie.toString(),Math.round(window.performance.now()-
ka),R.a.substrate,!0,B.a.Tta);const ha=D.a.MF(ra),ua=new G.a(ra);if(na===this.jI){this.gja();ea=T.b(ea.data.Wd);if(ea.Groups){ea=ea.Groups;for(const Ga of ea)"People"===Ga.Type&&this.ub.ltc&&(za?Array.contains(za,14):1)?(ea=this.H5f(Ga.Suggestions,ha,Ua),0<ea.results.length&&ua.Uq(ea)):"File"===Ga.Type&&this.ub.jtc&&(za?Array.contains(za,15):1)?(ea=this.F7d(Ga.Suggestions,ha,Ua),0<ea.results.length&&(this.XZc()&&(na=new E.a("GenerateSlidesFromTellMe",29,"",null,1),ea.ls(na)),ua.Uq(ea))):"Notes"===
Ga.Type&&this.ub.jVa&&Ua!==h.a.contextMenu&&(za?Array.contains(za,20):1)&&(ea=this.a5f(Ga.Suggestions,ha,ra),0<ea.results.length&&ua.Uq(ea))}F.resultsUpdated(ua);V.TellMeActor.instance.Hd.I5(ra.zf.length,this.DEc.join(","),"",Math.round(window.performance.now()-ka),"",!0,B.a.provider)}else F.resultsUpdated(ua)}a5f(ea,ra,F){const na=new K.a(20);na.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ka of ea)this.xYj(ka)&&(ea=ka.NotesType,ea=da.a.rg(ea),ea=this.ofj(ea,ka.LastModifiedTime,
ka.BodyPreview,ka.Subject,ra,F,ka))&&(ea.groupType=20,na.ls(ea));return na}H5f(ea,ra,F){const na=new K.a(14);na.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Ua of ea)if(this.yYj(Ua)){var ka=Ua.Id.split("@")[0];ea=Ua.EmailAddresses[0];let za=Ua.Type;if(void 0===za||null===za)za="User";if(ka=this.zgj(za,Ua.DisplayName,Ua.JobTitle,ea,ka,F,ra))ka.description=ea,ea=Ua.JobTitle,"Department"in Ua&&"CompanyName"in Ua&&(ea+="@"+Ua.Department+"@"+Ua.CompanyName),ka.EQd=ea,na.ls(ka)}return na}F7d(ea,
ra,F){const na=new K.a(15);na.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ga of ea)if(this.oYj(Ga)){var ka=Ga.FileName;ea=Ga.FileExtension;var Ua=ka;ka.length>ea.length&&Ua.endsWith(ea)&&(Ua=ka.substr(0,ka.length-ea.length-1));var za=void 0,ha=0;"DateCreated"in Ga&&Ga.DateCreated?(ha=D.a.Hae(Ga.DateCreated),za=D.a.U8f(Ga.DateCreated),za=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ga.Author,za)):za=Ga.Author;var ua=Ga.AccessUrl+"?web=1";const sa=da.a.x8b(ua);ka=String.format('<a href="{0}">{1}</a>',
sa,da.a.aUa(ka));if(F!==h.a.contextMenu||da.a.n9(ua))if(Ua=this.Q$i(Ua,F===h.a.contextMenu?ka:ua,za,Ga.FileExtension,Ga.Text,ra))Ua.description=Ga.Author,Ua.xHc=ha,na.ls(Ua),this.aCd&&(ha=Ga.AccessUrl,ka=D.a.$Sc(ea),za=Ga.DateModified?Ga.DateModified:Ga.DateCreated,ua=Ga.Size?Ga.Size:Ga.FileSize,this.Qjl()&&(ha=ha.replace(RegExp("%20","g")," "),ka=D.a.tlj(ea)),ea=new v(ka,ha,Ga.SPWebUrl,Ga.Id,ua,za),V.TellMeActor.instance.r5e(!1,Ua.value,ea))}return na}Xgb(ea,ra,F,na,ka){na===this.jI&&(this.gja(),
V.TellMeActor.instance.Hd.I5(ra.zf.length,this.DEc.join(","),ea.data.ie.toString(),Math.round(window.performance.now()-ka),R.a.substrate,!1,B.a.Tta));ea=new G.a(ra);F.resultsUpdated(ea)}zgj(ea,ra,F,na,ka,Ua,za){za=za?this.Wrf:this.bjf;if(!window.LPC&&!D.a.Rje()||this.QVb===za)return null;this.QVb+=1;za="PeopleSuggestion"+this.QVb.toString();var ha=this.Klf+"?size=1&accountName="+na;ea=Object.assign(new Z.a,{PersonaType:ea,Smtp:na,ProfilePictureUrl:ha,AadObjectId:ka});const ua=Object.assign(new P.a,
{identifiers:ea,displayName:ra});ea=Ua===h.a.contextMenu;this.ub.tda?(V.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(za,ua,ra,F)),Ua===h.a.contextMenu&&(F=D.a.MLf(ra,na,ka),V.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(za,F))),V.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(za,ea))):(ha=[],ha.push(appChrome.actions.setPersonaButtonCoauthor(za,ua,ra,F)),Ua===h.a.contextMenu&&(F=D.a.MLf(ra,
na,ka),ha.push(appChrome.actions.setButtonCommandValueId(za,F))),ha.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(za,ea)),appChrome.api.dispatch(ha));return new E.a(za,11,ra,na,0)}ofj(ea,ra,F,na,ka,Ua,za){if(ka&&!this.ub.bog||this.MBc===this.oBc||this.rVb===this.oBc||this.YOa===this.oBc)return null;var ha=null;this.MBc+=1;ka="";const ua=[],Ga={};za.type="Notes";this.dkf=Object.assign(new ca.a,{landingTab:"Notes",data:za});Ua=D.a.PCa(Ua.zf,33,this.dkf);if("onenotepagepreviews"===
ea){if(!("ClickthroughUrl"in za&&za.ClickthroughUrl)||""===za.ClickthroughUrl)return null;this.rVb+=1;ka="OnenoteNotesSuggestion"+this.rVb.toString();Ga["default"]="SaveAsonetoc2_20";ha=za.ClickthroughUrl;ua.push(appChrome.actions.setControlIconSet(ka,Ga));ua.push(appChrome.actions.setCompoundButtonCommandValueId(ka,ha));ha=new E.a(ka,19,null,null,0)}else if("stickynote"===ea){if(!this.tpf)return null;this.YOa+=1;ka="NotesSuggestion"+this.YOa.toString();Ga["default"]="ShowAllNotes_20";ua.push(appChrome.actions.setControlIconSet(ka,
Ga));ua.push(appChrome.actions.setCompoundButtonCommandValueId(ka,Ua));ha=new E.a(ka,21,null,null,0)}else if("samsung"===ea){if(!this.tpf)return null;this.YOa+=1;ka="NotesSuggestion"+this.YOa.toString();Ga["default"]="CategoryCollapsed_20";ua.push(appChrome.actions.setControlIconSet(ka,Ga));ua.push(appChrome.actions.setCompoundButtonCommandValueId(ka,Ua));ha=new E.a(ka,20,null,null,0)}""!==ka&&(ea=D.a.U8f(ra),ea=String.format(CommonUIStrings.l_LastModifiedString,ea),ha.label=na,ha.xHc=D.a.Hae(ra),
ua.push(appChrome.actions.setControlLabel(ka,na)),ua.push(appChrome.actions.updateCompoundButtonDescription(ka,ea)),ua.push(appChrome.actions.setControlCustomTooltip(ka,F)),appChrome.api.dispatch(ua));return ha}Q$i(ea,ra,F,na,ka,Ua){if(this.DSb===(Ua?this.pOd:this.HMd)||this.aCd&&"Word"!==D.a.$Sc(na))return null;this.DSb+=1;Ua="FileSuggestion"+this.DSb.toString();const za=[],ha={};ha["default"]=D.a.pbj(na);this.ub.tda?(V.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ua,ea)),
V.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Ua,ha)),V.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ua,F)),V.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ua,ra)),V.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ua,ka))):(za.push(appChrome.actions.setControlLabel(Ua,ea)),za.push(appChrome.actions.setControlIconSet(Ua,ha)),za.push(appChrome.actions.updateCompoundButtonDescription(Ua,
F)),za.push(appChrome.actions.setCompoundButtonCommandValueId(Ua,ra)),za.push(appChrome.actions.setControlCustomTooltip(Ua,ka)),appChrome.api.dispatch(za));return new E.a(Ua,6,ea,F,0)}gae(){const ea=[];this.ub.ltc&&Array.add(ea,"People");this.ub.jtc&&Array.add(ea,"File");this.ub.jVa&&Array.add(ea,"Notes");return ea}pmj(ea,ra,F,na){var ka=new A(ea);ea=new x("File",ka,0,na?this.pOd:this.HMd,null);na=new x("People",ka,0,na?this.Wrf:this.bjf,D.a.FFk);ka=new x("Notes",ka,0,this.oBc,null);this.ub.ROc&&
"powerpoint"===ra.toLowerCase()&&(ra="word");ra=new y("app",ra.toLowerCase());var Ua=[];Array.add(Ua,ra);ra=new u("tellmesearch",Ua);Ua=[];this.ub.jtc&&Array.add(Ua,ea);this.ub.ltc&&Array.add(Ua,na);this.ub.jVa&&Array.add(Ua,ka);F=new O(Ua,"UTC",F,ra);return T.c(F)}omj(){let ea=this.ub.mtl;this.ub.jVa&&(ea+="?&setflight=NotesFrom3S");""!==this.ub.i8f&&(ea=ea+"&"+this.ub.i8f);return ea}yYj(ea){return"DisplayName"in ea&&"Id"in ea&&"EmailAddresses"in ea&&!!ea.Id&&!!ea.EmailAddresses}oYj(ea){return"FileExtension"in
ea&&!!ea.FileExtension&&"FileName"in ea&&!!ea.FileName&&""!==ea.FileName&&"AccessUrl"in ea&&!!ea.AccessUrl&&""!==ea.AccessUrl}xYj(ea){return"Id"in ea&&!!ea.Id&&"NotesType"in ea&&!!ea.NotesType&&"Subject"in ea&&!!ea.Subject&&""!==ea.Subject}XZc(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Qjl(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",
!0)}}Object(J.a)(ma,"SubstrateResultsProvider",null,[602])},104:function(J,aa,d){J=d(0);var h=d(16);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(J.a)(e,"InsertMentionParameters",null,[]);class r{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(r,"InsightsParameters",null,[]);var n=d(983),v=d(984),B=d(985),y=d(986),x=d(27),A=d(334),E=d(447),u=d(36),K=d(55),G=d(47),O=d(125);d.d(aa,"a",function(){return R});class R{static get vIj(){return"Insights_16x16x32"}static get aZi(){return"Find_16x16x32"}static get e$g(){return"-Parameterized"}static get YZe(){return"Parameterized"}static get tud(){return"bTryQuery"}static get g4e(){return"TellMeSuggestion_"}static get oFh(){return"bTryQueryAlternate"}static get M1e(){return"MenuTellMe"}static get FFk(){const V=
{},D=[];Array.add(D,{Term:{PeopleType:"Person"}});V.And=D;return V}static oJi(V){return V+R.e$g}static getParameter(V){let D="",Q="";if(V)for(let Z=0;Z<V.aWf;++Z)"Type"===V.z7d(Z)?D=V.eb(Z):"Value"===V.z7d(Z)&&(Q=V.eb(Z));return new h.a(D,Q)}static aZd(V){V=Object.assign(new r,{neighborhood:V,mentionStart:0,mentionLength:V.length});return u.c(V)}static MLf(V,D,Q){V=Object.assign(new e,{displayName:V,email:D,userId:Q});return u.c(V)}static PCa(V,D,Q=null){return u.c(R.J7f(V,D,Q,null))}static J7f(V,
D,Q=null,Z=null){V=Object.assign(new E.a,{neighborhood:V,mentionStart:0,mentionLength:V?V.length:0});return Object.assign(new A.a,{selection:V,userIntent:Z,entryPoint:D,launchData:Q})}static G4k(V,D){return R.PCa(V,R.umh(D))}static umh(V){switch(V){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static Sjg(){return!!x.AFrameworkApplication.fa&&x.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static wbb(){const V=
x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"):null;return!!V&&0<V.length}static isEnterpriseUser(){const V=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ga("HostAuthType"):null;return!!V&&"aad"===V.toLowerCase()||"external"===V&&R.Rje()}static lYe(V){return V.Rvl&&!R.wbb()}static Vmg(){const V=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ga("UiHostIntegrationType"):"";return!!x.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===V&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static kYe(V){return V.pza&&V.VXi&&(V.ltc||V.jtc||V.jVa)&&!R.Vmg()&&R.isEnterpriseUser()&&!R.wbb()}static j4(){return x.AFrameworkApplication.fa?x.AFrameworkApplication.Tya||x.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):x.AFrameworkApplication.Tya}static MF(V){return!V||R.yng(V.zf)}static yng(V){return!V||!V.trim().length}static cud(V){if(!V)return 0;const D=Math.pow(10,5);return Math.round(V*D)/D}static Cxl(){var V=new Date;return V?new Date(V.getUTCFullYear(),V.getUTCMonth(),
V.getUTCDate(),V.getUTCHours(),V.getUTCMinutes(),V.getUTCSeconds(),V.getUTCMilliseconds()):null}static Hae(V){return(R.Cxl().getTime()-(new Date(V)).getTime())/1E3}static Xng(V){const {InsightsMenuItemFactory:D}=d(982);switch(V){case n.a.Xce:case v.a.wXf:case D.bgg:case B.a.N0g:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return V.startsWith(R.tud)||
V.startsWith(R.g4e)||V.startsWith(R.oFh)||V.startsWith("PeopleSuggestion")||V.startsWith("FileSuggestion")||V.startsWith("FindInDocumentSuggestion")||V.startsWith("NotesSuggestion")||V.startsWith("OnenoteNotesSuggestion")||V.startsWith("SmartLookupFromTellMe")||V.startsWith("GetHelpFromTellMe")||V.startsWith("GetHelpWithDescriptionFromTellMe")||V.startsWith("AddinSuggestion")||V.startsWith("OfficeScripts")?!0:!1}static V7d(V,D){const Q=[];Array.add(Q,new y.a(400,V));Array.add(Q,new y.a(200,D));V=
{};V.parts=Q;return JSON.stringify(V)}static CSa(V){const D=V.indexOf("<b0>"),Q=V.lastIndexOf("</b0>"),Z=[];Array.add(Z,new y.a(400,V.substring(0,D)));Array.add(Z,new y.a(600,V.substring(D+4,Q)));Array.add(Z,new y.a(400,V.substring(Q+5,V.length)));V={};V.parts=Z;return JSON.stringify(V)}static U8f(V){const D=R.Hae(V);return 60>D?CommonUIStrings.l_TimeSince_SecsAgo:3600>D?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(D/60).toString()):86400>D?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(D/3600).toString()):172800>D?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(V)).localeFormat("MMMM dd, yyyy"))}static X6i(V){const D=Array(V.length);for(let Q=0;Q<V.length;Q++)D[Q]=V[Q].commandId;return D}static Rje(){if("Dev Box"===x.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse"))return!0;let V=x.AFrameworkApplication.fa.Ga("UserPrincipalName");V=O.b(V)?"":G.a.rg(V);const D=x.AFrameworkApplication.fa.Eu("TellMeIntEnabledForFeatureCrew")?
x.AFrameworkApplication.fa.YA("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(D,V)&&"inner"===x.AFrameworkApplication.fa.Ga("Microsoft365Ring")}static pbj(V){switch(R.$Sc(V)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static tlj(V){V=R.$Sc(V);switch(V){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return V}}static $Sc(V){switch(V.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static px(){return K.a.DT&&!K.a.Vj}}R.Ltd=9E5;Object(J.a)(R,"TellMeUtils",null,[])},1049:function(J,aa,d){J=d(0);var h=d(18),e=d(144),r=d(675),n=d(383),v=d(263),B=d(452),y=d(156),x=d(171),A=d(170),E=d(117),u=d(104);class K{constructor(fa){this.ub=fa;this.DEc=this.gae()}$D(){return"Add-ins"}pL(){return 0===this.ub.Aq?
0:1===this.ub.Aq?1:3}iB(fa,ma){fa=new A.a(fa);ma.resultsUpdated(fa)}BTa(fa,ma,ea){let ra;ra=this.ub.QH?new x.a(28):new x.a(26);ra.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ea&&this.gol(fa.zf,ma,ra)}gol(fa,ma,ea){const ra=[];let F;F=this.ub.XJj?this.ub.QH&&this.ub.XPa?u.a.CSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,fa):this.ub.YJj?this.ub.QH&&this.ub.XPa?u.a.CSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,
fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,fa):this.ub.QH&&this.ub.XPa?u.a.CSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,fa);this.ub.tda?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",F)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",fa))):(ra.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
F)),ra.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",fa)),appChrome.api.dispatch(ra));ea.ls(new y.a("LaunchAddinDialogFromTellMe",28));ma.Uq(ea)}gae(){const fa=[];this.ub.OYc&&Array.add(fa,"Addin");return fa}}Object(J.a)(K,"AddinStoreResultsProvider",null,[602]);var G=d(987),O=d(335),R=d(384),V=d(988),D=d(1015),Q=d(989),Z=d(451),P=d(27),ca=d(36),T=d(109);d.d(aa,"a",function(){return da});class da{constructor(fa,ma,ea){this.ePa=this.$Wb=this.aXb=this.lEc=!1;this.jI=null;
this.gS=-1;this.oBa=this.zXb=this.qPa=this.q5a=null;this.Uhf=this.Whf=0;this.ub=fa;const ra=u.a.j4();this.uNa=ma||[];this.Yh=P.AFrameworkApplication.Ke;this.bpf=fa.LJe;this.bXb=fa.KJe;this.jEc=ra&&this.zkb();this.kEc=ra&&this.Akb();this.dpf=ra&&this.Bkb();this.nEc=this.VMb();this.uLd=this.UMb();if((ma=fa.E0e&&u.a.kYe(fa))||fa.t3)this.q5a=new D.a(fa),this.lEc=fa.jtc;ma&&(this.aXb=fa.ltc,this.$Wb=fa.jVa,this.ePa=this.lEc&&this.du("File")||this.aXb&&this.du("People")||this.$Wb&&this.du("Notes"));this.iEc=
this.ykl();this.cXb=fa.jlc;this.mEc=this.Mkl();this.tLd=this.xkl();this.Wza=this.hnj();this.I8e=new G.a(fa);this.ZTh=new V.a(fa);this.R2h=new Q.a(fa);this.SNh=new K(fa);this.sWb=ea;this.W4a=new r.a;this.cXb&&(this.I8e=new G.a(fa));fa.t3&&(this.tLd=this.mEc=this.cXb=this.ePa=this.$Wb=this.aXb=this.uLd=this.nEc=this.dpf=this.kEc=this.jEc=this.bXb=!1,P.AFrameworkApplication.fa&&this.du("File")&&this.Nvh()&&(fa=this.W4a.Lae("Search",P.AFrameworkApplication.fa.Ga("TellMeServiceAuthEndpointForSearch"),
!0),this.i4b(fa,"TellMeService",!0),fa=this.W4a.Lae("SmartLookup",P.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint"),!1),this.i4b(fa,"Shredder",!1)));P.AFrameworkApplication.fa&&this.ePa&&this.du("File")&&this.Nvh()&&(fa=this.W4a.Lae("Search",P.AFrameworkApplication.fa.Ga("TellMeServiceAuthEndpointForSearch"),!0),this.i4b(fa,"TellMeService",!0))}du(fa){return Array.contains(this.uNa,fa)?!0:!1}$D(){return"TellMeService"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:this.du("Command")||
this.du("Recommended")?2:3}enj(fa){let ma="";if(!fa&&this.du("Command")&&this.ub.hle){ma+="CommandSearch_DLIS,";var ea=this.ub.kCh;0<ea.length&&(ma+=ea+",")}fa&&this.du("Recommended")&&this.bXb&&(ea=this.Npj(),0<ea.length&&(ma+=ea+","));!fa&&this.du("Help")&&(fa=this.ub.jCh,0<fa.length&&(ma+=fa+","));this.ub.t3&&this.oBa&&0<this.oBa.length&&(ma+="IsRecallEnabled_true,");(this.ub.ROc||this.ub.t3)&&this.ePa&&(ma+="IsGenerateSlidesEnabled_true,");0<ma.length&&(ma=ma.substr(0,ma.length-1));return ma}i4b(fa,
ma,ea){const ra=ea?this.Whf:this.Uhf;if(!ra||window.performance.now()-ra>=u.a.Ltd)if(fa)ea?this.Whf=window.performance.now():this.Uhf=window.performance.now(),fa.then(F=>{ea?this.zXb=F:(this.oBa=F,E.TellMeActor.instance.SZe=F)},F=>{E.TellMeActor.instance.Hd.onError("TellMeServiceProvider:FetchTokenForService_"+ma,"tellMeServiceToken promise rejected: "+F)});else if(E.TellMeActor.instance.Hd)E.TellMeActor.instance.Hd.onError("TellMeServiceProvider:FetchTokenForService_"+ma,"undefined token promise")}iB(fa,
ma,ea,ra=e.a.tellMe,F=null){const na=new A.a(fa);ea=u.a.MF(fa);this.du("File")&&(this.ePa||this.ub.t3)&&this.i4b(this.W4a.inj(),"TellMeService",!0);this.du("File")&&this.ub.t3&&this.i4b(this.W4a.Pkj(),"Shredder",!1);var ka=this.ePa&&!!this.zXb;const Ua=this.ub.t3&&!!this.oBa;var za=ka||Ua||ea&&this.du("Recommended")&&this.bXb;ka=ka||Ua||!ea&&(this.bpf&&this.du("Command")||this.jEc&&this.du("Answer")||this.kEc&&this.du("Definition")||this.uLd&&this.du("Image")||this.cXb&&this.du("Help")||this.nEc&&
this.du("WolframAnswer")||this.mEc&&this.du("Template")||this.tLd&&this.du("Addin"));if(za||ka)if(this.qPa=ra,ra={"Content-Type":"application/json",Accept:"application/json"},ra["X-Office-Version"]=P.AFrameworkApplication.buildVersion,ra["X-Office-Application"]=P.AFrameworkApplication.fa.Ga("Application"),ra["X-Office-Platform"]="WAC",ra["X-TellMe-SqmUserId"]=P.AFrameworkApplication.fa.Ga("LoggableUserId")||"",ra["X-TellMe-SessionId"]=E.TellMeActor.instance.bVc(),this.zXb&&(ra.Authorization="Bearer "+
this.zXb),this.oBa&&0<this.oBa.length&&(ra["X-TellMe-ShredderToken"]="Bearer "+this.oBa),za=this.enj(ea),0<za.length&&(ra["X-TellMe-Flights"]=za),za=[],!ea&&this.du("Answer")&&this.jEc&&(F?Array.contains(F,9):1)&&Array.add(za,"Answer"),!ea&&this.du("Command")&&this.bpf&&!O.CommandResultsUtility.yje(fa.zf)&&(F?Array.contains(F,17):1)&&Array.add(za,"Command"),!ea&&this.du("Definition")&&this.kEc&&(F?Array.contains(F,10):1)&&Array.add(za,"Definition"),!ea&&this.du("Help")&&this.cXb&&(F?Array.contains(F,
8):1)&&Array.add(za,"Help"),!ea&&this.du("WolframAnswer")&&this.nEc&&(F?Array.contains(F,12):1)&&Array.add(za,"WolframAnswer"),ea&&this.du("Recommended")&&this.bXb&&!E.TellMeActor.instance.bvc&&(F?Array.contains(F,18):1)&&Array.add(za,"Recommended"),!ea&&this.du("Image")&&this.uLd&&(F?Array.contains(F,19):1)&&Array.add(za,"Image"),this.zXb&&this.ePa&&(F?Array.contains(F,14)||Array.contains(F,15)||Array.contains(F,20):1)&&(this.q5a.n1(),this.lEc&&this.du("File")&&Array.add(za,"File"),this.aXb&&this.du("People")&&
Array.add(za,"People"),this.$Wb&&this.du("Notes")&&Array.add(za,"Notes")),this.oBa&&0<this.oBa.length&&this.ub.t3&&(F?Array.contains(F,15):1)&&(this.q5a.n1(),this.du("File")&&Array.add(za,"File")),!ea&&this.du("Template")&&this.mEc&&(F?Array.contains(F,23):1)&&Array.add(za,"Template"),!ea&&this.du("Addin")&&this.tLd&&(F?Array.contains(F,26):1)&&Array.add(za,"Addin"),za.length){ra["X-TellMe-SuggestionTypes"]=za.join(",");ra["X-TellMe-Culture"]=P.AFrameworkApplication.uiCulture;ra["X-TellMe-ProcessSessionId"]=
P.AFrameworkApplication.userSessionId;var ha=this.jI=T.a.create().toString();ra["Client-Request-Id"]=ha;var ua=window.performance.now();this.gja();this.gS=window.setTimeout(()=>{if(ha===this.jI){this.jI="";this.gS=-1;ma.resultsUpdated(na);const Ga={};Ga[n.a.provider]=this.$D();Ga[n.a.gib]=fa.QZa;E.TellMeActor.instance.Hd.CH(v.a.timedOut,this.sWb,Ga)}},this.sWb);this.Yh.nj(this.Wza,2,this.gnj(fa.zf),ra,!1,0,Ga=>{this.ihb(Ga,fa,ma,ha,ua,F)},Ga=>{this.Xgb(Ga,fa,ma,ha,ua)},null,null,!1,4E3,6E3)}else E.TellMeActor.instance.Hd.onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),ma.resultsUpdated(na);else ma.resultsUpdated(na)}gja(){-1!==this.gS&&(window.clearTimeout(this.gS),this.gS=-1)}ihb(fa,ma,ea,ra,F,na){const ka=new A.a(ma);if(ra===this.jI){this.gja();E.TellMeActor.instance.Hd.I5(ma.zf.length,this.uNa.join(","),fa.data.ie.toString(),Math.round(window.performance.now()-F),Z.a.tellMe,!0,B.a.Tta);ra=fa.data.Wd;fa=null;try{fa=ca.b(ra)}catch(sa){E.TellMeActor.instance.Hd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+
sa);return}ra=u.a.MF(ma);if("Groups"in fa&&fa.Groups){var Ua=fa.Groups;for(var za of Ua)if("GroupType"in za&&"Suggestions"in za&&za.Suggestions)if("Commands"===za.GroupType&&(na?Array.contains(na,17):1)||"Recommended"===za.GroupType&&(na?Array.contains(na,18):1)){var ha=(Ua="Recommended"===za.GroupType)?"DLIS":"NaiveBayes";"Source"in za&&za.Source&&(ha=za.Source);var ua=za.Suggestions;new h.a;var Ga=[];for(const sa of ua)this.lYj(sa)&&(ua=sa.Type,("Command"===ua||Ua&&"Recommended"===ua)&&Ga.push(new R.a(sa.CommandId,
sa.Score)));O.CommandResultsUtility.y2c(Ga,!ma.zf.trim().length,za.GroupType,ha);ha=E.TellMeActor.instance.sS;ua=[];for(const sa of Ga)Ua&&ha&&ha.iXd(sa.commandId)||ua.push(sa);Ga=O.CommandResultsUtility.vUc(ma,ua,this.ub,null,null,null,Ua?18:17,0);0<Ga.results.length&&(this.qPa!==e.a.contextMenu&&(Ga.displayName=Ua?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ka.Uq(Ga))}else if("Answer"===za.GroupType){ua=za.Suggestions;Ua=null;Ga=2147483647;ha="";for(const sa of ua)if(this.iYj(sa))if(ha=
sa.Type,ua=this.vxb(ha),"Answer"===ha&&this.jEc){Ua=this.GLf(ha,sa,ma.zf);break}else ua&&ua<Ga&&(Ga=ua,Ua=this.GLf(ha,sa,ma.zf));Ga=u.a.G4k(ma.zf,ha);Ua&&(na?Array.contains(na,Ua.type):1)&&(ha=[],this.iEc?this.ub.tda?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ua.value,Ua.MJ)),E.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ua.value,Ua.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ua.value,
Ga))):(ha.push(appChrome.actions.setControlLabel(Ua.value,Ua.MJ)),ha.push(appChrome.actions.updateCompoundButtonDescription(Ua.value,Ua.description)),ha.push(appChrome.actions.setCompoundButtonCommandValueId(Ua.value,Ga)),appChrome.api.dispatch(ha)):this.ub.tda?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ua.value,Ua.MJ+" - "+Ua.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ua.value,Ga))):(ha.push(appChrome.actions.setControlLabel(Ua.value,
Ua.MJ+" - "+Ua.description)),ha.push(appChrome.actions.setButtonCommandValueId(Ua.value,Ga)),appChrome.api.dispatch(ha)),Ga=this.XHi(Ua.type),Ga.ls(Ua),ka.Uq(Ga))}else"Help"===za.GroupType&&za.Suggestions.length&&(na?Array.contains(na,8):1)?this.cXb&&(Ua=this.I8e.BTa(ma,za.Suggestions))&&0<Ua.results.length&&ka.Uq(Ua):"Template"===za.GroupType&&(na?Array.contains(na,23):1)?(Ua=za.Suggestions)&&0<Ua.length&&this.R2h.BTa(ma,ka,Ua):"Addin"===za.GroupType&&(na?Array.contains(na,26):1)?(Ua=za.Suggestions)&&
0<Ua.length&&this.SNh.BTa(ma,ka,Ua):"Substrate"===za.GroupType&&this.ePa&&"Type"in za?"File"===za.Type&&this.lEc&&(na?Array.contains(na,15):1)?(Ua=this.q5a.F7d(za.Suggestions,ra,this.qPa))&&0<Ua.results.length&&(this.XZc()&&(Ga=new y.a("GenerateSlidesFromTellMe",29,"",null,1),Ua.ls(Ga)),ka.Uq(Ua)):"People"===za.Type&&this.aXb&&(na?Array.contains(na,14):1)?(Ua=this.q5a.H5f(za.Suggestions,ra,this.qPa))&&0<Ua.results.length&&ka.Uq(Ua):"Notes"===za.Type&&this.$Wb&&(na?Array.contains(na,14):1)&&(Ua=this.q5a.a5f(za.Suggestions,
ra,ma))&&0<Ua.results.length&&ka.Uq(Ua):"Recall"===za.GroupType&&this.ub.t3&&"Type"in za&&"IntentService"===za.Type&&(na?Array.contains(na,15):1)&&(Ua=this.q5a.F7d(za.Suggestions,ra,this.qPa))&&0<Ua.results.length&&(this.XZc()&&(Ga=new y.a("GenerateSlidesFromTellMe",29,"",null,1),Ua.ls(Ga)),ka.Uq(Ua));else E.TellMeActor.instance.Hd.onError("OnSuccessCallBack","GroupType"in za?"Invalid group suggestions found for "+za.GroupType:"Invalid group found")}if(fa.Intents){za=fa.Intents;for(const sa of za)this.gne(sa)&&
("Image"===sa.GroupType&&sa.ConfidenceScore>sa.ConfidenceThreshold&&(na?Array.contains(na,19):1)?this.ZTh.BTa(ma,ka,0,sa):"Commands"===sa.GroupType&&sa.ConfidenceScore<sa.ConfidenceThreshold&&(na?Array.contains(na,17):1)&&(za=new x.a(17),ka.Uq(za)))}ea.resultsUpdated(ka);E.TellMeActor.instance.Hd.I5(ma.zf.length,this.uNa.join(","),"",Math.round(window.performance.now()-F),"",!0,B.a.provider)}}Xgb(fa,ma,ea,ra,F){const na=new A.a(ma);ra===this.jI&&(this.gja(),E.TellMeActor.instance.Hd.I5(ma.zf.length,
this.uNa.join(","),fa.data.ie.toString(),Math.round(window.performance.now()-F),Z.a.tellMe,!1,B.a.Tta));ea.resultsUpdated(na)}vxb(fa){switch(fa){case "Entity":return this.dpf?3:0;case "Definition":return this.kEc?5:0;case "WolframAnswer":return this.nEc?2:0;default:return 0}}GLf(fa,ma,ea){switch(fa){case "Answer":return new y.a(this.iEc?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ma.Title?ea:ma.Title,ma.Description,0);case "Entity":return new y.a(this.iEc?"AnswerForSearch":"AnswerForSearchSingleLine",
2,""===ma.Title?ea:ma.Title,ma.Description,0);case "Definition":return new y.a(this.iEc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ma.Title?ea:ma.Title,ma.Description,0);case "WolframAnswer":return new y.a("WolframForSearch",3,""===ma.Title?ea:ma.Title,ma.Description,0);default:return null}}XHi(fa){switch(fa){case 0:return new x.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new x.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new x.a(10,CommonUIStrings.l_TellMeDefinitionTitle);
case 3:return new x.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new x.a(19,this.ub.PMb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}iYj(fa){return"Type"in fa&&!!fa.Type&&""!==fa.Type&&"Description"in fa&&!!fa.Description&&""!==fa.Description}lYj(fa){return"Type"in fa&&!!fa.Type&&""!==fa.Type&&"CommandId"in fa&&!!fa.CommandId&&""!==fa.CommandId&&"Score"in fa&&!!fa.Score}gne(fa){if("GroupType"in fa&&fa.GroupType&&"ConfidenceScore"in fa&&
"ConfidenceThreshold"in fa)return!0;E.TellMeActor.instance.Hd.onError("IsValidIntentGroup","Invalid intents found");return!1}gnj(fa){const ma=u.a.yng(fa),ea={};ea.Query=fa;ma&&this.bXb&&(this.JRj()?ea.UserActionEvents=E.TellMeActor.instance.hrf:(ea.CommandClickedEvents=E.TellMeActor.instance.vzd,ea.CommandActionEvents=E.TellMeActor.instance.n$e),ea.TellMeCommandClickMruEvents=E.TellMeActor.instance.Djf,ea.ContentType=E.TellMeActor.instance.KMc);this.mEc&&(fa={},fa.Application=this.ub.application,
ea.TemplateInfo=fa);return ca.c(ea)}zkb(){return!!this.ub&&this.ub.zkb||!!P.AFrameworkApplication.Aa&&P.AFrameworkApplication.Aa.hb.zkb}Akb(){return!!this.ub&&this.ub.Akb||!!P.AFrameworkApplication.Aa&&P.AFrameworkApplication.Aa.hb.Akb}Bkb(){return!!this.ub&&this.ub.Bkb||!!P.AFrameworkApplication.Aa&&P.AFrameworkApplication.Aa.hb.Bkb}VMb(){return!!this.ub&&this.ub.VMb||!!P.AFrameworkApplication.Aa&&P.AFrameworkApplication.Aa.hb.VMb}UMb(){return!!this.ub&&(this.ub.UMb||this.ub.QH)}ykl(){return!!this.ub&&
!this.ub.iVa}Mkl(){return!!this.ub&&this.ub.Gac}xkl(){return!!this.ub&&this.ub.ZJj&&this.ub.WJj}$ng(){return!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}aog(){return!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}JRj(){return!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",
!1)}XZc(){return!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Nvh(){return!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}Npj(){return P.AFrameworkApplication.fa?P.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}hnj(){if(!P.AFrameworkApplication.fa)return"";
if(this.aog())return P.AFrameworkApplication.fa.Ga("TellMeServiceProdEndpointForSearch");if(this.$ng())return P.AFrameworkApplication.fa.Ga("TellMeServiceEdogEndpointForSearch");if(u.a.Rje())return P.AFrameworkApplication.fa.Ga("TellMeServiceIntEndpointForSearch");let fa=P.AFrameworkApplication.fa.Ga("TellMeServiceSearchEndpoint");fa&&""!==fa||(fa=P.AFrameworkApplication.iCh);return fa}static cMf(fa,ma){if(ma)return new da(fa,["Command","Recommended"],fa.M$i);ma=u.a.j4()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):
"Help WolframAnswer File People Notes Template Addin".split(" ");return new da(fa,ma,fa.F7f)}}Object(J.a)(da,"TellMeServiceProvider",null,[602])},1137:function(J,aa,d){d.r(aa);d.d(aa,"SurfaceStringTokenStringGenerator",function(){return e});J=d(0);var h=d(547);class e extends h.a{constructor(r){super(r);this.Ia=r}apply(r,n,v,B,y,x,A){null==x&&(x=r.$8f(y,n));A=h.a.wuf(r,x,this.Ia.score,v,B,A);return{Xtc:x,p_b:A}}}e.q_b=0;Object(J.a)(e,"SurfaceStringTokenStringGenerator",h.a,[])},1138:function(J,aa,
d){d.r(aa);d.d(aa,"QueryTokenStringGenerator",function(){return r});J=d(0);var h=d(547),e=d(80);class r extends h.a{constructor(n){super(n);this.Ia=n}apply(n,v,B,y,x,A,E){v=this.Ia.query.load(v,null);x=0;let u=null;this.Ia.query.RU===e.Annotations.Mga?v&&(u=this.Ia.name):((u=this.Ia.name)&&(u+="_"),u+=this.Ia.annotations.Z1(this.Ia.query.RU,v));null!=u&&(x=h.a.wuf(n,u,this.Ia.score,B,y,x));return{Xtc:A,p_b:E+x}}}r.q_b=1;Object(J.a)(r,"QueryTokenStringGenerator",h.a,[])},1139:function(J,aa,d){d.r(aa);
d.d(aa,"FuzzyMatchTokenStringGenerator",function(){return e});J=d(0);var h=d(547);class e extends h.a{constructor(r){super(r);this.Ia=r}apply(r,n,v,B,y,x,A){null==x&&(x=r.$8f(y,n));r=this.Ia.NTf.o6j(x);if(this.Ia.s8g)for(var E of r)if(!E.SG&&E.GQc)return{Xtc:x,p_b:A};E=0;for(const u of r)if(u.SG&&!({LTd:E}=this.Byf(u,!0,v,B,E)).returnValue)return{Xtc:x,p_b:A};if(this.Ia.zeg)for(const u of r)if(!({LTd:E}=this.Byf(u,!1,v,B,E)).returnValue)break;return{Xtc:x,p_b:A}}Byf(r,n,v,B,y){let x;n?(n=0,x=r.GQc?
1:0):(n=r.GQc?1:0,x=r.count-n);for(let A=0;A<x;++A)if(h.a.xuf(r.mSa+n+A,this.Ia.score,v,B),++y,0<this.Ia.zEe&&y>=this.Ia.zEe)return{returnValue:!1,LTd:y};return{returnValue:!0,LTd:y}}}e.q_b=2;Object(J.a)(e,"FuzzyMatchTokenStringGenerator",h.a,[])},1146:function(J,aa,d){d.r(aa);J=d(0);var h=d(306),e=d(18),r=d(16),n=d(1204),v=d(171);class B{constructor(R,V,D,Q=0){this.E$f=R;this.groupType=V;this.Abe=Q;this.spc=D}}Object(J.a)(B,"SortingGroup",null,[]);class y{constructor(R,V,D,Q){this.order=R;this.G$a=
V;this.irj=D;this.groupType=Q}}Object(J.a)(y,"SortingProp",null,[]);var x=d(117),A=d(144),E=d(104),u=d(125);class K{constructor(R,V){this.GSg={};this.FSg={};this.FRg=this.lYg=1;this.yBf(R,V)}nql(R,V,D){var Q=E.a.MF(D)?this.GSg:this.FSg;D=new e.a;for(var Z of V)V=Object(n.a)(y,Q[h.a[Z.groupType].toLowerCase()]),u.b(V)||D.add(new r.a(V,Z));D.Sc((ca,T)=>ca.key.order<T.key.order?-1:1);Array.clear(R);Z=x.TellMeActor.instance.OP;for(V=0;V<D.count;){Q=D.ga(V).key.G$a;var P=D.ga(V).value;const ca=new v.a(D.ga(V).key.groupType);
u.b(Z)||Z.Location===A.a.contextMenu||(ca.displayName=D.ga(V).key.irj);for(const T of P.results)ca.ls(T);for(P=++V;P<D.count&&D.ga(P).key.G$a===Q;)this.rPd(ca,D.ga(P).value),P=++V;R.push(ca)}}wHl(R,V){this.FRg=this.lYg=1;this.yBf(R,V)}yBf(R,V){this.syh(R);for(var D=0;D<R.length;D++){let Q=R[D];for(const Z of Q.spc)this.Y6h(Z,D,Q.E$f,Q.groupType)}this.syh(V);for(R=0;R<V.length;R++){D=V[R];for(const Q of D.spc)this.X6h(Q,R,D.E$f,D.groupType)}}syh(R){R.sort((V,D)=>Object(n.a)(B,V).Abe>Object(n.a)(B,
D).Abe?-1:1)}Y6h(R,V,D,Q){this.GSg[h.a[R].toLowerCase()]=new y(this.lYg++,V,D,Q)}X6h(R,V,D,Q){this.FSg[h.a[R].toLowerCase()]=new y(this.FRg++,V,D,Q)}rPd(R,V){for(let D=0;D<V.results.length;D++)R.ls(V.results[D])}}Object(J.a)(K,"BaseGroupingSorter",null,[]);class G{constructor(){this.Hcd=[new B("",25,[25]),new B("",24,[24]),new B(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new B(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new B(CommonUIStrings.l_TellMeSuggestionsProviderTitle,
32,[15,14,19,3]),new B("",13,[13]),new B("",22,[22])];this.B$c=[new B(CommonUIStrings.l_TellMeCommandProviderTitle,30,[17,0,1,8,27]),new B(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,31,[2,19,23,28]),new B(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,32,[15,14,20,9,12,10,11,26]),new B("",13,[13,24]),new B("",22,[22])];this.rAg=new K(this.Hcd,this.B$c)}isc(R,V,D,Q=null,Z=null){let P=!1;if(Q){for(const ca of E.a.MF(D)?this.Hcd:this.B$c)this.FRk(ca,Q);P=!0}if(Z){for(const ca of E.a.MF(D)?
this.Hcd:this.B$c)this.xHl(V,ca,Z);P=!0}P&&this.rAg.wHl(this.Hcd,this.B$c);this.rAg.nql(R,V,D)}FRk(R,V){const D=new e.a;for(var Q of R.spc){const Z=V[h.a[Q].toLowerCase()];D.add(new r.a(u.b(Z)?Number.MAX_VALUE:Z,Q))}if(D.count){D.Sc((Z,P)=>Z.key<P.key?-1:1);V=Array(D.count);for(Q=0;Q<D.count;Q++)V[Q]=D.ga(Q).value;R.spc=V}}xHl(R,V,D){let Q=0;for(const Z of V.spc)if(h.a[Z].toLowerCase()in D&&D[h.a[Z].toLowerCase()])for(const P of R)if(P.groupType===Z){Q+=D[h.a[Z].toLowerCase()];break}V.Abe=Q}}Object(J.a)(G,
"SimplifiedGroupingSorter",null,[]);d.d(aa,"GroupsPlacementInfo",function(){return O});class O{constructor(R){this.ESg={};this.CSg={};this.DSg={};this.HSg={};this.FBe={};this.eTg=this.Bjk=this.Fhk=this.cik=1;this.uUg=null;this.Fq=R;this.xmi();this.yHk();this.tmi();this.uli();R.QH&&(this.uUg=new G)}Sz(R){this.ESg[h.a[R].toLowerCase()]=this.cik++}fC(R,V){this.CSg[h.a[R].toLowerCase()]=V}ura(R){this.DSg[h.a[R].toLowerCase()]=this.Fhk++}FS(R){this.HSg[h.a[R].toLowerCase()]=this.Bjk++}Xx(R){this.FBe[h.a[R].toLowerCase()]=
this.eTg++}xmi(){const R=!!this.Fq&&this.Fq.iVa,V=!!this.Fq&&this.Fq.jlc,D=!!this.Fq&&this.Fq.jVa,Q=!!this.Fq&&this.Fq.Xme&&!E.a.wbb(),Z=!!this.Fq&&this.Fq.Gac,P=!!this.Fq&&this.Fq.OYc,ca=!!this.Fq&&this.Fq.nle,T=!!this.Fq&&this.Fq.MYc;this.Fq&&(this.Fq.t3||this.Fq.ROc)&&this.Sz(25);T&&this.Sz(24);this.Sz(4);this.Sz(18);this.Sz(16);this.Sz(7);this.Sz(17);this.Sz(0);this.Sz(1);ca&&this.Sz(27);Z&&this.Sz(23);R||this.Sz(2);R&&!V||this.Sz(8);this.Sz(15);D&&this.Sz(20);this.Sz(14);this.Sz(9);this.Sz(12);
this.Sz(10);this.Sz(11);R&&this.Sz(2);R&&!V&&this.Sz(8);this.Sz(19);P&&this.Sz(26);this.Sz(21);this.Sz(13);Q&&this.Sz(22)}yHk(){this.fC(21,1);this.fC(4,3);this.fC(18,3);this.fC(16,3);this.fC(7,3);this.fC(17,5);this.fC(0,5);this.fC(1,1);this.fC(27,2);this.fC(2,1);this.fC(8,2);this.fC(15,3);this.fC(14,2);this.fC(26,3);this.fC(9,1);this.fC(12,1);this.fC(10,1);this.fC(11,1);this.fC(19,1);this.fC(23,1);this.fC(13,1);this.fC(24,1);this.fC(20,2);this.fC(22,1);this.fC(25,1)}tmi(){this.ura(4);this.ura(0);
this.ura(17);this.ura(7);this.ura(16);this.ura(18);this.ura(15);this.ura(20);this.ura(8);this.ura(14)}uli(){this.FS(14);this.FS(10);this.FS(12);this.FS(9);this.FS(11);this.FS(20);this.FS(15);this.FS(8);this.FS(2);this.FS(1);this.FS(26);this.FS(7);this.FS(18);this.FS(16);this.FS(17);this.FS(0);this.FS(4)}s3k(){this.FBe={};this.eTg=1}Xij(R,V,D){this.s3k();const Q=!!this.Fq&&this.Fq.iVa,Z=!!this.Fq&&this.Fq.jlc,P=!!this.Fq&&this.Fq.jVa,ca=!!this.Fq&&this.Fq.Xme&&!E.a.wbb(),T=!!this.Fq&&this.Fq.Gac,da=
!!this.Fq&&this.Fq.OYc,fa=!!this.Fq&&this.Fq.nle,ma=!!this.Fq&&this.Fq.MYc;R=R&&Z;this.Xx(4);this.Xx(18);this.Xx(16);this.Xx(7);this.Xx(17);this.Xx(0);this.Xx(1);fa&&this.Xx(27);T&&this.Xx(23);Q&&!Z||!R||this.Xx(8);V&&this.Xx(15);Q||this.Xx(2);da&&this.Xx(26);D&&this.Xx(14);Q&&!Z||R||this.Xx(8);V||this.Xx(15);P&&this.Xx(20);D||this.Xx(14);this.Xx(9);this.Xx(12);this.Xx(10);this.Xx(11);Q&&this.Xx(2);Q&&!Z&&this.Xx(8);this.Xx(19);this.Xx(21);this.Xx(13);ma&&this.Xx(24);ca&&this.Xx(22);return this.FBe}WG(){return this.Fq}}
Object(J.a)(O,"GroupsPlacementInfo",null,[])},1149:function(J,aa,d){d.r(aa);J=d(0);var h=d(714),e=d(452),r=d(306),n=d(1049),v=d(451);class B{constructor(O="",R="",V="",D=-99999,Q=-1,Z=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=O?O:"";this.Description=R?R:"";this.Type=V?V:"";this.Score=D;this.Age=Q;this.Count=Z}}Object(J.a)(B,"Suggestion",null,[]);class y{constructor(O,R){this.GroupType=this.Suggestions=null;this.Suggestions=O;this.GroupType=R}}Object(J.a)(y,
"SuggestionGroup",null,[]);class x{}x.help="help";x.answer="answer";x.commands="commands";x.s$k="servicecommands";x.lCh="template";Object(J.a)(x,"SuggestionGroupType",null,[]);var A=d(117),E=d(104),u=d(27),K=d(36);d.d(aa,"InteractionLogger",function(){return G});class G{constructor(O,R,V){this.SAd=0;this.FMd=this.AUb=null;this.Cj=O;this.FLd=this.Jzd=this.pDd=!1;this.vQh=R;this.Yh=u.AFrameworkApplication.Ke;this.ub=V;this.Pxc=this.xId=0}get doa(){return this.Cj.doa}Ipd(O){this.Cj.Ipd(O)}Jrg(){if(this.AUb){var O=
0;for(const R of this.AUb)this.Cj.l5j(R,O++);this.AUb=null}}beginQuery(O,R,V){this.Cj.a5j(O,R,V)}U4g(O,R){this.Cj.Nii(O,R);this.pDd=!0;this.FLd=!1}T4g(){this.pDd=!1;this.Jzd||(this.Jrg(),this.Cj.wSf(this.SAd))}c5j(O,R){this.Cj.d5j(O,R)}ptk(O,R,V,D,Q){for(const Z of this.vQh)if(O.startsWith(Z)){this.FLd=!0;break}this.Cj.f3j(O,R,V,D,Q)}Btk(O){this.Jzd=!1;this.SAd=O;this.pDd||this.FLd||(this.Jrg(),this.Cj.wSf(this.SAd,!1))}Atk(O,R){this.Cj.j3j(O,R);this.Jzd=!0}E5d(O,R){if(!O.count)return"";let V="";
const D=Date.now();for(let Q of O)O=(D-Q.timeStamp)/1E3,O=E.a.cud(O),0<V.length&&(V+=";"),V+=R?Q.commandId:Q.controlId,V+=":",V+=O.toString();return V}xkc(){var O=this.E5d(h.a.instance.uRb,!1);0<O.length&&this.Cj.d3j(O);O=this.E5d(h.a.instance.z2a,!0);0<O.length&&this.Cj.C2j(O);O=this.E5d(h.a.instance.Qyc,!0);0<O.length&&this.Cj.N3j(O);O=A.TellMeActor.instance.Ejf;0<O.length&&this.Cj.$4j(K.c(O))}w5j(O){this.Cj.R2j(O)}I5(O,R,V,D,Q,Z,P,ca=null){this.Cj.w4j(O,R,V,D,Q,Z,P,ca)}epe(O,R,V,D){this.Cj.epe(O,
R,V,D)}CH(O,R,V=null){this.Cj.cGa(O,R,V)}onError(O,R,V=null){this.Cj.Hbc(O,R,V)}Ncl(O){this.AUb=O}wmj(O){const R=[];if(!O)return R;for(let V=0;V<O.length;V++){const D=r.a[O[V].groupType].toLowerCase(),Q=[],Z=O[V].results;if(Z){for(let P=0;P<Z.length;P++)"findindocument"===D?Array.add(Q,new B("","",D,Z[P].score,Z[P].xHc,Z[P].count)):Array.add(Q,new B(Z[P].label,Z[P].description,D,Z[P].score,Z[P].xHc,Z[P].count));"answer"===D||"definition"===D||"wolframanswer"===D||"entity"===D?Array.add(R,new y(Q,
x.answer)):"classifier"===D||"appsforoffice"===D?Array.add(R,new y(Q,x.commands)):"serviceclassifier"===D?Array.add(R,new y(Q,x.s$k)):"assistance"===D?Array.add(R,new y(Q,x.help)):("document"===D||"people"===D||"findindocument"===D||"notes"===D||"image"===D||"template"===D)&&Array.add(R,new y(Q,D))}}return R}fae(O,R){const V={};V.Query=R;V.SuggestionGroups=K.c(this.wmj(O));return K.c(V)}D8f(O){const R={"Content-Type":"application/json",Accept:"application/json"};R["X-Office-Version"]=u.AFrameworkApplication.buildVersion;
R["X-Office-Application"]=u.AFrameworkApplication.fa.Ga("Application");R["X-Office-Platform"]="WAC";R["X-TellMe-SqmUserId"]=u.AFrameworkApplication.fa.Ga("LoggableUserId")||"";R["X-TellMe-SessionId"]=this.Cj.doa.d9;R["X-TellMe-SuggestionTypes"]="Ranker";R["X-TellMe-Culture"]=u.AFrameworkApplication.uiCulture;R["X-TellMe-ProcessSessionId"]=u.AFrameworkApplication.userSessionId;R["X-TellMe-Flights"]=O;R["X-TellMe-PartialQueryIndex"]=this.xId;return R}ihb(O,R,V){this.I5(R.length,"RankerLogging",O.data.ie.toString(),
Math.round(window.performance.now()-V),v.a.hCh,!0,e.a.Tta)}Xgb(O,R,V){this.I5(R.length,"RankerLogging",O.data.ie.toString(),Math.round(window.performance.now()-V),v.a.hCh,!1,e.a.Tta)}E8f(){this.FMd||(this.FMd=new n.a(this.ub,null,6E3));return this.FMd.Wza}hpe(O){const R=this.fae(this.AUb,O),V=this.D8f("RankerLogging"),D=window.performance.now();this.Yh.nj(this.E8f(),2,R,V,!1,0,Q=>{this.ihb(Q,O,D)},Q=>{this.Xgb(Q,O,D)},null,null,!1,4E3,6E3);this.xId++}k3k(){this.xId=0}OVe(O){this.Pxc=O}}Object(J.a)(G,
"InteractionLogger",null,[])},117:function(J,aa,d){d.r(aa);J=d(0);var h=d(1205),e=d(1206),r=d(14),n=d(24),v=d(1204),B=d(714),y=d(265);class x{constructor(wb,Rb,vc,rd,rc,cb){this.groupType=wb;this.resultType=Rb;this.B0e=vc;this.G$a=rd;this.C0d=rc;this.resultIndex=cb}}Object(J.a)(x,"ClickLoggingInfo",null,[]);const A=wb=>{const Rb=[];for(;wb;)Array.add(Rb,"{ContextId:"+wb.contextId+", IsGraphNodeContext:"+wb.al+"}"),wb=wb.CE;Rb.reverse();return"{"+Rb.join(", ")+"}"};class E{constructor(){this.d9=this.sessionId=
null}}Object(J.a)(E,"CorrelationRecord",null,[965]);var u=d(263);class K{constructor(wb,Rb){this.provider=wb;this.Gud=Rb}}Object(J.a)(K,"ExternalResultProvider",null,[]);class G{constructor(wb,Rb){this.Id=null;this.TimeStamp=0;this.Id=wb;this.TimeStamp=Rb}}Object(J.a)(G,"MRUControl",null,[]);var O=d(701),R=d(697),V=d(104),D=d(27),Q=d(373);class Z{constructor(wb,Rb){this.qXh=10;this.NV=[];this.Oha=[];this.Yff=this.Xff=!1;this.fVb=this.eVb="";this.qBc=Rb;this.ub=wb;this.Dgf=wb.Po}G5b(){!this.Xff&&this.Dgf&&
this.ub&&R.a.Okg()&&(this.eVb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.ub.application,this.NV=this.$_f(),this.Xff=!0);return this.NV}zhj(){!this.Yff&&this.Dgf&&this.ub&&R.a.Okg()&&(this.fVb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.ub.application,this.Oha=this.$_f(!0),this.Yff=!0);return this.Oha}mXj(wb){return wb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===wb||"TryOfficeUpsell"===wb}Hje(wb){return this.yKj(wb)||this.mXj(wb)||V.a.Xng(wb)?!1:!0}m6h(wb){wb=wb.ControlId;this.Hje(wb)&&(wb=
this.xRe(wb),this.QYk(wb),this.Zkk(),Array.insert(this.NV,0,new G(wb,Date.now())),this.eVb.length&&(wb=JSON.stringify(this.NV),Q.a.instance.setItem(this.eVb,wb)))}Uy(wb){this.Ykk();Array.insert(this.Oha,0,new G(O.a[wb],Date.now()));this.fVb.length&&(wb=JSON.stringify(this.Oha),Q.a.instance.setItem(this.fVb,wb))}$_f(wb=!1){if(!this.NV.length){var Rb=wb?Q.a.instance.getItem(this.fVb):Q.a.instance.getItem(this.eVb);if(!Rb||""===Rb)return wb?this.Oha:this.NV;let vc=null;try{vc=JSON.parse(Rb)}catch(rd){this.jui(wb),
vc=null}if(!vc||!vc.length||10<vc.length)return wb?this.Oha:this.NV;Rb=0;for(const rd of vc)if(wb||this.ub.b1c(rd.Id)&&this.Hje(rd.Id))if(wb?Array.insert(this.Oha,Rb++,rd):Array.insert(this.NV,Rb++,rd),Rb===this.qBc)break}return wb?this.Oha:this.NV}iXd(wb){wb=this.xRe(wb);for(const Rb of this.NV)if(Rb.Id===wb)return!0;return!1}jui(wb=!1){Q.a.instance.setItem(wb?this.fVb:this.eVb,"")}MMj(wb){wb=this.xRe(wb.ControlId);return this.Hje(wb)?this.iXd(wb):!1}QYk(wb){if(0<this.NV.length){let Rb=0;for(const vc of this.NV){if(vc.Id===
wb){Array.removeAt(this.NV,Rb);break}Rb++}}}xRe(wb){return"Excel"===this.ub.application&&wb.startsWith("m_excelWebRenderer_ewaCtl_")?wb.substr(26,wb.length):wb}Zkk(){this.NV.length===this.qBc&&Array.removeAt(this.NV,this.NV.length-1)}Ykk(){this.Oha.length===this.qXh&&Array.removeAt(this.Oha,this.Oha.length-1)}yKj(wb){wb=wb.split("|");let Rb="";if(6<=wb.length)Rb=wb[0];else if(3<=wb.length){if("3"===wb[0])return!0;Rb=wb[1]}return Rb.startsWith("WA")}static createInstance(wb){let Rb=3;D.AFrameworkApplication.fa&&
(Rb=D.AFrameworkApplication.fa.Bc("TellMeMaxRecommendedResultsToReturn",3));return new Z(wb,Rb)}}Object(J.a)(Z,"MruControlsManager",null,[964]);class P{constructor(wb){this.z4a=wb}aL(wb,Rb){let vc;return wb.MJ&&(vc=this.z4a[wb.value])?vc.aL(wb,Rb):(vc=this.M0f(wb.value))?vc.aL(vc.fok,Rb):null}hgj(wb,Rb){if(wb=this.z4a[wb])for(const vc of Rb)if(Rb=V.a.getParameter(vc),Rb.key===wb.HDk)return Rb.value;return null}wqk(wb){(wb=this.M0f(wb))&&wb.uqk()}M0f(wb){const Rb=wb.indexOf(V.a.e$g);return 0<Rb?this.z4a[wb.substring(0,
Rb)]:null}}Object(J.a)(P,"ParameterizedCommandManager",null,[963]);var ca=d(306);class T{constructor(wb,Rb){this.zf=wb;this.QZa=Rb}}Object(J.a)(T,"TellMeQuery",null,[]);var da=d(698);class fa{constructor(wb,Rb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=wb;this.TimeElapsedSinceClick=Rb}}Object(J.a)(fa,"CommandClickedEvent",null,[]);var ma=d(125);class ea{constructor(wb,Rb){this.xYh=wb;this.Vba=Rb}resultsUpdated(wb){this.xYh(ma.b(wb.query)?"":wb.query.zf,wb.Lk,wb.attributes,this.Vba,wb.bAb)}}
Object(J.a)(ea,"ResultsUpdatedCallback",null,[900]);class ra{constructor(wb,Rb,vc,rd,rc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=wb;this.TimeElapsedSinceClick=vc;this.CommandSurface=rd;this.CommandId=Rb;this.TerminalParentControlId=rc}}Object(J.a)(ra,"UserActionEvent",null,[]);var F=d(18);class na{constructor(wb,Rb){this.menuModel=wb;this.resultCount=Rb}}Object(J.a)(na,"GeneratedMenuModel",null,[]);class ka{constructor(){this.ariaLabel=
this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(J.a)(ka,"MenuModel",null,[]);class Ua{constructor(wb,Rb,vc){this.ub=wb;this.z4a=Rb;this.L5a=vc}p3i(wb,Rb,vc){const {TellMeActor:rd}=d(117);let rc=0;const cb=new ka,Wb=[];let Uc="";cb.sections=[];let Ib=new F.a;const Vc=!!this.ub&&this.ub.iVa;var gc=!!this.ub&&this.ub.OMb||D.AFrameworkApplication.Aa.hb.OMb;for(const Zb of wb){wb=0;Vc||(Ib=new F.a);const Hc=new F.a;let Ab=Zb.displayName;for(const ad of Zb.results){if(0<=
ad.value.indexOf(V.a.YZe)){if(ad.MJ){var rb=this.z4a[ad.value];if(rb&&ad.value.endsWith(V.a.YZe)){if("FindParameterized"!==ad.value&&!gc){const Bd=[];Bd.push(appChrome.actions.setControlLabel(ad.value,rb.xcj(ad)));Bd.push(appChrome.actions.setButtonCommandValueId(ad.value,rb.a7i(ad)));appChrome.api.dispatch(Bd)}rb=ad.value.replace(V.a.YZe,"");Ib.remove(rb)?wb--:Hc.add(rb);Ib.add(ad.value);wb++}}}else switch(ad.type){case 5:Hc.contains(ad.value)||(Ib.add(ad.value),wb++);break;case 7:Ib.add(ad.MJ);
wb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 6:case 19:case 20:case 21:case 26:case 28:case 27:case 29:case 30:Ib.add(ad.value),wb++}13===Zb.groupType&&(Ab=V.a.j4()?0<Rb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Rb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Rb));21===Zb.groupType&&(Ab=CommonUIStrings.l_LearningUILiveText)}rc+=wb;""!==
Ab&&0<wb&&(Uc+=" , "+wb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Ab+" , ");0<Ib.count&&!Vc&&(wb=appChrome.api.menuSection(Ib.toArray(),Zb.displayName,null,ca.a[Zb.groupType]),Wb.push(wb))}gc=null;0<rc&&(gc=0<Rb.length?1!==rc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,rc,Rb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Rb):1!==rc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,rc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,
Vc?(Rb=appChrome.api.menuSection(Ib.toArray(),"",null,null),Wb.push(Rb)):gc+=Uc);vc&&(this.ub.tda?rd.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(gc)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(gc)));cb.sections=Wb;return new na(cb,rc,[])}static get C1d(){return Ua.Abf||(Ua.Abf=new na(Object.assign(new ka,{sections:[]}),0,[]))}}Ua.Abf=null;Object(J.a)(Ua,"TellMeMenuDefintionGenerator",null,[]);var za;(function(wb){wb[wb.TellMeControlActivated=
0]="TellMeControlActivated";wb[wb.TellMeQueryExecuted=1]="TellMeQueryExecuted";wb[wb.TellMeResultsRendered=2]="TellMeResultsRendered";wb[wb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(za||(za={}));Object(J.b)("PerformanceMarker",za);var ha;(function(wb){wb[wb.TellMeTimeToRender=0]="TellMeTimeToRender";wb[wb.TellMeSessionLength=1]="TellMeSessionLength";wb[wb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(ha||(ha={}));Object(J.b)("PerformanceMeasure",ha);class ua{mark(wb){window.performance.mark(za[wb])}measure(wb,
Rb,vc){const {TellMeActor:rd}=d(117);try{window.performance.measure(ha[wb],za[Rb],za[vc])}catch(rc){rd.instance.Hd.onError("TellMePerformance:Measure","error measuring "+ha[wb])}}Yoe(wb,Rb,vc){const {TellMeActor:rd}=d(117);rd.instance.Hd.epe(Rb,vc,wb,this.Odj(wb))}CQa(wb){for(const Rb of wb)window.performance.clearMarks(za[Rb])}clearMeasures(wb){for(const Rb of wb)window.performance.clearMeasures(ha[Rb])}Odj(wb){let Rb=0;(wb=this.i4i(wb))&&0<wb.length&&(Rb=wb[wb.length-1].duration);return Rb}i4i(wb){return window.performance.getEntriesByName(ha[wb],
"measure")}}Object(J.a)(ua,"TellMePerformance",null,[]);var Ga=d(452),sa=d(451),Ba=d(36);class pa{constructor(wb){this.P2h=wb}sJe(wb,Rb,vc){const {TellMeActor:rd}=d(117);rd.instance.Hd.I5(Rb,sa.a.nJb,wb.data.ie.toString(),Math.round(window.performance.now()-vc),sa.a.nJb,!0,Ga.a.Tta);wb=Ba.b(wb.data.Wd);Rb=-1;wb.Index&&(Rb=wb.Index);rd.instance.Hd.c5j(Rb,this.P2h)}qkc(wb,Rb,vc){const {TellMeActor:rd}=d(117);rd.instance.Hd.I5(Rb,sa.a.nJb,wb.data.ie.toString(),Math.round(window.performance.now()-vc),
sa.a.nJb,!1,Ga.a.Tta)}Chj(wb){if(wb&&""!==wb.trim()){const vc=window.performance.now(),rd=D.AFrameworkApplication.fCh;var Rb={};Rb.Text=wb;Rb.IsFileHash="false";Rb=Ba.c(Rb);D.AFrameworkApplication.Ke.nj(rd,2,Rb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,rc=>{this.sJe(rc,wb.length,vc)},rc=>{this.qkc(rc,wb.length,vc)},null,null,!1,4E3,6E3)}}}Object(J.a)(pa,"TellMeQueryIndexCallback",null,[]);var ia=d(144);class Da{constructor(wb,Rb,vc){this.xml=wb;this.resultCount=Rb;this.JOi=
vc}}Object(J.a)(Da,"GeneratedMenuXml",null,[]);var Xa=d(983),Ka=d(47);class Ma{constructor(wb,Rb){this.yxc=wb||{};this.QAa=Rb}get ijb(){return 5}aL(wb,Rb=null){return this.QAa.aL(wb,Rb)||this.Uki(wb.value)}Uki(wb){return Ma.Tki(wb,this.yxc[wb]||null)}static Tki(wb,Rb=null){wb=String.format('<ClonedControl Id="{0}" ',wb);for(let rc in Rb){var vc=rc,rd=Rb[rc];rd=rd?Ka.a.ue(rd.toString()):"";wb+=String.format('{0}="{1}" ',vc,rd)}return wb+"/>"}}Object(J.a)(Ma,"CommandMenuItemFactory",null,[843]);var Oa=
d(131);class qa{constructor(){this.zSh=CommonUIStrings.l_FindInDocumentText}get ijb(){return 8}aL(wb){var Rb=wb.MJ;wb=Ka.a.ue(wb.value);const vc=Ka.a.ue(Rb);Rb=Ka.a.ue(String.format(this.zSh,Rb));return this.G2i(wb,vc,Rb)}G2i(wb,Rb,vc){return Oa.a(wb,"1540292897",vc,V.a.aZi,null,Rb,vc,null,null)}}Object(J.a)(qa,"FindInDocumentMenuItemFactory",null,[843]);var Ya=d(984),Fb=d(982),hc=d(985);class ec{get ijb(){return 7}aL(wb){const Rb=Object(v.a)(da.a,wb);return this.v3i(Ka.a.ue(wb.value),Rb.id)}v3i(wb,
Rb){return Oa.a(Rb,"1404166600",wb,null,null,wb,wb,null,null)}}Object(J.a)(ec,"TryQueryMenuItemFactory",null,[843]);class Tb{constructor(wb){this.dqa=[];this.ub=wb}K$i(wb){for(const Rb of this.dqa)if(Rb.ijb===wb)return Rb;return null}j_a(wb){this.dqa.push(wb)}kVk(wb){this.j_a(new Ma(this.ub.lBi,wb));this.j_a(new hc.a(this.ub.Hpk));this.j_a(new Xa.a(this.ub.c8k,this.ub.b8k,this.ub.bwl,this.ub.tAj,this.ub.ujl));this.j_a(new Fb.InsightsMenuItemFactory);this.j_a(new qa);this.j_a(new Ya.a);this.j_a(new ec)}}
Object(J.a)(Tb,"MenuItemFactoryRegistry",null,[]);var vb=d(156);class zb{constructor(wb,Rb){this.ub=wb;this.ijf=new Tb(this.ub);this.ijf.kVk(Rb)}q3i(wb,Rb){let vc=0;const rd=[],rc=[];for(const Wb of wb){wb=V.a.M1e;var cb=[];for(const Uc of Wb.results){const Ib=this.ijf.K$i(Uc.type).aL(Uc,Rb);wb=V.a.M1e;cb.push(Ib);if(13===Uc.type||14===Uc.type)wb="Menu32";17===Uc.type&&(wb="MenuTellMeExtended");Uc.groupType=Wb.groupType;rc.push(Object(v.a)(vb.a,Uc))}vc=vc?vc:cb.length;cb=Oa.c("TellMeDropdownControls",
cb);wb=Oa.e("TellMeDropdownMenuSection",cb,wb,Wb.displayName);rd.push(wb)}Rb=Oa.f(rd,"LookupDropdownMenu");return new Da(Rb,vc,rc)}static get KOc(){return zb.Bbf||(zb.Bbf=new Da(Oa.f([],"LookupDropdownMenu"),0,[]))}}zb.Bbf=null;Object(J.a)(zb,"TellMeXmlGenerator",null,[]);class Xb{}Xb.Cok="MRU";Xb.test="Test";Object(J.a)(Xb,"ActionType",null,[]);var Za=d(383),Va=d(992),tc=d(105);class Kb{constructor(wb,Rb,vc,rd,rc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=
null;this.CommandId=wb;this.IsEnabled=Rb;this.ResultType=O.a[vc];this.SubResultType=Va.a[rd];this.OptionalData=rc?tc.a.toJSON(rc):null}}Object(J.a)(Kb,"ResultInfo",null,[]);var Pa=d(172),mb=d(142),qc=d(181);class oc{constructor(wb,Rb=null){this.Sef="TellMeWAC.";this.bZh=wb;this.s3h=Rb}Goa(wb,Rb,vc){Rb=Pa.a.sC(Rb);wb=Pa.a.pZd(wb,this.bZh,this.s3h,vc,Rb);mb.a.Goa(wb,this.Sef)}QKa(wb,Rb,vc=0){Rb=Pa.a.sC(Rb);mb.a.QKa(Object.assign(new qc.a,{name:wb,dataFields:Rb,durationMs:vc}),this.Sef)}}Object(J.a)(oc,
"TellMeOtelLogger",null,[864]);var ib=d(109);class $a{constructor(wb,Rb,vc,rd,rc,cb,Wb){this.OV=this.EZ=this.r$e=null;this.Jpa=wb;this.Mzd=Rb;this.Hqa=vc;this.VNa=rd;this.CAa=rc;this.SVh=cb;this.OV=Wb?Wb:new oc(this.VNa?y.CuiHelper.XZe:y.CuiHelper.V1e)}get Po(){return this.VNa}get doa(){return this.Hqa}Ipd(wb){this.r$e=wb;switch(wb){case ia.a.contextMenu:this.EZ=ia.a.contextMenu;break;default:this.EZ=ia.a.tellMe}}Nii(wb,Rb){this.Hqa.d9||(this.Hqa.d9=ib.a.create().toString(),this.drg(wb,!0,Rb))}wSf(wb,
Rb=!0){this.Hqa.d9&&this.A3j(wb,Rb);this.VNa&&appChrome.api.updateTellMeCorrelationId("");this.Hqa.d9=null}drg(wb,Rb,vc){const {TellMeActor:rd}=d(117),rc=this.yW(u.a.Xyb);rc[Za.a.culture]=this.Mzd;rc[Za.a.appName]=this.Jpa;rc[Za.a.context]=wb;rc[Za.a.o0c]=this.CAa;rc[Za.a.iXj]=this.SVh;rc[Za.a.OVj]=vc;rc[Za.a.hQj]=Rb;rc[Za.a.contentType]=rd.instance.KMc;this.OV.Goa(u.a.Xyb,rc,this.r$e);this.VNa&&appChrome.api.updateTellMeCorrelationId(this.Hqa.d9)}A3j(wb,Rb){const vc=this.yW(u.a.hgg);vc[Za.a.DQi]=
wb;vc[Za.a.gQj]=Rb;this.OV.QKa(u.a.hgg,vc)}a5j(wb,Rb,vc){let rd=0;!vc&&0<wb.length&&(rd=wb.trim().split(" ").length);const rc=this.yW(u.a.query);rc[Za.a.query]="!";rc[Za.a.gib]=Rb;rc[Za.a.heh]=wb.length;rc[Za.a.Pog]=vc;rc[Za.a.tMl]=rd;this.OV.Goa(u.a.query,rc,this.EZ)}w4j(wb,Rb,vc,rd,rc,cb,Wb,Uc=null){const Ib=this.yW(u.a.latency);Ib[Za.a.culture]=this.Mzd;Ib[Za.a.heh]=wb;Ib[Za.a.XFh]=Rb;Ib[Za.a.statusCode]=vc;Ib[Za.a.r$k]=rc;Ib[Za.a.isSuccess]=cb;Ib[Za.a.n_j]=Wb;Uc&&(Ib[Za.a.Vxl]=Uc);this.OV.QKa(u.a.latency,
Ib,rd)}epe(wb,Rb,vc,rd){const rc=this.yW(u.a.performance);rc[Za.a.culture]=this.Mzd;rc[Za.a.Qii]=za[wb];rc[Za.a.oSi]=za[Rb];rc[Za.a.OFk]=ha[vc];this.OV.QKa(u.a.performance,rc,rd)}l5j(wb,Rb){var {TellMeActor:vc}=d(117);const {CommandResultsUtility:rd}=d(335);if(wb.results.length){var rc=this.yW(u.a.Akh);rc[Za.a.G$a]=Rb.toString();rc[Za.a.groupType]=ca.a[wb.groupType];16===wb.groupType&&(rc[Za.a.rVj]=vc.instance.bvc);Rb=[];vc=[];var cb=[];for(const Wb of wb.results)rc[Za.a.resultType]||(rc[Za.a.resultType]=
O.a[Wb.type]),wb={},26===Wb.type&&(wb.AssetId=Wb.EQd),vc.push(rd.I9b(Wb.value)),Rb.push(Wb.value),cb.push(new Kb(Wb.value,rd.I9b(Wb.value),Wb.type,Wb.subType,wb));0<Rb.length&&(rc[Za.a.I4k]="{"+Rb.join(", ")+"}",rc[Za.a.ORi]="{"+vc.join(", ")+"}",rc[Za.a.E4k]=Ba.c(cb));this.OV.Goa(u.a.Akh,rc,this.EZ)}}K3i(wb,Rb){if(4===wb)return Xb.Cok;switch(Rb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return O.a[Rb]}f3j(wb,
Rb,vc,rd,rc){const cb=this.yW(u.a.click);cb[Za.a.XFh]=wb;cb[Za.a.JDk]=Rb;cb[Za.a.commandId]=vc;cb[Za.a.uCa]=rd;cb[Za.a.actionType]=this.K3i(rc.groupType,rc.resultType);cb[Za.a.resultType]=O.a[rc.resultType];cb[Za.a.B0e]=Va.a[rc.B0e];cb[Za.a.groupType]=ca.a[rc.groupType];cb[Za.a.G$a]=rc.G$a.toString();cb[Za.a.C0d]=rc.C0d.toString();cb[Za.a.resultIndex]=rc.resultIndex.toString();this.OV.Goa(u.a.click,cb,this.EZ)}j3j(wb,Rb){this.Hqa.d9||(this.Hqa.d9=ib.a.create().toString(),this.drg("",!1,Rb));Rb=this.yW(u.a.eJf);
Rb[Za.a.gib]=wb;this.OV.QKa(u.a.eJf,Rb)}nrg(wb,Rb,vc){if(wb){if(vc)for(let rd in vc)wb[rd]=vc[rd];this.OV.QKa(u.a.events,wb,Rb)}}cGa(wb,Rb,vc=null){const rd=this.yW(u.a.events);rd[Za.a.event]=wb;this.nrg(rd,Math.round(Rb),vc)}Hbc(wb,Rb,vc=null){const rd=this.yW(u.a.events);rd[Za.a.event]=u.a.error;rd[Za.a.module]=wb;rd[Za.a.errorMessage]=Rb;rd[Za.a.message]=Rb;this.nrg(rd,Math.round(window.performance.now()),vc)}d3j(wb){const Rb=this.yW(u.a.uHf);Rb[Za.a.value]=wb;Rb[Za.a.fld]=this.VNa;this.OV.Goa(u.a.uHf,
Rb,this.EZ)}C2j(wb){const Rb=this.yW(u.a.ksf);Rb[Za.a.value]=wb;Rb[Za.a.fld]=this.VNa;this.OV.Goa(u.a.ksf,Rb,this.EZ)}N3j(wb){const Rb=this.yW(u.a.nWf);Rb[Za.a.value]=wb;Rb[Za.a.fld]=this.VNa;this.OV.Goa(u.a.nWf,Rb,this.EZ)}$4j(wb){const Rb=this.yW(u.a.Pdh);Rb[Za.a.value]=wb;Rb[Za.a.fld]=this.VNa;this.OV.Goa(u.a.Pdh,Rb,this.EZ)}R2j(wb){const Rb=this.yW(u.a.eqh);Rb[Za.a.value]=wb;this.OV.Goa(u.a.eqh,Rb,this.EZ)}d5j(wb,Rb){const vc=this.yW(u.a.feh);vc[Za.a.nJb]=wb;Rb&&(vc[Za.a.d9]=Rb);this.OV.QKa(u.a.feh,
vc)}yW(wb){return{["SessionID"]:this.Hqa.sessionId,["CorrelationID"]:this.Hqa.d9,["Time"]:(new Date).getTime(),["Event"]:wb,["Scenario"]:this.EZ}}}Object(J.a)($a,"UsageLogger",null,[844]);var Db=d(95);class Mb{}Mb.Callback="action";Object(J.a)(Mb,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var ob=d(535),jc=d(305),Gb=d(82),Gc=d(135),bc=d(488),dc=d(240),Nb=d(55),Ac=d(270),jb=d(73),Vb=d(37);d.d(aa,"TellMeActor",function(){return Tc});class Tc{constructor(){this.QAa=this.sS=this.Od=this.$a=this.Q6=
this.tG=this.$d=this.Ca=this.Hd=this.FD=this.GGd=this.Vrf=this.D7=this.ub=null;this.Xob=!1;this.vzd=[];this.n$e=[];this.hrf=[];this.Djf=[];this.Ejf=[];this.Agf=!1;this.vnb=this.L5a=null;this.VTb=this.CAa=!1;this.CBc=!0;this.OP=this.Izc=this.sdf=this.RGd=this.xjf=null;this.d2=[];this.kNa=this.Nnb=this.mha=this.bDc=this.ipf=null;this.Eob=!1;this.LGd=0;this.nnb=null;this.Vba=-1;this.jjf=0;this.dUb=!1;this.uNa=null;this.frf=!1;this.onb=this.zS=null}get KMc(){return this.Q6?this.Q6.contentType:Tc.unknown}get actions(){return this.d2}set actions(wb){this.d2=
wb}bVc(){return this.Hd?this.Hd.doa.d9:null}WG(){return this.ub}get Wnk(){return this.CBc}get kLl(){return this.xjf}performance(){return this.FD}get SZe(){return this.ipf}set SZe(wb){this.ipf=wb}get bvc(){return this.frf}set bvc(wb){this.frf=wb}rG(wb){const Rb=window.performance.now();this.L5a&&!ma.b(wb)&&(this.L5a(wb),this.Hd.CH(u.a.rG,window.performance.now()-Rb))}initialize(wb,Rb=null,vc=null,rd=null,rc=null,cb=null,Wb=null,Uc=null,Ib=null,Vc=null,gc=null){const {InteractionLogger:rb}=d(1149),
{GroupsPlacementInfo:Zb}=d(1146),{AggregatorResultsProvider:Hc}=d(1004);this.ub=wb;this.CAa=!!D.AFrameworkApplication.Aa&&D.AFrameworkApplication.Aa.hb.tAb;this.Hd=rd;if(!rd){rd=new E;rd.sessionId=D.AFrameworkApplication.userSessionId;const Ab=Ac.a.xe(D.AFrameworkApplication.lcid)||Ac.a.s9b;this.Hd=new rb(new $a(this.ub.application,Ab.name,rd,this.ub.Po,this.CAa,wb.pza,null),this.ub.mBi,this.ub)}this.QAa=new P(this.ub.parameterData);this.Vrf=vc||new zb(this.ub,this.QAa);this.L5a=Wb;this.GGd=this.GGd||
new Ua(this.ub,this.ub.parameterData,Wb);this.Od=Db.FocusManager.instance();this.sS=Z.createInstance(this.ub);this.sdf=new Zb(wb);this.Ca=rc||D.AFrameworkApplication.Ta;this.$d=cb||D.AFrameworkApplication.ye;this.tG=Ib;this.D7=Rb;this.zS=gc;this.FD=new ua;this.onb=new h.a(e.a.Hn());this.bDc=[];Ib?Ib.execute(Ab=>{Ab.isFeatureEnabled(Tc.Qvl,!0).then(ad=>{const {AggregatorResultsProvider:Bd}=d(1004);this.dUb=ad;this.D7=this.D7||Bd.createInstance(this.sS,this.ub,this.QAa,this.dUb);for(const kd of this.bDc)this.D7.Uy(kd.provider,
kd.Gud);this.bDc=[];return null})}):(this.dUb=!0,this.D7=this.D7||Hc.createInstance(this.sS,this.ub,this.QAa,this.dUb));this.$a=Uc;this.mha=zb.KOc;this.xjf=new Promise(Ab=>{this.RGd=Ab});Vc&&Vc.execute(Ab=>{this.Q6=Ab});this.ub.Po&&V.a.Vmg()&&(wb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.ub.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(wb,wb)))}wb(){this.Y8h()}Y8h(){this.Ca.ra(Vb.a.tellMe,jb.a.frame,Object(r.a)(this,this.tellMe,"tellMe"),96);
this.Ca.ra(Vb.a.L1e,jb.a.frame,Object(r.a)(this,this.RCf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.ra(Vb.a.P1e,jb.a.frame,Object(r.a)(this,this.zrg,"logItemExecuted"),96);this.Ca.ra(Vb.a.S1e,jb.a.frame,Object(r.a)(this,this.irg,"logControlDeactivation"),96);this.Ca.ra(Vb.a.R1e,jb.a.frame,Object(r.a)(this,this.vrg,"logInputFocus"),96);this.Ca.ra(Vb.a.O1e,jb.a.frame,Object(r.a)(this,this.Xyb,"interactionBegin"),96);this.Ca.ra(Vb.a.U1e,jb.a.frame,Object(r.a)(this,this.Xyb,"interactionBegin"),96);
this.Ca.ra(Vb.a.Q1e,jb.a.frame,Object(r.a)(this,this.urg,"logInputBlur"),96);this.Ca.ra(Vb.a.T1e,jb.a.frame,Object(r.a)(this,this.hrg,"logControlActivated"),96);this.Ca.ra(Vb.a.ktc,jb.a.frame,Object(r.a)(this,this.iYf,"focusSearchBox"),96);this.Ca.ra(Vb.a.K1e,jb.a.frame,Object(r.a)(this,this.yIf,"constructLiveNotificationForMenu"),96);this.Ca.ra(Vb.a.W1e,jb.a.frame,Object(r.a)(this,this.nie,"insertTryQuery"),96);this.Ca.ra(Vb.a.joe,jb.a.frame,Object(r.a)(this,this.nie,"insertTryQuery"),96);this.Ca.ra(Vb.a.N3d,
jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.O3d,jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.P3d,jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.Q3d,jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.R3d,jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.HJe,jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.IJe,jb.a.frame,Object(r.a)(this,
this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.JJe,jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);this.Ca.ra(Vb.a.PKe,jb.a.frame,Object(r.a)(this,this.e9b,"insertMention"),96);this.Ca.ra(Vb.a.QKe,jb.a.frame,Object(r.a)(this,this.e9b,"insertMention"),96);this.Ca.ra(Vb.a.RKe,jb.a.frame,Object(r.a)(this,this.e9b,"insertMention"),96);this.Ca.ra(Vb.a.N1e,jb.a.frame,Object(r.a)(this,this.y8g,"openFeedback"),96);this.Ca.ra(Vb.a.X1e,jb.a.frame,Object(r.a)(this,this.nxa,"openOrInsertUrl"),96);
this.Ca.ra(Vb.a.AQd,jb.a.frame,Object(r.a)(this,this.YAb,"launchAddin"),96);this.Ca.ra(Vb.a.BQd,jb.a.frame,Object(r.a)(this,this.YAb,"launchAddin"),96);this.Ca.ra(Vb.a.CQd,jb.a.frame,Object(r.a)(this,this.YAb,"launchAddin"),96);this.Ca.ra(Vb.a.Jkb,jb.a.frame,Object(r.a)(this,this.Jkb,"showTellMeCoachmark"),96);this.Ca.ra(Vb.a.boe,jb.a.frame,Object(r.a)(this,this.Opg,"launchAddinStore"),96);this.Ca.ra(Vb.a.wPe,jb.a.frame,Object(r.a)(this,this.Heh,"quickActionOnFileHandler"),96);this.Ca.ra(Vb.a.I5d,
jb.a.frame,Object(r.a)(this,this.QZf,"generateSlidesFromFiles"),96)}LUk(wb){this.CBc=!1;const Rb=window.performance.now();wb.ZFa.isCompleted?(this.CBc=!0,this.RGd(!0)):wb.HS(()=>{this.CBc=!0;this.RGd(!0);this.Hd.CH(u.a.bMi,window.performance.now()-Rb)});this.pVk(wb)}pVk(wb){dc.a.wld(Object(r.a)(this,this.wOi,"dispatcher"));dc.a.F3b([new bc.a(Vb.a.tellMe,jb.a.frame,96),new bc.a(Vb.a.L1e,jb.a.frame,96),new bc.a(Vb.a.P1e,jb.a.frame,96),new bc.a(Vb.a.S1e,jb.a.frame,96),new bc.a(Vb.a.R1e,jb.a.frame,96),
new bc.a(Vb.a.O1e,jb.a.frame,96),new bc.a(Vb.a.U1e,jb.a.frame,96),new bc.a(Vb.a.Q1e,jb.a.frame,96),new bc.a(Vb.a.T1e,jb.a.frame,96),new bc.a(Vb.a.ktc,jb.a.frame,96),new bc.a(Vb.a.K1e,jb.a.frame,96),new bc.a(Vb.a.W1e,jb.a.frame,96),new bc.a(Vb.a.joe,jb.a.frame,96),new bc.a(Vb.a.N3d,jb.a.frame,96),new bc.a(Vb.a.O3d,jb.a.frame,96),new bc.a(Vb.a.P3d,jb.a.frame,96),new bc.a(Vb.a.Q3d,jb.a.frame,96),new bc.a(Vb.a.R3d,jb.a.frame,96),new bc.a(Vb.a.HJe,jb.a.frame,96),new bc.a(Vb.a.IJe,jb.a.frame,96),new bc.a(Vb.a.JJe,
jb.a.frame,96),new bc.a(Vb.a.PKe,jb.a.frame,96),new bc.a(Vb.a.QKe,jb.a.frame,96),new bc.a(Vb.a.RKe,jb.a.frame,96),new bc.a(Vb.a.N1e,jb.a.frame,96),new bc.a(Vb.a.X1e,jb.a.frame,96),new bc.a(Vb.a.AQd,jb.a.frame,96),new bc.a(Vb.a.BQd,jb.a.frame,96),new bc.a(Vb.a.CQd,jb.a.frame,96),new bc.a(Vb.a.Jkb,jb.a.frame,96),new bc.a(Vb.a.boe,jb.a.frame,96),new bc.a(Vb.a.wPe,jb.a.frame,96),new bc.a(Vb.a.I5d,jb.a.frame,96)],wb)}wOi(wb,Rb,vc,rd,rc){if(Rb.contextId===jb.a.frame)switch(wb){case Vb.a.tellMe:return this.tellMe(wb,
Rb,vc,rd,rc);case Vb.a.L1e:return this.RCf(wb,Rb,vc,rd,rc);case Vb.a.P1e:return this.zrg(wb,Rb,vc,rd,rc);case Vb.a.S1e:return this.irg(wb,Rb,vc,rd,rc);case Vb.a.R1e:return this.vrg(wb,Rb,vc,rd,rc);case Vb.a.O1e:return this.Xyb(wb,Rb,vc,rd,rc);case Vb.a.U1e:return this.restoreFocus(wb,Rb,vc,rd,rc);case Vb.a.Q1e:return this.urg(wb,Rb,vc,rd,rc);case Vb.a.T1e:return this.hrg(wb,Rb,vc,rd,rc);case Vb.a.ktc:return this.iYf(wb,Rb,vc,rd,rc);case Vb.a.K1e:return this.yIf(wb,Rb,vc,rd,rc);case Vb.a.W1e:case Vb.a.joe:return this.nie(wb,
Rb,vc,rd,rc);case Vb.a.N3d:case Vb.a.O3d:case Vb.a.P3d:case Vb.a.Q3d:case Vb.a.R3d:case Vb.a.HJe:case Vb.a.IJe:case Vb.a.JJe:case Vb.a.X1e:return this.nxa(wb,Rb,vc,rd,rc);case Vb.a.PKe:case Vb.a.QKe:case Vb.a.RKe:return this.e9b(wb,Rb,vc,rd,rc);case Vb.a.N1e:return this.y8g(wb,Rb,vc,rd,rc);case Vb.a.AQd:case Vb.a.BQd:case Vb.a.CQd:return this.YAb(wb,Rb,vc,rd,rc);case Vb.a.Jkb:return this.Jkb(wb,Rb,vc,rd,rc);case Vb.a.boe:return this.Opg(wb,Rb,vc,rd,rc);case Vb.a.wPe:return this.Heh(wb,Rb,vc,rd,rc);
case Vb.a.I5d:return this.QZf(wb,Rb,vc,rd,rc)}return 2}iYf(wb,Rb,vc){if(1===vc)return 32;this.Ksh();wb=!1;(this.ub.pza||this.CAa)&&(Rb=document.getElementById("SearchButton"))&&Rb.click();if(!this.ub.pza&&this.CAa)for(Rb=document.getElementsByClassName("ms-suiteux-search-box"),vc=0;vc<Rb.length;vc++){const rd=Rb[vc].querySelector("input[type=search]");rd&&(wb=Db.FocusManager.Wr(rd))}else wb=Db.FocusManager.Wr($get(this.ub.Po?y.CuiHelper.XZe:y.CuiHelper.V1e));this.VTb=!0;return wb?32:8}nie(wb,Rb,vc,
rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Ksh();wb=rc.CommandValueId;Rb=this.ub.Po?y.CuiHelper.XZe:y.CuiHelper.V1e;this.ub.Po&&!ma.b(rc[ob.a.Haa])&&(rc[ob.a.Haa]=!1);if(wb){if(this.ub.Po)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(wb)),this.uNa=[19],32;if(rc=$get(Rb))rc.value=wb}return Db.FocusManager.Wr($get(Rb))?32:8}Ksh(){this.Od.LU(this.ub.pza||this.CAa?this.ub.zWc:this.ub.JKa,!1)}F3i(wb,
Rb){switch(wb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Rb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Rb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Rb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Rb)}return Rb}yIf(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:ConstructLiveNotificationForMenu",
"actiondata comes null"),16;wb=this.mha?this.mha.resultCount:0;rc.Value=1!==wb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,wb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.mha)for(const cb of this.mha.JOi)rc=Object(n.a)(da.a,cb)?cb.id:Ka.a.replaceAll(cb.value,'"',""),(rc=$get(rc+"-"+V.a.M1e))&&Gc.a.eP(rc,Gc.a.ns,Ka.a.ue(this.F3i(cb.groupType,rc.innerText)));return 32}RCf(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:CacheAsyncMenuRefreshFunction",
"actiondata comes null"),16;this.nnb=new Gb.a(2,1,0,()=>{rc[Mb.Callback]()},97);this.mha&&this.$d.Db(this.nnb);return 32}zrg(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;rc.CloseAllMenus&&(wb=void 0===rc.ParentControlId||null===rc.ParentControlId?"<NA>":rc.ParentControlId,Rb=this.vnb?this.vnb[rc.ControlId]:null,!Rb&&this.vnb&&"<NA>"!==wb&&(Rb=this.vnb[wb]),Rb||(Rb=this.Xob&&this.sS.MMj(rc),Rb=this.YMi(Rb,rc.ControlId),
Rb=new x(Rb,31,4,-1,-1,-1),this.Hd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+rc.ControlId+" determined group:"+ca.a[Rb.groupType])),this.Hd.ptk(rc.ControlId,wb,rc.CommandId,rc.CloseAllMenus,Rb),this.QAa.wqk(rc.ControlId),rc.Location!==ia.a.contextMenu&&(this.sS.m6h(rc),this.sS.Uy(Rb.resultType),this.ub.Mqd&&this.D7.w7h(rc.CommandId)));return 32}irg(wb,Rb,vc,rd,rc){if(1===vc)return 32;R.a.jXj()&&(new pa(this.bVc())).Chj(this.Nnb);wb=this.Nnb;Rb=this.Vba;vc=this.Hd.Pxc;if(ma.b(rc))return this.Hd.onError("TellMeActor:LogControlDeactivation",
"actiondata comes null"),16;rc=rc.UILocation;wb&&0<wb.length&&this.dUb&&V.a.lYe(this.ub)&&this.ub.N0c&&19!==rc&&Rb>vc&&!this.ub.QH&&(this.Hd.hpe(wb),this.Hd.OVe(Rb));this.Hd.k3k();this.ub.Nvd&&19!==rc&&(this.FD.mark(3),this.FD.measure(1,0,3),this.FD.measure(2,2,3),this.FD.Yoe(0,1,2),this.FD.Yoe(2,2,3),this.FD.Yoe(1,0,3),this.FD.CQa([0,1,2,3]),this.FD.clearMeasures([0,2,1]));this.Hd.Btk(window.performance.now()-this.LGd);this.ub.Po&&(this.kNa=null,this.Hd.T4g());this.VTb=this.Eob=!1;this.Nnb="";return 32}vrg(wb,
Rb,vc){if(1===vc)return 32;this.Hd.U4g(A(Rb),this.VTb);return 32}urg(wb,Rb,vc){if(1===vc)return 32;this.Hd.T4g();this.Eob=!1;return 32}hrg(wb,Rb,vc,rd,rc){if(1===vc)return 32;this.OP=null;rc&&(this.OP=rc);this.ub.Nvd&&(ma.b(this.OP)||this.OP.Location!==ia.a.contextMenu)&&this.FD.mark(0);this.Hd.Ipd(ma.b(this.OP)||ma.b(this.OP.Location)?ia.a.unknown:this.OP.Location);this.Hd.Atk(this.jjf,this.VTb);this.Eob||this.xkc();return 32}GKf(wb,Rb){const vc=[],rd=Date.now();for(let rc of wb)wb=(rd-rc.timeStamp)/
1E3,wb=V.a.cud(wb),Array.add(vc,new fa(Rb?rc.commandId:rc.controlId,wb));return vc}nJi(wb){const Rb=[],vc=Date.now();for(let rd of wb)if(rd.controlId||"keyboardShortcut"===rd.commandSurface)wb=(vc-rd.timeStamp)/1E3,wb=V.a.cud(wb),Array.add(Rb,new ra(rd.controlId,rd.commandId,wb,rd.commandSurface,rd.atd));return Rb}dLf(wb=!1){var Rb=wb?this.sS.zhj():this.sS.G5b();wb=[];const vc=Date.now();for(const rd of Rb)Rb=(vc-rd.TimeStamp)/1E3,Rb=V.a.cud(Rb),Array.add(wb,new fa(rd.Id,Rb));return wb}xkc(){if(!this.Eob){this.Xob=
this.Eob=!0;""!==this.ub.aph&&D.AFrameworkApplication.Wj(this.ub.aph);if(!this.Agf){this.Agf=!0;const wb={};wb.IsMLREnabled=this.ub.xRj;wb.IsReactRibbonEnabled=this.ub.Po;wb.IsSharedHeaderEnabled=!!D.AFrameworkApplication.Aa&&D.AFrameworkApplication.Aa.hb.dO;wb.IsSearchUxEnabled=this.CAa;wb.IsTellMeInHeaderEnabled=this.ub.pza;wb.IsGoLocalEnv=V.a.Sjg();wb.IsSovereignEnvironment=V.a.wbb();wb.IsTellMeServiceResultsEnabled=V.a.lYe(this.ub);wb.IsSubstrateProviderEnabled=V.a.kYe(this.ub);wb.ShouldFetchTokens=
!!D.AFrameworkApplication.Aa&&D.AFrameworkApplication.Aa.hb.NMb;wb.IsSerpletEnabled=V.a.j4();wb.FirstOnClickTimeInMS=Math.round(window.performance.now());wb.IsHeaderHidden=D.AFrameworkApplication.hideHeader||D.AFrameworkApplication.CQ;wb.IsSearchInHeaderHidden=D.AFrameworkApplication.JWc;void 0!==window.performance.timing&&null!==window.performance.timing&&(wb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));wb.IsFindWithMatchesEnabled=this.ub.CWf;wb.HelpShowsTopSearchResult=
this.ub.rrc;wb.HelpShowsNumberOfMatches=this.ub.qrc;D.AFrameworkApplication.fa&&(wb.UiHost=D.AFrameworkApplication.fa.Ga("UiHostIntegrationType"));this.Hd.w5j(JSON.stringify(wb))}this.vzd=this.GKf(B.a.instance.uRb,!1);this.n$e=this.GKf(B.a.instance.z2a,!0);this.hrf=this.nJi(B.a.instance.z2a);this.Djf=this.dLf();this.Ejf=this.dLf(!0);this.Hd.xkc()}}Xyb(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Nb.a.eX)return 32;
this.LGd=window.performance.now();this.xkc();wb=new ea(Object(r.a)(this,this.Bfa,"onRequestCompleted"),0);this.Vba++;this.Hd.beginQuery("",this.Vba,this.Xob);this.r5e(!0,null);this.mha=zb.KOc;this.kNa=Ua.C1d;if(this.D7)Tc.instance.actions=[],this.D7.iB(new T("",this.Vba),wb,this.ub.Po);else this.Hd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.nnb&&this.$d.Db(this.nnb);return 32}restoreFocus(wb,Rb,vc){if(1===vc)return 32;this.Od.a1(this.ub.pza||this.CAa?this.ub.zWc:
this.ub.JKa,!1);return 32}tellMe(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:TellMe","actiondata comes null"),16;this.OP=rc;this.Hd.Ipd(ma.b(this.OP.Location)?ia.a.unknown:this.OP.Location);wb=this.OP.Value;this.ub.Po||wb&&""!==wb.trim()?(!this.kNa&&this.ub.Po&&(this.Hd.U4g(A(Rb),this.VTb),this.xkc()),this.jVi(wb,this.OP.Location),this.OP.PopulationXML=this.mha.xml):this.Xob?this.OP.PopulationXML=this.mha.xml:(this.OP.PopulationXML=zb.KOc.xml,this.kNa=Ua.C1d,
this.Nnb="");return 32}jVi(wb,Rb){this.LGd=window.performance.now();this.ub.Nvd&&Rb!==ia.a.contextMenu&&this.FD.mark(1);this.ub.Po&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(wb));wb&&0<wb.trim().length&&(this.Xob=!1);this.ub.$Ti();Rb=ma.b(Rb)?ia.a.tellMe:Rb;if(wb!==this.Nnb||this.ub.Po){this.Vba++;this.Hd.beginQuery(wb,this.Vba,this.Xob);this.r5e(!0,null);const vc=new T(wb,this.Vba),rd=new ea(Object(r.a)(this,this.Bfa,"onRequestCompleted"),this.Vba);this.mha=zb.KOc;this.kNa=
Ua.C1d;if(this.D7)Tc.instance.actions=[],this.D7.iB(vc,rd,this.ub.Po,Rb,this.uNa),this.uNa=null;else this.Hd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.jjf=this.Vba;this.Nnb=wb}}NFl(wb){if(this.ub.Po){var Rb=appChrome.selectors.getActiveControlStates();if(Rb=Object(v.a)(Object,Rb[wb.value])){wb.label=Rb.label;let vc=null;"description"in Rb&&(vc=Rb.description);vc&&Object.getType(vc)===String?wb.description=vc:"secondaryText"in Rb?wb.description=Rb.secondaryText:
"fullDescriptionLabel"in Rb&&(wb.description=Rb.fullDescriptionLabel)}}}YGk(wb){this.vnb={};let Rb=0,vc=0;for(const rd of wb){wb=0;for(const rc of rd.results)this.vnb[rc.value]=new x(rc.groupType,rc.type,rc.subType,Rb,wb,vc),wb++,vc++,rc.label||5!==rc.type||this.NFl(rc);0<wb&&Rb++}}OHb(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(wb=rc.CommandValueId)&&window.open(wb,"_blank");return 32}Ypg(wb){const Rb={};Rb.token=
this.SZe;Rb.files=Ba.c(wb);Rb.type="MultiFilesDeckGeneration";wb=V.a.J7f("",V.a.umh("GenerateDeckFromFile"),Object.assign(new jc.a,{landingTab:"All",data:Rb}));wb=this.Ca.La(Vb.a.FYc,2,wb);return 32!==wb?(this.Hd.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+wb+"."),!1):!0}Heh(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Od.dYf();if(wb=rc.TerminalParentControlId){wb=
this.onb.ga(wb);if(!wb)return 16;Rb=[];Array.add(Rb,wb);if(!this.Ypg(Rb))return 8}return 32}QZf(){if(!this.onb.count)return 16;const wb=[];for(let Rb of this.onb.values)Array.add(wb,Rb);return this.Ypg(wb)?32:8}e9b(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:InsertMention","actiondata comes null"),16;wb=rc.UILocation;let cb;rc=rc.CommandValueId;try{cb=Ba.a(rc)}catch(Wb){return this.Hd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return ma.b(cb)?(this.Hd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):ma.b(this.Izc)?(this.Hd.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==wb?(this.Hd.onError("TellMeActor:InsertMention","location "+wb+" is unexpected"),16):this.Izc.e9b(cb.displayName,cb.email,cb.userId)?32:(this.Hd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}nxa(wb,Rb,vc,rd,rc){return 1===vc?32:ma.b(rc)?(this.Hd.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===rc.UILocation?this.pIj(vc,rc):this.OHb(wb,Rb,vc,rd,rc)}y8g(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.zS&&window.setTimeout(()=>{this.zS.execute(cb=>{cb.iNb("TellMeSurvey",null)})},Tc.xXi);return 32}pIj(wb,Rb){if(1===wb)return 32;if(ma.b(Rb))return this.Hd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(ma.b(this.Izc))return this.Hd.onError("TellMeActor:InsertUrl",
"_iInsertContentHandler comes null"),16;wb=Rb.CommandValueId;return ma.b(wb)?(this.Hd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Izc.insertHtmlText(wb)?32:(this.Hd.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Bfa(wb,Rb,vc,rd,rc){vc=window.performance.now();this.YGk(Rb);this.Hd.Ncl(Rb);this.ub.Po?(this.kNa=this.GGd.p3i(Rb,wb,rc),this.ub.tda?(this.d2.push(appChrome.actions.updateTellMeSearchResults(this.kNa.menuModel,wb,rc)),appChrome.api.dispatch(this.d2)):
appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.kNa.menuModel,wb,rc)),this.ub.Nvd&&this.Eob&&(ma.b(this.OP)||this.OP.Location!==ia.a.contextMenu)&&(this.FD.mark(2),this.FD.measure(0,1,2))):this.mha=this.Vrf.q3i(Rb,this.Hd.doa);this.nnb&&this.$d.Db(this.nnb);rc={};rc.GroupsCount=Rb.length;rc.QueryID=rd;rc.QueryLength=wb.length;this.Hd.CH(u.a.qHi,window.performance.now()-vc,rc)}YMi(wb,Rb){return Rb.startsWith(this.ub.Po?V.a.g4e:V.a.tud)?5:wb?4:"bSearchHelp"===Rb||Rb.startsWith("GetHelpFromTellMe")?
8:"bInsights"===Rb||Rb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Rb?24:Rb===this.ub.BWf?2:0}Uy(wb,Rb){this.D7?this.D7.Uy(wb,Rb):Array.add(this.bDc,new K(wb,Rb))}Opg(wb,Rb,vc,rd,rc){if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){wb={};wb.SourceControlId=rc.SourceControlId;wb.Query=rc.CommandValueId;rc=this.Ca.La(Vb.a.coe,
2,wb);if(32!==rc)this.Hd.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+rc+".");return rc}return this.Ca.La(Vb.a.coe,2,rc)}YAb(wb,Rb,vc,rd,rc){({AddinResultsProvider:wb}=d(711));if(1===vc)return 32;if(ma.b(rc))return this.Hd.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;vc=rc.CommandValueId;if(ma.a(vc))return this.Hd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!wb.r6a[vc])return this.Hd.onError("TellMeActor:LaunchAddin",
"Add-in with assetId "+vc+" doesn't not exist in entitlements"),16;rc=d(711).AddinResultsProvider.r6a[vc];wb={};wb.solutionId=rc.id;wb.version=rc.appVersion;wb.storeType=rc.storeType;wb.storeId=rc.storeId;wb.assetId=rc.assetId;wb.assetStoreId=rc.assetStoreId;wb.displayName=rc.displayName;wb.targetType=rc.targetType;wb.height=rc.height;wb.width=rc.width;rc=this.Ca.La(Vb.a.Sfg,2,wb);if(32!==rc)this.Hd.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+rc+". AssetId: "+
vc);return rc}Jkb(){if(!ma.b(this.zS))for(let wb of B.a.instance.z2a){if("ShowContextMenuWithFloatie"===wb.commandId)return this.zS.execute(Rb=>{Rb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(wb.commandId&&-1===wb.commandId.indexOf("Tab"))break}return 8}r5e(wb,Rb="",vc=null){wb?this.onb=new h.a(e.a.Hn()):Rb&&vc&&this.onb.add(Rb,vc)}static get instance(){return Tc.Ka||(Tc.Ka=new Tc)}}Tc.Ka=null;Tc.Qvl="mso_tellMeService";Tc.unknown="Unknown";Tc.xXi=500;Object(J.a)(Tc,"TellMeActor",
null,[])},1245:function(J,aa,d){d.r(aa);var h=d(0),e=d(27),r=d(71),n=d(387),v=d(936),B=d(95),y=d(57),x=d(1203),A=d(14),E=d(1238),u=d(93),K=d(67),G=d(173),O=d(962),R=d(79);class V{static get eg(){return R.a.VA(V.En,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}V.En="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(h.a)(V,"InsertSymbolsDialogHtml",null,[]);var D=d(34),Q=d(218);class Z extends E.a{constructor(Ha,kb,Hb){super();this.Bhf=this.Vqa=this.jPa=null;this.wDd=0;this.Ca=Ha;this.Od=kb;this.tBa=Hb;this.Xe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Xe(0,CommonUIStrings.l_DialogClose);this.KV=!1;this.eg=V.eg;this.ig="InsertSymbolsDialog"}dispose(){0<Z.kNd&&n.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.wDd,Z.kNd);Z.saf++;
n.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Z.saf);this.Ca=this.tBa=null;super.dispose()}j6(){this.aj(Box4Intl.Box4Strings.L_SymbolSingle,Object(A.a)(this,this.kIj,"insertSymbolsDialogHandler"),null);this.wDd=0;Z.xaf++;n.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Z.xaf);const Ha=this.kae("symbol_d_"+Z.xUb);Ha&&Ha.focus()}hide(){var Ha=document.getElementById("symbolsContainer");if(Ha&&(Ha=Ha.getElementsByTagName("a")))for(let kb=0;kb<
Ha.length;kb++)u.a.removeHandler(Ha[kb],K.a.focus,Object(A.a)(this,this.OAh,"symbolFocusHandler"));super.hide()}kIj(Ha){1===Ha?(this.yIe("symbol_d_"+Z.xUb),this.Od.LU(this.iL,!0),this.Od.yl().wj.ZE(this.wD),this.wD.focus()):this.hide()}get WAb(){return Z.Xhf}set WAb(Ha){Z.Xhf=Ha}get SAb(){return Z.Jhf}set SAb(Ha){Z.Jhf=Ha}axa(){super.axa();var Ha=document.getElementById("symbolsContainer");if(Ha&&(O.a.tpd(Ha,this.tBa.sli(),"InsertSymbolsDialog"),Ha=Ha.getElementsByTagName("a")))for(let kb=0;kb<Ha.length;kb++)u.a.addHandler(Ha[kb],
K.a.focus,Object(A.a)(this,this.OAh,"symbolFocusHandler"))}b8(){const Ha=document.getElementById("symbolsContainer");Ha&&(this.jPa||(this.jPa=Object(A.a)(this,this.aul,"symbolClickHandler"),this.yn.pb(K.a.click,Ha,this.jPa),this.yn.pb(K.a.doubleClick,Ha,this.jPa)),this.Vqa||(this.Vqa=Object(A.a)(this,this.cul,"symbolKeyHandler"),this.Rg.pb(K.a.Xf,Ha,this.Vqa),this.Rg.pb(K.a.my,Ha,this.Vqa),this.Rg.pb(K.a.Il,Ha,this.Vqa)));super.b8()}xsa(){const Ha=document.getElementById("symbolsContainer");Ha&&(this.jPa&&
(this.yn.yb(K.a.click,Ha,this.jPa),this.yn.yb(K.a.doubleClick,Ha,this.jPa),this.jPa=null),this.Vqa&&(this.Rg.yb(K.a.Xf,Ha,this.Vqa),this.Rg.yb(K.a.my,Ha,this.Vqa),this.Rg.yb(K.a.Il,Ha,this.Vqa),this.Vqa=null));super.xsa()}Qyk(Ha){this.Lsh("symbol_d_"+Z.xUb,!1);Z.xUb=parseInt(Ha.substr(Ha.lastIndexOf("_")+1));this.Lsh(Ha,!0);if(Ha=document.getElementById("SymbolNameValueLabel")){const kb=this.WUc(Z.xUb);Ha.innerText=kb.altText}}WUc(Ha){const kb=this.tBa.Nsc.Asd.value,Hb=Q.a(kb);return kb[Hb[Ha]]}OAh(Ha){if(Ha.target!==
this.Bhf){const kb=this.Od.yl();kb&&kb.wj&&(kb.wj.ZE(Ha.target),this.Bhf=Ha.target)}this.Qyk(Ha.target.id)}aul(Ha){const kb=Ha.Ec;if("a"!==kb.tagName.toLowerCase())return!1;Ha.eventName===K.a.doubleClick&&this.yIe(kb.id);this.Od.LU(this.iL,!0);this.Od.yl().wj.ZE(kb);kb.focus();return!0}cul(Ha){var kb=Ha.Ec;if("a"!==kb.tagName.toLowerCase())return!1;const Hb=parseInt(kb.id.substr(kb.id.lastIndexOf("_")+1));if(Ha.qc.ctrlKey||Ha.qc.altKey||Ha.qc.keyCode>=G.a.Dmb&&Ha.qc.keyCode<=G.a.Pza)return!1;if(Ha.eventName===
K.a.Xf){Ha=Ha.qc.keyCode;let ic=-1;Ha===Sys.UI.Key.enter?(this.yIe(kb.id),this.Od.LU(this.iL,!0),this.Od.yl().wj.ZE(kb),kb.focus()):Ha===Sys.UI.Key.up?ic=Hb-15:Ha===Sys.UI.Key.down?ic=Hb+15:Ha===Sys.UI.Key.left?ic=e.AFrameworkApplication.isRtl?Hb+1:Hb-1:Ha===Sys.UI.Key.right&&(ic=e.AFrameworkApplication.isRtl?Hb-1:Hb+1);0<=ic&&(kb=this.kae("symbol_d_"+ic))&&kb.focus()}return!0}yIe(Ha){this.wDd++;Z.kNd++;Ha=parseInt(Ha.substr(Ha.lastIndexOf("_")+1));const kb=this.WUc(Ha),Hb={};Hb.SourceControlId="symbol_"+
Ha+"_"+kb.zsd;this.Ca.La(D.a.nUa,2,Hb);n.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Ha)}kae(Ha){const kb=document.getElementById("symbolsContainer");return kb?kb.querySelector("#"+Ha):null}Lsh(Ha,kb){(Ha=this.kae(Ha))&&(kb?Ha.setAttribute("selected","true"):Ha.removeAttribute("selected"))}}Z.xUb=0;Z.Xhf=null;Z.Jhf=null;Z.xaf=0;Z.saf=0;Z.kNd=0;Object(h.a)(Z,"InsertSymbolsDialog",E.a,[]);var P=d(44),ca=d(53),T=d(41),da=d(183),fa=d(108);class ma{constructor(Ha,kb,
Hb,ic,Qc,Jd,yd,He){this.Ca=Ha;this.AK=kb;this.j2h=new x.a(Object(A.a)(this,this.Gmj,"getSymbolsDropDownMenuProps"));this.k2h=new x.a(Object(A.a)(this,this.lae,"getSymbolsDropDownXml"));this.qMd=ic.Nsc.Asd;this.Bk=Hb;this.tBa=ic;this.DD=Qc;this.rP=Jd;this.Tc=yd;this.Gm=He}Gmj(){return this.tBa.hmi()}lae(){return this.tBa.build()}wb(){this.Ca.ra(D.a.Mjd,T.a.application,Object(A.a)(this,this.Mjd,"queryInsertSymbols"),96);this.Ca.ya(D.a.Ihb,T.a.view,Object(A.a)(this,this.Ihb,"populateSymbolsDropDown"));
this.Ca.ya(D.a.Bsd,T.a.view,Object(A.a)(this,this.PAh,"symbolsDropDownOpenHandler"));this.Ca.ya(D.a.QOe,T.a.view,Object(A.a)(this,this.Deh,"querySymbolPositionHandler"));this.Ca.ya(D.a.nUa,T.a.view,Object(A.a)(this,this.aFa,"insertSymbolViewHandler"));this.Ca.ya(D.a.Ihb,T.a.Of,Object(A.a)(this,this.Ihb,"populateSymbolsDropDown"));this.Ca.ya(D.a.Bsd,T.a.Of,Object(A.a)(this,this.PAh,"symbolsDropDownOpenHandler"));this.Ca.ya(D.a.QOe,T.a.Of,Object(A.a)(this,this.Deh,"querySymbolPositionHandler"));this.Ca.ya(D.a.nUa,
T.a.Of,Object(A.a)(this,this.jIj,"insertSymbolHandler"));this.Ca.le(D.a.Ihb,1124);this.Ca.le(D.a.Bsd,1036);this.Ca.le(D.a.QOe,1124);this.Ca.le(D.a.nUa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Ca.ya(D.a.QXc,T.a.view,Object(A.a)(this,this.Owh,"showInsertMoreSymbolsDialogHandler")),this.Ca.ya(D.a.QXc,T.a.Of,Object(A.a)(this,this.Owh,"showInsertMoreSymbolsDialogHandler")),this.Ca.le(D.a.QXc,1124))}Deh(Ha,kb,Hb,ic,Qc){if(1===Hb)return 32;Ha=this.tBa.o$g(Qc);
Ha=String.format(this.tBa.bul,Ha.character);Qc[v.a.InnerHTML]=Ha;Qc[v.a.On]=!1;return 32}aFa(Ha,kb,Hb,ic,Qc){if(({Hf:Ha,selected:Hb,aFa:He}=this.kNf(kb,Hb)).returnValue)return He;var Jd=P.SelectionEditor.Tg(Hb);let yd=!0;Hb=8;var He=this.Bk.oe(15);He.kd(Ha.xg);Jd||(Hb=this.Ca.pi(kb,D.a.$Ca,2,!0,ic,null),kb=32===Hb,n.ULS.shipAssertTag(6407387,348,kb,"DeleteForReplace did not succeed. Response is {0}",Hb),yd=kb);yd&&(kb=Ha.Mb.Qj,Jd=P.SelectionEditor.Tg(kb),n.ULS.shipAssertTag(6407388,348,Jd,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
kb.contextId),Hb=8,Jd&&(Hb=this.Ca.pi(kb,D.a.nUa,2,!1,ic,Qc),n.ULS.shipAssertTag(6407389,348,32===Hb,"Insertion at IP context did not succeed. Response is {0}",Hb),32===Hb&&B.FocusManager.instance().rf(Ha.FI)));He.dispose();return Hb}kNf(Ha,kb){let Hb,ic;Hb=null;Ha.view.Nh&&(Hb=Ha.view);ic=null;return Hb&&Hb.Mb?(ic=Hb.Mb.Qj)?this.rP.ga(14)&&this.DD.C7a(ic)?{returnValue:!0,Hf:Hb,selected:ic,aFa:8}:Hb.Mb.Na.jH||this.Gm&&this.Gm.instance&&this.Gm.instance.bX(ic)||P.SelectionEditor.WYc(Ha.CE)?{returnValue:!0,
Hf:Hb,selected:ic,aFa:2}:1===kb?{returnValue:!0,Hf:Hb,selected:ic,aFa:32}:{returnValue:!1,Hf:Hb,selected:ic,aFa:32}:{returnValue:!0,Hf:Hb,selected:ic,aFa:2}:(fa.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Ha.toString()),{returnValue:!0,Hf:Hb,selected:ic,aFa:8})}jIj(Ha,kb,Hb,ic,Qc){if(1===Hb)return 32;if(P.SelectionEditor.WYc(kb))return 2;Ha=this.tBa.o$g(Qc);ic.CN=Ha.index;ic=this.AK.Mc(kb.node);Hb=ic.rc(11);
n.ULS.shipAssertTag(6379466,324,Hb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",da.a[kb.node.type]);Hb=this.Bk.oe(15);Hb.Iy(ic);ma.characterPropertiesEditor.replaceTextRange(kb,Ha.character,!0,!1);kb=ca.SelectionFactory.Sg(ic.currentNode,kb.Qa+1);this.Tc.setSelection(kb);Hb.dispose();return 32}Ihb(Ha,kb,Hb,ic,Qc){if(1===Hb)return 32;e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Pp?Qc.MenuItems=this.j2h.value:Qc.PopulationXML=this.k2h.value;return 32}PAh(Ha,
kb,Hb){({aFa:Ha}=this.kNf(kb,Hb));return Ha}Owh(Ha,kb,Hb){2===Hb&&(new Z(this.Ca,B.FocusManager.instance(),y.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).j6();return 32}Mjd(){return 32}static get characterPropertiesEditor(){return ma.gh||(ma.gh=y.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Ha){ma.gh=Ha}}ma.gh=null;Object(h.a)(ma,"SymbolsActor",null,[572]);class ea{constructor(Ha,kb){this.zsd=Ha;this.altText=kb}}Object(h.a)(ea,"Symbol",null,
[]);class ra{constructor(){this.pMd=null;this.qMd=new x.a(ra.hZd)}get Asd(){return this.qMd}ocj(Ha){this.pMd||(this.pMd=Q.a(this.qMd.value));return Array.indexOf(this.pMd,Ha)}static hZd(){const Ha={};Ha["\u2022"]=new ea("\u2022",Box4Intl.Box4Strings.L_Bullet);Ha["\u20ac"]=new ea("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Ha["\u00a3"]=new ea("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Ha["\u00a5"]=new ea("\u00a5",Box4Intl.Box4Strings.L_YenSign);Ha["\u00a9"]=new ea("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);
Ha["\u00ae"]=new ea("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Ha["\u2122"]=new ea("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Ha["\u00b1"]=new ea("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Ha["\u2260"]=new ea("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Ha["\u2264"]=new ea("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Ha["\u2265"]=new ea("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Ha["\u00f7"]=new ea("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Ha["\u00d7"]=new ea("\u00d7",
Box4Intl.Box4Strings.L_MultiplicationSign);Ha["\u221e"]=new ea("\u221e",Box4Intl.Box4Strings.L_Infinity);Ha["\u00b5"]=new ea("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Ha["\u03b1"]=new ea("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Ha["\u03b2"]=new ea("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Ha["\u03c0"]=new ea("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Ha["\u03a9"]=new ea("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Ha["\u03a3"]=new ea("\u03a3",Box4Intl.Box4Strings.L_NArySummation);
Ha["\u00b0"]=new ea("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Ha["\u0394"]=new ea("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Ha["\u263a"]=new ea("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Ha["\u2665"]=new ea("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Ha["\u20b9"]=new ea("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Ha["\u00bf"]=new ea("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Ha["\u00a1"]=new ea("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Ha["\u2014"]=
new ea("\u2014",Box4Intl.Box4Strings.L_EmDash);Ha["\u2026"]=new ea("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Ha["\u00c0"]=new ea("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Ha["\u00c1"]=new ea("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Ha["\u00c2"]=new ea("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Ha["\u00c3"]=new ea("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Ha["\u00c4"]=new ea("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);
Ha["\u00c5"]=new ea("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Ha["\u00c6"]=new ea("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Ha["\u00c7"]=new ea("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Ha["\u00c8"]=new ea("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Ha["\u00c9"]=new ea("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Ha["\u00ca"]=new ea("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Ha["\u00cb"]=
new ea("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Ha["\u00cc"]=new ea("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Ha["\u00cd"]=new ea("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Ha["\u00ce"]=new ea("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Ha["\u00cf"]=new ea("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Ha["\u00d1"]=new ea("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Ha["\u00d2"]=
new ea("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Ha["\u00d3"]=new ea("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Ha["\u00d4"]=new ea("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Ha["\u00d5"]=new ea("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Ha["\u00d6"]=new ea("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Ha["\u00d9"]=new ea("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Ha["\u00da"]=
new ea("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Ha["\u00db"]=new ea("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Ha["\u00dc"]=new ea("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Ha["\u00df"]=new ea("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Ha["\u00e0"]=new ea("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Ha["\u00e1"]=new ea("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Ha["\u00e2"]=new ea("\u00e2",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Ha["\u00e3"]=new ea("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Ha["\u00e4"]=new ea("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Ha["\u00e5"]=new ea("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Ha["\u00e6"]=new ea("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Ha["\u00e7"]=new ea("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Ha["\u00e8"]=new ea("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);
Ha["\u00e9"]=new ea("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Ha["\u00ea"]=new ea("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Ha["\u00eb"]=new ea("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Ha["\u00ec"]=new ea("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Ha["\u00ed"]=new ea("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Ha["\u00ee"]=new ea("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Ha["\u00ef"]=
new ea("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Ha["\u00f1"]=new ea("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Ha["\u00f2"]=new ea("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Ha["\u00f3"]=new ea("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Ha["\u00f4"]=new ea("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Ha["\u00f5"]=new ea("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Ha["\u00f6"]=new ea("\u00f6",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Ha["\u00f9"]=new ea("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Ha["\u00fa"]=new ea("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Ha["\u00fb"]=new ea("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Ha["\u00fc"]=new ea("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Ha["\u00ff"]=new ea("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Ha["\u011e"]=new ea("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);
Ha["\u011f"]=new ea("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Ha["\u0130"]=new ea("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Ha["\u0131"]=new ea("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Ha["\u0152"]=new ea("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Ha["\u0153"]=new ea("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Ha["\u015e"]=new ea("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Ha["\u015f"]=new ea("\u015f",
Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Ha["\u0178"]=new ea("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Ha}}Object(h.a)(ra,"SymbolsLoader",null,[571]);var F=d(47),na=d(315),ka=d(273),Ua=d(205),za=d(586),ha=d(1234),ua=d(131),Ga=d(75);class sa{constructor(Ha){this.l2h=Ha}get Nsc(){return this.l2h}get bul(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}o$g(Ha){Ha=Ha.SourceControlId.split("_");const kb={};2===Ha.length?
(kb.character=Ha[1],kb.index=this.Nsc.ocj(kb.character)):(kb.character=Ha[2],kb.index=parseInt(Ha[1]));return kb}hmi(){return this.n8f()}build(){return this.lae()}sli(){const Ha=new Sys.StringBuilder;Ha.append('<table class="moreSymbolsTable">');const kb=this.Nsc.Asd.value,Hb=Q.a(kb);let ic=0;for(;ic<Hb.length;){ic%15||Ha.append('<tr role="presentation">');const Qc=kb[Hb[ic]];Ha.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+ic,F.a.aUa(Qc.zsd),F.a.aUa(Qc.altText)));ic++;ic%15&&ic!==Hb.length||Ha.append("</tr>")}Ha.append("</table>");return Ha.toString()}lae(){const Ha=this.n8f();return ua.l(Ha)}n8f(){const Ha=Object.assign(new na.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(Ha.MenuSectionList,this.R8h());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(Ha.MenuSectionList,this.B7h());return Ha}B7h(){const Ha=Object.assign(new ka.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),kb=Object.assign(new Ua.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:F.a.ue(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:F.a.ue(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.qm,Image16by16Class:Ga.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(Ha.ControlList,kb);return Ha}R8h(){const Ha=Object.assign(new ka.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),kb=Object.assign(new za.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Hb=this.Nsc.Asd.value,ic=Q.a(Hb),Qc=Math.min(25,ic.length);for(let yd=0;yd<Qc;yd++){var Jd=Hb[ic[yd]];Jd=Object.assign(new ha.a,{Id:String.format("{0}{1}_{2}","symbol_",yd,Jd.zsd),Character:Jd.zsd,Command:"3966968829",QueryCommand:"816646517",Alt:F.a.ue(Jd.altText)});kb.GalleryItems.push(Jd)}Array.add(Ha.ControlList,
kb);return Ha}}Object(h.a)(sa,"SymbolsUiBuilder",null,[570]);var Ba=d(64),pa=d(122),ia=d(38),Da=d(513),Xa=d(295);class Ka{constructor(){this.Da=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Da.resolve("Box4.Symbols.ISymbolsActor").wb()}dispose(){}Zb(Ha){this.Da=Ha;this.Da.register(ra,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Da.register(sa,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().oa(()=>
new sa(this.Da.resolve("Box4.Symbols.ISymbolsLoader")));this.Da.register(ma,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().oa(()=>new ma(e.AFrameworkApplication.Ta,new Da.a,new Xa.a,this.Da.resolve("Box4.Symbols.ISymbolsUIBuilder"),pa.a.instance,ia.a.instance,Ba.a.instance,this.Da.Ja("Box4.IExternalSelectionManager")))}static main(){r.a.instance.Dc(new Ka)}}Object(h.a)(Ka,"Box4SymbolsPackage",null,[2,3]);var Ma=d(1066),Oa=d(36),qa=d(81),Ya=d(450);class Fb{constructor(Ha,kb){this.kLd=
this.jLd=null;this.mqb=new Ma.a;this.Yh=Ha;this.GBa=kb.appSettings[Fb.tLl]||""}get eil(){return this.mqb.task}get yca(){return this.Yh.value}J2k(){const Ha={};Ha[Fb.Iyj]=e.AFrameworkApplication.hh;Ha["Content-Type"]="application/json; charset=utf-8";n.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const kb=qa.a.Ni(this.GBa+Fb.fil,Fb.mrk,e.AFrameworkApplication.Aa.hb.Uk.toString());this.yca.nj(kb,1,"",Ha,!0,2,Object(A.a)(this,this.sJe,"onSuccessCallback"),
Object(A.a)(this,this.qkc,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}K4j(Ha){try{const kb={};kb.FlightName=Ha.FlightName;kb.SessionID=Ha.SessionID;n.ULS.sendTraceTag(594883776,215,50,Oa.c(kb))}catch(kb){n.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}sJe(Ha){if((Ha=Ha.data.Wd)&&Ha.length)try{const kb=Oa.a(Ha);this.jLd=kb.NavBarDataJson;n.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.jLd?({sv:this.kLd}=Oa.d(kb.NavBarDataJson)).returnValue?
(this.K4j(this.kLd),this.mqb.Kg(this.kLd)):(n.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Ya.a.kuc(this.jLd)}),this.mqb.t1()):(n.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.mqb.t1())}catch(kb){n.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.mqb.t1()}else n.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}qkc(){this.mqb.t1();n.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Fb.Ka||
(Fb.Ka=Fb.t9a())}static t9a(){return new Fb(new x.a(()=>e.AFrameworkApplication.Ke),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.hb.Uk)}}Fb.Iyj="X-qs";Fb.mrk="at";Fb.fil="O365ShellServiceProxy.ashx";Fb.Ka=null;Fb.tLl="ShellWebServiceBase";Object(h.a)(Fb,"O365ShellActor",null,[608]);class hc{constructor(){this.Da=null}get name(){return"Common.App.O365Shell"}Zb(Ha){this.Da=Ha;this.Da.register(Fb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().oa(()=>new Fb(new x.a(()=>
e.AFrameworkApplication.Ke),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.hb.Uk))}init(){e.AFrameworkApplication.fa.ff(Object(A.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){e.AFrameworkApplication.Mvd&&e.AFrameworkApplication.Aa.hb.dO&&this.Da.resolve("Common.App.O365Shell.O365ShellActor").J2k()}dispose(){}static main(){r.a.instance.Dc(new hc)}}Object(h.a)(hc,"PackageManager",null,[2,3]);var ec=d(78),Tb=d(285);class vb{constructor(Ha){this.Pa=new ec.a;this.YH=Ha}cHc(Ha){this.Pa.addHandler(vb.tza,
Ha)}MRe(Ha){this.Pa.removeHandler(vb.tza,Ha)}WYe(){this.Pa.raiseEvent(vb.FLb)}VYe(){this.Pa.raiseEvent(vb.GLb)}}vb.FLb="SE";vb.GLb="SEP";vb.tza="SER";vb.W2e="TRP";Object(h.a)(vb,"NullSessionExpirationManager",null,[581,582]);var zb=d(166);class Xb{constructor(){this.TWb=this.cPa=!1;const Ha=e.AFrameworkApplication.hm;0>=Ha||(this.hm=Ha,n.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.hm,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.sca}),
Tb.a.instance.nQd(Object(A.a)(this,this.DHb,"onSessionExpiredDetected")),Tb.a.instance.lQd(Object(A.a)(this,this.Pkc,"onSessionExpiringDetected")))}DHb(){Tb.a.instance.Rjh(Object(A.a)(this,this.DHb,"onSessionExpiredDetected"));n.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.ece()}Pkc(){Tb.a.instance.h0k(Object(A.a)(this,this.Pkc,"onSessionExpiringDetected"));this.TWb||this.cPa||(n.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.TWb=!0,
this.CZe())}ece(){this.cPa||(e.AFrameworkApplication.zp(zb.a.sessionAccessTokenExpired),this.cPa=!0,this.urd())}}Object(h.a)(Xb,"ASessionExpirationManager",null,[]);var Za=d(290),Va=d(37);class tc{constructor(Ha,kb,Hb,ic){this.n2e="";this.Zvc=Ha;this.Lof=Hb;this.Iof=ic;this.Cff=kb;Ha=(new Date(this.Zvc)).format(e.AFrameworkApplication.suh);this.n2e=this.Cff?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,Ha)}DLb(Ha){1===Ha?this.Lof&&this.Lof(this.Cff):
0===Ha&&e.AFrameworkApplication.Ta.La(Va.a.close,2,Za.g)}dispose(){this.Iof&&this.Iof()}}tc.id="SessionExpirationDialog";Object(h.a)(tc,"SessionExpirationDialogSharedProperties",null,[]);class Kb{}Kb.eg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(h.a)(Kb,"SessionExpirationDialogHtml",null,[]);class Pa extends R.a{constructor(Ha,kb,Hb,ic){super(kb);const Qc={};this.mBa=new tc(Ha,kb,Hb,
ic);this.ig=tc.id;e.AFrameworkApplication.JDf?(this.yd=1,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.yd=0,this.Ar=!1);kb||1===e.AFrameworkApplication.Aa.mode?this.Xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.eg=Kb.eg;Qc.WACSessionExpirationText=this.mBa.n2e;this.aj(CommonUIStrings.l_DefaultDialogTitle,Object(A.a)(this,this.DLb,"sessionExpirationDialogHandler"),Qc);this.f6(this.Oh("WACSessionExpirationText"))}DLb(Ha){this.mBa.DLb(Ha)}tZc(){return this.LQ}m8b(){this.hide()}dispose(){super.dispose();
this.mBa&&this.mBa.dispose()}}Object(h.a)(Pa,"LegacySessionExpirationDialog",R.a,[689]);var mb=d(107);class qc extends mb.StandardDialog{constructor(Ha,kb,Hb,ic){super(kb);this.mBa=new tc(Ha,kb,Hb,ic);this.ig=tc.id;e.AFrameworkApplication.JDf?(this.yd=1,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.yd=0,this.Ar=!1);kb||1===e.AFrameworkApplication.Aa.mode?this.Xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Gx(CommonUIStrings.l_DefaultDialogTitle,
this.mBa.n2e,0,Object(A.a)(this,this.DLb,"sessionExpirationDialogHandler"))}DLb(Ha){this.mBa.DLb(Ha)}tZc(){return this.LQ}m8b(){this.hide()}dispose(){super.dispose();this.mBa&&this.mBa.dispose()}}Object(h.a)(qc,"SessionExpirationDialog",mb.StandardDialog,[689]);const oc=(Ha,kb,Hb,ic)=>e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.IC&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new qc(Ha,kb,Hb,ic):new Pa(Ha,kb,Hb,ic);var ib=d(221);class $a extends Xb{constructor(Ha){super();
this.oqb=this.pqb=!0;this.MP=null;this.Pa=new ec.a;this.YH=Ha}cHc(Ha){this.Pa.addHandler($a.tza,Ha)}MRe(Ha){this.Pa.removeHandler($a.tza,Ha)}WYe(Ha){this.pqb=Ha}VYe(Ha){this.oqb=Ha}CZe(){if(!this.MP&&!ib.a.gx){if(this.oqb){const Ha=Object(A.a)(this,this.Vub,"disposeCallback");this.MP=oc(this.hm,!1,Object(A.a)(this,this.ELb,"sessionExpirationHandler"),Ha)}this.Pa.raiseEvent($a.GLb)}}urd(){this.MP&&(this.MP.tZc()&&this.MP.m8b(),this.MP=null);if(this.pqb){const Ha=Object(A.a)(this,this.Vub,"disposeCallback");
this.MP=oc(this.hm,!0,Object(A.a)(this,this.ELb,"sessionExpirationHandler"),Ha)}this.Pa.raiseEvent($a.FLb)}Vub(){this.MP=null}ELb(){this.YH.refreshDocument(null)}}$a.FLb="SE";$a.GLb="SEP";$a.tza="SER";$a.W2e="TRP";Object(h.a)($a,"SessionExpirationManager",Xb,[581,582]);var Db=d(18);class Mb{}Mb.O4h="Aborting";Mb.kGc="ActivityDuration";Mb.error="Error";Mb.y2d="Errors";Mb.failed="Failed";Mb.BQc="FirstActivity";Mb.initialized="Initialized";Mb.UZj="KickedOut";Mb.b_j="LastActivity";Mb.Bmh="RetryOverride";
Mb.Bmd="RequestGroups";Mb.u_a="Requests";Mb.Nmd="Responses";Mb.Kod="SessionDuration";Mb.status="Status";Mb.success="Success";Mb.otl="Successful";Mb.tokens="Tokens";Mb.xLe="PollingDuration";Object(h.a)(Mb,"SessionExpirationStrings",null,[]);var ob=d(82);class jc{constructor(Ha){this.Py={};this.R6={};this.MOa={};this.xrg=15;this.Jgf=!1;this.G0h=new Date;this.MAc=new Date;this.$d=Ha;this.J7=new ob.a(2,2,6E4*this.xrg,Object(A.a)(this,this.fLh,"writeMeasures"),135,"SL",!1);this.$d.Db(this.J7);this.jGj()}fLh(){n.ULS.sendTraceTag(41964821,
217,50,n.ULS.Ane({["Aggregate"]:this.R6,["Current"]:this.Py}))}jGj(){this.R6[Mb.Bmd]=0;this.R6[Mb.u_a]=0;this.R6[Mb.Nmd]=0;this.R6[Mb.status]=Mb.initialized;this.R6[Mb.BQc]=new Date;this.R6[Mb.Kod]=0;this.R6[Mb.kGc]=0;this.R6[Mb.Kod]=0;this.Py[Mb.Kod]=0;this.R6[Mb.kGc]=0;this.Py[Mb.kGc]=0}get NGk(){this.MOa[Mb.xLe]=+new Date-+this.MOa[Mb.BQc];return this.MOa}kee(Ha,kb){var Hb=Ha[kb];Hb=Hb?Hb:0;Hb++;Ha[kb]=Hb;this.lWe(Ha)}lWe(Ha){const kb=new Date;Ha[Mb.kGc]=+kb-+this.MAc;this.MAc=kb;Ha[Mb.Kod]=+this.MAc-
+this.G0h;Ha[Mb.b_j]=this.MAc}LY(Ha,kb){this.Py[Ha]=kb;this.lWe(this.Py)}NVe(Ha,kb){this.Py[Ha]=kb;this.lWe(this.Py)}Hyb(Ha){this.kee(this.Py,Ha);this.kee(this.R6,Ha);this.kee(this.MOa,Ha)}flush(){this.Jgf||(this.R6[Mb.status]=this.Py[Mb.status],this.fLh(this.J7),this.$d.Y5(this.J7,6E4*this.xrg))}g3k(){const Ha=this.Py[Mb.status];Ha&&(this.R6[Mb.status]=Ha);this.Py={}}m3k(){this.MOa={};this.MOa[Mb.xLe]=0;this.MOa[Mb.BQc]=new Date}stop(){n.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.Jgf=!0;this.$d.Mg(this.J7)}}Object(h.a)(jc,"SessionLogger",null,[577]);class Gb{constructor(Ha,kb){this.lFc=Ha;this.sha=kb}get tokens(){return this.lFc}get errors(){return this.sha}}Object(h.a)(Gb,"TokenRefreshArgs",null,[607]);var Gc=d(96),bc=d(199),dc=d(134);class Nb extends Sys.EventArgs{constructor(Ha,kb,Hb,ic,Qc,Jd,yd){super();this.MOa=Ha;this.Bmd=ic;this.failed=Qc;this.u_a=Jd;this.Nmd=yd}}Object(h.a)(Nb,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Ac=d(89);class jb{constructor(Ha,
kb=null,Hb=null){this.TWb=this.cPa=!1;this.oqb=this.pqb=!0;this.Pa=new ec.a;this.VWb=this.pUb=this.nDc=!1;this.VId=null;this.Slf=10;this.tAc=!1;this.eNd=Ha;this.dFd=e.AFrameworkApplication.XYj;this.$d=dc.a.instance;n.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.hm,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.sca});this.Cj=kb||new jc(dc.a.instance);this.kia=Hb;Tb.a.instance.nQd(Object(A.a)(this,
this.J4h,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Tb.a.instance.lQd(Object(A.a)(this,this.qOd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));bc.SessionStatusManager.instance.eQd(Object(A.a)(this,this.qOd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));bc.SessionStatusManager.instance.qbi(Object(A.a)(this,this.QJk,"preemptiveTokenRefresh"));this.Ihf=new Date;e.AFrameworkApplication.WYj&&(Tb.a.instance.QUd=Object(A.a)(this,this.mUk,"refreshAccessTokenWhenSessionExpired"));
Ha=!1;e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Slf=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),Ha=e.AFrameworkApplication.fa.ka("WopiTokenRefreshWhenNetworkResumed"));Ha?bc.SessionStatusManager.instance.eQd(Object(A.a)(this,
this.K4h,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):bc.SessionStatusManager.instance.eQd(Object(A.a)(this,this.qOd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}cHc(Ha){this.Pa.addHandler(jb.tza,Ha)}MRe(Ha){this.Pa.removeHandler(jb.tza,Ha)}mUk(){this.O7b(!1);return!Tb.a.instance.LFa(e.AFrameworkApplication.hm)}J4h(Ha,kb){Tb.a.instance.A0c?this.DHb(Ha,kb):this.dFd?(this.pUb=!1,this.O7b(!1)):(this.cPa||n.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.DHb(Ha,kb))}K4h(Ha,kb){Tb.a.instance.y0c?this.Pkc(Ha,kb):(fa.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.pUb=!1,this.O7b(!0))}qOd(Ha,kb){Tb.a.instance.y0c?this.Pkc(Ha,kb):this.O7b(!0)}O7b(Ha){if(!this.nDc&&!this.pUb)if(this.kia&&this.kia.ebb)this.VWb=!0,this.Cj.LY(Mb.status,Mb.UZj),this.Cj.flush(),this.Cj.stop();else if(n.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",Ha,this.VWb),this.VWb)this.urd();
else{this.Cj.flush();this.Cj.g3k();this.Cj.Hyb(Mb.Bmd);this.nDc=!0;this.tAc||(this.Cj.m3k(),this.tAc=!0,this.UCi());const kb=this.eNd.GUk(Ha);kb.continueWith(()=>{if(this.eNd.qMk(kb))this.Cj.Hyb(Mb.otl),this.Cj.LY(Mb.status,Mb.success),this.oqb=!1,this.dFd&&(this.pqb=!1),this.pUb=!1,this.Ihf=new Date,this.zsl(),this.Pa.raiseEvent(jb.tza,new Gb(kb.result.tokens,null));else{const Hb=kb.result.errors;this.Cj.Hyb(Mb.failed);this.Cj.LY(Mb.status,Mb.failed);Ha||(this.VWb=this.eNd.M$b(Hb));this.VWb&&(this.Cj.LY(Mb.O4h,
JSON.stringify(Hb)),n.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.pUb=!0;this.Pa.raiseEvent(jb.tza,new Gb(null,Hb))}this.Cj.flush();this.nDc=!1})}}DHb(){this.dFd||Tb.a.instance.Rjh(Object(A.a)(this,this.DHb,"onSessionExpiredDetected"));n.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.ece(Tb.a.instance.A0c)}Pkc(){this.TWb||this.cPa||(n.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.TWb=!0,this.CZe(Tb.a.instance.y0c))}ece(Ha){if(!this.cPa){var kb=
Ha?zb.a.w$k:zb.a.sessionAccessTokenExpired;const Hb=Object.assign(new Ac.a,{extendedProperties:new Map});Hb.extendedProperties.set("ErrorCode",String.format("{0}",kb));e.AFrameworkApplication.zp(kb,void 0,["SessionExpired"],Hb);Ha||(Ha=new Date,kb=new Date(e.AFrameworkApplication.sca),n.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",kb,Ha,+Ha-+kb),864E5>+Ha-+kb&&Gc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],
!0,!0,!1,!0,Hb),2592E5>+Ha-+kb&&Gc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Hb));this.cPa=!0;this.urd()}}zsl(){this.tAc&&(this.$d.Mg(this.VId),this.tAc=!1)}UCi(){this.VId=new ob.a(2,2,1E3*this.Slf,Object(A.a)(this,this.Xxl,"tokenRefreshPolling"),135);this.$d.Db(this.VId)}Xxl(){const Ha=this.Cj.NGk;n.ULS.sendTraceTag(555255521,217,50,"{0}",Oa.c(Ha));this.Pa.raiseEvent(jb.W2e,new Nb(Ha,Ha[Mb.xLe],Ha[Mb.BQc],Ha[Mb.Bmd],Ha[Mb.failed],
Ha[Mb.u_a],Ha[Mb.Nmd]))}QJk(){3E5<+new Date-+this.Ihf?(n.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.O7b(!1)):n.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}jb.FLb="SE";jb.GLb="SEP";jb.tza="SER";jb.W2e="TRP";Object(h.a)(jb,"ASessionExpirationManagerWithRefresh",null,[]);class Vb extends jb{constructor(Ha,kb,Hb=null,ic=null){super(kb,Hb,ic);this.MP=null;this.YH=Ha}WYe(Ha){this.pqb=Ha}VYe(Ha){this.oqb=
Ha}CZe(Ha){if(!this.MP&&!ib.a.gx){if(Ha){var kb=Object(A.a)(this,this.Vub,"disposeCallback");this.MP=oc(e.AFrameworkApplication.hLb,!1,Object(A.a)(this,this.ELb,"sessionExpirationHandler"),kb)}else if(this.oqb){if(this.nDc)return;kb=Object(A.a)(this,this.Vub,"disposeCallback");this.MP=oc(e.AFrameworkApplication.hm,!1,Object(A.a)(this,this.ELb,"sessionExpirationHandler"),kb)}n.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",jb.GLb,Ha);this.Pa.raiseEvent(jb.GLb)}}urd(){this.MP&&
(this.MP.tZc()&&this.MP.m8b(),this.MP=null);if(this.pqb){this.Cj.stop();if(this.kia&&this.kia.ebb)return;const Ha=Object(A.a)(this,this.Vub,"disposeCallback");this.MP=oc(e.AFrameworkApplication.hm,!0,Object(A.a)(this,this.ELb,"sessionExpirationHandler"),Ha)}n.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",jb.FLb);this.Pa.raiseEvent(jb.FLb)}Vub(){this.MP=null}ELb(){this.YH.refreshDocument(null)}}Object(h.a)(Vb,"SessionExpirationManagerWithRefresh",jb,[581,582]);class Tc{constructor(Ha,kb,Hb=
null,ic=null){this.brf=!1;this.Ka=null;this.DNa=Ha;this.mOa=kb;this.Cj=Hb||new jc(dc.a.instance);this.kia=ic}create(){this.brf=e.AFrameworkApplication.$z;if(!this.brf)return new $a(this.DNa);e.AFrameworkApplication.Wj("WOPITokenRefreshIsEnabled");n.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Ka)switch(e.AFrameworkApplication.GLl){case 1:n.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this.Ka=new vb(this.DNa);break;
case 2:n.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.Ka=new Vb(this.DNa,this.mOa,this.Cj,this.kia);break;default:n.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.Ka=new $a(this.DNa)}n.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Ka).getName());return this.Ka}}Object(h.a)(Tc,"SessionExpirationManagerFactory",null,[580]);var wb=d(1204),Rb=d(24);class vc{}
Object(h.a)(vc,"Error",null,[]);class rd{}Object(h.a)(rd,"NamedResult",null,[]);class rc extends rd{}Object(h.a)(rc,"ErrorInfo",rd,[]);var cb=d(472),Wb=d(109),Uc=d(175),Ib=d(127),Vc=d(713);class gc{constructor(Ha,kb,Hb,ic=null,Qc=!1,Jd=null,yd=!1,He=!1){this.dBa=0;this.Yqa=this.Xm=null;this.lFc=new Db.a;this.sha=new Db.a;this.dw=null;this.fUb=!1;this.JXb=this.KXb=null;this.$d=Ha;this.Xlf=kb;this.Xlf.execute(sf=>{sf.KB(Ib.a.zde,Object(A.a)(this,this.Avk,"onHostResponseReceived"))});this.wS=Hb;this.Aqf=
new Vc.a("WebServiceCall","TokenRefresh");this.Cj=ic||new jc(Ha);this.A0h=Qc;this.Rqa=Jd?Jd:bc.SessionStatusManager.instance;this.Dbf=yd;this.yyc=He}Avk(Ha){if(Ha.MessageId!==Ib.a.zde)fa.c(39408099,306,15,"Unexpected message.");else{var kb=new Db.a,Hb=new Db.a;this.Cj.Hyb(Mb.Nmd);var ic=Ha.Values[Uc.a.hqh];if(!ic||0>=ic.length)fa.c(40122317,306,15,"Found no tokens in the dictionary"),ic=Ha.Values;fa.c(40122318,306,100,"The Tokens array contains {0} tokens",ic.length);this.Cj.LY("Correlation",Ha.CorrelationId);
var Qc="";for(let He=0;He<ic.length;He++){this.Cj.NVe(Mb.tokens,ic.length);var Jd=ic[He],yd=Jd;if(!yd||!yd.Name)continue;this.Cj.Hyb(yd.Name);const sf=Jd;if(sf&&sf.Value)fa.c(39408128,306,100,"Received token with name: {0}",sf.Name),kb.add(sf),this.lFc.add(sf),this.yyc||this.Cj.LY(Mb.status,Mb.success),this.Dbf&&this.Rqa&&this.Rqa.z3k();else if(Jd=this.njj(Jd),fa.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",yd.Name,JSON.stringify(Jd),this.Yqa),Hb.add(Jd),
this.yyc||(this.sha.add(Jd),Qc=JSON.stringify(Jd),this.Cj.LY(Mb.error,JSON.stringify(Jd)),this.Cj.LY(Mb.status,Mb.failed)),this.Dbf)for(const bg of Jd.Errors)yd=this.z$i(bg),this.Rqa&&this.Rqa.l9h(yd)}this.yyc?(0<Hb.count?this.JXb?this.JXb(new Gb(kb,Hb)):fa.c(512267295,306,15,"Received errors but the promise has completed"):this.KXb?this.KXb(new Gb(kb,Hb)):fa.c(512267294,306,15,"Received valid tokens but the promise has completed"),fa.c(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
kb.count,Hb.count,Ha.CorrelationId,this.Yqa)):(0<Hb.count&&""!==Qc?(ic=Object.assign(new Ac.a,{extendedProperties:new Map}),ic.extendedProperties.set("Errors",Qc),ic.extendedProperties.set("RetryCount",this.dBa.toString()),ic.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),ic.extendedProperties.set("IsTokenExpiring",this.fUb.toString()),Gc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ic)):Gc.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),fa.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",kb.count,Hb.count,Ha.CorrelationId,this.Yqa),0<Hb.count&&!this.M$b(Hb)?(Ha=this.wS.F6f(Hb),Ha!==this.wS.VKb&&(this.Cj.NVe(Mb.Bmh,Ha),this.$d.Y5(this.Xm,Ha))):(this.Cj.flush(),this.Xm&&(fa.c(39408131,306,100,"Deleting task {0} from task manager",this.Xm.name),this.$d.Mg(this.Xm)),this.dw&&!this.dw.task.isCompleted?this.dw.Kg(new Gb(kb,Hb)):fa.c(512267293,306,15,"Received results but the task has completed")))}}njj(Ha){if(!Ha)return null;
const kb=Object.assign(new rc,{Name:Ha.Name,Errors:[]});for(const Hb of Ha.Errors)Ha=new vc,Ha.Id=Hb.Id,Ha.Details=cb.a.Bxb(Hb.Details,500),kb.Errors.push(Ha);return kb}requestTokensOnce(){this.Blh()}Blh(){e.AFrameworkApplication.dGa("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.dBa>=this.wS.kZg?(fa.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Yqa),this.sEi(this.dw)):(Gc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),
this.Fph())}Fph(){const Ha={};Ha[Uc.a.hqh]=this.wS.tokens;const kb=Wb.a.create().toString();fa.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.wS.tokens),this.dBa+1,kb,this.Yqa);this.Xlf.execute(Hb=>{Hb.sendMessage(Ib.a.hRd,Ha,kb)});this.dBa++;this.Cj.Hyb(Mb.u_a)}sEi(Ha){const kb=new Db.a;for(let Hb=0;Hb<this.wS.tokens.length;Hb++){const ic=Object.assign(new rc,{Name:this.wS.tokens[Hb],Errors:[Object.assign(new vc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
kb.add(ic);this.sha.add(ic)}this.$d.Mg(this.Xm);this.Cj.LY(Mb.y2d,JSON.stringify(this.sha));this.Cj.LY(Mb.status,Mb.failed);Ha&&!Ha.task.isCompleted&&Ha.Kg(new Gb(new Db.a,this.sha))}GUk(Ha){this.Aqf.start();this.fUb=Ha;this.Yqa=Wb.a.create().toString();fa.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Yqa,this.fUb);this.dBa=0;this.sha.clear();this.lFc.clear();this.dw=new Ma.a;this.yyc?this.Clh(this.wS.kZg).then(kb=>{this.dw&&!this.dw.task.isCompleted&&this.dw.Kg(kb);
this.JXb=this.KXb=null;this.Cj.LY(Mb.y2d,JSON.stringify(this.sha));this.Cj.LY(Mb.status,Mb.success);this.Cj.flush()}).catch(kb=>{this.dw&&!this.dw.task.isCompleted&&this.dw.Kg(Object(wb.a)(607,kb));this.JXb=this.KXb=null;this.Cj.LY(Mb.y2d,JSON.stringify(this.sha));this.Cj.LY(Mb.status,Mb.failed);this.Cj.flush()}):(this.Xm=new ob.a(this.wS.priority,2,this.wS.VKb,Object(A.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Ib.a.hRd,!0),this.A0h&&this.Blh(),this.$d.Db(this.Xm));return this.dw.task}Clh(Ha){const kb=
this,Hb=new Promise((He,sf)=>{kb.KXb=He;kb.JXb=sf;Gc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);kb.Fph()}),ic=this,Qc=new Promise((He,sf)=>{window.setTimeout(()=>{sf(ic.JKf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},ic.wS.VKb)});let Jd=Ha;const yd=this;return new Promise((He,sf)=>{Jd--;Promise.race([Hb,Qc]).then(bg=>{Gc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);He(bg)}).catch(bg=>{var Ag=yd.wS.VKb;if(Object(Rb.a)(607,
bg)&&(bg=Object(wb.a)(607,bg),0<bg.errors.count)){yd.D3j(bg.errors);yd.btf(bg.errors);if(yd.M$b(bg.errors)){sf(bg);return}const Ii=yd.wS.F6f(bg.errors);Ii!==yd.wS.VKb?(yd.Cj.NVe(Mb.Bmh,Ii),Ag=Ii):yd.vXj(bg.errors)&&(Ag=0)}Jd?window.setTimeout(()=>{yd.Clh(Jd).then(He).catch(sf)},Ag):(Ag=yd.JKf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),yd.btf(Ag.errors),sf(Ag),fa.c(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
yd.Yqa))})})}btf(Ha){for(let kb of Ha)this.sha.add(kb)}vXj(Ha){if(!Ha.count)return!1;Ha=Ha.ga(Ha.count-1);return Ha.Errors.length?"TIMEOUT"==Ha.Errors[0].Id:!1}JKf(Ha,kb){const Hb=new Db.a;for(let ic=0;ic<this.wS.tokens.length;ic++){const Qc=this.tEi(this.wS.tokens[ic],Ha,kb);Hb.add(Qc)}return new Gb(new Db.a,Hb)}tEi(Ha,kb,Hb){return Object.assign(new rc,{Name:Ha,Errors:[Object.assign(new vc,{Id:kb,Details:Hb})]})}D3j(Ha){if(Ha.count){Ha=Ha.ga(Ha.count-1);Ha=JSON.stringify(Ha);var kb=Object.assign(new Ac.a,
{extendedProperties:new Map});kb.extendedProperties.set("Errors",Ha);kb.extendedProperties.set("RetryCount",this.dBa.toString());kb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());kb.extendedProperties.set("IsTokenExpiring",this.fUb.toString());Gc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,kb);this.Cj.LY(Mb.error,Ha);this.Cj.LY(Mb.status,Mb.failed)}}qMk(Ha){this.Aqf.stop();const kb=this.czj(Ha.result.errors);n.ULS.sendTraceTag(41755339,
217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!kb,this.Yqa,this.fUb,this.dBa,this.sha.count,0<Ha.result.errors.count?Ha.result.errors.ga(0).Name:"",0<Ha.result.errors.count&&0<Ha.result.errors.ga(0).Errors.length?Ha.result.errors.ga(0).Errors[0].Id:"",0<Ha.result.errors.count&&0<Ha.result.errors.ga(0).Errors.length?Ha.result.errors.ga(0).Errors[0].Details:"");return kb?
!1:this.pMk(Ha.result.tokens)}M$b(Ha){return this.wS.M$b(Ha)}pMk(Ha){for(let kb=0;kb<Ha.count;kb++){const Hb=Ha.ga(kb);if(Hb.Name===Uc.a.accessToken){const ic=(new Date).getTime();Hb.Expiry>e.AFrameworkApplication.hm?(n.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Hb.Expiry,["NowGetTime"]:ic,["BootTime"]:e.AFrameworkApplication.sca},"PreviousAccessTokenTtl",e.AFrameworkApplication.hm),e.AFrameworkApplication.accessToken=Hb.Value,e.AFrameworkApplication.hm=Math.floor(Hb.Expiry),
e.AFrameworkApplication.X6e=ic,e.AFrameworkApplication.L7=Math.floor(Hb.Expiry)):n.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Hb.Expiry,["NowGetTime"]:ic,["BootTime"]:e.AFrameworkApplication.sca},"PreviousAccessTokenTtl",e.AFrameworkApplication.hm)}}return!0}czj(Ha){let kb=!1;for(let Hb=0;Hb<Ha.count;Hb++){kb=!0;const ic=Ha.ga(Hb);n.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
ic.Name,JSON.stringify(ic.Errors),this.Yqa)}return kb}z$i(Ha){let kb=zb.a.sessionAccessTokenExpired;Ha=parseInt(Ha.Id);if(isNaN(Ha))kb=zb.a.KLl;else{switch(Ha){case 401:kb=zb.a.NLl;break;case 403:kb=zb.a.ILl;break;case 500:kb=zb.a.JLl;break;case 503:kb=zb.a.MLl}kb===zb.a.sessionAccessTokenExpired&&(kb=500<Ha?zb.a.LLl:zb.a.HLl)}return kb}}Object(h.a)(gc,"TokenRefreshManager",null,[579]);class rb{constructor(){this.VKb=e.AFrameworkApplication.QLl;this.kZg=e.AFrameworkApplication.OLl;this.tokens=e.AFrameworkApplication.qqj();
this.priority=e.AFrameworkApplication.RLl;this.tnf=this.xel();this.eOd=e.AFrameworkApplication.pqj()}M$b(Ha){Ha=JSON.stringify(Ha);if(this.eOd&&0<this.eOd.length)for(const kb of this.eOd)if(0<kb.length&&0<=Ha.indexOf(kb))return!0;return!1}F6f(Ha){try{if(Ha)for(let kb of Ha)if(kb.Errors)for(const Hb of kb.Errors)if(Hb.Id in this.tnf)return Number.parseInvariant(this.tnf[Hb.Id].toString())}catch(kb){n.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",kb.toString())}return this.VKb}xel(){const Ha=
{};try{if(!e.AFrameworkApplication.zVc()||0>=e.AFrameworkApplication.zVc().length||""===e.AFrameworkApplication.zVc()[0])return Ha;for(const kb of e.AFrameworkApplication.zVc())0<kb.length&&(Ha[kb]=e.AFrameworkApplication.PLl)}catch(kb){n.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",kb.toString())}return Ha}}Object(h.a)(rb,"TokenRefreshPolicy",null,[578]);class Zb{constructor(){this.Da=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.ff(()=>
{this.REa()})}REa(){this.Da.resolve("Common.ISessionExpirationManagerFactory");this.Da.resolve("Common.ISessionExpirationManager");this.Da.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Zb(Ha){this.Da=Ha;Ha.register(577,"Common.App.SessionExpiration.ISessionLogger").ma().oa(()=>new jc(dc.a.instance));Ha.register(578,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().oa(()=>new rb);Ha.register(579,"Common.App.SessionExpiration.ITokenRefreshManager").ma().oa(()=>new gc(dc.a.instance,
e.AFrameworkApplication.nT(),Ha.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),Ha.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),Ha.rb("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSyncMessageWithTimeout")));Ha.register(580,"Common.ISessionExpirationManagerFactory").ma().oa(()=>
new Tc(e.AFrameworkApplication.Aa,Ha.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),Ha.resolve("Common.App.SessionExpiration.ISessionLogger"),Ha.rb("Common.ISessionStatus")));Ha.register(581,"Common.ISessionExpirationManagerWithDialog").ma().oa(()=>Ha.resolve("Common.ISessionExpirationManagerFactory").create());Ha.register(582,"Common.ISessionExpirationManager").ma().oa(()=>Ha.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){r.a.instance.Dc(new Zb)}}Object(h.a)(Zb,
"SessionExpirationPackage",null,[2,3]);var Hc=d(55),Ab=d(441),ad=d(39),Bd=d(155),kd=d(121),Be=d(135),Qd=d(60),ae=d(28),We=d(35),$d=d(30);class Re extends ib.a{constructor(Ha,kb){super();this.kfa=null;this.p7j=!1;this.q8j="";this.wIg=this.xIg=this.Ytg=this.Ztg=null;this.yd=3;this.Xe(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Xe(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=Ha;this.oJg=kb.rk(Qd.a.DFk)}dispose(){this.kfa=null;super.dispose()}showDialog(Ha){this.aj(Ha);this.Ztg=document.getElementById("btnMaximize");
this.xIg=Object(A.a)(this,this.Myk,"onScaleUpButton");u.a.addHandler(this.Ztg,"click",this.xIg);this.Ytg=document.getElementById("btnEnsure");this.wIg=Object(A.a)(this,this.Lyk,"onScaleDownButton");u.a.addHandler(this.Ytg,"click",this.wIg)}aj(Ha){this.sqa=Object(A.a)(this,this.jfl,"setSlideOrientationRatio");this.xya(Ha);this.fm.style.width="420px";this.show()}hide(){this.Hb&&(e.AFrameworkApplication.Aa.Pw.Lo(kd.AFrame.z5),super.hide())}Myk(Ha){this.ia.processAction($d.a.Kqc,2);Ha.preventDefault();
this.KV&&this.hide()}Lyk(Ha){this.ia.processAction($d.a.Jqc,2);Ha.preventDefault();this.KV&&this.hide()}jfl(Ha){1===Ha?this.ia.processAction($d.a.Kqc,2):2===Ha?this.ia.processAction($d.a.Jqc,2):ae.a.J(25277209,822,50,"Cancle the slide orientation change.");this.KV&&this.hide()}xya(){this.qu();this.BA()}qu(){super.qu();Sys.UI.DomElement.addCssClass(this.Hb,this.q8j);var Ha=$get("WACDialogTitleText");Ha.innerText=ResourceStrings.l_SetSlideScaleTitle;Ha.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);
Ha=document.createElement("div");Ha.id=this.Oh("WACDialogHtmlPanel");Ha.className="WACDialogHtmlPanel";this.fm.appendChild(Ha);this.kfa=document.createElement("div");this.kfa.id=this.Oh("WACDialogText");Ha.appendChild(this.kfa);Ha=document.createElement("div");Ha.id=this.Oh("Scalediv");Ha.className="WACDialogRow";this.kfa.appendChild(Ha);var kb=document.createElement("label");kb.id=this.Oh("Scalelabel");kb.innerText=ResourceStrings.L_SetSlideOrientationInformation;Ha.appendChild(kb);Ha=document.createElement("div");
Ha.id=this.Oh("ScaleMode");Ha.setAttribute("style","margin-left: 20px;");Ha.className="WACDialogRow";this.kfa.appendChild(Ha);kb=Re.OKf(Qd.a.Y$g+"_MaximizeFit_170x130x32",this.oJg,ResourceStrings.L_SetSlideOrientationMaximize);kb.id=this.Oh("btnMaximize");var Hb=document.createElement("td");Hb.className=String.format("clip{0}x{1}","170","130");Hb.setAttribute("style","border: #ccc 1px solid");Hb.appendChild(kb);kb=Re.OKf(Qd.a.Y$g+"_Ensurefit_170x130x32",this.oJg,ResourceStrings.L_SetSlideOrientationEnsure);
kb.id=this.Oh("btnEnsure");var ic=document.createElement("td");ic.className=String.format("clip{0}x{1}","170","130");ic.setAttribute("style","border: #ccc 1px solid");ic.appendChild(kb);var Qc=document.createElement("td");Qc.setAttribute("style","width: 30px;");kb=document.createElement("tr");kb.appendChild(Hb);kb.appendChild(Qc);kb.appendChild(ic);Hb=document.createElement("td");Hb.setAttribute("align","center");ic=document.createElement("label");ic.id=this.Oh("Maxlabel");ic.className="UIFontBold";
ic.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Hb.appendChild(ic);ic=document.createElement("td");ic.setAttribute("align","center");Qc=document.createElement("label");Qc.id=this.Oh("Ensurelabel");Qc.className="UIFontBold";Qc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;ic.appendChild(Qc);const Jd=document.createElement("td");Jd.setAttribute("style","width: 30px;");Qc=document.createElement("tr");Qc.appendChild(Hb);Qc.appendChild(Jd);Qc.appendChild(ic);Hb=document.createElement("table");
Hb.appendChild(kb);Hb.appendChild(Qc);Ha.appendChild(Hb)}BA(){this.Crd(ib.a.qmc+(ib.a.HU-Re.xni)/2-12,ib.a.pmc+(ib.a.CR-Re.Cni)/2-12)}Crd(Ha,kb){this.Hb.style.top=(0>Ha?0:Ha)+"px";We.a("DeprecateIE.SetSlideOrientation")?this.Hb.style.left=(0>kb?0:kb)+"px":Hc.a.bbb&&e.AFrameworkApplication.isRtl?this.Hb.style.right=(0>kb?0:kb)+"px":this.Hb.style.left=(0>kb?0:kb)+"px";this.p7j||(this.Hb.style.width=String.format("{0}em",this.width));this.Hb.style.display="Block"}static OKf(Ha,kb,Hb){const ic=document.createElement("img");
ic.className=Ha;ic.setAttribute("Unselectable","on");ic.setAttribute(Be.a.af,Be.a.pN);ic.src=kb;Hb&&(ic.alt=Hb,ic.title=Hb);return ic}}Re.Cni=350;Re.xni=200;Object(h.a)(Re,"SetSlideOrientationDialog",ib.a,[]);var Ta=d(52),xb=d(111),kc=d(248),Nc=d(70);class id extends R.a{constructor(Ha,kb){super(!1,!1,!0);this.hJf=this.p3=null;if(!Ha)throw Error.argumentNull("actionManager");if(!kb)throw Error.argumentNull("presentationReader");this.ia=Ha;this.oc=kb}SEa(){this.p3=Object(A.a)(this,this.kfl,"setSlideSizeAndLayoutDialogResultHandler");
this.hJf=this.A2i(this.getCurrentSlideDimensions());this.aj(ResourceStrings.L_SetSlideSize,this.p3,this.hJf)}kfl(Ha,kb){1===Ha&&this.ia.La($d.a.Dsh,2,kb);this.dispose()}getCurrentSlideDimensions(){const Ha=this.oc.Hu(),kb={};kb.height=Ha.height;kb.width=Ha.width;kb.slideType=this.oc.mlj();return kb}A2i(Ha){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:Ha,["numberFormatInfo"]:Nc.e().numberFormatInfo}}}Object(h.a)(id,"SlideSizeAndLayoutDialog",R.a,[]);class Ed{constructor(Ha,kb,Hb,ic,Qc,
Jd,yd,He,sf){this.tIa=this.Vma=this.tU=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");this.Kxh=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.Xxh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=Ha;this.Fa=kb;this.gf=Hb;this.Jb=
ic;this.Vb=Qc;this.ua=Jd;this.pa=He;this.oc=yd;this.qe=sf}wb(){this.ia.ra($d.a.wkd,Ta.a.application,Object(A.a)(this,this.KOe,"querySlideSize"),96);this.ia.ra($d.a.vkd,Ta.a.application,Object(A.a)(this,this.KOe,"querySlideSize"),96);this.ia.ra($d.a.LOe,Ta.a.application,Object(A.a)(this,this.KOe,"querySlideSize"),96);this.ia.ya($d.a.mfl,Ta.a.application,Ab.a.dH);this.ia.ra($d.a.WNk,Ta.a.application,Ab.a.h1,96);this.ia.ra($d.a.Mqc,Ta.a.application,Object(A.a)(this,this.yxj,"handleSetSlideSize"),4);
this.ia.ra($d.a.Spd,Ta.a.application,Object(A.a)(this,this.Axj,"handleSetSlideSize4x3"),4);this.ia.ra($d.a.Rpd,Ta.a.application,Object(A.a)(this,this.zxj,"handleSetSlideSize16x9"),4);this.ia.ra($d.a.QJe,Ta.a.application,Object(A.a)(this,this.I_j,"launchSlideSizeAndLayoutDialogHandler"),4);this.ia.ra($d.a.ABk,Ta.a.application,Object(A.a)(this,this.Xpg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.ra($d.a.BBk,Ta.a.application,Object(A.a)(this,this.Xpg,"launchSetSlideOrientationScaleTypeDialogHandler"),
4);this.ia.ra($d.a.Kqc,Ta.a.application,Object(A.a)(this,this.Csh,"setSlideOrientationHandler"),4);this.ia.ra($d.a.Jqc,Ta.a.application,Object(A.a)(this,this.Csh,"setSlideOrientationHandler"),4);this.ia.ra($d.a.Dsh,Ta.a.application,Object(A.a)(this,this.lfl,"setSlideSizeAndLayoutHandler"),4);this.ia.ya($d.a.nfl,Ta.a.application,Ab.a.dH);this.ia.ya($d.a.setSlideHeight,Ta.a.application,Ab.a.dH);this.ia.ra($d.a.YNk,Ta.a.application,Ab.a.h1,96);this.ia.ra($d.a.XNk,Ta.a.application,Ab.a.h1,96);this.ia.ya($d.a.Oql,
Ta.a.application,Ab.a.dH);this.ia.ya($d.a.Nql,Ta.a.application,Ab.a.dH)}Ee(){}KOe(Ha,kb,Hb,ic,Qc){ae.a.J(34936782,822,50,"Click slide size drop down.");if(kb.contextId!==Ta.a.application)return 2;if(kb=Object(wb.a)(xb.a,Qc))Ha=Ed.YMj(this.oc.Hu(),Ha),kb.Lf(Ha);return 32}I_j(Ha,kb,Hb){kb=this.ua.Ba;return!kb||this.gf.$c(kb)||!We.a("DeprecateIE.CustomizeSlideSizeActor")&&Hc.a.px?8:1===Hb?32:Bd.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",Ha,()=>{(new id(this.ia,this.oc)).SEa();
ae.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}Xpg(Ha,kb,Hb,ic,Qc){Ha=this.ua.Ba;if(!Ha||this.gf.$c(Ha))return 16;if(1===Hb)return 32;if("slideType"in Qc&&"slideWidth"in Qc&&"slideHeight"in Qc)if(this.tIa=6,"o_custom"===Qc.slideType.toString().toLowerCase())this.tU=6*Math.round(Qc.slideWidth),this.Vma=6*Math.round(Qc.slideHeight);else{Hb=0;for(const Jd of this.slideSizeType){if(Qc.slideType.toString().toLowerCase()===Jd.toLowerCase()){this.tIa=Hb;break}Hb++}"landscape"===
Qc.orientation.toString()?(this.Vma=this.Kxh[Hb],this.tU=this.Xxh[Hb]):(this.tU=this.Kxh[Hb],this.Vma=this.Xxh[Hb])}(new Re(this.ia,this.qe)).showDialog(ResourceStrings.l_SetSlideScaleTitle);ae.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}yxj(Ha,kb,Hb){Ha=this.ua.Ba;return!Ha||this.gf.$c(Ha)?8:this.ia.processAction($d.a.i8a,Hb)}Axj(Ha,kb,Hb){ae.a.J(34936788,822,50,"click set slide size 4:3.");kb=this.ua.Ba;if(!kb||this.gf.$c(kb))return 16;if(1===Hb||960===this.oc.Hu().width)return 32;
this.tU=5760;this.Vma=4320;this.tIa=0;return this.nMb(this.tU,this.Vma,Ha,this.tIa,"EnsureFit")}zxj(Ha,kb,Hb){ae.a.J(34936792,822,50,"click set slide size 16:9.");kb=this.ua.Ba;if(!kb||this.gf.$c(kb))return 16;if(1===Hb)return 32;Hb=this.oc.Hu();if(1280===Hb.width)return 32;this.tU=7680;this.Vma=4320;this.tIa=16;return 960===Hb.width&&720===Hb.height?this.nMb(this.tU,this.Vma,Ha,this.tIa,""):this.nMb(this.tU,this.Vma,Ha,this.tIa,"EnsureFit")}lfl(Ha,kb,Hb,ic,Qc){kb=this.ua.Ba;return!kb||this.gf.$c(kb)?
8:1===Hb?32:this.nMb(Qc.width,Qc.height,Ha,Qc.slideType,Qc.slideScaleType)}Csh(Ha,kb,Hb){kb=this.ua.Ba;return!kb||this.gf.$c(kb)?16:1===Hb?32:this.Vma&&this.tU?Ha===$d.a.Kqc?this.nMb(this.tU,this.Vma,Ha,this.tIa,"Maximize"):Ha===$d.a.Jqc?this.nMb(this.tU,this.Vma,Ha,this.tIa,"EnsureFit"):32:(ae.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}nMb(Ha,kb,Hb,ic,Qc){const Jd=this.ua.Ba;let yd=!1;if(Jd){var He=Jd.gk();if(He&&0<He.length)for(const sf of He)if(sf.iFa){yd=
!0;break}}He=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()});try{He.kd(Jd),He.jd=Hb,He.Zy[kc.a.byb]=yd,Jd.setValue(ad.a.slideWidth,Ha),Jd.setValue(ad.a.slideHeight,kb),Jd.setValue(ad.a.slideScaleType,Qc),Jd.setValue(ad.a.slideSizeType,ic)}finally{He&&He.dispose()}ae.a.J(34936798,822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",Ha,kb,Qc);this.gf.YZb(this.Vb.xf,Jd,Hb);return 32}static YMj(Ha,kb){Ha=Ha.width/Ha.height;switch(kb){case $d.a.wkd:return.01>Math.abs(Ha-1.33);case $d.a.vkd:return.01>
Math.abs(Ha-1.77);default:return!1}}}Object(h.a)(Ed,"CustomizeSlideSizeActor",null,[365]);class Ja{}Ja.Wlh=0;Ja.l3k=22711;Object(h.a)(Ja,"ImageConstants",null,[]);var db=d(233),zc=d(325),Hd=d(446),Ad=d(43),Kd=d(103),Pc=d(246),tf=d(110);class xe extends tf.a{constructor(){super();this.ImageToken=null;this.ErrorCode=0}Zk(){return 78}}Object(h.a)(xe,"NotifyImageUploadFailureRequest",tf.a,[]);class ef{constructor(Ha,kb,Hb,ic,Qc,Jd,yd,He,sf,bg,Ag,Ii,aj,Xg,Qi,Jh,Og,Qh,Yg,If,mj,xi,Bj){this.rIa=this.aWa=
this.vJ=null;this.ZFb=!1;this.yxk=(yi,Zg)=>{(yi=y.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&Zg&&Zg.hTj&&yi.execute(ya=>{ya.logActivity("InsertPicture",null)})};this.ia=Ha;this.ob=Hb;this.fc=kb;this.ua=Qc;this.Jb=Jd;this.Fa=ic;this.rB=yd;this.kR=He;this.Sk=sf;this.Oye=bg;this.Ou=Ag;this.Sd=Ii;this.Fb=aj;this.Ngc=Xg;this.Yec=Qi;this.MWa=Jh;this.wi=Og;this.Zj=Qh;this.Ha=Yg;this.gl=If;this.Lc=mj;this.fU=Yg.OIb;this.Ea=xi;this.fbk=null===Bj||void 0===Bj?void 0:Bj.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",
!1);this.Wu()}Wu(){this.fbk&&this.Lc.Dai(this.yxk)}wb(){this.ia.ra($d.a.insertPicture,T.a.application,Object(A.a)(this,this.uag,"handleInsertPicture"),4);this.ia.ra($d.a.pQc,T.a.view,Object(A.a)(this,this.syj,"handleUploadPictureAll"),4);this.ia.ra($d.a.NJc,T.a.application,Object(A.a)(this,this.osj,"handleChangePicture"),4);this.ia.ra($d.a.Hmd,T.a.application,Object(A.a)(this,this.Wwj,"handleResetPicture"),4);this.ia.ra($d.a.Ulh,T.a.application,Object(A.a)(this,this.Xwj,"handleResetPictureAndSize"),
4);this.ia.ra($d.a.Vlh,T.a.application,Object(A.a)(this,this.Ywj,"handleResetPictureSplitButton"),4);this.ia.ra($d.a.Tra,T.a.application,Object(A.a)(this,this.psj,"handleChangePictureStyle"),4);this.ia.ra($d.a.a1d,T.a.application,Object(A.a)(this,this.uag,"handleInsertPicture"),4);this.ia.ra($d.a.QQf,T.a.application,Object(A.a)(this,this.etj,"handleDragAndInsertImage"),4)}Ee(){}uag(Ha,kb,Hb){this.Ha.Nig&&!We.a("DummyChangeGateForTest")&&ae.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");
kb=this.ua.Ba;kb=this.Ha.X_c&&!!kb&&!this.fc.$c(kb);kb=(this.Yec=this.Ngc.yLj()&&this.Yec)?kb&&!!this.rB&&this.rB.Hvd:this.kR.rjg&&kb;if(!kb)return 16;if(1===Hb)return 32;this.ZFb=!0;this.rIa=this.ua.Ba;this.xrd(Ha!==$d.a.a1d,!0);return 32}syj(Ha,kb,Hb,ic,Qc){var Jd=this.ua?this.ua.Ba:null;if(!Jd||!Jd.isConnected)return 16;if(!this.Zj.OF(Jd,1))return this.Zj.mG(Jd),16;ae.a.J(512500497,822,50,"Start picture upload");kb=ef.OWj(Qc);(ic=Ad.a.Ib)&&ic.Va(Kd.a.sIj,kb?"1":"0");this.Lc.yRk();let yd=!1;if(this.ZFb&&
this.Yec&&!this.rB.wkb&&this.ZQj(kb)){if(Jd=Jd.G3(this.ob.Xd())){if(15!==Jd.Jj){const He=Jd.SU;He.BottomLeft.X!==He.TopLeft.X&&(yd=!0)}ic&&ic.Va(Kd.a.r5k,yd?"1":"0")}Jd&&(15===Jd.Jj||yd)?(ic&&ic.Va(Kd.a.x3d,yd?"PlaceHolder Rotated":"Picture Type PlaceHolder"),Ha=this.zbg(Ha,Hb,Qc)):Ha=this.tyj(Ha,Hb,Qc)}else this.rB.wkb=!1,Ha=this.zbg(Ha,Hb,Qc);kb&&32===Ha&&ae.a.J(512500496,822,50,"Upload a svg file successfully.");return Ha}ZQj(Ha){return Ha?this.Ha.powerPointInsertSVGFileLocalRenderingEnabled:!0}etj(Ha,
kb,Hb,ic,Qc){if(!this.rB.iGk)return ae.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Qc)return 16;Ha=[];kb=0;Hb=!1;for(const Jd of Qc)if(kb++,"string"===typeof Jd.type)if(Qc=F.a.rg(Jd.type),ae.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",kb,Jd.size,Qc),0<=Qc.indexOf("image")&&0===this.rB.Yvd(Jd.name))if(Ha.length<this.Ha.powerPointDragInsertMultipleImageQuantityLimit)Array.add(Ha,
Jd);else{this.gl.dL(19);break}else Hb||(this.gl.dL(18),Hb=!0);if(1>Ha.length)return ae.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.rB.kQi(Ha);return 32}zbg(Ha,kb,Hb){if(!(this.ua&&this.ua.Ba&&this.rB))return 16;if(1===kb)return 32;this.kR.Dhb=new Date;this.ZFb&&this.ob.jj();this.Fa.Ed();this.fc.blockContent(this.ua.presentation,Ha);const ic=Ad.a.Ib;this.rB.W_e(Hb,Qc=>{Ad.a.DI(ic,()=>{ae.a.J(512500492,822,50,"Picture upload successful");this.Dvj(Hb,
Qc,Ha);this.EYf()})},Qc=>{ae.a.J(512500491,822,10,"Upload picture failed");this.R7b(Qc.error);this.EYf()});return 32}tyj(Ha,kb,Hb){if(!(this.ua&&this.ua.Ba&&this.rB))return 16;if(1===kb)return 32;const ic=String.format("{0}{1}","client",Wb.a.create().toString());ae.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",ic,Hb.wL);this.kR.Yii(ic);const Qc=Ad.a.Ib;Qc&&(kb="InsertPicture",this.ZFb||(kb="ChangePicture"),Qc.actionName=kb,Qc.Oj=!0);const Jd=new Date;Ad.a.Ak("PictureUploadStart",
Ad.a.mf(Jd));Ad.a.Ak("ImageSize",Hb.wL.toString());Ad.a.Ak("ImageToken",ic);const yd=this.ua.Ba.sid;this.ia.La($d.a.tfe,2,yd);this.rB.W_e(Hb,He=>{Ad.a.DI(Qc,()=>{ae.a.J(512500489,822,50,"Upload picture completed");Ad.a.Ak("PictureUploadDurationMS",(+new Date-+Jd).toString());this.hGk(ic,He);this.ia.La($d.a.XXc,2,yd)})},He=>{this.kR.GSf(ic);var sf=Object.assign(new xe,{ImageToken:ic,ErrorCode:He.error.Code});Qc&&Qc.Va("UploadPictureErrorCode",db.a[sf.ErrorCode]);sf=new Pc.a(sf,null,()=>ef.Uwk());this.wi.Db(sf);
ae.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",ic,db.a[He.error.Code],He.error.Message);this.ia.La($d.a.XXc,2,yd)},ic);this.insertPicture(ic,Ha,Hb);return 32}osj(Ha,kb,Hb){Ha=this.fU?this.J9a():this.Wwb();if(!(this.fU?this.N$b(Ha):this.Slg(Ha)&&this.Ha.X_c&&this.kR.rjg&&!this.fc.$c(Ha)))return 16;if(1===Hb)return 32;this.ZFb=!1;this.xrd(!0,!1);return 32}Wwj(Ha,kb,Hb){return this.Tra(kb,Hb,Ja.Wlh,Ha)}Xwj(Ha,kb,Hb){return this.Tra(kb,Hb,Ja.l3k,Ha)}Ywj(Ha,
kb,Hb,ic,Qc){return this.Tra(kb,1,Qc,Ha)}psj(Ha,kb,Hb,ic,Qc){return this.Tra(kb,Hb,Qc,Ha)}Tra(Ha,kb,Hb,ic){const Qc=this.ob.Xd();if(!(Qc&&0<Qc.length))return 8;Ha=[];if(We.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.xjj(Qc,Ha);else for(const yd of Qc){if(this.flg(yd)||this.fc.$c(yd))return 8;(this.fU?this.N$b(yd):this.Slg(yd))&&Ha.push(yd)}if(0>=Ha.length)return 8;if(1===kb)return 32;ae.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Hb);kb=Ad.a.Ib?Ad.a.Ib.actionName:
null;for(var Jd of Ha)this.TRa(Jd);Jd=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{Jd.nc(Ha[0]);Jd.jd=ic;for(const yd of Ha)yd.Chb=Hb}finally{Jd&&Jd.dispose()}if(ic=Ad.a.Ib)kb&&(ic.actionName=kb),ic.Va("PictureStyleId",Hb.toString()),Ad.a.Tfa(ic);return 32}xjj(Ha,kb){let Hb=!1;for(const ic of Ha){if(!ic||this.flg(ic)||this.fc.$c(ic))return;ic.Og&&(Hb=!0)}if(Hb)for(const ic of Ha)ic.Og&&this.N$b(ic)&&kb.push(ic);else for(const ic of Ha)if(this.N$b(ic))kb.push(ic);else if(ic.If){Ha=this.Ea.ix(ic);
for(const Qc of Ha)this.N$b(Qc)&&kb.push(Qc)}}Dvj(Ha,kb,Hb){this.kR.wZa=new Date;const ic=kb.result;if(Ha){if(this.ZFb?(kb="InsertPicture",this.ZHj(ic,Ha,Hb)):(kb="ChangePicture",We.a("ChangePictureOnMultiSelectFixEnabled")?this.Jri(ic,Ha,Hb):this.Kri(ic,Ha,Hb)),Ha=Ad.a.Ib)Ha.actionName=kb,Ha.Va("PictureUploadStart",Ad.a.mf(this.kR.Dhb)),Ha.Va("PictureUploadDurationMS",(+this.kR.wZa-+this.kR.Dhb).toString())}else Ha=Object.assign(new zc.a,{Code:94}),this.R7b(Ha)}hGk(Ha,kb){this.kR.GSf(Ha);kb.result||
ae.a.J(512500486,822,50,"Upload picture completed with null response")}ZHj(Ha,kb,Hb){const ic=this.ua.Ba;if(ic&&ic.isConnected){this.aWa=ic.G3(this.ob.Xd());var Qc=this.Jb.Ad(15,void 0,void 0,()=>{this.ob.selectShape(this.vJ,!0);this.Fa.Ed()});try{Qc.nc(ic),Qc.jd=Hb,Qc.Zy[kc.a.rDa]=kc.a.$Yf,this.vJ=this.Sk.rEi(ic.Cb),this.aWa&&(this.vJ.vca=this.aWa.id),this.vJ.bMb(Ha.ItemId,this.Ha.FUa?null:kb.fileName,kb.fileName),ic.gC(this.vJ)}finally{Qc&&Qc.dispose()}this.fc.Qra(this.ua.Ba,this.vJ,this.Fb.Ma,
"InsertPictureAfterUpload");this.Ou.SF=this.vJ}}Jri(Ha,kb,Hb){var ic=this.ob.Xd();if(ic){var Qc=[];for(const Jd of ic)Jd.If||Qc.push(Jd);for(const Jd of Qc)this.TRa(Jd);ic=this.Jb.Ad(15);try{ic.jd=Hb;ic.nc(Qc[0]);for(const Jd of Qc)Jd.vca=Jd.id,this.Ha.FUa?(Jd.bMb(Ha.ItemId,null,kb.fileName),Jd.set_alt("")):Jd.bMb(Ha.ItemId,kb.fileName,kb.fileName)}finally{ic&&ic.dispose()}for(const Jd of Qc)this.fc.Qra(this.ua.Ba,Jd,this.Fb.Ma,"ChangePictureAfterUpload")}}Kri(Ha,kb,Hb){const ic=this.fU?this.J9a():
this.Wwb();if(ic){this.TRa(ic);var Qc=this.Jb.Ad(15);try{Qc.jd=Hb,Qc.nc(ic),ic.vca=ic.id,this.Ha.FUa?(ic.bMb(Ha.ItemId,null,kb.fileName),ic.set_alt("")):ic.bMb(Ha.ItemId,kb.fileName,kb.fileName)}finally{Qc&&Qc.dispose()}this.fc.Qra(this.ua.Ba,ic,this.Fb.Ma,"changePictureAfterUploadSingleImage")}}R7b(Ha){this.kR.wZa=new Date;ae.a.J(512500484,822,50,"Upload picture failed");this.Sd.cH(Ha.Code,kb=>{kb.mC=1;kb.$Ra=Ha.ExtraErrorParam;return!1})}EYf(){this.fc.hK(this.ua.presentation)}xrd(Ha,kb){this.Oye?
Hd.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.rB&&(this.rB.s2c=this.Yec,this.rB.FPb=0,Ha&&this.rB.Edh(kb))}Wwb(){const Ha=this.ob.Xd();for(const kb of Ha)if(kb&&kb.Hj)return kb;return null}J9a(){const Ha=this.ob.Xd();return Ha&&Ha.length?this.VRd(Ha)?Ha[0]:this.Wwb():null}VRd(Ha){if(!Ha||!Ha.length)return!1;let kb=Ha[0].Hj,Hb=1===Ha[0].mediaType;for(const ic of Ha)kb=kb&&ic.Hj,Hb=Hb&&1===ic.mediaType;return kb||Hb}$k(Ha){return Ha?Object(wb.a)(117,Ha.sc(this.Fb.Ma)):
null}TRa(Ha){Ha&&Ha.iy&&(Ha=this.$k(Ha))&&Ha.u1(!1)}Slg(Ha){return this.ua&&this.ua.Ba&&Ha&&Ha.Hj?!0:!1}N$b(Ha){return this.ua&&this.ua.Ba&&Ha&&(Ha.Hj||1===Ha.mediaType)?!0:!1}flg(Ha){return this.ua&&this.ua.Ba&&Ha&&Ha.Op?!0:!1}insertPicture(Ha,kb,Hb){var ic=this.ua.Ba;const Qc=Object(wb.a)(566,ic.sc(this.Fb.Ma)),Jd=this.rIa.Cb;if(ic&&ic.isConnected&&Qc&&this.rIa&&this.rIa.isConnected){ic=this.rIa.Wt();this.aWa=this.rIa.G3(this.ob.Xd());var yd,He;({E3d:He,mD:yd}=this.MWa.ZWd(this.aWa,Hb.imageWidth,
Hb.imageHeight));var sf=this.Jb.Ad(15,void 0,()=>{this.ob.ey();this.ob.Rh();this.Fa.Ed()},()=>{this.Ou.SF=this.vJ;this.ob.selectShape(this.vJ,!0)});try{sf.nc(this.rIa);sf.jd=kb;this.vJ=this.Sk.nsa(!0,Jd.cid,Jd.sid,0,yd.x,yd.y,He.width,He.height,ic+1,!1);const bg=this.MWa.iTd(this.Fb.Md,He,yd,Qc.tT);this.vJ.SU=bg;this.aWa&&(this.vJ.vca=this.aWa.id,this.rIa.PU([this.aWa]));this.vJ.bMb(Ha,this.Ha.FUa?null:Hb.fileName,Hb.fileName);this.vJ.isResizable=!0;this.vJ.v$b=!0;this.vJ.FL=!0;this.vJ.bJa=!0;this.vJ.Hj=
!0;this.vJ.Hvb=!!Hb.cHb;this.vJ.hea=Hb.cHb||Hb.fXc;this.rIa.gC(this.vJ)}finally{sf&&sf.dispose()}Ad.a.o4e()}}static OWj(Ha){return!!Ha&&!!Ha.fileName&&Ha.fileName.toLowerCase().indexOf(".svg")===Ha.fileName.length-4}static Uwk(){ae.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(h.a)(ef,"PictureActor",null,[365]);var Id=d(114),qe=d(211),jg=d(724),of=d(912),Cb=d(86);class Df extends Sys.EventArgs{constructor(Ha,kb){super();this.rTj=Ha;this.T0c=kb}}Object(h.a)(Df,"TokenRefreshEventArgs",
Sys.EventArgs,[]);class Bf{constructor(Ha,kb,Hb,ic,Qc,Jd,yd){this.UFb=0;this.Oc=Ha;this.NBe=kb;this.ku=Hb;this.ia=ic;this.To=Qc;this.zb=Jd;this.Ha=yd;this.NBe&&this.NBe.cHc(Object(A.a)(this,this.a8g,"onTokenRefreshed"))}mVd(Ha){!this.Ha.podTokenRefreshImprovementEnabled&&this.zb.Pta&&this.zb.z_a();const kb=Tb.a.instance.LFa(e.AFrameworkApplication.hm),Hb=Tb.a.instance.x0c(e.AFrameworkApplication.hm,e.AFrameworkApplication.sia);ae.a.J(41562886,801,kb||Hb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",
kb,Hb,Ha,this.Ha.podTokenRefreshImprovementEnabled,this.UFb);Tb.a.instance.d7a();this.Ha.podTokenRefreshImprovementEnabled&&this.zb.Pta&&this.zb.z_a()}a8g(Ha,kb){ae.a.J(41562888,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Hb=Object(wb.a)(Gb,kb)||new Gb(null,null),ic=Hb.tokens,Qc=Hb.errors;Ha="";if(void 0===Qc||null===Qc||0>=Qc.count)for(kb=0;kb<ic.count;kb++)if(ic.ga(kb).Name===Uc.a.A$k){const yd=ic.ga(kb)?ic.ga(kb):null;Ha=yd&&yd.Value&&0<yd.Value.length?yd.Value:"";break}const Jd=
Tb.a.instance.LFa(e.AFrameworkApplication.hm);ae.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Jd,this.Ha.mMe,this.UFb,this.Ha.Zbh);if(0<Ha.length&&Jd&&this.Ha.mMe&&this.UFb<this.Ha.Zbh)ae.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",
(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm),this.Ha.mMe,this.UFb),this.UFb++,this.mVd(2);else if(0<Ha.length&&!Jd){ae.a.J(41562890,809,Jd?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm));qe.App.G7d=e.AFrameworkApplication.Qub=F.a.Ne(Ha);const yd=this.ku.Umc.presentationId.i0e+
"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.hm.toString());this.ku.Umc=new of.a(new jg.a(yd));this.Oc.Xfh(new Df(this.To?this.To.m_:!1,!0))}else{if(We.a("CleanPIIFromC49mm")&&Qc)for(let yd of Qc)if(yd.Errors)for(const He of yd.Errors)"403"===He.Id&&He.Details&&He.Details.startsWith("<")&&(He.Details=null);ae.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",
Qc?Id.c(Qc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.UFb);Qc&&0<=Id.c(Qc).indexOf("The caller is not authenticated")?(e.AFrameworkApplication.zp(Cb.a.Vh(383)),Gc.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.zp(Cb.a.Vh(380)),Gc.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.dv&&e.AFrameworkApplication.dv.B8();this.Oc.Xfh(new Df(this.To?
this.To.m_:!1,!1));this.ia.La($d.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Hb){ae.a.J(41562894,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Id.c(Hb))}}dispose(){this.NBe.MRe(Object(A.a)(this,this.a8g,"onTokenRefreshed"))}}Object(h.a)(Bf,"PPTTokenRefreshManager",null,[539]);var qg=d(87),vd=d(654);class $f{constructor(Ha,kb,Hb,ic,Qc,Jd){this.kY=this.nLl=this.uSe=null;this.f4b=this.S3d=!1;this.Zbd=
0;this.Jmb=Ad.a.zk("SeamlessFailover");1!==kb&&2!==kb||Ad.a.QFa();this.Dj=new Date;Ad.a.XAb=this.startTime;this.KYh=Hb;this.YQa=0;this.y_h=kb;this.lSh=ic;this.uZh=Qc;this.tzl=Jd;this.YWi=!1;this.resultCode=0;this.bcf=!0;if(Ha=e.AFrameworkApplication.gd)this.Uc.Va("Host",Object(wb.a)(String,Ha.Host)),this.Uc.Va("Ring",Object(wb.a)(String,Ha.Ring))}Vsh(Ha,kb){this.Zbd=window.setTimeout(Ha,kb)}Bsl(){this.bcf=!1}dispose(){Ad.a.ibc=new Date;0<=this.Zbd&&(window.clearTimeout(this.Zbd),this.Zbd=-1)}get VWi(){return this.bcf}get Uc(){return this.Jmb}get startTime(){return this.Dj}get PBk(){return this.KYh}get Uxa(){return this.y_h}get kWi(){return this.lSh}get podsCleaningRequestPattern(){return this.uZh}}
Object(h.a)($f,"SeamlessFailoverState",null,[106]);const ng=Ha=>{Ha=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ga("361"),Ha);e.AFrameworkApplication.Ke.cW(Ha,1,null,null,null,0,()=>{ae.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{ae.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var Qe;(function(Ha){Ha[Ha.unknown=0]="unknown";Ha[Ha.mouse=
1]="mouse";Ha[Ha.keyboard=2]="keyboard";Ha[Ha.podsPopsUnavailable=4]="podsPopsUnavailable"})(Qe||(Qe={}));Object(h.b)("RehydrationTrigger",Qe);var Gf=d(665),Jf=d(981);class xh{constructor(Ha,kb,Hb,ic,Qc,Jd,yd,He,sf,bg,Ag,Ii,aj,Xg,Qi,Jh,Og,Qh,Yg,If,mj,xi,Bj){this.Je=this.xre=null;this.YDe=this.Ecd=-1;this.wTg=0;this.Teb=Ha;this.la=kb;this.Vb=Hb;this.ia=ic;this.zb=Qc;this.pE=Jd;this.Fe=yd;this.Fg=sf;this.sz=bg;this.Sd=Ag;this.Mm=Ii;this.ei=aj;this.mc=Xg;this.lR=Qi;this.Ds=Qh;this.OBe=new Date;this.Iv=
Jh;this.sH=Og;this.ua=Yg;this.Qb=If;this.cgc=mj;Bj.execute(yi=>{this.xre=yi});this.H5c=[];this.dhk=this.Qb.Bc("SeamlessFailoverMaxRetryAttempts",0);this.chk=this.Qb.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.ehk=this.Qb.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");ae.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get m_(){return!!this.Je&&this.Je.VWi}get JVf(){return this.wTg}rOd(Ha){if(this.m_){e.AFrameworkApplication.$z&&(this.ei.Soc(Object(A.a)(this,
this.Efa,"onWopiTokenRefreshed")),this.f0b());var kb=0;if(this.la.Hzb)this.Je.Uc.SB("Result","abortedOnIrmProtectedFile"),kb=365;else if(this.Je.Uc.SB("Result",Ha),"abortedOnExitApp"!==Ha||this.ehk)kb=4===this.Je.Uxa?356:357;this.Bjb(!1,kb,!this.Je.f4b&&"abortedOnRefreshDoc"!==Ha)}}u3e(Ha,kb,Hb){if(this.m_)ae.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.dv||(e.AFrameworkApplication.dv=ae.a.C1b());this.Sd.disabled=!1;this.Sd.Dka=!1;this.Je=
new $f(Ha,kb,this.Fe.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,Hb);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Je.Vsh(Object(A.a)(this,this.e4g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Je.Uc.Va("PopsAvailable",this.Fg.fG.toString());this.Je.Uc.Va("OrderlyShutdown",Ha.toString());this.Je.Uc.Va("Trigger",Qe[kb]);this.Je.Uc.Va("TriggerErrorCode",db.a[Hb]);this.Je.Uc.Va("OldPodsId",this.Je.PBk);this.Je.Uc.Va("OldPopsId",
this.Fe.Kk);ae.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Je.Uc.actionId,this.Je.Uc.vOb());if(1===kb||2===kb)e.AFrameworkApplication.Ug=!1,this.ua.presentation&&this.ua.presentation.ZSe();this.ei.kHc(Object(A.a)(this,this.Efa,"onWopiTokenRefreshed"));e.AFrameworkApplication.$z&&Tb.a.instance.d7a()?(ae.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),
new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm)),this.f0b(),this.Ecd=window.setTimeout(Object(A.a)(this,this.PAk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.Fah&&this.cgc.CYf(!1)):(this.ei.Soc(Object(A.a)(this,this.Efa,"onWopiTokenRefreshed")),this.YDh(kb))}}aXi(Ha){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,Cb.a.Vh(Ha).toString())){if(!this.H5c.length)return!0;const kb=new Date;let Hb=0;for(let ic=this.H5c.length-
1;0<=ic;ic--){const Qc=this.H5c[ic];if(+kb-+Qc.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Qc.tzl===Ha&&Hb++}if(Hb<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;ae.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",Ha,Hb,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}YDh(Ha){e.AFrameworkApplication.$z&&(this.ei.Soc(Object(A.a)(this,
this.Efa,"onWopiTokenRefreshed")),this.f0b());if(++this.wTg>this.dhk)this.Hbe("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Je.Vsh(Object(A.a)(this,this.e4g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.OBe>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.Hbe("RecoveryStreamExpired",358);else{if(this.Je.S3d&&(this.Je.Uc.SB("Trigger",Qe[Ha]+"_GetFileUrlExpired"),this.bLj())){this.Hbe("GetFileUrlExpired_NoAzureBackup",
364);return}this.Je.kWi&&this.Nti();this.ei.Ykd(new Gf.a(4===Ha?5:2));this.ei.FQk();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===Ha&&(ae.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Fe.Kk),this.lR.Ysb(()=>{},()=>{}));this.Mm.isPaused||this.Mm.pause();this.Je.Uc.Zm("CreatePodsWithRetryST",new Date);this.Je.Uc.Zm("SessionStartTime",this.OBe);this.Rhh()}}Hbe(Ha,kb){this.zb.Pta&&this.zb.z_a();this.Je.Uc.SB("Result",Ha);this.Bjb(!1,kb)}PAk(){this.ei.Soc(Object(A.a)(this,
this.Efa,"onWopiTokenRefreshed"));this.f0b();ae.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Je.Uc.Va("WopiTokenRefreshed","TO");e.AFrameworkApplication.zp(Cb.a.Vh(382));Gc.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.dv&&e.AFrameworkApplication.dv.B8();this.Je.f4b=!0;this.ia.La($d.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}Efa(Ha,kb){Ha=
kb.T0c;this.ei.Soc(Object(A.a)(this,this.Efa,"onWopiTokenRefreshed"));this.f0b();this.la.Fah&&this.cgc.CYf(!0);kb=0<e.AFrameworkApplication.hm&&(new Date).getTime()>=e.AFrameworkApplication.hm-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;ae.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",Ha,(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm));
this.Je.Uc.Va("WopiTokenRefreshed","True");this.Je.Uc.Va("WopiTokenRefreshedSuccessfully",Ha.toString());this.Je.S3d=kb;Ha?this.YDh(this.Je.Uxa):this.Je.f4b=!0}f0b(){-1!==this.YDe&&(window.clearTimeout(this.YDe),this.YDe=-1);-1!==this.Ecd&&(window.clearTimeout(this.Ecd),this.Ecd=-1)}bLj(){const Ha=F.a.rg(this.Qb.Ga("152")||""),kb=!e.AFrameworkApplication.Zg.IsRealEdit&&1!==this.Je.Uxa&&2!==this.Je.Uxa;return".pptx"!==Ha&&".ppsx"!==Ha||kb}Nti(){try{let Ha=0,kb=0;const Hb={},ic={};this.Ds.N4h(Qc=>{if(-1<
Qc.request.get_url().search(new RegExp(this.Je.podsCleaningRequestPattern,"i")))return this.DDh(Hb,this.A6f(Qc.request.get_url())),Ha++,!0;this.DDh(ic,this.A6f(Qc.request.get_url()));kb++;return!1});ae.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",Ha,Hb,kb,ic)}catch(Ha){ae.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",Ha)}}A6f(Ha){let kb=Ha;const Hb=Ha.indexOf("?");0<
Hb&&(kb=Ha.substr(0,Hb));Ha=kb.lastIndexOf("/");0<Ha&&(kb=kb.substr(Ha+1));return kb}DDh(Ha,kb){Ha[kb]=kb in Ha?Ha[kb]+1:1}e4g(){this.m_&&(this.Je.Uc.SB("Result","Timeout"),this.Je.Uc.Va("TimeoutDuration",(+new Date-+this.Je.startTime).toString()),this.Bjb(!1,4===this.Je.Uxa?354:355))}Bjb(Ha,kb=0,Hb=!0){if(this.m_){this.sz.Tib(Object(A.a)(this,this.zfa,"onPodSessionRefreshed"));this.Vb.zi.contentReplicator.Ooc(Object(A.a)(this,this.q2g,"onAfterReplication"));var ic=+new Date-+this.OBe>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.$z&&(ic=0<e.AFrameworkApplication.hm&&(new Date).getTime()>=e.AFrameworkApplication.hm-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&ae.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm));Ha&&ic&&this.Je.Uc.Va("SkipPopsReason","FileUrlExpired");this.mc.Srg();var Qc=this.Je.Uxa;this.Je.Uc.Va("IsInEditingMode",
this.mc.In.toString());this.Je.Uc.Va("IsPreviousModeEditing",this.mc.S$b.toString());this.Je.Uc.Va("IsLastKnownModeEditing",this.mc.Vke.toString());this.Je.Uc.Va("PopSessionEverInitialized",this.Fg.hmc.toString());this.Je.Uc.Va("ResultErrorCode",db.a[kb]);this.Je.Uc.Va("RefreshPage",Hb.toString());this.Je.Uc.Va("FRehydrationInitiatedPageRefresh",this.Je.f4b.toString());this.Je.YWi=Ha;this.Je.resultCode=kb;this.Je.Bsl();this.H5c.push(this.Je);this.chk||this.NQc();Ha?(this.ei.xfh(new Jf.a(Qc)),this.hEh(ic,
Qc)):(this.NQc(),0!==kb&&(Ha=Cb.a.Vh(kb),e.AFrameworkApplication.zp(Ha),Gc.Health.instance.recordQosError(Cb.a.qja(Ha),["UnexpectedAppRefresh"],399===kb,!1,!0,Hb,null)),Hb?(e.AFrameworkApplication.dv&&e.AFrameworkApplication.dv.B8(),this.ia.La($d.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.ei.xfh(new Jf.a(Qc)),this.hEh(ic,Qc)))}}g4b(){return this.Je&&this.Je.Uc?!0:!1}NQc(){this.g4b()&&(ae.a.J(512497874,801,15,"Action Telemetry: {0}",this.Je.Uc.vOb()),this.Je.Uc.finish(!0),
this.Je.dispose(),this.Je=null)}hEh(Ha,kb){!this.mc.BL||Ha||2!==kb&&1!==kb&&4!==kb?(this.g4b()&&this.Je.Uc.Va("PopsRehydrationAttempted","false"),ae.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",Ha,kb),this.yLf(null)):(this.g4b()&&this.Je.Uc.Va("PopsRehydrationAttempted","true"),this.lR.Vfa(4===kb?6:7,Object(A.a)(this,this.TGi,"createPopSessionSucceededCallback"),Object(A.a)(this,this.yLf,"createPopSessionFailedCallback")))}TGi(){this.g4b()&&
(this.DXf(),this.Je.Uc.Va("POPSessionCreated","true"),this.NQc())}yLf(){if(!this.g4b())return!1;this.DXf();this.Je.Uc.Va("POPSessionCreated","false");this.NQc();return!1}DXf(){this.Je.Uc.SB("IsInEditingMode",this.mc.In.toString());this.Je.Uc.SB("IsPreviousModeEditing",this.mc.S$b.toString());this.Je.Uc.SB("PopSessionEverInitialized",this.Fg.hmc.toString())}vzl(Ha){ae.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.Qb.ka("UserHasValidLicenseForEnterpriseFonts"),this.Qb.ka("PPTOEnterpriseFontsEnabled"));this.Qb.ka("UserHasValidLicenseForEnterpriseFonts")&&this.Qb.ka("PPTOEnterpriseFontsEnabled")&&ng(Ha)}Rhh(){this.Je.kY=vd.a();this.zb.Pta||this.zb.stop();let Ha=this.la.restoreRCInCreatePodSessionRequest&&this.ua.fk?this.ua.fk.toString():"";Ha=F.a.replaceAll(Ha,"#","%23");this.Teb.createPodSession(this.Je.kY,"SeamlessFailover_"+this.Je.Uxa,this.Je.YQa,+new Date-+this.Je.startTime,Object(A.a)(this,this.SGi,
"createPodSessionSucceededCallback"),Object(A.a)(this,this.RGi,"createPodSessionFailedCallback"),this.pE,this.Fe.podSessionId,Ha);this.Teb.AGl(this.Je.kY,Object(A.a)(this,this.vzl,"triggerFontsInstallationCallback"));this.zb.z_a()}SGi(Ha){if(this.m_){Ad.a.ttd=[];this.Je.Uc.Va("NewPodsId",this.Je.kY);this.Fe.podSessionId=this.Je.kY;this.Je.Uc.Va("CreatePodsWithRetryResult","true");this.Je.Uc.Va("CreatePodsRetryCount",this.Je.YQa.toString());this.Je.Uc.Va("CreatePodsDuration",(+new Date-+this.Je.startTime).toString());
this.Mm.isPaused&&this.Mm.amb();try{this.Mm.cEf()}catch(kb){ae.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",kb)}if(this.la.restoreRCInCreatePodSessionRequest&&Ha&&qg.a.Mlc in Ha&&!F.a.Wa(Ha[qg.a.Mlc])){const kb=Boolean.parse(Ha[qg.a.Mlc]);this.Je.Uc.Va("RCRestoredWhenCreatePodSession",Ha[qg.a.Mlc]);kb?(this.Je.Uc.SB("Result","Success"),this.Bjb(!0)):(this.xre&&this.xre.cui(),this.Je.Uc.Va("DocRefreshTriggered","true"),Ha={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},Ha.podSessionId=this.Fe.podSessionId,this.Je.f4b=!0,this.ia.La($d.a.eKb,2,Ha))}else this.aEh()}}aEh(){this.Vb.zi.contentReplicator.UGc(Object(A.a)(this,this.q2g,"onAfterReplication"));this.zzl()}zzl(){const Ha=()=>{this.Je.uSe=new Date;this.Je.Uc.Zm("InboundStartTime",this.Je.uSe);this.Vb.zi.contentReplicator.DF(null,null,null)};ae.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ua.Ba?
this.ua.Ba.sid:0,this.Je.kY);4===this.Je.Uxa&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ua.Ba?(this.sH.gXc&&this.sH.gXc.Fgg(this.ua.Ba.Cb),this.Je.Uc.Zm("ForceInboundSlideStartTime",new Date),this.Iv.f5d(this.ua.Ba,(kb,Hb)=>{ae.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",kb,Hb);this.m_&&(this.Je.Uc.Zm("ForceInboundSlideEndTime",new Date),Ha())},!0,!1)):Ha()}RGi(Ha){if(!this.m_)return!0;const kb=+new Date-
+this.Je.startTime;if(399===Ha)return ae.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Fe.podSessionId,kb),this.Sd.cH(Ha,null),this.Bjb(!1,Ha,!1),!0;if(this.Je.S3d&&230===Ha)return ae.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Fe.podSessionId,kb),this.ESf("CreatePodSessionFailed_GetFileUrlFailed",
Ha),!0;if(this.Je.YQa<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&kb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Hb;(Hb=this.Je).YQa=Hb.YQa+1;ae.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Fe.podSessionId,this.Je.YQa,kb,Ha);this.Rhh();return!0}ae.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Fe.podSessionId,this.Je.YQa,kb,Ha);this.ESf("CreatePodSessionFailed",Ha);return!0}ESf(Ha,kb){this.Je.Uc.Va("CreatePodsWithRetryResult","false");this.Je.Uc.Va("CreatePodsRetryCount",this.Je.YQa.toString());this.Je.Uc.Zm("CreatePodsWithRetryET",new Date);this.Je.Uc.SB("Result",Ha);this.Je.Uc.Va("CreatePodsDuration",(+new Date-+this.Je.startTime).toString());this.Bjb(!1,kb)}q2g(Ha,kb){this.m_&&(kb.slg?ae.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
kb.jhd):(this.Je.Uc.SB("InboundDuration",(+new Date-+this.Je.uSe).toString()),this.Je.Uc.SB("Result","Success"),this.Bjb(!0)))}zfa(Ha,kb){this.m_&&(this.Je.Uc.Va("WaitPodsRefreshedDuration",(+new Date-+this.Je.nLl).toString()),this.Je.Uc.Va("NewPodsId",kb.kY),this.sz.Tib(Object(A.a)(this,this.zfa,"onPodSessionRefreshed")),this.Mm.isPaused&&this.Mm.amb(),this.aEh())}}Object(h.a)(xh,"PodSeamlessFailoverManager",null,[538]);class he{constructor(Ha,kb,Hb){this.dva=Ha;this.Xa=Hb}MZ(){}HYb(){}$5a(Ha){Ha&&
(Array.add(Ha,qg.a.vKe),Array.add(Ha,qg.a.iaa),Array.add(Ha,qg.a.eIb),Array.add(Ha,qg.a.wDk),Array.add(Ha,qg.a.Mlc))}vda(Ha,kb){kb?((kb=Ha[qg.a.eIb])&&kb.toLowerCase()!==(this.Xa.jaa?this.Xa.jaa.toLowerCase():"")&&(ae.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",kb),this.Xa.jaa=kb),this.dva?(Ha=Ha[qg.a.vKe])?(this.dva.ccpInfo=Ha,ae.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",Ha.length)):ae.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
ae.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):ae.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(h.a)(he,"RehydrationHeaderHandler",null,[583]);class de{constructor(Ha,kb,Hb,ic,Qc,Jd,yd,He,sf,bg){this.FO=null;this.D5c=!1;this.pag=Ag=>{if(Ag.keyCode===G.a.Rvd||Ag.keyCode===G.a.vMa||Ag.keyCode===G.a.mmb||Ag.keyCode>=G.a.Dmb&&Ag.keyCode<=G.a.Pza)return!1;this.XQe(2);return!0};this.kf=Ha;this.Oc=
kb;this.rfc=Hb;this.Lr=ic;this.Zc=Qc;this.Le=Jd;this.QTg=sf;this.Ha=yd;this.To=He;this.acd=bg}init(){this.Oc&&(this.Oc.mQd(Object(A.a)(this,this.sessionExpired,"sessionExpired")),this.Oc.MPa(Object(A.a)(this,this.fyk,"onRehydrateSession")))}sessionExpired(){this.Hwh(!0);n.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Gc.Health.instance.stopAllHealthTimers()}XQe(Ha){this.Hwh(!1);const kb=e.AFrameworkApplication.$z||!We.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");n.ULS.sendTraceTag(544789148,
821,100,"Should refresh token: {0}",kb);kb&&this.acd&&this.acd.mVd(0);this.Ha.podsSeamlessFailoverEnabled&&this.To.u3e(!1,Ha,223)}fyk(){n.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");Gc.Health.instance.resumeAllHealthTimers()}Hwh(Ha){this.D5c!==Ha&&this.kf&&(Ha?(this.FO||(this.FO=this.Le.Ie(),this.FO.id="sessiontimeoutoverlay",this.FO.className="SessionTimeoutOverlay",this.FO.tabIndex=-1,this.Fhi(this.FO),this.kf.appendChild(this.FO)),this.D5c=!0,this.QTg(this.FO)):(this.IOf(this.FO),
this.FO&&this.FO.parentNode&&this.FO.parentNode.removeChild(this.FO),this.FO=null,this.D5c=!1))}Fhi(Ha){Ha&&(this.Zc.pb(K.a.click,Ha,Object(A.a)(this,this.H$a,"handleClickEvent")),this.Zc.pb(K.a.doubleClick,Ha,Object(A.a)(this,this.H$a,"handleClickEvent")),We.a("FixRehydrationOnKeyPress")?this.Lr.addHandler(Ha,K.a.Xf,this.pag):this.rfc.pb(K.a.Xf,Ha,Object(A.a)(this,this.wag,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(A.a)(this,this.onVisibilityChange,"onVisibilityChange")))}IOf(Ha){Ha&&
(this.Zc.yb(K.a.click,Ha,Object(A.a)(this,this.H$a,"handleClickEvent")),this.Zc.yb(K.a.doubleClick,Ha,Object(A.a)(this,this.H$a,"handleClickEvent")),We.a("FixRehydrationOnKeyPress")?this.Lr.removeHandler(Ha,K.a.Xf,this.pag):this.rfc.yb(K.a.Xf,Ha,Object(A.a)(this,this.wag,"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(A.a)(this,this.onVisibilityChange,"onVisibilityChange")))}H$a(){this.XQe(1);return!0}wag(Ha){if(Ha.qc.ctrlKey||Ha.qc.altKey||Ha.qc.shiftKey||Ha.qc.keyCode>=G.a.Dmb&&
Ha.qc.keyCode<=G.a.Pza)return!1;this.XQe(2);return!0}onVisibilityChange(){e.AFrameworkApplication.$z&&!window.document.hidden&&this.acd&&this.acd.mVd(1)}dispose(){this.Oc.Qjh(Object(A.a)(this,this.sessionExpired,"sessionExpired"));this.FO&&(this.IOf(this.FO),this.FO.parentNode&&this.FO.parentNode.removeChild(this.FO));this.Lr=this.rfc=this.Zc=null;this.D5c=!1;this.QTg=null}}Object(h.a)(de,"SessionRehydrationController",null,[]);class xf{constructor(){this.Da=null}Zb(Ha){this.Da=Ha||y.a.instance}dispose(){}}
Object(h.a)(xf,"TellMePackage",null,[2,3]);var re=d(117),Ih=d(144),Le=d(29),Cd=d(16),Lc=d(104),Td=d(941);class Ge{constructor(Ha=null,kb=null,Hb=null,ic,Qc=null){this.Bxd=null;this.h8e=!1;this.tcf=this.$mb=null;this.v1h=this.Xof=this.lOh=this.ucf=!1;this.yxc=null;this.vOh=null==kb?e.AFrameworkApplication.isb:kb;this.oUh=null==Hb?e.AFrameworkApplication.bFa:Hb;this.Q1h=null==Qc?e.AFrameworkApplication.Tya:Qc;this.DTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");
this.U2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.ahl(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.L2h=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Fac;this.M2h=!Lc.a.px()&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.K2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.rSh=!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.hb.NMb;this.N2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.h1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.DYh=this.rrc||this.qrc;this.BYh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.CYh=this.hle;this.MVh=!!e.AFrameworkApplication.fa&&this.pza&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");
this.$Sh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.hTh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.XSh=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.JVh=
!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.wUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&Lc.a.j4();this.f2h=
e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.kTh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.i1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",
!1);this.E1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.r1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||this.QH;this.UVh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",
!1));this.qVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.HVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.RVh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",
!1));this.fWh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.nOh=this.pza&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.yTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.J1h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",
!1)||"Word"!==e.AFrameworkApplication.fa.Ga("Application"));this.VOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.$3h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled"));this.yUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.CUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.gTh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.TVh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.Zng;this.AUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.BUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.zUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.ORh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);
this.PRh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.O2h=this.kXj&&(this.KJe||this.LJe||this.jlc||this.pza&&Lc.a.j4()&&!!e.AFrameworkApplication.fa&&(this.UMb||this.zkb||this.Akb||this.Bkb||this.VMb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));
this.QNh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.Mia;this.RNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.CFj(Ha||{});this.NKd="2918242107";this.MKd="1454393937";this.z4a={};this.pPa=[];this.mBi=[Lc.a.tud]}get application(){return this.$mb}get isb(){return this.vOh}get c8k(){return this.NKd}get b8k(){return this.MKd}get BWf(){return this.tcf}get bZi(){return this.ucf}get bFa(){return this.oUh}get Tya(){return this.Q1h}get x6a(){return this.lOh}get tAj(){return this.DTh}get bwl(){return this.U2h}get kXj(){return!0}get Rvl(){return this.O2h}get ujl(){return this.Xof}ahl(Ha){this.Xof=
Ha}get pza(){return this.L2h}get ltc(){return this.M2h}get jtc(){return this.K2h}get VXi(){return this.rSh}get Pvl(){return this.N2h}get D3e(){return!1}get jlc(){return this.DYh}get KJe(){return this.BYh}get LJe(){return this.CYh}get iVa(){return!1}get N0c(){return!1}get Kme(){return this.MVh}get MYe(){return this.v1h}get UMb(){return!1}get Gkl(){return!1}get f0j(){return""}get e9d(){return 2}get Dhj(){return 4}get Ehj(){return 5}get Zjj(){return""}get M$i(){return this.$Sh}get F7f(){return this.hTh}get akj(){return 1E3}get $jj(){return 1E-6}get mtl(){return this.f2h}get E0e(){return!1}get ltl(){return!1}get SUj(){return this.HVh}get w0c(){return!1}get pme(){return!1}get sRj(){return!1}get rRj(){return!1}get Zng(){return!1}get bog(){return!1}get CWf(){return!1}get OMb(){return!1}get zkb(){return!1}get Akb(){return!1}get Bkb(){return!1}get VMb(){return!1}get rrc(){return this.h1h}get PMb(){return this.i1h}get qrc(){return!1}get S6d(){return null}get kme(){return!1}get Mqd(){return this.r1h}get d5f(){return 0}get m6i(){return this.XSh}get i8f(){return this.kTh}get oWj(){return this.JVh}get MYc(){return this.wUh}get N4f(){return-3.9}get QH(){return this.E1h}get Gac(){return this.UVh}get nle(){return this.qVh}get Xme(){return this.RVh}get XPa(){return this.nOh}get hZj(){return this.fWh}get tda(){return this.yTh}get Dxh(){return this.J1h}get dki(){return this.VOh}get Nvd(){return this.$3h}get OYc(){return this.yUh}get ZJj(){return this.CUh}get Aq(){return this.gTh}get jVa(){return this.TVh}get XJj(){return this.AUh}get YJj(){return this.BUh}get WJj(){return this.zUh}get Tvf(){return this.QNh}get Uvf(){return this.RNh}get t3(){return this.ORh}get ROc(){return this.PRh}get Pp(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.hb.Po}get Po(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Po}get xRj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Voa}get Hpk(){return Ga.getImageClass("OfficeAssistant_32x32x32")}W$i(){return Promise.reject("GetFindMatchCount method is not overridden")}b1c(Ha){return Array.contains(appChrome.selectors.getVisibleControlIds(),Ha)}Gje(){return!1}get ele(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get jCh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ga("TellMeServiceHelpClassifierModelName"):""}get hle(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get zWc(){return"NoOpHeaderUi"}get lBi(){return this.yxc}get parameterData(){return this.z4a}get ABl(){return this.pPa}$Ti(){if(this.Bxd&&!this.h8e&&(this.h8e=!0,this.bqd(this.Bxd),this.Po)){var Ha=y.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Ha=(new Td.a(Ha)).P5d(this.Bxd.Uaa);appChrome.api.dispatch(Ha)}}get aph(){return""}bqd(){}cNi(Ha){const kb=
[];for(let Hb=0;Hb<Ha.length;++Hb)Ha[Hb].pll?kb.push(new Cd.a(Ha[Hb].alternate,Lc.a.oFh+Hb.toString())):kb.push(new Cd.a(Ha[Hb].standard,Lc.a.tud+Hb.toString()));return kb}CFj(Ha){const kb={};for(let Hb in Ha){const ic=Hb,Qc=Ha[Hb];for(let Jd in Qc){const yd=Jd,He=Qc[Jd];(kb[yd]||(kb[yd]={}))[ic]=He}}this.yxc=kb}get kCh(){return""}get Twh(){return!1}}Object(h.a)(Ge,"TellMeApplicationData",null,[806]);class Xc{constructor(Ha,kb=null,Hb=!1){this.standard=Ha;this.alternate=kb;this.pll=Hb}}Object(h.a)(Xc,
"TryQuerySet",null,[]);class jf{constructor(){this.Ajf=this.Bjf=null}get fok(){return this.Ajf}aL(Ha){this.Bjf=Ha;return this.SFi(Ha)}uqk(){this.Ajf=this.Bjf}xcj(Ha){return 8===Ha.type?String.format(CommonUIStrings.l_FindInDocumentText,Ha.MJ):Ha.MJ}a7i(Ha){return Ha.MJ}}Object(h.a)(jf,"ParameterizedCommand",null,[]);class Mh extends jf{constructor(Ha){super();this.VVj=Ha}get commandId(){return this.VVj?"FindParameterized":"EditingFind"}get HDk(){return"Find"}SFi(Ha){if(!Ha)return null;const kb=F.a.ue(String.format(ResourceStrings.l_ParamFindInDocTitle,
Ha.MJ));return ua.a(Lc.a.oJi(Ha.value),"1540292897",kb,"Find_16x16x32",null,F.a.ue(Ha.MJ),kb,null,null)}}Object(h.a)(Mh,"FindParameterizedCommand",jf,[]);var bd=d(124);class Bc extends Ge{constructor(){super(window.TellMeControlMetadataOverrides);this.$mb="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var Ha=[new Xc(ResourceStrings.l_TellMeTryQuery01,"",!1),new Xc(ResourceStrings.l_TellMeTryQuery02,"",!1),new Xc(ResourceStrings.l_TellMeTryQuery03,"",!1),new Xc(ResourceStrings.l_TellMeTryQuery04,
"",!1),new Xc(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.pPa=this.cNi(Ha)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(Ha=new Mh(Bc.UVj()),this.parameterData[Ha.commandId]=Ha,this.ucf=!0,this.tcf=Ha.commandId)}get JKa(){return bd.a.aCf}bqd(Ha){if(Ha){Ha=Ha.Uaa;var kb=e.AFrameworkApplication.fa;Ha["PptTellMe.Animation"]=!kb.ka("TellMeAnimationsTransitionsIsEnabled")||kb.ka("241");Ha["PptTellMe.Transition"]=!kb.ka("TellMeAnimationsTransitionsIsEnabled");Ha["PptTellMe.SelectAll"]=
!kb.ka("TellMeSelectAllResultIsEnabled");Ha["PptTellMe.AnimationNew"]=!kb.ka("241")||!kb.ka("TellMeAnimationsTransitionsIsEnabled");Ha["PptTellMe.Designer"]=!kb.ka("248");kb=kb.ka("TellMeDesktopUpSellIsEnabled");var Hb=e.AFrameworkApplication.lXj;Ha["PptTellMe.WordArtUpSellButton"]=!kb||Hb;Ha["PptTellMe.SpellCheckDictUpSellButton"]=!kb||Hb;Ha["PptTellMe.InsertAudioUpSellButton"]=!kb||Hb;Ha["PptTellMe.InsertChartUpSellButton"]=!kb||Hb;Ha["PptTellMe.WordArtUpSellButtonEnterprise"]=!kb||!Hb;Ha["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=
!kb||!Hb;Ha["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!kb||!Hb;Ha["PptTellMe.InsertChartUpSellButtonEnterprise"]=!kb||!Hb}}get Zng(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get bog(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get d5f(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",
2)}get kCh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get E0e(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",!1)}get jCh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get UMb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",
!1)}get hle(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get e9d(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMenuUpdatePolicy",0)}get Twh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get N0c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",
!1)}get BWj(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1)||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1)}get S6d(){const Ha={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?Ha.FontName="FontPicker":Ha.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(Ha.NewSlide="NewSlideSplit",Ha.ChangeLayout="ChangeLayoutFlyout"):
(Ha.NewSlideSplit="NewSlide",Ha.ChangeLayoutFlyout="ChangeLayout");return Ha}get N4f(){var Ha=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold","-3.9");Ha=parseFloat(Ha);return isNaN(Ha)?-3.9:Ha}get w0c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get Tvf(){return e.AFrameworkApplication.fa.ka("51")}get Uvf(){return e.AFrameworkApplication.fa.ka("305")}static UVj(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.hb.Pp}}Object(h.a)(Bc,"PowerPointTellMeApplicationData",Ge,[]);var Hf;(function(Ha){Ha[Ha.none=0]="none";Ha[Ha.waitAll=1]="waitAll";Ha[Ha.synchronizeFast=2]="synchronizeFast";Ha[Ha.synchronizeSlow=3]="synchronizeSlow"})(Hf||(Hf={}));Object(h.b)("ProviderSynchronizationType",Hf);var Me;(function(Ha){Ha[Ha.immediate=0]="immediate";Ha[Ha.waitAll=1]="waitAll";Ha[Ha.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Ha[Ha.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Me||
(Me={}));Object(h.b)("MenuUpdatePolicy",Me);var Tf=d(170),Sd=d(306),lf=d(156),fb=d(701),Qb=d(171),ac=d(992);class Jc{constructor(Ha,kb,Hb){this.Fq=Ha;this.ob=kb;this.ua=Hb}$D(){return"SummarizeSlidesProvider"}pL(){return this.Fq.e9d?this.Fq.e9d===Me.waitAll?Hf.waitAll:Hf.synchronizeSlow:Hf.none}iB(Ha,kb,Hb,ic,Qc=null){const Jd=new Tf.a(Ha);if(this.MF(Ha))if(null!=Qc&&0>Qc.indexOf(Sd.a.ActionAI))kb.resultsUpdated(Jd);else{this.NCe="SummarizeDeckFromTellMe";if(this.ob&&this.ob.Qe()&&1<this.ob.Qe().length)this.NCe=
"SummarizeSlidesFromTellMe";else if(this.ua&&2>this.ua.presentation.Qya){kb.resultsUpdated(Jd);return}appChrome&&appChrome.selectors.isControlDisabled(this.NCe)?kb.resultsUpdated(Jd):(Ha=new lf.a(this.NCe,fb.a.SummarizeDeck,"","",ac.a.Local),Hb=new Qb.a(Sd.a.SummarizeDeck),Hb.ls(Ha),Jd.Uq(Hb),window.requestAnimationFrame(()=>{kb.resultsUpdated(Jd)}))}else kb.resultsUpdated(Jd)}MF(Ha){return!Ha||!Ha.zf||!Ha.zf.trim().length}}Object(h.a)(Jc,"SummarizeSlidesProvider",null,[602]);class pd extends xf{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.eCh){var Ha=
Le.App.Kb.hb.O$d(Va.a.tellMe);Ha.yZc?pd.Qah():Ha.HS(Object(A.a)(this,this.P7k,"scriptResource_LoadFinished"));var kb=new Bc;re.TellMeActor.instance.initialize(kb,null,null,null,null,null,Object(A.a)(Le.App.Kb,Le.App.Kb.FYf,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Da.Ja("Common.IActionContextProvider"),this.Da.Ja("Common.ISystemInitiatedFeedback"));re.TellMeActor.instance.LUk(Ha);Ha=e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("822");kb.BWj&&Ha&&re.TellMeActor.instance.Uy(new Jc(kb,this.Da.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),Ih.a.tellMe)}}P7k(){pd.Qah()}static Qah(){Le.App.Kb.updateCommandUI()}}Object(h.a)(pd,"PowerPointTellMePackage",xf,[]);var qd=d(213);class sd{constructor(){this.nh=this.Y4=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}Zb(Ha){this.K=Ha;this.Y4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");
this.nh=this.Y4.mEa(4,this.name);this.K.register(he,"PowerPointWebEditor.RehydrationHeaderHandler").ma().oa(()=>new he(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(de,"PowerPointWebEditor.SessionRehydrationController").ma().oa(()=>new de(this.K.resolve("Box4.IAppFrame").FF(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),kb=>{B.FocusManager.Wr(kb)},e.AFrameworkApplication.$z?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.K.register(538,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().oa(()=>
new xh(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),
this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),e.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Ja("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.$z&&this.K.register(539,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().oa(()=>new Bf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),
this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let Ha=this.nh.Bu("resolvechronos1");const kb=this.K.resolve("Common.AFrameworkApplication"),Hb=this.K.resolve("PowerPointWebEditor.IApplicationContext").qd;var ic=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Qc=this.K.resolve("Common.IActionManagerExtended"),Jd=this.K.resolve("PowerPointWebEditor.IFocusManager"),
yd=this.K.resolve("Common.Transaction.ITransactionFactory"),He=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),sf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),bg=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Ag=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Ii=this.K.resolve("PowerPointWebEditor.PictureContext"),aj=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Xg=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),
Qi=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.nh.Gu(Ha);Ha=this.nh.Bu("regactorschronos1");ic=[new ef(Qc,bg,He,Jd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yd,Qi,Ii,sf,e.AFrameworkApplication.PQ,Xg,this.K.resolve("PowerPointWebEditor.IErrorHandler"),ic,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Hb.BPj,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),aj,Ag,Hb,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Common.IAppSettingsManager"))];for(var Jh of ic)Jh.wb(),Jh.Ee();this.nFj();this.nh.Gu(Ha);Ha=this.nh.Bu("tellme");Jh=new pd;Jh.Zb(this.K);Jh.load(kb);this.nh.Gu(Ha);Hb.pptEditorTimeoutDialogRemovalIsEnabled&&Hb.vg&&(Ha=this.nh.Bu("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.nh.Gu(Ha));Hb.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");
e.AFrameworkApplication.$z&&(Ha=this.nh.Bu("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.nh.Gu(Ha));this.f1j()}nFj(){const Ha=this.K.resolve("Common.IActionManagerExtended"),kb=this.K.resolve("PowerPointWebEditor.IFocusManager"),Hb=this.K.resolve("Common.AFrameworkApplication").wq.Ld,ic=this.K.resolve("Common.Transaction.ITransactionFactory"),Qc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Jd=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
yd=this.K.resolve("PowerPoint.IPathManager"),He=this.K.resolve("PowerPointWebEditor.IPresentationReader"),sf=this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw;sf.loadScript("powerpoint-editor-intl").then(()=>{ae.a.J(512497373,801,50,"Editor script is loaded successfully");sf.loadScript("powerpoint-ribbon-intl").then(()=>{ae.a.J(512497372,801,50,"Ribbon script is loaded successfully");const bg=[];bg.push(new Ed(Ha,kb,Jd,ic,Hb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
He,Qc,yd));for(const Ag of bg)Ag.wb(),Ag.Ee()}).catch(()=>{ae.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{ae.a.J(512497370,801,10,"Failed to load Editor script")})}f1j(){ae.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.chronos2",()=>{const Ha=this.K.resolve("PowerPointWebEditor.ISessionState");Ha&&Ha.U5("Chronos2DownloadFinished")},()=>d.e(8).then(d.bind(null,1240)))}dispose(){const Ha=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");Ha.pptEditorTimeoutDialogRemovalIsEnabled&&Ha.vg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.$z&&Ha.vg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Ug&&Hc.a.fg?ae.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):r.a.instance.Dc(qd.a(new sd,4))}}Object(h.a)(sd,"Chronos1Package",null,
[2,3]);var ze=d(651),Wd=d(141),ye=d(583),Yc=d(58),Ae=d(48);class hd{constructor(Ha,kb,Hb,ic,Qc,Jd,yd,He,sf){this.type="FormatPictureTaskPaneProps";this.saturation=this.contrast=this.brightness=this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.disabled=!1;this.onChange=null;this.emptyValueFields=0;const bg=Object(wb.a)(Object,Nc.e().numberFormatInfo);if(!bg)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=bg;this.width=Ha;this.height=kb;this.top=ic;this.left=
Hb;this.brightness=Qc;this.contrast=Jd;this.saturation=yd;this.disabled=He;this.emptyValueFields=sf}}Object(h.a)(hd,"FormatPictureTaskPaneProps",null,[]);class oe{constructor(Ha,kb,Hb,ic,Qc,Jd,yd,He,sf,bg,Ag,Ii){this.Xcb=!0;this.ovg=this.Vtg=this.KWg=this.dHg=this.p0=this.P0=0;this.mTg=100;this.MXa=this.Eb=this.Vxg=!1;Ii.loadScript("powerpoint-editor-intl").then(()=>{this.MXa=!0}).catch(aj=>{ae.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+aj.toString())});this.ob=Ha;this.Rb=kb;this.ia=
Hb;this.Fa=ic;this.Yf=Qc;this.ua=Jd;this.Fb=yd;this.Ri=He;this.I9=sf;this.fc=bg;this.Lc=Ag;this.Yf.SBa(Object(A.a)(this,this.Zed,"onChangeRenderFormatPicturePane"));this.Rb.RK(Object(A.a)(this,this.Tu,"onAppFrameModeSwitched"));this.Lc.JPa(Object(A.a)(this,this.Zed,"onChangeRenderFormatPicturePane"))}dispose(){this.Yf.l_a(Object(A.a)(this,this.Zed,"onChangeRenderFormatPicturePane"));this.Rb.CY(Object(A.a)(this,this.Tu,"onAppFrameModeSwitched"));this.Lc.Sib(Object(A.a)(this,this.Zed,"onChangeRenderFormatPicturePane"))}Ee(){}wb(){this.ia.ra($d.a.LJb,
Ta.a.application,Object(A.a)(this,this.LJb,"queryShowHideReactPictureCropPane"),96);this.ia.ra($d.a.Orc,Ta.a.application,Object(A.a)(this,this.Orc,"showHideReactPictureCropPane"),4);this.ia.ra($d.a.vPb,Ta.a.application,Object(A.a)(this,this.vPb,"updatePictureCropPane"),4)}LJb(Ha,kb,Hb,ic,Qc){(Ha=Object(wb.a)(xb.a,Qc))&&Ha.Lf(this.Eb);return 32}Orc(Ha,kb,Hb){if(!this.MXa)return 8;if(1===Hb)return 32;kb=this.ua.presentation;return this.ua.Ba&&kb&&!this.fc.$c(kb)?Bd.b("ShowHideReactPictureCropPane:",
this.Eb.toString(),Ha,()=>{if(this.Eb=!this.Eb){if(this.Ql(),We.a("CropControlEnableOnDisplayingFormatPicturePane")){const ic=this.ob.kp();(null===ic||void 0===ic?0:ic.iy)||this.ia.processAction($d.a.xZd,2)}}else this.Cr();return 32}):16}vPb(Ha,kb,Hb){if(!this.Eb)return 8;2===Hb&&this.Ql(!0);return 32}Ql(Ha=!1){var kb=this.CUc();kb=this.yC(kb);const Hb=Object.assign(new ze.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:kb,onOpen:()=>{},onClose:()=>{this.Eb=
!1},isModernPane:!0});Wd.UISurfaces.zr().then(ic=>{Ha?ic.updateTaskPane(Ae.a.KJa,Hb):ic.showTaskPane(Ae.a.KJa,Hb);return null}).catch(ic=>{ae.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+ic.toString())})}Cr(){Wd.UISurfaces.zr().then(Ha=>{Ha.hideTaskPane(Ae.a.KJa,2);return null}).catch(Ha=>{ae.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+Ha.toString())})}yC(Ha){if(Ha){const kb=Ha.V6d(),Hb=this.Fb.Md;this.p0=ye.a.Qv(Hb.qf(this.Ri.GM(Yc.a.lm(kb.ga(0),kb.ga(3)),
Ha.zoom),1));this.P0=ye.a.Qv(Hb.qf(this.Ri.GM(Yc.a.lm(kb.ga(0),kb.ga(1)),Ha.zoom),0));this.dHg=ye.a.Qv(Hb.qf(this.Ri.GM(kb.ga(0).x,Ha.zoom),0));this.KWg=ye.a.Qv(Hb.qf(this.Ri.GM(kb.ga(0).y,Ha.zoom),1));this.Xcb=!1;this.Vxg=!0}else this.Xcb=!0;Ha=new hd(this.P0,this.p0,this.dHg,this.KWg,this.Vtg,this.ovg,this.mTg,this.Xcb,this.Vxg?0:15);Ha.onChange=Object(A.a)(this,this.fxa,"onPropertyChange");return Ha}CUc(){const Ha=this.ob.kp();return Ha&&Ha.iy&&Ha.isConnected?this.I9.IF(Ha):null}fxa(Ha,kb){const Hb=
{};Hb.Number=Ha;switch(kb){case 0:this.ia.La($d.a.tvd,2,Hb);break;case 1:this.ia.La($d.a.qvd,2,Hb);break;case 2:this.ia.La($d.a.rvd,2,Hb);break;case 3:this.ia.La($d.a.svd,2,Hb);break;case 4:this.ia.La($d.a.eHh,2,Hb);this.Vtg=Ha;break;case 5:this.ia.La($d.a.qHh,2,Hb);this.ovg=Ha;break;case 6:this.ia.La($d.a.JIh,2,Hb),this.mTg=Ha}this.Ql(!0)}Zed(){this.Eb&&this.Ql(!0)}Tu(Ha){1===Ha.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Fa.Ej(Ae.a.KJa,this.Eb))}}Object(h.a)(oe,"FormatPicturePaneActor",null,[]);var Xe=
d(861);class Ke{constructor(Ha,kb,Hb,ic,Qc,Jd,yd,He,sf,bg,Ag,Ii,aj,Xg,Qi,Jh,Og,Qh){this.YCb=!1;if(!Qi)throw Error.argumentNull("shapeReader");if(Jh&&!Og)throw Error.argumentNull("shapeSVGDependencyLoader");if(!Qh)throw Error.argumentNull("businessBarController");this.ia=Ha;this.pa=kb;this.Jb=Hb;this.wi=ic;this.fc=Qc;this.Ixe=Jd;this.qCg=yd;this.Qo=He;this.Fb=sf;this.ua=bg;this.Ri=Ag;this.I9=Ii;this.WL=aj;this.t0=Xg;this.Ea=Qi;this.Dma=Jh;this.QXa=Og;this.gl=Qh}wb(){this.ia.ra($d.a.xZd,T.a.application,
Object(A.a)(this,this.I7b,"handlePictureCropEvent"),4);this.qCg?(this.ia.ra($d.a.vZd,T.a.application,Object(A.a)(this,this.S$f,"handleCropSplitButton"),4),this.ia.ra($d.a.wZd,T.a.application,Object(A.a)(this,this.S$f,"handleCropSplitButton"),4)):(this.ia.ra($d.a.vZd,T.a.application,Object(A.a)(this,this.I7b,"handlePictureCropEvent"),4),this.ia.ra($d.a.wZd,T.a.application,Object(A.a)(this,this.I7b,"handlePictureCropEvent"),4));this.ia.ra($d.a.yOe,T.a.application,Object(A.a)(this,this.ANk,"queryIsActive"),
101);this.ia.ra($d.a.jqc,T.a.application,Object(A.a)(this,this.uxj,"handleSendCropInfo"),4);this.ia.ra($d.a.xah,T.a.application,Object(A.a)(this,this.Ybe,"handlePictureCropToShapeEvent"),4);this.ia.ra($d.a.wah,T.a.application,Object(A.a)(this,this.Ybe,"handlePictureCropToShapeEvent"),4);this.ia.ra($d.a.qJb,T.a.application,Object(A.a)(this,this.Wjd,"queryPictureCropBounding"),100);this.ia.ra($d.a.sJb,T.a.application,Object(A.a)(this,this.Wjd,"queryPictureCropBounding"),100);this.ia.ra($d.a.rJb,T.a.application,
Object(A.a)(this,this.Wjd,"queryPictureCropBounding"),100);this.ia.ra($d.a.wnc,T.a.application,Object(A.a)(this,this.Wjd,"queryPictureCropBounding"),100);this.ia.ra($d.a.qvd,T.a.application,Object(A.a)(this,this.pvd,"updatePictureCropBounding"),4);this.ia.ra($d.a.tvd,T.a.application,Object(A.a)(this,this.pvd,"updatePictureCropBounding"),4);this.ia.ra($d.a.rvd,T.a.application,Object(A.a)(this,this.pvd,"updatePictureCropBounding"),4);this.ia.ra($d.a.svd,T.a.application,Object(A.a)(this,this.pvd,"updatePictureCropBounding"),
4)}S$f(Ha,kb,Hb,ic,Qc){return 1===Hb?32===this.Ybe(Ha,kb,Hb,ic,Qc)||32===this.I7b(Ha,kb,Hb,ic,Qc)?32:8:this.I7b(Ha,kb,Hb,ic,Qc)}uxj(Ha,kb,Hb,ic,Qc){if(!Qc)return ae.a.J(512500482,824,50,"Send Crop Info called with no cropping info"),8;kb=Qc.pictCropperInfo;Qc=Qc.shapeNode;if(!Qc||!Qc.pictureCropInfo)return ae.a.J(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Hb)return 32;if(Hb=Ad.a.Ib)Hb.actionName="EndCropPicture",Hb.Oj=!1,Hb.Ur=!0;Hb=this.Jb.Ad(15);try{Hb.nc(Qc),Hb.jd=
Ha,Qc.Xlc=kb}finally{Hb&&Hb.dispose()}return 32}Ybe(Ha,kb,Hb,ic,Qc){if(!this.qCg||this.fc.$c(this.pa.uk()))return 8;kb=this.pa.tg();if(!kb||!kb.length)return 8;const Jd=[];for(var yd of kb)yd&&Jd.push(yd);if(!Jd.length)return 8;for(const bg of Jd)if(bg.isLocal||this.WL.aX(bg)||!this.fTj(bg))return 8;if(1===Hb)return 32;ae.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const He=Qc?Qc.SourceControlId:"";yd=0;Hb=He.split("_");if(3===Hb.length)yd=Number.parseInvariant(Hb[2]);
else return ae.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",He),16;Hb=window.performance.now();Qc=new Xe.a;Qc.TargetShapeTypeAsInt=yd;yd=this.Jb.Ad(15,void 0,()=>{for(const bg of Jd)if(bg.iy){const Ag=this.$k(bg);Ag&&Ag.u1(!1)}ae.a.J(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",He)});try{yd.nc(Jd[0]);yd.jd=Ha;for(var sf of Jd)sf.Ylc=Qc}finally{yd&&yd.dispose()}Ha=window.performance.now();
if(sf=Ad.a.Ib)sf.actionName="PictureCropToShape",sf.Va("PictureCropShapeType",Qc.TargetShapeTypeAsInt.toString()),sf.Va("PictureCropToShapeDuration",(Ha-Hb).toString()),Ad.a.Tfa(sf);ae.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",Qc.TargetShapeTypeAsInt);return 32}I7b(Ha,kb,Hb){if(!this.Ixe||this.fc.$c(this.pa.uk()))return 16;if(this.Dma&&!this.QXa.wkg)return ae.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),
8;kb=this.pa.Xd();const ic=this.pa.N7d(kb);if(1!==kb.length)return We.a("CropCannotBePerformedOnCurrentSelection")&&1!==Hb&&this.XPf(),8;if(!ic)return 8;if(this.Ea.ix(ic).length)return We.a("CropCannotBePerformedOnCurrentSelection")&&1!==Hb&&this.XPf(),8;if(!this.Fle(ic))return 8;if(1===Hb)return 32;if(ic.isLocal||this.WL.aX(ic))return 16;if(ic.iy){Ha=this.$k(ic);if(!Ha)return 8;Ha.u1(!1);ic.pictureCropInfo=null;Le.App.Kb.updateCommandUI();this.ia.processAction($d.a.vPb,2);return 32}this.pa.jj();
const Qc=this.ua.Ba;this.fc.blockContent(Qc,Ha);const Jd=Ad.a.Ib;Jd&&(Jd.actionName="BeginCropPicture",Jd.Oj=!1,Jd.Ur=!0);this.wi.K5f(ic.get_sid(),ic.get_cid(),ic.get_shapeId(),yd=>{Ad.a.AF(Jd,()=>{this.evk(ic,Qc,yd)})},()=>this.dvk(ic,Qc),!0);return 32}ANk(Ha,kb,Hb,ic,Qc){if(!Object(Rb.a)(xb.a,Qc))return 8;Ha=this.pa.kp();Qc.Lf(Ha?Ha.iy:!1);return 32}CUc(){const Ha=this.pa.kp();return Ha&&Ha.iy&&Ha.isConnected?this.I9.IF(Ha):null}$k(Ha){return Ha?Object(wb.a)(117,Ha.sc(this.Fb.Ma)):null}XPf(){this.gl.dL(26)}Wjd(Ha,
kb,Hb,ic,Qc){if(!this.Ixe||!Qc)return 16;kb=this.CUc();if(!kb)return 16;Hb=kb.V6d();ic=this.Fb.Md;Ha=Ha===$d.a.qJb?ic.qf(this.Ri.GM(Yc.a.lm(Hb.ga(0),Hb.ga(3)),kb.zoom),1):Ha===$d.a.sJb?ic.qf(this.Ri.GM(Yc.a.lm(Hb.ga(0),Hb.ga(1)),kb.zoom),0):Ha===$d.a.rJb?ic.qf(this.Ri.GM(Hb.ga(0).x,kb.zoom),0):ic.qf(this.Ri.GM(Hb.ga(0).y,kb.zoom),1);Qc=Qc.queryResult;null!==Qc&&(Qc.Kaa=parseFloat(ye.a.Qv(Ha).toFixed(2)).toString());return 32}pvd(Ha,kb,Hb,ic,Qc){if(!this.Ixe||this.Dma&&!this.QXa.wkg)return 16;kb=this.CUc();
if(1===Hb)return kb?32:16;if(!kb||!Qc)return 16;if(2===Hb){Hb=!1;ic=kb.V6d().copy();Qc=ye.a.UW(Qc.Number);const Jd=Yc.a.lm(ic.ga(0),ic.ga(1)),yd=Yc.a.lm(ic.ga(0),ic.ga(3)),He=this.Fb.Md;Ha===$d.a.qvd?(Qc=this.Ri.JM(He.Pe(Qc,1),kb.zoom),Ha=Qc-yd,ic.ga(2).pM(0,Ha),ic.ga(3).pM(0,Ha)):Ha===$d.a.tvd?(Qc=this.Ri.JM(He.Pe(Qc,0),kb.zoom),Ha=Qc-Jd,ic.ga(1).pM(Ha,0),ic.ga(2).pM(Ha,0)):Ha===$d.a.rvd?(Hb=!0,Qc=this.Ri.JM(He.Pe(Qc,0),kb.zoom),Ha=Qc-ic.ga(0).x,ic.move(Ha,0)):Ha===$d.a.svd&&(Hb=!0,Qc=this.Ri.JM(He.Pe(Qc,
1),kb.zoom),Ha=Qc-ic.ga(0).y,ic.move(0,Ha));kb.JEl(ic,Hb)}return 32}fTj(Ha){let kb=[];Ha.If?kb=this.Ea.ix(Ha):Ha.Og&&(kb=this.Ea.ix(Ha.ys()));if(kb.length){for(const Hb of kb)if(!this.Fle(Hb))return!1;return!0}return this.Fle(Ha)}Fle(Ha){const kb=this.Qo.O0e&&!Ha.isGif&&(Ha.Hj||1===Ha.mediaType)&&!Ha.get_isSVGBlipFilled();return this.t0?kb&&!Ha.TGb:kb}dvk(Ha,kb){this.fc.hK(kb);if(!this.isActive||!Ha.isConnected)return!0;this.isActive=!1;Ha.pictureCropInfo=null;ae.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");
return!1}evk(Ha,kb,Hb){this.fc.hK(kb);if(Ha.isConnected)if(kb=Ad.a.Ib,Ad.a.AF(kb,()=>{this.ia.processAction($d.a.v7a,2)}),this.WL.aX(Ha))ae.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");else{var ic=Ha.ng(this.Fb.Ma);if(ic){var Qc=new Date;Ha.pictureCropInfo=JSON.parse(Hb.PictureCropInfoStr);this.I9.ZG(Ha).Brl();Ha=new Date;kb&&(kb.Zm("ParseCropInfoStart",Qc),kb.Zm("ParseCropInfoEnd",Ha),Ad.a.Tfa(kb));ic.GA();this.ia.processAction($d.a.vPb,2)}}}get isActive(){return this.YCb}set isActive(Ha){this.YCb=
Ha}}Object(h.a)(Ke,"PictureCropActor",null,[]);var me=d(1212),Uf=d(196),yf=d(187),Cf=d(219),Ld=d(133),od=d(167),ug=d(330),Kf=d(860),Vf=d(628),Ch=d(49),xg=d(69),lh=d(728),Oi=d(116),ph=d(209),Dh=d(169),mh=d(893),Od=d(329),Ue=d(208),yh=d(188),Hj=d(189),fe=d(286);class Zh{constructor(Ha,kb,Hb,ic,Qc,Jd,yd,He,sf,bg,Ag,Ii,aj,Xg){this.Eb=!0;this.Hk=!1;this.Jn=[];this.G4=this.lB=this.xX=this.AH=this.rJ=this.xb=null;this.WC=Array(8);this.vva=this.un=this.Kv=null;this.uU=this.vd=1;this.jCe=new Yc.a(0,0);this.Kn=
new Uf.a;this.H0=new yf.a;this.aic=new Yc.a(0,0);this.Ifb=0;this.nu=new yf.a;this.Kva=new Yc.a(0,0);this.wma=new Yc.a(0,0);this.uic=this.VWa=!1;this.vfc=new Yc.a(0,0);this.M$=this.m$=null;this.ixg=new ec.a;this.ou=null;if(!ic)throw Error.argumentNull("clickInputManager");if(!Ha)throw Error.argumentNull("shapeNode");if(Ag&&!Ii)throw Error.argumentNull("transformFactory");if(Ag&&!aj)throw Error.argumentNull("presReader");this.ta=Ha;this.Ea=kb;this.ic=Hb;this.Zc=ic;this.ia=Qc;this.YC=Jd;this.je=yd;this.O9=
He;this.ihk=sf;this.Wva=bg;this.Dma=Ag;this.yk=Ii;this.S9j=Xg}Jm(Ha){this.xb=new yh.a;this.xb.$j(1);this.xb.Rd(!1);this.xb.Hoa(xg.a.Ysl);Ha.appendChild(this.xb.viewport);this.rJ=new lh.a(!1,this.Dma);this.xb.appendChild(this.rJ);this.AH=new lh.a(!1,this.Dma);this.xb.appendChild(this.AH);this.AH.$j(1);this.xX=new Dh.a;this.xX.Zu(Qd.a.E1);this.xX.mr(Qd.a.TE);this.xX.PE(Oi.a.none);this.xX.$j(1);this.xb.appendChild(this.xX);this.G4=new Dh.a;this.G4.$j(1);this.G4.nl(xg.a.Zya);this.G4.Hoa("ShapeMoveHandle");
this.G4.PE(Oi.a.none);this.xb.appendChild(this.G4);this.lB=new ph.a;this.L1b(this.lB);this.xb.appendChild(this.lB);this.xb.viewport.xa.setAttribute("class",xg.a.bmc);this.xb.Rd(!1);this.Zc.pb(K.a.click,this.G4.xa,Object(A.a)(this,this.ned,"noOpHandler"));this.Zc.pb(K.a.click,this.xX.xa,Object(A.a)(this,this.ned,"noOpHandler"))}L1b(Ha){for(let ic=0;8>ic;++ic){var kb="cropHandle"+ic;const Qc=new ph.a;Qc.xa.id=kb;if(Hc.a.ELa){var Hb=new Od.a;Hb.xa.id=kb;Hb.setVisibility(!1);Hb.setPosition(-10,-10);Hb.lh(20,
20);Qc.appendChild(Hb)}Hb=new od.a(ic);kb=Hb.K9b()?this.RDi(Hb,kb):this.UHi(Hb,kb);Qc.appendChild(kb);Qc.$j(1);this.WC[ic]=Qc;Ha.appendChild(Qc)}}Kde(Ha){for(let kb=0;8>kb;++kb)if(this.WC[kb].xa.id===Ha.id)return new od.a(kb);return null}DUj(Ha){return Ha.id.startsWith("cropHandle")}dispose(){this.O9();this.Hk=!0;this.Eb=!1;this.xb&&this.xb.zq();this.xb=null;this.G4&&this.Zc.yb(K.a.click,this.G4.xa,Object(A.a)(this,this.ned,"noOpHandler"));this.G4=null;this.xX&&this.Zc.yb(K.a.click,this.xX.xa,Object(A.a)(this,
this.ned,"noOpHandler"));this.lB=this.xX=null;this.WC&&Array.clear(this.WC);this.m$=this.M$=this.WC=null;this.vfc=new Yc.a(0,0)}Bqd(Ha,kb,Hb,ic){const Qc=this.L$d(),Jd=Ha-Qc.x+this.wma.x+Hb,yd=kb-Qc.y+this.wma.y+ic;return isNaN(Jd)||isNaN(yd)?(ae.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",Ha,Qc.x,this.wma.x,Hb,kb,Qc.y,this.wma.y,
ic,this.vd),new Yc.a(0,0)):new Yc.a(Jd,yd)}setPosition(Ha,kb){this.VWa&&this.ta.pictureCropInfo&&(this.Kva=Ha=new Yc.a(Ha/this.vd,kb/this.vd),this.Wva?(this.m$&&this.rJ&&(kb=this.Bqd(this.m$.Position.X,this.m$.Position.Y,Ha.x,Ha.y),this.rJ.setPosition(kb.x,kb.y)),this.M$&&this.AH&&this.AH.image&&(Ha=this.Bqd(this.M$.Position.X,this.M$.Position.Y,Ha.x,Ha.y),this.AH.image.setPosition(Ha.x,Ha.y))):((kb=this.ta.pictureCropInfo.MaskViewElem)&&this.rJ&&(kb=this.Bqd(kb.Position.X,kb.Position.Y,Ha.x,Ha.y),
this.rJ.setPosition(kb.x,kb.y)),(kb=this.ta.pictureCropInfo.TextureViewElem)&&this.AH&&this.AH.image&&(Ha=this.Bqd(kb.Position.X,kb.Position.Y,Ha.x,Ha.y),this.AH.image.setPosition(Ha.x,Ha.y))),this.xb.Rl())}iql(Ha,kb){const Hb=new Yc.a(this.Ea.$A(this.ta,this.YC).x/this.vd,this.Ea.$A(this.ta,this.YC).y/this.vd),ic=new Yc.a(this.wma.x+this.Kva.x,this.wma.y+this.Kva.y);if(this.Wva)this.m$&&this.rJ&&this.rJ.setPosition(this.m$.Position.X-Hb.x+ic.x+Ha/this.vd,this.m$.Position.Y-Hb.y+ic.y+kb/this.vd),
this.M$&&this.AH&&this.AH.image.setPosition(this.M$.Position.X-Hb.x+ic.x+Ha/this.vd,this.M$.Position.Y-Hb.y+ic.y+kb/this.vd);else{var Qc=this.ta.pictureCropInfo.MaskViewElem;Qc&&this.rJ.setPosition(Qc.Position.X-Hb.x+ic.x+Ha/this.vd,Qc.Position.Y-Hb.y+ic.y+kb/this.vd);(Qc=this.ta.pictureCropInfo.TextureViewElem)&&this.AH.image.setPosition(Qc.Position.X-Hb.x+ic.x+Ha/this.vd,Qc.Position.Y-Hb.y+ic.y+kb/this.vd)}this.xb.Rl()}jql(Ha,kb){kb.Kj(1/this.uU);this.ith(Ha,Uf.a.add(this.TYa,kb))}resize(Ha,kb){kb.Kj(1/
this.uU);this.ith(Ha,kb)}ith(Ha,kb){Ha=this.CTd(Ha,kb);this.Qq(Ha);this.setOffsets(kb)}L$d(){const Ha=this.Ea.$A(this.ta,this.YC);return new Yc.a(Ha.x/this.vd,Ha.y/this.vd)}WIh(){this.ta.iy&&(this.uU=this.ic.jg(this.ta).oq/this.jCe.x)}Brl(){const Ha=this.ic.jg(this.ta);this.jCe.update(Ha.oq,Ha.Vk)}Kj(Ha){this.vd=Ha;this.xb.Kj(this.vd);Ha=new yf.a;Ha.lca(1/this.vd,1/this.vd);this.lB.QE(Ha,Ue.a.tca);this.S9j?this.yY(!1):this.yY(!0)}get zoom(){return this.vd/this.uU}V6d(){this.WIh();this.Kv||(this.Kv=
this.ta.fp);var Ha=Yc.a.lm(this.Kv.ga(0),this.Kv.ga(1));const kb=Yc.a.lm(this.Kv.ga(0),this.Kv.ga(3)),Hb=this.Kv.Vf(),ic=new Ld.a(new Yc.a(0,0),new Yc.a(Ha,0),new Yc.a(Ha,kb),new Yc.a(0,kb));ic.move(Hb.x-Ha/2,Hb.y-kb/2);Ha=this.L$d();ic.move(Ha.x,Ha.y);ic.scale(this.uU,this.uU);return ic}JEl(Ha,kb){Ha=Ha.copy();Ha.scale(1/this.uU,1/this.uU);var Hb=this.L$d();Ha.move(-1*Hb.x,-1*Hb.y);Hb=Ha.Vf();const ic=new yf.a;kb?ic.P7(this.ta.get_shapeRotation(),Hb):ic.P7(this.ta.get_shapeRotation(),this.Kv.ga(0));
ic.El(Ha);kb||Ha.move(this.Kv.ga(0).x-Ha.ga(0).x,this.Kv.ga(0).y-Ha.ga(0).y);this.Kv=Ha;this.xX.Et(this.Kv.points);kb=this.AH.clipPath;We.a("SVGCreationOnChangesFromFormatPane")&&this.Dma&&kb?(kb.s0b=this.pMc(Ha),this.OGc(Ha.ga(0))):kb&&kb.m7a&&kb.m7a.K5e(this.Kv.points);this.uic=!0;this.yY(!0);this.xb.Rl()}setZIndex(Ha){this.xb.OB(Ha+2*ug.a.jba)}setOffsets(Ha){this.Kv||(this.Kv=this.ta.fp);this.sdi(Ha);this.Kn=Ha;var kb=this.lB.OBb;Ha=new Yc.a(kb[0].x/this.vd,kb[0].y/this.vd);var Hb=new Yc.a(kb[2].x/
this.vd,kb[2].y/this.vd);const ic=new Yc.a(kb[4].x/this.vd,kb[4].y/this.vd);kb=new Yc.a(kb[6].x/this.vd,kb[6].y/this.vd);Ha=new Ld.a(Ha,Hb,ic,kb);this.xX.Et(this.Kv.points);Hb=this.AH.clipPath;this.Dma&&Hb?(this.OGc(Yc.a.fV(Ha.points[this.Ifb],this.aic)),Hb.s0b=this.pMc(Ha)):Hb&&Hb.m7a&&Hb.m7a.K5e(Ha.points);this.xb.Rl()}sdi(Ha){var kb=this.Kv,Hb=Yc.a.lm(kb.ga(0),kb.ga(1));kb=Yc.a.lm(kb.ga(0),kb.ga(3));Ha.bottom-Ha.top<-1*kb&&(kb+=Ha.bottom-Ha.top,Ha.top+=kb,Ha.bottom-=kb);Ha.right-Ha.left<-1*Hb&&
(Hb+=Ha.right-Ha.left,Ha.left+=Hb,Ha.right-=Hb)}Qq(Ha){this.H0=Ha;this.xX.QE(Ha,Ue.a.tca);this.yY(!0)}Yu(Ha){this.nu=Ha;this.xb.QE(Ha,Ue.a.Ssb);this.xb.Rl()}Xy(){Array.clear(this.Jn)}bE(Ha){return this.DUj(Ha)?this.Kde(Ha):null}JB(Ha){const kb=[];var Hb=this.ta.pictureCropInfo;if(this.ta.iy){const ic=this.ic.jg(this.ta);if(Hb.MaskViewElem){let Qc=fe.a.nMc(6,ic.oq,ic.Vk);Array.add(kb,Qc)}Hb.TextureViewElem&&(Hb=fe.a.nMc(7,ic.oq,ic.Vk),Array.add(kb,Hb));Array.add(this.Jn,Ha)}else this.Eb=!1,this.xb.Rd(!1);
return kb}lD(){}hIl(){this.vfc.x!==this.rJ.x&&this.vfc.y!==this.rJ.y&&(ae.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.m$.Position.X=this.rJ.x+this.Ea.$A(this.ta,this.YC).x/this.vd,this.m$.Position.Y=this.rJ.y+this.Ea.$A(this.ta,this.YC).y/this.vd,this.M$.Position.X=this.AH.image.x+this.Ea.$A(this.ta,this.YC).x/this.vd,this.M$.Position.Y=this.AH.image.y+this.Ea.$A(this.ta,this.YC).y/this.vd,this.wma.update(0,
0))}i_b(Ha,kb){const Hb=this.yk.wMc();this.ta.get_isVerticallyFlipped()&&(Hb.lca(1,-1),Hb.hC(0,2*kb._y));this.ta.get_isHorizontallyFlipped()&&(Hb.lca(-1,1),Hb.hC(2*kb._x,0));Hb.P7(Ha,kb);return Hb}W7f(){return this.ta.get_isVerticallyFlipped()&&this.ta.get_isHorizontallyFlipped()?2:this.ta.get_isVerticallyFlipped()?3:this.ta.get_isHorizontallyFlipped()?1:0}OGc(Ha){const kb=new yf.a;kb.hC(Ha._x,Ha._y);this.AH.clipPath.QE(kb,Ue.a.tca)}pMc(Ha){ae.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");
var kb=this.ta.get_shapeRotation();this.yk.Ica(-kb,Ha.Vf()).El(Ha);this.ou||(this.ou=svgShape.FactoryGlobal.createShape());this.ou.setSVGRoot(this.xb.xa,!1);this.ta.TK?this.ou.setShapeType(this.ta.TK):(this.ou.setShapeType(4),ae.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.ou.setOffsets(this.ta.get_xPersisted()+me.a.xY(Ha.ga(0).x/this.uU,0),this.ta.get_yPersisted()+me.a.xY(Ha.ga(0).y/this.uU,1));this.ou.setExtents(me.a.xY(Ha.ga(1).x-Ha.ga(0).x,0),me.a.xY(Ha.ga(2).y-Ha.ga(1).y,1));
var Hb=svgShape.FactoryGlobal.getConvertor().getPath(this.ou,!1,this.uU,this.uU);if(!Hb||!Hb.length)throw ae.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");Ha=Array(Hb.length);kb=0;for(const ic of Hb)Hb=new Dh.a,Hb.v1(ic),Hb.xa.setAttribute(Oi.a.NOb,this.nu.Flb()),Ha[kb++]=Hb;ae.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return Ha}draw(Ha,kb){if(Array.contains(this.Jn,
Ha)){Array.remove(this.Jn,Ha);if(this.ta.pictureCropInfo&&!this.VWa){if(this.ta.pictureCropInfo.MaskViewElem){Ha=this.ta.pictureCropInfo.MaskViewElem;var Hb=Ha.Clip,ic=this.ic.jg(this.ta);ic=fe.a.nMc(6,ic.oq,ic.Vk);if(ic=kb[ic.toString()])this.rJ.pcl(ic.Base64Data,Ha.Id.toString(),Hb.Bounds.Left,Hb.Bounds.Top,Hb.TotalWidth,Hb.TotalHeight,Hb.Bounds.Right-Hb.Bounds.Left,Hb.Bounds.Bottom-Hb.Bounds.Top),this.rJ.Rd(!0),this.rJ.setPosition(Ha.Position.X-this.Ea.$A(this.ta,this.YC).x/this.vd,Ha.Position.Y-
this.Ea.$A(this.ta,this.YC).y/this.vd);this.m$=Ha;this.vfc=new Yc.a(this.rJ.x,this.rJ.y)}this.ta.pictureCropInfo.TextureViewElem?(Ha=this.ic.jg(this.ta),ic=fe.a.nMc(7,Ha.oq,Ha.Vk),Ha=this.ta.pictureCropInfo.TextureViewElem,Hb=Ha.Clip,(kb=kb[ic.toString()])?this.Dma?(this.Ifb=this.W7f(),this.aic=this.un.points[this.Ifb].copy(),this.OGc(Yc.a.fV(this.ta.fp.points[this.Ifb],this.aic)),this.nu=this.i_b(this.ta.get_shapeRotation(),this.ta.fp.Vf()),this.AH.qcl(kb.Base64Data,Ha.Id.toString(),Ha.Position.X-
this.Ea.$A(this.ta,this.YC).x/this.vd,Ha.Position.Y-this.Ea.$A(this.ta,this.YC).y/this.vd,Hb.TotalWidth,Hb.TotalHeight,this.un.copy().points,this.pMc(this.un.copy()))):this.AH.ocl(kb.Base64Data,Ha.Id.toString(),Ha.Position.X-this.Ea.$A(this.ta,this.YC).x/this.vd,Ha.Position.Y-this.Ea.$A(this.ta,this.YC).y/this.vd,Hb.TotalWidth,Hb.TotalHeight,this.ta.fp.points):ae.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.M$=Ha):ae.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");
this.Kv&&Yc.a.lm(this.Kv.ga(0),this.Kv.ga(2))||(this.Kv=this.ta.fp);this.vva=this.ta.oZa;this.G4.Et(this.vva.points);this.xX.Et(this.Kv.points);this.VWa=!0;this.yY(!0);this.visible=this.Eb}else this.Wva&&this.m$&&this.M$&&(this.hIl(),this.rJ.setPosition(this.m$.Position.X-this.Ea.$A(this.ta,this.YC).x/this.vd,this.m$.Position.Y-this.Ea.$A(this.ta,this.YC).y/this.vd),this.AH.image.setPosition(this.M$.Position.X-this.Ea.$A(this.ta,this.YC).x/this.vd,this.M$.Position.Y-this.Ea.$A(this.ta,this.YC).y/
this.vd),this.Dma?(this.Ifb=this.W7f(),this.aic=this.un.points[this.Ifb].copy(),this.OGc(Yc.a.fV(this.ta.fp.points[this.Ifb],this.aic)),this.nu=this.i_b(this.ta.get_shapeRotation(),this.ta.fp.Vf()),this.AH.clipPath.s0b=this.pMc(this.ta.fp)):this.AH.clipPath.m7a=new mh.a(this.ta.fp.points,0),this.vfc=new Yc.a(this.rJ.x,this.rJ.y),this.Kv=this.ta.fp,this.vva=this.ta.oZa,this.G4.Et(this.vva.points),this.xX.Et(this.Kv.points),this.yY(!0),ae.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));
this.xb.Rl();this.xb.Rd(this.Eb)}}pEl(){if(this.Kv){var Ha=this.lB.OBb;const kb=new Yc.a(Ha[0].x/this.vd,Ha[0].y/this.vd),Hb=new Yc.a(Ha[2].x/this.vd,Ha[2].y/this.vd),ic=new Yc.a(Ha[4].x/this.vd,Ha[4].y/this.vd);Ha=new Yc.a(Ha[6].x/this.vd,Ha[6].y/this.vd);this.Kv=new Ld.a(kb,Hb,ic,Ha)}else this.Kv=this.ta.fp;this.un=this.Kv.copy();this.vva||(this.vva=this.ta.oZa);this.vva.move(this.Kva.x,this.Kva.y);this.G4.Et(this.vva.points);this.wma.pM(this.Kva.x,this.Kva.y);this.Kva.update(0,0);this.je.Gy(new Hj.a(1))}w6i(){var Ha=
this.lB.OBb;const kb=new Yc.a(Ha[0].x,Ha[0].y),Hb=new Yc.a(Ha[2].x,Ha[2].y),ic=new Yc.a(Ha[4].x,Ha[4].y);Ha=new Yc.a(Ha[6].x,Ha[6].y);return new Ld.a(kb,Hb,ic,Ha)}v8i(){var Ha=this.ta.oZa.copy().points,kb=new Yc.a(Ha[0].x*this.vd,Ha[0].y*this.vd);const Hb=new Yc.a(Ha[1].x*this.vd,Ha[1].y*this.vd),ic=new Yc.a(Ha[2].x*this.vd,Ha[2].y*this.vd);Ha=new Yc.a(Ha[3].x*this.vd,Ha[3].y*this.vd);kb=new Ld.a(kb,Hb,ic,Ha);kb.scale(1/this.uU,1/this.uU);kb.move((this.wma.x+this.Kva.x)*this.vd,(this.wma.y+this.Kva.y)*
this.vd);return kb}OE(Ha){this.VWa&&(this.lB.Rd(!Ha),Ha?(this.WIh(),this.uic=!0):(this.pEl(),this.ia.processAction($d.a.vPb,2),this.Wva&&(Ha={["pictCropperInfo"]:this.$Af(),["shapeNode"]:this.ta},this.ia.La($d.a.jqc,2,Ha))))}Zp(){return this.xb.Zp()}yY(Ha){if(this.VWa){var kb=this.Kv.copy();Ha&&this.H0.El(kb);Ha=new yf.a;Ha.nrb(this.ta.get_shapeRotation());var Hb=2*Math.ceil((this.ta.get_shapeRotation()-45)/90)%8;for(let ic=0;8>ic;++ic){const Qc=this.WC[ic];Qc.nl(Ch.a.fQ(Cf.a.box4Image(Zh.Npc[Hb]),
xg.a.EA));this.ZKa(Qc,kb.sk(new od.a(ic)));Qc.QE(Ha,Ue.a.Ssb);Hb=(Hb+1)%8}}}ZKa(Ha,kb){Ha.x===kb.x*this.vd&&Ha.y===kb.y*this.vd||Ha.setPosition(kb.x*this.vd,kb.y*this.vd)}get visible(){return this.Eb}set visible(Ha){this.Eb=Ha;!Ha&&this.VWa&&(this.lVi(),this.VWa=!1);this.xb.Rd(this.Eb)}lVi(){if(this.VWa){if(this.uic){const Ha={["pictCropperInfo"]:this.$Af(),["shapeNode"]:this.ta};this.ia.La($d.a.jqc,2,Ha)}this.b3()}}$Af(){let Ha,kb,Hb,ic;const Qc=this.hpi();({left:Ha,top:kb,right:Hb,bottom:ic}=this.Sxi());
return Object.assign(new Kf.a,{Left:Ha,Top:kb,Right:Hb,Bottom:ic,X:Qc.x,Y:Qc.y})}Sxi(){let Ha,kb,Hb,ic;({left:Ha,top:kb,right:Hb,bottom:ic}=this.UMi());({left:Ha,top:kb,right:Hb,bottom:ic}=this.CBi(Ha,kb,Hb,ic));({left:Ha,top:kb,right:Hb,bottom:ic}=Zh.PJl(Ha,kb,Hb,ic));return{left:Ha,top:kb,right:Hb,bottom:ic}}UMi(){let Ha,kb,Hb;var ic=this.vva.points;const Qc=this.Kv.points;Ha=Vf.a(ic[3],ic[0],Qc[3],Qc[0]);kb=Vf.a(ic[0],ic[1],Qc[0],Qc[1]);Hb=Vf.a(ic[1],ic[2],Qc[1],Qc[2]);ic=Vf.a(ic[2],ic[3],Qc[2],
Qc[3]);return{left:Ha,top:kb,right:Hb,bottom:ic}}CBi(Ha,kb,Hb,ic){var Qc=this.vva.points;const Jd=Yc.a.lm(Qc[0],Qc[1]);Qc=Yc.a.lm(Qc[1],Qc[2]);Ha=Math.floor(Ha/Jd*1E6)/1E6;kb=Math.floor(kb/Qc*1E6)/1E6;Hb=Math.floor(Hb/Jd*1E6)/1E6;ic=Math.floor(ic/Qc*1E6)/1E6;return{left:Ha,top:kb,right:Hb,bottom:ic}}hpi(){var Ha=this.Kv.copy(),kb=new yf.a,Hb=Ha.Vf();kb.P7(-1*this.ta.get_shapeRotation(),Hb);kb.El(Ha);Hb=this.Ea.$A(this.ta,this.YC);this.ihk?(kb=this.YC.qf(Ha.hc*this.vd+Hb.x,0),Ha=this.YC.qf(Ha.kc*this.vd+
Hb.y,1),Ha=new Yc.a(kb,Ha)):Ha=new Yc.a(Ha.hc+Hb.x/this.vd,Ha.kc+Hb.y/this.vd);return Yc.a.scale(Ha,this.uU,this.uU)}ned(){return!0}b3(){this.xX.QE(new yf.a,Ue.a.tca);this.G4.setPosition(0,0);this.Kn=new Uf.a;this.un=this.Kv=this.H0=this.ta.pictureCropInfo=null;this.wma.update(0,0);this.uic=!1;this.jCe.update(0,0);this.uU=1}CTd(Ha,kb){const Hb=new yf.a;this.un||(this.un=Ha);Ha=this.un.Vf();const ic=Yc.a.lm(this.un.ga(0),this.un.ga(1)),Qc=Yc.a.lm(this.un.ga(0),this.un.ga(3)),Jd=ic?1+(kb.right-kb.left)/
ic:1,yd=Qc?1+(kb.bottom-kb.top)/Qc:1,He=Ha.copy();He.pM(-1*ic/2,-1*Qc/2);Hb.P7(-1*this.ta.get_shapeRotation(),Ha);Hb.hC(-1*He.x,-1*He.y);Hb.lca(Jd,yd);Hb.hC(kb.left+He.x,kb.top+He.y);Hb.P7(this.ta.get_shapeRotation(),Ha);return Hb}RDi(Ha,kb){var Hb=[new Yc.a(0,0),new Yc.a(20,0),new Yc.a(20,5),new Yc.a(5,5),new Yc.a(5,20),new Yc.a(0,20)];Hb=new mh.a(Hb,0);Hb.xa.id=kb;Hb.PE("black");Hb.Zu("white");Hb.mr(1);Ha.equals(od.a.DE)?Hb.dLa(90):Ha.equals(od.a.Ru)?Hb.dLa(0):Ha.equals(od.a.WE)?Hb.dLa(180):Ha.equals(od.a.RH)&&
Hb.dLa(-90);return Hb}UHi(Ha,kb){const Hb=new Od.a;Hb.xa.id=kb;Hb.PE("black");Hb.Zu("white");Hb.mr(1);Hb.lh(20,5);Ha.equals(od.a.north)?Hb.setPosition(-10,0):Ha.equals(od.a.south)?Hb.setPosition(-10,-5):Ha.equals(od.a.east)?(Hb.setPosition(-5,-10),Hb.lh(5,20)):Ha.equals(od.a.west)&&(Hb.setPosition(0,-10),Hb.lh(5,20));return Hb}get TYa(){return this.Kn}get te(){return this.xb.viewport}g$d(Ha){return!this.ta.iy&&8>Ha.index?this.WC[Ha.index].xa:null}PN(){return!1}Ox(Ha){Ha&&(this.uic=!1)}setSelection(){}static PJl(Ha,
kb,Hb,ic){.999999<Ha+Hb&&(ae.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",Ha,Hb),Hb=(999999-1E6*Ha)/1E6);.999999<kb+ic&&(ae.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",kb,ic),ic=(999999-1E6*kb)/1E6);return{left:Ha,top:kb,right:Hb,bottom:ic}}}Zh.Npc=[xg.a.Wzh,xg.a.Uzh,xg.a.Vzh,xg.a.Tzh,xg.a.Yzh,xg.a.Xzh,xg.a.Zzh,xg.a.$zh];Object(h.a)(Zh,"PictureCropShapeView",null,[584,435,436,106]);var Pi=d(664);class Zj{constructor(Ha,kb,Hb){this.Ea=
Ha;this.YC=kb;this.I9=Hb}setPosition(Ha,kb,Hb){this.I9.IF(Ha.shapeNode).iql(kb,Hb)}setOffsets(Ha,kb){this.I9.IF(Ha.shapeNode).jql(Ha.T4e.copy(),kb)}JI(Ha,kb){const Hb=new yf.a,ic=this.I9.IF(Ha.shapeNode);kb=kb?ic.w6i().copy():ic.v8i().copy();Ha=this.Ea.$A(Ha.shapeNode,this.YC);Hb.hC(Ha.x,Ha.y);Hb.El(kb);return new Pi.a(kb)}lG(Ha){return Ha.shapeNode.iy}}Object(h.a)(Zj,"ShapeCropMoveResizeHandler",null,[576]);class Wg{constructor(Ha,kb,Hb){this.I9=Ha;this.Wva=kb;this.Q9c=Hb}u1(Ha,kb,Hb){if((Ha=this.I9.IF(Ha))&&
Ha.visible!==Hb){for(const ic of kb)this.Q9c&&(kb=Object(wb.a)(573,ic))&&kb.setSelected(!Hb),ic!==Ha&&(ic.visible=!Hb);Ha.visible=Hb}}Tqd(){return!1}Wud(Ha,kb,Hb){this.I9.IF(Ha).resize(Hb,kb)}Uqd(){return!1}Xud(Ha,kb,Hb,ic){ic&&this.I9.IF(Ha).setPosition(kb,Hb)}h1c(){return!this.Wva}B9a(Ha,kb){return this.Wva?kb:[this.I9.IF(Ha)]}lG(Ha){return Ha.iy}}Object(h.a)(Wg,"ShapeViewCropUpdateStrategyHandler",null,[574,575]);var $h=d(280);class Fe{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PictureCrop"}Zb(Ha){this.K=
Ha;this.K.register(403,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().oa(()=>new $h.a((kb,Hb)=>{let ic=null;const Qc=Object(wb.a)(117,kb.sc(this.K.resolve("Box4.IPageView").Ma));Qc&&!Qc.Al&&(ic=new Zh(kb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IPageView").Md,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
Hb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").mLe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").nid,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").E4d),ic.Jm(Qc.xa),ic.setZIndex(3),ic.visible=!1,Qc.PM(ic.te.xa,!0),Qc.xra(ic,3));return ic}));this.K.register(Ke,
"PowerPointWebEditor.PictureCropActor").ma().oa(()=>new Ke(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").gTj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").lLe,this.K.resolve("Common.IBrowserUtils"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").yka,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").nid,
this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(oe,"PowerPointWebEditor.FormatPicturePaneActor").ma().oa(()=>new oe(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new Wg(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").mLe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pid));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Zj(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView").Md,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").wb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").wb();
this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").Ee()}dispose(){}static main(){r.a.instance.Dc(qd.a(new Fe,0))}}Object(h.a)(Fe,"PPTWebEditorPictureCropPackage",null,[2,3]);var Ph=d(40),rg=d(247);class zg{constructor(Ha,kb,Hb,ic,Qc){this.bA=[Ph.a.Ui,Ph.a.font,ad.a.autonumberBulletType];this.Pb=Ha;this.Ml=kb;this.Ih=Hb;this.Pgc=ic;this.pJ=Qc}format(Ha){if(Ha&&Ha.FAb){Ha=this.Pb.Mc(Ha);for(var kb=this.Ml.h3(Ha,Ha.currentNode);kb.moveNext();){var Hb=kb.currentNode;if(Hb&&this.Ih.ae(Hb)){const ic=
this.pJ.qQ(Ha,this.Ih.thb(Hb));(Hb=this.Pgc.ITc(Hb))&&rg.d(ic,Hb,this.bA)}}}}}Object(h.a)(zg,"BeautifyListFormatter",null,[540]);class lj{constructor(Ha,kb,Hb,ic,Qc){this.ia=Ha;this.ua=Hb;this.Jb=kb;this.Ea=ic;this.v7j=Qc}initialize(){this.wb()}wb(){this.ia.ra($d.a.ORd,T.a.application,Object(A.a)(this,this.ORd,"applyTextFormatterSuggestion"),4)}ORd(Ha,kb,Hb){if(1===Hb)return 32;Ha=this.ua.Ba;if(!Ha)return 16;kb=Ha.gk();if(!kb||!kb.length)return 16;kb=this.Ea.r_(kb);if(!kb.length)return 16;Hb=this.Jb.Ad(15);
Hb.nc(Ha);for(const ic of kb)this.v7j.format(ic);Hb.dispose();return 32}}Object(h.a)(lj,"TextFormatterActor",null,[]);class pg{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}Zb(Ha){this.K=Ha;Ha.register(540,"PowerPointWebEditor.IBeautifyListFormatter").ma().oa(()=>new zg(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor")));Ha.register(lj,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().oa(()=>new lj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const Ha=this.K.resolve("Common.IAppSettingsManager");Ha.ff(()=>
{Ha.ka("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){r.a.instance.Dc(qd.a(new pg,0))}}Object(h.a)(pg,"PPTWebEditorTextFormatterPackage",null,[2,3]);var Nh=d(12);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Object(Nh.c)("Chronos1");
Ka.main();Type.registerNamespace("Common.App.O365Shell");hc.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Zb.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");sd.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",
Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",
attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",
Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},
children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",
attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",
Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",
Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",
attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",
Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},
{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},
{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",
ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",
QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",
Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",
Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",
DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};Fe.main();pg.main();Type.registerNamespace("NLRT");Object(Nh.b)("Chronos1")},139:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(224);class e{constructor(r,n){this.WNa=!1;const {Annotations:v}=d(80);if(!r)throw Error.argumentNull("annotations");
if(!r.kne(n))throw Error.argument("memberTypeID","Invalid type ID");if(v.TB(n))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Gr=r;this.yXh=n;this.$B=[]}get Orb(){return this.Gr}get isReadOnly(){return this.WNa}get BU(){return this.yXh}get items(){return this.$B}Z1(){const {Annotations:r}=d(80);let n="[";for(let v=0,B=this.items.length;v<B;++v){0<v&&(n+=", ");const y=this.Gr.Z1(this.BU,this.items[v]);this.BU===r.dZ?(n+='"',n+=h.a.A2d(y),n+='"'):n+=y}return n+"]"}isEqual(r){const {Annotations:n}=
d(80);if(this===r)return!0;if(!r||r.Orb!==this.Gr||r.BU!==this.BU||r.items.length!==this.items.length)return!1;for(let v=0;v<this.items.length;++v)if(!n.T1a(this.BU,this.items[v],r.items[v]))return!1;return!0}clone(){const r=new e(this.Gr,this.BU);Array.addRange(r.items,this.items);return r}XK(){return this.isReadOnly?this.clone():this}Loe(){const {Annotations:r}=d(80);if(!this.isReadOnly){this.WNa=!0;for(const n of this.items)r.Xbb(n)}}toString(){return this.Z1()}}Object(J.a)(e,"ListValue",null,
[976,978])},144:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.tellMe="TellMe";h.contextMenu="ContextMenu";h.unknown="Unknown";Object(J.a)(h,"TellMeScenario",null,[])},156:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r,n=null,v=null,B=4,y=-99999,x=0){this.EQd="";this.xHc=-1;this.value=e;this.type=r;this.subType=B;this.label=this.MJ=n;this.groupType=29;this.description=v;this.score=y;this.count=x}}Object(J.a)(h,"ResultBinding",null,[])},170:function(J,
aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.attributes=null;this.query=e;this.Lk=[]}Uq(e){this.Lk.push(e)}Kih(e){const r=[];for(const n of this.Lk)n.groupType!==e&&r.push(n);this.Lk.length!==r.length&&(this.Lk=r)}get bAb(){return!1}}Object(J.a)(h,"SimpleResultsUpdatedEventArgs",null,[807])},171:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e=29,r=""){this.X_h=[];this.groupType=e;this.displayName=r}get results(){return this.X_h}ls(e){e.groupType=
this.groupType;Array.add(this.results,e)}qRe(e=1){if(this.results.length>=e)for(let r=0;r<e;r++)Array.removeAt(this.results,this.results.length-1)}}Object(J.a)(h,"SimpleResultGroup",null,[808])},224:function(J,aa,d){J=d(0);class h{constructor(r,n){this.ZPa=r;this.value=n}}Object(J.a)(h,"AttrValuePair",null,[]);d.d(aa,"a",function(){return e});class e{constructor(r){this.WNa=!1;if(!r)throw Error.argumentNull("annotations");this.Gr=r;this.kO=[]}get Orb(){return this.Gr}get isReadOnly(){return this.WNa}get pce(){return 0<
this.kO.length}Tm(r){if(!this.Gr.JAb(r))throw Error.argument("attributeID","Invalid attribute ID");for(const n of this.kO)if(r===n.ZPa)return r=n.value,{returnValue:!0,value:r};return{returnValue:!1,value:null}}su(r,n){var {Annotations:v}=d(80);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Gr.JAb(r))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Gr.Jzb(this.Gr.getAttributeType(r),n))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");v.Xbb(n);for(v=0;v<this.kO.length;++v){const B=this.kO[v];if(r===B.ZPa){B.value=n;return}}Array.add(this.kO,new h(r,n))}Jld(r){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Gr.JAb(r))throw Error.argument("attributeID","Invalid attribute ID");for(let n=0;n<this.kO.length;++n)if(r===this.kO[n].ZPa){Array.removeAt(this.kO,n);break}}WQc(r){if(!r)throw Error.argumentNull("action");
for(const n of this.kO)r(n.ZPa,n.value)}clone(){const r=new e(this.Gr);r.ECa(this);return r}ECa(r){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!r)throw Error.argumentNull("other");if(r.Orb!==this.Gr)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.kO);r.WQc((n,v)=>{this.su(n,v)})}Z1(){const {Annotations:r}=d(80);let n="[",v=!0;for(const B of this.kO){v?v=!1:n+=", ";n+=this.Gr.x_f(B.ZPa);n+="=";const y=this.Gr.getAttributeType(B.ZPa),
x=this.Gr.Z1(y,B.value);y===r.dZ?(n+='"',n+=e.A2d(x),n+='"'):n+=x}return n+"]"}isEqual(r){const {Annotations:n}=d(80);if(!r)throw Error.argumentNull("other");if(this===r)return!0;if(!r||this.Gr!==r.Orb||this.pce!==r.pce)return!1;let v=0,B=null,y=!1;r.WQc((x,A)=>{++v;if(!y){var E=-1;for(let u=0,K=this.kO.length;u<K;++u)if(this.kO[u].ZPa===x){E=u;break}0>E?y=!0:(B||(B=Array(this.kO.length)),B[E]=A)}});if(this.kO.length!==v||y)return!1;for(let x=0,A=this.kO.length;x<A;++x)if(!n.T1a(this.Gr.getAttributeType(this.kO[x].ZPa),
this.kO[x].value,B[x]))return!1;return!0}XK(){return this.isReadOnly?this.clone():this}Loe(){const {Annotations:r}=d(80);if(!this.isReadOnly){this.WNa=!0;for(const n of this.kO)r.Xbb(n.value)}}toString(){return this.Z1()}static A2d(r){return r.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(J.a)(e,"FeatureBundle",null,[975,978])},263:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.click="Click";h.Xyb="InteractionBegin";h.hgg="InteractionEnd";
h.eJf="ControlActivated";h.query="Query";h.feh="QueryIndexRecorded";h.uHf="Clicks";h.ksf="ActionEvents";h.nWf="FilteredActionEvents";h.eqh="SessionContext";h.latency="Latency";h.performance="Performance";h.Akh="RenderedResults";h.events="Events";h.qHi="CreateResultsMenu";h.rG="UpdateRibbonControls";h.H4k="ResultsAggregation";h.iB="IssueQuery";h.Nwi="CommandSuggestions";h.error="Error";h.Doe="LoadModelData";h.bMi="DepsResolveTime";h.Xnk="ModelDataWaitTime";h.timedOut="TimedOut";h.Pci="AddinQueryCommandReady";
h.Y3i="GetAddinEntitlements";h.Pdh="ProviderMRUEvents";h.FRi="EnableAddinSearchCommands";Object(J.a)(h,"EventNames",null,[])},281:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.XAe=null;this.rz=this.CCe=0}pRc(e,r,n){if(!e)throw Error.argumentNull("referenceList");if(0>r||r>e.length)throw Error.argumentOutOfRange("startIndex");if(0>n||n>e.length)throw Error.argumentOutOfRange("length");if(r+n>e.length)throw Error.argument("Invalid start-length range");this.XAe=
e;this.CCe=r;this.rz=n}uSa(e,r,n){this.pRc(e.XAe,e.CCe+r,n)}ga(e){if(0>e||e>=this.rz)throw Error.argumentOutOfRange("index");return this.XAe[this.CCe+e]}get count(){return this.rz}static WYd(e){const r=new h;r.pRc(e,0,e.length);return r}}Object(J.a)(h,"ReadOnlyList",null,[1011])},306:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]=
"FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=
19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.SummarizeDeck=25]="SummarizeDeck";e[e.Addin=26]="Addin";e[e.OfficeScript=27]="OfficeScript";e[e.AddinStoreEntry=28]="AddinStoreEntry";e[e.None=29]="None";e[e.MergedActions=30]="MergedActions";e[e.MergedScopedSearches=31]="MergedScopedSearches";e[e.MergedSuggestedSearches=32]="MergedSuggestedSearches"})(h||(h={}));Object(J.b)("ResultGroupType",h)},335:function(J,
aa,d){d.r(aa);d.d(aa,"CommandResultsUtility",function(){return A});J=d(0);var h=d(383),e=d(263),r=d(384),n=d(156),v=d(171),B=d(117),y=d(104),x=d(27);class A{static mPb(E,u){if(u&&u.Po){const K={};for(const G of E)u.b1c(G)&&(K[G]=appChrome.selectors.getModelType(G));B.TellMeActor.instance.rG(K)}}static dwl(E){return E.startsWith("btnTellMeOfficeAddIn")}static I9b(E){const u=B.TellMeActor.instance.WG();return!!u&&u.Po&&!appChrome.selectors.isControlDisabled(E)}static y2c(E,u,K,G){if(B.TellMeActor.instance.Hd&&
E){const O=[];for(const R of E)O.push(String.format('{{"Id":"{0}","Score":{1}}}',R.commandId,R.score));E={};E[h.a.suggestions]="[{"+O.join(",")+"}]";E[h.a.Pog]=u;E[h.a.groupType]=K;E[h.a.provider]=G;B.TellMeActor.instance.Hd.CH(e.a.Nwi,window.performance.now(),E)}}static T7i(E,u){const K=[],G=[];for(const O of u){u=O.commandId;let R=O;O.commandId in E&&(u=E[O.commandId],R=new r.a(u,O.score));Array.contains(G,u)||(K.push(R),G.push(u))}return K}static vUc(E,u,K,G,O,R,V,D){K.S6d&&(u=A.T7i(K.S6d,u));
var Q=y.a.X6i(u);A.mPb(Q,K);var Z=[],P=[];Q=[];const ca=new v.a(V);V=16===V||18===V||7===V||4===V?x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Bc("TellMeMaxRecommendedResultsToReturn",3):3:0===V||17===V?5:0;for(const T of u)if(!A.KMj(T.commandId)){u=A.dwl(T.commandId);if(K.b1c(T.commandId)&&!u){if(y.a.Xng(T.commandId))continue;u=null;O&&R&&(u=O.hgj(T.commandId,R));A.I9b(T.commandId)?Array.add(Z,new n.a(T.commandId,5,u,null,D,T.score)):Array.add(P,new n.a(T.commandId,5,u,null,D,T.score))}else K.x6a&&
u&&G&&Array.add(Q,T.commandId.substr(21));if(Z.length+Q.length>=V)break}K=0;for(O=0;O<Z.length&&K<V;O++,K++)ca.ls(Z[O]);for(Z=0;Z<P.length&&K<V;Z++,K++)ca.ls(P[Z]);for(P=0;P<Q.length&&K<V;P++,K++)G.sQl(E,Q[P],ca);return ca}static KMj(E){A.qAf||(x.AFrameworkApplication.fa&&x.AFrameworkApplication.fa.Eu("TellMeControlPredictionBlockList")&&x.AFrameworkApplication.fa.YA("TellMeControlPredictionBlockList").forEach(u=>{Array.add(A.pAf,u.toLowerCase())}),A.qAf=!0);return Array.contains(A.pAf,E.toLowerCase())}static yje(E){return 2<
E.length&&";"===E.charAt(0)&&";"===E.charAt(E.length-1)&&!!x.AFrameworkApplication.fa&&(x.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static O0f(E){const u=new v.a(0);var K=E.split(";");E=B.TellMeActor.instance.WG();for(const G of K)if(0<G.length){K=G.split(":");const O=2===K.length?K[0]:G;if(!E.b1c(O))break;if(1===K.length)K=new n.a(O,5,null,null,1),u.ls(K);else if(2===
K.length)K=new n.a(O,5,K[1],null,1),u.ls(K);else break}return u}static a7h(E,u,K){if(!(u&&u.results&&E&&E.results&&E.results.length))return{returnValue:!1,ePd:E,DPd:u};const G=[];for(var O of u.results)Array.add(G,O.value);O=0;const R=0<u.results.length?u.results[0].score:0;for(const V of E.results)if(V.score>K&&!Array.contains(G,V.value)&&A.I9b(V.value)&&(0<R&&(V.score=R),Array.insert(u.results,O,V),O++),2===O)break;return 0<O?(K=u.results.length-5,0<K&&u.qRe(K),{returnValue:!0,ePd:E,DPd:u}):{returnValue:!1,
ePd:E,DPd:u}}}A.qAf=!1;A.pAf=[];Object(J.a)(A,"CommandResultsUtility",null,[])},383:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.appName="AppName";h.uCa="CloseAllMenus";h.commandId="CommandId";h.context="Context";h.culture="Culture";h.message="Message";h.errorMessage="ErrorMessage";h.event="Event";h.d9="CorrelationID";h.JDk="ParentUiElement";h.query="Input";h.gib="QueryID";h.heh="QueryLength";h.nJb="QueryIndex";h.I4k="ResultsList";h.suggestions="Suggestions";h.scenario="Scenario";
h.sessionId="SessionID";h.source="Source";h.timeStamp="Time";h.XFh="UiElement";h.fld="ReactUx";h.value="Val";h.statusCode="StatusCode";h.r$k="Service";h.isSuccess="IsSuccess";h.Vxl="TokenAcquired";h.n_j="LatencyType";h.groupName="GroupName";h.G$a="GroupIndex";h.groupType="GroupType";h.E4k="ResultInfoList";h.resultType="ResultType";h.B0e="SubResultType";h.gQj="IsInputBlur";h.hQj="IsInputFocus";h.OVj="IsShortCutUsed";h.actionType="ActionType";h.count="Count";h.DQi="DwellTime";h.Pog="IsZeroTerm";h.tMl=
"WordsCount";h.o0c="IsSearchUxEnabled";h.iXj="IsTellMeInHeaderEnabled";h.module="Module";h.resultIndex="ResultIndex";h.C0d="DisplayIndex";h.ORi="EnableList";h.provider="Provider";h.contentType="ContentType";h.rVj="IsSelectionBased";h.Qii="BeginPerformanceMarker";h.oSi="EndPerformanceMarker";h.OFk="PerformanceMeasure";Object(J.a)(h,"Columns",null,[])},384:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r){this.commandId=e;this.score=r}}Object(J.a)(h,"CommandSuggestion",
null,[])},450:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{static kuc(e){if(!e)return"{NULL}";const r=e.length;return 600>=r?e:e.substring(0,400)+"[...]"+e.substring(r-195,r)}}Object(J.a)(h,"LogUtils",null,[])},451:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.tellMe="TellMe";h.loki="Loki";h.substrate="Substrate";h.nJb="QueryIndex";h.gCh="TellMeRanker";h.hCh="TellMeRankerLogging";Object(J.a)(h,"Services",null,[])},452:function(J,aa,d){d.d(aa,"a",function(){return h});
J=d(0);class h{}h.Tta="HttpRequest";h.provider="Provider";Object(J.a)(h,"LatencyTypes",null,[])},547:function(J,aa,d){J=d(0);class h{constructor(){this.Wtc=this.X8b=null;this.zEe=this.score=this.$ic=0}xKe(K,G,O){this.score=K.ga(G);++G;this.X8b=K.ga(G)?O.M8(K.ga(G)):null;++G;this.Wtc=K.ga(G)?O.M8(K.ga(G)):null;++G;this.$ic=K.ga(G);++G;this.zEe=K.ga(G);++G;return G}}Object(J.a)(h,"TokenStringGeneratorInit",null,[]);class e{constructor(K,G,O,R,V){this.mSa=K;this.count=G;this.GQc=O;this.SG=R;this.depth=
V}}Object(J.a)(e,"ErrorTolerantTrieMatch",null,[]);var r=d(709),n=d(991);class v{constructor(K=null,G=0,O=0,R=0){this.q3h=K||new n.a;this.bda=G;this.SG=O;this.depth=R}get rV(){return this.q3h}getKey(){return this.rV.ht.toString()+":"+this.bda.toString()}}Object(J.a)(v,"TrieBookmark",null,[]);class B{constructor(K,G){this.Iwa=K;this.gze=G}o6j(K){if(null==K)throw Error.argumentNull("prefix");let G={};var O=G[""]=new v;this.$Wc(O,G);for(O=0;O<K.length;++O){const R=K.charCodeAt(O),V={};for(let D in G)this.Jdi(R,
G[D],V);G=V}return this.bzl(G)}$Wc(K,G){if(!(K.SG>=this.gze)&&(K=new v(r.a.eWd(K.rV),K.bda,K.SG+1,K.depth),K.rV.Jz&r.a.FMa&&(K.bda+=1),this.Iwa.Olb(K.rV))){K.depth+=1;let O=!0;for(;O;)B.ovd(K,G),this.$Wc(K,G),K.bda+=this.Iwa.Kwb(K.rV,!0)+(K.rV.Jz&r.a.FMa?1:0),O=this.Iwa.euc(K.rV)}}Jdi(K,G,O){G.SG+1<=this.gze&&(G.SG+=1,B.ovd(G,O),--G.SG);G.rV.Jz&r.a.FMa&&(G.bda+=1);if(this.Iwa.Olb(G.rV)){G.depth+=1;let R=!0;for(;R;)G.rV.rmb===K?(B.ovd(G,O),this.$Wc(G,O)):G.SG+1<=this.gze&&(G.SG+=1,B.ovd(G,O),this.$Wc(G,
O),--G.SG),G.bda+=this.Iwa.Kwb(G.rV,!0)+(G.rV.Jz&r.a.FMa?1:0),R=this.Iwa.euc(G.rV)}}bzl(K){const G=[];for(var O in K){const R=K[O];if(!R.rV.ht)continue;const V=!!(R.rV.Jz&r.a.FMa),D=this.Iwa.Kwb(R.rV,!1)+(V?1:0);Array.add(G,new e(R.bda,D,V,R.SG,R.depth))}G.sort((R,V)=>{let D=R.mSa-V.mSa;return D||(D=-(R.count-V.count))?D:D=R.depth-V.depth});if(2>G.length)return G;K=[];for(O=0;O<G.length;)O+=B.ODh(O,G,K);return K}static ovd(K,G){const O=K.getKey();O in G?(G=G[O],G.SG=Math.min(G.SG,K.SG)):G[O]=new v(r.a.eWd(K.rV),
K.bda,K.SG,K.depth)}static ODh(K,G,O){const R=G[K];let V=R.mSa;const D=V+R.count;let Q=1,Z=R.GQc;for(;K+Q<G.length&&G[K+Q].mSa<D;){const P=G[K+Q];P.mSa>V&&(Array.add(O,new e(V,P.mSa-V,Z,R.SG,R.depth)),Z=!1);Q+=B.ODh(K+Q,G,O);V=P.mSa+P.count}V<D&&Array.add(O,new e(V,D-V,Z,R.SG,R.depth));return Q}}Object(J.a)(B,"ErrorTolerantTrieLookupEngine",null,[1071]);class y extends h{constructor(K,G,O){super();this.zeg=this.s8g=!1;this.NTf=null;if(K){var R=0;try{R=this.xKe(K,R,G);this.s8g=1===K.ga(R);++R;this.zeg=
1===K.ga(R);++R;const V=K.ga(R);this.NTf=this.ZDk(O,V)}catch(V){throw Error.argument("initData");}}}ZDk(K,G){return new B(K,G)}}Object(J.a)(y,"FuzzyMatchTokenStringGeneratorInit",h,[]);class x extends h{constructor(K,G){super();this.query=this.name=null;if(K){this.annotations=G.annotations;var O=0;try{O=this.xKe(K,O,G),this.name=G.BC(K.ga(O)),++O,this.query=G.VD(K.ga(O))}catch(R){throw Error.argument("initData");}}}}Object(J.a)(x,"QueryTokenStringGeneratorInit",h,[]);class A extends h{constructor(K,
G){super();if(K)try{this.xKe(K,0,G)}catch(O){throw Error.argument("initData");}}}Object(J.a)(A,"SurfaceStringTokenStringGeneratorInit",h,[]);var E=d(281);d.d(aa,"a",function(){return u});class u{constructor(K){this.yqe=K}get X8b(){return this.yqe.X8b}get Wtc(){return this.yqe.Wtc}get $ic(){return this.yqe.$ic}static create(K,G,O){const {SurfaceStringTokenStringGenerator:R}=d(1137),{QueryTokenStringGenerator:V}=d(1138),{FuzzyMatchTokenStringGenerator:D}=d(1139);let Q=0;try{if(K.ga(Q)!==u.Q6a)throw Error.argument("initData",
"Input does not represent a token string generator");++Q;const Z=K.ga(Q);++Q;const P=new E.a;P.uSa(K,Q,K.count-Q);switch(Z){case R.q_b:return new R(new A(P,G));case V.q_b:return new V(new x(P,G));case D.q_b:return new D(new y(P,G,O));default:throw Error.argument("initData");}}catch(Z){throw Error.argument("initData");}}static wuf(K,G,O,R,V,D){K=K.byl.getId(G,null);if(0>K)return++D,D;u.xuf(K,O,R,V);return D}static xuf(K,G,O,R){Array.add(R.h0e,K);Array.add(R.Lzh,G);++R.HOb[O]}}u.Q6a=1099767983;Object(J.a)(u,
"TokenStringGenerator",null,[1037])},697:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(104);d=d(27);class e{static jXj(){return!h.a.Sjg()&&!h.a.wbb()&&e.isFeatureEnabled(0)}static tng(){return e.isFeatureEnabled(1)}static Okg(){return e.isFeatureEnabled(2)}static isFeatureEnabled(r){return!!(e.pSh&1<<r)}}e.pSh=d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.Bc("TellMeFeatureConfigValue",0):0;Object(J.a)(e,"TellMeFeatureAvailability",null,[])},698:function(J,aa,d){d.d(aa,"a",
function(){return h});J=d(0);d=d(156);class h extends d.a{constructor(e,r,n,v,B=null){super(e,r,B,null,n);this.id=v}}Object(J.a)(h,"TryQueryResultBinding",d.a,[])},699:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.Ia=e}get eJa(){return this.Ia.eJa}get Ftl(){return 4!==this.Ia.style}get Itl(){return!0}get trie(){return this.Ia.trie}getId(e,r){if(!this.Ftl)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ia.style){case 0:return this.qbj(e,
r);default:throw Error.notImplemented();}}BC(e){if(!this.Itl)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.eJa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ia.style){case 0:return this.Wlj(e);case 4:return this.Vlj(e);default:throw Error.notImplemented();}}qbj(e,r){e=this.Ia.trie.hsg(e,0,e.length,r);if(!e.succeeded)return-1;if(0>e.QOb||e.QOb>=this.Ia.eJa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");
return this.Ia.fuc?this.Ia.foc.ru(this.Ia.fuc+4*e.QOb,4):e.QOb}Wlj(e){if(this.Ia.fuc){let r=0;for(;r<this.Ia.eJa&&this.Ia.foc.ru(this.Ia.fuc+4*r,4)!==e;++r);if(r>=this.Ia.eJa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ia.trie.a8f(r)}return this.Ia.trie.a8f(e)}Vlj(e){const r=this.Ia.foc.ru(this.Ia.Jzh+4*e,4);e=this.Ia.foc.ru(this.Ia.Kzh+4*e,4);if(0>e||0>r)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const n=Array(r);
for(let v=0;v<r;++v)n[v]=({LBj:e}=this.rSk(e)).returnValue;return String.fromCharCode.apply(null,n)}rSk(e){let r=0;for(let n=0;3>n;++n){const v=this.Ia.foc.ga(this.Ia.UEf+e)^182;++e;r|=(v&127)<<7*n;if(!(v&128))break}return{returnValue:r,LBj:e}}}Object(J.a)(h,"StringTable",null,[1013])},700:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(709);class e{constructor(r){this.trie=null;this.UEf=this.Jzh=this.Kzh=this.fuc=0;if(r){this.foc=r;var n=0;if(r.ru(n,4)!==e.Q6a)throw Error.argument("bytes",
"Input does not represent a string table");n+=4;this.eJa=r.ru(n,4);n+=4;this.style=r.ru(n,4);n+=4;switch(this.style){case 0:const v=1===r.ru(n,4);n+=4;v||(this.fuc=n,n+=4*this.eJa);r.ru(n,4);this.trie=this.CEk(r,n+4);break;case 4:this.Kzh=n;this.Jzh=n+=4*this.eJa;n+=4*this.eJa;r.ru(n,4);this.UEf=n+4;break;default:throw Error.argument("bytes");}}}CEk(r,n){return new h.a(r,n)}}e.Q6a=1025118440;Object(J.a)(e,"StringTableInit",null,[])},701:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;
(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";
e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.Addin=26]="Addin";e[e.OfficeScript=27]="OfficeScript";e[e.AddinStoreEntry=28]="AddinStoreEntry";e[e.GenerateSlides=
29]="GenerateSlides";e[e.SummarizeDeck=30]="SummarizeDeck";e[e.Unknown=31]="Unknown"})(h||(h={}));Object(J.b)("ResultType",h)},709:function(J,aa,d){J=d(0);class h{constructor(y){this.G0g=y;this.succeeded=!1;this.QOb=y?y.QOb:0;this.fXj=!1;this.length=this.svl=0}}Object(J.a)(h,"TrieResult",null,[]);class e{constructor(y,x,A){this.Bo=new h(null);this.Eck=y;this.mec=x;this.Gxg=x+A-1}get result(){return this.Bo}R4f(){let y;return this.mec<=this.Gxg?(y=this.Eck.charAt(this.mec),++this.mec,{returnValue:!0,
ch:y}):{returnValue:!1,ch:"\x00"}}VQe(y,x,A){y&&(this.Bo.fXj=!0,this.Bo.svl=x);this.Bo.length=this.mec;this.Bo.succeeded=!0;this.Bo.QOb=A;this.mec!==this.Gxg+1&&(this.Bo=new h(this.Bo))}}Object(J.a)(e,"LookUpStringVisitor",null,[1030]);var r=d(991);class n{constructor(){this.BEf=this.VBf=this.XBf=this.UBf=this.WBf=this.KTd=this.JTd=this.MTd=this.ITd=0}}Object(J.a)(n,"TRIESTATS",null,[]);class v{constructor(){this.symbol=this.Vjc=0}}Object(J.a)(v,"TrieSymbol",null,[]);d.d(aa,"a",function(){return B});
class B{constructor(y,x){this.vU=null;this.v6c=this.ZAg=this.XAg=this.aBg=this.TAg=this.$Ag=this.YAg=this.bBg=this.UAg=0;this.KC=y;if(y.ru(x,4)!==B.Q6a)throw Error.argument("Input does not represent a trie");x+=4;this.kyg=1===y.ru(x,4);x+=4;this.u9j=1===y.ru(x,4);x+=4;this.f9j=y.ru(x,4);x+=4;if(y.ru(x,4)){y=x+4;this.vU=this.tSk(y);this.UAg=x=y+B.tni;this.bBg=x+=B.XIc*(this.vU.ITd+(this.vU.ITd%2?1:0));this.YAg=x+=B.XIc*(this.vU.MTd+(this.vU.MTd%2?1:0));this.$Ag=x+=B.XIc*(this.vU.JTd+(this.vU.JTd%2?
1:0));this.TAg=x+=B.XIc*(this.vU.KTd+(this.vU.KTd%2?1:0));this.aBg=x+=B.QTd*this.vU.UBf;this.XAg=x+=B.RTd*this.vU.XBf;this.ZAg=x+=B.RTd*this.vU.VBf;x+=B.RTd*this.vU.WBf;if(x!==y+this.vU.BEf)throw Error.argument("Corrupted trie binary");this.v6c=x}else this.vU=null}hsg(y,x,A,E){y=new e(y,x,A);this.xKh(y,E);return y.result}a8f(y){if(this.kyg)if(y)--y;else return"";if(!this.vU)throw Error.argument("Invalid trieID");const x=new r.a;x.Jz=0;this.Olb(x);const A=[];for(;;){if(x.Jz&B.FMa)if(y)--y;else return Array.add(A,
x.rmb),String.fromCharCode.apply(null,A);const E=!!(x.Jz&B.Nwd),u=this.Kwb(x,!0);if(E||y<u){if(Array.add(A,x.rmb),!this.Olb(x))throw Error.argument("Invalid trieID");}else if(y-=u,!this.euc(x))throw Error.argument("Invalid trieID");}}xKh(y,x){let A=0;this.kyg&&(y.VQe(this.u9j,this.f9j,0),++A);if(this.vU){var E=new r.a;E.Jz=0;if(this.Olb(E))for(;;){var u=void 0;if(!({ch:u}=y.R4f()).returnValue)break;x&&(u=x(u));u=u.toString().charCodeAt(0);let K=!1;for(;!K;){const G=!!(E.Jz&B.FMa);if(E.rmb===u){if(K=
!0,G&&y.VQe(!!(E.Jz&B.A7e),E.Rsd,A),!this.Olb(E))return}else if(A+=this.Kwb(E,!0),!this.euc(E))return;G&&++A}}}}Olb(y){if(!y.Jz)return this.n3e(y),!0;if(!(y.Jz&B.Mwd))return!1;y.Vta=0;y.ht=y.bUa;this.n3e(y);return!0}euc(y){if(y.Jz&B.Nwd)return!1;this.n3e(y);return!0}Kwb(y,x){return y.Jz&B.z7e?y.UIc:y.Jz&B.Mwd?!x&&y.Jz&B.Nwd?this.Z7i(y):1:0}Z7i(y){y=B.eWd(y);if(!this.Olb(y))return 0;let x=0;do y.Jz&B.FMa&&++x,x+=this.Kwb(y,!1);while(this.euc(y));return x}n3e(y){y.Jz||(y.Vta=0,y.ht=this.v6c);var x=
this.XMc(this.UAg,y.ht),A=x.symbol;y.ht+=x.Vjc;x=this.KC.ru(this.TAg+B.QTd*A,B.QTd);y.rmb=x&65535;y.Jz=x>>16;y.Jz&B.z7e&&(y.UIc=this.BKi(y));y.Jz&B.A7e&&(x=this.XMc(this.bBg,y.ht),A=x.symbol,y.ht+=x.Vjc,y.Rsd=this.KC.ru(this.aBg+4*A,4));y.Jz&B.QMh?(y.bUa=this.v6c+((this.KC.ga(y.ht)<<8|this.KC.ga(y.ht+1))<<8|this.KC.ga(y.ht+2)),y.ht+=3):y.Jz&B.RMh?(y.bUa=y.ht,y.Vta=y.bUa):y.Jz&B.SMh?(x=this.XMc(this.YAg,y.ht),A=x.symbol,y.ht+=x.Vjc,y.bUa=this.v6c+this.KC.ru(this.XAg+4*A,4)):y.Jz&B.Mwd&&(x=this.XMc(this.$Ag,
y.ht),A=x.symbol,y.ht+=x.Vjc,y.Vta||(y.Vta=y.ht),y.Vta+=this.KC.ru(this.ZAg+4*A,4),y.bUa=y.Vta)}XMc(y,x){const A=new v;let E=0;for(;;){E+=this.KC.ga(x);++x;++A.Vjc;const u=this.KC.ru(y,2);if(E<u)break;A.symbol+=u;E-=u;y+=2;E<<=8}A.symbol+=E;return A}BKi(y){let x=this.KC.ga(y.ht);192<=x?(x=(x&63)<<15|(this.KC.ga(y.ht+1)&127)<<8,x|=this.KC.ga(y.ht+2),y.ht+=3):128<=x?(x=(x&127)<<8|this.KC.ga(y.ht+1),y.ht+=2):y.ht+=1;return x}tSk(y){const x=new n;x.ITd=this.KC.ru(y+12,2);x.MTd=this.KC.ru(y+14,2);x.JTd=
this.KC.ru(y+16,2);x.KTd=this.KC.ru(y+18,2);x.WBf=this.KC.ru(y+24,4);x.UBf=this.KC.ru(y+28,4);x.XBf=this.KC.ru(y+32,4);x.VBf=this.KC.ru(y+36,4);x.BEf=this.KC.ru(y+40,4);return x}static eWd(y){const x=new r.a;x.rmb=y.rmb;x.Jz=y.Jz;x.UIc=y.UIc;x.ht=y.ht;x.bUa=y.bUa;x.Vta=y.Vta;x.Rsd=y.Rsd;return x}}B.Q6a=1654263084;B.tni=48;B.XIc=2;B.RTd=4;B.QTd=4;B.FMa=1;B.Nwd=2;B.z7e=4;B.A7e=8;B.Mwd=16;B.RMh=64;B.SMh=128;B.QMh=256;Object(J.a)(B,"Trie",null,[1031])},711:function(J,aa,d){d.r(aa);J=d(0);d(144);var h=
d(263);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(J.a)(e,"AppsForOfficeStoreType",null,[]);var r=d(117),n=d(27),v=d(82),B=d(37);class y{constructor(){this.ULd=0}YNe(R,V){this.ULd=window.performance.now();this.U1a(()=>{const D=window.performance.now(),Q={},Z=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);V.Tvf&&(Q.callback=P=>{R(P,e.marketPlace,D)},Z&&(Q.storeType=e.marketPlace),n.AFrameworkApplication.Ta.La(B.a.PZa,
2,Q));V.Uvf&&(Q.callback=P=>{R(P,e.privateCatalog,D)},Z?Q.storeType=e.privateCatalog:n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?Q.storeType=10:Q.storeType=e.privateCatalog,n.AFrameworkApplication.Ta.La(B.a.PZa,2,Q))},0,()=>{if(r.TellMeActor.instance.Hd)r.TellMeActor.instance.Hd.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.ULd)+" ms")})}U1a(R,V=0,D=null){2!==
n.AFrameworkApplication.Ta.processAction(B.a.PZa,1)?(r.TellMeActor.instance.Hd&&r.TellMeActor.instance.Hd.CH(h.a.Pci,window.performance.now()-this.ULd),R()):V<y.Dmk?n.AFrameworkApplication.ye.Db(new v.a(2,1,y.mLl,()=>{this.U1a(R,V+1,D)})):D&&D()}static get instance(){y.Ka||(y.Ka=new y);return y.Ka}}y.Ka=null;y.Dmk=20;y.mLl=500;Object(J.a)(y,"AddinEntitlementsQuery",null,[]);class x{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=
null;this.height=this.width=0;this.Hne=this.storeType=this.storeId=this.UMk=this.iconUrl=null}}Object(J.a)(x,"AddinInfo",null,[]);var A=d(156),E=d(171),u=d(170),K=d(104),G=d(70);d.d(aa,"AddinResultsProvider",function(){return O});class O{constructor(R){this.MJd=[];this.ub=R;this.avk=(V,D,Q)=>{if(V){const Z=V.errorCode;if(r.TellMeActor.instance.Hd){const P={};P.StoreType=D;P.ErrorCode=Z;P.AddinCount=V.value?V.value.length:0;r.TellMeActor.instance.Hd.CH(h.a.Y3i,window.performance.now()-Q,P)}if(0===
Z&&V.value){O.r6a=O.r6a||{};V=V.value;for(const P of V)V=new x,V.displayName=P[0],V.id=P[1],V.description=P[2],V.targetType=P[3],V.appVersion=4<P.length?P[4]:"",V.assetId=5<P.length?P[5]:"",V.assetStoreId=6<P.length?P[6]:"",V.width=7<P.length?P[7]:0,V.height=8<P.length?P[8]:0,V.iconUrl=9<P.length?P[9]:"",V.UMk=10<P.length?P[10]:"",V.storeId=11<P.length?P[11]:"",V.storeType=12<P.length?P[12]:"",V.Hne=this.qcj(V),O.r6a[V.id]=V,0<V.iconUrl.length&&(D="AddinIcon_"+V.id,n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",
!0)?this.zhh(D,V.iconUrl):appChrome.addInApi.registerAddinIcon(D,V.iconUrl))}}};y.instance.YNe(this.avk,this.ub)}$D(){return"Add-ins"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:2}iB(R,V,D,Q,Z=null){D=new u.a(R);Z&&!Array.contains(Z,26)||K.a.MF(R)||(Z=new E.a(26),Z.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.Zbj(R.zf,Z),D.Uq(Z));V.resultsUpdated(D)}Zbj(R,V){if((R=this.$7k(R))&&0<R.length){let D=0;R.forEach(Q=>{if(!(3<++D)){var Z="AddinSuggestion"+D,P={};if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",
!0)){var ca="AddinIcon_"+Q.id;0>Array.indexOf(this.MJd,ca)&&0<Q.iconUrl.length&&this.zhh(ca,Q.iconUrl);P["default"]=0<=Array.indexOf(this.MJd,ca)?ca:"AppForOfficeLogo_20"}else P["default"]=0<Q.iconUrl.length?"AddinIcon_"+Q.id:"AppForOfficeLogo_20";ca=[];ca.push(appChrome.actions.setControlLabel(Z,Q.displayName));ca.push(appChrome.actions.setControlIconSet(Z,P));ca.push(appChrome.actions.setCompoundButtonCommandValueId(Z,Q.id));ca.push(appChrome.actions.updateCompoundButtonDescription(Z,Q.description));
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(P=window.performance.now(),ca.push(appChrome.actions.updateControlEnabledDisabledState(Z,!1)),r.TellMeActor.instance.Hd&&r.TellMeActor.instance.Hd.CH(h.a.FRi,window.performance.now()-P));appChrome.api.dispatch(ca);Z=new A.a(Z,26,void 0,void 0,1);Z.EQd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.id,Q.storeType,Q.assetId,null,null,Q.storeId);V.ls(Z)}})}}zhh(R,V){G.c()&&appChrome.addInApi.registerAddinIcon&&
(appChrome.addInApi.registerAddinIcon(R,V),Array.add(this.MJd,R))}$7k(R){if(!O.r6a)return null;const V=[],D=O.r6a;for(let Z in D){var Q=D[Z];Q&&O.Xlk(R,Q)&&Array.add(V,Q)}return V}qcj(R){return O.drl(R.displayName)}static Xlk(R,V){if(!V.Hne)return!1;for(const D of R.split(" ")){R=!1;for(const Q of V.Hne)if(Q.toLowerCase().startsWith(D.toLowerCase())){R=!0;break}if(!R)return!1}return!0}static drl(R){const V=[];for(const D of R.split(" ")){R=0;for(let Q=0;Q<D.length;Q++){const Z=D.charAt(Q);Z.toString().toUpperCase()===
Z.toString()&&Q>R&&(Array.add(V,D.substring(R,Q)),R=Q)}Array.add(V,D.substring(R,D.length));R&&Array.add(V,D.substring(0,D.length))}return V}}O.r6a=null;Object(J.a)(O,"AddinResultsProvider",null,[602])},80:function(J,aa,d){d.r(aa);J=d(0);var h=d(24),e=d(224),r=d(139),n=d(699),v=d(700);class B{constructor(x,A){this.WNa=!1;this.z4=null;if(!x)throw Error.argumentNull("annotations");if(!x.KAb(A))throw Error.argument("structTypeID","Invalid struct type ID");this.Gr=x;this.LBb=this.Gr.b5f(A);this.d2h=A}get Orb(){return this.Gr}get isReadOnly(){return this.WNa}get Yya(){return this.d2h}QSa(x){if(0>
x||x>=this.LBb)throw Error.argument("iField","Invalid field index");return this.z4&&null!=this.z4[x]?this.z4[x]:this.Gr.b8f(this.Yya,x)}VVe(x,A){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>x||x>=this.LBb)throw Error.argument("iField","Invalid field index");if(!this.Gr.Jzb(this.Gr.o$a(this.Yya,x),A))throw Error.argument("value","Value is not of the correct type for the specified field");(this.z4||(this.z4=Array(this.LBb)))[x]=A}Z1(){const {Annotations:x}=
d(80);let A="[";if(this.z4){let E=!0;for(let u=0;u<this.LBb;++u){if(null==this.z4[u])continue;const K=this.Gr.o$a(this.Yya,u);if(x.T1a(K,this.z4[u],this.Gr.b8f(this.Yya,u)))continue;E?E=!1:A+=", ";A+=this.Gr.c8f(this.Yya,u);A+="=";const G=this.Gr.Z1(K,this.z4[u]);K===x.dZ?(A+='"',A+=e.a.A2d(G),A+='"'):A+=G}}return A+"]"}isEqual(x){const {Annotations:A}=d(80);if(this===x)return!0;if(!x||this.Gr!==x.Orb||this.Yya!==x.Yya)return!1;for(let E=0;E<this.LBb;++E)if(!A.T1a(this.Gr.o$a(this.Yya,E),this.QSa(E),
x.QSa(E)))return!1;return!0}clone(){const x=new B(this.Gr,this.Yya);this.z4&&(x.z4=Array.clone(this.z4));return x}XK(){return this.isReadOnly?this.clone():this}Loe(){const {Annotations:x}=d(80);if(!this.isReadOnly&&(this.WNa=!0,this.z4))for(let A=0;A<this.LBb;++A){const E=this.z4[A];null!=E&&x.Xbb(E)}}toString(){return this.Z1()}}Object(J.a)(B,"StructValue",null,[977,978]);d.d(aa,"Annotations",function(){return y});class y{constructor(x,A){if(!x)throw Error.argumentNull("initData");if(!A)throw Error.argumentNull("objectFetcher");
this.U8j=A.UPi;let E=0;var u=A.ESa(x.ga(E));++E;this.ICe=new n.a(new v.a(u));this.XRh=x.ga(E);++E;this.Mxg=Array(this.oPc);this.ydc=Array(this.oPc);this.rWa=Array(this.oPc);for(u=0;u<this.oPc;++u){this.Mxg[u]=A.BC(x.ga(E));++E;this.ydc[u]=x.ga(E);++E;var K=x.ga(E);++E;this.rWa[u]=Array(K);for(var G=0;G<K;++G)this.rWa[u][G]=A.BC(x.ga(E)),++E}this.c2h=x.ga(E);++E;this.oVg=Array(this.wsc);this.vbd=Array(this.wsc);this.wbd=Array(this.wsc);this.ubd=Array(this.wsc);for(u=0;u<this.wsc;++u)for(this.oVg[u]=
A.BC(x.ga(E)),++E,K=x.ga(E),++E,this.vbd[u]=Array(K),this.wbd[u]=Array(K),this.ubd[u]=Array(K),G=0;G<K;++G)this.vbd[u][G]=A.BC(x.ga(E)),++E,this.wbd[u][G]=x.ga(E),++E,this.ubd[u][G]=({W3:E}=this.usa(this.wbd[u][G],x,E,null,null,null)).returnValue,y.Xbb(this.ubd[u][G]);this.yOh=x.ga(E);++E;this.oqe=Array(this.msb);this.pqe=Array(this.msb);this.nqe=Array(this.msb);for(u=0;u<this.msb;++u)this.oqe[u]=A.BC(x.ga(E)),++E,this.pqe[u]=x.ga(E),++E,this.nqe[u]=({W3:E}=this.usa(this.pqe[u],x,E,null,null,null)).returnValue,
y.Xbb(this.nqe[u])}m5b(x){for(let A=0;A<this.msb;++A)if(this.oqe[A]===x)return A;return-1}x_f(x){if(!this.JAb(x))throw Error.argument("attrID","Invalid attribute ID");return this.oqe[x]}getAttributeType(x){if(!this.JAb(x))throw Error.argument("attrID","Invalid attribute ID");return this.pqe[x]}o$a(x,A){if(!this.KAb(x))throw Error.argument("structTypeID","Invalid struct type ID");x=this.wbd[y.xsc(x)];if(0>A||A>=x.length)throw Error.argument("iField","Invalid field index");return x[A]}Z1(x,A){if(!this.kne(x))throw Error.argument("typeID",
"Invalid type ID");if(!this.Jzb(x,A))throw Error.argument("value","Value is not of the correct type");switch(x){case y.dZ:return A;case y.Mga:return A?"True":"False";case y.npa:case y.Waa:return A.toString();case y.SM:return A.Z1();default:if(!y.TB(x)&&y.vuc(x)){x=y.u2d(x);const K=this.rWa[x].length;switch(this.ydc[x]){case 0:return this.rWa[x][A];case 1:if(A){var E="";for(var u=1;u<K;++u)A&1<<u-1&&(0<E.length&&(E+=" & "),E+=this.rWa[x][u]);return E}return this.rWa[x][0];case 2:E="";for(u=0;u<K;++u)A&
1<<u&&(0<E.length&&(E+=" & "),E+=this.rWa[x][u]);return E;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.ydc[x]);}}else return A.Z1()}}kne(x){switch(x){case y.dZ:case y.Mga:case y.npa:case y.Waa:case y.SM:return!0;default:return y.TB(x)?this.kne(y.hEa(x)):y.vuc(x)?this.nYj(x):this.KAb(x)}}nYj(x){x=y.u2d(x);return 0<=x&&x<this.Mxg.length}KAb(x){x=y.xsc(x);return 0<=x&&x<this.oVg.length}JAb(x){return 0<=x&&x<this.msb}Jzb(x,A){if(null==A)return!1;switch(x){case y.dZ:return"string"===
typeof A;case y.Mga:return"boolean"===typeof A;case y.npa:return"number"===typeof A;case y.Waa:return"number"===typeof A;case y.SM:return Object(h.a)(975,A);default:if(y.TB(x))return Object(h.a)(976,A)&&A.BU===y.hEa(x);if(y.vuc(x)){if("number"!==typeof A)return!1;x=y.u2d(x);const E=this.rWa[x].length;switch(this.ydc[x]){case 0:return 0<=A&&A<E;case 1:return!(A&-1<<E-1);case 2:return!!A&&!(A&-1<<E);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.ydc[x]);}}else return Object(h.a)(977,
A)&&A.Yya===x}}get msb(){return this.yOh}get oPc(){return this.XRh}get wsc(){return this.c2h}P4i(x){if(!this.JAb(x))throw Error.argument("attrID","Invalid attribute ID");return this.nqe[x]}b5f(x){if(!this.KAb(x))throw Error.argument("structTypeID","Invalid struct type ID");return this.vbd[y.xsc(x)].length}c8f(x,A){if(!this.KAb(x))throw Error.argument("structTypeID","Invalid struct type ID");return this.vbd[y.xsc(x)][A]}b8f(x,A){if(!this.KAb(x))throw Error.argument("structTypeID","Invalid struct type ID");
x=this.ubd[y.xsc(x)];if(0>A||A>=x.length)throw Error.argument("iField","Invalid field index");return x[A]}usa(x,A,E,u,K,G){if(!A)throw Error.argumentNull("initData");if(y.TB(x)){var O=A.ga(E);++E;x=y.hEa(x);var R=new r.a(this,x);for(var V=0;V<O;++V)Array.add(R.items,({W3:E}=this.usa(x,A,E,u,K,G)).returnValue);return{returnValue:R,W3:E}}switch(x){case y.dZ:return{returnValue:(u||this.ICe).BC(A.ga(E++)),W3:E};case y.Mga:return{returnValue:1===A.ga(E++),W3:E};case y.npa:return{returnValue:A.ga(E++),
W3:E};case y.Waa:return{returnValue:(K||this.U8j)[A.ga(E++)],W3:E};case y.SM:x=A.ga(E++);O=new e.a(this);for(R=0;R<x;++R)V=A.ga(E),++E,G&&(V=G[V]),O.su(V,({W3:E}=this.usa(this.getAttributeType(V),A,E,u,K,G)).returnValue);return{returnValue:O,W3:E};default:if(y.vuc(x))return{returnValue:A.ga(E++),W3:E};if(y.TFh(x)){O=A.ga(E++);R=new B(this,x);for(V=0;V<O;++V){const D=A.ga(E);++E;R.VVe(D,({W3:E}=this.usa(this.o$a(x,D),A,E,u,K,G)).returnValue)}return{returnValue:R,W3:E}}throw Error.argument("typeID",
"Invalid type ID");}}static vuc(x){return 16<=(x&16383)&&16384!==(x&16384)&&32768!==(x&32768)}static TFh(x){return 16<=(x&16383)&&16384===(x&16384)&&32768!==(x&32768)}static TB(x){return 32768===(x&32768)}static odj(x){if(y.TB(x))throw Error.argument("nonListTypeID","Non-list type ID required");return x|32768}static hEa(x){if(!y.TB(x))throw Error.argument("listTypeID","List type ID required");return x&-32769}static T1a(x,A,E){switch(x){case y.dZ:case y.Mga:case y.npa:case y.Waa:return A===E;case y.SM:return A.isEqual(E);
default:return y.TB(x)?A.isEqual(E):y.vuc(x)?A===E:A.isEqual(E)}}static Xbb(x){Object(h.a)(978,x)&&x.Loe()}static XK(x){return Object(h.a)(978,x)?x.XK():x}static u2d(x){return x-16}static xsc(x){return(x&-16385)-16}}y.dZ=1;y.Mga=2;y.npa=3;y.Waa=5;y.SM=9;Object(J.a)(y,"Annotations",null,[979])},981:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.Uxa=e}}Object(J.a)(h,"SessionRehydratedEventArgs",Sys.EventArgs,[])},982:function(J,aa,
d){d.r(aa);d.d(aa,"InsightsMenuItemFactory",function(){return n});J=d(0);var h=d(104),e=d(131),r=d(47);class n{constructor(v=null){this.nUh=v||CommonUIStrings.l_InsightsButtonText}get ijb(){return 10}aL(v){var B=v.MJ;v=h.a.j4()?h.a.PCa(B,1):h.a.aZd(B);B=String.format(this.nUh,B);return this.W2i(v,B)}W2i(v,B){return e.a(n.bgg,h.a.j4()?"1914896509":"3317204163",r.a.ue(B),h.a.vIj,null,r.a.ue(v),r.a.ue(B),null,null)}}n.bgg="bInsights";Object(J.a)(n,"InsightsMenuItemFactory",null,[843])},983:function(J,
aa,d){d.d(aa,"a",function(){return r});J=d(0);var h=d(131),e=d(47);class r{constructor(n,v,B,y,x){this.NKd=n;this.MKd=v;this.T2h=B;this.CTh=y;this.wef=x}get ijb(){return 4}aL(n,v=null){v=v.sessionId+"|"+v.d9+"|"+n.MJ;if(this.wef||this.CTh){let B=this.wef||e.a.RB(CommonUIStrings.l_HelpTooltip)===e.a.RB(n.MJ.trim());if(this.T2h&&2<n.MJ.length){const y=n.MJ;";"===y.charAt(0)&&";"===y.charAt(y.length-1)&&y.substring(1,y.length-1)===r.Xce&&(B=!0)}n=B?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
n.MJ);return this.NZf(v,e.a.ue(n),B)}return this.NZf(v,e.a.ue(String.format(CommonUIStrings.l_TextWithQuotation,n.MJ)),!1)}NZf(n,v,B){return h.a(r.Xce,B?this.MKd:this.NKd,v,"OfficeAssistant_16x16x32","A0",e.a.ue(n),v,null,null)}}r.Xce="bSearchHelp";Object(J.a)(r,"AssistanceMenuItemFactory",null,[843])},984:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(27),e=d(131),r=d(75),n=d(47);class v{get ijb(){return 13}aL(){return v.lli()}static lli(){return e.b(v.wXf,"798637440",n.a.ue(CommonUIStrings.l_LookupFirstRunExperienceTitle),
h.AFrameworkApplication.qm,r.getImageClass("Info_32x32x32"),null,null,n.a.ue(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,n.a.ue(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}v.wXf="bTellMeFirstRun";Object(J.a)(v,"FirstRunMenuItemFactory",null,[843])},985:function(J,aa,d){d.d(aa,"a",function(){return n});J=d(0);var h=d(27),e=d(131),r=d(47);class n{constructor(v=null,B=null){this.bkf=v;this.aYh=B||CommonUIStrings.l_LookupNoResultsDescription}get ijb(){return 14}aL(v){v=
String.format(this.aYh,v.MJ);return this.Vli(v)}Vli(v){return e.b(n.N0g,"798637440",r.a.ue(CommonUIStrings.l_LookupNoResultsTitle),this.bkf?h.AFrameworkApplication.qm:null,this.bkf,null,null,r.a.ue(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,r.a.ue(v),null,null)}}n.N0g="lookupNoResults";Object(J.a)(n,"NoCommandsFoundMenuItemFactory",null,[843])},986:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=
r}}Object(J.a)(h,"LabelFormatted",null,[])},987:function(J,aa,d){d.d(aa,"a",function(){return B});J=d(0);d(144);var h=d(156),e=d(171),r=d(170),n=d(104),v=d(47);class B{constructor(y){this.ub=y}$D(){return"Assistance"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:this.ub.jlc?3:2}iB(y,x,A=!1,E,u=null){E=new r.a(y);if((!u||Array.contains(u,8))&&!n.a.MF(y)){u=new e.a(8);if(A){A=v.a.RB(CommonUIStrings.l_HelpTooltip)===v.a.RB(y.zf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
y.zf);const K=[];this.ub.iVa&&(this.ub.MYe||K.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),A=this.W4f(y.zf));const G="||"+y.zf;K.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",A));K.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",G));appChrome.api.dispatch(K);y=new h.a("GetHelpFromTellMe",4,y.zf,null,1)}else y=new h.a("bSearchHelp",4,y.zf,null,1);u.ls(y);u.displayName=CommonUIStrings.l_HelpButtonTitle;E.Uq(u)}x.resultsUpdated(E)}BTa(y,
x=null){const A=new e.a(8),E=v.a.RB(CommonUIStrings.l_HelpTooltip)===v.a.RB(y.zf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,y.zf);for(let K=0;K<x.length&&2>K;K++){var u=void 0;u=[];let G="GetHelpWithDescriptionFromTellMe"+(K+1).toString(),O=4;if(this.ub.qrc)u.push(appChrome.actions.setControlLabel(G,E)),u.push(appChrome.actions.setCompoundButtonCommandValueId(G,y.zf)),u.push(appChrome.actions.updateCompoundButtonDescription(G,this.eoj(x.length)));
else if(this.ub.rrc){let R=this.c9f(x[K]);G="GetHelpFromTellMe"+(K+1).toString();this.ub.iVa&&(R=this.W4f(R));O=9;u.push(appChrome.actions.setControlLabel(G,R));u.push(appChrome.actions.setButtonCommandValueId(G,this.coj(x[K])))}appChrome.api.dispatch(u);u=new h.a(G,O,null,null,0);u.label=this.c9f(x[K]);u.description=this.boj(x[K]);A.ls(u);if(this.ub.rrc)break}A.displayName=CommonUIStrings.l_HelpButtonTitle;return A}eoj(y){return 1===y?String.format(CommonUIStrings.l_SearchResultText,y):String.format(CommonUIStrings.l_SearchResultsText,
y)}W4f(y){return this.ub.Kme?n.a.V7d(y,CommonUIStrings.l_HelpScopedButtonText):y+CommonUIStrings.l_HelpScopedButtonText}c9f(y){return y.name?y.name:""}boj(y){return y.description?y.description:""}coj(y){return y.id?"AssetID="+y.id:""}}Object(J.a)(B,"AssistanceResultsProvider",null,[602])},988:function(J,aa,d){d.d(aa,"a",function(){return y});J=d(0);d(144);var h=d(156),e=d(171),r=d(170),n=d(117),v=d(104),B=d(305);class y{constructor(x){this.ub=x}$D(){return"Image"}pL(){return 0===this.ub.Aq?0:1===
this.ub.Aq?1:3===this.ub.Aq?3:2}iB(x,A,E,u,K=null){E=new r.a(x);(!K||Array.contains(K,19))&&v.a.MF(x)&&this.ub.QH&&this.BTa(x,E,1);A.resultsUpdated(E)}BTa(x,A,E,u=null){var K=[];let G;n.TellMeActor.instance.WG()&&n.TellMeActor.instance.WG().iVa?(G=this.ub.Kme?v.a.V7d(x.zf,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):x.zf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.ub.MYe||K.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):
G=this.ub.QH?v.a.MF(x)?this.ub.XPa?v.a.CSa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.ub.XPa?v.a.CSa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,x.zf)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,x.zf):this.ub.PMb?CommonUIStrings.l_TellMeImageSuggestionButtonText:x.zf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.ub.tda?(n.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
G)),K=v.a.PCa(x.zf,9,Object.assign(new B.a,{landingTab:"Image"})),n.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",K))):(K.push(appChrome.actions.setControlLabel("ImageForSearch",G)),x=v.a.PCa(x.zf,9,Object.assign(new B.a,{landingTab:"Image"})),K.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",x)),appChrome.api.dispatch(K));E=new h.a("ImageForSearch",12,null,null,E);u&&(E.score=u.ConfidenceScore);u=new e.a(19,this.ub.PMb?CommonUIStrings.l_TellMeImageTitleV2:
CommonUIStrings.l_TellMeImageTitle);u.ls(E);A.Uq(u)}}Object(J.a)(y,"ImageResultsProvider",null,[602])},989:function(J,aa,d){d.d(aa,"a",function(){return B});J=d(0);d(144);var h=d(156),e=d(171),r=d(170),n=d(104),v=d(27);class B{constructor(y){this.ub=y}$D(){return"Template"}pL(){return 0===this.ub.Aq?0:1===this.ub.Aq?1:3}iB(y,x){y=new r.a(y);x.resultsUpdated(y)}BTa(y,x,A){var E=[];let u;u=this.ub.QH?this.ub.XPa?n.a.CSa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,y.zf)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,
y.zf):String.format(CommonUIStrings.l_TellMeTemplateButtonText,y.zf);E.push(appChrome.actions.setControlLabel("TemplateForSearch",u));E.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(v.AFrameworkApplication.fa.Ga("TellMeTemplateProviderURL"),v.AFrameworkApplication.uiCulture,y.zf)));appChrome.api.dispatch(E);y=new e.a(23);y.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;E=new h.a("TemplateForSearch",24,null,null,0);E.label=A[0].Title?A[0].Title:"";E.description=
A[0].Description?A[0].Description:"";y.ls(E);x.Uq(y)}}Object(J.a)(B,"TemplateResultsProvider",null,[602])},990:function(J,aa,d){d.d(aa,"a",function(){return A});J=d(0);d(144);var h=d(335),e=d(156),r=d(171),n=d(170),v=d(698),B=d(117),y=d(104),x=d(47);class A{constructor(E,u,K,G){this.sS=E;this.pPa=u;this.Kqf=G;this.ESh=K;this.ub=B.TellMeActor.instance.WG()}$D(){return"EmptyQuery"}pL(){return 1===this.ub.Aq?1:0}iB(E,u,K=!1,G,O=null){G=new n.a(E);if((!O||Array.contains(O,5)||Array.contains(O,6)||Array.contains(O,
4))&&y.a.MF(E)){this.sS.G5b().length||!this.ESh||this.Kqf||(E=new r.a(6),O=new e.a(null,13,void 0,void 0,1),E.ls(O),G.Uq(E));E=new r.a(4);if(0<this.sS.G5b().length){E.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;O=this.sS.G5b();var R=[];for(var V of O)R.push(V.Id);h.CommandResultsUtility.mPb(R,this.ub);for(var D of O)h.CommandResultsUtility.I9b(D.Id)&&E.ls(new e.a(D.Id,5,null,null,2));G.Uq(E)}if(this.Kqf&&0<this.pPa.length&&this.sS.G5b().length<A.jZg){V=new r.a(5);V.displayName=CommonUIStrings.l_TellMeTryQueryTitle;
D=A.jZg-E.results.length;E=[];for(O=0;O<this.pPa.length&&O<D;++O){if(K){R=y.a.g4e+(O+1);const Q=this.pPa[O].key,Z=x.a.replaceAll(Q,'"',"");E.push(appChrome.actions.setControlLabel(R,Q));E.push(appChrome.actions.setButtonCommandValueId(R,Z));R=new v.a(Q,7,0,Z,R)}else R=new v.a(this.pPa[O].key,7,0,this.pPa[O].value);V.ls(R)}0<E.length&&appChrome.api.dispatch(E);G.Uq(V)}}u.resultsUpdated(G)}}A.jZg=5;Object(J.a)(A,"EmptyQueryResultsProvider",null,[602])},991:function(J,aa,d){d.d(aa,"a",function(){return h});
J=d(0);class h{constructor(){this.Rsd=this.Vta=this.bUa=this.ht=this.UIc=this.Jz=this.rmb=0}}Object(J.a)(h,"TRIESCAN",null,[])},992:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.Service=0]="Service";e[e.Local=1]="Local";e[e.MRU=2]="MRU";e[e.TestResult=3]="TestResult";e[e.Unknown=4]="Unknown"})(h||(h={}));Object(J.b)("SubResultType",h)}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.chronos1.js.map