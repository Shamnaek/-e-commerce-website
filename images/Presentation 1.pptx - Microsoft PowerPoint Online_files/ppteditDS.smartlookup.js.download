'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[12],{1246:function(J,aa,d){d.r(aa);var h=d(0),e=d(1203),r=d(1258),n=d(27),v=d(271),B=d(95),y=d(71),x=d(18);class A{constructor(fb){fb.Ja("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(h.a)(A,"DocumentContentExtractionManager",null,[742]);var E=d(387),u=d(14),K=d(1066);class G{}G.dql="mso_smartLookup";G.channelId="SmartLookup";G.cql="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";
G.kyh="https://uci.edog.cdn.office.net/mirrored/smartlookup/";G.lyh="https://uci.cdn.office.net/mirrored/smartlookup/";G.bql="https://hedwigtestserver.blob.core.windows.net/builds/";G.aql="http://localhost:8080/";G.gsc="current";G.jyh="next";G.QCk=2;G.whd=CommonUIStrings.L_SmartLookupPaneTitle;G.$Y="InsightsTaskPane";G.width=400;G.cCh="appCorrelationId";G.dCh="message";Object(h.a)(G,"InsightsConstants",null,[]);var O=d(942),R=d(172);class V{}Object(h.a)(V,"ActivityContractInfo",null,[]);class D{}
Object(h.a)(D,"BrowserPaneDataField",null,[]);class Q{}Object(h.a)(Q,"BrowserPaneTelemetryEvent",null,[]);var Z=d(142),P=d(57),ca=d(181),T=d(182);class da{static Xu(fb,Qb){const ac=new Q;ac.eventName="Diagnostics";ac.isActivity=!1;ac.activityContract=Object.assign(new V,{success:!0});const Jc=[],pd=new D;pd.name="Message";pd.dataType=0;pd.value=fb;fb=new D;fb.name="Level";fb.dataType=0;fb.value=da.Qcj(Qb);Array.add(Jc,pd);Array.add(Jc,fb);ac.dataFields=Jc;da.sendTelemetryEvent(ac)}static Bod(fb,Qb){const ac=
new Q;ac.eventName=fb;ac.isActivity=!1;ac.activityContract=Object.assign(new V,{success:!0});fb=[];const Jc=new D;Jc.name="AppCorrelationId";Jc.dataType=0;Jc.value=Qb;Array.add(fb,Jc);ac.dataFields=fb;da.sendTelemetryEvent(ac)}static w9k(fb,Qb,ac,Jc,pd,qd){const sd=new Q;sd.eventName="LaunchPaneWithError";sd.isActivity=!1;sd.activityContract=Object.assign(new V,{success:!0});const ze=[],Wd=new D;Wd.name="IsNetworkConnected";Wd.dataType=0;Wd.value=fb?"true":"false";fb=new D;fb.name="IsHostruntimeAvailable";
fb.dataType=0;fb.value=Qb?"true":"false";Qb=new D;Qb.name="EntryPoint";Qb.dataType=0;Qb.value=ac;ac=new D;ac.name="RuntimeVersion";ac.dataType=0;ac.value=Jc;Jc=new D;Jc.name="IsFirstRelease";Jc.dataType=1;Jc.value=pd?"true":"false";pd=new D;pd.name="IsZeroTerm";pd.dataType=1;pd.value=qd?"true":"false";qd=new D;qd.name="IsClientSideRendering";qd.dataType=1;qd.value="false";Array.add(ze,Wd);Array.add(ze,Qb);Array.add(ze,fb);Array.add(ze,ac);Array.add(ze,Jc);Array.add(ze,pd);Array.add(ze,qd);sd.dataFields=
ze;da.sendTelemetryEvent(sd)}static bVe(fb,Qb,ac){const Jc=new Q;Jc.eventName="CDNDownloadLatency";Jc.isActivity=!0;Jc.activityContract=Object.assign(new V,{duration:ac,success:!0});ac=[];const pd=new D;pd.name="CDNHostname";pd.dataType=0;pd.value=fb;fb=new D;fb.name="Filename";fb.dataType=0;fb.value=Qb;Array.add(ac,pd);Array.add(ac,fb);Jc.dataFields=ac;da.sendTelemetryEvent(Jc,1)}static hqc(fb,Qb,ac,Jc,pd,qd,sd,ze){const Wd=new Q;Wd.eventName="LaunchPane";Wd.isActivity=!0;Wd.activityContract=Object.assign(new V,
{duration:Qb,success:!0});Qb=[];const ye=new D;ye.name="AppCorrelationId";ye.dataType=0;ye.value=fb;fb=new D;fb.name="EntryPoint";fb.dataType=0;fb.value=ac;ac=new D;ac.name="IsServerSideRendering";ac.dataType=1;ac.value="true";const Yc=new D;Yc.name="UxVersion";Yc.dataType=0;Yc.value=Jc;Jc=new D;Jc.name="FeatureGates";Jc.dataType=0;Jc.value=pd;pd=new D;pd.name="IsFirstRelease";pd.dataType=1;pd.value=qd?"true":"false";qd=new D;qd.name="IsZeroTerm";qd.dataType=1;qd.value=sd?"true":"false";sd=new D;
sd.name="IsClientSideRendering";sd.dataType=1;sd.value=ze?"true":"false";Array.add(Qb,ye);Array.add(Qb,fb);Array.add(Qb,ac);Array.add(Qb,Yc);Array.add(Qb,Jc);Array.add(Qb,pd);Array.add(Qb,qd);Array.add(Qb,sd);Wd.dataFields=Qb;da.sendTelemetryEvent(Wd)}static sendTelemetryEvent(fb,Qb=2){if(fb.isFeedbackActivity)da.I3j(fb.eventName);else{var ac=-1<fb.eventName.indexOf(da.bCh)?fb.eventName:da.bCh+fb.eventName,Jc=da.J8i(fb.dataFields);fb.isActivity?(fb=Object.assign(new ca.a,{name:ac,samplingPolicy:Qb,
dataFields:Jc,succeeded:fb.activityContract.success,durationMs:fb.activityContract.duration}),Z.a.sendActivityEvent(fb)):(fb=Object.assign(new T.a,{name:ac,samplingPolicy:Qb,dataFields:Jc}),Z.a.sendTelemetryEvent(fb))}}static Qcj(fb){switch(fb){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static J8i(fb){const Qb=[];if(fb&&0<fb.length)for(const ac of fb)(fb=R.a.L8(ac.name,ac.value,da.$Bi(ac.dataType)))&&Array.add(Qb,fb);return Qb}static $Bi(fb){switch(fb){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static I3j(fb){const Qb=P.a.instance.rb("Common.ISystemInitiatedFeedback");Qb?Qb.logActivity(fb,null):E.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}da.bCh="Office.Insights.SmartLookup.";Object(h.a)(da,"TelemetryUtils",null,[]);var fa=d(539),ma=d(334),ea=d(447),ra=d(199),F=d(36),na=d(109);class ka{static EQ(fb,Qb,ac,Jc,pd,qd){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;if(pd.value.dll())return da.Xu("Skipping Serplet launch",
10),32;Qb=qd;if(!Qb)return 8;fb=ka.v9a();if(ac=Qb.CommandValueId)try{Qb=F.a(ac)}catch(sd){return E.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",ac),8}ac=Qb;Qb.selection||(Qb.neighborhood?ac=Object.assign(new ma.a,{selection:Qb}):(Qb=pd.value.Q9a(),ac.selection=Object.assign(new ea.a,{neighborhood:Qb.neighborhood,mentionStart:Qb.mentionStart,mentionLength:Qb.mentionLength})));ac.selection.clientDetectedLanguage=null;return ka.Avb(qd,null,ac,fb,
0,pd)}static Avb(fb,Qb,ac,Jc,pd,qd){const sd={};sd.controlId=fb?fb.SourceControlId:"shortcut";ac&&(sd.entryPoint=fa.a[ac.entryPoint]);E.ULS.sendTraceTag(594044172,1303,50,ka.Yja("Show insights",Jc,sd));Qb?qd.value.fnl(Qb,Jc,pd):ac&&(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?qd.value.Fll(ac,Jc):qd.value.gnl(ac,Jc,pd));return 32}static Yja(fb,Qb,ac=null){fb={["appCorrelationId"]:Qb,["message"]:fb};if(ac)for(let Jc in ac)fb[Jc]=ac[Jc];return F.c(fb)}static v9a(){return na.a.create().toString()}}
Object(h.a)(ka,"InvokingPaneUtils",null,[]);class Ua{}Object(h.a)(Ua,"LaunchDataInDoc",null,[]);class za{}Object(h.a)(za,"LaunchDataPasteAsSlide",null,[]);class ha{}Object(h.a)(ha,"LaunchDataSlidesCompression",null,[]);var ua=d(392),Ga=d(121),sa=d(70),Ba=d(305),pa=d(82),ia=d(65),Da=d(73),Xa=d(534),Ka=d(37);class Ma{constructor(fb,Qb,ac,Jc,pd,qd,sd,ze,Wd){this.URb=this.Czc=this.mo=null;this.Ry=fb;this.Ca=Qb||n.AFrameworkApplication.Ta;this.xK=ac;this.Od=Jc;this.zgf=ze;this.zOa=pd;this.$a=qd;this.$d=
sd;this.PFj();this.wha=new e.a(()=>new ua.a(Wd.value,Object(u.a)(this,this.kEa,"getMoreInfoEventReceived")))}wb(){this.Ca.ya(Ka.a.tIj,Da.a.frame,Object(u.a)(this,this.dnl,"showInsights"));this.Ca.ya(Ka.a.uIj,Da.a.frame,Object(u.a)(this,this.enl,"showInsightsForTellMe"));this.Ca.ya(Ka.a.definitions,Da.a.frame,Object(u.a)(this,this.jml,"showDefinitions"));this.Ca.ya(Ka.a.vLi,Da.a.frame,Object(u.a)(this,this.kml,"showDefinitionsForTellMe"));this.Ca.ya(Ka.a.nZe,Da.a.frame,Object(u.a)(this,this.nZe,"showInsightsForSuggestion"));
this.zgf&&(this.Ca.ya(Ka.a.FYc,Da.a.frame,Object(u.a)(this,this.EQ,"invokeSmartLookupPane")),this.Ca.ya(Ka.a.Iie,Da.a.frame,Object(u.a)(this,this.Iie,"invokeInDocSerplet")),this.Ca.ya(Ka.a.IYc,Da.a.frame,Object(u.a)(this,this.IYc,"invokeSerpletRibbon")),this.Ca.ya(Ka.a.HYc,Da.a.frame,Object(u.a)(this,this.HYc,"invokeSerpletContextMenu")),this.Ca.ya(Ka.a.Oie,Da.a.frame,Object(u.a)(this,this.Oie,"invokeSerpletTellMeZeroTerm")),this.Ca.ya(Ka.a.Nie,Da.a.frame,Object(u.a)(this,this.Nie,"invokeSerpletTellMeNotes")),
this.Ca.ya(Ka.a.Hie,Da.a.frame,Object(u.a)(this,this.Hie,"invokeImageSerpletContextMenu")),this.Ca.ya(Ka.a.KYc,Da.a.frame,Object(u.a)(this,this.KYc,"invokeSynonymsSerpletContextMenu")),this.Ca.ya(Ka.a.Fie,Da.a.frame,Object(u.a)(this,this.Fie,"invokeDictionarySerpletContextMenu")),this.Ca.ya(Ka.a.Pie,Da.a.frame,Object(u.a)(this,this.Pie,"invokeZeroTermSerpletContextMenu")),this.Ca.ya(Ka.a.Eie,Da.a.frame,Object(u.a)(this,this.Eie,"invokeDefinitionSearchFromFloatie")),this.Ca.ya(Ka.a.GYc,Da.a.frame,
Object(u.a)(this,this.GYc,"invokeSerpletBrowseFiles")),this.Ca.ya(Ka.a.Jie,Da.a.frame,Object(u.a)(this,this.Jie,"invokeInDocSerpletWithLaunchData")),this.Ca.ya(Ka.a.pPe,Da.a.frame,Object(u.a)(this,this.pPe,"queryToggleSerplet")),this.Ca.ya(Ka.a.jWe,Da.a.frame,Object(u.a)(this,this.jWe,"setInDocSearchParameter")),this.Ca.ya(Ka.a.JYc,Da.a.frame,Object(u.a)(this,this.JYc,"invokeSerpletSlidesCompression")),this.Ca.ya(Ka.a.Mie,Da.a.frame,Object(u.a)(this,this.Mie,"invokeSerpletPasteAsNewSlide")),n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.Ca.ya(Ka.a.AJj,Da.a.frame,Object(u.a)(this,this.CJj,"invokeSmartLookupPaneConversations")),this.Ca.ya(Ka.a.Die,Da.a.frame,Object(u.a)(this,this.Die,"invokeAutoLaunchSearchRequest"))),this.AVk().continueWith(()=>{n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.updateCommandUI(!0)}))}gtf(){this.Ca.ra(Ka.a.Zyb,Da.a.frame,Object(u.a)(this,this.Zyb,"invokeFilesSerplet"),4);this.Ca.ra(Ka.a.Kgg,Da.a.frame,Object(u.a)(this,this.Zyb,"invokeFilesSerplet"),4);this.Ca.ra(Ka.a.Mgg,Da.a.frame,
Object(u.a)(this,this.rJj,"invokeLinkFilesSerplet"),4);if(this.$a.ka("IsTellMeUpSellEnterpriseEnabled")&&this.$a.ka("SmartLookupTokenPrefetchIsEnabled")){const fb=pa.a.mMc(0,Object(u.a)(this,this.fch,"prefetchToken"),0,177);this.$d.Db(fb)}}FPd(){sa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.Ca.ya(Ka.a.Zyb,Da.a.frame,Object(u.a)(this,this.Gie,"invokeFilesSerpletUnavailable")),this.Ca.ya(Ka.a.Kgg,Da.a.frame,Object(u.a)(this,
this.Gie,"invokeFilesSerpletUnavailable")),this.Ca.ya(Ka.a.Mgg,Da.a.frame,Object(u.a)(this,this.Gie,"invokeFilesSerpletUnavailable")))}fch(fb){E.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",fb.interval,!!fb.data);this.$Ob().then(Qb=>{let ac=1;if(Qb)E.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.mVe("SmartLookupFiles: Token prefetch succeeded",!0),Qb=6E4*this.$a.Bc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{E.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.mVe("SmartLookupFiles: Token prefetch failed",!1);ac=parseInt(fb.data||"1");if(ac>this.$a.Bc("SmartLookupTokenRenewalRetryThreshold",5)){E.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.mVe("SmartLookupFiles: Token prefetch max retry count reached",!1);return}Qb=6E4*this.$a.Bc("SmartLookupTokenRetryWaitDurationInMinutes",10);ac++}Qb=new pa.a(3,1,Qb,Object(u.a)(this,
this.fch,"prefetchToken"),177);Qb.data=ac.toString();this.$d.Db(Qb)})}mVe(fb="",Qb=!1){this.zOa.execute(ac=>{ac&&ac.W_a("PrefetchToken",Qb,0,"SmartLookup",fb)})}$Ob(){return this.zOa?new Promise(fb=>{this.zOa.execute(Qb=>{if(Qb){var ac=Date.now();Qb.getToken("SmartLookup",this.$a.Ga("SmartLookupShredderServiceEndpoint")).then(Jc=>{fb(!!Jc&&0<Jc.length);Qb.W_a("TryGetTokenInternal",!!Jc&&0<Jc.length,Date.now()-ac,"SmartLookup")})}else fb(!1)})}):Promise.resolve(!1)}AVk(){const fb=new K.a;if(this.$a.ka("BrowserSupportsInsightsPaneSSO"))this.gtf(),
fb.Kg(!0);else{if(!this.zOa)return E.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),fb.Kg(!1),this.FPd(),fb.task;this.zOa.execute(Qb=>{Qb?Qb.getToken("SmartLookup",this.$a.Ga("SmartLookupShredderServiceEndpoint")).then(ac=>{E.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!ac&&0<ac.length);ac&&0<ac.length?(this.gtf(),fb.Kg(!0)):this.FPd()}):(E.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),fb.Kg(!1),this.FPd())})}return fb.task}dnl(fb,Qb,ac,Jc,pd){if(1===
ac)return n.AFrameworkApplication.Aa&&n.AFrameworkApplication.fa.ka("OneNoteDelayLoadContextActivationManager")&&!n.AFrameworkApplication.d1b?8:this.Ry.value.okg()?32:8;fb=ka.v9a();Qb=this.Ry.value.Q9a();return this.zgf?(Qb=Object.assign(new ea.a,{neighborhood:Qb.neighborhood,mentionStart:Qb.mentionStart,mentionLength:Qb.mentionLength}),Qb=Object.assign(new ma.a,{selection:Qb,userIntent:null,entryPoint:0,launchData:Object.assign(new Ba.a,{landingTab:"All"})}),ka.Avb(pd,null,Qb,fb,0,this.Ry)):ka.Avb(pd,
Qb,null,fb,0,this.Ry)}jml(fb,Qb,ac,Jc,pd){if(1===ac)return this.Ry.value.okg()?32:8;fb=ka.v9a();Qb=this.Ry.value.Q9a();return ka.Avb(pd,Qb,null,fb,1,this.Ry)}enl(fb,Qb,ac,Jc,pd){return 1===ac?32:this.uUf(pd,0)}kml(fb,Qb,ac,Jc,pd){return 1===ac?32:this.uUf(pd,1)}uUf(fb,Qb){const ac=ka.v9a(),Jc=fb.CommandValueId;let pd;try{pd=F.a(Jc)}catch(qd){return E.ULS.sendTraceTag(6295941,1303,15,ka.Yja(String.format("Insights parameters [{0}] is not in proper format.",Jc),ac)),8}return ka.Avb(fb,pd,null,ac,Qb,
this.Ry)}nZe(fb,Qb,ac,Jc,pd){if(1===ac)return 32;if(!pd)return 8;fb=pd.query?pd.query:"";Qb=ka.v9a();ac=new O.a;ac.neighborhood=fb;ac.mentionStart=0;ac.mentionLength=fb.length;return ka.Avb(pd,ac,null,Qb,0,this.Ry)}rJj(fb,Qb,ac,Jc){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;const pd=n.AFrameworkApplication.fa.ka("InsertFileLinkSerpletIsEnabled"),qd=this.Ry.value.USa();return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:qd.neighborhood,mentionStart:0,
mentionLength:0}),launchData:Object.assign(new Ba.a,{landingTab:"File"}),entryPoint:pd?32:10}))}Zyb(fb,Qb,ac,Jc){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;const pd=n.AFrameworkApplication.fa.ka("InvokeReuseSlidesSerpletIsEnabled"),qd=this.Ry.value.USa();return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:qd.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Ba.a,{landingTab:pd?"Slide":"File"}),entryPoint:pd?20:10}))}Gie(){return 2}Iie(fb,
Qb,ac,Jc,pd){if(1===ac)return ra.SessionStatusManager.instance.Aka?8:32;const qd=this.Ry.value.USa();pd=void 0===pd||null===pd?18:19;return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:qd.neighborhood,mentionStart:qd.mentionStart,mentionLength:qd.mentionLength}),launchData:Object.assign(new Ba.a,{landingTab:"Indoc"}),entryPoint:pd}))}Jie(fb,Qb,ac,Jc,pd){pd=pd.CommandValueId;if(!pd||pd&&this.URb&&pd.query===this.URb.query&&pd.matchCase===this.URb.matchCase&&
pd.matchWholeWordOnly===this.URb.matchWholeWordOnly)return 32;const qd=this.Ry.value.USa();return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:qd.neighborhood,mentionStart:qd.mentionStart,mentionLength:qd.mentionLength}),launchData:Object.assign(new Ba.a,{landingTab:"Indoc",data:Object.assign(new Ua,{type:4,query:pd.query,matchCase:pd.matchCase,matchWholeWord:pd.matchWholeWordOnly})}),entryPoint:18}))}pPe(fb,Qb,ac,Jc,pd){pd&&(pd[Xa.a.On]=this.Ry.value.H$b);
return 32}jWe(fb,Qb,ac,Jc,pd){if(fb=pd.CommandValueId)this.URb=fb;return 32}CJj(fb,Qb,ac){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;fb=this.Ry.value.USa();fb=Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:fb.neighborhood,mentionStart:fb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Ba.a,{landingTab:"All"})});this.Ry.value.foe(fb);return 32}Die(fb,Qb,ac){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;fb=this.Ry.value.USa();
fb=Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:fb.neighborhood,mentionStart:fb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Ba.a,{landingTab:"All",data:n.AFrameworkApplication.zRa})});Qb=ka.v9a();this.Ry.value.Dod(fb,Qb);return 32}IYc(fb,Qb,ac,Jc){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;const pd=this.Ry.value.Ybj();return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:pd.neighborhood,
mentionStart:pd.mentionStart,mentionLength:pd.mentionLength}),entryPoint:4,launchData:Object.assign(new Ba.a,{landingTab:"All"})}))}HYc(fb,Qb,ac,Jc){return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{entryPoint:5,launchData:Object.assign(new Ba.a,{landingTab:"All"})}))}Oie(fb,Qb,ac,Jc){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;const pd=this.Ry.value.USa();return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:pd.neighborhood,mentionStart:pd.mentionStart,
mentionLength:0}),launchData:Object.assign(new Ba.a,{landingTab:"All"}),entryPoint:26}))}Fie(fb,Qb,ac,Jc){return 1===ac?(fb=this.Ry.value.Q9a())&&0<fb.mentionLength?32:8:this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{entryPoint:22,launchData:Object.assign(new Ba.a,{landingTab:"All"})}))}Eie(fb,Qb,ac,Jc){return 1===ac?(fb=this.Ry.value.Q9a())&&0<fb.mentionLength?32:8:this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{entryPoint:7,launchData:Object.assign(new Ba.a,{landingTab:"All"})}))}Hie(fb,Qb,ac,Jc){return this.EQ(fb,
Qb,ac,Jc,Object.assign(new ma.a,{launchData:Object.assign(new Ba.a,{landingTab:"Image"}),entryPoint:9}))}KYc(fb,Qb,ac,Jc){return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{launchData:Object.assign(new Ba.a,{landingTab:"All"}),entryPoint:24}))}Nie(fb,Qb,ac,Jc){return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{launchData:Object.assign(new Ba.a,{landingTab:"Notes"}),entryPoint:33}))}Pie(fb,Qb,ac,Jc){if(1===ac)return ra.SessionStatusManager.instance.J_?32:8;const pd=this.Ry.value.USa();return this.EQ(fb,
Qb,ac,Jc,Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:pd.neighborhood,mentionStart:pd.mentionStart,mentionLength:0}),launchData:Object.assign(new Ba.a,{landingTab:"All"}),entryPoint:27}))}JYc(fb,Qb,ac,Jc,pd){if(!pd)return 8;const qd=pd.url;pd=pd.selectedSlideIDs;return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{launchData:Object.assign(new Ba.a,{landingTab:"All",data:Object.assign(new ha,{type:6,url:qd,selectedSlideIDs:pd})}),entryPoint:37}))}Mie(fb,Qb,ac,Jc,pd){if(!pd)return 8;
const qd=pd.Selection;pd=pd.CurrentDocTitle;return this.EQ(fb,Qb,ac,Jc,Object.assign(new ma.a,{launchData:Object.assign(new Ba.a,{landingTab:"All",data:Object.assign(new za,{type:5,selection:qd,currentDocTitle:pd})}),entryPoint:36}))}EQ(fb,Qb,ac,Jc,pd){return ka.EQ(fb,Qb,ac,Jc,this.Ry,pd)}GYc(fb,Qb,ac){if(1===ac)return 32;this.mo||this.wha.value.pda("Browse File from Search pane",!0);if(!this.Czc||""===this.Czc)return E.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),
8;ia.a.vn(this.Czc,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}kEa(fb){this.mo||3!==fb.state||(this.mo=fb,this.Czc=this.mo.DR)}PFj(){const fb=this.Od.Fc(G.$Y);fb.parent=Ga.AFrame.hj;fb.Q7(Object(u.a)(this,this.gVe,"sendIFrameTakeFocusMessage"));this.xK.yia(G.$Y)}gVe(){document.activeElement.blur();n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.hb.iX||(this.Ry.value.YVe(),this.Ry.value.t9k())}dispose(){this.Ry.value&&this.Ry.value.dispose()}}Object(h.a)(Ma,"InsightsActor",null,[106]);
var Oa=d(1204),qa=d(694),Ya=d(55),Fb=d(270),hc=d(47);const ec=fb=>{fb=fb.split("-");return fb[fb.length-1]},Tb=fb=>18===fb||19===fb||15===fb,vb=()=>{var fb=Va();if(fb)return Promise.resolve(fb);fb=Pa().replace("SearchWeb","searchweb");fb=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?fb+G.jyh+"/":fb+G.gsc+"/";fb+="version.json";if(Ya.a.px)return zb(fb);try{const Qb=new Sys.Net.WebRequest;Qb.set_httpVerb("GET");Qb.set_url(fb);fb={};
fb.method=Qb.get_httpVerb();return"function"!==typeof window.fetch?(da.Xu("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(Qb.getResolvedUrl(),fb).then(ac=>ac.json()).catch(()=>{da.Xu("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(ac=>{ac=F.b(JSON.stringify(ac));return ac.version?ac.version:""},ac=>{da.Xu("InsightsUtils - Failed to deserialize version: "+ac.toString(),10);E.ULS.sendTraceTag(591971029,
1303,15,"Insights: Failed to deserialize version: "+ac.toString());return""}).then(ac=>ac)}catch(Qb){return da.Xu("InsightsUtils - Failed to download version.json: "+Qb.toString(),10),E.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+Qb.toString()),Promise.resolve("")}},zb=fb=>{const Qb=n.AFrameworkApplication.Ke;return new Promise(ac=>{const Jc=new qa.a(fb,1,null,null,!0,2,null);Qb.send(Jc).hKb(pd=>{pd&&pd.data?pd.data.Wd||(da.Xu("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
pd.data.ie,10),ac("")):(da.Xu("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),ac(""));try{const qd=F.b(pd.data.Wd);qd.version&&ac(qd.version)}catch(qd){da.Xu("InsightsUtils - Failed to deserialize version: "+qd.toString(),10),ac("")}},pd=>{pd&&pd.data?da.Xu("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+pd.data.ie,10):da.Xu("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);ac("")})})},Xb=()=>n.AFrameworkApplication.fa.ka("SmartLookupEnableLocalOverride")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),Za=()=>{const fb=Pa();return Xb()||n.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion")?fb+Va()+"/":n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?fb+G.jyh:fb+G.gsc},Va=()=>Xb()?"dev":n.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion")?
n.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion").split("/")[1]:n.AFrameworkApplication.fa.Ga("SmartLookupClientVersion"),tc=fb=>{var Qb=3===n.AFrameworkApplication.Aa.hb.Uk?"wordwac":2===n.AFrameworkApplication.Aa.hb.Uk?"pptwac":"excelwac";var ac=Fb.a.xe(n.AFrameworkApplication.lcid);const Jc=ac?ac.name:"en-us";ac=Pa();const pd=qc();Qb="main_ssr_wac.html?appName="+Qb+"&culture="+Jc;return"LOCAL"===pd?ac+Qb:ac+((""!==fb?fb:G.gsc)+"/")+Qb},Kb=fb=>Pa()+(""!==fb?fb:G.gsc)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
Pa=()=>{switch(qc()){case "LOCAL":return G.aql;case "PR":const fb=n.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion").split("/");return G.bql+fb[0]+"/";case "INT":return G.cql;case "EDOG":return G.kyh;default:return G.lyh}},mb=()=>{if(!n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(qc()){case "EDOG":return G.kyh;case "PROD":return G.lyh;default:return""}},qc=()=>{if(n.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")||
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(n.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(n.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(n.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion")&&n.AFrameworkApplication.fa.Ga("SmartLookupPRIntentSvc"))return"PR";if(Xb())return"LOCAL";switch(Object(Oa.a)(String,n.AFrameworkApplication.gd.AudienceGroup)||""){case "Dogfood":if(n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let fb=n.AFrameworkApplication.fa.Ga("UserPrincipalName");fb=hc.a.rg(fb);const Qb=n.AFrameworkApplication.fa.Eu("SmartLookupINTEnabledForSKITeam")?
n.AFrameworkApplication.fa.YA("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(Qb,fb))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},oc=()=>{let fb;fb=n.AFrameworkApplication.fa.ka("IntentSvcEnableEdogSourceLocationOverride")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":n.AFrameworkApplication.fa.ka("IntentSvcEnableProdSourceLocationOverride")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":n.AFrameworkApplication.fa.ka("IntentSvcEnableIntSourceLocationOverride")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":qc();const Qb=n.AFrameworkApplication.fa.Ga("IntentServiceEndpoint"),ac=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===fb&&""!==Qb)return Qb+"searchendpointv2/";switch(fb){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return n.AFrameworkApplication.fa.Ga("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(ac?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(ac?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class ib{sendTelemetryEvent(fb){da.sendTelemetryEvent(fb)}}
Object(h.a)(ib,"OtelTelemetrySink",null,[783]);class $a{}Object(h.a)($a,"ApplicationProperties",null,[]);class Db{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(h.a)(Db,"CurrentDocumentProperties",null,[]);class Mb{}Object(h.a)(Mb,"EnterpriseUserInfo",null,[]);class ob{}Object(h.a)(ob,"FeatureGates",null,[]);var jc=d(81);class Gb{constructor(fb,Qb){this.hq=this.kh=null;this.ICg=!0;this.Q5a=Qb;this.tG=fb;this.tG.execute(ac=>{ac.isFeatureEnabled("mso_sendASmile",
!0).then(Jc=>{this.ICg=Jc}).catch(Jc=>{da.Xu("SearchHelper - Failed to check if Feedback feature is enabled: "+Jc.toString(),15)})});fb=oc();Qb=n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(n.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")){this.hq={};const ac=this.Ujj();if(ac&&0<ac.length)for(let Jc=0;Jc<ac.length;Jc++){const pd=ac[Jc],qd=this.Kkj(pd);
switch(qd.toLowerCase()){case "true":this.hq[pd]=!0;break;case "false":this.hq[pd]=!1;break;default:this.hq[pd]=qd}}this.hq.EnableInDocumentSearch=Qb;this.hq.EnableInDocumentSearchReplace=!0;this.hq.EnableInDocumentParamLocalSearch=!0;this.hq.EnableInDocumentQuerySuggest=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.hq.EnableInDocumentQuestionGeneration=
Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.hq.EnableInDocumentGlobalEncoder=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentGlobalEncoder")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.hq.EnableInDocumentExperiment1=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.hq.EnableInDocumentExperiment2=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.hq.EnableInDocumentExperiment3=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",
!1);this.hq.EnableZeroTermAutoRefresh=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.hq.EnableTap3SZeroTerm=n.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.hq.EnableLocalSearch=!0;this.hq.EnableInDocumentStickyFilters=!0;this.hq.IntentServiceEndpoint=fb;this.hq.EnablePDFShredding=n.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.hq.FilterNonPPTFilesForReuseSlides=n.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides");this.hq.UXBundleVersion=Va();this.hq.SmartLookupServicePath=Za();this.hq.EnableAcronymSearch=!0;this.hq.UseAltAnswerEndpoint1=n.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",
!1);this.hq.UseAltAnswerEndpoint2=n.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.hq.UseAltAnswerEndpoint3=n.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.hq.UseNextUXVersion=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1);this.hq.IgnoreNeighborhoodContext=n.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.hq.ShowDebugInfo="INT"===qc();this.hq.DebugCommands=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.hq.ChangeGates=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.hq.QnaInMixSection=!0;this.hq.EnableNoteSearch=n.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.hq.EnableWikiL2=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.hq.EnableFilteringOutRedundantKPE=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.hq.EnableZeroTermEntitySuggestion=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",
!1);this.hq.RankingModels=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.hq.EnableClientSideRendering=!0}else this.kh=new ob,this.kh.EnableInDocumentSearch=Qb,this.kh.EnableInDocumentSearchReplace=!0,this.kh.EnableInDocumentParamLocalSearch=!0,this.kh.EnableInDocumentQuerySuggest=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1),this.kh.EnableInDocumentQuestionGeneration=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.kh.EnableInDocumentGlobalEncoder=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentGlobalEncoder")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",
!1),this.kh.EnableInDocumentExperiment1=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.kh.EnableInDocumentExperiment2=Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.kh.EnableInDocumentExperiment3=
Qb&&n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.kh.EnableZeroTermAutoRefresh=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.kh.EnableTap3SZeroTerm=n.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.kh.EnableLocalSearch=!0,this.kh.EnableInDocumentStickyFilters=!0,this.kh.IntentServiceEndpoint=fb,this.kh.EnablePDFShredding=n.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.kh.FilterNonPPTFilesForReuseSlides=n.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides"),this.kh.UXBundleVersion=Va(),this.kh.SmartLookupServicePath=
Za(),this.kh.EnableAcronymSearch=!0,this.kh.UseAltAnswerEndpoint1=n.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.kh.UseAltAnswerEndpoint2=n.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.kh.UseAltAnswerEndpoint3=n.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.kh.UseNextUXVersion=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.kh.IgnoreNeighborhoodContext=n.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.kh.ShowDebugInfo="INT"===qc(),this.kh.DebugCommands=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.kh.ChangeGates=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.kh.QnaInMixSection=!0,this.kh.EnableNoteSearch=n.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.kh.EnableWikiL2=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),
this.kh.EnableFilteringOutRedundantKPE=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.kh.EnableZeroTermEntitySuggestion=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.kh.RankingModels=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.kh.EnableClientSideRendering=!0,this.kh.SharedSerpletFeatureGate1=
n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.kh.SharedSerpletFeatureGate2=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.kh.SharedSerpletFeatureGate3=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.kh.SharedSerpletFeatureGate4=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",
!1),this.kh.SharedSerpletFeatureGate5=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.kh.SharedSerpletFeatureGate6=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.kh.SharedSerpletFeatureGate7=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.kh.SharedSerpletFeatureGate8=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",
!1),this.kh.SharedSerpletFeatureGate9=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.kh.SharedSerpletFeatureGate10=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.kh.SharedSerpletFeatureGate11=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.kh.SharedSerpletFeatureGate12=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",
!1),this.kh.SharedSerpletFeatureGate13=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.kh.SharedSerpletFeatureGate14=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.kh.SharedSerpletFeatureGate15=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.kh.SharedSerpletFeatureGate16=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",
!1),this.kh.SharedSerpletFeatureGate17=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.kh.SharedSerpletFeatureGate18=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.kh.SharedSerpletFeatureGate19=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.kh.SharedSerpletFeatureGate20=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",
!1),this.kh.SharedSerpletFeatureGate21=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.kh.SharedSerpletFeatureGate22=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.kh.SharedSerpletFeatureGate23=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.kh.SharedSerpletFeatureGate24=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",
!1),this.kh.SharedSerpletFeatureGate25=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.kh.SharedSerpletFeatureGate26=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.kh.SharedSerpletFeatureGate27=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.kh.SharedSerpletFeatureGate28=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",
!1),this.kh.SharedSerpletFeatureGate29=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.kh.SharedSerpletFeatureGate30=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.kh.SharedSerpletFeatureGate31=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.kh.SharedSerpletFeatureGate32=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1),this.kh.SharedSerpletFeatureGate33=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.kh.SharedSerpletFeatureGate34=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.kh.SharedSerpletFeatureGate35=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.kh.SharedSerpletFeatureGate36=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",
!1),this.kh.SharedSerpletFeatureGate37=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.kh.SharedSerpletFeatureGate38=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.kh.SharedSerpletFeatureGate39=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.kh.SharedSerpletFeatureGate40=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",
!1);this.SUb=P.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.Afb=!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.Mec=Gb.isEnterpriseUser();this.Ohc=n.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint");this.Vik=jc.a.YD(n.AFrameworkApplication.fa.Ga("AppCatalogUrl")||"");this.Ojk=n.AFrameworkApplication.fa.Ga("UserPrincipalName");(this.Mec||this.Afb)&&this.s7f()}Kkj(fb){return n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline."+
fb,"")}Ujj(){const fb=n.AFrameworkApplication.fa.IQc,Qb=n.AFrameworkApplication.fa.YA("SmartLookupFlightKeywordList"),ac=[];if(fb&&Qb&&0<Qb.length)for(let pd in fb){var Jc={key:pd,value:fb[pd]};Jc=Jc&&Jc.key?Jc.key:"";for(let qd=0;qd<Qb.length;qd++)if(-1<Jc.toLowerCase().indexOf(Qb[qd].toLowerCase())){const sd=Jc.split(".");sd&&4===sd.length&&Array.add(ac,sd[sd.length-1])}}return ac}M6b(fb,Qb,ac,Jc){return new Promise(pd=>{this.nWj().then(qd=>{const sd=new $a;sd.anid="";sd.applicationName=3===n.AFrameworkApplication.Aa.hb.Uk?
"WORD":"POWERPNT";sd.applicationVersion=n.AFrameworkApplication.buildVersion;sd.appCorrelationId=fb?fb:ka.v9a();sd.themePlatform="web";sd.lcid=n.AFrameworkApplication.lcid;sd.launchUtcTime=(new Date).toUTCString();n.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?sd.featureGates=F.c(this.hq):sd.featureGates=F.c(this.kh);var ze=Fb.a.xe(n.AFrameworkApplication.lcid);ze=ze?ze.name:null;sd.market=ec(ze);sd.uiLanguage=ze;sd.sessionId=n.AFrameworkApplication.userSessionId;sd.themeId=ac;sd.parentalControl=
"yes";sd.processorOnlyMode=qd;sd.isEditingAllowed=Qb.isEditingAllowed();sd.isFeedbackEnabled=this.ICg;sd.isClientSideRendering=Tb(Jc);sd.disableClipboard=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&n.AFrameworkApplication.iG&&!n.AFrameworkApplication.ORa;sd.accessToken=this.Mec||this.Afb?this.s7f():"";qd=new Mb;qd.CountryCode=ec(ze);qd.ServiceEndpoint=this.Ohc;qd.IsGoLocal=n.AFrameworkApplication.fa.ka("IsGoLocalEnvironment");
qd.IsEnabled=this.Mec;qd.IsEnterpriseEnabled=this.Mec;qd.TenantRoot=this.Vik;qd.Upn=this.Ojk;ze=qc();qd.IsEUDB="PROD"===ze&&""!==n.AFrameworkApplication.fa.Ga("IntentServiceEndpoint");sd.enterpriseUserInfo=qd;qd=new Db;qd.filePath=n.AFrameworkApplication.fa.Ga("EditDocInClientUrl");qd.docName=n.AFrameworkApplication.fa.Ga("FileName");qd.author=99!==Jc?Qb.author():null;qd.createdDate=99!==Jc?Qb.createdDate():null;sd.currentDocument=qd;pd(sd)})})}nWj(){return new Promise(fb=>{this.tG?this.tG.execute(Qb=>
{Qb.isFeatureEnabled(G.dql,!0).then(ac=>{fb(!ac)}).catch(ac=>{da.Xu("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+ac.toString(),10);fb(!0)})}):fb(!0)})}gah(fb){this.SUb&&(this.Mec||this.Afb)&&this.Jae(this.Ohc).then(Qb=>{fb(Qb)})}s7f(){if("Dev Box"===n.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const fb=
this.Afb?"Search":"SmartLookup";return this.SUb?this.SUb.Tnj(fb,this.Ohc,this.Afb):""}Jae(fb){if("Dev Box"===n.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(ac=>{ac(window.SearchPaneShredderTokenOverride)});const Qb=this.Afb?"Search":"SmartLookup";return this.SUb?this.SUb.getToken(Qb,fb,this.Afb):Promise.resolve("")}n$a(){return this.Q5a?this.Q5a.getVersion():""}q2f(){return n.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?
F.c(this.hq):F.c(this.kh)}static isEnterpriseUser(){const fb=n.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"),Qb=n.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");return(!fb||!fb.length)&&Qb}}Object(h.a)(Gb,"SearchHelper",null,[743]);class Gc{constructor(){Gc.Ka=""}getVersion(){return Gc.Ka}ygl(fb){Gc.Ka=fb}}Gc.Ka=null;Object(h.a)(Gc,"SmartLookupVersion",null,[]);class bc{}Object(h.a)(bc,"ConfigurationProvider",null,[]);class dc{constructor(fb){dc.Ka=fb}h8d(){return dc.Ka}}
dc.Ka=null;Object(h.a)(dc,"SearchHostRuntime",null,[]);var Nb=d(134),Ac=d(240),jb=d(284),Vb=d(291);class Tc{constructor(){this.BK=this.Omb=this.Da=null}get name(){return"Common.App.Insights"}Zb(fb){this.Da=fb;const Qb=Vb.a.av(P.a.instance.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>")),ac=n.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||n.AFrameworkApplication.fa.ka("SmartLookupIsEnabled");fb.register(Ma,"Common.App.Insights.InsightsActor").ma().oa(()=>new Ma(fb.ke("Common.App.Insights.IInsightsManager"),
n.AFrameworkApplication.Ta,v.a.instance,B.FocusManager.instance(),fb.Ja("Common.App.SearchCommon.ISearchOAuthManager"),n.AFrameworkApplication.fa,Nb.a.instance,ac,new e.a(()=>Qb.result)));fb.register(742,"Common.App.Insights.IDocumentContentExtractionManager").ma().oa(()=>new A(fb));ac&&(fb.register(Gc,"Common.App.Insights.SmartLookupVersion").ma().oa(()=>new Gc),fb.register(743,"Common.App.SearchCommon.ISearchHelper").ma().oa(()=>new Gb(P.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
fb.rb("Common.App.Insights.SmartLookupVersion"))))}init(){n.AFrameworkApplication.bFa&&(this.Omb=this.Da.rb("Common.App.Insights.InsightsActor"),this.Omb.wb())}eQi(){this.EIj()}EIj(){vb().then(fb=>{if(""!==fb){const Qb=this.Da.rb("Common.App.Insights.SmartLookupVersion");Qb&&Qb.ygl(fb)}this.rOc();this.Omb=this.Da.resolve("Common.App.Insights.InsightsActor");fb=Kb(fb);fb=jb.a.create(fb);fb.HS((Qb,ac)=>{ac.succeeded?this.lhl()&&this.prefetchZeroTerm():da.Xu("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
ac.Bt,10);this.Omb.wb()});Ac.a.fy(fb)})}lhl(){const fb=Object.assign(new bc,{channelId:G.channelId,approvedOriginPattern:Xb()?"^(http)?://(localhost:8080)$":n.AFrameworkApplication.fa.Ga("SmartLookupApprovedOriginPattern")});var Qb=this.Da.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const ac=this.Da.resolve("Common.App.SearchCommon.ISerpletExecutor"),Jc=this.Da.resolve("Common.App.SearchCommon.IInsertContentExecutor"),pd=new x.a;Qb&&pd.add(Qb);ac&&pd.add(ac);Jc&&pd.add(Jc);Qb=oc();
try{const qd=new ib,sd=SmartLookupHostRuntime.setup(fb,pd.toArray(),!0,Qb,qd);this.Da.register(dc,"Common.App.SearchCommon.SearchHostRuntime").ma().oa(()=>new dc(sd));return!0}catch(qd){return da.Xu("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+qd,10),!1}}prefetchZeroTerm(){if(n.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)){var fb=P.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime");if(fb){const Qb=this.Da.resolve("Common.App.SearchCommon.ISearchHelper"),ac=this.Da.resolve("Common.App.SearchCommon.IDocumentHelper");Qb.M6b(null,ac,0,99).then(Jc=>{fb.h8d().prefetchZeroTerm(Jc,n.AFrameworkApplication.userSessionId,Za(),!0,"Indoc",null)})}else da.Xu("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}rOc(){var fb=this.Da.resolve("Common.App.SearchCommon.ISearchHelper");
const Qb=tc(fb.n$a());fb=fb.n$a();fb=Pa()+(""!==fb?fb:G.gsc)+"/scripts/microsoft.office.smartlookup.ssr.js";const ac=mb();Ya.a.px?this.dQi(Qb,fb):(this.bQi(Qb,ac),this.cQi(fb,ac))}bQi(fb,Qb){const ac=new Sys.Net.WebRequest;ac.set_httpVerb("GET");const Jc={};Jc.method=ac.get_httpVerb();ac.set_url(fb);const pd=(new Date).getTime();try{window.fetch(ac.getResolvedUrl(),Jc).then(()=>{""!==Qb&&da.bVe(Qb,fb,(new Date).getTime()-pd);this.Da.rb("Common.App.Insights.SmartLookupVersion")})}catch(qd){da.Xu("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
qd.toString(),10)}}cQi(fb,Qb){var ac=new Sys.Net.WebRequest;ac.set_httpVerb("GET");const Jc={};Jc.method=ac.get_httpVerb();ac.set_url(fb);let pd=-1;if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))ac=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Nb.a.instance.Db(new pa.a(5,1,ac,()=>{const qd=jb.a.create(fb);qd.Puf(()=>{pd=Date.now()});qd.HS((sd,ze)=>{ze.succeeded?""!==
Qb&&da.bVe(Qb,fb,Date.now()-pd):da.Xu("InsightsPackage - Failed to prefetch JS file.",10)});Ac.a.fy(qd)}));else{pd=Date.now();try{window.fetch(ac.getResolvedUrl(),Jc).then(()=>{""!==Qb&&da.bVe(Qb,fb,Date.now()-pd)})}catch(qd){da.Xu("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+qd.toString(),10)}}}dQi(fb,Qb){if(Ya.a.px){var ac=n.AFrameworkApplication.Ke;fb=new qa.a(fb,1,null,null,!0,2,null);ac.send(fb).hKb(Jc=>{Jc&&Jc.data?Jc.data.Wd?this.Da.rb("Common.App.Insights.SmartLookupVersion"):
da.Xu("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+Jc.data.ie,10):da.Xu("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},Jc=>{Jc&&Jc.data?da.Xu("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+Jc.data.ie,10):da.Xu("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});n.AFrameworkApplication.fa.ka("SmartLookupPrefetchJSIsEnabled")&&
(Qb=new qa.a(Qb,1,null,null,!0,2,null),ac.send(Qb).hKb(Jc=>{Jc&&Jc.data?Jc.data.Wd||da.Xu("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+Jc.data.ie,10):da.Xu("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},Jc=>{Jc&&Jc.data?da.Xu("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+Jc.data.ie,10):da.Xu("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",
10)}))}}dispose(){this.Omb&&this.Omb.dispose()}}Object(h.a)(Tc,"InsightsPackage",null,[2,3]);var wb=d(29),Rb=d(99),vc=d(676),rd=d(1101),rc=d(542),cb=d(61),Wb=d(34);class Uc{constructor(fb,Qb,ac,Jc=!0){this.streamUrl=fb;this.objectType=Qb;this.formatType=ac;this.renderAfterInsert=Jc}}Object(h.a)(Uc,"InsertContentFromStreamData",null,[]);var Ib=d(444),Vc=d(30);class gc{constructor(fb,Qb,ac){this.ia=fb;this.pa=Qb;this.ua=ac}insertOnlinePicture(fb){const Qb=Object(Oa.a)(115,this.ua.Ba);fb&&Qb&&(fb=Object.assign(new rc.a,
{Action:"Insert",Caption:fb.caption,OriginalUrl:fb.sourceUrl,Height:fb.height,Width:fb.width,LicenseDisplayName:fb.licenseDisplayName,LicenseUrl:fb.licenseUrl,ThumbnailUrl:fb.thumbnailUrl,PageUrl:fb.pageUrl}),this.ia.La(Vc.a.sab,2,fb))}insertHtmlText(fb){if(fb)if(1===this.pa.Xd().length){const Qb=new rd.DictionaryPropertySet;Qb.setValue(cb.a.JU,fb.htmlText);Qb.setValue(cb.a.bid,!1);8===this.ia.La(Wb.a.Qhd,2,Qb)&&this.Mfg(fb)}else this.Mfg(fb)}Mfg(fb){fb=Object.assign(new Ib.a,{TMb:!1,jV:fb.htmlText});
this.ia.La(Vc.a.xxa,2,fb)}insertContentFromStreamUrl(fb){fb&&(fb=new Uc(fb.streamUrl,fb.objectType,fb.formatType,fb.renderAfterInsert),this.ia.La(Vc.a.MXc,2,fb))}getId(){return"InsertContentExecutor"}}Object(h.a)(gc,"InsertContentExecutor",null,[673,741]);var rb=d(1022),Zb=d(191);class Hc{}Object(h.a)(Hc,"CommandMetadataResponse",null,[]);class Ab{constructor(){this.Ide=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){Zb.PrivacyDialogManager.Yqd()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(fb){const Qb=
new Hc;fb.iconNames&&(Qb.svgData=this.getCommandIconSvg(fb.iconNames));if(!fb.commandId||""===fb.commandId)return Qb.isVisible=!1,Qb;try{Qb.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),fb.commandId);Qb.isDisabled=appChrome.selectors.isControlDisabled(fb.commandId);Qb.label=appChrome.selectors.getControlLabel(fb.commandId);if(Qb.svgData&&""!==Qb.svgData)return Qb;const ac=appChrome.selectors.getControlIconSet(fb.commandId),Jc=Array(2);Jc[0]=ac["default"];Jc[1]=ac.icon32;Qb.svgData=
this.getCommandIconSvg(Jc)}catch(ac){return null}return Qb}getCommandIconSvg(fb){if(!this.Ide)return"";for(let Qb=0;Qb<fb.length;Qb++){const ac=fb[Qb];if(ac in this.Ide)return this.Ide[ac]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(fb){const Qb={SourceControlId:"GiveFeedback"};Qb.feedbackType="true"===fb.IsPosFeedback?0:1;const ac={};ac.featureArea=Ab.zXi;Qb.telemetryGroup=ac;Qb.appData=fb;return Qb}}
Ab.sAj="FA000000012";Ab.ONk="AssetID=";Ab.zXi="SearchPane";Object(h.a)(Ab,"BaseSerpletExecutor",null,[672,741]);var ad=d(28);class Bd extends Ab{constructor(fb,Qb,ac){super();this.ia=fb;this.kIg=Qb;this.Bdk=ac;if(!fb)throw Error.argumentNull("m_actionManager");}openFeedbackPane(fb){this.ia.La(Ka.a.jLb,2,this.createFeedbackPropertiesFromData(fb))}openHelpTaskPane(fb){const Qb={};Qb.query=Ab.ONk+fb;fb={};fb.assetId=Ab.sAj;fb.nonPersistedSettings=Qb;this.ia.La(Vc.a.lga,2,fb)}browseFiles(){this.ia.La(Ka.a.GYc,
2,null)}executeCommand(fb){if(fb)switch(fb.CommandId){case 3:appChrome.api.executeCommand(fb.Data.CommandId,fb.Data.Payload);break;case 4:if(this.kIg&&this.Bdk)try{this.kIg.GIj(fb.Data.AST)}catch(Qb){ad.a.J(509449952,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${Qb}`)}}}}Object(h.a)(Bd,"PPTSerpletExecutor",Ab,[]);class kd{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(h.a)(kd,"BaseDocumentHelper",null,[674]);
class Be extends kd{constructor(){super()}isEditingAllowed(){return wb.App.Kb.Ld.isEditingAllowed}}Object(h.a)(Be,"PptDocumentHelper",kd,[]);class Qd{constructor(){this.Dxc=this.hI=null}ZXd(){return null}USa(){return this.Q9a()}Ybj(){return this.Q9a()}fnl(fb,Qb,ac){this.hI||(this.hI=this.eMc());this.hI.Ql(fb,Qb,ac)}gnl(fb,Qb,ac){this.hI||(this.hI=this.eMc());this.hI.vZe(fb,Qb,ac)}Fll(fb,Qb){this.Dxc||(this.Dxc=this.ZXd());this.Dxc&&this.Dxc.vZe(fb,Qb)}Dod(fb,Qb){this.hI||(this.hI=this.eMc());this.hI.Dod(fb,
Qb)}foe(fb){this.hI||(this.hI=this.eMc());this.hI.foe(fb)}t9k(){this.hI&&this.hI.gVe()}YVe(){this.hI&&this.hI.Rbl()}dll(){var fb=n.AFrameworkApplication.fa.Bc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);fb=window.performance.now()-Qd.Jpg<=fb;fb||(Qd.Jpg=window.performance.now());return fb}dispose(){this.hI&&(this.hI.dispose(),this.hI=null)}get H$b(){return this.hI?this.hI.isVisible:!1}}Qd.Jpg=0;Object(h.a)(Qd,"InsightsManager",null,[472,106]);class ae{constructor(fb,Qb,ac,Jc,pd,qd=!0,
sd=null,ze=null){this.mK=this.Hp=this.Fha=null;this.ZNa=!1;this.BK=null;this.Od=Qb;this.QEd=qd;this.VRb=ze?ze:new kd;this.tG=sd;this.xK=fb;this.QEd&&(P.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime")&&(this.BK=P.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").h8d()),this.VV=P.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Q5a=this.VV.n$a())}Zgb(fb){if(this.QEd){fb=fb.rawEvent;try{var Qb=F.a(fb.data)}catch(ac){E.ULS.sendTraceTag(595161728,1303,15,this.Yja("Message data from Serplet [{0}] failed to deserialize.",
fb.data));return}switch(Qb.actionType){case 101:fb=0;this.Hp&&(fb=this.Hp.entryPoint);this.VV.M6b(this.mK,this.VRb,this.oTa(),fb).then(ac=>{Qb.data=ac;this.uIb(Qb)});break;case 118:Qb.data=this.Hp?this.Hp:Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:this.Fha.neighborhood,mentionStart:this.Fha.mentionStart,mentionLength:this.Fha.mentionLength})});this.uIb(Qb);break;case 103:fb=F.a(Object(Oa.a)(String,Qb.data));da.sendTelemetryEvent(fb);break;case 206:this.VV.Jae(Qb.data).then(ac=>
{Qb.data=ac;this.uIb(Qb)});break;case 112:Qb.data.shiftPressed?(Ya.a.fg&&document.activeElement.blur(),this.xK.UVc(0,null,2,null,null),E.ULS.sendTraceTag(592545156,1303,50,this.Yja("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.xK.xTa(0,null,2,null,null),E.ULS.sendTraceTag(592545155,1303,50,this.Yja("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Cr()}}}Cjb(fb){if(this.BK){var Qb=0;this.Hp&&(Qb=this.Hp.entryPoint);this.VV.M6b(this.mK,this.VRb,this.oTa(),Qb).then(ac=>{da.Bod("SearchFromHost",
this.mK);this.Hp.launchData||(this.Hp.launchData=new Ba.a);const Jc=Za();try{this.BK.search(this.Hp,ac,n.AFrameworkApplication.userSessionId,Jc,fb),this.VV.gah(pd=>{da.Bod("SearchFromHostWithToken",this.mK);this.BK.searchAuthenticatedProviders(this.Hp,ac,n.AFrameworkApplication.userSessionId,Jc,null,pd)})}catch(pd){da.Xu("BaseSmartLookupPane - Fail to search from host. Error: "+pd,10)}}).catch(ac=>{da.Xu("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+ac.toString(),
10)})}}hqc(fb){this.QEd&&da.hqc(this.mK,Math.round(window.performance.now()-fb),this.Hp?fa.a[this.Hp.entryPoint]:"",this.VV.n$a(),this.VV.q2f(),n.AFrameworkApplication.BHc,this.ZNa,Tb(this.Hp?this.Hp.entryPoint:0))}}Object(h.a)(ae,"BaseSmartLookupPane",null,[788,106]);class We{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(h.a)(We,"SmartLookupTaskPaneProps",null,[]);var $d=d(651);class Re{}Object(h.a)(Re,"ActionDescriptor",null,[]);var Ta=d(97);class xb extends ae{constructor(fb,Qb,ac,
Jc=null,pd=null,qd=null,sd=!0,ze=null,Wd=null){super(Qb,ac,Jc,pd,qd,sd,ze,Wd);this.CMd=!!n.AFrameworkApplication.Aa&&!!n.AFrameworkApplication.Aa.hb&&n.AFrameworkApplication.Aa.hb.Wme;this.Vob=this.KJd=!1;this.tXh=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.sXh=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.xXh=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.wXh=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);sd||da.Xu("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.Aqa=fb;this.ref=tc(this.Q5a)}get isVisible(){return this.Vob}Dod(fb,Qb){this.Hp=fb;this.Fha=fb=Object.assign(new O.a,{neighborhood:fb.selection.neighborhood,mentionStart:fb.selection.mentionStart,mentionLength:fb.selection.mentionLength});this.ZNa=!fb.mentionLength;this.mK=Qb;this.Cjb(!1)}foe(fb){this.Hp=
fb;this.Oya(Object.assign(new O.a,{neighborhood:fb.selection.neighborhood,mentionStart:fb.selection.mentionStart,mentionLength:fb.selection.mentionLength}),!1)}Ql(fb,Qb){this.mK=Qb;this.Oya(fb,!0)}vZe(fb,Qb,ac){this.Hp=fb;this.Ql(Object.assign(new O.a,{neighborhood:fb.selection.neighborhood,mentionStart:fb.selection.mentionStart,mentionLength:fb.selection.mentionLength}),Qb,ac)}Cr(){this.mpd();this.Aqa.hideTaskPane()}Oya(fb,Qb){ra.SessionStatusManager.instance.J_&&this.BK?(this.Fha=fb,this.ZNa=!fb.mentionLength,
fb=window.performance.now(),this.initialize(),this.isVisible?n.AFrameworkApplication.fa.ka("SmartLookupDisableRefreshPaneIsEnabled")?(this.Aqa.updateTaskPane(null),Qb&&this.R9k()):(Qb&&this.Cjb(!1),this.KJd=!this.KJd,this.Aqa.updateTaskPane(this.Jca())):(Qb&&this.Cjb(this.isVisible),this.Aqa.showTaskPane(this.Jca())),this.hqc(fb)):(this.Aqa.showTaskPane(this.Jca()),da.w9k(ra.SessionStatusManager.instance.J_,!!this.BK,this.Hp?fa.a[this.Hp.entryPoint]:"",this.VV.n$a(),n.AFrameworkApplication.BHc,this.ZNa))}R9k(){if(!this.Hp){const fb=
Object.assign(new ea.a,{neighborhood:this.Fha.neighborhood,mentionStart:this.Fha.mentionStart,mentionLength:this.Fha.mentionLength});this.Hp=Object.assign(new ma.a,{selection:fb,userIntent:null,entryPoint:0,launchData:null})}this.Cjb(this.isVisible)}D9k(){const fb=new Re;fb.transactionId=this.mK;fb.actionType=15;fb.channelId=G.channelId;this.uIb(fb)}Zgb(fb){const Qb=fb.rawEvent;document.getElementById(G.$Y)&&Qb.source!==document.getElementById(G.$Y).contentWindow||this.XRk(fb)}XRk(fb){const Qb=fb.rawEvent;
let ac;try{ac=F.b(Qb.data)}catch(Jc){E.ULS.sendTraceTag(545604257,1303,15,this.Yja("Message data from Serplet [{0}] failed to deserialize.",Qb.data));return}switch(ac.actionType){case 32:n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Ta.a.tVc()>=this.tXh?this.Aqa.updateTaskPane(this.jZd(this.sXh)):Ta.a.tVc()>=this.xXh&&this.Aqa.updateTaskPane(this.jZd(this.wXh)));break;case 33:n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&this.Aqa.updateTaskPane(this.jZd(ac.data));break;case 42:this.Aqa.updateTaskPane(this.NIi(ac.data));break;case 43:this.Aqa.updateTaskPane(this.Jca());break;default:super.Zgb(fb)}}dispose(){}initialize(){this.pkb()}pkb(){const fb=this.Od.Fc(G.$Y);fb.parent=Ga.AFrame.hj;fb.dJ=!0}VLb(){this.Od.rf(G.$Y)}mpd(){this.Vme()&&this.Od.rf(this.Od.q8)}MQe(){$addHandler(window,"message",Object(u.a)(this,this.Zgb,"onIFrameMessage"))}O4e(){$removeHandler(window,"message",Object(u.a)(this,this.Zgb,"onIFrameMessage"))}Vme(){return!!this.Od.Ae&&
this.Od.Ae.name===G.$Y}uIb(fb){fb=F.c(fb);document.getElementById(G.$Y)&&document.getElementById(G.$Y).contentWindow.postMessage(fb,jc.a.sQ(this.ref))}Yja(fb,...Qb){const ac={};this.mK&&(ac[G.cCh]=this.mK);ac[G.dCh]=String.format.apply(null,[fb].concat(Qb));return F.c(ac)}oTa(){return sa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}V7g(){if(this.BK)this.BK.onPaneThemeChanged(this.oTa());return sa.a("getTheme")?appChrome.api.getTheme():null}gVe(){}Rbl(){document.getElementById(G.$Y)&&
B.FocusManager.Wr(document.getElementById(G.$Y).contentWindow)}sIe(){da.Xu("ReactSmartLookupPane - Iframe component failed to load.",10)}Bvk(){n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||da.Xu("ReactSmartLookupPane - Onload detected no network.",50)}T9i(){return this.Hp?10===this.Hp.entryPoint?2===n.AFrameworkApplication.Aa.hb.Uk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:
18===this.Hp.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.Hp.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.Hp.entryPoint||38===this.Hp.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}Jca(){var fb=CommonUIStrings.L_SmartLookupPaneTitle;n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(fb=this.T9i());const Qb=new We;Qb.src=this.ref;Qb.id=G.$Y;Qb.refreshPane=
this.KJd;Qb.onError=Object(u.a)(this,this.sIe,"onIFrameError");Qb.onLoad=Object(u.a)(this,this.Bvk,"onIFrameLoad");Qb.title=fb;ra.SessionStatusManager.instance.J_?this.BK||(Qb.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,Qb.errorType=1):(Qb.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,Qb.errorType=0);fb=Object.assign(new $d.a,{title:fb,hideHeader:!1,width:G.width,location:G.QCk,contentProps:Qb,isModernPane:!0,onOpen:()=>{this.VLb();this.Vob=!0;this.MQe();
sa.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(u.a)(this,this.V7g,"onThemeIdChanged"));n.AFrameworkApplication.Aa.updateCommandUI();if(this.BK)this.BK.onPaneStateChanged(!0)},onClose:()=>{this.D9k();this.mpd();this.Vob=!1;this.O4e();sa.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(u.a)(this,this.V7g,"onThemeIdChanged"));n.AFrameworkApplication.Aa.updateCommandUI();if(this.BK)this.BK.onPaneStateChanged(!1)}});this.CMd&&
(fb.enableResize=!0,fb.minResizeWidth=320,fb.maxResizeWidth=920);return fb}NIi(fb){const Qb=this.Jca();Qb.title=fb;Qb.contentProps.title=fb;return Qb}jZd(fb){const Qb=this.Jca();Qb.resizeWidth=fb;return Qb}}Object(h.a)(xb,"ReactSmartLookupPane",ae,[]);var kc=d(141);class Nc{constructor(){this.Ggf=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}showTaskPane(fb){kc.UISurfaces.zr().then(Qb=>{this.Ggf||(fb.enableResize=!1);Qb.showTaskPane(G.$Y,
fb);return null})}updateTaskPane(fb=null){kc.UISurfaces.zr().then(Qb=>{Qb.setSelectedTaskPane(G.$Y);fb&&(this.Ggf||(fb.enableResize=!1),Qb.updateTaskPane(G.$Y,fb));return null})}hideTaskPane(){kc.UISurfaces.zr().then(fb=>{fb.hideTaskPane(G.$Y,2);return null})}}Object(h.a)(Nc,"PptReactSmartLookupPaneHandler",null,[767]);class id{static ylj(){switch(n.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":n.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")?
"PROD":n.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")?"INT":id.t$i()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static t$i(){switch(Object(Oa.a)(String,n.AFrameworkApplication.gd.AudienceGroup)||""){case "Dogfood":if(n.AFrameworkApplication.fa){let fb=n.AFrameworkApplication.fa.Ga("UserPrincipalName");fb=hc.a.rg(fb);const Qb=n.AFrameworkApplication.fa.Eu("SmartLookupINTEnabledForSKITeam")?n.AFrameworkApplication.fa.YA("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(Qb,fb)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}}Object(h.a)(id,"Utils",null,[]);class Ed{constructor(fb,Qb=null){this.mK=this.Hp=this.Fha=null;this.ZNa=!1;this.BK=null;this.xK=fb;this.VRb=Qb?Qb:new kd;P.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime")&&(this.BK=P.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").h8d());this.VV=P.a.instance.resolve("Common.App.SearchCommon.ISearchHelper");this.Q5a=this.VV.n$a()}Cjb(fb){if(this.BK){var Qb=0;
this.Hp&&(Qb=this.Hp.entryPoint);this.VV.M6b(this.mK,this.VRb,this.oTa(),Qb).then(ac=>{da.Bod("SearchFromHost",this.mK);this.Hp.launchData||(this.Hp.launchData=new Ba.a);const Jc=Za();try{this.BK.search(this.Hp,ac,n.AFrameworkApplication.userSessionId,Jc,fb),this.VV.gah(pd=>{da.Bod("SearchFromHostWithToken",this.mK);this.BK.searchAuthenticatedProviders(this.Hp,ac,n.AFrameworkApplication.userSessionId,Jc,null,pd)})}catch(pd){da.Xu("BaseSmartLookupPane - Fail to search from host. Error: "+pd,10)}}).catch(ac=>
{da.Xu("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+ac.toString(),10)})}}MQe(){$addHandler(window,"message",Object(u.a)(this,this.Zgb,"onIFrameMessage"))}O4e(){$removeHandler(window,"message",Object(u.a)(this,this.Zgb,"onIFrameMessage"))}uIb(fb){fb=F.c(fb);document.getElementById(this.nxb())&&document.getElementById(this.nxb()).contentWindow.postMessage(fb,jc.a.sQ(Pa()))}Zgb(fb){let Qb;fb=fb.rawEvent;try{Qb=F.b(fb.data)}catch(ac){E.ULS.sendTraceTag(509614105,
1303,15,this.Yja("Message data from Serplet [{0}] failed to deserialize.",fb.data));return}switch(Qb.actionType){case 103:fb=F.b(Object(Oa.a)(String,Qb.data));da.sendTelemetryEvent(fb);break;case 206:this.VV.Jae(Qb.data).then(ac=>{Qb.data=ac;this.uIb(Qb)});break;case 112:Qb.data.shiftPressed?(Ya.a.fg&&document.activeElement.blur(),this.xK.UVc(0,null,2,null,null),E.ULS.sendTraceTag(509614104,1303,50,this.Yja("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.xK.xTa(0,null,2,null,null),E.ULS.sendTraceTag(509614103,
1303,50,this.Yja("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Cr()}}Yja(fb,...Qb){const ac={};this.mK&&(ac[G.cCh]=this.mK);ac[G.dCh]=String.format.apply(null,[fb].concat(Qb));return F.c(ac)}hqc(fb){da.hqc(this.mK,Math.round(window.performance.now()-fb),this.Hp?fa.a[this.Hp.entryPoint]:"",this.VV.n$a(),this.VV.q2f(),n.AFrameworkApplication.BHc,this.ZNa,Tb(this.Hp?this.Hp.entryPoint:0))}}Ed.Mei="AppProperties";Ed.$pl="SmartLookupApplicationInterface";Object(h.a)(Ed,"BaseCopilotAddin",
null,[787,106]);class Ja extends Ed{constructor(fb,Qb,ac,Jc){if(!fb)throw Error.argumentNull("actionManager");if(!Qb)throw Error.argumentNull("appForOfficeManager");if(!Jc)throw Error.argumentNull("f6Manager");super(Jc,ac);this.Eb=!1;this.NCg=!0;this.ztg="FA000000006";this.ia=fb;this.Yc=Qb;this.nz={};this.dik=id.ylj();this.nz.sourceLocationOverrideResourceId=this.dik;this.nz.XE="Copilot";this.nz.assetId=this.ztg}vZe(fb,Qb){this.Hp=fb;const ac=Object.assign(new O.a,{neighborhood:fb.selection.neighborhood,
mentionStart:fb.selection.mentionStart,mentionLength:fb.selection.mentionLength});this.mK=Qb;this.Fha=ac;this.ZNa=!ac.mentionLength;ra.SessionStatusManager.instance.J_&&this.BK?(this.Cjb(!1),this.VV.M6b(this.mK,this.VRb,this.oTa(),fb.entryPoint).then(Jc=>{Jc.isFirstLaunch=this.NCg;this.NCg=!1;const pd={};pd[Ed.$pl]=this.Hp;pd[Ed.Mei]=Jc;this.nz.nonPersistedSettings=pd;this.nz.H5=Object(u.a)(this,this.bhb,"onPaneRendered");this.ia.La(Vc.a.lga,2,this.nz);this.Eb=!0})):(this.ia.La(Vc.a.lga,2,this.nz),
this.Eb=!0)}bhb(){this.MQe()}Cr(){const fb=this.nxb();this.O4e();fb&&this.ia&&this.ia.La(Vc.a.Ftb,2,fb);this.Eb=!1}Dod(fb,Qb){this.Hp=fb;this.Fha=fb=Object.assign(new O.a,{neighborhood:fb.selection.neighborhood,mentionStart:fb.selection.mentionStart,mentionLength:fb.selection.mentionLength});this.ZNa=!fb.mentionLength;this.mK=Qb;this.Cjb(!1)}dispose(){}nxb(){if(this.Yc.instance){const fb=this.Yc.instance.oQ(this.ztg+"."+this.nz.sourceLocationOverrideResourceId);if(fb)return fb.instanceId;ad.a.J(509433935,
1313,15,"PPT Copilot Addin: Could not find task pane from ID.")}else ad.a.J(509433934,1313,15,"PPT Copilot Addin: AppForOfficeManager is unavailable.");return null}oTa(){return sa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}get isVisible(){return this.Eb}}Object(h.a)(Ja,"PptCopilotAddin",Ed,[]);class db extends Qd{constructor(fb,Qb,ac,Jc,pd){super();this.ATg=fb;this.Qb=ac;this.ia=Jc;this.Yc=pd}eMc(){const fb=this.Qb.ka("822");return new xb(new Nc,v.a.instance,B.FocusManager.instance(),
P.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),P.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),P.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),fb,P.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}ZXd(){return this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?new Ja(this.ia,this.Yc,null,v.a.instance):super.ZXd()}Q9a(){return this.ATg.getSelectedText()}okg(){return this.ATg.XMj()}}
Object(h.a)(db,"SmartLookupManager",Qd,[]);class zc{constructor(fb,Qb,ac,Jc,pd,qd,sd){this.PT=fb;this.Jb=Qb;this.bjk=ac;this.phk=Jc;this.Yhk=pd;this.hak=qd;this.PVg=sd;this.LGa=new Map;if(!fb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Qb)throw Error.argumentNull("m_transactionFactory");if(!ac)throw Error.argumentNull("m_textODSLEntity");if(!Jc)throw Error.argumentNull("m_shapeODSLEntity");if(!pd)throw Error.argumentNull("m_slideODSLEntity");if(!qd)throw Error.argumentNull("m_imageODSLEntity");
if(!sd)throw Error.argumentNull("m_tablesODSLEntity");this.PT&&this.PT.execute(ze=>{this.Yc=ze});this.LGa=new Map;this.LGa.set("text",this.bjk);this.LGa.set("shapes",this.phk);this.LGa.set("slides",this.Yhk);this.LGa.set("images",this.hak);this.LGa.set("tables",this.PVg);this.LGa.set("table",this.PVg)}hAi(fb,Qb){return Object.assign({},...fb.map(ac=>Qb.has(ac.value)?{[ac.name]:Qb.get(ac.value)}:{[ac.name]:JSON.parse(ac.value)}))}GIj(fb){if(this.Yc){var Qb=this.Jb.oe(15);try{Qb.nc(this.Yc.s_.presentation);
const ac=new Map;for(const Jc of fb.statements){const pd=Jc.name.split("_");if(2!==pd.length)throw Error.argumentOutOfRange("statement",pd,"Provided ODSL statement does not have expected format of action_entity.");const qd=pd[0],sd=pd[1];if(!this.LGa.has(sd))throw Error.argumentOutOfRange("entityName",sd,"Provided entity name in ODSL statement is not supported.");const ze=this.LGa.get(sd);if(!ze)throw Error.argumentOutOfRange("entity",ze,"Could not access entity for provided ODSL statement.");const Wd=
this.hAi(Jc.arguments,ac);if(!Wd)throw Error.argumentOutOfRange("args",Wd,"Could not construct ODSL statement input from provided args.");let ye;switch(qd){case "select":ye=ze.select(Wd);break;case "format":ye=ze.format(Wd);break;case "insert":ye=ze.insert(Wd);break;case "delete":ye=ze.delete(Wd);break;case "default":throw Error.argumentOutOfRange("action",qd,"Provided action in ODSL statement is not supported.");}Jc.returnVariable&&ye&&ac.set(Jc.returnVariable,ye)}}catch(ac){ad.a.J(509440020,1313,
15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${ac}`)}finally{Qb&&Qb.dispose()}}else ad.a.J(509440021,1313,15,"SmartLookup ODSLInterpreter interpret: Skipping execution because no AppForOfficeManager instance exists.")}}Object(h.a)(zc,"ODSLInterpreter",null,[736]);var Hd=d(278),Ad=d(48);class Kd{constructor(fb,Qb,ac,Jc,pd){this.Vb=fb;this.ia=Qb;this.Pg=ac;this.Fa=Jc;this.Fcb=Ad.a.KXd;this.C_e=!1;this.onAction=qd=>{if(qd)switch(qd.actionType){case "Query":this.Pxk(qd);
break;case "ToggleDictation":this.hAk()}};if(!this.Vb)throw Error.argumentNull("m_workspace");if(!this.ia)throw Error.argumentNull("m_actionManager");if(!this.Pg)throw Error.argumentNull("m_f6Manager");if(!this.Fa)throw Error.argumentNull("m_focusManager");if(!pd)throw Error.argumentNull("actorFuture");pd.execute(()=>{this.start().catch(qd=>{E.ULS.sendTraceTag(509440287,1313,10,`Unable to start Copilot UX, error: ${qd}`)})})}yae(){return""}F8f(){return""}vsc(){var fb,Qb;null===(Qb=null===(fb=this.hWa)||
void 0===fb?void 0:fb.setDictationState)||void 0===Qb?void 0:Qb.call(fb,!0);return this.C_e=!0}wDa(){var fb,Qb;this.C_e||(null===(Qb=null===(fb=this.hWa)||void 0===fb?void 0:fb.setDictationState)||void 0===Qb?void 0:Qb.call(fb,!1));this.C_e=!1}sxf(fb){var Qb,ac;return this.hWa?(null===(ac=(Qb=this.hWa).appendQuery)||void 0===ac?void 0:ac.call(Qb,fb),!0):!1}Lfg(fb){var Qb,ac;null===(ac=null===(Qb=this.hWa)||void 0===Qb?void 0:Qb.setQuery)||void 0===ac?void 0:ac.call(Qb,fb);return!0}p_g(){}hAk(){this.ia.La(Wb.a.Glb,
2,{fPf:Kd.pMh})}Pxk(fb){var Qb;fb=null!==(Qb=fb.query)&&void 0!==Qb?Qb:"";Qb=Object.assign(new ma.a,{selection:Object.assign(new ea.a,{neighborhood:fb,mentionStart:0,mentionLength:fb.length}),launchData:Object.assign(new Ba.a,{landingTab:"Copilot"}),entryPoint:0});this.ia.La(Ka.a.FYc,2,Qb)}P7i(){this.xdb||(this.xdb=document.createElement("div"),this.xdb.id="copilotHost",document.body.appendChild(this.xdb));return this.xdb}khl(){this.Fa.NYb(this.Fcb);const fb=this.Fa.Fc(this.Fcb);fb.parent=Ga.AFrame.hj;
fb.dJ=!0;fb.Q7(()=>{var Qb;null===(Qb=this.hWa)||void 0===Qb?void 0:Qb.focus()});this.Pg.yia(this.Fcb);this.Pg.rI(this.Fcb);this.xdb.addEventListener("focusin",Qb=>{var ac;Qb.preventDefault();Qb.stopPropagation();(null===(ac=this.Fa.Ae)||void 0===ac?void 0:ac.name)!==this.Fcb&&this.Fa.LU(this.Fcb,!1)});this.xdb.addEventListener("focusout",Qb=>{var ac,Jc,pd;Qb.preventDefault();Qb.stopPropagation();for(Qb=null!==(ac=Qb.relatedTarget)&&void 0!==ac?ac:document.activeElement;Qb;){if(Qb===this.xdb)return;
Qb=Qb.parentElement}null===(pd=null===(Jc=this.hWa)||void 0===Jc?void 0:Jc.collapse)||void 0===pd?void 0:pd.call(Jc);this.Fa.a1(this.Fcb,!1)})}start(){return Object(Hd.a)(this,void 0,void 0,function*(){const fb=this.P7i();this.hWa=yield(yield kc.UISurfaces.O7i()).renderCopilot(fb,{onAction:this.onAction});if(!this.hWa)throw Error("Copilot control interface is not returned.");this.khl()})}}Kd.pMh="PowerPointWebEditor.SmartLookup.FABDictationHost";Object(h.a)(Kd,"PptCopilot",null,[475]);class Pc{constructor(fb,
Qb){this.PT=fb;this.pa=Qb;this.insert=({slides:ac,description:Jc})=>{if(!ac)throw Error.argumentNull("slides");return Promise.resolve(ac).then(()=>{throw Error(`Could not get imageString in Base64 for ${Jc}`);})};if(!fb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Qb)throw Error.argumentNull("m_selectionManager");this.PT&&this.PT.execute(ac=>{this.Yc=ac})}select(){throw Error("Method not implemented.");}format(){throw Error("Method not implemented.");}delete(){throw Error("Method not implemented.");
}}Object(h.a)(Pc,"ODSLImage",null,[722]);var tf=d(583),xe=d(1212),ef;(function(fb){fb[fb.horizontal=0]="horizontal";fb[fb.vertical=1]="vertical"})(ef||(ef={}));Object(h.b)("Orientation",ef);var Id=d(283),qe=d(63),jg=d(58),of=d(393),Cb=d(684),Df=d(43),Bf=d(103),qg=d(1030),vd=d(685),$f=d(231),ng=d(230);class Qe{}var Gf=Qe;Qe.Jnh={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",
blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",
darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",
lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",
mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",
pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",
white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};Qe.JQa=fb=>{fb=fb.toLowerCase().trim().replace(/\s/g,"");return Qe.Jnh[fb]?Qe.Jnh[fb]:""};Qe.ZDf=fb=>fb?""!==Gf.JQa(fb):!1;Qe.O6i=fb=>{var Qb=/^#([0-9a-f])*$/i;if(!fb||!fb.match(Qb))throw Error("invalid hex color string provided");Qb=new ng.Color;switch(fb.length){case 7:Qb.a=1;Qb.r=parseInt(fb.substring(1,3),16);Qb.g=parseInt(fb.substring(3,5),16);Qb.b=parseInt(fb.substring(5,7),16);break;case 9:Qb.r=parseInt(fb.substring(1,
3),16);Qb.g=parseInt(fb.substring(3,5),16);Qb.b=parseInt(fb.substring(5,7),16);Qb.a=parseInt(fb.substring(7,9),16);break;default:throw Error("unsupported color string provided");}return Qb};Object(h.a)(Qe,"ColorTranslator",null,[]);var Jf=d(32),xh=d(51),he=d(33),de=d(553);class xf{constructor(fb,Qb,ac,Jc){this.Pb=fb;this.Ceb=Qb;this.MHa=ac;this.lJ=Jc;if(!fb)throw Error.argumentNull("m_graphIteratorFactory");if(!Qb)throw Error.argumentNull("m_outlineEditor");if(!ac)throw Error.argumentNull("m_outlineElementNavigator");
if(!Jc)throw Error.argumentNull("m_characterPropertiesEditor");}Haj(fb,Qb,ac){fb=this.Laj(fb,Qb,ac);Qb=new x.a;for(const Jc of fb)Qb.add(xh.a.create(Jc));return Qb}Laj(fb,Qb,ac){const Jc=new Jf.GraphIterator;Jc.set(Qb);Qb=new x.a;this.kTc(fb,Jc,ac,!1,Qb);return Qb}kTc(fb,Qb,ac,Jc,pd){let qd=null;if(Qb&&(qd=Qb.Ii())){do{switch(qd.type){case 12:break;case 35:Jc&&this.kTc(fb,Qb,ac,Jc,pd);break;case 14:ac&&this.kTc(fb,Qb,ac,Jc,pd);break;default:this.kTc(fb,Qb,ac,Jc,pd)}if(fb===qd.type&&12===fb){if(null===
qd)throw Error("Could not cast node of NodeType.Paragraph to ParagraphNode");pd.add(qd)}}while(qd=Qb.lp());Qb.zc()}}PUe(fb,Qb,ac){for(const Jc of Qb){if(12===fb&&(Jc.gB||Jc.kla&&0===Jc.xC().length)){Qb=this.Pb.Mc(Jc);Jc.deleteParagraph();this.Ceb.iW(Qb,!0);this.MHa.oi(Qb);Qb=Qb.currentNode;const pd=he.ParagraphReader.textLength(Qb);Qb=xh.a.createTextRange(Qb,0,pd);this.lJ.replaceTextRange(Qb,"")}ac.push(...this.Haj(fb,Jc,14===fb).toArray())}}mLb(fb,Qb,ac){for(const Jc of Qb)this.PUe(fb,Jc.gk(),ac)}}
xf.MVc=(fb,Qb,ac=!1)=>{const Jc=()=>{if(Qb){var pd=ac?Qb.XUc():Qb;fb(pd);de.a.instance.Q_k(Jc)}};de.a.instance.pvf(Jc);return Jc};Object(h.a)(xf,"ODSLGraphHelper",null,[]);class re{constructor(fb,Qb,ac,Jc,pd,qd,sd,ze,Wd,ye,Yc){this.PT=fb;this.pa=Qb;this.Zj=ac;this.QXa=Jc;this.OWa=pd;this.Ea=qd;this.Sk=sd;this.Ri=ze;this.Fb=Wd;this.Ms=ye;this.Ou=Yc;this.YDb=this.AHa=0;this.XUe=(Ae,hd)=>{for(let oe of Ae)hd.push(...oe.gk())};this.select=({scope:Ae,name:hd,index:oe=-1})=>{const Xe=Ke=>{const me=[],Uf=
[];let yf=null!==Ke&&void 0!==Ke?Ke:"Selection";if("Selection"===yf){const Cf=this.pa.Xd();0<Cf.length?me.push(...Cf):this.XUe(this.pa.Qe(),me);0!==me.length||Ke||(yf="Presentation")}if("Presentation"===yf&&this.Yc){Ke=this.Yc.s_.presentation.slides;if(null===Ke)throw Error("Could not cast from ISlide to ISlideNode on presentation slides.");this.XUe(Ke,me)}else Array.isArray(yf)&&0<yf.length&&yf[0]instanceof Id.a&&this.XUe(yf,me);if(hd)for(const Cf of me)Cf.shapeName===hd&&Uf.push(Cf);else Uf.push(...me);
return-1!==oe&&oe<Uf.length?[Uf[oe]]:Uf};return Ae instanceof Promise?Ae.then(Ke=>Xe(Ke)):Promise.resolve(Xe(Ae))};this.format=({shapes:Ae,left:hd,top:oe,height:Xe,width:Ke,lineColor:me,lineDashStyle:Uf,lineWeight:yf,lineTransparency:Cf,fillColor:Ld,fillTransparency:od})=>{if(!Ae)throw Error.argumentNull("shapes");return Promise.resolve(Ae).then(ug=>{if(ug&&0<ug.length)for(const Kf of ug){void 0!==hd&&(Kf.Ay=hd);void 0!==oe&&(Kf.By=oe);void 0!==Xe&&(Kf.JC=Xe);void 0!==Ke&&(Kf.wx=Ke);me&&(ug=Qe.JQa(me),
me=""===ug?me:ug,ug=$f.a.parse(me),Kf.Fya=JSON.stringify(ug));if(Uf)switch(Uf){case "Dash":Kf.WO=0;break;case "DashDot":Kf.WO=1;break;case "DashDotDot":Kf.WO=2;break;case "LongDash":Kf.WO=3;break;case "LongDashDot":Kf.WO=4;break;case "RoundDot":Kf.WO=5;break;case "Solid":Kf.WO=6;break;case "SquareDot":Kf.WO=7;break;case "LongDashDotDot":Kf.WO=8;break;case "SystemDash":Kf.WO=9;break;case "SystemDot":Kf.WO=10;break;case "SystemDashDot":Kf.WO=11;break;default:Kf.WO=6}void 0!==yf&&(Kf.outlineWidth=yf);
void 0!==Cf&&(ug=$f.a.parse(Kf.Fya),ug.Alpha=100*Cf,Kf.Fya=JSON.stringify(ug));Ld&&(Ld=""===Qe.JQa(Ld)?Ld:Qe.JQa(Ld),ug=$f.a.parse(Ld),Kf.Soa=JSON.stringify(ug));void 0!==od&&(ug=$f.a.parse(Kf.Soa),ug.Alpha=100*od,Kf.Soa=JSON.stringify(ug))}})};this.insert=({slides:Ae,shapeType:hd})=>{if(!Ae)throw Error.argumentNull("slides");const oe=Xe=>{if(!this.Yc)throw Error("Cannot insert shapes without appForOfficeManager instance.");const Ke=[];for(var me of Xe){if(!me)throw Error("Cannot find selected slide to insert shape.");
Xe=me.Cb;if(qe.a.mx(Xe))throw Error("Cannot insert on fake slide node.");const Kf=this.x9a(hd);if(!Kf)throw Error("Could not load props for shapeType.");if(!this.Zj.OF(me,1))throw this.Zj.mG(me),Error("Too many shapes on the slide.");const Vf=this.QXa.XI;var Uf=me.Jd.HasDefaultShape,yf=me.Jd.HasDefaultLine,Cf=95===Kf.sga||97===Kf.sga||Array.contains(Cb.a.ooe,Kf.sga);yf=yf&&Cf;Uf=Uf&&!Cf;this.Kga(0);var Ld=void 0;let Ch,xg;var od=this.Yc.s_.presentation.slideWidth,ug=this.Yc.s_.presentation.slideHeight;
Ld=new jg.a((od-Kf.width*tf.a.aD)/2,(ug-Kf.height*tf.a.aD)/2);Cf=Ld.x+xe.a.qf(this.oO*of.a.RS,ef.horizontal);xg=Ld.y+xe.a.qf(this.oO*of.a.RS,ef.vertical);Vf?(Ld=Kf.width*tf.a.aD,Ch=Kf.height*tf.a.aD):(Ld=xe.a.qf(re.w_b,ef.horizontal),Ch=xe.a.qf(re.v_b,ef.vertical),Cf=od/2-xe.a.qf(re.w_b/2-this.oO*of.a.RS,ef.horizontal),xg=ug/2-xe.a.qf(re.v_b/2-this.oO*of.a.RS,ef.vertical));this.oO++;this.oO>this.AHa&&(this.oO=this.YDb);od=me.Wt();ug=Object(Oa.a)(566,this.Yc.s_.Ba.ng(this.Fb.Ma));Df.a.Ib&&(yf||Uf)&&
Df.a.Ib.Va(Bf.a.x3d,yf?"HasDefaultLine":"HasDefaultShape");let lh=null;lh=!Vf||"TextBox"===hd||Uf||yf?this.Sk.aRa(!1,Xe.cid,Xe.sid,0,Kf.shapeType,Cf,xg,Ld,Ch,od+1):Cb.a.sMc(Xe,Kf,ug.tT,null,new qg.a,Cf,xg,Ld,Ch,od,this.Ea,this.Sk,this.Fb,this.Yc.s_,this.Ri);this.Ms.HW([lh],me,null);this.Ou.SF=lh;this.guc();Ke.push(lh)}me=[];for(const Kf of Ke)me.push(new Promise(Vf=>xf.MVc(Vf,Kf).bind(this)));return Promise.all(me)};return Promise.resolve(Ae).then(Xe=>oe(Xe))};this.delete=({shapes:Ae})=>{if(!Ae)throw Error.argumentNull("shapes");
const hd=oe=>{for(const Xe of oe)this.Sk.QNc(Xe)};return Promise.resolve(Ae).then(oe=>hd(oe))};if(!fb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Qb)throw Error.argumentNull("m_selectionManager");if(!ac)throw Error.argumentNull("m_shapeCountValidator");if(!Jc)throw Error.argumentNull("m_shapeSVGDependencyLoader");this.PT&&this.PT.execute(Ae=>{this.Yc=Ae});this.oO=0}Kga(fb){this.OWa.Q2e(fb)}guc(){const fb=P.a.instance.Ja("Common.ISystemInitiatedFeedback");fb&&fb.execute(Qb=>{Qb.logActivity("InsertShapeActivity",
null)})}x9a(fb){switch(fb){case "Textbox":return new vd.a(34,16,.5,3);case "Ellipse":return new vd.a(34,9,1,1);case "Triangle":return new vd.a(2,17,1,1.16);case "RightTriangle":return new vd.a(3,55,1,1);case "Parallelogram":return new vd.a(6,56,1,1.33);case "Trapezoid":return new vd.a(7,57,1.33,1);case "Diamond":return new vd.a(5,58,1,1);case "SPentagon":return new vd.a(9,59,1,1.05);case "Hexagon":return new vd.a(10,60,1,1.16);case "Heptagon":return new vd.a(11,61,1,1);case "Octagon":return new vd.a(12,
62,1,1);case "Decagon":return new vd.a(13,63,1,1);case "Dodecagon":return new vd.a(14,64,1,1);case "Pie":return new vd.a(39,65,1,1);case "Chord":return new vd.a(87,66,1,1);case "Teardrop":return new vd.a(35,67,1,1);case "Frame":return new vd.a(83,68,1,1);case "HalfFrame":return new vd.a(84,69,1,1);case "LShape":return new vd.a(85,70,1,1);case "DiagonalStripe":return new vd.a(86,71,1,1);case "Cross":return new vd.a(130,72,1,1);case "Plaque":return new vd.a(33,73,1,1);case "Can":return new vd.a(73,
7,1.33,1);case "Cube":return new vd.a(72,8,1.33,1.33);case "Bevel":return new vd.a(82,74,1.14,1.14);case "Donut":return new vd.a(41,75,1,1);case "NoSymbol":return new vd.a(42,76,1,1);case "BlockArc":return new vd.a(40,77,1,1);case "FoldedCorner":return new vd.a(81,78,1,1);case "SmileyFace":return new vd.a(78,79,1,1);case "Heart":return new vd.a(75,18,1,1);case "LightningBolt":return new vd.a(74,80,1,1);case "Sun":return new vd.a(76,81,1,1);case "Moon":return new vd.a(77,82,1,.5);case "Cloud":return new vd.a(120,
83,1,1);case "Arc":return new vd.a(88,84,1,1);case "DoubleBracket":return new vd.a(93,85,1,1);case "DoubleBrace":return new vd.a(94,86,1,1.17);case "LeftBracket":return new vd.a(89,87,1,.08);case "RightBracket":return new vd.a(90,88,1,.08);case "LeftBrace":return new vd.a(91,89,1,.17);case "RightBrace":return new vd.a(92,90,1,.17);case "MathPlus":return new vd.a(175,19,1,1);case "MathMinus":return new vd.a(176,20,1,1);case "MathMultiply":return new vd.a(177,21,1,1);case "MathDivide":return new vd.a(178,
22,1,1);case "MathEqual":return new vd.a(179,23,1,1);case "MathNotEqual":return new vd.a(180,24,1,1);case "StraightConnector":return new vd.a(95,12,1,1);case "StraightConnectorArrow":return new vd.a(95,13,1,1);case "StraightConnectorTwoArrow":return new vd.a(95,14,1,1);case "ElbowConnector":return new vd.a(97,26,1,1);case "ElbowArrowConnector":return new vd.a(97,155,1,1);case "ElbowDoubleArrowConnector":return new vd.a(97,156,1,1);case "CurvedConnector":return new vd.a(101,25,1,1);case "CurvedArrowConnector":return new vd.a(101,
153,1,1);case "CurvedDoubleArrowConnector":return new vd.a(101,154,1,1);case "DownArrow":return new vd.a(46,0,1.07,.53);case "LeftArrow":return new vd.a(44,1,.53,1.07);case "LeftRightArrow":return new vd.a(50,2,.53,1.33);case "RightArrow":return new vd.a(43,3,.53,1.07);case "UpArrow":return new vd.a(45,4,1.07,.53);case "UpDownArrow":return new vd.a(51,5,1.33,.53);case "LeftRightUpArrow":return new vd.a(53,27,.93,1.33);case "BentArrow":return new vd.a(62,28,.95,.89);case "UTurnArrow":return new vd.a(63,
29,.96,.97);case "LeftUpArrow":return new vd.a(52,30,.93,.93);case "BentUpArrow":return new vd.a(49,31,.8,.93);case "CurvedRightArrow":return new vd.a(67,32,1.33,.8);case "CurvedLeftArrow":return new vd.a(68,33,1.33,.8);case "CurvedUpArrow":return new vd.a(69,34,.8,1.33);case "CurvedDownArrow":return new vd.a(70,46,.8,1.33);case "StripedRightArrow":return new vd.a(47,35,.53,1.07);case "NotchedRightArrow":return new vd.a(48,36,.53,1.07);case "Pentagon":return new vd.a(36,37,.53,1.07);case "Chevron":return new vd.a(37,
38,.53,.53);case "RightArrowCallout":return new vd.a(56,39,1,1);case "DownArrowCallout":return new vd.a(58,40,1,1);case "LeftArrowCallout":return new vd.a(55,41,1,1);case "UpArrowCallout":return new vd.a(57,42,1,1);case "LeftRightArrowCallout":return new vd.a(59,43,.63,1.33);case "QuadArrowCallout":return new vd.a(61,44,1.33,1.33);case "CircularArrow":return new vd.a(64,45,1.07,1.07);case "QuadArrow":return new vd.a(54,47,1.33,1.33);case "Rectangle":return new vd.a(4,10,1,1);case "RoundedRectangle":return new vd.a(25,
11,1,1);case "RoundDiagonalCornerRectangle":return new vd.a(28,48,1,1);case "RoundSameSideCornerRectangle":return new vd.a(27,49,1,1);case "RoundSingleCornerRectangle":return new vd.a(26,50,1,1);case "SnipRoundSingleCornerRectangle":return new vd.a(29,51,1,1);case "SnipDiagonalCornerRectangle":return new vd.a(32,52,1,1);case "SnipSameSideCornerRectangle":return new vd.a(31,53,1,1);case "SnipSingleCornerRectangle":return new vd.a(30,54,1,1);case "RectangularCallout":return new vd.a(116,91,.67,1);case "RoundedRectangleCallout":return new vd.a(117,
6,.67,1);case "OvalCallout":return new vd.a(118,92,.67,1);case "CloudCallout":return new vd.a(119,93,.67,1);case "LineCallout1":return new vd.a(104,94,.67,1);case "LineCallout2":return new vd.a(105,95,.67,1);case "LineCallout3":return new vd.a(106,96,.67,1);case "LineCallout1Accent":return new vd.a(107,97,.67,1);case "LineCallout2Accent":return new vd.a(108,98,.67,1);case "LineCallout3Accent":return new vd.a(109,99,.67,1);case "LineCallout1BorderAccent":return new vd.a(110,100,.67,1);case "LineCallout2BorderAccent":return new vd.a(111,
101,.67,1);case "LineCallout3BorderAccent":return new vd.a(112,102,.67,1);case "LineCallout1NoBorder":return new vd.a(113,103,.67,1);case "LineCallout2NoBorder":return new vd.a(114,104,.67,1);case "LineCallout3NoBorder":return new vd.a(115,105,.67,1);case "Explosion1":return new vd.a(79,106,1,1);case "Explosion2":return new vd.a(80,107,1,1);case "Star4":return new vd.a(15,108,1,1);case "Star5":return new vd.a(16,15,1,1);case "Star6":return new vd.a(17,109,1,1);case "Star7":return new vd.a(18,110,
1,1);case "Star8":return new vd.a(19,111,1,1);case "Star10":return new vd.a(20,112,1,1);case "Star12":return new vd.a(21,113,1,1);case "Star16":return new vd.a(22,114,1,1);case "Star24":return new vd.a(23,115,1,1);case "Star32":return new vd.a(24,116,1,1);case "UpRibbon":return new vd.a(122,117,.67,1.33);case "DownRibbon":return new vd.a(121,118,.67,1.33);case "CurvedUpRibbon":return new vd.a(124,119,.83,1.33);case "CurvedDownRibbon":return new vd.a(123,120,.83,1.33);case "VerticalScroll":return new vd.a(126,
121,1.25,1.13);case "HorizontalScroll":return new vd.a(127,122,1.13,1.25);case "Wave":return new vd.a(128,123,1,1);case "DoubleWave":return new vd.a(129,124,1,1);case "Process":return new vd.a(131,125,.67,1);case "AlternateProcess":return new vd.a(158,126,.67,1);case "Decision":return new vd.a(132,127,.67,1);case "Data":return new vd.a(133,128,.67,1);case "PredefinedProcess":return new vd.a(134,129,.67,1);case "InternalStorage":return new vd.a(135,130,.67,.67);case "Document":return new vd.a(136,
131,.67,1);case "Multidocument":return new vd.a(137,132,.83,1.16);case "Terminator":return new vd.a(138,133,.33,1);case "Preparation":return new vd.a(139,134,.67,1.16);case "ManualInput":return new vd.a(140,135,.5,1);case "ManualOperation":return new vd.a(141,136,.67,1);case "Connector":return new vd.a(142,137,.5,.5);case "OffpageConnector":return new vd.a(159,138,.67,.67);case "Card":return new vd.a(143,139,.88,1);case "PunchedTape":return new vd.a(144,140,.88,1);case "SummingJunction":return new vd.a(145,
141,.67,.67);case "Or":return new vd.a(146,142,.67,.67);case "Collate":return new vd.a(147,143,1,.5);case "Sort":return new vd.a(148,144,1,.5);case "Extract":return new vd.a(149,145,.75,.75);case "Merge":return new vd.a(150,146,.75,.75);case "StoredData":return new vd.a(152,147,.67,1);case "Delay":return new vd.a(157,148,.67,.67);case "SequentialActionStorage":return new vd.a(153,149,.67,.67);case "MagneticDisk":return new vd.a(154,150,.67,1);case "DirectAccessStorage":return new vd.a(155,151,.75,
1);case "Display":return new vd.a(156,152,.67,1);default:return null}}}re.w_b=110;re.v_b=75;Object(h.a)(re,"ODSLShape",null,[722]);var Ih=d(686);class Le{constructor(fb,Qb,ac,Jc){this.PT=fb;this.pa=Qb;this.gf=ac;this.Mu=Jc;this.select=({scope:pd,index:qd=-1})=>Promise.resolve((sd=>{const ze=[];let Wd=null!==sd&&void 0!==sd?sd:"Selection";if("Selection"===Wd){const ye=this.pa.Qe();0<ye.length&&ze.push(...ye);0!==ze.length||sd||(Wd="Presentation")}if("Presentation"===Wd&&this.Yc){sd=this.Yc.s_.presentation.slides;
if(null===sd)throw Error("Could not cast from ISlide to ISlideNode on presentation slides.");ze.push(...sd)}return-1!==qd&&qd<ze.length?[ze[qd]]:ze})(pd));this.j7d=pd=>pd?pd.ij:this.Yc.s_.presentation.Q0[0].Id;this.h7d=pd=>{const qd=this.Yc.s_.presentation.Q0;for(let sd=0;sd<qd.length;sd++)if(pd===qd[sd].Id)return qd[sd].ContentMasters[0].Id;return 0};this.insert=({slides:pd})=>{if(!pd)throw Error("Could not insert slide due to invalid preceding slides");const qd=sd=>{if(!this.Yc)throw Error("Cannot insert slides without appForOfficeManager instance.");
const ze=[];for(var Wd of sd)sd=this.j7d(Wd),sd=this.Yc.s_.presentation.KYb(Wd,null,sd,this.h7d(sd)),ze.push(Object(Oa.a)(Id.a,sd));Wd=[];for(const ye of ze)Wd.push(new Promise(Yc=>xf.MVc(Yc,ye).bind(this)));return Promise.all(Wd)};return Promise.resolve(pd).then(sd=>qd(sd))};this.delete=({slides:pd})=>{if(!pd)throw Error.argumentNull("slides");const qd=sd=>{if(!this.Yc)throw Error("Cannot delete slides without appForOfficeManager instance.");for(const ze of sd)ze&&!this.gf.$c(ze)&&ze.isConnected&&
(this.pa.Rh(),this.Yc.s_.presentation.zI(ze),this.Mu.$kd(new Ih.a([ze])))};return Promise.resolve(pd).then(sd=>qd(sd))};if(!fb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Qb)throw Error.argumentNull("m_selectionManager");if(!ac)throw Error.argumentNull("m_actionBlockingManager");if(!Jc)throw Error.argumentNull("m_graphOperationEventNotifier");this.PT&&this.PT.execute(pd=>{this.Yc=pd})}format(){throw Error("Method not implemented.");}}Object(h.a)(Le,"ODSLSlide",null,[722]);var Cd=d(1237),
Lc;(function(fb){fb[fb.unattempted=0]="unattempted";fb[fb.inProgress=1]="inProgress";fb[fb.notHandled=2]="notHandled";fb[fb.handleExternally=4]="handleExternally";fb[fb.failed=8]="failed";fb[fb.error=16]="error";fb[fb.succeeded=32]="succeeded";fb[fb.delayed=64]="delayed"})(Lc||(Lc={}));Object(h.b)("ActionResponse",Lc);var Td=d(39),Ge=d(343),Xc=d(149);class jf{constructor(fb,Qb,ac,Jc,pd,qd,sd,ze,Wd,ye,Yc){this.ua=fb;this.pa=Qb;this.Zj=ac;this.Fa=Jc;this.Sk=pd;this.Ou=qd;this.M0=sd;this.gf=ze;this.ia=
Wd;this.Ms=ye;this.IHa=Yc;this.select=({scope:Ae,index:hd=-1})=>{const oe=Xe=>{let Ke=[],me=[],Uf=null!==Xe&&void 0!==Xe?Xe:"Selection";if("Selection"===Uf){var yf=this.pa.an();yf?me.push(yf):(yf=this.pa.Qe(),0<yf.length&&this.IHa.mLb(14,yf,Ke),0!=Ke.length||Xe||(Uf="Presentation"))}if(Array.isArray(Uf)&&0<Uf.length&&Uf[0]instanceof Id.a)this.IHa.mLb(14,Uf,Ke);else if("Presentation"===Uf&&this.ua.presentation){Xe=this.ua.presentation.slides;if(null===Xe)throw Error("Could not cast from ISlide to ISlideNode on presentation slides");
this.IHa.mLb(14,Xe,Ke)}me.push(...Ke.map(Cf=>Cf.node));return-1!==hd&&hd<me.length?[me[hd]]:me};return Ae instanceof Promise?Ae.then(Xe=>oe(Xe)):Promise.resolve(oe(Ae))};this.format=({tables:Ae,table:hd,color:oe,fillColor:Xe,styles:Ke,cellColor:me,border:Uf,borderColor:yf,mergeCells:Cf,splitCells:Ld})=>{Ae=null!==Ae&&void 0!==Ae?Ae:hd;if(!Ae)throw Error.argumentNull("tables");const od=ug=>{var Kf;let Vf=!1;var Ch=!1,xg=!1;for(const Oi of ug){let ph=this.pa.yv();1===ug.length&&ph&&0<ph.length?Vf=!0:
ph=Oi.q$a();ph.filter(Dh=>!Dh.isGhostCell);var lh=this.gmj(null!==(Kf=null!==Ke&&void 0!==Ke?Ke:Xe)&&void 0!==Kf?Kf:oe);lh&&0<lh.length&&Oi.setValue(Td.a.jza,na.a.Gf(lh));if(me&&Qe.ZDf(me)&&!Ch){Ch=this.X$d(me);for(const Dh of ph)lh=Dh.cellShading,Ge.b(lh),lh.solidFillField=Ch,Dh.cellShading=lh;Ch=Vf&&1===ug.length}if((Uf||yf)&&!xg){if(Uf)xg=yf&&Qe.ZDf(yf)?this.X$d(yf):void 0,this.ia.La(Vc.a.fpa,Cd.a.execute,{["TableNode"]:Oi,["CellNodes"]:ph,["SourceControlId"]:this.y9a(Uf),["BorderColor"]:xg,["DoNotCreateTransaction"]:!0});
else{xg=Qe.JQa(yf);this.ia.La(Vc.a.b1a,Cd.a.execute,{["TableNode"]:Oi,["Color"]:xg});xg=this.X$d(yf);for(const Dh of ph)Xc.Box4ColorHelper.Aab(Dh.GLa)||(Dh.GLa=xg),Xc.Box4ColorHelper.Aab(Dh.zga)||(Dh.zga=xg),Xc.Box4ColorHelper.Aab(Dh.FLa)||(Dh.FLa=xg),Xc.Box4ColorHelper.Aab(Dh.Aga)||(Dh.Aga=xg)}xg=Vf&&1===ug.length}(Cf||Ld)&&Vf&&this.ia.La(Cf?Vc.a.mergeTableCells:Vc.a.splitTableCells,Cd.a.execute,{["rows"]:1,["columns"]:2})}};return Promise.resolve(Ae).then(ug=>od(ug))};this.lIj=Ae=>{Ae=Object.assign(new Ib.a,
{TMb:!1,d1a:[Ae]});if(this.ia.La(Vc.a.xxa,Cd.a.execute,Ae)!==Lc.succeeded)throw Error("Table insertion from HTML failed.");return this.pa.kp()};this.nIj=(Ae,hd,oe)=>{const Xe=[];if(!hd||Number.isNaN(hd)||!oe||Number.isNaN(oe))throw Error("Invalid rows and columns provided.");this.pa.ey();this.pa.Rh();this.Fa.Ed();for(const me of Ae){Ae=me.node;if(!Ae)throw Error("Cannot find selected slide to insert table.");if(!this.gf.$c(Ae)){if(!this.Zj.OF(Ae,1))throw this.Zj.mG(Ae),Error("Too many shapes on the slide.");
var Ke=Ae.Cb;Ke=Ae.j3(Ke.sid,Ke.cid,0,hd,oe,Ae.Wt());Xe.push(Ke);this.Ms.HW([Ke],Ae,null);this.Ou.SF=Ke}}return Xe};this.insert=({slides:Ae,rows:hd,columns:oe,html:Xe})=>{if(!Ae)throw Error("No slide context provided to insert table.");const Ke=me=>{const Uf=[];Xe?Uf.push(this.lIj(Xe)):Uf.push(...this.nIj(me,hd,oe));me=[];for(const yf of Uf)me.push(new Promise(Cf=>xf.MVc(Cf,yf,!0).bind(this)));return Promise.all(me)};return Promise.resolve(Ae).then(me=>Ke(me))};this.delete=({tables:Ae})=>{if(!Ae)throw Error.argumentNull("tables");
const hd=oe=>{for(var Xe of oe)oe=this.pa.kp(),oe&&oe.ud&&this.gf.$c(oe)||(oe=Object(Oa.a)(4,Xe),this.Sk.QNc(oe));(Xe=this.ua.Ba)&&this.gf.hw(Xe,"handleDeleteTable")};return Promise.resolve(Ae).then(oe=>hd(oe))};if(!fb)throw Error.argumentNull("m_graphTopologyManager");if(!Qb)throw Error.argumentNull("m_selectionManager");if(!ac)throw Error.argumentNull("m_shapeCountValidator");if(!Jc)throw Error.argumentNull("m_focusManager");if(!pd)throw Error.argumentNull("m_shapeEditor");if(!qd)throw Error.argumentNull("m_ribbonChangeManager");
if(!sd)throw Error.argumentNull("m_tableStyleGalleryManager");if(!ze)throw Error.argumentNull("m_actionBlockingManager");if(!Wd)throw Error.argumentNull("m_actionManager");if(!ye)throw Error.argumentNull("m_transactionHelper");if(!Yc)throw Error.argumentNull("m_odslGraphUtils");}Hnj(){var fb=this.pa.Qe();return fb&&0!=fb.length?(fb=fb[0])?fb.Jd:null:null}M6i(fb,Qb){fb=Qe.O6i(fb);return(Math.abs(fb.r-Qb.r)^2)+(Math.abs(fb.g-Qb.g)^2)+(Math.abs(fb.b-Qb.b)^2)}gmj(fb){if(!fb)return"";var Qb=fb.toLowerCase();
this.M0.Z1d();fb=this.M0.IRc();if(!fb||!fb.length)return"";if(Qb.includes("transparent")||Qb.includes("none")){var ac=fb[0].Mh(Td.a.tableStyle);return ac.dY?ac.dY.styleIdField:""}Qb=Qe.JQa(Qb);if(!Qb.length)return"";const Jc=this.Hnj();if(!Jc)return"";let pd=999999,qd="";for(let ze=0;7>ze;++ze){const Wd=fb[ze].Mh(Td.a.tableStyle);if(!Wd.dY)continue;var sd=null!==(ac=Wd.dY.firstRowField)&&void 0!==ac?ac:Wd.dY.wholeTblField;if(!sd||!sd.tcStyleField)continue;sd=sd.tcStyleField.fillField;if(!sd||sd.noFillField)continue;
let ye;sd.solidFillField?ye=Xc.Box4ColorHelper.KH(Xc.Box4ColorHelper.pga(sd.solidFillField),Jc):sd.gradFillField&&(ye=Ge.f(sd.gradFillField,Jc).stops[0].color);ye&&(sd=this.M6i(Qb,ye),sd<=pd&&(pd=sd,qd=Wd.dY.styleIdField))}return qd}X$d(fb){const Qb={};Qb.Color=Qe.JQa(fb);return Xc.Box4ColorHelper.YR(Qb)}y9a(fb){fb=fb.toLowerCase();if(fb.includes("no"))return"TableBordersNoBorder";if(!fb.includes("all")){if(fb.includes("outside"))return"TableBordersOutsideBorders";if(fb.includes("horizontal"))return"TableBordersInsideHorizontalBorder";
if(fb.includes("vertical"))return"TableBordersInsideVerticalBorder";if(fb.includes("inside"))return"TableBordersInsideBorders";if(fb.includes("top"))return"TableBordersTopBorder";if(fb.includes("bottom"))return"TableBordersBottomBorder";if(fb.includes("left"))return"TableBordersLeftBorder";if(fb.includes("right"))return"TableBordersRightBorder";if(fb.includes("up"))return"TableBordersDiagonalUpBorder";if(fb.includes("down"))return"TableBordersDiagonalDownBorder";if(fb.includes("diagonal"))return"TableBordersDiagonalUpBorder"}return"TableBordersAllBorders"}}
Object(h.a)(jf,"ODSLTable",null,[722]);var Mh=d(41),bd=d(92),Bc=d(184),Hf=d(717),Me=d(1011);class Tf{constructor(fb,Qb,ac,Jc,pd,qd,sd,ze){this.PT=fb;this.pa=Qb;this.mi=ac;this.Qva=Jc;this.Ea=pd;this.pJ=qd;this.lJ=sd;this.IHa=ze;this.select=({scope:Wd,text:ye,index:Yc=-1})=>{const Ae=hd=>{const oe=[];let Xe=[];var Ke=null!==hd&&void 0!==hd?hd:"Selection";if("Selection"===Ke){var me=this.pa.Na.mb;me?(me=me.toArray().filter(Uf=>he.ParagraphReader.ae(Uf.node)),0<me.length?oe.push(...me):(me=this.pa.Xd(),
0<me.length&&this.IHa.PUe(12,me,oe))):this.IHa.mLb(12,this.pa.Qe(),oe);0!==oe.length||hd||(Ke="Presentation")}if(Array.isArray(Ke)&&0<Ke.length&&Ke[0]instanceof Id.a)this.IHa.mLb(12,Ke,oe);else if(Array.isArray(Ke)&&0<Ke.length&&Ke[0]instanceof Me.a)this.IHa.PUe(12,Ke,oe);else if("Presentation"===Ke&&this.Yc){hd=this.Yc.s_.presentation.slides;if(null===hd)throw Error("Could not cast from ISlide to ISlideNode on presentation slides.");this.IHa.mLb(12,hd,oe)}if(ye)for(const Uf of oe){hd=he.ParagraphReader.text(Uf.node);
hd=this.matchAll(hd,ye);for(const yf of hd)yf[0]&&void 0!==yf.index&&(hd=yf.index,Ke=yf.index+yf[0].length,me=xh.a.Mj(Uf.node,hd),this.lJ.F_e(me),me=xh.a.Mj(Uf.node,Ke+1),this.lJ.F_e(me),Xe.push(xh.a.createTextRange(Uf.node,hd,Ke)))}else Xe=oe;-1!==Yc&&Yc<oe.length&&(Xe=[Xe[Yc]]);return Xe};return Wd instanceof Promise?Wd.then(hd=>Ae(hd)):Promise.resolve(Ae(Wd))};this.tal=(Wd,ye)=>{const Yc=new Jf.GraphIterator;Yc.set(Wd);Yc.rc(11);Yc.Jg(11);Wd=Wd.Rf.lw(Yc);const Ae=ye?1:16;ye=ye?1:0;Wd?Wd.zya(Ae,
ye):(ye=Bc.a.yN(Ae,ye),this.pJ.SPa(Yc,ye))};this.icl=(Wd,ye)=>{switch(ye){case "Left":ye=1;break;case "Center":ye=2;break;case "Right":ye=3;break;case "Distributed":ye=7;break;case "Justify":ye=6;break;default:ye=1}this.Qva.$J(Wd,ye)};this.Agl=(Wd,ye)=>{if(Wd=this.Ea.en(Wd)){switch(ye){case "Top":ye=0;break;case "Middle":ye=1;break;case "Bottom":ye=2;break;default:ye=0}Wd.setValue(Td.a.kP,ye)}};this.format=({textRanges:Wd,color:ye,bold:Yc,italic:Ae,underline:hd,fontName:oe,size:Xe,bulleted:Ke,horizontalAlignment:me,
verticalAlignment:Uf})=>{if(!Wd)throw Error.argumentNull("textRanges");const yf=Cf=>{if(Cf&&0<Cf.length)for(const Ld of Cf){Cf=[];if(Ld.contextId===Mh.a.paragraph){const od=bd.a.g_f(Ld.node,!1);for(const ug of od)Cf.push(ug.formatting)}else Cf.push(bd.a.xs(Ld));for(const od of Cf)od&&(ye&&(Cf=Qe.JQa(ye),ye=""===Cf?ye:Cf,this.mi.Sr(od,ye,null)),void 0!==Yc&&this.mi.OH(od,Yc),void 0!==Ae&&this.mi.setItalic(od,Ae),hd&&this.mi.PY(od,"None"!==hd),oe&&this.mi.YU(od,oe),void 0!==Xe&&this.mi.Pq(od,2*Xe),
void 0!==Ke&&this.tal(Ld.node,Ke),me&&this.icl(Ld.node,me),Uf&&this.Agl(Ld.node,Uf))}};return Promise.resolve(Wd).then(Cf=>yf(Cf))};this.insert=({precededBy:Wd,text:ye})=>{if(!Wd)throw Error.argumentNull("precededBy");const Yc=Ae=>{const hd=[];for(var oe of Ae){Ae=oe.node;const Xe=xh.a.Mj(Ae,-1===oe.Lb?Ae.characterData.length:oe.Lb+1);this.lJ.replaceTextRange(Xe,ye,!0);Ae=xh.a.createTextRange(Ae,oe.Lb+1,oe.Lb+ye.length);hd.push(Ae)}oe=[];for(const Xe of hd)oe.push(new Promise(Ke=>xf.MVc(Ke,Xe).bind(this)));
return Promise.all(oe)};return Promise.resolve(Wd).then(Ae=>Yc(Ae))};this.delete=({textRanges:Wd})=>{if(!Wd)throw Error.argumentNull("textRanges");const ye=Yc=>{for(let Ae of Yc)Ae.node instanceof Hf.a&&Ae.contextId!==Mh.a.textRange&&(Ae=xh.a.createTextRange(Ae.node,0,Ae.node.characterData.length)),this.lJ.replaceTextRange(Ae,"",!0)};return Promise.resolve(Wd).then(Yc=>ye(Yc))};if(!fb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Qb)throw Error.argumentNull("m_selectionManager");if(!ac)throw Error.argumentNull("m_formattingEditor");
if(!Jc)throw Error.argumentNull("m_paragraphEditor");if(!pd)throw Error.argumentNull("m_shapeReader");if(!qd)throw Error.argumentNull("m_listEditor");if(!sd)throw Error.argumentNull("m_characterPropertiesEditor");if(!ze)throw Error.argumentNull("m_odslGraphUtils");this.PT&&this.PT.execute(Wd=>{this.Yc=Wd})}matchAll(fb,Qb){Qb=Qb instanceof RegExp?Qb:new RegExp(Qb,"g");const ac=[];let Jc;for(;null!==(Jc=Qb.exec(fb));)ac.push(Jc);return ac}}Object(h.a)(Tf,"ODSLText",null,[722]);d(90);class Sd{constructor(fb,
Qb,ac){this.PT=fb;this.pa=Qb;this.Ea=ac;if(!fb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Qb)throw Error.argumentNull("m_selectionManager");if(!ac)throw Error.argumentNull("m_shapeReader");this.PT&&this.PT.execute(Jc=>{this.Yc=Jc})}}Object(h.a)(Sd,"ODSLContext",null,[718]);class lf extends Tc{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){n.AFrameworkApplication.Tya&&this.eQi()}Zb(fb){super.Zb(fb);fb.register(vc.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().oa(()=>
new vc.a);fb.register(db,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").ma().oa(()=>new db(fb.resolve("Common.App.Insights.IInsightsSelection"),fb,fb.resolve("Common.IAppSettingsManager"),fb.resolve("Common.IActionManagerExtended"),fb.Ja("PowerPointWebEditor.IAppForOfficeManager")));fb.register(671,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").ma().oa(()=>new rb.a(new e.a(()=>wb.App.Kb?wb.App.Kb.Ld.zi:
null),Rb.InteractiveViewManager.instance,fb.resolve("Box4.ISelectionFactory"),fb.resolve("PowerPointWebEditor.ISlideReader"),fb.resolve("PowerPointWebEditor.IPPTWorkspace"),fb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new r.a,fb.resolve("Common.IActionManagerExtended"),fb.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.resolve("PowerPointWebEditor.IClipServiceManager"),fb.resolve("PowerPointWebEditor.IPresentationReader")));n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",
!1)&&(fb.register(xf,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").ma().oa(()=>new xf(fb.resolve("Box4.Graph.IGraphIteratorFactory"),fb.resolve("Box4.IOutlineEditor"),fb.resolve("Box4.IOutlineElementNavigator"),fb.resolve("Box4.ICharacterPropertiesEditor"))),fb.register(Tf,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").ma().oa(()=>new Tf(fb.Ja("PowerPointWebEditor.AppForOfficeManager"),
fb.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.resolve("Box4.IFormattingEditor"),fb.resolve("Box4.IParagraphEditor"),fb.resolve("PowerPointWebEditor.IShapeReader"),fb.resolve("Box4.List.IListEditor"),fb.resolve("Box4.ICharacterPropertiesEditor"),fb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),fb.register(re,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").ma().oa(()=>new re(fb.Ja("PowerPointWebEditor.AppForOfficeManager"),
fb.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),fb.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),fb.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),fb.resolve("PowerPointWebEditor.IShapeReader"),fb.resolve("PowerPointWebEditor.IShapeEditor"),fb.resolve("PowerPointWebEditor.IPPTUnitConversion"),fb.resolve("PowerPointWebEditor.View.IPPTPageView"),fb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),
fb.resolve("PowerPointWebEditor.IRibbonChangeManager"))),fb.register(Le,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").ma().oa(()=>new Le(fb.Ja("PowerPointWebEditor.AppForOfficeManager"),fb.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),fb.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),fb.register(Pc,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").ma().oa(()=>
new Pc(fb.Ja("PowerPointWebEditor.AppForOfficeManager"),fb.resolve("PowerPointWebEditor.IPptSelectionManager"))),fb.register(jf,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").ma().oa(()=>new jf(fb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),fb.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),fb.resolve("PowerPointWebEditor.IFocusManager"),
fb.resolve("PowerPointWebEditor.IShapeEditor"),fb.resolve("PowerPointWebEditor.IRibbonChangeManager"),fb.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),fb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),fb.resolve("Common.IActionManagerExtended"),fb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),fb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),fb.register(Sd,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLContext").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext").ma().oa(()=>
new Sd(fb.Ja("PowerPointWebEditor.AppForOfficeManager"),fb.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.resolve("PowerPointWebEditor.IShapeReader"))),fb.register(zc,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLInterpreter").as("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter").ma().oa(()=>new zc(fb.Ja("PowerPointWebEditor.AppForOfficeManager"),fb.resolve("Common.Transaction.ITransactionFactory"),fb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),fb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),
fb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),fb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"),fb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"))));fb.register(672,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").ma().oa(()=>new Bd(fb.resolve("Common.IActionManagerExtended"),fb.rb("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter"),fb.rb("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext")));
fb.register(673,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").ma().oa(()=>new gc(n.AFrameworkApplication.Ta,fb.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));fb.register(674,"Common.App.SearchCommon.IDocumentHelper").ma().oa(()=>new Be);n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotUxIsEnabled",!1)&&(fb.register(Kd,"PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.FABDictationHost").ma().oa(()=>
new Kd(fb.resolve("PowerPointWebEditor.IPPTWorkspace"),fb.resolve("Common.IActionManagerExtended"),v.a.instance,B.FocusManager.instance(),fb.Ja("Common.App.Insights.InsightsActor"))),fb.resolve("PowerPointWebEditor.SmartLookup.PptCopilot"))}static main(){y.a.instance.Dc(new lf)}}Object(h.a)(lf,"PptSmartLookupPackage",Tc,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");lf.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.smartlookup.js.map