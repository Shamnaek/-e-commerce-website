'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1242:function(J,aa,d){d.r(aa);var h=d(0),e=d(18),r=d(387),n=d(273);class v{constructor(){this.kPh=new e.a}get kJc(){return this.kPh}Afj(M){r.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",M);const N=new e.a;for(let Ia of this.kJc)for(let lb of Ia.$jc)lb.id===M&&N.add(lb);return N}ali(){var M=this.Afj("ContextMenuText");if(M&&0<M.count){const N=Object.assign(new n.a,{ControlList:[]});for(let Ia of M)M=
Ia.Qtc(),0<M.length&&Array.addRange(N.ControlList,M);return N}return null}Usf(M){this.kJc.add(M)}ZXk(M){for(let N of this.kJc)if(N.swf===M.swf){this.kJc.remove(N);break}}static TNi(M,N,Ia=null){M=v.A7i(M);0<M.length&&(v.jpd(M,!1),Ia&&Ia(N,M))}static A7i(M){const N=[];if(M&&M.$jc&&0<M.$jc.count)for(let Ia of M.$jc)if(Ia.controls&&0<Ia.controls.count)for(let lb of Ia.controls)if(lb.menuItems&&0<lb.menuItems.count)for(let Sb of lb.menuItems)Array.add(N,Sb.id);return N}static jpd(M,N){if(M.length){var Ia=
[];for(const lb of M)Ia.push(appChrome.actions.updateControlEnabledDisabledState(lb,N));appChrome.api.dispatch(Ia)}}}Object(h.a)(v,"ContextMenuExtensibilityCache",null,[915,916]);var B=d(27),y=d(373),x=d(107),A=d(71),E=d(14);class u{constructor(M,N,Ia){this._id=M;this.NNh=N;this.SPh=Ia;this.Ogg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get wQd(){return this.NNh}get Jwi(){return this.SPh}execute(M,N,Ia){Ia=Ia||{};Ia.commandMode=this.Ogg;N.invokeAppCommand(this.wQd,this.Jwi,Ia,(lb,
Sb)=>{M.w5g(this.id,this.wQd,lb,Sb)})}}Object(h.a)(u,"AddinNativeActionBase",null,[909]);class K extends u{constructor(M,N){super(1,M,N);this.Ogg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(h.a)(K,"AddinTakeSnapshotAction",u,[]);class G{XJf(M,N){let Ia=null;switch(M){case 1:Ia=new K(N,this.S5d().getNativeActionName(M));break;case 2:Ia=new u(2,N,this.S5d().getNativeActionName(M));break;case 3:Ia=new u(3,N,this.S5d().getNativeActionName(M))}return Ia}S5d(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(h.a)(G,"AddinNativeActionManager",null,[891]);class O{invokeAppCommand(M,N,Ia,lb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,N,Ia,lb)}static getInstance(){O.Ka||(O.Ka=new O);return O.Ka}}O.Ka=null;Object(h.a)(O,"OSFAddinCommandsRuntimeManager",null,[890]);var R=d(78);class V{constructor(){this.iRf=this.displayName=this.c1b=this.WJ=this.vM=null;this.isUpgraded=!1}Nmg(M,N){return this.vM.getStoreType().toLowerCase()===M.toLowerCase()&&this.vM.getSolutionId().toLowerCase()===N.toLowerCase()}}
Object(h.a)(V,"AddinCommandsResourceItem",null,[]);class D{constructor(){this.zxd=null;this.xCd=0;this.WDd=!1;this.Pa=new R.a;this.pUh=new e.a}F9h(M){this.Pa.addHandler("AddinCommandsLoadingMessageChanged",M)}get aZb(){return this.zxd}yMb(M){M!==this.zxd&&(this.zxd=M,this.Pa.raiseEvent("AddinCommandsLoadingMessageChanged"))}lal(){this.xCd++;this.aZb||this.yMb(CommonUIStrings.l_LoadingAddInsTitle)}UVe(){this.xCd--;this.r2c()&&(this.WDd?this.aZb!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.yMb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.yMb(null))}Fbl(){this.WDd=!0;this.yMb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}JFf(){this.WDd=!1;this.r2c()?this.yMb(null):this.yMb(CommonUIStrings.l_LoadingAddInsTitle)}r2c(){return 0>=this.xCd}get Vyb(){return this.pUh}W8a(M,N,Ia=0){for(let lb of this.Vyb)if(lb.Nmg(M,N)&&(!lb.WJ||lb.WJ.w3i===Ia))return lb;return null}Htf(M,N,Ia,lb){const Sb=new V;Sb.vM=M;Sb.WJ=N;Sb.c1b=Ia;Sb.displayName=lb;this.Vyb.add(Sb)}E7h(M,N,Ia,lb){const Sb=new V;Sb.vM=M;Sb.WJ=N;Sb.c1b=null;Sb.iRf=Ia;Sb.displayName=
lb;this.Vyb.add(Sb)}HXk(M,N){let Ia=0;for(let lb of this.Vyb)lb.vM.getStoreType()===M&&lb.vM.getSolutionId()===N?this.Vyb.removeAt(Ia):Ia++}static getInstance(){D.Ka||(D.Ka=new D);return D.Ka}}D.Ka=null;Object(h.a)(D,"AddinCommandsResourceManager",null,[]);var Q=d(210),Z=d(449),P=d(172),ca=d(142);class T extends Sys.EventArgs{constructor(){super();this.WJ=this.Ju=null}}Object(h.a)(T,"InsertionParamEventArgs",Sys.EventArgs,[]);class da{constructor(M,N,Ia,lb,Sb,Wc){this.vx=M;this.Ju=N;this.vaa=Ia;this.displayName=
Sb;this.vpg=Wc}}Object(h.a)(da,"PostLaunchAddinCommandsParameters",null,[]);var fa=d(36),ma=d(47),ea=d(1204);class ra{constructor(M,N,Ia,lb=null){this.Bpc=B.AFrameworkApplication.fa.Ga("RoamingServiceHandlerWebServiceBase");this.appName=M;this.aTb=N;this.YSb=Ia;this.VVb=lb}zPc(M){this.WUi(M,Object(E.a)(this,this.oEa,"getRequestSuccessCallback"),Object(E.a)(this,this.nka,"getRequestFailureCallback"))}WUi(M,N,Ia){const lb=new Sys.StringBuilder(this.Bpc);lb.append("RoamingServiceHandler.ashx?action=");
lb.append("getAddinTeachingCalloutSettings");lb.append("&");lb.append(this.W9d(M));lb.append("&");lb.append(B.AFrameworkApplication.hh);B.AFrameworkApplication.Ke.nj(lb.toString(),1,null,null,!0,2,N,Ia,null)}zvb(M){this.cVi(M)}cVi(M){var N=new Sys.StringBuilder(this.Bpc);N.append("RoamingServiceHandler.ashx?action=");N.append("saveAddinTeachingCalloutSettings");N.append("&");N.append(B.AFrameworkApplication.hh);N=N.toString();M=fa.c(M);B.AFrameworkApplication.Ke.nj(N,2,M,null,!0,4,null,Object(E.a)(this,
this.kaa,"postRequestFailureCallback"),null)}oEa(M){let N=!1,Ia=null;try{if(0<M.data.Wd.length){const lb=Object(ea.a)(Object,fa.a(M.data.Wd)),Sb=lb?lb[this.appName]:null;Sb&&(Ia=Object(ea.a)(Object,fa.a(Sb.toString())))}N=!0}catch(lb){this.nka(null)}N&&this.aTb&&this.aTb(Ia)}nka(M){this.YSb&&this.YSb(M?M.data:null)}kaa(M){this.VVb&&this.VVb(M?M.data:null)}W9d(M){const N=new Sys.StringBuilder("requestedsettings=");for(let Ia=0;Ia<M.count;Ia++)N.append(M.ga(Ia)),Ia<M.count-1&&N.append(";");return N.toString()}}
Object(h.a)(ra,"AddinTeachingUIRoamingRequestHandler",null,[]);var F=d(182);class na{constructor(M,N,Ia){this.Apc=!1;this.mba=null;this.Pa=M;this.DTb=N;this.vQb=Ia}aPd(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(E.a)(this,this.FIe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(E.a)(this,this.UHe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(E.a)(this,this.FHe,"onCloseButtonClickedEventHandler"),
!0),window.addEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.hkc,"onCampaignLaunchedHandler"),!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}FIe(){const M={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:na.tQ(this.DTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.vQb&&this.vQb.tabs&&!this.vQb.tabs[0].isOfficeTab&&(M["SDX.FeatureFlags"]="NonOfficeTab");ca.a.sendTelemetryEvent(Object.assign(new F.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:P.a.sC(M)}));this.VIa();this.vQb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.vQb,()=>{const N=new T;N.Ju=this.DTb;this.Pa.raiseEvent(Q.a.aoe,N)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}FHe(){const M={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:na.tQ(this.DTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:P.a.sC(M)}));this.VIa()}UHe(){const M={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:na.tQ(this.DTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:P.a.sC(M)}));this.VIa()}hkc(M){if(M&&(M=M.detail)&&M.id&&this.qje(M.id)){const Ia=
(M.action||"").toLowerCase();if(M.success&&"opened"===Ia){var N={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:na.tQ(this.DTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:P.a.sC(N)}));r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.VIa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(E.a)(this,this.hkc,"onCampaignLaunchedHandler"),!0)}else try{N=JSON.stringify(M),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+N)}catch(lb){N="id : "+M.id+" telemetryEventName: "+M.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+N+" Error: "+(lb?lb.toString():""))}}}qje(M){M=ma.a.rg(M);return-1!==M.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==M.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==M.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==M.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==M.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==M.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}I_a(M){const N=B.AFrameworkApplication.fa.Ga("WebAppShortName");if(N){const Ia={},lb={};lb.LastTeachingUIShowTime=(new Date).toUTCString();lb.AddinHasShown=M;Ia[N]=fa.c(lb);this.mba=new ra(N,null,null,Object(E.a)(this,this.kaa,"postRequestFailureCallback")),this.mba.zvb(Ia),r.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}VIa(){if(!this.Apc){const M=window.g_roamingAddinList;M&&(this.I_a(M),this.Apc=!0)}}kaa(M){r.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",M?M.ie:-1)}static tQ(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}}Object(h.a)(na,"PrivateCatalogTeachingCalloutHandler",null,[]);var ka=d(15),Ua=d(16),za=d(971);class ha{constructor(){this.addinId=
null;this.targetType=0;this.solutionId=null}}Object(h.a)(ha,"AddinAbstract",null,[]);class ua extends Sys.EventArgs{constructor(M){super();this.solutionId=M.solutionId;this.assetId=M.assetId;this.storeType=M.storeType;this.storeId=M.storeId;this.assetStoreId=M.assetStoreId;this.targetType=M.targetType;this.width=M.width;this.height=M.height;this.displayName=M.displayName;this.version=M.version}}Object(h.a)(ua,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Ga=d(125);class sa{constructor(M){this.Crb=
this.Ju=null;this.Apc=!1;this.fNa=this.hwc=this.kKa=this.vl=this.mba=this.r1=null;this.Lp=M}get appName(){return B.AFrameworkApplication.fa.Ga("WebAppShortName")}get Vvf(){this.mba||(this.mba=new ra(this.appName,Object(E.a)(this,this.oEa,"getRequestSuccessCallback"),Object(E.a)(this,this.nka,"getRequestFailureCallback"),Object(E.a)(this,this.kaa,"postRequestFailureCallback")));return this.mba}get NPa(){this.hwc||(this.hwc=new e.a);return this.hwc}set NPa(M){this.hwc=M}get A7a(){this.fNa||(this.fNa=
new e.a);return this.fNa}set A7a(M){this.fNa=M}aPd(M,N){window.addEventListener?(this.Ju=M,this.Crb=N,window.addEventListener("LaunchAddinTaskpane",Object(E.a)(this,this.FIe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(E.a)(this,this.UHe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(E.a)(this,this.FHe,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.hkc,"onCampaignLaunchedHandler"),
!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Kzl(M,N,Ia,lb){this.vl=M;this.NPa=N;this.A7a=Ia;this.kKa=lb;r.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",N?N.count.toString():"null",Ia?Ia.count.toString():"null");0<this.NPa.count||0<this.A7a.count?(M=new e.a,M.add(this.appName),this.Vvf.zPc(M)):this.kKa(new e.a,null)}FIe(){const M=new ka.ScriptSharpLegacyMap;this.Crb&&
this.Crb.tabs&&!this.Crb.tabs[0].isOfficeTab&&M.$("SDX.FeatureFlags","NonOfficeTab");this.bGa(sa.tQ(this.Ju),"ClickOnLaunch",M);this.VIa();this.Crb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Crb,()=>{const N=new T;N.Ju=this.Ju;this.Lp.raiseEvent(Q.a.aoe,N)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}FHe(){this.bGa(sa.tQ(this.Ju),"ClickOnClose");this.VIa()}UHe(){this.bGa(sa.tQ(this.Ju),"ClickOnDismiss");this.VIa()}hkc(M){if(M&&
(M=M.detail)&&M.id&&this.qje(M.id)){const N=(M.action||"").toLowerCase();if(M.success&&"opened"===N)this.bGa(sa.tQ(this.Ju),"CampaignLaunched"),r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.VIa(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.hkc,"onCampaignLaunchedHandler"),!0);else{let Ia;try{Ia=JSON.stringify(M),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ia)}catch(lb){Ia=
"id : "+M.id+" telemetryEventName: "+M.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ia+" Error: "+(lb?lb.toString():""))}}}}qje(M){M=ma.a.rg(M);return-1!==M.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==M.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==M.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==M.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==M.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==M.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}I_a(M){if(this.appName){const N=
{},Ia={};Ia.LastTeachingUIShowTime=(new Date).toUTCString();Ia.AddinHasShown=M;N[this.appName]=fa.c(Ia);this.Vvf.zvb(N);r.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}VIa(){if(!this.Apc){const M=window.g_roamingAddinList;M&&(this.I_a(M),this.Apc=!0)}}oEa(M){M?this.EYe(M)?(r.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),
this.r1="AddinHasShown"in M&&M.AddinHasShown?M.AddinHasShown.toString():null,this.Q0b()):(r.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.kKa(this.NPa,null)):(r.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.r1=null,this.Q0b())}nka(M){r.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",M?M.ie:-1);this.kKa(this.NPa,null)}kaa(M){r.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
M?M.ie:-1)}Q0b(){const M=this.a0d();0===M.targetType?(M.solutionId?this.XNe(M):this.bGa(null,"NoSolutionId"),this.EIh(M),this.kKa(this.NPa,null)):this.kKa(this.NPa,M);r.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",M.addinId)}XNe(M){const N=new za.a;N.callbackFunc=Ia=>{if(Ia.errorCode){this.bGa(M.solutionId,"FailToGetAppDetails");var lb=window.g_roamingAddinList;lb&&this.I_a(lb)}else if(Ia.value)for(lb of Ia.value)if(Ia=lb[1],Ia===M.solutionId){const Sb={};Sb.solutionId=Ia;Sb.assetId=
lb[5];Sb.storeType=lb[12];Sb.storeId=lb[11];Sb.assetStoreId=lb[6];Sb.targetType=lb[3];Sb.width=lb[7];Sb.height=lb[8];Sb.displayName=lb[0];Sb.version=lb[4];r.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",M.solutionId);lb=new ua(Sb);this.Lp.raiseEvent(Q.a.SYe,lb);break}};N.storeType=OSF.StoreTypeEnum.PrivateCatalog;N.fromInsertDialog=!1;N.refresh=!1;this.vl.queryEntitlementDetails(N)}EYe(M){if("LastTeachingUIShowTime"in M){if(M=+new Date-+new Date(M.LastTeachingUIShowTime.toString()),
M<B.AFrameworkApplication.fa.rQ("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",M),!1}else r.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}a0d(){let M=new Ua.a(new ha,0),N=new Ua.a(new ha,0),Ia=0,lb=0,Sb=0;var Wc=new e.a;for(var td of this.NPa)Wc.add(td);for(let wd of this.A7a)Wc.add(wd);for(let wd of Wc)if(!("excatalog"!==wd.storeType||Ga.b(wd.installTimeInMS)||!wd.installTimeInMS||
wd.installTimeInMS<=B.AFrameworkApplication.fa.rQ("DateTimeInMSForNewAddin",16409952E5))){Wc=sa.h5b(wd);if(this.r1&&(td=this.r1.split(","),0<td.length&&Array.contains(td,Wc))){Sb++;r.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Wc.startsWith("private_")?(M=sa.a4f(wd,M),lb++):(N=sa.a4f(wd,N),Ia++)}r.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",lb,Ia,Sb);return 0<N.value?N.key:
0<M.value?M.key:Object.assign(new ha,{addinId:null,targetType:-1,solutionId:null})}bGa(M,N,Ia=null){M={["AppTeachingUICalloutAction"]:N,["SDX.Id"]:M,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ia)for(let lb of Ia.keys)M[lb]=Ia.ga(lb);ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:P.a.sC(M)}))}EIh(M){M&&(window.g_roamingAddinList=this.r1?this.r1+","+M.addinId:M.addinId)}static tQ(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.storeType,M.assetId,null,null,M.storeId)}static a4f(M,N){return N.value<M.installTimeInMS?new Ua.a(Object.assign(new ha,{addinId:sa.h5b(M),targetType:M.targetType,solutionId:M.solutionId}),M.installTimeInMS):N}static h5b(M){return Telemetry.PrivacyRules.IsPrivateAddin(M.storeType,M.assetId,null,null,M.storeId)?"private_"+M.installTimeInMS:M.solutionId}}Object(h.a)(sa,"PrivateCatalogTeachingCalloutHandler2",null,[]);class Ba{constructor(M){this.qhf=null;this.Nef=M}get rVa(){return this.qhf}lrb(M,
N=null){this.Nef.lrb(M,N);this.qhf=M}sRe(M){this.Nef.sRe(M)}}Object(h.a)(Ba,"RibbonExtensibilityManagerWithChangeDetection",null,[930]);var pa=d(81);const ia=()=>{const M=pa.a.qxb(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"4"===M},Da=()=>pa.a.qxb(window.location.href.toLowerCase(),"wdtpl"),Xa=()=>{const M=pa.a.qxb(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"1"===M},Ka=M=>{let N=null;switch(M){case 0:N="omex";break;case 1:N="spcatalog";break;case 2:N="spapp";
break;case 3:N="filesystem";break;case 4:N="exchange";break;case 6:N="registry";break;case 7:N="inmemory";break;case 8:N="uploadfiledevcatalog";break;case 9:N="hardcodedpreinstall";break;case 10:N="excatalog";break;case 16:N="wopicatalog"}return N},Ma=M=>{let N=-1;switch(M.toLowerCase()){case "omex":N=0;break;case "spcatalog":N=1;break;case "spapp":N=2;break;case "filesystem":N=3;break;case "exchange":N=4;break;case "registry":N=6;break;case "inmemory":N=7;break;case "uploadfiledevcatalog":N=8;break;
case "hardcodedpreinstall":N=9;break;case "excatalog":N=10;break;case "wopicatalog":N=16}return N};class Oa{constructor(){this.title=this.id=this.tabs=null}}Object(h.a)(Oa,"AddInDataTransferObject",null,[]);class qa{constructor(M,N,Ia){this.fwc=M;this.JNh=N;this.KNh=Ia}get vF(){return this.fwc}get h7h(){return this.JNh}get i7h(){return this.KNh}static nwb(M){return(M=M.haa)?Object.assign(new Oa,{tabs:M.vF.toArray(),id:M.h7h,title:M.i7h}):null}}Object(h.a)(qa,"OneLineRibbonExtensibility",null,[]);
class Ya{lrb(M,N=null){if(M=qa.nwb(M)){appChrome.addInApi.dispatchActionsToInstallAddIn(M,N);for(const Ia of M.tabs)if(Ia.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(M,()=>{});break}}}sRe(M){(M=qa.nwb(M))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(M)}static ZNi(M,N,Ia=null){M=Ya.vij(M);0<M.length&&(Ya.jpd(M,!1),Ia&&Ia(N,M))}static vij(M){const N=[];if(M&&(M=M.haa,M.vF&&0<M.vF.count))for(let Ia of M.vF)if(Ia.groups&&0<Ia.groups.length)for(const lb of Ia.groups)if(lb.controls&&
0<lb.controls.length)for(const Sb of lb.controls)Array.add(N,Sb.id);return N}static jpd(M){if(M.length){var N=[];for(const Ia of M)N.push(appChrome.actions.updateControlEnabledDisabledState(Ia,!0));appChrome.api.dispatch(N)}}}Object(h.a)(Ya,"OneLineRibbonExtensibilityManager",null,[930]);class Fb{constructor(){this.Ver=1}}Object(h.a)(Fb,"CacheItem",null,[]);class hc{constructor(){}}Object(h.a)(hc,"AppsDataCacheManager",null,[923]);class ec{constructor(){new hc(y.a.instance)}pqh(M,N){M=Q.a.G2f()+M;
y.a.instance.setItem(M,N.toString())}a6f(){var M=Q.a.d6f();r.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",M);M=y.a.instance.getItem(M);return fa.a(M)}Wrh(M){const N=Q.a.d6f();r.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",N);y.a.instance.setItem(N,fa.c(M))}Ikg(){return!!y.a.instance.localStorage}static get instance(){ec.Ka||(ec.Ka=new ec);return ec.Ka}}ec.Ka=null;Object(h.a)(ec,"AddInCommandsCacheManager",null,[906]);var Tb=d(541),vb=d(68);class zb{static m3f(M){const N=new e.a;
if(zb.$Hf)for(var Ia of zb.$Hf)N.add(Ia);Ia=null;switch(M){case "Workbook":Ia=zb.vMl;break;case "Document":Ia=zb.FPi;break;case "Presentation":Ia=zb.zKk}if(Ia)for(const lb of Ia)N.add(lb);return N}}zb.$Hf=["PrimaryCommandSurface","ContextMenu"];zb.vMl=null;zb.FPi=null;zb.zKk=null;Object(h.a)(zb,"ExtensionPointType",null,[]);class Xb{constructor(M){this.ykf=null;if(Ga.b(M))throw r.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.UNh=M}get $jc(){return this.ykf||(this.ykf=new e.a)}get swf(){return this.UNh}}Object(h.a)(Xb,"ContextMenuExtensibility",null,[918]);class Za{constructor(M,N=null,Ia=0){if(Ga.b(M))throw r.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.AYh=M;this.X1h=N;this.WSh=Ia}get haa(){return this.AYh}get startedNode(){return this.X1h}get w3i(){return this.WSh}}Object(h.a)(Za,
"RibbonExtensibility",null,[970]);class Va{constructor(M){this.WRh=M.entitlement}get entitlement(){return this.WRh}createActionContext(M,N){M={};M.ownerAddinInfo=this.entitlement;M.action=N;return M}}Object(h.a)(Va,"AddInCommandsContextProvider",null,[]);class tc{constructor(M,N,Ia){this.g8e=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=M;this.eventBuilder=N;this.contextMenuBuilder=Ia}get addinInfo(){return this.g8e}PDi(M){return new Va(M)}createActionBuilder(M,
N){return OfficeExt.DefaultControlActionBinder.createActionBuilder(M,N.entitlement,N.manifest)}startApplyAddin(M){this.g8e=M;const N=this.PDi(M);this.actionBuilder=this.createActionBuilder(N,M)}endApplyAddin(){}G5d(M,N,Ia=0){return this.ribbonBuilder.vF&&0<this.ribbonBuilder.vF.count?new Za(this.e3i(M,N),this.addinInfo.startedNode,Ia):null}DZf(){var M=null;if(this.contextMenuBuilder.mdd&&0<this.contextMenuBuilder.mdd.count){M||(M=this.addinInfo.entitlement.solutionId);M=new Xb(M);for(let N of this.contextMenuBuilder.mdd)M.$jc.add(N);
return M}return null}e3i(M,N){return this.ribbonBuilder.vF&&0<this.ribbonBuilder.vF.count?new qa(this.ribbonBuilder.vF,M,N):null}}Object(h.a)(tc,"AddinCommandsBuilder",null,[]);class Kb{constructor(M,N,Ia,lb,Sb,Wc,td){this.Zkb=new vb.a;this.vx=M;this.vl=N;this.IS=Ia;this.xpc=lb;this.wXd=Sb;this.GKa=Wc;this.zrb=td;this.Maa=B.AFrameworkApplication.Aa.lV}X1c(M,N,Ia,lb,Sb,Wc,td){const wd=(be,hb,hf,Xf)=>{Sb(be,hb,hf,Xf);be=Tb.a[this.vx]+hb.assetId;({value:hb}=this.Zkb.Tf(be)).returnValue&&(hb.stop(),this.Zkb.remove(be))};
if(0!==this.vx&&M){r.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",M.count);4===this.vx&&(r.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",lb)),this.dui(M,lb),Wc());for(let be of M)if(M=be,r.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId))),this.hKh(M))if(td&&M.requireConsent)td(M,hb=>{try{if(this.Maa){const Xf=
Tb.a[this.vx]+hb.solutionId,Bg=this.Maa.Ei("ComponentAttach",Xf);this.Zkb.$(Xf,Bg)}const hf=this.GKa.W8a(hb.storeType,hb.solutionId);6!==this.vx&&(hf&&(this.fKc(hf),hf.vM.purge(!1)),this.vl.insertOsfControl(this.Rmc(hb,N,Ia,wd)),hf&&this.vl.ownerAddinControlRecreated(hb.solutionId,hb.storeType))}catch(hf){r.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(hb.solutionId,
hb.ownerAddinStoreType||hb.storeType,hb.assetId,null,null,hb.storeId),hb.version,hb.storeType,hb.storeId,hf.message)),wd(!1,hb,null,null)}});else try{if(this.Maa){const hf=Tb.a[this.vx]+M.solutionId,Xf=this.Maa.Ei("ComponentAttach",hf);this.Zkb.$(hf,Xf)}const hb=this.GKa.W8a(M.storeType,M.solutionId);6!==this.vx&&(hb&&(this.fKc(hb),hb.vM.purge(!1)),this.vl.insertOsfControl(this.Rmc(M,N,Ia,wd)),hb&&this.vl.ownerAddinControlRecreated(M.solutionId,M.storeType))}catch(hb){r.ULS.sendTraceTag(17388185,
220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,hb.message)),wd(!1,M,null,null)}else wd(!1,M,null,null)}}v_j(M,N,Ia,lb,Sb,Wc){const td=(wd,be,hb,hf)=>{Wc(wd,be,hb,hf);wd=Tb.a[this.vx]+be.solutionId;({value:be}=this.Zkb.Tf(wd)).returnValue&&(be.stop(),
this.Zkb.remove(wd))};if(6===this.vx&&M)if(r.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId))),this.hKh(M))try{if(this.Maa){const be=Tb.a[this.vx]+M.solutionId,hb=this.Maa.Ei("ComponentAttach",be);this.Zkb.$(be,hb)}const wd=this.GKa.W8a(M.storeType,M.solutionId);wd||td(!1,M,null,null);B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.ONf?
this.VZf(M,N,lb,Sb,Ia,be=>{td(be,M,Ia,wd.displayName)}):(this.VZf(M,N,lb,Sb,Ia),td(!0,M,Ia,wd.displayName))}catch(wd){r.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,wd.message)),td(!1,M,null,null)}else td(!1,
M,null,null)}Irk(M,N,Ia,lb,Sb,Wc){if(Wc)if(Wc._isAddinCommandsManifest(this.IS.qT))try{B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.ONf?this.UZf(M,N,Ia,Sb,Wc,td=>{lb(td,M,Wc,Wc.getDefaultDisplayName())}):(this.UZf(M,N,Ia,Sb,Wc),lb(!0,M,Wc,Wc.getDefaultDisplayName()))}catch(td){r.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,td.message)),lb(!1,M,Wc,Wc.getDefaultDisplayName())}else r.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),lb(!1,
M,null,null);else r.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.IS.qT,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),lb(!1,M,null,null)}Rmc(M,N,Ia,lb){const Sb={},Wc=document.createElement("div");Wc.setAttribute("visible","false");Sb.div=Wc;Sb.id=M.solutionId;Sb.solutionId=M.solutionId;
Sb.version=M.version;Sb.storeType=M.storeType;Sb.storeId=M.storeId;Sb.assetId=M.assetId;Sb.assetStoreId=M.assetStoreId;Sb.isvirtualOsfControl=!0;Sb.virtualOsfControlActivationCallback=(td,wd)=>{const be=this.GKa.W8a(M.storeType,M.solutionId);be&&(be.isUpgraded&&(M.isUpgraded=!0),this.fKc(be));this.Irk(M,N,Ia,lb,td,wd)};Sb.reason=3===this.vx?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Sb}UZf(M,N,Ia,lb,Sb,Wc=null){const td=
{};td.solutionId=lb.getSolutionId();td.version=lb.getVersion();td.storeType=lb.getStoreType();td.storeId=lb.getStoreId();td.assetId=lb.getAssetId();td.assetStoreId=lb.getAssetStoreId();td.targetType=lb.getOsfControlType();let wd=null,be=null;if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))wd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.IS.qT,this.IS.formFactor)).parseExtensions(td,Sb,this.zrb),be=zb.m3f(this.IS.qT);
else try{wd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.IS.qT,this.IS.formFactor)).parseExtensions(td,Sb,this.zrb),be=zb.m3f(this.IS.qT)}catch(hf){throw r.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+hf.message),hf;}if(be&&0<be.count){if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var hb=N(M);N=Ia(M);Ia=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");
hb=new tc(hb,null,N);for(let hf of be)hb.commandSurface=hf,wd.apply(hb,this.zrb,Ia)}else try{let hf=N(M),Xf=Ia(M),Bg=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");hb=new tc(hf,null,Xf);for(let ji of be)hb.commandSurface=ji,wd.apply(hb,this.zrb,Bg)}catch(hf){throw r.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+hf.message),hf;}if(OSF.OUtil.checkFlight(14))try{let hf=hb.G5d(M.solutionId,Sb.getDefaultDisplayName()),
Xf=hb.DZf();hf&&this.xpc.lrb(hf,Wc);Xf&&this.wXd.Usf(Xf);this.GKa.Htf(lb,hf,Xf,Sb.getDefaultDisplayName());r.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Sb.getDefaultDisplayName())}catch(hf){throw OfficeExt.DevConsole.log(hf),r.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+hf.message),hf;}else try{let hf=hb.G5d(M.solutionId,Sb.getDefaultDisplayName()),Xf=hb.DZf();hf&&this.xpc.lrb(hf);Xf&&this.wXd.Usf(Xf);this.GKa.Htf(lb,hf,Xf,Sb.getDefaultDisplayName());
r.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Sb.getDefaultDisplayName())}catch(hf){throw r.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+hf.message),hf;}}}VZf(M,N,Ia,lb,Sb,Wc=null){const td={};td.solutionId=M.solutionId;td.version=M.version;td.storeType=M.storeType;td.storeId=M.storeId;td.assetId=M.assetId;td.assetStoreId=M.assetStoreId;td.targetType=M.targetType;const wd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.IS.qT,this.IS.formFactor);
try{const be=N.getManifest(),hb=wd.parse(td,be,Sb,this.zrb,N.getSharedRuntimeId(),N),hf=Ia(M),Xf=lb(M),Bg=new tc(hf,null,Xf);Bg.commandSurface="PrimaryCommandSurface";hb.apply(Bg,this.zrb,!0);if(Bg.ribbonBuilder.vF&&0<Bg.ribbonBuilder.vF.count){const ji=Bg.G5d(M.solutionId,N.getManifest().getDefaultDisplayName(),1);B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.xpc.lrb(ji,Wc):ji&&this.xpc.lrb(ji,Wc);this.GKa.E7h(N,ji,
Sb,N.getManifest().getDefaultDisplayName());r.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",N.getManifest().getDefaultDisplayName())}}catch(be){r.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",N.getManifest().getDefaultDisplayName(),be.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(be)}}fKc(M){M.WJ&&this.xpc.sRe(M.WJ);M.c1b&&this.wXd.ZXk(M.c1b);this.GKa.HXk(M.vM.getStoreType(),M.vM.getSolutionId())}dui(M,N){N=
Ka(N);for(let Ia of this.GKa.Vyb){if(Ia.vM.getStoreType()!==N)continue;let lb=!0;for(let Sb of M){const Wc=Sb;if(Wc&&Ia.Nmg(Wc.storeType,Wc.solutionId)){lb=!1;break}}lb&&(this.fKc(Ia),Ia.vM.purge(!1))}}hKh(M){return!!M&&!!M.solutionId&&!!M.version&&!!M.storeType&&!!M.storeId}}Object(h.a)(Kb,"AddInCommandsIntegration",null,[]);var Pa=d(1154),mb=d(166),qc=d(933),oc=d(579),ib=d(351),$a=d(934),Db=d(141),Mb=d(97),ob=d(65),jc=d(57);class Gb{static get a8(){return Gb.uG||(Gb.uG=jc.a.instance.rb("Common.Utils.IAriaNotifier"))}static bKf(M,
N,Ia,lb){Gb.MV&&Gb.MV.AL&&Gb.MV.dismiss();Gb.MV=Pa.a.IYd(N,M,M,3);Gb.MV.content=Ia;Ga.a(lb)||(Gb.MV.title=lb,Gb.MV.f8b=!0);M=new Sys.UI.Bounds(0,0,Mb.a.tVc(),Mb.a.sVc());Gb.MV.TZ=Gb.w6d(M,N,Gb.MV.gba,1);Gb.MV.show();Gb.a8&&Gb.a8.sendNotification(Ia.innerText,!0)}static aYd(M,N,Ia,lb=null){Db.UISurfaces.oL().then(Sb=>{let Wc=null;Gb.cWb&&(Sb.removeNotification(Gb.cWb),Gb.cWb=null);const td=Sb.callout(Object.assign(new qc.a,{target:M,title:N,content:Ia,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,
calloutProps:Object.assign(new $a.a,{onDismiss:()=>{Sb.removeNotification(Wc)},directionalHint:null!=lb?lb:null})})),wd=Object.assign(new ib.a,{expirationOptions:Object.assign(new oc.a,{displayTimeoutSeconds:7,onExpire:()=>{Sb.removeNotification(Gb.cWb)}})});Wc=Gb.cWb=Sb.addNotification(td,wd);return null},Sb=>{r.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Sb);return null})}static QYe(M){Gb.MV&&Gb.MV.AL&&Gb.MV.dismiss();const N=new x.StandardDialog;N.E0a=!1;N.yd=0;
N.Jy(mb.a.p_j,CommonUIStrings.l_DialogError,Ga.a(M)?Gb.M1f():M,null)}static Ell(M){Gb.MV&&Gb.MV.AL&&Gb.MV.dismiss();r.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",M.errorCode));const N=Ga.a(M.description)?Gb.M1f():M.description,Ia=new x.StandardDialog;let lb=null;M.o_b?(Ia.yd=1,Ia.Xe(1,M.buttonText),Ia.wya(1)):Ia.yd=0;lb=Sb=>{1===Sb?M.o_b():M.G2b&&M.G2b()};Ia.E0a=!1;0===M.yee?Ia.Jy(M.errorCode,M.title?M.title:CommonUIStrings.l_DialogError,N,lb):1===
M.yee?Ia.fP(M.title?M.title:CommonUIStrings.l_DialogWarning,N,lb):Ia.Ikb(M.title?M.title:CommonUIStrings.l_DialogInfo,N,lb)}static w6d(M,N,Ia,lb){let Sb=0===lb?0:4;const Wc=M.x+M.width-N.x-N.width;N.x-M.x+N.width/2<=Ia/2?Sb=0===lb?2:5:Wc+N.width/2<=Ia/2&&(Sb=0===lb?3:6);return Sb}static Pll(M,N,Ia,lb=!1){(N=qa.nwb(N))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(N,Sb=>{Sb&&(lb||Gb.aYd(Sb,Ia,M,5))})}static Qll(M,N,Ia=!1){Gb.Pll(N.startedNode?
N.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,M),N,N.startedNode?N.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,M),Ia)}static Oll(M,N,Ia,lb){if(Gb.AJh)M=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ia,lb,CommonUIStrings.l_InsertionDialogRefresh)),Gb.aYd(N,M,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{N=ob.a.ai(N);var Sb=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),
Wc=document.createElement("span");Wc.innerText=Sb[0];var td=document.createElement("span");td.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ia,lb,CommonUIStrings.l_InsertionDialogRefresh);td.className="UIFontBold";Ia=document.createElement("span");Ia.innerText=Sb[1];lb=document.createElement("div");Sys.UI.DomElement.addCssClass(lb,"ModalCalloutControl");lb.appendChild(Wc);lb.appendChild(td);lb.appendChild(Ia);Gb.bKf(M,N,lb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static mnl(M,
N){var Ia=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,lb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Gb.AJh?Gb.aYd(N,Ia,lb):(N=ob.a.ai(N),Gb.bKf(M,N,Gb.Fmi(lb),Ia))}static Fmi(M){const N=document.createElement("div");Sys.UI.DomElement.addCssClass(N,"ModalCalloutControl");N.innerText=M;return N}static M1f(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get AJh(){return B.AFrameworkApplication.Aa.hb.Po&&B.AFrameworkApplication.Aa.hb.XUa}}
Gb.MV=null;Gb.cWb=null;Gb.uG=null;Object(h.a)(Gb,"AddInCommandsNotificationFactory",null,[]);class Gc{constructor(M,N,Ia,lb,Sb,Wc,td,wd=null){this.Pa=new R.a;this.Axd=M;this.nQh=N;this.cN=Ia;this.Oqf=lb;this.Xpb=Sb;this.LNh=Wc;this.iwc=td;this.qYh=wd;this.SUh=B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}E9h(M){this.Pa.addHandler(Q.a.Ovf,M)}A$h(M){this.Pa.addHandler(Q.a.aoe,M)}Xbi(M){this.Pa.addHandler(Q.a.ewh,M)}R9h(M){this.Pa.addHandler(Q.a.ISd,
M)}G_j(M,N,Ia){const lb=Ia[Q.a.mHc],Sb=void 0===Ia[Q.a.T7]?0:Ia[Q.a.T7];if(lb&&0!==Sb)if(0>=lb.count&&4!==Sb)this.lbh(new da(Sb,null,null,N,null,!0));else{var Wc=lb.count,td=new Ba(new Ya),wd=void 0===Ia[Q.a.U7]?-1:Ia[Q.a.U7],be=new Kb(Sb,this.cN,this.Axd,td,this.nQh,this.Xpb,this.iwc),hb=pi=>this.Oqf.Zli(pi.solutionId,this.iwc,this.Axd,M),hf=pi=>this.Oqf.$ki(pi.solutionId),Xf=(pi,Oe,Ri)=>{Wc--;Ri=new da(Sb,Oe,td,N,Ri,0>=Wc);if(pi&&Oe)this.lbh(Ri);else{if(3===Sb||Oe&&Oe.isUpgraded)pi="",Oe&&(pi=Telemetry.PrivacyRules.GetPrivacyCompliantId(Oe.solutionId,
Oe.ownerAddinStoreType||Oe.storeType,Oe.assetId,null,null,Oe.storeId)),Oe={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:pi},ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:P.a.sC(Oe)}));this.kbh(Ri)}Wc||B.AFrameworkApplication.Aa.updateCommandUI()},Bg=(pi,Oe,Ri,Rj)=>{Xf(pi,Oe,Rj)},ji=()=>{this.uGe();0>=lb.count&&4===Sb&&this.Xpb.UVe()};6===Sb?(wd=Ia[Q.a.EQi],Ia=Ia[Q.a.FQi],be.v_j(lb.ga(0),wd,
Ia,hb,hf,(pi,Oe,Ri,Rj)=>{Xf(pi,Oe,Rj)})):be.X1c(lb,hb,hf,wd,Bg,ji,this.qYh)}else ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:P.a.sC({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),r.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.Axd.qT)),this.kbh(new da(Sb,null,null,N,null,!0))}kbh(M){this.uGe(M);this.Vwh(!1,
M)}lbh(M){const N=M.Ju;let Ia=null;null!==N&&(Ia=N.storeType,Ia=Ia.toLowerCase());if(M&&"omex"===Ia&&(3===M.vx||N.isUpgraded)){var lb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId)};ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:P.a.sC(lb)}))}this.uGe(M);lb=Xa()&&"omex"===Ia&&!!M.vaa&&!!N.solutionId&&
2===M.vx&&N.solutionId.toLowerCase()===Da().toLowerCase();var Sb="excatalog"===Ia&&3===M.vx;if("omex"===Ia&&M.vaa&&(3===M.vx&&"hardcodedpreinstall"!==Ia||N.isUpgraded)||lb||Sb)lb=new T,lb.Ju=N,lb.WJ=M.vaa.rVa,this.Pa.raiseEvent(Q.a.ISd,lb);this.SUh&&(lb=ia(),Sb=Da(),lb&&N&&"excatalog"===N.storeType&&M.vaa&&5===M.vx&&Sb&&(N.storeId&&N.storeId.toLowerCase()===Sb.toLowerCase()||N.assetId&&N.assetId.toLowerCase()===Sb.toLowerCase())&&(lb=new T,lb.Ju=N,lb.WJ=M.vaa.rVa,this.Pa.raiseEvent(Q.a.ISd,lb),r.ULS.sendTraceTag(525362254,
220,50,"Email alert triggers AutoLaunchAddin event.")));N&&(ec.instance.pqh(Ma(Ia),!0),"uploadfiledevcatalog"===Ia&&(lb=this.LNh.createAddinDataProvider(Ia,this.cN))&&lb.localCacheAddinCommands(this.cN.oxa,N.solutionId,N.version,N.storeId),Z.a.Ylb(Q.a.Brb,"true",Ma(Ia)));this.Vwh(!0,M)}Vwh(M,N){M?B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&N.vaa&&5===N.vx&&N.vaa.rVa&&void 0!==N.Ju.showCallout&&null!==N.Ju.showCallout&&N.Ju.showCallout?
(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new sa(this.Pa)).aPd(N.Ju,qa.nwb(N.vaa.rVa)):(new na(this.Pa,N.Ju,qa.nwb(N.vaa.rVa))).aPd(),M=new T,M.WJ=N.vaa.rVa,M.Ju=N.Ju,this.Pa.raiseEvent(Q.a.ewh,M)):3!==N.vx?N.vpg&&this.Xpb.UVe():N.vaa&&N.vaa.rVa&&"hardcodedpreinstall"!==N.Ju.storeType&&Gb.Qll(N.displayName,N.vaa.rVa,N.Ju.isAutoLaunched):3===N.vx?N.Ju&&"uploadfiledevcatalog"===N.Ju.storeType.toLowerCase()?(N=this.iwc.A$i(N.Ju.solutionId),
Gb.QYe(N?N:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.Xpb.Fbl():N.vpg&&this.Xpb.UVe()}uGe(M=null){var N=M?M.Ju:null;const Ia=new T;if(Ia.Ju=N){var lb=this.Xpb.W8a(N.storeType,N.solutionId,6===M.vx?1:0);if(lb&&lb.WJ){Ia.WJ=lb.WJ;var Sb=Da();Sb=Xa()&&!!N.solutionId&&!!Sb&&N.solutionId.toLowerCase()===Sb.toLowerCase()&&2===M.vx;if(3===M.vx&&"hardcodedpreinstall"!==N.storeType||Sb)M="",lb.WJ.haa&&lb.WJ.haa.vF&&(lb=lb.WJ.haa.vF.ga(0))&&(M=lb.id),N={["SDX_CommandPlacement"]:M,
["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId)},ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:P.a.sC(N)}))}}this.Pa.raiseEvent(Q.a.Ovf,Ia)}}Object(h.a)(Gc,"LaunchAddinCommandsHandler",null,[913]);class bc{constructor(M){this.LYh=M}get oxa(){return this.LYh}insertOsfControl(M){return this.oxa.insertOsfControl(M)}getManifestInvaildErrorString(){return this.oxa.getManifestInvaildErrorString()}isAddinCommandsAsync(M,
N){this.oxa.isAddinCommandsAsync(M,N)}isAddinCommandsExAsync(M,N){this.oxa.isAddinCommandsExAsync(M,N)}ownerAddinControlRecreated(M,N){this.oxa.ownerAddinControlRecreated(M,N)}queryEntitlementDetails(M){this.oxa.queryEntitlementDetails(M)}}Object(h.a)(bc,"ContextActivationMgrWrapper",null,[914]);class dc{}dc.xmb="Alt";dc.ymb="Command";dc.id="Id";dc.V1a="Image16by16";dc.zmb="LabelText";dc.button="Button";dc.L4d="FlyoutAnchor";Object(h.a)(dc,"AddinDataNodeConstants",null,[]);var Nb=d(205),Ac=d(408),
jb=d(315),Vb=d(70);class Tc{constructor(M,N){this.vBc=this.F$e=null;if(Ga.b(M)||Ga.b(N))throw r.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Kzd=N;this._id=M;this.wN[dc.id]=this._id}get id(){return this._id||""}get wN(){return this.F$e||(this.F$e={})}get controlType(){return this.Kzd||""}get menuItems(){return this.vBc||(this.vBc=new e.a)}Qtc(){let M=null;this.Kzd===
dc.L4d?M=Object.assign(new Ac.a,{Menu:this.Nmk()}):this.Kzd===dc.button&&(M=Object.assign(new Nb.a,{}));M&&(this.wN[dc.id]&&(M.ExternalId=this.wN[dc.id]),this.wN[dc.ymb]&&(M.Command=this.wN[dc.ymb].toString()),this.wN[dc.zmb]&&(M.LabelText=this.wN[dc.zmb]),this.wN[dc.xmb]&&(M.Alt=this.wN[dc.xmb]),this.wN[dc.V1a]&&(Vb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.wN[dc.V1a]),M.ExternalImageId=this._id));return M}Nmk(){const M=Object.assign(new jb.a,{UpdateDynamically:!0,
MenuSectionList:[]});if(this.vBc){const N=Object.assign(new n.a,{ControlList:[]});for(let Ia of this.vBc)Array.add(N.ControlList,Ia.Qtc());Array.add(M.MenuSectionList,N)}return M}}Object(h.a)(Tc,"ControlDefinition",null,[912]);class wb{constructor(M){this.Lba=null;if(Ga.b(M))throw r.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=M;this.gjc[dc.id]=this._id}get gjc(){return this.Lba||
(this.Lba={})}get id(){return this._id||""}Qtc(){const M=Object.assign(new Nb.a,{});this.Lba[dc.id]&&(M.ExternalId=this.Lba[dc.id]);this.Lba[dc.ymb]&&(M.Command=this.Lba[dc.ymb].toString());this.Lba[dc.zmb]&&(M.LabelText=this.Lba[dc.zmb]);this.Lba[dc.xmb]&&(M.Alt=this.Lba[dc.xmb]);this.Lba[dc.V1a]&&(Vb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.Lba[dc.V1a]),M.ExternalImageId=this._id);return M}}Object(h.a)(wb,"MenuItemDefinition",null,[947]);class Rb{constructor(M){this.Cxc=
null;if(Ga.b(M))throw r.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=M}get id(){return this._id}get controls(){return this.Cxc||(this.Cxc=new e.a)}Qtc(){const M=[];if(this.Cxc)for(let N of this.Cxc){const Ia=N.Qtc();Ia&&M.push(Ia)}return M}}Object(h.a)(Rb,"OfficeMenuDefinition",null,[910]);var vc=d(37);class rd{constructor(M,N,Ia){this.BV=this.Knb=null;this.dHd=M;this.unb=
N;this.Imb=Ia;this.AXh=new e.a}get Zdd(){return this.dHd}get E0b(){return this.unb}get wOd(){return this.Imb}addButton(M){r.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",M.actionType);this.BV=new Tc(this.nQa(M.id),dc.button);this.BV.wN[dc.zmb]=M.label;this.BV.wN[dc.xmb]=M.label;this.BV.wN[dc.V1a]=M.icon["16"];this.VZb(this.BV.wN[dc.id],M.action);this.b6a(this.BV.wN);this.Knb.controls.add(this.BV);this.BV=null}startBuildMenu(M){if(Ga.b(this.Knb))this.Knb=new Rb(M.id);else{const N=
this.nQa(M.id);this.BV=new Tc(N,dc.L4d);this.Gsb(this.BV.wN,M);this.BV.wN[dc.V1a]=M.icon["16"];this.BV.wN[dc.ymb]=vc.a.X7}}addMenuItem(M){r.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",M.actionType);const N=new wb(this.nQa(M.id));this.Gsb(N.gjc,M);M.icon&&(N.gjc[dc.V1a]=M.icon["16"]);this.VZb(N.gjc[dc.id],M.action);this.b6a(N.gjc);this.BV.menuItems.add(N)}endBuildMenu(){Ga.b(this.BV)?(this.mdd.add(this.Knb),this.Knb=null):(this.Knb.controls.add(this.BV),this.BV=null)}get mdd(){return this.AXh}VZb(M,
N){this.wOd.bindAction(M,N)}b6a(M){this.E0b.b6a(M)}nQa(M){return this.Zdd.$Da(M)}Gsb(M,N){M[dc.zmb]=N.label;M[dc.xmb]=N.label}}Object(h.a)(rd,"ContextMenuExtensibilityCreator",null,[929,925]);class rc{constructor(M){this.gVb=M}get Hjc(){return this.gVb}$Da(M){return this.Hjc+M}}Object(h.a)(rc,"DefaultContextMenuNamingProvider",null,[928]);class cb{constructor(M,N,Ia,lb){this.gVb=M;B.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&Ia.Ydj();this.upf=N;this.k1h=lb}get Hjc(){return this.gVb}get solutionId(){return this.upf}get tYe(){return this.k1h}$Da(M){M=
this.Hjc+this.solutionId+M;return this.tYe?(M in cb.nHc||(cb.nHc[M]="AddinControl"+cb.Mci++),cb.nHc[M]):M}XMf(M){if(this.tYe){const Ia=cb.nHc;for(let lb in Ia){var N=lb;if(M===Ia[lb])return N.substr(this.Hjc.length+this.solutionId.length)}}return M}Imj(M){M=this.Hjc+this.solutionId+M;return this.tYe?(M in cb.DQd||(cb.DQd[M]="AddinTab"+cb.Qci++),cb.DQd[M]):M}}cb.nHc={};cb.DQd={};cb.Qci=0;cb.Mci=0;Object(h.a)(cb,"DefaultRibbonNamingProvider",null,[911]);class Wb{bindAction(M,N){OfficeExt.DefaultControlActionBinder.bindAction(M,
N)}}Object(h.a)(Wb,"DefaultUIControlActionBinder",null,[927]);class Uc{constructor(M){this.RPh=M}get command(){return this.RPh}b6a(M){M[dc.ymb]=this.command}}Object(h.a)(Uc,"DefaultUIControlCommandBinder",null,[926]);var Ib=d(533);class Vc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(h.a)(Vc,"AddInControl",null,[]);class gc{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(h.a)(gc,"AddInGroup",null,[]);class rb{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(h.a)(rb,"AddInMenuItem",null,[]);class Zb{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(h.a)(Zb,"AddInTab",null,[]);class Hc{constructor(M,N,Ia,lb,Sb,Wc){this.fwc=new e.a;this.BRb=this.gAa=this.Lnb=null;this.dHd=M;this.Imb=
N;this.unb=Ia;this.upf=lb;this.iwc=Sb;this.Ybf=Wc}get Zdd(){return this.dHd}get vF(){return this.fwc}get wOd(){return this.Imb}get E0b(){return this.unb}startBuildTab(M){const N=M.isOfficeTab?M.id:this.Zdd.Imj(M.id),Ia=M.isOfficeTab?null:M.label;this.Lnb=Object.assign(new Zb,{id:N,title:Ia,isOfficeTab:M.isOfficeTab,visible:M.visible,groups:[],tabType:M.tabType,insertBefore:M.insertBefore,insertAfter:M.insertAfter,autoFocus:M.autoFocus})}startBuildGroup(M){const N=this.nQa(M.id);this.gAa=Object.assign(new gc,
{id:N,mlrId:M.mlrId,title:M.label,controls:[],groupType:0})}addNativeGroup(M){this.gAa=Object.assign(new gc,{id:M.id,mlrId:M.mlrId,title:M.label,controls:[],groupType:1});this.Lnb.groups.push(this.gAa)}addButton(M){const N=this.nQa(M.id);N&&(this.VZb(N,M.action),r.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",M.actionType),M=Object.assign(new Vc,{id:N,title:M.label,iconLocation:this.j8d(M),enabled:M.enabled,controlType:0,attributes:this.Gsb()}),this.Ybf.Asf(new Ib.a(N,
this.E0b.command.toString())),this.gAa.controls.push(M))}addNativeControl(M){M.id&&(r.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",M.actionType),M=Object.assign(new Vc,{id:M.id,title:"",iconLocation:"",enabled:M.enabled,controlType:2,attributes:this.Gsb()}),this.gAa.controls.push(M))}startBuildMenu(M){const N=this.nQa(M.id);N&&(this.BRb=Object.assign(new Vc,{id:N,title:M.label,iconLocation:this.j8d(M),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(M){const N=
this.nQa(M.id);N&&(this.VZb(N,M.action),r.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",M.actionType),M=Object.assign(new rb,{id:N,title:M.label,iconLocation:this.j8d(M),enabled:M.enabled,attributes:this.Gsb()}),this.Ybf.Asf(new Ib.a(N,this.E0b.command.toString())),this.BRb.menuItems.push(M))}endBuildMenu(){Ga.b(this.BRb.id)||this.gAa.controls.push(this.BRb);this.BRb=null}endBuildGroup(){Ga.b(this.gAa.id)||this.Lnb.groups.push(this.gAa);this.gAa=null}endBuildTab(){Ga.b(this.Lnb.id)||
this.fwc.add(this.Lnb);this.Lnb=null}Gsb(){const M={};this.b6a(M);return M}j8d(M){return M.icon["80"]?M.icon["80"]:M.icon["32"]}b6a(M){this.E0b.b6a(M)}nQa(M){return this.Zdd.$Da(M)}VZb(M,N){this.wOd.bindAction(M,N)}}Object(h.a)(Hc,"OneLineRibbonExtensibilityCreator",null,[924,925]);class Ab{constructor(M,N){this.gVb=M;this.Imb=new Wb;this.unb=new Uc(N)}$ki(M){M=new rc(M);return new rd(M,this.unb,this.Imb)}Zli(M,N,Ia,lb){Ia=new cb(this.gVb,M,Ia,!0);return new Hc(Ia,this.Imb,this.unb,M,N,lb)}}Object(h.a)(Ab,
"UIExtensibilityFactory",null,[908]);class ad{createAddinDataProvider(M,N){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(M,N.oxa)}static get instance(){ad.Ka||(ad.Ka=new ad);return ad.Ka}}ad.Ka=null;Object(h.a)(ad,"OSFAddinDataProviderFactory",null,[907]);class Bd{constructor(){this.Arb=null}setErrorMessageForAddin(M,N){this.Arb||(this.Arb={});this.Arb[M]=N}A$i(M){return this.Arb&&M in this.Arb?this.Arb[M]:null}}Object(h.a)(Bd,"AddinCommandsErrorManager",null,[]);class kd{constructor(){this.yee=
0;this.o_b=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.fdg=!1;this.sCj=this.G2b=null}}Object(h.a)(kd,"AddInCommandsNotificationParameters",null,[]);class Be{constructor(){this.S8e=this.gxd=null}get xOd(){return this.gxd||(this.gxd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set xOd(M){this.gxd=M}get lii(){return this.S8e||(this.S8e=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(M,
N){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(M,N)}z7b(M,N,Ia,lb,Sb){r.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",M);if((M=N.W8a(Sb.ownerAddinInfo.storeType,Sb.ownerAddinInfo.solutionId))&&M.vM&&!M.vM.getIsUpgrading())if(N=null,0<M.vM.getNotificationParams().length&&(N=this.mBf(M.vM.getNotificationParams()[0]))&&2147758681===N.errorCode&&(M.isUpgraded=!0),2!==M.vM.getStatus()&&(1!==M.vM.getStatus()||N&&2147758681===N.errorCode))N&&this.awh(M,N,
null);else try{Ia.setOwnerAddinEToken(M.vM.getEToken()),Sb.action(Ia,lb.oxa)}catch(Wc){r.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",B.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Wc.stack:Wc.message)),Gb.QYe(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}awh(M,N,Ia=null){const lb=M.vM;if(1===lb.getNotificationParams().length||N.fdg){const Sb=N.o_b,Wc=N.G2b;N.o_b=
()=>{lb.removeFirstNotification();if(0<lb.getNotificationParams().length){const td=this.mBf(lb.getNotificationParams()[0]);this.awh(M,td)}2147758681===N.errorCode&&(Ya.ZNi(M.WJ,lb,Object(E.a)(this,this.Weg,"initUpgradeStateDetectTask")),v.TNi(M.c1b,lb,Object(E.a)(this,this.Weg,"initUpgradeStateDetectTask")));Sb&&Sb()};N.G2b=()=>{Wc&&Wc();Ia&&Ia()};Gb.Ell(N)}}Weg(M,N){let Ia=null;Ia=()=>{M.getIsUpgrading()?window.setTimeout(Ia,1E3):M.getUpgradingFailed()?Ya.jpd(N,!0):B.AFrameworkApplication.Aa.updateCommandUI()};
window.setTimeout(Ia,1E3)}mBf(M){const N=new kd;N.yee=M.infoType;N.id=M.id;N.title=M.title;N.description=M.description;N.buttonText=M.buttonTxt;N.o_b=M.buttonCallback;N.fdg=M.highPriority;N.G2b=M.dismissCallback;N.errorCode=M.errorCode;N.sCj=M.iframeNotificationUrl;return N}}Object(h.a)(Be,"AddinCommandsActionHandler",null,[919]);class Qd{constructor(){this.labelText=null;this.visible=!1}}Object(h.a)(Qd,"AddinStatusCommandValues",null,[]);class ae{static DNk(M){const N=new Qd;N.labelText=M.aZb;N.visible=
N.labelText?!0:!1;return N}static pZe(){const M=document.getElementById(void 0);M?ae.Qwh(void 0,void 0,M,void 0,void 0):r.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static Qwh(M,N,Ia,lb,Sb){Ia?M.aZb===CommonUIStrings.l_ErrorLoadingAddInsTitle?Gb.Oll(N,Ia,lb,Sb):M.aZb===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Gb.mnl(N,Ia):r.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(h.a)(ae,
"AddinCommandsStatusHandler",null,[]);class We{constructor(){this.vx=this.f1=0;this.tQd=null;this.tjd=this.Ntd=0;this.fNa=this.VBd=this.yxd=this.mLc=this.QDa=this.zra=null}get sQd(){this.yxd||(this.yxd=new e.a);return this.yxd}get y5d(){this.VBd||(this.VBd=new e.a);return this.VBd}get A7a(){this.fNa||(this.fNa=new e.a);return this.fNa}}Object(h.a)(We,"AddinCommandsListLoaderContext",null,[]);const $d=M=>{const N={};N.solutionId=M.solutionId;N.version=M.version;N.storeType=M.storeType;N.storeId=M.storeId;
N.assetId=M.assetId;N.assetStoreId=M.assetStoreId;N.targetType=M.targetType;N.requireConsent=M.requireConsent||!1;N.isAddinCommands=!0;N.addinCommandsActionType=0;return N};class Re{constructor(M,N){this.entitlement=M;this.metadata=N}bDh(){const M=$d(this.entitlement);M.targetType=this.targetType;return M}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(h.a)(Re,"AddinEntitlementEx",null,[]);var Ta=d(22);class xb{constructor(M){this.Cg=null;this.zba=M}get_current(){if(!this.Cg)throw Error.argumentOutOfRange();return this.Cg.data}moveNext(){if(!this.Cg)return this.Cg=this.zba,!!this.zba;if(!this.Cg.next)return!1;
this.Cg=this.Cg.next;return!0}reset(){this.Cg=this.zba}}Object(h.a)(xb,"ListEnumerator",null,[0]);class kc{constructor(M,N,Ia){this.next=Ia;this.previous=N;this.data=M}}Object(h.a)(kc,"ListNode",null,[]);class Nc{constructor(){this.t5a=this.yha=null;this.Xk=0}add(M){this.yha?this.t5a=this.t5a.next=new kc(M,this.t5a,null):this.yha=this.t5a=new kc(M,null,null);this.Xk=this.count+1}insert(M,N){if(M>this.count||0>M)throw Error.argumentOutOfRange("pos");if(M===this.count)this.add(N);else{for(var Ia=this.yha;0!==
M--;)Ia=Ia.next;M=new kc(N,Ia.previous,Ia);M.previous?M.previous.next=M:this.yha=M;M.next?M.next.previous=M:this.t5a=M;this.Xk=this.count+1}}remove(M){let N=this.yha;for(;N&&N.data!==M;)N=N.next;if(!N)return!1;N.previous?N.previous.next=N.next:this.yha=N.next;N.next?N.next.previous=N.previous:this.t5a=N.previous;this.Xk=this.count-1;return!0}clear(){let M=this.yha,N;for(this.t5a=this.yha=null;M;)N=M.next,M.previous=null,M.next=null,M=N;this.Xk=0}indexOf(M){let N=this.yha,Ia=0;for(;N&&N.data!==M;)N=
N.next,Ia++;return N?Ia:-1}ga(M){return this.at(M).data}get count(){return this.Xk}getEnumerator(){return new xb(this.yha)}[Symbol.iterator](){return Object(Ta.a)(this.getEnumerator())}toArray(){const M=Array(this.count);let N=0;for(let Ia of this)M[N]=Ia,N++;return M}at(M){let N=this.yha,Ia=0;for(;Ia!==M;){if(!N)throw Error.argumentOutOfRange("pos");N=N.next;Ia++}return N}}Object(h.a)(Nc,"List",null,[1]);class id extends Sys.EventArgs{constructor(M){super();this.properties=M}}Object(h.a)(id,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);class Ed{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(h.a)(Ed,"MiniAddinInfo",null,[]);class Ja{constructor(M,N,Ia){this.Lp=new R.a;this.context=new We;this.DMd=this.q_e=this.o6a=this.r1=this.mba=null;this.contextActivationMgr=M;this.Nci=N;this.p6a=Ia;this.appName=B.AFrameworkApplication.fa.Ga("WebAppShortName")}get YBh(){this.DMd||(this.DMd=new sa(this.Lp));return this.DMd}D9h(M){this.Lp.addHandler(Q.a.$Yb,M)}Zbi(M){this.Lp.addHandler(Q.a.SYe,M)}GBl(M){null!==
M&&(this.context.f1=M[Q.a.U7],this.context.vx=M[Q.a.T7],this.context.Ntd=this.context.tjd=0,M=Q.a.q6a in M?M[Q.a.q6a]:0,-1!==this.context.f1&&0!==this.context.vx&&(this.context.zra=new Nc,this.context.QDa=new Nc,this.context.mLc=new Nc,this.context.tQd=this.Nci.createAddinDataProvider(Ka(this.context.f1),this.contextActivationMgr),this.context.tQd?this.context.tQd.getEntitlementsAsync(this.contextActivationMgr.oxa,!0,M,N=>{this.mwk(N)}):r.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",
this.context.f1)))}mwk(M){if(M&&0<M.length){this.context.Ntd=M.length;const Ia=B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Da():null;for(let lb=0;lb<M.length;lb++){const Sb=M[lb];if(B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Xa()&&Sb&&Sb.storeType&&"omex"===Sb.storeType.toLowerCase()&&Sb.assetId&&Ia&&Sb.assetId.toLowerCase()===Ia.toLowerCase()){var N={["SDX_AppInstallOrigin"]:"DeeplinkUser",
["SDX_Id"]:Ja.tQ(Sb)};ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:P.a.sC(N)}))}!Sb||1!==Sb.targetType&&-1!==Sb.targetType?this.Ked():(N={},B.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(N.solutionId=Sb.solutionId,N.version=Sb.version):(N.marketplaceId=Sb.solutionId,N.marketplaceVersion=Sb.version),N.storeType=Sb.storeType,N.storeId=Sb.storeId,N.targetData=
Sb,Ja.htc?this.contextActivationMgr.isAddinCommandsExAsync(N,Object(E.a)(this,this.Vvk,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(N,(Wc,td,wd)=>{Wc?(td&&this.context.zra.add(wd.targetData),10===this.context.f1&&(Wc=wd.targetData,td=Wc.targetType,Ga.b(wd.targetTypeForExp)||(td=wd.targetTypeForExp,Wc.targetType=td),this.context.QDa.add(Wc),0===td&&this.context.mLc.add(Wc))):(wd=wd.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(wd.solutionId,wd.storeType,wd.assetId,null,null,wd.storeId),wd.storeType));this.Ked()}))}}else this.Ked()}Ked(){var M;(M=this.context).tjd=M.tjd+1;this.context.tjd>=this.context.Ntd&&(this.p6a.pqh(this.context.f1,!1),0<this.context.Ntd&&10===this.context.f1&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(M=!1,B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&ia()&&(M=this.y3j()),
this.O2j(),B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!M?Ja.htc?this.YBh.Kzl(this.contextActivationMgr,this.context.sQd,this.context.A7a,(N,Ia)=>{const lb=new e.a;for(let Sb of N)N=Sb.bDh(),Ia&&Ia.solutionId===Sb.solutionId&&(N.showCallout=!0,this.YBh.EIh(Ia)),lb.add(N);this.kKa(lb)}):this.$3i(this.context.zra):this.vGc(this.context.zra)):this.vGc(this.context.zra))}vGc(M){if(Ja.htc)this.kKa(this.Fxi(this.context.sQd));
else{var N=new e.a;if(M)for(let Ia of this.context.zra)N.add($d(Ia));this.context.zra&&1>this.context.zra.count&&Z.a.Ylb(Q.a.Brb,"false",this.context.f1);M={["ack2"]:N};M[Q.a.U7]=this.context.f1;M[Q.a.T7]=this.context.vx;this.Lp.raiseEvent(Q.a.$Yb,new id(M),this)}}Fxi(M){const N=new e.a;if(M)for(let Ia of M)N.add(Ia.bDh());return N}kKa(M){M&&M.count||Z.a.Ylb(Q.a.Brb,"false",this.context.f1);M={["ack2"]:M};M[Q.a.U7]=this.context.f1;M[Q.a.T7]=this.context.vx;this.Lp.raiseEvent(Q.a.$Yb,new id(M),this)}I_a(M){if(this.appName){const N=
{},Ia={};Ia.LastTeachingUIShowTime=(new Date).toUTCString();Ia.AddinHasShown=M;N[this.appName]=fa.c(Ia);this.mba&&(this.mba.zvb(N),r.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else r.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}$3i(M){(this.o6a=M)?(M=new e.a,M.add(this.appName),this.mba=new ra(this.appName,Object(E.a)(this,this.oEa,"getRequestSuccessCallback"),
Object(E.a)(this,this.nka,"getRequestFailureCallback"),Object(E.a)(this,this.kaa,"postRequestFailureCallback")),this.mba.zPc(M)):(M={["ack2"]:new e.a},M[Q.a.U7]=this.context.f1,M[Q.a.T7]=this.context.vx,this.Lp.raiseEvent(Q.a.$Yb,new id(M),this))}oEa(M){M?this.EYe(M)?(r.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.r1="AddinHasShown"in M&&M.AddinHasShown?M.AddinHasShown.toString():null,this.Q0b()):(r.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.vGc(this.o6a)):
(r.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.r1=null,this.Q0b())}nka(M){r.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",M?M.ie:-1);this.vGc(this.o6a)}kaa(M){r.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",M?M.ie:-1)}Q0b(){const M=this.a0d();0===M.targetType?(M.solutionId?(this.q_e=M.solutionId,this.XNe()):this.bGa("NoSolutionId"),M.addinId&&(window.g_roamingAddinList=
this.r1?this.r1+","+M.addinId:M.addinId),this.xtf(null)):this.xtf(M.addinId);r.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",M.addinId)}XNe(){const M=new za.a;M.callbackFunc=N=>{if(N.errorCode){this.bGa("FailToGetAppDetails");var Ia=window.g_roamingAddinList;Ia&&this.I_a(Ia)}else if(N.value)for(Ia of N.value)if(N=Ia[1],N===this.q_e){const lb={};lb.solutionId=N;lb.assetId=Ia[5];lb.storeType=Ia[12];lb.storeId=Ia[11];lb.assetStoreId=Ia[6];lb.targetType=Ia[3];lb.width=Ia[7];lb.height=
Ia[8];lb.displayName=Ia[0];lb.version=Ia[4];Ia=new ua(lb);this.Lp.raiseEvent(Q.a.SYe,Ia);break}};M.storeType=OSF.StoreTypeEnum.PrivateCatalog;M.fromInsertDialog=!1;M.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(M)}EYe(M){if("LastTeachingUIShowTime"in M){if(M=+new Date-+new Date(M.LastTeachingUIShowTime.toString()),M<B.AFrameworkApplication.fa.rQ("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
M),!1}else r.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}a0d(){let M=new Ua.a(new Ed,0),N=new Ua.a(new Ed,0),Ia=0,lb=0,Sb=0;var Wc=new Nc;if(0<this.context.zra.count)for(var td of this.context.zra)Wc.add(td);if(0<this.context.mLc.count)for(let wd of this.context.mLc)Wc.add(wd);for(let wd of Wc)if(!("excatalog"!==wd.storeType||Ga.b(wd.installTimeInMS)||!wd.installTimeInMS||wd.installTimeInMS<=B.AFrameworkApplication.fa.rQ("DateTimeInMSForNewAddin",16409952E5))){Wc=Ja.h5b(wd);
if(this.r1&&(td=this.r1.split(","),0<td.length&&Array.contains(td,Wc))){Sb++;r.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Wc.startsWith("private_")?(M.value<wd.installTimeInMS&&(M=new Ua.a(Object.assign(new Ed,{addinId:Wc,targetType:wd.targetType,solutionId:wd.solutionId}),wd.installTimeInMS)),lb++):(N.value<wd.installTimeInMS&&(N=new Ua.a(Object.assign(new Ed,{addinId:Wc,targetType:wd.targetType,solutionId:wd.solutionId}),wd.installTimeInMS)),Ia++)}r.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",lb,Ia,Sb);return 0<N.value?N.key:0<M.value?M.key:Object.assign(new Ed,{addinId:null,targetType:-1,solutionId:null})}xtf(M){const N=new e.a;for(let Ia of this.o6a){const lb=$d(Ia);if(M){const Sb=Ja.h5b(Ia);M===Sb&&(lb.showCallout=!0,window.g_roamingAddinList=this.r1?this.r1+","+M:M)}N.add(lb)}this.o6a&&1>this.o6a.count&&Z.a.Ylb(Q.a.Brb,"false",this.context.f1);M={["ack2"]:N};M[Q.a.U7]=this.context.f1;
M[Q.a.T7]=this.context.vx;this.Lp.raiseEvent(Q.a.$Yb,new id(M),this)}y3j(){if(Ja.htc)return this.z3j(this.context.y5d);var M=!1;if(this.context.QDa&&1>this.context.QDa.count)return M;const N=Da();if(!N)return M;for(let Ia of this.context.QDa)if(Ia.storeId&&Ia.storeId.toLowerCase()===N.toLowerCase()||Ia.assetId&&Ia.assetId.toLowerCase()===N.toLowerCase())M={["SDX_Id"]:Ja.tQ(Ia),["SDX_TargetType"]:Ga.b(Ia.targetType)?"":Ia.targetType.toString()},ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:P.a.sC(M)})),M=!0;return M}O2j(){if(Ja.htc)this.P2j(this.context.y5d);else if(!(this.context.QDa&&1>this.context.QDa.count))if(this.p6a.Ikg()){var M=this.p6a.a6f();M?(M=this.l1f(this.context.QDa,M),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(M=this.l1f(this.context.QDa,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.p6a.Wrh(M)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}l1f(M,N){const Ia={};let lb=!1;for(let Sb of M)if(M=
Ja.tQ(Sb))!N||M in N||(this.iea(Sb,M),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===M.toLowerCase()?lb||(lb=!0,Ia[M]=null):Ia[M]=null;return Ia}iea(M,N){var Ia=M.installTimeInMS?(new Date(M.installTimeInMS)).toISOString():"";Ia={["SDX.Id"]:N,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ga.b(M.targetType)?"":M.targetType.toString(),["SDX.AdminDeploymentTime"]:Ia};ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:P.a.sC(Ia)}));1===M.targetType&&(M={["SDX.Id"]:N,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:P.a.sC(M)})))}z3j(M){let N=!1;if(M&&1>M.count)return N;const Ia=Da();if(!Ia)return N;for(let lb of M)if(lb.storeId&&lb.storeId.toLowerCase()===Ia.toLowerCase()||lb.assetId&&lb.assetId.toLowerCase()===Ia.toLowerCase())M={["SDX_Id"]:Ja.c6f(lb),["SDX_TargetType"]:Ga.b(lb.targetType)?
"":lb.targetType.toString()},ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:P.a.sC(M)})),N=!0;return N}P2j(M){if(!(M&&1>M.count))if(this.p6a.Ikg()){var N=this.p6a.a6f();N?(M=this.m1f(M,N),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(M=this.m1f(M,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.p6a.Wrh(M)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}m1f(M,
N){const Ia={};let lb=!1;for(let Sb of M)if(M=Ja.c6f(Sb))!N||M in N||(this.H5j(Sb,M),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===M.toLowerCase()?lb||(lb=!0,Ia[M]=null):Ia[M]=null;return Ia}H5j(M,N){var Ia=M.installTimeInMS?(new Date(M.installTimeInMS)).toISOString():"";Ia={["SDX.Id"]:N,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ga.b(M.targetType)?"":M.targetType.toString(),["SDX.AdminDeploymentTime"]:Ia};ca.a.sendTelemetryEvent(Object.assign(new F.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:P.a.sC(Ia)}));1===M.targetType&&(M={["SDX.Id"]:N,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:P.a.sC(M)})))}Vvk(M,N,Ia,lb){M?(-1===lb.targetType&&(lb.targetType=Ia.targetTypeForExp),M=new Re(Ia.targetData,lb),N&&this.context.sQd.add(M),10===this.context.f1&&(this.context.y5d.add(M),0===M.targetType&&this.context.A7a.add(M))):
(N=Ia.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId),N.storeType));this.Ked()}bGa(M){M={["AppTeachingUICalloutAction"]:M,["SDX.Id"]:this.q_e,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:P.a.sC(M)}))}static get htc(){return B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static tQ(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}static c6f(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}static h5b(M){return Telemetry.PrivacyRules.IsPrivateAddin(M.storeType,M.assetId,null,null,M.storeId)?"private_"+M.installTimeInMS:M.solutionId}}Object(h.a)(Ja,"AddInCommandsListLoader",null,[]);var db=d(1132),zc=d(179),Hd=d(1236),Ad=d(29),Kd=d(60);class Pc{constructor(M,
N,Ia){this.fcb=this.iGa=this.Lea=this.nfb=null;this.cBe=this.K$c=-1;this.nH=null;this.XSg=!1;this.Nsg=M;this.Qb=N;this.Tsg=this.Qb.Bc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.S6j=this.Qb.Bc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.r3c=this.Qb.Ga("WebAppShortName");this.Lc=Ia;ma.a.Wa(this.r3c)&&(this.r3c="PowerPoint")}tQ(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}WWk(M){this.nH=M;this.Lc.m6a(Object(E.a)(this,
this.V4g,"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",Object(E.a)(this,this.pAk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(E.a)(this,this.euk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(E.a)(this,this.dtk,"onCloseButtonClicked_ContentAddin"),!0)}fwk(){this.Lea&&this.fcb&&(this.Nsg.z7b({["SourceControlId"]:this.fcb}),r.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}Tll(M,
N){N?(this.Lea=N.Ju,(this.nfb=N.WJ)&&this.nfb.haa&&this.nfb.haa.vF&&(this.iGa=this.nfb.haa.vF.ga(0)),this.iGa?this.iGa.isOfficeTab?(M=this.Lea.solutionId,N=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),M in N?this.fcb=N[M]:(r.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.tQ(this.Lea)),this.fcb=this.W3i(this.nfb)),this.fcb?0<this.iGa.id.indexOf(Kd.a.cgh)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(qa.nwb(this.nfb),
()=>{this.gxh(this.rUc(this.fcb))}):this.Lc.m6a(Object(E.a)(this,this.J7g,"onTabSwitched")):(this.HVa("NoEnabledButtonFound",this.Lea),r.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.UIa())):this.ixh(this.rUc(this.iGa.id),0):(this.HVa("NoTabFound",this.Lea),r.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.UIa())):this.UIa()}J7g(M,N){!this.iGa||void 0===this.iGa.id||null===this.iGa.id||
0>ma.a.rg(this.iGa.id).indexOf(ma.a.rg(N.qfa))||(this.Lc.Qoc(Object(E.a)(this,this.J7g,"onTabSwitched")),this.wVd(N.Y1g,N.qfa,this.Tsg,!1))}V4g(M,N){"Insert"===N.qfa&&(this.Lc.Qoc(Object(E.a)(this,this.V4g,"onInsertTabSwitched_ContentAddin")),this.wVd(N.Y1g,N.qfa,this.Tsg,!0))}wVd(M,N,Ia,lb){if(0>Ia)this.HVa("TabSwitchTimeOut",this.Lea);else{var Sb=document.querySelector("button"+this.rUc(N));Sb.hasAttribute("aria-selected")&&"false"!==Sb.getAttribute("aria-selected")?(0<this.cBe&&window.clearTimeout(this.cBe),
lb?this.mol():this.gxh(this.rUc(this.fcb))):this.cBe=window.setTimeout(()=>{this.wVd(M,N,Ia-1,lb)},1E3)}}rUc(M){return"[id="+M+"]"}mol(){let M=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var N=M?window.getComputedStyle(M,null):null;if(!M||N&&"none"===N.display)if(M=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))r.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.oBb("NoAnchor",this.nH);r.ULS.sendTraceTag(512499850,
220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else r.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(N=jc.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&M?(N.execute(Ia=>{Ia.logActivity("ShowTeachingUIForContentAddin",null)}),this.oBb("Show",this.nH),r.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.oBb("NoSifFutureObject",this.nH),r.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}pAk(){this.oBb("ClickOnLaunch",
this.nH);this.UIa();const M={};M.solutionId=this.nH.solutionId;M.assetId=this.nH.assetId;M.assetStoreId=this.nH.assetStoreId;M.height=this.nH.height?this.nH.height:600;M.storeId=this.nH.storeId;M.targetType=this.nH.targetType;M.width=this.nH.width?this.nH.width:600;M.displayName=this.nH.displayName;M.version=this.nH.version;M.storeType=this.nH.storeType;M.isAddinCommands=!1;this.Nsg.Kd.YAb("0",3,M)}dtk(){this.oBb("ClickOnClose",this.nH);this.UIa()}euk(){this.oBb("ClickOnDismiss",this.nH);this.UIa()}ixh(M,
N){if(N>this.S6j)window.clearTimeout(this.K$c),this.hxh("[data-unique-id='pivotOverflowButton']"),r.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Ia=document.querySelector("button"+M);!Ia||Ia.hasAttribute("tabIndex")&&"-1"===Ia.getAttribute("tabIndex")?this.K$c=window.setTimeout(()=>{this.ixh(M,N+1)},1E3):(0<this.K$c&&window.clearTimeout(this.K$c),this.hxh(M))}}gxh(M){let N=document.querySelector("button[data-unique-id='RightPaddle']");
if(N)this.HVa("RightPaddlePresent",this.Lea);else if(M=(N=document.querySelector("button"+M))?window.getComputedStyle(N,null):null,!N||M&&"none"===M.display)if(N=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!N){this.HVa("NoAnchor",this.Lea);r.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.UIa();return}this.bEh(N,"ShowTeachingUIForAddinButton")}hxh(M){let N=document.querySelector("button"+M);if(!N&&("[data-unique-id='pivotOverflowButton']"!==
M&&(N=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!N)){this.HVa("NoAnchor",this.Lea);r.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.UIa();return}this.bEh(N,"ShowTeachingUIForAddinTab")}bEh(M,N){M.setAttribute("lpp-id","latestAddin");const Ia=jc.a.instance.Ja("Common.ISystemInitiatedFeedback");Ia&&M?(this.HVa("Show",this.Lea),Ia.execute(lb=>{lb.logActivity(N,null)}),r.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):
(this.HVa("NoSifFutureObject",this.Lea),r.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.UIa())}W3i(M){if(!M||!M.haa||!M.haa.vF)return null;for(let N of M.haa.vF)if(N)for(const Ia of N.groups)if(Ia)for(const lb of Ia.controls){if(lb&&lb.attributes&&0===lb.controlType&&lb.enabled)return lb.id;if(lb.menuItems)for(const Sb of lb.menuItems)if(Sb.attributes&&Sb.enabled)return lb.id}return null}HVa(M,N){Pc.iea(M,this.tQ(N))}oBb(M,N){N=Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,
N.storeType,N.assetId,null,null,N.storeId);Pc.iea(M,N)}I_a(M){const N={};N[this.r3c]=fa.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:M});(new ra(this.r3c,null,null,Object(E.a)(this,this.kaa,"postRequestFailureCallback"))).zvb(N);r.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}kaa(M){r.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",
M?M.ie:-1)}UIa(){if(!this.XSg){const M=window.g_roamingAddinList;M&&(this.I_a(M),this.XSg=!0)}}static iea(M,N){M={["AppTeachingUICalloutAction"]:M,["SDX.Id"]:N,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:P.a.sC(M)}))}}Object(h.a)(Pc,"AddinTeachingCalloutHandler",null,[]);class tf{}Object(h.a)(tf,"AddinCommandsHost",null,[]);var xe=d(79),ef=
d(135);class Id extends xe.a{constructor(){super(void 0,void 0,void 0,!0);this.PRb="AddinCommandsUILessDialog";this.cNd="WACDialogTitleText";this.rba="0";this.iS=380;this.pha=190;this.ig=this.PRb;this.yd=5;this.gQh=String.format("{0}px",this.iS);this.qba=String.format("{0}px",this.pha);this.qce=this.Ar=!1;this.qu()}qu(){super.qu();this.fm.style.width=this.gQh;this.fm.style.height=this.qba;this.fm.style.padding=this.rba}xya(M){this.BA();document.getElementById(this.Oh(this.cNd)).innerText=M}BA(){super.BA();
this.Hb.style.width=String.format("{0}px",this.iS);this.Hb.style.height=String.format("{0}px",this.pha);this.Hb.removeAttribute(ef.a.af);this.Hb.removeAttribute(ef.a.U2)}hide(){this.gde()}get Gja(){return this.fm}initializeAndShowWithTitle(){this.aj(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(h.a)(Id,"AddinCommandsUILessDialog",xe.a,[917]);var qe=d(42),jg=d(161),of=d(39),Cb=d(333);class Df extends tf{constructor(M,N,Ia,lb){super();this.lF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&
B.AFrameworkApplication.Aa.hb.iX;this.o$=M;this.Yc=N;this.P6c=Ia;this.Xfb=lb}setOwnerAddinEToken(M){this.o$.eToken=M}showTaskpane(M,N,Ia){r.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.Ffg(M,N,Ia,!0)||r.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(M,N,Ia){r.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.Ffg(M,N,Ia,!1,this.P6c)||r.ULS.sendTraceTag(509699667,
806,10,String.format("UILess : instance id is null."))}disposeHost(){}Ffg(M,N,Ia,lb,Sb=!1){var Wc=this.Yc.oQ(M.solutionId);Wc||(Wc=this.Yc.BZi(M,N,this.o$.solutionId,Sb));if(Wc&&this.Yc.pua(Wc.instanceId))return this.Yc.Wib(Wc.instanceId),Ia(Wc.instanceId,0),Sb||this.Yc.ILb(Wc.instanceId,lb),!0;let td=null;if(!Wc)if(Wc=this.Yc.Mki(M,N,lb,this.o$.solutionId,Sb),Wc.setValue(of.a.ownerAddinStoreType,this.o$.storeType),td=Wc.sa(jg.a.sharedRuntimeId,null),this.Prg(!!td,!0),Sb&&(Sb=Sb&&!td),N=Sb?new Id:
null,Sb?this.Yc.Dkb(Wc,N.Gja):(Wc.setValue(qe.a.qZb,lb||!!td),this.Yc.fkh(Wc)),Wc=this.Yc.oQ(M.solutionId))if(Sb&&this.Xfb.$(Wc.instanceId,N),M=this.Yc.JDa(this.o$.solutionId)){if(M=new Cb.a(M),this.Yc.ZGh(M.id,Wc.instanceId),td&&!this.Yc.v4b(M.Qxa)&&(M=this.Yc.c6d(M.Qxa)))M.gw||M.B5h(td),this.Yc.CGc(this.o$.solutionId,M)}else{M=this.Yc.Lki(this.o$,td);if(!M)return Ia(null,5001),!1;this.Yc.CGc(this.o$.solutionId,M);this.I2j(!!td)}else return Ia(null,5001),!1;Ia(Wc.instanceId,0);this.lF&&(Ia=this.Yc.pua(Wc.instanceId),
this.Yc.ILb(Wc.instanceId,Ia?lb:!0));this.Prg(!!td,!1);return!0}Prg(M,N){M&&window.performance&&window.performance.memory&&r.ULS.sendTraceTag(509699666,802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",N,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}I2j(M){r.ULS.sendTraceTag(509699665,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(this.o$.solutionId,this.o$.storeType,this.o$.assetId,null,null,this.o$.storeId),this.o$.storeType,M)}}Object(h.a)(Df,"WACPowerPointAddInCommandsHost",tf,[]);var Bf=d(189);class qg{constructor(M,N,Ia,lb,Sb,Wc,td,wd,be,hb,hf){this.nH=this.UVg=null;if(!M)throw Error.argumentNull("app");this.Bla=new D;this.lvg=Ia;this.Rb=M.wq;this.je=td;this.Yc=N;this.Cla=Wc;this.Yc.vai(Object(E.a)(this,this.Eui,"clearLoadingAddinMessage"));this.Bla.F9h(Object(E.a)(this,this.srj,
"handleAddinCommandsLoadingMessageChanged"));this.Ha=lb;this.Qb=Sb;db.a.t8b=db.a.Ebh;this.Xfb=new vb.a;this.uCb=be;this.gl=hb;this.A8j=new e.a;this.eCb=new e.a;this.Lc=hf}get Kd(){return this.Yc}X1c(M){r.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",M[Q.a.T7]);if(this.Ha.G$b||!this.Ha.Mia){var N=M[Q.a.mHc];if(N&&0<N.count){const lb=N.count;for(let Sb=lb-1;0<=Sb;Sb--){const Wc=N.ga(Sb);OSF.OsfControl.isFirstPartyStoreString(Wc.storeType)||N.remove(N.ga(Sb))}N.count<lb&&(this.Ha.G$b&&
!this.gl.Mda(22)&&this.gl.jDa(22),this.Ha.Mia||this.gl.Mda(36)||this.gl.jDa(36));if(!N.count)return}}let Ia=null;Ia=B.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new Gc(this.Cla,this.lvg,new bc(this.Yc.vl),new Ab("",vc.a.e6a),this.Bla,ad.instance,new Bd,(lb,Sb)=>{const Wc={};Wc.solutionId=lb.solutionId;Wc.version=lb.version;Wc.storeType=lb.storeType;Wc.storeId=lb.storeId;Wc.assetId=lb.assetId;Wc.assetStoreId=lb.assetStoreId;this.Yc.uol(Wc,()=>{Sb(lb)})}):new Gc(this.Cla,this.lvg,new bc(this.Yc.vl),
new Ab("",vc.a.e6a),this.Bla,ad.instance,new Bd);Ia.R9h(Object(E.a)(this,this.ssk,"onAutoLaunchAddin"));Ia.E9h(Object(E.a)(this,this.gwk,"onLaunchAddinCommandsCompleted"));this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(N=new Pc(this,this.Qb,this.Lc),Ia.A$h(Object(E.a)(N,N.fwk,"onLaunchAddinButtonClicked")),Ia.Xbi(Object(E.a)(N,N.Tll,"showCalloutOnAddin")));try{zc.a.get_instance().Uj(5,null).continueWith(()=>{Ia.G_j(this.uCb,Ad.App.Kb.FF(),M)},
11)}catch(lb){r.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",lb.message))}}qrj(M){M=M[this.Cla.OQa];M=(new Be).xOd(M);return B.AFrameworkApplication.Mia||OSF.OsfControl.isFirstPartyStoreString(M.ownerAddinInfo.storeType)}z7b(M){const N=new Be;this.Cbe(N,M[this.Cla.OQa])}Cbe(M,N){const Ia=M.xOd(N),lb=new Df(Ia.ownerAddinInfo,this.Yc,this.Ha.Pka,this.Xfb);M.z7b(N,this.Bla,lb,new bc(this.Yc.vl),Ia)}Wdh(M){const N=ae.DNk(this.Bla);M[Hd.a.LabelText]=N.labelText;
M[Hd.a.Visible]=N.visible}Gll(){this.pZe()}WMb(M){M&&Q.a.vQd in M&&M[Q.a.vQd]&&Gb.QYe(M[Q.a.vQd].toString())}nUk(){if(this.Bla.r2c()){this.Bla.JFf();const M=this.h6d();if(M&&0<M.count)for(let N of M)this.SKb({["ack1"]:N,["ack0"]:4,["ak0"]:(new Date).getTime()})}else this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(r.ULS.sendTraceTag(509669719,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.Bla.r2c()),this.naa(10,
!0),this.naa(0,!0))}srj(){this.je.Gy(new Bf.a(2));this.pZe()}cNk(M){M&&Q.a.U7 in M?this.naa(M[Q.a.U7],!0):r.ULS.sendTraceTag(509669718,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}naa(M,N=!1){this.Yc?(r.ULS.sendTraceTag(509669716,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",M,N),this.Yc.naa(M,N)):r.ULS.sendTraceTag(509669717,220,10,"QueryAddinDetails: abort because m_appForOfficeManager is null.")}SKb(M){r.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
M[Q.a.T7],M[Q.a.U7]);this.Bla.lal();window.setTimeout(()=>{const N=new Ja(new bc(this.Yc.vl),ad.instance,ec.instance);N.D9h((Ia,lb)=>{this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.naa(M[Q.a.U7]);this.X1c(lb.properties)});N.Zbi((Ia,lb)=>{this.nH=lb;this.UVg=new Pc(this,this.Qb,this.Lc);this.UVg.WWk(this.nH)});N.GBl(M)},0)}Eui(){this.Bla.JFf()}gii(M){var N=this.Yc.oQ(M);if(N&&N.gw&&N.gw.iya&&!(0>=N.gw.state)){var Ia=new Be,lb=Ia.getTaskPaneControlIdFromSolutionIdRuntimeId(M,
N.gw.iya);lb&&(this.Yc.CGc(M,N),this.Cbe(Ia,lb),this.Yc.OGf(M),(N=this.Yc.oQ(M+lb))?this.Yc.setInitialDisplayMode(N.instanceId,1):r.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+M))}}kii(M){if(M&&M.solutionId){var N=new Be,Ia=N.lii;if(Ia=M.solutionId in Ia?Ia[M.solutionId]:null){let lb=this.Yc.oQ(M.solutionId);if(!lb){lb=this.Yc.c6d(M.solutionId);if(!lb){r.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.storeType,M.assetId,null,null,M.storeId)));return}this.Yc.CGc(M.solutionId,lb)}M=lb.settings;(M=Q.a.Nvf in M?M[Q.a.Nvf]:null)&&"true"===M.toLowerCase()&&this.Cbe(N,Ia)}}else r.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}Gil(M){if(void 0===M||null===M||void 0===M[this.Cla.OQa]||null===M[this.Cla.OQa])return!1;M=M[this.Cla.OQa];return ma.a.Wa(M)?!1:this.eCb.contains(M)}yel(M){M=M.haa;if(!M)r.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");
else if(M.vF)for(let N of M.vF)if(N.groups)for(const Ia of N.groups)if(Ia.controls)for(const lb of Ia.controls)if(this.b1e(lb.id,lb.enabled),1===lb.controlType&&lb.menuItems)for(const Sb of lb.menuItems)this.b1e(Sb.id,Sb.enabled)}b1e(M,N){if(M&&M.length){var Ia=this.eCb.contains(M);Ia&&N&&this.eCb.remove(M);Ia||N||this.eCb.add(M)}}GEl(M){let N=null,Ia=null,lb=!0;void 0!==M[Q.a.o1d]&&null!==M[Q.a.o1d]&&void 0!==M[this.Cla.OQa]&&null!==M[this.Cla.OQa]&&void 0!==M[Q.a.m1d]&&null!==M[Q.a.m1d]&&(N=M[Q.a.o1d],
Ia=M[this.Cla.OQa],lb=M[Q.a.m1d]);ma.a.Wa(N)||ma.a.Wa(Ia)||(M=(new cb("",N,this.Cla,!0)).$Da(Ia),this.b1e(M,lb),this.Rb.updateCommandUI())}V3b(M){if(void 0!==M&&null!==M&&void 0!==M[Q.a.n1d]&&null!==M[Q.a.n1d])switch(M[Q.a.n1d]){case 1:this.GEl(M);break;case 4:this.eCb.clear(),this.eCb.addRange(this.A8j)}}ssk(M,N){if(N)if(N)if(M=N.Ju,N=N.WJ,!Xa()&&!ia()||this.Yc.c6d(M.solutionId)){var Ia=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(N=M.solutionId in Ia?Ia[M.solutionId]:
this.I7i(N))?(this.z7b({["SourceControlId"]:N}),M.isAutoLaunched=!0):r.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else r.ULS.sendTraceTag(512259016,220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)));else r.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else r.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}I7i(M){if(!M)return r.ULS.sendTraceTag(512499859,
220,10,"Failed to get button id for addin"),null;M=M.haa;if(!M||!M.vF||!M.vF.count)return r.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),null;M=M.vF.ga(0);if(!M.groups||1!==M.groups.length)return r.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;M=M.groups[0];if(!M.controls||1!==M.controls.length)return r.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;M=M.controls[0];return M.attributes&&0===M.controlType&&M.enabled?M.id:null}gwk(M,N){let Ia=
null;N&&(Ia=N);Ia&&Ia.WJ&&this.yel(Ia.WJ);Ia?(Ia.Ju&&this.gii(Ia.Ju.solutionId),this.Ha.UJj&&window.setTimeout(()=>{Ia.Ju&&this.kii(Ia.Ju)},0)):r.ULS.sendTraceTag(512499855,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}h6d(){const M=new e.a;this.Ha.fua&&(this.Ha.Yie&&M.add(0),this.Qb.ka("187")&&M.add(1),this.Qb.ka("305")&&M.add(10),M.add(8));return M}pZe(){const M=this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",
!1),N=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");ae.Qwh(this.Bla,this.Rb.FF(),N,M?ResourceStrings.L_TabHome:ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}Trc(M){M&&this.Xfb.Gb(M)&&this.Xfb.ga(M).initializeAndShowWithTitle()}q8b(M){M&&this.Xfb.Gb(M)&&this.Xfb.ga(M).hide()}}Object(h.a)(qg,"AddinCommandsManager",null,[889]);class vd{constructor(){this.zVg={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",
["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};this.PHg={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};
this.Z8c=null}get OQa(){return"SourceControlId"}get qT(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}Ydj(){if(!this.Z8c){this.Z8c={};for(const M of Object.keys(this.zVg))this.Z8c[M]=this.zVg[M];for(const M of Object.keys(this.PHg))this.Z8c[M]=this.PHg[M][0]}}}Object(h.a)(vd,"AddinCommandsStringProvider",null,[888]);class $f{constructor(M){this.bBi=M}F2i(){return this.bBi.ali()}}Object(h.a)($f,"ContextMenuExtensibilityHandler",null,[887]);var ng=d(82),Qe=d(35);class Gf{constructor(M,
N,Ia,lb){this.Cye=null;this.Yc=M;this.RVg=N;this.pa=Ia;this.Yf=lb}get fbc(){return this.Cye}set fbc(M){this.Cye=M}register(){this.pa.KG(Object(E.a)(this,this.vod,"selectionChangeEventHandler"));Qe.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Yf.vrb(Object(E.a)(this,this.vod,"selectionChangeEventHandler"))}dispose(){this.pa.yKa(Object(E.a)(this,this.vod,"selectionChangeEventHandler"));Qe.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Yf.hmd(Object(E.a)(this,this.vod,"selectionChangeEventHandler"))}vod(){try{this.fbc&&
this.RVg.Mg(this.fbc),this.Cye=new ng.a(4,1,0,()=>{this.fbc=null;this.qzl()},90,"50"),this.RVg.Db(this.fbc)}catch(M){r.ULS.sendTraceTag(18442309,802,10,M.toString())}}qzl(){try{this.Yc.Seh(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const N=this.pa.uk();if(N){var M=N.gk();if(M)for(const Ia of M)if(Ia.Dq){const lb=new Cb.a(Ia);this.Yc.$Za(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),lb.id,null)}}}catch(N){r.ULS.sendTraceTag(18442310,802,10,N.toString())}}}
Object(h.a)(Gf,"AppForOfficeApiSelectionChangeEventListener",null,[875,106]);var Jf=d(549),xh=d(979),he=d(727);class de{}de.generalException="generalException";de.invalidArgument="invalidArgument";de.notAllowed="notAllowed";de.apiNotAvailable="apiNotAvailable";de.unresolvedPendingRequest="unresolvedPendingRequest";de.timeout="timeout";de.adalTimeout="adalTimeout";de.userNotSignedIn="userNotSignedIn";de.userAborted="userAborted";de.silentSignInFailed="silentSignInFailed";de.invalidResourceUrl="invalidResourceUrl";
de.invalidGrant="invalidGrant";de.connectionLost="connectionLost";de.clientError="clientError";de.serverError="serverError";Object(h.a)(de,"WopiHostErrorCodes",null,[]);var xf=d(226);class re{}Object(h.a)(re,"OAuthCallerMetadata",null,[]);var Ih=d(55);class Le{constructor(M){this.eM=M;this.QRh=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}Z4h(M,N,Ia,lb,Sb,Wc){if(!this.eM)return lb=new xh.a,lb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(lb);const td=new re;td.AddinName=Sb;td.AddinTrustId=Wc;let wd=-1;Wc=null;if(lb&&this.qkg())Wc=this.eM.SEh(Q.a.ptd,M,lb,Le.f6f(Sb),td);else{const be=Date.now();Wc=this.eM.sV(Q.a.ptd,M,td).then(hb=>{wd=Date.now()-be;const hf=(N||Ia)&&"login_required"===hb.ErrorCode;return(N&&("interaction_required"===hb.ErrorCode||"consent_required"===hb.ErrorCode||"invalid_grant"===hb.ErrorCode)||hf)&&this.qkg()?this.eM.SEh(Q.a.ptd,M,null,Le.f6f(Sb),td):Promise.resolve(hb)})}return Wc.then(be=>{const hb=
new xh.a;be.IsSuccess?(hb.token=be.Token,be.Telemetry&&(hb.Ilb=be.Telemetry.fromCache,hb.expiresOn=be.Telemetry.expiresOn)):(hb.errorCode=this.nlk(be),hb.G1e=this.LDk(be));return hb}).catch(()=>{const be=new xh.a;be.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(be)}).then(be=>{be.eCa="OauthManager";0<=wd&&(be.d7b=wd);return be})}XNj(M){const N=(B.AFrameworkApplication.fa.Ga(B.AFrameworkApplication.gK)||"").toLowerCase();return(Ih.a.OFa||"teams"===N&&xf.OAuthManagerSettings.Y$a)&&
!Le.rNj(M)||!this.eM||!this.eM.PKj()?!1:!0}qkg(){return this.QRh||1!==he.a.RRc()}nlk(M){switch(M.ErrorCode){case "UserCancelled":case "interaction_required":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:M=M.ErrorCode===de.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:M.ErrorCode===de.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:M.ErrorCode===de.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:M.ErrorCode===de.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:M.ErrorCode===de.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return M}LDk(M){let N="";(M=RegExp("AADSTS(\\d+)").exec(M.ErrorMessage))&&1<M.length&&(N=M[1]);return N}static f6f(M){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,M)}static rNj(M){if(!M)return!1;M=M.toLowerCase();for(const N of Jf.AppsForOfficeSingleSignOnManager.EQc)if(N===
M)return!0;return!1}}Object(h.a)(Le,"AppsforOfficeTokenFromOauthManager",null,[968]);class Cd{constructor(M){this.ujk=M}static Y3e(){if(B.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var M=null;try{M=jc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(N){r.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+N)}M=new Le(M);Cd.Ka=new Cd(M)}}static getInstance(){Cd.Hef||(Cd.Y3e(),Cd.Hef=!0);return Cd.Ka}}Cd.Ka=null;Cd.Hef=!1;Object(h.a)(Cd,"AppsForOfficeOauthManagerFactory",
null,[945]);class Lc{constructor(M){const N=Cd.getInstance();this.npf=new Jf.AppsForOfficeSingleSignOnManager(M,N)}getAccessTokenAsync(M,N){return new Promise(Ia=>{const lb=B.AFrameworkApplication.fa.ka("342");this.npf.getAccessToken(M,lb,N,(Sb,Wc)=>{const td={};td.errorCode=Sb;td.accessToken=Wc?Wc.accessToken:"";Ia(td)})})}removeCallbackForAddin(M){this.npf.removeCallbackForAddin(M)}}Object(h.a)(Lc,"AppForOfficeAuthProvider",null,[905]);class Td{mDi(M){return new Lc(M)}}Object(h.a)(Td,"AppForOfficeAuthFactory",
null,[859]);var Ge=d(235),Xc=d(63),jf=d(49),Mh=d(629);class bd{constructor(M,N,Ia,lb,Sb,Wc,td){this.pCe=this.oCe=this.Yze=this.Xze=0;this.TIg=.5;this.EDb=null;this.Sve=0;this.h7j={};this.pgc=document.createElement("div");this.pgc.className="OsfAddinOverlay";N.appendChild(this.pgc);Ia.ncl(this.pgc);this.Ckk=M;this.DJ=td;this.DJ.QGc(Object(E.a)(this,this.JHb,"onZoomed"));this.ua=lb;this.Kc=Sb;this.Nq=Wc;this.Nq.eW(Object(E.a)(this,this.SQe,"registerSlideViewElementEvents"))}dispose(){this.DJ.Uld(Object(E.a)(this,
this.JHb,"onZoomed"));this.Nq.Yxa(Object(E.a)(this,this.SQe,"registerSlideViewElementEvents"))}initialize(){if(this.ua.Ba){this.SQe(null,null);const M=this.Kc.Ic;M&&(this.Xze=parseFloat(M.GU.style.left),this.Yze=parseFloat(M.GU.style.top),this.oCe=parseFloat(M.te.xa.style.left),this.pCe=parseFloat(M.te.xa.style.top))}this.G5e();this.JHb(null,new Mh.a(this.Ckk.zoom))}SQe(M,N){(M=this.Kc.Ic)&&M!==this.EDb&&(M.gci(Object(E.a)(this,this.mIh,"updateOffsetFromSlideView")),M.fbi(Object(E.a)(this,this.lIh,
"updateOffsetFromPageContentContainer")),this.EDb&&(this.EDb.x0k(Object(E.a)(this,this.mIh,"updateOffsetFromSlideView")),this.EDb.U_k(Object(E.a)(this,this.lIh,"updateOffsetFromPageContentContainer")),this.a1e(this.EDb,!1)),N&&N.D0c&&1!==this.Sve&&this.a1e(M,!0),this.EDb=M)}a1e(M,N){if(M&&(M=M.Fd)&&M.isConnected){var Ia=M.gk();if(Ia&&Ia.length)for(const Sb of Ia)if(Sb.Dq){Ia=Sb.sa(of.a.NZ,null);var lb=Xc.a.VE(M.eb(of.a.sid),M.eb(of.a.cid)).toString();const Wc=Sb.get_shapeId().toString();Ia=Ia+Wc+
lb;Qe.a("Microsoft.Office.SharedOnline.FixBug6808089")?(lb=Sb.ng(0),(null===lb||void 0===lb?0:lb.xa)?this.UKa(Ia,N,lb.xa.pe):this.UKa(Ia,N,null)):this.UKa(Ia,N,null)}}}u6(M){this.Sve=M;const N=this.Kc.Ic;N?(r.ULS.sendTraceTag(512369926,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",N.Fd.sid,N.Fd.cid),this.a1e(N,2===M)):r.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}lIh(M,
N){this.Xze=N.x;this.Yze=N.y;this.G5e()}mIh(M,N){this.oCe=N.x;this.pCe=N.y;this.G5e()}G5e(){this.pgc.style.left=jf.a.Pc(this.Xze+this.oCe+Ge.a.o6-this.TIg);this.pgc.style.top=jf.a.Pc(this.Yze+this.pCe+Ge.a.o6-this.TIg)}zKj(M){return M in this.Fra}J6k(M,N){this.Fra[M]=N}UKa(M,N,Ia){1===this.Sve&&N||M in this.Fra&&this.Fra[M].UKa(N,Ia)}eih(M){M in this.Fra&&(this.Fra[M].dispose(),delete this.Fra[M])}DVe(M,N){M in this.Fra&&this.Fra[M].DVe(N)}JHb(){}get Fra(){return this.h7j}}Object(h.a)(bd,"AppForOfficeContentAppsContainer",
null,[886,106]);var Bc=d(402);class Hf extends x.StandardDialog{constructor(M,N){super();this.wPh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.hSh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.iSh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.eRh=M;this.ORb=N}showDialog(M,N){const Ia=new xe.a(void 0,void 0,!1);Ia.yd=0;Ia.ig=Bc.a.eld(Number.MAX_VALUE).toString();Ia.eg=String.format("<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
N,this.iSh,this.hSh,this.wPh);Ia.aj(M,Object(E.a)(this,this.Zsk,"onCheckboxExecute$4"),{optInCheckbox:!1})}Zsk(M,N){1===M&&N.optInCheckbox&&(y.a.instance.getItem("optedIntoAddinDeveloperMode")?y.a.instance.removeItem("optedIntoAddinDeveloperMode"):(y.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Xrc()))}Xrc(){const M=new x.StandardDialog;M.yd=4;const N=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.eRh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;M.fP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,N,this.ORb)}}Object(h.a)(Hf,"AppForOfficeDeveloperModeOptInDialog",x.StandardDialog,[]);const Me=M=>{const N=[];if(!M)return N;N[OSF.DDA.Marshaling.ThemingKeys.Accent1]=Tf(M.Accent1);N[OSF.DDA.Marshaling.ThemingKeys.Accent2]=Tf(M.Accent2);N[OSF.DDA.Marshaling.ThemingKeys.Accent3]=Tf(M.Accent3);N[OSF.DDA.Marshaling.ThemingKeys.Accent4]=Tf(M.Accent4);N[OSF.DDA.Marshaling.ThemingKeys.Accent5]=
Tf(M.Accent5);N[OSF.DDA.Marshaling.ThemingKeys.Accent6]=Tf(M.Accent6);N[OSF.DDA.Marshaling.ThemingKeys.Background1]=Tf(M.OsfColorScheme?M.OsfColorScheme.Background1:null);N[OSF.DDA.Marshaling.ThemingKeys.Background2]=Tf(M.OsfColorScheme?M.OsfColorScheme.Background2:null);N[OSF.DDA.Marshaling.ThemingKeys.Text1]=Tf(M.OsfColorScheme?M.OsfColorScheme.Text1:null);N[OSF.DDA.Marshaling.ThemingKeys.Text2]=Tf(M.OsfColorScheme?M.OsfColorScheme.Text2:null);N[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=Tf(M.Hyperlink);
N[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=Tf(M.FollowedHyperlink);const Ia=M.OsfFontScheme;Ia&&(N[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=Ia.HdEaFt,N[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Ia.HdLtnFt,N[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Ia.HdLclFt,N[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Ia.HdSptFt,N[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Ia.BdEaFt,N[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Ia.BdLtnFt,N[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=Ia.BdLclFt,N[OSF.DDA.Marshaling.ThemingKeys.BdScript]=
Ia.BdSptFt);N[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=Tf(M.Background);return N},Tf=M=>{if(!M)return null;let N;N=M.b;N+=M.g<<8;return N+=M.r<<16};class Sd{constructor(M,N,Ia){this.YIg=M;this.VQ=N;this.D9j=Ia}register(){this.YIg.kk(Object(E.a)(this,this.GCh,"themeChangedCallback"))}dispose(){this.YIg.Rm(Object(E.a)(this,this.GCh,"themeChangedCallback"))}GCh(M,N){if(N.node.Sa(of.a.Jd)&&(N.property===of.a.Jd||N.property===of.a.eba)){M=N.node;try{var Ia=Me(M?M.Jd:null)}catch(lb){return}if(M){M=
M.gk();for(const lb of M)lb.Dq&&(M=this.D9j.g3(lb),this.VQ.$Za(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),M.id,Ia))}this.VQ.Seh(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Ia)}}}Object(h.a)(Sd,"AppForOfficeDocumentThemeListener",null,[875,106]);var lf=d(221);class fb extends xe.a{constructor(M,N,Ia){super();this.fra=null;this.cNd="WACDialogTitleText";this.rba="0";this.Spa="15px";this.fQh="0px";this.qba="calc(100% - 30px)";this.eQh="100%";this.Rmf=0;this.Pa=new R.a;
this.PNh=new G;this.yd=5;this.ig=this.PRb=Ia;this.yAd=M;this.taf=N;this.aBd=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}dai(M){this.Pa.addHandler("OnDialogClosedEventKey",M)}bdl(){this.sqa=null}qu(){super.qu();this.fm.style.width="100%";this.fm.style.height=this.g8b?this.qba:this.eQh;this.fm.style.marginTop=this.g8b?this.Spa:this.fQh;this.fm.style.padding=this.rba}BA(){super.BA();this.Hb.style.width=String.format("{0}px",this.yAd*window.innerWidth/
100);this.Hb.style.height=String.format("{0}px",this.taf*window.innerHeight/100);this.Hb.style.minWidth="0px";this.aBd&&B.AFrameworkApplication.isRtl&&100===this.yAd&&(this.Hb.style.right="0px",this.Hb.style.marginRight="0px");this.fra=document.getElementById(this.Oh(this.cNd));this.fra.style.position="absolute";this.fra.style.whiteSpace="nowrap";this.fra.style.textOverflow="ellipsis";B.AFrameworkApplication.isRtl?(this.fra.style.right="14px",this.fra.style.left="44px"):(this.fra.style.right="44px",
this.fra.style.left="14px")}xya(M){super.xya(M);this.fra&&this.fra.setAttribute("title",M)}get Gja(){return this.fm}QSe(){this.Hb.style.width=String.format("{0}px",this.yAd*window.innerWidth/100);this.Hb.style.height=String.format("{0}px",this.taf*window.innerHeight/100);this.Hb.style.overflowY="hidden";this.Hb.style.overflowX="hidden";this.Hb.style.marginTop="";this.Hb.style.top="";Ih.a.bbb&&B.AFrameworkApplication.isRtl?(this.Hb.style.right="",this.Hb.style.marginRight=""):(this.Hb.style.left="",
this.Hb.style.marginLeft="")}hide(){this.PNh.XJf(3,this.PRb).execute(this,O.getInstance(),{});this.Rmf=window.setTimeout(()=>{this.Pa.raiseEvent("OnDialogClosedEventKey",this.PRb);lf.a.prototype.hide.call(this)},500)}w5g(M){3===M&&(window.clearTimeout(this.Rmf),this.Pa.raiseEvent("OnDialogClosedEventKey",this.PRb),super.hide())}}Object(h.a)(fb,"AppsForOfficeDialog",xe.a,[867,868]);class Qb{constructor(){this.dialog=this.ig=null}}Object(h.a)(Qb,"DialogInfo",null,[]);class ac{}ac.url="url";ac.height=
"height";ac.width="width";ac.B0d="displayInIframe";ac.MWc="hideTitle";Object(h.a)(ac,"DialogSettings",null,[]);class Jc{constructor(){this.height=this.width=0;this.ig=this.controlId=this.pageUrl=null;this.MWc=this.B0d=!1}}Object(h.a)(Jc,"DisplayDialogParams",null,[]);class pd extends Sys.EventArgs{constructor(M,N,Ia=null,lb="",Sb=""){super();this.controlId=M;this.messageType=N;this.messageContent=Ia;this.MEe=lb;this.NLa=Sb}}Object(h.a)(pd,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class qd extends Sys.EventArgs{constructor(M,
N,Ia=null,lb="",Sb=""){super();this.controlId=M;this.messageType=N;this.messageContent=Ia;this.MEe=lb;this.NLa=Sb}}Object(h.a)(qd,"OnMessageParentEventArgs",Sys.EventArgs,[]);var sd=d(109);class ze{constructor(M){this.Pa=new R.a;this.cN=M}Aai(M){this.Pa.addHandler("OnMessageParentEventKey",M)}xjh(M){this.Pa.removeHandler("OnMessageParentEventKey",M)}zai(M){this.Pa.addHandler("OnMessageDialogEventKey",M)}y_k(M){this.Pa.removeHandler("OnMessageDialogEventKey",M)}showDialog(M,N,Ia,lb){if(ze.Hpa.Gb(N))r.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const hf=fa.b(M),Xf=hf[ac.url];if(this.cN.getOsfControl(N).checkAppDomains(Xf)){var Sb=new Jc;Sb.width=hf[ac.width];Sb.height=hf[ac.height];Sb.pageUrl=Xf;Sb.B0d=hf[ac.B0d];Sb.MWc=hf[ac.MWc];Sb.controlId=N;Sb.ig=sd.a.create().toString();var Wc=new Qb;Wc.ig=Sb.ig;var td=this.cN.getOsfControl(Sb.controlId).getManifest().getDefaultDisplayName(),wd=this.cN.getOsfControl(Sb.controlId).getStoreType().toLowerCase();
M=null;M=(4===B.AFrameworkApplication.Aa.hb.Uk&&"hardcodedpreinstall"===wd||"sdxcatalog"===wd)&&Sb.MWc?this.createAndShowAppsForOfficeDialog(Sb.width,Sb.height,Sb.ig,!0,td):this.createAndShowAppsForOfficeDialog(Sb.width,Sb.height,Sb.ig,!1,td);var be=this.cN.getOsfControl(Sb.controlId),hb=be.getManifest();N={};N.id=Sb.ig;N.solutionId=be.getSolutionId();N.version=be.getVersion();N.storeType=wd;N.storeId=be.getStoreId();N.assetId=be.getAssetId();N.assetStoreId=be.getAssetStoreId();N.ownerAddinSolutionId=
be.getOwnerAddinSolutionId();N.ownerAddinStoreType=be.getOwnerAddinStoreType();N.appDomains=hb.getAppDomains();N.dialogUrl=Xf;N.osfControlType=1;N.agaveName=td;N.div=M.Gja;r.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),ma.a.sN(Sb.pageUrl));this.cN.insertDialogControl(N);M.dai(Object(E.a)(this,this.Rtk,"onDialogClosed"));Wc.dialog=M;ze.Hpa.$(Sb.controlId,
Wc);lb&&lb(N);Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else r.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(hf){r.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",hf.message),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}wnk(M,N,Ia,lb){B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===lb&&(lb=Ia);try{const Sb=this.$Da(M);Sb&&this.Pa.raiseEvent("OnMessageParentEventKey",new qd(Sb,OSF.DialogMessageType.DialogMessageReceived,N,Ia,lb))}catch(Sb){return r.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Sb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Fvi(M,N){if(ze.Hpa.Gb(M))try{const Ia=ze.Hpa.ga(M);Ia.dialog&&Ia.dialog.hide();this.cN.purgeDialogControl(Ia.ig);
ze.Hpa.remove(M);N(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ia){r.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ia.message),N(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else r.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),N(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}y9k(M,N,Ia,lb){B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===lb&&(lb=Ia);if(ze.Hpa.Gb(M)&&(M=ze.Hpa.ga(M),M.dialog))try{this.Pa.raiseEvent("OnMessageDialogEventKey",new pd(M.ig,OSF.DialogMessageType.DialogParentMessageReceived,N,Ia,lb))}catch(Sb){r.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Sb.message)}}$Da(M){let N=null;for(let Ia of ze.Hpa)if(Ia.value.ig===M){N=Ia.key;break}return N}Rtk(M,N){if(M=this.$Da(N))this.cN.purgeDialogControl(N),ze.Hpa.remove(M),this.Pa.raiseEvent("OnMessageParentEventKey",
new qd(M,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(M,N,Ia,lb,Sb){M=new fb(M,N,Ia);Sb=lb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Sb);lb&&(M.g8b=!1,M.Ar=!1);M.aj(Sb,null,null);M.bdl();return M}static J9f(){return ze.Hpa}static getInstance(M){ze.Ka||(ze.Ka=new ze(M));return ze.Ka}}ze.Ka=null;ze.Hpa=new vb.a;Object(h.a)(ze,"AppsForOfficeDialogManager",null,[846]);var Wd=d(722),ye=d(67),Yc=d(121),Ae=d(95),hd=d(173),oe=d(124);class Xe extends Sys.EventArgs{constructor(M){super();
this.nca=M}}Object(h.a)(Xe,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var Ke=d(48);class me{constructor(M,N,Ia,lb,Sb,Wc){this.UQ=[];this.RDe=new Wd.a;this.lF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.iX;this.VX=M;this.tak=this.VX.firstChild;this.Fa=N;this.Lr=Ia;this.ob=lb;this.Yc=Sb;this.je=Wc}get R2(){return this.UQ}get Kd(){return this.Yc.value}nce(){return 0<this.Wjc}RP(M){if(M){this.R2.push(M);var N=M.xa;N&&!this.lF&&this.VX.insertBefore(N,
this.tak);1===this.Wjc&&this.Fa.Ej(oe.a.OTd,!0);M.isVisible&&this.Lr.addHandler(M.xa,ye.a.Xf,Object(E.a)(this,this.lbg,"handleShortCutsOnAddinPane"))}}Eih(M){M&&(Array.remove(this.UQ,M),M=M.xa,this.Lr.removeHandler(M,ye.a.Xf,Object(E.a)(this,this.lbg,"handleShortCutsOnAddinPane")),M&&!this.lF&&this.VX.removeChild(M),this.Wjc||this.Fa.Ej(oe.a.OTd,!1))}u6(M){if(1===M||2===M){if(1===M){this.RDe=new Wd.a;for(const N of this.R2)N.isVisible&&this.RDe.add(N.id.toLowerCase())}M=2===M;for(const N of this.R2)this.RDe.contains(N.id.toLowerCase())&&
(N.Ap(M),(M&&1===this.Wjc||!M&&!this.Wjc)&&this.Fa.Ej(oe.a.OTd,M))}}xuj(M,N){for(const Ia of this.UQ)M=Ia.layout(M,N)}DU(M,N){if(M){M=null;if(N===Ke.a.sg)for(N=this.UQ.length-1;0<=N;N--){if(this.UQ[N].isVisible){M=this.UQ[N];break}}else if(N===oe.a.YBf||N===oe.a.dni||N===Yc.AFrame.ZV||N===Yc.AFrame.G4b||N===oe.a.Y2||N===oe.a.ini||N===Ke.a.ME||N===Ke.a.SI||N===Ke.a.KW)for(N=0;N<this.UQ.length;N++)if(this.UQ[N].isVisible){M=this.UQ[N];break}this.S4d(M)}}S4d(M){if(M){var N=this.Kd.wQc(M.id);N&&this.je.OOk(new Xe(N.nca));
this.Kd.notifyAgave(M.id,11)}else r.ULS.sendTraceTag(19014042,806,10,"Focus could not be put on the null addin pane!")}q0i(M,N){var Ia;for(Ia=0;Ia<this.UQ.length&&this.UQ[Ia].id!==M;Ia++);if(Ia===this.UQ.length)r.ULS.sendTraceTag(19014043,806,10,String.format("Failed to find the taskpane with instance id: {0}",M)),this.x3e(N);else{M=null;if(5===N)for(--Ia;0<=Ia;Ia--){if(this.UQ[Ia].isVisible){M=this.UQ[Ia];break}}else if(6===N)for(Ia+=1;Ia<this.UQ.length;Ia++)if(this.UQ[Ia].isVisible){M=this.UQ[Ia];
break}M?this.S4d(M):this.x3e(N)}}fYf(M){for(const N of this.UQ)if(N.id===M){Ae.FocusManager.Wr(N.Mvi);return}r.ULS.sendTraceTag(19014044,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",M))}$Al(M){for(let N of ze.J9f())if(N.value.ig.toLowerCase()===M.toLowerCase())return N.value.dialog.hide(),N.key;return null}x3e(M){5===M?this.Fa.xTa(!1):6===M&&this.Fa.xTa(!0)}zUf(){const M=this.ob.Xd();M&&1===M.length&&(this.ob.selectShape(M[0],!0),this.Fa.Ed())}get Wjc(){let M=
0;for(const N of this.R2)N.isVisible&&M++;return M}lbg(M){if(M.keyCode===hd.a.hZ&&M.ctrlKey)for(var N=0;N<this.R2.length;N++){var Ia=this.R2[N];if(Ia.isVisible&&Ia.xa.contains(M.target)){Ia=null;if(M.shiftKey)for(N+=1;N<this.R2.length;N++){if(this.R2[N].isVisible){Ia=this.R2[N];break}}else for(--N;0<=N;N--)if(this.R2[N].isVisible){Ia=this.R2[N];break}Ia&&(this.S4d(Ia),M.preventDefault(),M.stopPropagation());break}}}rf(M){this.Fa.rf(M)}}Object(h.a)(me,"AppForOfficeFocusManager",null,[884]);var Uf=
d(954);class yf{MDi(M,N,Ia){M=Uf.a.Z7f(M.zhb);M.appName=OSF.AppName.PowerpointWebApp;M.clientMode=1;M.formFactor="DefaultSettings";M.hostControl=N;N=jc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");M.allowExternalMarketplace=M.allowExternalMarketplace&&N.d1b;Ia.register(M);Ia=new OSF.ContextActivationManager(M);Ia.setWSA(B.AFrameworkApplication.kj);return Ia}}Object(h.a)(yf,"AppForOfficeImportedClassFactory",null,[885]);class Cf{constructor(M){this.mtg=M}GQe(){for(const M of this.mtg)M.register()}dispose(){for(const M of this.mtg)M.dispose()}}
Object(h.a)(Cf,"AppForOfficeListenerManager",null,[879,106]);var Ld=d(1205),od=d(1206),ug=d(158),Kf=d(970);class Vf{constructor(){this.AUP=this.priority=0}}Object(h.a)(Vf,"AddinDetailInfo",null,[]);class Ch{constructor(){this.qNb=null;this.errorCode=0;this.failure=null}}Object(h.a)(Ch,"AddinCollection",null,[]);class xg extends Sys.EventArgs{constructor(M,N){super();this.yrb=M;this.V7=N}}Object(h.a)(xg,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class lh{constructor(M){this.errorCode=M;this.V7=
[];this.failure=null}}Object(h.a)(lh,"GetAddinDetailsResult",null,[]);var Oi=d(540);class ph{}Object(h.a)(ph,"GetEntitlementDetailsParameters",null,[]);var Dh=d(193),mh=d(215),Od=d(6);class Ue{constructor(M,N,Ia=null){this.Pa=new R.a;this.Gpa=new Ld.a(od.a.Hn());this.XH=new ug.a;this.WId=null;this.kDd="https://store-images.s-microsoft.com";this.bMd=new mh.a;this.bMd.add(OSF.StoreTypeEnum.MarketPlace,0);this.bMd.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.$a=M;this.cN=N;this.D2a=Ia;if(this.eMi||this.SMf)this.kDd=
Ue.Cbj(M,this.kDd);this.Fuf(Object(E.a)(this,this.QGe,"onAddinDetailsRefreshed"))}get eMi(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)}get SMf(){return!!this.$a&&this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled")}get bYf(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get X9b(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get vl(){return this.cN.value}g5b(M){if(!this.Wie(M))return M=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Kf.a[M]}),Object.assign(new lh(1),{failure:M});if(this.XH.ga(M).failure)return Object.assign(new lh(this.XH.ga(M).errorCode),{failure:this.XH.ga(M).failure});r.ULS.shipAssertTag(509870082,220,!!this.XH.ga(M).qNb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",M);const N=new lh(0);for(let Ia of this.XH.ga(M).qNb)this.Gpa.Gb(Ia)&&
Array.add(N.V7,this.Gpa.ga(Ia));return N}X3i(M){return this.Gpa.Gb(M)?this.Gpa.ga(M):null}kWk(M){if(M){this.Fuf(M);for(let Ia of this.XH.keys)if(this.Wie(Ia)&&!this.XH.ga(Ia).failure){r.ULS.shipAssertTag(509870081,220,!!this.XH.ga(Ia).qNb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ia);var N=[];for(let lb of this.XH.ga(Ia).qNb)Array.add(N,this.Gpa.ga(lb));N=new xg(Ia,N);M(null,N)}}}naa(M,N=!1){0!==M&&10!==M?r.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
Oi.a[M]):this.bNk(M,Object(E.a)(this,this.Qxk,"onQueryAddinDetailsCompleted"),N)}Fuf(M){this.Pa.addHandler(Q.a.Qvf,M)}Qxk(M,N,Ia){if(Ia)if(Ue.b5j(M,Ia,window.performance.now()-N),0===Ia.errorCode){let Sb;if(Ia.value){let Wc=0;Sb=Array(Ia.value.length);Ia.value.forEach(td=>{Sb[Wc++]=td})}else Sb=[];this.e1g(M,Sb)}else if(-1===Ia.errorCode||10===Ia.errorCode)this.e1g(M,[]);else{var lb={};lb.collectionType=Kf.a[M];lb.invokeResultCode=Ia.errorCode;lb["queryResult.Value"]=Ia.value?String.format("Length: {0}",
Ia.value.length):"null";lb.queryStart=N;lb.queryDuration=window.performance.now()-N;this.XH.$(M,Object.assign(new Ch(M),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",lb)}));r.ULS.sendTraceTag(512231324,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Kf.a[M],this.XH.ga(M).failure.toString(),JSON.stringify(this.XH.ga(M).failure))}else lb={},lb.collectionType=Kf.a[M],lb.queryResult=Ia?"not null":
"null",lb.queryStart=N,lb.queryDuration=window.performance.now()-N,this.XH.$(M,Object.assign(new Ch(M),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",lb)})),r.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Kf.a[M],this.XH.ga(M).failure.toString(),JSON.stringify(this.XH.ga(M).failure))}fce(M){const N={};N.collectionType=Kf.a[M];this.XH.$(M,Object.assign(new Ch(M),
{errorCode:2,failure:Error.create("The store is disabled.",N)}));r.ULS.sendTraceTag(510253056,220,10,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Kf.a[M],this.XH.ga(M).failure.toString(),JSON.stringify(this.XH.ga(M).failure))}Wjl(){return this.Wie(2)?this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.XH.ga(2).failure:!1:!0}bNk(M,N,Ia=!1){r.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",
M);M!==OSF.StoreTypeEnum.MarketPlace&&M!==OSF.StoreTypeEnum.PrivateCatalog?r.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",M):(this.Wjl()&&this.queryStoreDisabled(0,(lb,Sb)=>{Sb?this.fce(2):(lb=window.performance.now(),N(2,lb,this.Ogj()))}),this.queryStoreDisabled(M,(lb,Sb)=>{if(lb===OSF.StoreTypeEnum.MarketPlace&&Sb)this.fce(0);else if(lb===OSF.StoreTypeEnum.PrivateCatalog&&Sb)this.fce(1);else{var Wc=window.performance.now();this.vl.getEntitlementDetails(Object.assign(new ph,{storeType:lb,
refresh:Ia}),td=>{N(this.bMd.ga(lb),Wc,td)})}}))}e1g(M,N){M=new xg(M,N);this.Pa.raiseEvent(Q.a.Qvf,M)}QGe(M,N){M=Object.assign(new Ch(N.yrb),{qNb:new e.a});var Ia=N.V7;for(const lb of Ia)Ia=lb.solutionId,this.Gpa.Gb(Ia)?this.Gpa.$(Ia,this.Omk(this.Gpa.ga(Ia),N.yrb,lb)):this.Gpa.add(Ia,lb),M.qNb.add(Ia);this.XH.$(N.yrb,M)}Wie(M){return this.XH.Gb(M)?!!this.Gpa:!1}get Pgi(){return this.D2a?!this.D2a.AreThirdPartyAddInsAllowed||this.D2a.AppsForOfficeThirdPartyIsDisabled:!this.$a.ka("AreThirdPartyAddInsAllowed")||
this.$a.ka("AppsForOfficeThirdPartyIsDisabled")}get kRj(){return this.D2a?!this.D2a.AppsForOfficeAllowExternalMarketplace:!this.$a.ka("AppsForOfficeAllowExternalMarketplace")}get Lid(){return this.D2a?this.D2a.PopularAddinDetailsJsonString:this.$a.Ga("PopularAddinDetailsJsonString")}queryStoreDisabled(M,N){if(this.Pgi)N(M,!0);else if(M===OSF.StoreTypeEnum.MarketPlace&&this.kRj)N(M,!0);else{const Ia=Ue.Bxl(M);if(Ia){const lb=window.performance.now();this.vl.queryStoreDisabled(Ia,Sb=>{r.ULS.sendTraceTag(509679070,
220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",M,Sb,lb,window.performance.now()-lb);N(M,Sb)})}else N(M,!1)}}Omk(M,N,Ia){if(!M)return Ia;if(!Ia)return M;if(this.bYf)return 2===N?Ue.EZg(Ia,M):Ue.EZg(M,Ia);if(2===N)return M.addinInfo=Ia.addinInfo,M;Ia.addinInfo=M.addinInfo;return Ia}Ogj(){if(this.SMf){if(!this.WId){var M=JSON.parse(this.Lid);this.x_i(M);this.WId=M}return Ue.pBf(this.WId)}M=JSON.parse(this.Lid);this.JXf(M);return Ue.pBf(M)}x_i(M){this.bYf&&
Ue.sfi(M);this.Ofi(M);this.JXf(M)}Ofi(M){const N=this.bmi();for(var Ia=0;Ia<M.length&&0<N.count;Ia++){const lb=M[Ia];if(N.Gb(lb.solutionId)){let Sb=String.format("Found an override, solutionId: {0}",lb.solutionId);const Wc=N.ga(lb.solutionId);Wc&&(isNaN(Wc.addinInfo.priority)||(Sb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Sb,lb.addinInfo.priority,Wc.addinInfo.priority),lb.addinInfo.priority=Wc.addinInfo.priority),isNaN(Wc.addinInfo.AUP)||(Sb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Sb,lb.addinInfo.AUP,Wc.addinInfo.AUP),lb.addinInfo.AUP=Wc.addinInfo.AUP),Wc.displayName&&(Sb=String.format("{0}; DisplayName: update {1} to {2}",Sb,lb.displayName,Wc.displayName),lb.displayName=Wc.displayName),Wc.iconUrl&&(Sb=String.format("{0}; IconUrl: update {1} to {2}",Sb,lb.iconUrl,Wc.iconUrl),lb.iconUrl=Wc.iconUrl),Wc.description&&(Sb=String.format("{0}; Description: update {1} to {2}",Sb,lb.description,Wc.description),lb.description=Wc.description));N.remove(lb.solutionId);this.X9b&&r.ULS.sendTraceTag(509379136,
220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Sb)}}for(let lb of N.keys)Ia=N.ga(lb),Ia.displayName&&Ia.iconUrl&&Ia.addinInfo&&(M.push(Ia),this.X9b&&r.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ia)))}bmi(){const M=new Ld.a(od.a.Hn());let N=this.$a.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!N)return M;N=N.trim();if(12>=N.length)return 0<N.length&&r.ULS.sendTraceTag(509379106,
220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",N),M;this.X9b&&r.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",N);try{const Ia=[],lb=N.split("|");for(let Sb=lb.length-1;0<=Sb;Sb--){const Wc=lb[Sb],td=Wc.split("\\");if(2>td.length){Ia.push(Wc);continue}const wd=Ue.oEk(td);wd?M.Gb(wd.solutionId)||M.add(wd.solutionId,wd):Ia.push(Wc)}this.X9b&&0<Ia.length&&r.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
Ia.join("|"));this.X9b&&0<M.count&&r.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",M.count,JSON.stringify(Od.toArray(M.values)));return M}catch(Ia){r.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",N,Ia.toString())}return M}JXf(M){for(let N=0;N<M.length;N++)Dh.c(M[N].iconUrl.toLowerCase(),"http",0)||(M[N].iconUrl=String.format("{0}/image/apps.{1}",this.kDd,M[N].iconUrl))}static b5j(M,
N,Ia){const lb={};lb.AddinCollectionType=Kf.a[M];lb.ErrorCode=N.errorCode;lb.AddinCount=N.value?N.value.length:0;r.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",Ia,JSON.stringify(lb))}static pBf(M){const N={errorCode:0};N.value=M;return N}static Bxl(M){return M===OSF.StoreTypeEnum.MarketPlace?"omex":M===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static EZg(M,N){N.solutionId=N.solutionId||M.solutionId;N.version=N.version||
M.version;N.storeType=N.storeType||M.storeType;N.storeId=N.storeId||M.storeId;N.assetId=N.assetId||M.assetId;N.assetStoreId=N.assetStoreId||M.assetStoreId;N.displayName=N.displayName||M.displayName;N.provider=N.provider||M.provider;N.description=N.description||M.description;N.iconUrl=N.iconUrl||M.iconUrl;N.webApplicationId=N.webApplicationId||M.webApplicationId;N.highResolutionIconUrl=N.highResolutionIconUrl||M.highResolutionIconUrl;N.licenseUrl=N.licenseUrl||M.licenseUrl;N.privacyUrl=N.privacyUrl||
M.privacyUrl;N.addinInfo=N.addinInfo||M.addinInfo;isNaN(N.targetType)&&(N.targetType=M.targetType);isNaN(N.height)&&(N.height=M.height);isNaN(N.width)&&(N.width=M.width);return N}static sfi(M){for(const N of M)isNaN(N.targetType)&&(N.targetType=1),N.assetId=N.assetId||N.solutionId,N.storeId=N.storeId||"en-US",N.storeType=N.storeType||"omex",N.assetStoreId=N.assetStoreId||"omex",isNaN(N.width)&&(N.width=0),isNaN(N.height)&&(N.height=0)}static oEk(M){const N={};let Ia=0;Ia<M.length&&0<M[Ia].trim().length&&
M[Ia].trim().toLowerCase().startsWith("wa")&&(N.solutionId=M[Ia].trim(),N.addinInfo=Object.assign(new Vf,{priority:Number.NaN,AUP:Number.NaN}),++Ia<M.length&&0<M[Ia].trim().length&&(N.addinInfo.priority=parseInt(M[Ia].trim())),++Ia<M.length&&0<M[Ia].trim().length&&(N.addinInfo.AUP=parseInt(M[Ia].trim())),++Ia<M.length&&0<M[Ia].trim().length&&(N.displayName=M[Ia].trim()),++Ia<M.length&&0<M[Ia].trim().length&&(N.iconUrl=M[Ia].trim()),++Ia<M.length&&0<M[Ia].trim().length&&(N.description=M[Ia].trim()));
return N.solutionId?N:null}static Cbj(M,N){M=M.Ga("AddinImageStoreServiceUrl");if(!M)return N;M=M.toLowerCase();return M.startsWith("http://")||M.startsWith("https://")?M:N}}Object(h.a)(Ue,"AddinDetailsManager",null,[847]);var yh=d(195),Hj=d(352),fe=d(577),Zh=d(1203);class Pi extends xe.a{constructor(){super();this.qba="calc(100% - 46px)";this.Spa="15px";this.rba="0";this.SRb="WACDialogPanel";this.iS=695;this.TRb=462;this.pha="80%";this.HQb=350;this.WMa="100%";this.yd=5;this.ig="AppsForOfficeInsertionDialog";
this.aBd=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}qu(){super.qu();this.fm.style.width=this.WMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Spa;this.fm.style.padding=this.rba}oaa(){this.fm.style.width=this.WMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Spa;this.fm.style.padding=this.rba;this.iS>lf.a.CR?(this.Hb.style.width=String.format("{0}px",lf.a.CR),this.Hb.style.overflowX="scroll",B.AFrameworkApplication.isRtl?
this.Hb.style.right="0":this.Hb.style.left="0"):(this.Hb.style.width=String.format("{0}px",this.iS),this.Hb.style.overflowX="hidden");this.Hb.offsetHeight>lf.a.HU||this.TRb+50>lf.a.HU?(this.Hb.style.height=String.format("{0}px",lf.a.HU),this.Hb.style.overflowY="scroll",this.Hb.style.top="0",B.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0",this.aBd||(this.Hb.style.marginTop="-48px"),this.fm.style.minHeight=String.format("{0}px",this.HQb)):(this.Hb.style.overflowY="hidden",
this.Hb.style.top="10%",this.Hb.style.height=this.pha);this.mCa()}mCa(){if(this.Hb){var M=this.Hb.style.zIndex;this.Hb.style.zIndex="-9999";if(this.iS>lf.a.CR)B.AFrameworkApplication.isRtl?this.Hb.style.marginRight="0":this.Hb.style.marginLeft="0";else{const N=String.format("{0}px",Math.floor(-this.Hb.offsetWidth/2));B.AFrameworkApplication.isRtl?this.Hb.style.marginRight=N:this.Hb.style.marginLeft=N;B.AFrameworkApplication.isRtl?this.Hb.style.right="50%":this.Hb.style.left="50%"}this.Hb.style.zIndex=
String(M)}else r.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}BA(){super.BA();const M=document.getElementById(this.Oh(this.SRb));M.style.width=String.format("{0}px",this.iS);M.style.height=this.pha}get Gja(){return this.fm}}Object(h.a)(Pi,"AppsForOfficeInsertionDialog",xe.a,[811]);class Zj extends xe.a{constructor(M=!0,N=!0){super();this.qba="calc(100% - 46px)";this.Spa="15px";this.rba="0";this.SRb="WACDialogPanel";this.iS=695;this.TRb=462;this.pha="80%";this.HQb=350;
this.WMa="100%";this.Taf="auto";this.Uaf="5px";this.Vaf="auto";this.Raf="40px";this.Saf="100px";this.Waf="200px";this.yd=5;this.ig="SDXDialog";this.qAc=M;this.g8b=N}qu(){super.qu();this.fm.style.width=this.WMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Spa;this.fm.style.padding=this.rba}oaa(){this.fm.style.width=this.WMa;this.fm.style.height=this.qAc?this.qba:"100%";this.fm.style.marginTop=this.qAc?this.Spa:"0px";this.fm.style.padding=this.rba;this.qAc?(this.iS>lf.a.CR?(this.Hb.style.width=
String.format("{0}px",lf.a.CR),this.Hb.style.overflowX="scroll",B.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0"):(this.Hb.style.width=String.format("{0}px",this.iS),this.Hb.style.overflowX="hidden"),this.Hb.offsetHeight>lf.a.HU||this.TRb+50>lf.a.HU?(this.Hb.style.height=String.format("{0}px",lf.a.HU),this.Hb.style.overflowY="scroll",this.Hb.style.top="0",B.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0",this.fm.style.minHeight=String.format("{0}px",
this.HQb)):(this.Hb.style.overflowY="hidden",this.Hb.style.top="10%",this.Hb.style.height=this.pha),this.mCa()):(this.Hb.style.left=this.Taf,this.Hb.style.right=this.Uaf,this.Hb.style.top=this.Vaf,this.Hb.style.bottom=this.Raf,this.Hb.style.width=this.Waf,this.Hb.style.height=this.Saf,this.Hb.style.overflowX="hidden",this.Hb.style.overflowY="hidden")}mCa(){if(this.Hb){var M=this.Hb.style.zIndex;this.Hb.style.zIndex="-9999";if(this.iS>lf.a.CR)B.AFrameworkApplication.isRtl?this.Hb.style.marginRight=
"0":this.Hb.style.marginLeft="0";else{const N=String.format("{0}px",Math.floor(-this.Hb.offsetWidth/2));B.AFrameworkApplication.isRtl?this.Hb.style.marginRight=N:this.Hb.style.marginLeft=N;B.AFrameworkApplication.isRtl?this.Hb.style.right="50%":this.Hb.style.left="50%"}this.Hb.style.zIndex=String(M)}else r.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}BA(){super.BA();const M=document.getElementById(this.Oh(this.SRb));M.style.width=String.format("{0}px",this.iS);M.style.height=
this.pha}get Pzb(){return this.qAc}get Gja(){return this.fm}gbl(M,N,Ia,lb){this.Taf=M;this.Uaf=N;this.Vaf=Ia;this.Raf=lb}hbl(M,N){this.Saf=M;this.Waf=N}}Object(h.a)(Zj,"SDXDialog",xe.a,[]);class Wg extends xe.a{constructor(M,N,Ia,lb){super();this.qba="calc(100% - 46px)";this.Spa="15px";this.rba="0";this.SRb="WACDialogPanel";this.iS=695;this.TRb=462;this.pha="80%";this.HQb=350;this.WMa="100%";this.DNa=null;this.yd=5;this.ig="AddinInstallDialog";this.uOh=M;this.Dba=N;this.B3h=Ia;this.wYh=lb}qu(){super.qu();
this.fm.style.width=this.WMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Spa;this.fm.style.padding=this.rba;document.getElementById(this.Oh("WACDialogButtonPanel")).style.display="none";this.FQa.setAttribute("tabindex","0");$addHandler(this.FQa,"keyup",Object(E.a)(this,this.cwk,"onKeyUp"));const M=document.createElement("iframe");M.setAttribute("id","InstallAddinDialog");M.setAttribute("src","about:blank");M.setAttribute("width","100%");M.setAttribute("height","100%");M.setAttribute("marginHeight",
"0");M.setAttribute("marginWidth","0");M.setAttribute("frameBorder","0");M.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const N=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.uOh,this.Dba,this.B3h);M.setAttribute("src",N);this.DNa=M;$addHandler(M,"load",Object(E.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(E.a)(this,this.onMessage,"onMessage"));this.fm.appendChild(M);
this.fm.appendChild(this.GEi())}GEi(){const M=document.createElement("div");M.setAttribute("tabindex","0");$addHandler(M,"focus",Object(E.a)(this,this.rwk,"onLoopPivotFocus"));return M}cwk(M){13!==M.keyCode&&32!==M.keyCode||this.hide()}rwk(){this.FQa.focus()}onLoad(){this.DNa.focus()}onMessage(M){M=M.rawEvent;if(M.source===this.DNa.contentWindow&&(M=(M=M.data)?M.split("|"):null)&&0<M.length&&("REFRESH_REQUIRED"===M[0]||"PRELOAD_MANIFEST"===M[0])){y.a.instance.setItem("refreshRequired","true");const N=
{};N.solutionId=M[1];N.version=Wg.Ppk(M[3]);N.storeType=M[4];N.storeId=M[5];N.assetId=M[6];N.targetType=Wg.yEk(M[2]);N.assetStoreId=M[7];N.width=parseInt(M[8]);N.height=parseInt(M[9]);this.wYh(N)}}oaa(){this.fm.style.width=this.WMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Spa;this.fm.style.padding=this.rba;this.iS>lf.a.CR?(this.Hb.style.width=String.format("{0}px",lf.a.CR),this.Hb.style.overflowX="scroll",B.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0"):
(this.Hb.style.width=String.format("{0}px",this.iS),this.Hb.style.overflowX="hidden");this.Hb.offsetHeight>lf.a.HU||this.TRb+50>lf.a.HU?(this.Hb.style.height=String.format("{0}px",lf.a.HU),this.Hb.style.overflowY="scroll",this.Hb.style.top="0",B.AFrameworkApplication.isRtl?this.Hb.style.right="0":this.Hb.style.left="0",this.fm.style.minHeight=String.format("{0}px",this.HQb)):(this.Hb.style.overflowY="hidden",this.Hb.style.top="10%",this.Hb.style.height=this.pha);this.mCa()}mCa(){if(this.Hb){var M=
this.Hb.style.zIndex;this.Hb.style.zIndex="-9999";if(this.iS>lf.a.CR)B.AFrameworkApplication.isRtl?this.Hb.style.marginRight="0":this.Hb.style.marginLeft="0";else{const N=String.format("{0}px",Math.floor(-this.Hb.offsetWidth/2));B.AFrameworkApplication.isRtl?this.Hb.style.marginRight=N:this.Hb.style.marginLeft=N;B.AFrameworkApplication.isRtl?this.Hb.style.right="50%":this.Hb.style.left="50%"}this.Hb.style.zIndex=String(M)}else r.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}BA(){super.BA();
const M=document.getElementById(this.Oh(this.SRb));M.style.width=String.format("{0}px",this.iS);M.style.height=this.pha}get Gja(){return this.fm}dispose(){super.dispose();$removeHandler(window,"message",Object(E.a)(this,this.onMessage,"onMessage"))}static yEk(M){switch(M){case "1":return 0;case "2":return 1;default:return 0}}static Ppk(M){const N=M.split(".");for(let Ia=0;Ia<4-N.length;Ia++)M+=".0";return M}}Object(h.a)(Wg,"AddinInstallDialog",xe.a,[]);var $h=d(176);class Fe{constructor(M,N,Ia){this.xyb=
M;this.onSuccess=N;this.onError=Ia;$addHandler(window,"message",Object(E.a)(this,this.J7b,"handleResponse"))}J7b(M){try{if(M&&M.rawEvent&&M.rawEvent.origin&&this.xyb&&this.xyb.id){var N=this.i$g(M.rawEvent.origin);const Ia=this.i$g(document.domain);if(od.a.Hn().equals(Ia,N))if(M.rawEvent.source&&M.rawEvent.source.frameElement&&M.rawEvent.source.frameElement.id&&od.a.Hn().equals(M.rawEvent.source.frameElement.id,this.xyb.id)){N=null;try{N=JSON.parse(M.rawEvent.data)}catch(lb){r.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",lb.message)}N?(N.statusCode!==$h.a.Wv||void 0!==N.error&&N.error?(r.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",N.statusCode,N.error),this.onError()):(r.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(N.authorizationCode?N.authorizationCode:
N.signInUrl)),$removeHandler(window,"message",Object(E.a)(this,this.J7b,"handleResponse")),this.xyb?document.body.contains(this.xyb)?document.body.removeChild(this.xyb):r.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):r.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):r.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else r.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else r.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else r.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ia){r.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ia.message)}}i$g(M){let N="";try{M&&(N=-1<M.indexOf("//")?M.split("/")[2]:M.split("/")[0])&&(N=N.split(":")[0],N=N.split("?")[0])}catch(Ia){r.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Ia.message)}return N}static $x(M,N,Ia){new Fe(M,N,Ia)}}Object(h.a)(Fe,"ResponseHandler",null,[]);var Ph=d(214);class rg{constructor(M){this.jra=M}tryAuthenticate(M,N){this.kid(rg.VTh,()=>{M()},N)}tryAuthorize(M,N){this.kid(rg.DOh,M,N)}getSignInUrl(M,N){this.kid(rg.lpf,M,N)}signOut(M,N){this.kid(rg.B1h,M,N)}kid(M,N,Ia){var lb=new Ph.QueryStringBuilder("AuthenticationProxyHandler.aspx");lb.Xg("responseType",M);B.AFrameworkApplication.APa(lb);lb=String.format("{0}{1}&{2}",
this.jra,lb.toString(),B.AFrameworkApplication.hh);const Sb=document.createElement("iframe");Sb.setAttribute("id","privateCatalogIframe");Sb.setAttribute("name","privateCatalogIframe");Sb.setAttribute("style","display: none");od.a.Hn().equals(M,rg.lpf)||Sb.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Fe.$x(Sb,N,Ia);Sb.setAttribute("src",lb);document.body.appendChild(Sb)}}rg.DOh="authcode";rg.VTh="identitytoken";rg.lpf="signinurl";rg.B1h="signout";
Object(h.a)(rg,"AuthenticationProxy",null,[]);class zg{}zg.getUserId="getUserId";zg.getLastStoreUpdate="laststoreupdate";zg.getEntitlement="getEntitlements";zg.getEToken="getEToken";zg.getManifest="getManifest";zg.getAppState="getAppState";zg.getKilledApps="getRemovedAddins";zg.getAppDetails="getAppDetails";zg.removeApps="removeAddin";zg.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";zg.getPrivateCatalogAddIns="getAddIns";zg.getPrivateCatalogManifests="getAppManifests";zg.isStoreDisabled=
"isStoreDisabled";Object(h.a)(zg,"S2SWebRequestActions",null,[]);var lj=d(525);class pg{getUserId(M,N){const Ia=new e.a;Ia.add(new Ua.a("corr",M));this.Lx(zg.getUserId,Ia,1,N)}getLastStoreUpdate(M,N,Ia){const lb=new e.a;lb.add(new Ua.a("lc",M));lb.add(new Ua.a("corr",N));this.Lx(zg.getLastStoreUpdate,lb,1,Ia)}getEntitlement(M,N,Ia,lb){M=new e.a;M.add(new Ua.a("av",N));M.add(new Ua.a("corr",Ia));this.Lx(zg.getEntitlement,M,1,lb)}getEToken(M,N,Ia,lb,Sb,Wc){const td=new e.a;td.add(new Ua.a("cmu",M));
td.add(new Ua.a("cmf",N));td.add(new Ua.a("assetid",Ia));td.add(new Ua.a("expver",lb));td.add(new Ua.a("corr",Sb));this.Lx(zg.getEToken,td,1,Wc)}getManifest(M,N,Ia,lb){const Sb=new e.a;Sb.add(new Ua.a("cmu",M));Sb.add(new Ua.a("assetid",N));Sb.add(new Ua.a("corr",Ia));this.Lx(zg.getManifest,Sb,1,lb)}getAppState(M,N,Ia){const lb=new e.a;lb.add(new Ua.a("ma",M));lb.add(new Ua.a("corr",N));this.Lx(zg.getAppState,lb,1,Ia)}getKilledApps(M,N){const Ia=new e.a;Ia.add(new Ua.a("corr",M));this.Lx(zg.getKilledApps,
Ia,1,N)}getAppDetails(M,N,Ia,lb){const Sb=new e.a;Sb.add(new Ua.a("cmo",M));Sb.add(new Ua.a("corr",Ia));this.sendWithBody(zg.getAppDetails,Sb,N,2,lb,!1)}removeApps(M,N,Ia){const lb=new e.a;lb.add(new Ua.a("corr",N));this.sendWithBody(zg.removeApps,lb,M,2,Ia,!1)}getLastPrivateCatalogUpdate(M,N,Ia,lb,Sb,Wc){const td=new e.a;td.add(new Ua.a("catalog","privatecatalog"));td.add(new Ua.a("clientCode",M));td.add(new Ua.a("clientVersion",N));td.add(new Ua.a("corr",Sb));M=String.format("authorizationCode={0}&refreshToken={1}",
Ia?ma.a.Ne(Ia):"",lb?ma.a.Ne(lb):"");this.sendWithBody(zg.getLastPrivateCatalogUpdate,td,M,2,Wc,!0)}getPrivateCatalogAddIns(M,N,Ia,lb,Sb,Wc){const td=new e.a;td.add(new Ua.a("catalog","privatecatalog"));td.add(new Ua.a("clientCode",M));td.add(new Ua.a("clientVersion",N));td.add(new Ua.a("corr",Sb));M=String.format("authorizationCode={0}&refreshToken={1}",Ia?ma.a.Ne(Ia):"",lb?ma.a.Ne(lb):"");this.sendWithBody(zg.getPrivateCatalogAddIns,td,M,2,Wc,!0)}getPrivateCatalogManifests(M,N,Ia,lb,Sb){const Wc=
new e.a;Wc.add(new Ua.a("catalog","privatecatalog"));Wc.add(new Ua.a("corr",lb));M=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",ma.a.Ne(M),N?ma.a.Ne(N):"",Ia?ma.a.Ne(Ia):"");this.sendWithBody(zg.getPrivateCatalogManifests,Wc,M,2,Sb,!0)}isStoreDisabled(M,N){const Ia=new e.a;Ia.add(new Ua.a("corr",M));this.Lx(zg.isStoreDisabled,Ia,2,N)}Lx(M,N,Ia,lb){this.sendWithBody(M,N,null,Ia,lb,!1)}sendWithBody(M,N,Ia,lb,Sb,Wc){const td=new Ph.QueryStringBuilder("AddinServiceHandler.ashx");
td.Xg("action",M);td.Xg("app",lj.a[B.AFrameworkApplication.Aa.hb.Uk]);for(let wd of N)td.Xg(wd.key,wd.value);N=String.format("{0}{1}&{2}",B.AFrameworkApplication.Aa.hb.tna,td.toString(),B.AFrameworkApplication.hh);B.AFrameworkApplication.Ke.nj(N,lb,Ia,null,!1,2,wd=>{let be=null,hb=null;wd&&wd.data&&(wd.data.tj["X-BlockedForMinor"]&&"1"===wd.data.tj["X-BlockedForMinor"].toString()&&(wd.data.ie=451),be=wd.data.Wd,hb=wd.data.tj);Sb(wd.data.ie,be,hb)},wd=>{var be=null;let hb=null;Wc&&wd&&wd.data&&wd.data.Wd&&
(be=wd.data.Wd,hb=wd.data.tj);Sb(wd.data.ie,be,hb);if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){be={message:"AddinServiceHandler request failed"};be.code=wd.data.ie;be.action=M;if(wd.data.request||wd.data.request.get_headers())be["X-UserSessionId"]=wd.data.request.get_headers()["X-UserSessionId"];408===wd.data.ie||503===wd.data.ie?r.ULS.sendTraceTag(538784582,220,10,JSON.stringify(be)):r.ULS.sendTraceTag(18392345,220,50,
JSON.stringify(be))}else r.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",wd.data.ie)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+M,void 0,void 0,void 0,["X-UserKey"])}}Object(h.a)(pg,"S2SWebRequestManager",null,[]);var Nh=d(32),Ha=d(84);class kb{constructor(M,N){this.state=M;this.iya=N}}Object(h.a)(kb,"BackgroundAppData",null,[931]);class Hb{constructor(M,N,Ia,lb,Sb,Wc,td,wd){this.nca=null;this.f7j=M;this.Pik=lb;this.mB=N;this.ou=Ia;this.xhc=Sb;this.settings=Wc;
this.i7j=td;this.gw=wd}get Jo(){return this.f7j}get taskpane(){return this.Pik}get instanceId(){return this.mB}get shape(){return this.ou}get Zw(){return this.i7j}B5h(M){this.gw=new kb(0,M)}}Object(h.a)(Hb,"AppForOffice",null,[881]);var ic=d(31);class Qc{}Qc.c_Error="Error";Object(h.a)(Qc,"ApiResponseKeyStrings",null,[]);class Jd{constructor(M,N,Ia,lb,Sb){this.EventDispId=M;this.ControlId=N;this.TargetId=Ia;this.Handler=lb;this.Callback=Sb}}Object(h.a)(Jd,"EventRegistrationParams",null,[]);var yd=
d(28);class He{constructor(M,N){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.zb=B.AFrameworkApplication.ye;this.rze=M;this.Txg=N}InvokeDdaMethod(M,N,Ia){const lb=M.DdaMethod.DispatchId,Sb=this.rze.C4i(lb);Sb?(Sb.parameters=M,Sb.callback=N,Sb.Uci=Ia,Sb.controlId=M.DdaMethod.ControlId,this.zb.Db(new ng.a(2,1,0,Object(E.a)(Sb,Sb.go,"go"),90,"51"))):(M="API Call for method ID "+lb+" does not exist:"+ic.Debug.Vt(),yd.a.J(8958091,802,10,M),this.vUd(N))}RegisterDdaEventAsync(M,
N,Ia,lb,Sb){const Wc=new ng.a(2,1,0,Object(E.a)(this,this.wVk,"registerEventTaskProcess"),90,"52");Wc.customData=new Jd(M,N,Ia,lb,Sb);this.zb.Db(Wc)}UnregisterDdaEventAsync(M,N,Ia,lb,Sb){const Wc=new ng.a(2,1,0,Object(E.a)(this,this.fDl,"unregisterEventTaskProcess"),90,"53");Wc.customData=new Jd(M,N,Ia,lb,Sb);this.zb.Db(Wc)}wVk(M){M=M.customData;var N=this.Txg.$5d(M.EventDispId);N?N.addHandler(M.ControlId,M.Handler,M.Callback,M.TargetId):(N="Event for dispatch ID "+M.EventDispId+" does not exist:"+
ic.Debug.Vt(),yd.a.J(8958093,802,10,N),this.vUd(M.Callback))}fDl(M){M=M.customData;var N=this.Txg.$5d(M.EventDispId);N?N.removeHandler(M.ControlId,M.Handler,M.Callback,M.TargetId):(N="Event for dispatch ID "+M.EventDispId+" does not exist:"+ic.Debug.Vt(),yd.a.J(8958095,802,10,N),this.vUd(M.Callback))}vUd(M){if(M){var N={};N[Qc.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;M(N)}}}Object(h.a)(He,"AppForOfficeApiAdapter",null,[937]);class sf{constructor(M,N,Ia,lb){this.menuItemId=M;this.aV=
N;this.Osl=Ia;this.hYi=lb}}Object(h.a)(sf,"NewDocumentParameters",null,[]);var bg=d(583),Ag=d(130),Ii=d(140),aj=d(44),Xg=d(53),Qi=d(76),Jh=d(33),Og=d(40),Qh=d(51),Yg=d(41),If=d(34),mj=d(58);class xi{constructor(M,N,Ia){this.ufb=[];this.s5c=this.xCb=!1;this.ta=M;this.UF=N;this.rz=Ia}build(){const M=this.ta.xC();if(!M)return this.ufb;for(const N of M)if(this.ULk(N),this.s5c)break;return this.ufb}ULk(M){const N=Jh.ParagraphReader.textLength(M);this.VLk(M,N);this.s5c||this.ALk(M)}VLk(M,N){this.xCb||(this.UF>=
N?this.UF-=N:(this.xCb=!0,this.rz||this.ufb.push(Qh.a.Mj(Object(ea.a)(Ha.a,M),this.UF))));this.xCb&&(this.rz>N-this.UF?0<N&&(this.ufb.push(Qh.a.createTextRange(Object(ea.a)(Ha.a,M),this.UF,N)),this.rz-=N-this.UF,this.UF=0):0<this.rz&&(this.ufb.push(Qh.a.createTextRange(Object(ea.a)(Ha.a,M),this.UF,this.UF+this.rz)),this.rz=0));0>=this.rz&&(this.s5c=!0)}ALk(M){this.xCb||(0<this.UF?--this.UF:(this.xCb=!0,this.rz||this.ufb.push(Qh.a.VQa(Object(ea.a)(Ha.a,M)))));this.xCb&&0<this.rz&&(this.ufb.push(Qh.a.Fca(Object(ea.a)(Ha.a,
M))),--this.rz);0>=this.rz&&(this.s5c=!0)}}Object(h.a)(xi,"TextSelectionBuilder",null,[]);var Bj=d(972),yi=d(30);class Zg{constructor(M,N,Ia,lb,Sb,Wc,td,wd,be,hb,hf,Xf,Bg,ji,pi,Oe,Ri,Rj,dh,ff,Kj,Mf,ke){this.Ha=M;this.Qb=N;this.nJ=Ia;this.Ceb=lb;this.pa=Sb;this.lJ=Wc;this.F8c=td;this.Jb=wd;this.ia=be;this.ua=hf;this.Vb=hb;this.Tb=Xf;this.ic=Bg;this.c7j=ji;this.ob=pi;this.Fb=Oe;this.Sk=Ri;this.Ea=Rj;this.Pb=dh;this.MHa=ff;this.Ih=Kj;this.Ou=Mf;this.odk=ke}Hjj(){let M;M="";if(this.ob.gH()){if(1<this.ob.sod())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
aqc:M};const N=this.ob.kp();if(this.IWj(N)){const Ia=[];this.Ea.NJ(N,lb=>{lb&&Ia.push(lb.characterData)});M=Ia.join(Zg.OCf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,aqc:M}}}else if(this.ob.Zz())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,aqc:M}}Djj(){let M;M="";return{returnValue:({g_e:M}=this.getSelectedSlides()).returnValue,O8k:M}}Nwb(){return this.nJ.zhb.documentUrl}Hqj(M){if(!M)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
var N=this.Tb.qj();if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const Ia=this.ua.Ba.me;switch(M){case "previous":M=Ia-1;break;case "next":M=Ia+1;break;case "first":M=0;break;case "last":M=N-1;break;default:if(M=parseInt(M),isNaN(M))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>M||M>N-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;N=this.Tb.ZA(M);if(!N)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Vb.Ba=N;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Iqj(M){if(!M)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
M=parseInt(M);if(isNaN(M))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;M=this.Q$d(M);if(!M)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Vb.Ba=M;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Sel(M){var N=this.ob.Xd();if(!N.length){if(N=Object(ea.a)(116,this.ob.uk()||this.ua.Ba)){var Ia=N.Cb;M=this.Sk.SYd(Ia.cid,Ia.sid,N.Wt()+1,M,"");Ia=this.Jb.Ad(7);Ia.nc(N);N.gC(M);this.ob.selectShape(M,!0);Ia.dispose();this.Ou.SF=M;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===
N.length){if(this.ob.gH())return this.Sfl(M);if(this.ob.Zz())return this.Tfl(M)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Nel(M,N,Ia,lb,Sb,Wc,td){if(this.LPc(Sb,0,Zg.Bmb)||this.LPc(Wc,0,Zg.Bmb)||this.LPc(Ia,-Zg.Bmb,Zg.Bmb)||this.LPc(lb,-Zg.Bmb,Zg.Bmb)||0!==td&&1!==td)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(M.length>this.Ha.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var wd=this.ob.Xd().length;
if(N||Sb||Wc||!wd){wd=this.ua.Ba;if(!wd)throw Error.argumentNull("ActiveSlide is null");const be=wd.Cb,hb=wd.Wt();let hf=!0,Xf=new mj.a(0,0);N?Xf=new mj.a(Ia,lb):!this.Ha.iIk||Sb&&Wc?Xf=this.Tb.Eta(Sb,Wc):hf=!1;N=this.Sk.nsa(!1,be.cid,be.sid,0,bg.a.GH(Xf.x),bg.a.GH(Xf.y),bg.a.GH(Sb),bg.a.GH(Wc),hb+1,!0);hf||(N.io(Og.a.Ay),N.io(Og.a.By));N.Hj=!0;N.qrd=!0;N.ez=td;N.Gka=0===td?this.uKf(M):M;N.izb=!0;M=this.Jb.Ad(7);try{this.Ha.eB&&(M.jd=yi.a.utf),M.nc(wd),wd.gC(N),this.ob.selectShape(N,!0)}finally{M&&
M.dispose()}this.Ou.SF=N;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===wd&&(wd=this.ob.kp())&&wd.xJc){N=this.ua.Ba;if(!N)throw Error.argumentNull("ActiveSlide is null");Ia=this.l$a(N,wd);Ia.Hj=!0;Ia.ez=td;Ia.Gka=0===td?this.uKf(M):M;Ia.izb=!0;M=this.Jb.Ad(7);try{M.nc(N),N.PU([wd]),N.gC(Ia),this.ob.selectShape(Ia,!0)}finally{M&&M.dispose()}this.Ou.SF=Ia;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}yd.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Pka(){return this.Ha.Pka}DKj(){return this.Qb.ka("342")}L9i(M){if(!M)return null;
M=this.c7j.g3(M);M=0===M.Zw?M.node:this.ua.Ba;if(!M)return null;M=Object(ea.a)(115,this.ic.jg(M));return Me(M.Jd)}pUe(M,N){if(M&&N)if(Qe.a("UseUndoTransactionForSaveSettingToApp")){var Ia=this.Jb.Ad(15,void 0,void 0,void 0,!0);try{Ia.nc(M),Ia.jd=yi.a.Nyb,Bj.a.YGh(this.F8c.value,M,N)}finally{Ia&&Ia.dispose()}}else{Ia=this.Jb.Ad(4);try{Ia.nc(M),Bj.a.YGh(this.F8c.value,M,N),this.Vb.zi.bga()}finally{Ia&&Ia.dispose()}}}L7a(M,N,Ia){const lb=new x.StandardDialog;lb.yd=4;lb.Gx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_NewFileAPIConsentMessage,1,Sb=>{2===Sb||0===Sb?Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Sb=new sf("blank","agave",M?Zg.jpk:Zg.kpk,M),this.odk.create(N,Ia,Sb).L7a())})}Qe(){return this.ob.Qe()}Xd(){return this.ob.Xd()}Ljj(){var M=this.ob.Xd();if(!(M.length&&this.ob.Zz()&&this.pa.value&&this.pa.value.Na.length))return[];const N=this.pa.value.Na.ga(0);return(M=Zg.Ihj(M[0],N))&&2===M.length?M:[]}KBl(M){if(!M)return!1;this.ob.Lub();if(!M.length)return!0;M[0]!==this.ua.Ba&&
(this.Vb.Ba=M[0]);for(const N of M)N&&this.ob.j6a(N);return!0}JBl(M){if(!M)return!1;if(!M.length)return this.ob.Rh(),!0;this.ob.R_a(M,!0);return!0}LBl(M,N,Ia){if(!Zg.Hng(M))return!1;if(0>N)return!0;M=(new xi(M,N,Ia)).build();M=[new Ag.Selection(M,!0)];M=new Ii.SelectionCollection(M,0);this.ob.RE(M);return!0}getSelectedSlides(){let M;M="";var N=null;if(!N||!N.length){var Ia=this.ob.uk()||this.ua.Ba;N||(N=[]);Ia&&N.push(Ia)}if(!N.length)return yd.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,g_e:M};Ia=[];for(const lb of N){N=lb.me+1;if(!N)return yd.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,g_e:M};Array.add(Ia,[lb.sid.toString(),lb.title||"",N.toString()])}M=fa.c(Ia);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,g_e:M}}getSelectedTextRange(){var M=[];for(let N=0;N<this.pa.value.Na.length;N++){const Ia=this.pa.value.Na.ga(N);
Array.add(M,this.EUc(Ia))}M=M.join(Zg.OCf);if(M===Qi.AParagraphNode.j_)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,aqc:M};M=Qi.AParagraphNode.Pld(M);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,aqc:M}}IWj(M){if(!M)return!1;let N=M.kla||M.ux||M.Qf||M.ud;if(!N&&M.fl)switch(M.Jj){case 0:case 2:case 1:case 3:case 10:case 8:N=!0}return N}JWj(M){if(!M)return!1;let N=M.kla||M.ux;if(!N&&M.fl)switch(M.Jj){case 0:case 2:case 1:case 3:case 8:N=
!0}return N}EUc(M){let N="";if(M)for(let Ia=0;Ia<M.length;Ia++){const lb=M.ga(Ia),Sb=lb.Qa,Wc=lb.Lb-Sb;let td="";Jh.ParagraphReader.ae(lb.node)&&(td=lb.node.characterData);switch(lb.contextId){case Yg.a.paragraph:N+=td+"\r";break;case Yg.a.textRange:0<Wc&&(N+=td.substr(Sb,Wc));break;case Yg.a.endOfParagraph:N+="\r"}}return N}Q$d(M){var N=this.ua.presentation;if(!N)throw Error.argumentNull("Presentation is null");N=N.slides||[];for(let Ia=0;Ia<N.length;Ia++)if(N[Ia].Cb.sid===M)return Object(ea.a)(116,
N[Ia]);return null}Tfl(M){if(!this.pa.value||!this.lJ.value||!this.Ceb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.pa.value.Na.length){if(!aj.SelectionEditor.ox(this.pa.value.Na.mb)&&32!==this.ia.processAction(If.a.$Ca,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var N=this.pa.value.Na.mb.Ua;const Ia=N.node,lb=N.Qa;N=N.Lb;const Sb=this.Jb.Ad(7);try{Sb.nc(Ia);let Wc=null;Wc=lb===N?Qh.a.Mj(Ia,lb):Qh.a.createTextRange(Ia,lb,N);this.lJ.value.replaceTextRange(Wc,
M)}finally{Sb.dispose()}N=lb+M.length;this.pa.value.setSelection(Xg.SelectionFactory.k3(Ia,lb,N));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}yd.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Sfl(M){if(!this.pa.value||!this.lJ.value||!this.Ceb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const N=this.ob.kp();if(!N)return M="Fail to get shape while setting selected shape's text: shape returned as null: "+
ic.Debug.Vt(),yd.a.J(512263106,802,10,M),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.JWj(N)){const Ia=this.Pb.Mc(N),lb=this.Jb.Ad(7);try{lb.nc(Ia);N.deleteParagraph();this.Ceb.value.iW(Ia,!0);this.MHa.oi(Ia);const Sb=Ia.currentNode,Wc=this.Ih.textLength(Sb),td=Qh.a.createTextRange(Sb,0,Wc);this.lJ.value.replaceTextRange(td,M)}finally{lb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}yd.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}LPc(M,
N,Ia){return M<N||Ia<M}uKf(M){return"data:image/png;base64,"+M}l$a(M,N){if(!M)return null;var Ia=M.Cb;M=M.Wt();let lb;const Sb=Kd.a.hY,Wc=Kd.a.y5;lb=N?N.kxb(Kd.a.hY,Kd.a.y5):this.Tb.Eta(Kd.a.hY,Kd.a.y5);Ia=this.Sk.nsa(!0,Ia.cid,Ia.sid,0,lb.x,lb.y,Sb,Wc,M+1,!0);N&&(Ia.vca=N.id);return Ia}static Hng(M){if(!M)return!1;let N=M.kla||M.ux;if(!N&&M.fl)switch(M.Jj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:N=!0}return N}static xnj(M,N){M=M.xC();if(!M||!N)return 0;let Ia=0;for(const lb of M){if(lb===
N)break;Ia+=Jh.ParagraphReader.textLength(Object(ea.a)(Ha.a,lb))+1}return Ia}static Ihj(M,N){if(!Zg.Hng(M)||!N)return[];var Ia=-1;let lb=0;for(let Sb of N){N=Jh.ParagraphReader.ae(Sb.node)?Jh.ParagraphReader.textLength(Sb.node):0;if(-1===Ia)switch(Ia=Jh.ParagraphReader.ae(Sb.node)?Zg.xnj(M,Object(ea.a)(5,Sb.node)):0,Sb.contextId){case Yg.a.paragraph:break;case Yg.a.textRange:case Yg.a.Of:Ia+=Sb.Qa;break;case Yg.a.endOfParagraph:Ia+=N;break;default:return[]}switch(Sb.contextId){case Yg.a.paragraph:lb+=
N+1;break;case Yg.a.textRange:lb+=Math.max(0,Sb.Lb-Sb.Qa);break;case Yg.a.endOfParagraph:lb+=1}}return[Ia,lb]}}Zg.OCf=" ";Zg.Bmb=169056;Zg.kpk="streamEmpty";Zg.jpk="streamBase64";Object(h.a)(Zg,"AppForOfficeApiFacadeEditorImpl",null,[936]);class ya{Oag(M,N,Ia){if(Ia.JDa(M))r.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(M=Ia.v4b(M)){const lb={};lb.solutionId=M.Jo.id;lb.version=M.Jo.version;lb.storeType=M.Jo.storeType;
lb.storeId=M.Jo.store;lb.assetId=null;lb.assetStoreId=null;lb.targetType=1;lb.isAddinCommands=!0;lb.addinCommandsActionType=1;lb.sharedRuntimeId=M.gw?M.gw.iya:null;lb.backgroundState=M.gw?M.gw.state:-1;M.settings=N;Ia.nRd.VG().La(yi.a.HXc,2,lb);return!0}return!1}AKj(M,N){if(!M&&!N)return!0;if(!M||!N||Object.keys(M).length!==Object.keys(N).length)return!1;for(let Sb in M){var Ia=Sb,lb=M[Sb];if(!(Ia in N)||N[Ia]!==lb)return!1}return!0}}Object(h.a)(ya,"AppForOfficeAppSettingProxy",null,[]);class La{constructor(M,
N,Ia,lb){this._id=M;this.Q5a=N;this.H7=Ia;this.Opf=lb}get id(){return this._id}get version(){return this.Q5a}get store(){return this.H7}get storeType(){return this.Opf}}Object(h.a)(La,"AppForOfficeReference",null,[935]);class Qa{constructor(M,N){this._id=M;this.N1h=N}get id(){return this._id}get slideId(){return this.N1h}}Object(h.a)(Qa,"AppForOfficeShape",null,[934]);class Eb{constructor(M,N,Ia,lb,Sb,Wc=null,td=!1){this.pRh=M;this.t4h=N;this.T5a=Ia;this.j0h=lb;this.oId=Sb;this.isForUILessAction=
td;this.RYh=Wc}get yQf(){return this.pRh}get visibility(){return this.t4h}get width(){return this.T5a}get row(){return this.j0h}get ownerAddinSolutionId(){return this.oId}get ownerAddinStoreType(){return this.RYh}}Object(h.a)(Eb,"AppForOfficeTaskpane",null,[932]);class fc{constructor(M,N,Ia,lb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=M;this.controlId=N;this.ddaBinding=Ia;this.ArrayData=lb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}
Object(h.a)(fc,"DdaEventArgs",null,[]);class mc{constructor(M,N){this.rCb=null;this.Yc=M;this.ia=N}$5d(M){this.rCb||this.dHk();if(!M||!this.rCb[M])return null;M=this.rCb[M];M.Kd=this.Yc;M.An=this.ia;return M}dGf(M){const N=this.rCb;for(let Ia in N)N[Ia].removeHandler(M)}set(M,N){this.rCb[M]=N}}Object(h.a)(mc,"ApiEventStore",null,[]);class Mc{constructor(){this.Bo=this.ia=this.Yc=null;this.Bl={}}get handlers(){return this.Bl}get An(){return this.ia}set An(M){this.ia=M}get Kd(){return this.Yc}set Kd(M){this.Yc=
M}raiseEvent(M,N=null){M=this.Fta(M);if(N){var Ia=this.Bl[N];Ia&&Ia(M)}else for(Ia in N=this.Bl,N){const lb=N[Ia];lb&&lb(M)}}addHandler(M,N,Ia=null){this.Bl[M]=N;this.X6a(Ia)}removeHandler(M,N,Ia=null){delete this.Bl[M];this.X6a(Ia)}get result(){return this.Bo}X6a(M){this.OA(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}OA(M,N){M&&(this.Bo={},this.Bo[Qc.c_Error]=N,M(this.Bo))}}Object(h.a)(Mc,"ApiEvent",null,[980]);class nd extends Mc{constructor(){super()}Fta(M){return M}static get instance(){nd.Rp||
(nd.Rp=new nd);return nd.Rp}}nd.Rp=null;Object(h.a)(nd,"ActivationStatusChangedEvent",Mc,[]);class ba extends Mc{constructor(){super()}Fta(){return"view"}static get instance(){ba.Rp||(ba.Rp=new ba);return ba.Rp}}ba.Rp=null;Object(h.a)(ba,"ActiveViewChangedEvent",Mc,[]);var Aa=d(105);class Wa extends Mc{constructor(){super();this.jqe=null}Fta(){return null}get zsa(){!this.jqe&&this.Kd&&(this.jqe=ze.getInstance(this.Kd.vl));return this.jqe}addHandler(M,N,Ia=null,lb=null){this.Kd?this.Kd.zu.Pka()?M in
this.handlers?this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(r.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(M,lb,Sb=>{Sb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Aa.a.count(this.handlers)||this.zsa.Aai(Object(E.a)(this,this.JIe,"onMessageParentEvent")),this.handlers[M]=N,this.Kd.vl?({value:Sb}=ze.J9f().Tf(M),Sb?(this.Kd.vl.setActivationCompletedStatus(Sb.ig,!0),this.Kd.$Za(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),Sb.ig,
!0)):r.ULS.sendTraceTag(24463263,806,15,"Show dialog successed but get dialogInfo failed")):r.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.X6a(Ia)):(r.ULS.sendTraceTag(20247127,806,10,"Show dialog failed. Error code: {0}",Sb.toString()),this.OA(Ia,Sb))})):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(M,N,Ia=null){this.Kd?this.Kd.zu.Pka()?
M in this.handlers?(r.ULS.sendTraceTag(20247128,802,50,"RemoveHandler was called."),this.zsa.Fvi(M,lb=>{delete this.handlers[M];Aa.a.count(this.handlers)||this.zsa.xjh(Object(E.a)(this,this.JIe,"onMessageParentEvent"));lb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&r.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",lb.toString());this.OA(Ia,lb)})):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(M,N,Ia){try{this.zsa.showDialog(N,M,Ia,null)}catch(lb){r.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",lb.message),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}JIe(M,N){if(N.controlId in this.Bl){M={};M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=N.messageType;M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=
N.messageContent;M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=N.MEe;M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=N.NLa;const Ia=this.Bl[N.controlId];Ia&&Ia(M);N.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.Bl[N.controlId],Aa.a.count(this.Bl)||this.zsa.xjh(Object(E.a)(this,this.JIe,"onMessageParentEvent")))}}static get instance(){Wa.Rp||(Wa.Rp=new Wa);return Wa.Rp}}Wa.Rp=null;Object(h.a)(Wa,"DialogMessageReceivedEvent",Mc,[]);
class gb extends Mc{constructor(){super()}Fta(){return null}addHandler(M,N,Ia=null){this.Kd?this.Kd.zu.Pka()?(N=this.Kd.uwb(M))&&N.taskpane&&N.taskpane.isForUILessAction?(this.An.La(vc.a.Trc,2,M),this.X6a(Ia)):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(M,N,Ia=null){this.Kd?this.Kd.zu.Pka()?(N=this.Kd.uwb(M))&&N.taskpane?N.taskpane.isForUILessAction?
(this.An.La(vc.a.q8b,2,M),this.X6a(Ia)):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(h.a)(gb,"DialogNotificationShownInAddinEvent",Mc,[]);class nb extends Mc{constructor(){super();this.vl=this.SRd=null}Fta(){return null}get zsa(){this.SRd||(this.SRd=ze.getInstance(this.contextActivationMgr));
return this.SRd}get contextActivationMgr(){!this.vl&&this.Kd&&(this.vl=this.Kd.vl);return this.vl}addHandler(M,N,Ia=null){this.Kd&&!this.Kd.zu.Pka()?this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):M in this.Bl?this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(Aa.a.count(this.Bl)||this.zsa.zai(Object(E.a)(this,this.r5g,"onMessageDialogEvent")),this.Bl[M]=N,this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(M,N,Ia=null){this.Kd&&!this.Kd.zu.Pka()?
this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):M in this.Bl?(delete this.Bl[M],Aa.a.count(this.Bl)||this.zsa.y_k(Object(E.a)(this,this.r5g,"onMessageDialogEvent")),this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}r5g(M,N){N.controlId in this.Bl&&(M={},M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=N.messageType,M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=
N.messageContent,M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=N.MEe,M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=N.NLa,(N=this.Bl[N.controlId])&&N(M))}static get instance(){nb.Rp||(nb.Rp=new nb);return nb.Rp}}nb.Rp=null;Object(h.a)(nb,"DialogParentMessageReceivedEvent",Mc,[]);class lc extends Mc{constructor(){super()}Fta(){return{}}static get instance(){lc.Rp||(lc.Rp=new lc);return lc.Rp}}lc.Rp=null;Object(h.a)(lc,"DocumentSelectionChangedEvent",
Mc,[]);class jd extends Mc{constructor(){super()}Fta(){return null}raiseEvent(M,N){try{const Ia=this.Bl[N];Ia&&(N={},N[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=M,Ia(N))}catch(Ia){yd.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+Ia.message)}}static get instance(){jd.Rp||(jd.Rp=new jd);return jd.Rp}}jd.Rp=null;Object(h.a)(jd,"DocumentThemeChangedEvent",Mc,[]);class xd extends Mc{constructor(){super()}Fta(){return null}addHandler(M,N,Ia=null){this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(M,
N,Ia=null){this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){xd.Rp||(xd.Rp=new xd);return xd.Rp}}xd.Rp=null;Object(h.a)(xd,"OfficeThemeChangedEvent",Mc,[]);class Kc{constructor(){}}Object(h.a)(Kc,"RichApiEventManagerHost",null,[981]);class Zc extends Mc{constructor(){super();this.jKd=null}Fta(M){return M}addHandler(M,N,Ia=null,lb=null){this.Kd&&Ga.a(lb)?(this.jKd||(this.jKd=new Kc(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.jKd)),
this.Bl[M]=N,this.X6a(Ia)):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(M,N,Ia=null,lb=null){this.Kd&&Ga.a(lb)&&M in this.Bl?(delete this.Bl[M],this.X6a(Ia)):this.OA(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){return Zc.Ka||(Zc.Ka=new Zc)}}Zc.Ka=null;Object(h.a)(Zc,"RichApiMessageEvent",Mc,[]);class Sc extends Mc{constructor(){super()}Fta(M){return M}static get instance(){Sc.Rp||(Sc.Rp=new Sc);return Sc.Rp}}Sc.Rp=null;Object(h.a)(Sc,
"SettingsChangedEvent",Mc,[]);class ld extends mc{constructor(M,N){super(M,N)}dHk(){this.rCb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Sc.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,ba.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,nd.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,jd.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,xd.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,
lc.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Wa.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,nb.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new gb);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,Zc.instance)}}Object(h.a)(ld,"EditorEventStore",mc,[]);class Dg{constructor(M){this.Rfc=null;this.Yc=M}C4i(M){this.Rfc||this.uHk();if(!M||!this.Rfc[M])return null;if(M=this.Rfc[M]())M.Kd=this.Yc;return M}set(M,
N){this.Rfc[M]=N}}Object(h.a)(Dg,"ApiMethodFactory",null,[]);class De{constructor(M,N,Ia,lb){this.instanceId=M.toLowerCase();this.fileSize=N;this.K3d=lb;this.Zxh=Ia}}Object(h.a)(De,"DocumentCopy",null,[]);var gi=d(390),pk=d(262);class Kh extends gi.a{constructor(M,N,Ia,lb,Sb,Wc,td){super();this.sB=M.string;this.mB=N;this.dma=Ia;this.ffa=Sb;this.Khk=lb;this.Rbc=Wc;this.LVa=td;this.bZa=Object(E.a)(this,this.Yuk,"onGetDocumentCopyChunkFinished");this.onError=Object(E.a)(this,this.Xuk,"onGetDocumentCopyChunkError")}start(){this.Kqd=
!1;pk.a.U1f(this.sB,this.mB,this.dma,this.Khk,this.ffa,Object(E.a)(this,this.xda,"handleWebserviceResponse"),Object(E.a)(this,this.wda,"handleWebserviceError"))}Yuk(M){if(M.fSa){const N={};M=M.result;N.value=M.FileData;N.errorCode=M.ErrorCode;this.Rbc(this.mB,N)}else this.handleError(M)}Xuk(M){this.handleError(M)}handleError(M){this.LVa&&(M=M.error,this.LVa(this.mB,!!M&&2===M.type))}}Object(h.a)(Kh,"GetDocumentCopyChunkTask",gi.a,[]);class Yd extends gi.a{constructor(M,N,Ia,lb,Sb,Wc){super();this.sB=
M.string;this.mB=N;this.dma=Ia;this.ffa=lb;this.Rbc=Sb;this.LVa=Wc;this.bZa=Object(E.a)(this,this.$uk,"onGetDocumentCopyFinished");this.onError=Object(E.a)(this,this.Zuk,"onGetDocumentCopyError")}start(){this.Kqd=!1;pk.a.I9i(this.sB,this.mB,this.dma,Object(E.a)(this,this.xda,"handleWebserviceResponse"),Object(E.a)(this,this.wda,"handleWebserviceError"))}$uk(M){if(M.fSa){const N={};M=M.result;N.fileSize=M.FileSize;N.errorCode=M.ErrorCode;N.format=this.dma;N.sliceSize=this.ffa;this.Rbc(this.mB,N)}else this.handleError(M)}Zuk(M){this.handleError(M)}handleError(M){this.LVa&&
(M=M.error,this.LVa(this.mB,!!M&&2===M.type))}}Object(h.a)(Yd,"GetDocumentCopyTask",gi.a,[]);class Kk extends gi.a{constructor(M,N,Ia,lb,Sb,Wc,td){super();this.sB=M.string;this.mB=N;this.dma=Ia;this.Dbk=lb;this.Cbk=Sb;this.Rbc=Wc;this.LVa=td;this.bZa=Object(E.a)(this,this.hyk,"onReleaseDocumentCopyFinished");this.onError=Object(E.a)(this,this.gyk,"onReleaseDocumentCopyError")}start(){this.Kqd=!1;pk.a.Coc(this.sB,this.mB,this.dma,this.Dbk,this.Cbk,Object(E.a)(this,this.xda,"handleWebserviceResponse"),
Object(E.a)(this,this.wda,"handleWebserviceError"))}hyk(M){if(M.fSa){const N={};N.errorCode=M.result.ErrorCode;this.Rbc(this.mB,N)}else this.handleError(M)}gyk(M){this.handleError(M)}handleError(M){this.LVa&&(M=M.error,this.LVa(this.mB,!!M&&2===M.type))}}Object(h.a)(Kk,"ReleaseGetDocumentCopyTask",gi.a,[]);class zi{constructor(){this.Nbd=null}start(){this.Nbd.start()}static QEi(M,N,Ia,lb,Sb,Wc){const td=new zi;td.Nbd=new Yd(M,N,Ia,lb,Sb,Wc);return td}static PEi(M,N,Ia,lb,Sb,Wc,td){const wd=new zi;
wd.Nbd=new Kh(M,N,Ia,lb,Sb,Wc,td);return wd}static CLf(M,N,Ia,lb,Sb,Wc,td){const wd=new zi;wd.Nbd=new Kk(M,N,Ia,lb,Sb,Wc,td);return wd}}Object(h.a)(zi,"AppForOfficeTask",null,[]);class Vi{constructor(){this.Ure=1;this.lcf=new vb.a}get HDa(){return this.lcf}Toi(M,N,Ia,lb){const Sb=this.S4f();M=new De(M,N,Ia,lb);this.HDa.$(Sb.toString(),M);return Sb}Jig(M,N){for(let Ia of this.HDa){const lb=Ia.value;if(lb.instanceId===M.toLowerCase()&&lb.K3d===N)return!0}return!1}Y_f(M){return this.HDa.ga(M.toString())}QXk(M){this.HDa.remove(M.toString())}Coc(M,
N,Ia,lb){(lb&&this.RXk(N)||Ia&&this.JXk())&&zi.CLf(M,N,4,Ia,lb,()=>{},()=>{}).start()}JXk(){let M=!1;0<this.HDa.count&&(this.lcf=new vb.a,M=!0);return M}RXk(M){if(!M)return!1;const N=[];for(let Ia of this.HDa)Ia.value.instanceId===M.toLowerCase()&&N.push(Ia.key);for(M=0;M<N.length;M++)this.HDa.remove(N[M]);return 0<N.length}S4f(){return this.Ure++}}Object(h.a)(Vi,"GetDocumentCopyHelper",null,[873]);class hi{constructor(M,N){this.azg=N.length;this.ffa=M;this.Jhk=Math.ceil(this.azg/M);this.SBi(N)}SBi(M){for(let N=
0;N<this.Jhk;N++){const Ia=N*this.ffa;M.slice(Ia,Math.min(Ia+this.ffa,this.azg))}}}Object(h.a)(hi,"DocumentCopyCache",null,[]);class xa{constructor(){this.iAe=this.FAe=null;this.jAe=this.GAe=0}add(M,N,Ia,lb){4===N?(this.GAe=M,this.FAe=new hi(Ia,lb)):3===N&&(this.jAe=M,this.iAe=new hi(Ia,lb))}remove(M){this.GAe===M?(this.GAe=0,this.FAe=null):this.jAe===M&&(this.jAe=0,this.iAe=null)}contains(M){return 4===M&&!!this.FAe||3===M&&!!this.iAe}}Object(h.a)(xa,"PerAppCache",null,[]);class sb{get cache(){return sb.li}get L3d(){return sb.H9j}Jig(M,
N){return M in this.cache&&this.cache[M].contains(N)}U1f(){}Coc(M){if(M.toString()in this.L3d){const N=this.L3d[M.toString()];delete this.L3d[M.toString()];this.cache[N].remove(M)}}S4f(){return sb.Ure++}}sb.li={};sb.H9j={};sb.Ure=1;Object(h.a)(sb,"GetFileApiProxy",null,[1015]);class Jb{constructor(M,N,Ia){this.vh=0;this.controlId=this.yAa=this.uE=this.BBb=this.Yc=this.Bo=null;this.parameters=M;this.callback=N;this.Uci=Ia;new sb;this.lcb=new ya;this.zWa=new Vi}get IHc(){this.lcb||(this.lcb=new ya);
return this.lcb}get jda(){return this.zWa}get I6k(){this.uE||(this.uE=jc.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));return this.uE}get mBj(){return this.yAa||(this.yAa=jc.a.instance.Ja("Postmessage.IHostPostmessenger"))}get errorCode(){return this.vh}set errorCode(M){this.vh=M}get result(){return this.Bo}set result(M){this.Bo=M}get zu(){return this.BBb}get Kd(){return this.Yc}set Kd(M){(this.Yc=M)?(this.BBb=this.Yc.zu,this.zWa=this.Yc.jda):this.zWa=this.BBb=null}go(){this.Bo=
{};try{this.$q()}catch(M){this.N2j(M)}this.NH()}N2j(M){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;yd.a.J(18396573,802,10,"Error when executing API: {0}",M.toString())}NH(){this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&yd.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",this.vh);this.Bo[Qc.c_Error]=this.vh;this.callback(this.Bo)}b6d(){return this.controlId?this.Kd?this.Kd.z_.MW(this.controlId):null:null}I4i(){if(!this.controlId)return null;let M=null;
this.Kd&&(M=this.Kd.z_.MW(this.controlId));return M?0===M.Zw?this.Kd.vWf(M.shape.slideId,M.shape.id):1===M.Zw?this.Kd.JDa(M.Jo.id):null:null}wae(M){return M?this.Kd?this.Kd.wae(M):null:null}}Object(h.a)(Jb,"ApiMethod",null,[]);class uc extends Jb{constructor(){super()}$q(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[Q.a.Jci][Q.a.Ici],this.parameters);this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}
Object(h.a)(uc,"AppCommandInvocationCompletedMethod",Jb,[]);class Gd extends Jb{constructor(){super()}go(){this.Bo={};this.$q()}$q(){if(this.zu)try{const M=this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();M&&M.length>this.Kd.nRd.qd.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(r.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",M.length),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.NH()):this.zu.L7a(M,Object(E.a)(this,this.mEi,
"createDocumentSuccessCallback"),Object(E.a)(this,this.lEi,"createDocumentFailCallback"))}catch(M){yd.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+M.toString()),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.NH()}else this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.NH()}mEi(M){const N=new x.StandardDialog;N.yd=4;N.Gx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Ia=>{1===Ia&&window.open(M);this.vh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.NH()})}lEi(M){this.vh=M?M:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH()}get description(){return"Create a new ppt document in the user's default folder."}}Object(h.a)(Gd,"CreateDocumentMethod",Jb,[]);var ee=d(96),se=d(89);class $e{static OSk(M){const N=new Map;N.set("ApiId",M.toString());ee.Health.instance.recordKpiUsage($e.Unh,1,$e.Qnh,N)}static NSk(M,N,Ia){const lb=new Map;lb.set("ApiId",M.toString());M=Object.assign(new se.a,
{extendedProperties:lb,durationMs:$e.$1f(N,Ia)});ee.Health.instance.recordKpiSuccess($e.Unh,M)}static Kgh(M){const N=new Map;N.set("fWacPartition",M.toString());ee.Health.instance.recordKpiUsage($e.Vnh,1,$e.Qnh,N)}static sQe(M,N){M=Object.assign(new se.a,{durationMs:$e.$1f(M,N)});ee.Health.instance.recordKpiSuccess($e.Vnh,M)}static $1f(M,N){let Ia=null;M&&N&&(Ia=N-M);return Ia}}$e.Unh="PptApiCall";$e.Vnh="PptApiRequest";$e.Qnh="pptom";Object(h.a)($e,"PptWacApiTelemetry",null,[]);class gg{constructor(){this.ver=
0;this.exec=this.sel=null}}Object(h.a)(gg,"ApiRequest",null,[]);class Th{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(h.a)(Th,"SelectionData",null,[]);const Uh=(M,N)=>{var Ia=Object,lb=Ia.assign,Sb=new gg,Wc=Object,td=Wc.assign,wd=new Th,be=M.zu.Qe();const hb=[];if(be){hb.length=be.length;for(var hf=0;hf<be.length;hf++)hb[hf]=be[hf].Cb.toString()}be=M.zu.Xd();hf=[];if(be){hf.length=be.length;for(let Xf=0;Xf<be.length;Xf++)hf[Xf]=be[Xf].get_shapeId().toString()}M=lb.call(Ia,Sb,{ver:1,
exec:N,sel:td.call(Wc,wd,{sldLst:hb,shpLst:hf,txRn:M.zu.Ljj()})});return Sys.Serialization.JavaScriptSerializer.serialize(M)},Qj=M=>{let N,Ia;N=M.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Ia=N.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Ia.addParameter("address","String",1,null,0);Ia.addParameter("displayName","String",1,null,0);Ia=N.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",
1,0,"InsertSlideFromContent",4);Ia.addParameter("slideContent","String",1,null,0);N=M.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);N.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);N.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);N.addProperty("Tags",4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);N.addProperty("Title",1,"String",1,!0,null,0);N.addMethod("GetSelectedShapes",
5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);N.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);N.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);N.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRangeOrNullObject",0);Ia=N.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",
0);Ia.addParameter("base64File","String",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Ia=N.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Ia.addParameter("slideIds","String[]",1,null,0);Ia=N.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);Ia.addParameter("referenceId","String",1,null,0);Ia.addParameter("eventType","Int32",1,null,0);Ia=N.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);Ia.addParameter("referenceId",
"String",1,null,0);Ia.addParameter("eventType","Int32",1,null,0);N=M.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);N.addProperty("LayoutId",1,"String",1,!1,null,0);N.addProperty("SlideMasterId",2,"String",1,!1,null,0);N=M.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}","",3,0);N.addProperty("Visible",2,"Boolean",1,!1,null,0);N.addMethod("_OnAccess",1,"Void",0,
1,"_OnAccess",0);N=M.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");N.addEnumField("Straight",0);N.addEnumField("Elbow",1);N.addEnumField("Curve",2);N=M.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");N.addEnumField("LineInverse",0);N.addEnumField("Triangle",1);N.addEnumField("RightTriangle",2);N.addEnumField("Rectangle",3);N.addEnumField("Diamond",4);N.addEnumField("Parallelogram",5);N.addEnumField("Trapezoid",6);N.addEnumField("NonIsoscelesTrapezoid",7);N.addEnumField("Pentagon",
8);N.addEnumField("Hexagon",9);N.addEnumField("Heptagon",10);N.addEnumField("Octagon",11);N.addEnumField("Decagon",12);N.addEnumField("Dodecagon",13);N.addEnumField("Star4",14);N.addEnumField("Star5",15);N.addEnumField("Star6",16);N.addEnumField("Star7",17);N.addEnumField("Star8",18);N.addEnumField("Star10",19);N.addEnumField("Star12",20);N.addEnumField("Star16",21);N.addEnumField("Star24",22);N.addEnumField("Star32",23);N.addEnumField("RoundRectangle",24);N.addEnumField("Round1Rectangle",25);N.addEnumField("Round2SameRectangle",
26);N.addEnumField("Round2DiagonalRectangle",27);N.addEnumField("SnipRoundRectangle",28);N.addEnumField("Snip1Rectangle",29);N.addEnumField("Snip2SameRectangle",30);N.addEnumField("Snip2DiagonalRectangle",31);N.addEnumField("Plaque",32);N.addEnumField("Ellipse",33);N.addEnumField("Teardrop",34);N.addEnumField("HomePlate",35);N.addEnumField("Chevron",36);N.addEnumField("PieWedge",37);N.addEnumField("Pie",38);N.addEnumField("BlockArc",39);N.addEnumField("Donut",40);N.addEnumField("NoSmoking",41);N.addEnumField("RightArrow",
42);N.addEnumField("LeftArrow",43);N.addEnumField("UpArrow",44);N.addEnumField("DownArrow",45);N.addEnumField("StripedRightArrow",46);N.addEnumField("NotchedRightArrow",47);N.addEnumField("BentUpArrow",48);N.addEnumField("LeftRightArrow",49);N.addEnumField("UpDownArrow",50);N.addEnumField("LeftUpArrow",51);N.addEnumField("LeftRightUpArrow",52);N.addEnumField("QuadArrow",53);N.addEnumField("LeftArrowCallout",54);N.addEnumField("RightArrowCallout",55);N.addEnumField("UpArrowCallout",56);N.addEnumField("DownArrowCallout",
57);N.addEnumField("LeftRightArrowCallout",58);N.addEnumField("UpDownArrowCallout",59);N.addEnumField("QuadArrowCallout",60);N.addEnumField("BentArrow",61);N.addEnumField("UturnArrow",62);N.addEnumField("CircularArrow",63);N.addEnumField("LeftCircularArrow",64);N.addEnumField("LeftRightCircularArrow",65);N.addEnumField("CurvedRightArrow",66);N.addEnumField("CurvedLeftArrow",67);N.addEnumField("CurvedUpArrow",68);N.addEnumField("CurvedDownArrow",69);N.addEnumField("SwooshArrow",70);N.addEnumField("Cube",
71);N.addEnumField("Can",72);N.addEnumField("LightningBolt",73);N.addEnumField("Heart",74);N.addEnumField("Sun",75);N.addEnumField("Moon",76);N.addEnumField("SmileyFace",77);N.addEnumField("IrregularSeal1",78);N.addEnumField("IrregularSeal2",79);N.addEnumField("FoldedCorner",80);N.addEnumField("Bevel",81);N.addEnumField("Frame",82);N.addEnumField("HalfFrame",83);N.addEnumField("Corner",84);N.addEnumField("DiagonalStripe",85);N.addEnumField("Chord",86);N.addEnumField("Arc",87);N.addEnumField("LeftBracket",
88);N.addEnumField("RightBracket",89);N.addEnumField("LeftBrace",90);N.addEnumField("RightBrace",91);N.addEnumField("BracketPair",92);N.addEnumField("BracePair",93);N.addEnumField("Callout1",94);N.addEnumField("Callout2",95);N.addEnumField("Callout3",96);N.addEnumField("AccentCallout1",97);N.addEnumField("AccentCallout2",98);N.addEnumField("AccentCallout3",99);N.addEnumField("BorderCallout1",100);N.addEnumField("BorderCallout2",101);N.addEnumField("BorderCallout3",102);N.addEnumField("AccentBorderCallout1",
103);N.addEnumField("AccentBorderCallout2",104);N.addEnumField("AccentBorderCallout3",105);N.addEnumField("WedgeRectCallout",106);N.addEnumField("WedgeRRectCallout",107);N.addEnumField("WedgeEllipseCallout",108);N.addEnumField("CloudCallout",109);N.addEnumField("Cloud",110);N.addEnumField("Ribbon",111);N.addEnumField("Ribbon2",112);N.addEnumField("EllipseRibbon",113);N.addEnumField("EllipseRibbon2",114);N.addEnumField("LeftRightRibbon",115);N.addEnumField("VerticalScroll",116);N.addEnumField("HorizontalScroll",
117);N.addEnumField("Wave",118);N.addEnumField("DoubleWave",119);N.addEnumField("Plus",120);N.addEnumField("FlowChartProcess",121);N.addEnumField("FlowChartDecision",122);N.addEnumField("FlowChartInputOutput",123);N.addEnumField("FlowChartPredefinedProcess",124);N.addEnumField("FlowChartInternalStorage",125);N.addEnumField("FlowChartDocument",126);N.addEnumField("FlowChartMultidocument",127);N.addEnumField("FlowChartTerminator",128);N.addEnumField("FlowChartPreparation",129);N.addEnumField("FlowChartManualInput",
130);N.addEnumField("FlowChartManualOperation",131);N.addEnumField("FlowChartConnector",132);N.addEnumField("FlowChartPunchedCard",133);N.addEnumField("FlowChartPunchedTape",134);N.addEnumField("FlowChartSummingJunction",135);N.addEnumField("FlowChartOr",136);N.addEnumField("FlowChartCollate",137);N.addEnumField("FlowChartSort",138);N.addEnumField("FlowChartExtract",139);N.addEnumField("FlowChartMerge",140);N.addEnumField("FlowChartOfflineStorage",141);N.addEnumField("FlowChartOnlineStorage",142);
N.addEnumField("FlowChartMagneticTape",143);N.addEnumField("FlowChartMagneticDisk",144);N.addEnumField("FlowChartMagneticDrum",145);N.addEnumField("FlowChartDisplay",146);N.addEnumField("FlowChartDelay",147);N.addEnumField("FlowChartAlternateProcess",148);N.addEnumField("FlowChartOffpageConnector",149);N.addEnumField("ActionButtonBlank",150);N.addEnumField("ActionButtonHome",151);N.addEnumField("ActionButtonHelp",152);N.addEnumField("ActionButtonInformation",153);N.addEnumField("ActionButtonForwardNext",
154);N.addEnumField("ActionButtonBackPrevious",155);N.addEnumField("ActionButtonEnd",156);N.addEnumField("ActionButtonBeginning",157);N.addEnumField("ActionButtonReturn",158);N.addEnumField("ActionButtonDocument",159);N.addEnumField("ActionButtonSound",160);N.addEnumField("ActionButtonMovie",161);N.addEnumField("Gear6",162);N.addEnumField("Gear9",163);N.addEnumField("Funnel",164);N.addEnumField("MathPlus",165);N.addEnumField("MathMinus",166);N.addEnumField("MathMultiply",167);N.addEnumField("MathDivide",
168);N.addEnumField("MathEqual",169);N.addEnumField("MathNotEqual",170);N.addEnumField("CornerTabs",171);N.addEnumField("SquareTabs",172);N.addEnumField("PlaqueTabs",173);N.addEnumField("ChartX",174);N.addEnumField("ChartStar",175);N.addEnumField("ChartPlus",176);N=M.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");N.addEnumField("KeepSourceFormatting",0);N.addEnumField("UseDestinationTheme",1);N=M.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}",
"{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);N.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);N.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);N.addProperty("TargetSlideId",5,"String",1,!1,null,0);N=M.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");N.addEnumField("Left",0);N.addEnumField("Center",1);N.addEnumField("Right",2);N.addEnumField("Justify",3);N.addEnumField("JustifyLow",4);N.addEnumField("Distributed",5);N.addEnumField("ThaiDistributed",
6);N=M.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);N.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,null,0);N.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);N.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,
0);N.addProperty("Height",1,"Double",1,!1,null,0);N.addProperty("Left",2,"Double",1,!1,null,0);N.addProperty("Top",3,"Double",1,!1,null,0);N.addProperty("Width",4,"Double",1,!1,null,0);N=M.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Ia=N.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Ia.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Ia.addParameter("options",
"Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ia=N.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Ia.addParameter("connectorType","Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ia=N.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Ia.addParameter("text","String",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",
2,null,0);N.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ia.addParameter("key","String",1,null,0);Ia=N.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=N.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);N.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",
!0);N=M.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);N.addProperty("Id",1,"String",1,!0,null,0);N.addProperty("Name",3,"String",1,!0,null,0);N.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);N.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);N.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.SlideLayout",3,0);Ia.addParameter("key","String",1,null,0);Ia=N.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=N.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);N.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);N=M.addType("Microsoft.Office.PowerPoint.SlideMaster",
"{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);N.addProperty("Id",1,"String",1,!0,null,0);N.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);N.addProperty("Name",4,"String",1,!0,null,0);N.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);N.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);N.addProperty("Key",2,"String",1,!0,null,0);
N.addProperty("Value",3,"String",1,!1,null,0);N.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);Ia=N.addMethod("Add",1,"Void",0,0,"Add",0);Ia.addParameter("key","String",1,null,0);Ia.addParameter("value","String",1,null,0);Ia=N.addMethod("Delete",2,"Void",0,0,"Delete",0);Ia.addParameter("key","String",1,null,0);N.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",
3,0);Ia.addParameter("key","String",1,null,0);Ia=N.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=N.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Ia.addParameter("key","String",1,null,0);N.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);N=M.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}",
"",3,0);N.addProperty("Id",1,"String",1,!0,null,0);N.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);N.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);N.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);N.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);N.addMethod("Delete",3,"Void",0,0,"Delete",0);Ia=N.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Ia.addParameter("shapeIds",
"String[]",1,null,0);N.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);N=M.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");N.addEnumField("NoFill",0);N.addEnumField("Solid",1);N.addEnumField("Gradient",2);N.addEnumField("Pattern",3);N.addEnumField("PictureAndTexture",4);N.addEnumField("SlideBackground",5);N=M.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);N.addProperty("ForegroundColor",2,"String",1,!1,null,0);N.addProperty("Transparency",
5,"Double",1,!1,null,0);N.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);N.addMethod("Clear",1,"Void",0,0,"Clear",0);Ia=N.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);Ia.addParameter("color","String",1,null,0);N.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);N=M.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");N.addEnumField("Single",0);N.addEnumField("ThickBetweenThin",1);N.addEnumField("ThickThin",2);N.addEnumField("ThinThick",3);N.addEnumField("ThinThin",
4);N=M.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");N.addEnumField("Dash",0);N.addEnumField("DashDot",1);N.addEnumField("DashDotDot",2);N.addEnumField("LongDash",3);N.addEnumField("LongDashDot",4);N.addEnumField("RoundDot",5);N.addEnumField("Solid",6);N.addEnumField("SquareDot",7);N.addEnumField("LongDashDotDot",8);N.addEnumField("SystemDash",9);N.addEnumField("SystemDot",10);N.addEnumField("SystemDashDot",11);N=M.addType("Microsoft.Office.PowerPoint.ShapeLineFormat","{f275eab8-4363-41e8-b11a-e41e3c725f21}",
"",3,0);N.addProperty("Color",1,"String",1,!1,null,0);N.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);N.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);N.addProperty("Transparency",5,"Double",1,!1,null,0);N.addProperty("Visible",6,"Boolean",1,!1,null,0);N.addProperty("Weight",7,"Double",1,!1,null,0);N.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);N=M.addEnumType("Microsoft.Office.PowerPoint.ShapeType");N.addEnumField("Unsupported",
0);N.addEnumField("Image",1);N.addEnumField("GeometricShape",2);N.addEnumField("Group",3);N.addEnumField("Line",4);N=M.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");N.addEnumField("AutoSizeNone",0);N.addEnumField("AutoSizeTextToFitShape",1);N.addEnumField("AutoSizeShapeToFitText",2);N.addEnumField("AutoSizeMixed",3);N=M.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");N.addEnumField("Top",0);N.addEnumField("Middle",1);N.addEnumField("Bottom",2);N.addEnumField("TopCentered",
3);N.addEnumField("MiddleCentered",4);N.addEnumField("BottomCentered",5);N=M.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");N.addEnumField("None",0);N.addEnumField("Single",1);N.addEnumField("Double",2);N.addEnumField("Heavy",3);N.addEnumField("Dotted",4);N.addEnumField("DottedHeavy",5);N.addEnumField("Dash",6);N.addEnumField("DashHeavy",7);N.addEnumField("DashLong",8);N.addEnumField("DashLongHeavy",9);N.addEnumField("DotDash",10);N.addEnumField("DotDashHeavy",11);N.addEnumField("DotDotDash",
12);N.addEnumField("DotDotDashHeavy",13);N.addEnumField("Wavy",14);N.addEnumField("WavyHeavy",15);N.addEnumField("WavyDouble",16);N=M.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);N.addProperty("Bold",1,"Boolean",1,!1,null,0);N.addProperty("Color",2,"String",1,!1,null,0);N.addProperty("Italic",3,"Boolean",1,!1,null,0);N.addProperty("Name",5,"String",1,!1,null,0);N.addProperty("Size",6,"Double",1,!1,null,0);N.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",
1,!1,null,0);N.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);N.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);N.addProperty("Length",7,"Int32",1,!1,null,0);N.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);N.addProperty("Start",9,"Int32",1,!1,null,0);N.addProperty("Text",5,"String",1,!1,null,0);N.addMethod("GetParentTextFrame",
10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Ia=N.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);Ia.addParameter("start","Int32",1,null,0);Ia.addParameter("length","Int32",1,null,0);N.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);N.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.TextFrame","{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);N.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",
1,!1,null,0);N.addProperty("BottomMargin",2,"Double",1,!1,null,0);N.addProperty("HasText",4,"Boolean",1,!0,null,0);N.addProperty("LeftMargin",6,"Double",1,!1,null,0);N.addProperty("RightMargin",7,"Double",1,!1,null,0);N.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);N.addProperty("TopMargin",9,"Double",1,!1,null,0);N.addProperty("VerticalAlignment",10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);N.addProperty("WordWrap",11,"Boolean",1,!1,null,0);
N.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);N.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);N.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);N.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);N.addProperty("Height",5,"Double",1,!1,null,0);N.addProperty("Id",1,"String",1,!0,null,0);N.addProperty("Left",6,"Double",1,!1,null,
0);N.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);N.addProperty("Name",7,"String",1,!1,null,0);N.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);N.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);N.addProperty("Top",8,"Double",1,!1,null,0);N.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",1,!0,null,0);N.addProperty("Width",10,"Double",1,!1,null,0);N.addMethod("Delete",4,"Void",0,0,"Delete",
0);N.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);N.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",0);N.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);N.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMaster",0);N.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",
3,0,"ParentSlideMasterOrNullObject",0);N.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);N.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);N.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ia.addParameter("key","String",1,null,0);Ia=N.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",
3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=N.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);N.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);N=M.addType("Microsoft.Office.PowerPoint.SlideCollection","{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Ia=N.addMethod("Add",6,"Void",0,0,"Add",0);Ia.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",
2,null,0);N.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);Ia.addParameter("key","String",1,null,0);Ia=N.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=N.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);N.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",
!0);N=M.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);N.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Ia.addParameter("key","String",1,null,0);Ia=N.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=N.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ia.addParameter("id",
"String",1,null,0);N.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);N=M.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);N.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideMaster",3,0);Ia.addParameter("key","String",1,null,0);Ia=N.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);Ia.addParameter("index",
"Int32",1,null,0);Ia=N.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);N.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);N=M.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);N.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,
"AppRuntimeState",0);Ia=N.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ia.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);N=M.addEnumType("Microsoft.AppRuntime.AppRuntimeState");N.addEnumField("Inactive",0);N.addEnumField("Background",1);N.addEnumField("Visible",2);N=M.addEnumType("Microsoft.AppRuntime.Visibility");N.addEnumField("Hidden",1);N.addEnumField("Visible",2);N=M.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}",
"{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);N.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);Ia=N.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Ia.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);N=M.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");N.addEnumField("Unknown",0);N.addEnumField("Basic",1);N.addEnumField("Premium",2);N=M.addType("Microsoft.Office.Licensing.License",
"{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Ia=N.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ia.addParameter("feature","String",1,null,0);Ia.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ia=N.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ia.addParameter("feature","String",1,null,0);Ia=N.addMethod("GetMsaDeviceTicket",
7,"String",1,1,"MsaDeviceTicket",4);Ia.addParameter("resource","String",1,null,0);Ia.addParameter("policy","String",1,null,0);Ia.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);Ia=N.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ia.addParameter("feature","String",1,null,0);Ia.addParameter("fallbackValue","Boolean",1,null,0);N.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ia=N.addMethod("LaunchUpsellExperience",
4,"Void",0,1,"LaunchUpsellExperience",0);Ia.addParameter("experienceId","String",1,null,0);Ia=N.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Ia.addParameter("feature","String",1,null,0);N=M.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);N.addProperty("Id",5,"String",1,!0,null,0);N.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);N.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",
0);N=M.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);N.addProperty("Scopes",1,"String",1,!1,null,0);N=M.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);N.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ia=N.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",
0);Ia.addParameter("jsonCreate","String",1,null,0);Ia=N.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ia.addParameter("jsonUpdate","String",1,null,0);Ia=N.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ia.addParameter("id","String",1,null,0);Ia=N.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ia.addParameter("id","String",1,null,0);N.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.DynamicRibbon.RibbonTab",
"{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);N.addProperty("Id",2,"String",1,!0,null,0);Ia=N.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Ia.addParameter("visibility","Boolean",1,null,0);N.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);N.addProperty("Enabled",3,"Boolean",1,!1,null,0);N.addProperty("Id",2,"String",1,!0,null,0);N.addProperty("Label",4,"String",1,!0,null,0);Ia=N.addMethod("SetEnabled",
5,"Void",0,0,"SetEnabled",0);Ia.addParameter("enabled","Boolean",1,null,0);N.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);N=M.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);N.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ia=N.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ia.addParameter("key","String",1,null,0);N.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);N.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",
!0)};var Xd=d(43);class Wf{constructor(M,N){this.thc=M;this.Wgc=N}HKf(M){return[200,null,M]}gVi(M,N,Ia,lb,Sb,Wc){const td=Xd.a.cZ(),wd=this.thc.create(N,Ia,lb);lb.tsf=wd;const be=this.Wgc.create(Wc);be.context.appId=N;be.context.controlId=Ia;const hb=()=>{$e.Kgh(!0);wd.IMe=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(wd,Qj,be,M).then(Xf=>{if(!Xf)return r.ULS.sendTraceTag(587745500,802,10,"ExecuteRichApiRequest failed."),Sb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),
null;$e.sQe(td,Xd.a.cZ());Sb(Xf,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},Xf=>{r.ULS.sendTraceTag(587745499,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",N,Xf);Sb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},hf=()=>{$e.Kgh(!1);let Xf=M[4];Qe.a("ExtensibilityUseSerializedPayloads")&&(Xf=Uh(lb,Xf));OfficeExtension.WacRuntime.Utility.createPromise(Bg=>{const ji={};ji.promiseToResolve=Bg;ji.requestBody=Xf;B.AFrameworkApplication.Ta.La(yi.a.I2d,
2,ji)}).then(Bg=>{Qe.a("ExtensibilityResetResponse")&&B.AFrameworkApplication.Ta.La(yi.a.I2d,2,{promiseToResolve:null,requestBody:""});if(Qe.a("ExtensibilityUseSerializedPayloads")){a:if((Bg=Sys.Serialization.JavaScriptSerializer.deserialize(Bg.toString()))&&Bg.sel&&Bg.sel.sldLst){var ji=Wc.presentation,pi=Bg.sel.sldLst,Oe=[];if(pi)for(Ri of pi)({slideId:pi}=Xc.a.QEh(Ri)).returnValue&&(pi=Object(ea.a)(116,ji.AC(pi)))&&Oe.push(pi);var Ri=Oe;if(Ri.length&&!lb.zu.KBl(Ri))Bg=null;else{Ri=1===Ri.length?
Ri[0]:null;ji=null;if(Ri&&Bg.sel.shpLst){Oe=Bg.sel.shpLst;ji=[];if(Oe)for(Rj of Oe)(Oe=Ri.lT(parseInt(Rj)))&&ji.push(Oe);var Rj=ji;if(Rj.length&&!lb.zu.JBl(Rj)){Bg=null;break a}ji=1===Rj.length?Rj[0]:null}Bg=ji&&Bg.sel.txRn&&(Bg.sel.txRn.length&&2!==Bg.sel.txRn.length||2===Bg.sel.txRn.length&&0<=Bg.sel.txRn[0]&&!lb.zu.LBl(ji,Bg.sel.txRn[0],Bg.sel.txRn[1]))?null:Bg.rst}}else Bg=null;Bg?($e.sQe(td,Xd.a.cZ()),Sb(this.HKf(Bg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Sb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else $e.sQe(td,
Xd.a.cZ()),Sb(this.HKf(Bg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Sb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};M?(wd.IMe=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(wd,Qj,be,M).then(Xf=>{Xf&&wd.nyg?hb():hf();return null},()=>{hf();return null})):hb()}}Object(h.a)(Wf,"RichApiRequest",null,[]);class yk extends Jb{constructor(M,N,Ia){super();this.thc=M;this.Wgc=N;this.ua=Ia}go(){this.Bo={};this.$q()}$q(){const M=this.parameters.ArrayData;
if(M){var N=null,Ia=this.b6d();Qe.a("SetOwnerAddinAssetIdForSharedRuntimeAPIsInPptWac")?Ia&&Ia.taskpane&&(N=Ia.taskpane.ownerAddinSolutionId):Ia&&(N=Ia.Jo.id);try{(new Wf(this.thc,this.Wgc)).gVi(M,N,this.controlId,this.Kd,Object(E.a)(this,this.hVi,"executeRichApiRequestCallback"),this.ua)}catch(lb){yd.a.J(36804577,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+lb.toString()),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.NH()}}else this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
this.NH()}hVi(M,N){this.errorCode=N;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.Bo.Data=M);this.NH()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(h.a)(yk,"ExecuteRichApiRequestMethod",Jb,[]);class ak extends Jb{constructor(){super()}go(){this.Bo={};this.$q()}$q(){const M=this.BBb.DKj();r.ULS.sendTraceTag(587747344,802,50,"GetAccessToken was called!");const N=(Ia,lb)=>{Ia===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(lb=lb.accessToken,this.Bo[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=
lb):(lb=this.Kd.z_.MW(this.controlId),r.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:Ia.toString(),["appId"]:lb.Jo.id,["storeType"]:lb.Jo.storeType}));this.vh=Ia;this.NH()};this.mBj.execute(Ia=>{const lb=this.Kd.vl,Sb=Cd.getInstance();Jf.AppsForOfficeSingleSignOnManager.getInstance(lb,Ia,Sb).getAccessToken(this.controlId,M,this.parameters,N)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(h.a)(ak,"GetAccessTokenMethod",Jb,[]);class Im extends Jb{constructor(){super()}$q(){let M=
null;this.zu&&(M=Microsoft.Office.WebExtension.ActiveView.Edit);M?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=M,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}Object(h.a)(Im,"GetActiveViewMethod",Jb,[]);var ml=d(980);class Lk extends Jb{constructor(){super()}go(){this.Bo={};this.$q()}$q(){var M=this.Yc.vl.getOsfControl(this.controlId);if(!B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",
!1)||M.isFirstParty()){M=M.getManifest();var N=M.getMarketplaceID(),Ia=M.getWebApplicationId(),lb=M.getWebApplicationMsaId();jc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(N).then(Sb=>{this.errorCode=0;const Wc={};Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Sb.upn;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Sb.userId;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Ia;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=
lb?lb:Ia;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Sb.authority;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=ml.a.A_f(Sb.authorityType);Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Sb.isAnonymous;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Sb.tenantId;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Sb.supportsAuthToken;this.Bo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Wc;this.NH()},Sb=>{this.vh=1;this.Bo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Sb;this.NH()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(h.a)(Lk,"GetAuthContextMethod",Jb,[]);class Jm extends Jb{constructor(){super()}go(){this.Bo={};this.$q();this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.NH()}$q(){var M=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const N=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];
M=this.jda.Y_f(M);!M||N*M.Zxh>=M.fileSize?this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:(zi.PEi(this.Kd.presentationId,this.controlId,M.K3d,N,M.Zxh,Object(E.a)(this,this.l2b,"customizedOnFinished"),Object(E.a)(this,this.k2b,"customizedOnError")).start(),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}l2b(M,N){M?0===N.errorCode?(M=N.value,this.Bo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=M,this.Bo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=
M.length,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH()}k2b(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH()}get description(){return"Returns the specified slice."}}Object(h.a)(Jm,"GetDocumentCopyChunkMethod",Jb,[]);class Mk extends Jb{constructor(){super();this.ffa=this.dma=0}go(){this.Bo={};this.$q();this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
this.NH()}$q(){try{const M=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];this.ffa=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.ffa||4194304<this.ffa)yd.a.J(17310339,802,50,"GetDocumentCopyMethod: Invalid slice size: "+this.ffa),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(M){case 1:this.dma=4;break;case 2:this.dma=3;break;default:yd.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+
M);this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.jda.Jig(this.controlId,this.dma)?this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.jda.HDa.count>=this.Kd.nRd.qd.pptEditorAppForOfficeMaxDocumentReaders?this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.I6k.C3(!1,!0,()=>{this.T6k()},Object(E.a)(this,this.jya,"saveFailureCallback")),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(M){yd.a.J(17310343,802,10,
"Exception thrown at GetDocumentCopyMethod: "+M.toString()),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}T6k(){zi.QEi(this.Kd.presentationId,this.controlId,this.dma,this.ffa,Object(E.a)(this,this.l2b,"customizedOnFinished"),Object(E.a)(this,this.k2b,"customizedOnError")).start()}jya(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH();return!1}l2b(M,N){if(M&&M.length){M=N.format;var Ia=N.sliceSize,lb=N.errorCode;0===lb?(N=N.fileSize,this.Bo[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=
N,N=this.jda.Toi(this.controlId,N,Ia,M),this.Bo[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=N,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=174===lb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:175===lb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH()}k2b(M,N){this.vh=N?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH()}get description(){return"Returns the entire document file in slices."}}Object(h.a)(Mk,"GetDocumentCopyMethod",Jb,[]);class vh extends Jb{constructor(){super()}$q(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const M=this.I4i(),N=this.zu.L9i(M);N&&(this.Bo[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=N,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(M){yd.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+
M)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(h.a)(vh,"GetDocumentThemeMethod",Jb,[]);class Ij extends Jb{constructor(){super()}$q(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let M=null;if(this.zu&&void 0!==(M=this.zu.Nwb())&&null!==(M=this.zu.Nwb())){var N={};N[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=M;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=N;this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}
Object(h.a)(Ij,"GetFilePropertiesMethod",Jb,[]);class nj extends Jb{constructor(){super()}$q(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(h.a)(nj,"GetOfficeThemeMethod",Jb,[]);class am extends Jb{constructor(){super()}$q(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.zu)try{var M=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();M===Microsoft.Office.WebExtension.CoercionType.SlideRange?
(M=null,this.vh=({O8k:M}=this.zu.Djj()).returnValue,this.Bo[OSF.DDA.WAC.UniqueArguments.Data]=M):M===Microsoft.Office.WebExtension.CoercionType.Text?(M=null,this.vh=({aqc:M}=this.zu.Hjj()).returnValue,this.Bo[OSF.DDA.WAC.UniqueArguments.Data]=M):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(N){yd.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+N.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(h.a)(am,
"GetSelectedDataMethod",Jb,[]);class pn extends Jb{constructor(){super()}$q(){var M=this.b6d();if(M){const N={};N.Settings=this.p5d(M.settings);this.Bo[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=N;this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else M="AppForOffice instance could not be found for ID "+this.controlId+ic.Debug.Vt(),yd.a.J(8958160,802,10,M),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}p5d(M){const N=
{};let Ia=0;for(let lb in M)N[Ia.toString()]=[lb,M[lb]],Ia++;return N}}Object(h.a)(pn,"LoadSettingsMethod",Jb,[]);class lm extends Jb{constructor(){super()}$q(){r.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.BBb.Pka()?(this.vh=Wa.instance.zsa.wnk(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[Q.a.yQd],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
r.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",this.vh.toString())):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(h.a)(lm,"MessageParentMethod",Jb,[]);class Km extends Jb{constructor(){super()}$q(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.zu)try{const M=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],N=M[OSF.DDA.Marshaling.NavigationKeys.GoToType],
Ia=M[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.vh=N===OSF.DDA.Marshaling.GoToType.Index?this.zu.Hqj(Ia):N===OSF.DDA.Marshaling.GoToType.Slide?this.zu.Iqj(Ia):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(M){yd.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+M.toString())}}get description(){return"Go to the slide specified by user."}}Object(h.a)(Km,"NavigateToMethod",Jb,[]);class mm extends Jb{constructor(){super();this.wve=0}go(){this.Bo={};this.$q();
this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.NH()}$q(){this.wve=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const M=this.jda.Y_f(this.wve);M?(zi.CLf(this.Kd.presentationId,this.controlId,M.K3d,!1,!1,Object(E.a)(this,this.l2b,"customizedOnFinished"),Object(E.a)(this,this.k2b,"customizedOnError")).start(),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}l2b(M,N){M?0===N.errorCode?
(this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.jda.QXk(this.wve)):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH()}k2b(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.NH()}get description(){return"Closes the document file."}}Object(h.a)(mm,"ReleaseDocumentCopyMethod",Jb,[]);class $k extends Jb{constructor(){super();this.lIa=null}$q(){var M=this.b6d();if(M){var N=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];
this.lIa=this.p5d(Array.isArray(N[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?N[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);N=null;M.taskpane&&(N=M.taskpane.ownerAddinSolutionId);var Ia;if(M.taskpane&&N)if(Ia=this.Kd.JDa(N)){this.zu.pUe(Ia,this.lIa);if(Ia=this.Kd.z_.a6d(N))Ia.settings=this.lIa;M.settings=this.lIa;this.Kd.V5e(N,this.lIa);this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.IHc.Oag(N,this.lIa,this.Yc)?(M.settings=this.lIa,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else(Ia=0===M.Zw?this.Kd.vWf(M.shape.slideId,M.shape.id):this.Kd.JDa(M.Jo.id))?(this.zu.pUe(Ia,this.lIa),M.settings=this.lIa,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else M="AppForOffice instance could not be found for ID "+this.controlId+ic.Debug.Vt(),yd.a.J(9052994,802,10,M),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}p5d(M){const N=
{};if(M)for(let Ia=0;Ia<M.length;Ia++){const lb=Array.isArray(M[Ia])?M[Ia]:null;lb&&1<lb.length&&(N[lb[0]]=lb[1])}return N}}Object(h.a)($k,"SaveSettingsMethod",Jb,[]);class nl extends Jb{constructor(){super()}$q(){this.BBb.Pka()?(Wa.instance.zsa.y9k(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[Q.a.yQd],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(h.a)(nl,"SendMessageMethod",Jb,[]);class Af extends Jb{constructor(){super()}$q(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.zu)try{const N=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var M=N.CoerceType.toString();const Ia=N[OSF.DDA.WAC.UniqueArguments.Data];if(M===Microsoft.Office.WebExtension.CoercionType.Text)this.vh=this.zu.Sel(Ia);else{let lb;if(M===Microsoft.Office.WebExtension.CoercionType.Image)lb=0;else if(M===Microsoft.Office.WebExtension.CoercionType.XmlSvg)lb=
1;else{this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}M=!1;let Sb=0,Wc=0,td=0,wd=0;({Gzj:M,x:Sb,y:Wc,width:td,height:wd}=this.ZVi(N,M,Sb,Wc,td,wd));this.vh=this.zu.Nel(Ia,M,Sb,Wc,td,wd,lb)}}catch(N){yd.a.J(17310337,802,10,"Exception thrown at SetSelectedDataMethod: "+N)}}ZVi(M,N,Ia,lb,Sb,Wc){const td=M[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],wd=M[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==td&&null!==td&&"number"===typeof td&&void 0!==wd&&null!==wd&&"number"===
typeof wd&&(N=!0,Ia=td,lb=wd);M[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Sb=M[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);M[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(Wc=M[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{Gzj:N,x:Ia,y:lb,width:Sb,height:Wc}}get description(){return"Writes data to the current selection in the document."}}Object(h.a)(Af,"SetSelectedDataMethod",Jb,[]);class yl extends Dg{constructor(M){super(M)}uHk(){this.Rfc={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new pn);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new $k);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new Im);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new Km);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new am);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new Ij);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new vh);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new nj);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new Af);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Mk);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new Jm);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new mm);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new uc);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new lm);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new nl);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new ak);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Lk);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new Gd);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new yk(this.Yc.g5k,this.Yc.AKk,this.Yc.s_))}}Object(h.a)(yl,"EditorMethodFactory",Dg,[]);class oj extends Sys.EventArgs{constructor(M){super();this.qUh=M}get instanceId(){return this.qUh}}Object(h.a)(oj,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class zl{constructor(){this.QWa=
{};this.Gwe={};this.F$c={};this.I6c={}}Esf(M,N){N&&M&&(this.QWa[M]=N,this.I6c[M]=!1)}k6h(M,N){M&&N&&(this.F$c[M]=N)}MXk(M){if(M){var N=this.QWa[M];N&&(delete this.F$c[N.Jo.id],delete this.QWa[M],delete this.Gwe[M],delete this.I6c[M])}}MW(M){return M?this.QWa[M]:null}ecj(M){return M?this.I6c[M]:!1}vlj(M){return M?this.Gwe[M]:null}UHh(M,N){M&&(this.I6c[M]=N)}vHl(M,N){M&&(this.Gwe[M]=N)}a6d(M){if(!M)return null;const N=this.QWa;for(let Ia in N){const lb=N[Ia];if(lb&&lb.Jo.id.toLowerCase()===M.toLowerCase())return lb}return null}E4i(M,
N,Ia){if(!M||!N||!Ia)return null;const lb=this.QWa;for(let Sb in lb){const Wc=lb[Sb];if(Wc&&Wc.taskpane&&Wc.taskpane.ownerAddinSolutionId&&Wc.taskpane.ownerAddinSolutionId.toLowerCase()===M.toLowerCase()){const td=Ia.getOsfControl(Wc.instanceId);if(td&&td.getSharedRuntimeId()===N)return Wc}}return null}b5d(M){Aa.a.forEach(this.QWa,(N,Ia)=>{N=Object(ea.a)(881,Ia);1===N.Zw&&M(N)},null)}sYi(M){const N=this.QWa;for(let Ia in N){const lb=Object(ea.a)(881,N[Ia]);if(lb&&M(lb))return lb}return null}uWf(M){return M in
this.F$c?this.F$c[M]:null}}Object(h.a)(zl,"OsfAppInstacneCache",null,[]);class Bm{constructor(){}}Object(h.a)(Bm,"AppForOfficeSDXDialog",null,[902]);class va{constructor(M,N,Ia,lb,Sb,Wc,td,wd,be,hb,hf,Xf,Bg,ji,pi,Oe,Ri,Rj,dh,ff,Kj,Mf,ke,vf,fo){this.rDb=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.iX;this.d1b=!1;this.jcb=this.Iea=this.aqe=this.tsf=null;this.va=new R.a;this.wCg=!1;this.Yn=M;this.nJ=N;this.rze=new yl(this);this.q3c=new ld(this,ff);this.zWa=
Kj;this.fWa=lb;this.iug={};this.ZF=new zl;this.d7j=Ia;this.PBb=Sb.value;this.dA=td;this.Pb=Wc;this.WX=wd;this.Rb=be;this.T6j=Ri;this.Wua=hb;this.Qb=hf;this.wi=Xf;this.ua=Bg;this.Ea=ji;this.ic=pi;this.oc=Oe;this.dcc=dh;this.lcb=new ya;this.Q6j=Rj;this.gl=Mf;this.thc=ke;this.Wgc=vf;this.zdk=fo}initialize(){this.u6(this.Rb.mode);this.Rb.RK(Object(E.a)(this,this.Bag,"handleModeSwitch"))}dispose(){this.Rb.CY(Object(E.a)(this,this.Bag,"handleModeSwitch"))}get IHc(){this.lcb||(this.lcb=new ya);return this.lcb}get vl(){if(!va.Uua){this.Yn&&
(this.Yn.qd.CKj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new pg),this.Qb.ka("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new pg,new rg(this.Yn.qd.vg?B.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:B.AFrameworkApplication.fa.appSettings.WebServiceBase),this.Qb.ka("306")),OfficeExt.MosRequestHandler.init(new pg),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new pg));const M=new He(this.rze,
this.q3c);this.jcb=this.xF.bDi(this.ZF);va.Uua=this.d7j.MDi(this.nJ,M,this.jcb);va.Uua.setOAuthManager(this.zdk);va.Uua&&"undefined"!==typeof va.Uua.hostCheckReadyHandler&&B.AFrameworkApplication.w$h(Object(E.a)(va.Uua,va.Uua.hostCheckReadyHandler,"hostCheckReadyHandler"))}return va.Uua}c5e(M){(M=this.vl.getOsfControl(M))&&this.jcb&&this.jcb.s3g(M)}vkc(M,N){this.jcb.vkc(M,N)}YAb(M,N,Ia){this.jcb?this.jcb.r_j(M,N,Ia):r.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}Dkb(M,N,Ia=null){const lb=
this.xF.g3(M);if(this.Qb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Ztb(lb.storeType)))this.gl.Mda(22)||this.gl.jDa(22);else if(0===lb.Zw)this.fWa.zKj(lb.id)?(Ia=this.fWa.Fra[lb.id],Qe.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.fWa.UKa(lb.id,this.iYe(M),N):(Ia.CVe(N),this.fWa.UKa(lb.id,this.iYe(M),null))):(M=this.Wqd(M,N),M.CVe(N),this.fWa.J6k(lb.id,M));else if(1===lb.Zw){const Sb=lb.node.sa(of.a.NZ,null);this.pua(lb.id)?lb.bhg||this.ILb(Sb,!0):this.Wqd(M,N,Ia);this.Yn.qd.fua&&
!lb.ownerAddinSolutionId&&(N=this.wae(lb.Qxa),this.V5e(lb.Qxa,N.settings))}}launchInsertDialog(){this.va.raiseEvent("OnInsertionDialogOpened");this.Iea=new Pi;this.Iea.aj("",null,null);this.vl.launchInsertDialog(this.Iea.Gja)}q_j(M){const N=this.oHc.X3i(M);this.Yn.VG().La(vc.a.ofe,2,{version:N.version,storeType:N.storeType,storeId:N.storeId,assetId:N.assetId,assetStoreId:N.assetStoreId,targetType:N.targetType,displayName:N.displayName,solutionId:M,width:N.width,height:N.height})}Y1c(M){const N=this.vl.getAppUILocale()||
"en-US";this.Ssg=new Wg(M,"wac_powerpoint",N,Ia=>{this.Yn.VG().La(vc.a.ofe,2,Ia);this.Ssg.hide()});this.Ssg.aj("",null,null);return!0}A_j(M){this.va.raiseEvent("OnInsertionDialogOpened");this.Iea=new Pi;this.Iea.aj("",null,null);if(M){const N={navigationMode:0};N.assetId=M;this.vl.launchInsertDialog(this.Iea.Gja,"{98143890-AC66-440E-A448-ED8771A02D52}",N)}else this.vl.launchInsertDialog(this.Iea.Gja)}Upg(M){this.va.raiseEvent("OnInsertionDialogOpened");this.Iea=new Pi;this.Iea.aj("",null,null);this.vl.launchInsertDialog(this.Iea.Gja,
M,{navigationMode:0,assetId:null,category:null})}Tcg(){this.Iea&&this.Iea.hide()}Wib(M){const N=this.WWf(M);N?this.fkh(N):r.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",M))}fkh(M){const N=this.xF.g3(M);if(this.Qb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Ztb(N.storeType)))this.gl.Mda(22)||this.gl.jDa(22);else{var Ia=(lb,Sb)=>{const Wc=this.xF.g3(lb),td=this.xF.ILc(B.AFrameworkApplication.isRtl,Wc.id,Wc.width,Wc.visibility);Sb.RP(td);
this.rDb||td.Ap(Wc.visibility);let wd=Sb=null;this.Yn.qd.fua&&this.Yn.qd.hXj&&(wd=this.gld(M),Sb=()=>{this.YK(td,!0,!1);this.ROb(wd)});this.Dkb(lb,td.HHc,Sb);this.rDb&&(wd&&(lb=this.oQ(wd.Jo.id).nca,td.bgl(lb)),td.Ap(Wc.visibility))};if(this.Yn.qd.fua){const lb=this.xF.g3(M),Sb={};Sb.solutionId=lb.Qxa;Sb.version=lb.version;Sb.storeType=this.Ztb(lb.storeType);Sb.storeId=lb.store;Sb.targetData=M;this.vl.isAddinCommandsAsync(Sb,(Wc,td)=>{const wd=this.gld(M);var be=M.sa(jg.a.isForUILessAction,!1);const hb=
M.sa(jg.a.sharedRuntimeId,null),hf=lb.ownerAddinSolutionId,Xf=!!wd.gw&&0<wd.gw.state&&!!wd.gw.iya;if(!td&&lb.visibility||td&&hf&&!Xf||be&&!ma.a.Wa(hb))Ia(M,this.dA),this.z_.UHh(lb.id,td);else if(td){if(be=this.v4b(lb.Qxa))wd.settings=be.settings,this.zu.pUe(M,wd.settings);this.z_.Esf(wd.instanceId,wd);this.z_.UHh(wd.instanceId,td);this.V5e(wd.Jo.id,wd.settings);if(lb.visibility&&this.Wua.installVisibleAddinCommandsEnabled||Xf){if("omex"!==Sb.storeType.toLowerCase()&&!Xf)return;let Bg=!1;this.YNe(ji=>
{if(!ji[Q.a.Oci]){if(ji[Q.a.Rvf])for(const pi of ji[Q.a.Rvf])if(Bg=Dh.e(pi[1])===Dh.e(lb.Qxa))break;Bg||this.gGc(wd)}})}}Wc||yd.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",lb.Qxa,this.Ztb(lb.storeType))})}else Ia(M,this.dA)}}pwb(M){return M&&M.assetId?M.sourceLocationOverrideResourceId?String.format("{0}.{1}",M.assetId,M.sourceLocationOverrideResourceId):M.assetId:null}m1k(M){M.P0b=-1;const N=this.aBf(M);this.xhc=void 0!=M.CNc&&void 0!=M.GNc?new Zj(M.CNc,M.GNc):new Zj;void 0!=
M.dialogLeft&&void 0!=M.FNc&&void 0!=M.dialogTop&&void 0!=M.ANc&&this.xhc.gbl(M.dialogLeft,M.FNc,M.dialogTop,M.ANc);void 0!=M.dialogHeight&&void 0!=M.dialogWidth&&this.xhc.hbl(M.dialogHeight,M.dialogWidth);this.xhc.aj("",null,null);this.Wqd(N,this.xhc.Gja,null,M)}Y0k(M){Qe.a("EnableSDXDialog2")&&(M.P0b=1);const N=this.aBf(M),Ia=this.xF.g3(N);if(B.AFrameworkApplication.hme(Ia.Qxa)){const lb=this.xF.ILc(B.AFrameworkApplication.isRtl,Ia.id,Ia.width,Ia.visibility,M);this.dA.RP(lb);lb.Ap(Ia.visibility);
this.Wqd(N,lb.HHc,null,M)}}YNe(M){const N={};N.callback=M;B.AFrameworkApplication.Ta.La(vc.a.PZa,2,N)}gGc(M){const N=this.xF.ILc(B.AFrameworkApplication.isRtl,M.instanceId,M.taskpane.width,M.taskpane.visibility);this.dA.RP(N);N.Ap(M.taskpane.visibility);const Ia=N.HHc;Object(ea.a)(880,this.xF.eYd(this.Yn.qd,M,Ia,B.AFrameworkApplication.isRtl,this)).gGc(this.vl,Ia,()=>{this.ROb(M);this.YK(N,!1,!!M.gw&&!!M.gw.iya);y.a.instance.setItem(Q.a.uQd,"true")})}YK(M,N,Ia){M.Ap(!1);Ia||(va.Uua.purgeOsfControl(M.id,
!1),N?this.Yn.VG().La(yi.a.EWc,2,M.id):this.q3c.dGf(M.id),M.dispose())}ROb(M){var N={};N.solutionId=M.Jo.id;N.version=M.Jo.version;N.storeType=M.Jo.storeType;N.storeId=M.Jo.store;N.assetId=null;N.assetStoreId=null;N.sharedRuntimeId=M.gw?M.gw.iya:null;N.backgroundState=M.gw?M.gw.state:-1;M=new e.a;M.add(N);N={};N[Q.a.mHc]=M;N[Q.a.T7]=3;this.Yn.VG().La(vc.a.W1c,2,N)}ORc(){const M=this.WX.xf;var N=null;M&&(N=new Nh.GraphIterator,N.set(M),N=N.Bb(18));return N}oQ(M){return M?(M=this.ZF.a6d(M))&&M.taskpane?
M:null:null}BZi(M,N,Ia,lb){if(!M||!N||!Ia)return null;M=this.getSharedRuntimeId(N,lb,M.solutionId,Ia);return(Ia=this.ZF.E4i(Ia,M,this.vl))&&Ia.taskpane?Ia:null}wQc(M){return M?(M=this.ZF.MW(M))&&M.taskpane?M:null:null}JDa(M){if(!M)return null;var N=this.ORc();if(N&&(N=this.Pb.Mc(N))&&N.Bb(19)){do{const Ia=N.currentNode;if(this.DZb(Ia.sa(qe.a.Qrb,null),M))return Ia}while(N.Fj(19))}return null}WWf(M){if(!M)return null;var N=this.ORc();if(N&&(N=this.Pb.Mc(N))&&N.Bb(19)){do{const Ia=N.currentNode;if(this.DZb(Ia.sa(of.a.NZ,
null),M))return Ia}while(N.Fj(19))}return null}vWf(M,N){return(M=this.oc.zl(M))?M.lT(N):null}VJj(M){return M?this.ZF.ecj(M):!1}Mki(M,N,Ia,lb,Sb){if(!M||!M)return null;let Wc;if(!(M.solutionId&&M.version&&M.storeId&&M.storeType))return r.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;Wc=Object(ea.a)(Ha.a,this.PBb.createInstance(1074135137));Wc.setValue(qe.a.Qrb,M.solutionId);Wc.setValue(qe.a.QHc,M.version);Wc.setValue(qe.a.PHc,M.storeId);Wc.setValue(of.a.nZb,this.uLc(M.storeType));Wc.setValue(qe.a.LHc,
!1);Wc.setValue(of.a.NZ,sd.a.create().toString());Wc.setValue(qe.a.jRd,"right");Wc.setValue(qe.a.qZb,Ia);Sb&&Wc.setValue(jg.a.isForUILessAction,Sb);lb&&(Wc.setValue(of.a.l9g,lb),(M=this.getSharedRuntimeId(N,Sb,M.solutionId,lb))&&Wc.setValue(jg.a.sharedRuntimeId,M));return Wc}c6d(M){M=this.JDa(M);return this.gld(M)}Lki(M,N){if(!(M&&M&&M.solutionId&&M.version&&M.storeId&&M.storeType))return null;M=new La(M.solutionId,M.version,M.storeId,M.storeType);N=N?new kb(0,N):null;return new Hb(M,null,null,null,
null,{},1,N)}$Nc(M){Jf.AppsForOfficeSingleSignOnManager.$ri(M);const N=this.ZF.MW(M);N&&(va.Uua.purgeOsfControl(N.instanceId,!1),this.q3c.dGf(N.instanceId),this.ZF.MXk(N.instanceId),this.fWa.eih(N.instanceId),this.zWa.Coc(this.presentationId,M,!1,!0))}notifyAgave(M,N){this.vl.notifyAgave(M,N)}RUk(M){!this.wCg&&M.Tj&&(M=M.Tj,M.xd(47).R7(Object(E.a)(this,this.Uwf,"appDisposeHandler")),M.xd(10).R7(Object(E.a)(this,this.Uwf,"appDisposeHandler")),this.wCg=!0)}Uwf(M,N){M=N.node;N=1074135137===M.Ue;if(M.sa(of.a.Dq,
!1)||N)M=this.xF.g3(M),this.$Nc(M.id)}aBf(M){var N;const Ia=Object(ea.a)(9,this.PBb.createInstance(1074135137));Ia.setValue(qe.a.QHc,"1.0.0.0");Ia.setValue(qe.a.PHc,"en-US");Ia.setValue(of.a.NZ,sd.a.create().toString());Ia.setValue(qe.a.qZb,!0);Ia.setValue(of.a.cRd,null);Ia.setValue(of.a.Swf,null);Ia.setValue(qe.a.Qrb,this.pwb(M));(null!==(N=M.CJh)&&void 0!==N?N:1)?(Ia.setValue(qe.a.oZb,"sdxcatalog"),Ia.setValue(of.a.nZb,this.uLc("sdxcatalog"))):(Ia.setValue(qe.a.oZb,"firstparty"),Ia.setValue(of.a.nZb,
this.uLc("firstparty")));Ia.setValue(of.a.isAddinCommands,!1);Ia.setValue(qe.a.LHc,!1);Ia.setValue(qe.a.jRd,"right");return Ia}gld(M,N=null){if(!M)return null;M=this.xF.g3(M);var Ia=this.Ztb(M.storeType);const lb=new La(M.Qxa,M.version,M.store,Ia);let Sb=null,Wc=null,td;if(Qe.a("EnableSDXDialog2")&&-1==(null===N||void 0===N?void 0:N.P0b))td=new Bm;else if(0===M.Zw)Sb=new Qa(M.shapeId,M.slideId);else if(1===M.Zw)Wc=new Eb(M.yQf,M.visibility,M.width,M.row,M.ownerAddinSolutionId,M.ownerAddinStoreType,
M.bhg);else return null;let wd={};N&&OSF.OsfControl.isFirstPartyStoreString(Ia)?wd=OSF.OUtil.serializeSettings(N.nonPersistedSettings):M.ownerAddinSolutionId||(wd=M.settings);Ia=M.F6a?new kb(M.osb,M.F6a):null;return Qe.a("EnableSDXDialog2")?new Hb(lb,M.id,Sb,Wc,td,wd,td&&N?N.P0b:M.Zw,Ia):new Hb(lb,M.id,Sb,Wc,null,wd,M.Zw,Ia)}chh(M,N=null){if(this.Qb.ka("883")){var Ia=this.vl.getOsfControl(M);if(Ia&&N){if(N.nonPersistedSettings){var lb=OSF.OUtil.serializeSettings(N.nonPersistedSettings);Ia.setSettings(lb);
Ia.setHostSettings(lb)}N.XE&&(lb=Object(ea.a)(881,this.wQc(M)))&&(lb.nca=N.XE,this.rDb&&this.ILb(M,!0));Ia.refresh();this.c5e(M)}}}Wqd(M,N,Ia=null,lb=null){const Sb=this.gld(M,lb);if(!Sb||OSF.OsfControl.isFirstPartyStoreString(Sb.Jo.storeType)&&!B.AFrameworkApplication.hme(Sb.Jo.id))return null;var Wc=this.xF.g3(M);if(this.Qb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Ztb(Wc.storeType)))return this.gl.Mda(22)||this.gl.jDa(22),null;lb&&lb.XE&&(Sb.nca=lb.XE);Wc=Object(ea.a)(880,this.xF.eYd(this.Yn.qd,
Sb,N,B.AFrameworkApplication.isRtl,this));this.ZF.Esf(Sb.instanceId,Sb);this.ZF.k6h(Sb.Jo.id,N);lb&&lb.H5&&lb.H5();this.Yn.qd.fua&&Sb.taskpane&&Sb.taskpane.ownerAddinSolutionId&&(N=this.ZF.a6d(Sb.taskpane.ownerAddinSolutionId))&&this.ZGh(N.instanceId,Sb.instanceId);Wc.Jll(this.vl,this.iYe(M),Ia,lb,this.Wua.powerPointDragInsertImageIsEnabled);Sb.taskpane&&Sb.taskpane.ownerAddinSolutionId||this.RUk(M);return Wc}KBh(M){if(this.Wua.ZXj){const Ia=this.z_.MW(M);if(Ia&&0===Ia.Zw&&Ia.shape){var N=this.z_.vlj(M);
const lb=new Date;!N||lb.getTime()-N.getTime()>=this.Wua.pptEditorAppForOfficeSnapshotIntervalTime?(r.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",Ia.Jo.id,M),(N=this.T6j.XJf(1,M))?(this.z_.vHl(M,lb),N.execute(this,this.Q6j,null)):r.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Ia?Ia.Jo.id:"AppNotExist",M)):r.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",Ia?Ia.Jo.id:
"AppNotExist",M)}}}w5g(M,N,Ia,lb){1===M&&this.Yzk(N,Ia,lb)}Yzk(M,N,Ia){let lb=null;Ia&&Ia.result&&(Ia=Ia.result,lb=Ia.substr(Ia.indexOf("base64,")+7));const Sb=this.z_.MW(M);N===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&lb&&0<lb.length&&Sb?0===Sb.Zw&&Sb.shape&&Sb.Jo&&this.wi.pHh(Sb.shape.slideId.toString(),Sb.shape.id,lb,()=>{r.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Sb.Jo.id,M,lb.length)},()=>{r.ULS.sendTraceTag(512508169,806,10,"Update addin [{0}] {1} snapshot failed",
Sb.Jo.id,M);return!1}):r.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",Sb?Sb.Jo.id:"AppNotExist",M,lb?lb.length:0)}v4b(M){return M?this.iug[M]:null}CGc(M,N){M&&N&&(this.iug[M]=N)}get zu(){this.aqe||(this.aqe=new Zg(this.Yn.qd,jc.a.instance.resolve("Common.IAppSettingsManager"),this.nJ,jc.a.instance.ke("Box4.IOutlineEditor"),jc.a.instance.ke("Box4.ISelectionManager"),jc.a.instance.ke("Box4.ICharacterPropertiesEditor"),jc.a.instance.ke("PowerPointWebEditor.IClassFactory"),
jc.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.Yn.VG(),jc.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),jc.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),jc.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),jc.a.instance.resolve("PowerPointWebEditor.ISlideReader"),jc.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),jc.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),jc.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),
jc.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),jc.a.instance.resolve("PowerPointWebEditor.IShapeReader"),jc.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),jc.a.instance.resolve("Box4.IOutlineElementNavigator"),jc.a.instance.resolve("Box4.IParagraphReader"),jc.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),jc.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.aqe}get jda(){return this.zWa}$Za(M,N,Ia){this.q3c.$5d(M).raiseEvent(Ia,
N)}Seh(M,N){this.ZF.b5d(Ia=>{this.$Za(M,Ia.instanceId,N)})}ZGh(M,N){if(M&&N){M=this.z_.MW(M);var Ia=this.z_.MW(N);M&&Ia&&(Ia.settings=M.settings,this.B5g(N,M.settings))}}V5e(M,N){M&&N&&this.z_.b5d(Ia=>{this.DZb(Ia.taskpane.ownerAddinSolutionId,M)&&!this.IHc.AKj(Ia.settings,N)&&(Ia.settings=N,this.B5g(Ia.instanceId,N))})}Bag(M){this.u6(M.mode)}u6(M){if(1!==M&&2!==M)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",M));r.ULS.sendTraceTag(512508167,806,50,
"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===M?"Show":"Edit");this.fWa.u6(M);this.dA.u6(M)}B5g(M,N){const Ia=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.$Za(Ia,M,N)}Ztb(M){switch(M){case 0:M="spcatalog";break;case 1:M="filesystem";break;case 2:M="omex";break;case 3:M="spapp";break;case 4:M="registry";break;case 5:M="inmemory";break;case 6:M="uploadfiledevcatalog";break;case 7:M="excatalog";break;case 8:M="firstparty";break;case 9:M=
"sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",M));}return M}uLc(M){if(!M)throw Error.create("Store Type should not be null.");va.c6||va.YEj();if(M in va.c6)return va.c6[M];throw Error.create(String.format("[{0}] is not the valid store type.",M));}wae(M){return M?this.ZF.sYi(N=>this.DZb(N.Jo.id,M)):null}get nRd(){return this.Yn}vai(M){this.va.addHandler("OnInsertionDialogOpened",M)}WGc(M){this.va.addHandler("OnFirstPartyAddInHidden",M)}o_k(M){this.va.removeHandler("OnFirstPartyAddInHidden",
M)}tPk(M){this.va.raiseEvent("OnFirstPartyAddInHidden",new oj(M))}fWd(M){const N=yh.a.zpa(this.dA.R2,Ia=>Ia.id===M);if(1!==N.length)return!1;this.YK(N[0],!0,this.pua(M));return!0}ILb(M,N){const Ia=yh.a.zpa(this.dA.R2,lb=>lb.id===M);1!==Ia.length?yd.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Ia.length):Ia[0].Ap(N)}S3i(M){const N=yh.a.zpa(this.dA.R2,Ia=>Ia.id===M);return 1!==N.length?(yd.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",N.length),!1):N[0].isVisible}PBl(M,
N){const Ia=this.v4b(M);Ia&&Ia.gw&&Ia.gw.iya&&(Ia.gw.state=N?1:0,(this.JDa(M)||this.IHc.Oag(M,Ia.settings,this))&&this.Yn.VG().La(yi.a.bHh,2,Ia))}T3i(M){return(M=this.v4b(M))&&M.gw?1===M.gw.state:!1}OGf(M){this.z_.b5d(N=>{this.DZb(N.taskpane.ownerAddinSolutionId,M)&&this.fWd(N.instanceId)})}uwb(M){return this.ZF.MW(M)}pua(M){if(!M||4===this.vl.getOsfControlStatus(M))return!1;M=this.vl.getOsfControl(M);return!!M&&!!M.getSharedRuntimeId()}setInitialDisplayMode(M,N){(M=this.vl.getOsfControl(M))&&M.setInitialDisplayMode(N)}getSharedRuntimeId(M,
N,Ia,lb){if(!M)return null;const Sb=new vd;if(!Sb)return null;if(N)return M.getSharedRuntimeId(Sb.qT,N,null);Ia=(new cb("",lb,Sb,!0)).XMf(Ia.substr(lb.length));return M.getSharedRuntimeId(Sb.qT,N,Ia)}XZi(M,N){const Ia={};Ia.visibility=N?"Visible":"Hidden";N=JSON.stringify(Ia);this.kXf(M,65539,"",N)}ZZi(M,N,Ia){this.kXf(M,1,N,Ia)}uol(M,N){M=new La(M.solutionId,M.version,M.storeId,M.storeType);var Ia=new Eb("right",!0,350,0,null,null,!1);M=new Hb(M,Hj.a.create().toString(),null,Ia,null,{},1,null);const lb=
this.xF.ILc(B.AFrameworkApplication.isRtl,M.instanceId,M.taskpane.width,M.taskpane.visibility);this.dA.RP(lb);lb.Ap(M.taskpane.visibility);Ia=lb.HHc;Object(ea.a)(880,this.xF.eYd(this.Yn.qd,M,Ia,B.AFrameworkApplication.isRtl,this)).gGc(this.vl,Ia,()=>{this.YK(lb,!1,!1);N()})}kXf(M,N,Ia,lb){var Sb=Array(6);Sb[0]=65536;Sb[1]=N;Sb[2]=Ia;Sb[3]=lb;Sb[4]=-1;Sb[5]=!1;N=Array(1);N[0]=Sb;Sb=new fc(OSF.DDA.EventDispId.dispidRichApiMessageEvent,M,null,N);this.$Za(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),
M,Sb)}DZb(M,N){return M&&N?M.toLowerCase()===N.toLowerCase():!1}iYe(M){return!this.Rb||1!==this.Rb.mode||M&&"FA000000012"===M.sa(of.a.cRd,null)?1===this.xF.g3(M).Zw?!0:this.Ea.MFa(M)?this.ua.Ba===this.ic.jg(M):!1:!1}get presentationId(){return this.Yn.gTa().presentationId}get PIf(){return this.fWa}get z_(){return this.ZF}get xF(){return this.dcc.value}get g5k(){return this.thc}get AKk(){return this.Wgc}get s_(){return this.ua}static YEj(){va.c6={};va.c6.inmemory=5;va.c6.uploadfiledevcatalog=6;va.c6.spcatalog=
0;va.c6.omex=2;va.c6.registry=4;va.c6.spapp=3;va.c6.filesystem=1;va.c6.excatalog=7;va.c6.firstparty=8;va.c6.sdxcatalog=9}get Pvf(){return this.oHc}get oHc(){this.tHc&&!this.Qsg&&(this.Qsg=new Ue(new fe.a({["AppsForOfficeAllowExternalMarketplace"]:this.Wua.Yie.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.Wua.G$b.toString(),["AreThirdPartyAddInsAllowed"]:this.Wua.Mia.toString(),["PopularAddinDetailsJsonString"]:va.Lid}),new Zh.a(()=>this.vl)));return this.Qsg}get tHc(){return this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}naa(M,N){this.oHc&&this.oHc.naa(M,N)}static get Lid(){return'[{"displayName":"Pro Word Cloud","solutionId":"WA104038830","version":"1.0.0.3","description":"Create beautiful word cloud images from your text","iconUrl":"65503.58165d84-0d6e-4545-a991-40ffee49b75a.9fa95f4f-0649-45b6-8ea9-b3b9e7611d90.2a84fadc-6e9a-4a27-a8c3-4c7a71e76546.jpeg","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://prowritingaid.com/art/245/Privacy-Policy.aspx","addinInfo":{"priority":2,"AUP":1}},{"displayName":"QR4Office","solutionId":"WA104051163","version":"1.2.0.3","description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":2,"AUP":1}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"WA104178141","version":"4.3.3.0","description":"Unlimited access to licensed photos, clipart and your company\'s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":1,"AUP":1885}},{"displayName":"Poll Everywhere Presenter","solutionId":"WA104218073","version":"3.0.0.1","description":"Gather audience responses via SMS or web, and display them instantly in gorgeous PowerPoint charts.","iconUrl":"27009.88b1aa30-f74d-43ab-b5f6-4565d9a70427.06bc2362-a830-44c4-84e3-f5b99c45acf8.47ba58ff-e53f-4c3e-bea2-3aa7562d1cc6.png","licenseUrl":"https://www.polleverywhere.com/terms","privacyUrl":"https://www.polleverywhere.com/privacy-policy","addinInfo":{"priority":2,"AUP":1495}},{"displayName":"Web Video Player","solutionId":"WA104221182","version":"3.3.0.0","description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":947}},{"displayName":"Web Viewer","solutionId":"WA104295828","version":"1.9.0.0","description":"Take it to the web! Insert a secure webpage into your presentation.","iconUrl":"53665.f48f5d64-1b9c-4db4-8579-0a8a770cc1df.479bd539-f5d1-4edd-8d3f-fd2aa12fe078.d7ba8494-d2ee-426a-985a-25a7db9bf8f5.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949675993/Asset_901070fc-4837-4edc-83b0-b3438f2ddf97/OfficeMixEULA.docx","privacyUrl":"https://aka.ms/mixaddinprivacy","addinInfo":{"priority":2,"AUP":2439}},{"displayName":"Mentimeter - Interactive Presentations","solutionId":"WA104379261","version":"3.0.2.4","description":"Engage your audience with fun and interactive presentations, visualizing their opinions in real-time","iconUrl":"51223.47e20eb4-286a-415c-a7c6-a30d8aaf5dd8.bb9bb1df-e506-4b71-82d1-44c6d0de3876.92bae303-c177-4756-a889-8da8fce426e2.png","licenseUrl":"https://www.mentimeter.com/terms","privacyUrl":"https://www.mentimeter.com/privacy","addinInfo":{"priority":1,"AUP":3793}},{"displayName":"LessonPix Symbols","solutionId":"WA104379370","version":"2.0.0.0","description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":350}},{"displayName":"Pexels - Free Stock Photos","solutionId":"WA104379997","version":"2.0.0.0","description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":412}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"WA104380050","version":"3.4.0.0","description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":795}},{"displayName":"Emoji Keyboard","solutionId":"WA104380121","version":"2.0.0.0","description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":591}},{"displayName":"Templafy Company Templates","solutionId":"WA104380278","version":"1.0.0.6","description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":110}},{"displayName":"PickMe - Presentation images","solutionId":"WA104380510","version":"1.0.0.3","description":"Search and add images, photos, icons and background images for your best presentation.","iconUrl":"45844.d6cd8bac-3b6d-45dc-8fbe-6307d6477d25.c4010abd-54d6-4345-be6e-fb8cdb8f926e.2095bcd7-d785-46dd-9472-c95cceb628d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickme.gettyimagesbank.com/guide/Privacy/privacy_policy","addinInfo":{"priority":3,"AUP":1}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"WA104380526","version":"1.1.0.0","description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":685}},{"displayName":"officeatwork | Content Chooser for Office","solutionId":"WA104380602","version":"3.4.0.0","description":"Access your centrally shared content in Word, Excel, PowerPoint, Outlook, Browser, and other Apps.","iconUrl":"21517.8509aff9-edc8-4f6a-8b59-4b406996c84a.d1a19980-7c71-4be1-8215-82ff5834af8f.fa526dd8-ee50-4045-add0-21357070c87b.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":379}},{"displayName":"PP Timer","solutionId":"WA104380667","version":"3.0.0.1","description":"Insert a timer into your PowerPoint presentation. Add an analog or digital timer into your slide.","iconUrl":"34537.0bb60981-b391-4645-8398-65b19c9df09a.571de747-edd5-4568-9dd0-072bcf87df09.69ce727f-55eb-405a-9470-668ccee0d6fc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pp-timer.com/privacy-policy","addinInfo":{"priority":1,"AUP":8}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"WA104380862","version":"1.5.0.0","description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":305}},{"displayName":"Pixton Comic Characters","solutionId":"WA104380907","version":"3.1.0.0","description":"Add illustrated, posable comic characters to your training or educational presentations.","iconUrl":"29860.e57c0b3f-b9bb-4ebd-b4e4-8b64b797db43.8ed21d66-e83f-4ec7-98e4-f637d866c239.755b4296-081d-4793-8eb5-ed82118043d8.png","licenseUrl":"https://www.pixton.com/terms-of-use/addons","privacyUrl":"https://www.pixton.com/privacy-policy/addons","addinInfo":{"priority":1,"AUP":1485}},{"displayName":"Excel-to-Word Document Automation","solutionId":"WA104380955","version":"3.16.2.1","description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":211}},{"displayName":"Icons by Noun Project","solutionId":"WA104381063","version":"1.0.0.1","description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":1,"AUP":318}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"WA104381155","version":"1.1.1.0","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":2,"AUP":3852}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"WA104381411","version":"2.4.1.0","description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":645}},{"displayName":"Ubi Timer","solutionId":"WA104381448","version":"1.0.0.8","description":"Add a customisable timer to your PowerPoint presentation slides.","iconUrl":"8460.b2044bd4-1b25-41e3-9810-3564d9472171.804e0d26-99a8-4b72-a103-49327a1a30b8.f01fef0d-5053-4e80-b246-34524e7c5f69.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ubicompsolutions.co.uk/timer_privacy","addinInfo":{"priority":3,"AUP":84}},{"displayName":"Forms","solutionId":"WA104381526","version":"1.0.0.2","description":"Embed surveys, quizzes, and polls directly into a PowerPoint slide.","iconUrl":"3597.3f744035-7cc5-4b23-9aea-1e7380b37172.42f8397f-a77f-48a3-a506-4032a34b3bf7.14bf7247-1539-4086-9824-7fe176221f3d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?linkid=871815","addinInfo":{"priority":1,"AUP":6617}},{"displayName":"Wooclap","solutionId":"WA104381682","version":"1.0.0.5","description":"With its many features and intuitive use, Wooclap turns events into interactive and dynamic learning","iconUrl":"13441.9fb6980a-f99b-4bf1-9d44-82fefa4843e1.4d33dfef-862e-473d-bfb1-2bdabc490da8.e1403f2d-3a83-46a6-8215-0a1020f33bbc.png","licenseUrl":"https://www.wooclap.com/en/terms-of-service","privacyUrl":"https://www.wooclap.com/en/privacy-policy","addinInfo":{"priority":2,"AUP":935}},{"displayName":"MathType","solutionId":"WA104381909","version":"3.5.1.0","description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":1,"AUP":1672}},{"displayName":"EasyTimer","solutionId":"WA104382064","version":"1.0.0.2","description":"An easy-to-use timer for your PowerPoint presentations.","iconUrl":"17586.18a4e21f-e685-4cd1-910e-2b2e032b01ff.5f21673c-f2a3-4710-8cdc-532e6d7a4f45.baa310be-ee05-44be-8e2b-1373024798f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://lixiaoooowei.github.io/TimerLab/Home/PrivacyPolicy.html","addinInfo":{"priority":2,"AUP":1364}},{"displayName":"Pear Deck Add-in","solutionId":"WA200000094","version":"1.0.0.0","description":"Add formative assessments and interactive activities to lessons and presentations","iconUrl":"59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.peardeck.com/privacy-policy","addinInfo":{"priority":2,"AUP":9847}},{"displayName":"draw.io Diagrams","solutionId":"WA200000113","version":"1.0.0.0","description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":783}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"WA200000729","version":"3.19.222.0","description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":681}},{"displayName":"Present Pal add-in - Presentation Support","solutionId":"WA200001313","version":"1.0.0.0","description":"Control your slideshow directly from the Present Pal app to make presenting easy and accessible!","iconUrl":"26522.34e9b858-f1e6-4aa8-b47f-dfb0c9224869.2f9ca7d4-7141-4377-bde9-adcb55b44237.6092b85f-1084-427b-a1ec-55b33b8ee41f.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://presentpal.co.uk/privacy-policy","addinInfo":{"priority":3,"AUP":96}},{"displayName":"Premast Plus","solutionId":"WA200001396","version":"4.1.3.0","description":"Use Premast plus features and professional templates to design better presentation, faster. Without ","iconUrl":"62947.925c188e-dab2-4231-acfb-60d131eb7da4.132d74f0-1c13-48eb-b8f5-fcec0b139825.1b91bd7f-2be5-430e-a33c-2016eb52f79a.png","licenseUrl":"https://premast.com/plus-terms-of-use","privacyUrl":"https://premast.com/privacy-policy","addinInfo":{"priority":1,"AUP":103}},{"displayName":"Slides365 - Build Professional Presentations Yourself","solutionId":"WA200001409","version":"1.0.0.3","description":"Guided storytelling using pre-built Templates, Industry Domain Slides, Design Slides and Icons","iconUrl":"10382.5c0bebe6-0d6f-40c0-88ff-4bcc1c0a3acb.9a0fd746-d03b-42f5-8b9f-1eced5547c82.1b9b795d-9337-411d-be6b-fd064ef3dec8.png","licenseUrl":"https://slides365.com/Terms.html","privacyUrl":"https://slides365.com/Privacy-Policy.html","addinInfo":{"priority":2,"AUP":124}},{"displayName":"SlideHub","solutionId":"WA200001625","version":"1.0.0.7","description":"Helps SlideHub users build better presentations faster via various tools and an on-demand service ","iconUrl":"28341.df79b07c-0691-4db6-9851-8b81eaa9f482.805bbb88-2bbf-4a63-9d09-d9c6ebedfc46.339597b4-5e8a-4295-8925-ed11ad30fbc1.png","licenseUrl":"https://slidehub.io/eula","privacyUrl":"https://slidehub.io/privacy","addinInfo":{"priority":2,"AUP":1735}},{"displayName":"Breaktime","solutionId":"WA200001661","version":"2.1.0.2","description":"A quick way to tell everyone when you\'ll be back, because it\'s Breaktime!","iconUrl":"53429.790a3023-92b3-4c27-bd32-62a1ac84d552.c35b1205-7b21-4321-84c7-9708e97de568.4d0318b8-f51d-4eef-ae55-3c20fb66521e.png","licenseUrl":"https://www.flosim.com/breaktime/EULA.html","privacyUrl":"https://www.flosim.com/breaktime/Privacy_Policy.html","addinInfo":{"priority":1,"AUP":3240}},{"displayName":"Canto Connector","solutionId":"WA200001766","version":"1.5.0.0","description":"Simplify how you add images and brand elements to Word and PowerPoint from your Canto image library.","iconUrl":"7869.c66666c2-edf3-4109-955b-4b8dcefb734e.39d11081-f25d-4285-9427-84ecd59deb0a.d2b7f5df-5a3f-4755-a8a6-9c5dd4a750dc.png","licenseUrl":"https://team.canto.com/b/Q9GTF","privacyUrl":"https://www.canto.com/privacy-policy","addinInfo":{"priority":3,"AUP":32}},{"displayName":"Jasperactive for Office","solutionId":"WA200002334","version":"1.1.0.0","description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":2,"AUP":1456}},{"displayName":"Kahoot! for PowerPoint","solutionId":"WA200002908","version":"1.1.0.0","description":"Host kahoots within PowerPoint and make presentations awesome! ","iconUrl":"5821.dc651664-7ea2-4fed-b845-27e926a3bf3f.29a4cdf3-8814-4a22-b5b3-c79c432e8b0f.0c3e5c0c-62fb-4d25-8518-3bf537f62cd0.png","licenseUrl":"https://trust.kahoot.com/terms-and-conditions","privacyUrl":"https://trust.kahoot.com/privacy-policy","addinInfo":{"priority":1,"AUP":563}},{"displayName":"RRSlide Library","solutionId":"WA200003157","version":"1.0.0.0","description":"We supply PowerPoint templates, infographics, charts, 3D icons, etc. to make a quick presentation","iconUrl":"27146.0ffbcab3-3f86-4d90-847e-e9e416c2f04d.1ada7438-24b1-4363-861f-4f3235e1fe56.1c5b196a-7fe5-49ea-ad4c-a502150e70e9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://rrslide.com/privacy-policy","addinInfo":{"priority":2,"AUP":150}},{"displayName":"Personalised QR Code Generator","solutionId":"WA200003220","version":"1.0.0.0","description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":179}},{"displayName":"Microsoft Power BI","solutionId":"WA200003233","version":"2.0.0.3","description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.68115a5f-13b5-4260-9fe9-b6c37e561377.e47b03c9-a5b9-4b5b-97be-affb2ee9bff5.82fc138b-c424-4039-b098-8fdbd0d76965.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":43414}},{"displayName":"Microsoft Power BI Beta","solutionId":"WA200003251","version":"2.0.0.4","description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.e29569b7-a73e-472a-906f-7d3d7b5b56d0.6c0dd532-76c1-4565-a1f0-e5e8d45f1138.f53a6d02-633b-4da5-a56f-f804e844a2a0.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":250}},{"displayName":"Showmaster (Helper Plugin)","solutionId":"WA200003676","version":"1.0.0.0","description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.cc4515b5-7941-4c49-8152-a4da1dceef8d.f2ec1037-3774-4e94-a41a-f9e6432611d8.b9e80121-ccc1-40f9-b6f7-3430a31b50fc.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":156}},{"displayName":"Showmaster","solutionId":"WA200003706","version":"1.1.0.0","description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.e0b83de2-8341-4aaf-a8da-e9a86c1dfdd3.e729953e-7bb6-4556-8a33-55c83e572918.0fe180b8-8511-42ae-b526-0796e91fbee1.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":75}},{"displayName":"PresenterMedia | Thousands of Animations, Templates, and Designs at your Fingertips","solutionId":"WA200003891","version":"1.0.0.1","description":"Insert customized graphics, templates and videos directly into your presentation.","iconUrl":"37569.30ec0671-d417-4ae9-8009-4cee496ea074.3b3c120c-ea56-4a82-a3c1-82e4591f6140.e03fae66-8132-4071-a176-963a53dd2798.png","licenseUrl":"https://www.presentermedia.com/addin_terms_of_use","privacyUrl":"https://www.presentermedia.com/privacy_policy","addinInfo":{"priority":3,"AUP":109}},{"displayName":"Read on reMarkable","solutionId":"WA200003915","version":"2.0.0.0","description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":2,"AUP":250}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"WA200003944","version":"1.1.0.1","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":2,"AUP":3813}},{"displayName":"beautiful.ai | AI powered slide templates","solutionId":"WA200003964","version":"1.0.0.0","description":"Create beautiful presentations faster with AI powered slide templates","iconUrl":"5525.df072342-580e-437e-9d68-96615f75b68a.7429d240-ba6f-4dc1-b122-5ce6e89e8b49.50a5f98b-bd54-446f-a983-3d56cf4f16ca.png","licenseUrl":"https://www.beautiful.ai/terms-of-service","privacyUrl":"https://www.beautiful.ai/privacy-policy","addinInfo":{"priority":1,"AUP":157}},{"displayName":"Project Plan","solutionId":"WA200004643","version":"1.0.0.3","description":"Visualize your project plans and roadmaps right in PowerPoint and Excel.","iconUrl":"48512.5fa6879a-44fb-480a-8848-5280995a049e.88d32693-93e0-4681-93a8-a59ee99f893b.c488f1bf-ea9e-4e56-9711-4a5a41a432c4.png","licenseUrl":"https://www.projectplan-powerpoint.com/terms","privacyUrl":"https://www.projectplan-powerpoint.com/privacy","addinInfo":{"priority":1,"AUP":192}},{"displayName":"Vevox for PowerPoint (BETA)","solutionId":"WA200004709","version":"1.0.0.2","description":"Include Live Polls and interaction in PowerPoint presentations with the #1 rated polling platform.","iconUrl":"30836.b99a2c67-c0f9-4608-ab59-33f5dab5dffa.3c46736f-fe0e-4dad-b17e-edb4bd558f68.7ecef1a1-72c6-4083-afb1-715afe5fb27c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.vevox.com/terms-conditions#PrivacyPolicy","addinInfo":{"priority":1,"AUP":251}},{"displayName":"Ghostwriter","solutionId":"WA200005107","version":"1.0.0.5","description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":14}}]'}Jbl(M,
N=null){if(this.vl.getOsfControl(M)&&N){if(N.XE){const Ia=Object(ea.a)(881,this.wQc(M));Ia&&(Ia.nca=N.XE)}this.c5e(M)}}}va.c6=null;va.Uua=null;Object(h.a)(va,"AppForOfficeManager",null,[882,106,868]);class Ki{constructor(M,N,Ia){this.VQ=M;this.lAg=N;this.Pb=Ia}register(){this.lAg.kk(Object(E.a)(this,this.cxf,"appSettingChangedEventHandler"))}dispose(){this.lAg.Rm(Object(E.a)(this,this.cxf,"appSettingChangedEventHandler"))}cxf(M,N){M=N.node;N=N.property;try{if(1074135139===M.Ue&&N===qe.a.OHc){N=null;
var Ia=this.Pb.Mc(M);Ia.rc(47)||Ia.rc(10);Ia.zc();this.Eje(Ia.currentNode)&&(N=new Cb.a(Ia.currentNode));var lb=N.settings;Qe.a("RefreshAppSettingsValue")&&(this.VQ.uwb(N.id).settings=lb);this.VQ.$Za(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),N.id,lb)}}catch(Sb){r.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Sb)}}Eje(M){if(!M)return!1;const N=Object(ea.a)(4,M);return 1074135137===M.Ue||!!N&&N.Dq}}Object(h.a)(Ki,"AppForOfficeSettingChangedEventListener",
null,[875,106]);class Jj{constructor(M,N,Ia){this.VQ=M;this.ptg=N;this.Pb=Ia}register(){for(const M of this.ptg)M.wF(Object(E.a)(this,this.dxf,"appSettingCreatedEventHandler"))}dispose(){for(const M of this.ptg)M.bP(Object(E.a)(this,this.dxf,"appSettingCreatedEventHandler"))}dxf(M,N){M=N.node;try{if(this.Eje(M)&&21===N.VZ){this.Pb.Mc(M).p7b()||r.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");const Ia=new Cb.a(M),lb=Ia.settings;this.VQ.$Za(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),
Ia.id,lb)}}catch(Ia){r.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Ia)}}Eje(M){if(!M)return!1;const N=Object(ea.a)(4,M);return 1074135137===M.Ue||!!N&&N.Dq}}Object(h.a)(Jj,"AppForOfficeSettingCreatedEventListener",null,[875,106]);class al{constructor(M,N){this.ia=M;this.Gv=N}register(){this.Gv.kk(Object(E.a)(this,this.WBh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Gv.Rm(Object(E.a)(this,this.WBh,"taskpaneAppCreatedEventHandler"))}WBh(M,N){if(M=N.node)M=
new Cb.a(M),N.property.id===of.a.NZ.id&&1===M.Zw&&(N=N.node.sa(of.a.NZ,null))&&this.ia.La(yi.a.Wib,2,N)}}Object(h.a)(al,"AppForOfficeTaskpaneAppCreatedEventListener",null,[875,106]);var gh=d(651),Nk=d(531),Pd=d(900);class bl{constructor(M,N,Ia,lb,Sb){this.rDb=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.iX;this.VQ=M;this.Yn=N;this.Rb=Ia;this.ZF=lb;this.dA=Sb}register(M){M.controlStatusChanged=Object(E.a)(this,this.s3g,"onControlStatusChanged");M.notifyHost=
Object(E.a)(this,this.C5g,"onOsfNotifyHost")}s3g(M){let N=this.ZF.uWf(M.getSolutionId());const Ia=this.ZF.MW(M.getID());Ia&&Ia.Jo&&M.isFirstParty()&&(N=this.ZF.uWf(Ia.Jo.id));if(N&&Ia&&N.previousSibling){var lb=M.getSolutionId(),Sb=M.getVersion(),Wc=null,td=null;td=M.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(lb,""):OSF.OsfManifestManager.getCachedManifest(lb,Sb);M.isFirstParty()&&Ia.nca?Wc=Ia.nca:td&&(Wc=td.getDefaultDisplayName(),Ia.nca=Wc);if(!(0===Ia.Zw||Qe.a("EnableSDXDialog2")&&
-1===Ia.Zw)){if(this.rDb){Sb=null;td&&(Sb=td.getDefaultIconUrl());td=null;Qe.a("UpdateTaskpaneWithInstanceId")&&(td=Object.assign(new Pd.a,{getContent:()=>N,type:"LegacyTaskPaneProps"}));const wd=Object.assign(new gh.a,{title:Wc,hideHeader:Qe.a("UpdateTaskpaneWithInstanceId"),iconUrl:Sb,width:320,location:2,contentProps:td,onOpen:()=>{},onClose:()=>{},isModernPane:!0});Db.UISurfaces.zr().then(be=>{if(Qe.a("UpdateTaskpaneWithInstanceId")){const hb=M.getID();be.updateTaskPane(hb,wd)}else be.updateTaskPane(lb,
wd);return null}).catch(()=>{yd.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",lb)})}N.previousSibling&&(N.previousSibling.innerText===Wc||!M.isFirstParty()&&""!==N.previousSibling.innerText)||!Wc||!Ia.taskpane||Ia.taskpane.isForUILessAction||(N.previousSibling.innerText=Wc,this.Rb.zTa())}}}r_j(M,N,Ia){this.C5g(M,N,Ia)}get tHc(){return this.Yn.qd.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}Igi(M,N){return od.a.Hn().equals(M.solutionId,
N.solutionId)&&od.a.Hn().equals(M.storeType,N.storeType)}C5g(M,N,Ia){3===N?(this.VQ.Tcg(),this.dA.rf(Ke.a.YE),Ia?(this.vkc("InsertAgave",Ia),this.Yn.VG().La(yi.a.HXc,2,Ia)):r.ULS.sendTraceTag(512360769,806,10,"InsertAgave: should have valid insert agave parameters")):41===N?this.vkc("ClickTrust",Ia):40===N?this.tHc&&this.wye&&Ia&&this.Igi(this.wye,Ia)&&Ia.storeType&&(r.ULS.sendTraceTag(509669715,220,50,"AgaveHostAction.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",bl.tQ(Ia)),this.wye=
void 0,this.VQ.naa(Ma(Ia.storeType))):36===N?Ia?this.Yn.VG().La(yi.a.HXc,2,Ia):r.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===N?Ia&&(M=Object(ea.a)(Object,Ia),M={["ak1"]:this.VQ.vl.getDevManifestInvalidUrlErrorString(M.manifestUrl)},this.Yn.VG().La(vc.a.WMb,2,M)):2===N?this.VQ.Tcg():9===N?this.Yn.qd.fua&&this.Yn.qd.Zgg&&this.Yn.VG().La(vc.a.vQe,2,Ia):5===N||6===N?(Ia=this.ZF.MW(M))?0===Ia.Zw?this.dA.x3e(N):this.dA.q0i(M,N):r.ULS.sendTraceTag(512360738,
806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):13===N||14===N?(Ia=this.ZF.MW(M))?0===Ia.Zw||Ia.taskpane&&Ia.taskpane.isForUILessAction?this.VQ.notifyAgave(M,13===N?11:12):(Ih.a.fg&&document.activeElement.blur(),this.rDb&&13===N?Ae.FocusManager.instance().MWe(Ke.a.OM):this.dA.fYf(M)):r.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):16===N?(N=this.ZF.MW(M))?0===N.Zw&&this.dA.zUf():r.ULS.sendTraceTag(512360736,
806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):17===N||18===N?(N=this.ZF.MW(M))?0===N.Zw?this.dA.zUf():(Ih.a.fg&&document.activeElement.blur(),this.dA.fYf(M)):r.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):1===N||10===N?(N=this.ZF.MW(M))?0===N.Zw&&this.VQ.KBh(M):r.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):8===N?(M={["ak1"]:this.VQ.vl.getManifestInvaildErrorString()},
this.Yn.VG().La(vc.a.WMb,2,M)):15===N?(M=this.dA.$Al(M))&&(N=this.VQ.uwb(M))&&N.taskpane&&!N.taskpane.isForUILessAction&&this.VQ.notifyAgave(M,11):23===N?ca.a.sendOtelEvent(Object.assign(new Nk.a,{otelEvent:Ia})):38===N?ca.a.sendOtelCustomerContent(Object.assign(new Nk.a,{otelEvent:Ia})):32===N?(M=Object(ea.a)(Object,Ia).solutionId,this.VQ.OGf(M)):34===N&&(M=Object(ea.a)(Object,Ia),N=M.controlId,Ia=new cb("",M.ownerAddinSolutionId,new vd,!0),M.originalControlId=Ia?Ia.XMf(N):N)}vkc(M,N){this.tHc&&
N&&(this.wye=N)}static tQ(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}}Object(h.a)(bl,"AppForOfficeAppEventHandler",null,[897]);var Lm=d(252),fj=d(1222);class Ai{static X7h(M){var N=M.getAttribute("style");N=N?N.toString():"";0>N.indexOf("pointer-events: auto")&&M.className!==Ai.cLb&&(Qe.a("Microsoft.Office.SharedOnline.FixBug6808089")?M.style.pointerEvents="auto":M.setAttribute("style",N+" pointer-events: auto"))}static Qtf(M){var N=
M.getAttribute("style");N=N?N.toString():"";0>N.indexOf("pointer-events: none")&&M.className===Ai.cLb&&(Qe.a("Microsoft.Office.SharedOnline.FixBug6808089")?M.style.pointerEvents="none":M.setAttribute("style",N+" pointer-events: none"))}static WYk(M){var N=M.getAttribute("style");N=N?N.toString():"";0<=N.indexOf("pointer-events: none")&&M.className===Ai.cLb&&(Qe.a("Microsoft.Office.SharedOnline.FixBug6808089")?M.style.pointerEvents="":(N=N.replace("pointer-events: none",""),M.setAttribute("style",
N)))}}Ai.Q5k="AppForOfficeContainer EditAppForOfficeContainer";Ai.cLb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";Ai.YTe="";Object(h.a)(Ai,"AppForOfficeViewHelper",null,[]);var dg=d(969),Mm=d(138);class nc{constructor(M,N,Ia,lb,Sb){this.eA=this.Psg=null;this.WHa=!1;this.cA=N;this.ii=Ia;N&&N.taskpane&&N.taskpane.isForUILessAction?(this.eA=null,this.Psg=Ia):(this.eA=new Mm.a,this.eA.pe.className=Ai.cLb,this.eA.pe.id="AppForOffice_"+this.cA.instanceId,this.eA.pe.style.width=
"100%",this.eA.pe.style.height="100%",this.eA.pe.style.position="relative",this.eA.pe.style.left="0",this.eA.pe.style.top="0",Ia.appendChild(this.eA.pe));this.Yc=Sb}dispose(){this.NXk();this.cA=null}NXk(){this.eA&&this.eA.zq()}CVe(M){M&&this.eA&&M!==this.ii&&(this.ii=M,M.appendChild(this.eA.pe),this.WHa&&this.Eda())}qCa(M){M&&(M.pe.innerHTML="")}Jll(M,N,Ia=null,lb=null,Sb=!1){this.i5h(M,N,Ia,lb,Sb)}gGc(M,N,Ia){N=this.Rmc(N);M.insertBlankControlWithErrorUX(N,()=>{Ia()})}i5h(M,N,Ia=null,lb=null,Sb=
!1){this.WHa=Sb;this.qCa(this.eA);this.cA&&M&&(this.UKa(N,null),N=this.Rmc(this.eA?this.eA.pe:this.Psg,lb,M),N.virtualOsfControlActivationCallback=Ia,M.insertOsfControl(N),M.setActivationCompletedStatus(this.cA.instanceId,!0),Sb&&this.Eda())}Eda(){if(this.eA){var M=this.eA.xa;if(M){var N=M.parentNode;N&&"OsfAddinOverlay"!==N.className&&(Lm.a.instance.pb(ye.a.ona,N,Object(E.a)(this,this.Hih,"removePointerEventsStyleHandler")),fj.a.instance.pb(ye.a.drop,N,Object(E.a)(this,this.Hih,"removePointerEventsStyleHandler")),
Lm.a.instance.pb(ye.a.pna,N,Object(E.a)(this,this.Y7h,"addPointerEventsStyleHandler")),Ai.Qtf(M))}}}Hih(M){M=M.qc.target;for(let N=0;N<M.childNodes.length;++N)Ai.WYk(M.childNodes[N]);return!0}Y7h(M){M=M.qc.target;for(let N=0;N<M.childNodes.length;++N)Ai.Qtf(M.childNodes[N]);return!0}UKa(M,N){this.eA&&(M?(null!=N&&this.CVe(N),this.eA.pe.className=""===Ai.YTe?Ai.Q5k:Ai.YTe,Ai.X7h(this.eA.xa)):(this.eA.pe.className!==Ai.cLb&&(Ai.YTe=this.eA.pe.className),this.eA.pe.className=Ai.cLb))}DVe(M){this.eA&&
(this.eA.pe.style.zIndex=String(M))}Rmc(M,N=null,Ia=null){const lb={};lb.div=M;lb.id=this.cA.instanceId;M=this.cA.Jo.id;const Sb=this.cA.taskpane?this.cA.taskpane.ownerAddinSolutionId:null;if(Ia&&Sb){const Wc=this.cA.taskpane.isForUILessAction;this.cA.gw?lb.sharedRuntimeId=this.cA.gw.iya:(Ia=Ia.getOsfControl(Sb).getManifest(),lb.sharedRuntimeId=this.Yc.getSharedRuntimeId(Ia,Wc,M,Sb));lb.initialDisplayMode=Wc?1:2}lb.hostInfoFlags=0;lb.sharedRuntimeId?(lb.hostInfoFlags|=1,lb.solutionId=Sb):N?(lb.solutionId=
N.assetId,lb.sourceLocationOverrideResourceId=N.sourceLocationOverrideResourceId,lb.featureGates=B.AFrameworkApplication.fa.maj(N.assetId)):lb.solutionId=M;lb.version=this.cA.Jo.version;lb.storeId=this.cA.Jo.store;lb.storeType=this.cA.Jo.storeType;lb.assetId=null;lb.assetStoreId=null;lb.settings=this.cA.settings;N&&OSF.OsfControl.isFirstPartyStoreString(this.cA.Jo.storeType)&&(lb.hostSettings=OSF.OUtil.serializeSettings(N.nonPersistedSettings));lb.reason=dg.a.contains(this.cA.Jo.id,this.cA.Zw,this.cA.Jo.store,
this.cA.Jo.storeType,this.cA.Jo.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.cA.Zw?lb.osfControlType=0:1===this.cA.Zw&&(lb.osfControlType=1);B.AFrameworkApplication.Mia||OSF.OsfControl.isFirstPartyStoreString(lb.storeType)||(r.ULS.sendTraceTag(512369924,802,50,(0===this.cA.Zw?"Content":"Taskpane")+" web add-in disabled by doc IRM"),lb.hostInfoFlags|=4);this.cA.taskpane?(lb.isForUILessAction=this.cA.taskpane.isForUILessAction,
lb.ownerAddinSolutionId=Sb,lb.ownerAddinStoreType=this.cA.taskpane.ownerAddinStoreType):lb.isForUILessAction=!1;return lb}}Object(h.a)(nc,"AppForOfficeView",null,[880]);var nm=d(279),Rc=d(75);class pf{constructor(M,N,Ia,lb,Sb,Wc,td,wd,be,hb,hf,Xf,Bg,ji,pi){new nm.a(0,0,0,0);this.fcc=this.mcb=this.jO=this.yo=null;this.lDe=ResourceStrings.l_AddinPane;this.lF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.iX;this.qb=jf.a.Ie();this.Rb=Wc;this.Zc=wd;this.dA=
td;this.qe=be;this.hu=M;this.mB=N;this.Yn=Ia;this.U6j=lb;this.Eb=Sb;this.Lr=hb;this.Yc=hf;this.Oc=Xf;this.mc=Bg;this.zH=ji;this.nz=pi;this.initialize()}dispose(){this.Zc&&this.yo&&(this.Zc.yb(ye.a.click,this.yo,Object(E.a)(this,this.xCa,"closePaneButtonClickHandler")),this.Lr.removeHandler(this.yo,ye.a.Xf,Object(E.a)(this,this.mbg,"handleShortCutsOnCloseButton")),this.yo=null);this.Oc.Vib(Object(E.a)(this,this.Hw,"onUnifiedAppStateChanged"));this.Rb.AKb(Object(E.a)(this,this.nY,"onSetOffline"));this.dA.Eih(this)}initialize(){const M=
"label_"+this.mB,N="icon_"+this.mB;this.qb.className=this.hu?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";if(Object(Qe.a)("AddClassOnSDXPaneContainer")&&this.nz){const Ia=this.nz.SBh;Ia&&(this.qb.className+=" "+Ia)}this.qb.style.position="absolute";this.qb.style.display="none";this.qb.setAttribute(ef.a.af,ef.a.bCa);this.qb.setAttribute(ef.a.U2,M);this.yo=this.KCa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.yo,"AddinPaneCloseButton");this.Zc.pb(ye.a.click,this.yo,Object(E.a)(this,
this.xCa,"closePaneButtonClickHandler"));this.Lr.addHandler(this.yo,ye.a.Xf,Object(E.a)(this,this.mbg,"handleShortCutsOnCloseButton"));this.qb.appendChild(this.yo);Object(Qe.a)("TempHeaderIconForActionAI")&&(this.Yn.qd.$W||this.Yn.qd.eB)&&this.nz&&"ActionAITaskPane"===this.nz.SBh&&(this.fcc=jf.a.SA(),this.fcc.className="PaneIcon",this.fcc.id=N,this.fcc.src="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Orange.svg",this.qb.appendChild(this.fcc));
this.mcb=jf.a.Ie();this.mcb.className="PaneLabel";this.mcb.id=M;this.mcb.setAttribute(ef.a.af,ef.a.Qyf);this.mcb.setAttribute(ef.a.EZb,"1");this.qb.appendChild(this.mcb);this.jO=jf.a.Ie();this.jO.className="AddinPanePanelResize";this.qb.appendChild(this.jO);this.Oc.S7(Object(E.a)(this,this.Hw,"onUnifiedAppStateChanged"));this.Rb.HPa(Object(E.a)(this,this.nY,"onSetOffline"))}Hw(M,N){N.Jab&&!this.mc.In&&this.isVisible&&this.Icg()}nY(M){M&&this.isVisible&&(Object(Qe.a)("FixAddInPaneVisibilityInOfflineMode")&&
this.Yc.$Nc(this.mB),this.Icg())}Icg(){this.Ap(!1);this.Yn.VG().La(yi.a.EWc,2,this.mB);this.Cne()||this.dispose()}layout(M,N){const Ia=N?M.oD(this.width):M.pD(this.width);this.isVisible&&(N?Ia.oD(1):Ia.pD(1),this.jO.style.height=(M.height-this.yo.clientHeight-this.mcb.clientHeight).toString()+"px",this.jO.style.width="100%");jf.a.z1(this.qb,Ia);return M}bgl(M){this.lDe=M}Ap(M){const N=this.Eb!==M;if(this.Eb=M)this.qb.style.display="block";const Ia=this.Cne();this.zH.Gcl(this.mB,Ia);if(this.lF){let lb=
this.lDe;Object(Qe.a)("TaskPaneToolTip")&&this.Yn.qd.eB?this.nz&&this.nz.UBh?lb=this.nz.UBh:this.nz&&(lb=this.nz.XE):lb=this.nz?this.nz.XE:this.lDe;this.zH.IM(this,this.Eb,lb,this.mB)}else this.Rb.zTa();Ia&&(this.yo.style.visibility=M?"visible":"hidden",N&&this.Yc.XZi(this.mB,M))}Cne(){return this.Yc.pua(this.mB)}xCa(){this.Ap(!1);this.Yn.VG().La(yi.a.EWc,2,this.mB);this.Cne()||this.dispose();return!0}JCa(M,N,Ia,lb,Sb,Wc){const td=jf.a.SA();td.alt=Sb;td.className=Rc.getImageClassWithCluster(M,lb);
td.src=this.qe.rk(M+".png");td.setAttribute("Unselectable","on");M=jf.a.Sn();M.className=N+" cui-img-cont-float";M.appendChild(td);N=jf.a.Sn();N.className=Ia;N.setAttribute("Unselectable","on");N.appendChild(M);Ia=jf.a.Eca();Ia.className="CommentPaneNoBorderButton cui-ctl";Ia.title=Sb;Ia.setAttribute(ef.a.af,ef.a.Au);Ia.tabIndex=0;Ia.appendChild(N);Wc&&(Sb=jf.a.Sn(),Sb.className="cui-ctl-mediumlabel",Sb.setAttribute("Unselectable","on"),Sb.innerText=Wc,Ia.appendChild(Sb));return Ia}KCa(M,N){return this.JCa(M,
"cui-img-16by16","cui-ctl-iconContainer",N,CommonUIStrings.l_DialogClose,null)}mbg(M){M.keyCode===hd.a.tq||M.keyCode===hd.a.pP?(this.xCa(null),M.preventDefault(),M.stopPropagation()):M.keyCode===hd.a.Sq&&(M.shiftKey?this.Yc.notifyAgave(this.mB,12):this.Yc.notifyAgave(this.mB,11),M.preventDefault(),M.stopPropagation())}get isVisible(){return this.Eb}get xa(){return this.qb}get order(){return 6}get width(){return this.isVisible?this.U6j:0}get HHc(){return this.jO}get Mvi(){return this.yo}get id(){return this.mB}}
Object(h.a)(pf,"AddInPane",null,[895,552,106]);class jk{constructor(M,N,Ia,lb,Sb,Wc,td,wd,be,hb){this.Yn=M;this.Rb=N;this.dA=Ia;this.Zc=lb;this.qe=Sb;this.q0=Wc;this.Yc=td;this.Oc=wd;this.mc=be;this.zH=hb}ILc(M,N,Ia,lb,Sb){return new pf(M,N,this.Yn,Ia,lb,this.Rb,this.dA,this.Zc,this.qe,this.q0,this.Yc,this.Oc,this.mc,this.zH,Sb)}g3(M){return new Cb.a(M)}bDi(M){return new bl(this.Yc,this.Yn,this.Rb,M,this.dA)}eYd(M,N,Ia,lb,Sb){return new nc(M,N,Ia,lb,Sb)}}Object(h.a)(jk,"AppforOfficeClassFactory",
null,[874]);class hg{constructor(M){this.Jyg=this.dR=!1;this.Pm=Xd.a.cZ();this.jtg=M;$e.OSk(this.jtg)}Tv(){this.Jyg=!0}dispose(){if(this.Jyg&&!this.dR){var M=Xd.a.cZ();$e.NSk(this.jtg,this.Pm,M);this.dR=!0}}}Object(h.a)(hg,"ApiCallLogger",null,[106]);class qh{get formatting(){return 0}set formatting(M){}get sourceSlideIds(){return null}set sourceSlideIds(M){}get targetSlideId(){return null}set targetSlideId(M){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(M){switch(M){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,N){switch(M){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"Array<string>");return;
case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}
Object(h.a)(qh,"InsertSlideOptions",null,[]);class Cj{constructor(){this.controlId=this.appId=null}}Object(h.a)(Cj,"RequestContext",null,[]);class mf{constructor(){this.spf=this.bif=null}get layoutId(){return this.bif}set layoutId(M){this.bif=M}get slideMasterId(){return this.spf}set slideMasterId(M){this.spf=M}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(M){switch(M){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,N){switch(M){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(h.a)(mf,"AddSlideOptions",null,[]);class L{constructor(M,N,Ia){this.gcc=M;this.H9=N;this.Yc=Ia}getAppRuntimeStartState(){if(!this.Yc.pua(this.H9))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Yc.T3i(this.gcc)?1:0}setAppRuntimeStartState(M){if(!this.Yc.pua(this.H9)||0!==M&&1!==M)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Yc.PBl(this.gcc,1===M)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,
N){switch(M){case 2:return this.K4i();case 1:return this.$$k(N)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}K4i(){return this.getAppRuntimeStartState()}$$k(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");this.setAppRuntimeStartState(M);return null}}Object(h.a)(L,"AppRuntimePersistenceService",null,[]);class Cn{constructor(M,N){this.H9=
M;this.Yc=N}getAppRuntimeState(){if(!this.Yc.pua(this.H9))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Yc.S3i(this.H9)?2:1}setAppRuntimeState(M){if(!this.Yc.pua(this.H9)||2!==M&&1!==M)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Yc.ILb(this.H9,2===M)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 2:return this.L4i();case 1:return this.aal(N)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,
N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}L4i(){return this.getAppRuntimeState()}aal(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");this.setAppRuntimeState(M);return null}}Object(h.a)(Cn,"AppRuntimeService",null,[]);class oi{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 1001:return this.KHj(N);case 1002:return this.fIj(N)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}KHj(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"string");this.insertHyperLink(N,M);return null}fIj(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.insertSlideFromContent(M)}}Object(h.a)(oi,"Application",null,[]);class pj{constructor(M,N){this.yG=
!1;this._id=M;this.oId=N}get enabled(){return this.yG}set enabled(M){this.yG=M;B.AFrameworkApplication.Ta.La(vc.a.V3b,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.oId,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(M){switch(M){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,N){switch(M){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 5:return this.wbl(N);
case 1:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}wbl(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"boolean");this.setEnabled(M);return null}WH(){this._OnAccess();return null}}Object(h.a)(pj,"RibbonButton",null,[]);class Nl{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(M){switch(M){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 3:return this.Cgl(N);case 1:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,
N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}Cgl(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"boolean");this.setVisibility(M);return null}WH(){this._OnAccess();return null}}Object(h.a)(Nl,"RibbonTab",null,[]);class Bi{constructor(M,N){this.PMa=this.cN=this.pCc=null;this.vxc=M;this.j2a=N;ma.a.Wa(this.vxc)||(this.PMa=N.uwb(M),this.pCc=(this.cN=this.j2a?this.j2a.vl:null)?this.cN.getOsfControl(this.vxc):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(M){let N=
null;if(!this.Oig())return this.fKf();if(!ma.a.Wa(M)&&this.PMa&&this.PMa.taskpane){if(!this.qFf(M))return this.sKf(M);N=new pj(M,this.PMa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}getTab(M){let N=null;if(!this.Oig())return this.fKf();if(!ma.a.Wa(M)&&this.PMa&&this.PMa.taskpane){if(!this.qFf(M))return this.sKf(M);N=new Nl(M)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(M){switch(M){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 1:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){switch(M){case 7:return this.eVi(N);
case 6:return this.fVi(N);case 3:return this.D5i(N);case 5:return this.Jmj(N)}M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}eVi(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.executeRequestCreate(M)}fVi(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.executeRequestUpdate(M)}D5i(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getButton(M)}Jmj(M){M=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getTab(M)}WH(){this._OnAccess();return null}sKf(M){return this.FKf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+M)}fKf(){return this.FKf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}Oig(){const M=!ma.a.Wa(this.pCc.getSharedRuntimeId());yd.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",M));return M}qFf(M){if(this.pCc){var N=
this.pCc.getManifest();if(N&&(N=N.getRibbonExtensionControlMap()))return M in N||this.ksi(M)}return!1}ksi(M){var N=this.sZi();if(N){N=N.iRf;for(const Ia of N.tabs){if(Ia.id===M)return!0;for(const lb of Ia.groups)for(const Sb of lb.controls){if(Sb.id===M)return!0;if("Menu"===Sb.type){N=Sb;for(const Wc of N.items)if(Wc.id===M)return!0}}}}return!1}sZi(){return D.getInstance().W8a(this.PMa.taskpane.ownerAddinStoreType,this.PMa.taskpane.ownerAddinSolutionId,1)}FKf(M,N){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,
lb)=>{lb(OfficeExtension.WacRuntime.Utility.createRichApiException(M,N))})}}Object(h.a)(Bi,"DynamicRibbon",null,[]);class Li{constructor(M,N,Ia,lb){this.t9e="";this.Kyc=0;this.tG=M;this._id=N;this.yVb=Ia;this.j2a=lb}get id(){return this._id}_RegisterStateChange(){this.Kyc||this.tG.execute(M=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.yVb,this._id,1);this.t9e=M.Gib(this._id,N=>{this.j2a.ZZi(this.yVb,this._id,JSON.stringify(N))})});this.Kyc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Kyc--;
this.Kyc||this.tG.execute(M=>{M.oKb(this._id,this.t9e)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(M){switch(M){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){switch(M){case 6:return this.oNh();case 7:return this.sNh()}M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}oNh(){return this._RegisterStateChange()}sNh(){return this._UnregisterStateChange()}}Object(h.a)(Li,"LicenseFeature",
null,[]);class Dj{get scopes(){return null}set scopes(M){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(M){switch(M){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,N){switch(M){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(h.a)(Dj,"MsaDeviceTicketOptions",null,[]);class zk{constructor(M,N){this.tG=jc.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
this.yVb=M;this.j2a=N}getFeatureTier(M,N){return OfficeExtension.WacRuntime.Utility.createPromise(Ia=>{const lb=1===N?1:2===N?2:0;this.tG.execute(Sb=>{Sb.getFeatureTier(M,lb).then(Wc=>{Ia(this.Scj(Wc))},()=>{Ia(N)})})})}getLicenseFeature(M){M=new Li(this.tG,M,this.yVb,this.j2a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}getMsaDeviceTicket(){return null}isFeatureEnabled(M,N){return OfficeExtension.WacRuntime.Utility.createPromise(Ia=>{this.tG.execute(lb=>{lb.isFeatureEnabled(M,
N).then(Sb=>{Ia(Sb)},()=>{Ia(N)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(M=>{this.tG.execute(N=>{N=N.isFreemiumUpsellEnabled();M(N)})})}launchUpsellExperience(M){if(this.j2a.vl.getOsfControl(this.yVb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.tG.execute(N=>{N.launchUpsellExperience(M)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied","");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 7:return this.Gej(N);case 6:return this.qNh(N)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,
N){switch(M){case 2:return this.O$i(N);case 5:return this.Rcj(N);case 1:return this.lOj(N);case 3:return this.$Oj();case 4:return this.J_j(N)}M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}O$i(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int");return this.getFeatureTier(N,M)}Rcj(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");
return this.getLicenseFeature(M)}Gej(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string"),Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,2,Dj);return this.getMsaDeviceTicket(N,Ia,M)}lOj(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"boolean");return this.isFeatureEnabled(N,M)}$Oj(){return this.isFreemiumUpsellEnabled()}J_j(M){M=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.launchUpsellExperience(M)}qNh(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");this._TestFireStateChangedEvent(M);return null}Scj(M){switch(M){case 1:return 1;case 2:return 2;default:return 0}}}Object(h.a)(zk,"License",null,[]);class Ne{get height(){return 0}set height(M){}get left(){return 0}set left(M){}get top(){return 0}set top(M){}get width(){return 0}set width(M){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(M){switch(M){case 1:return this.height;
case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,N){switch(M){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"number");return;case 3:this.top=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,
N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(h.a)(Ne,"ShapeAddOptions",null,[]);class Ig{constructor(M,N,Ia){this.IMe=!1;this.nyg=!0;this.gcc=M;this.H9=N;this.Yc=Ia}hostName(){return"PowerPointOnline"}appId(){return this.gcc}controlId(){return this.H9}createInstance(M){switch(M){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new mf;case "Microsoft.Office.PowerPoint.Application":return new oi;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new qh;
case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Ne;case "Microsoft.AppRuntime.AppRuntimeService":return new Cn(this.H9,this.Yc);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new L(this.gcc,this.H9,this.Yc);case "Microsoft.Office.Licensing.License":return new zk(this.H9,this.Yc);case "Microsoft.DynamicRibbon.DynamicRibbon":return new Bi(this.H9,this.Yc)}r.ULS.sendTraceTag(588375570,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",
M);return null}static ar(M){const N=jc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").tsf;M||(N.nyg=!1);return!N.IMe}}Object(h.a)(Ig,"RichApiHost",null,[898]);class Ok{constructor(M,N,Ia){this.cxd=this.Uh=-1;this.$B=Ia;0<=M&&(this.Uh+=M,this.cxd=0<N?M+N<this.$B.getCount()?M+N:this.$B.getCount():this.$B.getCount())}get_current(){return-1<this.Uh&&this.Uh<this.cxd?this.$B.getItemAt(this.Uh):null}moveNext(){const M=this.nBl();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}nBl(){return this.Uh+
1<this.cxd?(this.Uh++,!0):!1}}Object(h.a)(Ok,"ElementEnumerator",null,[933]);class gj{constructor(M,N){this.e5a=M;this.yS=N}get fill(){Ig.ar(!1);return null}get height(){Ig.ar(!1);return 0}set height(M){Ig.ar(!1)}get id(){const M=new hg(28);try{yd.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.e5a)return yd.a.J(577525073,802,10,"Shape is null."),"";const N=this.e5a.get_shapeId().toString();M.Tv();return N}finally{M&&M.dispose()}}get left(){Ig.ar(!1);return 0}set left(M){Ig.ar(!1)}get lineFormat(){Ig.ar(!1);
return null}get name(){Ig.ar(!1);return null}set name(M){Ig.ar(!1)}get tags(){Ig.ar(!1);return null}get textFrame(){Ig.ar(!1);return null}get top(){Ig.ar(!1);return 0}set top(M){Ig.ar(!1)}get type(){Ig.ar(!1);return 0}get width(){Ig.ar(!1);return 0}set width(M){Ig.ar(!1)}deleteObject(){if(Ig.ar(!0)){var M=new hg(45);try{yd.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const N=Object(ea.a)(116,this.yS);N&&(N.VLi(Object(ea.a)(4,this.e5a)),M.Tv())}finally{M&&M.dispose()}}}getParentSlide(){Ig.ar(!1);
return null}getParentSlideLayout(){Ig.ar(!1);return null}getParentSlideLayoutOrNullObject(){Ig.ar(!1);return null}getParentSlideMaster(){Ig.ar(!1);return null}getParentSlideMasterOrNullObject(){Ig.ar(!1);return null}getParentSlideOrNullObject(){Ig.ar(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(M){switch(M){case 11:return this.fill;case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;
case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,N){switch(M){case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,
0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 4:return this.H_d();
case 15:return this.jgj();case 16:return this.kgj();case 18:return this.lgj();case 17:return this.mgj();case 19:return this.ngj();case 20:return this.ogj();case 2:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}H_d(){this.deleteObject();return null}jgj(){return this.getParentSlide()}kgj(){return this.getParentSlideLayout()}lgj(){return this.getParentSlideLayoutOrNullObject()}mgj(){return this.getParentSlideMaster()}ngj(){return this.getParentSlideMasterOrNullObject()}ogj(){return this.getParentSlideOrNullObject()}WH(){this._OnAccess();
return null}}Object(h.a)(gj,"Shape",null,[]);class Ce{constructor(M){this.qTb=this.kqb=null;this.yS=M;if(M=Object(ea.a)(116,this.yS))this.kqb=M.mTa();this.mHk()}mHk(){this.qTb=new ka.ScriptSharpLegacyMap;if(this.kqb)for(const M of this.kqb){const N=new gj(M,this.yS);this.qTb.add(N.id,N)}}addGeometricShape(){Ig.ar(!1);return null}addLine(){Ig.ar(!1);return null}addTextBox(){Ig.ar(!1);return null}getCount(){const M=new hg(29);try{yd.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.kqb)return yd.a.J(577525071,
802,50,"In Shape.GetCount(), _shapes is null"),0;M.Tv();return this.kqb.length}finally{M&&M.dispose()}}getItem(M){const N=new hg(31);try{yd.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");try{const Ia=this.qTb.ga(M);N.Tv();return Ia}catch(Ia){throw yd.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");
}}finally{N&&N.dispose()}}getItemAt(M){const N=new hg(30);try{yd.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Ia=this.kqb[M].get_shapeId().toString(),lb=this.qTb.ga(Ia);N.Tv();return lb}catch(Ia){throw yd.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{N&&
N.dispose()}}getItemOrNullObject(M){const N=new hg(32);try{yd.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let Ia;({value:Ia}=this.qTb.Tf(M));N.Tv();return Ia}finally{N&&N.dispose()}}_OnAccess(){}getAsyncEnumerator(M,N){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ok(M,N,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=
this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 6:return this.S6h(N);case 7:return this.q7h(N);case 8:return this.Z8h(N);case 1:return this.E9a();case 2:return this.U9a(N);case 5:return this.T9a(N);case 3:return this.V9a(N);
case 4:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}S6h(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,Ne);return this.addGeometricShape(N,M)}q7h(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
1,Ne);return this.addLine(N,M)}Z8h(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,Ne);return this.addTextBox(N,M)}E9a(){return this.getCount()}U9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItem(M)}T9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");return this.getItemAt(M)}V9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"string");return this.getItemOrNullObject(M)}WH(){this._OnAccess();return null}}Object(h.a)(Ce,"ShapeCollection",null,[920]);class Al{constructor(M){this.tEc=M}get id(){const M=new hg(15);try{yd.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.tEc)return yd.a.J(576581654,802,10,"SlideLayout is null."),"";const N=this.tEc.Id.toString();M.Tv();return N}finally{M&&M.dispose()}}get name(){const M=new hg(16);try{yd.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.tEc)return yd.a.J(576581655,
802,10,"SlideLayout is null."),"";const N=this.tEc.Name;M.Tv();return N}finally{M&&M.dispose()}}get shapes(){Ig.ar(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(M){switch(M){case 1:return this.id;case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 2:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}WH(){this._OnAccess();return null}}Object(h.a)(Al,"SlideLayout",null,[]);class qk{constructor(M){this.rTb=null;this.iXb=M;this.nHk()}nHk(){this.rTb=
new ka.ScriptSharpLegacyMap;if(this.iXb)for(const M of this.iXb){const N=new Al(M);this.rTb.add(N.id,N)}}getCount(){const M=new hg(17);try{yd.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.iXb)return yd.a.J(576581651,802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;M.Tv();return this.iXb.length}finally{M&&M.dispose()}}getItem(M){const N=new hg(19);try{yd.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Ia=this.rTb.ga(M);N.Tv();
return Ia}catch(Ia){throw yd.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{N&&N.dispose()}}getItemAt(M){const N=new hg(18);try{yd.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const Ia=this.rTb.ga(this.iXb[M].Id.toString());N.Tv();return Ia}catch(Ia){throw yd.a.J(576581653,
802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{N&&N.dispose()}}getItemOrNullObject(M){const N=new hg(20);try{yd.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let Ia;({value:Ia}=this.rTb.Tf(M));N.Tv();return Ia}finally{N&&N.dispose()}}_OnAccess(){}getAsyncEnumerator(M,
N){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ok(M,N,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,
N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 1:return this.E9a();case 2:return this.U9a(N);case 3:return this.T9a(N);case 4:return this.V9a(N);case 5:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}E9a(){return this.getCount()}U9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"string");return this.getItem(M)}T9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");return this.getItemAt(M)}V9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItemOrNullObject(M)}WH(){this._OnAccess();return null}}Object(h.a)(qk,"SlideLayoutCollection",null,[920]);class eg{constructor(M){this.uqb=M}get id(){const M=new hg(21);try{yd.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.uqb)return yd.a.J(576581648,
802,10,"SlideMaster is null."),"";const N=this.uqb.Id.toString();M.Tv();return N}finally{M&&M.dispose()}}get layouts(){const M=new hg(23);try{yd.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.uqb)return yd.a.J(576581649,802,10,"SlideMaster is null."),null;const N=new qk(this.uqb.ContentMasters);M.Tv();return N}finally{M&&M.dispose()}}get name(){const M=new hg(22);try{yd.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.uqb)return yd.a.J(576581650,802,10,"SlideMaster is null."),
"";const N=this.uqb.Name;M.Tv();return N}finally{M&&M.dispose()}}get shapes(){Ig.ar(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(M){switch(M){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 2:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}WH(){this._OnAccess();return null}}Object(h.a)(eg,"SlideMaster",null,[]);class Lf{constructor(M,N){this.yS=M;this.VAa=N}get id(){const M=
new hg(5);try{yd.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.yS)return yd.a.J(587747398,802,10,"Slide is null."),"";const N=this.yS.Cb.toString();M.Tv();return N}finally{M&&M.dispose()}}get layout(){const M=new hg(9);try{yd.a.J(572643284,802,50,"PptApi Call - Slide.GetLayout");const N=this.VAa.Q0;for(let Ia=0;Ia<N.length;Ia++){const lb=N[Ia].ContentMasters;for(let Sb=0;Sb<lb.length;Sb++)if(this.yS.Cn===lb[Sb].Id){const Wc=new Al(lb[Sb]);M.Tv();return Wc}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a Layout.");}finally{M&&M.dispose()}}get shapes(){const M=new hg(6);try{yd.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");const N=new Ce(this.yS);M.Tv();return N}finally{M&&M.dispose()}}get slideMaster(){const M=new hg(8);try{yd.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const N=this.VAa.Q0;for(let Ia=0;Ia<N.length;Ia++)if(this.yS.ij===N[Ia].Id){const lb=new eg(N[Ia]);M.Tv();return lb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a SlideMaster.");}finally{M&&M.dispose()}}get tags(){Ig.ar(!1);return null}deleteObject(){if(Ig.ar(!0)){var M=new hg(7);try{yd.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.VAa.zI(this.yS),M.Tv()}finally{M&&M.dispose()}}}setSelectedShapes(){Ig.ar(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(M){switch(M){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 3:return this.H_d();case 8:return this.Qel(N);case 2:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}H_d(){this.deleteObject();return null}Qel(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"Array<string>");this.setSelectedShapes(M);return null}WH(){this._OnAccess();return null}}Object(h.a)(Lf,"Slide",null,[]);class om{constructor(M){this.sTb=null;this.VAa=M;this.vqb=this.VAa.slides;this.oHk()}oHk(){this.sTb=new ka.ScriptSharpLegacyMap;if(this.vqb)for(const M of this.vqb){const N=
new Lf(M,this.VAa);this.sTb.add(N.id,N)}}W8i(){return 0<this.getCount()?this.vqb[this.getCount()-1]:null}j7d(M){return M?M.ij:this.VAa.Q0[0].Id}h7d(M){const N=this.VAa.Q0;for(let Ia=0;Ia<N.length;Ia++)if(M===N[Ia].Id)return N[Ia].ContentMasters[0].Id;return 0}add(M){if(Ig.ar(!0)){var N=new hg(10);try{yd.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const Ia=this.W8i();let lb=0;lb=M&&M.slideMasterId?parseInt(M.slideMasterId):this.j7d(Ia);let Sb=0;Sb=M&&M.layoutId?parseInt(M.layoutId):this.h7d(lb);
this.VAa.KYb(Ia,null,lb,Sb);N.Tv()}finally{N&&N.dispose()}}}getCount(){const M=new hg(11);try{yd.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.vqb)return yd.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;M.Tv();return this.vqb.length}finally{M&&M.dispose()}}getItem(M){const N=new hg(13);try{yd.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const Ia=this.sTb.ga(M);N.Tv();return Ia}catch(Ia){throw yd.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{N&&N.dispose()}}getItemAt(M){const N=new hg(12);try{yd.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Ia=this.sTb.ga(this.vqb[M].Cb.toString());N.Tv();return Ia}catch(Ia){throw yd.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{N&&N.dispose()}}getItemOrNullObject(M){const N=new hg(14);try{yd.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let Ia;({value:Ia}=this.sTb.Tf(M));N.Tv();return Ia}finally{N&&N.dispose()}}_OnAccess(){}getAsyncEnumerator(M,N){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ok(M,N,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 6:return this.o7h(N);case 1:return this.E9a();case 5:return this.U9a(N);case 2:return this.T9a(N);case 3:return this.V9a(N);
case 4:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}o7h(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,mf);this.add(M);return null}E9a(){return this.getCount()}U9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItem(M)}T9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"int");return this.getItemAt(M)}V9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItemOrNullObject(M)}WH(){this._OnAccess();return null}}Object(h.a)(om,"SlideCollection",null,[920]);class yc{constructor(M){this.tTb=null;this.jXb=M;this.pHk()}pHk(){this.tTb=new ka.ScriptSharpLegacyMap;if(this.jXb)for(const M of this.jXb){const N=new eg(M);this.tTb.add(N.id,N)}}getCount(){const M=new hg(24);try{yd.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.jXb)return yd.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;M.Tv();return this.jXb.length}finally{M&&M.dispose()}}getItem(M){const N=new hg(26);try{yd.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Ia=this.tTb.ga(M);N.Tv();return Ia}catch(Ia){throw yd.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{N&&N.dispose()}}getItemAt(M){const N=new hg(25);try{yd.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Ia=this.tTb.ga(this.jXb[M].Id.toString());N.Tv();return Ia}catch(Ia){throw yd.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{N&&N.dispose()}}getItemOrNullObject(M){const N=new hg(27);try{yd.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let Ia;({value:Ia}=this.tTb.Tf(M));N.Tv();return Ia}finally{N&&N.dispose()}}_OnAccess(){}getAsyncEnumerator(M,N){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ok(M,N,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 1:return this.E9a();case 2:return this.U9a(N);case 3:return this.T9a(N);case 4:return this.V9a(N);case 5:return this.WH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}E9a(){return this.getCount()}U9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItem(M)}T9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");return this.getItemAt(M)}V9a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItemOrNullObject(M)}WH(){this._OnAccess();return null}}
Object(h.a)(yc,"SlideMasterCollection",null,[920]);class Dn{constructor(M){this.mE=new Cj;this.X4=M.presentation}get context(){return this.mE}get slideMasters(){const M=new hg(2);try{yd.a.J(572643293,802,50,"PptApi Call - Presentation.GetSlideMasters");const N=new yc(this.X4.Q0);M.Tv();return N}finally{M&&M.dispose()}}get slides(){const M=new hg(3);try{yd.a.J(572643294,802,50,"PptApi Call - Presentation.GetSlides");const N=new om(this.X4);M.Tv();return N}finally{M&&M.dispose()}}get tags(){Ig.ar(!1);
return null}get title(){const M=new hg(4);try{return yd.a.J(572643295,802,50,"PptApi Call - Presentation.GetTitle"),M.Tv(),"This is the title property"}finally{M&&M.dispose()}}getSelectedShapes(){Ig.ar(!1);return null}getSelectedSlides(){Ig.ar(!1);return null}getSelectedTextRange(){Ig.ar(!1);return null}getSelectedTextRangeOrNullObject(){Ig.ar(!1);return null}insertSlidesFromBase64(){Ig.ar(!1)}setSelectedSlides(){Ig.ar(!1)}_RegisterEvent(M,N){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
M,N)}_UnregisterEvent(M,N){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,M,N)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(M){switch(M){case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,N){this.invokePropertySet(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,N){switch(M){case 5:return this.Cjj();case 6:return this.Ejj();case 7:return this.Jjj();case 9:return this.Kjj();case 1003:return this.gIj(N);case 8:return this.Rel(N);case 1001:return this.nNh(N);case 1002:return this.rNh(N)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,N){M=this.invokeMethod(M,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}Cjj(){return this.getSelectedShapes()}Ejj(){return this.getSelectedSlides()}Jjj(){return this.getSelectedTextRange()}Kjj(){return this.getSelectedTextRangeOrNullObject()}gIj(M){const N=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,qh);this.insertSlidesFromBase64(N,M);return null}Rel(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"Array<string>");this.setSelectedSlides(M);return null}nNh(M){const N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int");this._RegisterEvent(N,M);return null}rNh(M){const N=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int");this._UnregisterEvent(N,M);return null}}Object(h.a)(Dn,"Presentation",null,[]);class Ol{create(M){return new Dn(M)}}Object(h.a)(Ol,"PresentationFactory",null,[877]);class ii{create(M,N,Ia){return new Ig(M,N,Ia)}}Object(h.a)(ii,"RichApiHostFactory",null,[876]);class zh{constructor(M){this.qb=document.createElement("div");this.qb.className="AddinPaneFrame";this.dA=
M}dispose(){}layout(M,N){this.dA.value.xuj(M,N);return M}get isVisible(){return!1}get xa(){return this.qb}get order(){return 13}}Object(h.a)(zh,"AddinPaneFrame",null,[858,552,106]);class Wi{constructor(){this.Tcb=this.H4c=this.K=this.Yc=this.lH=null;this.lF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.iX}get name(){return"PowerPointWebEditor.AppForOffice"}Ska(M){return M.resolve("PowerPointWebEditor.IApplicationSettings").eB||M.resolve("PowerPointWebEditor.IApplicationSettings").$W}Zb(M){this.lH=
M.resolve("Common.AFrameworkApplication");this.K=M;this.K.register(Vi,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").oa(()=>new Vi).ma();this.K.register(me,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").oa(()=>new me(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").xa,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.ke("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(bd,"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").oa(()=>new bd(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();Object(Qe.a)("RegisterPackageBeforeResolve")&&this.Ska(this.K)&&(this.K.register(ii,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>new ii).ma(),this.K.register(Ol,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>
new Ol).ma());this.K.register(va,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").oa(()=>new va(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new yf,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.ke("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new G,O.getInstance(),this.K.ke("PowerPointWebEditor.IAppforOfficeClassFactory"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();const N=new v;this.K.register(qg,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").oa(()=>
new qg(this.lH,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),N,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new vd,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register($f,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").oa(()=>
new $f(N)).ma();this.K.register(Cf,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").oa(()=>new Cf(this.E2i())).ma();this.K.register(jk,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").oa(()=>new jk(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();Object(Qe.a)("RegisterPackageBeforeResolve")&&this.Ska(this.K)||(this.K.register(ii,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>
new ii).ma(),this.K.register(Ol,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>new Ol).ma());this.K.register(858,"PowerPointWebEditor.IAddinPaneFrame").ma().oa(()=>new zh(this.K.ke("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(859,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().oa(()=>new Td)}init(){B.AFrameworkApplication.Asa||this.K.resolve("Common.IAppSettingsManager").ff(Object(E.a)(this,
this.Qm,"onFullAppSettingsReady"))}Qm(){this.Yc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Yc.d1b=!0;B.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(M=>{M.isFeatureEnabled(Wi.Ddk,!0).then(N=>{this.Yc.d1b=N;this.Jyb();return null})}):this.Jyb()}Jyb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").GQe();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const M=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");M.Fzl();M.Gzl();M.Bsj();this.DBl();this.pFj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}pFj(){const M=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame");
this.lF||this.K.resolve("PowerPointWebEditor.IPaneManager").RP(M);const N=this.K.resolve("PowerPointWebEditor.IFocusManager"),Ia=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");N.a9(Ke.a.Ara,Ke.a.hj,M,!Ia.nce());this.lH.wq.Oq()}E2i(){const M=[];var N=[];N.push(this.K.resolve("Box4.Graph.IGraphInstance").xd(47));N.push(this.K.resolve("Box4.Graph.IGraphInstance").xd(10));N=new Jj(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),N,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));
M.push(N);N=new Ki(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Box4.Graph.IGraphInstance").xd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));M.push(N);N=new Gf(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));M.push(N);N=new al(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphInstance").xd(47));
M.push(N);N=new Sd(this.K.resolve("Box4.Graph.IGraphInstance").xd(8),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));M.push(N);return M}DBl(){this.Tcb=B.AFrameworkApplication.fa.Ga("DevAddinManifestFileUrl");this.H4c=B.AFrameworkApplication.fa.Ga("DevAddinManifestGuid");var M=B.AFrameworkApplication.fa.Ga("IsDevAddinTest");if(this.Tcb&&this.H4c&&M)if(M="true"===M,y.a.instance.getItem("optedIntoAddinDeveloperMode")||M&&B.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(y.a.instance.getItem(this.H4c)||
M&&B.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Yc.vl.validateAndCacheNewDevAddinManifest(this.Tcb);else{M=new x.StandardDialog;M.yd=4;const N=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Tcb)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;M.fP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,N,Object(E.a)(this,this.uhh,"registerDevAddinManifestHandler"))}else M=
Object(E.a)(this,this.uhh,"registerDevAddinManifestHandler"),M=new Hf(this.Tcb,M),M.yd=0,M.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}uhh(M){1===M&&this.Tcb&&this.nVk()}nVk(){this.Yc&&(this.Yc.vl.validateAndCacheNewDevAddinManifest(this.Tcb),y.a.instance.setItem(this.H4c,"true"))}static main(){A.a.instance.Dc(new Wi)}}Wi.Ddk="mso_officeStore";Object(h.a)(Wi,"AppForOfficePackage",null,[2,3]);var ch=
d(12);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Object(ch.c)("AppForOffice");Type.registerNamespace("CommandUI.AddInCommands");Wi.main();Object(ch.b)("AppForOffice")},449:function(J,aa,d){d.d(aa,"a",function(){return r});J=d(0);var h=d(387),e=d(210);class r{static pvh(n){return parseInt(r.Ulb(e.a.xQd,n)||"-1")<=(new Date).getTime()}static R5d(n){return parseInt(r.Ulb(e.a.q6a,
n)||"-1")}static oce(n){return Boolean.parse(r.Ulb(e.a.Brb,n)||"false")}static Ulb(n,v){let B=null;try{const y=r.Z9a();if(void 0!==y&&y){const x=e.a.ERc(n)+v;B=y.getItem(x)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(y){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",n,v)}return B}static Ylb(n,v,B){try{const y=r.Z9a();if(void 0!==y&&y){const x=e.a.ERc(n)+B;y.setItem(x,v)}else h.ULS.sendTraceTag(42074647,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(y){h.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",n,B)}}static Z9a(){if(!r.WTa)return null;let n=null;try{n=localStorage}catch(v){r.WTa=!1,n=null}return n}}r.WTa=!0;Object(J.a)(r,"AddinUtil",null,[])},540:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=
2]="spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(J.b)("AddinProviderType",h)},541:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=
1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(J.b)("AddinCommandsLaunchOperationType",h)},549:function(J,aa,d){d.r(aa);J=d(0);var h=d(18),e=d(387),r=d(68);class n{constructor(){this.startTime=0;this.callback=null}}Object(J.a)(n,
"SSOCallbackInfo",null,[]);class v{constructor(){this.accessToken=null}}Object(J.a)(v,"AccessTokenInformation",null,[969]);var B=d(979);class y{constructor(){this.token=null;this.expiresOn=0;this.eCa=this.mW=null}}Object(J.a)(y,"CachedTokenInfo",null,[]);class x{constructor(){this.Qwc=new h.a;this.Dra=this.Cra=!1;this.cMa=this.mW=null;this.startTime=this.retryCount=0;this.Wvf=null}get wUd(){return this.Qwc}}Object(J.a)(x,"SSORequestInfo",null,[]);class A extends x{constructor(){super();this.errorCode=
0}}Object(J.a)(A,"SSOFailedRequestInfo",x,[]);var E=d(27);class u{constructor(ca,T,da,fa){this.C7=new h.a;this.lS=new h.a;this.$Ma=null;this.gWb=new h.a;this.Qhf=Promise.resolve(null);this.jpf=!1;this.P_h=T;this.vxc=ca;this.Opf=da;this.ONh=fa}gkl(ca){if(this.$Ma&&this.$Ma.mW===ca.mW){if(Date.now()/1E3+u.lmk>this.$Ma.expiresOn)return this.$Ma=null,!1;ca=new B.a;ca.token=this.$Ma.token;ca.expiresOn=this.$Ma.expiresOn;ca.eCa=this.$Ma.eCa;ca.Ilb=!0;ca.d7b=0;this.P7b(ca);return!0}return!1}Dil(ca){for(let T=
0;T<this.lS.count;T++)if(this.lS.ga(T).mW===ca.mW&&this.lS.ga(T).cMa===ca.cMa){let da;(da=this.lS.ga(T)).retryCount=da.retryCount+1;ca.retryCount=this.lS.ga(T).retryCount;if(this.lS.ga(T).retryCount<u.CYa||!this.lS.ga(T).Cra&&ca.Cra||!this.lS.ga(T).Dra&&ca.Dra){if(!this.lS.ga(T).Cra&&ca.Cra||!this.lS.ga(T).Dra&&ca.Dra)ca.retryCount=0;this.lS.removeAt(T);break}ca=new B.a;ca.errorCode=this.lS.ga(T).errorCode;this.P7b(ca);return!0}return!1}e9h(ca,T){for(let da=0;da<this.lS.count;da++)if(this.lS.ga(da).cMa===
ca.cMa&&this.lS.ga(da).mW===ca.mW)return;this.lS.add(Object.assign(new A,{Cra:ca.Cra,Dra:ca.Dra,mW:ca.mW,cMa:ca.cMa,errorCode:T,retryCount:ca.retryCount}))}get resource(){return this.P_h}N5d(ca,T,da,fa,ma,ea){const {AppsForOfficeSingleSignOnManager:ra}=d(549);""===da&&(da=null);if(this.jpf)ra.zla(ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var F=null;for(let na of this.C7)if(na.Cra===ca&&na.Dra===T&&na.mW===da&&na.cMa===ma){F=na;break}F||(F=Object.assign(new x,{Cra:ca,
Dra:T,mW:da,Wvf:fa,cMa:ma,retryCount:0,startTime:ra.EF()}),this.C7.add(F));F.retryCount=0;F.wUd.add(ea);this.Qhf=this.Qhf.then(()=>{var {AppsForOfficeSingleSignOnManager:na}=d(549);if(0<this.C7.count){var ka=this.C7.ga(0);if(this.gkl(ka)||this.Dil(ka))return null;for(let za=0;za<this.gWb.count;)this.gWb.ga(za)+u.Nwl<na.EF()?this.gWb.removeAt(za):za++;if(this.gWb.count>=u.Amk||this.C7.count>=u.imk)return ka=new B.a,ka.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.P7b(ka),null;
let Ua=null;E.AFrameworkApplication.Aa&&(na=E.AFrameworkApplication.Aa.lV)&&(Ua=na.Ei("ComponentAttach",this.vxc+u.b2h));return ka.cMa.Z4h(this.resource,ka.Cra,ka.Dra,ka.mW,this.ONh,ka.Wvf).then(za=>{Ua&&Ua.stop();this.P7b(za)},()=>{Ua&&Ua.stop();const za=new B.a;za.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.P7b(za)})}return null})}}P7b(ca){const {AppsForOfficeSingleSignOnManager:T}=d(549);try{if(this.C7.count){var da=this.C7.ga(0);this.C7.removeAt(0);var fa=null;ca.errorCode||
(fa=new v,fa.accessToken=ca.token);ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.e9h(da,ca.errorCode);var ma={};null!=ca.d7b&&(ma.getTokenSilentTime=ca.d7b.toString());null!=ca.Kae&&(ma.getTokenPopupTime=ca.Kae.toString());null!=ca.i8d&&(ma.getIDTokenTime=
ca.i8d.toString());null!=ca.Ilb&&(ma.tokenCached=ca.Ilb.toString());ca.G1e&&(ma.detailedError=ca.G1e);ca.eCa&&(ma.authLibrary=ca.eCa);da.retryCount&&(ma.retryCount=da.retryCount);for(var ea of da.wUd)T.zla(ea,ca.errorCode,fa,ma);null!=ca.Ilb&&ca.Ilb||this.gWb.add(da.startTime);if(!ca.errorCode)for(null!=ca.expiresOn&&(this.$Ma=Object.assign(new y,{token:ca.token,expiresOn:ca.expiresOn,mW:da.mW,eCa:ca.eCa})),this.lS.clear(),ea=0;ea<this.C7.count;)if(this.C7.ga(ea).mW===da.mW){for(let ra of this.C7.ga(ea).wUd)T.zla(ra,
ca.errorCode,fa,ma);this.C7.removeAt(ea)}else ea++}}catch(ra){e.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ra.message)}}shutdown(){this.jpf=!0;this.C7.clear()}}u.Nwl=6E4;u.Amk=6;u.imk=6;u.CYa=3;u.lmk=300;u.b2h="GetAccessToken";Object(J.a)(u,"SSOCallbackManager",null,[]);var K=d(210),G=d(226),O=d(172),R=d(81),V=d(55),D=d(47),Q=d(142),Z=d(182);d.d(aa,"AppsForOfficeSingleSignOnManager",function(){return P});class P{constructor(ca,T,da=null){this.Pmb=new r.a;
const fa=new h.a;T&&fa.add(T.ujk);da&&fa.addRange(da);this.cN=ca;this.k3h=fa}removeCallbackForAddin(ca){this.Pmb.Gb(ca)&&(this.Pmb.ga(ca).shutdown(),this.Pmb.remove(ca))}O5d(ca,T,da,fa,ma,ea,ra,F,na,ka){ka=Object.assign(new n,{startTime:P.EF(),callback:ka});try{const ha=!!da&&""!==da;var Ua=ka.startTime;const ua=this.getOsfControl(ca);let Ga=ua.getStoreType()||"",sa=ua.getOwnerAddinStoreType()||"",Ba=ua.getSolutionId()||"";const pa=ua.getVersion()||"";Ga=Ga.toLowerCase();sa=sa.toLowerCase();Ba=Ba.toLowerCase();
var za=R.a.oTc(T)||"";const ia=R.a.oTc(ua.getIframeUrl())||"",Da=za.toLowerCase()===ia.toLowerCase();za=Ga;"inmemory"===Ga&&(za=sa);const Xa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,za,ua.getAssetId(),null,null,ua.getStoreId()),Ka={["callInstanceId"]:Ua.toString(),["controlSolutionId"]:Xa,["controlVersion"]:pa,["storeType"]:Ga,["ownerStoreType"]:sa,["allowConsentPrompt"]:fa.toString(),["forMSGraphAccess"]:ma.toString(),["allowSignInPrompt"]:ea.toString(),["hasAddinAuthChallenge"]:ha.toString(),
["securityOriginEqualsSourceLocation"]:Da.toString(),["singleSignOnEnabled"]:ra.toString(),["accountTypeFilter"]:F||""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Ka);Q.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:O.a.sC(Ka)}));Ua=!0;const Ma=E.AFrameworkApplication.fa.Ga("HostAuthType");switch(F){case "aad":Ua="aad"===Ma;break;case "msa":Ua="msa"===Ma;break;default:Ua=!F||"noFilter"===F}if(Ua){F=null;if(ra)for(let Oa of this.k3h)if(Oa.XNj(Ba)){F=
Oa;break}F?this.isSSOAddin(ca)?(ra=!0,"omex"===za&&(ra=!1),"spapp"===za||"spcatalog"===za?(e.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),P.zla(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ma&&!ra?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),P.zla(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ma&&"exchange"===za&&(fa=!1),
this.N5d(ca,T,da,za,fa,ea,na,F,ka))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),P.zla(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):P.zla(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else P.zla(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ha){this.x2c(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",ha.message),P.zla(ka,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(ca,T,da,fa){this.O5d(ca,da[K.a.yQd]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,T,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,fa)}N5d(ca,T,da,fa,ma,ea,ra,F,na){this.Pmb.Gb(ca)?fa=this.Pmb.ga(ca):(fa=new u(ca,this.getWebApplicationResource(ca).split(",")[0],fa,this.getDefaultDisplayName(ca)),this.Pmb.add(ca,fa));const ka=fa.resource;ca=P.pij(ka,this.getWebApplicationId(ca));const Ua=OfficeExt.WACUtils.getHostSecure(T);ca&&Ua?ca.toLowerCase()===Ua.toLowerCase()?fa.N5d(ma,ea,da,ra,F,na):(P.bcb('SSO Resource "'+ka+'" cannot be used from "'+T+'" origin due to domain mismatch.'),
e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),P.zla(na,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(ca||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Ua||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),P.zla(na,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}x2c(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(ca){return this.cN.getOsfControl(ca)}isSSOAddin(ca){return this.getOsfControl(ca).getManifest().isSSOAddin()}getWebApplicationId(ca){return this.getOsfControl(ca).getManifest().getWebApplicationId()}getWebApplicationResource(ca){return this.getOsfControl(ca).getManifest().getWebApplicationResource()}getDefaultDisplayName(ca){return this.getOsfControl(ca).getManifest().getDefaultDisplayName()}static w7f(){try{const ca=
{};V.a.OFa&&G.OAuthManagerSettings.Y$a&&(ca.UiHostSupportsAuthTokenAddinList=P.EQc);ca.UiHostSupportsAuthToken=G.OAuthManagerSettings.Y$a;return ca}catch(ca){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ca.message)}return null}static getInstance(ca,T,da=null){P.Ka||(P.Ka=new P(ca,da));return P.Ka}static $ri(ca){P.Ka&&P.Ka.removeCallbackForAddin(ca)}static bcb(ca){window.console.warn&&window.console.warn(ca)}static pij(ca,T){if(!ca)return"";T||(T="");
let da=ca.toLowerCase();var fa=T.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(fa)||(P.bcb('SSO App Id "'+T+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));da.endsWith(fa)||(P.bcb('SSO Resource "'+ca+'" does not end with App Id "'+T+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!da.startsWith("https://")&&
!da.startsWith("api://"))return P.bcb('SSO Resource "'+ca+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(T=0;T<ca.length;T++){fa=ca.charAt(T);const ma=D.a.charCodeAt(ca,T);if(33>ma||126<ma||"&"===fa||"?"===fa||"#"===fa||"%"===fa||"\\"===fa)return P.bcb('SSO Resource "'+ca+'" contains an invalid character "'+fa+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+fa+"' in resource URI."),""}if(0<=ca.indexOf("::"))return P.bcb('SSO Resource "'+
ca+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<ca.length)return P.bcb('SSO Resource "'+ca+'" is '+ca.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+ca.length+"."),"";da.startsWith("api://")&&(da="https://"+da.substring(6,da.length));return 8===da.length?"":OfficeExt.WACUtils.getHostSecure(da)||""}static zla(ca,T,da,fa){var ma=ca.startTime;let ea=0;0<ma&&(ea=
P.EF()-ma);ma={["callInstanceId"]:ma.toString(),["callDuration"]:ea.toString(),["errorCode"]:T.toString()};if(fa)for(let ra in fa)ma[ra]=fa[ra];e.ULS.sendTraceTag(51401116,344,50,"{0}",ma);Q.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:O.a.sC(ma)}));ca.callback(T,da)}static EF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(ca){}return Date.now()}}P.EQc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
P.Ka=null;Object(J.a)(P,"AppsForOfficeSingleSignOnManager",null,[922])},979:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.eCa=this.Ilb=this.i8d=this.Kae=this.d7b=this.G1e=null}}Object(J.a)(h,"AppsForOfficeOauthResult",null,[])},980:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=
this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static A_f(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(J.a)(h,"WopiAuthContext",null,[719])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.appforoffice.js.map