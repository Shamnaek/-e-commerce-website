'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1248:function(J,aa,d){d.r(aa);J=d(0);var h=d(14);class e{constructor(jb,Vb){this.POa=null;this.PVb=jb;this.sZh=Vb}init(){this.PVb.continueWith(()=>{this.POa=this.PVb.result;this.POa.xrb(Object(h.a)(this,this.Z0,"onUsersUpdated"))})}Z0(){e.Myf(this.POa.s9a())&&(this.POa.WRe(Object(h.a)(this,this.Z0,"onUsersUpdated")),this.sZh.IsRealCoauthSession=!0)}static Myf(jb){let Vb=null;for(const Tc of jb)if(Tc)if(jb=Tc.isAnonymous||
!Tc.email?Tc.clientId:Tc.email.toUpperCase(),!Vb)Vb=jb;else if(Vb!==jb)return!0;return!1}}Object(J.a)(e,"CoauthTelemetry",null,[1231]);var r=d(387),n=d(1066),v=d(1204),B=d(27),y;(function(jb){jb[jb.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";jb[jb.notImplemented=1]="notImplemented";jb[jb.renderHandled=2]="renderHandled";jb[jb.renderHandledWithVeto=3]="renderHandledWithVeto"})(y||(y={}));Object(J.b)("CoauthorGalleryTelemetryEndResult",y);var x=d(96),A=d(105),E=d(2);class u{constructor(jb,
Vb,Tc,wb,Rb,vc,rd,rc,cb){this.Glf=this.l$e=this.FK=null;this.Fpa=jb;this.xEc=new n.a;this.$a=Tc;this.szd=Vb;this.S6=wb;this.yi=Rb;this.PId=vc;this.KOa=rd;this.oOh=rc;this.Ldf=this.Idf=!1;this.hFc=0;this.i$e=1;this.s2a=cb;this.bYb=this.$a.ka("PeoplesWellExtraButtonInfoIsEnabled");this.Wmb=Object(v.a)(String,B.AFrameworkApplication.gd.Application)||""}get rzh(){return this.xEc.task}init(){E.Task.WAA.call(null,this.KOa,this.szd,this.PId).continueWith(()=>{this.FK=this.KOa.result;this.l$e=this.szd.result;
this.Glf=this.PId.result;E.Task.WAA.call(null,this.szd.result.yCa,this.PId.result.wtd).continueWith(()=>{this.i$e=this.l$e.yCa.result;this.hFc=this.Glf.wtd.result;this.FK.xrb(Object(h.a)(this,this.ehd,"onUsersUpdatedEventListener"));this.FK.s9a().length&&this.Z0()})})}ehd(){this.Z0()}Z0(){this.oOh(this.FK.s9a())?(this.FK.WRe(Object(h.a)(this,this.ehd,"onUsersUpdatedEventListener")),this.Huk(this.Idf)):this.xEc.eK(1);this.Idf=!0}Huk(jb){this.Ldf?this.rzh.continueWith(()=>{r.ULS.sendTraceTag(42062996,
325,15,"We already attempted to log a render of coauthor gallery: {0}",y[this.rzh.result])}):(this.Ldf=!0,this.oMk(0===this.i$e&&!jb))}oMk(jb){jb?this.S6.Uj(4,Object(h.a)(this,this.AIe,"onInteractiveReady")):this.xEc.eK(1)}AIe(){const jb=this.yi.ih("AppInitStatus_interactivityReady");r.ULS.shipAssertTag(42259235,325,!!this.hFc);const Vb=this.hFc-jb,Tc={};Tc.InteractiveTime=jb;Tc.ReactRenderComplete=this.hFc;Tc.HadTabSwitch=this.s2a();Tc.IsModernGallery=this.bYb;r.ULS.sendTraceTag(594883104,325,50,
A.a.toJSON(Tc));this.bYb?(r.ULS.sendTraceTag(42062997,325,15,Vb.toString()),this.xEc.eK(this.pKl(Vb)?3:2)):r.ULS.sendTraceTag(594883103,325,15,Vb.toString())}pKl(jb){const Vb=jb>this.$a.Bc("CoauthorGalleryTimeToRenderDurationMs",1E4),Tc="Word"===this.Wmb;if(this.s2a())return r.ULS.sendTraceTag(50455714,325,50,Vb.toString()),!1;Tc&&x.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Vb&&(Tc&&x.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded",
"CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),r.ULS.sendTraceTag(42062998,325,15,jb.toString()));return Vb}}Object(J.a)(u,"CoauthorGalleryTelemetry",null,[1225]);class K{constructor(jb){this.FK=null;this.exc={};this.GCc={};this.yTb=null;this.KOa=jb}oUc(jb){const Vb=new n.a;this.init().continueWith(()=>{jb in this.exc?Vb.eK(this.exc[jb]):this.GCc[jb]=Vb});return Vb.task}init(){if(this.yTb)return this.yTb.task;this.yTb=new n.a;this.KOa.continueWith(()=>{this.FK=this.KOa.result;this.FK.xrb(Object(h.a)(this,
this.Z0,"onUsersUpdated"));this.vIh();this.yTb.Kg(null)});return this.yTb.task}vIh(){const jb=this.FK.s9a();jb.sort(Object(h.a)(this,this.pxi,"comparePresenceUsers"));this.exc={};for(let Vb=0;Vb<jb.length&&jb[Vb]&&jb[Vb].PFa;Vb++)this.$7h(this.exc,jb[Vb].clientId,Vb)}$7h(jb,Vb,Tc){jb[Vb]=Tc;Vb in this.GCc&&(this.GCc[Vb].eK(Tc),delete this.GCc[Vb])}Z0(){this.vIh()}pxi(jb,Vb){return jb.PFa>Vb.PFa?1:jb.PFa<Vb.PFa?-1:0}}Object(J.a)(K,"CoauthorPositionFinder",null,[1224]);var G=d(1207),O=d(1206),R=d(1205),
V=d(18),D=d(109);class Q{constructor(){this.oia=null;this.OQb=Array(32)}xor(jb){if(!jb)throw Error.argumentNull("Guid argument cannot be null");const Vb=new Q,Tc=new Sys.StringBuilder;for(let wb=0;wb<jb.OQb.length;wb++){const Rb=this.OQb[wb]^jb.OQb[wb];Vb.OQb[wb]=Rb;Tc.append(Rb.toString(16));7!==wb&&11!==wb&&15!==wb&&19!==wb||Tc.append("-")}Vb.oia=D.a.Gf(Tc.toString());return Vb}toString(){return this.oia.toString()}equals(jb){if(!jb)throw Error.argumentNull("Guid argument cannot be null");return this.oia.equals(jb.oia)}static sRc(jb){if(!jb)throw Error.argumentNull("String input cannot be null");
const Vb=new Q;Vb.oia=D.a.Gf(jb);const Tc=Vb.oia.toString();let wb=0;for(let vc=0;vc<Tc.length;vc++){var Rb=jb.charAt(vc);if(Q.DPj(Rb))Rb=Q.vAj(Rb,jb.charCodeAt(vc)),Vb.OQb[wb++]=Rb;else if(!Q.YOj(Rb))throw Error.argument("String contains characters not valid in Guids");}return Vb}static DPj(jb){return"0"<=jb&&"9">=jb||"A"<=jb&&"F">=jb||"a"<=jb&&"f">=jb}static YOj(jb){return"{"===jb||"}"===jb||"-"===jb}static vAj(jb,Vb){if("0"<=jb&&"9">=jb)return Vb-48;if("A"<=jb&&"F">=jb)return Vb-65+10;if("a"<=
jb&&"f">=jb)return Vb-97+10;throw Error.argument("Char is not valid hex digit");}}Object(J.a)(Q,"Guid",null,[]);class Z{constructor(jb,Vb,Tc,wb){this.POa=null;this.baf=this.Jjf=!1;this.Yhf=0;this.PVb=jb;this.rMd=Vb;this.$a=Tc;this.bHd=wb;this.XNh=B.AFrameworkApplication.kmb||B.AFrameworkApplication.PQ;this.Gif=new G.a(O.a.Hn())}get UZd(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.PVb.continueWith(()=>{this.POa=this.PVb.result;
this.POa.xrb(Object(h.a)(this,this.Z0,"onUsersUpdated"))})}Z0(){this.swi(this.POa.s9a())}swi(jb){var Vb=0;const Tc=new R.a(O.a.Hn());for(const wb of jb)if(wb&&wb.isAnonymous){B.AFrameworkApplication.dGa("70eb6120;2gfeb930");if(Tc.Gb(wb.userName))Tc.ga(wb.userName).add(wb.clientId);else{let Rb;Tc.add(wb.userName,(Rb=new V.a,Rb.add(wb.clientId),Rb))}wb.clientId!==this.bHd?(Vb++,2<=Vb&&!this.Jjf&&this.J4j()):!this.baf&&this.UZd&&"Guest"===wb.userName&&(r.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),
this.baf=!0)}if(this.UZd&&this.Yhf!==Vb){r.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",Vb+(this.XNh?1:0));this.Yhf=Vb;for(let wb of Tc.keys)2<=Tc.ga(wb).count&&(jb=this.R9i(Tc.ga(wb)),this.Gif.contains(jb)||(Vb={},Vb.guestsWithSameName=Tc.ga(wb).count,Vb.identifier=jb,r.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",Vb),this.Gif.add(jb)))}}J4j(){r.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.Jjf=!0;this.UZd&&
this.rMd&&this.rMd.continueWith(()=>{window.setTimeout(()=>{this.rMd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}R9i(jb){if(!jb||1>=jb.count)return"";let Vb=Q.sRc(jb.ga(0));for(let Tc=1;Tc<jb.count;Tc++)Vb=Vb.xor(Q.sRc(jb.ga(Tc)));return Vb.toString()}}Object(J.a)(Z,"GuestCoauthTelemetry",null,[]);var P=d(1203);class ca{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(J.a)(ca,"PL",null,[]);var T=d(36);class da{constructor(){this.ct=
this.vt=this.d=0}static $ph(jb,Vb,Tc){const wb=new da;wb.d=jb;wb.vt=Vb;wb.ct=Tc;return T.c(wb)}}Object(J.a)(da,"VD",null,[]);var fa=d(89);class ma{constructor(jb,Vb,Tc,wb,Rb,vc,rd,rc,cb){this.Dj=0;this.Mof=!1;this._id=jb;this.Fpf=Vb;this.It=Tc;this.Ljf=wb;this.TMd=Rb;this.R5a=vc;this.O2a=rd;this.EPh=rc;this.s2a=cb;this.Wmb=Object(v.a)(String,B.AFrameworkApplication.gd.Application)||""}ewd(jb){E.Task.WAA(this.Fpf,this.TMd).continueWith(()=>{if(this.Ljf.result<=this.TMd.result)jb.eK(!1);else{this.Dj=
this.Fpf.result;var Vb=this.It-this.Dj,Tc=new ca;Tc.id=this._id;Tc.et=this.It;Tc.st=this.Dj;Tc.d=this.It-this.Dj;Tc.mp=this.Ljf.result;Tc.tp=this.TMd.result;Tc.ct=this.p6i(this.EPh);Tc.vc=this.s2a();var wb=T.c(Tc),Rb="Word"===this.Wmb;r.ULS.sendTraceTag(42078597,302,15,wb);if(Rb){const vc=new Map;vc.set("data",wb);x.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",vc)}Vb>this.R5a.value&&!this.Mof&&!Tc.vc&&(this.Mof=!0,jb.eK(!0),Tc=Object.assign(new fa.a,{inStaging:!0,
extendedProperties:new Map}),Tc.extendedProperties.set("data",wb),Rb&&x.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Tc),Vb<this.O2a.value&&r.ULS.sendTraceTag(42078598,302,15,da.$ph(Vb,this.R5a.value,this.O2a.value)));jb.task.isCompleted||jb.eK(!1)}})}p6i(jb){switch(jb){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(J.a)(ma,"PresenceLatencyActivityLogger",null,[]);class ea{constructor(jb,Vb,
Tc){this.H9e=this.h$e=this.Twc=this.dxc=this.Rmb=0;this._id=jb;this.R5a=Vb;this.O2a=Tc;this.Wmb=Object(v.a)(String,B.AFrameworkApplication.gd.Application)||""}get rwf(){return this.Rmb}set rwf(jb){this.Rmb=jb;this.nVd()}get cHf(){return this.dxc}set cHf(jb){this.dxc=jb;this.nVd()}get rEf(){return this.Twc}set rEf(jb){this.Twc=jb;this.nVd()}get dHf(){return 0!==this.h$e}get sEf(){return 0!==this.H9e}nVd(){!this.dHf&&this.Rmb&&this.dxc&&(this.h$e=this.ewd(this.dxc,"CoauthGalleryLightupDurationTooLong"));
!this.sEf&&this.Rmb&&this.Twc&&(this.H9e=this.ewd(this.Twc,"CanvasPresenceLightupDurationTooLong"))}ewd(jb,Vb){const Tc=jb-this.Rmb;var wb=new ca;wb.id=this._id;wb.et=jb;wb.st=this.Rmb;wb.d=Tc;var Rb=T.c(wb);jb="Word"===this.Wmb;wb="CanvasPresenceLightupDurationTooLong"===Vb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Vb?r.ULS.sendTraceTag(572289499,302,15,Rb):r.ULS.sendTraceTag(571524118,302,15,Rb);if(jb){var vc=new Map;vc.set("data",Rb);
x.Health.instance.recordKpiUsage(wb,0,"wordcollabrel",vc)}return Tc>this.R5a.value?(vc=Object.assign(new fa.a,{inStaging:!0,extendedProperties:new Map}),vc.extendedProperties.set("data",Rb),Rb=Tc<this.O2a.value,vc.extendedProperties.set("cash",Rb?"true":"false"),jb&&x.Health.instance.recordKpiFailure(wb,Vb,!1,!0,vc),r.ULS.sendTraceTag(572289500,302,15,da.$ph(Tc,this.R5a.value,this.O2a.value)),Rb?2:1):3}}Object(J.a)(ea,"PresenceLightupLatencyLogger",null,[]);var ra=d(288),F=d(282);class na{constructor(jb,
Vb,Tc,wb,Rb,vc,rd,rc=null,cb=null,Wb=null){this.nmf={};this.rzd={};this.$gf=new V.a;this.Cwc=this.zTb=this.FK=this.ODc=null;this.Dpf=this.Cpf=0;this.R5a=new P.a(()=>rc.rQ("PresenceBootLatencyThreshold",1E4));this.O2a=new P.a(()=>rc.rQ("PresenceBootLatencyCutoffThreshold",6E4));this.o4h=new P.a(()=>rc.rQ("PresenceLightupLatencyThreshold",2E3));this.MQh=new P.a(()=>rc.rQ("PresenceLightupLatencyCutoffThreshold",1E4));this.S6=wb;this.vZh=Rb;this.j$e=jb;this.Rnf=Vb;this.KOa=Tc;this.yi=vc;this.bHd=cb;this.s2a=
rd;this.Ndf=Wb;this.a9e=!1;this.init()}vSi(jb,Vb=0){var Tc=new Date;const wb=new n.a;this.init().continueWith(()=>{this.Gxk(jb);this.wSi(wb,jb,Tc,Vb)})}get g0g(){return this.bHd||"{"+B.AFrameworkApplication.userSessionId+"}"}init(){if(this.zTb)return this.zTb.task;this.zTb=new n.a;this.s2a()&&r.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.j$e.continueWith(()=>{const jb=this.j$e.result,Vb=jb.yCa,Tc=jb.Idd;Tc.continueWith(()=>{Vb.continueWith(()=>{this.Ndf&&this.Ndf.addQosPillar("RealTimeCoauth");
this.dsl(Vb.result,Tc.result);this.zTb.Kg(null)})})});this.Rnf.continueWith(()=>{this.ODc=this.Rnf.result;this.ODc.k6a(Object(h.a)(this,this.Ayk,"onRtcConnection"));this.ODc.WBa(Object(h.a)(this,this.ktk,"onCoauthorBootReceived"))});this.KOa.continueWith(()=>{this.FK=this.KOa.result;this.FK.xrb(Object(h.a)(this,this.ehd,"onUsersUpdatedEventListener"));0<this.FK.s9a().length&&this.Z0()});return this.zTb.task}L3f(){this.Cwc||(this.Cwc=new n.a,this.S6.Uj(4,()=>{this.Cwc.eK(this.yi.ih("AppInitStatus_interactivityReady"))}));
return this.Cwc.task}Ayk(jb,Vb){if(!this.a9e&&2===Vb.newState){var Tc=this.L3f();Tc.continueWith(()=>{var wb=Tc.result;wb=Date.now()-wb;const Rb={};Rb.clientId=this.g0g;Rb.bootTime=wb;this.a9e=!0;this.ODc.dga(15,Rb)})}}ktk(jb,Vb){if(15===Vb.type){jb=Date.now();Vb=Vb.Eza;var Tc=Vb.bootTime;this.B8d(Vb.clientId).rwf=jb-Tc}}ehd(){this.Z0()}Z0(){const jb=Date.now();var Vb=this.FK.s9a();const Tc=new V.a;for(const wb of Vb)this.$gf.contains(wb.clientId)||(this.$gf.add(wb.clientId),Tc.add(wb.clientId));
if(0<Tc.count)for(let wb of Tc)Vb=this.B8d(wb),Vb.dHf||(Vb.cHf=jb)}Gxk(jb){jb=this.B8d(jb);jb.sEf||(jb.rEf=Date.now())}B8d(jb){return jb in this.rzd?this.rzd[jb]:this.rzd[jb]=new ea(jb,this.o4h,this.MQh)}dsl(jb,Vb=0){this.Cpf=jb;this.Dpf=Vb?Vb:(new Date).getTime()}wSi(jb,Vb,Tc,wb){Tc=Tc?Tc.getTime():(new Date).getTime();Vb in this.nmf?jb.P1():(wb=new ma(Vb,this.Llj(),Tc,this.oUc(this.g0g),this.oUc(Vb),this.R5a,this.O2a,wb,this.s2a),this.nmf[Vb]=wb,wb.ewd(jb))}Llj(){return 1===this.Cpf?E.Task.gt(this.Dpf):
this.L3f()}oUc(jb){return this.vZh.oUc(jb)}}Object(J.a)(na,"PresenceBootTelemetry",null,[1223]);var ka=d(179),Ua=d(71),za=d(346),ha=d(57),ua=d(291);class Ga{get name(){return"Common.App.CoauthTelemetry"}Zb(jb){jb.register(e,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().oa(()=>new e(ua.a.av(jb.Ja("Common.IPeopleInfoProvider")),B.AFrameworkApplication.Zg));jb.register(u,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().oa(()=>
new u(B.AFrameworkApplication.Ta,ua.a.av(jb.Ja("Common.ICoauthoringTelemeryInfoProvider")),B.AFrameworkApplication.fa,ka.a.get_instance(),za.a.instance,ua.a.av(jb.Ja("Common.IPeoplesWell")),ua.a.av(jb.Ja("Common.IPeopleInfoProvider")),e.Myf,()=>this.VAf()));jb.register(na,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().oa(()=>new na(ua.a.av(jb.Ja("Common.ICoauthoringTelemeryInfoProvider")),ua.a.av(jb.Ja("Common.IRealtimeChannelBasic")),
ua.a.av(jb.Ja("Common.IPeopleInfoProvider")),ka.a.get_instance(),jb.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),za.a.instance,()=>this.VAf(),B.AFrameworkApplication.fa,null,x.Health.instance));jb.register(K,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().oa(()=>new K(ua.a.av(jb.Ja("Common.IPeopleInfoProvider"))));jb.register(Z,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().oa(()=>new Z(ua.a.av(jb.Ja("Common.IPeopleInfoProvider")),
ua.a.av(jb.Ja("Common.ISystemInitiatedFeedback")),B.AFrameworkApplication.fa,"{"+B.AFrameworkApplication.userSessionId+"}"))}init(){B.AFrameworkApplication.fa.ff(()=>{ha.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();ha.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();B.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&ha.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();B.AFrameworkApplication.fa.ka("CashTelemetryIsEnabled")&&
(ha.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),ha.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}VAf(){return F.a.mQa&&za.a.instance.hp(ra.a.dvc)?0<za.a.instance.ih(ra.a.dvc)[ra.a.iwd]:!1}static main(){Ua.a.instance.Dc(new Ga)}}Object(J.a)(Ga,"CoauthTelemetryPackage",null,[2,3]);var sa=d(265),Ba=d(1209),pa=d(240),ia=d(471);class Da{constructor(jb,Vb,Tc,wb,Rb){this.Jc=jb;this._clientId=Vb;this.nRh=Rb;this.nTh=Tc||(()=>null);this.oTh=
wb||(()=>null)}get id(){return this.Jc.id}get ZFc(){return this.Jc.ZFc}get cGc(){return this.Jc.cGc}get bGc(){return this.Jc.bGc}get aGc(){return this.Jc.aGc}get $Fc(){return this.Jc.$Fc}get eGc(){return this.Jc.eGc}get zOd(){return this.Jc.zOd}get lNb(){return this.Jc.lNb}get Brd(){return this.Jc.Brd}get Ydd(){return this.Jc.Ydd}get clientId(){return this._clientId}get Lta(){return this.nTh}get T3(){return this.oTh}get DOi(){return this.nRh}static createInstance(jb,Vb,Tc,wb,Rb=!1){return new Da(jb,
Vb,Tc,wb,Rb)}}Object(J.a)(Da,"PeoplesWellSettings",null,[]);var Xa=d(28);class Ka{constructor(jb){this.xj=jb}get yCa(){return this.xj.yCa}get Idd(){return this.xj.Idd}}Object(J.a)(Ka,"CoauthoringTelemetryInfoProvider",null,[531]);var Ma=d(669),Oa=d(78),qa=d(118),Ya=d(785),Fb=d(578);class hc{constructor(jb,Vb,Tc,wb,Rb){this.cGb=new Oa.a;this.xz=null;this.xj=jb;this.Zeb=Tc;this.mJ=wb;this.mJ.PPd(Object(h.a)(this,this.pfd,"onEditorTableUpdate"));this.x9j=B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
this.MAe=Rb;Vb&&Vb.execute(vc=>{this.xz=vc})}dispose(){this.cGb&&(qa.a.Knd([this.cGb]),this.cGb=null);this.mJ.cjh(Object(h.a)(this,this.pfd,"onEditorTableUpdate"))}xrb(jb){this.cGb.addHandler("UsersUpdatedEvent",jb)}WRe(jb){this.cGb.removeHandler("UsersUpdatedEvent",jb)}s9a(){return this.j_f(!1)}o4i(){return this.j_f(!0)}j_f(jb){const Vb=[];this.xj.Wlb(this.xj.bD).returnValue||Xa.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.xj.bD);var Tc=
null;this.xz&&(Tc=this.xz.HRc());const wb=this.MAe.e2f();let Rb=!1;for(const vc of this.xj.i_)jb&&hc.fIc(wb,vc.EmailAddress)?Rb=!0:Array.add(Vb,this.ZGi(vc,Tc));Tc={};Tc.fExcludeCurrent=jb;Tc.fCurrentExcluded=Rb;Tc.CurrentID=this.xj.bD;Tc.EditorCount=this.xj.i_.length;Tc.IsRtcNull=!this.xz;Tc.UserCount=Vb.length;Xa.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",T.c(Tc));return Vb}ZGi(jb,Vb){const Tc=this.Zeb.Kta(new Ma.a(jb.EmailAddress,void 0,jb.Name),jb.ColorIndex,jb.ID,1),wb=new Ya.a;
wb.f0a(0);let Rb=0,vc=!1,rd=!1;if(Vb&&jb.ID in Vb){wb.f0a(1);if(this.x9j){const rc=Vb[jb.ID];rc&&rc.capabilities&4&&wb.f0a(4);vc=!0;rc&&(Rb=rc.capabilities,rd=rc.isAnonymous)}delete Vb[jb.ID]}Xa.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",jb.ID,Tc,wb.yda(1),wb.yda(4),this.xj.bD,
!jb.EmailAddress,Rb,vc,rd);return new Fb.a(jb.ID,jb.Name,Tc,wb,null,jb.EmailAddress,void 0,void 0,rd,void 0,void 0,jb.JoinCoauthTime)}pfd(){Xa.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.cGb.raiseEvent("UsersUpdatedEvent",this)}static fIc(jb,Vb){return!!jb&&!!Vb&&jb.toLowerCase()===Vb.toLowerCase()}}Object(J.a)(hc,"PeopleInfoProvider",null,[1208]);var ec=d(82),Tb=d(205),vb=d(131),zb=d(315),Xb=d(273);class Za extends Tb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(J.a)(Za,"PeopleButtonProps",Tb.a,[]);var Va=d(770),tc=d(47),Kb=d(68);class Pa{constructor(jb){this.hvc=new Kb.a;this.SZd=null;this.clientId=jb}wgl(jb){this.LXk();this.Yal(jb);for(const Vb of jb)Vb.clientId!==this.clientId&&this.Buf(Vb)}get Ovd(){const jb=[];for(let Vb of this.hvc.values){const Tc=this.qph(Vb);Array.add(jb,Tc)}return jb}get Wwa(){return this.hvc.count}IPd(jb,Vb){jb=jb.toUpperCase();
let Tc;({value:Tc}=this.hvc.Tf(jb)).returnValue||(Tc=[],this.hvc.$(jb,Tc));Array.add(Tc,Vb)}LXk(){this.hvc=new Kb.a}Yal(jb){for(const Vb of jb)if(Vb.clientId===this.clientId){this.SZd=Vb;break}}}Object(J.a)(Pa,"UserTracker",null,[1692]);class mb extends Pa{constructor(jb,Vb){super(jb);this.pTh=Vb}Buf(jb){jb.isAnonymous||!jb.email?this.IPd(jb.clientId,jb):this.SZd&&O.a.Hn().equals(this.SZd.email,jb.email)||this.IPd(jb.email,jb)}qph(jb){let Vb=new Date(0),Tc=0<jb.length?jb[0]:null;for(const wb of jb)(jb=
this.pTh(wb.clientId))&&Vb.getTime()<jb.VAb.getTime()&&(Vb=jb.VAb,Tc=wb);return Tc}}Object(J.a)(mb,"UniqueUserTracker",Pa,[]);class qc extends Pa{constructor(jb){super(jb)}Buf(jb){this.IPd(jb.clientId,jb)}qph(jb){return jb[0]}}Object(J.a)(qc,"UserInstanceTracker",Pa,[]);const oc=(jb,Vb,Tc)=>Tc?new mb(jb,Vb):new qc(jb);var ib=d(73),$a=d(673),Db=d(37);class Mb{constructor(jb,Vb=null,Tc=null){this.FK=null;this.XMd=new n.a;this.Jc=jb;this.hid=Vb;Tc&&Tc.continueWith(()=>{this.FK=Tc.result;this.FK.xrb(Object(h.a)(this,
this.Z0,"onUsersUpdated"));this.rld()});new Fb.a(this.settings.clientId,"Anonymous user","#cccccc",new Ya.a(7));this.SZc=this.aFd=!0;this.DCd=this.OId=!1;this.V1=oc(this.settings.clientId,this.settings.T3,jb.DOi)}get settings(){return this.Jc}get mMj(){return B.AFrameworkApplication.fa?B.AFrameworkApplication.fa.ka("ColorPresenceHashIsEnabled"):!1}get Vhg(){return B.AFrameworkApplication.fa?B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"):!1}J7i(){let jb;let Vb,Tc,wb,Rb;var vc=
this.K7i();this.V1.Wwa?1===this.V1.Wwa?(Vb=!0,Tc=this.settings.lNb.cluster,wb=this.settings.lNb.BMc,Rb=this.V1.Ovd[0].color):(Vb=!0,Tc=this.settings.Ydd.cluster,wb=this.settings.Ydd.BMc,Rb=""):(Vb=!1,Rb=wb=Tc="");jb=vc[0];vc=vc.slice(1);return{ZBk:jb,$Bk:vc,VBk:Vb,kPl:Tc,XBk:wb,WBk:Rb}}K7i(){if(2<=this.V1.Wwa)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.V1.Wwa)];if(1===this.V1.Wwa){const jb=this.V1.Ovd[0],Vb=this.settings.T3(jb.clientId);return Vb&&2===
Vb.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,jb.userName]:[jb.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,jb.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}Voj(jb){return this.Woj(jb)}MDf(jb,Vb,Tc){return Vb?this.vqi(Vb)?(jb=this.settings.T3(jb))&&2===jb.status?!1:!0:(Tc&&r.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(Tc&&r.ULS.sendTraceTag(4482393,
325,50,"User does not have any presence data"),!1)}Qlj(jb){return jb.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}Woj(jb){if(!jb.capabilities.yda(1))return this.Qlj(jb);const Vb=jb.isReadOnly,Tc=this.settings.T3(jb.clientId);jb=this.settings.Lta(jb.clientId);if(!Tc)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(Tc.status){case 1:return jb?Vb?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.aCi(jb)||
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}Fbj(jb){if(this.hid.a1c)return this.hid.rub(jb.email,"O365",B.AFrameworkApplication.hh,0)}Koj(jb){jb=this.settings.T3(jb.clientId);return!jb||jb&&1===jb.status?!0:!1}Loj(jb){var Vb=String.format("buttonPeoplesWellUser-{0}",jb.clientId),Tc=jb.clientId,wb=this.Voj(jb);
const Rb=jb.userName,vc=jb.color;var rd=Object,rc=rd.assign,cb=new Za,Wb=this.settings.eGc.toString(),Uc=this.settings.Brd.cluster,Ib=this.settings.Brd.BMc,Vc=this.R1f(),gc=jb.isAnonymous,rb;if(rb=[Rb],rb.length){var Zb=new Sys.StringBuilder("STRARRY@");for(const Hc of rb)Zb.append(Hc?Hc.length:0),Zb.append(","),Zb.append(Hc),Zb.append(",");rb=Zb.toString().slice(0,-1)}else rb=null;Vb=rc.call(rd,cb,{Id:Vb,Command:Wb,LabelText:"{0}",Image32by32:Uc,Image32by32Class:Ib,MenuItemId:Tc,CommandValueId:Tc,
Alt:Rb,DisplayMode:Vc,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:wb,ImageBackColor:vc,IsAnonymous:gc,LabelTextUserGeneratedPlaceholderReplacements:rb,Upn:jb.email});B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&this.hid&&(Tc=this.Fbj(jb),wb=this.Koj(jb),Vb.ImageUrl=Tc,Vb.ActiveStatus=wb,Vb.JoinTimeInMS=jb.PFa,jb=this.MDf(jb.clientId,this.settings.Lta(jb.clientId),!1),Vb.CanJump=jb,""===Tc&&r.ULS.sendTraceTag(40969413,
302,50,"ImageURL collection failed"));return Vb}Paj(){return Object.assign(new Tb.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}R1f(){return this.mMj?"Initials":"Menu32"}Moj(jb){const Vb=[];for(const Tc of jb)jb=this.Loj(Tc),Array.add(Vb,jb);return Vb}Gje(){return 0<this.V1.Wwa}uOk(jb){if(!this.aFd)return!0;this.SZc||(jb[$a.a.Visible]=!0);let Vb,Tc,wb,Rb,vc;({ZBk:Vb,
$Bk:Tc,VBk:wb,XBk:Rb,WBk:vc}=this.J7i());jb[$a.a.LabelText]=Vb;Tc&&Tc.length&&(jb[$a.a.LabelTextUserGeneratedPlaceholderReplacements]=Tc);jb[$a.a.ImageIsVisible]=wb;jb[$a.a.Image16by16Class]=Rb;jb[$a.a.ImageBackColor]=vc;this.aFd=!1;return!0}gHk(jb){if(0>=this.V1.Wwa)return!1;var Vb=this.pql(this.V1.Ovd),Tc=this.Moj(Vb);Vb=Object.assign(new zb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});Tc=Object.assign(new Xb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.R1f(),
ControlList:Tc});B.AFrameworkApplication.fa.ka("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.hid&&(Tc.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,Tc.TitleId="menuCoauthorsTitle",Tc.Theme="Light");Array.add(Vb.MenuSectionList,Tc);B.AFrameworkApplication.fa.ka("DocChatIsEnabled")&&B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.Po&&(Tc=[],Array.add(Tc,this.Paj()),Tc=Object.assign(new Xb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",
ControlList:Tc}),Array.add(Vb.MenuSectionList,Tc));B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.Po?jb.MenuItems=Vb:jb.PopulationXML=vb.l(Vb);return!0}SIl(jb){r.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");jb=jb.MenuItemId;if(!jb)return!1;const Vb=this.settings.Lta(jb);if(!this.MDf(jb,Vb,!0))return!1;this.vZj(jb,Vb);return!0}sUk(){const jb=this.r4i();this.V1.wgl(jb);this.SZc&&1<=this.V1.Wwa&&(r.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),
this.SZc=!1);this.aFd=!0}Z0(){this.DCd||(window.setTimeout(()=>{this.rld();this.DCd=!1},3E3),this.DCd=!0)}r4i(){let jb;jb=this.p4i()||[];for(const Vb of jb)this.H6k(Vb);return jb}H6k(jb){jb.clientId||(jb.clientId=D.a.create().toString());jb.userName||(jb.userName="Anonymous user");jb.capabilities||(jb.capabilities=new Ya.a);jb.color||(jb.color="#cccccc");jb.PFa||(jb.PFa=0)}pql(jb){const Vb=[];Array.addRange(Vb,jb);Vb.sort(Mb.KBk);return Vb}yWk(){B.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&
!this.OId&&(B.AFrameworkApplication.Ta.hT(Db.a.gHf)&&Va.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||B.AFrameworkApplication.Ta.ra(Db.a.gHf,ib.a.frame,Object(h.a)(this,this.ltk,"onCoauthorGalleryFirstRender"),96));this.zWk();this.OId=!0;this.rld()}ltk(jb,Vb,Tc,wb,Rb){this.XMd.eK(Rb.RenderTime);return 32}get wtd(){return this.XMd.task}rld(){if(!this.OId&&(this.XMd.eK((new Date).getTime()),r.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),
this.Vhg))return;this.sUk();this.Vhg&&this.SZc?B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||ia.a.caa("ribbon","coauthorGallery"):(B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(ia.a.daa("ribbon","coauthorGallery"),ia.a.baa("ribbon","coauthorGallery")),this.tUk())}dispose(){this.FK&&(this.FK.WRe(Object(h.a)(this,
this.Z0,"onUsersUpdated")),this.FK=null)}static KBk(jb,Vb){return jb.capabilities.yda(1)&&Vb.capabilities.yda(1)||!jb.capabilities.yda(1)&&!Vb.capabilities.yda(1)?tc.a.localeCompare(jb.userName,Vb.userName):jb.capabilities.yda(1)?-1:1}}Object(J.a)(Mb,"APeoplesWell",null,[1577,106]);var ob=d(41);class jc extends Mb{constructor(jb,Vb,Tc=null,wb=null){super(jb,Tc,wb);this.oAa=()=>!0;this.Ca=Vb}wOk(jb){return this.uOk(jb)}iHk(jb){return this.gHk(jb)}UIl(jb){return this.SIl(jb)}zQ(jb,Vb,Tc,wb,Rb,vc){jb=
!1;switch(Tc){case 1:jb=Rb(wb);break;case 2:jb=vc(wb)}return jc.Hji(jb)}LMj(jb,Vb,Tc,wb,Rb){return this.zQ(jb,Vb,Tc,Rb,()=>this.Gje(),this.oAa)}vOk(jb,Vb,Tc,wb,Rb){return this.zQ(jb,Vb,Tc,Rb,Object(h.a)(this,this.wOk,"queryUsersProxy"),this.oAa)}hHk(jb,Vb,Tc,wb,Rb){return this.zQ(jb,Vb,Tc,Rb,this.oAa,Object(h.a)(this,this.iHk,"populateFlyoutContentsProxy"))}Mwi(jb,Vb,Tc,wb,Rb){return this.zQ(jb,Vb,Tc,Rb,this.oAa,this.oAa)}Lwi(jb,Vb,Tc,wb,Rb){return this.zQ(jb,Vb,Tc,Rb,this.oAa,this.oAa)}TIl(jb,Vb,
Tc,wb,Rb){return this.zQ(jb,Vb,Tc,Rb,this.oAa,Object(h.a)(this,this.UIl,"userButtonClickProxy"))}GFk(jb,Vb,Tc,wb,Rb){return this.zQ(jb,Vb,Tc,Rb,this.oAa,()=>{this.rld();return!0})}zWk(){this.Ca.ya(this.settings.ZFc,ob.a.application,Object(h.a)(this,this.LMj,"isControlEnabledHandler"));this.Ca.ra(this.settings.cGc,ob.a.application,Object(h.a)(this,this.vOk,"queryUsersHandler"),96);this.Ca.ra(this.settings.aGc,ob.a.application,Object(h.a)(this,this.Mwi,"commandMenuOpenHandler"),96);this.Ca.ra(this.settings.$Fc,
ob.a.application,Object(h.a)(this,this.Lwi,"commandMenuCloseHandler"),96);this.Ca.ra(this.settings.bGc,ob.a.application,Object(h.a)(this,this.hHk,"populateFlyoutContentsHandler"),96);this.Ca.ya(this.settings.eGc,ob.a.application,Object(h.a)(this,this.TIl,"userButtonClickHandler"));this.Ca.ra(this.settings.zOd,ob.a.application,Object(h.a)(this,this.GFk,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static Hji(jb){return jb?32:8}}Object(J.a)(jc,"ABox4PeoplesWell",Mb,[]);var Gb=d(738);
class Gc extends Sys.EventArgs{constructor(jb){super();this.controlId=jb}}Object(J.a)(Gc,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);class bc extends jc{constructor(jb,Vb,Tc,wb,Rb,vc,rd,rc,cb,Wb,Uc,Ib,Vc,gc,rb,Zb,Hc,Ab){super(jb,Vb,Zb,Ab?E.Task.gt(Ab):null);this.xz=null;this.$ve=!1;if(!Rb)throw Error.argumentNull("coauthStateGetter");if(!vc)throw Error.argumentNull("appFrame");if(!rd)throw Error.argumentNull("taskManager");this.xj=Rb;this.Rb=vc;this.zb=rd;wb&&wb.execute(ad=>{this.xz=ad});
Tc&&Tc.execute(ad=>{ad.rbi(Object(h.a)(this,this.vKk,"presenceChanged"))});this.oc=rc;this.Ge=cb;this.je=Wb;this.Iec=Vc;this.x7j=Uc;this.Zeb=Ib;this.nCb=gc;this.nU=rb;this.MAe=Hc;this.sJg=Ab;this.wtd.continueWith(()=>{this.nU.sTi(this.wtd.result)})}vZj(jb,Vb){let Tc=null;({data:Tc}=this.T3e(Vb)).returnValue&&Tc&&Tc.fk&&(Xa.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",jb,Tc.fk,this.xj.bD),(jb=this.oc.pka(Tc.fk))?(this.Ge.lpd(),this.Ge.IJ(jb.me)):
Xa.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",Tc.fk))}T3e(jb){let Vb;Vb=null;if(!jb)throw Xa.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.xj.bD),Error.argumentNull("presence");return jb?(Vb=Gb.a.ZLc(jb.data))?{returnValue:!0,data:Vb}:{returnValue:!1,data:Vb}:{returnValue:!1,data:Vb}}vqi(jb){let Vb=null;return({data:Vb}=this.T3e(jb)).returnValue&&Vb&&Vb.fk?!0:!1}p4i(){if(this.sJg)return this.sJg.o4i();
Xa.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const jb=this.q4i();0<jb.length&&Xa.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",jb.length);return jb}q4i(){const jb=[],Vb=this.MAe.e2f();this.xj.Wlb(this.xj.bD).returnValue||Xa.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.xj.bD);let Tc=null;this.xz&&(Tc=this.xz.HRc());var wb=B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
for(var Rb of this.xj.i_){var vc=this.Zeb.Kta(new Ma.a(Rb.EmailAddress,void 0,Rb.Name),Rb.ColorIndex,Rb.ID,1),rd=new Ya.a;rd.f0a(0);let rc=0,cb=!1;if(bc.eYj(Rb.ID,Tc)){rd.f0a(1);if(wb){let Wb=Tc[Rb.ID];Wb&&(rc=Wb.capabilities);cb=!0;Wb&&Wb.capabilities&4&&rd.f0a(4)}delete Tc[Rb.ID]}bc.fIc(Vb,Rb.EmailAddress)||(Array.add(jb,new Fb.a(Rb.ID,Rb.Name,vc,rd,null,Rb.EmailAddress)),Xa.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
Rb.ID,vc,rd.yda(1),rd.yda(4),this.xj.bD,!Rb.EmailAddress,rc,cb))}if(!wb&&this.Iec&&Tc)for(let rc in Tc)wb=Tc[rc],!bc.fIc(Vb,wb.email)&&wb&&wb.userName&&(Rb=new Ya.a,Rb.f0a(1),wb.capabilities&4&&Rb.f0a(4),vc=this.nCb.m7d(wb.email)||wb.email,rd=this.Zeb.Kta(new Ma.a(vc,void 0,wb.userName),null,wb.clientId,1),Array.add(jb,new Fb.a(wb.clientId,wb.userName,rd,Rb,null,vc)),Xa.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
wb.clientId,rd,Rb.yda(1),Rb.yda(4),this.xz.clientId,!wb.email,wb.capabilities));return jb}aCi(jb){let Vb=null,Tc=" ";({data:Vb}=this.T3e(jb)).returnValue&&Vb&&Vb.fk&&(jb=this.oc.pka(Vb.fk))&&(Tc=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,jb.me+1));return Tc}vKk(){this.Rb.Ut.qFa?this.$ve||(this.zb.Db(new ec.a(2,1,0,Object(h.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.$ve=!0):this.Ca.processAction(Db.a.r7a,2)}tUk(){this.je.xQk(new Gc(this.settings.id,
!0));const jb=1<this.V1.Wwa||1===this.V1.Wwa&&this.V1.Ovd[0].clientId!==this.settings.clientId;this.x7j.execute(Vb=>{jb&&this.nU&&this.nU.W4j();Vb.uPb()});jb&&this.nU.$h(14,Date.now())}handlePendingRefresh(){this.$ve=!1;this.Ca.processAction(Db.a.r7a,2)}dispose(){super.dispose()}static eYj(jb,Vb){return Vb&&jb in Vb?!0:!1}static fIc(jb,Vb){return!!jb&&!!Vb&&jb.toLowerCase()===Vb.toLowerCase()}}Object(J.a)(bc,"PowerPointPeoplesWell",jc,[]);class dc{constructor(jb){this.Ugc=null;jb.execute(Vb=>{this.Ugc=
Vb})}Lta(jb){return this.Ugc?this.Ugc.Lta(jb):null}T3(jb){return this.Ugc?this.Ugc.T3(jb):null}}Object(J.a)(dc,"PresenceUserInfoGetterProxy",null,[1196]);var Nb=d(35);class Ac{constructor(){this.Y4=this.mJ=this.nh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}Zb(jb){Ac.Lcc=Date.now();this.K=jb;this.Y4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.Y4.mEa(6,this.name);this.K.register(1196,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().oa(()=>new dc(this.K.Ja("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(531,"Common.ICoauthoringTelemeryInfoProvider").ma().oa(()=>new Ka(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(hc,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().oa(()=>new hc(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.Ja("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(Nb.a("PeoplesBaseUlrConfiguredForPods")&&(jb=this.K.resolve("Common.App.People.IExternalPeopleAPI"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").vg)){const Vb=this.K.resolve("Common.IAppSettingsManager").Ga("368");jb.h9g(Vb+"p")}Xa.a.J(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){if(B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("UnifiedScriptLoaderForDSEnabled"))this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.presence1",
null,()=>d.e(4).then(d.bind(null,1247)));else{const jb=Ba.a.create("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1247)));pa.a.fy(jb)}this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");this.K.resolve("Common.IPeopleInfoProvider");B.AFrameworkApplication.QA.TDa?(this.mJ=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),ia.a.caa("ribbon","coauthorGallery"),this.mJ.OPd(Object(h.a)(this,this.jfg,"initializePeoplesWellHandler"))):this.ifg()}jfg(){try{B.AFrameworkApplication.QA.TDa||
(this.ifg(),this.mJ.zRe(Object(h.a)(this,this.jfg,"initializePeoplesWellHandler")))}catch(jb){Xa.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",jb)}}ifg(){const jb=this.nh.Bu("peoplewell");this.uGj(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);
this.nh.Gu(jb)}uGj(jb,Vb,Tc,wb,Rb,vc){var rd=this.K.resolve("PowerpointPresence.IPresencePerfLogger");rd.$h(10,Ac.Lcc);rd.$h(9,Ac.fhc);rd.$h(11,(new Date).getTime());rd=Date.now();const rc=sa.CuiHelper.Agj(B.AFrameworkApplication.qm,B.AFrameworkApplication.qm,B.AFrameworkApplication.qm);jb=Da.createInstance(rc,vc,Object(h.a)(jb,jb.Lta,"getUserPresence"),Object(h.a)(jb,jb.T3,"getUserStatusInfo"),!0);(vc=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||Xa.a.J(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
Xa.a.J(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const cb=new bc(jb,Vb,this.K.Ja("PowerpointPresence.IPresenceManager"),this.K.Ja("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),Tc,wb,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ja("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),
Rb.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),vc);cb.yWk();this.K.register(bc,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().oa(()=>cb);this.K.resolve("Common.IPeoplesWell");this.K.Ja("Box4.IBox4BridgeCommandUi").execute(Wb=>{Wb.uPb()});Xa.a.J(8958615,
814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-rd);this.K.resolve("PowerpointPresence.IPresencePerfLogger").xTi()}dispose(){}static main(){Ac.fhc=Date.now();if(B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")){const jb=new Ac;jb.Zb(ha.a.instance);jb.init()}else Ua.a.instance.Dc(new Ac)}}Ac.fhc=0;Ac.Lcc=0;Object(J.a)(Ac,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");Ga.main();Type.registerNamespace("RealtimePresenceUI");Ac.main()},738:function(J,aa,d){J=d(0);var h=d(63);class e{constructor(n,v,B){this.slideId=n;this.shapes=v;this.sn=B}}Object(J.a)(e,"SerializablePresenceData",null,[]);d.d(aa,"a",function(){return r});class r{constructor(n,
v,B=0){if(!r.isValid(n))throw Error.create("Invalid Presence Data");this.xB=n;this.Rad=v;this.ITg=B?B:++r.YJi}get fk(){return this.xB}get UU(){return this.Rad}toString(){return this.xB.toString()+" : "+(this.UU&&this.UU.length?this.UU[0].toString():"")+" : "+this.ITg}x$d(){return new e(this.xB.Avc,this.Rad,this.ITg)}static isValid(n){return!!n}static ZLc(n){return new r(new h.a(n.slideId),n.shapes,n.sn)}}r.YJi=0;Object(J.a)(r,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.presence.js.map