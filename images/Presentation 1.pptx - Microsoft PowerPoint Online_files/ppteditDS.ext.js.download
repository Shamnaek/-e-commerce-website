/*
 @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1005:function(J,aa,d){d.r(aa);J=d(0);var h=d(78),e=d(47),r=d(93),n=d(67),v=d(27),B=d(1203),y=d(14),x=d(18),A=d(87),E=d(347),u=d(28),K=d(35);class G{constructor(Ya){this.ApiType=0;this.ApiType=Ya}}Object(J.a)(G,"SlideshowApiMessage",null,[]);class O extends G{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(J.a)(O,"DockSlideshowViewMessage",G,[]);class R extends G{constructor(){super(6);
this.AnimStep=this.SlideIndex=0}}Object(J.a)(R,"GoToSlideApiMessage",G,[]);class V extends G{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(J.a)(V,"GoToSlideWithTimeLinesApiMessage",G,[]);class D extends G{constructor(){super(19);this.Color=this.Item=null}}Object(J.a)(D,"InkManagerMessage",G,[]);class Q{constructor(Ya){this.vH=Ya.origin;this.ZUg=Ya.source;this.lva=Ya.data}}Object(J.a)(Q,"MessageEvent",null,[]);var Z=d(946),P=d(944),ca=d(947),T=d(948);class da extends Sys.EventArgs{constructor(Ya){super();
this.xac=Ya.IsStartTranscription;this.Vv=Ya.SubtitlesPosition}}Object(J.a)(da,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class fa extends Sys.EventArgs{constructor(Ya){super();this.Mx=Ya.SessionTelemetry}}Object(J.a)(fa,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var ma=d(951),ea=d(952),ra=d(949);class F extends Sys.EventArgs{constructor(Ya,Fb){super();this.xKj=Ya;this.category=Fb.Category;this.code=Fb.Code;this.message=Fb.Message;this.Zy=Fb.ExtraInfo;this.correlationId=
Fb.CorrelationId;this.sessionId=Fb.SessionId}}Object(J.a)(F,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var na=d(945);class ka extends Sys.EventArgs{constructor(Ya){super();this.isFinal=Ya.IsFinal;this.IDh=Ya.Transcripts}}Object(J.a)(ka,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Ua=d(953),za=d(950);class ha extends Sys.EventArgs{constructor(Ya){super();this.errorName=Ya.ErrorName;this.vetoName=Ya.VetoName;this.isIntentional=Ya.IsIntentional;this.isInternal=Ya.IsInternal;this.alertOnPillar=
Ya.AlertOnPillar;this.isSessionEndingError=Ya.IsSessionEndingError;this.durationMs=Ya.DurationMs}}Object(J.a)(ha,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class ua extends G{constructor(){super(11);this.StartSlideShowTime=0}}Object(J.a)(ua,"RecordStartedSlideShowTimestampApiMessage",G,[]);class Ga extends G{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(J.a)(Ga,"RefreshPodSessionApiMessage",G,[]);class sa extends G{constructor(){super(21);this.IsMute=!1}}Object(J.a)(sa,"SetMicrophoneStateMessage",
G,[]);class Ba extends G{constructor(){super(12);this.OsfLocalStorageData=null}}Object(J.a)(Ba,"SetOsfLocalStorageApiMessage",G,[]);class pa{constructor(){this.xac=this.Gkg=!1;this.Vv=null}}Object(J.a)(pa,"SlideShowViewDockingState",null,[]);var ia=d(1008);class Da extends G{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=
null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(J.a)(Da,"StartSlideShowApiMessage",G,[]);class Xa extends G{constructor(){super(13);this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(J.a)(Xa,"ToggleTranscriberLiveBroadcastModeMessage",
G,[]);class Ka extends G{constructor(){super(18);this.HideUI=!1}}Object(J.a)(Ka,"ToggleTranscriberUIVisibilityMessage",G,[]);class Ma extends G{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(J.a)(Ma,"TranscribeApiMessage",G,[]);var Oa=d(72);d.d(aa,"SlideshowFrame",function(){return qa});class qa{constructor(Ya,Fb,hc,ec,Tb,vb,zb,Xb){this.kb=this.pXa=
this.oXa=this.uva=null;this.va=new h.a;this.JGa=null;this.ACe=this.cVg=!1;this.kf=Fb;this.la=hc;this.Hc=ec;this.Ub=Tb;this.lO=vb;this.Ll=zb;this.kCb=Xb;this.fck=new B.a(Object(y.a)(Ya,Ya.Aki,"browserSupportsRenderingSVGInWebGL"))}init(Ya,Fb,hc){if(!this.kb){this.uva=document.getElementById("HiddenFocusTrapAnchor");this.kb=document.createElement("iframe");this.kb.id="SlideShowHostFrame";this.kb.className="SlideShowHostFrame";this.kb.style.display=Oa.a.Ff;this.kb.setAttribute("allow","microphone; autoplay");
this.JGa=new pa;hc=this.la.isHermesSlideShowPreloadEnabled?String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Ne(ResourceStrings.l_EndOfSlideShowMessage),e.a.Ne(hc),e.a.Ne(Fb)):"";hc+=String.format(hc?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Ne(this.la.hostSupportsSessionRefreshEnabled.toString()));hc+=String.format(hc?"&InkingEnabled={0}":"InkingEnabled={0}",e.a.Ne(this.la.isInkingInSlideShowEnabled.toString()));hc+=String.format(hc?
"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",e.a.Ne(this.la.KYj.toString()));hc+=String.format(hc?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Ne(this.la.Pab.toString()));hc+=String.format(hc?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Ne(this.la.CAb.toString()));hc+=String.format(hc?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Ne(this.la.Yie.toString()));hc+=String.format(hc?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",
e.a.Ne(this.la.x$b.toString()));hc+=String.format("&ImageCachingEnabled={0}",e.a.Ne(this.la.ypl.toString()));hc+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Ne(this.la.yGk.toString()));hc+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Ne(this.la.podsLoadSlideShowFrameFromCdn.toString()));hc+=String.format("&PodsBase={0}",e.a.Ne(this.la.podsWebServiceBase));var ec=this.la.Mfa;this.la.aVa&&(ec=new E.a(ec),ec.cvc=this.la.aVa,ec.erc=this.la.Fth,ec.drc=this.la.Eth,ec=ec.toString());
var Tb=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Wa(this.la.podsBaseSlideShowFramePath);this.kb.src=Tb?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.kb.src=String.format(this.kb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",Ya,e.a.Ne(Fb),e.a.Ne(this.la.pptEditorSlideShowWrsEndpoint),A.a.Olc,ec);u.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",Tb,this.la.pla));if(this.la.pla||this.la.Jac)this.kb.src=String.format(this.kb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",
e.a.Ne(this.la.pptEditorTranscriberJsUri),e.a.Ne(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Ne(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Ne(this.la.pptEditorSpeechHandlerBaseUri)),this.kb.src=String.format(this.kb.src+"&SpeechResponseMessageJS={0}",e.a.Ne(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.rg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&(this.kb.src=String.format(this.kb.src+"&QualityStatusMessageJS={0}",
e.a.Ne(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),this.la.Jac&&e.a.rg(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.kb.src=String.format(this.kb.src+"&RehearsalResultMessageJS={0}",e.a.Ne(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.rg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&(this.kb.src=String.format(this.kb.src+"&AgentCommandMessageJS={0}",
e.a.Ne(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));this.la.powerPointLiveBroadcastEnabled&&(this.kb.src+="&wdLiveBroadcast=true");this.kb.src=String.format(this.kb.src+"#{0}",hc);K.a("PresenterCoachTabFix")&&this.uva?this.kf.insertBefore(this.kb,this.uva):this.kf.appendChild(this.kb);r.a.addHandler(window,n.a.message,Object(y.a)(this,this.Gzk,"onSlideshowMessage"));this.Hc.Fvb&&this.la.fjd&&this.T1j();K.a("PresenterCoachTabFix")&&(this.oXa=document.getElementById("legacySlideshowBeginningFocusTrap"),
this.pXa=document.getElementById("legacySlideshowEndFocusTrap"),this.oXa||this.pXa||(this.oXa=document.createElement("div"),this.oXa.id="legacySlideshowBeginningFocusTrap",this.oXa.className="FocusTrap",this.oXa.tabIndex=0,r.a.addHandler(this.oXa,n.a.focus,Object(y.a)(this,this.Xkc,"onSlideShowContainerDivFocusHandler")),this.pXa=document.createElement("div"),this.pXa.id="legacySlideshowEndFocusTrap",this.pXa.className="FocusTrap",this.pXa.tabIndex=0,r.a.addHandler(this.pXa,n.a.focus,Object(y.a)(this,
this.Xkc,"onSlideShowContainerDivFocusHandler")),this.kf.insertBefore(this.oXa,this.kf.firstChild),this.kf.insertBefore(this.pXa,this.uva.nextSibling)))}}O8a(){return this.la.fjd&&this.ACe}Mzk(){u.a.J(512495880,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.cVg=!0;return null}T1j(){const Ya=new x.a;Ya.add(this.kCb.loadScript("PPTSpeechClient"));Promise.all(Ya.toArray()).then(()=>this.Mzk()).catch(Fb=>{u.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",
Fb)})}Srd(Ya,Fb,hc,ec,Tb,vb,zb,Xb,Za){this.JGa=new pa;zb&&u.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",Xb));this.gG(Object.assign(new Da,{WacCluster:hc,PodSessionId:ec,UserId:Tb,WacUserSessionId:vb,SlideId:Ya,SlideIndex:Fb,FPrerenderSS:zb,PrerenderCid:Xb,SlideShowClickTime:Za,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,FSupportSVGInWebGL:this.fck.value?"1":"0",RenderShapeBuilder:this.la.aVa?"1":"0",FileHost:v.AFrameworkApplication.fa.Ga("FileHost"),
VetoAppSettingsStr:this.opj(),DisabledTransitionsList:this.la.fMa,CustomTransitionResourceUrl:this.la.RMf,StreamVideoUseThinEmbed:v.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:v.AFrameworkApplication.fa.Ga("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:v.AFrameworkApplication.Mia,AllowExternalMarketplace:v.AFrameworkApplication.fa.ka("51")}))}prev(){this.gG(new G(2))}next(){this.gG(new G(1))}transcribe(Ya,Fb,hc,ec,Tb,vb,zb){var Xb=!!this.Ub&&!!this.Ub.instance&&
(this.Ub.instance.eSa||this.Ub.instance.dr);(this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.CDa||Xb)&&!this.Ub.instance.Jvb()?u.a.J(512495877,830,50,"LivePresenter prevented transcriber from starting"):this.O8a()?(ia.a.instance.transcribe(Ya,Fb,hc,ec,Tb,vb,zb),this.iOc(this.Hc.Lh&&5!==Tb,this.Hc.Vv)):(Xb={},Xb.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",Xb.BroadcastSubtitlesFromSpeechFrontDoorForLive=this.la.powerPointLiveBroadcastEnabled?
!0:!1,this.gG(Object.assign(new Ma,{SubtitlesAppSettingsStr:this.smj(Ya,hc,Fb,ec,Tb,vb),SubtitlesContextStr:this.Hc.ntl,SubtitlesResourceStr:this.tmj(),RehearsalContextStr:zb?zb.mXk:"",LiveBroadcastContextStr:JSON.stringify(Xb),MicrophoneDeviceId:this.lO.microphoneDeviceId})))}setMicrophoneState(Ya){this.O8a()?ia.a.instance.setMicrophoneState(Ya):(this.gG(Object.assign(new sa,{IsMute:Ya})),this.Ub&&this.Ub.instance&&(Ya?this.Ub.instance.Arh():this.Ub.instance.Brh()))}GVe(){}FOb(Ya,Fb=""){this.JGa.Gkg=
Ya;u.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.O8a()?(ia.a.instance.oDh(Ya,Fb),this.iOc(this.Hc.Lh,this.Hc.Vv)):this.gG(Object.assign(new Xa,{IsToggleOn:Ya,PragueSessionInfo:Fb}));this.K3g()}toggleTranscriberUIVisibility(Ya){u.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.O8a()?(Ya=Ya?Ya?!1:!0:!ia.a.instance.isVisible(),ia.a.instance.setVisibility(Ya),ia.a.instance.rHc(),this.iOc(this.Hc.Lh,this.Hc.Vv)):this.gG(Object.assign(new Ka,
{HideUI:Ya}))}iOc(Ya,Fb){this.JGa.xac=Ya;this.JGa.Vv=Fb;this.K3g()}setOsfLocalStorage(){const Ya={};let Fb=!1;try{const hc=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let ec=0;ec<localStorage.length;++ec){const Tb=localStorage.key(ec);if(hc.test(Tb)){const vb=localStorage.getItem(Tb);Ya[Tb]=vb;Fb=!0}}}catch(hc){u.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",hc.toString())}Fb&&this.gG(Object.assign(new Ba,{OsfLocalStorageData:Ya}))}show(){u.a.J(512495873,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.kb){this.kb.style.display=Oa.a.Wk;var Ya=(new Date).getTime();u.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",Ya);this.gG(Object.assign(new ua,{StartSlideShowTime:Ya}))}else u.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}vbb(){return this.kb&&this.kb.style.display!==Oa.a.Ff?!0:!1}Q8(){return"Legacy"}Ttc(Ya){this.kb.style.display=Ya?Oa.a.Wk:
Oa.a.Ff;this.O8a()&&ia.a.instance.setVisibility(Ya&&this.Hc.Lh)}wRc(){u.a.J(512495842,830,50,"SlideShowFrame: Exiting with post message");this.gG(new G(3))}exit(){this.kb.style.display===Oa.a.Ff?this.va.raiseEvent("OnExit",new P.a({SlideId:0,IsBeforeReady:!0})):(u.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.kb.style.display=Oa.a.Ff,this.gG(new G(3)));this.O8a()&&ia.a.instance.e0e()}restoreFocus(){this.kb.style.display===Oa.a.Ff||this.Zje()||(this.kb.focus(),this.gG(new G(4)))}pausePresentation(){this.gG(new G(15))}P2e(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.gG(new G(5))}getCurrentPositionWithTimeLines(){this.gG(new G(17))}getCurrentSlideDimensions(){this.gG(new G(20))}uTa(Ya){this.gG(Object.assign(new R,{SlideIndex:Ya,AnimStep:0}))}OLe(Ya){this.gG(Object.assign(new D,{Item:Ya.item,Color:Ya.color}))}lVe(Ya){this.va.raiseEvent("OnSpecialKey",new na.a({["Key"]:Ya.keyCode,["ShiftKey"]:Ya.shiftKey}))}Sph(){this.gG(new G(22))}h$f(Ya,Fb){this.gG(Object.assign(new V,{SlideIndex:Ya,TimeLineMappings:Fb}))}refreshPodSession(Ya,
Fb){this.gG(Object.assign(new Ga,{PodSessionId:Ya,WacCluster:Fb}))}setVisibility(Ya){this.kb.style.visibility=Ya?Oa.a.Hz:Oa.a.Qs}mga(Ya){this.gG(new G(Ya?9:10));this.O8a()&&ia.a.instance.mga(Ya)}aHc(Ya){this.va.addHandler("OnSlideshowReady",Ya)}$ld(Ya){this.va.removeHandler("OnSlideshowReady",Ya)}XPd(Ya){this.va.addHandler("OnBrowserEvent",Ya)}DRe(Ya){this.va.removeHandler("OnBrowserEvent",Ya)}evf(Ya){this.va.addHandler("OnFullscreenClick",Ya)}ujh(Ya){this.va.removeHandler("OnFullscreenClick",Ya)}ZPd(Ya){this.va.addHandler("OnSlideshowContextMenu",
Ya)}FRe(Ya){this.va.removeHandler("OnSlideshowContextMenu",Ya)}dQd(Ya){this.va.addHandler("OnPodSessionExpired",Ya)}JRe(Ya){this.va.removeHandler("OnPodSessionExpired",Ya)}IPa(Ya){this.va.addHandler("OnPositionChangeEventId",Ya)}Rib(Ya){this.va.removeHandler("OnPositionChangeEventId",Ya)}Fia(Ya){this.va.addHandler("OnExit",Ya)}Wfa(Ya){this.va.removeHandler("OnExit",Ya)}bvf(Ya){this.va.addHandler("OnSlideshowError",Ya)}rjh(Ya){this.va.removeHandler("OnSlideshowError",Ya)}WYb(Ya){this.va.addHandler("OnGetCurrentPosition",
Ya)}Qib(Ya){this.va.removeHandler("OnGetCurrentPosition",Ya)}XGc(Ya){this.va.addHandler("OnGetCurrentSlideDimensions",Ya)}Yld(Ya){this.va.removeHandler("OnGetCurrentSlideDimensions",Ya)}bHc(Ya){this.va.addHandler("OnSpecialKey",Ya)}amd(Ya){this.va.removeHandler("OnSpecialKey",Ya)}rvf(Ya){this.va.addHandler("OnVisibilityChangeEventId",Ya)}NRe(Ya){this.va.removeHandler("OnVisibilityChangeEventId",Ya)}hvf(Ya){this.va.addHandler("OnLogEndOfTranscriptionSession",Ya)}wjh(Ya){this.va.removeHandler("OnLogEndOfTranscriptionSession",
Ya)}gvf(Ya){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Ya)}vjh(Ya){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Ya)}aQd(Ya){this.va.addHandler("OnEnterEndOfShowEventId",Ya)}GRe(Ya){this.va.removeHandler("OnEnterEndOfShowEventId",Ya)}cQd(Ya){this.va.addHandler("OnLeaveEndOfShowEventId",Ya)}IRe(Ya){this.va.removeHandler("OnLeaveEndOfShowEventId",Ya)}ovf(Ya){this.va.addHandler("OnSubtitleUpdatedEventId",Ya)}Djh(Ya){this.va.removeHandler("OnSubtitleUpdatedEventId",Ya)}qvf(Ya){this.va.addHandler("OnTranscriberStartedEventId",
Ya)}Ejh(Ya){this.va.removeHandler("OnTranscriberStartedEventId",Ya)}yvf(Ya){this.va.addHandler("RecordQosErrorEventId",Ya)}Ljh(Ya){this.va.removeHandler("RecordQosErrorEventId",Ya)}Gzk(Ya){Ya=new Q(Ya.rawEvent);if(this.AYj(Ya)){var Fb=this.L4k(Ya.lva),hc=Fb.EventType;28===hc&&u.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",Ya.lva);switch(hc){case 23:this.ufd(Fb);break;case 18:this.Sgb(Fb);break;case 6:this.Ixk();break;case 11:this.r7g(!1,Fb);break;case 13:this.r7g(!0,
Fb);break;case 2:this.yfa(Fb);break;case 7:this.$wa(Fb);break;case 12:this.jxa(Fb);break;case 24:this.Fzk(Fb);break;case 26:this.mZa(Fb);break;case 27:this.sgd(Fb);break;case 29:this.Ufd(Fb);break;case 5:this.ugd(Fb);break;case 30:this.Rzk(Fb);break;case 32:this.ahd(Fb);break;case 31:this.Tfd(Fb);break;case 19:this.rfd(Fb);break;case 20:this.Qfd(Fb);break;case 33:this.nld(Fb)}}}AYj(Ya){try{if(Ya.ZUg!==this.kb.contentWindow)return u.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
Ya.ZUg.location.href),!1}catch(Fb){return u.a.J(512495838,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",Fb.toString()),!1}return!0}L4k(Ya){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Ya)}catch(Fb){let hc=Fb.toString();K.a("DisableLogPostMsgData")&&(Ya="<redacted>");K.a("DisableLogPostMsgEx")&&(hc="<redacted>");u.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
Ya,hc)}return{}}Ixk(){if(this.la.fjd&&this.cVg&&!this.ACe)try{const Ya=(new Date).getTime();ia.a.instance.init(this.la,this.kb.contentDocument.body,this.Hc,this,this.Ll,this.Ub,this.lO);this.ACe=!0;u.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-Ya)}catch(Ya){u.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",Ya.toString())}u.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}Sgb(Ya){this.va.raiseEvent("OnBrowserEvent",new Z.a(Ya))}ufd(Ya){u.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");u.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.kb.style.display=Oa.a.Ff;this.va.raiseEvent("OnExit",new P.a(Ya))}yfa(Ya){u.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.va.raiseEvent("OnGetCurrentPosition",new ca.a(Ya))}$wa(Ya){u.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.va.raiseEvent("OnGetCurrentSlideDimensions",new T.a(Ya))}r7g(Ya,Fb){this.va.raiseEvent("OnSlideshowError",new F(Ya,Fb))}jxa(Ya){Ya=new na.a(Ya);u.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",Ya.key);this.va.raiseEvent("OnSpecialKey",Ya)}Fzk(Ya){u.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.va.raiseEvent("OnSlideshowContextMenu",new ra.a(Ya))}mZa(Ya){u.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.va.raiseEvent("OnVisibilityChangeEventId",
new za.a(Ya))}sgd(Ya){u.a.J(512495826,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.va.raiseEvent("OnPodSessionExpired",new ma.a(Ya))}Ufd(Ya){u.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.va.raiseEvent("OnLogEndOfTranscriptionSession",new fa(Ya));this.Hc.Lvb=!1}ugd(Ya){u.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.va.raiseEvent("OnPositionChangeEventId",new ea.a(Ya))}Rzk(Ya){u.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.va.raiseEvent("OnSubtitleUpdatedEventId",new ka(Ya))}ahd(Ya){u.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.va.raiseEvent("OnTranscriberStartedEventId",new Ua.a(Ya));this.Hc.Lvb=!0}Xkc(){this.restoreFocus()}Tfd(Ya){u.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const Fb=new da(Ya);this.iOc(Fb.xac,Fb.Vv);this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",Fb)}catch(Fb){u.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
Fb.toString())}}rfd(){u.a.J(512495819,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}Qfd(){u.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}nld(Ya){u.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.va.raiseEvent("RecordQosErrorEventId",new ha(Ya))}gG(Ya){this.kb&&this.kb.contentWindow&&this.kb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(Ya),
"*")}K3g(){var Ya=0,Fb=100;this.JGa.xac&&("BelowSlide"===this.JGa.Vv?(Ya=0,Fb=85):"AboveSlide"===this.JGa.Vv&&(Ya=15,Fb=85));Ya=Ya.toString()+"%";Fb=Fb.toString()+"%";this.JGa.Gkg&&(Ya=String.format("calc({0} + {1})",Ya,"26px"),Fb=String.format("calc({0} - {1})",Fb,"26px"));this.gG(Object.assign(new O,{TopValue:Ya,HeightValue:Fb}))}opj(){const Ya={};Ya.AnimTranstionMinDurationMs=v.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);Ya.AnimTranstionWorstFrameIndex=v.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);Ya.AnimTranstionMaxFrameDurationMs=v.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);Ya.AnimTranstionMinFPS=v.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionMinFPS",24);Ya.NavDurationMs=v.AFrameworkApplication.fa.Bc("PodSlideShowVetoNavDurationMs",1250);Ya.SlideShowEUPLThresholdInMs=v.AFrameworkApplication.fa.Bc("SlideShowEUPLThresholdInMs",6E3);Ya.SlideShowNavigationThresholdInMs=v.AFrameworkApplication.fa.Bc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(Ya)}smj(Ya,Fb,hc,ec,Tb,vb){const zb=this.la.RIk&&e.a.rg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),Xb={};Xb.WacUserSessionId=Ya;Xb.WacUserDatacenterCluster=Fb;Xb.PodSessionId=hc;Xb.DocId=ec;Xb.EntryPoint=Tb;Xb.StartTime=vb;Xb.PodsWebServiceBase=this.la.podsWebServiceBase;Xb.TranscriberLoggingIntervalInMS=this.la.Myl;Xb.TranscribeRealTimeFactorLowerThreshold=this.la.Iyl;Xb.TranscribeRealTimeFactorUpperThreshold=this.la.Jyl;Xb.IsTranscriberLogEachTranscriptMessage=
this.la.KXj;Xb.IsTranscriberContentLoggingEnabled=this.la.HXj;Xb.FUseEndpointInWebapp=this.la.NXj;Xb.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;Xb.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;Xb.HeartbeatInterval=5E3;Xb.RoundtripLatencyThreshold=1E6;Xb.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;Xb.FragmentLatencyWarnThreshold=1E6;Xb.FragmentLatencyErrorThreshold=1E6;Xb.MessageType=this.la.pptEditorTransciberMessageType;
Xb.MaxAllowedFragmentLatencyMS=this.la.BGk;Xb.DynamicBufferEnabled=this.la.IXj;Xb.DefaultBufferSize=this.la.Lyl;Xb.MaxAllowedFinalFragmentLatencyMS=this.la.AGk;Xb.FSupportSpeechResponseMessage=zb;Xb.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&zb&&e.a.rg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");Xb.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;Xb.TranscriberShowListeningDetectionTextInMS=this.la.QIk;
Xb.PodTranscriberAudioContextSampleRate=this.la.zGk;Xb.RehearsalGrammarIsEnabled=this.la.eMe;Xb.PodRehearsalMonotoneEnabled=this.la.tLe;return JSON.stringify(Xb)}tmj(){const Ya={};Ya.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Ya.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;Ya.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;Ya.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;Ya.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;Ya.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;Ya.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;Ya.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;Ya.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;Ya.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Ya.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
Ya.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Ya.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Ya.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;Ya.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;Ya.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;Ya.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
Ya.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;Ya.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;Ya.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;Ya.InitialMessage=ResourceStrings.L_SubtitleInitMessage;Ya.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;Ya.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;Ya.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;Ya.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;Ya.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(Ya)}Zje(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.hVf}}Object(J.a)(qa,"SlideshowFrame",null,[335])},1006:function(J,aa,d){J=d(0);var h=d(387);class e{}e.taskPaneWidth="TaskPaneWidth";e.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";e.XE="TaskPaneTitle";e.nonPersistedSettings="NonPersistedSettings";e.onTaskPaneClose=
"OnTaskPaneClose";e.onExtensionLaunchCallback="OnExtensionLaunchCallback";e.H5="OnRenderedCallback";e.CNc="DialogIsModal";e.GNc="DialogShowTitleBar";e.dialogWidth="DialogWidth";e.dialogHeight="DialogHeight";e.dialogLeft="DialogLeft";e.FNc="DialogRight";e.dialogTop="DialogTop";e.ANc="DialogBottom";e.eDa="DialogTitle";Object(J.a)(e,"PropertyNames",null,[]);var r=d(27),n=d(14),v=d(18),B=d(970),y;(function(Kb){Kb[Kb.OK=0]="OK";Kb[Kb.notReady=1]="notReady";Kb[Kb.storeDisabled=2]="storeDisabled";Kb[Kb.invokeFailure=
3]="invokeFailure"})(y||(y={}));Object(J.b)("AddinDetailsQueryError",y);class x{constructor(Kb){this.hqb=Kb}next(Kb){this.hqb=(9301*this.hqb+49297)%233280;return Math.floor(this.hqb/233280*Kb)}}Object(J.a)(x,"Random",null,[]);var A=d(205);class E extends A.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(J.a)(E,"CuiButtonPropsExtended",A.a,[]);var u=d(937),K=d(586),G=d(1135),O=d(1131),R=d(588);class V{constructor(){this.text=this.href=null}}Object(J.a)(V,"LinkProps",null,[]);
var D=d(315),Q=d(273),Z=d(938),P=d(193),ca=d(47);class T{constructor(Kb,Pa,mb,qc,oc,ib=null){this.i3a={};this.IWh={};this.qob={};this.rob=0;this.Tlf=!1;this.uQb=0;this.zdf=!1;this.TAd=0;this.Qmb=Pa;this.RV=null;this.oWh=mb;this.qWh=qc;this.u0h=oc;this.$a=ib||r.AFrameworkApplication.fa;Kb=this.rUj?Object(n.a)(this,this.QGe,"onAddinDetailsRefreshed"):Object(n.a)(this,this.Ahh,"registerIcons");this.Qmb.kWk(Kb);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1));
appChrome.addInApi.loadOfficeAddInIcons()}get fJf(){return this.qob}Ahh(Kb,Pa){if(Pa.V7)for(Kb=0;Kb<Pa.V7.length;Kb++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+Pa.V7[Kb].solutionId,Pa.V7[Kb].iconUrl);else h.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get rUj(){return!!this.$a&&this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.FlyoutGeneratorRefactorEnabled")}get o_c(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",
!1)}Qil(Kb){0===Kb.yrb&&(this.uQb|=1);1===Kb.yrb&&(this.uQb|=2);return!!this.uQb}QGe(Kb,Pa){this.Ahh(Kb,Pa);this.Qil(Pa)&&(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1)),this.$a.isChangeGateEnabled("OfficeVSO:7611216_UnderstandDataProvider")&&h.ULS.sendTraceTag(509224609,220,50,"UnderstandDataProvider, Flyout button enabled, collectionType: {0}",B.a[Pa.yrb]),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutOverflowTelemetryEnabled",
!1)&&this.T4j())}YEf(){let Kb=this.Qmb.g5b(0);if(1!==Kb.errorCode)return!0;Kb=this.Qmb.g5b(1);return 1!==Kb.errorCode}cGk(Kb){const Pa=[];var mb=new x((new Date).getDate());for(var qc=0;8>qc;qc++)Array.add(Pa,mb.next(Kb.count));mb=0;for(let oc of Kb){qc=!1;for(const ib of Pa)if(mb===ib){qc=!0;break}mb++;if(qc){let ib;(ib=oc.addinInfo).AUP=20*ib.AUP}else if(1===oc.addinInfo.priority){let ib;(ib=oc.addinInfo).AUP=4*ib.AUP}else if(2===oc.addinInfo.priority){let ib;(ib=oc.addinInfo).AUP=2*ib.AUP}}Kb.Sc((oc,
ib)=>oc.addinInfo.AUP<ib.addinInfo.AUP?1:-1);return Kb}dGk(Kb){for(let Pa of Kb)if(1===Pa.addinInfo.priority){let mb;(mb=Pa.addinInfo).AUP=4*mb.AUP}else if(2===Pa.addinInfo.priority){let mb;(mb=Pa.addinInfo).AUP=2*mb.AUP}Kb.Sc((Pa,mb)=>Pa.addinInfo.AUP<mb.addinInfo.AUP?1:-1);return Kb}ZYd(Kb,Pa){const mb={};mb.width=Kb;mb.height=Pa;mb.backgroundColor="transparent";return mb}EYd(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box",
"-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}iTc(){const Kb={},Pa={},mb={};Pa.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Pa.inner={margin:"-4px"};mb.root=this.ZYd(100,100);mb.flexContainer={flexDirection:"column"};mb.label=this.o_c?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:this.EYd();Kb.galleryButtonInExpanded=
mb;Kb.galleryStack=Pa;return Kb}k3i(){return Object.assign(new O.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"QuickSearchNoCategories_16",Command:this.u0h,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}qwb(Kb,
Pa,mb){Kb=Object.assign(new O.a,{Id:mb,ExternalId:mb,Icon:"AddinFlyoutControl"+Pa.solutionId,Command:Kb===CommonUIStrings.l_PopularAddins?this.oWh:this.qWh,LabelText:Pa.displayName,FullIconStyle:{root:{width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"}},Alt:Pa.displayName});this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)&&(Kb.Alt=Pa.description);return Kb}lHk(Kb,Pa,mb){const qc=Object.assign(new G.a,
{SectionId:Kb,Title:Kb,GalleryButtons:[]});for(let oc=0;oc<mb;oc++)Array.add(qc.GalleryButtons,this.qwb(Kb,Pa[oc],this.i3a[Pa[oc].solutionId]));return qc}o6b(){var Kb=[];const Pa=this.Qmb.g5b(0);Array.addRange(Kb,Pa.V7);const mb=this.Qmb.g5b(1);Array.addRange(Kb,mb.V7);let qc=Kb.length;this.TAd=0<qc?5:6;r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&h.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",
qc,y[Pa.errorCode],Pa.V7.length,y[mb.errorCode],mb.V7.length);Kb.sort((jc,Gb)=>{jc=P.d(jc.displayName);Gb=P.d(Gb.displayName);return ca.a.localeCompare(jc,Gb)});const oc=6<qc;oc&&(qc=5);if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))for(var ib=0;ib<qc;ib++)this.fBf(Kb[ib]);else for(ib=0;ib<qc;ib++)if(!(Kb[ib].solutionId in this.i3a)){var $a="AddinGalleryButton"+this.rob.toString();this.i3a[Kb[ib].solutionId]=$a;this.qob[$a]=Kb[ib].solutionId;this.rob++}let Db=
[];ib=null;if(this.RV)Db=this.RV;else if(ib=this.Qmb.g5b(2),0===ib.errorCode)if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))ib.V7.forEach(jc=>{-1!==jc.addinInfo.priority&&(this.fBf(jc),Db.push(jc))});else for(Db=ib.V7,ib=0;ib<Db.length;ib++)Db[ib].solutionId in this.i3a||($a="AddinGalleryButton"+this.rob.toString(),this.i3a[Db[ib].solutionId]=$a,this.qob[$a]=Db[ib].solutionId,this.qob[$a+"Add"]=Db[ib].solutionId,this.rob++);ib=!0;Db.length||(ib=!1);
$a=0;if(ib&&($a=Kb.length?3>=Kb.length?9:6:12,Db=this.o_c?this.Vfi(Db,Kb):this.Ufi(Db,Kb),$a>Db.length&&($a=Db.length),r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.Tlf&&!this.o_c)){var Mb="",ob="";for(let jc=0;jc<Db.length&&jc<$a;jc++)Mb+=Db[jc].displayName,Mb+=",",ob+=Db[jc].solutionId,ob+=",";h.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",$a,Mb,ob);this.Tlf=
!0}Mb=Object.assign(new Q.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});ob=Object.assign(new A.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(Mb.ControlList,ob);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));Mb=Object.assign(new D.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Mb,UpdateDynamically:!0});
2!==Pa.errorCode||Kb.length?3===Pa.errorCode||3===mb.errorCode?(h.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),Kb=this.GZf("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Mb.MenuSectionList,Kb)):(0<qc?this.YJf(Mb,Kb,qc,"MRUAddins",CommonUIStrings.l_MyAddinSection,oc):this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(Kb=this.x2i(),Array.add(Mb.MenuSectionList,Kb),h.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),
ib&&(this.o_c?(Array.add(Mb.MenuSectionList,this.h3i(Db,this.TAd)),Kb=[],this.SFl(Kb),appChrome.api.dispatch(Kb)):this.YJf(Mb,Db,$a,"PopularAddins",CommonUIStrings.l_PopularAddins))):(h.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),Kb=this.GZf("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Mb.MenuSectionList,Kb));return Mb}SFl(Kb){6>this.TAd?Kb.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!0)):Kb.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",
!1))}h3i(Kb,Pa){const mb=Object.assign(new Q.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let qc=0;qc<0+Pa&&qc<Kb.length;qc++)this.IWh.PopularAddInsListItem0=Kb[qc].solutionId,this.q2i(mb.ControlList,qc.toString(),Kb[qc]);Kb=Object.assign(new E,{Id:"SwitchPopularAddIns",ExternalId:"SwitchPopularAddIns",ExternalImageId:"Refresh",Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,
DismissHostingSurfaceOnExecute:!1});Array.add(mb.ControlList,Kb);return mb}q2i(Kb,Pa,mb){Pa=this.DFi(Pa,mb);Array.add(Kb,Pa)}DFi(Kb,Pa){const mb=[];var qc=Object.assign(new V,{text:CommonUIStrings.l_AddinListPrivacy,href:Pa.privacyUrl});Array.add(mb,qc);qc=Object.assign(new V,{text:CommonUIStrings.l_AddinListLicense,href:Pa.licenseUrl});Array.add(mb,qc);qc=Object.assign(new V,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Pa.solutionId});Array.add(mb,
qc);qc={};qc["default"]="AddinFlyoutControl"+Pa.solutionId;return Object.assign(new Z.a,{Id:"PopularAddInsListItem"+Kb,ExternalId:"PopularAddInsListItem"+Kb,CommandId:"PopularAddInsListItem"+Kb,iconSet:qc,Label:Pa.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:Pa.description,Links:mb,ActionId:"PopularAddInsListItemAdd"+Kb,ActionCommandValueId:Pa.solutionId,CommandValueId:Pa.solutionId})}fBf(Kb){if(!(Kb.solutionId in this.i3a)){const Pa="AddinGalleryButton"+this.rob.toString();this.i3a[Kb.solutionId]=
Pa;this.qob[Pa]=Kb.solutionId;this.qob[Pa+"Add"]=Kb.solutionId;this.rob++}}x2i(){const Kb=Object.assign(new Q.a,{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),Pa=Object.assign(new R.a,{ExternalId:"AddInFlyoutBanner",LabelText:this.$a.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(Kb.ControlList,Pa);return Kb}GZf(Kb,Pa){const mb=Object.assign(new Q.a,{Id:"ErrorSection",
ControlsId:"ErrorSection.Controls",ControlList:[]});Kb=Object.assign(new u.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:Kb,Label:Pa});Array.add(mb.ControlList,Kb);return mb}Ufi(Kb,Pa){var mb=new v.a;for(let qc=0;qc<Kb.length;qc++)mb.add(Kb[qc]);this.RV||(8<mb.count&&(mb=this.cGk(mb)),this.RV=mb.toArray());for(Kb=0;Kb<this.RV.length;Kb++)for(mb=0;mb<Pa.length;mb++)if(this.RV[Kb].solutionId.toLowerCase()===Pa[mb].solutionId.toLowerCase()){Array.remove(this.RV,this.RV[Kb--]);break}return this.RV}Vfi(Kb,
Pa){var mb=new v.a;for(let qc=0;qc<Kb.length;qc++)mb.add(Kb[qc]);this.RV||(8<mb.count&&(mb=this.dGk(mb)),this.RV=mb.toArray());for(Kb=0;Kb<this.RV.length;Kb++)for(mb=0;mb<Pa.length;mb++)if(this.RV[Kb].solutionId.toLowerCase()===Pa[mb].solutionId.toLowerCase()){Array.remove(this.RV,this.RV[Kb--]);break}return this.RV}YJf(Kb,Pa,mb,qc,oc,ib=!1){const $a=Object.assign(new Q.a,{Id:qc+"Section",ControlsId:qc+"Section.Controls",ControlList:[]});qc=Object.assign(new K.a,{Id:qc+"GalleryControl",ExternalId:qc+
"GalleryControl",GalleryStyle:this.iTc(),Width:3,Type:4,GallerySections:[]});Array.add(Kb.MenuSectionList,$a);Array.add($a.ControlList,qc);Kb=this.lHk(oc,Pa,mb);ib&&Array.add(Kb.GalleryButtons,this.k3i());qc.GallerySections.push(Kb)}Oid(Kb){if(Kb)try{Kb.MenuItems=this.o6b()}catch(Pa){h.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(Pa?Pa.toString():""))}else h.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}T4j(){if(!this.zdf&&this.wod){var Kb=
appChrome.selectors.getSelectedTabId();Kb&&P.a(Kb,"Home")&&((Kb=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(Kb,"").display||h.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.zdf=!0)}}get wod(){return!!window.appChrome&&!!appChrome.selectors}}Object(J.a)(T,"AppsFlyoutGenerator",null,[106]);var da=d(971),fa=d(373),ma=d(210),ea=d(1204);class ra{}ra.Z3b="extId";ra.P0b="ComponentType";ra.wW="ComponentId";ra.nlc="OptionalProps";Object(J.a)(ra,"ActionPropertyNames",
null,[]);var F=d(37),na=d(42),ka=d(84),Ua=d(39);class za{constructor(){this.idField=null;this.stateField=0}}Object(J.a)(za,"CT_OsfBackgroundAppData",null,[]);class ha{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(J.a)(ha,"CT_OsfInsertionInfo",
null,[]);var ua=d(52),Ga=d(969),sa=d(972),Ba=d(333),pa=d(35),ia=d(30),Da=d(278),Xa=d(182),Ka=d(932),Ma=d(532);class Oa extends Ma.a{constructor(Kb){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Kb.paragraphs;this.image=Kb.image;this.imageWidth=Kb.imageWidth;this.imageHeight=Kb.imageHeight}}Object(J.a)(Oa,"TextAboveImage",Ma.a,[]);class qa{constructor(Kb,Pa){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Kb;
this.image=Pa}}Object(J.a)(qa,"TextAboveImageCustomProps",null,[]);var Ya=d(141),Fb=d(1122),hc=d(934),ec=d(933),Tb=d(351),vb=d(82),zb=d(134),Xb=d(142),Za=d(172);class Va{constructor(){this.cck="ClickOnLaunch";this.O8j="ClickOnDismiss";this.Ehk="Show";this.t$j="BetterEntryPoint_InsertTab";this.Oik=500;this.gak=280;this.cak=192;this.rak="InsertAddInFlyout";this.Qgk="RibbonOverflowMenu-overflow";this.Pgk="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.M$j="[data-unique-id=Home]";this.sak="InsertAddinTransitionEntry"}XCi(){Object(Da.a)(this,
void 0,void 0,function*(){try{let Kb=yield Ya.UISurfaces.oL();Va.PEb&&(Kb.removeNotification(Va.PEb),Va.PEb=null);let Pa=this.Pgk,mb=document.getElementById(this.sak);const qc=mb?window.getComputedStyle(mb,null):null;if(null==mb||qc&&"none"===qc.display)Pa=this.M$j;const oc=CommonUIStrings.l_BetterEntryPointTUI_Title,ib=CommonUIStrings.l_BetterEntryPointTUI_Content,$a=new Ka.a("https://iriscoremetadataprod.blob.core.windows.net/assets/add-ins_powerpoint_1677568738672.svg"),Db=new qa(ib,$a),Mb=new Oa(Db);
Mb.imageWidth=this.gak;Mb.imageHeight=this.cak;const ob=new Fb.a;ob.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;ob.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;ob.onExecute=()=>{this.Vvj();this.iea(this.cck)};const jc=new Fb.a;jc.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;jc.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;jc.onExecute=()=>{Kb.removeNotification(Va.PEb);this.iea(this.O8j)};const Gb=new hc.a;Gb.onDismiss=()=>{Kb.removeNotification(Va.PEb)};
Gb.setInitialFocus=!0;const Gc=new ec.a;Gc.target=Pa;Gc.title=oc;Gc.content=Mb;Gc.showCloseIcon=!0;Gc.hasDynamicSizing=!1;Gc.preventLightDismiss=!1;Gc.useTeachingStyles=!0;Gc.primaryButtonProps=ob;Gc.secondaryButtonProps=jc;Gc.calloutProps=Gb;const bc=Kb.callout(Gc),dc=new Tb.a;dc.onShow=()=>{this.iea(this.Ehk)};Va.PEb=Kb.addNotification(bc,dc);return null}catch(Kb){return h.ULS.sendTraceTag(509207556,220,15,"Failed to GetNotificationsAPIAsync: {0}",Kb),null}})}Vvj(){appChrome.api.dispatch(appChrome.actions.setCurrentTab("Home"));
const Kb=new vb.a(0,1,this.Oik,()=>{this.x_j()});zb.a.instance.Db(Kb)}x_j(){const Kb=document.getElementById(this.rak),Pa=Kb?window.getComputedStyle(Kb,null):null;if(null==Kb||Pa&&"none"===Pa.display){const mb=document.getElementById(this.Qgk);null!=mb?(mb.onclick=function(){const qc=new vb.a(0,1,500,()=>{const oc=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=oc?(oc.click(),h.ULS.sendTraceTag(509207555,220,50,"Launch flyout in overflow")):h.ULS.sendTraceTag(509207554,
220,10,"Neither ribbon nor overflow can launch flyout")});zb.a.instance.Db(qc);mb.onclick=function(){}},mb.click()):h.ULS.sendTraceTag(509207553,220,10,"Neither ribbon nor overflow can launch flyout")}else Kb.click(),h.ULS.sendTraceTag(509207552,220,50,"Launch flyout in ribbon button")}iea(Kb){Kb={["AppTeachingUICalloutAction"]:Kb,["AppTeachingUICalloutGoal"]:this.t$j};Xb.a.sendTelemetryEvent(Object.assign(new Xa.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Za.a.sC(Kb)}))}}
Va.PEb=null;Object(J.a)(Va,"PPTBetterEntryTeachingCallout",null,[]);d.d(aa,"a",function(){return tc});class tc{constructor(Kb,Pa,mb,qc,oc,ib,$a,Db,Mb,ob,jc,Gb,Gc){this.CBb=0;this.sAg=!1;this.R6j="g_InstallOrigin";this.aVg=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"]]);this.JMg=null;this.awj=()=>this.aSd&&!this.Qb.ka("AppsForOfficeThirdPartyIsDisabled")&&this.Hra&&this.Hra.YEf()?32:8;this.Evj=(bc,dc,Nb,Ac,jb)=>{if(2!==Nb)return this.Hra&&
this.Hra.YEf()?32:8;if(!this.Hra)return 8;this.Hra.Oid(jb);return 32};this.vuj=(bc,dc,Nb,Ac,jb)=>{if(!this.L4||!jb)return 8;if(1===Nb)return this.Kd?32:8;if(!this.Kd)return this.CBb||(this.CBb=window.performance.now()),this.ML.dja(),this.ML.zPa(bc,jb),8;bc=jb[ra.Z3b];jb=jb[ra.nlc].optionalProperties;dc={};dc.XE=jb.TMh;dc.assetId=bc.getId();dc.H5=jb.GMh;dc.nonPersistedSettings=jb.yNc;dc.CNc=jb.pNl;dc.GNc=jb.sNl;dc.dialogWidth=jb.uNl;dc.dialogHeight=jb.oNl;dc.dialogLeft=jb.qNl;dc.FNc=jb.rNl;dc.dialogTop=
jb.tNl;dc.ANc=jb.nNl;this.Kd.m1k(dc);return 32};this.wxj=(bc,dc,Nb,Ac,jb)=>{if(2!==Nb)return 32;if(!this.Kd)return 8;dc=jb[ra.Z3b];Nb=jb[ra.nlc].optionalProperties;bc={};bc.XE=Nb.TMh;bc.assetId=dc.getId();bc.sourceLocationOverrideResourceId=Nb.KNl;bc.H5=Nb.GMh;bc.nonPersistedSettings=Nb.yNc;dc=this.Kd.pwb(bc);dc=this.Kd.oQ(dc);jb=jb[ra.P0b];return dc&&"taskpane"==jb.toLowerCase()?(this.Kd.Jbl(dc.instanceId,bc),32):8};this.trj=(bc,dc,Nb,Ac,jb)=>{if(2!==Nb)return 32;if(jb.SourceControlId)return this.JMg=
new Va,this.JMg.XCi(),32;h.ULS.sendTraceTag(509207557,220,10,"Control id is null.")};this.wuj=(bc,dc,Nb,Ac,jb)=>{if(2!==Nb)return 32;if(!this.Hra)return 8;dc=this.Hra.fJf[jb.SourceControlId];if(!dc)return h.ULS.sendTraceTag(509383066,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Kd?this.Kd.q_j(dc):(this.ML.dja(),this.ML.zPa(bc,jb));return 32};this.uuj=(bc,dc,Nb,Ac,jb)=>{if(2!==Nb)return 32;if(!this.Hra)return 8;dc=this.Hra.fJf[jb.SourceControlId];if(!dc)return h.ULS.sendTraceTag(509383065,
220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Kd?this.Kd.Y1c(dc):(this.ML.dja(),this.ML.zPa(bc,jb));return 32};this.xag=(bc,dc,Nb,Ac,jb)=>{dc=this.ua.Ba;Ac=this.Vb.xf;if(!(this.L4&&dc&&Ac)||this.gf.$c(dc))return 8;if(!this.aSd)return h.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===Nb)return 32;pa.a("LogAddinInstallOriginEnabledForPPT")&&(Nb=jb?jb.SourceControlId:void 0,window[this.R6j]=this.aVg.get(Nb)?this.aVg.get(Nb):"Unknown");
this.Kd?pa.a("UpdateLaunchInsertDialog")?(bc=jb?jb.SourceControlId:void 0,jb=jb?jb.CommandValueId:null,"InsertMoreAddInsFromFooter"===bc?this.Kd.Upg("{98143890-AC66-440E-A448-ED8771A02D52}"):"AddinFlyoutMoreButton"===bc?this.Kd.Upg("0"):"LaunchAddinDialogFromTellMe"==bc&&jb?this.Kd.A_j(jb):this.Kd.launchInsertDialog()):this.Kd.launchInsertDialog():(this.ML.dja(),this.ML.zPa(bc,jb));return 32};this.qag=(bc,dc,Nb,Ac,jb)=>{if(!jb)return 8;null!=this.Kd&&this.Qb.isChangeGateEnabled("OnInsertAgaveStartedEnabled")&&
this.Kd.vkc("handleInsertAppForOffice",jb);return this.sag(bc,jb)};this.duj=(bc,dc,Nb,Ac,jb)=>jb?this.sag(bc,jb):8;this.sag=(bc,dc)=>{if(!this.aSd)return h.ULS.sendTraceTag(512288601,802,50,"Web add-in insert blocked by doc IRM"),16;if(0===dc.targetType)return this.VHj(dc,bc);if(1===dc.targetType){if(this.gf.$c(this.Vb.xf))return 16;this.Lak?dc.isAddinCommands?pa.a("AddinCommandsActionTypeUndefinedCheck")?void 0===dc.addinCommandsActionType||null===dc.addinCommandsActionType||0===dc.addinCommandsActionType?
this.ROb(dc):1===dc.addinCommandsActionType?this.WXc(dc):h.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+dc.addinCommandsActionType.toString()):0===dc.addinCommandsActionType?this.ROb(dc):1===dc.addinCommandsActionType&&this.WXc(dc):(bc={},bc.solutionId=dc.solutionId,bc.version=dc.version,bc.storeType=dc.storeType,bc.storeId=dc.storeId,bc.targetData=dc,this.Kd.vl.isAddinCommandsAsync(bc,(Nb,Ac,jb)=>{Ac?this.ROb(jb.targetData):this.WXc(jb.targetData);
Nb||(Nb=jb.targetData,h.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Nb.solutionId,Nb.storeType,Nb.assetId,null,null,Nb.storeId),Nb.storeType))})):this.WXc(dc);Ga.a.add(dc.solutionId,dc.targetType,dc.storeId,dc.storeType,dc.version);return 32}return 8};this.la=Kb;this.Qb=Pa;this.L4=this.la.pptEditInsertAppsForOfficeEnabled;this.Lak=this.la.fua;this.Ms=mb;this.ia=qc;this.Vb=oc;this.ua=ib;this.F8c=Db;this.Jb=$a;this.ML=
Mb;this.Yc=ob;this.Pb=jc;this.gf=Gb;this.Zj=Gc}get aSd(){return this.L4&&r.AFrameworkApplication.Mia}wb(){this.ia.ra(ia.a.Nyb,ua.a.application,this.xag,516);this.ia.ra(ia.a.HXc,ua.a.application,this.duj,4);this.ia.ya(ia.a.EWc,ua.a.application,Object(n.a)(this,this.Otj,"handleHideAppForOfficeTaskPane"));this.ia.ra(ia.a.Wib,ua.a.application,Object(n.a)(this,this.Qwj,"handleRenderAppForOfficeTaskPane"),4);this.ia.ra(ia.a.PZa,ua.a.application,Object(n.a)(this,this.PZa,"queryEntitledAppsForOffice"),96);
this.ia.ya(ia.a.lga,ua.a.application,Object(n.a)(this,this.nbg,"handleShowFirstPartyTaskPane"));this.ia.ya(ia.a.Ftb,ua.a.application,Object(n.a)(this,this.xsj,"handleCloseAppsForOfficeTaskPane"));this.ia.ya(F.a.uml,ua.a.application,Object(n.a)(this,this.Cxj,"handleShowExtensionTaskPane"));this.ia.ya(F.a.Ivi,ua.a.application,Object(n.a)(this,this.ysj,"handleCloseExtensionTaskPane"));this.ia.ya(F.a.p4k,ua.a.application,Object(n.a)(this,this.bxj,"handleRestartExtensionTaskPane"));this.ia.ya(ia.a.bHh,
ua.a.application,Object(n.a)(this,this.pyj,"handleUpdateBackgroundAppData"));pa.a("EnableSDXDialog2")&&this.ia.ya(F.a.H_j,ua.a.application,this.vuj);pa.a("EnabledTellMeAddinOnPPTO")&&(this.ia.ra(F.a.Sfg,ua.a.application,this.qag,4),this.ia.ra(F.a.coe,ua.a.application,this.xag,4));this.Svf&&(this.ia.ya(F.a.Y1c,ua.a.application,this.uuj),this.ia.ya(F.a.ofe,ua.a.application,this.qag),this.ia.ya(F.a.Zpg,ua.a.application,this.wuj),this.ia.ya(F.a.aNk,ua.a.application,this.awj),this.ia.ya(F.a.SGk,ua.a.application,
this.Evj),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1)));pa.a("EnableSetTitleExtensionTaskPane")&&this.ia.ya(F.a.agl,ua.a.application,this.wxj);this.Rci&&this.ia.ra(F.a.Gfg,ua.a.application,this.trj,516)}get Hra(){if(!this.Svf)return null;if(!this.Kd)return this.ML.dja(),h.ULS.sendTraceTag(509383064,220,10,"appForOfficeManager is null"),null;this.wtg||(this.Kd.Pvf?this.wtg=new T(this.ia,this.Kd.Pvf,F.a.Y1c.toString(),F.a.Zpg.toString(),ia.a.Nyb.toString(),
this.Qb):h.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null"));return this.wtg}get Svf(){return this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.Qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get Rci(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinTransitionEntranceEnabled",!1)}Ee(){}get Kd(){return this.Yc.instance}Cxj(Kb,Pa,mb,qc,oc){if(2!==
mb)return 32;const ib=oc[ra.Z3b];oc=oc[ra.nlc];const $a={};$a.XE=oc.optionalProperties[e.XE];$a.assetId=ib.getId();$a.H5=oc.optionalProperties[e.H5];$a.nonPersistedSettings=oc.yNc;return this.nbg(Kb,Pa,mb,qc,$a)}ysj(Kb,Pa,mb,qc,oc){if(2!==mb)return 32;Kb=oc[ra.Z3b];oc=oc[ra.nlc];Pa={};Pa.XE=oc.optionalProperties[e.XE];Pa.assetId=Kb.getId();Pa.sourceLocationOverrideResourceId=oc.optionalProperties[e.sourceLocationOverrideResourceId];Pa.H5=oc.optionalProperties[e.H5];Pa.nonPersistedSettings=oc.yNc;
oc=this.Kd.pwb(Pa);return(oc=this.Kd.oQ(oc))&&this.Kd.fWd(oc.instanceId)?32:8}bxj(Kb,Pa,mb,qc,oc){if(2!==mb)return 32;Kb=oc[ra.Z3b];Pa=oc[ra.nlc];oc={};oc.XE=Pa.optionalProperties[e.XE];oc.assetId=Kb.getId();oc.sourceLocationOverrideResourceId=Pa.optionalProperties[e.sourceLocationOverrideResourceId];oc.H5=Pa.optionalProperties[e.H5];oc.nonPersistedSettings=Pa.yNc;Kb=this.Kd.pwb(oc);return(Kb=this.Kd.oQ(Kb))?(this.Kd.chh(Kb.instanceId,oc),32):8}Otj(Kb,Pa,mb,qc,oc){if(!this.L4)return 16;if(!oc)return 8;
if(1===mb)return 32;Kb=Object(ea.a)(String,oc);if(!Kb||!Kb.length)return 8;if((Pa=this.Kd.wQc(Kb))&&Pa.taskpane){if(this.Kd.pua(Kb))return this.Kd.ILb(Kb,!1),32;if(Pa.Jo&&OSF.OsfControl.isFirstPartyStoreString(Pa.Jo.storeType))return this.Kd.$Nc(Kb),this.Kd.tPk(Kb),32;Pa=Pa.taskpane.ownerAddinSolutionId;if(this.Kd.VJj(Kb)||Pa)this.Kd.$Nc(Kb);else if(Pa=this.Kd.ORc(),mb=this.Pb.Mc(Pa),Kb=this.Kd.WWf(Kb)){mb.Pk(Object(ea.a)(ka.a,Kb));Kb=this.Jb.Ad(4,void 0,void 0,void 0,!0);try{Kb.nc(Pa),mb.Oi()}finally{Kb&&
Kb.dispose()}}}return 32}Qwj(Kb,Pa,mb,qc,oc){if(!this.L4)return 16;if(!oc)return 8;if(1===mb)return 32;Pa=Object(ea.a)(String,oc);if(!Pa||!Pa.length)return 8;this.Kd?this.Kd.Wib(Pa):this.ML.zPa(Kb,oc);return 32}nbg(Kb,Pa,mb,qc,oc){if(!this.L4)return 16;if(!oc)return 8;if(1===mb)return 32;if(this.Kd){if(!oc||!oc.assetId||!r.AFrameworkApplication.hme(oc.assetId))return 8;oc.nonPersistedSettings||(oc.nonPersistedSettings={});oc.nonPersistedSettings.ShowFeedback=r.AFrameworkApplication.UE;!this.sAg&&
this.CBb&&(this.sAg=!0,Kb=window.performance.now()-this.CBb,h.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",Kb));Kb=this.Kd.pwb(oc);if(Kb=this.Kd.oQ(Kb))return this.Kd.chh(Kb.instanceId,oc),32;this.Kd.Y0k(oc)}else this.CBb||(this.CBb=window.performance.now()),this.ML.dja(),this.ML.zPa(Kb,oc);return 32}pyj(Kb,Pa,mb,qc,oc){if(1===mb)return this.L4?32:8;if(!this.L4)return 16;if(!(oc&&oc.gw&&-1!==oc.gw.state&&oc.gw.iya&&this.Kd))return 8;Kb=this.Kd.JDa(oc.Jo.id);if(!Kb)return 8;Pa=
this.Jb.Ad(4,void 0,void 0,void 0,!0);try{Pa.nc(Kb),Kb.setValue(Ua.a.osb,oc.gw.state),Kb.setValue(Ua.a.F6a,oc.gw.iya),Kb.setValue(na.a.oZb,oc.Jo.storeType)}finally{Pa&&Pa.dispose()}return 32}xsj(Kb,Pa,mb,qc,oc){return this.L4?oc?1===mb?32:this.Kd&&oc&&oc.length?this.Kd.fWd(oc)?32:8:8:8:16}PZa(Kb,Pa,mb,qc,oc){var ib;if(2===mb){Pa=oc.callback;if(!Pa)return 16;pa.a("AllowQueryAddinsForStoreTypes")?this.Kd?this.nNk(Pa,null!==(ib=oc.storeType)&&void 0!==ib?ib:OSF.StoreTypeEnum.MarketPlace):(oc=Object.assign({},
oc),this.ML.zPa(Kb,oc)):this.mNk(Pa)}return 32}nNk(Kb,Pa){const mb=new da.a;mb.callbackFunc=Kb;mb.storeType=Pa;mb.fromInsertDialog=!1;mb.refresh="true"===fa.a.instance.getItem(ma.a.uQd);this.Kd.vl.queryEntitlementDetails(mb)}mNk(Kb){const Pa=new da.a;Pa.callbackFunc=Kb;Pa.storeType=OSF.StoreTypeEnum.MarketPlace;Pa.fromInsertDialog=!1;Pa.refresh="true"===fa.a.instance.getItem(ma.a.uQd);this.Kd.vl.queryEntitlementDetails(Pa)}ROb(Kb){const Pa=new v.a;Pa.add(Kb);Kb={};Kb[ma.a.mHc]=Pa;Kb[ma.a.T7]=3;this.ia.La(F.a.W1c,
2,Kb)}VHj(Kb,Pa){const mb=this.ua.Ba;if(!mb||this.gf.$c(mb))return 16;if(!this.Zj.OF(mb,1))return this.Zj.mG(mb),16;try{return this.Ufg(Kb,mb,mb.Cb,Pa)}catch(qc){return 8}}Ufg(Kb,Pa,mb,qc){mb=Pa.vGi(Kb.width,Kb.height,Pa.Wt()+1);sa.a.Otf(mb,Kb,this.Kd);this.Ms.HW([Object(ea.a)(4,mb)],Pa,qc);Ga.a.add(Kb.solutionId,Kb.targetType,Kb.storeId,Kb.storeType,Kb.version);return 32}WXc(Kb){if(!this.Kd.oQ(Kb.solutionId)){var Pa=this.Kd.JDa(Kb.solutionId),mb=this.Kd.ORc();if(Pa){mb=new Ba.a(Pa);if(!mb.visibility){let qc=
this.Jb.Ad(4,void 0,void 0,void 0,!0);try{qc.nc(Pa),Pa.setValue(na.a.qZb,!0),Pa.setValue(na.a.oZb,Kb.storeType)}finally{qc&&qc.dispose()}}this.Kd.Wib(mb.id)}else{Pa=sa.a.dDi(this.F8c.value,Kb,this.Kd);Kb=this.Jb.Ad(4,void 0,void 0,void 0,!0);try{Kb.nc(mb),sa.a.H5h(mb,Pa)}finally{Kb&&Kb.dispose()}}}}}Object(J.a)(tc,"AppForOfficeActor",null,[365])},1008:function(J,aa,d){J=d(0);var h=d(289),e=d(27),r=d(47),n=d(14),v=d(24),B=d(1204),y=d(36),x=d(28);class A{}A.speechMode="Subtitles";A.KMf=[A.speechMode];
A.sourceLanguage=null;A.targetLanguages=null;A.speechFDBase=null;A.podSessionId=null;A.AKh=null;A.docId=null;A.webServiceBase=null;A.userSessionId=e.AFrameworkApplication.userSessionId;Object(J.a)(A,"PPTSpeechClientConfig",null,[]);var E=d(78);class u{constructor(){this.va=new E.a}onFinalRecognitionText(da){this.va.raiseEvent("OnFinalRecognitionText",da)}onPartialRecognitionText(da){this.va.raiseEvent("OnPartialRecognitionText",da)}onError(da){this.va.raiseEvent("OnError",da)}onSpeechRecognitionStarted(da){this.va.raiseEvent("OnSpeechRecognitionStarted",
da)}onEventUpdate(da){this.va.raiseEvent("OnEventUpdate",da)}j$h(da){this.va.addHandler("OnFinalRecognitionText",da)}HZk(da){this.va.removeHandler("OnFinalRecognitionText",da)}kbi(da){this.va.addHandler("OnPartialRecognitionText",da)}W_k(da){this.va.removeHandler("OnPartialRecognitionText",da)}d$h(da){this.va.addHandler("OnError",da)}CZk(da){this.va.removeHandler("OnError",da)}jci(da){this.va.addHandler("OnSpeechRecognitionStarted",da)}A0k(da){this.va.removeHandler("OnSpeechRecognitionStarted",da)}f$h(da){this.va.addHandler("OnEventUpdate",
da)}EZk(da){this.va.removeHandler("OnEventUpdate",da)}}Object(J.a)(u,"PPTSpeechClientObserverController",null,[]);var K=d(387),G=d(398);class O{constructor(){this.accessToken=null}}Object(J.a)(O,"IAuthenticationProvider",null,[]);class R{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(J.a)(R,"IDocumentDownloadConfig",null,[]);class V{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=
this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(J.a)(V,"ISpeechConfig",null,[]);class D{constructor(da){this.l5=da}onFinalText(){}onFragmentText(){}onFinalRecognitionText(da,fa){this.l5.onFinalRecognitionText(da,fa)}onPartialRecognitionText(da,fa){this.l5.onPartialRecognitionText(da,fa)}onError(da){if("ErrorNone"!==da)switch(da){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.l5.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.l5.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.l5.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.l5.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.l5.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.l5.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.l5.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.l5.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.l5.onError("NotReadableError");break;default:this.l5.onError("CustomError-"+da)}}onSpeechRecognitionStarted(da){K.ULS.sendTraceTag(594355729,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",da);this.l5.onSpeechRecognitionStarted(da)}onEventUpdate(da){this.l5.onEventUpdate(da)}}Object(J.a)(D,"PPTSpeechClientObserver",null,[470]);class Q{constructor(da){this.I$=null;this.wIa=0;this.microphoneDeviceId="";this.fik=new D(da)}rWj(){return 2===this.wIa}SGj(){const da=this.mYd(),fa=Object.assign(new O,{accessToken:""});this.I$&&0!==this.wIa&&(this.I$.stopSpeechRecognition(),this.wIa=0);this.I$=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(da,
this.fik,fa,null,new G.a);return this.I$?!0:(K.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}lzh(){this.I$&&(0===this.wIa?(this.I$.startSpeechRecognition(),this.wIa=2):1===this.wIa&&(this.I$.resumeSpeechRecognition(),this.wIa=2))}Dsl(){this.I$&&(this.I$.stopSpeechRecognition(),this.wIa=0)}yFk(){this.I$&&(this.I$.pauseSpeechRecognition(),this.wIa=1)}setCustomSetting(da,fa){this.I$&&this.I$.setCustomSetting(da,fa)}mYd(){return Object.assign(new V,{speechMode:A.speechMode,
sourceLanguage:A.sourceLanguage,targetLanguages:A.targetLanguages,speechFDBase:A.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new R,{docId:A.docId,podsSessionId:A.podSessionId,userDataCenterClusterId:A.AKh,webServiceBase:A.webServiceBase}),userSessionId:A.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(J.a)(Q,"PPTSpeechClientProxy",null,[]);var Z;(function(da){da[da.none=0]="none";da[da.singleLineRibbon=1]="singleLineRibbon";
da[da.multipleLineRibbon=2]="multipleLineRibbon";da[da.slideShowToolbar=3]="slideShowToolbar";da[da.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";da[da.liveBroadcast=5]="liveBroadcast"})(Z||(Z={}));Object(J.b)("TranscriptionEntryPoint",Z);var P=d(678),ca=d(72);d.d(aa,"a",function(){return T});class T{constructor(){this.kf=this.K$=this.XC=this.Lfb=this.Or=this.kb=this.la=this.Ub=this.Hc=null;this.kDb=!1;this.Ll=null;this.Vfb=this.sic=0;this.HDg=!1;this.AIa=this.zIa="";this.A5c=!1;this.LCe=
"";this.Xre=0;this.KCb=this.N0=this.aGb="";this.lO=null;this.Bwa={};this.Fma=new u;this.v$=new Q(this.Fma);T.WGj()}init(da,fa,ma,ea,ra,F,na){x.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.kf=fa;this.la=da;this.Hc=ma;this.kb=ea;this.Ll=ra;this.Ub=F;this.lO=na;this.Or=document.createElement("div");this.Or.id="SubtitleContainer";this.Or.className="SubtitleContainer";this.Or.style.display=ca.a.Ff;this.Or.style.visibility=ca.a.Qs;this.Lfb=document.createElement("div");this.Lfb.id="SubtitleResultDiv";
this.Lfb.className="SubtitleResultDiv";this.Hc.pWi&&(this.Lfb.style.direction="rtl");this.XC=document.createElement("span");this.XC.id="SubtitleResultSpan";this.XC.className="SubtitleResultSpan";this.XC.setAttribute("aria-hidden","true");this.K$=document.createElement("span");this.K$.id="SubtitleAccessibilitySpan";this.K$.className="SubtitleAccessibilitySpan";this.K$.innerText="";this.K$.setAttribute("lang",this.Hc.xza);this.K$.setAttribute("aria-live","assertive");this.K$.setAttribute("aria-label",
ResourceStrings.L_SubtitleAccessibilityWindow);this.K$.setAttribute("aria-atomic","true");this.Lfb.appendChild(this.XC);this.Lfb.appendChild(this.K$);this.Or.appendChild(this.Lfb);this.kf.appendChild(this.Or);h.a.instance.pb(this.XC,()=>!1);e.AFrameworkApplication.fa.Nda?this.Qm():e.AFrameworkApplication.fa.ff(Object(n.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){this.aGb=this.getUserId();this.N0=e.AFrameworkApplication.fa.Ga("TenantId");this.KCb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ga("HostAuthType")||
"Unknown"}getUserId(){let da=e.AFrameworkApplication.fa.Ga("PptEditingUserId");r.a.Wa(da)&&(da=e.AFrameworkApplication.fa.Ga("LoggableUserId"),x.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",r.a.Wa(da)));return da}iZk(){this.Or.style.display=ca.a.Ff;this.Or.style.visibility=ca.a.Qs}transcribe(da,fa,ma,ea,ra,F){this.yAb()&&(this.Ll.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,P.a.xed),this.sic=window.setTimeout(Object(n.a)(this,this.kde,
"hideSoundReminderNotification"),3E3));this.pGl(fa,ma,ea,this.Hc);this.v$&&(this.v$.microphoneDeviceId=this.lO.microphoneDeviceId);this.Hc.Lh&&this.v$.SGj()?(this.Bwa.StartTime=F,this.Bwa.LastError="ErrorNone",this.Bwa.EntryPoint=Z[ra],this.Fma.j$h(Object(n.a)(this,this.q4g,"onFinalRecognitionTextHandler")),this.Fma.kbi(Object(n.a)(this,this.S5g,"onPartialRecognitionTextHandler")),this.Fma.d$h(Object(n.a)(this,this.A7g,"onSpeechProxyErrorHandler")),this.Fma.f$h(Object(n.a)(this,this.B7g,"onSpeechProxyEventUpdateHandler")),
this.Fma.jci(Object(n.a)(this,this.C7g,"onSpeechRecognitionStartedHandler")),this.v$.lzh(),this.v$.setCustomSetting("clientMetadata",JSON.stringify(this.z1f())),this.XC.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.XC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==ra),this.rHc(),this.kb.XGc(Object(n.a)(this,this.$wa,"onGetCurrentSlideDimensionsHandler")),this.kb.IPa(Object(n.a)(this,this.Jgd,"onSlideChangedHandler"))):this.e0e()}z1f(da=""){const fa=y.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
ma={};ma.userID=this.aGb;ma.tenantId=this.N0;ma.identityProvider=this.KCb;ma.audienceChannel="";ma.audienceGroup=fa.Ring||"Unknown";ma.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";ma.locale=this.la.NJa||"Unknown";ma.wacHost=fa.Host||"Unknown";ma.wacDatacenter=fa.WACDatacenter||"Unknown";ma.livePragueSessionInfo=da;return ma}e0e(){this.Or.style.display=ca.a.Ff;this.Or.style.visibility=ca.a.Qs;this.v$.Dsl();this.Fma.HZk(Object(n.a)(this,this.q4g,"onFinalRecognitionTextHandler"));this.Fma.W_k(Object(n.a)(this,
this.S5g,"onPartialRecognitionTextHandler"));this.Fma.CZk(Object(n.a)(this,this.A7g,"onSpeechProxyErrorHandler"));this.Fma.EZk(Object(n.a)(this,this.B7g,"onSpeechProxyEventUpdateHandler"));this.Fma.A0k(Object(n.a)(this,this.C7g,"onSpeechRecognitionStartedHandler"));this.kb.Yld(Object(n.a)(this,this.$wa,"onGetCurrentSlideDimensionsHandler"));this.kb.Rib(Object(n.a)(this,this.Jgd,"onSlideChangedHandler"));this.yAb()&&this.Ll.instance.hide();this.Bwa.EndTime=Date.now();x.a.J(512495705,817,15,JSON.stringify(this.Bwa,
T.BCl));this.Bwa={};this.Hc.Lvb=!1}rHc(){let da=3;this.Bwa.LastPosition=this.Hc.Vv;"AboveSlide"===this.Hc.Vv&&this.Or.style.visibility===ca.a.Hz?(this.Or.style.display=ca.a.$ya,this.Or.style.backgroundColor="black",this.Or.style.bottom="auto"):"BelowSlide"===this.Hc.Vv&&this.Or.style.visibility===ca.a.Hz?(this.Or.style.display=ca.a.$ya,this.Or.style.backgroundColor="black",this.Or.style.bottom="3%",da=-1):"TopOverlay"===this.Hc.Vv?(this.Or.style.display=ca.a.$ya,this.Or.style.backgroundColor="transparent",
this.Or.style.bottom="auto",da=5):"BottomOverlay"===this.Hc.Vv&&(this.Or.style.display=ca.a.$ya,this.Or.style.backgroundColor="transparent",this.Or.style.bottom="5%",da=-1);this.kDb&&document.getElementById("LiveURLBarLayerHost")?this.Or.style.top=-1<da?String.format("calc({0}% + {1})",da.toString(),"26px"):"auto":(this.Or.style.top=-1<da?da.toString()+"%":"auto",this.mwf())}isVisible(){return this.Or.style.visibility===ca.a.Hz}oDh(da,fa=""){A.KMf=da?["Live","Subtitles"]:["Subtitles"];this.kDb=da;
this.setVisibility(this.Or.style.visibility===ca.a.Hz);this.rHc();this.v$.setCustomSetting("clientMetadata",JSON.stringify(this.z1f(fa)));this.v$.setCustomSetting("slideIndex",this.Xre);this.v$.setCustomSetting("currentSpeechModes",JSON.stringify(A.KMf))}mga(da){this.Or.style.cursor=da?"default":"none"}mwf(){this.XC.style.fontSize=Math.floor(this.Or.clientHeight/2/1.5).toString()+"px";this.LCe=Math.floor(this.Or.clientHeight/12-2)+"px";this.XC.style.display="inline"}setVisibility(da){this.Or?(null===
da&&(da=this.Or.style.visibility===ca.a.Qs),this.Or.style.visibility=da?ca.a.Hz:ca.a.Qs):x.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}$wa(){this.mwf()}Jgd(da,fa){this.Xre=fa.slideIndex;this.v$.rWj()&&this.kDb&&(this.v$.setCustomSetting("currentSlideIndex",this.Xre),x.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(da){da?(this.v$.yFk(),this.lpc(),this.A5c=!0,this.Ub&&this.Ub.instance&&
this.Ub.instance.Arh()):(this.v$.lzh(),this.Ub&&this.Ub.instance&&this.Ub.instance.Brh())}kde(){this.yAb()&&(window.clearTimeout(this.sic),this.Ll.instance.hide())}pGl(da,fa,ma,ea){A.sourceLanguage=ea.Zoa;A.targetLanguages=ea.Nlb;A.podSessionId=da;A.AKh=fa;A.docId=ma;A.webServiceBase=this.la.podsWebServiceBase;A.speechFDBase=e.AFrameworkApplication.fa.Ga("715");da=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.eSa||this.Ub.instance.dr);A.speechMode=this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&
this.Ub.instance.CDa||da?"Live":"Subtitles"}cQf(da,fa){this.HDg||(this.XC.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.Vfb),this.XC.innerText=this.loj(da,fa),this.XC.scrollTop=this.XC.scrollHeight,this.Vfb=window.setTimeout(Object(n.a)(this,this.lpc,"resetSubtitlesToEmpty"),1E4),fa&&(this.K$.innerText=da,this.K$.focus()),this.XC.style.padding=r.a.Wa(da)?"0px":this.LCe)}uv(da){this.HDg||(this.XC.style.color="rgba( 255, 255, 0, 1 )",r.a.Wa(da)&&(da=ResourceStrings.L_SubtitleGenericErrorMessage),
window.clearTimeout(this.Vfb),this.XC.innerText="["+da+"]",this.XC.scrollTop=this.XC.scrollHeight,this.Vfb=window.setTimeout(Object(n.a)(this,this.lpc,"resetSubtitlesToEmpty"),1E4),this.XC.style.padding=this.LCe,this.K$.innerText="",this.K$.focus())}Pxj(da){if(null!==da)switch(da){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.uv(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.Bwa.LastError="MicrophoneError";break;case "FailedToConnect":this.uv(ResourceStrings.L_SubtitleRetryErrorMessage);
this.Bwa.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.uv(ResourceStrings.L_SubtitleGenericErrorMessage);this.Bwa.LastError="FailedToCreateSpeechSession";break;default:x.a.J(512495703,830,15,"HandleSpeechProxyError {0}",da)}}q4g(da,fa){this.Or.style.visibility!==ca.a.Qs&&this.cQf(fa[this.Hc.Nlb],!0)}S5g(da,fa){this.Or.style.visibility!==ca.a.Qs&&this.cQf(fa[this.Hc.Nlb],!1)}A7g(da,fa){x.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",fa);(da=fa.toString())&&
(-1<da.indexOf("NotAllowedError")||-1<da.indexOf("NotFoundError")||-1<da.indexOf("NotReadableError")||-1<da.indexOf("MicrophoneError"))&&this.yAb()&&this.Ll.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,P.a.SYa);this.Pxj(da)}C7g(da,fa){({SlideShowCoreFrame:da}=d(732));const {SlideshowFrame:ma}=d(1005);x.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",fa.toString());Object(v.a)(da,this.kb)?Object(B.a)(da,this.kb).ahd(fa.toString()):Object(v.a)(ma,this.kb)&&this.la.fjd&&
Object(B.a)(ma,this.kb).ahd(fa.toString());this.lpc();this.yAb()&&this.Ll.instance.hide()}B7g(da,fa){if(this.yAb())switch(da=fa.eventName,da){case "MediaEvent":"AudioDeviceConnected"===fa.mediaStatus&&this.Ll.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,P.a.xed);break;case "ConnectionRetry":this.Ll.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,P.a.SYa);this.uv(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const ma=fa.shortCode;da=fa.longCode;
const ea=fa.shortString,ra=fa.longString;switch(fa.severity){case 0:this.Ll.instance.hide();break;case 1:(fa=0<ma?T.AY[ma]:ea)&&this.Ll.instance.show(fa,P.a.ZGb);break;case 2:(fa=0<ma?T.AY[ma]:ea)&&this.Ll.instance.show(fa,P.a.SYa),fa=null===da?ra:T.AY[da],r.a.Wa(fa)||(window.clearTimeout(this.Vfb),this.uv(fa),this.Vfb=window.setTimeout(Object(n.a)(this,this.lpc,"resetSubtitlesToEmpty"),3E4))}break;default:x.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",da)}}yAb(){return this.la.pptEditorVoiceUXEnabled&&
!!this.Ll&&!!this.Ll.instance}lpc(){this.XC.style.color="rgba( 255, 255, 255, 1 )";this.XC.innerText="";this.XC.scrollTop=this.XC.scrollHeight;this.AIa=this.zIa="";this.A5c=!1;this.Vfb=0;this.XC.style.padding="0px"}loj(da,fa){this.A5c?this.ffi(da):this.E1k(da);this.A5c=fa;return r.a.Wa(this.zIa)||r.a.Wa(this.AIa)?r.a.Wa(this.zIa)?this.AIa:this.zIa:this.zIa+"\n"+this.AIa}ffi(da){this.zIa=r.a.Wa(this.AIa)?this.zIa:this.AIa;this.AIa=da}E1k(da){r.a.Wa(this.zIa)||r.a.Wa(this.AIa)?this.zIa=da:this.AIa=
da}static get instance(){return T.Rp}static WGj(){T.AY[1]=ResourceStrings.L_SubtitleDetection_Listening;T.AY[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;T.AY[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;T.AY[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;T.AY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static BCl(da,fa){return"undefined"===typeof fa?null:fa}}T.AY=Array(20);T.Rp=new T;Object(J.a)(T,"SlideshowSubtitles",null,[410])},1010:function(J,
aa,d){J=d(0);var h=d(27),e=d(55),r=d(57),n=d(270),v=d(312);class B{constructor(Ka,Ma=null){this.ZXh=Ka;this.CS=Ma||v.a.W7d(e.a.N6a,"")}get Qu(){return this.ZXh}get Nb(){return this.CS}kWe(Ka){this.Nb.d++;return this.Qu.kWe(Ka)}wMb(Ka){this.Nb.e++;return this.Qu.wMb(Ka)}OH(Ka){this.Nb.f++;return this.Qu.OH(Ka)}g0a(Ka){this.Nb.h++;return this.Qu.g0a(Ka)}PY(Ka){this.Nb.i++;return this.Qu.PY(Ka)}MY(Ka){this.Nb.j++;return this.Qu.MY(Ka)}h6(Ka){this.Nb.k++;return this.Qu.h6(Ka)}OY(Ka){this.Nb.l++;return this.Qu.OY(Ka)}aWe(Ka){this.Nb.m++;
return this.Qu.aWe(Ka)}YKa(Ka,Ma=!1){this.Nb.n++;return this.Qu.YKa(Ka,Ma)}Bbe(){this.Nb.o++;return this.Qu.Bbe()}UZe(){this.Nb.p++;return this.Qu.UZe()}JLb(Ka){this.Nb.m++;return this.Qu.JLb(Ka)}Sr(Ka){this.Nb.q++;return this.Qu.Sr(Ka)}Joa(Ka){this.Nb.r++;return this.Qu.Joa(Ka)}dMb(Ka){this.Nb.g++;return this.Qu.dMb(Ka)}Wpd(Ka){return this.Qu.Wpd(Ka)}m0a(Ka){this.Nb.s++;return this.Qu.m0a(Ka)}Bpd(Ka){this.Nb.s++;return this.Qu.Bpd(Ka)}hga(Ka){this.Nb.s++;return this.Qu.hga(Ka)}l0a(Ka){this.Nb.s++;
return this.Qu.l0a(Ka)}jkb(Ka){this.Nb.t++;return this.Qu.jkb(Ka)}Xpd(Ka){this.Nb.u++;return this.Qu.Xpd(Ka)}xqc(Ka){this.Nb.v++;return this.Qu.xqc(Ka)}Moa(Ka){return this.Qu.Moa(Ka)}apd(Ka){this.Nb.z++;return this.Qu.apd(Ka)}TSe(){return this.Qu.TSe()}cLa(Ka,Ma){this.Nb.w++;this.Nb.x++;return this.Qu.cLa(Ka,Ma)}C1(Ka){this.Nb.y++;return this.Qu.C1(Ka)}clearFormatting(){return this.Qu.clearFormatting()}clone(){return new B(this.Qu.clone(),this.Nb)}}Object(J.a)(B,"FormattingStewardUsageCollector",
null,[1078]);class y extends B{constructor(Ka,Ma=null){super(Ka,Ma)}get D5(){return this.Qu}get iE(){return this.D5.iE}set iE(Ka){this.D5.iE=Ka}get textIndent(){return this.D5.textIndent}get marginLeft(){return this.D5.marginLeft}get zhd(){return this.D5.zhd}get lineSpacing(){return this.D5.lineSpacing}get qga(){return this.D5.qga}get e2c(){return this.D5.e2c}get Hfa(){return this.D5.Hfa}get paragraph(){return this.D5.paragraph}set paragraph(Ka){this.D5.paragraph=Ka}get j9a(){return this.D5.j9a}dud(Ka){return this.D5.dud(Ka)}J3e(Ka){return this.D5.J3e(Ka)}clone(){const Ka=
this.Qu.clone();return new y(Ka,this.Nb)}}Object(J.a)(y,"FormattingStewardUsageCollector",B,[1077,1078]);var x=d(33),A=d(77),E=d(184),u=d(677),K=d(54),G=d(147),O=d(74),R=d(59),V=d(352),D=d(1101),Q=d(339),Z=d(47),P=d(1212),ca=d(1207),T=d(1206),da=d(113),fa=d(40),ma=d(83),ea=d(42),ra=d(38),F=d(88),na=d(308);class ka{}ka.yellow="FFFF00";ka.lime="00FF00";ka.aqua="00FFFF";ka.fuchsia="FF00FF";ka.blue="0000FF";ka.red="FF0000";ka.navy="000080";ka.teal="008080";ka.green="008000";ka.purple="800080";ka.maroon=
"800000";ka.olive="808000";ka.gray="808080";ka.Npl="C0C0C0";ka.black="000000";Object(J.a)(ka,"FontHighlightColorEnum",null,[]);var Ua=d(342),za=d(51),ha=d(890),ua=d(372),Ga=d(108);class sa{constructor(Ka,Ma,Oa,qa,Ya,Fb,hc,ec,Tb=null,vb=!1){this.Zv=this.wCc=null;this.HVb=0;this.P9e=this.GVb=null;this.D2=0;this.GOa=this.NEc=this.YAc=this.vEc=this.W3a=this.Yha=this.kBc=this.$Ec=null;this.BNf=.25*da.Font.yI;this.paragraph=Ka;this.Jf=Ma;this.KK=Oa;this.yP=qa;this.uha=Ya;this.IV=Fb;this.vZ=hc;this.f3a=
ec;Tb?(Ga.a(4223818,307,!!Tb.Zv),this.Zv=Tb.Zv.tKc(this.paragraph),this.HVb=Tb.HVb,this.GVb=Tb.GVb,Tb.Yha&&(this.Yha=new ha.a,this.Yha.afterSpacing.value=Tb.Yha.afterSpacing.value,this.Yha.beforeSpacing.value=Tb.Yha.beforeSpacing.value),Tb.W3a&&(this.W3a=Tb.W3a.clone()),this.D2=Tb.D2,this.NEc=Tb.NEc.clone(),this.$Ec=Tb.$Ec,this.kBc=Tb.kBc,this.vEc=Tb.vEc,this.YAc=Tb.YAc,Tb.Hfa&&(this.GOa=Tb.Hfa)):(this.Zv=new na.a(this.paragraph,0),this.Zv.formatting=new Ua.a(this.Zv,V.a.nil),Ma=za.a.VQa(Ka),Ma=this.yP.xs(Ma),
this.ebl(Ma),sa.tll(Ka)?(this.uha.dWe(this.Zv.formatting,Ma,vb),this.D2=Ka.Sa(fa.a.Jl)?Ka.eb(fa.a.Jl):0):this.D2=-1,this.HVb=0,this.GVb=null,this.Yha=this.$8i(),this.f3a&&(this.Yha=this.uha.QW(Ka),this.W3a=this.uha.C8d(Ka),this.vEc=this.uha.nTa(Ka),this.YAc=this.uha.N8(Ka)),this.NEc=new D.DictionaryPropertySet,this.uha.PVe(this.Zv.formatting,Ka,vb))}get paragraph(){return this.wCc}set paragraph(Ka){Ga.a(4223816,307,!!Ka&&x.ParagraphReader.ae(Ka));this.wCc=Ka}get j9a(){return this.Zv.formatting}get Glc(){return this.HVb}get R9g(){return this.GVb}get a3(){return this.P9e}get iE(){return this.D2}set iE(Ka){Ga.a(4223817,
307,1===Ka||2===Ka||3===Ka||ra.a.instance.ga(54)&&6===Ka);this.D2=Ka}get textIndent(){return this.$Ec}get marginLeft(){return this.kBc}get zhd(){return this.Yha}get lineSpacing(){return this.W3a}get qga(){return this.vEc}get e2c(){return this.YAc}get Hfa(){return this.GOa}ebl(Ka){const Ma=this.yP.language(Ka);Ma&&this.Jf.vqc(this.Zv.formatting,Ma,0,Ka.cache.SUa,!1)}$8i(){if(ra.a.instance.ga(54))return null;const Ka=new ha.a;Ka.afterSpacing.value=this.BNf;Ka.beforeSpacing.value=this.BNf;return Ka}kWe(Ka){(Ka=
n.a.xe(Ka))&&this.Jf.h0a(this.Zv.formatting,Ka.LCID);return!0}wMb(){return!1}OH(Ka){this.Jf.OH(this.Zv.formatting,Ka);return!0}g0a(Ka){this.Jf.setItalic(this.Zv.formatting,Ka);return!0}PY(Ka){this.Jf.PY(this.Zv.formatting,Ka);return!0}MY(Ka){this.Jf.MY(this.Zv.formatting,Ka);return!0}h6(Ka){this.Jf.h6(this.Zv.formatting,Ka);return!0}OY(Ka){this.Jf.OY(this.Zv.formatting,Ka);return!0}aWe(Ka){if(0>=Ka)return!1;this.Jf.Pq(this.Zv.formatting,Ka);return!0}YKa(Ka,Ma){if(!Ka||""===Ka)return!1;if(({fontInfo:Oa}=
Q.FontUtils.UBl(Ka)).returnValue)return this.Jf.YU(this.Zv.formatting,Oa.fontName),!0;var Oa=!1;const qa=Q.FontUtils.dG(Ka);Ma&&this.Bac(qa,this.IV)&&(this.IV.createFontUrl(Ka),Oa=!0);this.Bac(qa,this.vZ)&&(Oa=!0);Oa&&this.Jf.YU(this.Zv.formatting,qa);return Oa}Bac(Ka,Ma){return!!Ma&&Ma.isEnabled&&Ma.Bac(Ka)}Bbe(){this.Jf.RVc(this.Zv.formatting);return!0}UZe(){this.Jf.yrd(this.Zv.formatting);return!0}JLb(Ka){if(0>=Ka)return!1;this.Jf.JLb(this.Zv.formatting,Ka);return!0}Sr(Ka){var {Box4PasteSteward:Ma}=
d(251);if(!this.Jf.Smg(Ka)){if(null===Ka||""===Ka)return!1;Ka=Ma.F7a(Ka)}Ma=null;this.Hfa&&this.Hfa.hasOwnProperty(ea.a.listLevel.id.toString())&&(Ma=this.Hfa[ea.a.listLevel.id.toString()]);this.Jf.Sr(this.Zv.formatting,Ka,Ma);return!0}Joa(Ka){const {Box4PasteSteward:Ma}=d(251);if(!Ka||""===Ka||ra.a.instance.ga(49)&&!sa.rqj().contains(Ka)||this.uha.Avh(this.Zv.formatting))return!1;this.Jf.Joa(this.Zv.formatting,Ma.F7a(Ka));return!0}dMb(Ka){this.Jf.dMb(this.Zv.formatting,Ka);return!0}Wpd(Ka){let Ma=
0;switch(Z.a.rg(Ka)){case "small-caps":Ma=1;break;case "uppercase":Ma=2}this.Jf.Cm(this.Zv.formatting,ma.a.capitalization,Ma);return!0}apd(Ka){const {Box4PasteSteward:Ma}=d(251);if(!Ka||""===Ka)return!1;this.NEc.setValue(fa.a.JJc,parseInt(Ma.F7a(Ka),16));return!0}l0a(Ka){return 0>=Ka?!1:this.Bpd(F.StyleReader.hmj(Ka))}m0a(Ka){this.clearFormatting();this.HVb=Ka;return!0}Bpd(Ka){const {Box4PasteSteward:Ma}=d(251);return Ka&&0<Ka.length&&Ma.NNb&&Ma.NNb.$G(Ka)?(this.GVb=Ka,!0):!1}hga(Ka){const {Box4PasteSteward:Ma}=
d(251);return Ka&&0<Ka.length&&Ma.NNb&&Ma.NNb.$G(Ka)?(this.P9e=Ka,!0):!1}J3e(Ka){if(this.a3){Ka=d(251).Box4PasteSteward.NNb||F.StyleReader.sL(Ka);if(!Ka)return Ga.a(41968715,307,!1),!1;(Ka=Ka.$G(this.a3))&&this.Jf.hga(this.Zv.formatting,Ka);return!0}return!1}cLa(Ka,Ma){if(ra.a.instance.ga(54))return!1;Ga.a(5297416,307,0<=Ka&&0<=Ma);0<=Ka&&(this.Yha.beforeSpacing.value=Ka);0<=Ma&&(this.Yha.afterSpacing.value=Ma);return 0<=Ka||0<=Ma}C1(Ka){if(!ra.a.instance.ga(54)||!Ka)return!1;const Ma=parseFloat(Z.a.substring(Ka,
0,Z.a.rg(Ka).indexOf("px")));if(!isNaN(Ma))return this.W3a=new ua.a(3,P.a.Lfa(Ma,1)),!0;Ka=parseFloat(Z.a.substring(Ka,0,Z.a.rg(Ka).indexOf("%")));return isNaN(Ka)?!1:(this.W3a=new ua.a(2,Ka/100),!0)}jkb(Ka){let Ma=0;if(!Ka||""===Ka)return!1;switch(Ka){case "left":Ma=1;break;case "center":Ma=2;break;case "right":Ma=3;break;case "justify":ra.a.instance.ga(54)&&(Ma=6)}if(0===Ma)return!1;this.iE=Ma;return!0}Xpd(Ka){this.$Ec=Ka;return!0}xqc(Ka){this.kBc=Ka;return!0}Moa(Ka){this.GOa=JSON.parse(Ka);return this.Hfa?
!0:!1}clearFormatting(){this.Zv.formatting=new Ua.a(this.Zv,V.a.nil);return!0}TSe(){this.D2=0;return!0}dud(Ka){var {Box4PasteSteward:Ma}=d(251);if(!ra.a.instance.ga(71))return!1;if(0<this.Glc&&Ma.AJa[this.Glc]){Ga.a(4223819,307,1<=this.Glc);Ga.a(4223820,307,7>=this.Glc);Ma=F.StyleReader.sL(Ka);if(!Ma)return Ga.a(4223821,307,!1),!1;Ma=Ma.$G(d(251).Box4PasteSteward.AJa[this.Glc]);this.KK.Eaa(Ma,Ka,!1);return!0}if(this.R9g){Ma=d(251).Box4PasteSteward.NNb||F.StyleReader.sL(Ka);if(!Ma)return Ga.a(41968716,
307,!1),!1;this.KK.Eaa(Ma.$G(this.R9g),Ka,!1);return!0}return!1}clone(){return new sa(this.paragraph,this.Jf,this.KK,this.yP,this.uha,this.IV,this.vZ,this.f3a,this)}static rqj(){sa.QP||(sa.QP=new ca.a(T.a.Hn()),sa.QP.add(ka.yellow),sa.QP.add(ka.lime),sa.QP.add(ka.aqua),sa.QP.add(ka.fuchsia),sa.QP.add(ka.blue),sa.QP.add(ka.red),sa.QP.add(ka.navy),sa.QP.add(ka.teal),sa.QP.add(ka.green),sa.QP.add(ka.purple),sa.QP.add(ka.maroon),sa.QP.add(ka.olive),sa.QP.add(ka.gray),sa.QP.add(ka.Npl),sa.QP.add(ka.black));
return sa.QP}static tll(Ka){if(!ra.a.instance.ga(71))return!0;Ka=F.StyleReader.wQ(F.StyleReader.aE(Ka));return Ka===F.StyleReader.WKh||Ka===F.StyleReader.CMa||Ka===F.StyleReader.ZKh||Ka===F.StyleReader.cpa}}sa.QP=null;Object(J.a)(sa,"FormattingSteward",null,[1077,1078]);class Ba{W3e(){return!1}Ube(Ka){return Ka}Moa(){}aMb(){}TZc(){return!1}get R_c(){return!1}C1(){}cLa(){}Esh(){}urh(){}get Dvh(){return!1}}Object(J.a)(Ba,"NoOpPasteStewardBridge",null,[1076]);var pa=d(18);class ia{constructor(Ka,Ma){this.gqk=
Ka;this.hqk=Ma||"Normal"}}Object(J.a)(ia,"NoteTagInfoBox4",null,[]);const Da=Ka=>{const Ma=new pa.a;for(let Oa of Ka)Ka=new ia(Oa.gqk,Oa.hqk),Ma.add(Ka);return Ma};d.d(aa,"a",function(){return Xa});class Xa{constructor(Ka,Ma,Oa=null,qa=null){this.vZ=this.IV=null;this.s0i=h.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.Dlf=0;this.Ab=Ka;this.CG=Ma;this.lZ=qa||new Ba;this.CS=Oa||v.a.W7d(e.a.N6a,"")}get Nb(){return this.CS}get characterPropertiesEditor(){return Xa.gh||
(Xa.gh=r.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.IV||(this.IV=r.a.instance.rb("Box4.IFontService"))}get UCa(){return this.vZ||(this.vZ=r.a.instance.rb("Box4.CustomFontService"))}reset(){}get q2b(){return this.g7d(!1)}g7d(Ka){Ga.a(4223770,307,R.OutlineElementReader.$g(this.Ab));const Ma=K.OutlineElementNavigator.oi(this.Ab);K.OutlineElementNavigator.Re(this.Ab);Ga.a(4223771,307,!!Ma&&x.ParagraphReader.ae(Ma));Ka=new sa(Ma,Xa.mh,Xa.jP,Xa.f1i,Xa.g1i,this.fontService,
this.UCa,this.s0i,void 0,Ka);return new y(Ka,this.Nb)}Y0(){}Kna(){}kZa(){}Jna(){}Ina(){}Ywa(){}Xwa(){}wA(){}vA(){}eZa(){}dZa(){}cxa(){}sJa(){}Nna(){}Lna(){}bxa(){}Mna(){}fZa(){}BGb(Ka){R.OutlineElementReader.$g(this.Ab)?(Xa.Qh.i9b(this.Ab,!0),K.OutlineElementNavigator.HJ(this.Ab,!1,!1)):O.OutlineReader.au(this.Ab)?G.OutlineNavigator.Y$(this.Ab)?Ka?(this.Ab.Oi(),Xa.HB.iW(this.Ab,!1)):Xa.Qh.Goc(this.Ab):Xa.HB.iW(this.Ab,!1):Ga.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Ab.vi)}YSa(Ka){let Ma=
null;if(Ka&&Ka.FU&&Ka.cultureName)try{Ma=Object.assign(new u.a,{languageId:n.a.xe(Ka.cultureName).LCID})}catch(Oa){Ga.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Ka.cultureName,Oa)}Ma||null==this.CG||(Ma=Object.assign(new u.a,{languageId:this.CG}));return Ma}get yM(){return this.Dlf}set yM(Ka){this.Dlf=Ka}YHc(){}Qtd(){}NVd(){}get D7a(){return!1}get S7a(){return!1}J0j(Ka){let Ma=1;if(Ka.Dkg){var Oa=0;switch(Ka.listStyleType){case 1:Ma=0;break;case 7:Ma=1;break;case 8:Ma=2;break;case 9:Ma=
3;break;case 10:Ma=4;break;case 11:Ma=5}}else switch(Oa=1,Ka.listStyleType){case 1:Ma=0;break;case 3:Ma=1;break;case 4:Ma=2;break;case 5:Ma=3}let qa;Oa=(qa=A.ListReader.K8a)?E.a.yN(Oa,Ma,Da(Ka.L5),Ka.listId,Ka.listLevel,Ka.levelText,Ka.font):E.a.yN(Oa,Ma,Da(Ka.L5));Ka.Dkg&&!Ka.TKj&&(Oa.yA=qa&&0<Ka.listId&&0<=Ka.listLevel&&!Ka.gIb?Ka.Qrl:Ka.UJi);this.lZ.aMb(this.Ab,Oa,Ka);return Oa}tY(){}qY(){}sY(){}rY(){}pY(){}oY(){}static get Qh(){return Xa.Fi||(Xa.Fi=r.a.instance.resolve("Box4.IOutlineElementEditor"))}static get HB(){return Xa.Ux||
(Xa.Ux=r.a.instance.resolve("Box4.IOutlineEditor"))}static get mh(){return Xa.Jf||(Xa.Jf=r.a.instance.resolve("Box4.IFormattingEditor"))}static get jP(){return Xa.KK||(Xa.KK=r.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get f1i(){return Xa.yP||(Xa.yP=r.a.instance.resolve("Box4.IFormattingReader"))}static get g1i(){return Xa.uha||(Xa.uha=r.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}Xa.Fi=null;Xa.Ux=null;Xa.gh=null;Xa.Jf=null;Xa.KK=null;Xa.yP=null;Xa.uha=null;Object(J.a)(Xa,
"Box4PasteStewardBase",null,[1068,1069,1046])},1013:function(J,aa,d){d.r(aa);J=d(0);var h=d(722),e=d(1031),r=d(1018),n=d(195),v=d(14),B=d(40),y=d(74),x=d(32),A=d(39),E=d(28),u=d(43);class K{constructor(T,da){this.re=T;this.$f=da}}Object(J.a)(K,"RowSpan",null,[]);class G{constructor(T){this.AB=T;this.vIa=[]}BPd(T,da){Array.add(this.vIa,new K(T,da))}w5k(T){for(let da=0;da<this.vIa.length;da++){const fa=this.vIa[da];T<=fa.re&&fa.re++;T<=fa.$f&&fa.$f++}}get x(){return this.AB}get inh(){return this.vIa}static Dne(T,
da){return T.AB===da}static QWd(T,da){T=T.AB-da.AB;return 0<T?1:0>T?-1:0}}Object(J.a)(G,"ColSplit",null,[]);const O=(T,da,fa)=>{let ma;ma=-1;for(let ea=0;ea<T.length;++ea)if(fa(T.ga(ea),da))return ma=ea,{returnValue:!0,wyb:ma};return{returnValue:!1,wyb:ma}};class R{constructor(T,da){this.he=T;this.Nf=da}}Object(J.a)(R,"ColSpan",null,[]);class V{constructor(T){this.BB=T;this.vIa=[]}BPd(T,da){Array.add(this.vIa,new R(T,da))}cwi(T){for(let da=0;da<this.vIa.length;da++){const fa=this.vIa[da];T<=fa.he&&
fa.he++;T<=fa.Nf&&fa.Nf++}}get kHf(){return this.vIa}get y(){return this.BB}static Dne(T,da){return T.BB===da}static QWd(T,da){T=T.BB-da.BB;return 0<T?1:0>T?-1:0}}Object(J.a)(V,"RowSplit",null,[]);var D=d(959),Q=d(29);class Z{constructor(T,da,fa,ma,ea,ra,F,na,ka,Ua,za,ha,ua,Ga,sa){this.HUa=!1;this.$i=this.HJc=this.jVg=this.tbd=null;this.SFh=T;this.Uc=da;this.Kyh=fa;this.K0a=ma;this.jwd=ea;this.tableNode=ra;this.Md=F;this.ZY=na;this.YSa=ka;this.x5k=Ua;this.dwi=za;this.tnd=ha;this.CKc=ua;this.rows=
Ga;this.cols=sa;this.L0a=0;this.zac=!1}K6a(T){this.tbd=new Date;this.jVg=T}v8a(){this.tbd>Q.App.Ym&&this.Uc&&this.Uc.Va(this.jVg,(+new Date-+this.tbd).toString());this.tbd=Q.App.Ym}finish(){const {TableMergeSplitEditor:T}=d(1013);this.Uc&&(this.$i&&(this.zac=!1,this.Uc.Va(T.sOl,this.$i.message)),this.Uc.Va("SplitCellsSucceeded",this.zac.toString()),this.Uc.finish(),this.Uc=null);if(this.$i)throw this.$i;this.Kyh&&this.Kyh(this.zac,this.K0a)}}Object(J.a)(Z,"SplitCellsArguments",null,[]);var P=d(331);
d.d(aa,"TableMergeSplitEditor",function(){return ca});class ca{constructor(T,da,fa,ma,ea,ra,F,na,ka,Ua,za,ha,ua,Ga,sa){this.Pb=T;this.cY=da;this.sA=fa;this.o5=ma;this.Dbd=ea;this.XL=ra;this.f$c=F;this.Kq=ka;this.qea=Ua;this.Ceb=za;this.Tk=ha;this.Jb=ua;this.pa=Ga;this.Cad=sa}merge(T,da,fa){const ma=T.nf(da.re,da.he),ea=this.Pb.Mc(ma);let ra=ea.aB(1);const F=[A.a.rowId,A.a.cellId];ra&&ea.zc();let na=!0;for(let Ua=da.re;Ua<da.$f;++Ua){let za=T.nf(Ua,da.he);for(let ha=da.he+(Ua===da.re?1:0);ha<da.Nf;++ha)if(ha!==
da.he&&(za=T.nf(Ua,ha)),!za||!za.isGhostCell){za.io(A.a.rowSpan,A.a.colSpan);za.isGhostCell=!0;var ka=x.GraphIterator.nb(za);y.OutlineReader.isEmpty(ka)?this.jih(ka):(na&&y.OutlineReader.isEmpty(ea)&&(na=!1,ra=null,this.jih(ea)),this.XL.L0i(za,ua=>{this.XL.ay(ea.currentNode,ua,F);return!0},ua=>11===ua.type||22===ua.type||12===ua.type),ka=this.Pb.a8d(ka),ka.Bb(1),this.XL.jok(ea,ra,ka.role,ka.role,ka),ka.Uxb(1),ra=ka.currentNode)}}this.o5.nEl(fa,ma,da);ma.rowSpan=da.UO;ma.colSpan=da.AR;T.setValue(A.a.complexTable,
!0);this.f$c.wRe(T);T.Hda(511);this.sA.n9b(T);return ma}Uql(T,da,fa,ma,ea,ra,F,na,ka){if(1>=fa&&1>=ma)ka&&ka(!0,da);else{var Ua=new Date,za=u.a.zk("SplitCells",1);za.Oj=!0;var ha=new h.a,ua=new e.a,Ga=new e.a,sa=this.qea.zDa(T,ea,da);da=this.Kq.DPc(ea,da);var Ba=ra.L6f();for(ra=ra.G0f();sa.moveNext();){ha.add(sa.u5b().id.toString());const Xa=sa.fA;for(var pa=1;pa<fa;pa++){var ia=Ba[Xa.re];ia+=(Ba[Xa.$f]-ia)*pa/fa;var Da=void 0;({wyb:Da}=O(ua,ia,V.Dne)).returnValue||(Da=ua.length,ua.add(new V(ia)));
ua.ga(Da).BPd(Xa.he,Xa.Nf)}for(pa=1;pa<ma;pa++)ia=ra[Xa.he],ia+=(ra[Xa.Nf]-ia)*pa/ma,({wyb:Da}=O(Ga,ia,G.Dne)).returnValue||(Da=Ga.length,Ga.add(new G(ia))),Ga.ga(Da).BPd(Xa.re,Xa.$f)}ua=ua.toArray();Ga=Ga.toArray();ua.sort((Xa,Ka)=>V.QWd(Ka,Xa));Ga.sort((Xa,Ka)=>G.QWd(Ka,Xa));za.Va("Prep",(+new Date-+Ua).toString());Ua=this.Jb.oe(15);Ua.nc(T);T=new Z(Ua,za,ka,da,ha,T,F,ea,na,Ba,ra,ua,Ga,fa,ma);T=new r.a(null,Object(v.a)(this,this.brl,"splitRowSeams"),T);T.Qi=!1;T.Pl("SplitTableCells");T.run()}}brl(T,
da){try{for(da.K6a("SplitRowSeams");da.L0a<da.tnd.length;){const fa=({HUa:da.HUa}=this.$Ci(da.tableNode,da.Md,da.ZY,da.YSa,da.x5k,da.tnd[da.L0a])).returnValue;da.L0a++;if(da.HUa){let ma;(ma=da.K0a).$f=ma.$f+1;for(let ea=0;ea<da.CKc.length;ea++)da.CKc[ea].w5k(fa)}if(T.jpa)return!0}da.v8a();da.L0a=0;T.Yg(Object(v.a)(this,this.Yql,"splitColSeams"))}catch(fa){da.$i=fa,T.Yg(Object(v.a)(this,this.qlb,"tearDownSplit"))}return!0}Yql(T,da){try{for(da.K6a("SplitColSeams");da.L0a<da.CKc.length;){const fa=({HUa:da.HUa}=
this.ZCi(da.tableNode,da.Md,da.ZY,da.YSa,da.dwi,da.CKc[da.L0a])).returnValue;da.L0a++;if(da.HUa){let ma;(ma=da.K0a).Nf=ma.Nf+1;for(let ea=0;ea<da.tnd.length;++ea)da.tnd[ea].cwi(fa)}if(T.jpa)return!0}da.v8a();da.L0a=0;T.Yg(Object(v.a)(this,this.sPb,"updateIsComplexTableProperty"))}catch(fa){da.$i=fa,T.Yg(Object(v.a)(this,this.qlb,"tearDownSplit"))}return!0}sPb(T,da){try{da.K6a("UpdateComplex"),this.f$c.b5e(this.Pb.Mc(da.tableNode)),da.v8a(),da.HJc=this.qea.zDa(da.tableNode,da.ZY,da.K0a),T.Yg(Object(v.a)(this,
this.u_i,"fixSplitCells"))}catch(fa){da.$i=fa,T.Yg(Object(v.a)(this,this.qlb,"tearDownSplit"))}return!0}u_i(T,da){try{for(da.K6a("FixInsideBorders");da.HJc.moveNext();)if(da.jwd.contains(da.HJc.u5b().id.toString())&&this.t_i(da.tableNode,da.ZY,da.HJc,da.rows,da.cols),T.jpa)return!0;da.v8a();T.Yg(Object(v.a)(this,this.CTi,"ensureMinRowHeightColumnWidth"))}catch(fa){da.$i=fa,T.Yg(Object(v.a)(this,this.qlb,"tearDownSplit"))}return!0}CTi(T,da){try{da.K6a("EnsureMinHeightWidth"),1<da.rows&&this.DTi(da.tableNode,
da.K0a),1<da.cols&&this.BTi(da.tableNode,da.K0a),da.v8a(),T.Yg(Object(v.a)(this,this.setSelection,"setSelection"))}catch(fa){da.$i=fa,T.Yg(Object(v.a)(this,this.qlb,"tearDownSplit"))}return!0}setSelection(T,da){try{da.K6a("SetSelection");da.zac=!da.K0a.cSa();if(da.zac){const fa=this.Cad.FIi(da.tableNode,da.ZY,da.K0a);fa&&this.pa.RE(fa)}da.v8a();da.K6a("Render");T.Qi||da.SFh.Irh(T);da.SFh.dispose();T.Yg(Object(v.a)(this,this.qlb,"tearDownSplit"))}catch(fa){da.$i=fa,T.Yg(Object(v.a)(this,this.qlb,"tearDownSplit"))}return!0}qlb(T,
da){da.v8a();da.finish();return!1}$Ci(T,da,fa,ma,ea,ra){var F;let na=({rle:F}=D.c(ea,ra.y)).returnValue;if(F=!F){na++;var ka=ea[na-1],Ua=ea[na],za=this.Pb.Mc(T);this.Fjc(za,na-1);var ha=za.currentNode;za=this.f$c.lfe(za);ka=ra.y-ka;ha.setValue(A.a.tu,da.qf(ka,1));ka=Ua-ra.y;za.setValue(A.a.tu,da.qf(ka,1));Array.insert(ea,na,ra.y);fa.qUa(3)}for(da=0;da<ra.kHf.length;++da){ea=ra.kHf[da];Ua=[];for(ha=ea.he;ha<=ea.Nf;++ha)({vla:ka}=this.Dbd.GEh(T,fa,ha,na)),Ua[Ua.length]=ka;ha=new P.a;ha.he=ea.he;ha.Nf=
ea.Nf;ha.re=na-1;ha.$f=na+1;for(ha=this.qea.zDa(T,fa,ha);ha.moveNext();)ka=ha.fA,za=ha.u5b(),this.CJf(na,ka.he,za),this.Sqh(na,ka.he,za,ma);for(ha=ea.he;ha<ea.Nf;++ha){ka=T.nf(na-1,ha);za=T.nf(na,ha);var ua=this.Kq.EI(fa,na-1,ha);ua.he===ha&&(ka=T.nf(ua.re,ua.he),ua=na-ua.re,za.rowSpan=ka.rowSpan-ua,ka.rowSpan=ua,za.colSpan=ka.colSpan);za.isGhostCell=ka.isGhostCell}fa.qUa(1);this.o5.B4d(T,fa,na,ea.he,ea.Nf,!0);for(let Ga=ea.he,sa=0;Ga<=ea.Nf;++Ga,++sa)Ua[sa]&&this.o5.mXe(T,fa,Ga,na,na+1,Ua[sa])}return{returnValue:na,
HUa:F}}ZCi(T,da,fa,ma,ea,ra){var F;let na=({rle:F}=D.b(ea,ra.x)).returnValue;if(F=!F){na++;var ka=ea[na-1],Ua=ea[na],za=this.Pb.Mc(T);this.cY.I_g(za);za.$p(na-1,1);this.f$c.kfe(za);if(za=T.sa(B.a.$u,null))za=n.a.clone(za),za[na-1]=da.qf(ra.x-ka,0),za[na]=da.qf(Ua-ra.x,0),T.setValue(B.a.$u,za);Array.insert(ea,na,ra.x);fa.qUa(3)}for(da=0;da<ra.inh.length;++da){ea=ra.inh[da];ka=[];for(Ua=ea.re;Ua<=ea.$f;++Ua)({vla:za}=this.Dbd.CEh(T,fa,Ua,na)),ka[ka.length]=za;Ua=new P.a;Ua.re=ea.re;Ua.$f=ea.$f;Ua.he=
na-1;Ua.Nf=na+1;for(Ua=this.qea.zDa(T,fa,Ua);Ua.moveNext();){za=Ua.fA;var ha=Ua.u5b();this.CJf(za.re,na,ha);this.Sqh(za.re,na,ha,ma)}for(Ua=ea.re;Ua<ea.$f;++Ua){za=T.nf(Ua,na-1);ha=T.nf(Ua,na);var ua=this.Kq.EI(fa,Ua,na-1);ua.re===Ua&&(za=T.nf(ua.re,ua.he),ua=na-ua.he,ha.colSpan=za.colSpan-ua,za.colSpan=ua,ha.rowSpan=za.rowSpan);ha.isGhostCell=za.isGhostCell}fa.qUa(1);this.o5.D4d(T,fa,na,ea.re,ea.$f,!0);for(let Ga=ea.re,sa=0;Ga<=ea.$f;++Ga,++sa)ka[sa]&&this.o5.gWe(T,fa,Ga,na,na+1,ka[sa])}return{returnValue:na,
HUa:F}}t_i(T,da,fa,ma,ea){var ra=this.qea.zDa(T,da,fa.rE);ra.moveTo(fa.IO,fa.OL);fa=ra.fA;for(let F=1;F<ma;++F)ra.tok(),fa.$f=ra.fA.$f,fa.Nf=ra.fA.Nf;for(ma=1;ma<ea;++ma)ra.moveNext(),fa.$f=ra.fA.$f,fa.Nf=ra.fA.Nf;for(ea=this.qea.zDa(T,da,fa);ea.moveNext();){ra=ea.fA;let F;ra.$f<fa.$f&&({vla:F}=this.Dbd.CEh(T,da,fa.$f,ra.he)).returnValue&&this.o5.gWe(T,da,ra.$f,ra.he,ra.Nf,F);ra.Nf<fa.Nf&&({vla:F}=this.Dbd.GEh(T,da,fa.Nf,ra.re)).returnValue&&this.o5.mXe(T,da,ra.Nf,ra.re,ra.$f,F)}}DTi(T,da){T=this.Pb.Mc(T);
this.Fjc(T,da.re);for(let fa=da.re;fa<da.$f;++fa){const ma=T.currentNode.sa(A.a.tu,0);ma&&ma<this.Tk.oJc(T.currentNode)&&T.currentNode.setValue(A.a.tu,0);T.Cf(1)}}BTi(T,da){let fa=T.sa(B.a.$u,null),ma=!1;if(fa){fa=n.a.clone(fa);for(let ea=da.he;ea<da.Nf;++ea){const ra=this.Tk.Usb(T,ea);fa[ea]&&fa[ea]<ra&&(fa[ea]=ra,ma=!0)}}ma&&T.setValue(B.a.$u,fa)}CJf(T,da,fa){const ma=fa.getContainingTable();ma||E.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");ma.nf(T,da).cellShading=
fa.cellShading}Sqh(T,da,fa,ma){const ea=fa.getContainingTable();ea||E.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");T=x.GraphIterator.nb(ea.nf(T,da));this.Ceb.iW(T,!0,ma(fa))}Fjc(T,da){for(this.cY.I_g(T);0<da--;)this.cY.zok(T)}jih(T){T=this.Pb.a8d(T);let da=T.Bb(1);for(;da;)da=T.vRa(1)}}Object(J.a)(ca,"TableMergeSplitEditor",null,[285])},1014:function(J,aa,d){J=d(0);var h=d(14),e=d(387),r=d(27),n=d(166),v=d(198),B=d(57);class y{constructor(D,Q,Z,P){this.tGd=null;this.fyc=
P;this.Pba=D;this.Qba=Q;this.sP=Z;this.$of=this.qYg.Mjl;D=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.aXh=D[0];this.$Wh=D[1]}get qYg(){return this.tGd||(this.tGd=B.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get XTa(){return CommonUIStrings.l_OICErrorHelpLink}get vrc(){return this.$of}get sYg(){return this.aXh}get rYg(){return this.$Wh}get pYg(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.$of?
3:2}get Q3b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get kLc(){return!!this.Qba}get R3b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get eDa(){return CommonUIStrings.l_DefaultDialogTitle}WPe(D){this.ckc(D)}moe(D){this.ckc(D)}ckc(D){let Q=10;this.Qba&&1===D&&(this.Qba(this.sP),Q=1);this.Pba&&this.Pba(this.sP);this.zp(Q)}Qgb(){v.Redirect.showHelp("OICFailure");this.zp(2)}MGe(){this.qYg.Vpg();this.zp(4)}zp(D){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.fyc,D);r.AFrameworkApplication.bjb(n.a.C8g,this.fyc,D)}dispose(){this.sP=this.Pba=this.Qba=null}}Object(J.a)(y,"AOICErrorDialog",null,[106]);var x=d(93),A=d(107);class E extends y{constructor(D,Q,Z,P){super(D,Q,Z,P);this.lOa=this.Nz=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=this.errorMessage;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));this.Nz=document.createElement("a");this.Nz.href="#";this.Nz.innerText=this.XTa;D.appendChild(this.Nz);
x.a.addHandler(this.Nz,"click",Object(h.a)(this,this.Qgb,"oicErrorHelpLinkHandler"));Q=new A.StandardDialog;Q.ig=this.id;this.vrc?(Z=document.createElement("span"),P=document.createElement("span"),Z.innerText=this.sYg,P.innerText=this.rYg,this.lOa=document.createElement("a"),this.lOa.href="#",this.lOa.innerText=this.pYg,D.appendChild(document.createElement("br")),D.appendChild(Z),D.appendChild(this.lOa),D.appendChild(P),x.a.addHandler(this.lOa,"click",Object(h.a)(this,this.MGe,"oicErrorMacOfferLinkHandler"))):
this.kLc&&(D.appendChild(document.createElement("br")),D.appendChild(document.createElement("br")),Z=document.createElement("span"),Z.innerText=this.Q3b,D.appendChild(Z));this.kLc?(Q.yd=1,Q.Xe(1,this.R3b)):Q.yd=0;Q.Gx(this.eDa,null,this.icon,Object(h.a)(this,this.moe,"legacyOICErrorDialogHandler"),D);Q.f6("errorMessageText")}dispose(){this.Nz&&(x.a.removeHandler(this.Nz,"click",Object(h.a)(this,this.Qgb,"oicErrorHelpLinkHandler")),this.Nz=null);this.lOa&&(x.a.removeHandler(this.lOa,"click",Object(h.a)(this,
this.MGe,"oicErrorMacOfferLinkHandler")),this.lOa=null);super.dispose()}}Object(J.a)(E,"OICErrorDialog",y,[]);class u{constructor(D,Q,Z){this.Pba=Q;this.Qba=D;this.sP=Z}get id(){return"OICErrorDialogWithDownload"}get LTf(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get XTa(){return CommonUIStrings.l_OICErrorHelpLink}get Q3b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get R3b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get eDa(){return CommonUIStrings.l_DefaultDialogTitle}WPe(D){this.ckc(D)}moe(D){this.ckc(D)}ckc(D){let Q=
10;1===D&&(this.Qba(this.sP),Q=1);this.Pba&&this.Pba(this.sP);this.zp(Q)}Qgb(){v.Redirect.showHelp("OICFailure");this.zp(2)}zp(D){r.AFrameworkApplication.bjb(n.a.D8g,3,D)}dispose(){this.sP=this.Qba=this.Pba=null}}Object(J.a)(u,"AOICErrorDialogWithDownload",null,[106]);class K extends u{constructor(D,Q,Z){super(D,Q,Z);this.Nz=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=this.LTf;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));this.Nz=
document.createElement("a");this.Nz.href="#";this.Nz.innerText=this.XTa;D.appendChild(this.Nz);x.a.addHandler(this.Nz,"click",Object(h.a)(this,this.Qgb,"oicErrorHelpLinkHandler"));D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));Q=document.createElement("span");Q.innerText=this.Q3b;D.appendChild(Q);Q=new A.StandardDialog;Q.ig=this.id;Q.yd=1;Q.Xe(1,this.R3b);Q.Gx(this.eDa,null,this.icon,Object(h.a)(this,this.moe,"legacyOICErrorDialogHandler"),D);Q.f6("errorMessageText")}dispose(){this.Nz&&
(x.a.removeHandler(this.Nz,"click",Object(h.a)(this,this.Qgb,"oicErrorHelpLinkHandler")),this.Nz=null);super.dispose()}}Object(J.a)(K,"OICErrorDialogWithDownload",u,[]);var G=d(79);class O extends y{constructor(D,Q,Z,P){super(D,Q,Z,P);Q={["errorMessage"]:this.errorMessage};Q.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.XTa,["onExecute"]:ca=>{this.Qgb(ca)}};this.vrc?(Q.macOfficePreLinkText=this.sYg,Q.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.pYg,
["onExecute"]:ca=>{this.MGe(ca)}},Q.macOfficePostText=this.rYg):this.kLc&&(Q.errorFileDownloadOffer=this.Q3b);D=new G.a(!1,!1,!0);this.kLc?(D.yd=1,D.Xe(1,this.R3b)):D.yd=0;D.ig=this.id;Q={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:Q};D.aj(this.eDa,Object(h.a)(this,this.WPe,"reactOICErrorDialogHandler"),Q)}}Object(J.a)(O,"ReactOICErrorDialog",y,[]);class R extends u{constructor(D,Q,Z){super(D,Q,Z);Q={["errorMessage"]:this.LTf,["errorFileDownloadOffer"]:this.Q3b};Q.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.XTa,["onExecute"]:P=>{this.Qgb(P)}};D=new G.a(!1,!1,!0);D.yd=1;D.Xe(1,this.R3b);D.ig=this.id;Q={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:Q};D.aj(this.eDa,Object(h.a)(this,this.WPe,"reactOICErrorDialogHandler"),Q)}}Object(J.a)(R,"ReactOICErrorDialogWithDownload",u,[]);d.d(aa,"a",function(){return V});class V{constructor(){this.nqa=!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.hb.IC}pGi(D,Q,Z){this.nqa?new O(D,Q,null,Z):new E(D,Q,null,Z)}qGi(D,
Q,Z){this.nqa?new R(D,Q,Z):new K(D,Q,Z)}rGi(D,Q,Z,P,ca){const {ReactOICErrorDialogWithTrial:T}=d(1119),{OICErrorDialogWithTrial:da}=d(1120);this.nqa?new T(D,Q,Z,null,P,ca):new da(D,Q,Z,null,P,ca)}static get instance(){return V.Ka||(V.Ka=new V)}}V.Ka=null;Object(J.a)(V,"OICErrorDialogFactory",null,[1401])},1019:function(J,aa,d){J=d(0);var h=d(387);d(1204);var e=d(96),r=d(65),n=d(89);class v{constructor(){this.hasImpliedUsage=this.additionalValues=this.isInternal=this.isIntentional=null}}Object(J.a)(v,
"IKpiFailureOptionalProperties",null,[]);class B{constructor(){this.hasImpliedUsage=this.additionalValues=null}}Object(J.a)(B,"IKpiSuccessOptionalProperties",null,[]);var y=d(929);class x{constructor(){this.blockFutureEmissionDurationInMs=this.optionalVeto=this.optionalProperties=this.errorName=this.kpiName=null}}Object(J.a)(x,"KpiFailureParams",null,[]);class A{constructor(){this.blockFutureEmissionDurationInMs=this.optionalProperties=this.kpiName=null}}Object(J.a)(A,"KpiSuccessParams",null,[]);
var E=d(930);d.d(aa,"a",function(){return u});class u{static getInstance(K){try{return healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(e.Health.instance,K)}catch(G){return h.ULS.V_a(521457890,383,10,G,"Failed to initialize extendedHealth"),null}}static uTk(K,G){const O=u.getInstance(K);O&&O.logKpiUsage(u.wcj());const R=r.a.vj();try{const V=G();V.then(D=>{const Q=u.vcj(r.a.vj()-R);O&&O.logKpiSuccess(Q);return D}).catch(D=>{let Q="UnknownError";D&&(Q=D.toString());D=u.S3f(Q,r.a.vj()-R);O&&
O.logKpiFailure(D)});return V}catch(V){throw K="",K=V.message,K=u.S3f(K,r.a.vj()-R),O&&O.logKpiFailure(K),V;}}static wcj(){const K=Object.assign(new y.a,{extendedProperties:u.t7d()});return Object.assign(new E.a,{kpiName:"InitFloodgate",kpiType:0,optionalProperties:K,blockFutureEmissionDurationInMs:3E5})}static vcj(K=null){K=Object.assign(new B,{additionalValues:Object.assign(new n.a,{extendedProperties:u.t7d(),durationMs:K})});return Object.assign(new A,{kpiName:"InitFloodgate",optionalProperties:K,
blockFutureEmissionDurationInMs:3E5})}static S3f(K,G=null){G=Object.assign(new v,{additionalValues:Object.assign(new n.a,{extendedProperties:u.t7d(),durationMs:G})});return Object.assign(new x,{kpiName:"InitFloodgate",errorName:K,optionalProperties:G,optionalVeto:null,blockFutureEmissionDurationInMs:3E5})}static t7d(){const K=new Map;K.has("SkipAria")||K.set("SkipAria","True");return K}}Object(J.a)(u,"ExtendedHealth",null,[])},1022:function(J,aa,d){J=d(0);class h{constructor(){this.results=null;this.totalResultCount=
0;this.hasTooManyResults=!1}}Object(J.a)(h,"DocumentContentSearchResults",null,[]);class e{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(R,V,D,Q,Z){this.selectRange(V,D,Q,Z)}selectRangeV3(){}search(){}searchV2(R,V){this.search(R,D=>{V(Object.assign(new h,{results:D,totalResultCount:D.length,hasTooManyResults:100<D.length}))})}searchWithParam(R,V){this.search(R.query,V)}searchWithParamV2(R,V){this.searchWithParam(R,D=>{V(Object.assign(new h,{results:D,totalResultCount:D.length,
hasTooManyResults:D.length>R.totalResultLimit}))})}highlight(){}highlightWithParam(R){this.highlight(R.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(J.a)(e,"BaseDocumentContentExecutor",null,[671,741]);class r{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(J.a)(r,"DocumentContentSearchResult",null,[]);var n=d(109),v=d(27),B=d(47),y=d(18),x=d(76),A=d(33),E=d(51),u=d(387),K=d(682),G=d(30);d.d(aa,"a",function(){return O});class O extends e{constructor(R,
V,D,Q,Z,P,ca,T,da,fa,ma){super();if(!R)throw Error("pageNode is null");if(!V)throw Error("interactiveViewManager is null");if(!D)throw Error("selectionFactory is null");if(!Q)throw Error("slideReader is null");if(!Z)throw Error("workspace is null");if(!P)throw Error("graphTopologyManager is null");if(!ca)throw Error("searchContextFactory is null");if(!T)throw Error("actionManager is null");if(!da)throw Error("selectionManager is null");if(!fa)throw Error("clipServiceManager is null");if(!ma)throw Error("presentationReader is null");
this.Xdk=R;this.jA=V;this.Cad=D;this.ic=Q;this.Vb=Z;this.ua=P;this.fhk=ca;this.ia=T;this.pa=da;this.mO=fa;this.oc=ma}getAllParagraphsInDocument(){const R=this.H9d(),V=new y.a;for(let D of R)V.add(O.E9d(D));return V.toArray()}selectRange(R,V,D,Q){if(!(0>R||0>V||0>D||0>Q||R>D||R===D&&V>Q)){var Z=this.H9d();Z.count<=D||(R=Z.ga(R),D=Z.ga(D),O.Dog(R,V)&&O.Dog(D,Q)&&(Z=this.ic.jg(R),this.ua.Ba!==Z&&this.Vb.oqh(Z),V=this.Cad.Sg(R,V),Q=this.Cad.GN(V,E.a.Mj(D,Q+1)),this.jA.nXe(this.Vb.PK,Q)))}}search(R,V){const D=
new y.a,Q=R.toLowerCase();var Z=this.H9d();let P=0;for(let T of Z){Z=O.E9d(T);const da=Z.toLowerCase();let fa=0;for(;-1<(fa=da.indexOf(Q,fa));){var ca=this.fhk.FHi(Z,fa,fa+R.length);ca=Object.assign(new r,{snippet:ca.eBi,startOffsetInSnippet:ca.F4k,endOffsetInSnippet:ca.C4k-1,paragraphIndex:P,startOffsetInParagraph:fa,endOffsetInParagraph:fa+R.length-1});D.add(ca);fa+=R.length}P++}D.Sc((T,da)=>T.paragraphIndex===da.paragraphIndex?T.startOffsetInParagraph-da.startOffsetInParagraph:T.paragraphIndex-
da.paragraphIndex);V(D.toArray())}getSelectedSlidesAsPPTXStream(){const R=this.pa.Qe();if(R&&R.length)return this.B0f(R);u.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const R=this.oc.N7f();if(R&&R.length)return this.B0f(R);u.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}B0f(R){var V=this.mO.PLc(1,R.length,!1),D=n.a.create().toString();
D=new K.a(V,D,R);var Q=8;Q=this.ia.La(G.a.PXd,2,D);V.xW=Q;D=v.AFrameworkApplication.fa.Ga("361");Q=B.a.Ne(V.Jp);const Z=B.a.Ne(V.tD);V=B.a.Ne(V.Cy);if(Q&&Z&&V)return{url:`${D}GetClipboardBytes.ashx?Id=${Q}&DC=${Z}&pkey=${V}&wdwaccluster=${Z}&DataType=${1}`,selectedSlideIDs:R.map(P=>P.id.toString())}}H9d(){var R=A.ParagraphReader.hUc(this.Xdk.value,!0,!1);const V=new y.a;for(let D of R)R=this.ic.jg(D),R.XN||R.xAb||V.add(D);return V}static E9d(R){R=A.ParagraphReader.text(R);return x.AParagraphNode.Pld(R,
" ")}static Dog(R,V){R=O.E9d(R);return V<R.length}}Object(J.a)(O,"PPTDocumentContentExecutor",e,[])},1025:function(J,aa,d){J=d(0);var h=d(387),e=d(1204),r=d(1205),n=d(1206),v=d(121),B=d(27),y=d(1019),x=d(201),A=d(271),E=d(95),u=d(252),K=d(310),G=d(36),O=d(193),R=d(55),V=d(47);class D{constructor(){this.cvFlights=this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(J.a)(D,"CustomerVoiceSurveyParams",null,[]);var Q=d(142),Z=d(531);class P{sendTelemetryEvent(da){const fa=new Z.a;fa.otelEvent=
da;Q.a.sendOtelEvent(fa)}}Object(J.a)(P,"OtelTelemetrySink",null,[1408]);var ca=d(931);d.d(aa,"a",function(){return T});class T{static init(da,fa,ma,ea,ra){ra.onDismiss=da;ra.onError=fa;da=null;OfficeBrowserFeedback.initOptions?("screenshot"in ra&&(OfficeBrowserFeedback.initOptions.screenshot=ra.screenshot),"showEmailAddress"in ra&&(OfficeBrowserFeedback.initOptions.showEmailAddress=ra.showEmailAddress),"feedbackForumUrl"in ra&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=ra.feedbackForumUrl),
da=ra):OfficeBrowserFeedback.initOptions=ra;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=T.vLf());OfficeBrowserFeedback.multiFeedback(da).then(()=>{h.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(F=>h.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+F.toString()))}static Gee(da,fa,ma,ea){h.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(T.Dob===T.initialized)return Promise.resolve(1);if(T.Dob===
T.pfg)return T.qfg||(T.qfg=!0,h.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(T.Dob!==T.error){T.Dob=T.pfg;h.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check");if(T.NEj(da,fa,ma,ea))return T.sEj();T.Dob=T.error;Promise.reject(T.I1g)}return Promise.reject(0)}static sEj(){try{return y.a.uTk(T.ucj(),()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>T.O_e())).catch(da=>{let fa=10;da&&da.toString()&&O.a(da.toString(),T.v2j)&&
(fa=15);h.ULS.sendTraceTag(36546402,356,fa,"BFCOCV Floodgate initialize error:"+da.toString())})}catch(da){return h.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+da.toString()),Promise.reject(T.krk)}}static ucj(){return Object.assign(new ca.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static O_e(){return OfficeBrowserFeedback.floodgate.start().then(()=>{T.Z_i()}).catch(da=>{h.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+
da.toString())})}static Z_i(){T.Dob=T.initialized;h.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");try{const da=B.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const fa of da.split("|"))fa&&T.logActivity(fa,null)}catch(da){h.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static Hua(){let da=!1;const fa=B.AFrameworkApplication.fa;fa&&(da="teams"===(fa.Ga(B.AFrameworkApplication.gK)||"").toLowerCase());
return R.a.OFa||da}static N1g(){return"undefined"==typeof OfficeBrowserFeedback}static NEj(da,fa,ma,ea){let ra=!0;try{if(T.N1g())return h.ULS.sendTraceTag(39900617,356,15,T.I1g),!1;OfficeBrowserFeedback.initOptions||(ma.onDismiss=ea,ma.onError=fa,ma=T.Tei(ma),OfficeBrowserFeedback.initOptions=ma);OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=T.vLf());fa={};ea={};ea.onSurveyActivated=T.Vzk;ea.onTeachingCampaignRender=ma.onTeachingCampaignRender;fa.onSurveyActivatedCallback=
ea;fa.onDismiss=da;fa.autoDismiss=ma.FloodgateUIAutoDismissTimeEnum;fa.telemetryGroup=ma.telemetryGroup;fa.uIStringGetter=ma.uIStringGetter;fa.authTokenCallback=ma.authTokenCallback;fa.augLoopCallback=ma.augLoopCallback;fa.campaignFlights="";fa.governanceServiceEnabled=ma.governanceServiceEnabled;fa.governanceServiceConfig=ma.governanceServiceConfig;fa.personalizerEnabled=ma.personalizerEnabled;fa.messagingServiceSettings=ma.messagingServiceSettings;fa.isPriorityEnabled=ma.isPriorityEnabled;B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1)&&("surveyEnabled"in ma&&(fa.surveyEnabled=ma.surveyEnabled),"showEmailAddress"in ma&&(fa.showEmailAddress=ma.showEmailAddress));fa.isEudbUxEnabled=!1;B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(fa.isEudbUxEnabled=!0);const na=T.u8i(ma),ka=T.I2f(na);let Ua=T.P8i(ma);for(let za in ka){da=za;var F=ka[za];-1!==da.toLowerCase().indexOf("flight")?fa.campaignFlights+=F+";":Ua=Ua+da+"="+F+"&"}h.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+
fa.campaignFlights+" campaignQueryParameters: "+Ua);fa.campaignQueryParameters=Ua;fa.customerVoiceSurveyParams=T.G8i(ma.Application.toString(),T.Hua()?T.Evl:"");OfficeBrowserFeedback.floodgate.initOptions=fa}catch(na){ra=!1,h.ULS.sendTraceTag(39900618,356,15,na.toString())}return ra}static Tei(da){try{const fa=da.applicationGroup?da.applicationGroup:{},ma=fa.appData,ea=ma?G.a(G.a('"'+ma+'"')):{};ea.fgUIAutoDismiss=da.FloodgateUIAutoDismissTimeEnum;fa.appData=G.c(ea);da.applicationGroup=fa}catch(fa){h.ULS.sendTraceTag(588842831,
356,10,"Failed to parse applicationGroup.appData",fa.toString())}return da}static u8i(da){da=Array.isArray(da.Flights)?da.Flights:null;da||(da=(da=B.AFrameworkApplication.fa.Ga("FlightId"))?da.toString().split(";"):null);if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",!0)){const fa=B.AFrameworkApplication.fa.IQc;if(fa)for(let ma in fa){const ea={key:ma,value:fa[ma]};-1!==(ea&&ea.key?ea.key.toLowerCase():"").indexOf("floodgateflight")&&
"unset"!==(ea&&ea.value?ea.value.toString().toLowerCase():"")&&da.push(ea.key)}}return da}static I2f(da){const fa={SelfTriggerActivity:""};if(!da||!da.length)return fa;try{for(let ra=0;ra<da.length;ra++){let F=da[ra]?da[ra].toLowerCase():"";if(-1===F.indexOf("floodgateflight"))continue;const na=F.lastIndexOf(".");-1!==na&&(F=F.substring(na+1,F.length));if(-1!==("AppFlights"in fa?fa.AppFlights:"").indexOf(F))continue;fa.AppFlights="AppFlights"in fa?fa.AppFlights+(";"+F):F;const ka=V.a.replaceAll(F,
"-",""),Ua=B.AFrameworkApplication.fa.Ga(ka);if(Ua)try{const za=G.a(Ua);za&&za.SelfTriggerActivity||(fa.SelfTriggerActivity+=";"+ka);if(za)for(let ha in za){var ma=ha,ea=za[ha];ma in fa?fa[ma]!==ea&&(fa[ma]=fa[ma]+";"+ea):fa[ma]=ea}}catch(za){h.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+ka+" json data",za.toString())}else fa.SelfTriggerActivity+=";"+ka}}catch(ra){h.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",ra.toString())}return fa}static P8i(da){let fa=
"";const ma={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let F in ma){var ea=F,ra=ma[F];let na=da[Object(e.a)(String,ra)];na||(na=B.AFrameworkApplication.fa.Ga(Object(e.a)(String,ra)));na&&(fa+=ea+"="+encodeURIComponent(na)+"&")}return fa}static bbl(da){T.XZd=da}static Vzk(da,fa,ma){if(da)try{const ra=fa?fa.getCampaignId():"",F=fa?fa.getLauncherType():"",na=ma?ma.contextInfo:null;var ea=fa?fa.getSurveyInfo():null;const ka=ea?ea.getPreferredLaunchType():
null,Ua=ea?ea.getMetadata():null,za=Ua?Ua.getContentMetadata():null,ha=za?za.customSurveyName:null,ua=za?za.telemetryEventName:null;T.ELj(ra)?h.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+ra):(ea={},ea.campaignId=ra,ea.surveyName=ha,ea.launcherType=F,ea.contextInfoLength=na?na.length.toString():"-1",ea.preferredLaunchType=ka,ea.telemetryEventName=ua,h.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(ea)),F&&"coachingux"===F.toLowerCase()&&
ka&&"default"!==ka.toLowerCase()&&T.sbg(za,fa,ma)?h.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(ea)):(da.launch(ma),T.yth()))}catch(ra){h.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(ra?ra.toString():""))}else h.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")}static dyj(da){da=da?da.surfaceContext:null;if(!da||!da.surveyForm)return h.ULS.sendTraceTag(555071516,
356,10,"Missing activation arguments"),!1;try{const fa=da.surveyForm.getSurveyInfo(),ma=fa?fa.getMetadata():null,ea=ma?ma.getContentMetadata():null;return T.sbg(ea,da.surveyForm,da.surveyParams)}catch(fa){h.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(fa?fa.toString():""))}return!1}static sbg(da,fa,ma){if(!da||!da.customSurveyName||!fa)return h.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(da?da.customSurveyName:null)),!1;const ea=fa.getCampaignId();
if(da.telemetryEventName){var ra={["action"]:"Opened",["id"]:ea,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:da.customSurveyName,["telemetryEventName"]:da.telemetryEventName};T.XZd?T.XZd(da.telemetryEventName,ra):(B.AFrameworkApplication.Wj(da.telemetryEventName),B.AFrameworkApplication.Ibc(da.telemetryEventName),h.ULS.sendTraceTag(512505554,356,50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(ra)))}ra=T.osf.Gb(da.customSurveyName)?T.osf.ga(da.customSurveyName):
null;if(!ra)return h.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+da.customSurveyName+", "+ea),!1;(da=ra(fa,ma))&&da.then(F=>{h.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(F))}).catch(F=>{h.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(F?F.toString():""))});return!0}static ELj(da){try{return-1!==B.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((da||
"").toLowerCase())}catch(fa){h.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+da)}return!1}static logActivity(da,fa=null){if(T.uVd(da,"LogActivity")){var ma=T.O7d();ma&&(h.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+da),ma.logActivity(da,1,fa))}}static iNb(da){da?(h.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(da),T.yth()):h.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static yth(){T.tra(T.SXf)}static QFj(da,
fa,ma){var ea=[3,2,5,1];const ra=E.FocusManager.instance(),F=ra.Fc(da);F.parent=v.AFrame.hj;F.dJ=!0;A.a.instance.P2(da,!0);fa&&F.kca(fa);if(ma){u.a.instance.N7(da,ma,!1,!0);K.a.instance.N7(da,ma,!1,!0);da=new x.DOMFocusListing(()=>ma);for(fa=0;fa<ea.length;++fa)da.Io(ea[fa]);ra.Yia(()=>ma,F,da).rX=!0}}static tra(da){const fa=document.getElementById(da);fa?T.QFj(da,T.Muk,fa):h.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+da)}static Muk(da,fa){h.ULS.sendTraceTag(37107265,356,
100,"BFCOCV.OnFocusAction. PrevScopeName "+(da?da.name:"")+" NextScopeName "+(fa?fa.name:""));fa&&(da=E.FocusManager.instance().uQ(fa.name))&&da.Ldd()}static Bbc(da){if(T.uVd(da,"LogActivityStart")){var fa=T.O7d();fa&&(h.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+da),fa.logActivityStartTime(da))}}static Xqg(da){if(T.uVd(da,"LogActivityEnd")){var fa=T.O7d();fa&&(h.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+da),fa.logActivityStopTime(da,
new Date))}}static $_i(){OfficeBrowserFeedback.floodgate.start()}static a0i(){OfficeBrowserFeedback.floodgate.stop()}static uVd(da,fa){da||h.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+fa);return!!da}static O7d(){let da=null;const fa=OfficeBrowserFeedback.floodgate.getEngine();fa?(da=fa.getActivityListener())||h.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):T.s1g||(T.s1g=!0,h.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));
return da}static vLf(){return new P}static G8i(da,fa){return Object.assign(new D,{productName:da,uiHost:fa,cvFlights:"",isCVSurveyEnabled:!0})}}T.SXf="obf-ToastContainer";T.notInitialized=0;T.pfg=1;T.initialized=2;T.error=-1;T.Dob=T.notInitialized;T.s1g=!1;T.qfg=!1;T.v2j="window.localStorage is not available";T.I1g="OFB still undefined";T.krk="OFB Floodgate is undefined or does not contain initialize function";T.Evl="Teams";T.osf=new r.a(n.a.Hn());T.XZd=null;Object(J.a)(T,"BrowserFeedbackControlOCV",
null,[])},1029:function(J,aa,d){J=d(0);var h=d(351),e=d(532);class r extends e.a{constructor(E,u=null,K=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=u;this.messageText=E;this.isDeferred=K}}Object(J.a)(r,"DeferredContentProps",e.a,[]);var n=d(28),v=d(933),B=d(934);const y=(E,u)=>Object.assign(new v.a,{target:".EditingRibbonPanel",content:E,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new B.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,
preventDismissOnScroll:!0,onDismiss:u,preventDismissOnResize:!0})});var x=d(48);d.d(aa,"a",function(){return A});class A{constructor(){this.XT=new r(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}yOi(E,u,K,G){G=Object.assign(new h.a,{onShow:()=>{K.rI(x.a.v0a)}});u=E.callout(u);return G=E.addNotification(u,G)}SXk(E,u){E.removeNotification(u);n.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");return u}GGi(E){return y(this.XT,
()=>{E.Lo(x.a.v0a)})}}Object(J.a)(A,"DownloadACopyDeferred",null,[454])},1030:function(J,aa,d){J=d(0);var h=d(583),e=d(1204),r=d(298),n=d(503);class v{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(J.a)(v,"CT_LineJoinMiterProperties",null,[]);var B=d(964);class y{constructor(){this.valField=0}}Object(J.a)(y,"CT_PositiveFixedPercentage",null,[]);var x=d(965),A=d(368),E=d(323),u=d(299);d.d(aa,"a",function(){return K});class K{j7f(G,O,R,V,D,Q){G=Object(e.a)(566,Q.Ba.ng(D.Ma));R=D.Md;
D=Math.round(V.JM(R.Pe(O.width*h.a.aD,0),G.tT));O=Math.round(V.JM(R.Pe(O.height*h.a.aD,1),G.tT));return{Qth:D,Ith:O}}kKf(G,O){return Object.assign(new r.a,{TopLeft:Object.assign(new u.a,{X:0,Y:0}),TopRight:Object.assign(new u.a,{X:G,Y:0}),BottomLeft:Object.assign(new u.a,{X:0,Y:O}),BottomRight:Object.assign(new u.a,{X:G,Y:O})})}wrh(G){G.lineStyle=Object.assign(new B.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new v,
{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new x.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new E.a,{schemeClrField:Object.assign(new A.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}Hrh(G){G.fill=Object.assign(new n.a,{solidFillField:Object.assign(new E.a,{schemeClrField:Object.assign(new A.a,{valField:4})})});G.lineStyle=Object.assign(new B.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new v,
{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new x.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new E.a,{schemeClrField:this.EHi(Object.assign(new y,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}EHi(G){const O={itemsElementNameField:[26]};O.itemsField=[G];O.valField=4;return O}}Object(J.a)(K,"InsertShapeActorHelper",null,[746])},1039:function(J,aa,d){J=d(0);var h=d(14),e=d(1203),r=d(27),n=d(67),v=d(82);class B{constructor(x,A,E,u=null){this.origin=x;
this.data=A;this.source=E;this.qc=u}}Object(J.a)(B,"MessageEventArgs",null,[]);d.d(aa,"a",function(){return y});class y{constructor(x,A){this.dOd=null;this.B4h=x;this.$d=A;this.xBc=null}get ylb(){return this.B4h.value}get taskManager(){return this.$d.value}Bhi(x){this.xBc=x;this.dOd=Object(h.a)(this,this.WHk,"postMessageEventHandler");this.ylb.addHandler(n.a.message,this.dOd,null)}NMi(){this.xBc=null;this.ylb.removeHandler(n.a.message,this.dOd)}AYc(x,A){const E=new v.a(0,1,1,()=>{x(A)},7);this.taskManager.Db(E)}oJj(x,
A){const E=new v.a(0,1,1,()=>{x(A)},7);this.taskManager.Db(E)}WHk(x){return this.xBc?this.xBc(new B(x.origin,x.data,x.source,x.qc)):!1}static get instance(){return y.t9a()}static t9a(){return new y(new e.a(()=>r.AFrameworkApplication.ylb),new e.a(()=>r.AFrameworkApplication.ye))}}Object(J.a)(y,"MessageEventHandler",null,[369])},1042:function(J,aa,d){J=d(0);var h=d(387),e=d(105),r=d(270),n=d(14),v=d(1204),B=d(36);class y{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(J.a)(y,"CritiqueTypeOption",
null,[]);var x=d(2);d.d(aa,"a",function(){return A});class A{constructor(E,u,K){this.dLd={};this.ol=null;this.Fnf=E;this.f0h=u;this.g0h=K;this.a4a=x.Task.gt({})}init(){this.a4a=this.Fnf.Tae(this.f0h,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(n.a)(this,this.pwk,"onLoadSettingsTaskFinished"),8)}Vyl(E){const u={};if(!(E&&"ProofingSettingLanguageList"in E))return u;const K=Array.isArray(B.a(E.ProofingSettingLanguageList))?B.a(E.ProofingSettingLanguageList):null;for(const G of K)"ProofingSettings"+
G in E&&(u[G]=Object(v.a)(Object,B.a(E["ProofingSettings"+G])));return u}Wyl(E){const u={},K=[];for(let R in E){var G=R,O=E[R];O&&(K.push(G),u["ProofingSettings"+G]=B.c(O))}u.ProofingSettingLanguageList=B.c(K);return u}saveSettings(E){this.a4a=x.Task.gt(E);this.ol=null;try{const u=this.Wyl(E);this.Fnf.$sh(this.g0h,u).continueWith(Object(n.a)(this,this.Eyk,"onSaveSettingsTaskFinished"),8)}catch(u){h.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",u.toString())}}U6d(){if(!this.ol){if(6!==
this.a4a.status)return[];try{var E=this.a4a.result;let O;if(e.a.isEmpty(this.dLd))O=E;else if(e.a.isEmpty(E))O=this.dLd;else{O={};var u=this.dLd;for(let R in u)O[R]=e.a.Yqc(u[R]);O=A.merge(O,E)}this.ol=[];for(let R in O){var K=O[R];const V=r.a.xe(parseInt(R));if(!V)continue;const D=V.name;u=K;for(let Q in u){E=Q;var G=u[Q];const Z=Object.assign(new y,{LanguageId:D,Id:E,Value:G.toString()});this.ol.push(Z)}}}catch(O){h.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",
O.toString())}}return this.ol}UNi(E,u){const K=this.a4a.result;if(K)try{let G=K[E];G||(G={});G[u]=!1;K[E]=G;this.saveSettings(K)}catch(G){h.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",G.toString())}}pwk(E){if(E.rm)return h.ULS.sendTraceTag(34964619,375,10,"Load setting failed with exception {0}",E.$i),null;if(6===E.status)try{return this.Vyl(E.result)}catch(u){h.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",u.toString())}return null}Eyk(E){E.rm&&
h.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",E.$i)}static merge(E,u){E=E||{};if(u)for(let O in u){var K=O,G=u[O];E[K]=E[K]||{};for(let R in G)E[K][R]=G[R]}return E}}Object(J.a)(A,"CritiqueTypeSettings",null,[849])},1045:function(J,aa,d){J=d(0);var h=d(135),e=d(81),r=d(1212),n=d(27),v=d(195),B=d(47),y=d(165),x=d(28),A=d(443),E=d(444);class u{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(J.a)(u,"ImagePasteArgs",null,[]);
var K=d(328),G=d(43),O=d(49),R=d(30);d.d(aa,"a",function(){return V});class V{constructor(D,Q,Z,P,ca,T,da,fa,ma,ea,ra,F){this.ia=D;this.Fa=Q;this.PHa=Z;this.pa=P;this.tkk=ca;this.Qo=T;this.Jla=da;this.Le=ea;this.rB=ra;this.Cc=F;this.efc=fa;this.L7c=ma;this.Wad=!1;this.Ofc=-1}mQ(D){if(!this.PHa.z9b(this.Fa)||!D)return!1;if(D.PPc&&D.Qde)return this.Wad=!1,D.mQ=this.efc;if(!D.Bm||0<D.Bm.getElementsByTagName(O.a.Sdg).length)return!1;this.Wad=!this.icg(D)&&this.YVj(this.pa.Xd());D.mQ=this.Wad?this.L7c:
this.efc;return D.mQ}YVj(D){return 1===D.length?D[0].pXj:!1}GLk(D,Q){this.edh(D,Q,0);if(!D.firstChild||!D.firstChild.className||!A.a.Ugg(D.firstChild.className))if(!this.Qo.fg||"<br>"!==D.innerHTML){const Z=y.b(D);Z&&0<Z.length&&(Q.jV=D.innerHTML)}}edh(D,Q,Z){if(D){if(Z>=V.VIc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",V.VIc));if(1===D.nodeType){var P=D.tagName.toLowerCase();if(this.Jla.bUj(P))D.parentNode.removeChild(D);else{for(let T=D.firstChild;T;T=ca){var ca=T.nextSibling;
this.edh(T,Q,Z+1)}P===O.a.Z8?(D.parentNode.removeChild(D),this.HLk(D,Q)):P===O.a.fOb?(D.parentNode.removeChild(D),this.nMk(D,Q)):P===O.a.listTag&&this.NLk(D);this.Cc.ZWe(D,Q.Wb)}}}}NLk(D){if(D){var Q=D.getAttribute("data-"+h.a.EZb);if(Q&&0<Q.length&&D.style){var Z=parseInt(Q);if(1!==Q.length||isNaN(Z)||1>Z||Z>K.a.e8)Q="1",Z=1;Z>this.Ofc&&(this.Ofc=Z);Q=String.format(O.a.L0j,Q);(Z=D.style.cssText)?D.setAttribute("style",Q+Z):D.setAttribute("style",Q)}if((Q=D.parentNode)&&!this.Le.XQj(Q.tagName)){Z=
D.nextSibling;const P=this.Le.R1b();P.appendChild(D);Q.insertBefore(P,Z)}}}HLk(D,Q){if(D&&D.src&&D.src.length){var Z=window.location.href.toLowerCase();Z=e.a.sQ(Z);if(D.src.startsWith(Z))x.a.J(509153345,826,50,"Pasted image src is an empty string.");else{Z=Math.ceil(r.a.Pe(this.Jla.Gbj(D),0,!1));var P=Math.ceil(r.a.Pe(this.Jla.xbj(D),1,!1));Q.Bda.push(Object.assign(new u,{src:D.src,alt:D.alt,width:Z?Z:D.width,height:P?P:D.height}))}}}nMk(D,Q){D&&D.innerHTML&&D.rows&&D.rows.length&&(D.getElementsByTagName(O.a.Jsd).length||
D.getElementsByTagName(O.a.Nul).length)&&(D=y.c(D),!D||0>=D.length||Q.d1a.push(D))}icg(D){if(D.PPc)return!0;const Q=D.Bm.getElementsByTagName(O.a.fOb).length;return 0<D.Bm.getElementsByTagName(O.a.Z8).length||0<Q}paste(D){if(n.AFrameworkApplication.PQ)this.tkk.Xrc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const Q=Object.assign(new E.a,{Wb:D.Wb});let Z=!0;Q.TMb=this.Wad;n.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&(Q.oje=D.c3d,Q.K$b=D.d4b&&!this.icg(D)&&
""!==D.Bm.innerText);if(D.PPc)Q.Bda.push(Object.assign(new u,{src:D.Qde,width:0,height:0}));else if(n.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&Q.K$b)Q.jV=D.Bm.innerText;else try{this.GLk(D.Bm,Q),0<this.Ofc&&(x.a.J(509153315,826,50,String.format("max list level pasted into new shape = {0}.",this.Ofc-1)),this.Ofc=-1)}catch(P){Z=!1,x.a.J(509153314,826,15,P.message)}Z&&(this.Sil(Q)?this.dFk(Q):this.ia.La(R.a.xxa,2,Q))}}Sil(D){return v.a.Wa(D.d1a)&&B.a.Wa(D.jV)&&!!D.Bda&&1===D.Bda.length&&
this.jYj(D.Bda[0].src)}jYj(D){if(B.a.Wa(D)||!D.startsWith("data:image"))return!1;D=D.split(";");if(!D||2!==D.length)return!1;D=D[0].replace("/",".");return 0===this.rB.Yvd(D,!0)}dFk(D){let Q=new Image;const Z=D.Bda[0],P=G.a.Ib;if(Z.width&&Z.height)D.T_c=!0,this.ia.La(R.a.xxa,2,D);else{const ca=new Date;Q.onload=()=>{D.FKe=+new Date-+ca;Z.width=Q.width;Z.height=Q.height;D.T_c=!0;Q=null;G.a.AF(P,()=>{this.ia.La(R.a.xxa,2,D)})};Q.onerror=()=>{Q=null;G.a.AF(P,()=>{this.ia.La(R.a.xxa,2,D)})};Q.src=Z.src}}}
V.VIc=100;Object(J.a)(V,"HtmlPasteHandler",null,[1207])},1046:function(J,aa,d){J=d(0);var h=d(18),e=d(27),r=d(1209),n=d(240),v=d(39);class B{constructor(E,u){this.actionId=E;this.rd=u}}Object(J.a)(B,"CommandActionData",null,[]);var y=d(30),x=d(35);d.d(aa,"a",function(){return A});class A{constructor(E,u,K,G,O,R){this.eXg=[];this.Flg=!1;this.ecc=null;this.$3c=new h.a;this.ia=E;this.EAe=u;this.zsf=!1;this.Pb=K;this.lH=G;this.B$=O;this.ttg=this.hEb=null;R&&Object(x.a)("EnhancementOfSDXPaneBootTime")&&
this.$Dj()}$Dj(){this.hEb||(this.hEb=e.AFrameworkApplication.Bj("officeExtensionMerge.js",5));this.ttg||(this.ttg=e.AFrameworkApplication.Bj("appforoffice.hermes"+this.lH.xne,1));if(!this.ecc){const E=[this.B$.mub(this.LGe)];this.ecc=r.a.create("pptedit.appforoffice",E,()=>d.e(9).then(d.bind(null,1242)))}}get Hud(){return this.eXg}get LGe(){this.hEb||(this.hEb=e.AFrameworkApplication.Bj("officeExtensionMerge.js",5));return this.hEb}set LGe(E){this.hEb=E}get Eei(){if(!this.ecc){const E=[this.B$.mub(this.LGe)];
this.ecc=r.a.create("pptedit.appforoffice",E,()=>d.e(9).then(d.bind(null,1242)))}return this.ecc}t8h(E){this.Hud.push(E)}dja(){this.Flg||(n.a.fy(this.Eei),this.Flg=!0)}Fzl(){for(const E of this.Hud)E.Dkb();this.eXg=[]}Gzl(){var E=this.Pb.Mc(this.EAe.xf).Bb(18);E=this.Pb.Mc(E);let u=E.Bb(19);if(u){do u=E.yq,this.ia.La(y.a.Wib,2,u.eb(v.a.NZ));while(E.Cf(19))}}zPa(E,u){this.$3c.add(new B(E,u))}Bsj(){if(0<this.$3c.count){for(let E of this.$3c)this.ia.La(E.actionId,2,E.rd);this.$3c.clear()}}nce(){const E=
!!this.Hud&&0<this.Hud.length;let u=!1;if(this.EAe.xf&&!E){const K=this.Pb.Mc(this.EAe.xf).Bb(18);K&&0<this.Pb.Mc(K).H8(19)&&(u=!0)}return E||u}}Object(J.a)(A,"AppForOfficeManagerFactory",null,[793])},1047:function(J,aa,d){J=d(0);var h=d(47);class e{constructor(n,v){this.Zak=n;this.a9c=v}get DUa(){return this.Zak}get message(){return this.a9c}}Object(J.a)(e,"CalloutNotificationError",null,[]);d.d(aa,"a",function(){return r});class r{constructor(n,v){this.rug=n;this.Sgk=v}kga(n,v,B,y,x,A,E,u,K,G,O,
R){this.rug.show(this.Sgk,null,!1,K,G,n,v,B,x,y,A,E,u,O,R)}r0d(){this.rug.dismiss()}dwh(n){if(!n)throw Error.argumentNull("CalloutNotificationMessageAttributes");const v=this.MJl(n);if(v&&v.DUa)return v;this.kga(n.title,n.message,n.lcg,n.XIb,n.qcg,n.Und,n.UKk,n.f8k,n.VKk,n.g8k,!!n.timeoutInSeconds,n.timeoutInSeconds);return new e(!1,null)}MJl(n){return h.a.Wa(n.title)?new e(!0,"Invalid Title"):h.a.Wa(n.message)?new e(!0,"Invalid Message"):n.lcg&&h.a.Wa(n.XIb)?new e(!0,"Missing PrimaryButtonLabel"):
n.qcg&&h.a.Wa(n.Und)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(J.a)(r,"CalloutNotificationAdapter",null,[534])},1048:function(J,aa,d){J=d(0);var h=d(27),e=d(735),r=d(232);class n extends e.a{constructor(B,y){super(B);this.t7j=y}eDh(B){return r.i(r.g(B))}G2e(B){return r.i(B)}Rtc(B){return this.t7j?B.eji:B.Rtc().toString()}Lmi(B,y,x){const A=new Sys.StringBuilder;A.append(String.format('<Menu Id="{0}">',"menuFontColor"));A.append(this.fbe(B,y,x));A.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');
A.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",h.AFrameworkApplication.qm,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));A.append("</Controls> </MenuSection>");A.append("</Menu>");return A.toString()}}Object(J.a)(n,"ColorMenuBuilder",e.a,[]);d.d(aa,"a",function(){return v});class v{Q6i(B){return new e.a(B)}K0f(B,y){return new n(B,y)}}Object(J.a)(v,
"ColorPickerBuilderFactory",null,[863])},1050:function(J,aa,d){J=d(0);var h=d(663),e=d(143);class r extends h.a{constructor(){super();this.languageId=null;this.startOfSentence=!1;this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(J.a)(r,"TextPredictorSignalBase",h.a,[]);d.d(aa,"a",function(){return n});class n extends r{constructor(){super();
this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static getBaseTypes(){return["AugLoop_Signals_TextPredictorSignalBase","AugLoop_Signals_Signal"]}}Object(J.a)(n,"TextPredictorSignal",r,[])},111:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(1232);class e{constructor(){this.m9a=this.QBf=this.E3=this.Kaa=this.TIc=this.ARc=this.mwb=this.SDa=this.$Z=this.NKc=this.Ftd=null}Lf(r){this.Ftd=new h.a;this.Ftd.value=
r}mqc(){this.NKc=new h.a;this.NKc.value=!0}ZU(r){this.ARc=new h.a;this.ARc.value=r}}Object(J.a)(e,"QueryResult",null,[])},1116:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(97);class e{constructor(r){this.pzd=r.cloneNode(!0);this.Zkf=r}restore(){for(h.a.Cu(this.Zkf);this.pzd.firstChild;){const r=this.pzd.firstChild;h.a.$O(r);this.Zkf.appendChild(r)}this.pzd=null}}Object(J.a)(e,"DomElementContentState",null,[])},1117:function(J,aa,d){d.r(aa);d.d(aa,"SpellingRequestObjectUpdatedV2",
function(){return r});J=d(0);var h=d(668),e=d(667);class r extends h.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=null;this.UxLcid=0}static x5d(n,v){const B=new r;h.a.ALe(B,n,v);B.UserActionType=e.a[n.userAction];B.ProofingEngine=n.Rfa;B.Descriptors=n.descriptors;B.OverriddenCritiqueTypeOptions=n.overriddenCritiqueTypeOptions;B.UxLcid=n.LJh;2===n.Rfa?B.TextUnit=n.range.textUnit:1===n.Rfa&&(B.UseContextualResults=
!0);return B}}Object(J.a)(r,"SpellingRequestObjectUpdatedV2",h.a,[])},1118:function(J,aa,d){d.r(aa);d.d(aa,"SpellingRequestObjectUpdated",function(){return r});J=d(0);var h=d(668),e=d(667);class r extends h.a{constructor(){super();this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static x5d(n,v,B,y,x,A){const E=new r;h.a.ALe(E,n,v);E.UserActionType=e.a[n.userAction];E.UseOneSpeller=B;E.TrackMetrics=y;E.UseContextualResults=x;A&&(E.ExperimentId=A);return E}}Object(J.a)(r,
"SpellingRequestObjectUpdated",h.a,[])},1119:function(J,aa,d){d.r(aa);d.d(aa,"ReactOICErrorDialogWithTrial",function(){return n});J=d(0);var h=d(14);aa=d(926);var e=d(198),r=d(79);class n extends aa.a{constructor(v,B,y,x,A,E){super(v,B,y,x,A,E);B={["errorMessage"]:this.KTf,["offerString"]:this.M1g};v=new r.a(!1,!1,!0);this.wwh?(v.yd=1,B.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.XTa,["onExecute"]:()=>{e.Redirect.showHelp(this.Fcg)}}):(v.yd=4,v.Xe(2,this.Fdg));v.Xe(1,this.jsf);
v.ig=this.id;B={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:B};v.aj(this.eDa,Object(h.a)(this,this.WRk,"reactOICErrorDialogWithTrialHandler"),B)}}Object(J.a)(n,"ReactOICErrorDialogWithTrial",aa.a,[])},1120:function(J,aa,d){d.r(aa);d.d(aa,"OICErrorDialogWithTrial",function(){return r});J=d(0);var h=d(14);aa=d(926);var e=d(107);class r extends aa.a{constructor(n,v,B,y,x,A){super(n,v,B,y,x,A);n=document.createElement("span");n.innerText=this.KTf;n.appendChild(document.createElement("br"));
n.appendChild(document.createElement("br"));v=document.createElement("span");v.innerText=this.M1g;n.appendChild(v);v=new e.StandardDialog;this.wwh?(v.yd=1,v.hPd(this.XTa,this.Fcg)):(v.yd=4,v.Xe(2,this.Fdg));v.Xe(1,this.jsf);v.ig=this.id;v.Gx(this.eDa,null,this.icon,Object(h.a)(this,this.m0j,"legacyOICErrorDialogWithTrialHandler"),n)}}Object(J.a)(r,"OICErrorDialogWithTrial",aa.a,[])},1121:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.keytip=this.id=this.image=
this.label=this.command=null}}Object(J.a)(h,"HeaderButtonInfo",null,[])},1122:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(J.a)(h,"CalloutButtonProps",null,[])},1123:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.y=this.x=0}}Object(J.a)(h,"IPoint",null,[])},1124:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(27);d=d(78);class e{static Y$h(r){e.O7e.addHandler(e.tHf,
r)}static YOk(r){h.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&e.O7e.raiseEvent(e.tHf,r)}}e.tHf="CommandClickEvent";e.O7e=new d.a;Object(J.a)(e,"CommandClickEvents",null,[])},1125:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.Image16by16Class="Image16by16Class";h.Image32by32Class="Image32by32Class";h.On="On";h.LabelText="LabelText";h.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";h.EnsureControlRoleIsButton="EnsureControlRoleIsButton";h.Visible="Visible";
Object(J.a)(h,"SplitButtonCommandProperties",null,[])},1126:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r=null,n=null,v=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=r;this.iconSet.icon24=n;this.iconSet.icon32=v}}Object(J.a)(h,"IconSetContainer",null,[])},1127:function(J,aa,d){d.r(aa);d.d(aa,"NewCustomEventFactory",function(){return h});J=d(0);d=d(536);class h extends d.a{constructor(){super()}create(e,r){const n={};n.detail=r;return new CustomEvent(e,
n)}}Object(J.a)(h,"NewCustomEventFactory",d.a,[])},1128:function(J,aa,d){d.r(aa);d.d(aa,"IECustomEventFactory",function(){return h});J=d(0);d=d(536);class h extends d.a{constructor(){super()}create(e,r){const n=window.document.createEvent("CustomEvent");n.initCustomEvent(e,!1,!1,r);return n}}Object(J.a)(h,"IECustomEventFactory",d.a,[])},1129:function(J,aa,d){d.r(aa);d.d(aa,"CheckRoamingRightsRequest",function(){return h});J=d(0);d=d(958);class h extends d.a{constructor(){super()}vxb(){return 2}Zk(){return 1}}
Object(J.a)(h,"CheckRoamingRightsRequest",d.a,[])},1130:function(J,aa,d){d.r(aa);d.d(aa,"GetRoamingLauncherRequest",function(){return h});J=d(0);d=d(958);class h extends d.a{constructor(){super()}vxb(){return 0}Zk(){return 2}}Object(J.a)(h,"GetRoamingLauncherRequest",d.a,[])},1131:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(356);class h extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(J.a)(h,
"IconGalleryButtonProps",d.a,[])},1132:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.Ebh="WAC_Powerpoint";h.t8b=null;Object(J.a)(h,"AddinHostApp",null,[])},1133:function(J,aa,d){d.d(aa,"a",function(){return r});J=d(0);var h=d(201),e=d(95);class r{constructor(n){this.fw=n;this.eN=Array.indexOf(this.fw,this.Uja)}dispose(){this.fw=null}get d_(){return this.fw[this.eN]}ZE(n){this.nqc(n,!1);return!0}i9a(n){this.nqc(n,!0)}nqc(n,v){n&&(this.d_!==n||v)&&(n.tabIndex=0,e.FocusManager.Wr(n));
Array.contains(this.fw,n)&&(this.eN=Array.indexOf(this.fw,n))}get Cch(){let n=this.eN;do if(n)if(0<n&&n<this.fw.length)n--;else break;else n=this.fw.length-1;while(!h.DOMFocusListing.qDa(this.fw[n])&&n!==this.eN);return this.fw[n]}get C0g(){let n=this.eN;do if(n===this.fw.length-1)n=0;else if(0<=n&&n<this.fw.length-1)n++;else break;while(!h.DOMFocusListing.qDa(this.fw[n])&&n!==this.eN);return this.fw[n]}get Uja(){let n=0;for(;!h.DOMFocusListing.qDa(this.fw[n])&&n<this.fw.length;)n++;return h.DOMFocusListing.qDa(this.fw[n])?
this.fw[n]:null}get RAb(){let n=this.fw.length-1;for(;!h.DOMFocusListing.qDa(this.fw[n])&&0<n;)n--;return h.DOMFocusListing.qDa(this.fw[n])?this.fw[n]:null}}Object(J.a)(r,"DialogFocusListing",null,[188])},1134:function(J){(function(aa,d){J.exports=d()})(this,function(){function aa(Xb,Za){if("object"!==d(Xb)||"function"!==typeof Xb.createPolicy)return null;var Va=null;Za.currentScript&&Za.currentScript.hasAttribute("data-tt-policy-suffix")&&(Va=Za.currentScript.getAttribute("data-tt-policy-suffix"));
Za="dompurify"+(Va?"#"+Va:"");try{return Xb.createPolicy(Za,{createHTML:function(tc){return tc},createScriptURL:function(tc){return tc}})}catch(tc){return console.warn("TrustedTypes policy "+Za+" could not be created."),null}}function d(Xb){"@babel/helpers - typeof";return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Za){return typeof Za}:function(Za){return Za&&"function"==typeof Symbol&&Za.constructor===Symbol&&Za!==Symbol.prototype?"symbol":typeof Za},d(Xb)}function h(Xb,
Za){h=Object.setPrototypeOf||function(Va,tc){Va.__proto__=tc;return Va};return h(Xb,Za)}function e(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.bQl)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Xb){return!1}}function r(Xb,Za,Va){r=e()?Reflect.construct:function(tc,Kb,Pa){var mb=[null];mb.push.apply(mb,Kb);tc=new (Function.bind.apply(tc,mb));Pa&&h(tc,Pa.prototype);return tc};
return r.apply(null,arguments)}function n(Xb){var Za=Array.isArray(Xb)?v(Xb):void 0;Za||(Za="undefined"!==typeof Symbol&&null!=Xb[Symbol.iterator]||null!=Xb["@@iterator"]?Array.from(Xb):void 0);if(!Za)a:{if(Xb){if("string"===typeof Xb){Za=v(Xb,void 0);break a}Za=Object.prototype.toString.call(Xb).slice(8,-1);"Object"===Za&&Xb.constructor&&(Za=Xb.constructor.name);if("Map"===Za||"Set"===Za){Za=Array.from(Xb);break a}if("Arguments"===Za||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Za)){Za=v(Xb,
void 0);break a}}Za=void 0}if(!(Xb=Za))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return Xb}function v(Xb,Za){if(null==Za||Za>Xb.length)Za=Xb.length;for(var Va=0,tc=Array(Za);Va<Za;Va++)tc[Va]=Xb[Va];return tc}function B(Xb){return function(Za){for(var Va=arguments.length,tc=Array(1<Va?Va-1:0),Kb=1;Kb<Va;Kb++)tc[Kb-1]=arguments[Kb];return P(Xb,Za,tc)}}function y(Xb,Za,Va){Va=Va?Va:ma;K&&
K(Xb,null);for(var tc=Za.length;tc--;){var Kb=Za[tc];if("string"===typeof Kb){var Pa=Va(Kb);Pa!==Kb&&(G(Za)||(Za[tc]=Pa),Kb=Pa)}Xb[Kb]=!0}return Xb}function x(Xb){var Za=Q(null),Va;for(Va in Xb)P(u,Xb,[Va])&&(Za[Va]=Xb[Va]);return Za}function A(Xb,Za){for(;null!==Xb;){var Va=R(Xb,Za);if(Va){if(Va.get)return B(Va.get);if("function"===typeof Va.value)return B(Va.value)}Xb=O(Xb)}return function(tc){console.warn("fallback value for",tc);return null}}function E(){function Xb(Cd){var Lc,Td;Va("beforeSanitizeAttributes",
Cd,null);var Ge=Cd.attributes;if(Ge){var Xc={attrName:"",rzf:"",lpg:!0,TNl:We};for(Td=Ge.length;Td--;){var jf=Lc=Ge[Td],Mh=jf.name;jf=jf.namespaceURI;Lc="value"===Mh?Lc.value:ka(Lc.value);var bd=Gf(Mh);Xc.attrName=bd;Xc.rzf=Lc;Xc.lpg=!0;Xc.S0i=void 0;Va("uponSanitizeAttribute",Cd,Xc);Lc=Xc.rzf;if(!Xc.S0i&&(mb(Mh,Cd),Xc.lpg))if(Ua(/\/>/i,Lc))mb(Mh,Cd);else{Ed&&(Lc=F(Lc,rb," "),Lc=F(Lc,Zb," "),Lc=F(Lc,Hc," "));var Bc=Gf(Cd.nodeName);a:{var Hf=Bc;var Me=bd,Tf=Lc;if(Kd&&("id"===Me||"name"===Me)&&(Tf in
Mb||Tf in xh))Hf=!1;else{if(!Nc||xb[Me]||!Ua(Ab,Me))if(!kc||!Ua(ad,Me))if(!We[Me]||xb[Me]){if(!(0<Hf.indexOf("-")&&(Re.M1 instanceof RegExp&&Ua(Re.M1,Hf)||Re.M1 instanceof Function&&Re.M1(Hf))&&(Re.C6a instanceof RegExp&&Ua(Re.C6a,Me)||Re.C6a instanceof Function&&Re.C6a(Me))||"is"===Me&&Re.AHc&&(Re.M1 instanceof RegExp&&Ua(Re.M1,Tf)||Re.M1 instanceof Function&&Re.M1(Tf)))){Hf=!1;break a}}else if(!(Cb[Me]||Ua(Be,F(Tf,kd,""))||("src"===Me||"xlink:href"===Me||"href"===Me)&&"script"!==Hf&&0===na(Tf,"data:")&&
jg[Hf]||id&&!Ua(Bd,F(Tf,kd,"")))&&Tf){Hf=!1;break a}Hf=!0}}if(Hf){!Pc||"id"!==bd&&"name"!==bd||(mb(Mh,Cd),Lc="user-content-"+Lc);if(rd&&"object"===d(Vb)&&"function"===typeof Vb.getAttributeType&&!jf)switch(Vb.getAttributeType(Bc,bd)){case "TrustedHTML":Lc=rd.createHTML(Lc);break;case "TrustedScriptURL":Lc=rd.createScriptURL(Lc)}try{jf?Cd.setAttributeNS(jf,Mh,Lc):Cd.setAttribute(Mh,Lc),da(ib.removed)}catch(Sd){}}}}Va("afterSanitizeAttributes",Cd,null)}}function Za(Cd){Va("beforeSanitizeElements",Cd,
null);if(Cd instanceof Ac&&("string"!==typeof Cd.nodeName||"string"!==typeof Cd.textContent||"function"!==typeof Cd.removeChild||!(Cd.attributes instanceof Nb)||"function"!==typeof Cd.removeAttribute||"function"!==typeof Cd.setAttribute||"string"!==typeof Cd.namespaceURI||"function"!==typeof Cd.insertBefore||"function"!==typeof Cd.hasChildNodes)||Ua(/[\u0080-\uFFFF]/,Cd.nodeName))return qc(Cd),!0;var Lc=Gf(Cd.nodeName);Va("uponSanitizeElement",Cd,{tagName:Lc,UNl:Qd});if(!(!Cd.hasChildNodes()||tc(Cd.firstElementChild)||
tc(Cd.content)&&tc(Cd.content.firstElementChild))&&Ua(/<[/\w]/g,Cd.innerHTML)&&Ua(/<[/\w]/g,Cd.textContent)||"select"===Lc&&Ua(/<template/i,Cd.innerHTML))return qc(Cd),!0;if(!Qd[Lc]||Ta[Lc]){if(!Ta[Lc]&&0<Lc.indexOf("-")&&(Re.M1 instanceof RegExp&&Ua(Re.M1,Lc)||Re.M1 instanceof Function&&Re.M1(Lc)))return!1;if(tf&&!Id[Lc]){Lc=vc(Cd)||Cd.parentNode;var Td=Rb(Cd)||Cd.childNodes;if(Td&&Lc)for(var Ge=Td.length-1;0<=Ge;--Ge)Lc.insertBefore(Tc(Td[Ge],!0),wb(Cd))}qc(Cd);return!0}if(Td=Cd instanceof Gc){(Td=
vc(Cd))&&Td.tagName||(Td={namespaceURI:Bf,tagName:"template"});Ge=ma(Cd.tagName);var Xc=ma(Td.tagName);Td=!(vd[Cd.namespaceURI]&&("http://www.w3.org/2000/svg"===Cd.namespaceURI?"http://www.w3.org/1999/xhtml"===Td.namespaceURI?"svg"===Ge:"http://www.w3.org/1998/Math/MathML"===Td.namespaceURI?"svg"===Ge&&("annotation-xml"===Xc||he[Xc]):re[Ge]:"http://www.w3.org/1998/Math/MathML"===Cd.namespaceURI?"http://www.w3.org/1999/xhtml"===Td.namespaceURI?"math"===Ge:"http://www.w3.org/2000/svg"===Td.namespaceURI?
"math"===Ge&&de[Xc]:Ih[Ge]:"http://www.w3.org/1999/xhtml"===Cd.namespaceURI?"http://www.w3.org/2000/svg"===Td.namespaceURI&&!de[Xc]||"http://www.w3.org/1998/Math/MathML"===Td.namespaceURI&&!he[Xc]?0:!Ih[Ge]&&(xf[Ge]||!re[Ge]):"application/xhtml+xml"===ng&&vd[Cd.namespaceURI]))}if(Td||("noscript"===Lc||"noembed"===Lc)&&Ua(/<\/no(script|embed)/i,Cd.innerHTML))return qc(Cd),!0;Ed&&3===Cd.nodeType&&(Lc=Cd.textContent,Lc=F(Lc,rb," "),Lc=F(Lc,Zb," "),Lc=F(Lc,Hc," "),Cd.textContent!==Lc&&(fa(ib.removed,
{element:Cd.cloneNode()}),Cd.textContent=Lc));Va("afterSanitizeElements",Cd,null);return!1}function Va(Cd,Lc,Td){gc[Cd]&&T(gc[Cd],function(Ge){Ge.call(ib,Lc,Td,Jf)})}function tc(Cd){return"object"===d(Gb)?Cd instanceof Gb:Cd&&"object"===d(Cd)&&"number"===typeof Cd.nodeType&&"string"===typeof Cd.nodeName}function Kb(Cd){return Wb.call(Cd.ownerDocument||Cd,Cd,bc.SHOW_ELEMENT|bc.SHOW_COMMENT|bc.SHOW_TEXT,null,!1)}function Pa(Cd){if(db)Cd="<remove></remove>"+Cd;else var Lc=(Lc=ra(Cd,/^[\r\n\t ]+/))&&
Lc[0];"application/xhtml+xml"===ng&&"http://www.w3.org/1999/xhtml"===Bf&&(Cd='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Cd+"</body></html>");var Td=rd?rd.createHTML(Cd):Cd;if("http://www.w3.org/1999/xhtml"===Bf)try{var Ge=(new jb).parseFromString(Td,ng)}catch(Xc){}if(!Ge||!Ge.documentElement){Ge=cb.createDocument(Bf,"template",null);try{Ge.documentElement.innerHTML=qg?"":Td}catch(Xc){}}Td=Ge.body||Ge.documentElement;Cd&&Lc&&Td.insertBefore(Mb.createTextNode(Lc),Td.childNodes[0]||
null);return"http://www.w3.org/1999/xhtml"===Bf?Ib.call(Ge,Ja?"html":"body")[0]:Ja?Ge.documentElement:Td}function mb(Cd,Lc){try{fa(ib.removed,{attribute:Lc.getAttributeNode(Cd),from:Lc})}catch(Td){fa(ib.removed,{attribute:null,from:Lc})}Lc.removeAttribute(Cd);if("is"===Cd&&!We[Cd])if(zc||Hd)try{qc(Lc)}catch(Td){}else try{Lc.setAttribute(Cd,"")}catch(Td){}}function qc(Cd){fa(ib.removed,{element:Cd});try{Cd.parentNode.removeChild(Cd)}catch(Lc){try{Cd.outerHTML=rc}catch(Td){Cd.remove()}}}function oc(Cd){return Cd instanceof
RegExp||Cd instanceof Function}function ib(Cd){return E(Cd)}var $a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window;ib.version="2.4.1";ib.removed=[];if(!$a||!$a.document||9!==$a.document.nodeType)return ib.H0c=!1,ib;var Db=$a.document,Mb=$a.document,ob=$a.DocumentFragment,jc=$a.HTMLTemplateElement,Gb=$a.Node,Gc=$a.Element,bc=$a.NodeFilter,dc=$a.NamedNodeMap,Nb=void 0===dc?$a.NamedNodeMap||$a.BNl:dc,Ac=$a.HTMLFormElement,jb=$a.DOMParser,Vb=$a.trustedTypes;
dc=Gc.prototype;var Tc=A(dc,"cloneNode"),wb=A(dc,"nextSibling"),Rb=A(dc,"childNodes"),vc=A(dc,"parentNode");"function"===typeof jc&&(jc=Mb.createElement("template"),jc.content&&jc.content.ownerDocument&&(Mb=jc.content.ownerDocument));var rd=aa(Vb,Db),rc=rd?rd.createHTML(""):"";jc=Mb;var cb=jc.implementation,Wb=jc.createNodeIterator,Uc=jc.createDocumentFragment,Ib=jc.getElementsByTagName,Vc=Db.importNode;jc={};try{jc=x(Mb).documentMode?Mb.documentMode:{}}catch(Cd){}var gc={};ib.H0c="function"===typeof vc&&
cb&&"undefined"!==typeof cb.createHTMLDocument&&9!==jc;var rb=Oa,Zb=qa,Hc=Ya,Ab=Fb,ad=hc,Bd=Tb,kd=vb,Be=ec,Qd=null,ae=y({},[].concat(n(ha),n(ua),n(Ga),n(Ba),n(ia))),We=null,$d=y({},[].concat(n(Da),n(Xa),n(Ka),n(Ma))),Re=Object.seal(Object.create(null,{M1:{writable:!0,configurable:!1,enumerable:!0,value:null},C6a:{writable:!0,configurable:!1,enumerable:!0,value:null},AHc:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ta=null,xb=null,kc=!0,Nc=!0,id=!1,Ed=!1,Ja=!1,db=!1,zc=!1,Hd=!1,Ad=!1,Kd=
!0,Pc=!1,tf=!0,xe=!1,ef={},Id=null,qe=y({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),jg=null,of=y({},"audio video img source image track".split(" ")),Cb=null,Df=y({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),Bf="http://www.w3.org/1999/xhtml",qg=!1,vd=null,$f=y({},["http://www.w3.org/1998/Math/MathML","http://www.w3.org/2000/svg",
"http://www.w3.org/1999/xhtml"],ea),ng,Qe=["application/xhtml+xml","text/html"],Gf,Jf=null,xh=Mb.createElement("form"),he=y({},["mi","mo","mn","ms","mtext"]),de=y({},["foreignobject","desc","title","annotation-xml"]),xf=y({},["title","style","font","a","script"]),re=y({},ua);y(re,Ga);y(re,sa);var Ih=y({},Ba);y(Ih,pa);var Le=function Td(Lc){var Ge,Xc=Kb(Lc);for(Va("beforeSanitizeShadowDOM",Lc,null);Ge=Xc.nextNode();)Va("uponSanitizeShadowNode",Ge,null),Za(Ge)||(Ge.content instanceof ob&&Td(Ge.content),
Xb(Ge));Va("afterSanitizeShadowDOM",Lc,null)};ib.sanitize=function(Lc){var Td=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(qg=!Lc)&&(Lc="\x3c!--\x3e");if("string"!==typeof Lc&&!tc(Lc)){if("function"!==typeof Lc.toString)throw za("toString is not a function");Lc=Lc.toString();if("string"!==typeof Lc)throw za("dirty is not a string, aborting");}if(!ib.H0c){if("object"===d($a.J2e)||"function"===typeof $a.J2e){if("string"===typeof Lc)return $a.J2e(Lc);if(tc(Lc))return $a.J2e(Lc.outerHTML)}return Lc}Jf&&
Jf===Td||(Td&&"object"===d(Td)||(Td={}),Td=x(Td),ng=-1===Qe.indexOf(Td.IMh)?ng="text/html":ng=Td.IMh,Gf="application/xhtml+xml"===ng?ea:ma,Qd="ALLOWED_TAGS"in Td?y({},Td.fNl,Gf):ae,We="ALLOWED_ATTR"in Td?y({},Td.dNl,Gf):$d,vd="ALLOWED_NAMESPACES"in Td?y({},Td.eNl,ea):$f,Cb="ADD_URI_SAFE_ATTR"in Td?y(x(Df),Td.m7e,Gf):Df,jg="ADD_DATA_URI_TAGS"in Td?y(x(of),Td.cNl,Gf):of,Id="FORBID_CONTENTS"in Td?y({},Td.u7e,Gf):qe,Ta="FORBID_TAGS"in Td?y({},Td.wNl,Gf):{},xb="FORBID_ATTR"in Td?y({},Td.vNl,Gf):{},ef=
"USE_PROFILES"in Td?Td.MNl:!1,kc=!1!==Td.hNl,Nc=!1!==Td.iNl,id=Td.jNl||!1,Ed=Td.HNl||!1,Ja=Td.NNl||!1,zc=Td.DNl||!1,Hd=Td.ENl||!1,Ad=Td.FNl||!1,db=Td.xNl||!1,Kd=!1!==Td.INl,Pc=Td.JNl||!1,tf=!1!==Td.zNl,xe=Td.yNl||!1,Be=Td.gNl||Be,Bf=Td.CNl||"http://www.w3.org/1999/xhtml",Td.EMa&&oc(Td.EMa.M1)&&(Re.M1=Td.EMa.M1),Td.EMa&&oc(Td.EMa.C6a)&&(Re.C6a=Td.EMa.C6a),Td.EMa&&"boolean"===typeof Td.EMa.AHc&&(Re.AHc=Td.EMa.AHc),Ed&&(Nc=!1),Hd&&(zc=!0),ef&&(Qd=y({},n(ia)),We=[],!0===ef.html&&(y(Qd,ha),y(We,Da)),!0===
ef.Qtl&&(y(Qd,ua),y(We,Xa),y(We,Ma)),!0===ef.iQl&&(y(Qd,Ga),y(We,Xa),y(We,Ma)),!0===ef.YOl&&(y(Qd,Ba),y(We,Ka),y(We,Ma))),Td.DLh&&(Qd===ae&&(Qd=x(Qd)),y(Qd,Td.DLh,Gf)),Td.CLh&&(We===$d&&(We=x(We)),y(We,Td.CLh,Gf)),Td.m7e&&y(Cb,Td.m7e,Gf),Td.u7e&&(Id===qe&&(Id=x(Id)),y(Id,Td.u7e,Gf)),tf&&(Qd["#text"]=!0),Ja&&y(Qd,["html","head","body"]),Qd.table&&(y(Qd,["tbody"]),delete Ta.XBh),V&&V(Td),Jf=Td);ib.removed=[];"string"===typeof Lc&&(xe=!1);if(xe){if(Lc.nodeName&&(Td=Gf(Lc.nodeName),!Qd[Td]||Ta[Td]))throw za("root node is forbidden and cannot be sanitized in-place");
}else if(Lc instanceof Gb){var Ge=Pa("\x3c!----\x3e");Td=Ge.ownerDocument.importNode(Lc,!0);1===Td.nodeType&&"BODY"===Td.nodeName?Ge=Td:"HTML"===Td.nodeName?Ge=Td:Ge.appendChild(Td)}else{if(!zc&&!Ed&&!Ja&&-1===Lc.indexOf("<"))return rd&&Ad?rd.createHTML(Lc):Lc;Ge=Pa(Lc);if(!Ge)return zc?null:Ad?rc:""}Ge&&db&&qc(Ge.firstChild);for(var Xc=Kb(xe?Lc:Ge);Td=Xc.nextNode();)if((3!==Td.nodeType||Td!==jf)&&!Za(Td)){Td.content instanceof ob&&Le(Td.content);Xb(Td);var jf=Td}if(xe)return Lc;if(zc){if(Hd)for(jf=
Uc.call(Ge.ownerDocument);Ge.firstChild;)jf.appendChild(Ge.firstChild);else jf=Ge;We.aQl&&(jf=Vc.call(Db,jf,!0));return jf}jf=Ja?Ge.outerHTML:Ge.innerHTML;Ja&&Qd["!doctype"]&&Ge.ownerDocument&&Ge.ownerDocument.doctype&&Ge.ownerDocument.doctype.name&&Ua(zb,Ge.ownerDocument.doctype.name)&&(jf="<!DOCTYPE "+Ge.ownerDocument.doctype.name+">\n"+jf);Ed&&(jf=F(jf,rb," "),jf=F(jf,Zb," "),jf=F(jf,Hc," "));return rd&&Ad?rd.createHTML(jf):jf};return ib}var u=Object.hasOwnProperty,K=Object.setPrototypeOf,G=Object.isFrozen,
O=Object.getPrototypeOf,R=Object.getOwnPropertyDescriptor,V=Object.freeze,D=Object.seal,Q=Object.create,Z="undefined"!==typeof Reflect&&Reflect,P=Z.apply,ca=Z.construct;P||(P=function(Xb,Za,Va){return Xb.apply(Za,Va)});V||(V=function(Xb){return Xb});D||(D=function(Xb){return Xb});ca||(ca=function(Xb,Za){return r(Xb,n(Za))});var T=B(Array.prototype.forEach),da=B(Array.prototype.pop),fa=B(Array.prototype.push),ma=B(String.prototype.toLowerCase),ea=B(String.prototype.toString),ra=B(String.prototype.match),
F=B(String.prototype.replace),na=B(String.prototype.indexOf),ka=B(String.prototype.trim),Ua=B(RegExp.prototype.test),za=function(Xb){return function(){for(var Za=arguments.length,Va=Array(Za),tc=0;tc<Za;tc++)Va[tc]=arguments[tc];return ca(Xb,Va)}}(TypeError),ha=V("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
ua=V("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),Ga=V("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
sa=V("animate color-profile cursor discard fedropshadow font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),Ba=V("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),pa=V("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
ia=V(["#text"]),Da=V("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
Xa=V("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Ka=V("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
Ma=V(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Oa=D(/\{\{[\w\W]*|[\w\W]*\}\}/gm),qa=D(/<%[\w\W]*|[\w\W]*%>/gm),Ya=D(/\${[\w\W]*}/gm),Fb=D(/^data-[\-\w.\u00B7-\uFFFF]/),hc=D(/^aria-[\-\w]+$/),ec=D(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Tb=D(/^(?:\w+script|data):/i),vb=D(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zb=D(/^html$/i);return E()})},1135:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.InsertionPoint=
this.GalleryButtons=this.Title=this.SectionId=null}}Object(J.a)(h,"GallerySectionProps",null,[])},1136:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(304);class h{}h.Value="Value";h.Image16by16Class="Image16by16Class";h.Alt="Alt";h.Visible=d.a.visible;Object(J.a)(h,"LabelCommandProperties",null,[])},1143:function(J,aa,d){d.r(aa);J=d(0);var h=d(387),e=d(14),r=d(1204),n=d(27),v=d(141),B=d(460),y=d(269),x=d(199),A=d(57),E=d(73),u=d(37);class K{constructor(ib,$a,Db,Mb,ob){this.VGd=null;
this.BP=!0;this.uP=null;this.Ca=ib;this.Sh=$a;this.Yzd=Db;this.I0h=Mb;this.Zg=ob;n.AFrameworkApplication.RGc(Object(e.a)(this,this.RFl,"updateLastError"));this.I0h.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(this.BP=n.AFrameworkApplication.UE,A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(jc=>{jc.isFeatureEnabled("mso_sendASmile",!0).then(Gb=>{this.BP=n.AFrameworkApplication.UE&&Gb;this.Sh&&
this.Sh.updateCommandUI();return null},()=>null)})):A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(jc=>{jc.J3("Enabled").then(Gb=>{this.BP=Gb;return null},()=>null)})}get Zg(){this.uP||(n.AFrameworkApplication.Zg||(n.AFrameworkApplication.Zg=new B.a),this.uP=n.AFrameworkApplication.Zg);return this.uP}set Zg(ib){this.uP=ib}RFl(ib,$a){void 0!==$a&&null!==$a&&$a&&(this.VGd=$a.errorCode)}wb(){this.Ca.ya(u.a.giveFeedback,E.a.frame,Object(e.a)(this,this.yqj,"giveFeedbackHandler"));
this.Ca.ya(u.a.w3e,E.a.frame,Object(e.a)(this,this.w3e,"triggerFloodgateSurvey"));this.Sh.updateCommandUI()}w3e(ib,$a,Db,Mb,ob){if(1===Db)return 32;if(2===Db&&!ob)return 8;A.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(jc=>{jc.logActivity(Object(r.a)(String,ob.ActivityName),Object(r.a)(String,ob.BRSName))});return 32}yqj(ib,$a,Db,Mb,ob){if(1===Db)return n.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.BP=!1),this.BP&&x.SessionStatusManager.instance.J_?32:8;if(2===
Db){h.ULS.sendTraceTag(8405838,356,50,"");this.Zg.Feedback|=y.a.CXi;const jc=ob||{};void 0!==jc.ErrorCode&&null!==jc.ErrorCode||null==this.VGd||(jc.ErrorCode=this.VGd);n.AFrameworkApplication.fa.jPd(jc);this.Yzd&&(this.Yzd.instance||3===n.AFrameworkApplication.Aa.hb.Uk&&1===n.AFrameworkApplication.Aa.hb.gJa||A.a.instance.rb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.Yzd.execute(Gb=>{n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",
!1)?v.UISurfaces.f5f().then(Gc=>{void 0!==Gc&&null!==Gc?(Gb.E_j(jc,Gc),h.ULS.sendTraceTag(8405838,356,100,"Opened OCV vNext Modal")):(h.ULS.sendTraceTag(520626707,356,15,"feedbackAPI not retrived"),Gb.doe(jc));return Gc},()=>{h.ULS.sendTraceTag(520626706,356,15,"error while retieving feedbackAPI");Gb.doe(jc);return null}):Gb.doe(jc)}))}return 32}}Object(J.a)(K,"CustomerFeedbackActor",null,[1330]);class G{constructor(ib,$a,Db){this.jUb=this.hGd=!1;this.uP=this.E$e=null;this.H5a=ib;this.xDc=$a;this.Zg=
Db}get Zg(){this.uP||(n.AFrameworkApplication.Zg||(n.AFrameworkApplication.Zg=new B.a),this.uP=n.AFrameworkApplication.Zg);return this.uP}set Zg(ib){this.uP=ib}doe(ib){this.E$e=ib;this.Teg()||this.xbc()}E_j(ib,$a){this.H5a.yml(ib,$a)}xbc(){this.hGd||(this.hGd=!0,this.xDc.Z0d(Object(e.a)(this,this.frk,"oFeedbackJsDownloadFinished")))}frk(ib){ib?(this.jUb=!0,this.Zg.Feedback|=y.a.GXi,this.Teg(),h.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Zg.Feedback|=y.a.FXi,h.ULS.sendTraceTag(7611925,
356,100,"CF - JS download failed"));this.hGd=!1}Teg(){return this.jUb?(this.H5a.wol(this.E$e),!0):!1}bpg(ib){this.jUb=ib}}Object(J.a)(G,"CustomerFeedbackC3FormManager",null,[1378]);var O=d(18),R=d(672),V=d(174),D=d(240),Q=d(284);class Z{constructor(ib=null){this.Ikf=null;this.hCc=new O.a;this.sP=ib}Z0d(ib){Z.Uac()?this.hCc.add(ib):this.Ikf=ib;var $a="Feedback/officebrowserfeedback_floodgate.js";R.a.qke()&&($a="Feedback/latest/officebrowserfeedback_floodgate.js");ib="OFeedbackIntl";n.AFrameworkApplication.fa.Eu("IsServerFlavorDebug")&&
n.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&(ib+=".debug");ib+=".js";$a=V.a.L0b($a);V.a.nxi(ib);ib=Q.a.create($a);ib.HS(Object(e.a)(this,this.Xvk,"onJsDownloadFinished"));D.a.fy(ib);h.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",$a)}wal(ib){this.sP?ib&&this.sP.add(ib):this.sP=ib}Xvk(ib,$a){if(Z.Uac()){for(ib=0;ib<this.hCc.count;ib++)this.hCc.ga(ib)($a.succeeded,this.sP);this.hCc.clear()}else this.Ikf($a.succeeded,this.sP)}static Uac(){return!!n.AFrameworkApplication.Aa&&
!!n.AFrameworkApplication.Aa.hb&&3===n.AFrameworkApplication.Aa.hb.Uk&&1===n.AFrameworkApplication.Aa.hb.gJa}}Object(J.a)(Z,"CustomerFeedbackResourceDownloadManager",null,[1377]);class P{constructor(){this.audienceGroup=null;this.JGe=this.qjb=0}omg(){return!this.JGe}}Object(J.a)(P,"OCVData",null,[]);var ca=d(121),T=d(201),da=d(102);class fa extends Sys.EventArgs{constructor(ib){super();this.jtl=ib}}Object(J.a)(fa,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var ma=d(172),ea=d(70),ra=d(198),F=d(36),
na=d(193),ka=d(270),Ua=d(472),za=d(47),ha=d(1025),ua=d(78);class Ga{constructor(ib,$a){this.Ikk="obf-MainContentHolder";this.t0j="obf-OverallSmileAnchor";this.PKl="obf-visible";this.aRb=this.$Qb=Ga.Fmd;this.YDd=this.XDd=this.BP=!0;this.aff=this.Lob=this.LBd=this.KBd=this.CAc=this.cAc=this.UTb=!1;this.gAc=!0;this.uGd=this.ZFd=this.uP=this.kfd=this.zDd=this.gMd=null;this.qSh=n.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Od=ib;this.Zg=$a;this.Pa=new ua.a;if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)){const jc=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gc=>{Gc.isFeatureEnabled("mso_sendASmile",jc.BP).then(bc=>{jc.BP=bc;return null},()=>null);Gc.isFeatureEnabled("FloodgateSurvey",jc.CAc).then(bc=>{jc.CAc=bc;jc.LBd=!0;return null},()=>null)});const Gb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Gc=>{Gc.J3("IncludeScreenshot").then(bc=>{Gb.UTb=bc;return null},()=>null);Gc.J3("IncludeEmail").then(bc=>
{Gb.cAc=bc;Gb.KBd=!0;return null},()=>null)})}else{const jc=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Gb=>{Gb.J3("Enabled").then(Gc=>{jc.BP=Gc;return null},()=>null);Gb.J3("IncludeScreenshot").then(Gc=>{jc.UTb=Gc;return null},()=>null);Gb.J3("IncludeEmail").then(Gc=>{jc.cAc=Gc;jc.KBd=!0;return null},()=>null);Gb.J3("SurveyEnabled").then(Gc=>{jc.CAc=Gc;jc.LBd=!0;return null},()=>null)})}if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",
!0)){this.Lob=n.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const jc=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gb=>{jc.Lob=Gb.isFreemiumUpsellEnabled();Gb.isFeatureEnabled("mso_sendASmile",!1).then(Gc=>{jc.aff=Gc;return null},()=>null)})}const Db=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(jc=>{jc.isFeatureEnabled("FeedbackForum",Db.gAc).then(Gb=>{Db.gAc=Gb;return null},()=>null)});const Mb=
this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(jc=>{jc.isFeatureEnabled("FeedbackComplianceCannotConsent",Mb.XDd).then(Gb=>{Mb.XDd=Gb;return null},()=>null)});const ob=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(jc=>{jc.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",ob.YDd).then(Gb=>{ob.YDd=Gb;return null},()=>null)});R.a.qke()?(this.gMd=V.a.L0b("Feedback/latest/officebrowserfeedback.css"),
this.zDd=V.a.OWd("Feedback/latest/Intl/")):(this.gMd=V.a.L0b("Feedback/officebrowserfeedback.css"),this.zDd=V.a.OWd("Feedback/Intl/"))}get Zg(){this.uP||(n.AFrameworkApplication.Zg||(n.AFrameworkApplication.Zg=new B.a),this.uP=n.AFrameworkApplication.Zg);return this.uP}set Zg(ib){this.uP=ib}get noe(){return this.ZFd||(this.ZFd=document.getElementById(this.t0j))}get Lcd(){return this.uGd||(this.uGd=document.getElementById(this.Ikk))}lai(ib){this.Pa.addHandler(Ga.i4g,ib)}iui(){this.uGd=this.ZFd=null}MNj(ib){return!!ib&&
0<=ib.className.toLowerCase().indexOf(this.PKl.toLowerCase())}yml(ib,$a){n.AFrameworkApplication.UE?this.BP&&(h.ULS.sendTraceTag(520626705,356,50,"Feedback api retrieved"),ib=ib||{},this.getContext(ib),$a.initializeFeedbackModal(ib,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError")),h.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.Zg.Feedback|=y.a.VVf):h.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")}wol(ib){if(!n.AFrameworkApplication.UE)h.ULS.sendTraceTag(520626704,
356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.BP){ib=ib||{};this.getContext(ib);var $a=Ga.XMi(ib.AppMode||"Unknown");ha.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,$a,ib);this.MFj();Ga.allowKeytips(!1);h.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Zg.Feedback|=y.a.VVf}}oYi(ib,$a){$a&&2>=$a.qjb?(($a=n.AFrameworkApplication.fa.Ga("UserPrincipalName"))&&
0<$a.length&&(ib.userEmail=$a),ib.userEmailConsentDefault=!0):ib.userEmail=""}q_f(ib){const $a={};if(void 0!==ib.appData&&null!==ib.appData){var Db=ib.appData;for(var Mb in Db)$a[Mb]=Db[Mb]}$a.App=ib.Application||"";$a.AppMode=ib.AppMode||"";$a.AppModeExt=ib.ApplicationMode||"";$a.Host=ib.Host||"";$a.Language=ib.locale;$a.IsError=ib.Error||!1;$a.IsCrash=ib.Crash||!1;$a.ServerDocId=ib.ServerDocId||"";ib.ErrorCode&&""!==ib.ErrorCode.toString()&&($a.IsError=!0);"Origin"in ib&&($a.Origin=ib.Origin);$a.ClientThrottlingProtection=
this.Zg.ClientThrottlingProtection||"";$a.HostServiceLevel=this.Zg.HostServiceLevel||"";$a.RequestedCallThrottling=this.Zg.RequestedCallThrottling||"";$a.WacServiceLevel=this.Zg.WacServiceLevel||"";this.Zg.HostResponseStats&&(Db=this.Zg.HostResponseStats.Label)&&($a.HostFarmHint=Db);Db=n.AFrameworkApplication.fa;(Mb=Db.Ga(n.AFrameworkApplication.gK))&&""!==Mb&&($a.UiHost=Mb);(Mb=Db.Ga(n.AFrameworkApplication.aGh))&&""!==Mb&&($a.UiHostIntegrationType=Mb);Db.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&
(Db=ib.SessionOrigin,Db&&""!==Db||(ib=ib.SourceControlId)&&""!==ib&&na.a(na.d(ib),"feedback")&&(Db=this.d1f().SessionOrigin),Db&&""!==Db&&($a.SessionOrigin=Db));ib=null;try{ib=F.c($a),ib=za.a.Uca(ib,za.a.MAb)}catch(ob){ib="",h.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData: {0}",ob.message)}return{["appData"]:ib||""}}C8i(ib){const $a={};for(let Db in ib)$a[Db]=ib[Db];$a.IsFreemiumUpsellEnabled=this.Lob;$a.IsAadcEnabled=this.aff;$a.IsFeedbackEnabled=this.BP;return $a}F8i(){let ib=
null;try{const $a=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",null);$a&&(ib=F.b($a))}catch($a){h.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return ib||{}}i7i(ib,$a){if(ib&&$a){ib.LanguageID?ib.locale=ka.a.xe(ib.LanguageID).name||"":ib.ApplicationLCID&&(ib.locale=ib.ApplicationLCID);ib.applicationGroup=this.q_f(ib);ib.applicationSettings=this.C8i(n.AFrameworkApplication.fa.appSettings);ib.webSurfacesSettings=
this.F8i();Ga.ROf($a,ib);ib.appId=Ga.bNi();ib.environment=$a.JGe;ib.stylesUrl=this.gMd;ib.intlUrl=this.zDd;ib.rtl=n.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var Db=Ga.aNi();ib.primaryColour=Db.primaryColour;ib.secondaryColour=Db.secondaryColour;ib.sessionId=ib.SessionID||ib.WACSessionID||"";ib.build=ib.ApplicationVersion||ib.WFEVersion||"";Db=ib.FlightIDs?ib.FlightIDs.toString():ib.Flights?ib.Flights.toString():"";var Mb="";ib.ErrorCode&&(Mb=ib.ErrorCode.toString());var ob=this.Ggj(ib),jc=$a.omg()?
n.AFrameworkApplication.fa.Ga("TenantId"):"";jc&&"0"!==jc||(jc="");var Gb=n.AFrameworkApplication.fa.Ga("LoggableUserIdSpace"),Gc=n.AFrameworkApplication.fa.Ga("LoggableUserId")||"";switch(Gb){case "MsaPuid":Gc="p:"+Gc;break;case "MsaCid":Gc="m:"+Gc;break;case "OrgIdPuid":Gc="a:"+(n.AFrameworkApplication.fa.Ga("AADUserObjectId")||Gc);break;default:h.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: {0}, LoggableUserIdSpace: {1}",Gc,Gb),Gc=""}Gb={};if(void 0!==ib.telemetryGroup&&
null!==ib.telemetryGroup){const bc=ib.telemetryGroup;for(let dc in bc)Gb[dc]=bc[dc]}Gb.audienceGroup=$a.audienceGroup;Gb.audience=$a.audienceGroup;Gb.flights=Db;Gb.platform=ob;Gb.ringId=$a.qjb;Gb.officeUILang=n.AFrameworkApplication.lcid;Gb.errorCode=Mb;Gb.loggableUserId=Gc;Gb.processSessionId=ib.SessionID||ib.WACSessionID||"";Gb.officeBuild=ib.ApplicationVersion||ib.WFEVersion||"";0<jc.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==jc&&(Gb.tenantId=jc);ib.telemetryGroup=Gb;ib.webGroup={["browser"]:ib.Browser||
"",["browserVersion"]:(ib.BrowserMajorVersion||"")+"."+(ib.BrowserMinorVersion||""),["dataCenter"]:ib.Datacenter||ib.WACDatacenter||""};ib.isCommercialHost=n.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.VMi(ib);ib.disableIncludeScreenshot=!this.UTb;ib.screenshot=this.UTb;ib.showEmailAddress=this.cAc;ib.emailPolicyValue=this.cAc?1:0;ib.screenshotPolicyValue=this.UTb?1:0;n.AFrameworkApplication.fa.ka("IsO365CommercialHost")||(ib.disableIncludeScreenshot=!1,ib.showEmailAddress=!0,ib.screenshot=
!0);n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&(ib.surveyEnabled=this.CAc,n.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(ib.showEmailAddress=!0,ib.surveyEnabled=!0));this.oYi(ib,$a);this.kfd=ib.DismissHandler?ib.DismissHandler:null;this.TMi(ib)}}Egi(){return this.KBd&&this.LBd}getContext(ib){ib=ib||this.d1f();const $a=new P;this.i7i(ib,$a);return ib}Ggj(ib){let $a="";ib.Platform&&($a=ib.Platform.toString());ib.PlatformMajorVersion&&
(0<$a.length&&($a+=" "),$a+=ib.PlatformMajorVersion.toString()+".");ib.PlatformMinorVersion&&($a+=ib.PlatformMinorVersion.toString());return $a}srl(ib){ib.ApplicationMode&&(ib.AppMode=ib.ApplicationMode);ib.ApplicationModeExtended&&(ib.ApplicationMode=ib.ApplicationModeExtended)}d1f(){let ib;try{ib=F.b(n.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.srl(ib)}catch($a){h.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),ib={}}return ib}onError(ib){ib=
Ua.a.Bxb(ib);h.ULS.sendTraceTag(37259477,356,10,"FB submit error: {0}",ib);this.Zg.Feedback|=y.a.EXi;Ga.allowKeytips(!0)}kPi(){if(Ga.Zkg()){h.ULS.sendTraceTag(40112215,356,50,Ga.r1g);var ib=A.a.instance.resolve("Common.ISystemInitiatedFeedback");ib&&ib.logActivity("AppUsageNPSLocalizationTest",null)}}onDismiss(ib){this.koa();this.iui();ma.a.dHb()&&h.ULS.sendTraceTag(34936718,356,50,"FB dismiss");ma.a.nVa()&&da.c(ib?u.a.BXi:u.a.wXi,!0,null,2,8);ib?(ma.a.dHb()&&h.ULS.sendTraceTag(34936719,356,15,"FB submit"),
this.Zg.Feedback|=y.a.HXi):(this.Zg.Feedback|=y.a.DXi,this.kPi());this.Pa.raiseEvent(Ga.i4g,new fa(ib));Ga.allowKeytips(!0);this.kfd&&(this.kfd(),this.kfd=null)}MFj(){if(this.Od){let ib=!1,$a=5,Db=!1;this.aRb=this.clearInterval(this.aRb);this.$Qb=this.clearInterval(this.$Qb);this.$Qb=window.setInterval(()=>{if(this.noe){Db=!0;var Mb=this.Od.Fc(Ga.U7a);Mb.dJ=!0;Mb.parent=ca.AFrame.hj;Mb.c6a(Ga.gKi);Mb.Q7(()=>{let ob=this.Od.uQ(Ga.U7a),jc=null,Gb=5,Gc=!1;this.aRb=window.setInterval(()=>{this.MNj(this.Lcd)&&
(Gc=!0,this.noe.focus(),ob||(ob=this.Od.uQ(Ga.U7a)),ob&&!jc&&(jc=ob.wj),jc&&jc.ZE(this.noe));Gb--;if(Gc||!Gb)this.aRb=this.clearInterval(this.aRb)},1E3)});ib||(this.Od.LU(Ga.U7a,!0),ib=!0);this.qSh&&this.Lcd&&(Mb=new T.DOMFocusListing(()=>this.Lcd),Mb.Io(1),Mb.Io(2),Mb.Io(3),Mb.Io(5),Mb=this.Od.Yia(()=>this.Lcd,this.Od.Fc(Ga.U7a),Mb),Mb.Lib(),Mb.rX=!0,Mb.NQa=!0,Mb.A_g())}$a--;if(Db||!$a)this.$Qb=this.clearInterval(this.$Qb)},1E3)}}clearInterval(ib){ib!==Ga.Fmd&&(window.clearInterval(ib),ib=Ga.Fmd);
return ib}koa(){this.Od&&(this.Od.a1(Ga.U7a),this.Od.tKb(Ga.U7a))}TMi(ib){this.XDd?this.YDd||(ib.ageGroup=4):ib.ageGroup=3;n.AFrameworkApplication.fa.ka("IsAnonymousUser")?ib.authenticationType=2:ib.authenticationType="aad"===n.AFrameworkApplication.fa.Ga("HostAuthType")?1:0}VMi(ib){this.gAc&&(ib.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",ib.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.gAc){const $a=Ga.WMi();void 0!==$a&&null!==$a&&(ib.feedbackPortalUrl=
$a,ib.feedbackForumUrl=$a)}}static allowKeytips(ib){n.AFrameworkApplication.Aa.hb.Po&&ea.a("allowKeytips")&&appChrome.api.allowKeytips(ib)}static ROf(ib,$a){if($a){ib.qjb=parseInt($a.Ring);if(isNaN(ib.qjb))ib.audienceGroup="Unknown",ib.qjb=-2;else switch(ib.qjb){case 0:case 1:ib.audienceGroup="Dogfood";break;case 2:ib.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:ib.audienceGroup="Production";break;default:ib.audienceGroup="Unknown"}var Db=!0;$a.Host&&(Db="MsInternal"!==$a.Host&&"Blue Chicken"!==
$a.Host);ib.JGe=Db?0:1}}static bNi(){let ib=0;switch(ra.Redirect.application){case 2:ib=2155;break;case 4:ib=2158;break;case 3:ib=2157;break;case 1:ib=2156;break;case 5:ib=2159;break;default:h.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",ra.Redirect.application.toString())}return ib}static aNi(){const ib={};let $a="#2B579A",Db="#3C65A4";switch(ra.Redirect.application){case 2:n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?($a="#185ABD",Db="#2E6AC5"):
($a="#2B579A",Db="#3C65A4");break;case 4:$a="#7719AA";Db="#9953C0";break;case 3:$a="#B7472A";Db="#C75033";break;case 1:$a="#217346";Db="#3F8159";break;case 5:$a="#3955A3";Db="#4D6AB8";break;default:h.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",ra.Redirect.application.toString())}ib.primaryColour=$a;ib.secondaryColour=Db;return ib}static WMi(){let ib=null;switch(ra.Redirect.application){case 2:ib="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:ib="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";
break;case 3:ib="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:ib="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:ib="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:h.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",ra.Redirect.application.toString())}return ib}static XMi(ib){let $a=356;switch(ra.Redirect.application){case 2:switch(ib){case "Edit":$a=364;break;case "View":case "Attendee":case "Presenter":$a=
363;break;default:h.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",n.AFrameworkApplication.Aa.GYa),$a=363}break;case 4:$a=362;break;case 3:switch(ib){case "Edit":$a=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":$a=360;break;default:h.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",n.AFrameworkApplication.Aa.GYa),$a=360}break;case 1:switch(ib){case "Edit":$a=
358;break;case "View":$a=357;break;case "Survey":$a=359;break;default:h.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",n.AFrameworkApplication.Aa.GYa),$a=357}break;case 5:switch(ib){case "View":$a=373;break;case "Edit":$a=374;break;default:h.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",n.AFrameworkApplication.Aa.GYa),$a=373}break;default:h.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",
ra.Redirect.application.toString())}return $a}static gKi(){h.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static Zkg(){if(!Ga.yGe){const ib=!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka(Ga.r1g);Ga.yGe=ib?2:1}return 2===Ga.yGe}}Ga.U7a="CustomerFeedbackFocusId";Ga.i4g="FUID";Ga.Fmd=-1;Ga.yGe=0;Ga.r1g="NPSLocalizationTestingIsEnabled";Object(J.a)(Ga,"CustomerFeedbackUiWrapper",null,[1375]);var sa=d(15),Ba=d(1205),pa=d(1206);class ia{constructor(ib,$a,Db,Mb){this.x9e=
ib;this.Xga=$a;this.w9e=Db;this.hYh=Mb}activityName(){return this.Xga}object(){return this.hYh}}Object(J.a)(ia,"OneCallBackData",null,[]);class Da{constructor(ib,$a,Db,Mb){this.aNa=[];Array.add(this.aNa,new ia(ib,$a,Db,Mb))}add(ib){ib&&Array.addRange(this.aNa,ib.aNa)}kui(){Array.clear(this.aNa)}}Object(J.a)(Da,"CallBackData",null,[]);var Xa=d(532);class Ka extends Xa.a{constructor(ib,$a,Db=null,Mb=!1,ob=!1,jc=null,Gb=null,Gc=null){super("FloodgateTeachingCallout");this.image=this.footer=this.message=
this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=ib;this.message=$a;this.image=Db;this.positionImageAtLeft=Mb;this.smallHeadline=ob;this.title=jc;this.primaryButtonProps=Gb;this.secondaryButtonProps=Gc}}Object(J.a)(Ka,"FloodgateCalloutContent",Xa.a,[]);class Ma{constructor(){this.Ndh=this.options=null}}Object(J.a)(Ma,"Notification",null,[]);var Oa=d(1122),qa=d(933),Ya=d(351);class Fb extends Xa.a{constructor(ib,$a,Db=
null,Mb=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=ib;this.content=$a;this.imageProps=Db;this.imageHeight=Mb}}Object(J.a)(Fb,"PremiumUpsellCalloutContentProps",Xa.a,[]);var hc=d(934),ec=d(932);class Tb{static EXd(ib){return Tb.Lhj().then($a=>{try{const Db=[];for(let Mb=0;Mb<ib.length;Mb++){const ob=ib[Mb],jc=Tb.KWj(ob.surfaceType),Gb=new Ma;Gb.options=Tb.pfj(ob,!jc);Gb.Ndh=jc?$a.callout(Tb.Wkk(ib[Mb])):$a.externalNotification();Db.push(Gb)}return Tb.Iml($a,
Db)}catch(Db){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+Db.message);}})}static KWj(ib){switch(ib.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static pfj(ib,$a){const Db=new Ya.a;$a&&(Db.onShow=ib.onUnsupportedSurfaceType);Db.telemetryId="FloodgateTeachingUx-Surface"+($a?"NotSupported":"Supported");return Db}static Wkk(ib){var $a="premiumupsell"!==ib.surfaceType.toLowerCase()?new Ka(ib.footer,
ib.description,ib.illustrationImage?Object.assign(new ec.a(ib.illustrationImage),{ariaLabel:ib.imageAriaLabel}):null,"left"===ib.position,ib.smallHeadline,ib.title,Tb.YRc(ib.primaryButtonText,ib.primaryButtonAction),Tb.YRc(ib.secondaryButtonText,ib.secondaryButtonAction)):new Fb(ib.title,ib.description,ib.illustrationImage?Object.assign(new ec.a(ib.illustrationImage),{ariaLabel:ib.imageAriaLabel}):null);$a=Object.assign(new qa.a,{target:ib.selector,content:$a,showCloseIcon:null!=ib.hasCloseButton?
ib.hasCloseButton:!0,preventLightDismiss:null!=ib.preventAutoDismiss?ib.preventAutoDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new hc.a,{onDismiss:()=>{if(ib.onClosed)ib.onClosed("close")},directionalHint:ib.anchorHint,setInitialFocus:!0})});"coachmark"===ib.surfaceType.toLowerCase()?($a.hasDynamicSizing=!1,$a.useCoachmark=!0,$a.calloutProps.setInitialFocus=!1):"premiumupsell"===ib.surfaceType.toLowerCase()&&($a.primaryButtonProps=Tb.YRc(ib.primaryButtonText,ib.primaryButtonAction),
$a.secondaryButtonProps=Tb.YRc(ib.secondaryButtonText,ib.secondaryButtonAction),$a.showCloseIcon=!1,$a.useTeachingStyles=!1,$a.calloutProps.preventDismissOnLostFocus=!1);return $a}static YRc(ib,$a){return ib&&""!==ib&&$a?Object.assign(new Oa.a,{label:ib,onExecute:$a}):(h.ULS.shipAssertTag(594569111,356,(!ib||""===ib)&&!$a,"A callout button needs both a caption and an action."),null)}static Lhj(){Tb.KQc||(n.AFrameworkApplication.Aa.hb.XUa&&n.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?
Tb.KQc=v.UISurfaces.oL().then(ib=>{const $a=new Ka(null,null);if(ib.isCustomContentSupported&&ib.isCustomContentSupported($a))return ib;throw Error.create("Custom Content not supported: "+$a.type);},ib=>{h.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",ib);return null}):Tb.KQc=Promise.reject("React Notifications not enabled"));return Tb.KQc}static Iml(ib,$a){if(!$a||!$a.length)return[];const Db=[];for(let Mb=0;Mb<$a.length;Mb++){const ob=Tb.vnl(ib,$a[Mb]);Db.push(ob)}return Db}static vnl(ib,
$a){const Db=ib.addNotification($a.Ndh,$a.options);return()=>{ib.removeNotification(Db)}}}Tb.KQc=null;Object(J.a)(Tb,"FloodgateNotifications",null,[]);const vb=(ib,$a)=>{ib=n.AFrameworkApplication.fa.Ga("UserPrincipalName");if($a=!!$a.H1g&&2===$a.H1g.qjb)$a=($a=ib.toLowerCase())?0<$a.indexOf("linkedin.com")||0<$a.indexOf("linkedin.biz"):!1;return $a};class zb{constructor(ib,$a){this.H1g=ib;this.context=$a}}Object(J.a)(zb,"SurveyMetadata",null,[]);var Xb=d(67),Za=d(271),Va=d(93),tc=d(82);class Kb{constructor(ib){this.DUa=
this.isInitialized=!1;this.yja=this.Ymb=null;this.N1a=!1;this.W0e=null;this.djg=!1;this.cNc=0;this.LNf=-1;this.KLe=this.bNc=null;this.WTa=!0;this.gQ=ib;this.Mtc={};this.qzf=!1;this.RKb=this.na=null;this.JQc=0}iHj(ib){this.isInitialized&&this.Ymb||this.DUa?h.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===ib?h.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.N1a=ib.N1a,
h.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}ZGj(){const ib=this.gQ.getContext(null),$a=new P;Ga.ROf($a,ib);this.W0e=new zb($a,ib);this.RKb=new sa.ScriptSharpLegacyMap;this.RKb.$("LinkedInWACUsage",vb)}get Rrb(){this.Ymb||(this.Ymb=A.a.instance.rb("Common.App.IAppSpecificFeedbackData"));return this.Ymb}logActivity(ib,$a,Db=null){ib&&this.a9a(ib,Kb.mgb,$a)&&(this.isInitialized?(h.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+ib),ha.a.logActivity(ib,
Db)):(h.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+ib),this.Ree(new Da(ha.a.logActivity,ib,null,Db))))}Noe(ib){try{n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&h.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+ib),-1===this.LNf&&(this.LNf=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",Kb.oNf)),this.bNc||(this.bNc=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList",
" ").toString().toLowerCase()),!n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.bNc&&ib&&ib.startsWith("Ribbon_")&&-1===this.bNc.indexOf(ib.toLowerCase())?h.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.cNc&&n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.cNc),h.ULS.sendTraceTag(592217693,
356,50,"SIFB: LogActivityDeferred cancelled "+ib)),this.cNc=window.setTimeout(()=>{this.cNc=0;this.logActivity(ib,null)},Kb.oNf)):h.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+ib)}catch($a){h.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+($a?$a.toString():""))}}Bbc(ib,$a){ib&&this.a9a(ib,Kb.mgb,$a)&&(this.Zqg(ib,$a),this.Mtc[ib]=$a)}Zqg(ib,$a){this.a9a(ib,Kb.mgb,$a)&&(this.isInitialized?(h.ULS.sendTraceTag(37754501,
356,50,"SIFB: LogActivityStartInternal "+ib),ha.a.Bbc(ib,null)):(h.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+ib),this.Ree(new Da(ha.a.Bbc,ib,null,null))))}Xqg(ib){ib&&this.isInitialized&&this.a9a(ib,Kb.mgb,void 0)&&(ib in this.Mtc&&delete this.Mtc[ib],this.Yqg(ib,void 0))}Yqg(ib,$a){this.isInitialized&&this.a9a(ib,Kb.mgb,$a)&&(h.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+ib),ha.a.Xqg(ib))}iNb(ib,$a){if(this.a9a(ib,Kb.mgb,$a))if(this.Rrb){if($a=
this.Rrb.Sae(ib))this.isInitialized?(h.ULS.sendTraceTag(38605911,356,50,"SIFB:ShowUserInitiatedSurvey "+ib),ha.a.iNb($a)):(h.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+ib),this.Ree(new Da(null,null,ha.a.iNb,$a)))}else h.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}a9a(ib,$a,Db){if(this.DUa)return!1;if(!n.AFrameworkApplication.UE)return h.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.HOj())return!1;
this.gDi();return(this.yNj(ib)||this.TJi(ib)||this.cKj(ib))&&this.bki($a,Db)&&this.Otl(ib)}gDi(){if(!this.Ymb){const ib=A.a.instance.rb("Common.App.IAppSpecificFeedbackData");ib?this.Ymb=ib:h.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}IOj(ib){return 6!==ib}HOj(){if(0===this.JQc){const ib=this.gQ.getContext(null);this.JQc=this.IOj(parseInt(ib.Ring))?1:2;2===this.JQc&&h.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===
this.JQc}Otl(ib){null===this.RKb&&this.ZGj();return ib&&this.RKb&&this.RKb.Gb(ib)?this.RKb.ga(ib)(ib,this.W0e):!0}w8i(){if(!this.yja&&!this.qzf){this.qzf=!0;const ib=this.gQ.getContext(null);this.yja="locale"in ib?ib.locale:"";this.yja=this.yja.toLowerCase()}return this.yja}TJi(ib){this.yja||(this.yja=this.w8i());if(!(this.yja&&this.yja.length&&ib&&ib.length))return!1;let $a="en-us"===this.yja||this.MRj(ib)||Ga.Zkg();!$a&&this.BRj(ib)&&($a=this.CRj(this.yja));return $a}BRj(ib){return this.Rrb?"AppUsageNPS"===
ib||"AppUsageTimeSatisfiedNPS"===ib||"SuiteUsageNPS"===ib||"SuiteUsageTimeSatisfiedNPS"===ib:(h.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+ib),!1)}yNj(ib){return!!ib&&-1!==ib.toLowerCase().indexOf("floodgateflight")}MRj(ib){return!!ib&&-1!==ib.toLowerCase().indexOf("nlqs")}CRj(ib){if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",!1))return!0;if(!ib||!ib.length)return!1;if(!n.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===
ib;let $a=!1;switch(ib){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":$a=!0}return $a}bki(ib,$a){return n.AFrameworkApplication.fa.ka(ib)?$a&&!n.AFrameworkApplication.fa.ka($a)?(h.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+$a+") is off"),!1):!0:(h.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+
ib+") is off"),!1)}cKj(ib){const $a=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!ib&&!!$a&&-1!==$a.toLowerCase().indexOf(ib.toLowerCase())}Ree(ib){if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1))n.AFrameworkApplication.fa.ff(()=>{try{this.rOc(ib)}catch($a){h.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+
$a)}});else try{this.rOc(ib)}catch($a){h.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+$a)}}hlc(){this.N1a||this.start()}MAk(){this.N1a||this.stop()}O_e(){this.N1a&&this.start()}vsl(){this.N1a&&this.stop()}start(){h.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",!1)){const ib=tc.a.mMc(n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",
10),Object(e.a)(this,this.mzh,"startSurvey"),n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));n.AFrameworkApplication.ye.Db(ib)}else this.mzh(null)}mzh(){ha.a.$_i();this.cxl()}stop(){h.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.bxl(),ha.a.a0i())}cxl(){const ib=this.Mtc;for(let $a in ib)this.Zqg($a,ib[$a])}bxl(){const ib=this.Mtc;for(let $a in ib)this.Yqg($a,ib[$a])}rOc(ib){h.ULS.sendTraceTag(36546388,
356,100,"SIFB: Entered DownloadResources");var $a=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");$a&&($a.jUb?this.TXf(!0,ib):($a=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),$a.wal(ib),$a.Z0d(Object(e.a)(this,this.TXf,"floodgateJsDownloadFinished"))))}TXf(ib,$a){h.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+ib);let Db="";$a&&$a.aNa&&0<$a.aNa.length&&(Db=$a.aNa[0].activityName());
if(ib)if(R.a.qke())if(this.isInitialized)this.K0d($a);else{if(this.DUa||!this.KLe)this.KLe=this.gbh();this.KLe.then(()=>{this.K0d($a)}).catch(Mb=>this.hbh(Db,Mb))}else this.gbh().then(()=>{this.K0d($a)}).catch(Mb=>this.hbh(Db,Mb));else this.DUa=!0,h.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+Db)}hbh(ib,$a){this.DUa=!0;h.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+ib+". "+$a.toString())}b0i(ib){this.na||this.eHj();let $a=
ib;ib&&0<ib.length&&($a=this.na&&this.na.Gb(ib)?this.na.ga(ib):ib);return $a?$a:""}gbh(){var ib=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");ib&&ib.bpg(!0);this.fhl();this.Ggl();this.initOptions();if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&n.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.h4i().then($a=>{this.Voe($a);return $a}).then($a=>ha.a.Gee(Object(e.a)(this,
this.hJe,"onSIFeedbackDismiss"),Object(e.a)(this.gQ,this.gQ.onError,"onError"),$a,Object(e.a)(this.gQ,this.gQ.onDismiss,"onDismiss")));if(n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&n.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&n.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return Kb.yLi(this.G3f()).then(()=>{const $a=this.W5d();this.Voe($a);return $a}).then($a=>ha.a.Gee(Object(e.a)(this,this.hJe,"onSIFeedbackDismiss"),
Object(e.a)(this.gQ,this.gQ.onError,"onError"),$a,Object(e.a)(this.gQ,this.gQ.onDismiss,"onDismiss")));ib=this.W5d();this.Voe(ib);return ha.a.Gee(Object(e.a)(this,this.hJe,"onSIFeedbackDismiss"),Object(e.a)(this.gQ,this.gQ.onError,"onError"),ib,Object(e.a)(this.gQ,this.gQ.onDismiss,"onDismiss"))}h4i(){return new Promise(ib=>{A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute($a=>{const Db=this.W5d();$a.isFeatureEnabled("FloodgateSurvey",!0).then(Mb=>{Db.surveyEnabled=
"surveyEnabled"in Db?Mb&&Db.surveyEnabled:Mb;ib(Db);return null},Mb=>{h.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",Mb.toString());ib(Db);return null})})})}E8i(){let ib=null;try{const $a=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);$a&&(ib=F.b($a))}catch($a){h.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return ib||{}}W5d(){const ib=this.gQ.getContext(null);
ib.FloodgateUIAutoDismissTimeEnum=this.T4i();ib.uIStringGetter=Object(e.a)(this,this.b0i,"floodgateUIStringGetter");ib.authTokenCallback=Kb.nDi(Object(r.a)(String,ib.AudienceGroup));ib.augLoopCallback=Kb.lDi();ib.onTeachingCampaignRender=Kb.EXd;ib.governanceServiceEnabled=Kb.a3f();ib.governanceServiceConfig=Kb.Gaj();ib.personalizerEnabled=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);ib.messagingServiceSettings=this.E8i();ib.isPriorityEnabled=
Kb.khj();ib.enableWebCampaignGovernanceEnabled=Kb.cSi();ib.enableSendUserFacts=Kb.ZRi();ib.enableTargetedMessagingServiceFactRequest=Kb.$Ri();ib.disabledUserFacts=Kb.hOi();return ib}Voe(ib){const $a=this.gQ.Egi(),Db=this.G3f(),Mb=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),ob=n.AFrameworkApplication.fa.ka("IsO365CommercialHost"),jc=n.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),Gb=n.AFrameworkApplication.fa.ka("OcpsIsEnabled"),
Gc="surveyEnabled"in ib?ib.surveyEnabled:"null or undefined",bc="showEmailAddress"in ib?ib.showEmailAddress:"null or undefined",dc=Kb.a3f(),Nb=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);h.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',
$a,Mb,ob,jc,Gb,Db,bc,Gc,dc,F.c(ib.governanceServiceConfig),Nb)}T4i(){return vb(null,this.W0e)?(h.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",n.AFrameworkApplication.fa.Bc("FloodgateUIAutoDismissTimeEnum",2))}G3f(){return n.AFrameworkApplication.fa.Bc("FloodgateContextAndInitDelayInMilliSeconds",Kb.dLi)}K0d(ib){this.isInitialized=!0;this.z9h();
ha.a.bbl(Object(e.a)(this,this.V5j,"logTriggerEvent"));if(ib){for(const $a of ib.aNa)$a.x9e?(0,$a.x9e)($a.activityName(),$a.object()):$a.w9e?(0,$a.w9e)($a.object()):h.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");ib.kui()}else h.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const $a=this.gQ.getContext(null),Db=ha.a.I2f(Array.isArray($a.Flights)?$a.Flights:null),Mb=Db?Object(r.a)(String,Db.SelfTriggerActivity):null;if(Mb)for(const ob of Mb.split(";"))ob&&
""!==ob&&this.logActivity(ob,null)}catch($a){h.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+($a?$a.toString():""))}}z9h(){if(!this.djg&&window.addEventListener){const ib=Object(e.a)(this,this.JAk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",ib,!0);this.djg=!0}}frg(ib,$a){ib&&(n.AFrameworkApplication.Wj(ib),n.AFrameworkApplication.Ibc(ib));h.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+$a)}NMj(ib){if(!ib)return!1;try{const $a=(n.AFrameworkApplication.fa.Ga("FlightId")||
"").toLocaleLowerCase(),Db=ib.toString().toLocaleLowerCase().split(";");for(const Mb of Db)if(2<Mb.length&&(Mb.lastIndexOf("-control")===Mb.length-8||Mb.lastIndexOf("cf")===Mb.length-2&&-1!==$a.indexOf(Mb)))return!0}catch($a){h.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+($a?$a.toString():""))}return!1}V5j(ib,$a){$a=$a||{};if(ib&&!("isControl"in $a)){const Db=this.NMj(ib);Db&&($a.isControl=Db)}this.frg(ib,JSON.stringify($a))}JAk(ib){if(ib=ib?ib.detail:null){var $a=!n.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),
Db=(ib.action||"").toLowerCase();switch(Db){case "dismissed":$a&&Za.a.instance.Lo("obf-DynamicWebSurfaces");break;case "updated":$a&&ha.a.tra("obf-DynamicWebSurfaces");break;case "opened":case "":Db=ib.telemetryEventName;let Mb;try{Mb=JSON.stringify(ib)}catch(ob){Mb="id : "+ib.id+" telemetryEventName: "+Db,h.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+Mb+" Error: "+(ob?ob.toString():""))}ib.success?this.frg(Db,Mb):h.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+
Mb);ib.isHidden||ib.isAA||!$a||ha.a.tra("obf-DynamicWebSurfaces");break;default:h.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+Db)}}}fYk(ib){if(!ib)return null;try{const $a=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase();if(!$a||""===$a)return ib;const Db=F.b(ib),Mb=new O.a;let ob=0;for(const jc of Db){const Gb=jc.CampaignId;Gb&&-1!==$a.indexOf(Gb.toLowerCase())?(h.ULS.sendTraceTag(509167254,356,50,"Ignoring disabled campaign -"+
Gb),ob++):Mb.add(jc)}return ob?F.c(Mb.toArray()):ib}catch($a){return h.ULS.sendTraceTag(509167253,356,10,"Error filtering out disabled campaigns"),ib}}Wzl(ib){var $a=["Live"];if(!ib)return null;try{const Db=F.b(ib),Mb=new O.a;for(const ob of Db){const jc=ob.Tags;if(jc)for(const Gb of $a)Array.contains(jc,Gb)&&Mb.add(ob)}return F.c(Mb.toArray())}catch(Db){return h.ULS.sendTraceTag(523904348,356,10,"Could not deserialize CampaignDefinitionsJson"),null}}fhl(){let ib=!1,$a=null;const Db=this.Z9a();if(Db&&
this.Rrb)try{let Mb=this.Rrb.M5i();n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&n.AFrameworkApplication.ela&&(Mb=this.Wzl(Mb));n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FilterDisabledCampaigns",!0)&&(Mb=this.fYk(Mb));Mb?(Db.setItem(Kb.$pi,Mb),ib=!0):($a="SIFB.campaign str was null",h.ULS.sendTraceTag(594143442,356,10,$a))}catch(Mb){$a="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+
Mb,h.ULS.sendTraceTag(594143441,356,50,$a)}else this.Rrb?($a="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",h.ULS.sendTraceTag(594143440,356,50,$a)):($a="SIFB.Floodgate surveys not available. App Specific Feedback data was null",h.ULS.sendTraceTag(556896920,356,50,$a));h.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+ib+" errorString: "+($a?$a:"null"))}hJe(ib,$a){ma.a.dHb()&&h.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",
$a,ib);ma.a.nVa()&&da.c($a?u.a.cJl:u.a.bJl,!0,null,2,8);Za.a.instance.Lo(ha.a.SXf)}initOptions(){}Ggl(){this.N1a||(Va.a.addHandler(window.self,Xb.a.focus,Object(e.a)(this,this.hlc,"onWindowFocus")),Va.a.addHandler(window.self,Xb.a.blur,Object(e.a)(this,this.MAk,"onWindowBlur")))}Z9a(){if(!this.WTa)return null;let ib=null;try{ib=localStorage}catch($a){this.WTa=!1,ib=null,h.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+($a?$a.toString():""))}return ib}eHj(){h.ULS.sendTraceTag(39077269,
356,50,"inside InitializeUIStringGetter");try{this.na=new Ba.a(pa.a.Hn()),this.na.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.na.$("nps_PromptQuestion",CommonUIStrings.l_WAC_NPS_PromptQuestion),this.na.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.na.$("nps_RatingQuestion_Word",Kb.I9f()),this.na.$("nps_RatingQuestion_OneNote",Kb.Ppj()),this.na.$("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.na.$("nps_OneClickPromptQuestion_Excel",
CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.na.$("nps_OneClickRatingQuestion_Excel",Kb.G9f()),this.na.$("nps_OneClickRatingQuestion_PowerPoint",Kb.H9f()),this.na.$("nps_RatingQuestion_PowerPoint",Kb.H9f()),this.na.$("nps_RatingQuestion_Excel",Kb.G9f()),this.na.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.na.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.na.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),
this.na.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.na.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.na.$("nps_Rating_Values_5",CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.na.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.na.$("nps_OneClickRatingQuestion_Word",Kb.I9f()),this.na.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),
this.na.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.na.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),this.na.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.na.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.na.$("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.na.$("nps_Suite_QuestionQuestion",
"Please tell us more. Why did you choose that answer?"),this.na.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.na.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),this.na.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.na.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.na.$("NSV_Prompt_Title_Feedback",CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.na.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.na.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.na.$("NSVDidntCreateNSVOption_2",
CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.na.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.na.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.na.$("NSVFreeformDidntCreateSheetView",CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.na.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.na.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.na.$("CatchUpFPS_Title",
CommonUIStrings.l_WAC_CatchUpFPS_Title),this.na.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.na.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.na.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),this.na.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.na.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),
this.na.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.na.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.na.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.na.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.na.$("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),
this.na.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.na.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.na.$("ReviewMode_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.na.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.na.$("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),
this.na.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.na.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.na.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),this.na.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.na.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.na.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),
this.na.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.na.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.na.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),this.na.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.na.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.na.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),
this.na.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.na.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.na.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),this.na.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.na.$("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.na.$("connector_campaign_Rating_Values_2",
CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.na.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.na.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),this.na.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.na.$("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),
this.na.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.na.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.na.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),this.na.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.na.$("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),
this.na.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.na.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.na.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),this.na.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.na.$("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),
this.na.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.na.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.na.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),this.na.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.na.$("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),
this.na.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.na.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.na.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),this.na.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.na.$("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),
this.na.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.na.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.na.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),this.na.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.na.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.na.$("OfficeScriptsFPS_NoLabel",
CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.na.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.na.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.na.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),this.na.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.na.$("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),
this.na.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.na.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.na.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.na.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.na.$("ExcelAddins_QuestionQuestion",CommonUIStrings.l_Excel_Addins_QuestionQuestion),
this.na.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.na.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.na.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.na.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),this.na.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.na.$("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),
this.na.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.na.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.na.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.na.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelIdeas_Rating_3_Expectations",
CommonUIStrings.l_Excel_Rating_3_Expectations),this.na.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.na.$("ExcelRecommendedCharts_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),
this.na.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.na.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_3_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_4_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.na.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.na.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_Question",CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.na.$("ExcelRecommendedPivotTable_ExpectationsQuestion",
CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_5_Expectations",
CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.na.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.na.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.na.$("Download_as_Image_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.na.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),
this.na.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("TextPredictions_FloodgatePromptTitle",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.na.$("TextPredictions_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.na.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.na.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.na.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),this.na.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),
this.na.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.na.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.na.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.na.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),this.na.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),
this.na.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.na.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.na.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.na.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.na.$("SoftwareITDiagrams_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.na.$("SoftwareITDiagrams_Rating_Values_3",
CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),this.na.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),
this.na.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.na.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.na.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.na.$("ExternalContent_FloodgateRating_1",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.na.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),
this.na.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.na.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.na.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.na.$("ExternalContent_FloodgateQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.na.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),
this.na.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.na.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.na.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.na.$("Translator_RatingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.na.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),
this.na.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.na.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.na.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.na.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),this.na.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.na.$("TeamsOpen_GreetingQuestion",
CommonUIStrings.l_WAC_NPS_Title),this.na.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),this.na.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.na.$("TeamsOpen_RatingQuestion_PowerPoint",
CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.na.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.na.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.na.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("LinkedIn_Title",CommonUIStrings.l_LinkedIn_Title),this.na.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.na.$("LinkedIn_QuestionQuestion",
CommonUIStrings.l_LinkedIn_QuestionQuestion),this.na.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.na.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.na.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.na.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),this.na.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.na.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),
this.na.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.na.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.na.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.na.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.na.$("VHRestore_SurveyQuestion",CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.na.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.na.$("VHRestore_Answer_Options_2",
CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.na.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.na.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.na.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.na.$("ShowChanges_Prompt",CommonUIStrings.l_Excel_ShowChanges_Prompt),this.na.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.na.$("ShowChanges_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.na.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.na.$("ShowChanges_RatingValue_2",CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.na.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.na.$("ShowChanges_RatingValue_4",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.na.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.na.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.na.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),this.na.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",
CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.na.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.na.$("ModernUxExperiment_FloodgateRatingValue_1",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.na.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),
this.na.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.na.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.na.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),this.na.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptTitle",
CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.na.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),
this.na.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),
this.na.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.na.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.na.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.na.$("PollLoopComponent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.na.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.na.$("PollLoopComponent_FloodgateRatingValue_2",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.na.$("PollLoopComponent_FloodgateRatingValue_3",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.na.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.na.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.na.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),
this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.na.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.na.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),this.na.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),
this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.na.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),
this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),
this.na.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.na.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.na.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.na.$("ShortcutDiscovery_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.na.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.na.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("ShortcutDiscovery_RatingValue_5",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.na.$("Fonts_PromptTitle",CommonUIStrings.l_FontExperience_FloodgatePromptTitle),this.na.$("Fonts_PromptQuestion",CommonUIStrings.l_FontExperience_FloodgatePromptQuestion),this.na.$("Fonts_PromptAnswer_NotNow",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_NotNow),this.na.$("Fonts_PromptAnswer_Sure",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_Sure),
this.na.$("Fonts_RatingQuestion",CommonUIStrings.l_FontExperience_FloodgateRatingQuestion),this.na.$("Fonts_RatingValue_1",CommonUIStrings.l_FontExperience_FloodgateRatingValue_1),this.na.$("Fonts_RatingValue_2",CommonUIStrings.l_FontExperience_FloodgateRatingValue_2),this.na.$("Fonts_RatingValue_3",CommonUIStrings.l_FontExperience_FloodgateRatingValue_3),this.na.$("Fonts_RatingValue_4",CommonUIStrings.l_FontExperience_FloodgateRatingValue_4),this.na.$("Fonts_RatingValue_5",CommonUIStrings.l_FontExperience_FloodgateRatingValue_5),
this.na.$("Fonts_WhyQuestion",CommonUIStrings.l_FontExperience_FloodgateWhyQuestion),this.na.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.na.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.na.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),this.na.$("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.na.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.na.$("Ruler_RatingValue_1",
CommonUIStrings.l_WordRuler_RatingValue_1),this.na.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.na.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.na.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.na.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),this.na.$("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.na.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),
this.na.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.na.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.na.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.na.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),this.na.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.na.$("CustomTabDialog_RatingValue_2",
CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.na.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.na.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.na.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.na.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),this.na.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),
this.na.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.na.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.na.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.na.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),this.na.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.na.$("WordStyles_FloodgateRating_2",
CommonUIStrings.l_WordStyles_FloodgateRating_2),this.na.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.na.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.na.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.na.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),this.na.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),
this.na.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.na.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.na.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.na.$("UnsavedChangesHighlight_RatingQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.na.$("UnsavedChangesHighlight_Rating_Yes",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.na.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.na.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.na.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),this.na.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),
this.na.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.na.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.na.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.na.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),this.na.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),
this.na.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.na.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.na.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.na.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),this.na.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),
this.na.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.na.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.na.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.na.$("GrammarSuggestions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.na.$("GrammarSuggestions_FloodgateRating_1",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.na.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.na.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.na.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),this.na.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.na.$("GrammarSuggestions_FloodgateQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.na.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.na.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.na.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),this.na.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.na.$("WordRemoveSsr_FloodgateRatingQuestion",
CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.na.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.na.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.na.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.na.$("WordRemoveSsr_FloodgateRating_4",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.na.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),
this.na.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.na.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.na.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.na.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),this.na.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),
this.na.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.na.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.na.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.na.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.na.$("WordDrawing_FloodgateRating_4",CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.na.$("WordDrawing_FloodgateRating_5",
CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.na.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.na.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.na.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.na.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.na.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.na.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.na.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),this.na.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),
this.na.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.na.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.na.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.na.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.na.$("ShyRibbon_Floodgate_Option_3",CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.na.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),
this.na.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.na.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.na.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.na.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),this.na.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),
this.na.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.na.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.na.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.na.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),this.na.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),
this.na.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.na.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.na.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),
this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_4",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),
this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.na.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.na.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.na.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("WordSimilarity_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.na.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.na.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.na.$("WordSimilarity_FloodgateRating_3",CommonUIStrings.l_WordSimilarity_FloodgateRating_3),
this.na.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.na.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.na.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.na.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.na.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),this.na.$("PremiumPreviewFloodgateRatingQuestion",
CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.na.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.na.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.na.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.na.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.na.$("FloodgateNLQSPromptSubtitle",CommonUIStrings.l_FloodgateNLQSPromptSubtitle),
this.na.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.na.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.na.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.na.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.na.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.na.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),this.na.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),
this.na.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.na.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.na.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.na.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.na.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.na.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.na.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.na.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.na.$("ExcelWebEaseOfUse_RatingValue_4",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.na.$("ExcelWebEaseOfUse_RatingValue_5",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.na.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.na.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.na.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.na.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.na.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.na.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.na.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.na.$("ExcelWebPrintSurvey_RatingValue_4",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),
this.na.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.na.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.na.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.na.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.na.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ReactAutoFilter_PromptLabel_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.na.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.na.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.na.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.na.$("ReactAutoFilter_RatingValue_4",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),
this.na.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.na.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.na.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.na.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.na.$("WordLinksExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),
this.na.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.na.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.na.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.na.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),this.na.$("WordLinksExperience_FloodgateRating_3",
CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.na.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.na.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.na.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.na.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),this.na.$("OnlineVideoSupport_FloodgatePromptQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.na.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.na.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.na.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.na.$("OnlineVideoSupport_FloodgateRating_1",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),
this.na.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.na.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.na.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.na.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.na.$("OnlineVideoSupport_FloodgateWhyQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),
this.na.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.na.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.na.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.na.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),this.na.$("NavPaneExperience_FloodgateRatingQuestion",
CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.na.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.na.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.na.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.na.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),this.na.$("NavPaneExperience_FloodgateRating_5",
CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.na.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.na.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.na.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.na.$("BookmarksExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),
this.na.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.na.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.na.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.na.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),this.na.$("BookmarksExperience_FloodgateRating_3",
CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.na.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.na.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.na.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.na.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),this.na.$("WordPictureBorder_FloodgatePromptQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.na.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.na.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.na.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.na.$("WordPictureBorder_FloodgateRating_1",CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),
this.na.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.na.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.na.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.na.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.na.$("WordPictureBorder_FloodgateWhyQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),
this.na.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.na.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.na.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.na.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.na.$("WordComment_FloodgateRatingQuestion",CommonUIStrings.l_WordComment_FloodgateRatingQuestion),
this.na.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.na.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.na.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.na.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.na.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),this.na.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),
this.na.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.na.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.na.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.na.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),this.na.$("WordTrackChanges_FloodgateRatingQuestion",
CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.na.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.na.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.na.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.na.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),this.na.$("WordTrackChanges_FloodgateRating_5",
CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.na.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),
this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),
this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.na.$("CollabCorner_Survey_DownloadCopies_Comment_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),
this.na.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.na.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.na.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.na.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),this.na.$("WordListsExperience_FloodgateRatingQuestion",
CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.na.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.na.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.na.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.na.$("WordChartsSupport_FloodgatePromptTitle",CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),
this.na.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.na.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.na.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.na.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),this.na.$("WordChartsSupport_FloodgateRating_1",
CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.na.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.na.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.na.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.na.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),this.na.$("WordChartsSupport_FloodgateWhyQuestion",
CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.na.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.na.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.na.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.na.$("WordTablesSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),
this.na.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.na.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.na.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.na.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.na.$("WordTablesSupport_FloodgateRating_4",CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),
this.na.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.na.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.na.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.na.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.na.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ModernPresence_PromptLabel_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.na.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.na.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.na.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.na.$("ModernPresence_RatingValue_4",CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),
this.na.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.na.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.na.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.na.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.na.$("WordInsertImages_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),
this.na.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.na.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.na.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.na.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.na.$("WordInsertImages_FloodgateRating_3",CommonUIStrings.l_WordInsertImages_FloodgateRating_3),
this.na.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.na.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.na.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.na.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.na.$("FontPicker_FloodgatePromptQuestion",CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),
this.na.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.na.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.na.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.na.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.na.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),this.na.$("FontPicker_FloodgateRating3",
CommonUIStrings.l_FontPicker_FloodgateRating3),this.na.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.na.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.na.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.na.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.na.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.na.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.na.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.na.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.na.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.na.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.na.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.na.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.na.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.na.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.na.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.na.$("WordWebEditorSeen_FloodgateRating_3",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.na.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.na.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.na.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.na.$("OnenotePerf_FloodgatePromptTitle",Kb.Qpj()),this.na.$("OnenotePerf_FloodgatePromptQuestion",
CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.na.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.na.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.na.$("OnenotePerf_FloodgateRatingQuestion",Kb.Rpj()),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),
this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.na.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.na.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),
this.na.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),this.na.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.na.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.na.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.na.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.na.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),
this.na.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.na.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.na.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.na.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.na.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.na.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),
this.na.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.na.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),
this.na.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.na.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.na.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.na.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.na.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.na.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.na.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.na.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.na.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.na.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.na.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.na.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.na.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.na.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.na.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.na.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.na.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.na.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.na.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.na.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.na.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.na.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.na.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.na.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.na.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),
this.na.$("WordDesignerBlankDocumentExperienceRatingQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.na.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.na.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.na.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.na.$("WordDesignerFormattingSuggestionsSurveyQuestion",
CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.na.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.na.$("WordDesignerDesignerPasteFeedbackRatingQuestion",Kb.Spj()),this.na.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.na.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.na.$("WordDesignerHideSuggestionsAnswer2",
CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.na.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.na.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.na.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.na.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.na.$("FpsInDocSearch_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.na.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.na.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.na.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),
this.na.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.na.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.na.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.na.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.na.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.na.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.na.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.na.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.na.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.na.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.na.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.na.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.na.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.na.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.na.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.na.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.na.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.na.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.na.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.na.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.na.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.na.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.na.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.na.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.na.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.na.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.na.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.na.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.na.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.na.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.na.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.na.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.na.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.na.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.na.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.na.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.na.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.na.$("ConditionalFormatting_PromptLine_2",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.na.$("ConditionalFormatting_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.na.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.na.$("ConditionalFormatting_RatingValue_2",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.na.$("ConditionalFormatting_RatingValue_3",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.na.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.na.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.na.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),this.na.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.na.$("InAppNotification_Description",
CommonUIStrings.l_WAC_InAppNotification_Description),this.na.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.na.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.na.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.na.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.na.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.na.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),
this.na.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.na.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.na.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.na.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),
this.na.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.na.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.na.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.na.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.na.$("WordWebOpeningDocuments_FloodgateRating_2",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.na.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.na.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.na.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.na.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),
this.na.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.na.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.na.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.na.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.na.$("WordCommentReaction_FloodgateRatingQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.na.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.na.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.na.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.na.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.na.$("WordCommentReaction_FloodgateRating_5",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.na.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.na.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.na.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.na.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.na.$("GuestCoauthoring_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.na.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.na.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.na.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.na.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.na.$("GuestCoauthoring_FloodgateRatingValue_4",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.na.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.na.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.na.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.na.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),
this.na.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.na.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.na.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.na.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.na.$("CtrlClickExperience_FloodgateRating_2",
CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.na.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.na.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.na.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.na.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.na.$("WordTypingResponsiveness_FloodgatePromptTitle",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.na.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.na.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.na.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.na.$("WordTypingResponsiveness_FloodgateRatingQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.na.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.na.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.na.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.na.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),
this.na.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.na.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.na.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.na.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.na.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.na.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.na.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.na.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.na.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.na.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.na.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),
this.na.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.na.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.na.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.na.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.na.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),
this.na.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.na.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.na.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.na.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),
this.na.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.na.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.na.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.na.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.na.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.na.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),
this.na.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.na.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.na.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.na.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.na.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),
this.na.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.na.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),
this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.na.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),
this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.na.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.na.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.na.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),
this.na.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.na.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.na.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.na.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.na.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),
this.na.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.na.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.na.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.na.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.na.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PerformanceExperience_RatingQuestion",Kb.l7b(0)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile",Kb.l7b(1)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness",Kb.l7b(2)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",Kb.l7b(3)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",Kb.l7b(4)),this.na.$("PerformanceExperience_RatingValue_1",
CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.na.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),
this.na.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),this.na.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.na.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),this.na.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),
this.na.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),this.na.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.na.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.na.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),this.na.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),this.na.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),
this.na.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.na.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),
this.na.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.na.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.na.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),
this.na.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.na.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.na.$("Fluent2Survey_RatingValue_2",
CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.na.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.na.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.na.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),
this.na.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),this.na.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),
this.na.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),this.na.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.na.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.na.$("ConsumerExperiment_PromptQuestion",
CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.na.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),this.na.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.na.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.na.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.na.$("ConsumerExperiment_RatingValue4",
CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.na.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),this.na.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.na.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),
this.na.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.na.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),this.na.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.na.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.na.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.na.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.na.$("AIMakerSurvey_CommentQuestion",
CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.na.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.na.$("CheckPerformance_PromptQuestion",CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.na.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),
this.na.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.na.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),this.na.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.na.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.na.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.na.$("CheckPerformance_CommentQuestion",
CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.na.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.na.$("SmartSuggestion_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.na.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),
this.na.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.na.$("SmartSuggestion_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.na.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.na.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.na.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),
this.na.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.na.$("PPTO_Picture_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("PPTO_Picture_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PPTO_Picture_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PPTO_Picture_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("PPTO_Picture_FloodgateRatingQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateRatingQuestion),this.na.$("PPTO_Picture_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PPTO_Picture_FloodgateRating_4",CommonUIStrings.l_PPTO_Picture_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PPTO_Picture_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PPTO_Picture_FloodgateWhyQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateWhyQuestion),this.na.$("CCPExperience_FloodgatePromptTitle",CommonUIStrings.l_CCPExperience_FloodgatePromptTitle),this.na.$("CCPExperience_FloodgatePromptQuestion",CommonUIStrings.l_CCPExperience_FloodgatePromptQuestion),this.na.$("CCPExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_YesLabel),
this.na.$("CCPExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_NoLabel),this.na.$("CCPExperience_FloodgateRatingQuestion",CommonUIStrings.l_CCPExperience_FloodgateRatingQuestion),this.na.$("CCPExperience_FloodgateRating_1",CommonUIStrings.l_CCPExperience_FloodgateRating_1),this.na.$("CCPExperience_FloodgateRating_2",CommonUIStrings.l_CCPExperience_FloodgateRating_2),this.na.$("CCPExperience_FloodgateRating_3",CommonUIStrings.l_CCPExperience_FloodgateRating_3),this.na.$("CCPExperience_FloodgateRating_4",
CommonUIStrings.l_CCPExperience_FloodgateRating_4),this.na.$("CCPExperience_FloodgateRating_5",CommonUIStrings.l_CCPExperience_FloodgateRating_5),this.na.$("CCPExperience_FloodgateWhyQuestion",CommonUIStrings.l_CCPExperience_FloodgateWhyQuestion),this.na.$("FRE_FirstTeachingCalloutTitle",CommonUIStrings.l_FRE_FirstTeachingCalloutTitle),this.na.$("FRE_FirstTeachingCalloutDescription",CommonUIStrings.l_FRE_FirstTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutNextButtonText",CommonUIStrings.l_FRE_TeachingCalloutNextButtonText),
this.na.$("FRE_SecondTeachingCalloutTitle",CommonUIStrings.l_FRE_SecondTeachingCalloutTitle),this.na.$("FRE_SecondTeachingCalloutDescription",CommonUIStrings.l_FRE_SecondTeachingCalloutDescription),this.na.$("FRE_ThirdTeachingCalloutTitle",CommonUIStrings.l_FRE_ThirdTeachingCalloutTitle),this.na.$("FRE_ThirdTeachingCalloutDescription",CommonUIStrings.l_FRE_ThirdTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutGotItButtonText",CommonUIStrings.l_FRE_TeachingCalloutGotItButtonText),this.na.$("FloodgateSurveyNoRealEditPromptTitle",
CommonUIStrings.l_FloodgateSurveyNoRealEditPromptTitle),this.na.$("FloodgateSurveyNoRealEditPromptQuestion",CommonUIStrings.l_FloodgateSurveyNoRealEditPromptQuestion),this.na.$("FloodgateSurveyNoRealEditSure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FloodgateSurveyNoRealEditNotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FloodgateSurveyNoRealEditQuestion1",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion1),this.na.$("FloodgateSurveyNoRealEditOption1",CommonUIStrings.l_FloodgateSurveyNoRealEditOption1),
this.na.$("FloodgateSurveyNoRealEditOption2",CommonUIStrings.l_FloodgateSurveyNoRealEditOption2),this.na.$("FloodgateSurveyNoRealEditOption3",CommonUIStrings.l_FloodgateSurveyNoRealEditOption3),this.na.$("FloodgateSurveyNoRealEditOption4",CommonUIStrings.l_FloodgateSurveyNoRealEditOption4),this.na.$("FloodgateSurveyNoRealEditOption5",CommonUIStrings.l_FloodgateSurveyNoRealEditOption5),this.na.$("FloodgateSurveyNoRealEditQuestion2",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion2),this.na.$("FormulaByExample_PromptTitle",
CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptTitle),this.na.$("FormulaByExample_PromptQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptQuestion),this.na.$("FormulaByExample_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulaByExample_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulaByExample_RatingQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingQuestion),this.na.$("FormulaByExampleIgnored_RatingQuestion",
CommonUIStrings.l_Excel_FormulaByExampleIgnored_Survey_RatingQuestion),this.na.$("FormulaByExample_RatingValue_1",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_1),this.na.$("FormulaByExample_RatingValue_2",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_2),this.na.$("FormulaByExample_RatingValue_3",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_3),this.na.$("FormulaByExample_RatingValue_4",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_4),this.na.$("FormulaByExample_RatingValue_5",
CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_5),this.na.$("FormulaByExample_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_CommentQuestion),this.na.$("FormulaByExampleDeclined_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExampleDeclined_Survey_CommentQuestion),this.na.$("CIQSeenNotKeptFPS_Title",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Title),this.na.$("CIQSeenNotKeptFPS_Question",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Question),this.na.$("CIQSeenNotKeptFPS_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CIQSeenNotKeptFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CIQSeenNotKeptFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_RatingQuestion),this.na.$("CIQSeenNotKeptFPS_RatingValue_Yes",CommonUIStrings.l_DialogYes),this.na.$("CIQSeenNotKeptFPS_RatingValue_No",CommonUIStrings.l_DialogNo),this.na.$("CIQSeenNotKeptFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_WhyQuestion),this.na.$("FloodgateSurveyProofingSuggestions_PromptTitle",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptTitle),this.na.$("FloodgateSurveyProofingSuggestions_PromptQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion),this.na.$("FloodgateSurveyProofingSuggestions_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FloodgateSurveyProofingSuggestions_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FloodgateSurveyProofingSuggestions_WhyQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion1),
this.na.$("FloodgateSurveyProofingSuggestions_Option_1",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption1),this.na.$("FloodgateSurveyProofingSuggestions_Option_2",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption2),this.na.$("FloodgateSurveyProofingSuggestions_Option_3",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption3),this.na.$("FloodgateSurveyProofingSuggestions_Option_4",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption4),this.na.$("FloodgateSurveyProofingSuggestions_Option_5",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption5),this.na.$("FloodgateSurveyProofingSuggestions_AdditionalDetailsQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion2)}catch(ib){h.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(ib?ib.toString():""))}}static yLi(ib){try{return new Promise($a=>{window.setTimeout(()=>{$a(null)},ib)})}catch($a){return h.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),
Promise.resolve(null)}}static a3f(){return!n.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static khj(){return n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",!1)}static cSi(){return n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableWebCampaignGovernance",!1)}static ZRi(){return n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSendUserFacts",
!1)}static $Ri(){return n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTargetedMessagingServiceFactRequest",!1)}static hOi(){let ib=null;try{const $a=n.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.DisabledUserFacts","");$a&&""!==$a&&(ib=$a.split(","))}catch($a){h.ULS.sendTraceTag(509159242,356,10,"Could not deserialize DisabledUserFacts")}return ib||[]}static EXd(ib){const $a=ib?ib[0]:null;h.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+
($a?$a.surfaceId:""));if($a&&"customsurface"===($a&&$a.surfaceType?$a.surfaceType.toLocaleLowerCase():null)){const Db=ha.a.dyj($a);if(Db)return h.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+Db+", "+$a.surfaceId),null}return Tb.EXd(ib)}static Gaj(){const ib={};ib.retry=n.AFrameworkApplication.fa.Bc("FloodgateGovernanceServiceRetryCount",0);ib.timeout=n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);
ib.simpleRequestEnabled=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);ib.forceServicelessSurveyDisplay=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1);return ib}static nDi(ib){if(!("Unknown"!==ib&&"Automation"!==ib&&n.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",
!1)))return h.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+ib),null;ib={};ib.getUserPuid=Kb.Toj;return ib}static lDi(){const ib={},$a=!n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",!1)&&(n.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));ib.isEnabled=$a;return ib}static Toj(){return n.AFrameworkApplication.fa.Ga("Puid")}static I9f(){return ha.a.Hua()?
CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static H9f(){return ha.a.Hua()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static G9f(){return ha.a.Hua()&&n.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static l7b(ib){if(ha.a.Hua())switch(ib){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;
case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(ib){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;
case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static Ppj(){return ha.a.Hua()&&n.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static Rpj(){return ha.a.Hua()?
CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static Qpj(){return ha.a.Hua()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static Spj(){switch(n.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;
case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}Kb.mgb="SystemInitiatedFeedbackIsEnabled";Kb.$pi="obf-CampaignDefinitions";Kb.oNf=100;Kb.dLi=8002;Object(J.a)(Kb,"SystemInitiatedFeedback",null,[1376]);class Pa{constructor(ib){if(!ib)throw Error.argumentNull("SystemInitiatedFeedback is null");this.kpf=ib;this.txd={};this.ewc={};this.qxd={}}logActivity(ib,$a,Db){const Mb=new Date;if(!ib||!this.kpf.a9a(ib,Kb.mgb,$a))return!1;let ob=null;ib in this.txd&&
(ob=this.txd[ib]);const jc=this.Q3i(ib),Gb=this.P3i(ib);if(this.zSi(ob,Mb,Db))return h.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",jc,ib),this.kpf.logActivity(ib,$a),this.txd[ib]=Mb,this.ewc[ib]=0,this.qxd[ib]=Gb+1,!0;this.ewc[ib]=jc+1;return!1}zSi(ib,$a,Db){return ib?$a.getTime()-ib.getTime()>=1E3*Db:!0}Q3i(ib){let $a=0;ib in this.ewc&&($a=this.ewc[ib]);return $a}P3i(ib){let $a=0;ib in this.qxd&&($a=this.qxd[ib]);return $a}}Object(J.a)(Pa,"SystemInitiatedFeedbackWithTimeLapse",
null,[1374]);var mb=d(95),qc=d(71);d.d(aa,"CustomerFeedbackPackage",function(){return oc});class oc{constructor(){this.T$e=this.Da=null}get name(){return"Common.App.CustomerFeedback"}Zb(ib){n.AFrameworkApplication.Zg||(h.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),n.AFrameworkApplication.Zg=new B.a);ib.register(Z,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();ib.register(Ga,
"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().oa(()=>new Ga(mb.FocusManager.instance(),n.AFrameworkApplication.Zg));ib.register(G,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().oa(()=>new G(ib.resolve("Common.App.ICustomerFeedbackUiWrapper"),ib.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),n.AFrameworkApplication.Zg));ib.register(1330,
"Common.ICustomerFeedbackActor").ma().oa(()=>new K(n.AFrameworkApplication.Ta,n.AFrameworkApplication.Aa,ib.Ja("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),n.AFrameworkApplication.fa,n.AFrameworkApplication.Zg));ib.register(Kb,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().oa(()=>new Kb(ib.resolve("Common.App.ICustomerFeedbackUiWrapper")));ib.register(Pa,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().oa(()=>
new Pa(ib.resolve("Common.ISystemInitiatedFeedback")));this.Da=ib}init(){oc._initialized||(oc.Uac()||(this.T$e=this.Da.resolve("Common.ICustomerFeedbackActor"),this.T$e.wb(),n.AFrameworkApplication.Aa.updateCommandUI()),this.Da.Ja("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),oc._initialized=!0)}dispose(){}static Uac(){return!!n.AFrameworkApplication.Aa&&
!!n.AFrameworkApplication.Aa.hb&&3===n.AFrameworkApplication.Aa.hb.Uk&&1===n.AFrameworkApplication.Aa.hb.gJa}static main(){let ib=!1;oc.Uac()&&(ib=!0);qc.a.instance.Dc(new oc,0,ib)}}oc._initialized=!1;Object(J.a)(oc,"CustomerFeedbackPackage",null,[2,3])},1153:function(J,aa,d){J=d(0);var h=d(14),e=d(36);class r{constructor(){this.classId=0}static a8a(x){try{return e.a(x)}catch(A){}return null}}Object(J.a)(r,"ARoamingAppsResponse",null,[]);class n{constructor(){this.state=this.callback=null;this.nke=
!1}}Object(J.a)(n,"GetRoamingAppsLauncherContext",null,[]);var v=d(27),B=d(82);d.d(aa,"a",function(){return y});class y{constructor(x){this.ezd=!1;this.E7=y.mab;this.kKd=this.EHd=0;this.platform=null;this.e0h=x;this.lrf=this.lKd=!1}get CTe(){return this.e0h}get aJl(){return this.CTe&&this.lKd?this.lrf:!1}tti(){v.AFrameworkApplication.A$b&&this.CTe&&!this.lKd&&!this.ezd&&(this.kKd=3,this.ezd=!0,this.q3k(),this.cUf())}q3k(){this.E7=y.mab;this.EHd=0}getRoamingAppsLauncher(x,A,E){this.aJl?(x=new n,x.callback=
A,x.state=E,x.nke=!0,this.hUf(x)):A(!1,"",E)}cUf(){const x=new (d(1129).CheckRoamingRightsRequest);x.RoamingApp=this.kKd;x.BaseDocQuerySignature=v.AFrameworkApplication.hh;x.execute(Object(h.a)(this,this.vti,"checkUserRoamingRightsSucceeded"),Object(h.a)(this,this.uti,"checkUserRoamingRightsFailed"),null)}vti(x){v.AFrameworkApplication.Ug||((x=r.a8a(x.data.Wd))?this.lXe(x.HasRights):this.lXe(!1))}uti(){if(!v.AFrameworkApplication.Ug)if(this.EHd>=y.umk)this.lXe(!1);else{var x=new B.a(2,1,this.E7,Object(h.a)(this,
this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);v.AFrameworkApplication.ye.Db(x);this.EHd++;this.E7*=y.qTe;this.E7>y.cjc&&(this.E7=y.cjc)}}lXe(x){this.lrf=x;this.lKd=!0;this.ezd=!1}retryCheckUserRoamingRights(){this.cUf()}hUf(x){const A=new (d(1130).GetRoamingLauncherRequest);A.RoamingApp=this.kKd;A.BaseDocQuerySignature=v.AFrameworkApplication.hh;A.execute(Object(h.a)(this,this.Aij,"getRoamingAppsLauncherSucceeded"),Object(h.a)(this,this.zij,"getRoamingAppsLauncherFailed"),x)}Aij(x){if(!v.AFrameworkApplication.Ug){var A=
r.a8a(x.data.Wd);x=x.data.state;A?(this.platform=A.Platform,x.callback(!0,A.Launcher,x.state)):x.callback(!1,"",x.state)}}zij(x){if(!v.AFrameworkApplication.Ug){var A=x.data.state;5===x.data.status&&A.nke?(A.nke=!1,this.hUf(A)):A.callback(!1,"",A.state)}}static get instance(){return y.Nt||(y.Nt=new y(v.AFrameworkApplication.Hgi))}}y.mab=1E3;y.qTe=5;y.cjc=12E5;y.umk=5;y.Nt=null;Object(J.a)(y,"RoamingAppsManager",null,[])},1154:function(J,aa,d){J=d(0);var h=d(14),e=d(963),r=d(67);class n extends e.a{constructor(u,
K,G,O,R,V=null){super(u,G,R.WR,V);this.wjf=0;this.gba=this.kej(O);this.Sqb=K;this.Sh=R;this.A2e=7;this.gs=this.Sqb.ownerDocument.createElement("div");this.gs.className="ModalCalloutControlOverlay";this.gs.tabIndex=0;this.Sqb.insertBefore(this.gs,this.Sqb.firstChild)}show(){this.AL||(this.Sh.Vhb(),this.Sh.gQa(!1),this.gs.style.zIndex=String(this.Sh.pra),super.show(),this.Wu(),this.wjf=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.A2e))}dismiss(){this.AL&&(this.Sh.RRa(!1),this.ppa(),
this.Sqb&&this.Sqb.contains(this.gs)&&this.Sqb.removeChild(this.gs),super.dismiss(),window.clearTimeout(this.wjf))}Wu(){this.Sh.mca(Object(h.a)(this,this.dismiss,"dismiss"));this.Sh.Ly.pb(r.a.click,this.gs,Object(h.a)(this,this.onClick,"onClick"))}ppa(){this.Sh.xKa(Object(h.a)(this,this.dismiss,"dismiss"));this.Sh.Ly.yb(r.a.click,this.gs,Object(h.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}kej(u){let K=0;switch(u){case 0:K=190;break;case 1:K=250;break;case 2:K=300;break;case 3:K=
360}return K}}Object(J.a)(n,"ModalCallout",e.a,[]);var v=d(387),B=d(351),y=d(141);class x extends n{constructor(u,K,G,O,R,V=null){super(u,K,G,O,R,V);this.PBc=null}show(){if(!this.AL){const u=Object.assign(new B.a,{onShow:()=>{n.prototype.show.call(this)}});y.UISurfaces.oL().then(K=>{const G=K.externalNotification();this.PBc=K.addNotification(G,u);return null},K=>{v.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null})}}dismiss(){this.AL&&this.PBc&&(y.UISurfaces.oL().then(u=>
{u.removeNotification(this.PBc);return this.PBc=null},u=>{v.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",u);return null}),super.dismiss())}}Object(J.a)(x,"ReactManagedModalCallout",n,[]);var A=d(27);d.d(aa,"a",function(){return E});class E{static IYd(u,K,G,O,R=null){return A.AFrameworkApplication.Aa.hb.XUa?new x(u,K,G,O,A.AFrameworkApplication.Aa,R):new n(u,K,G,O,A.AFrameworkApplication.Aa,R)}}Object(J.a)(E,"ModalCalloutControlFactory",null,[])},1155:function(J,aa,d){d.r(aa);
J=d(0);var h=d(518),e=d(519);class r{constructor(y){this.IP=this.S9e=h.a.unused;this.qEc=y}get ztb(){return this.S9e}eHe(y,x,A,E){A===this.qEc.element&&(this.S9e=y,this.IP=E+this.qEc.offset)}bJe(){}ETd(y){return this.ztb!==h.a.unused?Object.assign(new e.a,{element:y,offset:this.IP}):null}}Object(J.a)(r,"ChildSelectionHelper",null,[1453]);class n{constructor(y,x){this.YGd=!1;this.qEc=x;this._parent=y;this.IP=x.offset}get ztb(){return h.a.unused}eHe(y,x,A,E){x||this.qEc.offset!==y||(this.IP=E,this.YGd=
!0)}bJe(y,x){!this.YGd&&this.IP>x&&(this.IP-=x-y+1)}ETd(y){return Object.assign(new e.a,{element:this.YGd?y:this._parent,offset:this.IP})}}Object(J.a)(n,"ParentSelectionHelper",null,[1453]);var v=d(914);d.d(aa,"CombineHelper",function(){return B});class B{constructor(y,x,A){this.Hbf=h.a.unused;this.kRb="";this._element=y;this.oXb=x;this.PWb=this.L0f(y,A.start);this.MWb=this.L0f(y,A.end)}L0f(y,x){return x.element===y?new n(y,x):new r(x)}$8h(y){const x=y===this.oXb,A=this._element.childNodes[y],E=this.kRb.length;
this.PWb.eHe(y,x,A,E);this.MWb.eHe(y,x,A,E);this.kRb+=A.nodeValue}end(y,x){this.oXb!==x&&(this.Hbf=x,Array.add(y,this))}Dwi(){var y=this.dhj();this.fih(this.oXb,y-1);this.fih(y+1,this.Hbf);y=this._element.childNodes[this.oXb];this.kRb!==y.nodeValue&&(y.nodeValue=this.kRb);return this.Imi(y)}fih(y,x){if(!(x<y)){this.PWb.bJe(y,x);this.MWb.bJe(y,x);for(let A=y;A<=x;A++)this._element.removeChild(this._element.childNodes[y])}}Imi(y){return Object.assign(new v.a,{start:this.PWb.ETd(y),end:this.MWb.ETd(y)})}dhj(){return this.PWb.ztb!==
h.a.unused?this.PWb.ztb:this.MWb.ztb!==h.a.unused?this.MWb.ztb:this.oXb}}Object(J.a)(B,"CombineHelper",null,[])},1160:function(J,aa,d){J=d(0);var h=d(1203),e=d(387),r=d(27),n=d(82),v=d(68);class B{static Upj(){if(!B.lwc&&(B.lwc=new v.a,r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.Eu("AggregatorIdDisabledList"))){const A=r.AFrameworkApplication.fa.YA("AggregatorIdDisabledList");for(let E=0;E<A.length;E++)B.lwc.$(A[E],!0)}return B.lwc}}B.lwc=null;Object(J.a)(B,"DisabledAggregatorListStore",
null,[]);var y=d(287);d.d(aa,"a",function(){return x});class x{constructor(A,E,u,K,G,O=!0,R=null){this.Iaf=this.Tpf=this.Rgf=!1;this.$d=null;if(!A)throw y.a.argument("taskManagerLazy");if(!G)throw y.a.argument("dataAggregator");this.G2h=A;this.SHd=E;this._id=u;this.Uef=6E4*K;this.Wxc=G;this.inf=O;this.CWb=R;B.Upj().Gb(this._id.toString())&&(this.Iaf=!0)}get taskManager(){return this.$d||(this.$d=this.G2h.value)}track(A,E=null){this.Iaf||(this.STi(),this.E7k(),this.Wxc.cZb(A,E))}E7k(){!this.Rgf&&0<
this.Uef&&(this.Rgf=!0,this.Poh())}Poh(){const A=new n.a(5,1,this.Uef,()=>{this.l9k()},19,this._id.toString());this.taskManager.Db(A)}l9k(){!this.CWb||this.CWb.cYe()?this.zod():this.inf&&this.Wxc.reset();this.Poh()}zod(){const A=this.Wxc.getData();if(A){const E=parseInt(String(A.length));if(isNaN(E)||0<E)this.Wph(A),this.inf&&this.Wxc.reset()}}Wph(A){e.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:A})}STi(){this.Tpf||(this.SHd(()=>{this.zod()}),this.Tpf=!0)}static xr(A,
E,u,K,G){return new x(new h.a(()=>r.AFrameworkApplication.ye),r.AFrameworkApplication.vga,A,E,u,K,G)}static LW(A,E,u,K=!0){return x.xr(A,E,u,K,null)}}Object(J.a)(x,"Aggregator",null,[1282])},1231:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=
9]="teamsElectron"})(h||(h={}));Object(J.b)("BrowserCode",h)},1232:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.value=!1}}Object(J.a)(h,"OutBool",null,[])},1233:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(J.a)(h,"ColorCellProps",null,[])},1234:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(356);class h extends d.a{constructor(){super();this.Style=this.Character=
null}get Type(){return 1}}Object(J.a)(h,"CharacterCodeGalleryButtonProps",d.a,[])},1235:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(514);class e{constructor(r){this.yca=r}kVe(r){return h.a.then(this.yca.krb(r,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),n=>this.sij(n))}sij(r){return r&&r.Yi&&r.Yi.data?r.Yi.data.Wd:null}}Object(J.a)(e,"SimpleRequestManager",null,[1517])},1236:function(J,aa,d){d.d(aa,"a",function(){return h});
J=d(0);d=d(304);class h{}h.LabelText=d.a.labelText;h.Alt=d.a.alt;h.Image16by16Class=d.a.yyb;h.Image32by32Class=d.a.NEa;h.Image48by48Class=d.a.Pde;h.Visible=d.a.visible;h.HasPopup="HasPopup";Object(J.a)(h,"ButtonCommandProperties",null,[])},1239:function(J,aa,d){function h(a,b){if(!a||!b)return[];const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.HGe)||void 0===l?void 0:l.forEach(w=>{w&&c.add(w)})});return Array.from(c).map(f=>b.Be(ia.a.Gf(f))).filter(f=>null!==f&&void 0!==
f)}function e(a,b){return b&&b.TableNode?new zF(b):new AF(a)}function r(a,b){Vw.set(a,b)}d.r(aa);var n=d(0),v=d(71),B=d(55),y=d(95),x=d(180),A=d(173),E=d(121),u=d(27),K=d(1101),G=d(37),O=d(157),R=d(38);class V{constructor(a){this.value=a}}Object(n.a)(V,"RefTriState",null,[]);var D=d(34);class Q{GQe(){this.hUi();this.GBj();this.AZj();this.p6j();R.a.instance.ga(70)&&this.HMk();this.a9k();R.a.instance.ga(71)&&this.KNb();this.lul();this.fvl();this.hKi();this.kZj();this.f5k();this.Aql();this.jwl();R.a.instance.ga(79)&&
(B.a.wk||this.MDj(),this.T0j(),this.iqk(),this.HCl())}hUi(){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);a.bindAction(x.KeyInputManager.Oa(A.a.tq,0),D.a.enter);a.bindAction(x.KeyInputManager.Oa(A.a.tq,4),D.a.yqd)}GBj(){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Hyperlink),D.a.insertHyperlink)}MDj(){const a=y.FocusManager.instance().Fc(E.AFrame.hj);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Rga,5),D.a.rC);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.dba,
5),D.a.Ey)}kZj(){if(!B.a.px){const a=y.FocusManager.instance().Fc(E.AFrame.hj);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Svc,x.KeyInputManager.Oe),D.a.Xog,Q.njb("faOpen"))}}AZj(){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);R.a.instance.ga(54)&&E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_CenterJustify),D.a.centerJustify,Q.OJ);B.a.wk?(E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),D.a.leftJustify,Q.OJ),E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),
D.a.rightJustify,Q.OJ)):(E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_LeftJustify),D.a.leftJustify,Q.OJ),E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_RightJustify),D.a.rightJustify,Q.OJ));R.a.instance.ga(54)&&E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Rwd,x.KeyInputManager.Oe),D.a.fullJustify,Q.OJ)}T0j(){var a=y.FocusManager.instance();const b=a.Fc(E.AFrame.hj);a=a.Fc(O.AppFrame.FW);E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.xMa,x.KeyInputManager.Oe),D.a.QM,Q.pPf);E.AFrame.lk(b,
x.KeyInputManager.Oa(A.a.u6e,x.KeyInputManager.Oe),D.a.mP,Q.pPf);B.a.LAb&&a.bindAction(x.KeyInputManager.Oa(A.a.Rvc,4|x.KeyInputManager.Oe),D.a.QM)}p6j(){const a=y.FocusManager.instance().Fc(E.AFrame.hj);E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_TellMe),G.a.ktc,Q.OJ)}iqk(){if(R.a.instance.ga(27)||R.a.instance.ga(58)){const a=y.FocusManager.instance().Fc(E.AFrame.hj),b=R.a.instance.ga(58)?D.a.m7k:D.a.save;E.AFrame.lk(a,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Save),b);E.AFrame.lk(a,
x.KeyInputManager.Oa(A.a.J7e,0),D.a.sync)}}HMk(){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Pvc,1),D.a.led);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Pvc,0),D.a.led)}a9k(){this.Cph(O.AppFrame.FW);this.Cph(O.AppFrame.YPe)}Cph(a){var b=y.FocusManager.instance(),c=A.a.dba,f=A.a.Rga;a=b.Fc(a);const l=b.Fc(u.AFrameworkApplication.Lhb);a.bindAction(x.KeyInputManager.Oa(c,
0),D.a.leftArrow);a.bindAction(x.KeyInputManager.Oa(f,0),D.a.rightArrow);a.bindAction(x.KeyInputManager.Oa(A.a.fZ,0),D.a.upArrow);a.bindAction(x.KeyInputManager.Oa(A.a.O6,0),D.a.downArrow);a.bindAction(x.KeyInputManager.Oa(f,4),D.a.x0a);a.bindAction(x.KeyInputManager.Oa(c,4),D.a.w0a);B.a.wk?(a.bindAction(x.KeyInputManager.Oa(f,1),D.a.RCa),a.bindAction(x.KeyInputManager.Oa(c,1),D.a.QCa),a.bindAction(x.KeyInputManager.Oa(f,5),D.a.dRa),a.bindAction(x.KeyInputManager.Oa(c,5),D.a.cRa),a.bindAction(x.KeyInputManager.Oa(f,
8),D.a.JYa),a.bindAction(x.KeyInputManager.Oa(c,8),D.a.KYa),a.bindAction(x.KeyInputManager.Oa(f,12),D.a.YRa),a.bindAction(x.KeyInputManager.Oa(c,12),D.a.ZRa)):(a.bindAction(x.KeyInputManager.Oa(f,x.KeyInputManager.Oe),D.a.RCa),a.bindAction(x.KeyInputManager.Oa(c,x.KeyInputManager.Oe),D.a.QCa),a.bindAction(x.KeyInputManager.Oa(f,x.KeyInputManager.Oe|4),D.a.dRa),a.bindAction(x.KeyInputManager.Oa(c,x.KeyInputManager.Oe|4),D.a.cRa));a.bindAction(x.KeyInputManager.Oa(A.a.fZ,4),D.a.HMb);a.bindAction(x.KeyInputManager.Oa(A.a.O6,
4),D.a.ukb);a.bindAction(x.KeyInputManager.Oa(A.a.fZ,x.KeyInputManager.Oe),D.a.a2b);a.bindAction(x.KeyInputManager.Oa(A.a.O6,x.KeyInputManager.Oe),D.a.uub);a.bindAction(x.KeyInputManager.Oa(A.a.fZ,x.KeyInputManager.Oe|4),D.a.N7a);a.bindAction(x.KeyInputManager.Oa(A.a.O6,x.KeyInputManager.Oe|4),D.a.bRa);a.bindAction(x.KeyInputManager.Oa(A.a.bF,0),D.a.KYa);a.bindAction(x.KeyInputManager.Oa(A.a.bF,4),D.a.ZRa);if(R.a.instance.ga(41))a.bindAction(x.KeyInputManager.Oa(A.a.bF,x.KeyInputManager.Oe),D.a.Mdd),
a.bindAction(x.KeyInputManager.Oa(A.a.Tw,x.KeyInputManager.Oe),D.a.rFe);else if(R.a.instance.ga(17)||R.a.instance.ga(77))a.bindAction(x.KeyInputManager.Oa(A.a.bF,x.KeyInputManager.Oe),D.a.wgb),a.bindAction(x.KeyInputManager.Oa(A.a.Tw,x.KeyInputManager.Oe),D.a.vgb);a.bindAction(x.KeyInputManager.Oa(A.a.bF,x.KeyInputManager.Oe|4),D.a.H8a);a.bindAction(x.KeyInputManager.Oa(A.a.Tw,0),D.a.JYa);a.bindAction(x.KeyInputManager.Oa(A.a.Tw,4),D.a.YRa);a.bindAction(x.KeyInputManager.Oa(A.a.Tw,x.KeyInputManager.Oe|
4),D.a.G8a);B.a.wk&&(a.bindAction(x.KeyInputManager.Oa(A.a.fZ,2),D.a.KYa),a.bindAction(x.KeyInputManager.Oa(A.a.fZ,6),D.a.ZRa),a.bindAction(x.KeyInputManager.Oa(A.a.O6,2),D.a.JYa),a.bindAction(x.KeyInputManager.Oa(A.a.O6,6),D.a.YRa),a.bindAction(x.KeyInputManager.Oa(A.a.bF,1),D.a.wgb),a.bindAction(x.KeyInputManager.Oa(A.a.Tw,1),D.a.vgb),R.a.instance.ga(6)&&(a.bindAction(x.KeyInputManager.Oa(A.a.fZ,5),D.a.N7a),a.bindAction(x.KeyInputManager.Oa(A.a.O6,5),D.a.bRa)));c=x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_SelectAll);
a.bindAction(c,D.a.Osa);l.bindAction(c,G.a.wRa);R.a.instance.ga(79)&&(f=b.Fc(E.AFrame.ND),b=b.Fc(E.AFrame.hj),f.bindAction(c,G.a.iCa),b.bindAction(x.KeyInputManager.Oa(A.a.GMa,x.KeyInputManager.Oe|4),D.a.Wnd),R.a.instance.ga(41)&&B.a.wk&&(a.bindAction(x.KeyInputManager.Oa(A.a.VB,1),D.a.wgb),a.bindAction(x.KeyInputManager.Oa(A.a.UB,1),D.a.vgb)),b.bindAction(x.KeyInputManager.Oa(A.a.UB,0),D.a.pageDown),b.bindAction(x.KeyInputManager.Oa(A.a.VB,0),D.a.pageUp),b.bindAction(x.KeyInputManager.Oa(A.a.UB,
4),D.a.mrc),b.bindAction(x.KeyInputManager.Oa(A.a.VB,4),D.a.Aqd));R.a.instance.ga(6)&&(a.bindAction(x.KeyInputManager.Oa(A.a.UB,x.KeyInputManager.Oe|4),G.a.wRa),a.bindAction(x.KeyInputManager.Oa(A.a.VB,x.KeyInputManager.Oe|4),G.a.wRa));B.a.Vj||a.bindAction(x.KeyInputManager.Oa(A.a.wMa,0),D.a.Iaa);a.bindAction(x.KeyInputManager.Oa(A.a.Dpa,4),D.a.zqd);a.bindAction(x.KeyInputManager.Oa(A.a.Dpa,4|x.KeyInputManager.Oe),D.a.zqd)}KNb(){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Owd,
x.KeyInputManager.Oe|1),D.a.HRd);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Pwd,x.KeyInputManager.Oe|1),D.a.IRd);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.D7e,x.KeyInputManager.Oe|1),D.a.JRd);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.E7e,x.KeyInputManager.Oe|1),D.a.KRd);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.F7e,x.KeyInputManager.Oe|1),D.a.LRd);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.G7e,x.KeyInputManager.Oe|1),D.a.MRd);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Qza,x.KeyInputManager.Oe|4),D.a.GRd);R.a.instance.ga(61)&&
y.FocusManager.instance().Fc(E.AFrame.hj).bindAction(x.KeyInputManager.Oa(A.a.Twd,x.KeyInputManager.Oe|4),D.a.dgi)}lul(){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);a.bindAction(x.KeyInputManager.Oa(A.a.Sq,0),D.a.tab);a.bindAction(x.KeyInputManager.Oa(A.a.Sq,4),D.a.nrc)}fvl(){if(R.a.instance.ga(30)){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.tq,x.KeyInputManager.Oe),D.a.eua)}}jwl(){const a=y.FocusManager.instance(),b=a.Fc(O.AppFrame.FW);a.Fc(E.AFrame.ND);
E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Bold),D.a.bold,Q.OJ);E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Italic),D.a.setItalic,Q.OJ);E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Underline),D.a.underline,Q.OJ);B.a.wk&&(E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Bold_Mac),D.a.bold,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Italic_Mac),D.a.setItalic,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Underline_Mac),
D.a.underline,Q.OJ));E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_ClearFormatting),D.a.clearFormatting);R.a.instance.ga(54)&&E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.Gmb,x.KeyInputManager.Oe|4),D.a.clearFormatting);E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.Emb,x.KeyInputManager.Oe|1),D.a.B1,Q.njb("00FFFF"));if(R.a.instance.ga(94)||R.a.instance.ga(96))E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.xMa,x.KeyInputManager.Oe|4),D.a.bH,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.kvc,x.KeyInputManager.Oe),
D.a.bH,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.Qvd,x.KeyInputManager.Oe|4),D.a.PH,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.ivc,x.KeyInputManager.Oe),D.a.PH,Q.OJ);u.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&E.AFrame.lk(b,x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_ToggleCase),D.a.Gtd);u.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.Svd,x.KeyInputManager.Oe|4),D.a.superscript,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.Vvd,
x.KeyInputManager.Oe|4),D.a.superscript,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.Tvd,x.KeyInputManager.Oe|4),D.a.subscript,Q.OJ),E.AFrame.lk(b,x.KeyInputManager.Oa(A.a.jvc,x.KeyInputManager.Oe|4),D.a.subscript,Q.OJ))}HCl(){const a=y.FocusManager.instance().Fc(E.AFrame.ND),b=y.FocusManager.instance().Fc(O.AppFrame.FW);var c=x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,G.a.iCa);b.bindAction(c,D.a.undo);c=x.KeyInputManager.Oa(A.a.VH,1);a.bindAction(c,G.a.iCa);B.a.wk||b.bindAction(c,
D.a.undo);c=x.KeyInputManager.qw(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,G.a.iCa);b.bindAction(c,D.a.redo);c=x.KeyInputManager.Oa(A.a.VH,5);a.bindAction(c,G.a.iCa);B.a.wk||b.bindAction(c,D.a.redo)}Aql(){const a=y.FocusManager.instance().Fc(O.AppFrame.FW);R.a.instance.ga(54)?(B.a.wk?this.Pra(a,x.KeyInputManager.Oa(A.a.Pwd,5),"\u20ac"):this.Pra(a,x.KeyInputManager.Oa(A.a.Cmb,x.KeyInputManager.Oe|1),"\u20ac"),this.Pra(a,x.KeyInputManager.Oa(A.a.Oza,x.KeyInputManager.Oe|1),"\u00a9"),this.Pra(a,
x.KeyInputManager.Oa(A.a.hQb,x.KeyInputManager.Oe|1),"\u00ae"),this.Pra(a,x.KeyInputManager.Oa(A.a.iQb,x.KeyInputManager.Oe|1),"\u2122"),this.Pra(a,x.KeyInputManager.Oa(A.a.jvc,x.KeyInputManager.Oe|1),"\u2014"),this.Pra(a,x.KeyInputManager.Oa(A.a.xMa,x.KeyInputManager.Oe|1),"\u2026"),this.Pra(a,x.KeyInputManager.Oa(A.a.u6e,x.KeyInputManager.Oe|5),"\u00bf"),this.Pra(a,x.KeyInputManager.Oa(A.a.Owd,x.KeyInputManager.Oe|5),"\u00a1")):R.a.instance.ga(25)&&this.Pra(a,x.KeyInputManager.Oa(A.a.Cmb,x.KeyInputManager.Oe|
1),"\u20ac")}Pra(a,b,c){E.AFrame.lk(a,b,D.a.nUa,Q.iIj("symbol_"+c))}hKi(){if(u.AFrameworkApplication.UE){var a=y.FocusManager.instance().Fc(E.AFrame.hj);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.H7e,x.KeyInputManager.Oe|1),G.a.giveFeedback);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.I7e,x.KeyInputManager.Oe|1),G.a.giveFeedback)}}f5k(){const a=y.FocusManager.instance().Fc(E.AFrame.hj);B.a.px||E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Emb,1),D.a.activateRibbonTab,Q.njb("tabHome"));E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Qza,
1),D.a.activateRibbonTab,Q.njb("tabInsert"));E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Fmb,1),D.a.activateRibbonTab,Q.njb("tabPageLayout"));E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.hQb,1),D.a.activateRibbonTab,Q.njb("tabReview"));E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.L7e,1),D.a.activateRibbonTab,Q.njb("tabView"))}static get instance(){return Q.Ka||(Q.Ka=new Q)}static pPf(){return new K.DictionaryPropertySet}static OJ(){return new V(2)}static iIj(a){return()=>{const b={};b.SourceControlId=a;return b}}static njb(a){return()=>
a}}Q.Ka=null;Object(n.a)(Q,"ShortcutRegistration",null,[]);class Z{get name(){return"Box4.Shortcuts"}Zb(){}init(){Q.instance.GQe()}dispose(){}static main(){v.a.instance.Dc(new Z)}}Object(n.a)(Z,"Box4ShortcutsPackage",null,[2,3]);var P=d(307);class ca{Qt(a,b,c=!1,f=!1,l=!1,w=null){return P.a.Qt(a,b,c,f,l,w)}Yuc(a,b,c){return P.a.Yuc(a,b,c)}Bsb(a,b){return P.a.Bsb(a,b)}oW(a,b,c,f,l=!1,w=!1){return P.a.oW(a,b,c,f,l,w)}kQa(a,b=null){return P.a.kQa(a,b)}Ida(){P.a.Ida()}I7a(a,b,c,f=null){return P.a.I7a(a,
b,c,f)}vEa(a,b,c=!1,f=!0){return P.a.vEa(a,b,c,f)}fac(a,b){return P.a.fac(a,b)}}Object(n.a)(ca,"TextMetricsAdapterProxy",null,[1320]);var T=d(314),da=d(151);class fa{rnj(a){var b=a;for(a=null;!a&&b&&"P"!==b.tagName;)a=T.a.Be(b,da.a.mOb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(n.a)(fa,"TextMetricsHelper",null,[322]);class ma{constructor(){this.Da=null}get name(){return"Box4.TextMetrics"}init(){this.Da.resolve("Box4.ITextMetricsAdapter")}dispose(){}Zb(a){this.Da=a;this.Da.register(1320,
"Box4.ITextMetricsAdapter").ma().oa(()=>new ca);this.Da.register(322,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new fa)}static main(){v.a.instance.Dc(new ma)}}Object(n.a)(ma,"Box4TextMetricsPackage",null,[2,3]);var ea=d(339),ra=d(252),F=d(14),na=d(99),ka=d(387),Ua=d(722),za=d(97),ha=d(47),ua=d(1223),Ga=d(1219),sa=d(67),Ba=d(566),pa=d(105),ia=d(352),Da=d(800),Xa=d(270),Ka=d(18),Ma=d(6);class Oa{static bcl(a){const b=new Ua.a;for(let c of a)b.add(c);return b}static oih(a,b){const c=new Ka.a;
b=Oa.bcl(b);for(let f of a)b.contains(f)||c.add(f);return c}static gYk(a,b){return Oa.oih(Ma.asEnumerable(a),b).toArray()}static hYk(a,b){return Oa.oih(a,b)}}Object(n.a)(Oa,"ExtendedGuidUtils",null,[]);var qa=d(1204),Ya=d(24),Fb=d(165);class hc{}hc.cri="ChangeInfo";Object(n.a)(hc,"CatchUpActivityConstants",null,[]);class ec{}ec.SHb="\u00a0";ec.EAf="\ue200";ec.peg="\ue201";ec.XQi=32767;ec.WNc=3;ec.A0d=1;Object(n.a)(ec,"ContentEditableViewConstants",null,[]);var Tb=d(548),vb=d(123),zb=d(33),Xb=d(367),
Za=d(40),Va=d(42),tc=d(90),Kb=d(92),Pa=d(54),mb=d(88);class qc{constructor(a,b,c){this.Qa=b;this.Lb=c}}Object(n.a)(qc,"ChangeInfo",null,[]);d(612);var oc=d(819);class ib{}Object(n.a)(ib,"InternalLinkConstants",null,[]);class $a extends Sys.EventArgs{constructor(){super();this.q8a=null}}Object(n.a)($a,"EditEventArgs",Sys.EventArgs,[]);class Db extends $a{constructor(){super();this.c0j=0;this.syl=this.LOc=this.h2e=this.E0j=this.sDj=this.Rgg=this.OYf=this.XXi=this.kUi=!1}}Object(n.a)(Db,"ParagraphContentUpdatedEventArgs",
$a,[]);class Mb{constructor(a){this.O1c=a}}Object(n.a)(Mb,"BlobPresenterArgs",null,[]);var ob=d(32);class jc{}jc.Z3="TrackedChange";jc.HBh="TrackChangeTableRowInsertion";jc.EBh="TrackChangeTableRowDeletion";jc.sCh="TrackChangeTextInsertion";jc.qCh="TrackChangeTextDeletion";jc.TCj="TrackChangeImageModified";jc.RCj="TrackChangeImageInsertion";jc.NCj="TrackChangeImageDeletion";jc.uoe="TrackChangeIndirectEffect";Object(n.a)(jc,"TrackChangeConstants",null,[]);var Gb=d(913),Gc=d(98);const bc=a=>!!a.hRa&&
Ma.AT(a.hRa,b=>3===b.type||2===b.type||4===b.type),dc=(a,b)=>{let c=!1,f=!1,l=null;if(b.hRa)for(let w of b.hRa)1===w.type&&(c=!0),3===w.type&&(f=!0),4===w.type&&w.He&&w.He.paragraph&&(l=w);l&&Sys.UI.DomElement.addCssClass(a,Gc.a.BJi);f&&Sys.UI.DomElement.addCssClass(a,Gc.a.hdg);c&&Sys.UI.DomElement.addCssClass(a,Gc.a.vJi)},Nb=a=>{const b=[Gc.a.gQi,Gc.a.hQi,Gc.a.fQi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var Ac=d(361);class jb{constructor(a){this.nSb=this.pXb=this.N$e=null;this.Ki=
a}get paragraphNode(){return this.Ki}get hRa(){return this.N$e}get Xkb(){return this.pXb}get w8a(){return this.nSb}get isEmpty(){return(!this.hRa||!this.hRa.count)&&(!this.Xkb||!this.Xkb.count)&&(!this.w8a||!this.w8a.count)}Qwk(){this.Xkb&&(this.pXb=new Ka.a);this.w8a&&(this.nSb=new Ka.a)}Evd(a){this.hRa||(this.N$e=new Ac.a);this.Xkb||(this.pXb=new Ka.a);this.w8a||(this.nSb=new Ka.a);this.hRa.Evd(a,b=>{this.Xkb.add(b)},b=>{this.w8a.add(b)})}}Object(n.a)(jb,"IntentRenderingState",null,[]);class Vb{constructor(a,
b){this.element=a;this.next=b}}Object(n.a)(Vb,"ElementStackNode",null,[]);class Tc{constructor(a=!1){this._history=new Sys.StringBuilder;this.uAa=this.ov=null;this.OXb=a}K3j(a){if(this.OXb&&a){this._history.append("[Cp "+a.cp+":");if(a.Xh)for(var b=0;b<a.Xh.length;b++)this._history.append(a.Xh.ga(b).zy+","+a.Xh.ga(b).pfa),b!==a.Xh.length-1&&this._history.append("|");if(a.nk)for(a.Xh&&this._history.append("|"),b=0;b<a.nk.length;b++)this._history.append(a.nk.ga(b).kua?"B":"I"),this._history.append(a.nk.ga(b).xk?
"S":"E"),this._history.append(a.nk.ga(b).fAb?"R":"F"),b!==a.nk.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.ov){for(var a=this.ov;a.next;)a=a.next;a.next=this.uAa;this.uAa=this.ov;this.ov=null;this.OXb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&ka.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.OXb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.ov.element}pop(a=
""){this.isEmpty()&&ka.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=this.ov.element;this.ov.element=null;const c=this.ov.next;this.ov.next=this.uAa;this.uAa=this.ov;this.ov=c;this.OXb&&this._history.append(String.format("Pop {0} Label:{1}\n",b?b.className:"Null Element",a));return b}push(a,b=""){if(this.uAa){const c=this.uAa.next;this.uAa.next=this.ov;this.ov=this.uAa;this.uAa=c;this.ov.element=a}else this.ov=new Vb(a,
this.ov);this.OXb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.ov}}Object(n.a)(Tc,"ElementStack",null,[]);class wb{constructor(){this.W$b=!1;this.span=null}}Object(n.a)(wb,"IntelligentPlaceholderRenderingState",null,[]);class Rb{constructor(a,b,c){this.eventName=a;this.Ec=b;this.handler=c}}Object(n.a)(Rb,"ParagraphContentRendererMouseEventRegistration",null,[]);var vc=d(78);class rd extends Sys.EventArgs{constructor(a,b,c){super();
this.element=a;this.paragraphNode=b;this.lKb=c}}Object(n.a)(rd,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class rc extends rd{constructor(a,b,c,f,l){super(a,b,c);this.pXb=f.Xkb;this.nSb=f.w8a;this.KRh=l}get Xkb(){return this.pXb}get w8a(){return this.nSb}get elementType(){return this.KRh}}Object(n.a)(rc,"IntentRangeRenderedEventArgs",rd,[]);class cb extends rd{constructor(a,b,c,f){super(a,b,c);this.Vp=f}}Object(n.a)(cb,"SpellingErrorRenderedEventArgs",rd,[]);class Wb{constructor(){this.Pa=
new vc.a}dispose(){this.Pa&&(this.Pa.dispose(),this.Pa=null)}iRk(a,b,c,f){this.Pa&&this.Pa.raiseEvent(Wb.Nzk,new cb(a,b,c,f))}Yeh(a,b,c,f,l){this.Pa&&this.Pa.raiseEvent(Wb.Pvk,new rc(a,b,c,f,l))}}Wb.Nzk="OnSpellingErrorRangeRendered";Wb.Pvk="OnIntentRangeRendered";Object(n.a)(Wb,"ParagraphRenderEvents",null,[106]);class Uc{constructor(){this.xFf=null;this.xcg=!1;this.v_g=this.gsf=null}}Object(n.a)(Uc,"RenderParagraphContentResults",null,[]);var Ib=d(158),Vc=d(68);class gc{constructor(a,b,c,f,l,w,
H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){this.BAa=this.iFd=this.kEd=this.Qpb=null;this.Kf=a;this.GP=b;this.fd=c;this.iqa=f;this.jN=l;this.ew=H;this.N4a=U;this.fOa=ja;this.wQh=Sa;this.JV=eb;this.k_h=ub;this.aTh=Ub;this.bPh=Fc;this.Tqf=new Ua.a;this.QEc=cc;this.Wob=!!wa&&wa.lFa(65);this.aFc=this.fzc=null;this.PNa=w;this.pVh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");this.hd=wa}get UCf(){return!0}get pkg(){null==this.kEd&&(this.kEd=!!this.hd&&this.hd.isFeatureEnabled(85));
return this.kEd}get Mog(){null==this.iFd&&(this.iFd=!!this.hd&&this.hd.isFeatureEnabled(77));return this.iFd}get $N(){null==this.BAa&&(this.BAa=!!this.hd&&this.hd.isFeatureEnabled(79));return this.BAa}h1k(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud){this.fzc={};this.aFc=new Ib.a;const je=zb.ParagraphReader.text(a),Vd=new Ka.a;var Ve=!1;u.AFrameworkApplication.fa&&(Ve=u.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));const af=new Tc(Ve);af.push(c,"RenderParagraphContentStart");
let Zf=null,lg=null,Tg=null,Ug=null,ag=Ve=null;const ih=new Db;var Vg=!1;let di=!1,Si=!1,rj=!1,sg=0,Cg=null,sh=null;const vk=new Ka.a;this.QEc&&this.QEc.JOl(a,c);const Ni=this.fOa.QW(a);this.fOa.Hfi(c,a,b,Ni,b.Md);if(this.N4a.qx&&b.Wl){var wk=this.Kf.Qd;wk&&1===wk.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}wk=!a.YW;let Jl=!1,hk=!1,Kl=!1,Vj=!1,Wj=0,nk=!1,gl=!1,yj=null,wh=0;const hl=new wb,Yl=Array(a.Ra.length+1);let wm=this.pkg?new Ka.a:null,Fk=null,Gk=null;for(;sg<a.Ra.length;){const ge=
a.Ra.ga(sg);var Di=void 0,Mg=void 0,Ei=!1;af.K3j(ge);({TKc:Di,PKc:Mg}=gc.P0f(ge));this.pkg&&(!this.pVh||Di.length||Mg.length)&&({TKc:Di,PKc:Mg,SJi:wm,pQj:Ei}=gc.BEl(ge.paragraph.Gh,Di,Mg,wm),hl.W$b=0<wm.count);Vj=0<Di.length||Vj;Yl[sg]=c.childNodes.length;if(0<ge.cp&&ge.Nj)break;let Lg=ge.cp;const ei=sg<a.Ra.length-1?a.Ra.ga(sg+1).cp:zb.ParagraphReader.textLength(a);sg++;var mg=!1;0<Lg&&af.pop("CurrentCpLargerThanZero");ge.IL&&(Zf=null);ge.tv&&(Gk=ge.tv);ge.isDictationCorrectionEnd&&(Gk=null);ge.JY&&
(lg=null);ge.g4&&(Tg=null);ge.dla&&(Ug=null);var Md=void 0,Pe=void 0;this.$N?(Md=ge.Wda,Pe=ge.E_):(Md=!!ge.Mo,Pe=!!ge.fieldRangeEnd);if(!Vg||ge.blob||ge.formatting||ge.hyperlink||ge.kn||ge.i4||Pe||Md||this.Wob&&(ge.isTrackChangeInfoEnd||ge.gO)||ge.tw&&!ge.tw.isEmpty)mg=!0,0<Lg&&Vg&&af.pop("InFormattingSpan");Pe&&(af.pop("HasFieldEnd"),Vg=!1);ge.kn&&(Jl||(Si=!0),hk=Jl=!1);ge.hyperlink&&(Jl&&(Si=!0),Jl=!0,hk=ge.hyperlink.iua);ge.kn&&!Si&&(af.pop("IsHyperlinkEnd"),Vg=!1);this.hd&&this.hd.isFeatureEnabled(17)&&
(ge.isChangeEnd&&(nk||ka.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),nk=!1,sh=null),ge.changeStart&&(nk&&ka.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),sh=ge,nk=!ge.Nj));if(this.Wob&&(ge.isTrackChangeInfoEnd&&(Kl||(rj=!0),Kl=!1,Cg=null),ge.gO&&(Kl&&(rj=!0),Cg=ge,Kl=!ge.Nj),ge.isTrackChangeInfoEnd&&!rj)){for(Vg=0;Vg<Wj;Vg++)af.pop("IsTrackChangeInfoEnd");Wj=0;Vg=!1}Fk&&Fk.Qwk();ge.tw&&(Fk||(Fk=new jb(a)),Fk.Evd(ge.tw));
if(ge.i4&&!ge.Nj){Ve=Ve||ge.formatting;Pe=this.VKf(af.peek("CreateIpFormattingSpan"),Ve,Ni,b,a,Sa,ja,Cg);Pe=za.a.X9a(Pe);for(let ti of Pe)eb=gc.Bia(l,eb,ti);ih.Rgg=!0}ge.hyperlink&&!Si&&({WFa:eb,CRi:gl,returnValue:ag}=this.a1k(ag,ge,af,Ni,ih,b,a,f,l,w,H,ja,Cg,eb,Sa,wk,Vg,gl));!this.Wob||rj||ge.Nj||(ge.Bp&&(this.iSe(ge.Bp,af,ih,b,ja),Wj++),ge.Ho&&(this.iSe(ge.Ho,af,ih,b,ja),Wj++),ge.Rs&&(this.iSe(ge.Rs,af,ih,b,ja),Wj++));Md&&({fRa:Ve,WFa:eb,returnValue:ag}=this.X0k(ag,l,a,ge,Ve,af,Ni,ih,b,ja,Sa,eb,
Vg,wk,Cg));this.Mog&&this.NEf(a,b,Ic&&Fc);ge.blob?({WFa:eb,D0j:yj,C0j:wh,returnValue:di}=this.P0k(eb,Vg,Ve,ge,w,H,wk,ag,af,Ni,ih,Lg,di,Fc,b,vk,Ic,a,Sa,l,ub,Ub,U,ja,Vd,Cg,sh,Di,Mg,yj,wh,Fk),Vg=!1,Ve=ag=null):(Md=ge.i4&&!ha.a.substring(je,Lg,ei).length,mg&&(mg=ag,{fRa:Ve,returnValue:ag}=this.Z0k(Ve,ge,Ni,af,ih,b,a,ja,Cg,Sa,Md),Vg=!0,ag&&ag.style&&(gl&&mg&&mg.style&&(mg.style.fontSize=ag.style.fontSize,mg.style.lineHeight=ag.style.lineHeight),yj&&yj.style&&0<wh&&ge.formatting&&ge.formatting.cache.Ota&&
wh>ge.formatting.cache.fontSize&&(yj.style.fontSize=ag.style.fontSize,yj.style.lineHeight=ag.style.lineHeight))),gl=!1,yj=null,wh=0,Md||(ge.Vp&&(Zf=ge.Vp),ge.BF&&(Tg=ge.BF),ge.JL&&(Ug=ge.JL),ge.Kw&&(lg=ge.Kw),mg=ha.a.substring(je,Lg,ei),Ei=this.lZd(af.peek("CreateTextOverlaySpan1"),Ve,a,Zf,Tg,Ug,lg,b,vk,ja,mg,Ic&&(ub<=Lg&&Lg<Ub||a.YW),Ud,hl,Ei,Fk,!!Gk,hk),af.push(Ei,"TextOverlaySpan1"),ih.h2e=!0,this.ROd(af.peek("AddCommentHintCssAndDataToElement"),Di,Mg),this.jN&&this.jN.gzb&&Zf&&Zf.Hh&&(Di=Object(qa.a)(440,
Zf.Hh))&&Di.zN&&Di.zN.TraceId&&5===Di.proofingType&&!Di.MEa&&(this.XXk(af.peek("RemoveConsistencyCheckCustomData")),Mg=this.o7i(ge.Vp,a,sg),T.a.Sv(af.peek("errorDetails"),Mg,Di.zN.TraceId)),this.HVe(sh,af.peek("SetChangeId"),ge.cp,ei),Ic&&ub!==Ub&&({WFa:eb,returnValue:Lg}=this.fMk(Ei,af,Ve,a,Zf,Tg,Ug,lg,ih,b,l,vk,ja,je,ub,Ub,eb,Lg,ei,Ud,hl,Fk,!!Gk,hk)),za.a.Nx(af.peek("SetElementText"),ha.a.substring(je,Lg,ei)),eb=gc.Bia(l,eb,af.peek("AddLeafNodeElement"))))}if(a.nWc!==Vj||this.Wob||this.N4a.Bvc)a.nWc=
Vj,(f=Pa.OutlineElementNavigator.WA(a))&&f.Jda(b.Ma,32,!0);({O1c:ag,WFa:eb,returnValue:Vg}=this.c1k(a,c,Ve,Ni,ih,ag,b,a,l,ja,Cg,Sa,eb,Vg,wk));!hl.W$b&&hl.span&&this.vRd(null,hl.span);wk&&this.W0k(c,ag,ih,b,a,l,ja,wa,eb,cc,sh);Yl[Yl.length-1]=c.children.length;this.xFl(di,Cc,b);this.tGl(ih,Vg,l);this.Lrh(b,a,c);let zf;return zf=new Uc,zf.xFf=Vd,zf.xcg=di,zf.gsf=Yl,zf.v_g=vk,zf}lKb(a,b,c,f){this.GP.pb(a,b,c,f);return new Rb(a,b,c)}o7i(a,b,c){let f=0;a&&a.Hh&&(f|=16);if(c<b.Ra.length&&b.Ra.ga(c).IL||
c===b.Ra.length)f|=1;switch(f){case 0:return Gb.a.cGe;case 16:return Gb.a.d2c;case 1:return Gb.a.jnd;case 17:return Gb.a.FIc}return""}XXk(a){T.a.noa(a,Gb.a.cGe);T.a.noa(a,Gb.a.d2c);T.a.noa(a,Gb.a.jnd);T.a.noa(a,Gb.a.FIc)}HVe(a,b,c,f){this.hd&&this.hd.isFeatureEnabled(17)&&a&&a.changeStart&&T.a.Sv(b,hc.cri,new qc(a.changeStart.id,c,f))}a1k(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){!Fc||Ic||b.i4||(a=this.A1b(c.peek("CreateFormattingSpan1"),null,f,w,H,eb,cc,ub),a.className+=" EmptyTextRun",Ub=gc.Bia(ja,
Ub,a),Cc=l.LOc=!0);b=this.yFi(c.peek("CreateLinkAnchor"),b.hyperlink,w,U,wa,Sa,eb);c.push(b,"RenderHyperlink");l.E0j=!0;return{returnValue:a,WFa:Ub,CRi:Cc}}iSe(a,b,c,f,l){a=this.TIi(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.syl=!0}X0k(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){ub||f.i4||(l=f.formatting||l,Ub?(a=this.A1b(w.peek("CreateFormattingSpan2"),l,H,ja,c,wa,Sa,cc),a.appendChild(ja.ownerDocument.createTextNode("")),a.className+=" EmptyTextRun",eb=gc.Bia(b,eb,a),U.LOc=
!0):(a=this.xMc(l,H,ja,c,Sa,cc),U.OYf=!0));b=this.zEi(w.peek("CreateFieldRangeSpan1"),ja,wa,c);w.push(b,"RenderFieldRange");U.XXi=!0;return{returnValue:a,fRa:l,WFa:eb}}P0k(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di,Si){b||(c=f.formatting||c,H&&!f.i4?(U=this.A1b(ja.peek("CreateFormattingSpan4"),c,wa,cc,Cc,Zf,Ud,Tg),U.appendChild(cc.ownerDocument.createTextNode("")),U.className+=" EmptyTextRun",a=gc.Bia(je,a,U),Sa.LOc=!0):U=this.xMc(c,wa,cc,Cc,Ud,Tg));1===f.blob.Wq&&
(ub=!0);b=f.blob.chj(cc);b.FZf(new Mb(U));U=b.element;Sys.UI.DomElement.containsCssClass(U,Gc.a.obc)&&(Vg=U,c&&c.cache.Ota&&(di=c.cache.fontSize));Sys.UI.DomElement.addCssClass(U,Gc.a.rN);this.N4a.nQi&&5!==f.blob.Wq&&Sys.UI.DomElement.addCssClass(U,Gc.a.jQi);this.Wob&&this.b1k(f,cc,U,Tg);this.ROd(U,ag,ih);Si&&!Si.isEmpty?(dc(U,Si),this.Qpb&&this.Qpb.Yeh(U,Cc,(rj,sg,Cg,sh)=>{Fc.add(this.lKb(rj,sg,Cg,sh))},Si,1)):Nb(U);this.HVe(Ug,U,f.cp,f.cp+1);ja.peek("blobElt").appendChild(U);af(U,!0);lg.add(f.blob);
Ic&&(Vd<=eb&&eb+1<=Ve||Cc.YW)?(Ub&&(Sys.UI.DomElement.containsCssClass(U,Gc.a.DZd)||Sys.UI.DomElement.addCssClass(U,Gc.a.DZd),u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.Kf&&this.Kf.Qd&&Object(Ya.a)(Tb.PageView,this.Kf.Qd)&&(c=this.Kf.Qd,eb=u.AFrameworkApplication.Ta,c&&3===c.Gpg?eb.La(D.a.yDh,2,U):eb.La(D.a.zDh,2,U))),Sys.UI.DomElement.addCssClass(U,
Gc.a.l8)):(Sys.UI.DomElement.removeCssClass(U,Gc.a.DZd),Sys.UI.DomElement.removeCssClass(U,Gc.a.l8));this.Mog||this.NEf(Cc,cc,Ic&&Ub);Sys.UI.DomElement.removeCssClass(U,Gc.a.xJi);this.hd&&this.hd.isFeatureEnabled(162)&&5===f.blob.Wq&&(f=f.blob,f.properties&&f.properties.Sa(Za.a.E8b)&&(f=f.properties.eb(Za.a.E8b))&&""!==f&&(Fc.add(this.lKb(sa.a.ona,U,l,f)),Fc.add(this.lKb(sa.a.ona,U,w,f))));a=gc.Bia(je,a,U);ja.push(U,"RenderBlob");return{returnValue:ub,WFa:a,D0j:Vg,C0j:di}}ROd(a,b,c){b.length?(Sys.UI.DomElement.addCssClass(a,
Gc.a.SKc),T.a.Sv(a,Gc.a.HWd,b)):Sys.UI.DomElement.removeCssClass(a,Gc.a.SKc);c.length&&T.a.Sv(a,Gc.a.DWd,c)}NEf(a,b,c){a=ob.GraphIterator.nb(a);a.Ze();a.Jg(11);if(b=a.currentNode.sc(b.Ma))b.htmlElement.style.zIndex=c?"1":""}b1k(a,b,c,f){let l=za.a.e6i(c,gc.ADh);5===a.blob.Wq&&f?(l||(l=b.jp(Ga.a.span),l.id=gc.ADh,Sys.UI.DomElement.addCssClass(l,jc.TCj),Sys.UI.DomElement.addCssClass(l,jc.Z3),c.appendChild(l)),this.TZf(b,l,f.Bp,jc.NCj),this.TZf(b,l,f.Ho,jc.RCj)):l&&c.removeChild(l)}TZf(a,b,c,f){c&&!za.a.y5b(b,
f)&&(a=a.jp(Ga.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}Z0k(a,b,c,f,l,w,H,U,ja,wa,Sa){a=b.formatting||a;b=Sa?this.xMc(a,c,w,H,wa,ja):this.A1b(f.peek("CreateFormattingSpan5"),a,c,w,H,U,wa,ja);f.push(b,"RenderFormattingSpan");l.OYf=!0;return{returnValue:b,fRa:a}}fMk(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf){Cc<cc&&cc<Ud&&(Cc=ha.a.substring(Ub,Cc,cc),za.a.Nx(a,Cc),Ic=gc.Bia(Sa,Ic,a),b.pop("ProcessSelectionBegins"),a=this.lZd(b.peek("CreateTextOverlaySpan2"),
c,f,l,w,H,U,wa,eb,ub,Cc,!0,je,Vd,!1,Ve,af,Zf),b.push(a,"TextOverlaySpan2"),Cc=cc,ja.h2e=!0);Cc<Fc&&Fc<Ud&&(Ub=ha.a.substring(Ub,Cc,Fc),za.a.Nx(a,Ub),Ic=gc.Bia(Sa,Ic,a),b.pop("ProcessSelectionEnds"),a=this.lZd(b.peek("CreateTextOverlaySpan3"),c,f,l,w,H,U,wa,eb,ub,Ub,!1,je,Vd,!1,Ve,af,Zf),b.push(a,"TextOverlaySpan3"),Cc=Fc,ja.h2e=!0);return{returnValue:Cc,WFa:Ic}}c1k(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){if(0<a.Ra.length){const Fc=a.Ra.last;let Ic;Ic=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");
a=ob.GraphIterator.nb(a);!Fc.kn||Ic&&a.rc(16)||(Ub=!1,c=null);if(this.$N?Fc.E_:Fc.fieldRangeEnd)Ub=!1,c=null;if(Fc.i4){c||(c=Fc.formatting);w=this.VKf(b,c,f,H,U,eb,wa,Sa);b=za.a.X9a(w);for(let Cc of b)ub=gc.Bia(ja,ub,Cc);l.Rgg=!0}else!Ub&&cc&&(c||(c=Fc.formatting),w=this.A1b(b,c,f,H,U,wa,eb,Sa),w.appendChild(H.ownerDocument.createTextNode("")),w.className+=" EmptyTextRun",ub=gc.Bia(ja,ub,w),l.LOc=!0)}else ka.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:Ub,
O1c:w,WFa:ub}}W0k(a,b,c,f,l,w,H,U,ja,wa,Sa){var eb=gc.x5i(a,wa);b=this.EKf(b,f,U,eb);Ba.a.instance.shipAssertTag(25519712,8,0<l.Ra.length,"Chps should never be empty");U=null;l.Ra&&0<l.Ra.length&&(U=l.Ra.last);this.Wob&&U&&(U.Bp||U.Ho||U.Rs)&&(b.className+=" "+jc.Z3);let ub;({TKc:eb,PKc:ub}=gc.P0f(U));this.ROd(b,eb,ub);this.HVe(Sa,b,U?U.cp:0,-1);wa&&(b.className+=" "+Xb.a.t_d);this.Lrh(f,l,b);a.appendChild(b);H(b);gc.Bia(w,ja,b);c.kUi=!0}Lrh(a,b,c){if(a.Wl&&this.iqa.Thd&&this.iqa.qkl(c)){if((a=this.iqa.Cta(b))&&
0<pa.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){ka.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=this.iqa.vnj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}TIi(a,b,c,f){c=c.jp(Ga.a.span);switch(b.changeType){case 2:c.className=jc.qCh+" "+jc.Z3;c.style.color="#000";break;case 1:c.className=jc.sCh+" "+jc.Z3;c.style.color="#000";break;case 3:c.className=jc.Z3}a.appendChild(c);
f(c);return c}xFl(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}tGl(a,b,c){a.c0j=c.count;a.sDj=b;this.k_h(a)}yFi(a,b,c,f,l,w,H){c=c.jp(Ga.a.a);c.className=Gc.a.Cdg;b.iua&&b.urc&&!R.a.instance.ga(61)&&(b.url.endsWith(u.AFrameworkApplication.fa.Ga("UserPrincipalName"))?c.className+=" "+Gc.a.DJi:c.className+=" "+Gc.a.EJi);this.ew.Qvh()&&(c.style["pointer-events"]="all");this.ew.kvh(this.N4a.OIl,!0)&&this.HYk(c);this.GP.pb(sa.a.ona,c,l,b.url);this.GP.pb(sa.a.pna,c,w);f.add(c);b.url&&ha.a.n9(b.url)&&!B.a.Pi&&
(Fb.d(c,ua.a.href,b.url),Fb.d(c,ua.a.target,"_blank"),Fb.d(c,ua.a.rel,"noreferrer"));a.appendChild(c);H(c);return c}HYk(a){a.style.textDecoration="none";a.style.color="inherit"}A1b(a,b,c,f,l,w,H,U){b=this.xMc(b,c,f,l,H,U);a.appendChild(b);w(b);return b}xMc(a,b,c,f,l,w){if(this.UCf){var H=a?a.nm.toString():ia.a.nil.toString();if(H in this.fzc)a=this.fzc[H];else{let U=a?a.cache:oc.FormattingCacheManager.s5b(f,ia.a.nil);a=this.gYd(a,U,b,c,f,l);this.fzc[H]=a}b=a.cloneNode();T.a.ALc(a,b)}else H=a?a.cache:
oc.FormattingCacheManager.s5b(f,ia.a.nil),b=this.gYd(a,H,b,c,f,l);this.yyf(b,w);return b}gYd(a,b,c,f,l,w){const H=f.jp(Ga.a.span);b=this.ew.v1f(f,b,l)||b;this.rfi(f,H,b,l);this.wfi(H,b,l,f,w);this.Ffi(H,a);this.fOa.Ifi(H,l,c,f.Md,b.fontSize,b.JN);return H}rfi(a,b,c,f){a=this.ew.u1f(a,f,c);for(let l of a.keys)b.setAttribute(l,a.ga(l))}VKf(a,b,c,f,l,w,H,U){var ja=b?b.cache:oc.FormattingCacheManager.s5b(l,ia.a.nil);ja=this.bPh(ja,l);b=this.gYd(b,ja,c,f,l,w);this.yyf(b,U);ja.isSuperscript||ja.QF?(f=f.jp(Ga.a.span),
this.uyf(f,ja,!0),b.appendChild(f),za.a.Nx(f,""),H(f)):za.a.Nx(b,"");a.appendChild(b);H(b);return b}wfi(a,b,c,f,l){var w=b.it;const H=[];Array.add(H,Gc.a.TLa);var U=this.ew.R7d(c,b,this.N4a.PIl,w);var ja=null;b.U$a&&(ja=b.NR,ja=ja===tc.a.auto?"transparent":tc.a.xI(ja));b.RTa&&(ja=b.highlight,ja=ja===tc.a.auto?"transparent":tc.a.xI(ja));c.W0g!==tc.a.nil&&(U=tc.a.xI(c.W0g));l!==tc.a.nil&&(ja=tc.a.xI(l));za.a.qCa(a);b.bcg&&(a.style.opacity=b.oYf.toString());b.Eab&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);
U?(a.style.color=U,Fb.d(a,ua.a.$Mf,"WindowText"===U?"auto":"none")):Fb.d(a,ua.a.$Mf,"auto");ja?(a.style.backgroundColor=ja,"transparent"!==ja&&Array.add(H,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||b.QF)l=Math.floor(l*this.ew.hae());U=this.ew.P2f(l,c,f.Md);ja=this.ew.P5b(b);l=this.JV&&this.JV.B0i?this.JV.o6h(b.JN):this.wQh(ja);this.N4a.ske&&l&&ea.FontUtils.mAb(ja)&&(l=this.ew.Ayf(ja,l));let wa=b.LTa&&b.isBold;void 0===wa&&(wa=!1);let Sa=b.R$a&&b.isItalic;
void 0===Sa&&(Sa=!1);l=this.ew.xdh(new Da.a(ja,wa,Sa),l,c);!this.VBl(ja,b,a.style)&&b.LTa&&(b.isBold?(a.style.fontWeight="bold",B.a.wk&&B.a.Vj&&Array.add(H,"MacChromeBold")):a.style.fontWeight="normal");b.R$a&&(a.style.fontStyle=b.isItalic?"italic":"normal");(b.iyb||w&&this.ew.mvh()||b.hyb||b.W7b)&&this.jSe(a,b,c,H);U&&(a.style.fontSize=U);if(l&&(a.style.fontFamily=l,R.a.instance.ga(118))){Ba.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");w=l.split(",");
for(l=0;l<w.length-1;l++)c.append('"'+w[l].trim()+'",');0<w.length&&c.append('"'+w[w.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.MTa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform="uppercase":a.style.fontVariant="normal");if(f=this.ew.s0f(b,f.Md))a.style.letterSpacing=f;if(b=this.ew.Q3f(b))a.style.fontKerning=b,B.a.DT&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=H.join(" ")}VBl(a,b,c){return R.a.instance.ga(116)&&
B.a.wk&&B.a.Vj?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}yyf(a,b){this.fd.hg&&b&&!b.Nj&&(b.Bp||b.Ho)&&(a.style.color="#000")}Ffi(a,b){if(b=b?this.aTh(b):0){const c=Xa.a.xe(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.Tqf.contains(b)||(ka.ULS.sendTraceTag(18482318,
324,15,"Unknown LCID encountered in file: {0}",b),this.Tqf.add(b))}}jSe(a,b,c,f){c="";const l=b.hE,w=b.PF;b=b.D_;l&&(c="underline",f[f.length]="Underlined");if(w||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";l||w||b||(c="none");0<c.length&&(a.style.textDecoration=c)}uyf(a,b,c){b.isSuperscript&&(a.style.verticalAlign="super",a.className+=" Superscript");b.QF&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.QF)&&
Fb.d(a,ua.a.bNf,(b.fontSize/2).toString())}lZd(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){const Ud=b?b.cache:oc.FormattingCacheManager.s5b(c,ia.a.nil);Sa=!f||ub||this.VRa(f,Sa)?0:f.Hh.proofingType;ub=!!l;const je=!!w,Vd=!!H;w=this.ew.Hvh(Ud,eb,l,w,H);if(Ub.W$b||Fc&&bc(Fc))w=!1;this.UCf?(l=this.ynj(Ud,Sa,ub,je,Vd,eb,w,Ic),this.aFc.Gb(l)?eb=this.aFc.ga(l):(eb=this.dMf(U,Ud,Sa,ub,je,Vd,eb,w,Ic),this.aFc.$(l,eb)),U=eb.cloneNode(),T.a.ALc(eb,U)):U=this.dMf(U,Ud,Sa,ub,je,Vd,eb,w,Ic);this.Ddi(a,U,Ud);
this.KQd(a,U);this.owf(U);this.nwf(a,U);this.iqa.lCi&&this.Edi(U,b,c);this.Qpb&&0!==Sa&&this.Qpb.iRk(U,c,(Ve,af,Zf,lg)=>{ja.add(this.lKb(Ve,af,Zf,lg))},f);Ub.W$b&&cc&&Ub.span&&(this.vRd(null,Ub.span),Ub.span=null);if((b=Ub.W$b?U:null)||Ub.span)this.vRd(b,Ub.span),Ub.span=b,Ub.span&&(b=(b=T.a.Be(a,da.a.j2c))?b:-1,0<b&&(Ub.span.style.lineHeight=String.format("{0}px",b+3)));Fc&&!Fc.isEmpty&&(dc(U,Fc),this.Qpb&&this.Qpb.Yeh(U,c,(Ve,af,Zf,lg)=>{ja.add(this.lKb(Ve,af,Zf,lg))},Fc,0));Cc&&Sys.UI.DomElement.addCssClass(U,
Gc.a.CJi);a.appendChild(U);wa(U);return U}VRa(a,b){b=a&&a.Hh&&a.Hh.token?a.Hh.token:b;return 0!==a.Hh.errorType&&!!this.PNa&&this.PNa.contains(b,a.Hh.lcid)}ynj(a,b,c,f,l,w,H,U){b|=0;w&&(b|=16);H&&(b|=32);c&&(b|=64);f&&(b|=128);l&&(b|=256);U&&(b|=2048);a.isSuperscript&&(b|=512);a.QF&&(b|=1024);return b}dMf(a,b,c,f,l,w,H,U,ja){a=a.jp(Ga.a.span);const wa=[];if(0!==c){if(!this.N4a.TLl)switch(c){case 1:wa[wa.length]=Gc.a.FMc;break;case 2:wa[wa.length]=Gc.a.DMc;break;case 3:wa[wa.length]=Gc.a.CMc}b.isSuperscript&&
(wa[wa.length]=Gc.a.FZd)}else ja&&(wa[wa.length]=Gc.a.uJi);H&&(wa[wa.length]=Gc.a.l8);f&&(wa[wa.length]=Gc.a.AZd);l&&(wa[wa.length]=Gc.a.CZd);w&&(wa[wa.length]=Gc.a.EMc);a.className=0<wa.length?wa.join(" "):Gc.a.Y1b;this.uyf(a,b,U);return a}Edi(a,b,c){if(b&&a){if(b=Kb.a.Bwb(b))if(b=mb.StyleReader.wQ(b)){a.setAttribute("data-ccp-charstyle",b);return}(c=zb.ParagraphReader.ae(c)?mb.StyleReader.aE(c):null)&&(c=mb.StyleReader.wQ(c))&&c!==mb.StyleReader.CMa&&c!==mb.StyleReader.XKh&&a.setAttribute("data-ccp-parastyle",
c)}}Ddi(a,b,c){(c=this.ew.l8f(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(ha.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.ew.hae()*c/100+"px"))}KQd(){}owf(){}nwf(){}zEi(a,b,c,f){b=b.jp(Ga.a.span);b.className=Gc.a.G3d;this.QEc&&this.QEc.SPl(f,b);a.appendChild(b);c(b);return b}EKf(a,b,c,f){b=b.jp(Ga.a.span);b.className=Gc.a.FN;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.r7d(a),b.style.fontFamily=a.style.fontFamily);
a="";for(let l=0;l<f;l++)a+=c;b.innerText=a;return b}r7d(a){return a.style.lineHeight}vRd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,Gc.a.yJi),b||Sys.UI.DomElement.addCssClass(a,Gc.a.BZd)):b&&((a=Sys.UI.DomElement.containsCssClass(b,Gc.a.BZd))&&Sys.UI.DomElement.removeCssClass(b,Gc.a.BZd),Sys.UI.DomElement.addCssClass(b,a?Gc.a.AJi:Gc.a.zJi))}static Bia(a,b,c){T.a.Sv(c,da.a.VFa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static P0f(a){let b,c;b=[];c=[];if(a&&
a.yg)for(let f=0;f<a.yg.length;f++){const l=a.yg.ga(f);Array.add(l.xk?b:c,l.wI)}return{TKc:b,PKc:c}}static Xki(a,b){const c=new Vc.a;for(const l of b){var f=a.Be(l);b=f.eb(Va.a.H0b);if(f=f.sa(Va.a.QKc,null)){let w;({value:w}=c.Tf(f)).returnValue||(w=new Ka.a,c.$(f,w));w.add(b)}}return c}static R0f(a,b,c){const f=new Ka.a,l=gc.Xki(a,b);for(const w of b){const H=a.Be(w),U=H.eb(Va.a.H0b),ja=H.sa(Va.a.uAi,!1),wa=H.sa(Va.a.IHf,!1);H.sa(Va.a.Nke,!1)&&!wa&&(c.add(w),ja||l.Gb(U)||f.add(H.id))}return Oa.gYk(b,
f)}static BEl(a,b,c,f){const l=new Ka.a,w=new Ka.a;b=gc.R0f(a,b,l);a=gc.R0f(a,c,w);c=new Ka.a;c.addRange(f);c.addRange(l);c=Oa.hYk(c,w);return{TKc:b,PKc:a,SJi:c,pQj:0<w.count}}static x5i(a,b){var c=1;if(B.a.NF&&!b){a=za.a.GRc(a,!1);for(let f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&(c+=ec.WNc+ec.A0d)}return c}}gc.z0i=.8;gc.ADh="TrackChangeImageOverlay";Object(n.a)(gc,"ParagraphContentRenderer",null,[1350]);var rb=d(77),Zb=d(608),Hc=d(1218),Ab=d(57);class ad{constructor(a){this._element=
null;this.ji=a;this.Dzc=[]}get ownerDocument(){return this.ji}get element(){return this._element}nkb(a){this._element=a}i1g(){var a=Sys.EventArgs.Empty;if(this.Dzc)for(let b=0;b<this.Dzc.length;b++)(0,this.Dzc[b])(this,a)}dispose(){this.Dzc=this._element=this.ji=null}}Object(n.a)(ad,"APresenter",null,[1388,106]);class Bd extends ad{constructor(a,b){super(b.htmlElement.ownerDocument);this.apb=null;this.FVb=a;this.r4h=b}FZf(a){this.element&&a.O1c===this.apb||(this.apb=a.O1c,this.nkb(this.FVb.EKf(this.apb,
this.r4h.Nd,da.a.WOc,1)),this.element.className=Gc.a.obc,this.element.style.lineHeight=this.apb.style.lineHeight,a=""+T.a.Be(this.apb,da.a.mOb),T.a.Sv(this.element,da.a.mOb,a),a=Hc.a.createElement(this.ownerDocument,Ga.a.span),a.innerText=da.a.Zqi,za.a.Cu(this.element),this.element.appendChild(a),a=Hc.a.createElement(this.ownerDocument,Ga.a.br),this.element.appendChild(a))}Bgg(){}dispose(){super.dispose();this.apb=null}}Object(n.a)(Bd,"LineBreakPresenter",ad,[]);class kd{constructor(a){this.FVb=a}create(a){return new Bd(this.FVb,
a)}}Object(n.a)(kd,"LineBreakPresenterFactory",null,[1349]);class Be extends ad{constructor(a,b){super(a.ownerDocument);this.GNd=b;this.gca=a}FZf(){this.element||(this.nkb(this.gca.jp(Ga.a.span)),19===this.GNd.kind||18===this.GNd.kind?Sys.UI.DomElement.addCssClass(this.element,Gc.a.zZd):(Sys.UI.DomElement.addCssClass(this.element,Gc.a.Z1b),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.GNd.g8a,this.i1g())}Bgg(){this.nkb(null);this.i1g()}}Object(n.a)(Be,"UnsupportedObjectPresenter",
ad,[]);class Qd{create(a,b){return new Be(a,b)}}Object(n.a)(Qd,"UnsupportedObjectPresenterFactory",null,[1348]);class ae{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,w=!1,H=!1){this.qx=a;this.nQi=b;this.OIl=c;this.PIl=f;this.Bvc=l;this.ske=w;this.TLl=H}}Object(n.a)(ae,"ParagraphContentRendererSettings",null,[]);var We=d(113);class $d{constructor(a,b,c){this.IV=a;this.vZ=b;this.iSb=c}M9a(a){return a}P2f(a,b,c){return c.pja(a)}s0f(){return null}Q3f(){return B.a.Vj&&window.chrome?"none":null}mFf(){return!1}uEh(){return!1}Ayf(){return""}eJh(){}fIf(){}Mvh(a){return a===
D.a.underline||a===D.a.Qoa||a===D.a.strikethrough||a===D.a.Zs||a===D.a.B1}ENe(a,b){this.IV&&this.IV.isEnabled&&this.IV.createFontUrl(a);this.vZ&&this.vZ.isEnabled&&(b=ea.FontUtils.trb(b,a,!1,!1,!0),this.vZ.createFontUrl(a));return b}xdh(a,b,c=null){if(!a)return b;b=this.ENe(a.fontName,b);this.iSb&&this.iSb.isEnabled&&(b=ea.FontUtils.trb(b,a.fontName,!1,!0),this.iSb.TOl(a)||this.iSb.bOl(c),this.iSb.lOl(a));return b}EZc(){return!1}R7d(a,b,c,f){a=null;!c&&f||!b.V3||(b=b.fontColor,a=b===tc.a.auto?"WindowText":
tc.a.xI(b));return a}Hvh(a,b,c,f,l){return!b&&!c&&!f&&!l}l8f(){return 0}hae(){return.8}kvh(a,b){return a||!b}Qvh(){return!1}mvh(){return!1}u1f(){return new Vc.a}v1f(){return null}P5b(a){return We.Font.eEa(a.JN)}}Object(n.a)($d,"TextRenderingStrategy",null,[1310]);class Re{get name(){return"Box4.ParagraphRenderElements"}Zb(a){a.register(kd,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().oa(()=>new kd(a.resolve("Box4.IParagraphContentRenderer")));a.register(Qd,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();
a.register($d,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().oa(()=>new $d(a.rb("Box4.IFontService"),a.rb("Box4.CustomFontService"),a.rb("Box4.IEmbeddedFontService")));a.register(ae,"Box4.ParagraphContentRendererSettings").ma().oa(()=>new ae(rb.ListReader.qx,u.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),R.a.instance.ga(49),R.a.instance.ga(53),u.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),u.AFrameworkApplication.fa.ka(ea.FontUtils.ZGf),u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));
a.register(gc,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>new gc(na.InteractiveViewManager.instance,ra.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.rb("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.rb("Box4.IFeatureHelper"),
ea.FontUtils.oja,a.rb("Box4.IFontSlotProvider"),Object(F.a)(a.resolve("Box4.IEditStateEventManager"),a.resolve("Box4.IEditStateEventManager").gfh,"raiseParagraphContentUpdatedEvent"),Kb.a.language,a.rb("Box4.ITableOfContentRenderHelper"),Zb.a.eBf))}init(){}dispose(){}static main(){v.a.instance.Dc(new Re)}}Object(n.a)(Re,"Box4ParagraphRenderElementsPackage",null,[2,3]);class Ta{constructor(a,b,c,f,l,w,H){this.ule=a;this.cZj=b;this.E_c=c;this.zTj=f;this.wWj=l;this.qx=w;this.UWj=b&&H||f}}Object(n.a)(Ta,
"TableCellViewElementSettings",null,[]);class xb{get name(){return"Box4.TableViewElements"}Zb(a){a.register(Ta,"Box4.TableCellViewElementSettings").ma().oa(()=>new Ta(u.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),R.a.instance.ga(63),R.a.instance.ga(30),R.a.instance.ga(77),R.a.instance.ga(71),rb.ListReader.qx,u.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){v.a.instance.Dc(new xb)}}Object(n.a)(xb,"Box4TableViewElementsPackage",
null,[2,3]);var kc=d(1203),Nc=d(388),id=d(1227),Ed=d(225),Ja=d(163),db=d(179),zc=d(1159);class Hd{Be(a,b){return T.a.Be(a,b)}Sv(a,b,c){T.a.Sv(a,b,c)}noa(a,b){T.a.noa(a,b)}rKa(a){T.a.rKa(a)}ALc(a,b){T.a.ALc(a,b)}}Object(n.a)(Hd,"CustomDataProxy",null,[1569]);var Ad=d(353),Kd=d(65),Pc=d(29);class tf{constructor(){this.Pa=new vc.a}SOk(a){this.Pa.raiseEvent("OnBackspaceDelete",a)}}Object(n.a)(tf,"BackspaceDeleteEventSource",null,[1442,1443]);class xe extends Sys.EventArgs{constructor(a,b){super();this.TM=
a;this.VU=b}}xe.eventId="AEV.AVLD";Object(n.a)(xe,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,[]);class ef extends vc.a{constructor(){super()}Suf(a){this.addHandler(xe.eventId,a)}XZk(a){this.removeHandler(xe.eventId,a)}}ef.NAi="AEV.CR";Object(n.a)(ef,"ContentEditableViewEventSource",vc.a,[]);var Id=d(51);class qe{constructor(){this.fDc=null;this.Uh=0}Rfj(a){if(!this.fDc){var b=a.Lb?Id.a.createTextRange(a.node,0,a.Lb):Id.a.Mj(a.node,a.Lb);this.fDc=vb.HyperlinkReader.vC(b,!1);this.Uh=this.fDc.length-
1}for(;0<=this.Uh;)if(b=this.fDc[this.Uh],a.Lb<=b.Qa)--this.Uh;else return b.Lb<=a.Qa?null:b;return null}}Object(n.a)(qe,"OverlappingHyperlinkHelper",null,[]);class jg{constructor(a,b,c,f,l){this.h1a=a;this.LD=b;this.Rra=c;this.Gdd=f;this.Hdd=l}}Object(n.a)(jg,"PersistActiveSpanEditState",null,[]);class of{constructor(a,b){this.Cg=a;this.gh=b;this.JCc=[];this.dI=this.cI=-1}rSe(){if(-1!==this.cI&&-1!==this.dI&&this.gh){this.JCc.reverse();const a=this.JCc.join("");let b,c;this.cI===this.dI?(b=Id.a.Mj(this.Cg,
this.cI),c=!!a.length):(b=Id.a.createTextRange(this.Cg,this.cI,this.dI),c=this.dI-this.cI!==a.length||this.Aae(b)!==a);c&&this.gh.replaceTextRange(b,a,!0,void 0,D.a.typing)}this.dI=this.cI=-1;Array.clear(this.JCc)}gfi(a,b){this.cI=a.Qa;-1===this.dI&&(this.dI=a.Lb);0<b.length&&Array.add(this.JCc,b)}Aae(a){return zb.ParagraphReader.text(a.node).substring(a.Qa,a.Lb)}}Object(n.a)(of,"ReplacementTextRangeBuilder",null,[]);var Cb=d(41);class Df{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.Dh=a;this.yD=
b;this.yqa=c;this.ag=f;this.nd=l;this.zn=w;this.zd=H;this.Um=ja;this.od=wa;this.tf=Sa;this.$a=eb;this.FAc=this.$a.ka("TextLayoutServiceUseResponse");this.Pgf=this.$a.ka("TextLayoutServiceEnableActiveContentSpanFix")}LAl(){let a,b;a=b=null;if(this.zd&&this.zd.hV){var c=this.Um.getSelection(this.od.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,Gc.a.Gfa);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,jYf:a,
kYf:b}}}return{returnValue:!1,jYf:a,kYf:b}}qfj(a){let b=0;for(let c of za.a.X9a(a))"span"===c.nodeName.toLowerCase()&&b++;return b}H8k(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,Gc.a.Gfa)&&!Sys.UI.DomElement.containsCssClass(b,Gc.a.y9);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of za.a.X9a(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=
b.parentNode}return null}S7i(a,b,c,f,l){let w=za.a.zv(c);const H=za.a.X5d(c,Gc.a.Gfa);l=this.qfj(H)+this.Dh.Gi.length-l.ot.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?w=za.a.zv(f)+za.a.zv(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?w=za.a.zv(f):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==f&&(w=za.a.zv(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(w=za.a.zv(f)+za.a.zv(f.nextSibling)):
2<l&&(w=b.innerText,ka.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));a.O0b||!b.innerText.endsWith(" ")||w.endsWith(" ")||(w+=b.innerText.substr(b.innerText.trimEnd().length));return w}QFk(a,b,c,f,l){const w=new jg(null,null,!0,null,null);let H=null,U=null;if(1===this.tf.mode||2===this.tf.mode)({jYf:H,kYf:U}=this.LAl());let ja=!1,wa=!1;const Sa=new qe,eb=new of(a,f),ub=0<this.Dh.Gi.length&&this.Dh.Gi[0].O0b;let Ub=null;H&&this.$a.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&
(Ub=this.H8k(H));for(let Fc=this.Dh.Gi.length-1;0<=Fc;Fc--){const Ic=this.Dh.Gi[Fc],Cc=Ic.yF;let Ud=!1;if(this.Pgf&&this.FAc&&U&&!za.a.s3b(Cc)){var cc=!1;ub&&Fc===this.Dh.Gi.length-1&&!za.a.X5d(H,Gc.a.FN)?Ud=cc=!0:1===this.Dh.Gi.length&&(cc=!0);cc&&(Cc.innerText=this.S7i(Ic,Cc,H,U,c),w.Rra=!1)}w.LD=za.a.zv(Cc);this.yD.w7&&this.xSi(w.LD)&&(w.LD=ha.a.substr(w.LD,0,w.LD.length-1));cc=this.B7i(a,Fc);this.wok(a,b,Fc,w);wa=!!w.h1a||wa;Ub===Cc&&(w.Hdd=Cc.innerText+za.a.zv(H),H.nodeValue="",w.Rra=!1,ka.ULS.sendTraceTag(541172698,
323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));w.Gdd||(w.Gdd=this.$Yi(a,cc,Sa));const je=!!l&&l.ZAi(cc);this.GDl(a,b,Cc,Fc,w,Ud);je&&0<w.LD.length?(eb.rSe(),this.replaceTextRange(f,w,"",cc),this.Cfi(l,je,w,cc)):this.eyi(Ic,w.LD,cc,eb);ja=Cc===U||ja}eb.rSe();this.AFl(a,w);H&&za.a.zv(H)&&!ja&&!wa&&(this.nd.Xb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),Df.Iif||(ka.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),
Df.Iif=!0));return w.Rra}eyi(a,b,c,f){if(c.contextId!==Cb.a.Of&&!a.O0b&&0<=a.phd){let l=a.phd,w=a.bKe;a=l!==w?Id.a.createTextRange(c.node,l,w):Id.a.Mj(c.node,l);b=b.substring(l-c.Qa,b.length-(c.Lb-w))}else a=c;a.Lb-a.Qa!==b.length||b!==this.Aae(a)?f.gfi(a,b):f.rSe()}xSi(a){return a.charAt(a.length-1)===ec.SHb||B.a.vo&&a.charCodeAt(a.length-1)===A.a.NPb}Aae(a){return zb.ParagraphReader.text(a.node).substring(a.Qa,a.Lb)}replaceTextRange(a,b,c,f){b.LD!==c&&a&&a.replaceTextRange(f,b.LD,!0,!0)}Cfi(a,b,
c,f){b&&0<c.LD.length&&(b=Id.a.createTextRange(f.node,f.Qa,f.Lb+c.LD.length),a.Efi(b))}AFl(a,b){b.Gdd&&(b=vb.HyperlinkReader.vC(b.Gdd,!0),1===b.length&&this.zn&&this.zn.ugl(a,b[0]))}GDl(a,b,c,f,l,w){const H=za.a.I6f(c);this.Dh.Gi[f].O0b&&H?w||this.Fsj(b,f,l,H):l.h1a&&!Sys.UI.DomElement.containsCssClass(c,Gc.a.rN)?(this.nd.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.ag.bc++,l.LD+=l.h1a,l.h1a=null,za.a.Nx(this.Dh.Gi[f].yF,l.LD)):l.Hdd?(l.LD=l.Hdd,l.Hdd=null):this.FAc&&
this.Pgf&&(a=zb.ParagraphReader.text(a),b=this.Dh.Gi[f],c=b.phd,w=b.bKe,f+1<this.Dh.Gi.length&&!za.a.s3b(this.Dh.Gi[f+1].yF)&&c===w&&0<c&&" "===a.charAt(c-1)&&(l.LD=l.LD.substr(0,c-1)+" "+l.LD.substr(c-1),l.Rra=!1),b.yF.innerText.endsWith(" ")||" "!==a.charAt(w)||b.pZa+b.vTa!==w+1||(l.LD+=" ",l.Rra=!1))}Fsj(a,b,c,f){!b&&c.h1a?(this.nd.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.ag.bb++,c.LD=c.h1a,za.a.Nx(this.Dh.Gi[b].yF,c.LD),this.zd.RF&&(a=a.lastChild,this.FAc&&Sys.UI.DomElement.containsCssClass(a,
Gc.a.y9)&&(a=a.lastChild),a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.h1a=null):(this.nd.Xb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.ag.bd++,c.LD="",za.a.Nx(this.Dh.Gi[b].yF,c.LD))}B7i(a,b){b=this.Dh.Gi[b];return b.pZa?Id.a.createTextRange(a,b.vTa,b.vTa+b.pZa):Id.a.Mj(a,b.vTa)}wok(a,b,c,f){if(this.Dh.Gi[c].vTa+this.Dh.Gi[c].pZa===zb.ParagraphReader.textLength(a)&&(a=b.lastChild,this.FAc&&Sys.UI.DomElement.containsCssClass(a,Gc.a.y9)&&(a=a.lastChild),c=za.a.zv(a),c.length>
this.yqa.v2d)){this.ag.ba++;this.yD.akb(!1,b,this.Dh);f.h1a=ha.a.substr(c,0,c.length-this.yqa.v2d);b="";for(c=0;c<this.yqa.v2d;c++)b+=da.a.WOc;a.innerText=b;f.Rra=!1}}$Yi(a,b,c){return(b=c.Rfj(b))&&Df.cLj(b)?Id.a.Mj(a,b.Qa):null}static cLj(a){return!!a.hyperlink&&a.hyperlink.url===zb.ParagraphReader.text(a.paragraph).substring(a.Qa,a.Lb)}}Df.Iif=!1;Object(n.a)(Df,"ActiveContentSpansPersistanceManager",null,[1440]);class Bf{constructor(a){this.Us=a}jsk(a){a&&this.Us.YY()}}Object(n.a)(Bf,"AppFrameResizeEventProcessor",
null,[]);class qg{constructor(){this.vYb=new Ka.a}ya(a){this.vYb.add(a)}jta(a){return this.vYb.count>a?this.vYb.ga(a):null}get YFa(){return this.vYb.count}isEmpty(){return!this.vYb.count}}Object(n.a)(qg,"AggregatedAutoCorrectActions",null,[589]);var vd=d(236);class $f{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){this.BR=this.zn=this.Gzc=this.Ve=null;this.hv=a;this.oK=b;this.zh=c;this.Ob=f;this.Dh=l;this.tZ=w;this.Ep=H;this.Wi=U;this.Mha=ja;this.Us=wa;this.tf=Sa;this.eS=eb;this.Bk=ub;this.Tc=
Ub;this.fd=cc;this.ap=Fc}NS(a){this.Ve=a}get QZb(){return this.oK}get hyperlinkEditor(){return this.zn||(this.zn=Ab.a.instance.rb("Box4.IHyperlinkEditor"))}get EBj(){return this.Gzc||(this.Gzc=Ab.a.instance.rb("Box4.IHyperlinkActionFactory"))}yJj(a){if(this.hv.instance&&a&&2===this.zh.mode)if(this.Ve.Ss(!0),this.Mha.value.uw(),a.nx)this.hv.instance.wJj(a),this.Mha.value.uw();else{var b=this.Wi.F8(this.zh.mode,this.Ob.Ji);a.Adg.innerText=a.Adg.innerText;this.eS.jpc();this.Ep.raiseEvent(vd.a.autoCorrect);
1===this.hv.instance.xJj(a)&&(this.tf.Daa(!0),b>=a.yR&&(b+=a.g2c),this.Wi.eT(b,this.Ob.Wh),this.Ve.Ss(!0),this.Mha.value.uw(),this.Us.YY())}}fEe(a,b){if(!this.hv.instance||!this.EBj||!this.hyperlinkEditor)return null;this.Ve.Ss(!0);a=this.tZ.sta(b).Ua;b=a.Qa;if(0>=b||!this.Dh.Gi.length)return null;if(a=this.hv.instance.fEe(a.node,b))this.BR||(this.BR=new qg),this.BR.ya(a);return a}bPi(a,b){if(2===this.zh.mode&&this.Dh.Gi.length){var c=this.Wi.F8(this.zh.mode,this.Ob.Ji);!this.BR&&this.hv.instance&&
(b=this.tZ.sta(b).Ua,0>c||!this.Dh.Gi.length||(this.BR=new qg,this.BR=this.hv.instance.jKf(b.node,c,c-this.Dh.Gi[0].IIc,this.Dh.Gi[0].yF,!this.Dh.Gi[0].IIc,a),this.BR.YFa||(this.BR=null)))}}HFk(){if(2===this.zh.mode){if(0<this.BR.YFa){this.Ve.Ss(!0);for(var a=0;a<this.BR.YFa;a++)this.BR.jta(a).TJh();for(a=0;a<this.BR.YFa;a++)this.yJj(this.BR.jta(a))}this.BR=null}}}Object(n.a)($f,"AutocorrectActionExecutor",null,[]);var ng=d(317);class Qe{constructor(a,b,c,f,l,w,H,U,ja,wa){this.R3h=w;this.tZ=a;this.lj=
b;this.DD=c;this.jf=f;this.wK=l;this.P7e=H;this.fd=U;this.BD=ja;this.Tza=!!wa;this.hv=wa}XAl(a,b,c,f,l,w,H){if(!f)return!1;f=this.tZ.sta(l);if(!f||!this.jf.ox(f)||!f.Ua.al)return!1;l=f.Ua;if(this.QSj(l)||this.vQj(a,l)||this.dbb(l))return!1;if(Pc.App.uii){if(this.PSj(w))return!1}else if(this.OSj(w))return!1;return this.wK&&this.wK.zzb(f)||!this.jqi(a,this.lj,H,za.a.zv(c),b)||this.Tza&&!a&&this.hv.instance&&this.hv.instance.Wzj()?!1:!0}PSj(a){if(this.P7e&&a&&Sys.UI.DomElement.containsCssClass(a,Gc.a.Gfa)){const b=
za.a.gda(a,Gc.a.y9);b&&(a=b)}return za.a.gda(a,Qe.V0g)?!0:!1}OSj(a){if(this.P7e&&a&&Sys.UI.DomElement.containsCssClass(a,Gc.a.Gfa)){const b=za.a.gda(a,Gc.a.y9);b&&(a=b)}return za.a.gda(a,ng.a.Tbb)||za.a.gda(a,Qe.V0g)?!0:!1}dbb(a){return this.BD.dbb(a).returnValue}QSj(a){return this.lj&&(!this.R3h.C_b(a.node)||R.a.instance.ga(14)&&this.DD.N9g(a.node))?!0:!1}vQj(a,b){return R.a.instance.ga(14)&&this.DD.cRj(b,!a)}jqi(a,b,c,f,l){if(!f||""===f)return!1;var w=this.fd.hg&&this.fd.Yy;w=a&&!w?0:1;!a&&1<c&&
ha.a.rx(f,c-1)?w=2:c<f.length&&ha.a.rx(f,c)&&(w=1);if(a){if(a=c+w,a>=f.length-2||!this.kqi(c,f,w))return!1}else{a=c-w;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&ha.a.iz(f.charCodeAt(0))&&(f.length===c||ha.a.iz(f.charCodeAt(c))))return!1}b=P.a.vEa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,da.a.wJi)||Sys.UI.DomElement.containsCssClass(b,Gc.a.FN)||Sys.UI.DomElement.containsCssClass(b,Gc.a.rN)||Sys.UI.DomElement.containsCssClass(b,da.a.kW)?!1:!0}kqi(a,b,c){return ha.a.iz(b.charCodeAt(a+
c))&&(!a&&b.length===1+c||1===a&&ha.a.iz(b.charCodeAt(0)))?!1:!0}}Qe.V0g="NoteTagContainer";Object(n.a)(Qe,"BackspaceInBrowserHandler",null,[]);var Gf=d(1214),Jf=d(200);class xh{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(n.a)(xh,"UnroundedRectangle",null,[]);var he=d(1070),de=d(64),xf=d(146);class re{constructor(a,b,c,f,l,w,H,U,ja){this.Ah=null;this.jga=!1;this.Kba=a;this.od=b;this.zZ=c;this.s2=f;this.zd=l;this.Kf=w;this.tf=H;this.Ob=U;this.KP=ja}WZb(a){this.Ah=a}YY(){if(2===
this.tf.mode&&this.Ob.Dg){var a=this.Ob.BW,b=this.Ob.Wh;if(a&&b){if(!this.od.zg&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),u.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){ka.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.Ah.Ma);return}this.od.zg.sGe(a);b=this.od.zg.uu;var c=this.d2f(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;
a=c.width;c=c.height;0>a&&(a=0);var l=Gf.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.Xvh()&&(f=this.od.om(),this.NYj()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.Kba.instance.YFl(b.parentNode,this.Ob.Lca,!!this.Ah&&this.Ah.Wl&&this.Ah.Uvb)}}}}Xvh(){return this.zd.RF&&!this.zd.Pi&&R.a.instance.ga(30)}INj(a){return za.a.GUa(a)}NYj(){return xf.c(this.Ah.xg)}ai(a){return Kd.a.ai(a)}TAh(a){var b=
de.a.instance.Na.mb;if(1===this.tf.mode){var c=(b.yf?b.Ye:b.Ua).node;b=c.sc(this.Kf.Qd.Ma);a=c.sc(a);if(b&&a){this.od.zg.sGe(b);a=this.od.zg.uu;var f=this.d2f(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.zd.Hjb)this.s2.adg();else{const l=b.x+"px";c+="px";f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}d2f(a,b){if(!this.INj(a))return null;var c=this.ai(a),f=this.ai(b);
let l=c.x-f.x;f=c.y-f.y;var w=Gf.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{w&&w.dispose()}b=c.width;c=c.height;this.zZ&&this.zZ.instance&&this.zZ.instance.ikg(a)&&(w=this.zZ.instance.n3,b/=w,c/=w);if(this.KP.jAb(a)){var H=Jf.a.Xt(a);H&&(w=parseFloat(H.width),H=parseFloat(H.height),isNaN(w)||isNaN(H)||(b=w,c=H))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.zd.IUa||this.zd.vo)b+=.001,l+=.001,f+=.001;c+=1.001;return new xh(new he.a(l,f),b,c)}}Object(n.a)(re,"BoundsSynchronizer",
null,[1438]);var Ih=d(565),Le=d(82);class Cd{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.UXh=new Ih.a(RegExp("\r\n","g"),"\n");this.NDd=null;this.DFd=0;this.uJd=!1;this.Szc=!0;this.nd=b;this.ag=c;this.WAc=a;this.od=f;this.Yo=l;this.zd=w;this.Kf=H;this.$d=U;this.lj=ja;this.Um=wa;this.JKd=Sa;this.gra=ub}get uig(){null==this.NDd&&(this.NDd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.NDd}get sVa(){return this.DFd}get DRk(){return this.uJd}get CIj(){return this.Szc}ZRc(a,
b){var c=this.od.cEa();if(1===a||0===a)return 0;if(this.zd.hV){var f=this.aEa();if(f){this.uJd=!this.f0c(f);c=this.Um.SUc(f);var l=this.Um.U7f(f),w=l;u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.uig&&this.zd.wk&&(f=this.Um.h2f(f),l!==f&&(w=f));return this.Yo.B9d(c,b,w,this.ag,this.nd,this.lj)}ka.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.zd.NF)try{return l=c.selection.createRange(),
w=this.od.om().innerText,b=0,""!==w&&(b=Math.abs(this.Um.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.Um.moveEnd(l.range,-1E5)),this.uJd=b!==f),w=this.UXh.IJa(w),b>=w.length&&(b=w.length-1),b}catch(H){this.nd.Xb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),this.ag.bg++,ka.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",H.message,H.toString())}else ka.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");
this.ag.bh++;return 0}f0c(a){return Kd.a.f0c(a)}aEa(){return Kd.a.aEa(this.od.contentWindow)}Vkl(a,b,c,f,l){if(!u.AFrameworkApplication.fa||!u.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.ot.length-1||Sys.UI.DomElement.containsCssClass(b.ot[a+1],Gc.a.FN))return!1;a=b.ot[a];b=za.a.X5d(a,Gc.a.y9);if(!b)return!1;b=za.a.X9a(b).toArray();return b[b.length-1]!==a?!1:!0}eT(a,b){var c=this.od.contentWindow;this.Szc=!0;this.DFd=a;try{if(this.zd.hV){const w=b.ot;
let H;var f=0;const U=this.Um.getSelection(c);if(U)for(H=0;H<b.ot.length;H++){const ja=b.ot;ka.ULS.shipAssertTag(18437200,315,w===ja);let wa=ja[H],Sa=this.Yo.MI(wa,this.ag,this.nd,this.lj);var l=a<=Sa+f;const eb=Sys.UI.DomElement.containsCssClass(wa,Gc.a.rN),ub=Sys.UI.DomElement.containsCssClass(wa,da.a.kW),Ub=this.Vkl(H,b,a,f,Sa);if(l&&!eb&&!ub&&!Ub){b=H+1;if(a===Sa+f&&b<ja.length){const cc=ja[b];!this.Yo.MI(cc,this.ag,this.nd,this.lj)&&za.a.s3b(cc)&&(wa=cc,f=a)}a-=f;this.WAc.value.D0b(wa,c);for(c=
wa;c.firstChild;)c=c.firstChild;this.uLj(U,c,a)||(c=this.VTi(c,this.od.cEa()),this.uig&&this.zd.wk?2!==this.Kf.editingView.wub&&this.SSf(c,a,U):this.SSf(c,a,U));break}f+=Sa}}else this.zd.NF&&(f=this.JKd.create(this.Kf.Qd),l=this.Um.createRange(this.od.om()),this.Um.collapse(l,!0),this.Um.moveStart(l,a),l.select(),f.dispose())}catch(w){ka.ULS.shipAssertTag(4203852,315,!1)}}VTi(a,b){"SPAN"===a.nodeName&&(b=b.Tl.createTextNode(""),a.appendChild(b),a=b);return a}SSf(a,b,c){if(this.Yo.Uig(a)){this.Um.removeAllRanges(c);
var f=this.Um.createRange(a.ownerDocument);this.Um.hMb(f,!0,a,b);this.Um.hMb(f,!1,a,b);try{this.Um.addRange(c,f)}catch(l){this.ag.bl++,this.nd.Xb("PossibleNoIp",{["Reason"]:"AddRangeException"}),ka.ULS.shipAssertTag(1708946,315,!1)}this.Um.collapse(f,!0)}else ka.ULS.sendTraceTag(541172696,324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.DFd=this.ZRc(a,b)}mouseDown(){return this.Szc=!1}GJ(){this.Szc=!0;return!1}F8(a,b){this.gra&&this.gra.NJl(this.sVa,this.ZRc(a,
b));return this.sVa}uLj(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,w=a.focusOffset;return a.isCollapsed&&l&&f===b&&w===c}SNf(a,b){const c=new Le.a(0,1,0,()=>{b.pVa(a.mode)&&this.updateCaretPosition(a.mode,b.Ji)},28);this.$d.Db(c)}}Object(n.a)(Cd,"CaretPositionManager",null,[1439]);var Lc=d(266);class Td{constructor(){this.vI=Lc.a.instance.u6d()}}Object(n.a)(Td,"CevUsageDataTracker",null,[]);class Ge{constructor(a,b){this.Hxc=null;this.pia=0;this.Dg=this.BW=null;this.Lca=!1;this.zBa=a;this.Kf=
b}init(a){this.pia=a}get aAj(){return!!this.Dg&&!!this.Dg.ng(this.pia)}get eRa(){ka.ULS.shipAssertTag(18437208,315,!!this.Dg);return this.Wh?this.Wh.htmlElement:null}get Ji(){return this.Wh?this.Wh.Ji:null}get Wh(){return this.Hxc}set Wh(a){this.Hxc=a;a=null;this.zBa.instance&&(a=this.zBa.instance.TEh());this.Hxc&&a&&a.qQl(this.Hxc.P9g)}pVa(a){return 1!==a||de.a.instance.Na.Xda?this.Dg&&this.Wh&&this.BW?(a=this.Kf.Qd)&&zb.ParagraphReader.ae(this.Dg)&&this.Wh===this.Dg.sc(this.pia)&&this.BW===this.Dg.sc(a.Ma)?
!0:!1:!1:!0}}Object(n.a)(Ge,"CevViewContentManager",null,[1437]);var Xc=d(1221),jf=d(378);class Mh{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){this.Ve=null;this.tK=a;this.NMd=b;this.nd=c;this.lDd=f;this.gra=l;this.fia=w;this.Mk=H;this.zh=U;this.ds=ja;this.tf=wa;this.SNa=Sa;this.pba=eb;this.cC=ub;this.PV=Ub;this.tqb=cc}NS(a){this.Ve=a}WWd(a,b,c){if(this.SNa.rDj||this.tK.P8b||!b)return!1;if(this.NMd.xuh)return!0;b=this.nd.Wp(D.a.typing);b.properties.$(Xc.a.source,"Composition");a=this.Kxi(a,c);
b.end();return a}Kxi(a,b){this.lDd.correctBadImeState()&&this.gra.epc(D.a.gCl);this.fia.fixupAfterMagnifierDrag();if(this.PV.qhd(a))return!1;this.Mk.Qne=(new Date).getTime();if(1===this.zh.mode){let c;({U3:b,ANb:c}=this.PV.WEh(a,b));if(b)return c}this.ds.isComposing=!0;this.tqb||this.tf.Daa(!0);a.eventName===sa.a.XWd&&this.pba.raiseEvent(jf.a.lIf,a);this.cC.EPa(a);return!1}S0b(a,b,c){this.tqb&&this.Ve&&this.Ve.Ss(!0,!0);return this.WWd(a,b,c)}R0b(a,b,c){this.WWd(a,b,c);return this.ds.isComposing=
!1}}Object(n.a)(Mh,"CompositionEventProcessor",null,[]);class bd{constructor(a,b,c){this.KDd=!1;this.pba=a;this.Ep=b;this.j7=c}get isComposing(){return this.KDd}set isComposing(a){(this.KDd=a)?(this.pba.raiseEvent(jf.a.Lxi),this.Ep.raiseEvent(vd.a.lDj)):(this.pba.raiseEvent(jf.a.Ixi),this.Ep.raiseEvent(vd.a.jDj))}get JFa(){return!this.isComposing&&!this.j7.ueg}}Object(n.a)(bd,"CompositionStateManager",null,[]);var Bc=d(135),Hf=d(91);class Me{constructor(a,b,c){this.QUh=u.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");
this.IBa=this.WAd=this.jOd=this.pAa=this.kAd=null;this.Zqb=a;this.YH=b;this.Tpa=c;this.render();this.Tpa.Tdd&&this.YH.RK(Object(F.a)(this,this.Fdd,"modeSwitched"))}Fdd(){this.Tpa.vvh&&this.cpd(!0);this.ZSf()}get uu(){return this.jOd}get contentWindow(){return Kd.a.pgj(this.Zqb.ownerDocument)}get contentDocument(){return this.Zqb.ownerDocument}get Nza(){return this.Zqb}get Tn(){return this.WAd}get bLh(){return this.IBa}get isValid(){return!0}initialize(a,b){this.pAa=a;this.pAa.cTd=Object(F.a)(this,
this.onBlur,"onBlur");b()}Xlh(){this.uu.style.left="0px";this.uu.style.top="0px"}TSi(){this.pAa&&this.pAa.LTi(this,this.YH)}koa(){}gud(){y.FocusManager.Wr(this.contentWindow)}IEh(){y.FocusManager.OBl(this.Tn)}get xkb(){return!Kd.a.NJj(this.Tn)}set xkb(a){}xVe(a,b,c){this.Tn.setAttribute(Bc.a.ns,a);this.kAd&&(this.kAd.innerText=b);this.qqc(c)}qqc(a){a&&this.Tn.setAttribute(Bc.a.af,a)}cpd(a){if(B.a.Gj||a)a=!this.Tpa.bje&&a,this.Tn.setAttribute("contenteditable",a?"true":"false"),this.Tpa.vvh?(Sys.UI.DomElement.addCssClass(this.Tn,
"WACEditing"),Sys.UI.DomElement.addCssClass(this.Tn,O.AppFrame.oRf),Sys.UI.DomElement.addCssClass(this.Tn,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.Tn,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.Tn,O.AppFrame.oRf),Sys.UI.DomElement.removeCssClass(this.Tn,"EditingSurfaceBody"))}dispose(){this.iDl();this.uu&&(this.uu.parentNode&&this.uu.parentNode.removeChild(this.uu),this.WAd=this.jOd=null)}render(){const a=String.format("{0}_EditingElement",this.Zqb.id),b=String.format("{0}_WrappingDiv",
a);this.jOd=document.createElement("div");this.uu.id=b;this.uu.style.height="0px";this.uu.style.width="0px";this.uu.style.display="none";Pc.App.instance.zZc&&Sys.UI.DomElement.addCssClass(this.uu,"NoPointer");this.WAd=document.createElement("div");this.Tn.id=a;this.Tn.setAttribute("contenteditable",!this.Tpa.bje);this.Tn.setAttribute("spellcheck","false");B.a.ala&&this.contentDocument.execCommand("AutoUrlDetect",!1,!1);this.sal();this.ZSf();Hf.c(this.Tn,!0);Hf.c(this.uu,!0);this.IBa=document.createElement("div");
this.uu.appendChild(this.Tn);this.Zqb.appendChild(this.uu)}ZSf(){if(this.Tn){const a=String.format("{0}_WACEditing_DescribedByElement",this.Zqb.id),b=this.Tpa.T4h;this.Tpa.bje?this.Tn.setAttribute("tabindex","0"):this.Tn.removeAttribute("tabindex");if(!this.QUh){const c=R.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:Bc.a.N5i();this.kAd=Bc.a.jxf(this.uu,this.Tn,a,c);this.xVe(b,c,null)}}}sal(){B.a.Gj?Sys.UI.DomElement.addCssClass(this.Tn,"InternetExplorer"):
B.a.fg?Sys.UI.DomElement.addCssClass(this.Tn,"FireFox"):B.a.Kua&&Sys.UI.DomElement.addCssClass(this.Tn,"Safari");B.a.Pi?Sys.UI.DomElement.addCssClass(this.Tn,"iPad"):Sys.UI.DomElement.addCssClass(this.Tn,"usehover")}iDl(){this.pAa&&(this.pAa.hDl(this,this.YH),this.pAa=null)}onBlur(a){this.pAa.ksg(a);this.pAa.tAf(a)}Jnk(){this.uu.style.width="0px";this.uu.style.height="0px"}sGe(a){a=a.htmlElement;this.uu.parentNode!==a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.uu,a)}GAl(a){if(a&&"DIV"===
a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);za.a.qCa(a);a.appendChild(b);break}}}}Object(n.a)(Me,"ContentEditableDiv",null,[1471,106]);class Tf{create(a,b,c){return new Me(a,b,c)}}Object(n.a)(Tf,"ContentEditableDomFactory",null,[1436]);var Sd=d(76);class lf{constructor(a,b){this.zd=a;lf.$a=b}wZc(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}uRi(a,
b){a=za.a.zv(a);const c=ha.a.UFa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(ha.a.n9(b)||ha.a.T9b(b))?!0:!1}o7d(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.Xb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return ec.peg;if("BR"===a.tagName)return ec.EAf;if(this.$jg(a)&&(u.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),lf.$a.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";
let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.o7d(a.childNodes[l],b,c);return f}J8f(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(w){return ka.ULS.sendTraceTag(51463192,324,15,w.message),c.Xb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(lf.t_c(a))return this.Ocj(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.$jg(a)&&(u.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
lf.$a.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.wZc(a)&&(l+=ec.WNc+ec.A0d);for(let w=0;w<a.childNodes.length;w++){const H=this.J8f(a.childNodes[w],b,c,f);if(0<=H)l+=H;else return a.innerText.length}return l}$jg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}RWj(a){return Sys.UI.DomElement.containsCssClass(a,
Gc.a.jul)}Ocj(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):Sd.AParagraphNode.j_.length}MI(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.Xb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.J8f(a,b,c,f)}q0f(a,b,c,f,l){let w=0;const H=a.ot;for(let U=0;U<H.length;U++){a=H[U];const ja=this.MI(a,f,c,l);if(b<w+ja)return b-=w,c=a.innerText,b>=c.length?0:ha.a.charCodeAt(c,
b);w+=ja}f.bt++;return 0}B9d(a,b,c,f,l,w){if(void 0===a||null===a)return l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,ka.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return ka.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let H=0;if(3===a.nodeType)H=c;else for(var U=0;U<c;U++)H+=this.MI(a.childNodes[U],f,l,w);for(;a!==b;){U=a;a=a.parentNode;
if(!a){ka.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),u.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;break}this.wZc(U)&&(H+=ec.WNc);let ja=0;for(;ja<a.childNodes.length&&a.childNodes[ja]!==U;)H+=
this.MI(a.childNodes[ja],f,l,w),ja++;if(ja===a.childNodes.length)if(3===U.nodeType)H=c;else return l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,ka.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return H}Uig(a){return za.a.s3b(a)}static get instance(){lf.Ka||(lf.Ka=new lf(id.a.instance,u.AFrameworkApplication.fa));return lf.Ka}static t_c(a){return Sys.UI.DomElement.containsCssClass(a,Gc.a.Ylk)||
Sys.UI.DomElement.containsCssClass(a,Gc.a.mUi)||Sys.UI.DomElement.containsCssClass(a,Gc.a.UQi)}}lf.Ka=null;lf.$a=null;Object(n.a)(lf,"ContentEditableViewDomUtils",null,[1430]);class fb{constructor(a,b){this.WCd=null;this.od=a;this.Mk=b}Nud(){return 1<this.X9i()||this.Tbg(this.WCd,this.b2f())}jpc(){const a=this.b2f();this.WCd=a?a.cloneNode(!0):null}X9i(){if(this.od){const a=this.od.om();if(a&&a.childNodes)return a.childNodes.length}return 0}b2f(){if(this.od){const a=this.od.om();if(a)return a.firstChild}return null}Tbg(a,
b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.$yj(a,b)}catch(c){return ka.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}$yj(a,b){if(ha.a.rg(a.nodeName)!==ha.a.rg(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!B.a.fg||a.childNodes.length!==b.childNodes.length-1||"BR"!==ha.a.RB(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&
c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!lf.t_c(a.childNodes[c])||!lf.t_c(b.childNodes[c]))&&this.Tbg(a.childNodes[c],b.childNodes[c]))return!0;return!1}n_i(a,b){if(B.a.TI&&R.a.instance.ga(98)){b.Xb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=za.a.gda(this.WCd,"EOP");const c=za.a.gda(a.firstChild,"EOP");
b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(n.a)(fb,"ContentEditableHtmlStructureUtils",null,[]);class Qb{constructor(){this.JXh=u.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return u.AFrameworkApplication.Ta.mode}get Tdd(){return this.JXh}get vvh(){return this.Tdd?!0:1!==u.AFrameworkApplication.Ta.mode||Pc.App.dAb&&u.AFrameworkApplication.HT}get T4h(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get bje(){return this.Tdd?1===u.AFrameworkApplication.Ta.mode||Pc.App.dAb&&u.AFrameworkApplication.HT:Pc.App.dAb&&u.AFrameworkApplication.HT?!(Pc.App.E_b||Pc.App.Y$b):1===u.AFrameworkApplication.Ta.mode}get Nqd(){return this.Tdd?1===u.AFrameworkApplication.Ta.mode||Pc.App.dAb&&u.AFrameworkApplication.HT:Pc.App.dAb&&u.AFrameworkApplication.HT}}Object(n.a)(Qb,
"ContentEditableModeHelper",null,[1313]);var ac=d(192),Jc=d(36);class pd{static JCi(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return Jc.c(b)}}Object(n.a)(pd,"CommonActivityAggregationMethods",null,[]);var qd=d(1024),sd=d(1036),ze=d(576),Wd=d(289),ye=d(267),Yc=d(93);class Ae{constructor(){this.cTd=this.ksg=this.tAf=this.sOc=this.o1=this.dFe=this.ugb=this.yLb=this.L_a=this.MQd=this.b3e=this.c3e=this.oC=this.n8a=this.lC=this.W2b=this.k1b=this.YZd=this.Plc=this.b3b=this.oDa=this.pDa=
this.rlb=this.R0b=this.YWd=this.S0b=this.Jbb=this.RFa=this.aA=null;this.i7=this.Fxd=this.JAd=this.BKd=this.vDd=this.OMd=this.Azd=!1}LTi(a,b){if(!this.i7){this.i7=!0;var c=ze.a.instance,f=b.pG,l=b.WR,w=b.xlb,H=b.Ly,U=Wd.a.instance,ja=b.Fga,wa=ye.a.instance,Sa=b.mtd,eb=b.jtd;B.a.Pi&&(Ja.EventHandlerManager.instance.oWk(this.MQd),this.Fxd=!0);b.mca(this.o1);this.vVk(a.Tn,f,l,H,w,wa,ja,U,c,Sa,eb)}}hDl(a,b){if(this.i7){var c=ze.a.instance,f=b.pG,l=b.WR,w=b.xlb,H=b.Ly,U=Wd.a.instance,ja=b.Fga,wa=ye.a.instance,
Sa=b.mtd,eb=b.jtd;this.Fxd&&(Ja.EventHandlerManager.instance.kDl(this.MQd),this.Fxd=!1);b.xKa(this.o1);this.eDl(a.Tn,f,l,H,w,wa,ja,U,c,Sa,eb);this.i7=!1}}vVk(a,b,c,f,l,w,H,U,ja,wa,Sa){b.Mp(a);c.Mp(a);f.Mp(a);l.Mp(a);w.Mp(a);Yc.a.addHandler(a,sa.a.paste,this.Plc);Yc.a.addHandler(a,sa.a.cut,this.YZd);Yc.a.addHandler(a,sa.a.copy,this.k1b);!Ae.xUj&&B.a.fg&&(Yc.a.addHandler(a,sa.a.V0d,this.W2b),this.JAd=!0);Yc.a.addHandler(a,sa.a.blur,this.cTd);f.pb(sa.a.click,a,this.lC);2===Pc.App.mode?H.PJ(a,this.sOc,
!0):H.PJ(a,this.sOc);U.pb(a,this.oC);l.pb(sa.a.E6,a,this.c3e);l.pb(sa.a.O1,a,this.b3e);c.pb(sa.a.mouseDown,a,this.ugb,null);c.pb(sa.a.GJ,a,this.dFe,null);b.pb(sa.a.Il,a,this.RFa);b.pb(sa.a.my,a,this.Jbb);b.pb(sa.a.Xf,a,this.aA);b.pb(sa.a.eQa,a,this.aA);f.pb(sa.a.doubleClick,a,this.n8a);Yc.a.addHandler(a,sa.a.scroll,this.L_a);if(B.a.L0e||B.a.fg)Sa.pb(sa.a.kIf,a,this.S0b,this),Sa.pb(sa.a.XWd,a,this.YWd,this),Sa.pb(sa.a.VWd,a,this.R0b,this),this.Azd=!0;Pc.App.lTd&&B.a.sAh||B.a.vo?(wa.pb(sa.a.input,a,
this.rlb,this),this.vDd=!0):B.a.P0e&&(wa.pb(sa.a.c2e,a,this.rlb,this),this.OMd=!0);ja.pb(sa.a.drop,a,this.pDa);B.a.Aua&&(ja.pb(sa.a.o8a,a,this.oDa),ja.pb(sa.a.VQf,a,this.b3b),this.BKd=!0);ja.pb(sa.a.xLb,a,this.yLb)}eDl(a,b,c,f,l,w,H,U,ja,wa,Sa){Yc.a.removeHandler(a,sa.a.paste,this.Plc);Yc.a.removeHandler(a,sa.a.cut,this.YZd);Yc.a.removeHandler(a,sa.a.copy,this.k1b);this.JAd&&(Yc.a.removeHandler(a,sa.a.V0d,this.W2b),this.JAd=!1);Yc.a.removeHandler(a,sa.a.blur,this.cTd);f.yb(sa.a.click,a,this.lC);H.aF(a,
this.sOc);U.yb(a,this.oC);l.yb(sa.a.E6,a,this.c3e);l.yb(sa.a.O1,a,this.b3e);c.yb(sa.a.mouseDown,a,this.ugb);c.yb(sa.a.GJ,a,this.dFe);b.Zq(a);c.Zq(a);f.Zq(a);l.Zq(a);w.Zq(a);b.yb(sa.a.Il,a,this.RFa);b.yb(sa.a.my,a,this.Jbb);b.yb(sa.a.Xf,a,this.aA);b.yb(sa.a.eQa,a,this.aA);f.yb(sa.a.doubleClick,a,this.n8a);Yc.a.removeHandler(a,sa.a.scroll,this.L_a);this.Azd&&(Sa.yb(sa.a.kIf,a,this.S0b),Sa.yb(sa.a.XWd,a,this.YWd),Sa.yb(sa.a.VWd,a,this.R0b),this.Azd=!1);this.OMd&&(wa.yb(sa.a.c2e,a,this.rlb),this.OMd=
!1);this.vDd&&(wa.yb(sa.a.input,a,this.rlb),this.vDd=!1);ja.yb(sa.a.drop,a,this.pDa);this.BKd&&(ja.yb(sa.a.o8a,a,this.oDa),ja.yb(sa.a.VQf,a,this.b3b),this.BKd=!1);ja.yb(sa.a.xLb,a,this.yLb)}static get xUj(){null==Ae.IEd&&(Ae.IEd=u.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return Ae.IEd}}Ae.IEd=null;Object(n.a)(Ae,"ContentEditableSurfaceEventHandlers",null,[]);var hd=d(62),oe=d(120),Xe=d(839),Ke=d(137),me=d(258);class Uf extends sd.a{constructor(a,b,c,f,l,w,H,U,
ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di,Si,rj,sg,Cg){super(sg);this.dDc=null;this.FOc=this.Uvb=this.u2b=this.VU=!1;this.Kf=a;this.Tc=b;this.Nk=c;this.Mt=H.create(this);this.ynb=Ug;this.od=U;this.Tpa=Cg;w.ya(D.a.aPf,Cb.a.application,ac.ActionManager.Ng);w.ya(D.a.bPf,Cb.a.application,ac.ActionManager.Ng);f.execute(sh=>{sh.yKi(D.a.typing,Xc.a.fah);sh.zVe(D.a.typing,Xc.a.source,pd.JCi)});l&&l.execute(sh=>{sh.wPl(Object(F.a)(this,this.lxa,"onZoomChanged"))});this.Ep=wa;this.aqa=
Cc;this.$Kd=ub;this.tK=Sa;this.IK=Ub;this.IK.init(this.Ma);this.s2=cc;this.tf=Fc;this.Mk=eb;this.Ob=ja;this.Ob.init(this.Ma);this.zh=Ud;this.y4a=je;this.Us=Ic;this.IOa=Vd;this.$H=Zf;this.ds=Ve;this.cC=lg;this.SNa=af;this.PV=Tg;this.jQh=ag;this.kQh=ih;this.DRh=Vg;this.iQh=di;this.Hha=Si;this.hQh=rj;this.Hha.J$h(Object(F.a)(this,this.W2g,"onBindEditingDom"));this.Hha.aai(Object(F.a)(this,this.d8g,"onUnbindEditingDom"));this.Hha.r$h(Object(F.a)(this,this.Vdh,"pushViewElementValidationStates"));this.Hha.q$h(Object(F.a)(this,
this.W4g,"onInteractiveViewOnAfterLoadContent"));this.V9e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&B.a.aZc;this.vbf=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&B.a.zT}get Md(){return this.Hf.Md}dispose(){this.Hha.VZk(Object(F.a)(this,this.W2g,"onBindEditingDom"));this.Hha.g_k(Object(F.a)(this,this.d8g,"onUnbindEditingDom"));this.Hha.OZk(Object(F.a)(this,this.Vdh,"pushViewElementValidationStates"));
this.Hha.NZk(Object(F.a)(this,this.W4g,"onInteractiveViewOnAfterLoadContent"));this.iQh.dispose();super.dispose()}lxa(){this.jga=!0}get ownerDocument(){const a=this.od.cEa();return a?a.Tl:null}get container(){return this.GRa}get qXd(){return this.Tn}createElement(a){a=this.ownerDocument.createElement(a);this.od.zg.bLh.appendChild(a);return a}jp(a){a=Hc.a.createElement(this.ownerDocument,a);this.od.zg.bLh.appendChild(a);return a}hCa(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}fHe(){this.Ep.raiseEvent(vd.a.YQi);this.FOc=!0}get GRa(){return this.od.zg?this.od.zg.uu:null}get Tn(){return this.od.om()}get Dzb(){return!0}Nui(){this.s2.nKc()}get m0c(){return this.ds.JFa}get isComposing(){return this.ds.isComposing}iKk(){this.V9e||this.vbf?this.IOa.kch(!0,""):(this.disable(!1,24),this.cpd(!0),B.a.px&&(this.GRa.style.overflow="hidden"),this.GRa.style.width="0px",this.GRa.style.height="0px",this.GRa.style.display="block",this.Ep.raiseEvent(vd.a.LEk),this.s2.nKc(),this.IK.NKa(this.zh.mode,
this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz))}Gvl(){this.V9e||this.vbf?this.IOa.qmh("none"):B.a.px&&this.GRa&&(this.GRa.style.overflow="none")}Ss(a,b=!1){this.$H.Ss(a,b)}YY(){this.Us.YY()}get Wl(){return!0}Lga(a,b){if(1===this.mode&&17!==a.vi){const c=a.currentNode;if(!de.a.instance.Na.jH&&!c.Zzb(de.a.instance.Na.Rr)&&6!==a.role)return!1}return super.Lga(a,b)}get KF(){let a=super.KF;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get wub(){const a=
u.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.m0c?2:this.root&&this.ownerDocument&&this.isActive&&!this.aqa.t9?a||this.m0c?1:2:3}lY(a){return this.kQh.lY(a)}U0(a){return this.jQh.U0(a)}sZd(){return new Xe.a(this.Ma)}kHe(a){!u.AFrameworkApplication.Ug&&0!==this.mode&&this.Hf&&this.Hf.uo&&(this.Z3j(a),this.Tc.yie())}Z3j(a){if(a){var b=a.PA;a=this.k_f(a.Vu,!0);b=this.k_f(b,!1);ka.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}k_f(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",zb.ParagraphReader.ae(a)&&(c+="paraId : "+zb.ParagraphReader.g6b(a)+"; ",c+="hasImage : "+oe.a(a,5)+";"),b&&(b=ob.GraphIterator.nb(a),b.Ze(),c+="inTable : "+hd.TableReader.Cs(b)+";"));return c}BIe(a){!u.AFrameworkApplication.Ug&&1===this.mode&&a&1&&this.Hf&&this.Hf.uo&&this.Tc.lJe()}cpd(a){this.od.e0a(a)}Obb(a,b,c){this.ynb.Obb(a,b,c)}ePc(){this.SNa.ePc()}Xel(){this.$Kd.XUf(de.a.instance.Na)}Djb(){this.IK.Djb(this.mode,this.Ob.Ji,this.Ob.Dg,
this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz)}NKa(){this.IK.NKa(this.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz)}get Dg(){return this.isActive?this.Ob.Dg:null}get mode(){return this.zh.mode}get isActive(){return this.tf.isActive}get yUa(){return this.tf.X5b(this.Ob.Dg)}get lme(){return this.tf.P3f(this.Ob.Dg)}get Hf(){return this.Kf.Qd}get ZJe(){return this.y4a.gJf}get Hya(){return this.SNa.Hya}set Hya(a){this.SNa.Hya=a}get jga(){return this.Us.jga}set jga(a){this.Us.jga=
a}get Wje(){return!0}get dSe(){return 2}get Nqd(){const a=this.Nk.value.isEditingAllowed||this.Nk.value.hz;return this.Tpa.Nqd?a:!0}get FJa(){return this.IOa.FJa}get Vtb(){return this.Mk}get kCl(){return this.cC}get PAi(){return this.ynb}get iDj(){return this.SNa}get CCk(){return this.PV}tbc(a){return me.a.Cqg(a,this)}BKb(a){return me.a.okh(a,this)}Yoc(a){return me.a.Ckh(a,this)}fjc(a){return me.a.wZg(a,this)}Xsb(a){return me.a.pDf(a,this)}cqc(a){return me.a.yph(a,this)}K4b(a){return me.a.RXf(a,this)}NZb(a){return me.a.Fzf(a,
this)}ENj(){switch(this.mode){case 2:if(this.Ob.Dg)return this.FNj(this.Ob.Dg)}return!1}FNj(a){a=Ke.a.nb(this.Ma,a.node);return a.Xq&&a.Ze()?a.jRa.iY(510&~this.KF):!0}W2g(a,b){this.jAf(b.zg)}d8g(){this.od.xCl()}IFj(a,b,c,f){a=this.hQh.create(a,b,this.Tpa);b=new Ae;b.sOc=c;this.DRh.ZGk(b);a.initialize(b,f);return a}jAf(a){this.od.iji(a,this)}disable(a,b){this.zh.Caa(0,a,b)}a1a(){this.zh.a1a()}suspend(){this.aqa.suspend()}resume(){this.aqa.resume()}Vdh(a,b){this.Kf.Qd===b.Hf&&(this.dDc=this.zMa,this.zMa=
new qd.a(0))}RGk(){const a=this.dDc,b=this.zMa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.zMa=a;this.dDc=null}xGf(){this.dDc=null}PYe(a){return 1!==this.mode||a.Hy||this.Hf.Mb.Na.jH?!1:!0}jne(a,b){return this.Hf.Mb&&!this.Hf.Mb.Na.jH&&b?a.Hy!==b.Ime:!0}W4g(a,b){this.Kf.Qd===b.Hf?this.RGk():this.Kf.Qd||this.xGf()}}Object(n.a)(Uf,"ContentEditableView",sd.a,[376,170,106,1435]);class yf{constructor(a,b,c,f,l,w){this.nd=a;this.ag=b;this.lj=c;this.Yo=f;this.Kf=
l;this.sr=w}eig(a){return Sys.UI.DomElement.containsCssClass(a,Gc.a.SIf)}}Object(n.a)(yf,"ContentEditableViewContentControlHelper",null,[1312]);var Cf=d(402),Ld=d(129),od=d(119),ug=d(840);class Kf{constructor(a,b,c,f,l){this.O0b=!1;this.bKe=this.phd=-1;this.yF=a;this.qie=b;this.IIc=c;this.vTa=f;this.pZa=l}}Object(n.a)(Kf,"ActiveContentSpan",null,[]);class Vf{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af){this.tha=this.eSb=null;this.x9=!1;this.Bpf=0;this.Xzd=Vd;this.Kf=a;
this.nd=b;this.ag=c;this.lj=f;this.Tc=l;this.jf=w;this.wK=H;this.zh=U;this.Ob=ja;this.Nk=wa;this.Fpa=Sa;this.tf=eb;this.$d=ub;this.zd=Ub;this.Wi=cc;this.Yo=Fc;this.Dh=Ic;this.tK=Cc;this.od=Ud;this.yD=je;this.HA=af}get dda(){return this.tha||(this.tha=Ab.a.instance.rb("Box4.IFormatPainter"))}jji(a){this.eSb=a}get dzh(){return this.Bpf}cKi(a,b,c){const f=this.Kf.Qd;if(!f)return!1;f.hIe();if(2!==this.zh.mode)return this.nd.Xb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.ag.be++,
!1;if(this.lj&&b)return this.nd.Xb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.ag.bf++,!0;if(3!==a.Wf&&a.uA===Sys.UI.MouseButton.rightButton&&this.zd.fg)return Pc.App.Kb.Qaa.YZi(a.qc.rawEvent),!0;if(!f)return!1;b=f.bka(a);if(3===a.Wf){var l=this.Tc.Na.mb;if(this.jf.ox(l)){var w=l.Ua.node.ng(f.Ma);l=this.HA?this.HA.PQa(l.Ua,!0):l.Ua.Qa;w=P.a.oW(l,w,!!l,!1,!1);w=new Sys.UI.Bounds(w.x-7,w.y,14,w.height);if(Cf.a.Aid(b,w))return Pc.App.Kb.l6(b,3),!0}}if(!c)return!0;this.Wi.SNf(this.zh,
this.Ob);y.FocusManager.UM()&&(y.FocusManager.instance().rf(f.FI),this.tK.setFocus(this.zh.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz));(c=Hf.a(a.Ec))?(this.eSb.Ss(!0),f.H6(a.clientPoint,c,c.gb,f,a.qc.rawEvent.shiftKey,a.a_,a.Wf)):f.H6(b,null,null,f,a.shiftKey,a.a_,a.Wf);this.dda&&this.dda.yL&&this.Fpa.processAction(D.a.Wja,2);this.eSb.Obb(a.shiftKey,b,a.Wf);f.CHe(new ug.a(a));this.zd.TI&&(a=new Le.a(0,1,0,()=>{this.tf.$Ka(!0);this.fixupAfterCursor(5)},
27),this.$d.Db(a));return!0}f1e(a,b=!1){if(2===this.zh.mode&&this.Ob.Wh){var c=this.od.zg.uu;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.zd.eme){c=this.Tc.Na.mb;var f=!!this.wK&&this.wK.gab();this.lj&&a?(this.nd.Xb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.ag.bm++):(this.Zal(b||f,this.Ob.Wh.ot,this.Tc.Na.mb.Ua),f&&this.wK.y1e(c))}}}Zal(a,b,c){let f=0,l=0;c=c.Qa;let w=!1;for(let H=0;H<b.length;H++){const U=b[H],ja=this.Yo.MI(U,this.ag,this.nd,
this.lj);if(Sys.UI.DomElement.containsCssClass(U,da.a.kW))f+=ja;else if(w||(this.Bpf=f,w=!0),Sys.UI.DomElement.containsCssClass(U,Gc.a.rN))c--,f+=ja,l++;else{if(c<=ja){a||this.Wi.eT(f+c,this.Ob.Wh);this.Pod(b,H,f,l,c);break}c-=ja;f+=ja;l+=ja}}}fixupAfterCursor(){if(2===this.zh.mode){var a=this.Wi.F8(this.zh.mode,this.Ob.Ji),b=0,c=0,f=this.Ob.Wh.ot,l;for(l=0;l<f.length;l++){const w=this.Yo.MI(f[l],this.ag,this.nd,this.lj);let H,U,ja;({c4:H,Xka:ja,lzb:U}=this.isi(f,l));if(a<=w&&this.B_i(f,l,a,H,ja,
b,c,U))return;a-=w;b+=w;H?c++:U||(c+=w)}this.nd.Xb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.ag.bq++}}B_i(a,b,c,f,l,w,H,U){const ja=a[b],wa=this.Yo.MI(ja,this.ag,this.nd,this.lj);if(f||this.lj&&l)if(l||!this.x9&&c!==wa){if(this.ag.bo++,this.Wi.eT(w,this.Ob.Wh),c=this.Yo.MI(a[b-1],this.ag,this.nd,this.lj),this.Pod(a,b-1,w-c,H-c,c),l)return!0}else this.ag.bn++,this.Wi.eT(w+wa,this.Ob.Wh),this.Pod(a,b+1,w+wa,H+1,0);else if(!U)return ha.a.rx(za.a.zv(ja),c)&&(this.ag.bp++,
this.Wi.eT(w+c+(this.x9?1:-1),this.Ob.Wh)),this.Pod(a,b,w,H,c),!0;return!1}isi(a,b){let c,f;c=Sys.UI.DomElement.containsCssClass(a[b],Gc.a.rN);f=Sys.UI.DomElement.containsCssClass(a[b],da.a.kW);a=Sys.UI.DomElement.containsCssClass(a[b],Gc.a.FN);return{c4:c,Xka:a,lzb:f}}Pod(a,b,c,f,l){const w=this.Ob.BW,H=a[b];Sys.UI.DomElement.containsCssClass(H,Gc.a.FN)&&(ka.ULS.shipAssertTag(4318915,315,!1),this.nd.Xb(Ld.a.R1,{["Reason"]:od.a.GTf}));Sys.UI.DomElement.containsCssClass(H,Gc.a.rN)&&(ka.ULS.shipAssertTag(4318916,
315,!1),this.nd.Xb(Ld.a.R1,{["Reason"]:od.a.nAf}));a=this.dGi(a,b,c,f,l,w);b=a.length!==this.Dh.Gi.length;for(c=0;!b&&c<this.Dh.Gi.length;)this.Dh.Gi[c].yF!==a[c].yF&&(b=!0),this.Dh.Gi[c].pZa!==a[c].pZa&&(b=!0),c++;b&&(this.eSb.yUa&&this.eSb.Ss(!0),this.Dh.Gi=a)}dGi(a,b,c,f,l,w){const H=a[b];var U=this.Yo.MI(H,this.ag,this.nd,this.lj);const ja=[];let wa=null;b<a.length-1&&l===U&&(wa=a[b+1]);var Sa=null;0<b&&!l&&(Sa=a[b-1]);a=this.Xzd.Be(H,da.a.VFa);a=w.ot[a];Array.add(ja,new Kf(H,a,c,f,U-(this.yD.w7?
1:0)));!wa||Sys.UI.DomElement.containsCssClass(wa,Gc.a.FN)||Sys.UI.DomElement.containsCssClass(wa,Gc.a.rN)?!Sa||Sys.UI.DomElement.containsCssClass(Sa,Gc.a.FN)||Sys.UI.DomElement.containsCssClass(Sa,Gc.a.rN)||Sys.UI.DomElement.containsCssClass(Sa,da.a.kW)||(a=this.Xzd.Be(Sa,da.a.VFa),a=w.ot[a],U=this.Yo.MI(Sa,this.ag,this.nd,this.lj),Array.insert(ja,0,new Kf(Sa,a,c-U,f-U,U))):(a=this.Xzd.Be(wa,da.a.VFa),a=w.ot[a],Sa=this.Yo.MI(wa,this.ag,this.nd,this.lj),Array.add(ja,new Kf(wa,a,c+U,f+U,Sa)));return ja}}
Object(n.a)(Vf,"ContentEditableViewCursorManager",null,[1434]);class Ch{}Object(n.a)(Ch,"ContentEditableViewDebugLogger",null,[]);class xg{constructor(a,b,c,f,l,w,H){this.yqa=a;this.cC=b;this.Dh=c;this.Fyc=f;this.ag=l;this.pba=w;this.zh=H}dispose(){this.yqa.jGf();this.cC.dispose();this.Dh.WFf();this.Fyc.zod();Lc.a.instance.X2j(this.ag);this.pba.raiseEvent(jf.a.s4j);this.zh.dispose()}}Object(n.a)(xg,"ContentEditableViewDisposer",null,[]);class lh{constructor(){this.SNc=!0}Obb(a,b,c){a&&(this.SNc=!1,
Pc.App.Kb.l6(b,c))}}Object(n.a)(lh,"ContentEditableViewFloatieHandler",null,[1433]);var Oi=d(1115),ph=d(145);class Dh{constructor(a,b,c,f,l,w,H){this.Ahf=0;this.m_c=this.P8b=this.cee=this.gee=!1;this.od=a;this.Kf=b;this.wK=c;this.lj=f;this.Nn=l;this.zyd=w;this.Od=H}Dji(){this.lj&&!this.P8b&&100<(new Date).getTime()-this.Ahf&&(ph.GrippersManager.instance.n8b=!0,this.m_c=!1)}setFocus(a,b,c,f,l){const w=this.Kf.Qd;this.Ahf=(new Date).getTime();this.wK&&this.wK.gab()||(1===a?this.Ubl(l):this.lj&&!this.Nn.iee&&
Ja.EventHandlerManager.instance.RTf!==sa.a.click||!this.od.zg.xkb||(l=new Oi.a(w),this.od.zg.gud(),this.lj&&(this.P8b=!0,this.od.om().blur(),this.P8b=!1),this.od.zg.IEh(),c&&f&&""!==b.innerText&&b.focus(),this.zyd.q9&&(this.m_c=!0),l&&l.dispose(),this.zyd.Gj&&0!==a&&(this.od.zg.xkb=!1)))}Ubl(a){if(!this.lj||a){a=null;B.a.Gj&&(a=new Oi.a(this.Kf.Qd));this.od.zg.xkb&&(this.od.zg.gud(),this.od.zg.IEh(),B.a.Gj&&(this.od.zg.xkb=!1),this.zyd.q9&&this.Nn.iee&&(this.m_c=!0));var b=this.od.om();this.od.zg.xkb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}ZSi(a){2!==a&&1!==a||this.od.zg.gud()}rke(){const a=this.Od.Ae;return!!a&&this.Kf.Qd.FI===a.name}}Object(n.a)(Dh,"ContentEditableViewFocusHelper",null,[1432]);class mh{constructor(a,b,c){this.z8b=a;this.$hb=b;this.Rra=c}}Object(n.a)(mh,"GraphUpdateState",null,[]);var Od=d(53),Ue=d(108);class yh{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di){this.Ve=this.KRb=null;this.Bk=
Vg;this.sr=ih;this.lha=a;this.zh=b;this.nd=c;this.Tc=f;this.wK=l;this.jf=w;this.tf=H;this.AK=U;this.Ob=ja;this.Mk=wa;this.yD=Sa;this.Dh=eb;this.od=ub;this.xV=Ub;this.eS=cc;this.aqa=Fc;this.tZ=Ic;this.fia=Ud;this.Wi=je;this.y4a=Vd;this.Us=Ve;this.ag=af;this.j7=Zf;this.$d=lg;this.zd=Tg;this.Eha=Ug;this.ENh=ag;this.gh=Cc;this.Oz=di}NS(a){this.Ve=a}get HVc(){const a=this.tZ.sta(this.xV.x9);return a?a.Ua.Qa:0}get iki(){return this.HVc}Ss(a,b=!1){ka.ULS.shipAssertTag(18437283,315,!!this.gh);if(this.Ve.yUa||
this.Ve.lme)if(this.Ve.kCl.typingProcess(),this.Ve.isActive&&2===this.zh.mode&&(this.Ve.yUa||this.Ve.lme)){var c=this.nd.Wp(D.a.Ss);this.lha.hG(()=>{this.uFl(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}fcl(a,b=!1){const c=this.jf.Iz;this.Tc.setSelection(a,void 0,void 0,b);this.jf.Iz=c}uFl(a,b=!1){Ue.c(36226527,306,100,"UpdateGraphInternalCalled");this.tf.b3k();if(this.Ob.Wh){a=new mh(!1,a,!1);a.$hb&&this.aqa.suspend();this.fia.fixupAfterMagnifierDrag();var c=this.AK.TSa();c.set(this.Ob.Dg.node);
var f=this.Bk.oe(b?12:15,D.a.Ss);f.jd=this.Mk.X2?D.a.gCa:D.a.typing;f.Iy(c);this.yD.dkl(a.$hb,this.Ve.m0c,this.Dh)&&(this.ag.v++,this.yD.akb(!1,this.Ob.Ji,this.Dh));var l=!!this.wK&&this.wK.gab(),w=l?de.a.instance.Na.mb:this.Vti();this.RFk(a);this.rGl();this.rerenderWhenNeeded(b,a,c);l||this.M_i(b,w);this.Dh.WFf();f.dispose();this.iul(a);this.Us.jga&&(this.Us.YY(),this.Us.jga=!1);a.$hb&&this.aqa.resume();this.Mk.n1();Ue.c(18437313,306,100,"UpdateGraphInternalExited")}else ka.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}iul(a){a.z8b||this.xV.f1e(this.Mk.Oda,a.Rra)}rerenderWhenNeeded(a,b,c){!b.z8b||this.Mk.pog()||a||(this.zh.Caa(0,!0,5),b.$hb&&(this.aqa.resume(),b.$hb=!1),this.q9b(c.currentNode))}Vti(){this.Wi.updateCaretPosition(this.zh.mode,this.Ob.Ji);this.y4a.I5e();this.eS.n_i(this.od.om(),this.nd);return this.tZ.sta(this.xV.x9)}M_i(a,b){const c=this.sr.textLength(b.Ua.node);b.Ua.Qa>c&&(b=Od.SelectionFactory.Sg(b.Ua.node,c));this.fcl(b,a);
a=!!this.wK&&this.wK.zzb(b);this.Mk.pog()&&!a&&this.Wi.eT(this.Wi.sVa,this.Ob.Wh)}q9b(a){R.a.instance.ga(70)&&Pc.App.XR.q9b(a)}rGl(){if(R.a.instance.ga(2)){const a=Pa.OutlineElementNavigator.WA(this.Ve.Dg);a&&rb.ListReader.KUa(a)}}B_d(){if(this.Ve.yUa||this.Ve.lme)this.KRb?this.$d.Y5(this.KRb,yh.TNf):(this.KRb=new Le.a(0,1,yh.TNf,Object(F.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.$d.Db(this.KRb))}delayUpdateGraphCallback(){this.KRb=null;this.Ob.pVa(this.zh.mode)&&
this.Ss(!0)}jZk(){let a;if(this.Mk.X2){var b=this.HVc;a=this.Mk.GLc}else if(this.Mk.ssa)b=this.HVc,a=b+(this.Mk.gtd-za.a.zv(this.Ob.eRa).length);else return;if(b===a)this.nd.Xb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{ka.ULS.shipAssertTag(18437315,315,b<=a);var c=this.sr.text(this.Ve.Dg),f="";this.sr.JSa(this.Ve.Dg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=ec.SHb;this.Kui(this.Ve.Dg);b=Id.a.createTextRange(this.Ve.Dg,
b,a);this.gh.replaceTextRange(b,f,void 0,void 0,D.a.NSd)}}Kui(a){R.a.instance.ga(70)&&this.Oz.kKc(a)}RFk(a){let b=!0;if(this.j7.ueg)this.j7.mSi();else{const c=1<this.od.om().childNodes.length;a.z8b=this.eS.Nud();if(a.z8b||this.Mk.ssa||this.Mk.X2){a.z8b&&this.ag.w++;c&&(this.nd.Xb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.ag.x++,b=!1);if(this.Mk.X2||this.Mk.ssa)this.jZk(),this.eS.jpc(),b=!1;a.$hb&&(this.nd.Xb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.ag.z++,this.aqa.resume(),a.$hb=!1);this.Dh.Uti(this.Ob.Wh)}}a.Rra=!0;b&&(a.Rra=this.ENh.QFk(this.Ob.Dg,this.Ob.Ji,this.Ob.Wh,this.gh,this.Eha.instance))}}yh.TNf=250;Object(n.a)(yh,"ContentEditableViewGraphUpdater",null,[]);var Hj=d(650),fe=d(59);class Zh{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih){this.Ve=null;this.Fpg=0;this.Hif=!1;this.Pa=a;this.zh=b;this.Ob=c;this.Kf=f;this.od=l;this.hha=w;this.Us=H;this.yD=ja;this.zd=wa;this.ag=Sa;this.sr=eb;
this.Dh=ub;this.eS=Ub;this.PMd=cc;this.yqa=Fc;this.tK=Ic;this.y4a=Cc;this.Tc=Ud;this.lj=je;this.IK=Vd;this.Nk=Ve;this.Mk=af;this.Ep=Zf;this.AK=lg;this.kPa=Tg;this.Tba=Ug;this.hd=ag;this.wVh=ih}NS(a){this.Ve=a}Wrk(a){this.Pa.raiseEvent(xe.eventId,new xe(a.TM,this.Ve.VU),this.Ve);if(1===this.zh.mode)return this.Xrk(a);if(0===this.zh.mode||!this.$El(a))return!1;this.yD.kGf();if(this.ZEl())return!0;this.I_i();this.yqa.pzh(this.Ob.Wh);this.G_i();!this.Hif&&this.Ob.Wh&&0<this.Ob.Wh.Esd&&(this.Hif=!0,u.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));
this.hd&&this.hd.isFeatureEnabled(84)&&this.vkh(this.Ob.Wh);this.y4a.I5e();this.wVh||this.Tba.Vkd(Object.assign(new Hj.a,{LYe:!0}));this.hd&&this.hd.isFeatureEnabled(84)||this.vkh(this.Ob.Wh);return!0}vkh(a){a&&a.Esd&&(this.kPa?this.kPa.EPl(a,!0):ka.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}$El(a){if(!this.Ob.Dg)return!1;this.Ob.Wh=this.Ob.Dg.sc(this.Ve.Ma);this.Ob.Wh||ka.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Ob.BW=this.Ob.Dg.sc(this.Kf.Qd.Ma);
if(!this.Ob.BW)return!1;this.od.zg.sGe(this.Ob.BW);const b=this.od.om(),c=this.Ob.eRa;(b?b.firstChild:null)!==c&&c&&(za.a.Cu(b),b.appendChild(c));if(!a.TM&&!this.Ve.FOc){this.Ve.VU&&this.hha.f1e(this.Mk.Oda);this.Ve.VU=!1;if(this.Us.jga||!a.xJa)this.Us.YY(),this.Us.jga=!1;return!1}this.Ve.FOc&&(this.Ve.FOc=!1,this.Ve.Uvb=!0);return!0}G_i(){this.Us.YY();if(this.Ve.Uvb){this.tK.setFocus(this.zh.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz);if(this.zd.fg){const a=
this.od.om(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.ag.bv++,a.removeChild(b))}this.Ve.Uvb=!1}this.hha.f1e(this.Mk.Oda)}I_i(){if(this.zd.fg){var a=this.od.om();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.ag.bu++,a.removeChild(b))}this.zd.SNb||(a=this.AK.Mc(this.Ob.Dg),this.sr.isEmpty(a)&&!this.sr.bke(a)&&this.yD.akb(!0,this.Ob.Ji,this.Dh));this.PMd.value.D0b(this.od.om(),this.od.contentWindow);this.eS.jpc()}ZEl(){var a=this.Ob.BW;const b=this.od.om().style;if(this.Ve.Uvb){if(!a)return!0;
a=this.Ob.Wh.htmlElement;this.Us.Xvh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Ob.Lca=this.tSj();return!1}tSj(){return fe.OutlineElementReader.um(Pa.OutlineElementNavigator.WA(this.Ob.Dg.node))}Xt(a){return Jf.a.Xt(a)}Xrk(a){if(!this.Tc.Na||!this.Tc.Na.mb)return ka.ULS.sendTraceTag(19711041,324,15,"Attempt to validate selection with empty selection."),!1;if(!this.Ve.VU&&(!a.TM||Pc.App.Xie&&a.xJa))return this.Us.jga&&(this.Us.TAh(this.Ve.Ma),this.Us.jga=
!1),!1;this.Ve.VU=!1;a=(new Date).getTime();const b=this.Tc.hpa;!this.lj&&!b.qle&&!b.dne&&250<a-this.Fpg?this.PNf(null):(this.Ep.raiseEvent(vd.a.$pk),b.sdl(Object(F.a)(this,this.PNf,"delayOnAfterValidateSelection")));return!0}PNf(){1===this.zh.mode&&(this.Tc.Na.Xda&&this.Ob.Dg&&(this.Ob.Wh=this.Ob.Dg.sc(this.Ve.Ma),this.Ob.Wh||ka.ULS.sendTraceTag(18437327,324,15,"current editing view element is set to null!"),this.Ob.BW=this.Ob.Dg.sc(this.Kf.Qd.Ma)),this.Tc.Na.Xda&&this.od.om().firstChild!==this.Ob.eRa&&
this.Ob.eRa&&(za.a.Cu(this.od.om()),this.od.om().appendChild(this.Ob.eRa)),this.od.om().firstChild&&(this.Tc.Na.Xda?this.od.om().style.direction=this.Xt(this.od.om().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.od.om().firstChild,"Rtl")?this.od.om().style.direction="rtl":this.od.om().style.direction="ltr",this.Tc.Na.Xda&&this.yqa.pzh(this.Ob.Wh),this.Us.TAh(this.Ve.Ma),this.IK.Djb(this.zh.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz)),this.Fpg=
(new Date).getTime(),this.Ep.raiseEvent(vd.a.WZi))}U0(a){const b=this.Wrk(a);this.Ep.raiseEvent(!a.TM||Pc.App.Xie&&a.xJa?vd.a.wHc:vd.a.O9g);return b}}Object(n.a)(Zh,"ContentEditableViewOnAfterValidateHandler",null,[]);class Pi{constructor(a,b,c,f,l){this.Ve=null;this.Us=a;this.ds=c;this.od=f;this.Ep=l}NS(a){this.Ve=a}lY(a){const b=this.Ve.wub;let c=3===b;c||2!==b||(this.Ve.root.Ode(510),c=!0,this.Us.YY());if(c)return a.cancel=!0,!1;this.Ep.TOk(a);return!1}}Object(n.a)(Pi,"ContentEditableViewOnBeforeValidateHandler",
null,[]);class Zj{constructor(a,b,c,f,l){this.w7=!1;this.PAa=null;this.Ep=a;this.nd=b;this.ag=c;this.od=f;this.Tmf=l}kGf(){this.w7=!1}akb(a,b,c){const f=this.od.cEa();a&&(this.w7=za.a.zv(b)!==da.a.WOc);if(a&&!this.w7){for(b=this.od.om();b.firstChild;)b=b.firstChild,this.Tmf&&Sys.UI.DomElement.containsCssClass(b,Gc.a.TLa)&&Sys.UI.DomElement.addCssClass(b,Gc.a.eKe);3!==b.nodeType?(this.PAa=f.Tl.createTextNode(ec.SHb),b.appendChild(this.PAa)):(this.PAa=b,this.PAa.nodeValue=ec.SHb);this.w7=!0;this.Ep.ffh(!0)}if(!a&&
this.w7){a=this.PAa;b=null;try{b=this.PAa.parentNode,b||""!==a.nodeValue||(this.PAa=null)}catch(l){this.ag.i++,this.PAa=null}this.PAa&&b!==f||(this.nd.Xb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.ag.j++,c.Gi.length&&(a=this.KWf(c.Gi[c.Gi.length-1].yF)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(ec.SHb))){if(this.Tmf)for(c=a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,Gc.a.eKe)){Sys.UI.DomElement.removeCssClass(c,Gc.a.eKe);
break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.w7=!1;this.Ep.ffh(!1)}}dkl(a,b,c){return!this.w7||a||(B.a.RF&&!B.a.Vj||B.a.NF)&&!b?!1:c.rsf()}KWf(a){if(a.className===Gc.a.FN)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.KWf(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&(b=a.nodeValue,b.endsWith(" ")||b.endsWith(ec.SHb)))return a;return null}}Object(n.a)(Zj,"ContentEditableViewPaddingManager",null,[1428]);class Wg{constructor(a){this.G_d=
this.d2e=this.ssa=this.X2=!1;this.U1c=this.gtd=this.GLc=-1;this.PDd=!1;this.Qne=0;this.Fpa=a}get Oda(){return this.PDd}set Oda(a){a!==this.PDd&&this.Fpa.processAction(a?D.a.aPf:D.a.bPf,2);this.PDd=a}pog(){return this.d2e||this.ssa||this.X2}n1(){this.G_d=this.d2e=this.ssa=this.X2=!1;this.U1c=this.gtd=this.GLc=-1}}Object(n.a)(Wg,"ContentEditableViewTypingState",null,[]);class $h{constructor(a,b,c,f,l,w,H){this.Wi=a;this.ag=b;this.nd=c;this.Yo=f;this.tf=l;this.Ob=w;this.lj=H}sta(a){if(!this.Ob.Wh||1===
this.tf.mode&&!this.Xda())return null;const b=this.Wi.F8(this.tf.mode,this.Ob.Ji);let c=b,f=0;const l=this.Ob.Wh.ot;let w,H=!1;for(w=0;w<l.length;w++){var U=l[w];if(!this.Yo.Uig(U)){H=!0;continue}const ja=this.Yo.MI(U,this.ag,this.nd,this.lj),wa=Sys.UI.DomElement.containsCssClass(U,Gc.a.rN);U=Sys.UI.DomElement.containsCssClass(U,da.a.kW);if(c<=ja)return wa?c=a||c===ja?1:0:U&&(c=0),this.Sg(this.Ob.Dg,f,c);c-=ja;wa?f++:U||(f+=ja)}return H?this.Sg(this.Ob.Dg,0,b):this.Sg(this.Ob.Dg,0,0)}Sg(a,b,c){return Od.SelectionFactory.Sg(a,
b+c)}Xda(){return de.a.instance.Na.Xda}}Object(n.a)($h,"CurrentEditSelectionProvider",null,[1425]);class Fe{constructor(a,b,c){this.oQb=[];this.jGc=null;this.nd=a;this.CS=b;this.PMd=c}get Gi(){return this.oQb}set Gi(a){this.oQb=a}rsf(){return this.oQb.length?1<this.oQb.length||1<this.oQb[0].yF.innerText.length:!1}MXf(a,b,c){const f=T.a.Be(a,da.a.VFa),l=b?a.firstChild:a.lastChild;let w=null;b&&0<f?w=c.ot[f-1]:!b&&f<c.ot.length&&(w=c.ot[f+1]);if(w)for(this.nd.Xb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),
this.CS.u++,a.removeChild(l),b?w.appendChild(l):w.insertBefore(l,w.firstChild),a=0;a<this.Gi.length;a++);}Uti(a){for(let b=0;b<this.Gi.length;b++){const c=this.Gi[b].yF;B.a.RF&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.MXf(c,!0,a):3===c.lastChild.nodeType&&this.MXf(c,!1,a));za.a.Nx(c,c.innerText)}}Opk(a){for(let b=0;b<this.Gi.length;b++)this.PMd.D0b(this.Gi[b].yF,a)}UXk(){for(let a=0;a<this.Gi.length;++a){const b=this.Gi[a].yF;if(Sys.UI.DomElement.containsCssClass(b,Gc.a.FMc)||
Sys.UI.DomElement.containsCssClass(b,Gc.a.DMc)||Sys.UI.DomElement.containsCssClass(b,Gc.a.CMc)||Sys.UI.DomElement.containsCssClass(b,Gc.a.EMc)){const c=this.Gi[a].pZa;c&&c!==b.innerText.length&&(b.className=Gc.a.Y1b)}}}vlk(a,b){for(let c=0;c<this.Gi.length;c++){const f=this.Gi[c],l=a<=f.vTa,w=f.vTa+f.pZa,H=w<=b;f.phd=l?f.vTa:a;f.bKe=H?w:b;l&&H&&(f.O0b=!0)}}WFf(){Array.clear(this.Gi)}}Object(n.a)(Fe,"CurrentlyActiveContentSpans",null,[1427]);class Ph{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,
Fc,Ic,Cc,Ud){this.Zzd=!1;this.jf=a;this.Tc=b;this.nd=c;this.tf=f;this.Ep=l;this.Kf=w;this.Dh=H;this.Ob=U;this.zd=ja;this.IK=wa;this.Nk=Sa;this.$za=eb;this.UQb=ub;this.ZQh=Ub;this.jk=cc;this.od=Fc;this.Ca=Cc;this.fd=Ud;this.MUh=Ic.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.RTb=Ic.ka("PasteKeepSourceFontSizeFixIsEnabled");this.iVh=(this.b_h=Ic.ka("ProtectInClient"))||Ic.ka("ProtectedFile");this.XUh=Ic.ka("EnableExtractForProtectedFile");this.wTb=Ic?Ic.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.eUb=Ic?Ic.ka("TextLayoutServiceUseResponse"):!1;this.Anf=this.znf=!1}get XZ(){return this.$za.instance}get Bbb(){return this.fd.hg&&this.fd.Yy}T$f(a,b,c,f){this.$Jk(a,b,c,f)}$Jk(a,b,c,f){this.iVh&&!this.XUh?a.preventDefault():!b||this.Nk.value.isEditingAllowed||this.Nk.value.hz&&this.Bbb?1!==this.tf.mode||this.Zzd||!c||f||(this.XZ?b&&!this.jf.pZc(this.Tc.Qj)?(ka.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.ZZd}),this.UQb.show(),a.preventDefault()):
(this.Tc.hpa.g5d(),this.Zzd=!0,b&&this.Ep.raiseEvent(vd.a.iKi),B.a.zua&&a.rawEvent&&a.rawEvent.currentTarget&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),this.wTb&&this.jk.smd(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.zd.Vj&&this.MUh&&this.v_i(a),this.RTb&&(this.znf=this.r_i(a)),this.eUb&&(this.Anf=this.GYk(a)),a=this.ZQh.create(null,Object(F.a)(this,this.sOi,"dispatchCutCopy"),b),a.Pl("Browser "+(b?"Cut":"Copied")),a.run()):
(ka.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.ope(b?D.a.cut:D.a.copy),a.preventDefault())):a.preventDefault()}v_i(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.w5i();({OMc:c}=this.jk.nAl(c));c&&(a.preventDefault(),b.setData("text/html",Fb.c(c)),b.setData("text/plain",c.innerText))}}r_i(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=
this.jk.rZa(c),this.jk.M_b(a,this.Kf.Qd.Md,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.jk.M_b(a.rawEvent.currentTarget,this.Kf.Qd.Md,!0)}GYk(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();a=c&&0<c.length?this.jk.rZa(c):a.rawEvent.currentTarget;if(this.jk.hvd(a,!1))return b.setData("text/html",Fb.c(a)),b.setData("text/plain",a.innerText),!0}return!1}w5i(){if(this.zd.hV){const a=this.od.cEa();if(a&&a.Tl)return a.Tl.getSelection()}return null}sOi(a,
b){this.Zzd=!1;if(this.Kf.Qd.uo&&1!==u.AFrameworkApplication.Aa.state){if(b){if(this.zd.fg){for(b=0;b<this.Dh.Gi.length;b++){const c=this.Dh.Gi[b].yF,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.IK.NKa(this.tf.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz)}this.XZ.jki(a)}else this.XZ.hki(a);B.a.zua&&this.wTb&&this.Kf&&this.jk.smd(this.Kf.Qd.zg.Tn,"data-srcurl","data-src");this.RTb&&this.znf&&this.Kf&&this.Kf.Qd&&this.jk.M_b(this.Kf.Qd.zg.Tn,
this.Kf.Qd.Md,!1);this.eUb&&this.Anf&&this.Kf&&this.Kf.Qd&&this.jk.hvd(this.Kf.Qd.zg.Tn,!0)}}}Object(n.a)(Ph,"CutCopyHandler",null,[1426]);class rg{constructor(a,b,c,f,l,w,H,U){this.zd=a;this.zh=b;this.ds=c;this.nd=f;this.tf=l;this.Iha=w;this.Us=H;this.tqb=U}W2b(a,b){this.zd.fg&&2===this.zh.mode&&b&&this.ds.isComposing&&(a=this.nd.Wp(D.a.typing),a.properties.$(Xc.a.source,"DomChange"),this.QPi(),a.end())}QPi(){this.tqb||this.tf.Daa(!0);this.Iha.qGb();this.Us.YY()}}Object(n.a)(rg,"DomChangeEventProcessor",
null,[]);class zg{constructor(a,b,c,f){this.Wi=a;this.zh=b;this.Ob=c;this.Kf=f}Wgb(a,b){if(!b)return!1;this.Wi.SNf(this.zh,this.Ob);return this.Kf.Qd?this.Kf.Qd.Wgb(a):!1}}Object(n.a)(zg,"DoubleClickProcessor",null,[]);class lj{constructor(a,b,c){this.zd=a;this.$nb=b;this.YAd=c}oDa(){this.$nb.R7a=!0;return!1}b3b(){return this.$nb.R7a=!1}pDa(a){this.$nb.R7a=!1;this.YAd.cancelEventAndRestoreEditingSurface(a.qc);return!0}}Object(n.a)(lj,"DragEventsProcessor",null,[]);class pg{constructor(a){this.jbf=
0;this.Uzd=!1;this.zd=a}get R7a(){return this.Uzd}set R7a(a){this.Uzd=a;window.clearTimeout(this.jbf);this.Uzd&&(this.jbf=window.setTimeout(Object(F.a)(this,this.Lrk,"onAfterDragInactivity"),1E3))}Lrk(){this.R7a=!1}}Object(n.a)(pg,"DragStateManager",null,[]);class Nh extends $a{constructor(){super();this.y0g=this.urk=0}}Object(n.a)(Nh,"SetModeEditEventArgs",$a,[]);class Ha extends $a{constructor(){super();this.updates=null;this.wza=new Ka.a}}Object(n.a)(Ha,"BeforeValidateEditEventArgs",$a,[]);class kb{constructor(){this.W8k=
this.RPi=null}}Object(n.a)(kb,"EditStateFactoryManager",null,[]);class Hb extends $a{constructor(){super();this.charCode=0;this.DRj=this.isComposing=!1}}Object(n.a)(Hb,"KeyDownEditEventArgs",$a,[]);class ic extends $a{constructor(){super();this.charCode=0;this.isComposing=!1}}Object(n.a)(ic,"KeyPressEditEventArgs",$a,[]);class Qc extends $a{constructor(){super();this.Bzj=!1}}Object(n.a)(Qc,"PaddingChangedEventArgs",$a,[]);class Jd{constructor(a){this.Pa=new vc.a;this.X2a=Object.assign(new kb,{RPi:()=>
a.om(),W8k:()=>Kd.a.aEa(a.contentWindow)})}addHandler(a,b){this.Pa.addHandler(a,b)}removeHandler(a,b){this.Pa.removeHandler(a,b)}raiseEvent(a){this.Pa.raiseEvent(a,Object.assign(new $a,{q8a:this.X2a}))}GQk(a,b){0===a&&0===b||this.Pa.raiseEvent(vd.a.gdl,Object.assign(new Nh,{urk:a,y0g:b,q8a:this.X2a}))}TOk(a){this.Pa.raiseEvent(vd.a.Lii,Object.assign(new Ha,{q8a:this.X2a,updates:a.updates,wza:a.wza}))}gfh(a){a.q8a=this.X2a;this.Pa.raiseEvent(vd.a.O9g,a)}GPe(a,b){this.Pa.raiseEvent(vd.a.my,Object.assign(new ic,
{charCode:a.qc.charCode,isComposing:b,q8a:this.X2a}))}KPk(a,b,c){this.Pa.raiseEvent(vd.a.Xf,Object.assign(new Hb,{charCode:a.qc.charCode,isComposing:b,DRj:c,q8a:this.X2a}))}ffh(a){this.Pa.raiseEvent(vd.a.ECk,Object.assign(new Qc,{q8a:this.X2a,Bzj:a}))}}Object(n.a)(Jd,"EditStateEventManager",null,[1424]);class yd{constructor(a){this.PEd=this.Yzc=!1;this.Zhf=null;this.D$e=0;this.bXc=!1;this.Pa=a;this.rbf=0;this.RFd=2}get mode(){return this.rbf}Ujb(a,b){0===a?(0===b&&(b=1),this.Zhf=(new Date).toISOString(),
this.RFd=b):this.RFd=0;this.rbf=a}get T1c(){return this.RFd}get m_j(){return this.Zhf}get isActive(){return 0!==this.mode}get QAi(){return this.D$e}$Ka(a){this.PEd=a}X5b(a){return this.isActive&&!!a&&this.Yzc}Daa(a){!this.Yzc&&a&&this.Pa.raiseEvent(ef.NAi);this.Yzc=a;this.Aqk(a);a&&(this.D$e=(new Date).getTime())}P3f(a){return this.isActive&&!!a&&this.PEd}Aqk(a){a&&ph.GrippersManager.instance.setVisibility(!1)}b3k(){this.PEd=this.Yzc=!1}}Object(n.a)(yd,"EditViewStateManager",null,[1423]);var He=d(915);
class sf{constructor(a,b,c,f,l,w){this.od=a;this.yD=b;this.Ep=c;this.IK=f;this.$a=l;this.Kf=w;this.$a&&(this.$a.ka("WordEditorImageOverflowIsEnabled")||this.$a.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(sf.zOc=-1*Math.pow(2,31))}nKc(){this.yD.kGf();za.a.Cu(this.od.om())}d2d(a){const b=this.od.om();if(2===a){var c=ec.XQi;a=sf.WQi;b.style.overflow="visible"}else if(1===a)c=B.a.Hjb?0:sf.zOc,a="0",b.style.overflow="hidden";else return;const f=this.od.zg.uu;f.style.position="absolute";
this.$a&&(this.$a.ka("WordEditorImageOverflowIsEnabled")||this.$a.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility="visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}$Sf(a){if(this.od&&this.od.zg&&this.od.zg.uu){var b=this.od.zg.uu;b.style.zIndex=String(B.a.Hjb?0:sf.zOc);B.a.Hjb&&!a&&(b.style.visibility=
"hidden",this.od.om().style.visibility="hidden")}}fKk(a){this.Ep.raiseEvent(vd.a.EJj);this.nKc();this.od.e0a(!0);this.od.om().style.direction="";this.d2d(a);this.od.zg.Jnk()}bKk(a){this.od.e0a(!0);this.d2d(a);B.a.Hjb&&this.adg();B.a.NF&&Sys.UI.DomElement.addCssClass(this.od.om(),"NonStandardIEClipboard")}eKk(a){this.d2d(a);B.a.NF&&Sys.UI.DomElement.removeCssClass(this.od.om(),"NonStandardIEClipboard")}dKk(a,b,c,f,l,w,H){this.Ep.raiseEvent(vd.a.endEditing);const U=this.od.om();U&&(za.a.Cu(U),B.a.eX&&
b&&a&&(this.od.e0a(!0),U.innerText=" ",this.IK.NKa(c,f,l,w,H)),a||Kd.a.sGf(U),this.od.e0a(!1),this.$Sf(b))}cKk(a){this.od.e0a(!1);B.a.NF&&Sys.UI.DomElement.removeCssClass(this.od.om(),"NonStandardIEClipboard");this.$Sf(a);this.Ep.raiseEvent(vd.a.nvi)}gKk(){const a=Sys.UI.DomElement.getBounds(this.Kf.Qd.XJ),b=this.od.zg.uu;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.Kf.Qd.scrollTop,He.a)+"px");b.style.opacity="0";b.style.zIndex=String(sf.zOc);B.a.Gj&&(b.style.visibility="Hidden",
this.od.om().style.visibility="Hidden")}adg(){const a=1E3-this.Kf.Qd.container.getBoundingClientRect().left+this.Kf.Qd.scrollLeft+1,b=this.od.zg.uu;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}sf.zOc=-1E3;sf.WQi="1";Object(n.a)(sf,"EditingDomDisplayManipulator",null,[]);class bg{constructor(a){this.l_h=a}get range(){return this.l_h}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}
Object(n.a)(bg,"RangeProxy",null,[1533]);class Ag{constructor(a){this.XDc=a}get selection(){return this.XDc}get type(){return this.selection.type}createRange(){return new bg(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(n.a)(Ag,"SelectionProxy",null,[1524]);class Ii{constructor(a){this.sRh=a}get Tl(){return this.sRh}get body(){return this.Tl.body}get activeElement(){return this.Tl.activeElement}get documentElement(){return this.Tl.documentElement}get document(){return this.Tl.cookie}get selection(){return new Ag(this.Tl.selection)}get designMode(){return this.Tl.designMode}get doctype(){return this.Tl.doctype}get domain(){return this.Tl.domain}get hidden(){return this.Tl.hidden}get implementation(){return this.Tl.implementation}get parentWindow(){return this.Tl.parentWindow}get referrer(){return this.Tl.referrer}get title(){return this.Tl.title}get URL(){return this.Tl.URL}get visibilityState(){return this.Tl.visibilityState}createAttribute(a){return this.Tl.createAttribute(a)}open(){this.Tl.open()}close(){this.Tl.close()}attachEvent(a,
b){return this.Tl.attachEvent(a,b)}detachEvent(a,b){this.Tl.detachEvent(a,b)}createAttributeNS(a,b){return this.Tl.createAttributeNS(a,b)}createDocumentFragment(){return this.Tl.createDocumentFragment()}createElement(a){return this.Tl.createElement(a)}createElementNS(a,b){return this.Tl.createElementNS(a,b)}createEvent(a){return this.Tl.createEvent(a)}createTextNode(a){return this.Tl.createTextNode(a)}dispatchEvent(a){return this.Tl.dispatchEvent(a)}execCommand(a,b,c){return this.Tl.execCommand(a,
b,c)}hasFocus(){return this.Tl.hasFocus()}focus(){this.Tl.focus()}getElementById(a){return this.Tl.getElementById(a)}getElementsByTagName(a){return this.Tl.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.Tl.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.Tl.getElementsByName(a)}write(a){this.Tl.write(a)}querySelector(a){return this.Tl.querySelector(a)}querySelectorAll(a){return this.Tl.querySelectorAll(a)}queryCommandEnabled(a){return this.Tl.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.Tl.queryCommandIndeterm(a)}queryCommandState(a){return this.Tl.queryCommandState(a)}queryCommandSupported(a){return this.Tl.queryCommandSupported(a)}queryCommandValue(a){return this.Tl.queryCommandValue(a)}}
Object(n.a)(Ii,"DOMDocumentProxy",null,[1567]);class aj{constructor(){this.Z2a=null}get isValid(){return this.zg.isValid}get contentWindow(){return this.zg?this.zg.contentWindow:null}get zg(){return this.Z2a}quk(a){me.a.EYg(a,this.zg.uu)}puk(){me.a.K4e(this.zg.uu)}fTf(){this.zg.TSi()}wgj(a){if(!B.a.fg)return a.innerHTML;this.zg.GAl(a);return a.innerHTML}xCl(){this.zg?(this.puk(),this.Z2a=null):ka.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}iji(a,b){this.Z2a=
a;this.quk(b)}om(){return this.zg?this.zg.Tn:null}e0a(a){this.zg&&this.zg.cpd(a)}cEa(){return this.zg?new Ii(this.zg.contentDocument):null}}Object(n.a)(aj,"EditingDomManager",null,[1422]);var Xg=d(147);class Qi{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud){this.hia=0;this.Ve=null;this.Ob=a;this.Bk=b;this.s2=c;this.Ep=f;this.aqa=l;this.$d=w;this.od=H;this.tf=U;this.tK=ja;this.Nk=wa;this.zd=Sa;this.yD=eb;this.Tc=ub;this.wK=Ub;this.Dh=cc;this.Kf=Fc;this.jf=Ic;this.fd=Ud;this.Hha=Cc;this.Hha.nci(Object(F.a)(this,
this.I7g,"onSynchronizeMode"))}dispose(){this.Hha.B0k(Object(F.a)(this,this.I7g,"onSynchronizeMode"))}WZb(a){(this.Ve=a)||ka.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.tf.mode}endClipboard(){if(1===this.mode){var a=this.Bk.oe(2);a.kd(this.Ve.root);this.Ve.detach();this.Ob.Dg&&!this.cje&&this.Ob.Dg.Jda(this.Kf.Qd.Ma,4,!0);this.tf.Ujb(0,3);this.Ob.Dg=null;this.Ob.Wh=null;this.Ob.BW=null;this.s2.cKk(this.Ve.FJa);a.dispose()}}Caa(a,b,c){this.Ve.yUa&&
this.Ob.Wh?this.Ve.Ss(!1):this.Ve.yUa&&!this.Ob.Wh&&ka.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.Ep.GQk(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.tf.Ujb(a,c);f=this.startEditing(this.bKi);break;case 1:if(this.mode!==a||this.Tc.Na.Rr!==this.hia)this.endEditing(!0),this.tf.Ujb(a,c),f=this.Arl(),this.hia=this.Tc.Na.Rr;break;case 0:this.mode!==a&&(2===this.mode&&ph.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.tf.Ujb(a,c))}f||this.tf.Ujb(0,7)}nbl(){this.tf.Ujb(2,0)}get bKi(){return this.Tc.Na.mb.Ua.node}startEditing(a){if(1===this.ssf)return!1;this.od.fTf();this.Ve.Hya?this.Ve.Ss(!0):(this.Ve.iDj.hTf(!1),this.tf.X5b(this.Ob.Dg)&&this.Ve.Ss(!1));this.Ve.Hya=!1;if(this.Ob.Dg===a)return a=ob.GraphIterator.nb(a.node),this.k2d(a),this.Ob.aAj&&(this.zd.Pi&&this.Ve.Vtb.Oda||this.tK.setFocus(this.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz)),!0;
const b=this.Bk.oe(2,D.a.startEditing);b.kd(a.node);this.Ve.detach();this.Ob.Dg&&this.Ob.Dg.Jda(this.Kf.Qd.Ma,4,!0);this.Ob.Dg=a;this.Ob.Dg.Jda(this.Kf.Qd.Ma,4,!0);if(this.fd.hg){const c=oe.j(this.Ob.Dg,5);for(let f=0;f<c.length;f++)c[f].eQf(this.Ve)}this.Ve.Uvb=!0;this.s2.fKk(this.mode);this.Ve.$x(a.node);this.yD.akb(!1,this.Ob.Ji,this.Dh);this.tf.Daa(!1);this.tf.$Ka(!1);a=ob.GraphIterator.nb(this.Ob.Dg.node);this.k2d(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Ve.ePc(),this.Ve.Ss(!0),
!this.cje)){var b=this.Bk.oe(2);b.kd(this.Ve.root);this.Ve.detach();this.Ob.Dg&&this.Kf.Qd&&this.Ob.Dg.Jda(this.Kf.Qd.Ma,20,!0);this.tf.Ujb(0,4);this.Ob.Dg=null;this.Ob.Wh=null;this.Ob.BW=null;this.s2.dKk(a,this.Ve.FJa,this.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz);b.dispose()}}Arl(){if(this.cje||R.a.instance.ga(11)&&1===this.ssf)return!1;this.Ep.raiseEvent(vd.a.mvi);this.od.fTf();const a=this.Bk.oe(2);a.kd(this.Tc.wlb);this.tf.X5b(this.Ob.Dg)&&this.Ve.Ss(!1);
this.Ve.detach();this.Ob.Dg=null;this.Ob.Wh=null;this.Ob.BW=null;if(this.Tc.Na.Xda){const b=this.Tc.Na.mb.Ua.node;this.Ve.$x(b);const c=ob.GraphIterator.nb(b);this.Ob.Dg=b;this.Ob.Lca=this.uMj(b);this.k2d(c);this.Ob.Dg.Jda(this.Kf.Qd.Ma,4,!0)}else this.Ve.$x(this.Tc.wlb);this.s2.bKk(this.mode);this.yD.akb(!1,this.Ob.Ji,this.Dh);a.dispose();return!0}I7g(){this.a1a()}a1a(){if(!this.aqa.t9&&!u.AFrameworkApplication.ye.ww&&this.Kf.Qd&&this.Kf.Qd.isActive){var a=this.Tc.Na.mb;a&&this.tK.rke()?this.wK&&
this.wK.gab()?this.Caa(2,!0,10):this.jf.ox(a)?Pc.App.Kb.Ld.isEditingAllowed||Pc.App.Kb.Ld.hz?this.Caa(2,!0,0):this.Ve.Nqd?(this.Caa(1,!0,0),this.Caa(0,!0,15)):this.Caa(2,!0,0):this.Caa(1,!0,0):this.Caa(0,!1,a?9:8)}}get cje(){return u.AFrameworkApplication.Ug}get ssf(){return u.AFrameworkApplication.Aa.state}k2d(a){a.Ze();Xg.OutlineNavigator.tTe(a)}uMj(a){return fe.OutlineElementReader.um(Pa.OutlineElementNavigator.WA(a))}}Object(n.a)(Qi,"EditingModeTransitionManager",null,[1421]);class Jh{constructor(a,
b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve){this.Ve=null;this.$d=a;this.tf=b;this.Ob=c;this.lWh=f;this.Mk=l;this.kWh=w;this.iWh=H;this.zzd=U;this.W2h=ja;this.Znb=wa;this.IOa=Sa;this.W$e=eb;this.rRh=ub;this.tK=Ub;this.hha=cc;this.NXb=Fc;this.wRh=Ic;this.yYh=Cc;this.hOh=Ud;this.YWh=je;this.fia=Vd;this.Wi=Ve}NS(a){this.Ve=a}get TY(){return!this.$d.ww&&this.tf.isActive&&this.Ob.pVa(this.tf.mode)?!0:!1}ZGk(a){a.RFa=b=>this.lWh.RFa(b,this.TY);a.Jbb=b=>this.kWh.Jbb(b,this.TY);a.aA=b=>this.iWh.aA(b,
this.TY,this.Ve.u2b);a.S0b=b=>this.zzd.S0b(b,this.TY,this.Ve.u2b);a.YWd=b=>this.zzd.WWd(b,this.TY,this.Ve.u2b);a.R0b=b=>this.zzd.R0b(b,this.TY,this.Ve.u2b);a.rlb=b=>this.W2h.rlb(b,this.TY&&this.Ve.Nqd);a.pDa=Object(F.a)(this.Znb,this.Znb.pDa,"dropHandler");a.oDa=Object(F.a)(this.Znb,this.Znb.oDa,"dragOverHandler");a.b3b=Object(F.a)(this.Znb,this.Znb.b3b,"dragLeaveHandler");a.Plc=b=>{this.IOa.handlePaste(b,this.Ve.root,this.tf.bXc)};a.YZd=b=>{this.W$e.T$f(b,!0,this.TY,this.tf.bXc)};a.k1b=b=>{this.W$e.T$f(b,
!1,this.TY,this.tf.bXc)};a.W2b=b=>{this.rRh.W2b(b,this.TY)};a.tAf=()=>{this.tK.Dji()};a.lC=b=>this.hha.cKi(b,this.Mk.Oda,this.TY);a.oC=b=>this.NXb.onContextMenu(b,this.Ve.Dg);a.c3e=Object(F.a)(this.NXb,this.NXb.dlc,"onTouchMove");a.b3e=Object(F.a)(this.NXb,this.NXb.HHb,"onTouchEnd");a.MQd=()=>{this.tK.ZSi(this.tf.mode)};a.n8a=b=>this.wRh.Wgb(b,this.TY);a.L_a=b=>{this.yYh.onScroll(b,this.TY,this.Ve.ownerDocument.documentElement)};a.o1=()=>{this.hOh.jsk(this.TY)};a.ksg=b=>{this.YWh.lostFocus(b,this.TY)};
a.yLb=()=>this.fia.txj(this.TY,this.Ve.Dg);a.ugb=b=>this.Wi.mouseDown(b);a.dFe=b=>this.Wi.GJ(b)}}Object(n.a)(Jh,"EditingSurfaceEventHandlerManager",null,[]);class Og{constructor(a,b,c){this.nd=a;this.ag=b;this.zh=c}cancelEventAndRestoreEditingSurface(a){this.nd.Xb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.ag.bx++;Yc.a.Bn(a);this.zh.Caa(0,!0,6);this.zh.a1a()}}Object(n.a)(Og,"EditingSurfaceEventHandlerUtils",null,[]);class Qh{constructor(){this.sBa=0}get t9(){return 0<
this.sBa}suspend(){this.sBa++}resume(){0<this.sBa&&this.sBa--}}Object(n.a)(Qh,"EditingSurfaceStateManager",null,[]);class Yg{constructor(a=30){this.bdd=this.djc=-1;this.Dlb=Array(a);this.udd=Array(a-1)}BDh(){this.zTk();this.gGl()}zod(){const a=this.i$k();ka.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}zTk(){var a=(new Date).getTime();if(this.djc<this.Dlb.length-1)this.djc++;else for(let b=0;b<this.Dlb.length-1;b++)this.Dlb[b]=this.Dlb[b+1];this.Dlb[this.djc]=a}gGl(){const a=this.djc+1;
for(let b=2;b<=a;b++)this.bCl(b,this.S9i(b))}S9i(a){const b=this.djc;return this.Dlb[b]-this.Dlb[b-(a-1)]}bCl(a,b){a-=2;this.bdd<a?(this.bdd++,this.udd[this.bdd]=b):b<this.udd[a]&&(this.udd[a]=b)}i$k(){const a=this.GYi();return Sys.Serialization.JavaScriptSerializer.serialize(a)}GYi(){const a=Array(this.bdd+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.udd[b]/(b+1));return a}}Object(n.a)(Yg,"EventFrequencyTracker",null,[]);var If=d(1087),mj=d(1089);class xi{constructor(a){this.It=null;this.Gp=
0;this.lK=a;this.Dj=new Date;this.ywc=u.AFrameworkApplication.Aa.mode}end(a){this.Gp=a;this.It=new Date}get startTime(){return this.Dj}get endTime(){return this.It}get actionId(){return this.lK}get behavior(){return 2}get zIc(){return this.ywc}get UJ(){return null}get rd(){return null}get telemetryData(){return null}get response(){return this.Gp}get vT(){return 1}get xq(){return 30}get asa(){return null}get Qi(){return!0}}Object(n.a)(xi,"TypingActionOperation",null,[1429,347,348]);class Bj{constructor(a,
b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){this.Ve=this.Fzc=this.Bob=null;this.QYh=a;this.zh=b;this.Ep=c;this.Mha=f;this.s2=l;this.Bk=w;this.Ob=H;this.Kf=U;this.$d=ja;this.Nk=wa;this.tf=Sa;this.Wi=eb;this.Dh=ub;this.Us=Ub;this.Iha=cc;this.eS=Fc;this.Tc=Ic;this.DD=Cc}NS(a){this.Ve=a}get ueg(){return!!this.Bob}startHybridTransition(){if(this.Nk.value.isEditingAllowed||this.Nk.value.hz){this.zh.nbl();this.Ep.raiseEvent(vd.a.BCk);this.lcl(D.a.overtype);this.Mha.value.uw();this.s2.eKk(this.zh.mode);
var a=this.Bk.oe(2);a.kd(this.Ve.root);this.Ob.Dg&&!u.AFrameworkApplication.Ug&&this.Ob.Dg.Jda(this.Kf.Qd.Ma,4,!0);a.dispose();this.eS.jpc();this.tf.$Ka(!0);this.Wi.updateCaretPosition(this.zh.mode,this.Ob.Ji);this.QYh.C_i(this.Ob.Wh,this.Ob.Dg,this.Ob.BW);this.Dh.vlk(this.Tc.Na.mb.Ua.Qa,this.Tc.Na.mb.Ua.Lb);this.Us.YY();this.Iha.qGb();this.b7h();this.Ep.raiseEvent(vd.a.zCk)}else this.zh.Caa(0,!0,12)}mSi(){this.eS.jpc();this.Bob.end(32);If.a.getInstance().ooc(this.Bob);mj.a.getInstance().noc(this.Bob);
this.Bob=null}b7h(){this.Fzc||(this.Fzc=new Le.a(2,1,20,Object(F.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.$d.Db(this.Fzc))}lcl(a){this.Bob=new xi(a)}hybridCleanup(){this.Fzc=null;this.Ob.pVa(this.zh.mode)&&this.Ve.Ss(!0)}NYe(){if(!this.Tc.Na.Xda)return!1;const a=this.Tc.Na.mb.Ua,b=vb.HyperlinkReader.vC(a,!1);for(const c of b)if(c.Qa===a.Qa&&c.Lb<=a.Lb)return!1;return this.DD.qVj(a)?!1:!oe.d(a.node,a.Qa)&&!oe.d(a.node,a.Lb-1)&&!a.node.xAi}}Object(n.a)(Bj,"HybridTransitionManager",null,
[1420]);class yi{constructor(a,b,c,f,l){this.nDd=this.Hya=!1;this.ds=a;this.zh=b;this.od=c;this.Dh=f;this.Kf=l}get rDj(){return this.nDd}ePc(){this.hTf(!0)}hTf(a){this.ds.isComposing&&2===this.zh.mode&&(ka.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.nDd=!0,this.od.zg.koa(),this.Dh.Opk(this.od.contentWindow),this.nDd=!1,this.ds.isComposing=!1,a&&this.Kf.Qd.uo&&(this.Kf.Qd.wtb()&&ka.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.zh.a1a()))}}
Object(n.a)(yi,"ImeManager",null,[]);class Zg{constructor(a,b,c,f,l,w,H,U){this.Ah=null;this.zd=a;this.od=b;this.zh=c;this.Bk=f;this.nd=l;this.ag=w;this.Um=U}WZb(a){this.Ah=a}get pDj(){if(this.zd.fg){const a=Kd.a.aEa(this.od.contentWindow);if(a&&this.Um.SUc(a)===this.od.om())return!0}return!1}correctBadImeState(){if(!this.pDj)return!1;this.nd.Xb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.ag.bz++;const a=this.Bk.oe(3);a.kd(this.Ah.root);this.zh.Caa(0,!0,11);this.zh.a1a();
a.dispose();return!0}}Object(n.a)(Zg,"ImeRecoveryUtils",null,[]);class ya{constructor(a,b,c,f,l,w,H,U,ja){this.Dh=a;this.ag=b;this.nd=c;this.lj=f;this.AK=l;this.Yo=w;this.Kf=H;this.Ob=ja}qGb(){for(let a=0;a<this.Dh.Gi.length;a++)this.Yo.MI(this.Dh.Gi[a].yF,this.ag,this.nd,this.lj)?Sys.UI.DomElement.removeCssClass(this.Dh.Gi[a].qie,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Dh.Gi[a].qie,"EmptyTextRun"),za.a.j1b(this.Dh.Gi[a].yF,this.Dh.Gi[a].qie)}}Object(n.a)(ya,"InteractiveViewSynchronizer",
null,[]);var La=d(15),Qa=d(195),Eb=d(244);class fc{constructor(){}}Object(n.a)(fc,"OnBackspaceDeleteEventArgs",null,[]);class mc{constructor(a){this.Y3d=a}}Object(n.a)(mc,"OnDisMissFloatieEventArgs",null,[]);var Mc=d(550),nd=d(101);class ba{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di,Si,rj,sg,Cg,sh,vk,Ni,wk,Jl,hk,Kl,Vj,Wj,nk,gl){this.gia=null;this.Tff=this.q8e=!1;this.mUb=new La.ScriptSharpLegacyMap;this.zBa=a;this.lj=b;this.$d=c;this.od=f;this.nd=
l;this.ag=w;this.gra=H;this.fia=U;this.hha=ja;this.Ob=wa;this.Wi=Sa;this.zd=eb;this.Um=ub;this.tZ=Ub;this.jf=cc;this.eS=Fc;this.$H=Ic;this.qqa=Cc;this.Tc=Ud;this.tf=je;this.ds=Vd;this.Mha=Ve;this.cC=af;this.gh=Zf;this.Nk=lg;this.IK=Tg;this.ynb=Ug;this.Mk=ag;this.SNa=ih;this.PV=Vg;this.LOh=di;this.tqb=Si;this.Bk=rj;this.Ca=sg;this.fd=Cg;this.ap=sh;this.JD=vk;this.rSb=Ni;this.KP=wk;this.$4a=Jl;this.Tba=hk;this.Ep=Kl;this.KOh=Vj;this.Tza=!!Wj;this.hv=Wj;this.$a=nk;this.zn=gl}get wuc(){return this.zBa.instance?
this.zBa.instance.TEh():null}get A_d(){return this.rSb||(this.rSb=Ab.a.instance.rb("Common.IEventTimingMeter"))}get T_a(){return this.gia||(this.gia=Ab.a.instance.rb("Box4.ISelectionCommands"))}IZj(a,b){let c=this.Qbe(a);c||(c=this.ruj(a,b));return c}ruj(a,b){const c=a.qc,f=c.keyCode,l=a.eventName===sa.a.eQa;if(this.Tza&&l&&this.hv.instance&&this.hv.instance.Ask(f===A.a.VH))return Yc.a.Bn(c),!0;if(f===A.a.X1a&&c.shiftKey&&c.ctrlKey)return l&&(u.AFrameworkApplication.Ta.processAction(D.a.rMf,2),ka.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(l&&c.ctrlKey){if(f===A.a.Svd||f===A.a.Vvd)return this.qpe(D.a.qMf),!1;if(f===A.a.Tvd||f===A.a.jvc)return this.qpe(D.a.pMf),!1;if(f===A.a.C7e)return this.qpe(D.a.IJi),!1}this.lj&&(this.$d.RNf(ba.vvl),this.od.zg.gud());if(1===this.tf.mode)return this.Zvk(a,b);if(this.lj&&this.Mk.Oda)return this.nd.Xb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.ag.bw++,Yc.a.Bn(c),this.gra.epc(D.a.typing),!0;this.fia.fixupAfterMagnifierDrag();this.od.om().scrollTop=
0;this.hha.x9=!this.Ob.Lca&&f===A.a.oP||this.Ob.Lca&&f===A.a.ZR||f===A.a.Tw;this.Wi.updateCaretPosition(this.tf.mode,this.Ob.Ji);this.zd.Gj&&(c.ctrlKey||c.altKey)&&f!==A.a.Rvd&&f!==A.a.vMa&&f!==A.a.mmb&&f!==A.a.Qwd&&this.SNa.ePc();return this.quj(a)}quj(a){var b=a.qc.keyCode;const c=b===A.a.upa,f=b===A.a.VH;let l=!1,w=!1,H=!1;switch(b){case A.a.Tw:case A.a.bF:H=!0;u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.$a.ka("BrowserHandledNavigationIsEnabled");
a.qc.altKey||a.qc.ctrlKey||a.qc.shiftKey||this.zd.wk||!b&&this.zd.Vj||(w=!0);break;case A.a.ZR:case A.a.oP:H=!0;this.zd.wk&&this.Um.C4f(a.qc.rawEvent)&&!a.qc.altKey&&!a.qc.shiftKey?w=!0:this.zd.Gj&&this.T_a?a.qc.altKey||a.qc.ctrlKey||a.qc.shiftKey||(w=!0):l=!0;this.$a&&this.$a.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.tf.$Ka(!0);break;case A.a.Y1:case A.a.W1:H=!0;this.zd.Gj&&this.T_a?w=this.dtj(a):l=!0;this.$a&&this.$a.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.jf.u0c(this.$4a.mb)||
this.jf.FKa(),this.tf.$Ka(!0));break;case A.a.upa:case A.a.VH:if(!this.Nk.value.isEditingAllowed&&this.Nk.value.hz)l=!0;else if(this.Tsj(a,c,f))return!0;break;case A.a.PJh:this.nd.Xb("InsertKeyPressed");l=!0;break;default:if(a.qc.keyCode===A.a.Qwd||a.qc.keyCode===A.a.Wvd||this.zd.XQd)this.ds.isComposing=!0,this.tqb||this.tf.Daa(!0)}(this.Mk.X2&&!f||this.Mk.ssa&&!c)&&this.$H.Ss(!0);2!==this.tf.mode&&(H=w=!1);a.eventName===sa.a.eQa&&this.Ep.KPk(a,this.ds.isComposing,H);w&&(this.Mha.value.uw(),this.cC.EPa(a));
l&&Yc.a.Bn(a.qc);return w}Qbe(a){return u.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?Mc.a.Qbe(a,this.$4a.z4b):!1}Usj(a){const b=this.$4a.z4b;var c=b.node;const f=b.Qa,l=zb.ParagraphReader.text(c);let w=!1;if(a){if(f<zb.ParagraphReader.textLength(c)){a=this.Bk.oe(15);try{a.kd(c),c=f+1,ha.a.rx(l,c)&&c++,this.zn.XGb(b,null),this.Ca.processAction(D.a.rightArrow,2)}finally{a&&a.dispose()}w=!0}}else if(0<f){a=this.Bk.oe(15);try{a.kd(c),c=f-1,ha.a.rx(l,c)&&c--,this.zn.XGb(b,null),this.Ca.processAction(D.a.leftArrow,
2)}finally{a&&a.dispose()}w=!0}return w}Njj(a){return Kb.a.xs(a.Ua).cache.fontSize}dtj(a){var b=!1;if(!(a.qc.altKey||a.qc.ctrlKey||a.qc.shiftKey||(a=oe.f(this.Ob.Dg),Qa.a.any(a,c=>5===c.Wq||8===c.Wq)))){if(this.od.zg&&this.KP.jAb(this.od.zg.Tn))return!1;this.cC.Zlb&&this.cC.typingProcess();b=this.tZ.sta(this.hha.x9);a=this.jf.Wia(b);a=this.Ob.Lca?a.x+a.width:a.x;-1===this.jf.Iz?(this.jf.Iz=a,b=!0):b=Math.abs(this.jf.Iz-a)<=this.Njj(b)}return b}Tsj(a,b,c){if(!a.qc.altKey&&!a.qc.ctrlKey&&!a.qc.shiftKey&&
(this.lj&&this.Mk.X2&&this.eS.Nud()&&this.$H.Ss(!1),this.LOh.XAl(b,this.Ob.Wh,this.Ob.eRa,this.Ob.Dg,this.hha.x9,this.Ob.BW.Ji,this.$H.iki))){if(this.fd.hg&&this.fd.Yy)return(b=this.Usj(b))&&Yc.a.Bn(a.qc),b;const f=this.nd.Wp(D.a.NSd);this.wuc&&this.wuc.OZj();const l=new fc(a,c,b);this.KOh.SOk(l);(c&&!this.Mk.X2||b&&!this.Mk.ssa)&&this.$H.Ss(!1);R.a.instance.ga(50)&&this.qqa.value&&this.qqa.value.vw&&this.Tc.sYb();za.a.j1b(this.Ob.Wh.Ji,this.Ob.BW.Ji);this.cC.EPa(a);this.jf.FKa();this.tf.Daa(!0);
this.Mk.ssa=b;this.Mk.X2=c;this.Mk.X2&&-1===this.Mk.GLc?this.Mk.GLc=this.$H.HVc:this.Mk.ssa&&-1===this.Mk.gtd&&(this.Mk.gtd=za.a.zv(this.Ob.eRa).length);f.end();return!0}return!1}aA(a,b,c){const f=this.A_d;try{f&&f.keyDownEventHandlerStart(a.qc.rawEvent);0===this.tf.mode&&a.qc.keyCode!==A.a.tq&&1!==this.Ca.mode&&this.t4j(this.tf,a.eventName);if(!b||!this.gh)return!1;(a.qc.keyCode!==A.a.mmb||this.ynb.SNc)&&this.Nk.value.wq.tC();if(!this.tjl(a)){const H=new mc(!0);this.Tba.iPk(H)}if(!this.tf.isActive)return!1;
this.Mk.Qne=(new Date).getTime();const l=this.nd.Wp(D.a.typing);l.properties.$(Xc.a.source,"KeyDown");l.properties.$(Xc.a.fah,"KeyDown");const w=this.IZj(a,c);w&&Yc.a.Kqi(a.qc);l.end();return w}finally{f&&f.keyDownEventHandlerEnd(a.qc.rawEvent)}}tjl(a){switch(a.qc.keyCode){case A.a.cba:case A.a.OJh:case A.a.O6:case A.a.fZ:case A.a.dba:case A.a.Rga:case A.a.Wvd:case A.a.Xvd:return!0}return!1}t4j(a,b){b={["EventName"]:b};u.AFrameworkApplication.Aa&&(b.Mode=u.AFrameworkApplication.Aa.mode);if(a)if(b.Trigger=
a.T1c,b.TriggeredTime=a.m_j,this.mUb.Gb(a.T1c)){let c,f;(c=this.mUb).$(f=a.T1c,c.ga(f)+1)}else this.mUb.$(a.T1c,1);b.Msg="BadEditSurfaceState";this.q8e?ka.ULS.sendTraceTag(18437408,323,50,"{0}",b):(ka.ULS.shipAssertTag(18437408,323,!1,"{0}",b),u.AFrameworkApplication.vga(()=>{this.u4j()}));this.q8e=!0}u4j(){if(!this.Tff){var a="";for(let b of this.mUb.keys)a+=" Trigger "+b+" - "+this.mUb.ga(b)+",";ka.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.Tff=!0}}Zvk(a,b){this.lj&&
this.IK.Djb(this.tf.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz);if(this.fd.hg&&(x.KeyInputManager.yWc(a.qc)===x.KeyInputManager.Oa(A.a.Oza,x.KeyInputManager.Oe)||x.KeyInputManager.yWc(a.qc)===x.KeyInputManager.Oa(A.a.Uvc,x.KeyInputManager.Oe))&&(u.AFrameworkApplication.BM||u.AFrameworkApplication.iG)&&!u.AFrameworkApplication.ORa)return Yc.a.Bn(a.qc),!0;const c=this.$4a.z4b,f=c.node;if(a.qc.keyCode===A.a.tq){if(Eb.EmbeddedFileReader.qTj(f))return Yc.a.Bn(a.qc),
!0;if(nd.ImageReader.iH(f)||!Eb.EmbeddedFileReader.Lab(f))if(nd.ImageReader.iH(f)||nd.ImageReader.tFa(c))return u.AFrameworkApplication.Ta.pi(c,D.a.CB,2,!1,null,null),Yc.a.Bn(a.qc),!0}switch(a.qc.keyCode){case A.a.Qwd:case A.a.Wvd:if({U3:a,ANb:b}=this.PV.WEh(a,b),a)return b}return!1}qpe(a){u.AFrameworkApplication.Ta.processAction(a,2)}}ba.vvl=2E3;Object(n.a)(ba,"KeyDownProcessor",null,[]);class Aa{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){this.Yo=a;this.Ob=b;this.ag=c;this.nd=f;this.lj=l;
this.yD=w;this.$H=H;this.eS=U;this.zh=ja;this.Wi=wa;this.tZ=Sa;this.xV=eb;this.jf=ub;this.Mk=Ub;this.tf=cc}get tKe(){return this.Yo.MI(this.Ob.Ji,this.ag,this.nd,this.lj)-(this.yD.w7?1:0)-this.Yo.MI(this.Ob.Ji.lastChild,this.ag,this.nd,this.lj)}LLk(a,b){switch(b.keyCode){case A.a.bF:case A.a.ZR:if(this.VAj(a,b))return!0;break;case A.a.Tw:case A.a.oP:if(this.iSi(a,b))return!0;break;case A.a.Y1:case A.a.W1:if(this.EDl(a,b))return!0;break;case A.a.VH:if(this.vii())return!0}return!1}vii(){return this.Mk.X2&&
this.eS.Nud()?(this.$H.Ss(!1,!0),!0):!1}EDl(a,b){a.nZc=!0;var c=this.tKe;const f=this.Wi.F8(this.zh.mode,this.Ob.Ji);f>=c&&(this.Wi.eT(c,this.Ob.Wh),a.mb=this.tZ.sta(this.xV.x9));if(f===b.j2b)a.T7a=b.keyCode===A.a.fZ?1:3;else{if(f<c&&ha.a.iz(this.Yo.q0f(this.Ob.Wh,f-1,this.nd,this.ag,this.lj))){c=this.jf.$sa(a.mb,!1,!1,!1,!0);c=this.jf.Wia(c);var l=a.mb.Ua;a=this.jf.Wia(a.mb);l=Kb.a.xs(l);a.y>c.y&&Math.abs(a.x-this.jf.Iz)>2*l.cache.fontSize&&this.Wi.eT(f-1,this.Ob.Wh)}this.tf.$Ka(!0);this.xV.fixupAfterCursor(b.keyCode===
A.a.fZ?1:3);this.$H.B_d();return!0}return!1}iSi(a,b){a.nZc=!0;const c=this.tKe;this.jf.FKa();const f=this.Wi.F8(this.zh.mode,this.Ob.Ji);f>=c&&(this.Wi.eT(c,this.Ob.Wh),a.mb=this.tZ.sta(this.xV.x9));if(b.keyCode===A.a.oP&&(b.j2b>=c&&!this.Ob.Lca||b.j2b===this.xV.dzh&&this.Ob.Lca))a.T7a=2;else return this.tf.$Ka(!0),b.keyCode===A.a.Tw&&f<c&&ha.a.iz(this.Yo.q0f(this.Ob.Wh,f-1,this.nd,this.ag,this.lj))&&this.Wi.eT(f-1,this.Ob.Wh),this.xV.fixupAfterCursor(this.Ob.Lca?4:2),this.$H.B_d(),!0;return!1}VAj(a,
b){a.nZc=!0;const c=this.tKe;this.jf.FKa();if(b.keyCode===A.a.ZR&&(b.j2b===this.xV.dzh&&!this.Ob.Lca||b.j2b>=c&&this.Ob.Lca))a.T7a=4;else return this.tf.$Ka(!0),this.xV.fixupAfterCursor(this.Ob.Lca?2:4),this.$H.B_d(),!0;return!1}}Object(n.a)(Aa,"KeyEntryProcessor",null,[]);var Wa=d(1210),gb=d(130),nb=d(44);class lc{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag){this.$za=this.fmf=null;this.zd=a;this.Um=b;this.nd=c;this.fia=f;this.Nk=l;this.PV=w;this.j7=H;this.ds=
U;this.tf=ja;this.Tc=wa;this.od=Sa;this.Fyc=eb;this.Wi=ub;this.aha=Ub;this.Yo=cc;this.Ob=Fc;this.hha=Ic;this.Dh=Cc;this.qqa=Ud;this.Ep=je;this.cC=Vd;this.pba=Ve;this.zBa=af;this.u2h=Zf;this.jha=lg;this.fd=Tg;this.ap=Ug;this.rSb=ag}get wuc(){return this.zBa&&this.zBa.instance?this.zBa.instance.TEh():null}get Bbb(){return this.fd.hg&&this.fd.Yy}get XZ(){return this.$za||(this.$za=Ab.a.instance.rb("Box4.IClipboardCommands"))}get A_d(){return this.rSb||(this.rSb=Ab.a.instance.rb("Common.IEventTimingMeter"))}Jbb(a,
b){if(!b)return!1;b=this.A_d;try{b&&b.keyPressedEventHandlerStart(a.qc.rawEvent);if(this.zd.RF&&this.zd.wk&&this.Um.C4f(a.qc.rawEvent))return!1;this.wuc&&!x.KeyInputManager.ckg(a)&&this.wuc.OZj();const c=this.nd.Wp(D.a.typing);c.properties.$(Xc.a.source,"KeyPress");const f=this.NZj(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.qc.rawEvent)}}byj(){if((this.u2h||this.Bbb)&&this.jha.V2(this.Tc.Qj,14)){var a=Object(qa.a)(Wa.a,this.jha.b5b(this.Tc.Qj,16,!1));if(a&&1<a.length){const b=[],
c=this.Tc.Na.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;if(!ob.GraphIterator.nb(l).Vaa(a))break;Array.add(b,c.ga(f))}0<b.length&&this.Tc.setSelection(new gb.Selection(b,!0))}}}MPk(a,b){if(1===this.tf.mode)return!1;this.Ep.GPe(a,this.ds.isComposing);let c;(c=this.cC).z1c=c.z1c+1;B.a.vo||Pc.App.lTd&&B.a.sAh||(this.cC.qvh(this.ds.JFa)||this.cC.EPa(a),this.tf.Daa(!0));this.ds.isComposing&&R.a.instance.ga(50)&&this.qqa.value&&this.qqa.value.vw&&this.Tc.sYb();this.Dh.jGc=
"";0<this.Dh.Gi.length&&(this.zd.fg||" "===b)&&(this.Dh.jGc=za.a.zv(this.Dh.Gi[0].yF));this.pba.raiseEvent(jf.a.Fne,a);this.Fyc.BDh();return!1}cPi(a){let b=!1;this.ds.JFa&&this.aha.QZb.instance&&(" "===a&&this.Yo.uRi(this.Ob.Ji,this.Wi.F8(this.tf.mode,this.Ob.Ji))&&(b=!!this.aha.fEe(this.ds.JFa,this.hha.x9)),!b&&this.aha.QZb.instance.PXj(a)&&this.aha.bPi(a,this.hha.x9))}suj(a){if(1!==this.tf.mode||(this.zd.Gj||this.zd.vo)&&a.qc.ctrlKey&&!a.qc.altKey||this.zd.ala&&a.qc.charCode===A.a.X1)return!1;if(this.PV.ohd(a))return!0;
var b=this.PV.qYe();const c=this.PV.wjl();if(b||c||!this.j7.NYe())return b&&!c&&this.Tc.setSelection(Od.SelectionFactory.Sg(this.Tc.Na.mb.Ua.node,this.Tc.Na.mb.Ua.Qa)),b=this.Mab(),this.byj(),this.XZ&&(this.XZ.y$g(String.fromCharCode(a.qc.charCode),b),this.pba.raiseEvent(jf.a.Fne,a)),Yc.a.Bn(a.qc),!0;if(this.PV.cKe(a))return!0;if(this.Bbb){b=this.fd.tsb();try{this.Ep.GPe(a,this.ds.isComposing),this.zd.vo&&this.XZ?(this.XZ.y$g(String.fromCharCode(a.qc.charCode)),Yc.a.Bn(a.qc)):(this.cC.EPa(a),this.tf.Daa(!0))}finally{b&&
b.dispose()}}else this.j7.startHybridTransition(),this.Ep.GPe(a,this.ds.isComposing),this.cC.EPa(a),this.tf.Daa(!0);this.pba.raiseEvent(jf.a.Fne,a);this.Fyc.BDh();return!1}Mab(){if(this.Tc&&this.Tc.Na&&this.Tc.Na.mb){const a=this.Tc.Na.mb;return nb.SelectionEditor.Xl(a.ga(a.length-1))||a.ga(a.length-1).contextId===Cb.a.paragraph}return!1}NZj(a){this.fia.fixupAfterMagnifierDrag();if(!(this.Nk.value.isEditingAllowed||this.Nk.value.hz&&this.Bbb))return Yc.a.Bn(a.qc),!0;if(this.PV.qhd(a))return!1;if(1===
this.tf.mode)return this.suj(a);this.od.om().scrollTop=0;this.zd.fg&&this.tf.X5b(this.Ob.Dg)&&" "===this.fmf&&this.cC.typingProcess();const b=ha.a.charAt(ha.a.fromCharCode(a.qc.charCode),0);this.fmf=b;this.ds.isComposing||(x.KeyInputManager.ckg(a)&&(this.ds.isComposing=!0),this.Wi.DRk&&(this.ds.isComposing=!0));this.cPi(b);if(this.zd.fg&&!this.zd.wk){const c=a.qc;if(c.ctrlKey&&122===this.Um.p0f(c)||c.ctrlKey&&121===this.Um.p0f(c))return!0}return this.MPk(a,b)}}Object(n.a)(lc,"KeyPressProcessor",null,
[]);class jd{constructor(a,b){this.Yi=a;this.keyCode=this.Yi.qc.keyCode;this.j2b=b}get lzj(){return!(void 0===this.keyCode||null===this.keyCode)}}Object(n.a)(jd,"KeyQueueEntry",null,[]);class xd{constructor(a,b,c,f,l,w,H){this.nUb=[];this.gia=null;this.jWh=a;this.tf=b;this.Ob=c;this.jf=f;this.Tc=l;this.$H=w;this.Wi=H}get T_a(){return this.gia||(this.gia=Ab.a.instance.rb("Box4.ISelectionCommands"))}gch(a){let b=-1;if(x.KeyInputManager.xkg(a.eventName)&&2===this.tf.mode)switch(a.qc.keyCode){case A.a.bF:case A.a.Tw:case A.a.ZR:case A.a.oP:case A.a.Y1:case A.a.W1:R.a.instance.ga(45)&&
this.tf.X5b(this.Ob.Dg)&&this.$H.Ss(!1,!1);ph.GrippersManager.instance.ZTa();b=this.Wi.F8(this.tf.mode,this.Ob.Ji);break;default:ph.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.nUb,new jd(a,b))}MLk(a){for(;0<this.nUb.length;){const b=this.nUb[0];Array.removeAt(this.nUb,0);const c=x.KeyInputManager.xkg(b.Yi.eventName);if(!(c&&(b.Yi.qc.altKey||b.Yi.qc.ctrlKey||b.Yi.qc.shiftKey)||this.nUb.length)){if(c)if(b.lzj){if(this.jWh.LLk(a,b))return!0}else this.jf.FKa();if(this.zBl(a))return!0}}return!1}zBl(a){if(5!==
a.T7a){if(this.tf.P3f(this.Ob.Dg))if(1===a.T7a||3===a.T7a){const b=this.jf.Iz;this.Tc.setSelection(a.mb);this.jf.Iz=b}else this.Tc.setSelection(a.mb);this.T_a.kok(a.T7a);if(2!==this.tf.mode)return!0}return!1}}Object(n.a)(xd,"KeyQueueProcessor",null,[]);class Kc{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.gia=null;this.nd=a;this.IK=b;this.zh=c;this.ds=f;this.Ob=l;this.Nk=w;this.Iha=H;this.Us=U;this.JAc=ja;this.od=wa;this.ynb=Sa;this.cC=eb}get T_a(){return this.gia||(this.gia=Ab.a.instance.rb("Box4.ISelectionCommands"))}RFa(a,
b){if(!b)return!1;b=this.nd.Wp(D.a.typing);b.properties.$(Xc.a.source,"KeyUp");a=this.QZj(a);b.end();return a}QZj(a){a.qc.keyCode===A.a.mmb&&(this.ynb.SNc=!0);a.qc.ctrlKey&&this.IK.LOf(this.zh.mode,de.a.instance.Na,this.T_a,this.Ob.Wh,this.Ob.Ji,this.Ob.Dg,this.Nk.value.isEditingAllowed||this.Nk.value.hz);this.ds.isComposing&&(this.Iha.qGb(),this.Us.YY());this.cC.qvh(this.ds.JFa)&&(this.JAc.gch(a),this.cC.Zlb=!0,this.cC.typingProcess());this.od.om().scrollTop=0;return!1}}Object(n.a)(Kc,"KeyUpProcessor",
null,[]);class Zc{constructor(a){this.qzd=this.Zxd=this.uG=null;this.$d=a}get a8(){return this.uG||(this.uG=Ab.a.instance.resolve("Common.Utils.IAriaNotifier"))}Nqk(a){a&&(this.qzd=a,this.Zxd=new Le.a(2,1,500,Object(F.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),29),this.$d.Db(this.Zxd))}tryAriaNotifyParagraphLockedTask(a){this.qzd&&a&&this.Zxd===a&&this.a8.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.qzd),!0)}}Object(n.a)(Zc,
"LockedParagraphAriaNotifier",null,[]);class Sc{constructor(a){this.$H=a}lostFocus(a,b){u.AFrameworkApplication.Ug||b&&this.$H.Ss(!0,!1)}}Object(n.a)(Sc,"LostFocusEventProcessor",null,[]);class ld{constructor(a,b,c,f){this.ag=a;this.zh=b;this.Iha=c;this.Us=f}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&(this.ag.h++,c.scrollLeft=0,c.scrollTop=0,2===this.zh.mode&&(this.Iha.qGb(),this.Us.YY()))}}Object(n.a)(ld,"OnScrollProcessor",null,[]);var Dg=d(1116);class De{constructor(a,b,c,f){this.html=a;this.text=
b;this.Dwl=c;this.uXd=f}dispose(){this.uXd=null}}Object(n.a)(De,"OriginalElementContent",null,[106]);class gi{constructor(a,b,c){this.uVb=[];this.Obf=0;this.nd=a;this.CS=b;this.Yo=c}get v2d(){return this.Obf}get V8g(){return this.uVb}jGf(){for(let a=0;a<this.uVb.length;a++)this.uVb[a]&&(this.uVb[a].dispose(),this.uVb[a]=null)}pzh(a){this.jGf();a=a.ot;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,
Gc.a.G3d));if(b||Sys.UI.DomElement.containsCssClass(f,Gc.a.rN)||Sys.UI.DomElement.containsCssClass(f,da.a.kW)||Sys.UI.DomElement.containsCssClass(f,Gc.a.FN)){let l=b=null,w=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=za.a.zv(f):(l=this.Yo.o7d(f,this.nd,this.CS),w=new Dg.a(f));this.V8g[c]=new De(f.innerHTML,b,l,w)}Sys.UI.DomElement.containsCssClass(f,Gc.a.FN)&&(this.Obf=za.a.I9a(f))}}}Object(n.a)(gi,"OriginalElementContentArray",null,[1419]);class pk{constructor(a,b,c,f,l,w,H){this.Dh=
a;this.ag=l;this.nd=f;this.lj=H;this.yD=b;this.Tc=c;this.Yo=w}C_i(a,b,c){var f=this.Tc.Na.mb.Ua;const l=f.Qa;f=f.Lb;let w=0,H=0;a=a.ot;Array.clear(this.Dh.Gi);for(let Sa=0;Sa<a.length;Sa++){var U=a[Sa],ja=this.Yo.MI(U,this.ag,this.nd,this.lj);if(Sys.UI.DomElement.containsCssClass(U,Gc.a.rN))H<l?w+=ja:H<f&&(ja=oe.d(b,H))&&!ja.lCa&&(ja=T.a.Be(U,da.a.VFa),Array.add(this.Dh.Gi,new Kf(U,c.ot[ja],w,H,1))),H++;else if(Sys.UI.DomElement.containsCssClass(U,da.a.kW))w+=ja;else if(!Sys.UI.DomElement.containsCssClass(U,
Gc.a.FN)){if(H+ja>=l&&H<=f){let eb=T.a.Be(U,da.a.VFa);var wa=c.ot[eb];Sys.UI.DomElement.removeCssClass(wa,Gc.a.l8);Array.add(this.Dh.Gi,new Kf(U,wa,w,H,ja-(this.yD.w7?1:0)));for(U=this.Yo.MI(wa,this.ag,this.nd,this.lj);U<ja&&!(eb+1>=c.ot.length);)wa=c.ot[eb+1],U+=this.Yo.MI(wa,this.ag,this.nd,this.lj),wa.parentNode.removeChild(wa),Array.removeAt(c.ot,eb+1)}else if(H>f)break;w+=ja;H+=ja}}}}Object(n.a)(pk,"OvertypeDomPreparer",null,[]);var Kh=d(122),Yd=d(61);class Kk{constructor(a,b,c,f,l,w,H,U,ja,
wa,Sa,eb,ub,Ub,cc,Fc){this.CId=!1;this.$za=null;this.SWh=a;this.zh=b;this.zd=c;this.Tc=f;this.gra=l;this.jf=w;this.Nk=H;this.Kf=U;this.ds=ja;this.j7=wa;this.lj=Sa;this.Ob=eb;this.IK=ub;this.cC=Ub;this.fd=cc;this.ap=Fc}get XZ(){return this.$za||(this.$za=Ab.a.instance.rb("Box4.IClipboardCommands"))}sBl(){return 1===this.zh.mode?(this.CId&&this.zd.fg&&this.USd(),this.CId=!1,!0):!1}USd(){if(this.XZ){const a=new K.DictionaryPropertySet;a.setValue(Yd.a.JU,"<span></span>");this.XZ.d8(null,a,!1)}}cKe(a){const b=
this.Tc.hpa;return b.dne||b.qle?(Yc.a.Bn(a.qc),this.gra.epc(D.a.ACk),!0):!1}ohd(a){if(!this.jf.gua(de.a.instance.Na.mb))return!1;Yc.a.Bn(a.qc);this.gra.epc(D.a.ohd);return!0}qhd(a){if(!R.a.instance.ga(14))return!1;var b=de.a.instance.Na.ga(0);if(!Kh.a.instance.T8k(b))return!1;b=this.jf.gvc(de.a.instance.Na);this.SWh.Nqk(b);Yc.a.Bn(a.qc);this.gra.epc(2===this.zh.mode?D.a.hCl:D.a.qhd);return!0}WEh(a,b){let c,f;f=c=!1;if(!this.Nk.value.isEditingAllowed)return Yc.a.Bn(a.qc),{U3:!0,ANb:!0};if(!b)return{U3:!0,
ANb:!0};if(this.ohd(a)||this.Kf.Qd.Mb.Na.jH&&a.qc.type===sa.a.VWd)return{U3:!0,ANb:f};this.ds.isComposing=!0;b=this.qYe();if(!b&&this.j7.NYe()){if(this.cKe(a))return{U3:!0,ANb:f};this.lj&&this.IK.Djb(this.zh.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz);this.fd.hg&&this.fd.Yy?(Yc.a.Bn(a.qc),f=c=!0):this.j7.startHybridTransition()}else b&&this.Tc.setSelection(Od.SelectionFactory.Sg(de.a.instance.Na.mb.Ua.node,de.a.instance.Na.mb.Ua.Qa)),this.Tc.hpa.gtb(),this.fd.hg&&
this.fd.Yy?(Yc.a.Bn(a.qc),f=c=!0):this.zd.fg?(this.CId=!0,this.cC.EPa(a),c=!0):(this.USd(),Yc.a.Bn(a.qc));return{U3:c,ANb:f}}qYe(){if(!this.Tc.Na.Xda)return!1;var a=de.a.instance.Na.mb.Ua;return a.Qa!==a.Lb-1?!1:(a=oe.d(a.node,a.Qa))&&5===a.Wq?!0:!1}wjl(){if(!this.Tc.Na.Xda)return!1;const a=this.Tc.Na.mb.Ua;return!oe.d(a.node,a.Lb)||0<a.Qa&&!oe.d(a.node,a.Qa-1)||a.Qa===a.Lb?!1:!0}}Object(n.a)(Kk,"OvertypeUtils",null,[]);class zi{constructor(a,b,c,f,l,w){this.L2a=null;this.od=a;this.sQh=b;this.Kf=
c;this.zh=f;this.Ob=l;this.kId=w}get gJf(){return this.sQh}I5e(){if(2===this.zh.mode&&this.Kf.Qd.pp&&this.Ob.pVa(this.zh.mode)){var a=this.Ob.Wh,b=this.gJf.z9d(a.gb);this.kId.kkh(b,this.L2a,a,this.od.zg.uu,!1,!0);this.L2a=b}}}Object(n.a)(zi,"ParagraphOverlayPositioner",null,[]);class Vi{constructor(a,b){this.VEk=this.location=null;this.Iu=a;this.isRtl=b}}Object(n.a)(Vi,"OnShowFloatieEventArgs",null,[]);class hi{constructor(){this.type=0;this.payload=this.YJe=null;this.h2c=!1;this.EQa=this.style=this.FNe=
null}}Object(n.a)(hi,"PasteDataContext",null,[]);class xa{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug){this.FId=this.Clf=this.Qn=null;this.mLd=Tg;this.Sqa=Ug;this.Blf=a.ka("PasteClipboardImageInChromeIsEnabled");this.dZh=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.zJd=a.ka("ReadImageBlobForIE11UpIsEnabled");this.HPh=a.Bc("ClipboardDataImageBlobLimitaton",10);this.WWb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.hpf=a.ka("PasteInBootLoadingUIIsEnabled");
this.rLd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");this.$d=b;this.nd=c;this.Bk=f;this.Tc=l;this.zh=w;this.od=H;this.s2=U;this.Kf=ja;this.zd=wa;this.IK=Sa;this.Ob=eb;this.aha=ub;this.Nk=Ub;this.$za=cc;this.jk=Fc;this.YQh=Cc;this.gPa=Ud;this.vS=je;this.Ca=Vd;this.S6=Ve;this.Cqa=af;this.Tba=Zf;this.wBa=lg;this.$9e=[Object(F.a)(this,this.FCj,"imageClipboardDataHandler"),Object(F.a)(this,this.qGk,"plainTextClipboardDataHandler"),Object(F.a)(this,this.uBj,"htmlClipboardDataHandler")]}get XZ(){return this.$za.instance}get FJa(){return this.FId}vgj(a){switch(a){case "image/png":a=
1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get m1h(){return this.rLd||this.WWb}zuj(a){const b=new hi;b.type=this.vgj(a.type);b.payload=a.data;b.h2c=!0;this.Dnh(b)}kch(a,b){this.Tc.hpa.gtb();this.zh.Caa(0,!0,13);this.od.e0a(!0);const c=this.od.zg.uu.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.s2.gKk();this.Kf.Qd.Kza();this.zd.Aua?this.IK.NKa(this.zh.mode,this.Ob.Ji,this.Ob.Dg,this.Ob.Wh,this.Nk.value.isEditingAllowed||this.Nk.value.hz):
this.s2.nKc();return b}qmh(a){this.od.zg.uu.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.FJa&&!this.$d.ww)if(this.XZ||this.hpf){this.aha.BR&&(this.aha.BR=null);this.FId=this.Bk.oe(3);this.FJa.kd(b);b=new hi;b.EQa=this.wBa.S_e();b.EQa.THc("pasteHandler");b.h2c=!1;b.YJe=this.kch(this.vS.Hqd,b.YJe);if(c=this.jk.ida(a)){this.m1h&&this.gEk(c,b);for(let f=0;f<this.$9e.length&&this.$9e[f](a,c,b);++f);}this.Sqa&&a.preventDefault();u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");
!this.XZ&&this.hpf?this.Dnh(b):this.Cnh(b)}else ka.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.UNf}),this.Ca.ope(D.a.d8),a.preventDefault()}Dnh(a){ka.ULS.sendTraceTag(24492118,307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.Xoa();this.S6.Uj(6,()=>{this.nOi(a)})}Xoa(){this.Qn=this.Cqa();this.Qn.Ar=!1;this.Qn.yd=5;this.Qn.Xoa(null,null,null)}nOi(a){this.Qn&&(this.Qn.close(),this.Qn=null);ka.ULS.sendTraceTag(24492119,
307,50,"Clipboard commands available. Dismissing progress dialog.");this.Cnh(a)}Cnh(a){a=this.YQh.create(null,Object(F.a)(this,this.qPi,"doPasteOperation"),a);a.Pl("Browser Pasted (Editing Surface)");a.run()}FCj(a,b,c){if((this.Blf||this.zJd)&&(b=this.jk.E6d(a.rawEvent))&&this.jk.Kvd(this.od.om())){let f=null;if(({L8b:f}=this.jk.kud(b,this.HPh,this.vS.ajc)).returnValue)return c.type=1,c.payload=f,this.zJd&&this.zd.eX&&a.preventDefault(),!1}return!0}qGk(a,b,c){return this.dZh&&this.jk.aTj(b)&&(a=this.jk.M9d(b))?
(c.type=2,c.payload=a,!1):!0}uBj(a,b,c){return this.mLd&&(a=this.jk.R5b(b))?(c.type=3,c.payload=a,this.rLd&&c.style&&(c.payload+=c.style),!1):!0}qPi(a,b){var c=this.od.zg.uu.style;b&&this.vS.Hqd&&"hidden"===c.overflow&&this.qmh(b.YJe);if(c=this.od.om()){if(this.zd.Kua)for(var f=c.firstChild;f&&1===c.childNodes.length&&Hf.a(f);)c=f,f=f.firstChild;if(b&&(this.Blf||this.zJd)&&1===b.type&&this.jk.Kvd(c)&&(f=b.payload)){this.Clf=a;this.vS.g1b(f,l=>{this.tQf(this.Clf,l,b)});return}this.tQf(a,this.od.wgj(c),
b)}}Yrf(a){a=this.gPa.create(a,Object(F.a)(this,this.$Bh,"teardownPaste"),null);a.Pl("Aborting Paste in ContentEditableView");a.run()}tQf(a,b,c){this.zd.Gj&&(za.a.Cu(this.od.om()),this.zd.ala||this.od.zg.koa());if(this.Sqa&&!c)ka.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.Yrf(a);else{c.h2c&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.h2c;this.Sqa&&(f=!c.payload&&f);f?(ka.ULS.sendTraceTag(18437454,307,15,""),this.Yrf(a)):(c.style&&(b+=c.style),this.od.e0a(!0),f=new K.DictionaryPropertySet,
f.setValue(Yd.a.JU,b),f.setValue(Va.a.Ike,!0),f.setValue(Za.a.bO,!0),1===c.type&&this.vS.xrc?f.setValue(Yd.a.hXc,b):2===c.type&&c.payload?f.setValue(Yd.a.yhb,c.payload):3===c.type&&c.payload&&(this.Sqa?f.setValue(Yd.a.JU,c.payload):f.setValue(Yd.a.KKe,c.payload)),this.WWb&&c.FNe&&f.setValue(Yd.a.N$g,c.FNe),c.EQa&&f.setValue(Yd.a.EQa,c.EQa),a=this.gPa.create(a,Object(F.a)(this,this.Upi,"callPasteAction"),f),a.Pl("Paste in ContentEditableView"),a.run())}}Upi(a,b){this.XZ.d8(a,b,!0);a.Yg(Object(F.a)(this,
this.$Bh,"teardownPaste"));return!0}$Bh(a){this.zh.a1a();this.FJa&&(this.FJa.XU(a),this.FJa.dispose(),this.FId=null);a.Yg(Object(F.a)(this,this.uUd,"callPasteFloatie"));return!0}uUd(a,b){a=Object(qa.a)(K.DictionaryPropertySet,b);if(!a||a.sa(Yd.a.yhb,null)||a.sa(Yd.a.hXc,null))return!1;b=new Vi(1,u.AFrameworkApplication.isRtl);b.VEk=a.sa(Yd.a.JU,null);this.Tba.MPe(b);return!1}gEk(a,b){if(a=this.jk.TUf(a)){u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");
if(this.WWb){let c=this.jk.UUf(a);null===c?c="inaccessible":""===c&&(c="unknown");b.FNe=c}this.rLd&&(b.style=this.jk.aWi(a))}}}Object(n.a)(xa,"PasteHandler",null,[1418]);class sb{constructor(a,b,c,f,l){this.Qjf=new Ih.a(RegExp("\u00a0","g")," ");this.pqf=new Ih.a(new RegExp("["+ec.EAf+ec.peg+"]","g"),"");this.nd=a;this.ag=b;this.Wi=c;this.Yo=f;this.zd=l}Oti(a,b,c,f,l){if(l){l=!1;for(let ja=0;ja<a.length;++ja){const wa=b.V8g[ja];if(!wa)continue;const Sa=a[ja];var w=Sa.innerHTML,H=wa.html;if(w.length===
H.length||w===H)continue;if(lf.t_c(Sa))continue;l=!0;w=Sys.UI.DomElement.containsCssClass(Sa,da.a.kW);H=Sys.UI.DomElement.containsCssClass(Sa,Gc.a.rN);const eb=Sys.UI.DomElement.containsCssClass(Sa,Gc.a.FN);let ub=!1,Ub=!1;Sa.parentNode&&Sa.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Sa.parentNode.parentNode,Gc.a.G3d)&&(ub=Sa.parentNode.parentNode.firstChild===Sa.parentNode,Ub=Sa.parentNode.parentNode.lastChild===Sa.parentNode);var U=void 0;let cc;wa.text?(U=za.a.zv(Sa),cc=wa.text):
(U=this.Yo.o7d(Sa,this.nd,this.ag),cc=wa.Dwl);const Fc=this.Qjf.IJa(U).indexOf(this.Qjf.IJa(cc));if(0<=Fc){const Ic=this.pqf.IJa(ha.a.substring(U,0,Fc));U=this.pqf.IJa(ha.a.right(U,Fc+cc.length));0<Ic.length&&((eb||H||ub)&&0<ja?(this.Rdd(a[ja-1],Ic,!0,this.ag),this.Yo.wZc(Sa)&&(f-=ec.WNc)):w&&ja!==a.length-1&&this.Rdd(a[ja+1],Ic,!1,this.ag));0<U.length&&((H||Ub||w)&&ja!==a.length-1?(this.Rdd(a[ja+1],U,!1,this.ag),this.Yo.wZc(Sa)&&(f+=ec.A0d)):eb&&0<ja&&this.Rdd(a[ja-1],U,!0,this.ag))}else eb&&(this.zd.Gj||
this.zd.vo)&&1===cc.length&&!U.length?ka.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):eb&&this.zd.fg||ka.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),w=cc?cc.length:0,H=U.length,H>w&&(f-=H-w);wa.text?za.a.Nx(Sa,wa.text):(this.Yo.RWj(Sa)||wa.uXd.restore(),wa.uXd=new Dg.a(Sa))}l&&this.Wi.eT(f,c)}}Rdd(a,b,c,f){f.n++;c?za.a.Nx(a,za.a.zv(a)+b):za.a.Nx(a,b+za.a.zv(a))}}Object(n.a)(sb,"ReadOnlyObjectsCleaner",null,[]);class Jb{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,
Ub,cc,Fc,Ic,Cc,Ud,je){this.pia=0;this.od=a;this.$Kd=b;this.tK=c;this.ag=f;this.nd=l;this.WAc=w;this.Tc=H;this.Wi=U;this.Yo=ja;this.zd=wa;this.$e=Sa;this.jf=eb;this.Kf=ub;this.lj=Ub;this.JKd=cc;this.Um=Fc;this.sr=Ic;this.kVh=Cc;this.FSh=je}init(a){this.pia=a}Djb(a,b,c,f,l){if(this.od.isValid){var w=this.od.om();w&&w.firstChild&&1!==u.AFrameworkApplication.Aa.state&&(this.$Kd.XUf(this.Tc.Na),this.JUe(a,b,c,f,l))}}NKa(a,b,c,f,l){if(this.tK.rke()&&(!this.lj||this.$e.zdh))if(this.tK.setFocus(a,b,c,f,l),
this.zd.hV){a="Window.getSelection";b=this.od.om();if(this.zd.DT){if("none"===b.style.display){ka.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!za.a.nua(this.od.zg.Nza,b)){ka.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var w=this.Um.getSelection(this.od.contentWindow);w&&(a="Selection.removeAllRanges",this.Um.removeAllRanges(w),a="Selection.selectAllChildren",this.Um.u8k(w,b))}catch(H){w=za.a.I6f(b),ka.ULS.sendTraceTag(18437461,
324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?Kd.a.g1d(b):"",H.stack,b?b.style.display:"",w?w.tagName+","+w.id+","+w.className:"")}}else this.Um.JUe(this.od.cEa().Tl)}JUe(a,b,c,f,l){const w=this.Tc.Na.mb;try{if(this.tK.rke()&&(!this.lj||this.$e.zdh)){var H=w.Ua,U=w.Ye,ja=this.JKd.create(this.Kf.Qd);this.NKa(a,b,c,f,l);a=null;var wa=this.od.cEa();if(this.zd.hV){a=this.Um.getSelection(this.od.contentWindow);if(!a)return;if(this.Um.Hhj(a)){var Sa=this.Um.getRangeAt(a,
0);this.Um.removeAllRanges(a)}else Sa=this.Um.createRange(wa.Tl)}else if(this.zd.NF)Sa=wa.selection.createRange();else return;this.kVh&&this.adl(Sa);(this.jf.ik(H)||this.jf.Xl(H))&&this.y_i(H,Sa);this.jf.ik(U)&&this.z_i(U,Sa);this.zd.hV?this.Um.addRange(a,Sa):this.zd.NF&&Sa.select();ja.dispose()}}catch(eb){H=this.od.om(),ka.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",eb.message,eb.stack,H?Kd.a.g1d(H):"")}}z_i(a,b){var c=a.node.sc(this.pia).ot;let f=0,l=0,w=0;
a=a.Lb;for(var H=!1;f<c.length;){const U=this.Yo.MI(c[f],this.ag,this.nd,this.lj);if(H)w+=U;else if(Sys.UI.DomElement.containsCssClass(c[f],Gc.a.rN))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],da.a.kW)){if(a<=l+U)if(H=a-l,this.zd.hV){c=c[f];this.WAc.value.D0b(c,this.od.contentWindow);this.fsh(b,c,H,!1);break}else w=U-H,H=!0;l+=U}f++}this.zd.NF&&this.Um.moveEnd(b,-w)}y_i(a,b){var c=a.node.sc(this.pia).ot;let f=0;var l=0;let w=0,H=a.Qa;for(this.jf.Xl(a)&&(H=this.sr.textLength(a.node));f<c.length;)if(a=
this.Yo.MI(c[f],this.ag,this.nd,this.lj),Sys.UI.DomElement.containsCssClass(c[f],Gc.a.rN))l++,f++,w+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],da.a.kW))f++,w+=a;else if(this.FSh&&Sys.UI.DomElement.containsCssClass(c[f],Gc.a.E1d))f++,w+=a;else{if(H<=l+a){l=H-l;this.zd.hV?(c=c[f],this.WAc.value.D0b(c,this.od.contentWindow),this.fsh(b,c,l,!0)):this.Um.moveStart(b,w+l);break}l+=a;w+=a;f++}}fsh(a,b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&ka.ULS.sendTraceTag(18437465,
324,50,"Span is not normalized"):ka.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,w=null;b=za.a.GRc(b,!0);for(let H of b)if(3===H.nodeType){b=H.nodeValue.length;if(c<=l+b){this.Um.hMb(a,f,H,c-l);return}w=H;l+=b}w?(ka.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.Um.hMb(a,f,w,c-l)):ka.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}LOf(a,b,c,f,l,w,H){var U=this.Tc.hpa;if(U.dne||
U.qle)return!1;var ja=this.od.om();if(!ja.innerHTML.length)return!1;U=!1;if(this.zd.hV)(b=Kd.a.aEa(this.od.contentWindow))&&(this.Um.SUc(b)===ja?U=!0:this.lj&&Kd.a.fUj(b)&&Kd.a.eUj(b)&&(U=!0));else if(this.zd.NF){var wa=this.od.cEa().selection.createRange();wa=this.Um.lbj(wa.range);wa=wa.replace(ha.a.$Ac,"");ja=ja.innerHTML;ja=ja.replace(ha.a.$Ac,"");if(wa===ja)switch(a){case 2:U=!0;break;case 1:1<b.length||!(this.jf.$t(b.mb.Ua)||this.jf.Xl(b.mb.Ua)||this.jf.$t(b.mb.Ye)||this.jf.Xl(b.mb.Ye))||(U=
!0)}}if(!U)return!1;this.ag.by++;this.lj&&c?c.Osa():2===a?this.Wi.eT(this.Wi.sVa,f):1===a&&this.Djb(a,l,w,f,H);return!0}adl(a){a=za.a.GRc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=za.a.cka(b),a.startsWith("OutlineElement")&&(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(n.a)(Jb,"SelectContentHelper",null,[]);class uc{constructor(a,
b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){this.gia=this.eqa=this.Ve=null;this.zh=a;this.Wi=b;this.ag=ub;this.Ob=c;this.tf=f;this.od=l;this.$d=w;this.Um=H;this.Yo=U;this.nd=eb;this.Tc=ja;this.lj=cc;this.IK=wa;this.xV=Sa;this.Nk=Ub;this.eS=Fc}get T_a(){return this.gia||(this.gia=Ab.a.instance.rb("Box4.ISelectionCommands"))}NS(a){this.Ve=a}txj(a,b){if(!a)return!1;var c=this.zh.mode;if(2===c)if(!this.Wi.CIj)this.ag.b++,this.Wi.eT(this.Wi.sVa,this.Ob.Wh);else if(this.lj){if(500>(new Date).getTime()-this.tf.QAi)return this.Ve.Vtb.Oda=
!1;a=Kd.a.aEa(this.od.contentWindow);if(!a)return!1;if(Kd.a.f0c(a)){b=this.Wi.ZRc(c,this.Ob.Ji);if(this.Wi.sVa===b&&!this.Ve.Vtb.Oda)return this.eqa&&(this.$d.Mg(this.eqa),this.$d.Db(this.eqa)),!1;if(this.eS.Nud())return this.ag.c++,this.Ve.Vtb.Oda=!0,!1;if(this.Ve.Vtb.Oda)return this.ag.d++,this.tf.Daa(!0),this.Ve.Ss(!0),this.Ve.Vtb.Oda=!1;this.eqa||this.Ve.Ss(!0);ph.GrippersManager.instance.setVisibility(!1);this.Kbl();return!1}if(this.IK.LOf(c,de.a.instance.Na,this.T_a,this.Ob.Wh,this.Ob.Ji,this.Ob.Dg,
this.Nk.value.isEditingAllowed||this.Nk.value.hz))return this.ag.e++,!1;c=this.Yo.B9d(this.Um.SUc(a),this.Ob.Ji,this.Um.U7f(a),this.ag,this.nd,this.lj);a=this.Yo.B9d(this.Um.s$i(a),this.Ob.Ji,this.Um.h2f(a),this.ag,this.nd,this.lj);if(0>c||a<c||zb.ParagraphReader.textLength(b.node)<a)return!1;this.ag.f++;this.Tc.setSelection(Od.SelectionFactory.k3(b.node,c,a))}return!1}Kbl(){this.eqa?this.$d.Mg(this.eqa):this.eqa=new Le.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.$d.Db(this.eqa)}fixupAfterMagnifierDrag(){if(this.eqa){this.eqa=
null;var a=this.zh.mode;2===a&&this.Ob.pVa(a)&&(this.ag.g++,this.Wi.updateCaretPosition(a,this.Ob.Ji),this.tf.$Ka(!0),this.xV.fixupAfterCursor(5),this.Ve.Ss(!0),ph.GrippersManager.instance.vwh())}}}Object(n.a)(uc,"SelectionChangeHandler",null,[1416]);class Gd{constructor(a,b){this.od=a;this.RWb=b}XUf(a){this.tyf(this.od.om(),this.RWb+a.Rr,B.a.oki)}tyf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.PYk(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.tyf(a,
b,c))}PYk(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.RWb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else ka.ULS.sendTraceTag(18437474,324,50,"Class string for DOMElement is null")}}Object(n.a)(Gd,"SequenceCodeHelper",null,[1415]);class ee{constructor(a,b,c,f){this.ag=f;this.Wi=b;this.nd=c;this.$a=a}$Mk(a,b,c,f){if(a.Gi.length){var l=a.Gi[0].yF,w=za.a.zv(l);if((a=a.jGc)&&w&&w.length===a.length+1&&w.endsWith(" ")){var H=Kd.a.D8d(l);H&&((a=T.a.Be(l,da.a.VFa),
a=b.ot[a+1],a)?Kd.a.D8d(a)!==H&&(c=this.Wi.F8(c,f),f=za.a.zv(a),this.nd.Xb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.ag.q++,za.a.Nx(l,w.substring(0,w.length-1)),za.a.Nx(a," "+f),this.Wi.eT(c,b)):this.ag.p++)}}}Yqi(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.$a.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,Gc.a.y9))for(let w=0;w<l.childNodes.length;w++)this.wEf(l.childNodes[w],
w,b,a,c)&&w--;else this.wEf(l,f,b,a,c)&&f--}}wEf(a,b,c,f,l){const w=a.parentNode;f=w===f;if(3===a.nodeType){let H=-1;const U=a.nodeValue;let ja=null,wa="";if(b){const Sa=w.childNodes[b-1];if(Hf.a(Sa)&&(!f||zb.ParagraphReader.ae(Hf.a(Sa).gb))){for(ja=Sa;ja.lastChild&&1===ja.lastChild.nodeType;)ja=ja.lastChild;wa=ja.innerText+U}}if(!ja&&b!==w.childNodes.length-1&&(b=w.childNodes[b+1],Hf.a(b)&&(!f||zb.ParagraphReader.ae(Hf.a(b).gb)))){for(ja=b;ja.firstChild&&1===ja.firstChild.nodeType;)ja=ja.firstChild;
wa=U+ja.innerText}ja?(H=this.Wi.F8(c,w),this.nd.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.ag.r++,za.a.Nx(ja,wa)):(this.nd.Xb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),this.ag.s++);w.removeChild(a);-1!==H&&this.Wi.eT(H,l);return!0}return!1}PXk(a,b,c,f){if(B.a.fg&&a.Gi.length){var l=za.a.zv(a.Gi[0].yF),w=a.jGc;l&&w&&l.length===w.length+2?this.Cih(0,a,b,c,f):2===a.Gi.length&&this.Cih(1,a,b,c,f)}}Cih(a,b,c,f,l){c=this.Wi.F8(c,f);(f=za.a.zv(b.Gi[a].yF))&&f.endsWith("\u00a0 ")&&
(this.ag.t++,f=f.substr(0,f.lastIndexOf("\u00a0 "))+" ",b.Gi[a].yF.innerText=f,(0<a?c-(b.Gi[0].IIc+za.a.zv(b.Gi[0].yF).length):c-b.Gi[0].IIc)>f.length&&c--,this.Wi.eT(c,l))}}Object(n.a)(ee,"StrayTextCleanupUtils",null,[]);class se{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud){this.tha=null;this.NMd=a;this.$nb=b;this.YAd=c;this.nd=f;this.fia=l;this.zh=w;this.Tc=H;this.j7=U;this.zd=ja;this.tf=wa;this.Mk=Sa;this.cC=eb;this.Iha=ub;this.Us=Ub;this.PV=cc;this.pba=Fc;this.Ob=Ic;this.kPa=
Cc;this.fd=Ud}get dda(){return this.tha||(this.tha=Ab.a.instance.rb("Box4.IFormatPainter"))}rlb(a,b){if(!b)return!1;if(this.NMd.xuh)return a.qc.preventDefault(),!0;if(this.$nb.R7a&&this.zd.Aua)return this.$nb.R7a=!1,this.YAd.cancelEventAndRestoreEditingSurface(a.qc),!0;this.dda&&this.dda.yL&&(this.dda.yL=!1);this.Ssj(a.qc);b=this.nd.Wp(D.a.typing);b.properties.$(Xc.a.source,"TextInput");a=this.kwl(a);b.end();return a}kwl(a){this.fia.fixupAfterMagnifierDrag();if(1===this.zh.mode){if(this.PV.qYe())this.Tc.setSelection(Od.SelectionFactory.Sg(de.a.instance.Na.mb.Ua.node,
de.a.instance.Na.mb.Ua.Qa));else if(this.j7.NYe()){if(this.PV.cKe(a))return!1;this.j7.startHybridTransition()}this.zd.TI&&this.PV.USd()}this.pba.raiseEvent(jf.a.lwl,a);this.tf.Daa(!0);this.Mk.d2e=!0;this.cC.EPa(a);this.kPa&&this.kPa.PPl(this.Ob.Wh);this.Iha.qGb();this.Us.YY();return!1}Ssj(a){this.zd.fg||"deleteContentBackward"!==a.rawEvent.inputType||(this.Mk.G_d=!this.Mk.X2,this.Mk.G_d&&u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=se.UUd.ZRc(2,this.Ob.Ji),
a<se.UUd.sVa&&(a=Od.SelectionFactory.k3(this.Ob.Dg,a,se.UUd.sVa),u.AFrameworkApplication.Ta.La(D.a.sRa,2,a))))}static get UUd(){return se.Wi||(se.Wi=Ab.a.instance.resolve("Box4.ICaretPositionManager"))}}se.Wi=null;se.eS=null;se.$H=null;Object(n.a)(se,"TextInputEventProcessor",null,[]);class $e{constructor(a,b,c,f,l,w){this.tK=a;this.zd=b;this.$e=c;this.Mk=f;this.Nk=l;this.fd=w}get Bbb(){return this.fd.hg&&this.fd.Yy}get xuh(){if(this.tK.P8b||!this.Nk.value.isEditingAllowed&&this.Nk.value.hz&&!this.Bbb)return!0;
if(this.zd.q9){var a=this.$e.c_j;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.Mk.Qne;if(500>a&&a<b)return!0}}return!1}}Object(n.a)($e,"TextInputHandlerUtils",null,[]);var gg=d(518),Th=d(310);class Uh{constructor(a,b,c,f){this.lqa=null;this.zd=a;this.tK=b;this.Kf=c;this.jf=f}onContextMenu(a,b){let c=!1;this.zd.q9&&this.tK.m_c&&(b=this.jf.iub(this.Kf.Qd,b,this.Kf.Qd.bka(a),!1),this.jf.ox(b)&&(c=!0));c?(this.lqa=a.clientPoint,a=!0):(this.lqa=null,a=this.Kf.Qd.onContextMenu(a));return a}dlc(a){if(this.zd.q9&&
this.lqa){const b=Th.a.$2e;if(a.clientPoint.x>this.lqa.x+b||a.clientPoint.x<this.lqa.x-b||a.clientPoint.y>this.lqa.y+b||a.clientPoint.y<this.lqa.y-b)this.lqa=null}return!1}HHb(a){let b=!1;this.zd.q9&&this.lqa&&(b=this.Kf.Qd.onContextMenu(a),this.lqa=null);return b}}Object(n.a)(Uh,"TouchEventProcessor",null,[]);class Qj{create(a){return new xi(a)}}Object(n.a)(Qj,"TypingActionOperationFactory",null,[1413]);var Xd=d(73),Wf=d(250);class yk{constructor(a,b,c,f,l,w){this.Nqf=0;this.uhf=ia.a.nil;this.bUb=
this.Zzc=!1;this.lgf=4===Pc.App.mode;this.xCc=!1;this.z3h=new Ib.a;this.z3h.add(0,D.a.BSe);this.sFc=new Ib.a;this.sFc.add(0,0);this.cif=a;this.xnb=b;this.Kf=c;this.Ep=f;this.A3h=l;this.$yd=w;this.dhf=Object(F.a)(this,this.x2k,"reportTypingCharCount");u.AFrameworkApplication.vga(()=>{this.X5j()});this.$yd&&this.TVk();this.SVk();u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.ra(D.a.BSe,Xd.a.frame,ac.ActionManager.Ng,96)}TVk(){this.Ep&&this.Ep.addHandler(vd.a.my,this.dhf)}SVk(){this.xnb&&this.xnb.Suf(Object(F.a)(this,
this.uHc,"afterEditingViewValidateEventHandler"))}epc(a){this.cif.value&&0===this.cif.value.mode||(a=new xi(a),a.end(8),If.a.getInstance().ooc(a),mj.a.getInstance().noc(a))}r3g(a,b){if(!this.lgf&&Pc.App.Kb&&2===Pc.App.Kb.mode&&b&&b.graphNode&&zb.ParagraphReader.ae(b.graphNode)&&!oe.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.uhf){if(this.xCc){var c;(c=this.sFc).$(0,c.ga(0)+1);u.AFrameworkApplication.Ta.processAction(D.a.BSe,2);c="Paragraph rendering is blocked";this.A3h&&(c+=", so graph transaction manager is reset",
Wf.GraphTransactionManager.instance.pXe());ka.ULS.sendTraceTag(38547550,323,15,c)}this.uhf=a;this.xCc=!0}}else this.xCc=!1}uHc(a,b){this.lgf||!b.TM&&!b.VU||(!this.Zzc&&this.Kf.Qd&&(this.Kf.Qd.S$h(Object(F.a)(this,this.r3g,"onContentEditableViewClick")),this.Zzc=!0),this.xCc=!1)}x2k(){this.Nqf++}NJl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),ka.ULS.sendTraceTag(18437207,323,15,a))}X5j(){this.bUb||(this.$yd&&(ka.ULS.sendTraceTag(38114780,323,50,
""+this.Nqf),this.ROi(),this.$yd=!1),0<this.sFc.ga(0)&&ka.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.sFc.ga(0)),this.QOi(),this.bUb=!0)}ROi(){this.Ep&&this.Ep.removeHandler(vd.a.my,this.dhf)}QOi(){this.xnb&&this.xnb.XZk(Object(F.a)(this,this.uHc,"afterEditingViewValidateEventHandler"));this.Zzc&&this.Kf.Qd&&(this.Kf.Qd.a_k(Object(F.a)(this,this.r3g,"onContentEditableViewClick")),this.Zzc=!1)}}Object(n.a)(yk,"TypingLogger",null,[1311]);const ak=a=>{u.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&
(a.execute(b=>{b.Bbc("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};class Im{constructor(a){this.nZc=!1;this.T7a=5;this.q0g=!1;this.OFe=!0;this.mb=a}}Object(n.a)(Im,"TypingProcessState",null,[]);var ml=d(916);class Lk{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di){this.mia=this.Ve=null;this.Zlb=!1;this.Eud=null;this.z1c=0;this.XSb=a;this.Ob=b;this.lDd=c;this.Wi=f;this.y4a=
l;this.Ep=w;this.JAc=H;this.tZ=U;this.xV=ja;this.tf=wa;this.qqa=Sa;this.Tc=eb;this.wK=ub;this.Iha=Ub;this.nd=cc;this.ag=Fc;this.$H=Ic;this.$d=Cc;this.Mk=Ud;this.Dh=je;this.yD=Vd;this.yqa=Ve;this.aha=af;this.zd=Zf;this.Eha=lg;this.Bk=Tg;this.Us=Ug;this.s_h=ag;this.cMd=ih;this.ds=Vg;this.fd=di;this.ehf=0;this.Hcf=!1;this.dHj()}NS(a){this.Ve=a}get g1a(){return this.mia||(this.mia=Ab.a.instance.rb("Box4.ITextFormattingCommands"))}jCl(){Ue.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.fd.tsb();
try{this.z1c=0;if(this.Ve.CCk.sBl()||2!==this.tf.mode||!this.tf.isActive||u.AFrameworkApplication.Ug||!this.Ob.Dg||this.lDd.correctBadImeState())return;this.Wi.updateCaretPosition(this.tf.mode,this.Ob.Ji);this.y4a.I5e();this.$ti();this.Ep.raiseEvent(vd.a.typingProcess);if(!this.Ob.eRa||(2==Pc.App.mode||ml.a("SkipTypingProcessorDuringComposition"))&&this.ds.isComposing)return;const b=new Im(this.tZ.sta(this.xV.x9));if(this.JAc.MLk(b))return;b.nZc||(this.tf.Daa(!0),b.q0g=!0);this.TLk(b);if(!this.Ob.pVa(this.tf.mode))return;
const c=this.Ob.BW.gb;this.fd.hg&&(c.uGb=this.Tc.Na.mb.Ua.Qa);b.q0g&&R.a.instance.ga(50)&&this.qqa.value&&this.qqa.value.vw&&this.Tc.sYb();if(b.OFe){try{this.Iha.qGb()}catch(f){this.nd.Xb("PossibleEditSurfaceIncorrectSize",{["Reason"]:"MirrorToPageViewCrash"}),this.ag.l++,this.$H.Ss(!1,!1)}this.Us.YY();this.ds.JFa&&(this.$H.Ss(!0,!0),this.ssi())}}finally{a&&a.dispose()}Ue.c(18437510,306,100,"TypingProcessInternalExited")}ssi(){Pc.App.Kb.Yzj&&Pc.App.Kb.P5k()}EPa(a){this.JAc.gch(a);this.Zlb||(this.Zlb=
!0,this.$d.Db(this.Eud))}CLi(){if(!this.Mk.X2&&!this.Mk.ssa)return!1;const a=!this.qqa.value||this.qqa.value.amIAlone?Lk.brj:Lk.arj,b=this.XSb();-1===this.Mk.U1c&&(this.Mk.U1c=b);return b-this.Mk.U1c<a?(this.$d.Db(this.Eud),this.Zlb=!0):!1}typingProcess(){if(this.Zlb&&(this.Zlb=!1,this.ehf++,!this.$d.ww&&this.Ob.pVa(this.tf.mode)&&!(this.wK&&this.wK.gab()||this.CLi()))){var a=this.nd.Wp(D.a.typingProcess);this.jCl();a.end();this.Hcf||this.ehf!==Lk.Tri||((a=Ab.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&
ak(a),this.Hcf=!0)}}$ti(){if(this.ds.JFa){if(this.Dh.rsf())if((this.zd.RF||this.zd.vo)&&this.yD.w7){const a=this.Wi.F8(this.tf.mode,this.Ob.Ji);this.yD.akb(!1,this.Ob.Ji,this.Dh);this.Wi.eT(a,this.Ob.Wh)}else this.yD.akb(!1,this.Ob.Ji,this.Dh);this.s_h.Oti(this.Ob.Wh.ot,this.yqa,this.Ob.Wh,this.Wi.F8(this.tf.mode,this.Ob.Ji),this.ds.JFa);this.cMd.Yqi(this.Ob.Ji,this.tf.mode,this.Ob.Wh);this.cMd.$Mk(this.Dh,this.Ob.Wh,this.tf.mode,this.Ob.Ji);this.Dh.UXk();this.cMd.PXk(this.Dh,this.tf.mode,this.Ob.Ji,
this.Ob.Wh)}}TLk(a){this.aha.BR?(this.aha.HFk(),a.OFe=!1):this.Eha.instance&&this.Eha.instance.Ice()&&!this.zd.SNb&&(this.ds.JFa&&this.g1a?(this.Dfi(a.mb),a.OFe=!1):this.Eha.instance.w_a())}Dfi(a){if(this.g1a&&this.Eha.instance){this.Eha.instance.freeze();var b=de.a.instance.Na.mb,c=this.Bk.oe(15);c.kd(this.Ob.Dg.node);a=Od.SelectionFactory.GN(a,b.Ua);this.g1a.WLb(a.Ua,!0);this.Eha.instance.o2e();this.Eha.instance.w_a();this.Ob.Wh&&this.Tc.setSelection(this.tZ.sta(this.xV.x9));c.dispose();this.tf.Daa(!0);
this.$H.Ss(!0,!1)}}dHj(){let a=1;B.a.vo&&(a=u.AFrameworkApplication.fa.Bc("Box4TypingTaskTimeEdge",1));this.Eud=new Le.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.Eud=null}qvh(a){return this.zd.q9&&a?this.aha.BR||this.z1c>Lk.rmk||this.Eha.instance&&this.Eha.instance.Ice()||this.yD.w7?!0:!1:!1}}Lk.rmk=7;Lk.arj=250;Lk.brj=2E3;Lk.Tri=500;Object(n.a)(Lk,"TypingProcessManager",null,[1412,106]);class Jm{constructor(){this.Pa=new vc.a}iPk(a){this.Pa.raiseEvent("OnDismissPasteFloatie",a)}oPk(){this.Pa.raiseEvent("OnExpandMenuPasteFloatie")}Vkd(a){this.Pa.raiseEvent("OnPastedContentUpdated",
a)}MPe(a){this.Pa.raiseEvent("OnShowPasteFloatie",a)}Cai(a){this.Pa.addHandler("OnPastedContentUpdated",a)}eai(a){this.Pa.addHandler("OnDismissPasteFloatie",a)}kai(a){this.Pa.addHandler("OnExpandMenuPasteFloatie",a)}Yai(a){this.Pa.addHandler("OnShowPasteFloatie",a)}}Object(n.a)(Jm,"PasteFloatieEventSource",null,[1409,1410,1411]);var Mk=d(880),vh=d(132),Ij=d(321),nj=d(404),am=d(228),pn=d(835);class lm{constructor(){this.Da=null}get name(){return"Box4.ContentEditableView"}Zb(a){this.Da=a;a.register(gg.a,
"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().oa(()=>new gg.a);a.register(Tf,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().oa(()=>new Tf);a.register(Yg,"Box4.EventFrequencyTracker").ma().oa(()=>new Yg);a.register(Td,"Box4.CevUsageDataTracker").ma().oa(()=>new Td);a.register(ef,"Box4.ContentEditableViewEventSource").ma().oa(()=>new ef);a.register(Fe,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().oa(()=>new Fe(Nc.a.instance,
Lc.a.instance.u6d(),a.resolve("Box4.TextNodeCombiner")));a.register(gi,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().oa(()=>new gi(Nc.a.instance,Lc.a.instance.u6d(),lf.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(aj,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().oa(()=>new aj);a.register(Jd,"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().oa(()=>new Jd(a.resolve("Box4.IEditingDomManager")));a.register(Zj,
"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().oa(()=>new Zj(a.resolve("Box4.EditStateEventManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));a.register(1311,"Box4.ITypingLogger").ma().oa(()=>new yk(a.ke("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),na.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),
a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(Cd,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().oa(()=>new Cd(a.ke("Box4.ITextNodeCombiner"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.EditingDomManager"),lf.instance,id.a.instance,na.InteractiveViewManager.instance,u.AFrameworkApplication.ye,id.a.instance.Pi,Mk.a.instance,a.resolve("Common.IScrollLockFactory"),
a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(Dh,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().oa(()=>new Dh(a.resolve("Box4.EditingDomManager"),na.InteractiveViewManager.instance,a.resolve("Box4.IExternalSelectionManager"),id.a.instance.Pi,Ed.a.instance,id.a.instance,y.FocusManager.instance()));a.register(sb,"Box4.ReadOnlyObjectsCleaner").ma().oa(()=>new sb(Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,
a.resolve("Box4.CaretPositionManager"),lf.instance,id.a.instance));a.register(ee,"Box4.StrayTextCleanupUtils").ma().oa(()=>new ee(u.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI));a.register(1312,"Box4.IContentEditableViewContentControlHelper").ma().oa(()=>new yf(Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,id.a.instance.Pi,lf.instance,na.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(Df,
"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().oa(()=>new Df(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").vI,Nc.a.instance,a.rb("Box4.IHyperlinkEditor"),id.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),Mk.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),
a.resolve("Common.IAppSettingsManager")));a.register(Ge,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().oa(()=>new Ge(a.Ja("Common.ITypingSpeedMeterProvider"),na.InteractiveViewManager.instance));a.register(Wg,"Box4.ContentEditableViewTypingState").ma().oa(()=>new Wg(u.AFrameworkApplication.Ta));a.register(fb,"Box4.ContentEditableHtmlStructureUtils").ma().oa(()=>new fb(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(Gd,"Box4.SequenceCodeHelper").ma().oa(()=>
new Gd(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").Zph));a.register(Jb,"Box4.SelectContentHelper").ma().oa(()=>new Jb(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").vI,Nc.a.instance,a.ke("Box4.ITextNodeCombiner"),de.a.instance,a.resolve("Box4.ICaretPositionManager"),lf.instance,id.a.instance,Ja.EventHandlerManager.instance,Ij.a.instance,na.InteractiveViewManager.instance,
id.a.instance.Pi,a.resolve("Common.ScrollLockFactory"),Mk.a.instance,a.resolve("Box4.IParagraphReader"),rb.ListReader.qx,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(sf,"Box4.EditingDomDisplayManipulator").ma().oa(()=>new sf(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),
u.AFrameworkApplication.fa,na.InteractiveViewManager.instance));a.register(yd,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().oa(()=>new yd(a.resolve("Box4.ContentEditableViewEventSource")));a.register(ya,"Box4.InteractiveViewSynchronizer").ma().oa(()=>new ya(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CevUsageDataTracker").vI,Nc.a.instance,id.a.instance.Pi,a.resolve("Box4.Graph.IGraphIteratorFactory"),lf.instance,na.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),
a.resolve("Box4.ICevViewContentManager")));a.register($h,"Box4.CurrentEditSelectionProvider").ma().oa(()=>new $h(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").vI,Nc.a.instance,lf.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),id.a.instance.Pi,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Qe,"Box4.BackspaceInBrowserHandler").ma().oa(()=>new Qe(a.resolve("Box4.CurrentEditSelectionProvider"),id.a.instance.Pi,
Kh.a.instance,Ij.a.instance,a.resolve("Box4.IExternalSelectionManager"),am.a.instance,u.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Ja("Box4.IAutoCorrectScheduler"):null));a.register(pk,"Box4.OvertypeDomPreparer").ma().oa(()=>new pk(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),
de.a.instance,Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,lf.instance,id.a.instance.Pi,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Ph,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().oa(()=>new Ph(Ij.a.instance,de.a.instance,Nc.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.EditStateEventManager"),na.InteractiveViewManager.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),id.a.instance,
a.resolve("Box4.SelectContentHelper"),new kc.a(()=>Pc.App.Kb.Ld),a.Ja("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Jm,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().oa(()=>
new Jm);a.register(tf,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().oa(()=>new tf);a.register(re,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().oa(()=>new re(a.Ja("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Ja("Common.IZoomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),id.a.instance,na.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.IRotatingCoordinateConverter")));a.register(Qh,"Box4.EditingSurfaceStateManager").ma().oa(()=>new Qh);a.register(Qi,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().oa(()=>new Qi(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),u.AFrameworkApplication.ye,a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new kc.a(()=>Pc.App.Kb.Ld),id.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),de.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),na.InteractiveViewManager.instance,Ij.a.instance,a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(zi,"Box4.ParagraphOverlayPositioner").ma().oa(()=>
new zi(a.resolve("Box4.IEditingDomManager"),new pn.a,na.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(Ch,"Box4.ContentEditableViewDebugLogger").ma().oa(()=>new Ch);a.register(Zg,"Box4.ImeRecoveryUtils").ma().oa(()=>new Zg(id.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.ContentEditableViewDebugLogger"),Mk.a.instance));a.register($f,"Box4.AutocorrectActionExecutor").ma().oa(()=>new $f(a.Ja("Box4.IAutoCorrectScheduler"),a.Ja("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),
a.ke("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),de.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(xa,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().oa(()=>new xa(a.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.ye,Nc.a.instance,
a.resolve("Box4.Graph.IGraphTransactionFactory"),de.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),na.InteractiveViewManager.instance,id.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new kc.a(()=>Pc.App.Kb.Ld),a.Ja("Box4.IClipboardCommands"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),
a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),u.AFrameworkApplication.Ta,db.a.get_instance(),()=>new zc.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),Pc.App.instance.g$b,Pc.App.instance.KMb));a.register(Vf,"Box4.ContentEditableViewCursorManager").ma().oa(()=>new Vf(na.InteractiveViewManager.instance,Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,id.a.instance.Pi,de.a.instance,
Ij.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new kc.a(()=>Pc.App.Kb.Ld),u.AFrameworkApplication.Ta,a.resolve("Box4.IEditViewStateManager"),u.AFrameworkApplication.ye,id.a.instance,a.resolve("Box4.ICaretPositionManager"),lf.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),
new Hd,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.rb("Box4.CharacterPointConverter")));a.register(uc,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().oa(()=>new uc(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.ye,Mk.a.instance,lf.instance,de.a.instance,a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.ContentEditableViewCursorManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,new kc.a(()=>Pc.App.Kb.Ld),id.a.instance.Pi,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(Bj,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().oa(()=>new Bj(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),a.ke("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),na.InteractiveViewManager.instance,u.AFrameworkApplication.ye,new kc.a(()=>Pc.App.Kb.Ld),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),de.a.instance,Kh.a.instance));a.register(bd,"Box4.CompositionStateManager").ma().oa(()=>
new bd(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(yi,"Box4.ImeManager").ma().oa(()=>new yi(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),na.InteractiveViewManager.instance));a.register(pg,"Box4.DragStateManager").ma().oa(()=>new pg(id.a.instance));a.register(Uh,"Box4.TouchEventProcessor").ma().oa(()=>
new Uh(id.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),na.InteractiveViewManager.instance,Ij.a.instance));a.register(Bf,"Box4.AppFrameResizeEventProcessor").ma().oa(()=>new Bf(a.resolve("Box4.BoundsSynchronizer")));a.register(ld,"Box4.OnScrollProcessor").ma().oa(()=>new ld(a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer")));a.register(Og,"Box4.EditingSurfaceEventHandlerUtils").ma().oa(()=>
new Og(Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.IEditingModeTransitionManager")));a.register(lj,"Box4.DragEventsProcessor").ma().oa(()=>new lj(id.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(zg,"Box4.DoubleClickProcessor").ma().oa(()=>new zg(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),na.InteractiveViewManager.instance));a.register(rg,
"Box4.DomChangeEventProcessor").ma().oa(()=>new rg(id.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),Nc.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register($e,"Box4.TextInputHandlerUtils").ma().oa(()=>new $e(a.resolve("Box4.IContentEditableViewFocusHelper"),id.a.instance,Ja.EventHandlerManager.instance,
a.resolve("Box4.ContentEditableViewTypingState"),new kc.a(()=>Pc.App.Kb.Ld),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(yh,"Box4.ContentEditableViewGraphUpdater").ma().oa(()=>new yh(Ad.a.instance,a.resolve("Box4.EditingModeTransitionManager"),Nc.a.instance,de.a.instance,a.resolve("Box4.IExternalSelectionManager"),Ij.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.HybridTransitionManager"),u.AFrameworkApplication.ye,id.a.instance,a.Ja("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),a.rb("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(Aa,"Box4.KeyEntryProcessor").ma().oa(()=>
new Aa(lf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").vI,Nc.a.instance,id.a.instance.Pi,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),Ij.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.EditViewStateManager")));a.register(xd,"Box4.KeyQueueProcessor").ma().oa(()=>new xd(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),Ij.a.instance,de.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(Lk,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().oa(()=>new Lk(Kd.a.vj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new kc.a(()=>Pc.App.Jh),de.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.ContentEditableViewGraphUpdater"),
u.AFrameworkApplication.ye,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),id.a.instance,a.Ja("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Kk,"Box4.OvertypeUtils").ma().oa(()=>new Kk(new Zc(u.AFrameworkApplication.ye),a.resolve("Box4.EditingModeTransitionManager"),id.a.instance,de.a.instance,a.resolve("Box4.ITypingLogger"),Ij.a.instance,new kc.a(()=>Pc.App.Kb.Ld),na.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.HybridTransitionManager"),id.a.instance.Pi,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(lh,"Box4.ContentEditableViewFloatieHandler").ma().oa(()=>new lh);a.register(Kc,"Box4.KeyUpProcessor").ma().oa(()=>new Kc(Nc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new kc.a(()=>Pc.App.Kb.Ld),
a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(lc,"Box4.KeyPressProcessor").ma().oa(()=>new lc(id.a.instance,Mk.a.instance,Nc.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new kc.a(()=>
Pc.App.Kb.Ld),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),de.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),lf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new kc.a(()=>
Pc.App.Jh),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Ja("Common.ITypingSpeedMeterProvider"),b,vh.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.rb("Common.IEventTimingMeter")));a.register(ba,"Box4.KeyDownProcessor").ma().oa(()=>new ba(a.Ja("Common.ITypingSpeedMeterProvider"),id.a.instance.Pi,u.AFrameworkApplication.ye,
a.resolve("Box4.IEditingDomManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),id.a.instance,Mk.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),Ij.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new kc.a(()=>
Pc.App.Jh),de.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.ke("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new kc.a(()=>Pc.App.Kb.Ld),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.rb("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),nj.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.Ja("Box4.IAutoCorrectScheduler"):null,u.AFrameworkApplication.fa,a.rb("Box4.IHyperlinkEditor")));a.register(Zh,"Box4.ContentEditableViewOnAfterValidateHandler").ma().oa(()=>new Zh(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),na.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),
a.resolve("Box4.IContentEditableViewPaddingManager"),id.a.instance,a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.ke("Box4.ITextNodeCombiner"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),de.a.instance,id.a.instance.Pi,a.resolve("Box4.SelectContentHelper"),new kc.a(()=>Pc.App.Kb.Ld),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.rb("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.rb("Box4.IFeatureHelper"),u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")));a.register(Pi,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().oa(()=>new Pi(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));a.register(Mh,"Box4.CompositionEventProcessor").ma().oa(()=>new Mh(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),Nc.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),
a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(se,"Box4.TextInputEventProcessor").ma().oa(()=>new se(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),Nc.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),
de.a.instance,a.resolve("Box4.HybridTransitionManager"),id.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),a.rb("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Sc,
"Box4.LostFocusEventProcessor").ma().oa(()=>new Sc(a.resolve("Box4.ContentEditableViewGraphUpdater")));a.register(Jh,"Box4.EditingSurfaceEventHandlerManager").ma().oa(()=>new Jh(u.AFrameworkApplication.ye,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),
a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));
a.register(xg,"Box4.ContentEditableViewDisposer").ma().oa(()=>new xg(a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").vI,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));a.register(Qj,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().oa(()=>new Qj);a.register(1313,
"Box4.IContentEditableModeHelper").ma().oa(()=>new Qb);a.register(Uf,"Box4.ContentEditableView").as("Box4.IEditingView").ma().oa(()=>new Uf(na.InteractiveViewManager.instance,de.a.instance,new kc.a(()=>Pc.App.Kb.Ld),a.Ja("Common.IActivityAggregationInfo"),a.Ja("Common.IZoomManager"),u.AFrameworkApplication.Ta,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.IContentEditableDomFactory"),Pc.App.WLa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Da.resolve("Box4.EditingModeTransitionManager").WZb(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.BoundsSynchronizer").WZb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ImeRecoveryUtils").WZb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.AutocorrectActionExecutor").NS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewCursorManager").jji(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.SelectionChangeHandler").NS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.HybridTransitionManager").NS(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.ContentEditableViewGraphUpdater").NS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.TypingProcessManager").NS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnAfterValidateHandler").NS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").NS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.EditingSurfaceEventHandlerManager").NS(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.CompositionEventProcessor").NS(this.Da.resolve("Box4.ContentEditableView"))}dispose(){}static main(){v.a.instance.Dc(new lm)}}Object(n.a)(lm,"ContentEditableViewPackage",null,[2,3]);class Km{get name(){return"PowerPointWebEditor.AutoFit"}Zb(){}init(){}dispose(){}static main(){v.a.instance.Dc(new Km)}}Object(n.a)(Km,"PPTWebEditorAutoFitPackage",null,[2,3]);class mm{constructor(a){this.Vw=a}}Object(n.a)(mm,"DynamicScriptLoaderProvider",null,[1563]);var $k=d(354),nl=d(240),Af=d(313);
const yl=(a,b)=>{var c=oj(b);c=a.identifier+c+".js";let f="";f=a.isLocalized?f+(u.AFrameworkApplication.lcid+"/"):f+zl(b);return f+c},oj=()=>u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"":u.AFrameworkApplication.fa.Eu("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",zl=a=>a&&u.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")&&!u.AFrameworkApplication.fa.ka("AppChromeOverrideIsCombinedBundle")&&!u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?
"exp/":"",Bm=(a="anonymous",b="dynamicScriptLoaderDependencies")=>{const c={resolveScript:f=>{var l=$k.AppChromeOverrideUtilities.ykg(c.knownScripts,f.identifier);if($k.AppChromeOverrideUtilities.isEnabled&&l)l=f.isLocalized?$k.AppChromeOverrideUtilities.r4f(u.AFrameworkApplication.lcid):$k.AppChromeOverrideUtilities.iLb,f.isLocalized||(l+=zl(!0)),f=l+f.identifier+$k.AppChromeOverrideUtilities.hQc+".js";else if(Af.a.instance.isEnabled){var w=u.AFrameworkApplication.tga;f=yl(f,l);Af.a.instance.isEnabled&&
(l=Af.a.instance.b8d(u.AFrameworkApplication.s1+f))&&(w=l+u.AFrameworkApplication.s1);ka.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+f);f=w+f}else if(w=oj(l),u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",!1))f.isLocalized?f=u.AFrameworkApplication.Bj(f.identifier+w,3):(f=zl(l)+f.identifier,f=u.AFrameworkApplication.Bj(f+w+".js",5));else{var H=u.AFrameworkApplication.tga;H=f.isLocalized?
H+(u.AFrameworkApplication.lcid+"/"):H+zl(l);f=H+f.identifier+w+".js"}return f},resolveSriHash:f=>{const l=$k.AppChromeOverrideUtilities.ykg(c.knownScripts,f.identifier);Af.a.instance.isEnabled?(f=yl(f,l),f=Af.a.instance.Glj(u.AFrameworkApplication.s1+f)):f=null;return f}};c.crossOriginAttributeValue=a;c.knownScripts=window[b];return c};var va=d(28),Ki=d(656);class Jj{constructor(){this.Bye=this.B$=this.K=null;this.$Eg=this.yCg=!1}get name(){return"PowerPointWebEditor.DynamicScriptLoader"}Zb(a){if(!a)throw Error.argumentNull("container");
this.K=a;this.B$=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.K.register(mm,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").ma().oa(()=>{var b=window.self.EarlyDynamicScriptLoader;if(void 0===b||null===b){b=Bm();if(Ki.a.wPj){const c=b.resolveScript;b.resolveScript=f=>{let l=Ki.a.b4e(f.identifier+($k.AppChromeOverrideUtilities.isEnabled?$k.AppChromeOverrideUtilities.hQc:".min")+".js");l||(l=c(f));return l}}this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseManagedScriptResourceLoading&&
(b.loadScriptHandler=Object(F.a)(this,this.loadScript,"loadScript"));return new mm(new dynamicScriptLoader.DynamicScriptLoader(b))}u.AFrameworkApplication.fa.ka("EnableDefaultDSLImpl")||b.M7e&&b.M7e(Object(F.a)(this,this.loadScript,"loadScript"));return new mm(b)});this.yCg=u.AFrameworkApplication.fa.ka("EarlyLazySprite");this.$Eg=u.AFrameworkApplication.fa.ka("RibbonShimmerExperimentEnabled");u.AFrameworkApplication.fa.ka("LoadSLideGridJSEarly")&&Jj.Opc.push("slidegrid");Jj.Opc.push("comment-pane-strings");
Jj.Opc.push("sharedcomments");Jj.Opc.push("floatingcontainermanager")}loadScript(a,b){let c=this.Bye;c&&c.isCompleted&&(this.Bye=c=null);const f=this.yCg&&Array.contains(Jj.Opc,a),l=u.AFrameworkApplication.fa.ka("BootFilesInDelayScriptFactory")&&Array.contains(Jj.d6k,a)?this.B$.qDi(b,Array.contains(Jj.Tnh,a),!(this.$Eg&&Array.contains(Jj.y6k,a))):this.B$.YYd(b,null,Array.contains(Jj.Tnh,a));f||(this.Bye=l.ZFa);return new Promise((w,H)=>{const U=Date.now(),ja=()=>{l.ZFa.continueWith(wa=>{if(6===wa.status)w(a);
else{let Sa=String.format("Failed to download the script with identifier: {0} at url: {1}.",a,b);wa.$i&&(Sa+=" "+wa.$i.message);H(Error.create(Sa))}});va.a.J(540113033,813,50,"LoadScript:: Identifier:{0}, DelayInMs:{1}",a,Date.now()-U);nl.a.fy(l)};!c||f?ja():c.continueWith(()=>{ja()})})}init(){}dispose(){}}Jj.Tnh=["common","powerpoint-ribbon-intl","appChrome"];Jj.Opc="ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");
Jj.d6k="common common50 ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");Jj.y6k=["common","appchrome"];Object(n.a)(Jj,"DynamicScriptLoaderPackage",null,[2,3]);var al=d(278),gh=d(109),Nk=d(176),Pd=d(35);class bl{constructor(a,b,c,f,l){this.n8j=a;this.Tck=b;this.Xa=c;this.bGb=f;this.Ds=l}AZf(a){var b;return Object(al.a)(this,void 0,void 0,function*(){try{const f=null!==
(b=a.CorrelationId)&&void 0!==b?b:gh.a.create().toString();va.a.J(509214920,817,50,`CopilotProxy::generateAndMergeSlides: Correlation=${f}`);var c=yield this.f3i(a);if(!c||!c.DownloadablePPTInfos||0==c.DownloadablePPTInfos.length)return va.a.J(509214919,817,10,"CopilotProxy::generateAndMergeSlides: generatePPTFromOutline returned invalid response"),!1;const l=c.DownloadablePPTInfos[0].DownloadUrl;if(!l)return va.a.J(509163081,817,10,`CopilotProxy::generateAndMergeSlides: generatePPTFromOutline failed; error code: ${c.DownloadablePPTInfos[0].ErrorCode}.`),
!1;c={};c.PodSID=this.Xa.podSessionId;c.Client=a.ClientName;Object(Pd.a)("PptCreatorAddScenarioInHeader")&&(c.Scenario="ReplaceAll"===a.MergeAction?"Create":"Insert");c["X-UserSessionId"]=this.bGb;c["X-CorrelationId"]=f;yield this.send({Oua:"mergeGeneratedSlides",url:this.Tck,payload:JSON.stringify({DownloadUrl:l,MergeAction:a.MergeAction,InsertPosition:a.InsertPosition}),headers:c});return!0}catch(f){return va.a.J(509214918,817,10,`CopilotProxy::generateAndMergeSlides: ${f}`),!1}})}f3i(a){var b;
return Object(al.a)(this,void 0,void 0,function*(){const c=null!==(b=a.CorrelationId)&&void 0!==b?b:gh.a.create().toString();va.a.J(509214917,817,50,`CopilotProxy::generatePPTFromOutline: Correlation=${c}`);const f={};f.Client=a.ClientName;Object(Pd.a)("PptCreatorAddScenarioInHeader")&&(f.Scenario="ReplaceAll"===a.MergeAction?"Create":"Insert");f["X-CorrelationId"]=c;f["X-UserSessionId"]=this.bGb;try{const l=yield this.send({Oua:"generatePPTFromOutline",url:`${this.n8j}?action=OutlineToPPT`,payload:JSON.stringify(a.OutlineInput),
headers:f});return JSON.parse(l)}catch(l){va.a.J(509214916,817,50,`CopilotProxy::generatePPTFromOutline: exception: ${l}`)}})}send(a){return new Promise((b,c)=>{const f=new Date;this.Ds.nj(a.url,2,a.payload,a.headers,!1,0,l=>{var w;va.a.J(509214915,817,50,`CopilotProxy::${a.Oua}: Time Taken ${+new Date-+f}`);l.data.ie!==Nk.a.Wv&&(va.a.J(509214914,817,10,`CopilotProxy::${a.Oua}: Bad Http Status ${l.data.ie}`),c(`Bad Http Status ${l.data.ie}`));va.a.J(509214913,817,50,`CopilotProxy::${a.Oua}: call successful`);
b(null!==(w=l.data.Wd)&&void 0!==w?w:"")},l=>{var w,H;const U=new Date;va.a.J(509214912,817,15,`CopilotProxy::${a.Oua}: request failed Status: ${null===(w=null===l||void 0===l?void 0:l.data)||void 0===w?void 0:w.ie}, Time Taken ${+U-+f}`);c(`${a.Oua} failed with ${null===(H=null===l||void 0===l?void 0:l.data)||void 0===H?void 0:H.ie}`)},null)})}}Object(n.a)(bl,"CopilotProxy",null,[1342]);class Lm{constructor(a,b,c,f){this.l8j=5;this.Sre=0;this.Qfc="ReplaceAll";this.Yug="colorSchemeTextArea";this.yWg=
"themeIdsTextArea";this.kRg="presOutlineTextArea";this.bse="CopilotStatusBarDebugUI";this.oHg="CopilotLogPanelId";this.xBf=l=>{l.innerText="";const w=this.oc.twb();for(let H=0;H<w.length;++H){const U=w[H],ja=document.createElement("option");ja.value=U.sid+";"+U.cid;ja.textContent=""+(H+1);l.appendChild(ja)}(l=l.options[l.selectedIndex].value.split(";"))&&2===l.length&&(this.KBg={ReferenceSlide:{Sid:parseInt(l[0]),Cid:parseInt(l[1])},InsertBefore:!1})};this.Fxk=()=>{const l=document.getElementById("InsertPositionSelect");
l&&this.xBf(l)};this.iWa=a;this.ese={ColorScheme:b.Ga("CopilotTestDefaultColorScheme"),ThemeIds:b.Ga("CopilotTestDefaultThemeIds"),PresOutline:b.Ga("CopilotTestDefaultPresOutline")};this.oc=c;this.FEb=f;this.FEb.wF(this.Fxk);document.getElementById("StatusBar").addEventListener("contextmenu",()=>{this.Sre++;this.Sre>=this.l8j&&(this.hml(),this.Sre=0)})}hml(){if(!document.getElementById(this.bse)){var a=document.createElement("div");a.id=this.bse;a.setAttribute("style","position: absolute; right: 0; bottom: 24px; display: block; z-Index: 10001; border:1px solid gray; padding: 10px; background-color:#f1f1f1");
a.appendChild(this.zTd("Color Scheme",this.Yug,this.ese.ColorScheme,"100px"));a.appendChild(this.zTd("Theme Ids",this.yWg,this.ese.ThemeIds,"30px"));a.appendChild(this.zTd("Presentation Outline",this.kRg,this.ese.PresOutline,void 0));a.appendChild(this.Kli());a.appendChild(this.rmi());a.appendChild(this.Ili());document.body.appendChild(a);"ReplaceAll"==this.Qfc?this.upd(!1):this.upd(!0)}}zTd(a,b,c,f){const l=document.createElement("div");l.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");
const w=document.createElement("div");w.setAttribute("style","margin: 2px; color: black; display: inline");const H=document.createElement("textarea");H.id=b;H.value=c;H.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");void 0!==f&&(H.style.height=f);b=document.createElement("div");b.setAttribute("style","display: inline; float: right; margin-bottom: 2px");f=document.createElement("button");f.innerText="Default";f.onclick=()=>{H.value=
c};b.appendChild(f);f=document.createElement("button");f.style.marginLeft="10px";f.innerText="Clear";f.onclick=()=>{H.value=""};b.appendChild(f);f=document.createElement("label");f.textContent=a;f.setAttribute("style","color: black; margin: 2px");w.appendChild(f);w.appendChild(b);l.appendChild(w);l.appendChild(H);return l}Kli(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.Jli());a.appendChild(this.Dli());
return a}Jli(){const a=document.createElement("div");a.setAttribute("style","display:inline; margin: 2px 20px;");const b=document.createElement("label");b.textContent="MergeAction: ";b.style.color="black";const c=document.createElement("select"),f=document.createElement("option");f.value="ReplaceAll";f.textContent="ReplaceAll";const l=document.createElement("option");l.value="Insert";l.textContent="Insert";"ReplaceAll"==this.Qfc?f.selected=!0:l.selected=!0;c.appendChild(f);c.appendChild(l);a.appendChild(b);
a.appendChild(c);c.addEventListener("change",()=>{"Insert"===c.options[c.selectedIndex].value?(this.Qfc="Insert",this.upd(!0)):(this.Qfc="ReplaceAll",this.upd(!1))});return a}Dli(){const a=document.createElement("div");a.id="InsertPositionDiv";a.setAttribute("style","display:inline; margin: 2px 20px; visibility: hidden");const b=document.createElement("label");b.textContent="After slide: ";b.style.color="black";const c=document.createElement("select");c.id="InsertPositionSelect";this.xBf(c);c.addEventListener("change",
()=>{const f=c.options[c.selectedIndex].value.split(";");f&&2===f.length&&(this.KBg={ReferenceSlide:{Sid:parseInt(f[0]),Cid:parseInt(f[1])},InsertBefore:!1})});a.appendChild(b);a.appendChild(c);return a}upd(a){document.getElementById("InsertPositionDiv").style.visibility=a?"visible":"hidden"}rmi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.smi());a.appendChild(this.Vki());return a}smi(){const a=
document.createElement("button");a.style.marginRight="10px";a.innerText="GenerateAndMergeSlides";a.onclick=()=>Object(al.a)(this,void 0,void 0,function*(){try{const b={ClientName:"ChatPPT",MergeAction:this.Qfc,OutlineInput:{ColorScheme:JSON.parse(document.getElementById(this.Yug).value),ThemeIds:JSON.parse(`[${document.getElementById(this.yWg).value}]`),FRenderFirstThumb:!0,PresOutline:JSON.parse(document.getElementById(this.kRg).value)},InsertPosition:this.KBg,CorrelationId:void 0},c=yield this.iWa.AZf(b);
this.log(`generateAndMergeSlides succeeded: ${c}`)}catch(b){this.log(`generateAndMergeSlides error: ${b}`)}});return a}Vki(){const a=document.createElement("button");a.innerText="Close";a.onclick=()=>{document.body.removeChild(document.getElementById(this.bse))};return a}Ili(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px; user-select: text;");var b=document.createElement("label");b.style.color="black";
b.style.userSelect="text";b.textContent=`UserSessionId: ${u.AFrameworkApplication.userSessionId}`;a.appendChild(b);b=document.createElement("textarea");b.id=this.oHg;b.value="";b.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");b.disabled=!0;b.style.height="50px";a.appendChild(b);return a}log(a){document.getElementById(this.oHg).value+=a+"\r\n"}}Object(n.a)(Lm,"StatusBarDebugUI",null,[]);class fj{get name(){return"PowerPointWebEditor.CopilotProxy"}Zb(a){this.K=
a;a.register(bl,"PowerPointWebEditor.CopilotProxy").as("PowerPointWebEditor.ICopilotProxy").ma().oa(()=>new bl(a.resolve("Common.IAppSettingsManager").Ga("CreatorServiceBase"),a.resolve("Common.IAppSettingsManager").Ga("MergeSlidesFromUrlEndpoint"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.Ke))}init(){this.K.resolve("PowerPointWebEditor.ICopilotProxy");this.K.resolve("Common.IAppSettingsManager").ka("CopilotDebugUIEnabled")&&new Lm(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.Graph.IGraphInstance").xd(7))}dispose(){}static main(){(u.AFrameworkApplication.fa.ka("EnableChatPPT")||u.AFrameworkApplication.fa.ka("EnableChatPPTCopilot")||u.AFrameworkApplication.fa.ka("EnableStoryTeller"))&&v.a.instance.Dc(new fj)}}Object(n.a)(fj,"PPTWebEditorCopilotProxyPackage",null,[2,3]);var Ai=d(166),dg=d(96),Mm=d(642),nc=d(52),nm;(function(a){a[a.unknown=0]="unknown";
a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(nm||(nm={}));Object(n.b)("RefreshDocTrigger",nm);var Rc=d(43),pf=d(86);class jk extends Sys.EventArgs{constructor(a,b){super();this.iVj=b}}Object(n.a)(jk,"FailoverEventArgs",Sys.EventArgs,[]);var hg=d(246),qh=d(110);class Cj extends qh.a{constructor(a){super();this.FailedMachineId=
null;this.FailedMachineId=a}Zk(){return 61}}Object(n.a)(Cj,"CheckUnblockUIRequest",qh.a,[]);var mf=d(879),L=d(30);class Cn{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve){this.pma=!1;this.vwa=this.YAe=this.AGa=this.HGa=this.aU=this.Fs=null;this.la=a;this.zb=b;this.kgk=c;this.gf=f;this.pa=l;this.Fa=w;this.jA=H;this.v4c=cc;this.Xdb=Ic;this.Mm=U;this.s7j=ja;this.ua=wa;this.Vb=Sa;this.x$=eb;this.Ce=ub;this.Sd=Ub;this.DGa=Fc;this.ia=Cc;this.MC=Ud;this.ln=je;this.sYa=Vd;this.gj=Ve;
this.E9j=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.jck=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}wb(){this.ia.ra(L.a.eKb,nc.a.application,Object(F.a)(this,this.kUk,"refeshDoc"),64)}kUk(a,b,c,f,l){this.h4e(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in l&&l.isPodSessionRefreshed?3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get zi(){return this.Vb.zi}Lsa(a){a.a8b()&&a.Lsa()}h4e(a,
b,c,f){if(!this.Ce.qd.hermesFailOverImprovementIsEnabled||this.Xdb())return!1;if(this.pma||this.DGa.Dig)return!0;const l=this.zi;if(!(l&&l.Bi&&l.Bi.hx&&l.Bi.hx.id!==ia.a.nil&&l.contentReplicator&&this.ua.presentation&&this.ua.presentation.id.equals(Mm.a.jKe)))return!1;5===f&&this.nsf();this.Mm.pause();this.x$.suspend();this.jA.Qd&&this.jA.Qd.endEditing(!1,14);this.jA.forEach(Object(F.a)(this,this.Lsa,"ensureGraphUpdated"));l.oT(!0)&&l.bga();this.pa.setSelection(null);this.Fa.Ed();this.Fs=Rc.a.zk("RefreshDoc");
this.Fs.Va("IsPlanedShutdown",b.toString());this.Fs.Va("PodSessionId",c);this.Fs.Va("RefreshDocTrigger",nm[f]);va.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.Fs.actionId,this.Fs.vOb());this.aU=a;b?(this.HGa=new Date,this.DGa.lwh(),this.v4c.Db(this.jYd())):this.bhh();this.MC.Ueh(new jk(b,!1));this.ua.presentation.ZSe();this.gf.blockContent(this.ua.presentation,"RefreshDoc",!0);va.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");
this.Sd.disabled=!0;return this.pma=this.Ce.c$a().sfd=!0}nsf(){this.Mm.isPaused&&(va.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.Mm.amb());try{this.Mm.cEf()}catch(a){va.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",a)}}jYd(){return this.AGa=new hg.a(new Cj(this.aU),Object(F.a)(this,this.zHe,"onCheckUnBlockUISuccess"),Object(F.a)(this,this.yHe,"onCheckUnBlockUIFailed"),
a=>0===a.StatusCode&&!a.ServerError,3)}bhh(){this.Fs.Va("FailedMachineId",this.aU);this.YAe=new Date;this.kgk.eKb(this.aU,this.Fs,!this.Ce.qd.refreshDocSynchronouslyIsEnabled,!1,Object(F.a)(this,this.CPi,"docRefreshSuccessCallback"),Object(F.a)(this,this.BPi,"docRefreshFailedCallback"));this.s7j.exa()}zHe(){this.DGa.FWc();this.Fs.Va("DeploymengUIBlockingTime",(+new Date-+this.HGa).toString());this.Fs.Va("CheckUnblockUISucceeded","True");this.bhh()}yHe(a){if(142===a.ServerError.Code)return va.a.J(512360795,
822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.aU,+new Date-+this.HGa),this.v4c.Db(this.AGa),!0;this.Fs.Va("DeploymengUIBlockingTime",(+new Date-+this.HGa).toString());this.Fs.Va("CheckUnblockUISucceeded","False");this.DGa.FWc();return this.k6g(a)}CPi(){this.ln.QPd(Object(F.a)(this,this.nJe,"onSlideDrawComplete"));this.vwa&&this.zb.Mg(this.vwa);const a=this.Fs.dK("RefreshDocTrigger");this.vwa=new Le.a(2,1,a&&1===a.length&&"podSessionRefreshed"===
a[0]?this.E9j:this.jck,Object(F.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.zb.Db(this.vwa);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.nsf()}BPi(a){return this.k6g(a)}nJe(){ka.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.vwa&&(this.zb.Mg(this.vwa),this.vwa=null);this.ln.Wld(Object(F.a)(this,this.nJe,"onSlideDrawComplete"));this.Fs&&(this.Fs.Va("ReStoreStatusAfterRefreshStartTime",Rc.a.mf(new Date)),this.x$.resume(),this.Fs.Va("SlideDrawResult",
"True"),this.Fs.Zm("SlideDrawCompleteET",new Date),this.Mm.isPaused&&this.Mm.amb(),this.Fs.Va("LoadAndRenderTime",(+new Date-+this.YAe).toString()),this.Ce.qd.tQe||this.Ce.c$a().gxa(),this.Fs.Va("ReStoreStatusAfterRefreshEndTime",Rc.a.mf(new Date)),this.aJe(!0),this.sYa.kfh(new mf.a("DocRefresh")),this.gj.umb=2,u.AFrameworkApplication.bjb(pf.a.Vh(180),Ai.a.unknown,Ai.a.Cuc),dg.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.ln.Wld(Object(F.a)(this,
this.nJe,"onSlideDrawComplete"));this.vwa&&(this.zb.Mg(this.vwa),this.vwa=null);ka.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.Fs.Va("SlideDrawResult","False");this.aJe(!1);this.d2k()}d2k(){this.Sd.disabled=!1;u.AFrameworkApplication.zp(pf.a.Vh(379));dg.Health.instance.recordQosError("RefreshDocTimeout",["UnexpectedAppRefresh"],!1,!1,!0,!0,null);u.AFrameworkApplication.dv&&u.AFrameworkApplication.dv.B8();this.ia.La(L.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}k6g(a){ka.ULS.sendTraceTag(512360792,
821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Kh);this.aJe(!1);return!1}aJe(a){this.pma=!1;this.AGa=this.aU=null;this.YAe=new Date(0);Rc.a.ibc=new Date;this.Fs&&(this.Fs.Va("Result",a?"Success":"Failed"),this.Fs.finish(!0),this.Fs=null);this.Sd.disabled=!1;this.Ce.c$a().sfd=!1;this.gf.hK(this.ua.presentation)}}Object(n.a)(Cn,
"DocRefreshHandler",null,[1318]);var oi=d(154);class pj{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.pma=!1;this.AGa=this.HGa=this.aU=this.Fs=null;this.ia=a;this.wi=b;this.ei=c;this.gf=f;this.pa=l;this.Fa=w;this.Mm=H;this.ua=U;this.x$=ja;this.DGa=wa;this.Xa=Sa;this.la=eb;this.Xdb=ub;this.la.ljg&&this.ei.LA(Object(F.a)(this,this.GB,"onSessionEnd"))}wb(){this.ia.ra(L.a.failover,nc.a.application,Object(F.a)(this,this.xtj,"handleFailover"),64)}GB(){this.Mm.isPaused||this.Mm.pause()}xtj(a,b,c,f,l){if(1===
c||this.Xdb()||this.pma||this.DGa.Dig)return 32;this.aU=l;if(!this.aU)return 8;this.Fs=Rc.a.zk("SeamlessFailover");this.Mm.pause();this.x$.suspend();this.pa.setSelection(null);this.Fa.Ed();this.gf.blockContent(this.ua.presentation,"SeamlessFailover",!0);va.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");this.HGa=new Date;this.DGa.lwh();this.ei.Ueh(new jk(!0,!0));u.AFrameworkApplication.rvb();this.wi.qGc(this.jYd());this.pma=!0;return 32}jYd(){return this.AGa=new hg.a(new Cj(this.aU),
Object(F.a)(this,this.zHe,"onCheckUnBlockUISuccess"),Object(F.a)(this,this.yHe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}zHe(){this.DGa.FWc();this.Fs.Va("DeploymengUIBlockingTime",(+new Date-+this.HGa).toString());this.Fs.Va("CheckUnblockUISucceeded","True");this.Fs.Va("FailedMachineId",this.aU);this.Xa.Mvb=this.aU;this.KRk()}yHe(a){if(142===a.ServerError.Code)return va.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",
this.aU,+new Date-+this.HGa),this.wi.qGc(this.AGa),!0;this.Fs.Va("DeploymengUIBlockingTime",(+new Date-+this.HGa).toString());this.Fs.Va("CheckUnblockUISucceeded","False");this.DGa.FWc();return this.Auk(a)}KRk(){this.Fs.Va("ReStoreStatusAfterRefresh",Rc.a.mf(new Date));this.Mm.amb();this.x$.resume();this.c4g(!0);u.AFrameworkApplication.bjb(pf.a.Vh(180),Ai.a.unknown,Ai.a.Cuc);dg.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}Auk(a){ka.ULS.sendTraceTag(22315611,
821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Kh);this.c4g(!1);a.ServerError=Object.assign(new oi.a,{Code:157,Source:0});return!1}c4g(a){this.pma=!1;this.AGa=this.aU=null;this.Fs&&(this.Fs.Va("Result",a?"Success":"Failed"),this.Fs.finish(),this.Fs=null);this.gf.hK(this.ua.presentation)}dispose(){this.la.ljg&&
this.ei.qaa(Object(F.a)(this,this.GB,"onSessionEnd"))}}Object(n.a)(pj,"SeamlessFailoverHandler",null,[106]);var Nl=d(221),Bi=d(107),Li=d(1157),Dj=d(290),zk=d(833),Ne=d(233),Ig=d(627);class Ok{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.la=b;this.S9=c;this.yz=f;this.Qb=l;this.Pdb=!1}uv(a,b=!1,...c){this.I2b.apply(this,[pf.a.Vh(a),this.S9.tUc(a),this.S9.Iae(a),this.S9.f9d(a),b].concat(c))}I2b(a,b,c,f,l=!1,...w){if(!Nl.a.gx){var H=2,U=!1;if(a===pf.a.Vh(83))this.la.SVj&&
(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,H=3);else if(a===pf.a.Vh(8)||a===pf.a.Vh(256)||a===pf.a.Vh(257)||a===pf.a.Vh(291))H=0,U=!0;w&&0<w.length&&(f=String.format.apply(null,[f].concat(w)));this.Ft(new Ig.a(a,c,f,b,H),l,U)}}Ft(a,b=!1,c=!1){let f=a.kld;var l=pf.a.BT(a.Im)?Ne.a[pf.a.$K(a.Im)]:"";va.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",
a.Im,l,b,u.AFrameworkApplication.UE,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));if(this.Wkl(a))va.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",a.Im);else{l=new Bi.StandardDialog;var w=null,H=!1,U=this.Qb.ka("UserCanWriteRelative");f&64&&va.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.Qb.Ga("DocumentPermissions")||"");var ja=!1;f&64&&this.la.pptFileRecoveryEnabled&&(ja=!0);f&64&&!U&&va.a.J(512497108,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");
!ja&&f&64&&(c=!1,f=this.hFl(a));U=!!(f&4)&&!(u.AFrameworkApplication.pEh||u.AFrameworkApplication.PQ);var wa=!!(f&2)&&u.AFrameworkApplication.Kda;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.Ar=wa||!!(f&1);f&8?(l.yd=0,w=Object(F.a)(this,this.pld,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Im.toString())?l.fP(Li.a.D3(a.title),Li.a.D3(a.message),w):(va.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Im),l.Xe(1,
ResourceStrings.L_Refresh),l.Jy(a.Im,Li.a.D3(a.title),Li.a.D3(a.message),w,b)),H=this.Pdb=!0):ja?(va.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Im),this.ia.processAction(L.a.repair,2)):wa&&U?(l.yd=4,l.Xe(1,c),l.Xe(2,ResourceStrings.L_Close),w=Object(F.a)(this,this.yBk,"openOrCloseActionHandler"),this.Pdb=!0):U?(l.yd=0,l.Xe(1,c),w=Object(F.a)(this,this.hhd,"openInClientActionHandler"),this.Pdb=!0):wa?(l.yd=0,l.Xe(1,ResourceStrings.L_Close),
w=Object(F.a)(this,this.zvi,"closeActionHandler"),this.Pdb=!0):(c=!!(f&1)||0===f,l.Ar=c,l.yd=c?0:5);H||ja||(f&16&&f&32?(b||u.AFrameworkApplication.zp(a.Im),l.E0a=!1,l.Gx(Li.a.D3(a.title),Li.a.D3(a.message),a.icon,w)):l.Jy(a.Im,Li.a.D3(a.title),Li.a.D3(a.message),w,b));this.Pdb&&this.yz&&this.yz.closeSession(4);this.Pdb?dg.Health.instance.recordQosError(pf.a.qja(a.Im),["NonDismissibleDialog"],!1,!1,!0,!0,null):dg.Health.instance.recordQosError(pf.a.qja(a.Im),["DismissibleDialog"],!1,!1,!0,!1,null)}}get A_c(){return this.Pdb}hFl(a){va.a.J(512497105,
801,15,"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Im===pf.a.Vh(8)||a.Im===pf.a.Vh(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}hhd(a,b){va.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.pdh()}yBk(a,b){va.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",
a,b);1===a?this.pdh():this.ia.La(L.a.Zvb,2,Dj.c)}zvi(a,b){va.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(L.a.Zvb,2,Dj.c)}pld(a,b){va.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(L.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}pdh(){(new zk.a(D.a.openInClient)).Kie()}Wkl(a){return a.Im===pf.a.Vh(83)&&(u.AFrameworkApplication.LL("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.Wol)||a.Im===
pf.a.Vh(56)&&(u.AFrameworkApplication.LL("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.Xol)?!0:!1}}Object(n.a)(Ok,"ErrorDialog",null,[1316]);var gj=d(282),Ce=d(127),Al=d(517),qk=d(1007);class eg extends Sys.EventArgs{constructor(){super();this.sCa=this.mC=0;this.message=this.title=null}}Object(n.a)(eg,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class Lf extends eg{constructor(a){super();this.$Ra=null;this.errorCode=a;this.mC=0}}Object(n.a)(Lf,"OnBeforeHandleClientErrorEventArgs",
eg,[]);class om extends eg{constructor(){super();this.mC=0}}Object(n.a)(om,"OnBeforeHandleServerErrorEventArgs",eg,[]);class yc extends Sys.EventArgs{constructor(a,b,c){super();this.HO=a;this.z9j=b;this.vh=c}get podSessionId(){return this.HO}get MPc(){return this.z9j}get errorCode(){return this.vh}}Object(n.a)(yc,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class Dn{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){this.rwe=!1;this.J$j=[8];this.Mwe={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,
["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,
["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.S9=a;this.wea=b;this.gl=c;this.axg=f;this.ia=l;this.Xa=w;this.Qb=H;this.Rb=U;this.yEb=ja;this.Fbf=!1;this.Mm=wa;this.yz=Sa;this.To=ub;this.xj=Ub;this.Ce=eb}zs(a,b,c=null,f=!1){if(this.disabled)return ka.ULS.sendTraceTag(512263053,804,50,
"Ignore server error {0}",a?a.Code:315),!0;this.yz.elk();if(this.yz.N_)return ka.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let l=!1,w=0,H=0,U=null;var ja=null;c&&(ja=new om,l=c(ja),w=ja.mC,H=ja.sCa,U=ja.title,ja=ja.message);l||(l=this.vxj(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.sWi(b)&&(this.Fbf=!0,this.Mm.pause()),a?this.Jy.apply(this,[w,b,H,U,ja,f].concat(a)):this.Jy(w,
b,H,U,ja,f));return l}vxj(a,b){if(!a)return!1;ka.ULS.sendTraceTag(512263051,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code)return gj.a.instance.cQe(Date.now()),gj.a.w2c(u.AFrameworkApplication.userSessionId),u.AFrameworkApplication.bjb(pf.a.Vh(153),Ai.a.unknown,Ai.a.Cuc),({D2e:c}=gj.a.instance.LEh()).returnValue&&ka.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.dUk(a.ExtraErrorParam[0]):ka.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.La(L.a.failover,2,a.ExtraErrorParam[0]):this.axg.h4e(a.ExtraErrorParam[0],!0,this.Xa.podSessionId||"",1))||this.Jy(0,157,0,null,null),
!0;if(274===a.Code)return ka.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.To.instance&&!ha.a.Wa(this.Xa.fQc))return ka.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.To.instance.u3e(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"";return this.Qb.ka("685")&&c.toLowerCase()!==this.Xa.podSessionId.toLowerCase()?(va.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.Qb.ka("884")&&this.rwe?(va.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.axg.h4e(a.ExtraErrorParam[0],
!1,this.Xa.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.Qb.ka("560")&&229===a.Code||this.Qb.ka("914")&&this.To.instance&&this.To.instance.aXi(a.Code)){if(b!==this.Xa.podSessionId)return va.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;if(this.Qb.ka("914")&&this.To.instance&&this.To.instance.m_)return va.a.J(512263043,801,15,
"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;va.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.yEb.kQk(new yc(this.Xa.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=
this.Rb.notificationBar.LCa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.Qb.ka("IsAutomation")?a.displayTimeoutSeconds=this.Qb.Bc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:va.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Rb.notificationBar.$h(a),!0;if(238===a.Code&&this.Qb.ka("561")&&this.To.instance&&this.To.instance.m_)return va.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped",
"GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return va.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.yxh(a.Code,null),!0;if(104===a.Code)return b=2===this.xj.Kca,a.Code=b?56:105,va.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",Ne.a[a.Code]),this.Jy(0,a.Code,0,
null,null),!0;if(this.NLj(a.Code)&&2!==this.Qb.state)return va.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.Jy.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.Jy.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),
!0;return!1}cH(a,b){if(this.disabled)return ka.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,w=null,H=null;var U=null;b&&(U=new Lf(a),c=b(U),f=U.mC,l=U.sCa,w=U.title,H=U.message,U=U.$Ra);c||(c=!1);c||(U?this.Jy.apply(this,[f,a,l,w,H,!1].concat(U)):this.Jy(f,a,l,w,H));return c}Jy(a,b,c,f,l,w=!1,...H){0===a&&(a=this.S9.Thj(b));0===c&&(c=this.S9.tUc(b));f||(f=this.S9.Iae(b));l||(3===b&&this.Qb.ka("DecryptSkipReasonIRMErrorEnabled")?l=this.o9i():(va.a.J(512263007,
801,50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.S9.f9d(b)));const U=()=>{this.rml.apply(this,[a,b,c,f,l,w].concat(H))};2===this.Qb.state?U():this.Qb.ff(U)}o9i(){va.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+u.AFrameworkApplication.o2b);return u.AFrameworkApplication.o2b&&this.Mwe[u.AFrameworkApplication.o2b]?this.Mwe[u.AFrameworkApplication.o2b]:this.Mwe.Generic}rml(a,b,c,f,l,w,...H){if(2===a){let U;(U=this.gl).I2b.apply(U,
[b,c,f,l].concat(H))}else 3===a?this.yxh.apply(this,[b].concat(H)):this.Csa.apply(this,[pf.a.Vh(b),c,f,l,w].concat(H))}Csa(a,b,c,f,l,...w){0===b&&(b=this.S9.tUc(pf.a.$K(a)));if(qk.GraphSpaceRootReplicator.Amg(pf.a.$K(a))&&w&&0<w.length){this.Xa.omd=w[0];var H=new Ka.a;for(var U=1;U<w.length;U++)H.add(w[U]);w=H.toArray()}H=Object.assign(new Al.a,{Type:6,Token:this.Ce.qd.rmc,Data:{["Reason"]:"FatalError",["ErrorName"]:pf.a.qja(a)}});Pd.a("PPT.BootstrapperMessageNewValues")&&(H.MessageId=Ce.a.dHh,U=
{Reason:"FatalError"},U.ErrorName=H.Data.ErrorName,H.Values=U);window.parent.postMessage(Jc.c(H),"*");ka.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let ja;(ja=this.wea).I2b.apply(ja,[a,b,c,f,l].concat(w))}dUk(a){Kd.a.openWindow(1,a)}get Dka(){return this.rwe}set Dka(a){this.rwe=a;va.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get N1d(){return this.Fbf}NPd(){}kQd(){}yxh(a,...b){const c=pf.a.Vh(a);va.a.J(512263003,801,
50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");u.AFrameworkApplication.zp(c);dg.Health.instance.recordQosError(pf.a.qja(c),["SilentFailure"],!1,!0,!0,!1,null)}NLj(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}sWi(a){return Array.contains(this.J$j,a)?!0:!1}}Object(n.a)(Dn,"GlobalErrorHandler",null,[1319,1407]);class Ol{constructor(a){this.Cdc=!1;this.XX=null;this.ut=a}get Dig(){return this.Cdc}lwh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,
b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.Cdc||(this.XX=new zc.a,this.XX.yd=5,this.XX.message=Li.a.D3(b),this.XX.Ar=!1,va.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),this.XX.Xoa(Li.a.D3(a),null,null),this.Cdc=!0,this.ut.oAf(!0))}FWc(){this.Cdc&&(this.XX.hide(),this.Cdc=!1,this.XX=null,this.ut.oAf(!1))}}Object(n.a)(Ol,"DeployingDialog",null,[1314]);var ii=d(1018),zh=d(435),Wi=d(648),ch=d(422),M=d(159),N=d(63),Ia=d(909);class lb{constructor(a,b,
c,f,l,w,H,U){this.rea=this.Pf=this.RCb=this.LCb=null;this.n5c=!1;this.G5c=this.xbd=this.i3c=null;this.pma=!1;this.ua=a;this.Vb=b;this.Iq=c;this.Tb=f;this.v4c=l;this.Hxg=w;this.To=H;this.Qjk=U}get zi(){return this.Vb.zi}eKb(a,b,c,f,l,w){this.pma||(this.pma=!0,this.n5c=c,this.Pf=b,this.xbd=l,this.G5c=w,this.To.instance&&this.To.instance.rOd("abortedOnRefreshDoc"),this.Hxg&&this.Hxg(),this.v4c.Db(this.gHi(a,f)))}gHi(a,b){let c=this.ua.Ba&&!N.a.mx(this.ua.Ba.Cb)?this.ua.Ba.Cb:N.a.empty;c=b?N.a.empty:
c;this.Pf.Va("CurrentActiveSlideId",c.toString());this.i3c=N.a.mx(c)?N.a.empty:c;return new hg.a(new Ia.a(c,a),Object(F.a)(this,this.Vuk,"onGetCellSuccess"),Object(F.a)(this,this.Uuk,"onGetCellFailed"),this.Qjk?null:Object(F.a)(this,this.ZJl,"validateResponse"))}ZJl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}Vuk(a){this.Pf.Va("GetCells",a.Kh);a=new ii.a(null,Object(F.a)(this,this.zDj,"inboundSetup"),
a);a.Qi=!this.n5c;a.Pl("RefreshUIOperation");a.run()}Uuk(a){this.Pf.Va("GetCells",a.Kh);200!==a.HttpStatusCode&&this.Pf.Va("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.G5c&&this.G5c(a))return!0;a.ServerError=Object.assign(new oi.a,{Code:294,Source:0});dg.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}zDj(a,b){(this.rea=this.Vb.Dn)&&this.rea.XM&&this.rea.XM.I2c();this.rea&&this.rea.pp&&(this.rea.XM=new Wi.a(Lc.a.instance,"FailoverView"));
this.Pf.Va("InboundSetupStartTime",Rc.a.mf(new Date));if(Pd.a("UseBuildIncrementalInboundOperation"))this.Vb.Ba=null,this.LCb=this.zi.contentReplicator.hBf(b);else{const c=b.Cells[b.Cells.length-1],f=this.zi.Bi.hx.id;c.RevisionList[0].BaseId=M.a(f);this.Vb.Ba=null;this.LCb=new zh.a(c,f,!1,new Date,b.Kh,!1,!1,!1)}this.RCb=this.Iq.oe(3);this.RCb.kd(this.ua.presentation);this.n5c&&this.RCb.XU(a);a.Yg(Object(F.a)(this,this.Hka,"inboundIncrementally"));this.Pf.Va("InboundSetupEndTime",Rc.a.mf(new Date));
return!0}Hka(a){this.Pf.Va("InboundIncrementallyStartTime",Rc.a.mf(new Date));this.zi.contentReplicator.Hka(this.LCb,new Date);this.LCb.FQ&&(this.RCb.dispose(),a.Yg(Object(F.a)(this,this.L$k,"setActiveSlideAndRender")),this.RCb=this.LCb=null,this.Pf.Va("InboundIncrementallyEndTime",Rc.a.mf(new Date)));return!0}L$k(a){this.Pf.Va("SetActiveSlideAndRenderStartTime",Rc.a.mf(new Date));a.Yg(Object(F.a)(this,this.VZi,"finishRefreshDoc"));if(N.a.empty.equals(this.i3c))return this.Pf.Va("SetActiveSlideAndRenderEndTime",
Rc.a.mf(new Date)),!0;const b=this.Tb.zl(this.i3c);if(!b)return this.Pf.Va("SetActiveSlideAndRenderEndTime",Rc.a.mf(new Date)),!0;const c=this.Iq.oe(3);try{c.kd(b),this.n5c&&c.XU(a),this.Vb.Ba=b}finally{c&&c.dispose()}this.Pf.Va("SetActiveSlideAndRenderEndTime",Rc.a.mf(new Date));return!0}VZi(){this.xbd&&this.xbd();this.rea&&this.rea.XM&&(this.rea.XM.I2c(),this.rea.XM=new ch.a);this.n1();return!1}n1(){this.pma=!1;this.G5c=this.xbd=this.i3c=this.rea=this.Pf=this.RCb=this.LCb=null}}Object(n.a)(lb,"RefreshDocExecutor",
null,[1317]);class Sb{f9d(a){switch(a){case 1:a=ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;
case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;
break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;
break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;
break;case 28:a=ResourceStrings.errorMessage_NoLicense;break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 39:a=ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;
break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;
break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;
break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=
ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=
ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;
case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;
break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;
break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;
break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=
ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=
ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;
break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 449:a=ResourceStrings.errorMessage_MediaUploadTimeout;break;case 450:a=ResourceStrings.errorMessage_UploadedVideoTooLarge;break;default:a=ResourceStrings.errorMessage_Unknown}return a}Iae(a){switch(a){case 1:a=
ResourceStrings.errorTitle_Unknown;break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;
break;case 51:a=ResourceStrings.errorTitle_Unknown;break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;
break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;
break;case 70:a=ResourceStrings.errorTitle_WacStandard;break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;
break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 149:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;
case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;
break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 449:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 450:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}tUc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=
6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=
6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=
116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;
case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=
8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;case 449:a=49;break;case 450:a=49;break;default:a=0}return a}Thj(a){switch(a){case 5:a=
1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;
case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(n.a)(Sb,"DefaultErrorMapping",null,[1315]);var Wc=d(712);class td{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}Zb(a){this.K=a;a.register(1314,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().oa(()=>new Ol(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1315,"PowerPointWebEditor.IErrorMapping").ma().oa(()=>new Sb);a.register(1316,
"PowerPointWebEditor.IErrorDialog").ma().oa(()=>new Ok(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new kc.a(()=>new Wc.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),
a.resolve("PowerPointWebEditor.IReplicationTimerFactory").N1b(a.resolve("Box4.IReplicationParameters")),Ab.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Ug));a.register(1317,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().oa(()=>new lb(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),
b.value,u.AFrameworkApplication.PSf,this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));a.register(1318,"PowerPointWebEditor.IDocRefreshHandler").ma().oa(()=>new Cn(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),
()=>u.AFrameworkApplication.Ug,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(pj,"PowerPointWebEditor.SeamlessFailoverHandler").ma().oa(()=>new pj(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.Ug));
a.register(1319,"PowerPointWebEditor.IDelayedErrorHandler").ma().oa(()=>new Dn(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),
this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").wb();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").wb()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){v.a.instance.Dc(new td)}}
Object(n.a)(td,"PPTWebEditorErrorHandlingPackage",null,[2,3]);var wd=d(1226),be=d(87),hb=d(39);class hf{constructor(){this.font=null;this.PZc=this.isValid=!1}}Object(n.a)(hf,"EmbeddedFontClientStatus",null,[]);class Xf{constructor(a,b,c,f,l,w){this.qcd=this.$cb=null;this.Ha=a;this.ny=b;this.rRg=c.xd(7);this.oc=f;this.$Eb=l;this.oz=w;this.rRg.kk(Object(F.a)(this,this.ehb,"onPresentationPropertyChanged"));this.ny.dFa(()=>{this.n5e(0)})}dispose(){this.rRg.Rm(Object(F.a)(this,this.ehb,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.$cb}get SJh(){return this.qcd}D6d(a){return this.isInitialized?
this.$cb.Gb(a)?this.$cb.ga(a):null:null}createFontUrl(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(va.a.J(41521309,820,50,"CreateFontUrl"),this.isInitialized||this.n5e(2),this.isInitialized){var b=this.oz.dG(a);if((b=this.D6d(b))&&!b.PZc&&b.isValid){b.font.Name!==a&&va.a.J(41296397,820,15,"Name is not identical");a=ea.FontUtils.K5b(a);const c=this.$Eb.resolve(be.a.v0i,Xf.E0i(b.font));ha.a.Wa(a)||ha.a.Wa(c)?va.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.oz.oQa(a,String.format("url('{0}')",
c)),b.PZc=!0)}}else va.a.J(41296401,820,10,"Dictionary is not initialized")}ehb(a,b){b&&b.node&&b.property&&b.property===hb.a.embeddedFonts&&this.n5e(1)}n5e(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(va.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.oc.k$i()){this.$cb?va.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.$cb=new Vc.a,va.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(ha.a.Wa(b.Name)){va.a.J(41296407,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=Xf.SOj(b);const c=this.oz.dG(b.Name),f=this.D6d(c);f&&(f.isValid===a||f.PZc)||this.$cb.$(c,Object.assign(new hf,{font:b,isValid:a,PZc:!1}))}this.qcd=Xf.bJi(this.$cb);this.oz.eFl(this.qcd);ea.FontUtils.A6h(this.qcd,Object(F.a)(this,this.createFontUrl,"createFontUrl"))}else va.a.J(41296403,820,10,"EmbeddedFonts is null")}static E0i(a){return JSON.stringify(a)}static SOj(a){return!ha.a.Wa(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static bJi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new wd.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(n.a)(Xf,"EmbeddedFontsManager",null,[1306,106]);class Bg{}Bg.loading="loading";Bg.loaded="loaded";Bg.error="error";Object(n.a)(Bg,"FontFaceStatus",null,[]);class ji{constructor(){this.T7c=this.atg=!1;this.Ove=null;this.init()}get Eng(){return this.T7c}load(a){return new Promise((b,c)=>{this.T7c&&!ha.a.Wa(a)||c([]);let f;f=this.atg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.Ove.load(f).then(l=>{for(const w of l)ha.a.Wa(w.family)||w.status===Bg.loaded||va.a.J(40429085,801,15,"Font load status {0}",w.status);l.length||va.a.J(41494563,801,15,"No font resolved");b(l)},l=>{va.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.Ove=a&&a.fonts?a.fonts:null;this.T7c=!!this.Ove;this.atg=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");va.a.J(41494593,
801,50,"FontFaceSetAPIIsSupported: {0}",this.T7c)}}Object(n.a)(ji,"FontFaceSetObserver",null,[1304]);class pi{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.mdb=a}Qee(a){return a?a:{}}Jee(a){return a?a:()=>{}}HKh(a,b,c,f,l,w,H){if(!a)return[];b=this.Qee(b);c=this.Jee(c);f=this.Qee(f);l=this.Jee(l);w=this.Qee(w);H=this.Jee(H);const U=[];for(const ja of a)ja in f?(l(ja),U.push(this.mdb.load(String.format("{0}_MSCustomFont",ja)))):ja in b?(c(ja),U.push(this.mdb.load(String.format("{0}_MSFontService",
ja)))):ja in w&&(H(ja),U.push(this.mdb.load(String.format("{0}_EmbeddedFont",ja))));return U}}Object(n.a)(pi,"FontsObserver",null,[1305]);class Oe{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}Zb(a){this.K=a;this.K.register(1304,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().oa(()=>new ji);this.K.register(1305,"PowerPointWebEditor.Fonts.IFontsObserver").ma().oa(()=>new pi(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1306,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().oa(()=>
new Xf(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){v.a.instance.Dc(new Oe)}}Object(n.a)(Oe,"PPTWebEditorFontsPackage",
null,[2,3]);var Ri=d(431);class Rj{Evh(){return!1}}Object(n.a)(Rj,"DefaultParagraphViewElementSetUpdateStrategy",null,[1444]);var dh=d(223),ff=d(1081),Kj=d(245);class Mf extends dh.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){super(a,b,l);this.RAc=null;this.uUb=tc.a.nil;this.Ocf=this.uCd=!1;this.oZ=this.nZ=this.Bnb=this.Anb=-1;this.RCd=this.OTb=!1;this.DBc=this.i2c=this.tId=this.Xmf=this.Apb=null;this.Esd=0;this.q9e=this.L2a=this.Aef=null;a.XM.c_a(b);this.DVa=c;this.uId=w;this.fTh=H;this.eTh=U;this.$Yh=
ja;this.fd=wa;this.GTh=Sa;this.ew=eb;this.C1a(!0);this.tXe(!0);this.WEd=new kc.a(Object(F.a)(this,this.ZMi,"determineIsShapesAndTextboxesEnabled"));this.ot=[];this.KNa=new Ka.a;this.R9e=new Ka.a;this.Igb();this.Qc.Nh&&(b=this.Qc.cgj(this.gb))&&(b.isSelected&&(this.IR.DGb=!0),b.k9&&(this.OTb=!0),this.IR.DGb&&(this.Anb=b.rja,this.Bnb=b.sja,this.nZ=b.SS,this.oZ=b.Sra));a.pp&&(a=Object(qa.a)(568,a))&&a.ARk(this.gb);this.FVb=f;this.kId=ub}get $Ck(){return this.FVb}get uKe(){return this.uId}get wkh(){return this.Xmf||
(this.Xmf=this.fTh())}get yhd(){if(!this.tId){const a=this.eTh();a&&(this.tId=a.mQl())}return this.tId}get Sf(){return this.fd}get w_(){return this.GTh}get Epg(){return this.uUb}set Epg(a){this.uUb=a}get FBj(){return this.KNa}get P9g(){return this.Ji?za.a.f_f(this.Ji,!1):0}get Ji(){return this.Apb}get dab(){return this.Aef}C1a(a){let b=!1;this.Bil(a)&&(a=this.M7a(),this.nc(a),this.RAc=null,this.uUb=tc.a.nil,b=!0);this.Sf.hg&&this.gb.Mlb?Sys.UI.DomElement.addCssClass(this.htmlElement,jc.Z3):Sys.UI.DomElement.containsCssClass(this.htmlElement,
jc.Z3)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,jc.Z3),this.htmlElement.removeAttribute("title"));return b}Bil(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Ji||"p"!==ha.a.rg(this.Ji.tagName)}M7a(){this.Apb=this.Nd.jp(Ga.a.p);this.Apb.className="Paragraph";this.Aef=this.Nd.jp(Ga.a.span);this.dab.className="WACImageGroupContainer";return this.Nd.Wl?this.Apb:this.zMl()}zMl(){const a=this.Nd.jp(Ga.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.Apb);this.Xo(this.Apb);return a}NU(a){super.NU(a);if(this.gb.YZ)return a=this.gb.YZ.sc(a.b2).Lwc,this.gb.YZ=null,new Kj.a(a.mna,a.minWidth,a.nna);let b;b=this.q9e;a.Bb(88)&&(b=Kj.a.max(b,a.Xq.sLa),a.zc());return b}Ny(a){if(u.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.i2c=null,this.Ji)){const b=this.Ji.getElementsByClassName("LineBox");if(b&&0<b.length){this.i2c=Array(b.length);for(let c=0;c<b.length;c++)this.i2c[c]=za.a.zv(b[c]).length}}this.C1a(!1)&&
(a.currentNode.anchor.hk(this.Ma,8),a.parentNode.anchor.hk(this.Ma,8),this.RAc=null);super.Ny(a);this.FGi(a,this.Ji)}FGi(a,b){var c=this.gb;if(this.Qc.Nh){var f=na.InteractiveViewManager.instance.Qd;f&&f.Ma===this.Qc.Ma&&f.editingView.Wl&&f.editingView.Dg===this.gb&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,Mf.Hcg):Sys.UI.DomElement.removeCssClass(this.htmlElement,Mf.Hcg)}if(c.YZ)c=c.YZ.sc(a.b2).htmlElement,za.a.j1b(c,b),b=this.Qc,b.Nh&&b.KF&128&&(this.gb.YZ=null);else{a=
this.dgj();f=mb.StyleReader.i3f(a);mb.StyleReader.d1c(a)&&f?(Fb.d(b,ua.a.role,Bc.a.Qyf),Fb.d(b,ua.a.Syf,f)):(b.removeAttribute(Bc.a.af),b.removeAttribute(Bc.a.EZb));var l="";if(R.a.instance.ga(71)||R.a.instance.ga(77))l=this.s8i(c);f=a=null;var w=zb.ParagraphReader.T7f(c,R.a.instance.ga(53),R.a.instance.ga(71),R.a.instance.ga(77),R.a.instance.ga(54));if(this.Ocf||l!==this.RAc||this.uUb!==c.kGe){a="WindowText";f="transparent";this.RAc=l;this.Ocf=!1;l="";let U=null;"P"!==b.tagName&&w.Q$a&&(U=ea.FontUtils.oja(w.fontName));
if(w.V3){var H=w.fontColor;H!==tc.a.auto&&(a=tc.a.xI(H))}R.a.instance.ga(49)||(w.U$a&&(H=w.NR,H!==tc.a.auto&&(f=tc.a.xI(H))),w.RTa&&(H=w.highlight,H!==tc.a.auto&&(f=tc.a.xI(H))));if(H=zb.ParagraphReader.language(this.gb))if(H=Xa.a.xe(H))b.setAttribute("xml:lang",H.name),b.setAttribute("lang",H.name);b.style.fontWeight=w.isBold?"bold":"normal";b.style.fontStyle=w.isItalic?"italic":"normal";b.style.verticalAlign="baseline";w.isSuperscript&&(b.style.verticalAlign="super");w.QF&&(b.style.verticalAlign=
"sub");w.hE&&(l="underline");if(w.PF||w.D_)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=U?U:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";w.MTa?1===w.capitalization?b.style.fontVariant="small-caps":2===w.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.uUb=c.kGe;R.a.instance.ga(49)&&(w.U$a&&(l=w.NR,l!==tc.a.auto&&(f=tc.a.xI(l))),w.RTa&&(w=w.highlight,w!==tc.a.auto&&(f=tc.a.xI(w))));this.gb.properties.sa(Za.a.Zhg,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(Bc.a.Jra,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(Bc.a.Jra),f?(b.style.backgroundColor=f,Mf.ouf(f,b)):R.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.kGe!==tc.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,Mf.ouf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=fe.OutlineElementReader.um(Pa.OutlineElementNavigator.WA(this.gb));this.Qc.Wl&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(zb.ParagraphReader.KN(this.gb)){case 1:b.style.textAlign="left";b.style.slb="";break;case 2:b.style.textAlign="center";b.style.slb="";break;case 3:b.style.textAlign="right";b.style.slb="";break;case 6:b.style.textAlign="justify";b.style.slb="auto";break;case 7:b.style.textAlign="justify";b.style.slb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.slb="kashida";break;case 13:b.style.textAlign="justify";b.style.slb="inter-cluster";break;default:b.style.textAlign="",b.style.slb=""}4===Pc.App.mode&&R.a.instance.ga(86)&&B.a.Gj&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");R.a.instance.ga(54)&&(Fb.d(b,ua.a.Hx,this.gb.sa(Va.a.lo,0)),Fb.d(b,ua.a.UCk,this.gb.id.toString()));this.uKe.Krh(this.gb,
b,c,this.Ma)}}dgj(){var a=R.a.instance.ga(71)?(a=mb.StyleReader.aE(this.gb))?mb.StyleReader.wQ(a):R.a.instance.ga(61)?mb.StyleReader.CMa:mb.StyleReader.cpa:mb.StyleReader.cpa;return a}s8i(a){let b="";var c=mb.StyleReader.aE(a);c&&(b+=c.id);mb.StyleReader.nr&&({tableStyle:a,x7a:c}=mb.StyleReader.nr.r$a(a),a&&(b+=a.id),c&&(b+=c.id));return b}Yaa(){this.gb.Jda(this.Ma,16,!0)}Igb(){this.WEd.value&&this.gb.eab.Igb()}iK(a){if(!this.Uol()){this.Igb();var b=this.gb;this.KFf();za.a.Cu(this.Ji);za.a.Cu(this.dab);
var c=this.Ji;c.style.minHeight="";this.ot=[];this.Esd=0;var f=new Ka.a,l=0;a&&(l=this.whi(a,b,f,c,l));if(!this.Tol()){a=!1;var w=this.htmlElement.parentNode,H=this.htmlElement.nextSibling;w&&(this.Foc(w,this.htmlElement),a=!0);this.yhd&&this.yhd.FPl();var U=l;l=this.$Ck.h1k(b,this.Nd,c,this.FBj,f,Object(F.a)(this,this.H5g,"onOverHyperlink"),Object(F.a)(this,this.D5g,"onOutHyperlink"),Object(F.a)(this,this.PM,"takeOwnershipOfSubtree"),Object(F.a)(this,this.Xo,"takeOwnership"),da.a.WOc,this.Epg,l,
this.Anb,this.Bnb,this.OTb,Mf.e1c,!!this.IR&&this.IR.DGb,this.uCd,Pc.App.XR.pYe,fe.OutlineElementReader.um(Pa.OutlineElementNavigator.WA(this.gb)));if(!u.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||this.ew.mFf(b,f))this.ew.uEh(c,this.Nd,l.gsf,b,U,f,de.a.instance.Na?de.a.instance.Na.mb:null,this.i2c)||this.Nd.pp||this.ew.eJh(b);this.ot=f.toArray();this.DBc=l.v_g;this.R9e=l.xFf;this.uCd=l.xcg;this.yhd&&this.yhd.APl(this.P9g);this.wkh&&this.wkh.DPl(c);this.NHh();this.RCd=
!0;a&&w.insertBefore(this.htmlElement,H);!this.Qc.Wl&&w&&"li"===ha.a.rg(w.tagName)&&this.Chi(b,w);this.Qc.Wl||this.ew.fIf(c)}}}Chi(a,b){if(rb.ListReader.Bna){if(b=this.ITc(a)){const c=b.sc(this.Qc.Ma);if(c){const f=za.a.gda(this.htmlElement,"Paragraph");this.HCk(a)?(a=(a=this.Sfj(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):za.a.MOd(f,c.htmlElement);b.anchor.hk(this.Ma,64)}}}else this.DVa.dKf(b,a,this.Ma)}Sfj(a){for(let b=0;b<a.children.length;b++){const c=
a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}HCk(a){if(!a)return!1;a=a.Ra;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.Wq:!1:!1}ITc(a){const b=new ob.GraphIterator;b.set(a);return b.Ze()?(Pa.OutlineElementNavigator.Re(b),this.Sf.hg&&!b.QI(4)?b.Bb(31):b.Bb(4)):null}whi(a,b,c,f,l){a=Ke.a.nb(a.b2,a.currentNode);if(!a.Ii())return l;let w=0,H=!1,U=0,ja=0,wa=0,Sa=!1;const eb=zb.ParagraphReader.cX(b),ub=this.WEd.value;do{const Ub=a.Xq.htmlElement;Sys.UI.DomElement.containsCssClass(Ub,
da.a.kW)?(ub&&b.eab.dQl?(Sa||(rb.ListReader.qx&&eb||b.eab.WPl(this.dab),f.appendChild(this.dab)),this.dab.appendChild(Ub)):f.appendChild(Ub),T.a.Sv(Ub,da.a.VFa,l++),c.add(Ub),this.Qc.Nh&&({Dnk:U,fmk:ja,emk:wa}=Mf.fdl(b,Ub,ub,a,Sa,U,ja,wa)),H=Sa=!0):f.appendChild(Ub)}while(a.EEa());ub?this.Qc.Wl?this.DFl():(this.QHh(wa+6,ja+6),w=ja+6):w=ja-U+6;H&&!Pc.App.instance.VCj&&this.Qc.Nh&&f.clientHeight<w&&(f.style.minHeight=w+"px");return l}QHh(a=0,b=0){this.WEd.value&&this.gb.eab.VPl(this.dab,a,b)}ivd(){const a=
new Ke.a(this.Ma);a.set(this.gb);a.Ze();Pa.OutlineElementNavigator.Re(a);rb.ListReader.qx&&(this.uKe.Krh(this.gb,this.Ji,fe.OutlineElementReader.um(a.currentNode),this.Ma),this.DVa.aGl(a))}NHh(){this.w_.Jkc(this.gb,this.Ji)}ZMi(){const a=Ab.a.instance.rb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.oZ=this.nZ=this.Bnb=this.Anb=-1)}get rja(){return this.Qc.Wl?this.gb.sc(this.Qc.Hf.Ma).rja:this.Anb}set rja(a){this.Anb!==
a&&(this.Anb=a,this.Roa(16),this.gb.anchor.hk(this.Qc.Ma,16))}get sja(){return this.Qc.Wl?this.gb.sc(this.Qc.Hf.Ma).sja:this.Bnb}set sja(a){this.Bnb!==a&&(this.Bnb=a,this.Roa(48),this.gb.anchor.hk(this.Qc.Ma,48))}get SS(){return this.Qc.Wl?this.gb.sc(this.Qc.Hf.Ma).SS:this.nZ}set SS(a){this.nZ!==a&&(this.nZ=a,this.Roa(16),this.gb.anchor.hk(this.Qc.Ma,16))}get Sra(){return this.Qc.Wl?this.gb.sc(this.Qc.Hf.Ma).Sra:this.oZ}set Sra(a){this.oZ!==a&&(this.oZ=a,this.Roa(48),this.gb.anchor.hk(this.Qc.Ma,
48))}get k9(){return this.Qc.Wl?this.gb.sc(this.Qc.Hf.Ma).k9:this.OTb}set k9(a){this.OTb!==a&&(this.OTb=a,this.Roa(16),this.gb.anchor.hk(this.Qc.Ma,16))}get FTf(){return this.ot[this.ot.length-1]}dispose(){this.aYk();super.dispose();this.KFf();for(let a of this.R9e)a.eQf(this.Nd)}aYk(){if(this.L2a&&this.htmlElement)for(let a of this.L2a)a.$Xk(this.htmlElement)}Ena(){super.Ena();this.uCd&&this.Qc.notify(2)}evd(a){const b=u.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Qc.ZJe.z9d(this.gb);
this.kId.kkh(c,this.L2a,this,this.htmlElement,b,this.ekl());this.L2a=c;this.RCd||this.NHh();this.RCd=!1;super.evd(a)}Roa(a){this.$Yh.Evh(this.gb)||super.Roa(a)}Uol(){if(this.rkg()){const a=this.Qc;if(1!==a.editingView.wub)return a.IZd=!0}return!1}Tol(){return this.Qc.Wl&&nb.SelectionEditor.gua(de.a.instance.Na.mb)?!0:!1}DFl(){var a=this.gb.sc(this.Qc.Hf.Ma);a&&(a=Sys.UI.DomElement.getBounds(a.dab),this.QHh(a.width,a.height))}ekl(){return!this.rkg()&&!this.Qc.Wl}rkg(){if(na.InteractiveViewManager.instance.Qd!==
this.Qc)return!1;const a=this.Qc.editingView;return a.Dg===this.gb&&2===a.mode}RSj(){const a=this.getBounds(),b=Kd.a.ai(this.Qc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}DEe(a){a.vlh(this);0<this.Esd&&a.K2k(this)}get EYa(){return this.Ji}fIh(a){this.q9e=new Kj.a(0,a,0)}getBounds(){const a=P.a.Bsb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Qc.Nh?this.gb.id.toString():"");this.uKe.Zci(this.gb,a,fe.OutlineElementReader.um(Pa.OutlineElementNavigator.WA(this.gb)),
this.Qc.Ma);return a}H5g(a){dh.a.cgl(a.Ec,a.rD);if(Pc.App.E_b){const b=a.Ec,c=b.querySelector(".NormalTextRun")||b;R.a.instance.ga(8)||a.a_?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,Mf.cFe);ff.a.instance().Z$h(Object(F.a)(this,this.MHe,"onCtrlKeyDown"));ff.a.instance().$$h(Object(F.a)(this,this.OHe,"onCtrlKeyUp"))}return!0}D5g(a){Sys.UI.DomElement.removeCssClass(a.Ec,Mf.cFe);ff.a.instance().mjh(Object(F.a)(this,this.MHe,"onCtrlKeyDown"));ff.a.instance().njh(Object(F.a)(this,
this.OHe,"onCtrlKeyUp"));return!0}KFf(){for(let a=0;a<this.KNa.count;a++)Pc.App.Kb.WR.yb(sa.a.ona,this.KNa.ga(a),Object(F.a)(this,this.H5g,"onOverHyperlink")),Pc.App.Kb.WR.yb(sa.a.pna,this.KNa.ga(a),Object(F.a)(this,this.D5g,"onOutHyperlink")),ff.a.instance().mjh(Object(F.a)(this,this.MHe,"onCtrlKeyDown")),ff.a.instance().njh(Object(F.a)(this,this.OHe,"onCtrlKeyUp"));this.KNa.clear();if(this.DBc){for(let a of this.DBc)Pc.App.Kb.WR.yb(a.eventName,a.Ec,a.handler);this.DBc=null}}MHe(){this.vya("pointer")}OHe(){this.vya("text")}vya(a){for(let b=
0;b<this.KNa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.KNa.ga(b),Mf.cFe)){const c=this.KNa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get e1c(){return!!de.a.instance.Na&&!!de.a.instance.Na.mb&&de.a.instance.Na.mb.e1c}static ouf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static fdl(a,b,c,f,l,w,H,U){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.eab.DOl(f.currentNode),b.x=a.x,b.y=a.y,b.height&&
b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<w)w=b.y;if(!l||a>H)H=a;b=b.x+b.width;if(!l||b>U)U=b;return{Dnk:w,fmk:H,emk:U}}}Mf.Hcg="HiddenParagraph";Mf.cFe="MouseIsOn";Object(n.a)(Mf,"ParagraphViewElement",dh.a,[1035,1446,494,346,106]);class ke extends dh.a{constructor(a,b,c,f,l,w){super(a,b);this.Wg=this.fd=this.Kba=this.uId=null;rb.ListReader.Bna?(this.GPf(),this.tXe(!0),this.Kba=c,this.uId=l,this.fd=w,this.Wg=f,this.C1a(!0)):(this.tXe(!1),a=this.Nd.jp(Ga.a.span),a.className=
"ListGhost",this.nc(a))}C1a(a){if(rb.ListReader.Bna){var b=this.C5f(this.gb);a&&(a=this.GYd(),this.nc(a),(b=Object(qa.a)(Mf,b.sc(this.Qc.Ma)))&&b.htmlElement&&(b=b.Ji))&&((a=za.a.y5b(b,ke.Tbb))?b.replaceChild(this.htmlElement,a):za.a.MOd(b,this.htmlElement))}}get woe(){return za.a.y5b(this.htmlElement,ke.sbc)}Ny(){this.C1a(!1);if(!this.Qc.Wl&&rb.ListReader.Bna)if(this.fd.hg)this.Tcl(this.htmlElement,this.woe,this.gb);else{const a=this.Kba.fBb(this.gb);this.woe.innerText=a}}iK(a){this.Qc.Wl||rb.ListReader.Bna&&
a.currentNode.anchor.hk(this.Ma,64)}DEe(a){rb.ListReader.Bna&&a.vlh(this)}get EYa(){return this.htmlElement}fIh(){}ivd(){this.Ucl()}l4f(){return-1}Tcl(a,b,c){var f=this.Wg.L8d(c);if(f)if(12!==f.type)Ba.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",f.type);else{var l=f.Ra,w=l?l.last.Ho:null;l=l?l.last.Bp:null;var H=f.Mlb,U=f.WIb,ja=f.K8();f=!!H&&U.P1f(ja).Sa(Va.a.listID);H=null;f&&(H=U.Sa(Va.a.listID)&&ja.Sa(Va.a.listID)?3:U.Sa(Va.a.listID)?2:1);U=this.Kba.fBb(c);
c=this.Kba.fBb(c);w=!!w||f&&(1===H||3===H);l=!!l||f&&(2===H||3===H);H=!w&&!l&&""!==U&&U!==c;for(ja=!w&&!l&&!H;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,jc.uoe);Sys.UI.DomElement.removeCssClass(a,jc.Z3);if(ja)b.innerText=c;else{if(l||H)ja=Hc.a.createElement(b.ownerDocument,Ga.a.span),Sys.UI.DomElement.addCssClass(ja,jc.qCh),ja.innerText=U,b.appendChild(ja);if(w||H)U=Hc.a.createElement(b.ownerDocument,Ga.a.span),Sys.UI.DomElement.addCssClass(U,
jc.sCh),U.innerText=c,b.appendChild(U);w||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,jc.uoe);f&&Sys.UI.DomElement.addCssClass(a,jc.Z3)}}else Ba.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}C5f(a){if(!a)return null;const b=new ob.GraphIterator;b.set(a);b.Ze();return Pa.OutlineElementNavigator.Re(b)?b.Bb(2):null}GYd(){const a=this.Nd.jp(Ga.a.span);Sys.UI.DomElement.addCssClass(a,ke.Tbb);this.hMc(a);return a}hMc(a){const b=Hc.a.createElement(a.ownerDocument,
Ga.a.span);Sys.UI.DomElement.addCssClass(b,ke.sbc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}Ucl(){if(!this.Qc.Wl){var a=this.C5f(this.gb),b=a.sc(this.Qc.Ma).htmlElement.parentNode;!this.Qc.Wl&&b&&"li"===ha.a.rg(b.tagName)&&this.Kba.dIh(b,a,this.Ma,this.woe,!1)}}}ke.Tbb="ListMarkerWrappingSpan";ke.sbc="ListMarker";Object(n.a)(ke,"NumberListViewElement",dh.a,[1446,494,346,106]);var vf=d(391),fo=d(1100);class go{constructor(a,b){this.offsetWidth=a;this.offsetHeight=
b}}Object(n.a)(go,"ListMarkerOffset",null,[]);class ho{constructor(){this.rck="ListMarkerMeasuringPad";this.Gfc=new qd.a}hdj(a){let b=a.innerHTML;if(!b.length)return new go(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.Gfc.Gb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,
a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),fo.a.TZb(),fo.a.j$a(this.rck).appendChild(a),{width:c,height:a}=Kd.a.SSc(a),this.Gfc.$(b,new go(c,a)),fo.a.E3b());return this.Gfc.ga(b)}}Object(n.a)(ho,"ListMarkerOffsetCache",null,[1308]);var Of=d(1212),io=d(1229),eh=d(83),rk=d(256),cf=d(184),qn=d(493);class Lj{constructor(a,b){this.fd=this.zZ=this.CK=null;this.Wg=a;this.DG=b;this.yG=rb.ListReader.qx;this.px=B.a.px||B.a.vo}get Rf(){return this.Wg}get wM(){return this.DG}get KL(){return this.CK||
(this.CK=Ab.a.instance.rb("Box4.List.ListSettings"))}get Zja(){return this.zZ||(this.zZ=Ab.a.instance.Ja("Common.IZoomManager"))}set Zja(a){this.zZ=a}get Sf(){return this.fd||(this.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.yG}fBb(a){const b=this.Rf.Y9a(a);return b&&b.propertySet.sa(Za.a.Ui,null)?1===b.listType?this.GBf(b):0===b.listType?this.B1g(b,a):"":""}$Fl(a,b){if(this.enabled&&b&&(this.Rf.Rda(b)||this.Sf.hg&&63===b.type)&&this.Lzb(a)){a.style.display=
"block";var c=this.fxb(a);this.vpd(a,b);c&&(a=this.fBb(b),c.innerText=a)}}dKf(a,b,c){if(this.enabled&&this.Lzb(a)){var f=this.fxb(a);f&&this.dIh(a,b,c,f)}}dIh(a,b,c,f,l=!1){var w=ob.GraphIterator.nb(b);w.Ze();Pa.OutlineElementNavigator.Re(w);if(rb.ListReader.vk(w)||this.Sf.hg&&rb.ListReader.gac(w)){const U=w.currentNode;var H=fe.OutlineElementReader.um(U);this.Sf.hg?this.Rf.L_g(w):this.Rf.qna(w);w=w.currentNode;if(!rb.ListReader.Bna){const ja=this.fBb(w);f.innerText=ja}f.setAttribute(Bc.a.SK,Bc.a.jC);
12!==b.type?qn.a.p_c(b)&&(a=f.parentNode,f.style.height="auto",b=c=0,{width:c,height:b}=this.Rwb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=H?"13px":c+"px",f.style.marginRight=H?c+"px":"13px",za.a.ubl(f,H?"right":"left"),H=0,{height:H}=this.Rwb(a.parentNode),f.style.marginTop=Math.max((H-b)/2,0)+"px"):(this.xfl(a,f,b,U,w,c),this.y5e(b,f,c,w,H,l))}}aGl(a){this.enabled&&a&&a.Xq&&fe.OutlineElementReader.um(a.currentNode)}x5e(a,b,c,f,l=-1){this.enabled&&(zb.ParagraphReader.cX(a)||
this.Sf.hg&&zb.ParagraphReader.nPj(a))&&this.bIh(a,b,c,l,null)}YFl(a,b,c){if(this.enabled&&this.Lzb(a)){var f=za.a.v0f(a,Lj.$Qi);if(f&&(f=za.a.v0f(f,Lj.ZQi))&&(f=za.a.G8(f,Lj.Gfa))&&f.style&&(B.a.fg||(f.style.marginTop="0px"),(a=za.a.G8(a,Lj.YCk))&&(a=za.a.G8(a,Lj.Gfa))&&f.className.startsWith(Lj.Gfa))){if(this.Sf.hg){var l=za.a.Cwb(a,Lj.TLa);var w=za.a.Cwb(f,Lj.TLa)}else l=this.w4d(a,Lj.TLa),w=za.a.G8(f,Lj.TLa);l&&w&&(f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?
"0px":a.style.marginLeft),f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{BXf:b,pXf:c}=this.$Hh(a,f,l,w,b,c),this.qdi(b,c,f))}}}w4d(a,b){return za.a.G8(a,b)}$Hh(a,b,c,f,l,w){var H;""!==a.style.textIndent&&(w&&this.Rf.Ubb||""===b.style.textIndent)&&(w=a.style.textIndent,this.Rf.Ubb&&(H=this.HTc(a))&&(w=this.mpi(H,w)),b.style.textIndent=w);w=this.Owb(c);H=this.Owb(f);Math.floor(H.x)!==Math.floor(w.x)?(a=this.ypi(l,w,H),a=isNaN(a)?
0:a,""!==b.style.textIndent&&(l=b.style.textIndent,w=l.lastIndexOf("px"),0<w&&(l=l.substring(0,w),a+=parseInt(l))),b.style.textIndent=a+"px",w=this.Owb(c),H=this.Owb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{BXf:w,pXf:H}}ypi(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.KL.YQj||(f=this.D5f(a,b,c)):f=this.D5f(a,b,c);return f}D5f(a,b,c){return a?c.x-b.x:b.x-c.x}mpi(a,b){let c=b,f;({width:f}=this.Rwb(a));if(f){var l=a.style.marginLeft,w=a.style.marginRight;const H=l.lastIndexOf("px"),
U=w.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<H&&0<U&&(l=this.yKe(l,H),w=this.yKe(w,U),(b=this.yKe(b,a))||l||w)&&(c=b+f+l+w+"px")}return c}yKe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}qdi(a,b,c){if(B.a.fg){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}l4f(a,b=!1){return(a=this.fxb(a))?({width:a}=this.Rwb(a),b?a+0:a):0}fxb(a){return this.enabled&&this.Lzb(a)?(a=qn.a.qdj(a))?
this.j4f(a):null:null}vpd(a,b,c=!1){if(this.enabled&&this.Lzb(a)){if(this.Sf.hg){var f="1";var l=this.Rf.H8d(b)}else f=this.gdj(b),l=this.Rf.Y9a(b);b=this.Y5b(b,l);c?(Fb.d(a,ua.a.pKi,b),Fb.d(a,ua.a.role,Bc.a.YPa),Fb.d(a,ua.a.oKi,f)):(Fb.d(a,ua.a.ahi,b),Fb.d(a,ua.a.role,Bc.a.YPa),Fb.d(a,ua.a.Syf,f))}}j4f(a){if(!this.enabled||!a)return null;let b=null;(a=this.HTc(a))&&(b=za.a.G8(a,Lj.sbc)||this.hMc(a));return b}Lzb(a){return!!a&&"li"===ha.a.rg(a.tagName)}bIh(){}F1f(){return 720}Rwb(a){let b,c;({width:b,
height:c}=Kd.a.SSc(a));this.Zja&&this.Zja.instance&&this.Zja.instance.ikg(a)&&(b/=this.Zja.instance.n3,c/=this.Zja.instance.n3);return{width:b,height:c}}Owb(a){const b=Kd.a.SSc(a).returnValue;this.Zja&&this.Zja.instance&&this.Zja.instance.ikg(a)&&(b.x/=this.Zja.instance.n3,b.y/=this.Zja.instance.n3);return b}ika(a,b){switch(a.ika()){case 0:return b+"";case 4:return ha.a.wJf(b-1,!0);case 2:return ha.a.yJf(b,!0);case 3:return ha.a.wJf(b-1,!1);case 1:return ha.a.yJf(b,!1);case 22:return 10>b?"0"+b:b+
"";default:return b+""}}GBf(a){if(1!==a.listType)return"";a=this.sfj(a.listType,a.listStyle);return rk.a.XAf(a[0])}B1g(a,b){b=this.Y5b(b,a);return this.ika(a,b)+"."}sfj(a,b){return cf.a.yN(a,b).propertySet.sa(Za.a.Ui,null)}Y5b(a,b){const c=b.Jja;return c!==rk.a.Nw?c:this.Epi(a,b)}Epi(a,b){if(b.lX!==rk.a.Nw)return b.lX;if(b.yA!==rk.a.Nw)return b.yA;let c=1;const f=new ob.GraphIterator;f.set(a);f.Ze();for(Pa.OutlineElementNavigator.Re(f);f.Mta();)if(rb.ListReader.vk(f)){const l=this.Rf.lw(f);if(l&&
b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.lX!==rk.a.Nw)return c+l.lX;if(l.yA!==rk.a.Nw)return c+l.yA;if(a.Sa(Va.a.listID)&&f.currentNode.Sa(Va.a.listID)&&f.currentNode.eb(Va.a.listID)!==a.eb(Va.a.listID))break;c++}}return c}DHl(a,b){Pc.App.Sbb&&(a.Sa(Za.a.fontColor)&&(b.fontColor=a.eb(Za.a.fontColor)),a.Sa(Za.a.fontSize)&&(b.fontSize=a.eb(Za.a.fontSize)),a.Sa(Za.a.font)&&(b.fontName=a.eb(Za.a.font)),a.Sa(Za.a.bold)&&(b.isBold=a.eb(Za.a.bold)),a.Sa(Za.a.italic)&&(b.isItalic=a.eb(Za.a.italic)),
a.Sa(Za.a.superscript)&&(b.isSuperscript=a.eb(Za.a.superscript)),a.Sa(Za.a.subscript)&&(b.QF=a.eb(Za.a.subscript)),a.Sa(Za.a.strikethrough)&&(b.PF=a.eb(Za.a.strikethrough)),a.Sa(eh.a.Zs)&&(b.D_=a.eb(eh.a.Zs)))}C9d(a,b){a=zb.ParagraphReader.T7f(a,R.a.instance.ga(53),R.a.instance.ga(71),R.a.instance.ga(77),R.a.instance.ga(54));this.DHl(b,a);return a}w1f(){return null}cIh(a,b,c,f){const l=c.parentNode;let w=f.sa(Za.a.fontSize,We.Font.yI);if(a.QF||a.isSuperscript)Fb.d(c,ua.a.bNf,(w/2).toString()),w=Math.floor(w*
gc.z0i),l&&(l.style.fontSize=w/2+"pt"),c.style.fontSize=w/2+"pt";else if(rb.ListReader.Bna){if(c.style.fontSize=w/2+"pt",!f.Sa(Za.a.fontSize)&&(a=za.a.Cwb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}xfl(a,b,c,f,l,w){b&&this.Lzb(a)&&(b.style.verticalAlign=a.style.verticalAlign,f&&l&&Pc.App.Sbb&&(w=f.ng(w)))&&(f=this.C9d(c,l,R.a.instance.ga(53),R.a.instance.ga(71),R.a.instance.ga(77),R.a.instance.ga(54)),f=this.w1f(w.Nd,c)||f,this.P5b(a,b,l),!this.Sf.hg||""===
b.style.color&&!Sys.UI.DomElement.containsCssClass(b,jc.uoe)?(c="",f.V3&&(w=f.fontColor,w!==tc.a.auto&&(c=tc.a.xI(w))),b.style.color=c,c=this.Rf.Y9a(l)):c=this.Rf.H8d(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?b.style.verticalAlign="super":f.QF&&(b.style.verticalAlign="sub"),this.cIh(f,a,b,l),f.PF||f.D_)&&(b.style.textDecoration=0<b.style.textDecoration.length?b.style.textDecoration+" line-through":
"line-through")}P5b(a,b){b.style.fontFamily=a.style.fontFamily}HTc(a){return a?za.a.y5b(a,ng.a.Tbb)||this.GYd(a):null}hMc(a){const b=Hc.a.createElement(a.ownerDocument,Ga.a.span);Sys.UI.DomElement.addCssClass(b,Lj.sbc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}GYd(a){if(!a)return null;const b=Hc.a.createElement(a.ownerDocument,Ga.a.span);Sys.UI.DomElement.addCssClass(b,ng.a.Tbb);za.a.MOd(a,b);this.hMc(b);return b}y5e(a,b,c){this.x5e(a,b.parentNode.parentNode,this.wM.Uwb(a).OPb,
this.wM.O9a(a).OPb,c)}}Lj.Gfa="Paragraph";Lj.YCk="ParaWrappingDiv";Lj.ZQi="_EditingElement";Lj.$Qi="_EditingElement_WrappingDiv";Lj.TLa="TextRun";Lj.sbc="ListMarker";Object(n.a)(Lj,"AListMarkerUtility",null,[1309]);var Ie=d(66),$m=d(814);class Pl{}Pl.FTd=8226;Pl.EBf="Arial";Pl.VZd=65532;Pl.fJa=65533;Object(n.a)(Pl,"PptListConstants",null,[]);var Pf=d(60),Jg=d(234);class Ho extends Lj{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){super(a,b);this.v6j=[12295,19968,20108,19977,22235,20116,
20845,19971,20843,20061];this.Ppe=c;this.Gfc=f;this.Ea=l;this.Yl=w;this.$hk=H;this.Pb=U;this.ZC=ja;this.Ih=wa;this.pJ=Sa;this.uH=eb;this.jA=ub;this.xsg=Ub;this.aXa=cc;this.mA=Cc;this.Cva=Fc;this.bfc=Ic}gdj(a){const b=new ob.GraphIterator;b.set(a);b.Ze();Pa.OutlineElementNavigator.Re(b);return b.currentNode.sa(Va.a.listLevel,0)+1+""}bIh(a,b,c,f,l=null){const w=this.Ppe.Wp(L.a.ZFl);l=new Ke.a(f);l.set(a);l.Ze();Pa.OutlineElementNavigator.Re(l);if(rb.ListReader.vk(l)){if(!b){this.Ppe.Xb(Ld.a.xh,{["Reason"]:"ParagraphElementNull"});
w.end();return}f=this.j4f(b);if(!f){this.Ppe.Xb(Ld.a.xh,{["Reason"]:"ListMarkerNotFound"});w.end();return}let H=this.Rwb(f).width;const U=l.Xq.Nd.Md;a=U.fK(this.wM.N8(a).WM,0);c=U.fK(Of.a.Lfa(c,0),0);this.mA&&Object(Ya.a)(308,this.jA.Qd)&&(c=0);l=fe.OutlineElementReader.um(l.currentNode);this.Qcl(b,f,a,c,H,l)}w.end()}Rwb(a){a=this.Gfc.hdj(a);return{width:a.offsetWidth,height:a.offsetHeight}}HTc(a){let b=a;this.aXa&&a&&0<=a.className.indexOf(Gc.a.Gfa)&&(a=za.a.gda(a,Gc.a.y9))&&(b=a);return super.HTc(b)}w4d(a,
b){return this.aXa?za.a.G8(a,Gc.a.y9)?za.a.Cwb(a,b):za.a.G8(a,b):super.w4d(a,b)}$Hh(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.Owb(c);f=this.Owb(f);return{BXf:a,pXf:f}}ika(a,b){switch(a.ika()){case 18:return 21>b?ha.a.fromCharCode(b-1+9312):b.toString();case 19:return this.b3i(b)}return super.ika(a,b)}GBf(a){let b="";if(1===a.listType){const c=a.propertySet.sa(Za.a.Ui,null);c&&c.length&&c[0]&&(b=ha.a.jw(c[0],4))}b=this.Hdi(b?b:"2022",a);if(Pd.a("FixEvalSecurityBugForListMarkerUtility")&&
String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));va.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(io.a)(String.format("'\\u{0}'",b))}B1g(a,b){b=this.Y5b(b,a);return this.ika(a,b)+this.rfj(a)}Qcl(a,b,c,f,l,w){f?this.Scl(a,b,f,c,l,w):this.Rcl(a,b,l,w)}Scl(a,b,c,f,l,w){const H=Math.max(Math.abs(c),l);a.style.textIndent=0<c?H+"px":Math.max(H-f,0)+"px";this.zrh(H-l,-1*H,b,w)}Rcl(a,b,c,f){a.style.textIndent=c+"px";this.zrh(0,-1*c,b,f)}zrh(a,b,c,f){c.style.marginLeft=
f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}rfj(a){a=a.z9;for(let b=0;b<a.length;b++)if(a[b]===Pl.fJa){if(b+2>=a.length)break;return a[b+2]?ha.a.fromCharCode(a[b+2]):""}return"."}b3i(a){let b="";for(;0<a;)b=ha.a.fromCharCode(this.v6j[a%10])+b,a=parseInt(String(a/10));return b}Hdi(a,b){let c=a;1===b.listType&&b.P$a&&0<=Array.indexOf(Ho.$5k,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));return c}C9d(a,b,c,f,l,w){if(!this.xsg)return super.C9d(a,b,c,f,l,w);f=this.Pb.Mc(b);f.rc(11);f.Jg(11);l=this.pJ.qQ(f,
this.uH.nda(f));c=new $m.ParagraphStandardProperties;(w=this.Yl.Tka(b))||this.$hk.PLj(b)?(c.fontColor=tc.a.nRa,c.fontSize=w?Pf.a.$0g:zb.ParagraphReader.Rja(a,Za.a.fontSize,We.Font.yI)):(b.Sa(Za.a.fontColor)?c.fontColor=b.eb(Za.a.fontColor):l&&l.Sa(Za.a.fontColor)&&!Ie.isTableCellOrInside(f)?c.fontColor=l.eb(Za.a.fontColor):c.fontColor=this.Ih.Rja(a,Za.a.fontColor,tc.a.nil),f=this.Ih.Rja(a,Za.a.fontSize,We.Font.yI),a=this.Ea.YDa(this.Ea.en(a)),a*=f,b.Sa(hb.a.Yvb)&&(a*=b.eb(hb.a.Yvb)),c.fontSize=a);
return c}cIh(a,b,c){this.xsg&&(b=this.ZC.KI(b))&&a.Ota&&(c.style.fontSize=b.Nd.Md.pja(a.fontSize),c.style.lineHeight="0.1")}N2f(a,b){let c="";const f=this.Rf.Y9a(b);1===f.listType&&f.P$a?c=f.font&&-1===f.font.indexOf(",")?ea.FontUtils.oja(f.font):f.font:19===f.ika()||18===f.ika()&&21>this.Y5b(b,f)?c=ea.FontUtils.oja("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}P5b(a,b,c){a=this.N2f(b,c);b.style.fontFamily=
a;b.style.fontFamily||!B.a.Vj&&!B.a.vo||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}y5e(a,b,c,f,l,w=!1){if(this.aXa){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(Gc.a.y9)?b.parentNode:b,this.x5e(a,b,this.wM.Uwb(a).OPb,this.wM.O9a(a).OPb,c)}else super.y5e(a,b,c,f,l,w)}fxb(a){return super.fxb(a)}Zcj(a,b){return this.Y5b(b,a)}vpd(a,b,c=!1){if(this.Cva){const l=this.Pb.Mc(b);l.rc(11);
l.Jg(11);l.Bb(2);if(c){if(b&&b.Sa(hb.a.yig)&&!b.eb(hb.a.yig)){var f=b.sa(Za.a.Ui,null);f&&0<f.length&&a.setAttribute("data-charcodes",f.toString());f=this.fxb(a);f=this.N2f(f,b);ha.a.Wa(f)||a.setAttribute("data-font",f);a.setAttribute("data-buAutoNum",b.sa(hb.a.autonumberBulletType,8))}this.bfc&&l.currentNode.Sa(hb.a.Pje)&&!l.currentNode.eb(hb.a.Pje)&&a.setAttribute("data-margin",l.currentNode.sa(Va.a.$l,Jg.a.leftMargin).toString())}}super.vpd(a,b,c)}w1f(a,b){return this.mA&&a&&b&&(Object(Ya.a)(308,
a)||Object(Ya.a)(308,this.jA.Qd)&&a.Wl)?(a=new $m.ParagraphStandardProperties,a.fontName=We.Font.ZS,a.fontColor=tc.a.nRa,a.fontSize=Pf.a.Xpl,a):null}}Ho.$5k="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(n.a)(Ho,"ListMarkerUtility",Lj,[861]);class an{static Q4j(){"GetSpecialIndentWithTabs"in an.Xnh||(an.Xnh.GetSpecialIndentWithTabs=!0,va.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}an.Xnh={};Object(n.a)(an,"SessionLogger",
null,[]);class sk{constructor(a,b,c,f,l,w){this.K8c=a;this.p$=b;this.Ih=c;this.Pb=f;this.pJ=l;this.Jvg=w}Krh(a,b,c,f=-1){let l=this.Jvg;0<=f&&(l=this.S1f(a,f)||l);this.Hdl(a,b,c,l);this.Idl(a,b,l,f)}S1f(a,b){let c=null;(a=a.sc(b))&&a.Nd&&(c=a.Nd.Md);return c}Hdl(a,b,c,f){let l=0;this.Ih.cX(a)||(l=f.fK(this.p$.N8(a).WM,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=l+"px",b.style.marginRight="")}Idl(a,b,c,f=-1){var l=this.p$.cTc(a).WM;a.anchor&&this.Ih.cX(a)&&0<=f?this.K8c.x5e(a,
b,Of.a.fK(l,0),0,f):(f=c.fK(l,0),l=c.fK(this.p$.N8(a).WM,0),b.style.textIndent=this.Clj(f,l,this.LCi(a),this.b9i(a),c)+"px")}LCi(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}b9i(a){let b=a.sa(Va.a.Gub,sk.jJc);if(!a.Sa(Va.a.Gub)){const c=this.Pb.Mc(a);c.set(a);c.rc(11);c.Jg(11);(a=this.pJ.qQ(c,a.sa(Va.a.listLevel,Jg.a.PEa)))&&(b=a.sa(Va.a.Gub,sk.jJc))}return b}Clj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&
(c=0,an.Q4j());0<c&&(f=l.fK(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}Zci(a,b,c,f=-1){var l=this.Jvg;0<=f&&(l=this.S1f(a,f)||l);a=this.p$.cTc(a).WM;l=l.fK(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}sk.jJc=1440;Object(n.a)(sk,"ParagraphViewIndentationStrategy",null,[1445]);var Ef=d(427),bm=d(643),rh=d(368),ie=d(149),Bl=d(232),jo=d(264);class Ql{constructor(a,b,c){this.success=a;this.rCk=b;this.RKk=c}}Object(n.a)(Ql,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var Io=d(820);class bn{constructor(){this.Lm=
new K.DictionaryPropertySet}eb(a){return this.Lm.eb(a)}sa(a,b){return this.Lm.sa(a,b)}Sa(a){return this.Lm.Sa(a)}get propertySet(){return this.Lm.clone()}get JN(){return this.Lm.sa(Za.a.font,We.Font.ZS)}get mV(){return this.Lm.sa(Va.a.mV,-1)}get fieldInstruction(){return this.Lm.sa(Va.a.fieldInstruction,"")}get Ota(){return this.Lm.Sa(Za.a.fontSize)}get fontSize(){return this.Lm.sa(Za.a.fontSize,We.Font.yI)}get V3(){return this.Lm.Sa(Za.a.fontColor)}get fontColor(){return this.Lm.sa(Za.a.fontColor,
tc.a.nil)}get bcg(){return this.Lm.Sa(Io.a.A0b)}get oYf(){return this.Lm.sa(Io.a.A0b,1)}get RTa(){return this.Lm.Sa(Za.a.highlight)}get highlight(){return this.Lm.sa(Za.a.highlight,tc.a.nil)}get U$a(){return this.Lm.Sa(eh.a.NR)}get NR(){return this.Lm.sa(eh.a.NR,tc.a.nil)}get dcg(){return this.Lm.Sa(Za.a.kt)}get language(){return this.Lm.sa(Za.a.kt,0)}get LTa(){return this.Lm.Sa(Za.a.bold)}get isBold(){return this.Lm.sa(Za.a.bold,!1)}get R$a(){return this.Lm.Sa(Za.a.italic)}get isItalic(){return this.Lm.sa(Za.a.italic,
!1)}get iyb(){return this.Lm.Sa(Za.a.underline)}get hE(){return this.Lm.sa(Za.a.underline,!1)}get wWc(){return this.Lm.Sa(Za.a.Rw)}get Rw(){return this.Lm.sa(Za.a.Rw,We.Font.tV)}get hyb(){return this.Lm.Sa(Za.a.strikethrough)}get PF(){return this.Lm.sa(Za.a.strikethrough,!1)}get W7b(){return this.Lm.Sa(eh.a.Zs)}get D_(){return this.Lm.sa(eh.a.Zs,!1)}get isSuperscript(){return this.Lm.sa(Za.a.superscript,!1)}get QF(){return this.Lm.sa(Za.a.subscript,!1)}get NG(){return this.Lm.sa(Va.a.NG,null)}get it(){return this.Lm.sa(Za.a.it,
!1)}get G_(){return this.Lm.sa(Za.a.G_,!1)}get jn(){return this.Lm.sa(Za.a.jn,!1)}get Eab(){return this.Lm.sa(Va.a.Eab,!1)}get SUa(){return this.Lm.sa(Yd.a.Twa,!1)}get MTa(){return this.Lm.Sa(eh.a.capitalization)}get capitalization(){return this.Lm.sa(eh.a.capitalization,0)}get fFa(){return this.Lm.sa(Va.a.fFa,!1)}Yp(a,b){b.Sa(a)&&this.Lm.setValue(a,b.Mh(a))}static OIc(a){const b=new bn;b.Lm.setValue(Za.a.fontSize,Pf.a.Upl);b.Yp(Za.a.superscript,a.propertySet);b.Yp(Za.a.subscript,a.propertySet);a.it&&
b.Lm.setValue(Za.a.underline,!0);return b}}Object(n.a)(bn,"PptSmartArtFormattingCache",null,[988]);class Sj{constructor(a,b,c,f){this.aji=a;this.dji=b;this.bji=c;this.cji=f}}Object(n.a)(Sj,"SelectionImageProperty",null,[]);var ki=d(150),nf=d(72);class li{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg){this.xAg=this.wAg=!1;if(!lg)throw Error.argumentNull("graphTopologyManager");this.jA=a;this.Ea=b;this.ic=c;this.V7j=f;this.Qo=l;this.ZC=w;this.Pgc=H;this.py=U;this.mz=
ja;this.EX=wa;this.ua=lg;this.Hdb=Sa;this.E7c=eb;this.oDb=ub&&!Ud;this.aXa=Ub;this.iXa=cc;this.zDb=Fc;this.Fec=Ic;this.ocd=Cc&&!Ud;this.mA=je;this.nma=Vd;this.F7c=Ve;this.Kff=af;this.Qbk=Zf;this.ua=lg;this.Hbk=Tg}M9a(a,b){if(b.sa(hb.a.xFa,!1))return Pf.a.$0g;b=this.Ea.YDa(this.Ea.en(b));return Cf.a.fz(b,1)?a:2*Math.round(a*b/2)}Ayf(a,b){if(!this.Kff||!a)return b;const c=li.O2f(a);if(a===c)return b;Pd.a("PPTO.TextRendering.UpdateFontFamilyWithWebFontFallback")&&(this.py&&this.py.MOj?({T4b:b}=li.Aud(a,
this.py.Bac(a),b)).returnValue||({T4b:b}=li.Aud(c,this.py.HLj(c),b)).returnValue:({T4b:b}=li.Aud(c,!0,b)).returnValue&&({T4b:b}=li.Aud(a,!0,b)).returnValue);return b}Xjj(a){if(!this.Hbk||ha.a.Wa(a))return null;const b=this.ua.presentation.$4d;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}P2f(a,b,c){return c.pja(this.M9a(a,b))}s0f(a,b){return a.Sa(hb.a.ttb)?b.Nfa(a.eb(hb.a.ttb)/Ef.a.xmc,0)+"px":null}Q3f(a){if(a.Sa(hb.a.NAb)){const b=a.eb(hb.a.NAb)/Ef.a.xmc;
a=a.fontSize;return 0<b&&a*Ef.a.$$a>=b?"normal":"none"}return null}R7d(a,b,c,f){let l=null;this.Hdb?l=tc.a.xI(0):!c&&f||!b.V3?this.oDb&&f&&(l=R.a.instance.ga(119)?b.sa(hb.a.B8b,!1)?this.p3f(a):tc.a.xI(b.fontColor):this.p3f(a)):(a=b.fontColor,l=a===tc.a.auto?"WindowText":tc.a.xI(a));return l}Hvh(a,b,c,f,l){return!b&&!c&&!f&&!l&&(!this.E7c||a.isSuperscript||a.QF)}l8f(a){return a.Sa(hb.a.qN)?a.eb(hb.a.qN)/1E3:0}hae(){return 2/3}p3f(a){let b=null;var c=Object.assign(new bm.a,{schemeClrField:Object.assign(new rh.a,
{valField:10})});a=Object(qa.a)(115,this.ic.jg(a));(c=this.V7j.KH(c,a?a.Jd:null))&&(b=ie.Box4ColorHelper.Jga(c).oV());return b}kvh(a,b){return this.oDb||a||!b}Qvh(){return!0}mvh(){return this.oDb}SHl(a,b,c,f){if(!c||!c.Ua||!f||1>f.length)return b;let l=0,w=0;for(let H=0;H<f.length;H++){if(c.Ua.Qa>=w&&c.Ua.Qa<w+f[H]||c.Ua.Qa===w+f[H]&&f[H]>b.Lines[H]){l=H;break}w+=f[H]}c=0;for(const H of b.Lines)c+=H;a=a.Ra.ga(a.Ra.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}mFf(a,b){a=Object(qa.a)(Sd.AParagraphNode,
a);if(!a||!a.Ra)return!1;let c=0;for(let f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}uEh(a,b,c,f,l,w,H,U){if(!(this.aXa&&a&&c&&c.length&&b))return!1;var ja=this.Ea.en(f);if(!ja)return!1;ja=this.iXa&&ja.BCb;if(!b.pp&&!ja)return!1;f=Object(qa.a)(Sd.AParagraphNode,f);if(!f||!f.Ra||!ja&&this.Pgc.c8a(f))return!1;c=this.Y7i(c,f,!b.pp);if(this.OMi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.Qo||
this.Qo.Aua)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.zDb?this.eAl(f,a,b,l,w,H,U):this.cAl(a,b,c)}eJh(a){this.iXa&&a&&(a=this.Ea.en(a))&&a.BCb&&(va.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),a.hmb(!1))}Vcj(a,b){const c=ki.a.ki(a,hb.a.nOb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Ra.length)return va.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",
c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Ra.ga(a.Ra.length-1).cp+1!==b)return null}return c}cAl(a,b,c){if(!c)return!1;const f=new Ka.a;for(const l of c){c=b.jp(Ga.a.span);Sys.UI.DomElement.addCssClass(c,Gc.a.y9);f.add(c);let w=!1;for(let H=0;H<l;H++)if(a.firstChild)c.appendChild(a.firstChild);else{va.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");w=!0;break}if(w)break}b=Object(qa.a)(1035,this.ZC.KI(a));if(!b)return va.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let l of f)b.Xo(l),a.appendChild(l);return!0}eAl(a,b,c,f,l,w,H){if(!b||!c)return!1;let U=ki.a.ki(a,hb.a.nOb,null);if(!U||!U.Lines||!U.Lines.length)return!1;for(this.Qbk&&(U=this.SHl(a,U,w,H));l.count>f;)l.removeAt(f);a=new Ka.a;H=w=f=null;for(let ja=0;ja<U.Lines.length;ja++){f=c.jp(Ga.a.span);Sys.UI.DomElement.addCssClass(f,Gc.a.y9);a.add(f);const wa=this.I8h(U.Lines[ja],b,f,w,H,l);w=wa.rCk;H=wa.RKk;this.M5j(ja,U.Lines.length,f.lastChild);if(!wa.success){va.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");
break}}for(this.JGc(w,f,l);b.firstChild;)this.JGc(b.firstChild,f,l);return this.dAl(b,a)}M5j(a,b,c){li.zAg||(dg.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",0,"pptotext",null),li.zAg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!li.yAg&&!a&&b&&c&&(dg.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),li.yAg=!0))}I8h(a,b,c,f,l,w){let H=!0;for(;0<
a;){if(!(f&&f.innerText.length||b.firstChild)){va.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");H=!1;break}let U;f?(l=U=f,f=null):(U=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(U,Gc.a.FN)&&(l.style.lineHeight=U.style.lineHeight),l=null);const ja=U.innerText.length;a>=ja?(this.JGc(U,c,w),a-=ja):(f=U.cloneNode(!1),this.crl(U,f,a),this.JGc(U,c,w),a-=U.innerText.length)}return new Ql(H,f,l)}crl(a,b,c){a=a.childNodes;let f=-1;for(let l=
0;l<a.length;l++){const w=a[l];if(c)if(c>=w.innerText.length)c-=w.innerText.length;else{const H=w.cloneNode(!0);H.innerText=w.innerText.substring(c,w.innerText.length+1);b.appendChild(H);w.innerText=w.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}JGc(a,b,c){if(a&&b&&c){b.appendChild(a);a=za.a.X9a(a);for(let f of a)c.add(f),T.a.Sv(f,"leafEltIdx",c.count-1)}}dAl(a,b){const c=Object(qa.a)(1035,this.ZC.KI(a));if(!c)return va.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let f of b)c.Xo(f),a.appendChild(f);return!0}Y7i(a,b,c){const f=this.UBi(this.Vcj(b,c));if(!f||!f.length)return null;c=f.length;const l=Array(c);let w=0,H=1;for(let U=0;U<b.Ra.length;U++)H<c&&b.Ra.ga(U).cp===f[H]&&(l[w]=a[U],w++,H++);l[c-1]=a[a.length-1];if(H!==c)return va.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}UBi(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=
Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}OMi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const f of b){b=!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],Gc.a.rN)||Sys.UI.DomElement.containsCssClass(a[l],Gc.a.E1d)||(b=!1);if(b)return!0;c+=f}return!1}u1f(a,b,c){const f=new Vc.a;if(!a||!b||!c)return va.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":
"null",c?"not null":"null"),f;this.jil(a,b)&&(a=null,c.Sa(hb.a.schemeColor)&&(a=c.eb(hb.a.schemeColor),a=this.ifj(b,a)),ha.a.Wa(a)||f.$("data-scheme-color",a),this.F7c&&c.Sa(hb.a.qZc)&&(c.eb(hb.a.qZc)?f.$("data-usefontface","false"):f.$("data-usefontface","true")));return f}ifj(a,b){if(ha.a.Wa(b))return"";const c=jo.SchemeColor.parse(b);if(c&&c.color&&!c.Nta){a=Object(qa.a)(115,this.ic.jg(a));a=c.resolve(a?a.Jd:null);if(!a)return"";c.ZP=Bl.g(a.D_a);return c.toString()}return b}jil(a,b){return this.Fec&&
a.Wl&&li.FWj(b)}fIf(a){if(this.ocd){a=a.querySelectorAll("."+li.EZd);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.p1k(a[b]);for(b=0;b<c;++b)nf.a.BHj(a[b],f[b].aji,f[b].dji,f[b].bji,f[b].cji)}}n1k(a){return new Sj("linear-gradient(to right, "+nf.a.IKc+", "+nf.a.IKc+")",nf.a.n0e,"0px "+a.style.verticalAlign,nf.a.hsd)}bKj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,Gc.a.l8))return!1;a=a.nextSibling}return!0}o1k(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+
Gc.a.l8);for(let w=0;w<l.length;w++){const H=l[w];f+=this.h$i(H);b=Math.min(b,H.offsetLeft);c=Math.max(c,H.offsetLeft+H.offsetWidth)}return new Sj("linear-gradient(to right, "+nf.a.IKc+", "+nf.a.IKc+")",0<c-a.offsetLeft?f+"px 100%":nf.a.n0e,b-a.offsetLeft+"px "+a.style.verticalAlign,nf.a.hsd)}p1k(a){return this.bKj(a)?this.n1k(a):this.o1k(a)}h$i(a){let b=0;if((a=a.getClientRects())&&0<a.length)for(const c of a)b+=c.width;return b}v1f(a,b,c){return this.mA&&a&&b&&c&&(Object(Ya.a)(308,a)||Object(Ya.a)(308,
this.jA.Qd)&&a.Wl)?bn.OIc(b):null}Mvh(){return!1}P5b(a){let b=a.sa(hb.a.latinFont,We.Font.ZS);b.startsWith("+")&&(b=a.sa(Za.a.font,We.Font.ZS));let c=new Ka.a;c.add(b);var f=[hb.a.eastAsianFont,hb.a.complexScriptFont,hb.a.YNb];for(var l of f)a.Sa(l)&&(f=a.eb(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.Xjj(b))l=new Ka.a,l.add(b),Pd.a("UseServerFallbackFontFirst")?l.insert(0,a):l.add(a),this.v5j(a,c),c=l;return c.toArray().join(",")}v5j(a,b){this.wAg||ea.FontUtils.isMissingFont(b.ga(0))?
this.xAg||b.contains(a)||(va.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.xAg=!0):(va.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.wAg=!0)}ENe(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.py&&this.py.isEnabled;const f=!!this.mz&&this.mz.isEnabled;if(f||c||this.nma)b=ea.FontUtils.trb(b,a,c,this.nma,f);f&&this.mz.createFontUrl(a);c&&(this.Kff&&a?(c=li.O2f(a),this.py.createFontUrl(a),c&&this.py.createFontUrl(c)):
this.py.createFontUrl(a));this.nma&&this.EX.createFontUrl(a);return b}xdh(a,b){return a?this.ENe(a.fontName,b):b}EZc(){return this.nma}static bTc(a){if(ha.a.Wa(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());return a}static O2f(a){if(ha.a.Wa(a))return null;a=li.bTc(a);let b=a.toLowerCase();for(;b;){let c=!1;b=b.trim();for(const f of li.C0i){let l=f;b.endsWith("\u200b")&&(l+="\u200b");b.endsWith(l)&&(c=!0,b=b.substring(0,b.lastIndexOf(l)+1))}if(!c)break}return a.substring(0,
b.length)}static Aud(a,b,c){return a&&b?(c=ea.FontUtils.K6h(li.bTc(a),c),{returnValue:!0,T4b:c}):{returnValue:!1,T4b:c}}static FWj(a){return a.sa(hb.a.xFa,!1)?!1:!0}}li.EZd="Selection";li.oMf="SelectionShadow";li.C0i=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");li.zAg=!1;li.yAg=!1;Object(n.a)(li,"TextRenderingStrategy",null,[1310]);class cn{constructor(){this.oyb=[]}LQe(a){a&&!Array.contains(this.oyb,a)&&(a.w_=this,Array.add(this.oyb,
a))}Jkc(a,b){for(let c=0;c<this.oyb.length;c++){const f=this.oyb[c];f.pyb&&f.Jkc(a,b)}}}Object(n.a)(cn,"AHighlightManager",null,[1307]);class dn extends cn{constructor(){super();this.NGg=this.Ucc=null}get vja(){return this.Ucc}get Nbb(){return this.NGg}fpd(a){if(a&&((this.Ucc=a)&&0===this.Ucc.action&&(this.NGg=this.Ucc),a.Ada||a.aib)){var b=[];for(let c=0;c<this.oyb.length;c++){const f=this.oyb[c];f.pyb&&Array.addRange(b,f.$Dh(a.Ada,a.aib))}}}}Object(n.a)(dn,"HighlightManager",cn,[]);class En{constructor(a,
b){this.Rva=a;this.tdc=b;this.Rva.kk(Object(F.a)(this,this.ph,"onPropertyChanged"))}dispose(){this.Rva.Rm(Object(F.a)(this,this.ph,"onPropertyChanged"))}ph(a,b){a=b.node;b.property.id===hb.a.nOb.id&&a.isConnected&&!this.tdc.isComposing&&a.anchor.Dr(208)}}Object(n.a)(En,"ParagraphNodeViewBehavior",null,[106]);class Pk{constructor(a){this.tdc=a}Evh(a){if(a=Object(qa.a)(5,a)){if(this.tdc.isComposing){if(!a.O0c)return va.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),
!0;va.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.O0c=!1}return!1}}Object(n.a)(Pk,"ParagraphViewElementCEVSetUpdateStrategy",null,[1444]);class bk{constructor(a){this.E9c=[hb.a.nX,hb.a.xx,hb.a.cea,hb.a.xla,hb.a.aea,hb.a.wla,Va.a.$l,Va.a.wY,Va.a.ho,Va.a.THb,Va.a.listLevel,Za.a.Jl,Za.a.gJ];this.hZh=a.xle;this.h_c=a.h_c;this.gZh=a.pptCopyPasteMarginAndIndentationEnabled}get Thd(){return this.hZh}get lCi(){return!1}get A$g(){return this.gZh}get fDk(){return this.E9c}qkl(a){return!!a.tagName&&
"p"===ha.a.rg(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,Gc.a.Gfa)}Cta(a){const b={};for(const c of this.E9c)b[c.id.toString()]=a.Mh(c);return b}Moa(a,b){if(b){const c=zb.ParagraphReader.cX(a);this.bel(a,b,this.E9c,this.Jlg(a),c);a.setValue(Yd.a.J$b,!0)}}Jlg(a){let b=!1;(a=ob.GraphIterator.nb(a).parentNode)&&fe.OutlineElementReader.r9(a)&&(b=rb.ListReader.KUa(a));return b}hnk(a,b,c,f){this.A$g||(f=!0);if(this.Thd){const l=a.sa(Yd.a.J$b,!1),w=b.sa(Yd.a.J$b,!1),H=l||!f&&!w&&!l?b:a;this.pCi(H,
l||!f&&!w&&!l?a:b,this.E9c,this.Jlg(H),c)}}vnj(a){return this.A$g&&a?zb.ParagraphReader.cX(a)&&a.Sa(hb.a.Oje)&&!a.eb(hb.a.Oje)&&a.Sa(Va.a.ho)?a.eb(Va.a.ho).toString():"":""}bel(a,b,c,f,l){for(const w of c)this.Cvh(w,f,l)||(c=b[w.id.toString()],void 0!==c?a.setValue(w,c):a.removeProperty(w))}pCi(a,b,c,f,l){for(const w of c)this.Cvh(w,f,l)||(c=b.Mh(w),void 0!==c?a.we(w,c):a.removeProperty(w))}Cvh(a,b,c){return this.h_c&&!b&&c&&(a===Va.a.$l||a===Va.a.ho)}}Object(n.a)(bk,"PptFormattingPropertyTransitStrategy",
null,[1441]);class uj{}uj.lGh="UnderlineColor";uj.Kud="UnderlinePositionInEm";uj.Lud="UnderlineThicknessInEm";uj.UQc="FontSizePx";Object(n.a)(uj,"ParagraphViewElementProperties",null,[]);class og extends gc{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af){super(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc);this.Obc=Ic;this.NFg=Cc;this.lDg=Ud&&!Vd;this.ocd=je&&!Vd;this.OFg=Ve;this.Uad=af}KQd(a,b){this.Obc?a.style&&!ha.a.Wa(a.style.verticalAlign)&&(ha.a.Wa(b.style.verticalAlign)?
(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.idi(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.KQd(a,b)}idi(a){if(null!==a.style&&!ha.a.Wa(a.style.verticalAlign)){if(this.NFg&&this.HPj(a)){const b=a.style.backgroundColor;a.style.backgroundColor=null;nf.a.ixf(a,String.format("linear-gradient(to right, {0}, {0})",b),nf.a.n0e,String.format("0px {0}",a.style.verticalAlign),nf.a.hsd)}if(this.ocd||
this.NFg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}r7d(a){return this.Obc?"0px":super.r7d(a)}owf(a){a.style.position=nf.a.Csc}HPj(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&a.style.backgroundColor!==nf.a.zwi}jSe(a,b,c,f){if(this.lDg&&b.it){if(b.PF||b.D_)a.style.textDecoration=nf.a.ctl,f[f.length]="Strikethrough";b.hE&&(f[f.length]="Underlined");
let l,w;this.Uad&&({Kud:l,Lud:w}=this.xoj(b.JN)).returnValue?(T.a.Sv(a,uj.lGh,this.woj(c,b)),T.a.Sv(a,uj.Kud,l),T.a.Sv(a,uj.Lud,w)):ha.a.Wa(a.style.textDecoration)?a.style.textDecoration=nf.a.eAh:a.style.textDecoration+=" "+nf.a.eAh}else super.jSe(a,b,c,f)}woj(a,b){a=this.ew.R7d(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",a)}xoj(a){return{returnValue:"Calibri"===a,Kud:1.1133,Lud:.0654}}OLj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,
Gc.a.l8))return!0;a=a.nextSibling}return!1}nwf(a,b){this.ocd&&(Sys.UI.DomElement.containsCssClass(b,Gc.a.l8)||this.OLj(a,Gc.a.l8)?(Sys.UI.DomElement.addCssClass(a,li.EZd),this.OFg&&B.a.Vj&&Sys.UI.DomElement.addCssClass(a,li.oMf)):(Sys.UI.DomElement.removeCssClass(a,li.EZd),this.OFg&&B.a.Vj&&Sys.UI.DomElement.removeCssClass(a,li.oMf)));if(this.lDg&&Sys.UI.DomElement.containsCssClass(a.parentNode,Gc.a.Cdg)){const c=T.a.Be(a,uj.lGh),f=T.a.Be(a,uj.Lud);let l=T.a.Be(a,uj.Kud);if(c&&f&&l){if(!ha.a.Wa(a.style.fontSize)&&
a.style.fontSize.endsWith("px")&&!ha.a.Wa(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=parseFloat(a.style.fontSize);const w=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(w)||(l-=w/a)}nf.a.ixf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),nf.a.hsd);b.style.textDecoration=nf.a.dtl}}}}Object(n.a)(og,"PptParagraphContentRenderer",gc,[]);class ol{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}Zb(a){this.K=a;this.NQe();this.UQe();this.wWk();
this.QQe();this.DWk();this.EWk();this.vWk()}init(){this.K.register(1307,"Box4.Highlight.IHighlightManager").ma().oa(()=>new dn);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new Ri.a((a,b)=>new Mf(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),new Xb.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.Wl&&u.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?
this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new Ri.a((a,
b)=>new ke(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}NQe(){this.K.register(1308,"PowerPointWebEditor.IListMarkerOffsetCache").ma().oa(()=>new ho);this.K.register(1309,"Box4.IListMarkerUtility").ma().oa(()=>
new Ho(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),Nc.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ibb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}UQe(){this.K.register(1310,
"Box4.ITextRenderingStrategy").ma().oa(()=>new li(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.rb("Box4.CloudFontService"),this.K.rb("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Dhg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").cmg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").$lg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ibb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").oOb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").uCh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").$_c,this.K.resolve("PowerPointWebEditor.IApplicationSettings").bmg,
this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").TOj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").xwl,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").p$k))}wWk(){this.K.register(Rj,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(Pk,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().oa(()=>new Pk(this.K.resolve("Box4.IEditingView")))}QQe(){this.K.register(sk,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().oa(()=>new sk(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),
this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new vf.a))}DWk(){this.K.register(bk,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().oa(()=>new bk(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}EWk(){this.K.register(og,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>
new og(na.InteractiveViewManager.instance,ra.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.rb("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.rb("Box4.IFeatureHelper"),ea.FontUtils.xBi,this.K.rb("Box4.IFontSlotProvider"),
Object(F.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").gfh,"raiseParagraphContentUpdatedEvent"),Kb.a.language,this.K.rb("Box4.ITableOfContentRenderHelper"),Zb.a.eBf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").cmg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").$lg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").bmg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").bjl))}vWk(){this.K.register(En,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().oa(()=>new En(this.K.resolve("Box4.Graph.IGraphInstance").xd(12),this.K.resolve("Box4.IEditingView")))}static main(){v.a.instance.Dc(new ol)}}Object(n.a)(ol,"PPTWebEditorParagraphPackage",null,[2,3]);var ck=d(498),Nm=d(626);class Fn extends Sys.EventArgs{constructor(a){super();
this.Kk=a}}Object(n.a)(Fn,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class en{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud){this.Eze=this.Xva=null;this.Fe=a;this.Ds=b;this.Sd=c;this.mc=f;this.la=l;this.Gic=w;this.X9c=H;this.ny=U;this.Fg=ja;this.Xea=wa;this.pa=Sa;this.gf=eb;this.ua=ub;this.ia=Ub;this.zb=cc;this.wea=Fc;this.To=Cc;this.MC=Ud;H.hQd(Object(F.a)(this,this.yHb,"onPodSessionUnavailable"));H.urb(Object(F.a)(this,this.zfa,"onPodSessionRefreshed"));Ic.iC(Object(F.a)(this,
this.Eo,"onSessionRehydrated"));this.uAe=new Le.a(4,2,2E3,Object(F.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.vg}get P$b(){return!!this.Xva}Jgj(a,b){const c=Rc.a.zk("GetPodSessionInfo");try{const f=this.Fe.podSessionId,l=gh.a.create().toString(),w=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),H={};H.PodSID=f;H["X-UserSessionId"]=this.Gic();H["X-CorrelationID"]=l;c.Va("PodSessionId",f);c.Va("Cid",l);
this.Ds.cW(w,2,null,H,[be.a.N5],0,U=>{try{if(f!==this.Fe.podSessionId)c.Va("ExpectedPodSessionId",f),c.Va("ActualPodSessionId",this.Fe.podSessionId),c.Va("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var ja=!0;if(U.data){if(c.Va("HttpStatus",U.data.ie.toString()),c.Va("RequestStatus",ck.a[U.data.status]),U.data.tj){const wa=U.data.tj[be.a.N5];wa&&"errorCannotFindSession"===wa&&(c.Va("ErrorCode",wa),ja=!1)}}else c.Va("HttpStatus","UNKNOWN"),c.Va("RequestStatus","UNKNOWN");ja?(c.Va("Result",
"Succeeded"),c.finish(),a&&a()):(c.Va("Result","Failed"),c.finish(!0),b&&b())}}catch(wa){va.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",wa),b&&b()}},U=>{try{if(f!==this.Fe.podSessionId)c.Va("ExpectedPodSessionId",f),c.Va("ActualPodSessionId",this.Fe.podSessionId),c.Va("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{if(U.data){if(c.Va("HttpStatus",U.data.ie.toString()),c.Va("RequestStatus",ck.a[U.data.status]),U.data.tj){const ja=U.data.tj[be.a.N5];ja&&
c.Va("ErrorCode",ja)}}else c.Va("HttpStatus","UNKNOWN"),c.Va("RequestStatus","UNKNOWN");c.Va("Result","Failed");c.finish(!0);b&&b()}}catch(ja){va.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ja),b&&b()}},null,void 0,void 0,this.la.Lgj,this.la.Mgj,"GetPodSessionInfo",void 0,!0)}catch(f){va.a.J(512496141,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",f),c.Va("Result","Failed"),c.finish(!0),b&&b()}}yHb(a,b){a=!1;this.Xva?va.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",
this.Fe.presentationId.string,this.ny.Qka,this.Fg.fG,this.Fe.Kk,this.Fe.podSessionId,!this.mc.In,Rc.a.mf(this.Xva),!!this.To.instance,b.MPc):(this.Xva=new Date,a=!0,va.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Fe.presentationId.string,
this.ny.Qka,this.Fg.fG,this.Fe.Kk,this.Fe.podSessionId,!this.mc.In,Rc.a.mf(this.Xva),!!this.To.instance,b.MPc));this.wea.instance&&this.wea.instance.A_c?va.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Fe.Kk,this.Fe.podSessionId):this.ny.Qka&&this.la.podsSeamlessFailoverEnabled&&this.To.instance?this.To.instance.u3e(b.MPc,4,b.errorCode):(this.Sd.Dka=!1,this.ny.Qka?this.Fg.fG?
(a&&this.zb.Db(this.uAe),this.Xea.ZTc(this.Fe.presentationId.string,this.Fe.Kk,this.Fe.podSessionId,b.MPc,c=>{this.N4k(c,this.Fe.Kk)},c=>{this.M4k(c,this.Fe.Kk)}),this.pa.setSelection(null),this.gf.blockContent(this.ua.presentation,"OnPodSessionUnavailable",!0),va.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.$uj():va.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Fe.podSessionId))}$uj(){this.Eze||
(this.Eze=new Date);const a=+new Date-+this.Eze;a>this.la.podsNullSrmWaitTimeInMs?(va.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Fe.podSessionId),u.AFrameworkApplication.zp(pf.a.Vh(305)),dg.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.La(L.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):va.a.J(512496134,801,
15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",this.la.podsNullSrmWaitTimeInMs,a,this.Fe.podSessionId)}detectFailoverTimeout(){if(this.Xva){var a=+new Date-+this.Xva;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.zb.Mg(this.uAe),va.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Fe.podSessionId,
this.Fe.Kk),a=Object.assign(new oi.a,{Code:293,Source:6}),this.Sd.zs(a,this.Fe.podSessionId,b=>{b.mC=1;b.sCa=8;return!1}))}}N4k(a,b){a&&(this.Fe.Kk!==b?va.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Fe.Kk,b,this.Fe.podSessionId):(b=a.result)?(va.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Fe.podSessionId,
b.DocumentSessionID),this.Fe.podSessionId!==b.DocumentSessionID&&(a=this.Fe.podSessionId,this.Fe.podSessionId=b.DocumentSessionID,this.X9c.ifh(new Nm.a(a,b.DocumentSessionID)))):va.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Fe.podSessionId,this.Fe.Kk))}M4k(a,b){if(this.Fe.Kk!==b)va.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",
this.Fe.Kk,b,this.Fe.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=pf.a.$K(a.error.Im),c=a.error.Im);va.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Fe.presentationId.string,this.Fe.Kk,this.Fe.podSessionId,"",Rc.a.mf(new Date),c,b);c===pf.a.Vh(241)&&(this.Fg.fG=!1,this.MC.HPe(new Fn(this.Fg.Zda)))}}zfa(a,b){Rc.a.XAb=
new Date;Rc.a.ttd=[];this.Fe.podSessionId!==b.kY?va.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",this.Fe.podSessionId,b.kY,this.Fe.Kk):(this.zb.Mg(this.uAe),va.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",
this.Fe.presentationId.string,this.Fe.Kk,b.gHb,b.kY,Rc.a.mf(this.Xva||new Date),Rc.a.mf(new Date)),this.Sd.Dka=!1,this.la.podsSeamlessFailoverEnabled&&this.To.instance?va.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.kY,this.ia.La(L.a.eKb,2,a)),this.Xva=null)}Eo(){this.Xva=null}}Object(n.a)(en,"PodSessionManager",null,[1302]);var Cl;(function(a){a[a.active=
0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(Cl||(Cl={}));Object(n.b)("AppVisibilityState",Cl);class Nd{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(n.a)(Nd,"GetHostSessionInfoParams",null,[]);class Ah{constructor(a,b,c,f,l,w,H,U,ja,wa){this.cad=0;this.tHa=this.sma=this.nBe=null;this.tTg=0;this.QDe=!1;this.Xa=b;this.Jgc=a;this.Fg=c;this.la=f;this.wea=l;this.lR=w;this.Ema=H;this.mc=U;this.iR=ja;this.PIa=wa;this.UBb=0;this.vEb=
this.la.getHostSessionInfoRequestTimeoutInMs;this.hek=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.nek=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.c8j=f.maxPopsRehydrationCount;this.BEb=this.la.Rah;this.AEb=this.la.podsPopSessionDisconnectedTimeLimitInMS;this.Pla=!1;this.MDb=this.Xa.Kk;this.sGg="";this.Dmd();this.KKa(0,!0)}Dmd(){this.cad=0;this.tHa=new Date}Spi(a){if(this.Uka&&!u.AFrameworkApplication.Ug&&this.mc.BL){var b=!1;this.PIa&&this.PIa.instance&&(b=2===this.PIa.instance.s6a,
this.QDe||(this.QDe=!0,this.PIa.instance.eHc(Object(F.a)(this,this.vKh,"visiblityChanged"))));var c=Object.assign(new Nd,{PopSessionID:this.Xa.Kk,PresentationID:this.Xa.presentationId.string,IsTabHidden:b});this.nBe=new Date;b=Math.min(this.vEb+2E3*this.cad,this.hek);var f=pa.a.SH("RequestTimeout",b.toString());this.Jgc.pTc(c,()=>{this.cvk(c.PopSessionID,a)},l=>{this.bvk(l,c.PopSessionID,a)},null,f,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.mc.BL&&(va.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",
this.Uka,u.AFrameworkApplication.Ug,!!this.wea.instance&&this.wea.instance.A_c,!this.mc.In),this.close(this.Uka?this.mc.BL?"AppShuttingDown":"TransitionedToReadingMode":"ClientDisabled"))}KKa(a,b){this.sma=new Date;this.tTg=window.setTimeout(()=>{this.Spi(b)},a)}JHl(a){va.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.nBe);this.Dmd();this.UBb=0;this.Fg.Yne=this.tHa;this.Fg.Xne=a}cvk(a,b){this.iR.dpc();this.lR.sVf(a,
"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.KKa(0,b):(this.JHl(a),b&&this.KKa(this.la.getHostSessionInfoPingIntervalInMs,!0))}vKh(a,b){va.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",Cl[b.oldState],Cl[b.newState]);this.KKa(0,!1)}yqi(){return this.Ema.P$b||!this.Uka?(va.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.Ema.P$b,this.Uka,Rc.a.mf(new Date)),
!1):this.UBb>this.c8j?(va.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",this.UBb,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.lR.Tbe(pf.a.Vh(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}Vfa(a){this.yqi()&&(++this.UBb,this.lR.Vfa(a),this.Dmd())}bkl(a){if(pf.a.BT(a))switch(pf.a.$K(a)){case 326:case 240:case 103:return!0;
case 329:return this.la.pXk}return!1}u$i(a){if(pf.a.BT(a))switch(pf.a.$K(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}bvk(a,b,c){a.EY&&200===a.EY.ie&&this.iR.dpc();if(this.lR.sVf(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.KKa(0,c);else{++this.cad;var f=+new Date-+this.tHa,l=44,w=-1;a&&a.error&&(l=pf.a.BT(a.error.Im)?pf.a.$K(a.error.Im):44,w=a.error.Im);a=pa.a.SH("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",
w,"TimeTakenInMs",+new Date-+this.nBe,"RetryCount",this.cad,"PopSessionDisconnectedTimeLimitInMS",this.AEb,"PopsIdleTimeLimitInMS",this.BEb,"Now",Rc.a.mf(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",this.UBb,"LastPingScheduledTime",Rc.a.mf(this.sma),"LastSuccessfulEnsureHostSessionId",this.Fg.Wne);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(H){va.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",
H)}va.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.sma>this.AEb?this.KKa(0,c):this.bkl(w)?this.Vfa(this.u$i(w),w):w===pf.a.Vh(370)?f<this.BEb?this.KKa(this.la.getHostSessionInfoPingIntervalInMs,c):this.Vfa(11,w):f>=this.AEb?this.Vfa(3,w):this.KKa(this.nek,c)}}fpe(a){const b=pa.a.SH("LastUsedPopSessionId",this.MDb,"LastClientClosedReason",this.sGg,"IsClientActive",this.Uka,"AppInEditingMode",this.mc.In,"PopSessionDisconnectedTimeLimitInMS",
this.AEb,"PopsIdleTimeLimitInMS",this.BEb,"Now",Rc.a.mf(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.UBb,"LastPingScheduledTime",Rc.a.mf(this.sma),"LastSuccessfulEnsureHostSessionId",this.Fg.Wne);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){va.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}va.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}yib(a){va.a.J(36282957,
801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Kk,this.MDb,this.Uka);this.Uka&&this.MDb===this.Xa.Kk||(this.MDb=this.Xa.Kk,this.Dmd(),this.Pla?(this.Pla=!1,this.KKa(0,!0)):va.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Kk,this.MDb,this.Uka))}close(a){this.Pla||
(va.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Xa.Kk,Rc.a.mf(new Date),a),this.QDe&&this.PIa&&this.PIa.instance&&this.PIa.instance.T_k(Object(F.a)(this,this.vKh,"visiblityChanged")),this.Pla=!0,this.MDb="",this.sGg=a,window.clearTimeout(this.tTg))}get Uka(){return!this.Pla}}Object(n.a)(Ah,"HostSessionInfoCaller",null,[]);class Se{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.Yva=null;this.Jgc=a;this.Xa=b;this.Oc=c;this.Fg=f;this.la=l;this.wea=w;this.lR=
H;this.Ema=U;this.mc=ja;this.iR=Sa;this.PIa=eb;this.Oc.iQd(Object(F.a)(this,this.chb,"onPopSessionClosed"));this.Oc.LA(Object(F.a)(this,this.ixa,"onSessionEnded"));this.Oc.jQd(Object(F.a)(this,this.cZa,"onPopSessionInitialized"))}WFj(){va.a.J(509150673,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Fg.fG&&this.b6g()}cZa(){this.b6g()}b6g(){!this.Yva&&this.Fg.fG?this.Yva=new Ah(this.Jgc,this.Xa,this.Fg,this.la,this.wea,this.lR,this.Ema,this.mc,this.iR,this.PIa):this.yib("PopSessionInitialized")}chb(){this.close("PopSessionClosed")}ixa(){this.fpe("SessionClosed")}fpe(a){this.Yva&&
this.Yva.fpe(a)}yib(a){this.Yva&&this.Yva.yib(a)}close(a){this.Yva&&this.Yva.close(a)}get Uka(){return!!this.Yva&&this.Yva.Uka}dispose(){this.Oc.Hjh(Object(F.a)(this,this.chb,"onPopSessionClosed"));this.Oc.ORe(Object(F.a)(this,this.cZa,"onPopSessionInitialized"))}}Object(n.a)(Se,"PopSessionInfoClient",null,[1303,106]);var Mj=d(285),ue=d(214),Dl=d(114),bj=d(657),$g=d(326),Gn=d(866),Hn=d(853);const gp=a=>{if(pf.a.BT(a)){a=pf.a.$K(a);if(Hn.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;
case 326:return 2;default:return 3}}else switch(a){case pf.a.GDa:case pf.a.m1c:return 0;default:return 3}};class Jo{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.Xa=a;this.Fg=b;this.Sd=c;this.la=f;this.Mv=l;this.MC=w;this.t$=H;this.Xea=Sa;this.mc=eb;this.Ema=ja;this.dIg=this.la.hermesNotRefreshErrorList;this.hze=this.la.podsMaxRetryTimesForEnsureHostSession;this.AHg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.vg&&(U.mci(Object(F.a)(this,this.Wzk,"onSyncLoopStatusNotified")),wa.bbi(Object(F.a)(this,
this.Uzk,"onSuccessfulOutbound")),wa.S7(Object(F.a)(this,this.Hw,"onUnifiedAppStateChanged")));u.AFrameworkApplication.$z&&wa.kHc(Object(F.a)(this,this.Efa,"onWopiTokenRefreshed"))}Vfa(a,b=null,c=null){var f=this.t$.q9a(this.Xa.presentationId.string);f=Object.assign(new bj.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.la.Mfa,IsCoauthSession:u.AFrameworkApplication.Zg.IsCoauthSession,
IsCreateNewSession:this.la.GQ,UseSharedHostFile:this.la.KPb});this.t$.rJc(f,b,c,a)}$He(a,b){if(this.tVf(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.Qhh();else{var c=new Date;this.Xa.Kk=b.IB.PopSessionID;this.Fg.fG=!0;this.Fg.hmc=!0;this.Fg.Wne=b.IB.PopSessionID;this.Fg.qla=c;this.MC.lQk();va.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",
b.UYa,b.IB.PopSessionID,b.IB.PodSessionID,this.Xa.podSessionId,Gn.a[b.trigger],b.retryCount,Rc.a.mf(b.startTime),Rc.a.mf(c),+c-+b.startTime,b.actionId);b.LH&&b.LH(a)}}pHb(a,b){let c=a.error.Im;const f=new Date;if(this.tVf(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.Qhh();else{if(b.retryCount<this.hze&&+f-+b.startTime<=this.AHg){if(0===gp(c)||c===pf.a.Vh(252)){b.retryCount++;a=this.t$.q9a(this.Xa.presentationId.string);va.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.UYa,b.IB.PopSessionID,b.IB.PodSessionID,this.Xa.podSessionId,Gn.a[b.trigger],b.retryCount,Rc.a.mf(b.startTime),Rc.a.mf(f),+f-+b.startTime,c,b.actionId);b.IB.PopSessionID=a;b.IB.IsRetrySession=!0;this.t$.tDf(b);return}this.Fg.qla=f;var l="FatalError"}else this.Fg.qla=f,l=b.retryCount>=this.hze?String.format("Exceeded the limit of {0} times of retrying",this.hze):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.AHg,+f-+b.startTime);c===pf.a.GDa&&(c=0===b.trigger?pf.a.Vh(375):pf.a.Vh(309));va.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.UYa,b.IB.PopSessionID,b.IB.PodSessionID,this.Xa.podSessionId,Gn.a[b.trigger],b.retryCount,Rc.a.mf(b.startTime),
Rc.a.mf(f),+f-+b.startTime,c,l,b.actionId);b.$s&&b.$s(a)||this.Tbe(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}tVf(a,b){return a.IB.PodSessionID!==this.Xa.podSessionId?(va.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Xa.podSessionId,a.IB.PodSessionID,b),!0):!1}Qhh(){this.Fg.qla=new Date;this.Vfa(8)}Wzk(a,b){a=pf.a.Vh(b.QAh);va.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.QAh,a,this.Xa.Kk,this.Xa.podSessionId);this.Fg.fG=!1;this.MC.HPe(new Fn(this.Fg.Zda));this.Tbe(a,"PopSessionManager::OnSyncLoopStatusNotified",b.MVi)}Efa(a,b){try{b.T0c?(va.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.rTj||(this.Ysb(()=>{},()=>{}),this.Vfa(9))):va.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){va.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}sVf(a,b){return a&&this.Xa.Kk&&this.Xa.Kk!==a?(va.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Xa.Kk,a,this.Fg.Zda),!0):!1}Tbe(a,b,c=null){va.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.wtj(a)){if(u.AFrameworkApplication.$z&&
a===pf.a.Vh(320)){const f=Mj.a.instance.d7a();if(f){va.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.Mv.ace(a,b)||this.D0d(a,b,c)}}Ysb(a,b,c=!1){va.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Xa.Kk,this.Xa.podSessionId,this.Fg.fG,this.Fg.Zda,this.Fg.Kid);if(this.Fg.fG||!this.Fg.Kid){if(this.m4e(c,
""))a(new $g.a(null)),va.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const f={};f["X-UsePopsRole"]=u.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.Xea.vKc(this.Fg.Zda,this.Xa.podSessionId,this.Xa.presentationId.string,u.AFrameworkApplication.fa.appSettings["361"],this.Xa.jaa,c,a,b,null,f)}this.Fg.fG=!1;this.Fg.Kid=!0;this.MC.HPe(new Fn(this.Fg.Zda))}}m4e(a,b){if(!B.a.Esb())return!1;try{const c=this.c5i(a,b),f=this.m6d();u.AFrameworkApplication.Ke.qya(f,c);
return!0}catch(c){return va.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}c5i(a,b){const c={};c.popSessionID=this.Fg.Zda;c.podSessionID=b.length?b:this.Xa.podSessionId;c.presentationID=this.Xa.presentationId.string;c.podUrl=u.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Xa.jaa;c.fTimeoutOrUserClose=a;return Dl.c(c)}m6d(){var a=u.AFrameworkApplication.fa.Ga("368")+u.AFrameworkApplication.fa.Ga("367")+"/ClosePopWacSession";a=new ue.QueryStringBuilder(a);
a.Ty(u.AFrameworkApplication.R1a,u.AFrameworkApplication.userSessionId);a.Ty(u.AFrameworkApplication.qTd,u.AFrameworkApplication.buildVersion);a.Ty("waccluster",this.Xa.qk);a.Ty("WacUserType",u.AFrameworkApplication.userType);a.Ty(u.AFrameworkApplication.kBb,u.AFrameworkApplication.A2c);a.Ty(u.AFrameworkApplication.$V,u.AFrameworkApplication.accessToken);a.Ty(u.AFrameworkApplication.hca,u.AFrameworkApplication.hm.toString());a.Ty("X-UsePopsRole",this.Xa.Iza.toString());a.Ty("X-PopsAffinityRoutingEnabled",
this.Xa.DFa.toString());return a=a.toString()}wtj(a){if(a!==pf.a.Vh(245))return!1;if(this.Fg.ypg>this.Fg.qla&&this.Fg.fG)return va.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Fg.ypg=new Date;this.nFf(0);return!0}nFf(a){const b=this.Xa.podSessionId;this.Ema.Jgj(()=>{if(b!==this.Xa.podSessionId)va.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Xa.podSessionId);else{var c=pf.a.Vh(245);this.Mv.ace(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.D0d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Xa.podSessionId?va.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Xa.podSessionId):this.Ema.P$b?va.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.Kgj?(va.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.nFf(a+1)):(va.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Sd.zs(Object.assign(new oi.a,{Code:223,Source:6}),b))})}D0d(a,b,c=null){va.a.J(512262793,801,
10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=pf.a.$K(a);pf.a.BT(a)?(a=Object.assign(new oi.a,{Code:pf.a.$K(a),Source:5,ExtraErrorParam:c}),this.Sd.zs(a,this.Xa.podSessionId,l=>{l.mC=1;Array.contains(this.dIg,Ne.a[f].toUpperCase())||(l.sCa=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.dIg,Ne.a[f].toUpperCase())||(b=8),this.Sd.Csa(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}Uzk(){this.Fg.fG||(va.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Xa.Kk,!this.Xa.presentationId.string),this.Vfa(5))}Hw(a,b){Pd.a("Pops.CloseSessionDueToReadonly")&&b.Lke&&!this.mc.BL&&this.Fg.fG&&(va.a.J(512262791,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.Ysb(()=>{},()=>{}))}}Object(n.a)(Jo,"PopSessionManager",null,[1301]);class rn{get name(){return"PowerPointWebEditor.PodsPops"}Zb(a){a.register(1301,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().oa(()=>new Jo(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1302,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().oa(()=>
new en(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.Ke,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Ja("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1303,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().oa(()=>
new Se(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ja("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Ja("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){v.a.instance.Dc(new rn)}}Object(n.a)(rn,"PPTWebEditorPodsPopsPackage",null,[2,3]);class ko{constructor(a,b,c,f,l){this.j$=new Ka.a;this.Icc=this.Jcc=null;this.hxg=this.rdc=0;this.Pwe=this.Owe=!1;this.JCb=Of.a.Nfa(2,0,!1);this.rYa=Of.a.Nfa(2,1,!1);this.mbd=a;this.eec=c;this.il=f;this.Mq=b;this.uHg=l}get Ic(){return this.eec.Ic}L6g(a,b,c,f){if(!b)return!1;
this.Owe||(this.rdc=Date.now(),this.Owe=!0);b=!1;try{if(this.il.Lyf(c.shapeNode)){this.j$.clear();this.wpi();const l=this.l7i(c);if(a){const H=this.il.ulj(this.il.JI(c,a),this.HSa(l),this.Ic,this.JCb,this.rYa);if(H.top||H.bottom||H.left||H.right)b=!0,this.il.hsc(c,H);if(this.uHg){const U=this.il.x$i(this.il.JI(c,a),l,this.JCb,this.rYa,f);if(U.top||U.bottom||U.left||U.right)b=!0,this.il.hsc(c,U);const ja=this.il.y$i(this.il.JI(c,a),l,this.Ic,this.rYa,f,a);if(ja.top||ja.bottom||ja.left||ja.right)b=
!0,this.il.hsc(c,ja);const wa=this.il.Mdj(this.il.JI(c,a),l,this.Ic,this.rYa,f,a);if(wa.top||wa.bottom||wa.left||wa.right)b=!0,this.il.hsc(c,wa)}}else b=this.il.hql(c,this.il.JI(c,a),this.HSa(l),this.Ic,this.JCb,this.rYa);this.j$.addRange(this.il.epi(this.il.JI(c,a),this.HSa(l),this.Ic));const w=this.il.Tsb(this.il.JI(c,a),this.HSa(l));if(w.count)this.j$.addRange(w);else if(!b){let H;H=a?this.il.gql(this.il.JI(c,!0),this.HSa(l),c):this.il.fql(this.il.JI(c,!1),this.HSa(l),c,this.rYa,this.JCb);this.j$.addRange(H);
b=!!H&&0<H.count}if(this.uHg)if(a)this.j$.addRange(this.il.kUd(this.il.JI(c,a),this.il.DSa(l),this.Ic,f,a)),this.j$.addRange(this.il.W6a(this.il.JI(c,a),this.il.DSa(l),this.Ic,f,a)),this.j$.addRange(this.il.npi(this.il.JI(c,a),this.il.DSa(l),f));else{const H=this.il.W6a(this.il.JI(c,a),this.il.DSa(l),this.Ic,f,a);if(H.count)this.j$.addRange(H);else if(!b){const ja=this.il.nyh(this.il.JI(c,!1),this.HSa(l),c,this.Ic,this.rYa,this.JCb);this.j$.addRange(this.il.W6a(this.il.JI(c,a),this.il.DSa(l),this.Ic,
f,a));b=ja}const U=this.il.kUd(this.il.JI(c,a),this.il.DSa(l),this.Ic,f,a);if(U.count)this.j$.addRange(U);else if(!b){const ja=this.il.nyh(this.il.JI(c,!1),this.HSa(l),c,this.Ic,this.rYa,this.JCb);this.j$.addRange(this.il.kUd(this.il.JI(c,a),this.il.DSa(l),this.Ic,f,a));b=ja}}this.mbd.cRf(this.j$.toArray());this.mbd.visible=!0}}catch(l){this.Pwe||(va.a.J(8959958,815,10,"SmartGuide - moving error {0}",l.toString()),this.Pwe=!0)}return b}P6g(a){a&&(this.mbd.visible=!1,this.Icc=this.Jcc=null,this.j$.clear(),
this.mbd.cRf([]),this.hxg=Date.now(),this.Pwe=this.Owe=!1,va.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.hxg-this.rdc).toString()))}wpi(){this.il.J1g=this.Mq.Sm(this.Ic.GU.offsetLeft-this.Ic.Qc.scrollLeft);this.il.K1g=this.Mq.Sm(this.Ic.GU.offsetTop-this.Ic.Qc.scrollTop)}l7i(a){return this.Jcc?this.Jcc:this.Jcc=this.il.k7i(this.il.Ekj(this.Ic,this.Ic.Ma),a)}HSa(a){return this.Icc?this.Icc:this.Icc=this.il.DSa(a)}}Object(n.a)(ko,"SmartGuideManager",null,[1294]);var cj=d(133),ne=d(167),
Xi=d(196),gd=d(58),Tj=d(162);class fg{constructor(){this.y4c=this.tGa=null;this.f6c=0;this.adb=this.Ffb=null;this.Mff=!1}get color(){return this.tGa}set color(a){this.tGa=a}get dashStyle(){return this.y4c}set dashStyle(a){this.y4c=a}get y7b(){return this.f6c}set y7b(a){this.f6c=a}get Mf(){return this.Ffb}set Mf(a){this.Ffb=a}get Eg(){return this.adb}set Eg(a){this.adb=a}get hH(){return this.Mff}set hH(a){this.Mff=a}length(){let a=-1;this.Ffb&&this.adb&&(a=Math.sqrt(Math.pow(this.adb._x-this.Ffb._x,
2)+Math.pow(this.adb._y-this.Ffb._y,2)));return a}reset(){const a=new fg;this.tGa=a.tGa;this.y4c=a.y4c;this.f6c=a.f6c;this.Ffb=a.Ffb;this.adb=a.adb}}Object(n.a)(fg,"SmartGuideLine",null,[1481]);class Ip{constructor(a,b,c,f){this.distance=a;this.RSd=b;this.S1d=c;this.direction=f}}Object(n.a)(Ip,"DistancePair",null,[]);class hp{constructor(a,b){this.shape=a;this.Fk=b}}Object(n.a)(hp,"LightSet",null,[]);class El{constructor(a,b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(n.a)(El,
"LightSetItem",null,[]);class Cm{constructor(){this.Ucb={};this.nGg=[]}ga(a){return this.Ucb[a]}$(a,b){a in this.Ucb||this.nGg.push(a);return this.Ucb[a]=b}get keys(){return this.nGg}}Object(n.a)(Cm,"NumberDictionary",null,[]);class Kg{constructor(a,b){this.first=a;this.second=b}}Object(n.a)(Kg,"NumberPair",null,[]);var Uj=d(664);class kk{constructor(a,b){this.PBe=[];this.wg=5;this.o4=this.Fw=2;this.AO=4;this.uB=3;this.u9c=this.t9c=0;this.Mq=a;this.yFb=b}Ekj(a,b){a=ob.GraphIterator.nb(a.gb);const c=
[];for(var f=a.Bb(1);f;f=a.Cf(1))f=Tj.a(f,b),c.push(f);return c}JI(a,b){for(const c of this.PBe)if(c.lG(a))return c.JI(a,b);return null}addHandler(a){this.PBe.push(a)}fql(a,b,c,f,l){f=this.Nrd(f,kk.$Ic);l=this.Nrd(l,kk.$Ic);for(var w of f){f=a.copy();f.move(0,0-w);f=this.Tsb(f,b);if(f.count)return this.uLa(c,0,-w),f;f=a.copy();f.move(0,w);f=this.Tsb(f,b);if(f.count)return this.uLa(c,0,w),f}for(let H of l){w=a.copy();w.move(0-H,0);w=this.Tsb(w,b);if(w.count)return this.uLa(c,-1*H,0),w;w=a.copy();w.move(H,
0);w=this.Tsb(w,b);if(w.count)return this.uLa(c,H,0),w}return new Ka.a}Nrd(a,b){const c=new Ka.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}gql(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.Tsb(f,b),f.count)return this.hsc(c,l),f;return new Ka.a}DSa(a){const b=[];for(const c of a)b.push(new Uj.a(c.us()));return b}hql(a,b,c,f,l,w){const H=new gd.a(Number.MAX_VALUE,Number.MAX_VALUE);let U=Number.MAX_VALUE;var ja=Number.MAX_VALUE;let wa=[];for(const Sa of c)wa.push(Sa);
this.yFb&&(wa=this.D8h(wa,f));for(const Sa of wa)c=this.gej(b,Sa,U),Math.abs(H.y)>Math.abs(c)&&(H.y=c),U=Math.abs(c),c=this.eej(b,Sa,ja),Math.abs(H.x)>Math.abs(c)&&(H.x=c),ja=Math.abs(c);ja=this.V9i(b,U,f);Math.abs(H.y)>Math.abs(ja)&&(H.y=ja);ja=this.U9i(b,U,f);Math.abs(H.x)>Math.abs(ja)&&(H.x=ja);Math.abs(H.x)>l&&(H.x=0);Math.abs(H.y)>w&&(H.y=0);return H.x||H.y?(this.uLa(a,H.x,H.y),!0):!1}D8h(a,b){var c=this.Mq.Sm(b.te.width);b=this.Mq.Sm(b.te.height);var f=new Uj.a(new cj.a(new gd.a(0,0),new gd.a(c,
0),new gd.a(c,b),new gd.a(0,b)));a.push(f);f=new Uj.a(new cj.a(new gd.a(0,0),new gd.a(c,0),new gd.a(c,b/2),new gd.a(0,b/2)));a.push(f);c=new Uj.a(new cj.a(new gd.a(0,0),new gd.a(c/2,0),new gd.a(c/2,b),new gd.a(0,b)));a.push(c);return a}hsc(a,b){this.kWc(a,c=>{c.setOffsets(a,b)})}uLa(a,b,c){this.kWc(a,f=>{f.setPosition(a,b,c)})}kWc(a,b){for(const c of this.PBe)if(c.lG(a)){b(c);break}}ulj(a,b,c,f,l){let w=Number.MAX_VALUE,H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE;var wa=[];for(var Sa of b)wa.push(Sa.copy());
b=this.Mq.Sm(c.te.width);c=this.Mq.Sm(c.te.height);Sa=new Uj.a(new cj.a(new gd.a(0,0),new gd.a(b,0),new gd.a(b,c),new gd.a(0,c)));wa.push(Sa);this.yFb&&(Sa=new Uj.a(new cj.a(new gd.a(0,0),new gd.a(b,0),new gd.a(b,c/2),new gd.a(0,c/2))),wa.push(Sa),b=new Uj.a(new cj.a(new gd.a(0,0),new gd.a(b/2,0),new gd.a(b/2,c),new gd.a(0,c))),wa.push(b));for(const eb of wa)wa=this.lod([eb.Yb-a.kc,eb.kc-a.kc,eb.Vf().y-a.kc],l),this.JT(wa,l)&&Math.abs(wa)<Math.abs(w)&&(w=wa),wa=this.lod([eb.Yb-a.Yb,eb.kc-a.Yb,eb.Vf().y-
a.Yb],l),this.JT(wa,l)&&Math.abs(wa)<Math.abs(H)&&(H=wa),wa=this.lod([eb.hc-a.hc,eb.$b-a.hc,eb.Vf().x-a.hc],f),this.JT(wa,f)&&Math.abs(wa)<Math.abs(U)&&(U=wa),wa=this.lod([eb.hc-a.$b,eb.$b-a.$b,eb.Vf().x-a.$b],f),this.JT(wa,f)&&Math.abs(wa)<Math.abs(ja)&&(ja=wa);a=new Xi.a;a.top=w===Number.MAX_VALUE?a.top:w;a.bottom=H===Number.MAX_VALUE?a.bottom:H;a.left=U===Number.MAX_VALUE?a.left:U;a.right=ja===Number.MAX_VALUE?a.right:ja;return a}Lyf(a){return a.kla||a.Hj||a.fl||a.hr||a.Qf}E9i(a,b){return Math.abs(a-
b)}gej(a,b,c){a=[new Kg(a.kc,b.kc),new Kg(a.kc,b.Yb),new Kg(a.kc,b.Vf().y),new Kg(a.Yb,b.kc),new Kg(a.Yb,b.Yb),new Kg(a.Yb,b.Vf().y),new Kg(a.Vf().y,b.kc),new Kg(a.Vf().y,b.Yb),new Kg(a.Vf().y,b.Vf().y)];return this.MTc(a,c)}eej(a,b,c){a=[new Kg(a.hc,b.hc),new Kg(a.hc,b.$b),new Kg(a.hc,b.Vf().x),new Kg(a.$b,b.hc),new Kg(a.$b,b.$b),new Kg(a.$b,b.Vf().x),new Kg(a.Vf().x,b.hc),new Kg(a.Vf().x,b.$b),new Kg(a.Vf().x,b.Vf().x)];return this.MTc(a,c)}V9i(a,b,c){c=this.Mq.Sm(c.te.height);a=[new Kg(a.kc,0),
new Kg(a.kc,c),new Kg(a.Yb,0),new Kg(a.Yb,c),new Kg(a.Vf().y,0),new Kg(a.Vf().y,c)];return this.MTc(a,b)}U9i(a,b,c){c=this.Mq.Sm(c.te.width);a=[new Kg(a.hc,0),new Kg(a.hc,c),new Kg(a.$b,0),new Kg(a.$b,c),new Kg(a.Vf().x,0),new Kg(a.Vf().x,c)];return this.MTc(a,b)}MTc(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.E9i(f.first,f.second),a<b&&(b=a,c=f.second-f.first);return c}JT(a,b){a=Math.abs(a);return.2<a&&a<b}lod(a,b){let c=Number.MAX_VALUE;for(const f of a)this.JT(f,b)&&Math.abs(c)>Math.abs(f)&&
(c=f);return c}k7i(a,b){const c=new Ka.a;for(const f of a)this.Lyf(f.shapeNode)&&f.gb!==b.gb&&c.add(f);return c.toArray()}Tsb(a,b){var c=new Ka.a;c.add(a);var f=new Ka.a;f.add(a);var l=new Ka.a;l.add(a);var w=new Ka.a;w.add(a);for(const H of b)H.Yb<a.kc||H.kc>a.Yb||(H.hc<a.hc&&this.mGc(c,H,2),H.$b>a.$b&&this.mGc(f,H,3)),H.$b<a.hc||H.hc>a.$b||(H.kc<a.kc&&this.mGc(l,H,0),H.Yb>a.Yb&&this.mGc(w,H,1));a=this.RTc(c,2);f=this.RTc(f,3);b=this.RTc(l,0);c=this.RTc(w,1);w=new Cm;this.iMc(w,a[0]);this.iMc(w,
f[0]);l=new Cm;this.iMc(l,b[0]);this.iMc(l,c[0]);this.iQc(w,a,2);this.iQc(w,f,3);this.iQc(l,b,0);this.iQc(l,c,1);a=new Ka.a;f=new Ka.a;this.$Kf(w,a,f);this.$Kf(l,a,f);this.T0a(a,1);this.T0a(f,2);a.addRange(f);for(let H of a)this.Rv(H);return a}RTc(a,b){const c=new Ka.a;for(let l=0;l<a.count;++l){var f=new El(this.N8i(a,l,b),this.e9i(a,l,b),null,-1);f=new hp(a.ga(l),[f]);for(let w=l+1;w<a.count;++w){const H=f.Fk.length;let U=H;for(let ja=0;ja<H;++ja)if(!f.Fk[ja].shape&&-1===f.Fk[ja].distance&&f.Fk[ja].end>
f.Fk[ja].begin){const wa=this.F9i(a,l,w,b);U+=this.CLk(a,w,ja,U,l,wa,f,b);U+=this.ELk(a,w,ja,U,l,wa,f,b);U+=this.tMk(a,w,ja,U,l,wa,f,b);U+=this.DLk(a,w,ja,l,wa,f,b)}}c.add(f)}return c.toArray()}$Kf(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const w=new Ka.a;for(let H of f){f=!1;for(let U of w)if(this.Dgi(H,U)){f=!0;w.remove(U);break}f||w.add(H)}for(let H of w)this.xFi(H,b,c)}}}Dgi(a,b){return this.Gyf(a.RSd,b.RSd)&&this.Gyf(a.S1d,b.S1d)}Gyf(a,b){return a.hc===b.hc&&a.$b===b.$b&&a.kc===
b.kc&&a.Yb===b.Yb}mGc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const w=a.ga(l);if(3===c&&(b.hc<a.ga(0).$b?b.$b:b.hc)<(w.hc<a.ga(0).$b?w.$b:w.hc)||2===c&&(b.$b>a.ga(0).hc?b.hc:b.$b)>(w.$b>a.ga(0).hc?w.hc:w.$b)||0===c&&(b.Yb>a.ga(0).kc?b.kc:b.Yb)>(w.Yb>a.ga(0).kc?w.kc:w.Yb)||1===c&&(b.kc<a.ga(0).Yb?b.Yb:b.kc)<(w.kc<a.ga(0).Yb?w.Yb:w.kc)){a.insert(l,b);return}}a.add(b)}iMc(a,b){for(const c of b.Fk)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Ka.a)}iQc(a,b,c){const f=new Cm;for(const l of b){for(const w of a.keys)f.$(w,
0);for(const w of l.Fk)if(0<w.distance&&w.shape)for(const H of a.keys)if(b=H,this.Ku(w.distance,b)){const U=f.ga(H);1>U&&(a.ga(H).add(new Ip(b,l.shape,w.shape,c)),f.$(H,U+1));break}}}N8i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.kc,a.kc);case 0:case 1:return Math.max(b.hc,a.hc);default:return-1}}e9i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Yb,a.Yb);case 0:case 1:return Math.min(b.$b,a.$b);default:return-1}}CLk(a,b,c,f,l,w,H,U){const ja=a.ga(b);
l=a.ga(l);switch(U){case 3:case 2:if(ja.Yb>=H.Fk[c].begin&&ja.Yb<=H.Fk[c].end&&ja.kc<=H.Fk[c].begin)return a=new El(H.Fk[c].begin,ja.Yb,a.ga(b),3===U?w-l.$b:l.hc-w),H.Fk[f]=a,H.Fk[c].begin=ja.Yb,1;break;case 0:case 1:if(ja.$b>=H.Fk[c].begin&&ja.$b<=H.Fk[c].end&&ja.hc<=H.Fk[c].begin)return a=new El(H.Fk[c].begin,ja.$b,a.ga(b),0===U?l.kc-w:w-l.Yb),H.Fk[f]=a,H.Fk[c].begin=ja.$b,1}return 0}ELk(a,b,c,f,l,w,H,U){const ja=a.ga(b);l=a.ga(l);switch(U){case 3:case 2:if(ja.kc>=H.Fk[c].begin&&ja.kc<=H.Fk[c].end&&
ja.Yb>=H.Fk[c].end)return a=new El(ja.kc,H.Fk[c].end,a.ga(b),3===U?w-l.$b:l.hc-w),H.Fk[f]=a,H.Fk[c].end=ja.kc,1;break;case 0:case 1:if(ja.hc>=H.Fk[c].begin&&ja.hc<=H.Fk[c].end&&ja.$b>=H.Fk[c].end)return a=new El(ja.hc,H.Fk[c].end,a.ga(b),0===U?l.kc-w:w-l.Yb),H.Fk[f]=a,H.Fk[c].end=ja.hc,1}return 0}tMk(a,b,c,f,l,w,H,U){const ja=a.ga(b);l=a.ga(l);switch(U){case 3:case 2:if(ja.kc>H.Fk[c].begin&&ja.kc<H.Fk[c].end&&ja.Yb>H.Fk[c].begin&&ja.Yb<H.Fk[c].end)return a=new El(ja.kc,ja.Yb,a.ga(b),3===U?w-l.$b:
l.hc-w),H.Fk[f]=a,a=new El(ja.Yb,H.Fk[c].end,null,-1),H.Fk[++f]=a,H.Fk[c].end=ja.kc,2;break;case 0:case 1:if(ja.hc>H.Fk[c].begin&&ja.hc<H.Fk[c].end&&ja.$b>H.Fk[c].begin&&ja.$b<H.Fk[c].end)return a=new El(ja.hc,ja.$b,a.ga(b),0===U?l.kc-w:w-l.Yb),H.Fk[f]=a,a=new El(ja.$b,H.Fk[c].end,null,-1),H.Fk[++f]=a,H.Fk[c].end=ja.hc,2}return 0}DLk(a,b,c,f,l,w,H){const U=a.ga(b);f=a.ga(f);switch(H){case 3:case 2:U.kc<w.Fk[c].begin&&U.Yb>w.Fk[c].end&&(w.Fk[c].shape=a.ga(b),w.Fk[c].distance=3===H?l-f.$b:f.hc-l);break;
case 0:case 1:U.hc<w.Fk[c].begin&&U.$b>w.Fk[c].end&&(w.Fk[c].shape=a.ga(b),w.Fk[c].distance=0===H?f.kc-l:l-f.Yb)}return 0}F9i(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.hc<a.$b&&c.$b>=a.$b&&(l=c.$b);c.hc>=a.$b&&(l=c.hc);break;case 2:c.$b>a.hc&&c.hc<=a.hc&&(l=c.hc);c.$b<=a.hc&&(l=c.$b);break;case 0:c.Yb>a.kc&&c.kc<=a.kc&&(l=c.kc);c.Yb<=a.kc&&(l=c.Yb);break;case 1:c.kc<a.Yb&&c.Yb>=a.Yb&&(l=c.Yb),c.kc>=a.Yb&&(l=c.kc)}return l}xFi(a,b,c){const f=a.RSd;var l=a.S1d;switch(a.direction){case 3:var w=
Math.max(f.Yb,l.Yb),H=new fg;H.Mf=new gd.a(f.$b-this.uB,f.kc);H.Eg=new gd.a(f.$b-this.uB,w+this.wg);b.add(H);H=new fg;H.Mf=new gd.a(f.$b+a.distance-this.uB,l.kc);H.Eg=new gd.a(f.$b+a.distance-this.uB,w+this.wg);b.add(H);b=new fg;b.Mf=new gd.a(f.$b-this.uB,w+this.wg);b.Eg=new gd.a(f.$b+a.distance-this.uB,w+this.wg);c.add(b);break;case 2:w=Math.max(f.Yb,l.Yb);H=new fg;H.Mf=new gd.a(f.hc-a.distance-this.uB,l.kc);H.Eg=new gd.a(f.hc-a.distance-this.uB,w+this.wg);b.add(H);l=new fg;l.Mf=new gd.a(f.hc-this.uB,
f.kc);l.Eg=new gd.a(f.hc-this.uB,w+this.wg);b.add(l);b=new fg;b.Mf=new gd.a(f.hc-a.distance-this.uB,w+this.wg);b.Eg=new gd.a(f.hc-this.uB,w+this.wg);c.add(b);break;case 0:w=Math.max(f.$b,l.$b);H=new fg;H.Mf=new gd.a(f.hc,f.kc-this.Fw);H.Eg=new gd.a(w+this.wg,f.kc-this.Fw);b.add(H);H=new fg;H.Mf=new gd.a(l.hc,f.kc-a.distance-this.Fw);H.Eg=new gd.a(w+this.wg,f.kc-a.distance-this.Fw);b.add(H);b=new fg;b.Mf=new gd.a(w+this.wg,f.kc-this.Fw);b.Eg=new gd.a(w+this.wg,f.kc-a.distance-this.Fw);c.add(b);break;
case 1:w=Math.max(f.$b,l.$b),H=new fg,H.Mf=new gd.a(f.hc,f.Yb-this.Fw),H.Eg=new gd.a(w+this.wg,f.Yb-this.Fw),b.add(H),H=new fg,H.Mf=new gd.a(l.hc,f.Yb+a.distance-this.Fw),H.Eg=new gd.a(w+this.wg,f.Yb+a.distance-this.Fw),b.add(H),b=new fg,b.Mf=new gd.a(w+this.wg,f.Yb-this.Fw),b.Eg=new gd.a(w+this.wg,f.Yb+a.distance-this.Fw),c.add(b)}}npi(a,b,c){const f=new Ka.a;if(!c)return f;let l=!1;var w=!1;const H=c.equals(ne.a.west)||c.equals(ne.a.Ru)||c.equals(ne.a.RH),U=c.equals(ne.a.east)||c.equals(ne.a.DE)||
c.equals(ne.a.WE),ja=c.equals(ne.a.north)||c.equals(ne.a.Ru)||c.equals(ne.a.DE);c=c.equals(ne.a.south)||c.equals(ne.a.RH)||c.equals(ne.a.WE);for(const Sa of b){if(this.mng(a,Sa,!0,b)&&(H||U)){l=!0;var wa=new fg;wa.Mf=new gd.a(Sa.hc,Sa.Vf()._y);wa.Eg=new gd.a(Sa.$b-this.uB,Sa.Vf()._y);wa.hH=!0;f.add(this.Rv(wa))}this.mng(a,Sa,!1,b)&&(ja||c)&&(w=!0,wa=new fg,wa.Mf=new gd.a(Sa.Vf()._x,Sa.kc),wa.Eg=new gd.a(Sa.Vf()._x,Sa.Yb-this.o4),wa.hH=!1,f.add(this.Rv(wa)))}l&&(b=new fg,b.Mf=new gd.a(a.hc,a.Vf()._y),
b.Eg=new gd.a(a.$b-this.uB,a.Vf()._y),b.hH=!0,f.add(this.Rv(b)));w&&(w=new fg,w.Mf=new gd.a(a.Vf()._x,a.kc),w.Eg=new gd.a(a.Vf()._x,a.Yb-this.o4),w.hH=!1,f.add(this.Rv(w)));this.T0a(f,2);return f}A5(a,b,c){var f=this.Dda(a,b,!1),l=this.Dda(a,b,!0);if(!f&&!l)return!1;let w=[];if(f){if(a.$b<=b.hc||a.$b<=b.$b){var H;var U=b.kc>a.kc?b.kc:a.kc;var ja=b.Yb<a.Yb?b.Yb:a.Yb;f=H=b.hc;a.$b>b.hc&&(f=H=b.$b);f=new Uj.a(new cj.a(new gd.a(f,U),new gd.a(H,U),new gd.a(H,ja),new gd.a(f,ja)));Array.add(w,f)}if(a.hc>=
b.$b||a.hc>=b.hc)U=b.kc>a.kc?b.kc:a.kc,ja=b.Yb<a.Yb?b.Yb:a.Yb,f=H=b.$b,a.hc<b.$b&&(f=H=b.hc),f=new Uj.a(new cj.a(new gd.a(f,U),new gd.a(H,U),new gd.a(H,ja),new gd.a(f,ja))),Array.add(w,f)}if(l){if(a.Yb<=b.kc||a.Yb<=b.Yb)l=b.hc>a.hc?b.hc:a.hc,U=b.$b<a.$b?b.$b:a.$b,f=H=b.kc,a.Yb>b.kc&&(f=H=b.Yb),l=new Uj.a(new cj.a(new gd.a(l,f),new gd.a(U,f),new gd.a(U,H),new gd.a(l,H))),Array.add(w,l);if(a.kc>=b.Yb||a.kc>=b.kc)l=b.hc>a.hc?b.hc:a.hc,U=b.$b<a.$b?b.$b:a.$b,f=H=b.Yb,a.kc<b.Yb&&(f=H=b.kc),l=new Uj.a(new cj.a(new gd.a(l,
f),new gd.a(U,f),new gd.a(U,H),new gd.a(l,H))),Array.add(w,l)}for(const wa of c)this.pcg(wa,a)||this.pcg(wa,b)||(w=this.VFl(a,wa,w));return 0<w.length?!0:!1}VFl(a,b,c){let f=[];for(const l of c)c=!0,l.hc===l.$b?(this.Dda(l,b,!1)||(c=!1),a.$b<=l.hc&&b.$b<=a.$b&&(c=!1),a.$b<=l.hc&&b.hc>=l.$b&&(c=!1),a.hc>=l.$b&&b.hc>=a.hc&&(c=!1),a.hc>=l.$b&&b.$b<=l.hc&&(c=!1),c?b.kc<=l.kc&&b.Yb<l.Yb?f=this.xPb(f,!0,!0,!1,l,b):b.Yb>=l.Yb&&b.kc>l.kc?f=this.xPb(f,!0,!1,!1,l,b):b.kc>l.kc&&b.Yb<l.Yb&&(f=this.xPb(f,!0,!1,
!0,l,b)):Array.add(f,l)):l.kc===l.Yb&&(this.Dda(l,b,!0)||(c=!1),a.Yb<=l.kc&&b.Yb<=a.Yb&&(c=!1),a.Yb<=l.kc&&b.kc>=l.Yb&&(c=!1),a.kc>=l.Yb&&b.kc>=a.kc&&(c=!1),a.kc>=l.Yb&&b.Yb<=l.kc&&(c=!1),c?b.hc<=l.hc&&b.$b<l.$b?f=this.xPb(f,!1,!0,!1,l,b):b.$b>=l.$b&&b.hc>l.hc?f=this.xPb(f,!1,!1,!1,l,b):b.hc>l.hc&&b.$b<l.$b&&(f=this.xPb(f,!1,!1,!0,l,b)):Array.add(f,l));return f}xPb(a,b,c,f,l,w){let H,U,ja,wa,Sa,eb,ub;if(c)b?(c=U=l.hc,H=w.Yb,ja=l.Yb):(H=ja=l.kc,c=w.$b,U=l.$b);else if(c||f){if(b?(c=U=wa=eb=l.hc,H=l.kc,
ja=w.kc,Sa=w.Yb,ub=l.Yb):(H=ja=Sa=ub=l.kc,c=l.hc,U=w.hc,wa=w.$b,eb=l.$b),f&&b&&!this.Ku(Sa,ub)||f&&!b&&!this.Ku(wa,eb))f=new Uj.a(new cj.a(new gd.a(wa,Sa),new gd.a(eb,Sa),new gd.a(eb,ub),new gd.a(wa,ub))),Array.add(a,f)}else b?(c=U=l.hc,H=l.kc,ja=w.kc):(H=ja=l.kc,c=l.hc,U=w.hc);if(b&&!this.Ku(H,ja)||!b&&!this.Ku(c,U))b=new Uj.a(new cj.a(new gd.a(c,H),new gd.a(U,H),new gd.a(U,ja),new gd.a(c,ja))),Array.add(a,b);return a}pcg(a,b){return a.$b!==b.$b||a.hc!==b.hc||a.kc!==b.kc||a.Yb!==b.Yb?!1:!0}mng(a,
b,c,f){if(c)return c=this.Ku(a.hc,b.hc)&&this.Ku(a.$b,b.$b),this.Ku(a.$b-a.hc,b.$b-b.hc)&&!c&&this.A5(a,b,f);c=this.Ku(a.kc,b.kc)&&this.Ku(a.Yb,b.Yb);return this.Ku(a.Yb-a.kc,b.Yb-b.kc)&&!c&&this.A5(a,b,f)}x$i(a,b,c,f,l){const w=new Xi.a;if(!l)return w;let H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,wa=Number.MAX_VALUE;const Sa=l.equals(ne.a.west)||l.equals(ne.a.Ru)||l.equals(ne.a.RH),eb=l.equals(ne.a.east)||l.equals(ne.a.DE)||l.equals(ne.a.WE),ub=l.equals(ne.a.north)||l.equals(ne.a.Ru)||
l.equals(ne.a.DE);l=l.equals(ne.a.south)||l.equals(ne.a.RH)||l.equals(ne.a.WE);const Ub=[];for(const cc of b)Ub.push(new Uj.a(cc.us()));for(const cc of Ub)b=cc.Yb-cc.kc-(a.Yb-a.kc),this.JT(b,f)&&Math.abs(b)<Math.abs(H)&&this.A5(a,cc,Ub)&&ub&&(H=-1*b),this.JT(b,f)&&Math.abs(b)<Math.abs(U)&&this.A5(a,cc,Ub)&&l&&(U=b),b=cc.$b-cc.hc-(a.$b-a.hc),this.JT(b,c)&&Math.abs(b)<Math.abs(ja)&&this.A5(a,cc,Ub)&&Sa&&(ja=-1*b),this.JT(b,c)&&Math.abs(b)<Math.abs(wa)&&this.A5(a,cc,Ub)&&eb&&(wa=b);w.top=H===Number.MAX_VALUE?
w.top:H;w.bottom=U===Number.MAX_VALUE?w.bottom:U;w.left=ja===Number.MAX_VALUE?w.left:ja;w.right=wa===Number.MAX_VALUE?w.right:wa;return w}y$i(a,b,c,f,l,w){let H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,wa=Number.MAX_VALUE,Sa=!0,eb=!0,ub=!0,Ub=!0;w&&l&&(Sa=l.equals(ne.a.west)||l.equals(ne.a.Ru)||l.equals(ne.a.RH),eb=l.equals(ne.a.east)||l.equals(ne.a.DE)||l.equals(ne.a.WE),ub=l.equals(ne.a.north)||l.equals(ne.a.Ru)||l.equals(ne.a.DE),Ub=l.equals(ne.a.south)||l.equals(ne.a.RH)||l.equals(ne.a.WE));
l=[];for(var cc of b)l.push(new Uj.a(cc.us()));b=this.Mq.Sm(c.te.width);c=this.Mq.Sm(c.te.height);for(const Fc of l)Fc.hc>b/2&&Fc.hc<3*b/4&&a.$b<b/2&&eb&&(cc=b/2-a.$b-(Fc.hc-b/2),this.JT(cc,f)&&Math.abs(cc)<Math.abs(wa)&&this.A5(a,Fc,l)&&(wa=cc)),Fc.$b<b/2&&Fc.$b>b/4&&a.hc>b/2&&Sa&&(cc=b/2-Fc.$b-(a.hc-b/2),this.JT(cc,f)&&Math.abs(cc)<Math.abs(ja)&&this.A5(a,Fc,l)&&(ja=cc)),Fc.kc>c/2&&Fc.kc<3*c/4&&a.Yb<c/2&&Ub&&(cc=c/2-a.Yb-(Fc.kc-c/2),this.JT(cc,f)&&Math.abs(cc)<Math.abs(U)&&this.A5(a,Fc,l)&&(U=cc)),
Fc.Yb<c/2&&Fc.Yb>c/4&&a.kc>c/2&&ub&&(cc=c/2-Fc.Yb-(a.kc-c/2),this.JT(cc,f)&&Math.abs(cc)<Math.abs(H)&&this.A5(a,Fc,l)&&(H=cc));a=new Xi.a;a.top=H===Number.MAX_VALUE?a.top:H;a.bottom=U===Number.MAX_VALUE?a.bottom:U;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}nyh(a,b,c,f,l,w){l=this.Nrd(l,kk.$Ic);w=this.Nrd(w,kk.$Ic);for(var H of l){l=a.copy();l.move(0,0-H);if(this.W6a(l,b,f,null,!1).count)return this.uLa(c,0,-H),!0;l=a.copy();l.move(0,H);if(this.W6a(l,b,
f,null,!1).count)return this.uLa(c,0,H),!0}for(let U of w){H=a.copy();H.move(0-U,0);if(this.W6a(H,b,f,null,!1).count)return this.uLa(c,-1*U,0),!0;H=a.copy();H.move(U,0);if(this.W6a(H,b,f,null,!1).count)return this.uLa(c,U,0),!0}return!1}Dda(a,b,c){return c?a.hc>=b.hc&&a.hc<=b.$b||a.$b>=b.hc&&a.$b<=b.$b||b.hc>=a.hc&&b.hc<=a.$b||b.$b>=a.hc&&b.$b<=a.$b:a.kc>=b.kc&&a.kc<=b.Yb||a.Yb>=b.kc&&a.Yb<=b.Yb||b.kc>=a.kc&&b.kc<=a.Yb||b.Yb>=a.kc&&b.Yb<=a.Yb}kUd(a,b,c,f,l){const w=new Ka.a,H=new Ka.a,U=new Ka.a;
let ja=!1,wa=!1,Sa=!1,eb=!1,ub=!0,Ub=!0,cc=!0,Fc=!0;l&&f&&(ub=f.equals(ne.a.west)||f.equals(ne.a.Ru)||f.equals(ne.a.RH),Ub=f.equals(ne.a.east)||f.equals(ne.a.DE)||f.equals(ne.a.WE),cc=f.equals(ne.a.north)||f.equals(ne.a.Ru)||f.equals(ne.a.DE),Fc=f.equals(ne.a.south)||f.equals(ne.a.RH)||f.equals(ne.a.WE));f=this.Mq.Sm(c.te.width);c=this.Mq.Sm(c.te.height);l=new fg;l.Mf=new gd.a(f/2-this.AO,0-this.Fw);l.Eg=new gd.a(f/2-this.AO,c-this.Fw);const Ic=new fg;Ic.Mf=new gd.a(0-this.AO,c/2-this.Fw);Ic.Eg=new gd.a(f-
this.AO,c/2-this.Fw);Ic.hH=!0;for(const Cc of b)Cc.hc>f/2&&Cc.hc<3*f/4&&a.$b<f/2&&this.A5(a,Cc,b)&&Ub&&this.Ku(f/2-a.$b,Cc.hc-f/2)&&(ja=!0,0>Cc.kc&&(l.Mf=new gd.a(f/2,Cc.kc)),Cc.Yb>c&&(l.Eg=new gd.a(f/2,Cc.Yb+this.wg)),w.add(this.BPa(Cc,!1,!1)),H.add(this.xPa(Cc,!1,!1,f,c))),Cc.$b<f/2&&Cc.$b>f/4&&a.hc>f/2&&this.A5(a,Cc,b)&&ub&&this.Ku(a.hc-f/2,f/2-Cc.$b)&&(wa=!0,0>Cc.kc&&(l.Mf=new gd.a(f/2,Cc.kc)),Cc.Yb>c&&(l.Eg=new gd.a(f/2,Cc.Yb+this.wg)),w.add(this.BPa(Cc,!1,!0)),H.add(this.xPa(Cc,!1,!0,f,c))),
Cc.kc>c/2&&Cc.kc<3*c/4&&a.Yb<c/2&&this.A5(a,Cc,b)&&Fc&&this.Ku(c/2-a.Yb,Cc.kc-c/2)&&(Sa=!0,0>Cc.hc&&(Ic.Mf=new gd.a(Cc.hc,c/2)),Cc.$b>f&&(Ic.Eg=new gd.a(Cc.$b+this.wg,c/2)),w.add(this.BPa(Cc,!0,!1)),H.add(this.xPa(Cc,!0,!1,f,c))),Cc.Yb<c/2&&Cc.Yb>c/4&&a.kc>c/2&&this.A5(a,Cc,b)&&cc&&this.Ku(a.kc-c/2,c/2-Cc.Yb)&&(eb=!0,0>Cc.hc&&(Ic.Mf=new gd.a(Cc.hc,c/2)),Cc.$b>f&&(Ic.Eg=new gd.a(Cc.$b+this.wg,c/2)),w.add(this.BPa(Cc,!0,!0)),H.add(this.xPa(Cc,!0,!0,f,c)));(ja||wa)&&w.add(this.Rv(l));(Sa||eb)&&w.add(this.Rv(Ic));
Sa&&(a.hc<Ic.Mf._x&&(Ic.Mf=new gd.a(a.hc,c/2)),a.$b>Ic.Eg._x&&(Ic.Eg=new gd.a(a.$b,c/2+this.wg)),w.add(this.BPa(a,!0,!0)),H.add(this.xPa(a,!0,!0,f,c)));eb&&(a.hc<Ic.Mf._x&&(Ic.Mf=new gd.a(a.hc,c/2)),a.$b>Ic.Eg._x&&(Ic.Eg=new gd.a(a.$b,c/2+this.wg)),w.add(this.BPa(a,!0,!1)),H.add(this.xPa(a,!0,!1,f,c)));ja&&(a.kc<l.Mf._y&&(l.Mf=new gd.a(f/2,a.kc)),a.Yb>l.Eg._y&&(l.Eg=new gd.a(f/2,a.Yb+this.wg)),w.add(this.BPa(a,!1,!0)),H.add(this.xPa(a,!1,!0,f,c)));wa&&(a.kc<l.Mf._y&&(l.Mf=new gd.a(f/2,a.kc)),a.Yb>
l.Eg._y&&(l.Eg=new gd.a(f/2,a.Yb+this.wg)),w.add(this.BPa(a,!1,!1)),H.add(this.xPa(a,!1,!1,f,c)));this.T0a(w,1);this.T0a(H,2);for(let Cc of w)U.add(Cc);for(let Cc of H)U.add(Cc);return U}BPa(a,b,c){const f=b&&c,l=b&&!c,w=!b&&!c;return!b&&c?(b=new fg,b.Mf=new gd.a(a.$b-this.uB,a.Yb),b.Eg=new gd.a(a.$b-this.uB,a.Yb+this.wg),this.Rv(b)):w?(b=new fg,b.Mf=new gd.a(a.hc-this.AO,a.Yb),b.Eg=new gd.a(a.hc-this.AO,a.Yb+this.wg),this.Rv(b)):f?(b=new fg,b.Mf=new gd.a(a.$b,a.Yb-this.o4),b.Eg=new gd.a(a.$b+this.wg,
a.Yb-this.o4),this.Rv(b)):l?(b=new fg,b.Mf=new gd.a(a.$b,a.kc-this.Fw),b.Eg=new gd.a(a.$b+this.wg,a.kc-this.Fw),this.Rv(b)):null}xPa(a,b,c,f,l){const w=b&&c,H=b&&!c,U=!b&&!c;return!b&&c?(l=new fg,l.hH=!0,l.Mf=new gd.a(f/2-this.AO,a.Yb+this.wg),l.Eg=new gd.a(a.$b-this.uB,a.Yb+this.wg),this.Rv(l)):U?(l=new fg,l.hH=!0,l.Mf=new gd.a(f/2-this.AO,a.Yb+this.wg),l.Eg=new gd.a(a.hc-this.AO,a.Yb+this.wg),this.Rv(l)):w?(f=new fg,f.hH=!0,f.Mf=new gd.a(a.$b+this.wg,l/2-this.Fw),f.Eg=new gd.a(a.$b+this.wg,a.Yb-
this.o4),this.Rv(f)):H?(f=new fg,f.hH=!0,f.Mf=new gd.a(a.$b+this.wg,l/2-this.Fw),f.Eg=new gd.a(a.$b+this.wg,a.kc-this.Fw),this.Rv(f)):null}Mdj(a,b,c,f,l,w){let H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,wa=Number.MAX_VALUE,Sa=!0,eb=!0,ub=!0,Ub=!0;w&&l&&(Sa=l.equals(ne.a.west)||l.equals(ne.a.Ru)||l.equals(ne.a.RH),eb=l.equals(ne.a.east)||l.equals(ne.a.DE)||l.equals(ne.a.WE),ub=l.equals(ne.a.north)||l.equals(ne.a.Ru)||l.equals(ne.a.DE),Ub=l.equals(ne.a.south)||l.equals(ne.a.RH)||l.equals(ne.a.WE));
l=[];for(const cc of b)l.push(new Uj.a(cc.us()));b=this.Mq.Sm(c.te.width);c=this.Mq.Sm(c.te.height);for(const cc of l)cc.$b>3*b/4&&cc.$b<b&&a.hc<b/4&&0<a.hc&&this.Dda(a,cc,!1)&&Sa&&(l=b-cc.$b-a.hc,this.JT(l,f)&&Math.abs(l)<Math.abs(ja)&&(ja=l)),cc.hc<b/4&&0<cc.hc&&a.$b>3*b/4&&a.$b<b&&this.Dda(a,cc,!1)&&eb&&(l=b-a.$b-cc.hc,this.JT(l,f)&&Math.abs(l)<Math.abs(wa)&&(wa=l)),cc.Yb>3*c/4&&cc.Yb<c&&a.kc<c/4&&0<a.kc&&this.Dda(a,cc,!0)&&ub&&(l=c-cc.Yb-a.kc,this.JT(l,f)&&Math.abs(l)<Math.abs(H)&&(H=l)),cc.kc<
c/4&&0<cc.kc&&a.Yb>3*c/4&&a.Yb<c&&this.Dda(a,cc,!0)&&Ub&&(l=c-a.Yb-cc.kc,this.JT(l,f)&&Math.abs(l)<Math.abs(U)&&(U=l));a=new Xi.a;a.top=H===Number.MAX_VALUE?a.top:H;a.bottom=U===Number.MAX_VALUE?a.bottom:U;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}W6a(a,b,c,f,l){const w=new Ka.a,H=new Ka.a,U=new Ka.a;var ja=!1,wa=!1,Sa=!1,eb=!1,ub=!0;let Ub=!0,cc=!0,Fc=!0;l&&f&&(ub=f.equals(ne.a.west)||f.equals(ne.a.Ru)||f.equals(ne.a.RH),Ub=f.equals(ne.a.east)||f.equals(ne.a.DE)||
f.equals(ne.a.WE),cc=f.equals(ne.a.north)||f.equals(ne.a.Ru)||f.equals(ne.a.DE),Fc=f.equals(ne.a.south)||f.equals(ne.a.RH)||f.equals(ne.a.WE));f=this.Mq.Sm(c.te.width);c=this.Mq.Sm(c.te.height);for(const Ic of b)Ic.$b>3*f/4&&Ic.$b<f&&a.hc<f/4&&0<a.hc&&this.Dda(a,Ic,!1)&&ub&&this.Ku(a.hc,f-Ic.$b)&&(ja=!0,b=new fg,b.Mf=new gd.a(Ic.$b-this.uB,Ic.Yb),b.Eg=new gd.a(Ic.$b-this.uB,Ic.Yb+this.wg),w.add(this.Rv(b)),b=new fg,b.hH=!0,b.Mf=new gd.a(f-this.uB,Ic.Yb+this.wg),b.Eg=new gd.a(Ic.$b-this.uB,Ic.Yb+this.wg),
H.add(this.Rv(b))),Ic.hc<f/4&&0<Ic.hc&&a.$b>3*f/4&&a.hc<f&&this.Dda(a,Ic,!1)&&Ub&&this.Ku(f-a.$b,Ic.hc)&&(wa=!0,b=new fg,b.Mf=new gd.a(Ic.hc-this.AO,Ic.Yb),b.Eg=new gd.a(Ic.hc-this.AO,Ic.Yb+this.wg),w.add(this.Rv(b)),b=new fg,b.hH=!0,b.Mf=new gd.a(0-this.AO,Ic.Yb+this.wg),b.Eg=new gd.a(Ic.hc-this.AO,Ic.Yb+this.wg),H.add(this.Rv(b))),Ic.Yb>3*c/4&&Ic.Yb<c&&a.kc<c/4&&0<a.kc&&this.Dda(a,Ic,!0)&&cc&&this.Ku(a.kc,c-Ic.Yb)&&(Sa=!0,b=new fg,b.Mf=new gd.a(Ic.$b,Ic.Yb-this.o4),b.Eg=new gd.a(Ic.$b+this.wg,Ic.Yb-
this.o4),w.add(this.Rv(b)),l=new fg,b.hH=!0,l.Mf=new gd.a(Ic.$b+this.wg,Ic.Yb-this.o4),l.Eg=new gd.a(Ic.$b+this.wg,c-this.o4),H.add(this.Rv(l))),Ic.kc<c/4&&0<Ic.kc&&a.Yb>3*c/4&&a.Yb<c&&this.Dda(a,Ic,!0)&&Fc&&this.Ku(c-a.Yb,Ic.kc)&&(eb=!0,b=new fg,b.Mf=new gd.a(Ic.$b,Ic.kc-this.Fw),b.Eg=new gd.a(Ic.$b+this.wg,Ic.kc-this.Fw),w.add(this.Rv(b)),l=new fg,b.hH=!0,l.Mf=new gd.a(Ic.$b+this.wg,0-this.Fw),l.Eg=new gd.a(Ic.$b+this.wg,Ic.kc-this.Fw),H.add(this.Rv(l)));Sa&&(Sa=new fg,Sa.Mf=new gd.a(a.$b,a.kc-
this.Fw),Sa.Eg=new gd.a(a.$b+this.wg,a.kc-this.Fw),w.add(this.Rv(Sa)),ub=new fg,Sa.hH=!0,ub.Mf=new gd.a(a.$b+this.wg,0-this.Fw),ub.Eg=new gd.a(a.$b+this.wg,a.kc-this.Fw),H.add(this.Rv(ub)));eb&&(eb=new fg,eb.Mf=new gd.a(a.$b,a.Yb-this.o4),eb.Eg=new gd.a(a.$b+this.wg,a.Yb-this.o4),w.add(this.Rv(eb)),Sa=new fg,eb.hH=!0,Sa.Mf=new gd.a(a.$b+this.wg,c-this.o4),Sa.Eg=new gd.a(a.$b+this.wg,a.Yb-this.o4),H.add(this.Rv(Sa)));ja&&(ja=new fg,ja.Mf=new gd.a(a.hc-this.AO,a.Yb),ja.Eg=new gd.a(a.hc-this.AO,a.Yb+
this.wg),w.add(this.Rv(ja)),ja=new fg,ja.hH=!0,ja.Mf=new gd.a(0-this.AO,a.Yb+this.wg),ja.Eg=new gd.a(a.hc-this.AO,a.Yb+this.wg),H.add(this.Rv(ja)));wa&&(wa=new fg,wa.Mf=new gd.a(a.$b-this.uB,a.Yb),wa.Eg=new gd.a(a.$b-this.uB,a.Yb+this.wg),w.add(this.Rv(wa)),wa=new fg,wa.hH=!0,wa.Mf=new gd.a(f-this.uB,a.Yb+this.wg),wa.Eg=new gd.a(a.$b-this.uB,a.Yb+this.wg),H.add(this.Rv(wa)));this.T0a(w,1);this.T0a(H,2);for(let Ic of w)U.add(Ic);for(let Ic of H)U.add(Ic);return U}epi(a,b,c){var f=new fg;const l=new fg,
w=new fg,H=new fg,U=new fg,ja=new fg,wa=new Ka.a;wa.add(f);wa.add(l);wa.add(w);wa.add(H);wa.add(U);wa.add(ja);this.T0a(wa,0);this.lHj(f,l,w,H,U,ja,a);for(const Sa of b)this.s3(a.kc,Sa.kc,Sa.Yb,f,Sa),this.s3(a.Yb,Sa.kc,Sa.Yb,l,Sa),this.s3(a.hc,Sa.hc,Sa.$b,w,Sa),this.s3(a.$b,Sa.hc,Sa.$b,H,Sa),this.yFb&&(this.s3(a.kc,Sa.Vf()._y,null,f,Sa),this.s3(a.Yb,Sa.Vf()._y,null,l,Sa),this.s3(a.hc,Sa.Vf()._x,null,w,Sa),this.s3(a.$b,Sa.Vf()._x,null,H,Sa),this.s3(a.Vf()._y,Sa.kc,null,U,Sa),this.s3(a.Vf()._y,Sa.Yb,
null,U,Sa),this.s3(a.Vf()._x,Sa.hc,null,ja,Sa),this.s3(a.Vf()._x,Sa.$b,null,ja,Sa)),this.s3(a.Vf()._y,Sa.Vf()._y,null,U,Sa),this.s3(a.Vf()._x,Sa.Vf()._x,null,ja,Sa);0<f.length()&&0<l.length()&&(this.yFb?(U.Mf=new gd.a(a.hc-this.wg,a.Vf()._y),U.Eg=U.Mf.copy()):U.reset());0<w.length()&&0<H.length()&&(this.yFb?(ja.Mf=new gd.a(a.Vf()._x,a.hc-this.AO),ja.Eg=ja.Mf.copy()):ja.reset());if(this.yFb&&c){b=this.Mq.Sm(c.te.width);c=this.Mq.Sm(c.te.height);if(this.Ku(a.kc,c/2)||Math.abs(a.kc)<=kk.R6a||this.Ku(a.kc,
c))f.Mf._x=Math.min(f.Mf._x,-1*this.wg),f.Eg._x=Math.max(f.Eg._x,b+this.wg);if(this.Ku(a.Yb,c/2)||Math.abs(a.Yb)<=kk.R6a||this.Ku(a.Yb,c))l.Mf._x=Math.min(l.Mf._x,-1*this.wg),l.Eg._x=Math.max(l.Eg._x,b+this.wg);if(this.Ku(a.Vf()._y,c/2)||Math.abs(a.Vf()._y)<=kk.R6a||this.Ku(a.Vf()._y,c))U.Mf._x=Math.min(U.Mf._x,-1*this.wg),U.Eg._x=Math.max(U.Eg._x,b+this.wg);if(this.Ku(a.$b,b/2)||Math.abs(a.$b)<=kk.R6a||this.Ku(a.$b,b))H.Mf._y=Math.min(H.Mf._y,-1*this.wg),H.Eg._y=Math.max(H.Eg._y,c+this.wg);if(this.Ku(a.hc,
b/2)||Math.abs(a.hc)<=kk.R6a||this.Ku(a.hc,b))w.Mf._y=Math.min(w.Mf._y,-1*this.wg),w.Eg._y=Math.max(w.Eg._y,c+this.wg);if(this.Ku(a.Vf()._x,b/2)||Math.abs(a.Vf()._x)<=kk.R6a||this.Ku(a.Vf()._x,b))ja.Mf._y=Math.min(ja.Mf._y,-1*this.wg),ja.Eg._y=Math.max(ja.Eg._y,c+this.wg)}f=new Ka.a;for(let Sa of wa)Sa.Mf&&0<Sa.length()&&(this.IUf(Sa,a),f.add(this.Rv(Sa)));return f}s3(a,b,c,f,l){(this.Ku(a,b)||this.Ku(a,c))&&this.IUf(f,l)}IUf(a,b){a.hH?(a.Mf._x=Math.min(a.Mf._x,b.hc-this.wg),a.Eg._x=Math.max(a.Eg._x,
b.$b+this.wg)):(a.Mf._y=Math.min(a.Mf._y,b.kc-this.wg),a.Eg._y=Math.max(a.Eg._y,b.Yb+this.wg))}Rv(a){let b;(b=a.Mf).x=b.x+this.t9c;let c;(c=a.Mf).y=c.y+this.u9c;let f;(f=a.Eg).x=f.x+this.t9c;let l;(l=a.Eg).y=l.y+this.u9c;return a}Ku(a,b){var c=kk.R6a;return!!a&&!!b&&Math.abs(a-b)<=c}lHj(a,b,c,f,l,w,H){a.Mf=new gd.a(H.hc-this.wg,H.kc-this.Fw);a.Eg=a.Mf.copy();a.hH=!0;b.Mf=new gd.a(H.hc-this.wg,H.Yb-this.o4);b.Eg=b.Mf.copy();b.hH=!0;c.Mf=new gd.a(H.hc-this.AO,H.kc-this.wg);c.Eg=c.Mf.copy();f.Mf=new gd.a(H.$b-
this.uB,H.kc-this.wg);f.Eg=f.Mf.copy();b=H.Vf();l.Mf=new gd.a(a.Mf._x-this.wg,b._y-this.Fw);l.Eg=l.Mf.copy();l.hH=!0;w.Mf=new gd.a(b._x-this.wg,c.Mf._y-this.wg);w.Eg=w.Mf.copy()}T0a(a,b){for(let c of a)0===b?(c.color=nf.a.ywi,c.dashStyle="4,4",c.y7b=0):1===b?(c.color=nf.a.xwi,c.dashStyle="4,4",c.y7b=1):2===b&&(c.color=nf.a.qHf,c.dashStyle="4,4",c.y7b=2)}get J1g(){return this.t9c}set J1g(a){this.t9c=a}get K1g(){return this.u9c}set K1g(a){this.u9c=a}}kk.R6a=.4;kk.$Ic=5;Object(n.a)(kk,"SmartGuideUtility",
null,[1296]);var lo=d(138),pm=d(209),qm=d(169),rm=d(197);class cm{constructor(a,b,c,f,l){this.AFb=this.BFb=this.xb=null;this.tma=new Sys.UI.Bounds(0,0,0,0);this.SIa=1;this.Eb=!1;this.Gg=a;this.Di=b;this.ld=f;this.Kc=c;this.ld.ZYb(Object(F.a)(this,this.onResize,"onResize"));l&&this.ld.FPa(Object(F.a)(this,this.T0,"onActiveSlideDomDisplayed"));this.Jm()}get visible(){return!!this.xb&&this.Eb}set visible(a){this.xb||this.Jm();this.Eb!==a&&(this.xb.Rd(a),this.Eb=a)}cRf(a){this.AFb&&this.BFb.xa.removeChild(this.AFb.xa);
this.AFb=new pm.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new qm.a,l=cm.o0j(cm.$fh(gd.a.scale(c.Mf,this.SIa,this.SIa)),cm.$fh(gd.a.scale(c.Eg,this.SIa,this.SIa)));f.Et(l);f.Zu(this.d_f(c.color));f.Noa(c.dashStyle);f.mr(1);this.AFb.appendChild(f);2===c.y7b&&this.pQi(l[0],l[1])}this.BFb.appendChild(this.AFb)}pQi(a,b){a._y===b._y?a._x<b._x?this.hKf(a,b):this.hKf(b,a):a._y>b._y?this.iKf(a,b):this.iKf(b,a)}hKf(a,b){const c=this.jDf(b._x-a._x);this.JLc([new gd.a(a._x,a._y),new gd.a(a._x+c,a._y-c/2),
new gd.a(a._x+c,a._y+c/2)]);this.JLc([new gd.a(b._x,b._y),new gd.a(b._x-c,b._y-c/2),new gd.a(b._x-c,b._y+c/2)])}iKf(a,b){const c=this.jDf(a._y-b._y);this.JLc([new gd.a(a._x,a._y),new gd.a(a._x-c/2,a._y-c),new gd.a(a._x+c/2,a._y-c)]);this.JLc([new gd.a(b._x,b._y),new gd.a(b._x-c/2,b._y+c),new gd.a(b._x+c/2,b._y+c)])}jDf(a){return Math.min(a,10)/2}JLc(a){const b=new qm.a,c=this.d_f(nf.a.qHf);b.Et(a);b.Zu(c);b.mr(1);b.PE(c);b.Rd(!0);this.AFb.appendChild(b)}d_f(a){return this.Di&&this.Di.highContrastColors?
this.Di.highContrastColors.foregroundTextColor:a}Jm(){this.xb=new lo.a;this.xb.ur("SmartGuideView");this.xb.$j(0);this.xb.Rd(!1);this.Gg.xa.appendChild(this.xb.xa);this.BFb=new rm.a;this.BFb.xa.style.overflow="visible";this.xb.appendChild(this.BFb);this.Xr(this.Kc.Ic)}onResize(a,b){b&&this.Xr(b.nG)}T0(a,b){b&&this.Xr(b.nG)}Xr(a){this.xb&&a&&a.te&&a===this.Kc.Ic&&(this.tma.x!==a.te.x||this.tma.y!==a.te.y||this.tma.width!==a.te.width||this.tma.height!==a.te.height)&&(this.tma=new Sys.UI.Bounds(a.te.x,
a.te.y,a.te.width,a.te.height),this.xb.setPosition(a.te.x,a.te.y),this.BFb.lh(a.te.width,a.te.height),this.xb.lh(a.te.width,a.te.height))}static o0j(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static $fh(a){return new gd.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(n.a)(cm,"SmartGuideView",null,[1295]);class mo{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(Xi.a.add(a.TYa,b),!0)}JI(a){return new Uj.a(a.us())}lG(a){return!a.shapeNode.iy}}
Object(n.a)(mo,"DefaultShapeMoveResizeHandler",null,[576]);class In{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}Zb(a){this.K=a;this.K.register(1294,"PowerPointWebEditor.ISmartGuideManager").ma().oa(()=>new ko(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1295,"PowerPointWebEditor.ISmartGuideView").ma().oa(()=>new cm(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Cua));this.K.register(1296,"PowerPointWebEditor.ISmartGuideUtility").ma().oa(()=>new kk(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new mo)}dispose(){}static main(){v.a.instance.Dc(new In)}}Object(n.a)(In,"PPTWebEditorSmartGuidePackage",null,[2,3]);class Fl{}Fl.$qg=[D.a.backspace,D.a.tub,D.a.bL,D.a.$1b,D.a.$Ca,D.a.enter,D.a.yqd,D.a.CB,D.a.tab,D.a.nrc,D.a.pageDown,D.a.pageUp,D.a.KYa,D.a.uFe,D.a.JYa,D.a.tFe];Fl.u2j=[D.a.backspace,D.a.tub,D.a.bL,D.a.$1b,D.a.$Ca,
D.a.enter,D.a.yqd,D.a.CB,D.a.tab,D.a.nrc,D.a.font,D.a.S5,D.a.IKa,D.a.Pq,D.a.WJa,D.a.C_a,D.a.bH,D.a.PH,D.a.bold,D.a.setItalic,D.a.underline,D.a.strikethrough,D.a.Sr,D.a.B1,D.a.fja,D.a.QM,D.a.mP,D.a.rC,D.a.Ey,D.a.bja,D.a.ula,D.a.Aoa,D.a.RDa,L.a.Sna,L.a.d1,L.a.c1,L.a.b1,D.a.bDa,D.a.Eka,D.a.kza,D.a.lza,D.a.mza,D.a.LLa,D.a.MLa,D.a.$8b,D.a.a9b,D.a.pab,D.a.iUa,D.a.lUa,D.a.eua,D.a.r8,L.a.yIb,D.a.deleteRow,L.a.wmc,D.a.ZCa,L.a.Zid,D.a.insertTable,L.a.aMe,D.a.QZ,D.a.PZ,L.a.Q5,L.a.TJa,L.a.q0a,L.a.gLa,L.a.Ooa,
L.a.hLa,L.a.Lrd,L.a.Krd,D.a.CM,D.a.nUa,D.a.centerJustify,D.a.leftJustify,D.a.rightJustify,D.a.fullJustify,D.a.M2b,D.a.Xac,D.a.Rqc,L.a.Lkb,L.a.Mkb,L.a.Nkb,L.a.Okb,D.a.b_b];Fl.R8k=[D.a.leftArrow,D.a.rightArrow,D.a.upArrow,D.a.downArrow,D.a.x0a,D.a.w0a,D.a.RCa,D.a.QCa,D.a.dRa,D.a.cRa,D.a.HMb,D.a.ukb,D.a.a2b,D.a.uub,D.a.N7a,D.a.bRa,D.a.KYa,D.a.ZRa,D.a.wgb,D.a.vgb,D.a.H8a,D.a.JYa,D.a.YRa,D.a.G8a,D.a.Osa,D.a.zqd,L.a.Ypc,L.a.fPb,L.a.G0a,L.a.nNb];Object(n.a)(Fl,"ActionIdList",null,[]);class Qk{constructor(){this.ActionTime=
this.ActionName=this.ActionId=null}}Object(n.a)(Qk,"ActionInformation",null,[]);class sm{constructor(a,b,c,f,l,w){this.ecb=[];this.Vbc=[];this.hJ=a;this.Mpe=b||[];this.ia=c;this.ia.paa(this);this.Xa=f;this.GX=l;this.pH=w}G5(a){this.Jvh(a)&&this.Uoa(a.actionId)&&(this.ecb.push(a.actionId),this.Vbc.push(Date.now()))}F5(a){this.Jvh(a)&&this.Uoa(a.actionId)&&(this.ecb.pop(),this.Vbc.pop())}Uoa(a){if(Array.contains(this.Mpe,a))return!0;a=this.ia.hT(a);return!!a&&!(a.flags[32]||a.flags[64])}Jvh(a){return 2===
a.behavior&&a.Qi?!0:!1}getCommandName(a,b=""){return(a=this.hJ?this.hJ.Z5(a):null)?a:b}iY(a){a&&a.rsa&&va.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.rsa.toString(),this.actionName||(this.GX.jd===D.a.typing||this.GX.jd===D.a.gCa||this.GX.jd===D.a.rRa?"Typing":null)||(this.pH.cZc?"ClosingTextUndoStack":""),this.Xa.podSessionId||"",this.hJ.Z5(this.GX.jd));return!!this.ecb.length}update(a,b){a=new Qk;a.ActionId=this.Y3f();a.ActionName=this.Z3f();a.ActionTime=
this.Jcj().toString();ki.a.Go(b,hb.a.c5h,a);b.setValue(hb.a.S8b,!0);b.setValue(hb.a.cnd,1)}get actionName(){return this.Z3f()}get actionId(){return this.Y3f()}y8d(){return this.ecb[this.ecb.length-1]}Y3f(){return this.ecb.length?this.y8d().toString():null}Z3f(){return this.ecb.length?this.getCommandName(this.y8d(),this.y8d().toString()):null}Jcj(){return this.Vbc.length?this.Vbc[this.Vbc.length-1]:Number.MAX_VALUE}}Object(n.a)(sm,"ActionInfoRevisionMetaDataUpdater",null,[1337,145]);class Rl{constructor(){this.va=
new vc.a}Sfh(a){this.va.raiseEvent("UCI",a)}Bci(a){this.va.addHandler("UCI",a)}J0k(a){this.va.removeHandler("UCI",a)}}Object(n.a)(Rl,"CcpEventSource",null,[1447,1448,1449]);class Yf{constructor(a,b){this.zcc=this.Xqe=this.Wqe=null;this.Yqe=a;this.qU=b;this.Yqe.Bci(Object(F.a)(this,this.c3g,"onCcpPropertyChanged"))}c3g(a,b){this.Wqe=b.Jp;this.Xqe=b.fri;this.zcc=b.gri}iY(a){a=this.qU.pEa(a.fya);!this.zcc&&a.Sa(hb.a.n7a)&&(a.removeProperty(hb.a.vN),a.removeProperty(hb.a.aQ),a.removeProperty(hb.a.n7a));
return!!this.zcc}update(a,b){b.setValue(hb.a.vN,this.Wqe);b.setValue(hb.a.aQ,this.Xqe);b.setValue(hb.a.n7a,this.zcc);this.zcc=this.Xqe=this.Wqe=null}dispose(){this.Yqe&&this.Yqe.J0k(Object(F.a)(this,this.c3g,"onCcpPropertyChanged"))}}Object(n.a)(Yf,"CcpInfoRevisionMetaDataUpdater",null,[1292,1337,106]);var Jn=d(324);class Ak extends qh.a{constructor(a,b,c,f,l,w,H){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=null;this.Cid=a;this.Sid=b;
this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=w;this.AuthToken=H}Zk(){return 108}}Object(n.a)(Ak,"AugmentImageRequest",qh.a,[]);class Ye extends qh.a{constructor(){super()}Zk(){return 81}}Object(n.a)(Ye,"FlushRequest",qh.a,[]);class cl extends qh.a{constructor(a,b,c,f,l,w){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=f;this.DeckSuggestionId=
l;this.Hints=w}Zk(){return 111}}Object(n.a)(cl,"GenerateAgendaDeckSuggestionRequest",qh.a,[]);class ip extends qh.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}Zk(){return 110}}Object(n.a)(ip,"GenerateAgendaSuggestionRequest",qh.a,[]);class pl extends qh.a{constructor(a,b,c,f,l,w,H,U,ja,wa){super();this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=
this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=w;this.SubNodeWidth=H;this.SubNodeHeight=U;this.CorrelationId=ja;this.Trigger=wa}Zk(){return 99}}Object(n.a)(pl,"GenerateIconSuggestionRequest",qh.a,[]);class Ej extends qh.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=this.IsSVGBlipFill=!1;
this.GraphNodeId=M.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}Zk(){return 91}}Object(n.a)(Ej,"GenerateImageDescriptionRequest",qh.a,[]);class ai extends qh.a{constructor(a,b,c,f,l,w,H){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=w;this.Hints=H}Zk(){return 66}}Object(n.a)(ai,"GenerateSuggestionRequest",
qh.a,[]);class tk extends ai{constructor(a,b,c,f,l,w,H,U){super(a,b,f,null,l,w,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=H;this.ShapeViewHeight=U}Zk(){return 83}}Object(n.a)(tk,"GenerateReplaceObjectRequest",ai,[]);class no extends qh.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}Zk(){return 57}}Object(n.a)(no,"GetPictureCropInfoRequest",qh.a,[]);class oo extends qh.a{constructor(){super();
this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}Zk(){return 109}}Object(n.a)(oo,"ImageTransformRequest",qh.a,[]);class Ji extends qh.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}Zk(){return 84}}Object(n.a)(Ji,"ReportReplaceObjectInfoRequest",qh.a,[]);class uk extends qh.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}Zk(){return 67}}Object(n.a)(uk,"ReportSuggestionSessionInfoRequest",
qh.a,[]);class Ko extends qh.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}Zk(){return 59}}Object(n.a)(Ko,"UpdateContentAddinSnapshotInfoRequest",qh.a,[]);class Gl{constructor(a,b,c){this.pH=a;this.Vb=b;this.kvg=c}get cZc(){return this.pH.cZc}q7a(a,b=!1){this.pH.q7a(a,b)}forceOutbound(){this.pH.forceOutbound()}ega(a,b,c=!1){this.pH.ega(a,b,c)}qGc(a){this.pH.qGc(a)}axb(a){return this.pH.axb(a)}Db(a){this.pH.Db(a)}K5f(a,
b,c,f=null,l=null,w=!1){a=new hg.a(new no(a,b,c),f,l,H=>0===H.StatusCode);this.pH.ega(a,this.Vb,w)}$ja(a,b,c,f,l,w,H,U=null,ja=null){a=new hg.a(new ai(a,b,c,f,l,w,H),U,ja,wa=>0===wa.StatusCode);this.pH.ega(a,this.Vb)}generateImageDescription(a,b,c,f){a=new hg.a(new Ej(a,b,c,f),null,null,l=>0===l.StatusCode);this.pH.ega(a,this.Vb)}uoa(a,b,c){a=new hg.a(new uk(a,b),null,()=>!0,f=>0===f.StatusCode);this.pH.ega(a,this.Vb,c)}MZf(a,b,c,f,l,w,H,U=null,ja=null){a=new hg.a(new tk(a,b,c,f,l,null,w,H),U,ja,
wa=>0===wa.StatusCode);this.pH.ega(a,this.Vb)}r2k(a,b,c=null,f=null){a=new hg.a(new Ji(a,b),c,f,l=>0===l.StatusCode);this.pH.ega(a,this.Vb)}U2i(a,b,c,f,l,w,H,U,ja=null,wa=null){a=new hg.a(new pl(a,b,c,f,l,w,74,74,H,U),ja,wa,Sa=>0===Sa.StatusCode);this.pH.ega(a,this.Vb)}augmentImage(a,b,c,f,l,w,H,U=null,ja=null){a=new hg.a(new Ak(a,b,c,f,l,w,H),U,ja,wa=>0===wa.StatusCode);this.pH.ega(a,this.Vb)}generateAgendaSuggestion(a,b,c,f,l,w=null,H=null){a=new hg.a(new ip(a,b,c,f,l),w,H,U=>0===U.StatusCode);
this.pH.ega(a,this.Vb)}generateAgendaDeckSuggestion(a,b,c,f,l,w,H=null,U=null){a=new hg.a(new cl(a,b,c,f,l,w),H,U,ja=>0===ja.StatusCode);this.pH.ega(a,this.Vb)}pHh(a,b,c,f=null,l=null){const w=new hg.a(new Ko(a,b,c),f,l,ja=>0===ja.StatusCode),H=()=>{this.PUi(w)};a=this.pH.axb(this.Vb.xf);const U=new Jn.a;a?a.forceOutbound(()=>{H()},l?()=>{l(U)}:null,null):(va.a.J(20460503,823,10,"Can't find graph space replicator when trying to do outbound"),l&&l(U))}flush(a=null,b=null){a=new hg.a(new Ye,a,b,c=>
0===c.StatusCode,3);this.pH.Nsa(a)}Nsa(a){this.pH.Nsa(a)}CSc(){return this.axb(this.Vb.xf)}PUi(a){this.kvg.Db(a);this.kvg.forceOutbound(null,null,null)}}Object(n.a)(Gl,"OutboundHelper",null,[1289,44,1344]);var Ci=d(259),dk=d(168);class Rk{constructor(a,b,c,f,l){this.cM=[];this.meb=new Ci.a;this.Mbd=null;this.Fsg=[];this.Z4=null;this.va=new vc.a;this.czg=this.bEb=this.pbd=!1;this.Tb=a;this.la=b;this.ua=c;this.Cgk=l;this.Ova=f;this.Nck=this.la.wua?1:4;f.kk(Object(F.a)(this,this.Vfd,"onMainMastersLoaded"));
this.la.wua&&f.kk(Object(F.a)(this,this.p5g,"onMasterIdListChanged"))}get Wlk(){if(this.la.wua&&this.ua.Ba){const a=this.ua.Ba.ij;a&&Array.contains(this.cM,a)&&this.oFe(a)}return this.cM.slice(0,Math.min(this.Nck,this.cM.length))}MYk(a){Array.remove(this.cM,a)}get ivl(){return this.Mbd}get PO(){return this.meb}get qYb(){return this.Fsg}get BDj(){return!this.Mbd}get EFk(){return 0<this.cM.length&&(!this.la.dVa||this.pbd)}get MFe(){return this.bEb}set MFe(a){this.bEb=a}Lrl(a){a&&this.ZEh(a.ij)}bzh(){this.pbd=
!0;this.tld(!0);this.bLb()}ZEh(a){this.pbd=!0;a&&(Array.remove(this.cM,a),Array.insert(this.cM,0,a));this.bLb()}R_e(a){this.la.wua?this.ZEh(a):this.bzh()}w4f(a){if(!a||!this.meb)return null;a=a.ij;if(!a)return null;let b=null;return({value:b}=this.meb.Tf(a)).returnValue?b:null}p5g(a,b){b.property.id===hb.a.Ycd.id&&(va.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.bEb),this.bEb&&(this.bEb=!1,this.pbd&&(this.tld(!1),this.bLb())),this.fFf())}Vfd(a,b){a=b.property;if(this.la.wua)if(a.id===
hb.a.kGb.id){a=this.Tb.Fcj();const f=this.Tb.HI();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],w=f[c];l.Id<w.Id?(this.tHh(l.Id),b++):w.Id<l.Id?(this.F5e(w.Id),c++):(Jc.c(l)!==Jc.c(w)&&this.YEl(w.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.F5e(f[c].Id);if(b<a.length)for(;b<a.length;b++)this.tHh(a[b].Id);this.bLb()}else dk.b(f,null,l=>{this.F5e(l.Id)})}else a.id===hb.a.DY.id&&(va.a.J(38847375,824,50,"Slide size changed, need to reload the resources."),this.tld(!0),
this.bLb());else if(a.id===hb.a.kGb.id||a.id===hb.a.DY.id)va.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.tld(!0),this.bLb()}F5e(a){this.oFe(a)}YEl(a){this.oFe(a)}oFe(a){Array.contains(this.cM,a)&&Array.remove(this.cM,a);Array.insert(this.cM,0,a)}tHh(a){this.meb.remove(a);-1!==Array.indexOf(this.cM,a)&&Array.remove(this.cM,a)}bLb(){this.Z4=this.Z4||this.Cgk(this);this.Z4.DF(null,null,null)}tld(a){if(this.la.wua){va.a.J(38847378,824,50,"RefreshMastersToLoad, need clean cache: {0} ",
a);var b=this.Tb.swb();a&&(Array.clear(this.cM),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.cM,c.idField)&&Array.add(this.cM,c.idField);else this.bEb=!0,(a=this.Tb.ZA(0))&&(a=a.ij)&&Array.add(this.cM,a)}else if(a=this.Tb.HI(),Array.clear(this.cM),this.clearCache(),a)for(b of a)this.meb.remove(b.Id),-1===Array.indexOf(this.cM,b.Id)&&Array.add(this.cM,b.Id)}twk(a){if(a){for(const b of a)b&&(va.a.J(38847381,824,50,"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",
b.MasterId),this.meb.$(b.MasterId,b),this.Mbd=this.Mbd||b.TableStyleGallery,this.la.wua||Array.remove(this.cM,b.MasterId));this.fFf();this.va.raiseEvent("MainMasterResourcesLoaded")}else va.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}fFf(){!this.czg&&this.hzf()&&(this.czg=!0,va.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),Pd.a("RaiseFirstMasterRetrievedEvent")&&this.va.raiseEvent("FirstMasterRetrieved"))}zrk(a){this.la.powerPointEnableAccCheck&&
(a&&a.length?(this.Fsg=a,this.va.raiseEvent("AccCheckRuleInfoListLoaded")):va.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}hzf(){if(!this.la.wua)return!0;const a=this.Tb.swb();if(a&&0<a.length)for(const b of this.Tb.swb())if(0<b.layoutCountField&&this.PO.Gb(b.idField)&&this.PO.ga(b.idField).LayoutIcons.length===b.layoutCountField)return va.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",
b.idField,b.layoutCountField),!0;return!1}YGc(a){this.va.addHandler("MainMasterResourcesLoaded",a)}x_k(a){this.va.removeHandler("MainMasterResourcesLoaded",a)}nai(a){this.va.addHandler("FirstMasterRetrieved",a)}I$h(a){this.va.addHandler("AccCheckRuleInfoListLoaded",a)}UZk(a){this.va.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.meb=new Ci.a}dispose(){this.Ova.Rm(Object(F.a)(this,this.Vfd,"onMainMastersLoaded"));this.la.wua&&this.Ova.Rm(Object(F.a)(this,this.p5g,"onMasterIdListChanged"));
this.va.dispose();this.Z4&&this.Z4.dispose()}}Object(n.a)(Rk,"PresentationResourcesManager",null,[1291,106]);var Lo=d(389);class Kn extends qh.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}Zk(){return 52}static eXd(a,b,c){const f=new Kn;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(n.a)(Kn,"GetEditPresResourcesRequest",qh.a,[]);class sn extends Lo.a{constructor(a,b,c,f){super();this.VBb=0;this.Leb=this.x4=!1;this.Mm=
a;this.FXa=b;this.iR=f;this.enabled=2;this.Jw=c.vEi();this.Mm.register(this)}DF(){this.Jw.U0i();this.Jw.hab();this.Mm.zaa()}forceOutbound(){}zka(){return this.FXa.EFk||this.FXa.MFe}QN(){return!1}NTa(){return this.Vd&&2===this.Vd.status?!0:this.x4||this.Leb?!1:this.zka()&&this.Jw.b8b()}FKb(){if(1===this._state){var a=this.FXa.Wlk;this.Vd.JH=Kn.eXd(a,this.FXa.BDj,this.FXa.MFe);for(const b of a)this.FXa.MYk(b);this.Vd.status=1;this._state=3}else 3===this._state&&this.Vd&&2===this.Vd.status&&(this.Leb?
(this._state=4,this.dispose()):(200===this.Vd.Av&&this.iR.dpc(),this.Jw.oMa(),2!==this.Vd.statusCode?this.DH():this.Vd.Qr&&1===this.Vd.Qr.length?(a=this.Vd.Qr[0],0===a.StatusCode?(this.FXa.twk(Jc.a(a.MainMasterResources)),this.FXa.zrk(Jc.a(a.AccRuleInfoList)),this.V0()):this.DH()):this.DH()))}get Nca(){return this.zka()?this.Jw.cjb():super.Nca}dispose(){1===this._state||4===this._state?(this.x4||this.Mm.unregister(this),this.x4=!0):this.Leb=!0}V0(){this.VBb=0;this._state=1;this.zka()||this.Jw.H0a()}DH(){4<
++this.VBb?(this._state=4,va.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.VBb)):(va.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(n.a)(sn,"PresentationResourcesReplicator",Lo.a,[106]);class tn{constructor(a,b){this.Ogk=a;this.qU=b}tyk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.fya;let c=null,f=!1;for(const l of this.Ogk)if(l.iY(a)){if(!c&&(c=this.qU.pEa(b),!c)){va.a.J(23594507,
817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.qU.sPd(b,a,c)}}Object(n.a)(tn,"RevisionMetaDataUpdateListener",null,[1293]);var po=d(411);class ve{pEa(a){if(!a)return null;const b=a.qL(4);return b&&!b.equals(ia.a.nil)?a.Be(b):new po.a}Q5e(a,b,c,f,l,w,H,U,ja){if(a&&f){a.io.apply(a,ve.l6k);a.setValue(hb.a.Rlg,b);a.setValue(hb.a.S8b,!0);a.setValue(hb.a.cnd,1);a.setValue(hb.a.sid,f.sid);a.setValue(hb.a.cid,f.cid);c&&a.setValue(hb.a.xFa,!0);l&&a.setValue(hb.a.shapeId,l.get_shapeId());
w&&(a.setValue(hb.a.eq,!0),a.setValue(hb.a.tBh,w.cellId),a.setValue(hb.a.rowId,w.rowId));if(H&&0<H.length){b=H.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=H[l].rowId,f[l]=H[l].cellId;a.setValue(hb.a.eq,!0);a.setValue(hb.a.nlb,f);a.setValue(hb.a.GBh,c)}a.setValue(hb.a.l2e,U);a.setValue(hb.a.k2e,ja)}}sPd(a,b,c){if(a&&b&&c){var f=!1;a.Be(ve.$fa)||(a.HE(c,ve.$fa),f=!0);b.vra(c);f&&b.Aya(c.id,4)}}DIh(a,b){if(a){var c=a.fya,f=this.pEa(c);f.setValue(hb.a.cnd,b);this.sPd(c,a,f)}}UGl(a){if(a){var b=
a.fya,c=this.pEa(b);c.setValue(hb.a.Z4k,0);this.sPd(b,a,c)}}}ve.$fa=ia.a.Gf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");ve.l6k=[hb.a.Rlg,hb.a.shapeId,hb.a.eq,hb.a.xFa,hb.a.tBh,hb.a.rowId,hb.a.nlb,hb.a.GBh,hb.a.l2e,hb.a.k2e];Object(n.a)(ve,"RevisionMetadataHelper",null,[1339]);var un=d(665),Mo=d(855);class dm extends qh.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=
c;this.SessionKey=f}Zk(){return 32}}Object(n.a)(dm,"SaveAndCloseRequest",qh.a,[]);class Hl{constructor(a,b,c,f,l,w,H,U,ja){this.wi=a;this.sad=b;this.MC=c;this.Xa=f;this.la=l;this.yz=w;this.Sd=H;this.mc=U;this.Mm=ja}W0i(a){this.Xa.rAb=!0;a=new dm(!0,!1,a,this.Xa.podSessionId);this.Sd.Dka=!0;const b=this.wi.CSc();b&&b.QN()&&this.mc.In?this.la.VCa?(ka.ULS.sendTraceTag(509436876,844,50,"SaveAndCloseHandler: forceSaveOnUnload - application is unloading, forceOutbound to save any remaining changes."),b.forceOutbound(null,
null,null),this.sad.O2d(a,null,null)):b.h9a(null,null,null,a):this.sad.O2d(a,null,null)}C3(a=!1,b=!0,c=null,f=null,l=1){va.a.J(509691458,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const w=new dm(a,!0,l,this.Xa.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.yz.markSessionClosingAtForceSave(l),this.Mm.pause(),this.sad.h9a(w,H=>{va.a.J(509691457,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");this.la.FUf?
this.yz.closeSession(l):this.MC.Ykd(new un.a(l));c(H)},()=>{va.a.J(509691456,823,15,"SaveAndCloseHandler::ForceSave Failed.");this.Mm.amb();f&&f(null);return!0});else{a=this.wi.CSc();const H=U=>{this.Quk(w,c,f,ja=>0===ja.StatusCode,U,b,l)};a?a.forceOutbound(()=>{H(!0)},()=>{H(!1)},null):(va.a.J(509691427,823,10,"Can't find graph space replicator when trying to do outbound"),H(!1))}}Quk(a,b,c,f,l,w,H){va.a.J(509691426,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",
a.ShouldReleaseLock,l,w);l&&w||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Sd.Dka=!0),this.sad.Nsa(a,U=>{a.ShouldReleaseLock&&(this.la.FUf?this.yz.closeSession(H):this.MC.Ykd(new un.a(H)));b(U)},c,f)):l&&b?b(new Mo.a):!l&&c&&c(new Jn.a)}}Object(n.a)(Hl,"SaveAndCloseHandler",null,[1290]);var Om=d(1032),Bh=d(103);class Rg{constructor(a,b,c,f){this.wi=a;this.uDe=b;this.iic=c;this.Gwa=f}iY(a){let b=null,c=!0;if(this.wi.cZc)b=a.rsa,c=!1;else if(this.uDe.jd===D.a.typing||this.uDe.jd===D.a.gCa||this.uDe.jd===
D.a.rRa)b=a.rsa;b&&(this.Gwa&&this.WIi(b.toString()),Rc.a.QFa(),this.iic.FDh(b,c),va.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.rsa.toString(),Rc.a.mf(new Date)));return!1}update(){}WIi(a){const b=new Om.ActionContext(Bh.a.WFh,1,null);b.Oj=!0;b.tF=new Date;b.Va(Bh.a.FY,Rc.a.h$a(a).toString());b.Ur=!0;Rc.a.Tfa(b)}}Object(n.a)(Rg,"TextEditingRevisionInfoMetaDataUpdater",null,[1337]);class lk{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}Zb(a){this.K=a;
const b=()=>new Wc.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").N1b(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Ug);a.register(1289,"PowerPointWebEditor.Storage.IOutboundHelper").ma().oa(()=>new Gl(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1290,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().oa(()=>new Hl(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1291,"PowerPointWebEditor.IPresentationResourcesManager").ma().oa(()=>new Rk(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").xd(7),c=>new sn(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),
this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.tzi()}tzi(){this.K.register(ve,"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();this.K.register(Rl,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(1292,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().oa(()=>new Yf(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),
this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));this.K.register(1293,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().oa(()=>new tn([new sm(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),Fl.$qg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new Rg(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();
this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){v.a.instance.Dc(new lk)}}Object(n.a)(lk,"PPTWebEditorStoragePackage",null,[2,3]);class pc{constructor(a,b,c){this.mNh=a;this.JQh=b;this.p0h=c}get LCID(){return this.mNh}get Q7k(){return this.p0h}get sMf(){return this.JQh}get Bje(){return!!(this.sMf&pc.qMh)}get P9b(){return!!(this.sMf&pc.rMh)}static xXc(){pc.eUe={["20490"]:new pc(20490,4215112,"Latn"),["8251"]:new pc(8251,4215112,"Latn"),["17418"]:new pc(17418,
4215112,"Latn"),["17417"]:new pc(17417,4215112,"Latn"),["8218"]:new pc(8218,4215304,"Cyrl"),["8204"]:new pc(8204,4215112,"Latn"),["8202"]:new pc(8202,4215112,"Latn"),["8201"]:new pc(8201,4215112,"Latn"),["8193"]:new pc(8193,4493640,"Arab"),["6154"]:new pc(6154,4215112,"Latn"),["7227"]:new pc(7227,4215112,"Latn"),["19466"]:new pc(19466,4215112,"Latn"),["16394"]:new pc(16394,4215112,"Latn"),["16393"]:new pc(16393,4215112,"Latn"),["16385"]:new pc(16385,4493640,"Arab"),["7194"]:new pc(7194,4215048,"Cyrl"),
["7180"]:new pc(7180,20808,"Latn"),["7178"]:new pc(7178,4215112,"Latn"),["7177"]:new pc(7177,4215112,"Latn"),["7169"]:new pc(7169,4493640,"Arab"),["12289"]:new pc(12289,4493640,"Arab"),["6203"]:new pc(6203,4215080,"Latn"),["15372"]:new pc(15372,4215112,"Latn"),["15370"]:new pc(15370,4215112,"Latn"),["15369"]:new pc(15369,4215112,"Latn"),["15361"]:new pc(15361,4493640,"Arab"),["6170"]:new pc(6170,4215304,"Latn"),["6156"]:new pc(6156,4215112,"Latn"),["18442"]:new pc(18442,4215112,"Latn"),["6153"]:new pc(6153,
4215112,"Latn"),["6145"]:new pc(6145,4493640,"Arab"),["4155"]:new pc(4155,4215080,"Latn"),["11274"]:new pc(11274,4215112,"Latn"),["5179"]:new pc(5179,4215112,"Latn"),["14348"]:new pc(14348,4215112,"Latn"),["14346"]:new pc(14346,4215112,"Latn"),["14345"]:new pc(14345,20808,"Latn"),["14337"]:new pc(14337,4493640,"Arab"),["5146"]:new pc(5146,4215048,"Latn"),["5132"]:new pc(5132,4215112,"Latn"),["5130"]:new pc(5130,4215112,"Latn"),["5129"]:new pc(5129,4215112,"Latn"),["5127"]:new pc(5127,4215112,"Latn"),
["5124"]:new pc(5124,4281672,"Hant"),["5121"]:new pc(5121,4493640,"Arab"),["31770"]:new pc(31770,4210820,""),["31748"]:new pc(31748,4277380,""),["10266"]:new pc(10266,4215048,"Cyrl"),["10252"]:new pc(10252,4215112,"Latn"),["10250"]:new pc(10250,4215112,"Latn"),["10249"]:new pc(10249,4215112,"Latn"),["13324"]:new pc(13324,4215112,"Latn"),["13322"]:new pc(13322,4215112,"Latn"),["13321"]:new pc(13321,4215112,"Latn"),["10241"]:new pc(10241,4493640,"Arab"),["13313"]:new pc(13313,4493640,"Arab"),["4122"]:new pc(4122,
4215048,"Latn"),["4108"]:new pc(4108,4215112,"Latn"),["4106"]:new pc(4106,4215112,"Latn"),["4105"]:new pc(4105,4215112,"Latn"),["4103"]:new pc(4103,4215112,"Latn"),["4100"]:new pc(4100,4282696,"Hans"),["3179"]:new pc(3179,4215048,"Latn"),["4097"]:new pc(4097,4493640,"Arab"),["1085"]:new pc(1085,299432,"Hebr"),["1144"]:new pc(1144,4280616,"Yiii"),["21514"]:new pc(21514,4215112,"Latn"),["2145"]:new pc(2145,5132616,"Deva"),["3131"]:new pc(3131,4215112,"Latn"),["2143"]:new pc(2143,4215432,"Latn"),["12314"]:new pc(12314,
4215048,"Cyrl"),["1070"]:new pc(1070,4215080,"Latn"),["1130"]:new pc(1130,4215080,"Latn"),["12300"]:new pc(12300,4215112,"Latn"),["1091"]:new pc(1091,4215080,"Latn"),["12298"]:new pc(12298,4215112,"Latn"),["12297"]:new pc(12297,4215112,"Latn"),["2055"]:new pc(2055,4215112,"Latn"),["2052"]:new pc(2052,4282664,"Hans"),["2115"]:new pc(2115,4215368,"Cyrl"),["9242"]:new pc(9242,4215304,"Latn"),["3098"]:new pc(3098,4215048,"Cyrl"),["2107"]:new pc(2107,4215112,"Latn"),["9228"]:new pc(9228,4215112,"Latn"),
["3084"]:new pc(3084,4215112,"Latn"),["9226"]:new pc(9226,4215112,"Latn"),["3082"]:new pc(3082,4215080,"Latn"),["3081"]:new pc(3081,4215112,"Latn"),["2094"]:new pc(2094,4215080,"Latn"),["3079"]:new pc(3079,4215112,"Latn"),["2092"]:new pc(2092,4215368,"Cyrl"),["1064"]:new pc(1064,4215080,"Cyrl"),["3076"]:new pc(3076,4281640,"Hant"),["2155"]:new pc(2155,4215048,"Latn"),["3073"]:new pc(3073,4493640,"Arab"),["1153"]:new pc(1153,4215080,"Latn"),["1119"]:new pc(1119,299400,"Arab"),["1086"]:new pc(1086,
4215080,"Latn"),["2144"]:new pc(2144,938632,"Deva"),["2077"]:new pc(2077,4215112,"Latn"),["1053"]:new pc(1053,4215080,"Latn"),["2141"]:new pc(2141,4215336,"Latn"),["2074"]:new pc(2074,4215304,"Latn"),["2073"]:new pc(2073,20808,"Cyrl"),["2072"]:new pc(2072,4215112,"Latn"),["2137"]:new pc(2137,4493896,"Arab"),["2070"]:new pc(2070,4215048,"Latn"),["2068"]:new pc(2068,4215048,"Latn"),["2067"]:new pc(2067,4215112,"Latn"),["1073"]:new pc(1073,4215080,"Latn"),["2064"]:new pc(2064,4215112,"Latn"),["2129"]:new pc(2129,
414016,"Tibt"),["2128"]:new pc(2128,4608584,"Mong"),["2060"]:new pc(2060,4215112,"Latn"),["1132"]:new pc(1132,4215080,"Latn"),["1097"]:new pc(1097,5132584,"Taml"),["2057"]:new pc(2057,4215080,"Latn"),["1164"]:new pc(1164,4493608,"Arab"),["106"]:new pc(106,4210820,""),["2118"]:new pc(2118,4493640,"Arab"),["2117"]:new pc(2117,5132584,"Beng"),["2049"]:new pc(2049,4493640,"Arab"),["1156"]:new pc(1156,4215080,"Latn"),["2110"]:new pc(2110,4215112,"Latn"),["1054"]:new pc(1054,4608296,"Thai"),["2108"]:new pc(2108,
4215048,"Latn"),["1083"]:new pc(1083,4215080,"Latn"),["136"]:new pc(136,4210820,""),["1114"]:new pc(1114,4493608,"Syrc"),["1148"]:new pc(1148,4215080,"Latn"),["1145"]:new pc(1145,20776,"Latn"),["11290"]:new pc(11290,4215304,"Latn"),["1075"]:new pc(1075,20776,"Latn"),["1106"]:new pc(1106,4215080,"Latn"),["1140"]:new pc(1140,4215080,"Latn"),["120"]:new pc(120,4276356,""),["1136"]:new pc(1136,4215080,"Latn"),["1066"]:new pc(1066,4215080,"Latn"),["1098"]:new pc(1098,5132584,"Telu"),["1169"]:new pc(1169,
4215048,"Latn"),["11276"]:new pc(11276,4215112,"Latn"),["61"]:new pc(61,295044,"Hebr"),["1060"]:new pc(1060,4215080,"Latn"),["11273"]:new pc(11273,4215112,"Latn"),["1058"]:new pc(1058,4215080,"Cyrl"),["128"]:new pc(128,4489348,""),["1160"]:new pc(1160,4215080,"Latn"),["1159"]:new pc(1159,4215080,"Latn"),["1158"]:new pc(1158,20776,"Latn"),["1157"]:new pc(1157,4215080,"Cyrl"),["11265"]:new pc(11265,4493640,"Arab"),["1155"]:new pc(1155,4215080,"Latn"),["1154"]:new pc(1154,4215080,"Latn"),["1117"]:new pc(1117,
4215080,"Cans"),["1152"]:new pc(1152,4493608,"Arab"),["1115"]:new pc(1115,5132584,"Sinh"),["1150"]:new pc(1150,4215080,"Latn"),["1113"]:new pc(1113,938280,"Deva"),["1112"]:new pc(1112,938280,"Beng"),["51"]:new pc(51,16516,""),["1146"]:new pc(1146,4215080,"Latn"),["1109"]:new pc(1109,5132584,"Mymr"),["115"]:new pc(115,4210820,""),["1143"]:new pc(1143,4215080,"Latn"),["1142"]:new pc(1142,20872,"Latn"),["1141"]:new pc(1141,4215080,"Latn"),["1104"]:new pc(1104,4215080,"Cyrl"),["2058"]:new pc(2058,4215112,
"Latn"),["1102"]:new pc(1102,5132584,"Deva"),["1137"]:new pc(1137,20776,"Latn"),["1100"]:new pc(1100,5132584,"Mlym"),["1135"]:new pc(1135,4215080,"Latn"),["1134"]:new pc(1134,4215080,"Latn"),["1133"]:new pc(1133,4215080,"Cyrl"),["1096"]:new pc(1096,5132584,"Orya"),["1131"]:new pc(1131,4215048,"Latn"),["1094"]:new pc(1094,5132584,"Guru"),["1129"]:new pc(1129,20872,"Latn"),["1128"]:new pc(1128,4215080,"Latn"),["1127"]:new pc(1127,20776,"Latn"),["1126"]:new pc(1126,20776,"Latn"),["1125"]:new pc(1125,
4493608,"Thaa"),["1124"]:new pc(1124,4215080,"Latn"),["1123"]:new pc(1123,4493608,"Arab"),["1122"]:new pc(1122,4215080,"Latn"),["1121"]:new pc(1121,5132584,"Deva"),["1120"]:new pc(1120,299400,"Arab"),["1118"]:new pc(1118,4215080,"Ethi"),["1082"]:new pc(1082,4215080,"Latn"),["1116"]:new pc(1116,4215080,"Cher"),["1080"]:new pc(1080,4215080,"Latn"),["1079"]:new pc(1079,4215080,"Geor"),["1078"]:new pc(1078,4215080,"Latn"),["1077"]:new pc(1077,4215080,"Latn"),["1111"]:new pc(1111,5132584,"Deva"),["1110"]:new pc(1110,
4215080,"Latn"),["1074"]:new pc(1074,4215080,"Latn"),["1108"]:new pc(1108,4608296,"Laoo"),["1107"]:new pc(1107,4608296,"Khmr"),["1071"]:new pc(1071,4215080,"Cyrl"),["1105"]:new pc(1105,4608296,"Tibt"),["1069"]:new pc(1069,4215080,"Latn"),["1103"]:new pc(1103,5132584,"Deva"),["1067"]:new pc(1067,4215080,"Armn"),["1101"]:new pc(1101,5132584,"Beng"),["1065"]:new pc(1065,4493608,"Arab"),["1099"]:new pc(1099,5132584,"Knda"),["1063"]:new pc(1063,4215080,"Latn"),["1062"]:new pc(1062,4215080,"Latn"),["1061"]:new pc(1061,
4215080,"Latn"),["1095"]:new pc(1095,5132584,"Gujr"),["1059"]:new pc(1059,4215080,"Cyrl"),["1093"]:new pc(1093,5132584,"Beng"),["1092"]:new pc(1092,4215080,"Cyrl"),["1056"]:new pc(1056,4493608,"Arab"),["1090"]:new pc(1090,4215080,"Latn"),["1089"]:new pc(1089,4215080,"Latn"),["1088"]:new pc(1088,4215080,"Cyrl"),["1087"]:new pc(1087,4215080,"Cyrl"),["1052"]:new pc(1052,4215080,"Latn"),["1051"]:new pc(1051,4215080,"Latn"),["1050"]:new pc(1050,4215048,"Latn"),["1049"]:new pc(1049,4215080,"Cyrl"),["1048"]:new pc(1048,
4215080,"Latn"),["1081"]:new pc(1081,5132584,"Deva"),["1046"]:new pc(1046,4215048,"Latn"),["1045"]:new pc(1045,4215080,"Latn"),["1044"]:new pc(1044,4215048,"Latn"),["1043"]:new pc(1043,4215080,"Latn"),["1076"]:new pc(1076,4215080,"Latn"),["1041"]:new pc(1041,4280616,"Jpan"),["1040"]:new pc(1040,4215080,"Latn"),["119"]:new pc(119,4210820,""),["1072"]:new pc(1072,4215176,"Latn"),["1037"]:new pc(1037,4493608,"Hebr"),["1036"]:new pc(1036,4215080,"Latn"),["1035"]:new pc(1035,4215080,"Latn"),["1068"]:new pc(1068,
4215080,"Latn"),["1033"]:new pc(1033,4215048,"Latn"),["1032"]:new pc(1032,4215080,"Grek"),["1031"]:new pc(1031,4215080,"Latn"),["1030"]:new pc(1030,4215080,"Latn"),["1029"]:new pc(1029,4215080,"Latn"),["1028"]:new pc(1028,4281672,"Hant"),["1027"]:new pc(1027,4215080,"Latn"),["1026"]:new pc(1026,4215080,"Cyrl"),["140"]:new pc(140,4489348,""),["1057"]:new pc(1057,4215080,"Latn"),["50"]:new pc(50,4210820,""),["1055"]:new pc(1055,4215080,"Latn"),["135"]:new pc(135,4210820,""),["134"]:new pc(134,16516,
""),["133"]:new pc(133,4210820,""),["132"]:new pc(132,4210820,""),["131"]:new pc(131,4210820,""),["130"]:new pc(130,4210820,""),["129"]:new pc(129,4210820,""),["1047"]:new pc(1047,4215080,"Latn"),["126"]:new pc(126,4210820,""),["89"]:new pc(89,5128324,""),["124"]:new pc(124,4210820,""),["1042"]:new pc(1042,4280616,"Hang"),["122"]:new pc(122,4210820,""),["121"]:new pc(121,16516,""),["1039"]:new pc(1039,4215080,"Latn"),["1038"]:new pc(1038,4215080,"Latn"),["118"]:new pc(118,16516,""),["117"]:new pc(117,
4210820,""),["116"]:new pc(116,4210820,""),["1034"]:new pc(1034,4219176,"Latn"),["114"]:new pc(114,4210820,""),["113"]:new pc(113,16516,""),["112"]:new pc(112,4210820,""),["111"]:new pc(111,4210820,""),["110"]:new pc(110,4210820,""),["109"]:new pc(109,4210820,""),["108"]:new pc(108,4210820,""),["107"]:new pc(107,4210820,""),["1025"]:new pc(1025,4493608,"Arab"),["105"]:new pc(105,16516,""),["104"]:new pc(104,4210820,""),["103"]:new pc(103,4210820,""),["102"]:new pc(102,16516,""),["101"]:new pc(101,
4489348,""),["100"]:new pc(100,4210820,""),["99"]:new pc(99,4489348,""),["98"]:new pc(98,4210820,""),["97"]:new pc(97,5128324,""),["96"]:new pc(96,966788,""),["95"]:new pc(95,4505732,""),["94"]:new pc(94,4210820,""),["93"]:new pc(93,4210820,""),["92"]:new pc(92,4210820,""),["91"]:new pc(91,5128324,""),["90"]:new pc(90,4489348,""),["85"]:new pc(85,5128324,""),["88"]:new pc(88,934020,""),["87"]:new pc(87,5128324,""),["86"]:new pc(86,4210820,""),["9275"]:new pc(9275,4215112,"Latn"),["84"]:new pc(84,
4604036,""),["83"]:new pc(83,4604036,""),["82"]:new pc(82,4210820,""),["81"]:new pc(81,4604036,""),["80"]:new pc(80,4604036,""),["79"]:new pc(79,5128324,""),["78"]:new pc(78,5128324,""),["77"]:new pc(77,5128324,""),["76"]:new pc(76,5128324,""),["75"]:new pc(75,5128324,""),["74"]:new pc(74,5128324,""),["73"]:new pc(73,5128324,""),["72"]:new pc(72,4210820,""),["71"]:new pc(71,4210820,""),["70"]:new pc(70,5128324,""),["69"]:new pc(69,5128324,""),["68"]:new pc(68,4210820,""),["67"]:new pc(67,4210820,
""),["66"]:new pc(66,4210820,""),["65"]:new pc(65,4210820,""),["64"]:new pc(64,4210820,""),["63"]:new pc(63,4210820,""),["62"]:new pc(62,4210820,""),["18441"]:new pc(18441,4215112,"Latn"),["59"]:new pc(59,4210820,""),["58"]:new pc(58,4210820,""),["57"]:new pc(57,5128324,""),["56"]:new pc(56,4210820,""),["55"]:new pc(55,4210820,""),["54"]:new pc(54,4210820,""),["53"]:new pc(53,4210820,""),["52"]:new pc(52,4210820,""),["31"]:new pc(31,4210820,""),["47"]:new pc(47,4210820,""),["49"]:new pc(49,4210820,
""),["48"]:new pc(48,4210820,""),["44"]:new pc(44,4210820,""),["46"]:new pc(46,4210820,""),["45"]:new pc(45,4210820,""),["41"]:new pc(41,4489348,""),["43"]:new pc(43,4210820,""),["42"]:new pc(42,4210820,""),["38"]:new pc(38,4210820,""),["40"]:new pc(40,4210820,""),["39"]:new pc(39,4210820,""),["35"]:new pc(35,4210820,""),["37"]:new pc(37,4210820,""),["36"]:new pc(36,4210820,""),["9225"]:new pc(9225,4215112,"Latn"),["34"]:new pc(34,4210820,""),["33"]:new pc(33,4210820,""),["32"]:new pc(32,4489348,
""),["29"]:new pc(29,4210820,""),["30"]:new pc(30,4604036,""),["27"]:new pc(27,4210820,""),["28"]:new pc(28,4210820,""),["9217"]:new pc(9217,4493640,"Arab"),["26"]:new pc(26,4210820,""),["25"]:new pc(25,4210820,""),["24"]:new pc(24,4210820,""),["23"]:new pc(23,4210820,""),["22"]:new pc(22,4210820,""),["21"]:new pc(21,4210820,""),["20"]:new pc(20,4210820,""),["19"]:new pc(19,4210820,"Latn"),["18"]:new pc(18,4276356,""),["17"]:new pc(17,4276356,""),["16"]:new pc(16,4210820,""),["15"]:new pc(15,4210820,
""),["14"]:new pc(14,4210820,""),["13"]:new pc(13,4489348,""),["12"]:new pc(12,4210820,""),["11"]:new pc(11,4210820,""),["10"]:new pc(10,4210820,""),["9"]:new pc(9,4210820,""),["8"]:new pc(8,4210820,""),["7"]:new pc(7,4210820,""),["6"]:new pc(6,4210820,""),["5"]:new pc(5,4210820,""),["4"]:new pc(4,4278404,""),["3"]:new pc(3,4210820,""),["2"]:new pc(2,4210820,""),["1"]:new pc(1,4489348,""),["0"]:new pc(0,1,"")}}static xe(a){pc.eUe||pc.xXc();return pc.eUe[a.toString()]}}pc.eUe=null;pc.qMh=262144;pc.rMh=
65536;Object(n.a)(pc,"ExtendedCultureInfo",null,[]);class hj{YU(a,b){var c=a.sa(Za.a.kt,1033);Xa.a.xe(c)&&(c=pc.xe(c))&&(c.P9b?a.setValue(hb.a.eastAsianFont,b):c.Bje&&a.setValue(hb.a.complexScriptFont,b));a.setValue(hb.a.latinFont,b)}static Axi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.we(Za.a.subscript,!0):0<b.baselineField?a.we(Za.a.superscript,!0):(a.we(Za.a.subscript,!1),a.we(Za.a.superscript,!1)));b.bFieldSpecified&&a.we(Za.a.bold,b.bField);b.noProofFieldSpecified&&a.we(Va.a.noProof,
b.noProofField);b.iFieldSpecified&&a.we(Za.a.italic,b.iField);b.strikeFieldSpecified&&a.we(Za.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.we(Za.a.underline,b.uField);if(b.langField){var f=Xa.a.xe(b.langField);f?a.we(Za.a.kt,f.LCID):va.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((f=Xa.a.xe(b.altLangField))?a.we(hb.a.DHc,f.LCID):va.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+
b.altLangField));b.hlinkClickField&&(a.we(Za.a.it,!0),a.we(Za.a.G_,!0));hj.Dxi(a,b,c)}static nJf(a){a>Ef.a.cdd?a=Ef.a.cdd:a<Ef.a.vdd&&(a=Ef.a.vdd);return hj.DRi(a)}static Dxi(a,b,c){b.szFieldSpecified&&a.we(Za.a.fontSize,hj.nJf(b.szField));(c=ie.Box4ColorHelper.LKb(b,c))&&a.setValue(Za.a.fontColor,c.sD);b.latinField&&a.we(hb.a.latinFont,b.latinField.typefaceField);b.eaField&&a.we(hb.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.we(hb.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&
a.we(eh.a.capitalization,b.capField);b.symField&&a.we(hb.a.YNb,b.symField.typefaceField)}static DRi(a){return a/(Ef.a.xmc*Ef.a.$$a)}static AAf(a){return a*Ef.a.$$a}}Object(n.a)(hj,"FormattingHelper",null,[1175]);class No{N6i(a,b,c){let f="";const l=a.sa(Va.a.W_,[]);l&&0<=b&&b<l.length&&(a=a.Gh)&&(b=a.Be(l[b]))&&b.Sa(hb.a.schemeColor)&&((b=jo.SchemeColor.parse(b.eb(hb.a.schemeColor)))?b.Nta?f=Bl.i(b.ZP):b.wQe(c)&&(f=Bl.i(b.ZP)):va.a.J(38606471,826,50,"schemeClr is null."));return f}P6i(a,b){let c=
"";(a=a.sqd)||va.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&va.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");a&&a.schemeClrField&&(14===a.schemeClrField.valField?va.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?va.a.J(38549312,826,50,"The color of shapeFont is B"):va.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=ie.Box4ColorHelper.gjb(a,b),b=Bl.g(b.D_a),c=Bl.i(b),"000000"===c?va.a.J(38549316,
826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?va.a.J(38549318,826,50,"The resolved color of shapeFont is W"):va.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));return c}}Object(n.a)(No,"NonTableThemeColorHelper",null,[1300]);class Sl{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(n.a)(Sl,"CT_TextFont",null,[]);class dl{constructor(){this.pSa=this.y_a=null}}Object(n.a)(dl,"ThemeFont",null,[]);
class Ze{static isThemeFont(a){return Ze.B6k.hasOwnProperty(a)}static yaj(a){let b="",c,f;({T8a:c,Qkb:f}=Ze.qaj(a)).returnValue&&(0===c?0===f?b="+Heading":1===f?b="+Heading Asian":2===f&&(b="+Heading CS"):1===c&&(0===f?b="+Body":1===f?b="+Body Asian":2===f&&(b="+Body CS")));return b}static Gmi(a,b,c){const f=[];if(!c||!c.FontScheme)return f;var l=Ze.V_,w=Ze.V_,H=Ze.V_;({Npg:l,jRf:w,nMf:H}=Ze.wJh(l,w,H,a));({Npg:l,jRf:w,nMf:H}=Ze.wJh(l,w,H,b));a=c.FontScheme;l!==Ze.V_?(Ze.hJb(a,0,l,Ze.Ocd,f),Ze.hJb(a,
1,l,Ze.Cdd,f)):(l=Ze.u$a(a,0,0),b=Ze.u$a(a,1,0),Ze.Wa(l)||Ze.Wa(b)||(f.push(Object.assign(new dl,{y_a:l,pSa:Ze.Ocd})),f.push(Object.assign(new dl,{y_a:b,pSa:Ze.Cdd}))));w!==Ze.V_?(Ze.hJb(a,0,w,Ze.Ncd,f),Ze.hJb(a,1,w,Ze.Bdd,f)):(w=Ze.u$a(a,0,1),l=Ze.u$a(a,1,1),Ze.Wa(w)||Ze.Wa(l)||(f.push(Object.assign(new dl,{y_a:w,pSa:Ze.Ncd})),f.push(Object.assign(new dl,{y_a:l,pSa:Ze.Bdd}))));H!==Ze.V_?(Ze.hJb(a,0,H,Ze.Mcd,f),Ze.hJb(a,1,H,Ze.zdd,f)):(H=Ze.u$a(a,0,2),w=Ze.u$a(a,1,2),Ze.Wa(H)||Ze.Wa(w)||(f.push(Object.assign(new dl,
{y_a:H,pSa:Ze.Mcd})),f.push(Object.assign(new dl,{y_a:w,pSa:Ze.zdd}))));return f}static Wa(a){return!a||!a.length}static hJb(a,b,c,f,l){a&&c!==Ze.V_&&(c=Ze.toj(a,b,c),Ze.Wa(c)&&(c=Ze.u$a(a,b,0),Ze.Wa(c)&&(c="Arial")),l.push(Object.assign(new dl,{y_a:c,pSa:f})))}static u$a(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=Ze.k9f(a.majorFontField,c));break;case 1:a.minorFontField&&(f=Ze.k9f(a.minorFontField,c))}return f}static k9f(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);
break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static toj(a,b,c){if(!a||c===Ze.V_)return"";let f="";if(1066===c)f="Viet";else if(1152===c)f="Uigh";else if(c=pc.xe(c))f=c.Q7k;return Ze.uoj(a,b,f)}static uoj(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=Ze.j9f(a.majorFontField,c));break;case 1:a.minorFontField&&(f=Ze.j9f(a.minorFontField,c))}return f}static j9f(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=
0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static wJh(a,b,c,f){if(f!==Ze.V_){const l=pc.xe(f);l&&(l.P9b?b===Ze.V_&&(b=f):l.Bje?c===Ze.V_&&(c=f):a===Ze.V_&&(a=f))}return{Npg:a,jRf:b,nMf:c}}static qaj(a){switch(a){case Ze.Mcd:return{returnValue:!0,T8a:0,Qkb:2};case Ze.Ncd:return{returnValue:!0,T8a:0,Qkb:1};case Ze.Ocd:return{returnValue:!0,T8a:0,Qkb:0};case Ze.zdd:return{returnValue:!0,T8a:1,Qkb:2};
case Ze.Bdd:return{returnValue:!0,T8a:1,Qkb:1};case Ze.Cdd:return{returnValue:!0,T8a:1,Qkb:0}}return{returnValue:!1,T8a:2,Qkb:0}}static qub(a,b){let c=null;if(0===a)switch(b){case 2:c=Ze.Mcd;break;case 1:c=Ze.Ncd;break;case 0:c=Ze.Ocd}else if(1===a)switch(b){case 2:c=Ze.zdd;break;case 1:c=Ze.Bdd;break;case 0:c=Ze.Cdd}null===c&&(va.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new Sl,{typefaceField:c,charsetField:1})}}Ze.Mcd="+mj-cs";
Ze.Ncd="+mj-ea";Ze.Ocd="+mj-lt";Ze.zdd="+mn-cs";Ze.Bdd="+mn-ea";Ze.Cdd="+mn-lt";Ze.V_=0;Ze.B6k={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(n.a)(Ze,"TextFontHelper",null,[]);class qo{constructor(a,b,c){this.ua=a;this.ic=b;this.g$c=c}I3k(a,b){let c="";var f=a.sa(Za.a.kt,Ze.V_),l=a.sa(hb.a.DHc,Ze.V_),w=pc.xe(f===Ze.V_?1033:f);if(w){let H="";a.Sa(hb.a.YNb)?H=a.eb(hb.a.YNb):w.Bje&&a.Sa(hb.a.complexScriptFont)?H=a.eb(hb.a.complexScriptFont):w.P9b&&a.Sa(hb.a.eastAsianFont)?
H=a.eb(hb.a.eastAsianFont):a.Sa(hb.a.latinFont)&&(H=a.eb(hb.a.latinFont));if(Ze.isThemeFont(H)){w=!1;let U=null;if(this.g$c){if(b=Object(qa.a)(115,this.ic.jg(b)))U=b.Jd}else{if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");U=this.ua.Ba.Jd}if(U&&(f=Ze.Gmi(f,l,U)))for(l=0;l<f.length;l++)if(H===f[l].pSa){c=f[l].y_a;w=!0;break}w||(c=Ze.yaj(H))}else c=H}c&&a.we(Za.a.font,c)}}Object(n.a)(qo,"FontResolver",null,[1299]);class Oo{constructor(a){this.Z9j=a}dCi(a,b,c){a(Za.a.kt);a(hb.a.latinFont);
a(hb.a.eastAsianFont);a(hb.a.complexScriptFont);a(hb.a.YNb);a(hb.a.DHc);a(hb.a.Jd);a(hb.a.ttb);a(hb.a.NAb);a(hb.a.qN);a(hb.a.schemeColor);a(hb.a.qZc);a(hb.a.r_d);a(hb.a.o_d);a(hb.a.l_d);a(hb.a.v_d);a(hb.a.B8b);this.Z9j.I3k(b(),c)}}Object(n.a)(Oo,"PptFormattingCacheCopyPropertyStrategy",null,[1341]);class Ln{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}Zb(a){this.K=a;a.register(1299,"Box4.IFontResolver").ma().oa(()=>new qo(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(1175,"PowerPointWebEditor.IFormattingHelper").ma().oa(()=>new hj);a.register(Oo,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().oa(()=>new Oo(a.resolve("Box4.IFontResolver")));a.register(1300,"PowerPointWebEditor.INonTableThemeColorHelper").ma().oa(()=>new No)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");
this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){v.a.instance.Dc(new Ln)}}Object(n.a)(Ln,"PPTWebEditorTextFormattingPackage",null,[2,3]);class Po{constructor(a){this.fd=a;this.vPh=R.a.instance.ga(115)}nlg(a){return this.Pjg(a)?!0:this.vPh?1074135161===a.Ue||1074135162===a.Ue:!1}Ojg(a){return this.Pjg(a)||131162===a.Ue||4325465===a.Ue||1179729===a.Ue}Pjg(a){return 131140===a.Ue||this.fd.hg&&131120===a.Ue}BQf(a){return pa.a.any(a.VJ,(b,c)=>!this.Ojg(c)&&!this.nlg(c))}}
Object(n.a)(Po,"UndoRevisionValidator",null,[1467]);class Mn{constructor(){this.hd=Ab.a.instance.rb("Box4.IFeatureHelper")}IMb(){return u.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}y0a(){return this.IMb()&&u.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(n.a)(Mn,"UndoSettingsManager",null,[1466]);var fn=d(345),qj=d(1031),ro=d(202);class Pm{Sa(a){return a.Sa(void 0)}i6f(a,b){return a.sa(b,null)}qUc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new qj.a(a)}l6f(a,b){return a.sa(b,
"")}ash(a,b,c){a.setValue(b,c)}}Object(n.a)(Pm,"MergeableObjectUtilities",null,[400]);class gn{constructor(a,b,c,f,l){this.Fb=a;this.ua=b;this.Ea=c;this.pa=f;this.n0=l}Sed(a,b,c){if(a)if("PowerPointGroupShapes"===b&&c)for(a=a.VJ,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===f.Ue&&f.Sa(hb.a.V8)){f=(new Pm).qUc(f,hb.a.V8);for(var l=0;l<f.length;l++){var w=this.ua.Ba;if(!w)throw Error.argumentNull("ActiveSlide is null");const H=this.n0.qda(f.ga(l));w=w.zC(H.get_shapeId());b.push(w)}this.yAj(b)}}else if("PowerPointUngroupShapes"===
b&&!c)for(a=a.VJ,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Ue&&c.Sa(hb.a.opa))for(c=(new Pm).qUc(c,hb.a.opa),f=0;f<c.length;f++){l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");w=this.n0.qda(c.ga(f));l=l.zC(w.get_shapeId());this.xAj(l)}}DWc(a){if(a){const b=a.ng(this.Fb.Ma);b.Cka();b.pLb=!0;this.pa.s8(a)}else va.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}yAj(a){if(a.length){var b=this.Ea.ys(a[0]);this.DWc(b);
for(const c of a)this.DWc(c)}}xAj(a){this.DWc(a);if(a.If){a=this.Ea.ix(a);for(const b of a)this.DWc(b)}}}Object(n.a)(gn,"GroupUngroupUndoRedoActionController",null,[1286]);class Sk{l3g(){}Sed(){}N2g(){}n2g(){}X0c(){return!1}}Object(n.a)(Sk,"NoOpTablePartialEditController",null,[1287]);class Qo{constructor(a,b,c,f,l,w){this.Geb=null;this.wi=a;this.Ea=b;this.iic=c;this.Vb=f;this.pa=l;this.Zec=w}l3g(){this.ane()&&this.d0e()}Sed(a){a&&this.ane()&&(a=this.Geb,this.d0e(),this.ozh(a))}N2g(a,b,c,f){this.ane()&&
!this.USj(a,b,c,f)&&this.d0e()}n2g(a,b,c){if(a&&b&&c){this.Geb=null;a=this.pa.Xd();c=new qd.a;b=b.VJ;for(let l=0;l<b.length;++l){var f=b[l];393230===f.Ue&&f.Sa(hb.a.cellId)&&(f=this.Ea.en(f),Array.contains(a,f)&&c.$(f.get_shapeId(),f))}0<c.count&&this.ozh(c.values.ga(0))}}USj(a,b,c,f){let l=!1;b&&this.X0c(a)&&(f=b.yT&&f,l=(c||f)&&b.actionId===a,this.Zec||(l=(b.actionId===a||this.X0c(b.actionId))&&1===this.iic.Oxb(b.r6)||l));return l}X0c(a){let b=a===D.a.gCa||a===D.a.rRa||a===D.a.typing;this.Zec||
(b=a===D.a.CB||a===D.a.enter||b);return b}ozh(a){this.Geb=a}d0e(){if(this.Geb){const a=this.Vb.zi.Bi.hx.id;0!==this.iic.Oxb(a)&&this.iic.FDh(a,!1);this.wi.q7a(this.Geb,!0)}this.Geb=null}ane(){return!!this.Geb}}Object(n.a)(Qo,"TablePartialEditController",null,[1287]);var Jp=d(922);class z{constructor(a,b,c,f){this.xt=a;this.Djk=c;this.ia=f;this.wb()}wb(){this.ia.ra(L.a.iib,nc.a.application,Object(F.a)(this,this.iib,"queryIsShapeTextEditHappened"),96)}iib(a,b,c,f,l){l.oua=this.oua(l.ftc,l.e_j);return 32}lrj(a,
b,c){this.Djk.zxl(new Jp.a(a,b,c))}oua(a,b){let c=!1;a&&(c=!this.xt.r_c()&&a.TFa!==b,this.xt.r_c()||a.TFa!==b||va.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",Object(Ya.a)(4,a)?"Shape":"Notes"));return c}}Object(n.a)(z,"PPTUndoActionBehavior",null,[1464]);class Y extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(n.a)(Y,"OnUndoEventArgs",Sys.EventArgs,[]);
var m=d(729),I=d(136);class X extends m.a{constructor(a=null,b=null,c=null){super(a,b);this.HGd=c||new Pm}ZIb(){super.ZIb();const a=new qj.a,b=new Ua.a;b.add(ia.a.nil);this.rjb.forEach((l,w)=>{b.add(w);a.add(w);return!0});for(this.objects.forEach(l=>{b.add(l);a.add(l);return!0});0<a.length;){var c=a.ga(0);a.C_d(0);var f=this.objects.ga(c)||this.e_.hxb(c);if(f){c=f;f=c.bA();for(let l=0;l<f.length;l++){const w=f[l],H=I.a.N6b(I.a.eZf(w));8===H?this.Jtf(this.HGd.i6f(c,w),a,b):9===H&&this.HGd.qUc(c,w).forEach(U=>
{this.Jtf(U,a,b);return!0})}}else Ba.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}Jtf(a,b,c){c.contains(a)||(c.add(a),this.tlg(a)&&(c=this.e_.hxb(a),this.GGe(c),b.add(a)))}}Object(n.a)(X,"ReferenceFollowingRevisionDiffer",m.a,[]);class ta{uHi(a,b){return new X(a,b)}}Object(n.a)(ta,"UndoDifferFactory",null,[1452]);var Fa=d(287),bb=d(591);class yb{constructor(a,b,c,f,l,w,H){a||Fa.a.argument("revisionStore cannot be null","revisionStore");b||Fa.a.argument("undoRevisionValidator cannot be null",
"undoRevisionValidator");c||Fa.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||Fa.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||Fa.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");w||Fa.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.a0h=a;this.vFc=b;this.eca=c;this.G3h=f;this.vWb=l;this.K3h=w;this.Wef=H}gMc(a,b){const c=this.G3h.uHi(a,b);c.ZIb();const f=new bb.a;f.Y_e(this.vWb,a);c.rjb.forEach((H,
U)=>{f.Aya(U,H);return!0});const l=new qj.a,w=a.KT<b.KT;c.objects.forEach((H,U)=>{if(this.vFc.nlg(U))return!0;if(w&&!this.vFc.Ojg(U)&&!b.K_(H)&&!a.K_(H))return l.add(H),!0;f.vra(U);return!0});0<l.length&&ka.ULS.sendTraceTag(22607311,365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",a.id,b.id,l.Er());this.Wef&&this.Wef.KFl(f);return f.yQc()}vHi(a,b,c,f){b=this.gMc(a,b);if(!b)return null;if(a.id===c.id)return ka.ULS.sendTraceTag(22607312,365,this.eca.y0a()?15:
50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.eca.y0a()),b;a=this.gMc(a,c);if(!a)return null;var l=b;this.vFc.BQf(a)?(ka.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),l=new qj.a,l.add(a),a=new qj.a,a.add(b),l=this.K3h.knk(f,a,l,c.$md).QO.last()):ka.ULS.sendTraceTag(22607314,365,this.eca.y0a()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",
this.eca.y0a());return this.gMc(c,l)}wHi(a,b,c,f,l){let w=null;f||(this.eca.y0a()||!this.eca.IMb()?w=this.gMc(c,b):(ka.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(w=this.vHi(a,b,c,l));return w&&this.Msl(w)?w:null}Msl(a){return this.vFc.BQf(a)?(this.a0h.alb(a),!0):!1}}Object(n.a)(yb,"UndoRevisionManager",null,[1451]);var Bb=d(160);class pb{constructor(a){this.Uif=null;this.Pa=new vc.a;this.Nmb=null;this.Xqb=[];this.L3h=
a}dispose(){for(;0<this.Xqb.length;)this.Yih(this.Xqb[0])}get NK(){return this.Nmb}set NK(a){this.Nmb&&(this.Nmb.isActive=!1);if(this.Nmb=a)this.Nmb.isActive=!0}register(a){if(!this.jla(a)){const b=this.L3h.XIi(a);b.eth(c=>{this.Pa.raiseEvent(pb.sAk,new Y(c))});a.addListener(this);Array.add(this.Xqb,b)}}unregister(a){if(a=this.Qxb(a))a===this.NK&&(this.NK=null),this.Yih(a)}setActive(a){this.NK=this.Qxb(a)}oKc(){const a=this.Qxb(void 0);a&&(a.zoa(void 0),this.xGe())}get SW(){return this.OI?this.NK.SW:
!1}get QZd(){return this.OI?this.NK.QZd:null}get Bka(){return this.OI?this.NK.Bka:!1}get vFa(){return this.OI?this.NK.vFa():!1}P_e(a,b){this.OI&&this.NK.P_e(a,b)}uw(){this.OI&&this.NK.uw()}NW(){return this.OI?this.NK.NW():null}undo(){return this.OI?this.NK.undo():!1}redo(){return this.OI?this.NK.redo():!1}BYa(a,b,c=!1){this.OI&&this.NK.BYa(a,b,c)&&(this.xGe(),this.Uif&&this.Uif())}DJe(){this.OI&&this.NK.DJe()}Yih(a){a.graphSpace.removeListener(this);a.eth(null);a.dispose();Array.remove(this.Xqb,a)}jla(a){return!!this.Qxb(a)}get OI(){return!!this.NK}Qxb(a){for(let b=
0;b<this.Xqb.length;b++){const c=this.Xqb[b];if(c.MKj(a))return c}return null}xGe(){Pc.App.Kb.updateCommandUI()}Cfd(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.Qxb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.Qxb(a);if(b)b.onAfterLoadContent(a);this.NK===b&&(this.NK.SW||this.NK.Bka)&&this.xGe()}onAfterFirstSaveContent(){}}pb.sAk="OnUndo";Object(n.a)(pb,"UndoManager",null,[1462,377,106,1463]);class Ob extends pb{constructor(a,b,c){super(a);this.i8j=b;this.xcd=c;
this.i8j.i$h(Object(F.a)(this,this.Buk,"onFailoverSucceeded"));this.xcd.RPd(Object(F.a)(this,this.Ivk,"onInitialSelectionSet"))}get Gxa(){return this.NK}WMj(a){return this.OI?this.Gxa.sig(a):!1}EVd(){this.OI&&this.Gxa.aui()}a7d(a){return this.OI?this.Gxa.a7d(a):null}ESc(a){return this.OI?this.Gxa.ESc(a):0}d1e(){this.OI&&this.Gxa.d1e()}get SW(){return this.OI?this.Gxa.ozj:!1}zoa(){this.OI&&this.Gxa.zoa(!0)}Buk(a,b){b.iVj&&this.zoa()}Ivk(){this.BYa(D.a.gUa,null)}f5e(a){this.OI&&this.Gxa.f5e(a)}r_c(){return this.OI?
this.Gxa.r_c():!1}Yab(){return this.OI?this.Gxa.Yab():!1}}Object(n.a)(Ob,"PPTUndoManager",pb,[1461,1462,377,106,1463]);class sc{knk(a,b,c,f){return a?a.ndd(b,c,null,f,1,!1,5):null}}Object(n.a)(sc,"PPTUndoRevisionMergeStrategy",null,[1460]);var wc=d(140),Lb=d(48);class $b{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud){this.Yxe=!1;if(Ud&&!Cc)throw Error.argumentNull("viewElementEventNotifier");this.Iqe=a;this.xB=b;this.FUg=c;this.WXa=f;this.qIa=l;this.xfb=w;this.lic=H;this.EJ=Cc;this.h5=
Ud;U===Lb.a.Ez&&(U=Lb.a.Kp);this.pzg=U;this.pa=ja;this.Tb=wa;this.F$j=Sa;this.Vb=eb;this.Fa=ub;this.ia=Ub;this.afc=cc;this.Phc=Fc;this.Fb=Ic}z4k(){this.MFh();if(this.xB){var a=this.Tb.zl(this.xB);a&&this.F$j.Ba!==a&&(this.Vb.Ba=a)}if(this.afc){if(this.WXa&&0<this.WXa.length){a=[];for(const b of this.WXa){let c=this.Tb.zl(b);c&&a.push(c)}if(0<a.length){let b;(b=this.pa).MR.apply(b,a)}}this.ia.processAction(L.a.M_a,2)}this.h5&&this.EJ&&this.EJ.nfh()}QU(a=!1,b=null){this.z4k();if(this.Yxe||this.jhg())return this.Yxe=
!1,null;b||(b=this.Wsb());this.setSelection(a,b);return b}Wsb(){let a=null;if(0<this.xfb.length){const b=this.Tb.zl(this.xB);if(b){const c=[];for(const f of this.xfb){if(!f)continue;const l=b.lT(f);if(l){const w=l.ng(this.Fb.Ma);w&&!w.pLb&&c.push(Od.SelectionFactory.wl(l))}}0<c.length&&(a=new wc.SelectionCollection(c,c.length-1))}}a||(a=this.Iqe.Wsb(!0));!a&&this.lic&&(a=this.lic.OZf());return a}setSelection(a=!1,b=null){this.Iqe.setSelection(a,b);b&&this.lic&&va.a.J(509445784,816,50,"Selection restore to IP level");
b||this.pzg!==Lb.a.sg?this.Fa.rf(this.pzg):(this.pa.Rh(),this.Fa.Ed())}RIc(){return this.Iqe.RIc()}MFh(){this.xB=this.s4e(this.xB,this.FUg);const a=[];let b=0;for(const c of this.WXa)a.push(this.s4e(c,this.qIa[b++]));this.WXa=a}s4e(a,b){let c=a;a&&N.a.mx(a)&&(a=this.Tb.J6b(b),a||(b=this.Phc.Qkj(b),null!=b&&(a=this.Tb.uEa(b))),a&&(c=a.Cb));return c}aCl(){this.xB=this.s4e(this.xB,this.FUg);this.afc&&this.MFh();if(this.xfb.length&&Array.contains(this.xfb,0)){Array.clear(this.xfb);var a=this.Wsb();if(this.pa.P_(a))for(let b of a)(a=
Object(qa.a)(4,b.Ua.node))&&this.xfb.push(a.get_shapeId())}}kHl(){this.Yxe=this.jhg()}jhg(){const a=this.Tb.zl(this.xB);if(!a)return!1;var b=this.lic?[this.lic.gXd]:this.xfb;for(const c of b)if((b=a.lT(c))&&b.aq)return!0;return!1}}Object(n.a)($b,"PPTUndoSelectionReference",null,[467,1459]);class Oc{constructor(a,b,c,f,l){this.oc=a;this.Ire=b;this.h4c=c;this.gic=f;this.fic=l}OZf(){var a=this.oc.zl(this.Ire);if(!a)return null;a=a.lT(this.h4c);if(!a)return null;a=a.XUc();if(!a)return null;var b=a.sa(Za.a.iza,
0);const c=a.sa(Za.a.Dga,0);if(!this.gic||!this.fic||this.gic.KLa>=b||this.gic.JLa>=c||this.fic.KLa>=b||this.fic.JLa>=c)return null;b=ob.GraphIterator.nb(a.nf(this.gic.KLa,this.gic.JLa));b.rc(14);a=ob.GraphIterator.nb(a.nf(this.fic.KLa,this.fic.JLa));a.rc(14);return Od.SelectionFactory.O1b(b,a)}get gXd(){return this.h4c}}Object(n.a)(Oc,"PPTUndoTableCellSelectionPos",null,[1484]);class md{constructor(a,b,c,f,l,w,H,U){this.Pb=a;this.oc=b;this.cY=c;this.d8j=f;this.Ire=l;this.h4c=w;this.Gbd=H;this.Wik=
U}OZf(){var a=this.oc.zl(this.sAi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.lT(this.gXd),!b)return null;var c=[];switch(this.containerType){case 10:c=this.H5d(b);break;case 16:a=this.Pb.Mc(b);if(!a.Ii()||!a.Ii())return null;if(0>this.KLa||0>this.JLa||this.KLa>=a.currentNode.sa(Za.a.iza,0)||this.JLa>=a.currentNode.sa(Za.a.Dga,0)){this.cY.N_g(a,0,0);c.push(Od.SelectionFactory.uj(a.currentNode,!0));break}this.cY.N_g(a,this.KLa,this.JLa);c=this.H5d(a.currentNode);
break;case 60:c=a.aTa();if(!c)return null;c=this.H5d(c);break;default:return null}return 0<c.length?new wc.SelectionCollection(c,0):null}get gXd(){return this.h4c}H5d(a){const b=[];for(const c of this.hwl){const f=c.l3i(a);f&&b.push(f)}b.length||b.push(Od.SelectionFactory.uj(a,!0));return b}get containerType(){return this.d8j}get sAi(){return this.Ire}get JLa(){return this.Gbd?this.Gbd.JLa:-1}get KLa(){return this.Gbd?this.Gbd.KLa:-1}get hwl(){return this.Wik}}Object(n.a)(md,"PPTUndoTextSelectionPos",
null,[1484]);class zd{constructor(a,b){this.Cik=a;this.Kik=b}get JLa(){return this.Cik}get KLa(){return this.Kik}}Object(n.a)(zd,"TableCellIndex",null,[]);class le{constructor(a,b,c,f,l,w){this.Pb=a;this.Ih=b;this.$dk=c;this.g8j=f;this.Jak=l;this.Iak=w}get contextId(){return this.g8j}get paragraphIndex(){return this.$dk}get v9b(){return this.Jak}get u9b(){return this.Iak}l3i(a){a=this.Pb.Mc(a);if(!a.pbe(this.paragraphIndex)||11!==a.yq.type||!a.Bb(2)||12!==a.yq.type&&21!==a.yq.type||this.v9b>this.u9b||
-1>this.v9b||this.u9b>this.Ih.textLength(a.currentNode))return null;switch(this.contextId){case Cb.a.Of:return Od.SelectionFactory.k3(a.currentNode,this.v9b,this.u9b);case Cb.a.textRange:return Od.SelectionFactory.k3(a.currentNode,this.v9b,this.u9b);case Cb.a.endOfParagraph:return Od.SelectionFactory.Gca(a.currentNode);case Cb.a.paragraph:return Od.SelectionFactory.Fu(Id.a.TQa(this.v9b,this.u9b,!1,a.currentNode))}return null}}Object(n.a)(le,"TextContextRecord",null,[]);class df{constructor(a,b,c,
f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){if(Fc&&!cc)throw Error.argumentNull("viewElementEventNotifier");this.z7j=a;this.pa=b;this.nAg=c;this.Vb=f;this.Pb=l;this.Fa=w;this.oc=H;this.Ea=U;this.Ih=ja;this.cY=wa;this.ia=Sa;this.afc=eb;this.Phc=ub;this.Fb=Ub;this.EJ=cc;this.h5=Fc}ksa(){const a=this.z7j.ksa();let b=null,c=ia.a.nil;const f=this.nAg.Ba;f&&(b=f.Cb,c=f.id);const l=[],w=[];if(this.afc){var H=this.pa.Qe();for(var U of H)l.push(U.Cb),w.push(U.id)}H=[];U=null;f&&(this.pa.gH()&&this.LTk(H),this.pa.Zz()&&
(U=this.QTk(b)));return new $b(a,b,c,l,w,H,U,this.Fa.m8,this.pa,this.oc,this.nAg,this.Vb,this.Fa,this.ia,this.afc,this.Phc,this.Fb,this.EJ,this.h5)}C_c(a){return 10===a.type||60===a.type||16===a.type}LTk(a){const b=this.pa.Xd();for(const c of b)a.push(c.get_shapeId())}QTk(a){return this.pa.Na.mb.mg?this.OTk(a):this.PTk(this.pa.Na,a)}PTk(a,b){var c=Object(qa.a)(5,a.mb.Ua.node),f=this.Pb.Mc(c);if(f.G6(Object(F.a)(this,this.C_c,"isOEContainerNode")))if(f.zc()&&11===f.currentNode.type){if(f.zc()){c=(c=
this.Ea.oda(c))?c.get_shapeId():0;const l=f.yq.type;f=16===l?this.qae(Object(qa.a)(125,f.yq)):null;const w=a.mb,H=[];this.rxf(w,H);for(let U of a)U!==w&&this.Ggi(U,w)&&this.rxf(U,H);return new md(this.Pb,this.oc,this.cY,l,b,c,f,H)}}else va.a.J(509445783,816,15,"Find text selection but its container is not OutlineElement");return null}OTk(a){var b=this.pa.Na.ga(0),c=this.pa.Na.last,f=b.mg;b=16===f.Ua.node.type?this.qae(Object(qa.a)(125,f.Ua.node)):null;f=c.mg;c=16===f.Ye.node.type?this.qae(Object(qa.a)(125,
f.Ye.node)):null;f=(f=this.Ea.oda(f.Ua.node))?f.get_shapeId():0;return new Oc(this.oc,a,f,b,c)}qae(a){return a?new zd(a.ui,a.rowIndex):null}rxf(a,b){for(let c of a){if(!Object(Ya.a)(102,c.node))continue;a=this.Pb.Mc(c.node);if(!a.G6(Object(F.a)(this,this.C_c,"isOEContainerNode")))continue;a.zc();const f=a.currentNode;a.zc();a=a.GSa(f);b.push(new le(this.Pb,this.Ih,a,c.contextId,c.Qa,c.Lb))}}Ggi(a,b){a=this.Pb.Mc(a.Ua.node);b=this.Pb.Mc(b.Ua.node);return a.G6(Object(F.a)(this,this.C_c,"isOEContainerNode"))&&
b.G6(Object(F.a)(this,this.C_c,"isOEContainerNode"))&&a.zc()&&11===a.currentNode.type&&b.zc()&&11===b.currentNode.type&&a.zc()&&b.zc()?a.currentNode===b.currentNode:!1}}Object(n.a)(df,"PPTUndoSelectionReferenceFactory",null,[439]);class bf{constructor(){this.CWa=this.BTg=this.LBe=this.hXg=null;this.I7c=!1;this.BDe=null}p4e(){if(!this.CWa.tzb&&this.CWa.V1c)for(const a of this.CWa.V1c)if(a.equals(this.hXg)){this.LBe.QU(!1,this.BTg);va.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.BDe);this.CWa.Ooc(Object(F.a)(this,this.p4e,"trySetSelectionWhenServerUndoRedoFinish"));this.I7c=!0;break}}NWk(a,b,c,f){a&&(this.hXg=b,this.BTg=f,(this.LBe=Object(qa.a)(1459,c))?(this.Q4e(),this.BDe=new Date,this.CWa=a,this.CWa.UGc(Object(F.a)(this,this.p4e,"trySetSelectionWhenServerUndoRedoFinish")),this.I7c=!1):va.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}Q4e(){this.CWa&&!this.I7c&&(va.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.BDe),this.CWa.Ooc(Object(F.a)(this,this.p4e,"trySetSelectionWhenServerUndoRedoFinish")),this.I7c=!0)}}Object(n.a)(bf,"PPTUndoSelectionRestoreExecutor",null,[1285]);class Hg{constructor(){this.rik=new qd.a(!1);this.Gjk=new qd.a(!1);this.vHg=new qd.a(!1);this.init()}init(){this.yEj()}yEj(){this.vHg.add(L.a.zI,!0)}GCi(a){return a&&this.rik.Gb(a)?!0:!1}FCi(a){return a&&this.Gjk.Gb(a)?!1:!0}Hjl(a){return a&&this.vHg.Gb(a)?!0:!1}}Object(n.a)(Hg,"PPTUndoSettings",null,[1458]);class Yh{constructor(a){this.Dj=
null;this.J9e=a}start(a){this.Dj=a}azj(){var a=new Date;return this.J9e?+a-+this.Dj>this.J9e:!1}}Object(n.a)(Yh,"UndoTimer",null,[1483]);var Hi=d(480),kf=d(521);class ej{constructor(a){this.xba=this.N2=null;this.qvb=this.usc=a}get usc(){return this.N2}set usc(a){this.N2&&(this.N2.XO&=-2);this.N2=a;this.N2.XO|=1}get qvb(){return this.xba}set qvb(a){this.xba&&(this.xba.XO&=-3);this.xba=a;this.xba.XO|=2}get r6(){return this.N2?this.N2.id:ia.a.nil}get Q1d(){return this.xba?this.xba.id:ia.a.nil}get VJ(){return this.N2?
this.N2.oqg():[]}combineWithPrevious(){}dispose(){this.N2&&(this.N2.XO&=-2);this.xba&&(this.xba.XO&=-3)}}Object(n.a)(ej,"Box4UndoRecordData",null,[1492,106]);class wi{constructor(a,b,c,f,l,w){this.pya=a;this.Fjb=b;this.H3h=c;this.actionId=f;this.yT=l;this.EKa=w}get Q1(){return this.H3h}get r6(){return this.Q1.r6}dispose(){this.Q1&&this.Q1.dispose()}}Object(n.a)(wi,"UndoRecord",null,[106]);class Qg{constructor(){this.hra=[]}ga(a){return this.hra[a]}get length(){return this.hra.length}add(a){this.hra.push(a)}clear(){for(let a=
0;a<this.hra.length;a++)this.hra[a].dispose();Array.clear(this.hra)}remove(a){const b=Array.remove(this.hra,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.hra.length&&(this.hra[a].dispose(),Array.removeAt(this.hra,a))}}Object(n.a)(Qg,"UndoRecordsArray",null,[]);class Jk{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af){this.g5a=!0;this.z3a=this.Bdf=this.oAc=this.nqb=!1;this.fob=null;this.zHd=this.jkf=0;this.bOd=null;this.opf=!0;this.isActive=!1;this.Mz=a;this.Vyd=b;this.zWh=
c;this.$Bd=f;this.I4h=l;this.MYh=w;this.Bk=H;this.YH=U;this.dnf=ja;this.x0h=wa;this.$d=Sa;this.y3h=eb;this.H0h=ub;this.rmf=Ub;this.I3h=Fc;this.Qqf=Ic;this.M3h=Cc;this.Sqf=Ud;this.eca=je;this.Sy=Ve;this.Qg=new Qg;this.rs=this.sh=-1;this.Lef=Object(F.a)(this,this.SKf,"createInitialUndoRecord");this.EDc=cc;this.EDc.Gbi(Object(F.a)(this,this.Xih,"removeUndoRecordForRevision"));this.opf=af}dispose(){this.Lef=null;this.oKc();this.Mz=null;this.EDc.f0k(Object(F.a)(this,this.Xih,"removeUndoRecordForRevision"))}get graphSpace(){return this.Mz}get anc(){return this.zWh.value}MKj(a){return this.Mz===
a?!0:!1}oKc(){this.Qg.clear();this.rs=this.sh=-1;this.g5a=!0}zui(){if(this.sh===this.Qg.length-1)this.oKc();else{let a=0;for(;a<this.sh;)this.Qg.removeAt(0),a++;this.sh=0;this.rs=1}}get SW(){return 0<this.sh}get QZd(){return this.SW?this.Qg.ga(this.sh).actionId:null}get RZd(){return 0<=this.sh&&this.sh<this.Qg.length?this.Qg.ga(this.sh).Q1:null}P_e(a,b){this.z3a?(this.mtc(),this.zoa()):(this.rmf&&this.anc.suspend(),this.z3a=!0,this.fob=a,this.jkf=b,this.zHd=0)}mtc(){this.z3a=!1;this.rmf&&this.anc.resume()}ECl(){this.H0h(new ia.a(this.fob,
1));this.mtc()}BYa(a,b,c=!1){if(!this.Vyd()||a===D.a.gUa&&this.Qg.length)return!1;var f=this.Mz.oT();if(!f&&a!==D.a.gUa&&!c||!this.Mz||!this.Mz.Bi)return!1;f&&(this.Bdf||(ka.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.Bdf=!0),this.$Bd.execute(w=>{w.s1d()}));if(this.z3a){ka.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.fob);this.mtc();for(c=this.Qg.length-2;0<=c;c--)this.Qg.removeAt(c);this.sh=0;this.rs=-1}c=this.NW();f=
this.yMc(f,a);this.Tub();b=this.Gwi(a,f,b);const l=this.eca.IMb()&&!this.eca.y0a();a=new wi(b,c,f,a,this.nqb,l);this.Qg.add(a);this.sh=this.Qg.length-1;return!0}yMc(a,b){return this.I3h(a,b)}Gwi(a,b,c){if(0<=this.sh){switch(a){case D.a.gCa:case D.a.rRa:case D.a.typing:this.g5a&&this.Qg.ga(this.sh).actionId===a?(a=this.Qg.ga(this.sh),c=a.pya,b.combineWithPrevious(a.Q1),this.Qg.removeAt(this.sh)):u.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.y3h.create(a),b.end(32),this.I4h.ooc(b),
this.MYh.noc(b))}this.g5a=!0}return c}DJe(){this.M3h(this)}SNi(){this.opf&&!this.g5a||!this.eca.IMb()||(this.g5a=!1,this.nqb=!0)}Elk(){if(this.eca.y0a())for(let a=0;a<this.Qg.length;a++)this.Qg.ga(a).EKa=!0}Tub(){if(this.sh<this.Qg.length-1){for(let a=this.Qg.length-1;a>this.sh;a--)this.Qg.removeAt(a);this.rs=-1}}MGl(){var a=Bb.ObjectSpace.J8(this.Mz.Bi);a=new ej(a);const b=this.NW(),c=this.Qg.ga(this.sh).pya;a=new wi(c,b,a,D.a.Sud,this.Qg.ga(this.sh).yT,this.Qg.ga(this.sh).EKa);this.Qg.removeAt(this.Qg.length-
1);this.Qg.add(a)}cib(a,b,c,f){return a.cib(b,c,f)}ZKe(a,b,c){this.oAc=!0;a.Aoe();this.oAc=!1;b.QU(void 0,c)}undo(){if(!this.SW)return!1;this.$Bd.execute(wa=>{wa.s1d()});var a=!0;let b=!1;var c=!1;const f=this.Bk.oe(7);f.kd(this.Mz);let l=0,w=!1,H=this.NW(),U=null;const ja=this.Qqf(!0);for(this.Sqf.start(new Date);this.SW&&a;){const wa=this.Qg.ga(this.sh),Sa=this.Qg.ga(this.sh-1);a=wa.yT&&Sa.yT;ka.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,kf.a[this.Sy]);
this.rs=this.sh;try{if(b=this.cib(ja,wa.Q1,Sa.Q1,wa.EKa||Sa.EKa))H=this.Qg.ga(this.sh).pya,U=this.Qg.ga(this.rs).Fjb,this.bOd&&this.bOd(this.Qg.ga(this.sh).actionId)}catch(eb){ka.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",eb.message,eb.stack),b=!1,c=!0}l++;b?this.sh--:(ka.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,kf.a[this.Sy]),this.zui(),a=!1);if(this.Sqf.azj()){w=!0;break}}b&&this.ZKe(ja,H,null,U,!0);f.dispose();this.uw();
this.z3a&&(this.ECl(),this.Tub());this.YH.updateCommandUI();this.dnf.zaa();if(0<this.sh&&w&&this.Qg.ga(this.sh).yT){a=this.sh;for(c=0;0<a&&this.Qg.ga(a).yT;)c++,a--;this.Qg.ga(this.sh).yT=!1;ka.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&ka.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}uw(){this.nqb=this.g5a=!1}get Bka(){return 0<this.rs}redo(){if(!this.Bka)return!1;
this.$Bd.execute(H=>{H.s1d()});var a=!0;let b=!1,c=!1;const f=this.Bk.oe(7);f.kd(this.Mz);let l=this.NW();const w=this.Qqf(!1);for(;this.Bka&&a;){a=this.Qg.ga(this.rs);const H=this.Qg.ga(this.sh);ka.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Qg.ga(this.rs).yT&&this.Qg.ga(this.sh).yT,kf.a[this.Sy]);try{if(b=this.cib(w,a.Q1,H.Q1,a.EKa||H.EKa))l=this.Qg.ga(this.rs).Fjb}catch(U){ka.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
U.message,U.stack),b=!1,c=!0}b?(this.sh=this.rs,this.rs<this.Qg.length-1?(this.rs++,a=this.Qg.ga(this.rs).yT&&this.Qg.ga(this.sh).yT):(this.rs=-1,a=!1)):(ka.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,kf.a[this.Sy]),this.zoa(),a=!1)}b&&this.ZKe(w,l,null,null,!1);f.dispose();this.uw();this.YH.updateCommandUI();this.dnf.zaa();return b}NW(){return this.Vyd()?this.x0h.ksa():null}dMk(a){return this.z3a&&gh.a.compare(a.Bq,this.fob)?(ka.ULS.sendTraceTag(512362002,
365,50,"Incremental Action in progress"),this.MGl(),this.zHd=a.n,this.zHd===this.jkf&&(ka.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.fob),this.mtc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.oAc&&!this.dMk(a.Bi.hx.id))if(this.z3a&&(ka.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.fob,this.Mz.Bi.hx.id),this.mtc()),!this.eca.IMb())this.zoa();else if(this.Bka||this.SW)this.SNi(),
this.Elk()}zoa(a=!1){this.oKc();a?this.SKf(null):(a=new Le.a(2,1,0,this.Lef,50),this.$d.Db(a))}Xih(a,b){if(b&&(1===(b.XO&1)||2===(b.XO&2))){a=this.Bka;const f=this.SW;for(var c=this.Qg.length-1;0<=c;c--){const l=Object(qa.a)(ej,this.Qg.ga(c).Q1);!l||l.usc!==b&&l.qvb!==b||(this.Qg.removeAt(c),-1!==this.sh&&this.sh--,-1!==this.rs&&this.rs--)}b=this.Bka;c=this.SW;!this.isActive||a===b&&f===c||(ka.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,
c),this.YH.updateCommandUI())}}SKf(){this.Vyd()&&this.BYa(D.a.gUa,this.NW())}vFa(){return this.oAc}eth(a){this.bOd=a}}Object(n.a)(Jk,"UndoStack",null,[1494,106]);var km=d(801);class Am extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(n.a)(Am,"RevisionStateArgs",Sys.EventArgs,[]);class ep{constructor(a,b,c,f,l,w){this.pya=a;this.Fjb=b;this.r6=c;this.actionId=f;this.yT=l;this.EKa=w}}Object(n.a)(ep,"PPTLocalUndoRecord",null,[]);class Go extends Jk{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,
eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di,Si,rj,sg,Cg){super(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,Ug,sg,4,Cg);this.Z7c=!1;this.Kgc=-1;this.bM=[];this.qU=je;this.DAe=Vd;this.BAe=Ve;this.Pb=af;this.la=Zf;this.ana=lg;this.Fa=Tg;this.BWa=ag;this.BWa.zvf(Object(F.a)(this,this.CHb,"onRevisionProcessed"));this.Qfb=ih;this.pa=Vg;this.ADe=di;this.dGg=Si;this.iXg=rj;this.aIg=Ug.IMb()&&!Ug.y0a()}BYa(a,b,c=!1){let f=!1;b=this.iXg.gHl(b);var l=this.sh;this.DAe.Hjl(a)?f=this.Rlk(a,
b):this.DAe.FCi(a)?(f=this.Tpi(a,b,c))&&this.mAl(a):this.zoa();b=null;f?(l=this.sh-l,b=this.e7b(this.sh),this.vTk(b,!l),this.Yab()||this.r2d()):this.iXg.HIj();l=null;this.la.designerSendActionDuration&&b&&b.Q1&&b.Q1.Q1d!==ia.a.nil&&(l=b.Q1.Q1d);this.BAe.lrj(a,f,l);return f}yMc(a,b){const c=0<=this.sh?this.Qg.ga(this.sh):null;this.Qfb.N2g(b,c,this.g5a,this.nqb);b=super.yMc(a,b);this.Qfb.n2g(c,b,a);return b}sig(a){let b=!1,c=null;a&&this.SW?c=this.Qg.ga(this.sh):!a&&this.Bka&&(c=this.Qg.ga(this.rs));
c&&(b=this.g_c(c.r6));return b&&this.Yab()}cib(a,b,c,f){let l=!1;if(this.sig(a.Ebb))(l=super.cib(a,b,c,f))&&this.Llk(a.tla);else{const w=a.Ebb?2:3;l=a.Rdh(H=>{this.qU.DIh(H,w)});this.zlk(a.tla);this.BWa.bld(new Am(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.Z7c&&this.BWa.bld(new Am(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.Z7c&&(this.BWa.bld(new Am(3)),this.Z7c=!1)}dispose(){this.BWa.Mjh(Object(F.a)(this,this.CHb,"onRevisionProcessed"));super.dispose()}ZKe(a,
b,c,f,l){a&&a.tla!=ia.a.nil&&(this.dGg&&(f&&this.PIh(f),b&&this.PIh(b)),0<this.bM.length&&(f=new ep(this.NW(),b,a.tla,l?L.a.GZa:L.a.FZa,!1,this.aIg),Array.add(this.bM,f)),a.Aoe(),b&&0<this.bM.length?b.QU(void 0,c):(Rc.a.Ib&&(Rc.a.Tfa(Rc.a.Ib),Rc.a.Ib.SB(Bh.a.FY,Rc.a.h$a(a.tla.toString()).toString())),this.dGg&&(f=Object(qa.a)(137,this.Mz.contentReplicator))&&b&&this.ADe.NWk(f,a.tla,b,c)))}CHb(a,b){b&&(!(a=b.MH)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.Z7c=!0,this.la.xig||(b=2===a.RevisionSource?
Object(qa.a)(1459,this.Qg.ga(0<this.rs?this.rs:this.Qg.length-1).pya):Object(qa.a)(1459,this.Qg.ga(this.sh).Fjb))&&b.kHl(),this.pTi(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.BWa.bld(new Am(1))))}pTi(a,b,c,f){a!==this.sh&&va.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.sh);if(a<this.sh||f){do this.Qg.removeAt(this.sh--);while(this.sh>a);this.rs=0<this.rs?this.sh+1:-1;this.ADe.Q4e()}if(!(0>this.rs)&&
(b!==this.Qg.length-this.rs&&va.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Qg.length-this.rs),b<this.Qg.length-this.rs||c)){do this.Qg.removeAt(this.rs);while(this.Qg.length-this.rs>b);if(!b||this.rs>=this.Qg.length)this.rs=-1;this.ADe.Q4e()}}PIh(a){(a=Object(qa.a)(1459,a))&&a.aCl()}aui(){if(this.la.Mzb&&this.bM.length){var a=this.e7b(this.sh);if(a){var b=a.pya;if(this.g_c(a.r6)){for(let c=this.sh-1;0<c;c--){const f=this.e7b(c);if(!f)break;if(this.g_c(f.r6))b=
f.pya,this.Qg.removeAt(c),this.sh--;else break}this.Tub()}else this.Qg.add(a),this.sh++,this.rs=-1;a.pya=b;a.yT=!1;this.Gmd();this.r2d()}else this.Tub(),this.Gmd()}}d1e(){if(this.la.Mzb){var a=this.e7b(this.sh);if(a){if(0<(-1===this.Kgc?0:this.Qg.length-this.Kgc)){for(var b=this.Qg.length-1;b>=this.Kgc;b--)this.Qg.removeAt(b);for(b=0;0<=b&&b<this.bM.length;){var c=b;let f=!0;for(;f&&b<this.bM.length;)b<this.bM.length-1?(f=this.bM[b].yT&&this.bM[b+1].yT,b++):(f=!1,b=-1);c=this.bM[c];this.Qg.add(new wi(c.pya,
this.bM[0>b?this.bM.length-1:b-1].Fjb,a.Q1,c.actionId,!1,c.EKa))}this.sh=this.Qg.length-1}this.rs=-1;this.Gmd();this.r2d()}else this.Tub(),this.Gmd()}}get ozj(){if(this.la.Mzb&&this.Yab()){const a=this.e7b(this.sh);if(!a||0<this.bM.length&&!this.g_c(a.r6))return!1}return this.SW}r2d(){var a=this.la.Hmk;if(this.sh>a){var b=0;for(a=this.sh-a-1;0<=a;a--)this.Qg.removeAt(a),b++;this.sh-=b;b=this.rs-b;this.rs=0<b?b:-1}}Tpi(a,b,c){const f=0<=this.sh?this.Qg.ga(this.sh):null;this.nqb=!!f&&this.Qfb.X0c(a)&&
f.actionId===a&&this.nqb;return super.BYa(a,b,c)}vTk(a,b){this.la.Mzb&&a&&(this.Yab()||this.DAe.GCi(a.actionId))&&(this.bM.length||(this.Kgc=this.sh),b&&Array.removeAt(this.bM,this.bM.length-1),Array.add(this.bM,new ep(a.pya,a.Fjb,a.r6,a.actionId,a.yT,a.EKa)))}e7b(a){return 0<a&&a<=this.sh?this.Qg.ga(a):null}a7d(a){a=a?this.sh:this.rs;return 0<=a&&a<this.Qg.length?this.Qg.ga(a).Q1:null}ESc(a){a=a?this.sh:this.rs;return 0<=a&&a<this.Qg.length?this.Qg.ga(a).actionId:0}Gmd(){Array.clear(this.bM);this.Kgc=
-1}Yab(){const a=this.Fa.Ae;return a?a.name!==Lb.a.sg&&a.name!==Lb.a.Ana&&a.name!==Lb.a.QR&&a.name!==Lb.a.hza&&a.name!==Lb.a.ZO||!this.pa.Zz()||this.YLj()?!1:!0:!1}alb(a){Bb.ObjectSpace.K3(this.graphSpace.Bi,!1).alb(a)}mAl(a){this.la.Mzb||this.lAl(a);this.kAl(a)}lAl(a){if(1<=this.sh&&this.qog(a)){const b=this.sh-1,c=this.Qg.ga(b),f=c.actionId;f!==a&&!this.qog(f)||1!==this.ana.Oxb(c.r6)||(this.Qg.removeAt(b),this.sh=this.Qg.length-1)}}kAl(a){if(1<=this.sh&&this.BKj(a)){const b=this.sh-1,c=this.Qg.ga(b).actionId;
if(c===a||this.gNj(c))this.Qg.removeAt(b),this.sh=this.Qg.length-1}}qog(a){return a===D.a.CB||a===D.a.gCa||a===D.a.rRa||a===D.a.typing||a===D.a.enter}gNj(a){return a===L.a.ZBa||a===L.a.Xhd}BKj(a){return a===L.a.Wrb||a===L.a.Rlc||a===L.a.hIb}Rlk(a,b){const c=this.yMc(this.Mz.oT(),a);this.Tub();a=new wi(b,null,c,a,!1,this.aIg);this.Qg.add(a);this.sh=this.Qg.length-1;return!0}Llk(a){let b=null;this.pa.fla()?b=this.pa.X6f():this.pa.Zz()&&(b=this.pa.kp());b&&this.BWa.Rfh(new km.a(b,a))}zlk(a){const b=
this.Pb.Mc(this.graphSpace);b.Bb(80);Object(qa.a)(532,b.yq).isDirty=!0;this.BWa.Rfh(new km.a(b.currentNode,a))}f5e(a){0>this.sh||(this.Qg.ga(this.sh).Fjb=a)}r_c(){return!this.bM.length}g_c(a){for(const b of this.bM)if(b.r6===a)return!0;return!1}YLj(){for(const a of this.pa.Xd())if(a.eb(hb.a.clearFormatting))return!0;return!1}}Object(n.a)(Go,"PPTUndoStack",Jk,[]);class fp{constructor(a){this.Ejk=a}XIi(a){const b=this.Ejk.jMf(a);return new Go(a,()=>!!na.InteractiveViewManager.instance.Qd,new kc.a(()=>
Pc.App.XR),Ab.a.instance.Ja("Common.Interface.IEditNotificationManager"),If.a.getInstance(),mj.a.getInstance(),Ab.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ab.a.instance.resolve("Box4.IAppFrame"),Ab.a.instance.resolve("Box4.IReplicationScheduler"),Ab.a.instance.resolve("Box4.ISelectionReferenceFactory"),Ab.a.instance.resolve("Common.ITaskManager"),Ab.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},R.a.instance.ga(70),Hi.a.instance,b.mGh,b.nGh,b.rGh,new Yh(Pc.App.xEf),
Ab.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Ab.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),Ab.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),Ab.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),Ab.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),Ab.a.instance.resolve("Common.IFocusManager"),Ab.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
Ab.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Ab.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),Ab.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,Ab.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
Ab.a.instance.ke("Box4.ICoauthCashTelemetry"),Object(Pd.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(n.a)(fp,"PPTUndoStackFactory",null,[1457]);class Gp{constructor(){this.G4c=new vc.a}zxl(a){this.G4c.raiseEvent("MU",a)}UYb(a){this.G4c.addHandler("MU",a)}BRe(a){this.G4c.removeHandler("MU",a)}dispose(){this.G4c.dispose()}}Object(n.a)(Gp,"UndoEventSource",null,[1454,1455,1456,106]);class Hp{constructor(a,b){this.Yfb=0;this.Bad=null;this.Wxe=!1;this.xt=a;this.Qk=b;this.Qk.Muf(Object(F.a)(this,
this.M2g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Qk.Luf(Object(F.a)(this,this.zfd,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.Qk.ejh(Object(F.a)(this,this.M2g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Qk.KZk(Object(F.a)(this,this.zfd,"onForceOutboundGraphTransactionDisposed"))}gHl(a){return 1===this.Yfb&&this.Bad?this.Bad:a}HIj(){1===this.Yfb&&(this.Wxe=!0)}M2g(a,b){this.sog(b.transaction.wza)&&(this.Yfb+=1,1===this.Yfb&&(this.Bad=this.xt.NW()))}zfd(a,
b){this.sog(b.transaction.wza)&&(1===this.Yfb&&(this.Bad=null,this.Wxe||(a=this.xt.NW(),this.xt.f5e(a)),this.Wxe=!1),--this.Yfb)}sog(a){return 8===(a&8)}}Object(n.a)(Hp,"UndoSelectionUpdater",null,[1288,106]);var $l=d(596);class co{constructor(a,b,c){this.Mz=a;this.eFd=b;this.xNd=c;this.uZ=Bb.ObjectSpace.J8(this.Mz.Bi)}cib(a,b,c){a=this.xNd.wHi(this.eFd?a.usc:b.qvb,this.eFd?b.qvb:a.usc,this.uZ,c,Pc.App.VLa);if(b=!!a)this.uZ=a;return b}Rdh(a){const b=new bb.a;b.Y_e(this.Mz.Bi,this.uZ);a(b);a=b.yQc();
Bb.ObjectSpace.K3(this.Mz.Bi,!1).alb(a);this.uZ=a;return!!a}Aoe(){const a=new $l.a(Bb.ObjectSpace.J8(this.Mz.Bi),this.uZ);this.Mz.hBb(a)}get Ebb(){return this.eFd}get tla(){return this.uZ.id}}Object(n.a)(co,"Box4UndoRedoPerformer",null,[1491]);class aq{constructor(a,b){this.mGh=c=>{c&&this.Mz.bga();c=Bb.ObjectSpace.J8(this.Mz.Bi);return new ej(c)};this.nGh=c=>new co(this.Mz,c,this.xNd);this.rGh=c=>{if(c.RZd&&(this.Mz.oT()&&this.Mz.bga(),c.RZd&&(c=c.RZd))){var f=Bb.ObjectSpace.J8(this.Mz.Bi);c.qvb=
f}};this.Mz=a;this.xNd=b}}Object(n.a)(aq,"Box4UndoStackDataSyncHelper",null,[1482]);class eo{constructor(a){this.J3h=a}jMf(a){return new aq(a,this.J3h(a.Bi))}}Object(n.a)(eo,"Box4UndoStackDataSyncHelperFactory",null,[1450]);class Ui{constructor(a,b,c){this.kfb=[];this.WFb=a;this.ead=b;this.bgc=c}get r6(){return this.ead}get Q1d(){return this.ead}get VJ(){return this.kfb}perform(){try{if(this.WFb){const a=this.WFb.perform();this.WFb=a.undoOperation;this.kfb=h(a.NVc,this.bgc);return a}}catch(a){ka.ULS.sendTraceTag(0,
844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.WFb&&this.WFb.combineWithPrevious(a.WFb)}dispose(){}}Object(n.a)(Ui,"FluidUndoRecordData",null,[1492,106]);class nt{constructor(a,b){this.fec=[];this.qdb=a;this.Vbk=b}cib(a){return a?(a=a.perform(),this.ddh(a)):!1}Rdh(a){const b=this.qdb.Bi.zPi.ULc();b.start(this.qdb.Bi);a(b);a=b.finish();return this.ddh(a)}Aoe(){this.fec.forEach(a=>{this.qdb.hBb(a)})}get Ebb(){return this.Vbk}get tla(){return 0<this.fec.length?
this.fec[this.fec.length-1].sla:ia.a.nil}ddh(a){return a?(a.NVc&&this.fec.push(...a.NVc),!0):!1}}Object(n.a)(nt,"FluidUndoRedoPerformer",null,[1491]);class is{constructor(a){this.mGh=b=>{var c,f;let l=null;b&&(l=this.qdb.bga());return new Ui(null!==(c=null===l||void 0===l?void 0:l.undoOperation)&&void 0!==c?c:null,null!==(f=null===l||void 0===l?void 0:l.revisionId)&&void 0!==f?f:ia.a.nil,this.qdb.Bi)};this.nGh=b=>new nt(this.qdb,b);this.rGh=()=>{};this.qdb=a}}Object(n.a)(is,"FluidUndoStackDataSyncHelper",
null,[1482]);class nr{jMf(a){return new is(a)}}Object(n.a)(nr,"FluidUndoStackDataSyncHelperFactory",null,[1450]);class Kp{constructor(a){this.qU=a}KFl(a){this.qU.DIh(a,1);this.qU.UGl(a)}}Object(n.a)(Kp,"PPTInverseRevisionUpdater",null,[1336]);class Yi{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}Zb(a){this.K=a;a.register(Mn,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();a.register(Po,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().oa(()=>
new Po(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(439,"Box4.ISelectionReferenceFactory").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new df(fn.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.HC,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),b.Ln):fn.SelectionReferenceFactory.instance});a.register(sc,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();
a.register(Hg,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").VCa?a.register(nr,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(eo,"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().oa(()=>new eo(b=>new yb(Bb.ObjectSpace.K3(b,a.resolve("PowerPointWebEditor.IApplicationSettings").VCa),
a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new ta,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new Kp(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(fp,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().oa(()=>new fp(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(z,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().oa(()=>
new z(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(Ob,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().oa(()=>new Ob(a.resolve("Box4.UndoRedo.IUndoStackFactory"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1285,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().oa(()=>new bf);a.register(Gp,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.Bzi(a);this.Fzi(a);a.register(1286,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().oa(()=>
new gn(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}Bzi(a){a.register(1287,"PowerPointWebEditor.ITablePartialEditController").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.cXj?new Qo(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.Mzb):new Sk})}Fzi(a){a.register(1288,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().oa(()=>new Hp(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");
var b=this.K.resolve("Box4.IPageView");b.xg&&(b=b.xg.Oo(),a.register(b),a.setActive(b),a.BYa(D.a.gUa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){v.a.instance.Dc(new Yi)}}Object(n.a)(Yi,"PPTWebEditorUndoRedoPackage",null,[2,3]);class Ul{constructor(a=!1,b,c=!1,f=!1,l=!1,w=!1,H=!1){this.NUa=a;this.cle=c;this.O$a=f;this.R9b=l;this.W9b=w;this.KZc=H}}Object(n.a)(Ul,
"DocModeSwitcherData",null,[]);var jn=d(854);class js{constructor(a,b,c,f,l){this.cDb=!1;this.UAe=null;this.TDd=this.hFd=this.tEd=this.DEd=this.wEd=this.REd=this.mEd=this.UEd=this.AAa=this.cEd=this.jEd=this.AEd=this.ZDd=this.sEd=this.zff=!1;this.mc=a;this.gl=b;this.Oc=c;this.Mv=l;this.JCg=f.zPj;this.rva=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.Tdb=f.vmg;this.lgk=u.AFrameworkApplication.$z;this.reset()}initialize(){this.Oc.S7(Object(F.a)(this,this.Hw,"onUnifiedAppStateChanged"));this.Oc.GPa(Object(F.a)(this,
this.Ikc,"onOutboundReplication"));this.UAe=[Object(F.a)(this,this.Qsi,"checkIsInlineRepairedDocument"),Object(F.a)(this,this.Nsi,"checkIrmProtection"),Object(F.a)(this,this.sti,"checkUserPermission"),Object(F.a)(this,this.osi,"checkFileFormats"),Object(F.a)(this,this.psi,"checkFileLock"),Object(F.a)(this,this.Zsi,"checkPasswordProtection"),Object(F.a)(this,this.rsi,"checkFontRestriction"),Object(F.a)(this,this.Rsi,"checkIsMarkedFinal"),Object(F.a)(this,this.Ssi,"checkIsMarkedReadOnlyRecommended"),
Object(F.a)(this,this.dti,"checkSessionRestriction"),Object(F.a)(this,this.cti,"checkSessionAccessTokenExpired"),Object(F.a)(this,this.Wsi,"checkNetworkIssueHappened"),Object(F.a)(this,this.$si,"checkPopsHostIssueHappened"),Object(F.a)(this,this.zti,"checkWopiAccessTokenOutOfRefreshRange"),Object(F.a)(this,this.Psi,"checkIsEmergencyViewMode")];this.vnh(this.UAe)}dispose(){this.Oc.Vib(Object(F.a)(this,this.Hw,"onUnifiedAppStateChanged"))}reset(){this.TDd=this.jEd=this.hFd=this.tEd=this.DEd=this.wEd=
this.REd=this.mEd=this.UEd=this.cEd=this.AEd=this.AAa=this.ZDd=this.sEd=this.zff=!1}Hw(a,b){va.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.Jab&&this.mc.In||(this.gl.QPf(),this.vnh(this.UAe))}Ikc(){this.rva&&!this.cDb&&(this.cDb=!0);this.mc.BL||va.a.J(38633602,801,15,"Outbound on RO mode")}vnh(a){if(a)for(const b of a)if(b())break}osi(){if(this.oOj||!this.mc.gg(64)||this.JCg&&!(this.mc.gg(4)&&this.mc.gg(16)&&this.mc.gg(8)))return!0;if(!this.mc.getState(64))return!1;
if(this.JCg&&this.mc.getState(4)&&!this.mc.getState(16)&&!this.mc.getState(8)){var a=u.AFrameworkApplication.Ta.La(L.a.iDa,2,Object.assign(new Ul,{KZc:!0,O$a:this.mc.getState(1)}));va.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.gl.dL(10);va.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=u.AFrameworkApplication.Ta.La(L.a.iDa,2,Object.assign(new Ul,{W9b:!0,O$a:this.mc.getState(1)})),
va.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.ZDd=!0}Nsi(){return this.zQj||!this.mc.gg(32768)?!0:this.mc.getState(32768)?(this.gl.dL(14),this.mEd=!0,va.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}psi(){return this.qOj?!0:this.mc.gg(128)&&this.mc.getState(128)?(this.gl.dL(3),this.AAa=!0,va.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.mc.gg(256)&&this.mc.getState(256)?(this.gl.dL(4),this.AAa=!0,va.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.mc.gg(512)&&this.mc.getState(512)?(this.gl.dL(5),this.AAa=!0,va.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.mc.gg(1024)&&this.mc.getState(1024)?(this.gl.dL(6),this.AAa=!0,va.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.mc.gg(2048)&&this.mc.getState(2048)?(this.gl.dL(7),this.AAa=!0,va.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.mc.gg(4096)&&this.mc.getState(4096)?(this.gl.dL(8),this.AAa=!0,va.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.mc.gg(8192)&&this.mc.getState(8192)?(this.gl.dL(9),this.AAa=!0,va.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}Rsi(){if(this.iRj||!this.mc.gg(2)||!this.mc.gg(16))return!0;if(!this.mc.getState(2)&&this.mc.getState(16)){const a=u.AFrameworkApplication.Ta.La(L.a.iDa,2,Object.assign(new Ul,{NUa:!0,O$a:this.mc.getState(1)}));va.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.sEd=!0}return!1}Ssi(){if(!this.Tdb)return!1;if(this.jRj||!this.mc.gg(2)||!this.mc.gg(524288))return!0;if(!this.mc.getState(2)&&this.mc.getState(524288)){const a=u.AFrameworkApplication.Ta.La(L.a.iDa,
2,Object.assign(new Ul,{cle:!0,O$a:this.mc.getState(1)}));va.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.tEd=!0}return!1}Zsi(){if(this.VSj||!this.mc.gg(2)||!this.mc.gg(32))return!0;if(!this.mc.getState(2)&&this.mc.getState(32)){const a=u.AFrameworkApplication.Ta.La(L.a.iDa,2,Object.assign(new Ul,{R9b:!0,O$a:this.mc.getState(1)}));va.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.AEd=!0}return!1}Qsi(){return this.eQj||!this.mc.gg(2097152)?!0:this.mc.getState(2097152)?(this.gl.dL(22),this.jEd=!0,va.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}Psi(){var a=!1;if(this.RNj||!this.mc.gg(4194304))return!0;this.mc.getState(4194304)&&(a="NotAvailable",this.Mv&&(a=this.Mv.Pwb(),a=jn.a[a]),dg.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===u.AFrameworkApplication.Ta.processAction(L.a.Msc,
1)?(a=u.AFrameworkApplication.Ta.processAction(L.a.Msc,2),va.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.gl.dL(23),va.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.TDd=a=!0);return a}rsi(){return!this.OOj&&this.mc.gg(2)&&this.mc.gg(8)?!this.mc.getState(2)&&this.mc.getState(8)?(this.gl.dL(12),this.cEd=!0,va.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}sti(){if(this.BNj||!this.mc.gg(1))return!0;if(!this.mc.getState(1)){const a=u.AFrameworkApplication.Ta.La(L.a.iDa,2,new Ul);va.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}dti(){return this.DVj?!0:this.mc.gg(16384)&&this.mc.getState(16384)?(this.gl.dL(13),this.UEd=!0,va.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}cti(){return this.BVj?!0:this.mc.gg(65536)&&this.mc.getState(65536)?
(dg.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.rva?this.gl.XNc(15,this.cDb):this.gl.dL(15),this.REd=!0,va.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}$si(){return this.wTj?!0:this.mc.gg(262144)&&this.mc.getState(262144)&&this.rva?(this.gl.XNc(17,this.cDb),this.DEd=!0,va.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}zti(){return this.VYj?
!0:this.mc.gg(1048576)&&this.mc.getState(1048576)&&this.rva&&this.lgk?(this.gl.XNc(21,this.cDb),this.hFd=!0,va.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}Wsi(){return this.FRj?!0:this.mc.gg(131072)&&this.mc.getState(131072)&&this.rva?(this.gl.XNc(16,this.cDb),this.wEd=!0,va.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get BNj(){return this.zff}get iRj(){return this.sEd}get oOj(){return this.ZDd}get VSj(){return this.AEd}get eQj(){return this.jEd}get OOj(){return this.cEd}get qOj(){return this.AAa}get DVj(){return this.UEd}get zQj(){return this.mEd}get BVj(){return this.REd}get FRj(){return this.wEd}get wTj(){return this.DEd}get jRj(){return this.tEd}get VYj(){return this.hFd}get RNj(){return this.TDd}}
Object(n.a)(js,"ReadOnlyUIManager",null,[1297,106]);class ot{constructor(a,b,c,f){this.KCg=!1;this.Hw=()=>{va.a.J(509367064,809,50,"FilterPrivacyUIManager::OnUnifiedAppStateChanged");this.ZPf()};this.sOj=()=>!this.Qb.ka("FilterPrivacyBusinessBarEnabled")||this.KCg?!1:this.mc.gg(16777216)?this.mc.getState(16777216):(va.a.J(509367063,809,50,"FilterPrivacyUIManager::IsFilterPrivacyEnabled - business bar not displayed, filterPrivacyEnabled field not ready"),!1);this.ZPf=()=>{this.sOj()&&(this.gl.dL(27),
this.KCg=!0,va.a.J(509366796,809,15,"FilterPrivacyUIManager::DisplayFilterPrivacyBusinessBar - business bar displayed"))};if(!f)throw Error.argumentNull("appSettingsManager");this.mc=a;this.gl=b;this.Oc=c;this.Qb=f}initialize(){this.Oc.S7(this.Hw);this.ZPf()}dispose(){this.Oc.Vib(this.Hw)}}Object(n.a)(ot,"FilterPrivacyUIManager",null,[1298,106]);class ks{constructor(){this.yve=this.chc=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}Zb(a){this.K=a;this.K.register(1297,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().oa(()=>
new js(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")));this.K.register(1298,"PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager").ma().oa(()=>new ot(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").oFa&&(this.chc=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.yve=this.K.resolve("PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager"),this.chc.initialize(),this.yve.initialize())}dispose(){this.chc&&this.chc.dispose();this.chc&&this.yve.dispose()}static main(){v.a.instance.Dc(new ks)}}Object(n.a)(ks,
"PPTWebEditorUnifiedAppPackage",null,[2,3]);var ri=d(275);class bq{constructor(a,b,c,f){this.Fb=a;this.lr=b;this.yE=c;this.tva=f}fka(){const a=new qd.a;a.$(0,Object(F.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(F.a)(this,this.pptTableColumnHandleClickHandler,"pptTableColumnHandleClickHandler"));a.$(2,Object(F.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(F.a)(this,this.backgroundClickHandler,
"backgroundClickHandler"));a.$(4,Object(F.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.lr.l4(a.Ec)||this.lr.gVa(a.Ec)||this.lr.L0c(a.Ec)?(this.Fb.uvb(),ri.a.Vl(!0)):ri.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.lr.Gua(a.Ec)){const b=this.lr.sae(a.Ec);if(!b||!b.Ek)return va.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),ri.a.Vl(!1);b.Ek.aq||this.lr.LKc(a.Ec,a.iV,a.Zi.Wf);
return ri.a.Vl(!0)}return ri.a.notHandled}pptTableRowHandleClickHandler(a){if(this.lr.Eac(a.Ec)){const b=this.lr.sae(a.Ec);if(!b||!b.Ek)return va.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),ri.a.Vl(!1);b.Ek.aq||this.lr.v5k(a.Ec,a.iV,a.Zi.Wf);return ri.a.Vl(!0)}return ri.a.notHandled}backgroundClickHandler(a){return this.Fb.sac(a)?(this.tva.setVisibility(!1),ri.a.Vl(!0)):ri.a.notHandled}shapeClickHandler(a){let b=ri.a.notHandled;this.yE.hac||(b=this.yE.CXe(a));
this.yE.hac=!1;if((a=this.yE.Dwb(a))&&!a.fO||a&&a.shapeNode&&a.shapeNode.ud&&a.fO)return ri.a.Vl(!0);this.tva.setVisibility(!1);return b}}Object(n.a)(bq,"ClickHandlers",null,[]);var to=d(425),uo=d(430);class kp{constructor(a,b,c,f,l,w){this.Fb=a;this.pa=b;this.Fa=c;this.ia=f;this.yE=l;this.DEb=w}fka(){const a=new qd.a;a.$(0,Object(F.a)(this,this.noContextMenuHandler,"noContextMenuHandler"));a.$(1,Object(F.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(F.a)(this,
this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Fb.uvh(a)?to.a.notHandled:to.a.Vl(null)}slideBackgroundContextMenuHandler(a){return this.Fb.sac(a)?(this.pa.ey(),this.pa.Rh(),this.Fa.Ed(),this.ia.La(L.a.zXd,2,a.Zi),to.a.Vl(null)):to.a.notHandled}shapeContextMenuHandler(a){var b=this.yE.Dwb(a);if(this.Nkl(b,a))b.yDa(),this.DEb?b.jy||this.ia.La(L.a.fQa,2,new uo.a(b.shapeNode,!0,a.Zi)):this.ia.La(L.a.fQa,2,new uo.a(b.shapeNode,!0,a.Zi));else if(this.Kkl(b))return this.pa.ey(),
(b=this.yE.Bkj(b,a))&&this.pa.selectShape(b,!0),this.Fa.Ed(),this.ia.La(L.a.yXd,2,a.Zi),to.a.Vl(null);return to.a.notHandled}Nkl(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.fog&&!a.mzb(b.Zi)}Kkl(a){return!!a||this.pa.gH()||!this.pa.Na.length}}Object(n.a)(kp,"ContextMenuClickHandlers",null,[]);class or{constructor(a,b,c,f,l){this.Fb=a;this.lr=b;this.yE=c;this.ia=f;this.Vec=l}fka(){const a=new qd.a;a.$(0,Object(F.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));
a.$(1,Object(F.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(F.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.lr.l4(a.Ec)||this.lr.gVa(a.Ec)||this.lr.L0c(a.Ec)?(this.Fb.uvb(),ri.a.Vl(!0)):this.lr.Gua(a.Ec)||this.lr.Eac(a.Ec)?(this.Fb.uvb(),ri.a.Vl(!1)):ri.a.notHandled}shapeDoubleClickHandler(a){return this.yE.Dwb(a)?(this.Fb.uvb(),ri.a.Vl(!1)):ri.a.notHandled}backgroundDoubleClickHandler(a){return this.Fb.sac(a)?
(this.Fb.uvb(),this.Vec||this.ia.processAction(L.a.ZEa,2,{DoubleClickInsert:"true"}),ri.a.Vl(!0)):ri.a.notHandled}}Object(n.a)(or,"DoubleClickHandlers",null,[]);class pr{constructor(a,b,c,f,l){this.yE=a;this.ZC=b;this.ia=c;this.Ea=f;this.sO=l}L4f(){return Object(F.a)(this,this.Kdd,"mouseUpHandlerFilter")}Kdd(a){return a?(a=this.ZC.j$d(a.Ec))&&a.gb&&this.Ea.en(a.gb)&&this.sO.kVa&&this.yE.oYe?(this.ia.processAction(D.a.Wja,2),!0):this.yE.oYe=!1:!1}}Object(n.a)(pr,"MouseInputHandlers",null,[]);var Ck=
d(277);class qr{constructor(a,b,c,f){this.yE=a;this.Rb=b;this.y0=c;this.Ge=f}fka(){const a=new qd.a;a.$(0,Object(F.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(F.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,Object(F.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.IBl();return this.yE.Tzf(a)}IBl(){this.Ge.Uie()||Rc.a.M2d("ScrollActiveThumbnailIntoView",L.a.zjb,()=>
{this.Ge.Snd();return 32})}shapePointerDownHandler(a){this.Rb.fX&&this.y0.show(3,-1);const b=this.yE.Dwb(a);if(b&&b.shapeNode&&b.shapeNode.Qf&&!b.shapeNode.Og)return ri.a.Vl(!1);if((Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.Eya)||Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.EMb)||Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.IXe)||Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.Osd)||Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.uBh)||Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.IBh))&&b.isSelected&&
!b.fO||void 0!==b&&null!==b&&b.shapeNode.Op)return this.yE.hac=!1,ri.a.Vl(!0);this.yE.hac=!0;a=this.yE.CXe(a);a.U3&&(this.yE.oYe=!0);return a}defaultPointerDownHandler(){return ri.a.Vl(!0)}}Object(n.a)(qr,"PointerDownHandlers",null,[]);class Mq{constructor(a){this.yE=a}fka(){const a=new qd.a;a.$(0,Object(F.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(F.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(F.a)(this,this.shapePointerUpHandler,
"shapePointerUpHandler"));a.$(2,Object(F.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.yE.Tzf(a)}shapePointerUpHandler(a){const b=this.yE.Dwb(a);return b&&b.shapeNode&&b.shapeNode.Qf&&!b.shapeNode.Og?ri.a.Vl(!1):this.yE.CXe(a)}defaultPointerUpHandler(){return ri.a.Vl(!0)}}Object(n.a)(Mq,"PointerUpHandlers",null,[]);class Lp extends Sys.EventArgs{constructor(){super()}}Object(n.a)(Lp,"SlideBackgroundClickedEventArgs",Sys.EventArgs,
[]);class Mp{constructor(a,b,c,f,l,w,H,U){this.Fb=a;this.lr=b;this.pa=c;this.tva=f;this.Fa=l;this.EJ=w;this.Uma=H;this.Ea=U;this.oYe=this.hac=!1}Tzf(a){return this.Fb.sac(a)?(this.pa.ey(),a=a.Zi,this.EJ.Gfh(new Lp(!1)),(a.ctrlKey||a.shiftKey)&&a.uA===Sys.UI.MouseButton.leftButton?this.pa.jj():this.pa.Rh(),this.tva.setVisibility(!1),this.Fa.Ed(),ri.a.Vl(!0)):ri.a.notHandled}CXe(a){const b=this.Dwb(a);b&&this.pa.ey();const c=Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.Eya)||Sys.UI.DomElement.containsCssClass(a.Ec,
Ck.a.EMb)||Sys.UI.DomElement.containsCssClass(a.Ec,Ck.a.IXe),f=this.lr.L0c(a.Ec)||this.lr.l4(a.Ec)||this.lr.gVa(a.Ec);Rc.a.Ak("isEventFromHandlers",c.toString());Rc.a.Ak("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.fO?(this.pa.jj(),this.tva.setVisibility(!1),this.Fa.Ed(),ri.a.Vl(!0)):f&&b&&!b.fO?(b.I2g(a.Zi),ri.a.Vl(!0)):!b||b.fO&&!this.$ie(a)?ri.a.notHandled:(b.azk(a.Zi),ri.a.Vl(!0))}Dwb(a){let b=this.lr.KI(a.Ec);if(!b){var c=a.Ec,f=Fb.a(c,ua.a.role);f=f?f.toString()===Bc.a.FZb:!1;
if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.lr.KI(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(qa.a)(117,b);if(!c&&(this.lr.L0c(a.Ec)||this.lr.l4(a.Ec)||this.lr.gVa(a.Ec))&&(c=this.Uma.C5b(this.Ea.en(b.gb)),!c))return va.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.Uma.C5b(this.Ea.en(b.gb)))&&
c.fB&&!(c.jy||c.aq||c.Zme))return c}return null}$ie(a){return a&&a.Ec?a.Ec.id.startsWith(Pf.a.Mrb):!1}Bkj(a,b){return a?this.Akj(a):this.zkj(b.graphNode)}Akj(a){let b=null;a.isSelected&&this.pa.gH()||(b=Object(qa.a)(4,a.gb));return b}zkj(a){let b=null;if(a){const c=ob.GraphIterator.nb(a);c.rc(10)?(a=Object(qa.a)(4,c.Jg(10)),this.pa.jX(a)||(b=a)):va.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(n.a)(Mp,"ViewEventHandlerHelper",null,
[1340]);class cq{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}Zb(a){this.K=a;a.register(bq,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().oa(()=>new bq(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(or,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().oa(()=>
new or(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").Syb));a.register(kp,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().oa(()=>new kp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(qr,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().oa(()=>new qr(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));
a.register(Mq,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().oa(()=>new Mq(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(pr,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().oa(()=>new pr(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(Mp,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().oa(()=>new Mp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.K5h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").fka());a.x6h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").fka());a.l6h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").fka());
a.W7h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").fka());a.Z7h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").fka());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").pb(sa.a.GJ,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").L4f())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").yb(sa.a.GJ,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").L4f())}static main(){v.a.instance.Dc(new cq)}}Object(n.a)(cq,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var ig=d(81),rr;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(rr||(rr={}));Object(n.b)("WebSocketCompressionHelperLoadState",rr);var Nj=d(89),ls=d(347),
kn;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(kn||(kn={}));Object(n.b)("WebSocketState",kn);class Nq{constructor(a,b,c,f,l){this.rgc=this.Nl=this.$Fb=null;this.THa=-1;this.geb=this.Rla=0;this.Ecc=-1;this.FDb=0;this.GDb=null;this.dWa=0;if(!a)throw Error.argumentNull("webSocketClient");this.Pv=a;this.Xa=b;this.wE=c;this.Oc=f;a=document.createElement("a");a.href=this.Pv.ALl;a.protocol="http:"===a.protocol?"ws":"wss";Pd.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new ue.QueryStringBuilder(a.href),Pd.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.Xg(be.a.d$g,b.qk),Pd.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.Xg(be.a.EDk,u.AFrameworkApplication.userSessionId),a.Xg(be.a.Olc,l.toString()),this.$Fb=a.toString()):this.$Fb=a.href;this.keb=ig.a.YD(this.$Fb);this.U0b(2);this.Pma=this.Pv.ymh;this.ere=this.Pv.Kvi;this.AXe();this.Oc.LPa(Object(F.a)(this,this.ghb,"onSessionEnding"));this.Oc.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"))}dispose(){this.Oc.QRe(Object(F.a)(this,
this.ghb,"onSessionEnding"));this.Oc.Xfa(Object(F.a)(this,this.Eo,"onSessionRehydrated"))}U0b(a){this.Nl&&this.Nl.close();this.Nl=new WebSocket(this.$Fb,[]);this.Nl.onopen=Object(F.a)(this,this.onOpen,"onOpen");this.Nl.onerror=Object(F.a)(this,this.onError,"onError");this.Nl.onclose=Object(F.a)(this,this.onClose,"onClose");this.Nl.onmessage=Object(F.a)(this,this.onMessage,"onMessage");this.dWa=a;va.a.J(556541794,this.Pv.QQ,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.keb,this.Xa.qk,this.dWa)}ping(){if(this.Nl)if(1===this.Nl.readyState){const a=this.Pv.QGi();this.Nl.send(a)}else va.a.J(559284698,this.Pv.QQ,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Nl.readyState),this.eya(4);else va.a.J(559284697,this.Pv.QQ,50,"WebSocketFetcher::Ping Websocket is unavailable.")}Rvi(){this.Nl.close()}onOpen(){va.a.J(591208995,this.Pv.QQ,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.keb,this.Xa.qk);this.kpc();this.FDb=0;this.GDb=null;
this.Pv.xtk()}onError(a){va.a.J(591208993,this.Pv.QQ,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.keb,this.Xa.qk)}onClose(a){va.a.J(591208991,this.Pv.QQ,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.keb,this.Xa.qk,JSON.stringify(a),a.code,a.reason);this.FDb=a.code;this.GDb=a.reason}onMessage(a){try{a&&a.data&&this.Pv.ywk(a)}catch(b){va.a.J(559284699,this.Pv.QQ,10,"WebSocketFetcher::OnMessage",
b.toString())}}AXe(){this.rgc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Ecc),this.Nl||(va.a.J(559284700,this.Pv.QQ,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.eya(1))):this.Ecc=window.setTimeout(()=>{this.Nl&&(va.a.J(559284701,this.Pv.QQ,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.FDb=1E3,this.GDb="Lost visibility",this.Nl.close(this.FDb,this.GDb),this.Nl=null,window.clearTimeout(this.THa))},
this.ere)};window.self.addEventListener("visibilitychange",this.rgc)}kpc(){this.Rla=0}SQd(){0<this.Pv.wdd&&(new Date).getTime()-this.geb>this.Pv.wdd&&(this.kpc(),va.a.J(559284702,this.Pv.QQ,50,"WebSocketFetcher::Retry connect to server after long pause."))}LUd(){const a=!!this.wE&&!!this.wE.instance&&!this.wE.instance.N_,b=(new Date).getTime()-this.geb>this.Pma,c=this.Rla<this.Pv.bZg,f=!this.Nl||3===this.Nl.readyState||2===this.Nl.readyState,l=a&&b&&c&&f;va.a.J(557181E3,this.Pv.QQ,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
l,a,b,c,f);return l}JWe(){this.geb=(new Date).getTime();this.Pma=Math.pow(2,this.Rla)*this.Pv.ymh;0<this.Pv.wdd&&(this.Pma=Math.min(this.Pma,this.Pv.wdd));window.setTimeout(()=>{this.eya(3)},this.Pma)}eya(a){this.SQd();this.LUd()&&(this.U0b(a),this.JWe(),this.Rla++,a!==this.dWa&&va.a.J(541671620,this.Pv.QQ,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.dWa),va.a.J(559284703,this.Pv.QQ,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.dWa),this.Rla===this.Pv.bZg&&va.a.J(559284704,this.Pv.QQ,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.dWa))}sendMessage(a,b){if(!this.Nl)return va.a.J(559284705,this.Pv.QQ,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.FDb,this.GDb),1;va.a.J(559284706,this.Pv.QQ,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",kn[this.Nl.readyState],
b,this.FDb,this.GDb);if(1===this.Nl.readyState)return this.Nl.send(a),0;this.eya(5);return 2}Egl(){this.Nl.binaryType="arraybuffer"}xHb(){-1!==this.THa&&window.clearTimeout(this.THa);this.THa=window.setTimeout(()=>{this.ping()},this.Pv.mGk)}mui(){this.dWa=0}ghb(){this.Nl&&(va.a.J(557352418,this.Pv.QQ,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Nl.close(),this.Nl=null)}Eo(){this.Nl||(va.a.J(557352419,this.Pv.QQ,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.eya(6))}}Object(n.a)(Nq,"WebSocketFetcher",null,[1372,106]);var dq;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(dq||(dq={}));
Object(n.b)("ConnectionReason",dq);var Oq;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(Oq||(Oq={}));Object(n.b)("SendMessageStatusCode",Oq);class eq extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.j4k=b;this.rMj=c}}Object(n.a)(eq,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Ee=d(655);class vn{constructor(a,b,c,f,l){this.Pm=window.performance.now();this.rBe=new vc.a;this.Vte=this.Jdc=!0;this.kCb=
null;this.gGb=1;this.Xa=b;this.S8c=a.yLl;this.sAe=a.zLl;this.ddk=a.wLl;this.Kgk=a.xLl;this.Q7j=a.uLl;this.NEb=a.owd;this.pcd=a.NIl;this.VDe=a.vLl;this.keb=ig.a.YD(this.VDe);this.Nwa=new Nq(this,b,c,f,new ls.a(a.Mfa));this.jyg=a.aLc;if(l)this.kCb=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.Nwa.dispose()}ping(){this.Nwa.ping()}Lx(a){const b=new Map,c=this.Bpj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),dg.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.NEb?(a=this.Nwa.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",Oq[a]),dg.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new Nj.a,{extendedProperties:b})))):dg.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new Nj.a,{extendedProperties:b}))}Fbi(a){this.rBe.addHandler("ResponseReceivedEventId",a)}e0k(a){this.rBe.removeHandler("ResponseReceivedEventId",
a)}xtk(){if(this.NEb){var a=Rc.a.Ib?Rc.a.Ib.actionId:gh.a.create().toString(),b=u.AFrameworkApplication.userSessionId,c=this.Xa.qk;this.Vte=!0;b=Ee.p(a,b,this.Xa.podSessionId,c);b=this.Nwa.sendMessage(JSON.stringify(b),"validateSession");va.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,Oq[b],this.keb,c)}}ywk(a){if(this.NEb)try{const b=this.WVi(a);if(b.pong)this.xHb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.GAk(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.ttk(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.rBe.raiseEvent("ResponseReceivedEventId",new eq(b,this.qij(a,c),c))}}catch(b){va.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.xHb(a.data)}WVi(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.gGb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);va.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}qij(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}GAk(a){if(a.isValid){if(this.jyg){a=Rc.a.Ib?Rc.a.Ib.actionId:gh.a.create().toString();const b=u.AFrameworkApplication.userSessionId,c=this.Xa.podSessionId,
f=this.Xa.qk;va.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",rr[this.gGb]);1===this.gGb?this.f2j(a,b,c,f):2===this.gGb&&this.Hph(a,b,c,f)}this.ping()}else va.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.keb,this.Xa.qk),this.Nwa.Rvi()}f2j(a,b,c,f){this.jyg&&this.kCb.loadScript("WebSocketCompressionHelper").then(()=>{this.gGb=
2;this.Hph(a,b,c,f)}).catch(()=>{va.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.gGb=3})}Hph(a,b,c,f){a=Ee.a(a,b,c,!0,f);a=this.Nwa.sendMessage(JSON.stringify(a),"compressionHandshake");va.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}ttk(a){a=a.clientReadyForCompression;va.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.Nwa.Egl()}Bpj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}xHb(a){this.Nwa.xHb(a);ha.a.Wa(a)?va.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?va.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.NEb):(a={["PingTime"]:window.performance.now()-this.Pm-a,MeasurementType:"Performance.Now"},a.First=this.Jdc?1:0,a.WebSocketFrontDoorProtobufEnabled=this.NEb,a.PostConnectionPing=this.Vte,a.ConnectionReason=dq[this.Nwa.dWa],this.Nwa.mui(),this.Vte=this.Jdc=!1,va.a.J(591208985,839,50,pa.a.toJSON(a))))}QGi(){var a=(window.performance.now()-this.Pm).toString();if(!this.NEb)return a;a=Ee.q(Ee.l(a),null,null,null,this.Xa.qk);return JSON.stringify(a)}get ALl(){return this.pcd&&!ha.a.Wa(this.VDe)?this.VDe:
u.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get QQ(){return 839}get mGk(){return this.sAe}get bZg(){return this.S8c}get ymh(){return this.Kgk}get wdd(){return this.ddk}get Kvi(){return this.Q7j}}Object(n.a)(vn,"PodsWebSocketFrontDoor",null,[1284,106,1335]);class sr{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}Zb(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1284,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().oa(()=>{try{return new vn(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Ja("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").Vw)}catch(b){return va.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){v.a.instance.Dc(new sr)}}
Object(n.a)(sr,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var tr=d(1151),Pq=d(1160);class ur{constructor(a=null){this.oo=null;this.reset();this.CWb=a}cZb(a,b){if(!this.CWb||this.CWb.cYe())b in this.oo||(this.oo[b]=[]),this.oo[b].push(a)}getData(){return pa.a.count(this.oo)?this.oo:null}reset(){this.oo={}}}Object(n.a)(ur,"NamedValuesAggregator",null,[1527]);class Qq{constructor(){this.oo=new Ka.a}get fTk(){return this.oo.count}cZb(a){this.oo.add(a)}getData(){return this.fTk?Ma.toArray(this.oo):
null}reset(){this.oo=new Ka.a}}Object(n.a)(Qq,"BatchDataAggregator",null,[1527]);var Np;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})(Np||(Np={}));Object(n.b)("ApiType",Np);class vr{constructor(a,b){this.Yh=a;this.lJd=b}Lx(a,b,c){if(c){a=Np[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=u.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Yh.nj(this.lJd()+
"&apitype="+a,2,b,f,!1,3,Object(F.a)(this,this.DKa,"requestSucceeded"),Object(F.a)(this,this.BKa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}DKa(a){if(!u.AFrameworkApplication.Ug&&a&&a.data){var b=a.data.state;b&&b.hWc(b,a.data.Wd)}}BKa(a){!u.AFrameworkApplication.Ug&&a&&a.data&&(a=a.data.state)&&a.VVc(a)}}Object(n.a)(vr,"EditorServiceRequestManager",null,[1479]);class Rq extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(n.a)(Rq,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var ql=d(274);class Rm{constructor(a,b,c){this.begin=a;this.end=b;this.Hh=c}}Object(n.a)(Rm,"ErrorRange",null,[221]);class em{constructor(a,b){this.Pn=a;this.YRh=b}get He(){return this.Pn}get Hh(){return this.YRh}ee(a){return new em(a||this.Pn,this.Hh)}}Object(n.a)(em,"SpellingErrorObject",null,[148]);class wr{constructor(a,b,c){this.Pa=new vc.a;this.sr=a;this.O0h=b;this.AVh=c}$sf(a,b){b=this.qyh(a,b);if(!Qa.a.Wa(b)){for(var c=this.GF(a),f=[],l=0,w=0;l<b.length&&w<c.length;){const H=c[w],U=b[l];
U.end<=H.begin?++l:(H.end>U.begin&&Array.add(f,H),++w)}c=a.Z0a();try{const H=a.Bja();try{this.lih(a,f),this.atf(a,b)}finally{H&&H.dispose()}}finally{c&&c.dispose()}this.zed(a)}}uKa(a,b,c=!1){if(!Qa.a.Wa(b)){c=c?null:a.Z0a();try{const f=a.Bja();try{this.lih(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.zed(a)}}C1k(a,b){const c=a.Z0a();try{const f=a.Bja();try{this.HVd(a),b=this.qyh(a,b),Qa.a.Wa(b)||this.atf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}HVd(a){const b=a.Z0a();try{const c=
a.Bja();try{const f=a.Ra;for(a=0;a<f.length;a++){const l=f.ga(a);l.Vp&&(l.Vp=null);l.IL=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}GF(a,b=null){const c=[];let f=0,l=null;var w=!1;a=a.Ra;for(let H=0;H<a.length;H++){const U=a.ga(H);if(U.IL){const ja=U.cp;l?(w=new Rm(f,ja,l),b&&!b(w)||Array.add(c,w)):w?ka.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):ka.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
f,ja);w=!1}U.Vp&&(w=!0,f=U.cp,l=U.Vp.Hh)}return c}PSa(a){if(!a||!nb.SelectionEditor.ik(a)&&!nb.SelectionEditor.Tg(a))return null;const b=a.node;let c=a.Qa,f=a.Lb;a=nb.SelectionEditor.Tg(a);const l=this.sr.text(b);for(const w of this.GF(b))if(a){if(w.begin<=c&&w.end>=f)return w}else if(w.begin<=c&&w.end>=c&&ha.a.EAi(l,w.end,f))return w;return null}bqc(a){if(!this.AVh||!a||!(a.Cca||2===a.length&&nb.SelectionEditor.Xl(a.Ye)))return!1;a=this.PSa(a.Ua);if(!a)return!1;if(a=Object(qa.a)(440,a.Hh))if(a.EKh=
!0,a.Hke())return!1;return!a||5!==a.proofingType}qyh(a,b){if(Qa.a.Wa(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=b[c];f&&f.Hh||(ka.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;ql.d(b);c=[];this.O0h&&Array.addRange(c,this.sr.RSa(a));c=ql.a(c);for(f=a=0;f<b.length&&a<c.length;){let l=b[f];const w=c[a];l.begin<w.end&&w.begin<l.end?Array.removeAt(b,f):l.end<
w.end?f++:a++}return b}atf(a,b){let c=!1;for(const f of b){b=f.Hh;c=1===b.proofingType||c;let l=a.svb(f.begin);l.Vp=new em(l,b);l.isFromErrorRangeSplit=!0;l=a.svb(f.end);l.IL=!0;l.isFromErrorRangeSplit=!0}c&&(a.rzb=!1)}lih(a,b){if(!Qa.a.Wa(b)){a=a.Ra;for(const c of b){b=a.iT(c.begin);const f=a.iT(c.end);b&&b.Vp&&f&&f.IL?(b.Vp=null,f.IL=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),ka.ULS.sendTraceTag(37532355,324,10,b))}}}iai(a){this.Pa.addHandler("OnErrorRangesChanged",
a)}zed(a){if(this.Pa.e8b){const b=this.GF(a);this.Pa.raiseEvent("OnErrorRangesChanged",new Rq(a.id.toString(),b))}}}Object(n.a)(wr,"ErrorRangeEditor",null,[1478]);var To=d(216);class Sq{constructor(){this.zef=new To.a}contains(a,b){return a?this.zef.contains(ha.a.cDh(a,b)):!1}add(a,b){a&&this.zef.add(ha.a.cDh(a,b))}}Object(n.a)(Sq,"IgnoreAllKeywords",null,[1279]);var Dk=d(217);class xr extends Dk.a{constructor(a,b,c){super(b,c);this.CG=a;this.QJa=this.maa=-1;this.iVd=0;this.textUnit=2}get lcid(){return this.CG}}
Object(n.a)(xr,"ModifiedRange",Dk.a,[]);class lp{constructor(a,b,c,f){this.D4h=a;this.GK=b;this.jN=c;this.tmf=f}get yjd(){return this.tmf?this.tmf.instance:null}GAf(a,b){const c=[];if(Qa.a.Wa(a)||Qa.a.Wa(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new xr(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];let w=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const H=a.pop(),U=H.end,ja=Math.min(U,l);U>l&&a.push(new Dk.a(l,U));Array.add(c,new xr(w,H.begin,
ja))}f++}while(0<a.length&&f<b.length);ka.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}pVi(a,b,c,f){let l,w;({NEe:l,uEe:w}=lp.$Wf(a,c,b));c=0;let H=a.begin,U=a.end;const ja=this.yjd;let wa=!1;ja?(c=ja.findEndBoundary(b,U-1,w),f||-1!==c||this.zcg(b,a)?c=-1===c?w:c:wa=!0):wa=!0;if(wa)return this.k2f(a,b,this.jN.D1g,l,w);if(!l)for(;" "===b.charAt(l)&&l<b.length;)l++;a=Math.max(ja.findBeginBoundary(b,H,l),l);return Dk.a.createTextRange(a,c)}oVi(a,
b,c){return this.BUf(a,b,c,this.jN.D1g)}nVi(a,b){if(!a||Qa.a.Wa(b))return a;let c=a.begin,f=a.end,l=!1;for(const w of b){if(a.end<=w.begin)break;a.begin>w.begin&&a.begin<w.end&&(c=w.begin,l=!0);a.end>w.begin&&a.end<w.end&&(f=w.end,l=!0)}return l?Dk.a.createTextRange(c,f):a}Yjl(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!ha.a.Wzb(b.substring(c,a))&&!ha.a.DAi(b,c,a)}Y5i(a,b,c){if(!a||!c||Qa.a.Wa(b))return 0;a=ql.c([a],b);b=0;for(const f of a)b+=this.D4h.C9f(c,f.begin,f.end);return b}D6h(a,
b,c,f){if(a&&b){var l=a.begin,w=a.end,H=this.jN.ark;if(0>=H)a.maa=l,a.QJa=w;else if(H=this.BUf(a,b,f,H)){b=a.lcid;f=H.begin;H=H.end;if(0>f||this.Suh(f,l,b,c))f=l;this.Suh(w,H,b,c)&&(H=w);a.maa=f;a.QJa=H}else a.maa=l,a.QJa=w}}zcg(a,b){return this.yjd?-1!==this.yjd.findEndBoundary(a,b.begin,b.end):!1}Suh(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.GAf([new Dk.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}BUf(a,b,c,f){if(!a||!b||0>f)return null;let l;({NEe:c,uEe:l}=lp.$Wf(a,c,b));return this.k2f(a,
b,f,c,l)}k2f(a,b,c,f,l){return Dk.a.createTextRange(this.GK.mZi(b,c,a.begin,f),this.GK.TYi(b,c,a.end,l))}static $Wf(a,b,c){let f;f=0;c=c.length;if(Qa.a.Wa(b))return{NEe:f,uEe:c};let l=a.begin;a=a.end;let w=!1,H=!1;for(const U of b)if(!w&&U.end<=l?f=U.end:w=!0,!H&&U.begin>=a&&(c=U.begin,H=!0),w&&H)break;return{NEe:f,uEe:c}}}Object(n.a)(lp,"ModifiedExpandRangeHelper",null,[1477]);var Uo=d(349);class pt{constructor(a,b){this.ADd=null;this.Cg=a;this.GK=b;this.GG=zb.ParagraphReader.text(this.Cg);this.omf=
[]}dpj(a,b){return this.pVc(this.GK.x4b(this.GG,a,b))}pVc(a){return a?this.Vae(a.begin,a.end):null}Vae(a,b){this.ADd=this.ADd||this.GK.MSc(this.Cg);return this.GK.pVc(a,b,this.GG,this.ADd)}zEa(a,b){(a=this.Vae(a,b))&&Array.add(this.omf,a)}m6b(){return Array.clone(this.omf)}}Object(n.a)(pt,"ValidatedRangeContainer",null,[]);class mp{constructor(a,b,c,f,l,w){this.Fm=a;this.GK=b;this.Tc=c;this.jN=f;this.l1h=l;this.VZh=w}Hwb(a){return new pt(a,this.GK)}Mdi(a){const b=a.Z_d.currentNode;var c=a.vyh.currentNode;
const f=a.W8g;a=this.zta(b);const l=this.Hwb(b);c=this.zta(c);for(var w of c)l.zEa(f+w.begin,f+w.end);Array.addRange(a,l.m6b());if(w=l.dpj(f,f))Array.add(a,w),this.nRe(b,w,0);b.R0=a}Ndi(a,b,c){var f=a.R0;if(Qa.a.Wa(f)||f[f.length-1].end<=c)this.kKc(b);else{var l=[],w=this.Hwb(a),H=this.Hwb(b);for(const U of f)if(f=U.end,f>c){const ja=U.begin;ja<c?(w.zEa(ja,c),H.zEa(0,f-c)):H.zEa(ja-c,f-c)}else Array.add(l,U);c=w.m6b();Array.addRange(c,l);a.R0=c;b.R0=H.m6b();a.tqc();b.tqc()}}Gdl(a){zb.ParagraphReader.ae(a)&&
!this.GK.vUa(a)&&(this.Fm.HVd(a),this.oSe(a,[new Dk.a(0,zb.ParagraphReader.textLength(a))]))}esh(a,b){b&&a&&zb.ParagraphReader.ae(a)&&!this.GK.vUa(a)&&!a.nC&&this.JZg(a,this.Hwb(a).pVc(b),D.a.typing)}gth(a,b,c){a&&this.esh(a,this.GK.x4b(zb.ParagraphReader.text(a),b,c))}oSe(a,b){if(zb.ParagraphReader.ae(a))if(Qa.a.Wa(b))this.kKc(a);else{const c=this.Hwb(a);for(const f of b)c.zEa(f.begin,f.end);a.R0=c.m6b()}}kKc(a){zb.ParagraphReader.ae(a)&&(a.R0=null)}Fpd(a,b,c=null){if(zb.ParagraphReader.ae(a)&&!a.nC&&
!Qa.a.Wa(b)){ql.d(b);var f=null;if(this.jN.gzb||this.jN.rUa)f=U=>1===U.Hh.proofingType;f=this.Fm.GF(a,f);for(var l=[],w=0,H=0;H<f.length&&w<b.length;){const U=b[w],ja=f[H];U.end<=ja.begin?w++:(ja.end<=U.begin||ja.begin>=U.begin&&ja.end<=U.end&&(0!==ja.Hh.errorType||ja.begin!==U.begin)&&Array.add(l,ja),H++)}this.Fm.uKa(a,l);f=this.zta(a);b=ql.b(f,b);c&&(c=ql.c(f,[c]),0<c.length&&(b=ql.e(b,c)));this.oSe(a,b)}}zta(a){return zb.ParagraphReader.ae(a)?a.R0||[]:[]}Rfi(a,b,c,f,l=0){const w=a.node;if(zb.ParagraphReader.ae(w)&&
!this.GK.vUa(w)&&!w.nC){var H=zb.ParagraphReader.text(w),U=a.Qa,ja=a.Lb+f;this.l1h?(U=a.Qa+b,ja=a.Lb-c+f):this.VZh&&(b=this.Tc.Qj,0<=f&&b&&nb.SelectionEditor.Tg(b)&&(b=b.Qa,0<=b&&b<=H.length&&(b=this.GK.x4b(H,b,b))&&b.begin>=U&&b.end<=ja&&(U=b.begin,ja=b.end)));b=this.Hwb(w);c=null;0<=f&&(c=b.Vae(U,ja));c||(c=this.GK.x4b(H,U,ja));0<=f?this.JZg(w,c,l):this.hGl(w,a.Qa,a.Lb,c,b,f,l)}}JZg(a,b,c){if(b){var f=this.zta(a);Array.add(f,b);a.R0=f;a.tqc();this.nRe(a,b,c)}}hGl(a,b,c,f,l,w,H){const U=this.zta(a),
ja=[];if(U.length)if(U[U.length-1].end<b)if(f)Array.addRange(ja,U);else return;else{for(const wa of U)wa.end<b?Array.add(ja,wa):wa.begin>=c?l.zEa(wa.begin+w,wa.end+w):wa.begin<b?wa.end>c?l.zEa(wa.begin,wa.end+w):l.zEa(wa.begin,b):wa.end>c&&l.zEa(b,wa.end+w);Array.addRange(ja,l.m6b())}f&&(Array.add(ja,f),this.nRe(a,f,H));a.R0=ja;a.tqc();this.Fm.zed(a)}nRe(a,b,c){const f=this.Fm.GF(a,w=>w.begin<=b.end&&w.end>=b.begin);if((c===D.a.NSd||c===D.a.typing||c===D.a.cut||c===D.a.paste)&&1===f.length&&f[0].Hh){c=
f[0].Hh;var l=Xa.a.xe(c.lcid);l=l?l.name:mp.oMh;const w=Object(Ya.a)(Uo.a,c)?c.typeId:mp.FMh;ka.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",w,l);c.EKh&&ka.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",w,l)}this.Fm.uKa(a,f)}}mp.FMh="";mp.oMh="UNKNOWN";Object(n.a)(mp,"ModifiedRangeEditor",null,[1476]);class fq{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa=null){this.Fm=a;this.Oz=b;this.WXb=c;this.AK=f;this.Q3a=l;this.sOa=w;this.GK=H;this.$4a=
U;this.y$e=ja;this.Hdf=Sa||fq.TKi;this.Eof=!1;wa.execute(eb=>{this.Eof=!!eb})}nHh(a){if(a&&zb.ParagraphReader.ae(a)&&a.tWc){let b=null;this.y$e.sua&&(b=c=>!!c.Hh&&1===c.Hh.proofingType);a.rzb=Qa.a.Wa(this.Oz.zta(a))&&Qa.a.Wa(this.Fm.GF(a,b))}}qej(a,b){var c=this.sej(a,b);if(Qa.a.Wa(c))return[];const f=zb.ParagraphReader.text(a).replace("\u00a0"," "),l=this.Fm.GF(a),w=this.h$k(a,l),H=w&&this.ECi(a),U=this.GK.sWf(a),ja=ql.e(this.GK.rWf(a),U);c=this.G$i(c,b,f,ja,l,w,H);if(Qa.a.Wa(c))return[];b=this.Q3a.Bcj(a);
c=this.sOa.GAf(c,b);if(Qa.a.Wa(c))return[];this.WMk(a,f,c);a=this.Oz.zta(a);for(const wa of c)this.sOa.D6h(wa,f,b,U),wa.iVd=this.sOa.Y5i(wa,a,f),w&&(H||this.sOa.zcg(f,wa))&&(wa.textUnit=4);return c}LYi(a){if(this.Hdf()||!a||""===a.sa(Za.a.pq,""))return null;var b=this.$4a.z4b;if(!b||!nb.SelectionEditor.Tg(b)||b.node!==a||!this.pzj(a))return null;b=b.Qa;return this.GK.x4b(zb.ParagraphReader.text(a),b,b)}Qfi(a,b,c,f,l,w,H=0){this.AK.Mc(a.node).Ze()&&(this.Oz.Rfi(a,b,c,w,H),this.WXb.gIl(a,f,l))}pzj(a){const b=
ql.a(this.Oz.zta(a));if(!b.length)return!1;a=ql.a(this.Fm.GF(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],w=a[c];l.begin>=w.begin&&l.end<=w.end?f++:c++}return f!==b.length}sej(a,b){if(!a||a.Aje)return null;a=this.Oz.zta(a);return a.length&&b?ql.b(a,[b]):a}h$k(a,b){return this.Eof&&this.y$e.sua?a.QTb||!b.length||Qa.a.any(b,c=>!!c.Hh&&2===c.Hh.Rqg):!1}ECi(a){if(!a.QTb||this.Hdf())return!0;var b;(b=this.$4a.z4b)&&b.node===a?(a=this.Oz.zta(a),b=b.Qa<a[a.length-1].begin):b=!0;return b}G$i(a,
b,c,f,l,w,H){let U=[];for(const ja of a)a=w?this.sOa.pVi(ja,c,f,H):this.sOa.oVi(ja,c,f),(a=this.sOa.nVi(a,l))&&Array.add(U,a);U=ql.a(U);b=ql.f(f,b);return ql.b(U,b)}WMk(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const w=c[l];this.sOa.Yjl(w,b)||(Array.removeAt(c,l),Array.add(f,w))}this.Oz.Fpd(a,f)}static TKi(){return Cf.a.Uzj(Pc.App.Kb.pG.Bpg)}}Object(n.a)(fq,"ParagraphProofingFacade",null,[1475]);var fk=d(1066);class np{constructor(){this.VVc=this.hWc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(n.a)(np,"EditorServiceAPIRequest",null,[]);class gq extends np{constructor(){super();this.nza=this.request=null}}Object(n.a)(gq,"ProofingConfigV2Request",np,[]);class hq{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(n.a)(hq,"ProofingConfigV2RequestObject",null,[]);var Op;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})(Op||(Op={}));Object(n.b)("ResponseStatus",Op);var el=d(2);class Tq{constructor(a,b,c,f,l){this.fSb=a;this.nd=b;this.$Vb=c;this.TZh=f;this.qrf=u.AFrameworkApplication.lcid;this.Yga=Pc.App.mode;this.Gxc={};this.sVb=new Vc.a;this.NZh=l}init(){this.Mid(this.qrf)}Mid(a){if(!(a.toString()in this.Gxc||u.AFrameworkApplication.Ug))try{this.TZh.Tsi(a).continueWith(b=>{!b.result||this.sVb.Gb(a.toString())&&this.sVb.ga(a.toString())||this.j9k(a)},3)}catch(b){ka.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}j9k(a){var b=new fk.a;const c=Xa.a.xe(a).name,f=Xa.a.xe(this.qrf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new gq,{request:new hq(a,this.d6d(),c,f,this.$Vb.descriptors),activity:this.nd.Wp(D.a.G2k),nza:b,hWc:Object(F.a)(this,this.$mc,"processSuccessResponse"),VVc:Object(F.a)(this,this.Ymc,"processFailResponse")}),this.sVb.$(a.toString(),!0),this.fSb.Lx(2,Jc.c(b.request),b))}$mc(a,b){if(!a||!a.request)return!1;this.sVb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.Gxc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=Jc.a(b)}catch(f){ka.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?Op[c.ResponseStatus]:"EmptyResponse",ka.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.NZh.filter(b);
ka.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.Gxc[a.request.Lcid.toString()]=b;return!0}Ymc(a){a&&(a.request&&this.sVb.$(a.request.Lcid.toString(),!1),a.nza.Kg(!1),ka.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return el.Task.gt(this.Gxc[a.toString()])}d6d(){const a=
kf.a[this.Yga];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(n.a)(Tq,"ProofingConfigV2Manager",null,[1283]);class rl{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new rl,{Name:a,Value:b})}static Pee(){Object.assign(new rl,{Name:"IsCompliant",Value:void 0});Object.assign(new rl,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new rl,{Name:"IsGoLocal",Value:void 0})}}Object(n.a)(rl,"Descriptor",null,[]);class t{constructor(a,b){this.mAa=[];this.$a=
a;this.hcf=b}get descriptors(){if(!this.mAa.length)try{this.Pee()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);ka.ULS.sendTraceTag(33952285,375,10,b)}return this.mAa}Pee(){Array.clear(this.mAa);var a=this.$a.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.mAa,Object.assign(new rl,{Name:"IsGoLocal",Value:this.$a.ka("IsGoLocalEnvironment").toString()}));Array.add(this.mAa,Object.assign(new rl,{Name:"IsCompliant",Value:a}));
if(this.hcf.vne||this.hcf.rUa)a=this.$a.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.mAa,Object.assign(new rl,{Name:"LicenseType",Value:a}));this.Xei();this.dfi()}dfi(){var a=Jc.b(this.$a.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.mAa,Object.assign(new rl,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.mAa,Object.assign(new rl,{Name:"Origin",Value:a}))}Xei(){const a=
this.rYi(this.$a.Ga("FlightId"));let b;0<a.length&&(b=Qa.a.join(a,";"),Array.add(this.mAa,Object.assign(new rl,{Name:"FlightIds",Value:b})),ka.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}rYi(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(n.a)(t,"ProofingDescriptors",null,[1278]);class S{constructor(a,b){this.rUa=this.gzb=this.ZKd=!1;this.GHd=this.FHd=0;
this.YCc=a.ka("ProofingWithEditorServiceIsEnabled");this.sTh=a.ka("GrammarCheckIsEnabled");this.WUa=a.ka("ProofingSettingIsEnabled");this.Nle=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.aAc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.H4h=a.ka("WritingStyleIsEnabled");this.oRh=a.ka("DoNotCheckThisIssueEnabled");this.cVh=a.ka("IgnoreProofingCommandIsEnabled");this.sua&&(this.ZKd=!1,b.execute(()=>{this.ZKd=!0}));2===this.Rfa?(this.GHd=2,this.FHd=
3):(this.GHd=a.Bc("NumberOfWordsToProofAroundModifiedRanges",1),this.FHd=a.Bc("NumberOfWordsAsContextAroundProofedRanges",0))}get Yjg(){return this.cVh}get sua(){return 2===this.Rfa&&this.sTh}get vne(){return this.sua&&this.H4h}get Uje(){return this.oRh&&this.Nle&&this.WUa}get pNj(){return this.aAc}get Rfa(){return this.YCc?2:0}get ark(){return this.FHd}get D1g(){return this.GHd}get isLoaded(){return!this.YCc||!this.sua||this.ZKd}}Object(n.a)(S,"ProofingFeatureConfiguration",null,[1474]);class la extends np{constructor(){super();
this.request=null}}Object(n.a)(la,"ProofingFeedbackLoopRequest",np,[]);class Ca{constructor(a,b,c){this.fSb=a;this.nd=b;this.$Vb=c}o9k(a){a.Descriptors=this.$Vb.descriptors;a=Object.assign(new la,{request:a,activity:this.nd.Wp(D.a.K9k),hWc:Object(F.a)(this,this.$mc,"processSuccessResponse"),VVc:Object(F.a)(this,this.Ymc,"processFailResponse")});this.fSb.Lx(1,Jc.c(a.request),a)}$mc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}Ymc(a){a&&(ka.ULS.sendTraceTag(38847138,375,15,"Proofing feedback failed"),
a.endActivity("RequestFailed"))}}Object(n.a)(Ca,"ProofingFeedbackLoopManager",null,[1473]);class Na extends np{constructor(){super();this.nza=this.request=null}}Object(n.a)(Na,"ProofingLanguageInfoRequest",np,[]);class qb{constructor(a){this.AppId=a}}Object(n.a)(qb,"ProofingLanguageInfoRequestObject",null,[]);class Pb{constructor(a,b){this.fSb=a;this.nd=b;this.Yga=Pc.App.mode;this.oqa=new La.ScriptSharpLegacyMap;this.eha=null;this.O4a=0}Tsi(a){if(this.oqa.Gb(a))return el.Task.gt(!0);this.xUe();return this.eha.CWRCo(()=>
!!this.eha.result&&this.eha.result.Gb(a),3)}Usi(a,b){if(this.oqa.Gb(a))return el.Task.gt(this.m8f(a,b));this.xUe();return this.eha.CWRCo(()=>this.m8f(a,b),3)}g8i(a){if(0<this.oqa.count)return el.Task.gt(this.j1f(a));this.xUe();return this.eha.CWRCo(()=>this.j1f(a),3)}A2k(){const a=new fk.a;u.AFrameworkApplication.Ug&&a.Kg(null);const b=Object.assign(new Na,{request:new qb(kf.a[this.Yga]+"_Online"),activity:this.nd.Wp(D.a.H2k),nza:a,hWc:Object(F.a)(this,this.$mc,"processSuccessResponse"),VVc:Object(F.a)(this,
this.Ymc,"processFailResponse")});this.fSb.Lx(0,Jc.c(b.request),b);this.O4a+=1;return a.task}$mc(a,b){let c=null;if(!a)return!1;try{c=Jc.a(b)}catch(l){ka.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=Xa.a.xe(f.LanguageId))&&0!==f.SupportedTextUnit&&this.oqa.$(b.LCID,f);a.nza.Kg(this.oqa);a.endActivity("RequestSucceeded");return!0}a.nza.Kg(null);
f=c?Op[c.ResponseStatus]:"EmptyResponse";ka.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}Ymc(a){a&&(a.nza.Kg(null),ka.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}m8f(a,b){if(!this.oqa||!this.oqa.Gb(a))return 0;a=this.oqa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.L$i(b,a)}L$i(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}j1f(a){const b=new Ka.a;if(!this.oqa)return b;for(let c of this.oqa)c.value.SupportedCritiqueTag&a&&b.add(c.key);
return b}xUe(){if(!this.eha||5===this.eha.status||4===this.eha.status||6===this.eha.status&&!this.eha.result)this.eha=this.A2k(),ka.ULS.sendTraceTag(38319180,375,1===this.O4a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.O4a,this.O4a)}}Object(n.a)(Pb,"ProofingLanguageInfoManager",null,[1472]);class xc{constructor(a,b){this.XVh=a;this.Kpb=b}track(a,b=null){this.XVh&&this.Kpb.track(a(),b)}}Object(n.a)(xc,"ProofingMetricsAggregator",null,[1282]);class ed{Auf(a,
b){a&&zb.ParagraphReader.ae(a)&&!Qa.a.Wa(b)&&(ql.d(b),a.hPb=ql.e(a.hPb,b))}gIl(a,b,c){if(b){var f=a.Lb;a=a.node.hPb;for(let w=0;w<a.length;w++){var l=a[w];const H=l.begin;l=l.end;0>b?l>c&&(H>=f?a[w]=new Dk.a(H+b,l+b):H>=c&&l<=f?(Array.removeAt(a,w),w--):a[w]=new Dk.a(H<c?H:c,l<=f?c:l+b)):a[w]=new Dk.a(H>f?H+b:H,l>f?l+b:l)}}}}Object(n.a)(ed,"UnsupportedLanguageRangeEditor",null,[1470]);var dd=d(1257),fd=d(467),we=d(249),Sf=d(453),Ff=d(1093),Gh=d(668);class gk{constructor(){this.Ky=this.u_a=null}}Object(n.a)(gk,
"ClientRequestManagerStateObject",null,[]);class vj{constructor(a,b){this.request=a;this.response=b}}Object(n.a)(vj,"SpellCheckRequestResponseTuple",null,[]);class mk{constructor(){this.LJh=0;this.MMf=this.Rna=this.paragraphNode=this.range=null;this.userAction=0;this.AI=null;this.Rfa=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}jkg(){const a=zb.ParagraphReader.text(this.paragraphNode);if(!a||!this.Rna)return a===this.Rna;let b=this.range.begin,c=this.range.end;return ha.a.$Rd(a.substring(b,
c),this.Rna.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.jkg()}}Object(n.a)(mk,"SpellCheckRequest",null,[]);var sl=d(667),On=d(846),Pn=d(847);class bi{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd){this.FNd=new Ua.a;this.NVb=[];this.qyc=0;this.vDc={};this.kba=null;this.O9e=Number.POSITIVE_INFINITY;this.oxc=0;this.E7=bi.mab;this.H4a=null;this.KEc=0;this.Fqb=[];this.Nxc=null;this.H_h=!1;this.qVb=[];this.IJd=[];this.OZh=0;this.SZh=c.ka(bi.DMk);this.XZh=c.ka(bi.KMk);
this.PZh=c.appSettings[bi.BMk];this.MZh=c.ka(bi.AMk);this.WZh=c.ka(bi.IMk);this.YH=f;this.Yga=Pc.App.mode;this.Fm=a;this.Oz=b;this.WXb=wa;this.Yh=l;this.rXh=c.Bc(bi.GMk,bi.FMk);this.UZh=ub;this.Bk=w;this.jf=H;this.AK=U;this.GK=ja;this.lJd=Sa;this.WCc=eb;this.Zh=new dd.a;this.RZh=c.ka(bi.CMk);this.VCc=cc;this.EMk=Fc;this.ZPc=Ub;this.YCc=c.ka(bi.JMk);this.$Vb=Ic;this.LZh=Cc;this.Cnb=Ud;this.S6=je;this.$d=Vd}get q8g(){return this.qVb}set q8g(a){this.qVb=a}get BRc(){return u.AFrameworkApplication.Ug}get W1b(){return this.Cnb.instance}suspend(){this.KEc++}resume(){if(0>=
--this.KEc&&(this.KEc=0,0<this.Fqb.length&&!this.Nxc)){const a=this.S6.isCompleted(4)?0:1;this.Nxc=new Le.a(a,1,1,Object(F.a)(this,this.Iql,"spellCheckSuspendedNodes"),74);this.$d.Db(this.Nxc)}}Iql(){this.Nxc=null;const a=Qa.a.clone(this.Fqb);Array.clear(this.Fqb);Date.now();let b=null;for(const c of a)b=this.EFh(c,!0,b);b&&b.dispose();this.H_h||Date.now()}TR(a,b=!1){(a=this.EFh(a,b,null))&&a.dispose()}EFh(a,b,c){switch(this.jta(a,b)){case 1:Qa.a.contains(this.Fqb,a)||Array.add(this.Fqb,a);break;
case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}jta(a,b){return!a||this.BRc||!this.YH.Ld.isEditingAllowed&&!this.YH.Ld.hz?0:!b&&0<this.KEc||!this.ZPc.isLoaded?1:!zb.ParagraphReader.ae(a)||!a.isConnected||a.anchor.$I||a.Aje||a.YW||a.nC?3:this.kba&&Qa.a.any(this.kba,c=>c.paragraphNode===a)?0:Qa.a.any(this.NVb,c=>c.paragraphNode===a)||!this.jf.Gt(this.AK.Mc(a))?3:2}doSpellCheck(a,b){const c=(wa,Sa)=>{this.Oz.Fpd(wa,Sa)};var f=this.GK.MSc(a);let l=
0<f.length;b=this.qNe(b,a,f,c);(f=this.VCc.LYi(a))&&this.EGi(a);const w=this.VCc.qej(a,f),H=zb.ParagraphReader.text(a),U=a.QTb,ja=[];for(let wa=w.length-1;0<=wa;wa--){const Sa=w[wa];Sa.begin!==Sa.end&&(this.FNd.contains(Sa.lcid)?Array.add(ja,Sa):(this.RCi(a,H,f,Sa,U),Array.removeAt(w,wa)))}l=0<ja.length||0<w.length||l;b=this.qNe(b,a,ja,Object(F.a)(this.WXb,this.WXb.Auf,"addUnsupportedRanges"));b=this.qNe(b,a,w,c);l&&this.VCc.nHh(a);return b}oe(a){const b=this.Bk.oe(7,D.a.N5e);b.kd(a);return b}qNe(a,
b,c,f){Qa.a.Wa(c)||(a=a||this.oe(b),f(b,c));return a}EGi(a){const b=new Le.a(4,1,500,Object(F.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.$d.Db(b)}bqk(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.Rna.length+b.paragraphNode.id;this.vDc[b]=(this.vDc[b]||0)+1;this.qyc=Math.max(this.vDc[b],this.qyc);return this.qyc>bi.jmk?(ka.ULS.sendTraceTag(22390425,324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.qyc=0,this.vDc=
{},this.Oz.kKc(a),!1):!0}RCi(a,b,c,f,l){const w=new mk;w.LJh=u.AFrameworkApplication.lcid;w.Rna=b;w.range=f;w.paragraphNode=a;w.MMf=c;w.userAction=l?1:0;const H=this.ZPc.WUa;H&&this.W1b&&(w.overriddenCritiqueTypeOptions=this.W1b.U6d());this.bqk(a,w)&&this.Dmj(w.range.lcid,w.range.textUnit).continueWith(U=>{U=U.result;w.Rfa=2===this.ZPc.Rfa?0!==U?2:0:this.OZh;w.range.textUnit=U;w.descriptors=this.$Vb.descriptors;this.BSi(w);H&&2===w.Rfa&&this.LZh.Mid(w.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}Dmj(a,
b){return 2===this.ZPc.Rfa?this.EMk.Usi(a,b):el.Task.gt(b)}BSi(a){a.AI=new Date;Array.enqueue(this.NVb,a)}recheckParagraphTask(a){this.TR(a.customData)}executeNextRequest(){if(!this.BRc&&!this.kba){var a=[];do{if(!this.NVb.length)break;const b=Array.dequeue(this.NVb);b.isValid()&&Array.add(a,b)}while(a.length<this.rXh);0>=a.length?(this.kba=null,this.Jql()):(this.kba=a,this.kba.sort((b,c)=>+b.AI-+c.AI),a=this.kba[0],this.WCc.track(+new Date-+a.AI,"ProofingRequestInQueue."+sl.a[a.userAction]),this.executeRequest(this.kba))}}Jql(){for(var a=
0;a<this.qVb.length;a++)(0,this.qVb[a])();Array.clear(this.qVb);for(a=0;a<this.IJd.length;a++)(0,this.IJd[a])();Array.clear(this.IJd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=Gh.a.Vjj(this.SZh,a[c],this.Yga,this.XZh,this.WZh,this.MZh,this.PZh,this.YCc);Array.add(b,f)}b=On.a.eAi(b,Pc.App.mode);this.Yh.nj(this.lJd(),2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(F.a)(this,this.Gql,"spellCheckSucceeded"),Object(F.a)(this,this.Fql,"spellCheckFailed"),
Object.assign(new gk,{u_a:a,Ky:this.Zh.Ei("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}Gql(a){if(!this.BRc){a=a.data;this.WCc.track(a.state.Ky.Vq,"ProofingRequestRoundtrip");var b=this.Zh.Ei("DOMUpdate","Proofing");this.Hql(a);this.WCc.track(b.Vq,"UpdateProofingResults")}}Hql(a){fd.a.mark(7798);this.kba=null;var b=a.state.u_a;if(({group:c}=Pn.a.BEh(a.Wd)).returnValue){var c=c.Responses;var f=({U4k:b,q$k:c}=this.umj(b,c)).returnValue;if(0<f.length){const l=this.oe(f[0].request.paragraphNode);
try{for(const w of f){const H=w.request;this.YH.DSi(H.paragraphNode,()=>{this.Nlk(w.response,H)})}}finally{l&&l.dispose()}}b.length?(this.QSd(a),this.aNe(b),this.O1d()):this.p3k();this.QSd(a);for(const l of c)we.PageStats.OYb(l);this.O1d();this.executeNextRequest()}else this.aNe(b);fd.a.mark(7799)}umj(a,b){let c,f;const l=[];c=[];f=[];for(let w=0;w<a.length;w++){const H=a[w];if(!H.paragraphNode.isConnected)continue;const U=b[w];if(5===U.classId){const ja=U.Fault;if(ja)switch(ja.Type){case 1:ka.ULS.sendTraceTag(22390429,
324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.O9e,ja.Limit,ja.AttemptedValue);this.O9e=ja.Limit;break;default:ka.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(H)}else l.push(new vj(H,U));U.ServerPageStatsTrace&&f.push(U.ServerPageStatsTrace)}return{returnValue:l,U4k:c,q$k:f}}Nlk(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.nC)this.executeNextRequest();else{var f=this.oe(c),l=this.UZh.N3k(a);
if(b.jkg()){var w=b.range;const H=[w];l.Qmd(a)?(w=ql.a(this.Fm.GF(c)),1!==b.userAction&&c.ugi()&&this.RZh&&(a=l.mWf(a,b,w)),this.Oz.Fpd(c,H,b.MMf),a=l.$Vi(a,b,w),this.Fm.$sf(c,a)):this.myj(c,w);this.VCc.nHh(c)}c.tqc();f.dispose();this.TR(c)}else this.executeNextRequest()}myj(a,b){const c=[b];b=b.lcid;this.FNd.contains(b)||(ka.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.FNd.add(b));this.Oz.Fpd(a,c);this.WXb.Auf(a,c)}Fql(a){a=a.data;if(!this.BRc){var b=a.state;this.WCc.track(b.Ky.Vq,
"ProofingRequestRoundtrip");this.aNe(b.u_a);this.QSd(a);this.O1d()}}aNe(a){this.kba=a;a=new Le.a(3,1,this.E7,Object(F.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.$d.Db(a);++this.oxc;this.E7*=bi.qTe;this.E7>bi.cjc&&(this.E7=bi.cjc);4!==this.oxc||this.Yh.wFa||(this.H4a=Pc.App.Kb.notificationBar.LCa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,!0),Pc.App.Kb.notificationBar.$h(this.H4a),u.AFrameworkApplication.kj.jab(bi.nMh,1),ka.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),
this.Yh.BGc(this))}p3k(){this.oxc&&(this.oxc=0,this.E7=bi.mab);this.H4a&&(Pc.App.Kb.notificationBar.removeEntry(this.H4a),this.H4a=null,this.Yh.Old(this))}retryCurrentRequest(){this.executeRequest(this.kba)}MGb(){Pc.App.Kb.notificationBar.removeEntry(this.H4a);this.H4a=null;this.Yh.Old(this)}Mjc(){}get Gme(){return!this.Fqb.length&&!this.kba&&!this.NVb.length}QSd(a){we.PageStats.I6a("SpellCheck",a.Zt);(a=a.tj?a.tj[Sf.a.FCa]:null)&&we.PageStats.a6a(Ff.a.Kh,a)}O1d(){we.PageStats.vDa("SpellCheck")}}
bi.GMk="ProofingRequestsBatched";bi.FMk=1;bi.AMk="ProofingContextualResultsIsEnabled";bi.IMk="ProofingTrackMetricsIsEnabled";bi.DMk="ProofingInstrumentedAndContextualIsEnabled";bi.KMk="ProofingWithOneSpellerIsEnabled";bi.BMk="ProofingExperimentId";bi.JMk="ProofingWithEditorServiceIsEnabled";bi.CMk="ProofingFilterSpellCheckResultIsEnabled";bi.nMh=11093;bi.jmk=30;bi.mab=1E3;bi.qTe=5;bi.cjc=72E6;Object(n.a)(bi,"ProofingCheckOperator",null,[234,1469]);var Qn=d(523);class Rn{constructor(a){this.Kpb=a}$Vi(a,
b,c){if(this.jTe(a)){const f={};a=this.YUf(b,a,c,f);this.Zdi(b,f);return a}b&&this.$di(b);return[]}Zdi(a,b){this.Kpb.track(()=>Object.assign(new Qn.a,{E:a.Rfa,C:a.range.iVd,F:b}))}$di(a){this.Kpb.track(()=>Object.assign(new Qn.a,{E:a.Rfa,C:a.range.iVd}))}$kg(a,b,c){return!a||Qa.a.all(a,f=>f.begin!==b||f.end!==c)}Nog(a,b,c){return!!a&&Qa.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(n.a)(Rn,"AProofingResultsManager",null,[1490]);var wn=d(522),fl;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";
a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(fl||(fl={}));Object(n.b)("ProofingType",fl);class Il extends Rn{constructor(a,b,c,f=null){super(a);this.$a=f;this.ZRh=b;this.jN=c}Qmd(a){return a&&63===a.classId?!0:(ka.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}jTe(a){return this.Qmd(a)&&!!a.Critiques&&0<a.Critiques.length}YUf(a,b,c,f){const l=[];b=b.Critiques;for(const U of b)if(this.uzj(b,
U)&&this.lil(U)){var w=0<=a.range.maa?a.range.maa+U.Start:a.range.begin+U.Start;const ja=w+U.Length;var H=a.Rna.substring(w,ja);const wa=this.ZRh.create(U,this.Kpb,this.$a);wa.lcid=a.range.lcid;wa.token=H;wa.originalText=a.Rna;wa.maa=a.range.maa;wa.QJa=a.range.QJa;a.range.end>=ja&&(H=new Rm(w,ja,wa),Array.add(l,H));this.$kg(c,w,ja)&&(w=1===wa.proofingType?fl[wa.proofingType]:wa.typeId,f[w]=w in f?f[w]+1:1)}return l}mWf(a,b,c){if(!this.jTe(a))return a;const f=[];for(const l of a.Critiques){const w=
0<=b.range.maa?b.range.maa+l.Start:b.range.begin+l.Start;this.Nog(c,w,w+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}lil(a){return 2!==wn.b(a)||!this.jN.rUa}uzj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(n.a)(Il,"ProofingCheckResultsManager",Rn,[]);var qf=d(50),Vl=d(94);class Em{constructor(a,b,c,f,l,w,H){this.OCd=!1;H&&c.RK(Object(F.a)(this,this.HSk,"recheckAllParagraphs"));b.H9h(Object(F.a)(this,
this.Rrk,"onAfterParagraphMerge"));l&&l.xd(12).R7(Object(F.a)(this,this.rxk,"onParagraphDisconnected"));this.Oz=a;this.ZVb=f;this.Fm=w}rxk(a,b){zb.ParagraphReader.ae(b.node)&&this.Fm&&this.Fm.zed(b.node)}Rrk(a,b){this.Oz.Mdi(b);this.TR(b.Z_d.currentNode)}q9b(a){this.Oz.Gdl(a);this.TR(a)}HSk(a){if(2===a.mode&&(a=this.B8f(a)))for(a=Vl.a.Vz(a);a.moveNext();)zb.ParagraphReader.el(a.iterator)&&this.TR(a.currentNode)}suspend(){this.ZVb.suspend()}resume(){this.ZVb.resume()}get Gme(){return this.ZVb.Gme}get pYe(){return this.OCd}set pYe(a){if(this.OCd!==
a&&(this.OCd=a,a=this.B8f(Pc.App.Kb))){var b=new qf.GraphTransaction(2);try{b.set(a.Tj);const c=Vl.a.Vz(a);for(;c.moveNext();)zb.ParagraphReader.el(c.iterator)&&c.currentNode.Cv(16,!0)}finally{b&&b.dispose()}}}B8f(a){return(a.Ld.isEditingAllowed||a.Ld.hz)&&a.Ld.Dn.uo?a.Ld.Dn.xg:null}d8h(a){Array.add(this.ZVb.q8g,a)}TR(a){this.ZVb.TR(a,!1)}}Object(n.a)(Em,"ProofingManager",null,[1281]);var wj=d(1213),yr=d(666);class vo extends yr.a{constructor(a){super(a);this.tXb=null}get proofingType(){return 1}get suggestions(){return this.tXb?
Array.clone(this.tXb):null}Dfl(a){this.tXb=a}dMa(a,b=0){this.smf.track(()=>Object.assign(new Qn.a,{E:0,T:1,A:a,I:b}))}}Object(n.a)(vo,"OfficeSpellerErrorDetails",yr.a,[]);class Wl extends Rn{constructor(a){super(a)}Qmd(a){return!!a.Errors}jTe(a){return this.Qmd(a)&&0<a.Errors.length}YUf(a,b,c,f){let l=0;const w=[],H=b.Errors;for(let wa=0;wa<H.length;wa++){var U=H[wa],ja=Object.assign(new vo(this.Kpb),{token:U.Word,errorType:U.Type,lcid:a.range.lcid});ja.Dfl(wj.a.fKh(b.Suggestions,wa*wj.a.ppg));const Sa=
U.Offset+a.range.begin;U=Sa+U.Word.length;ja=new Rm(Sa,U,ja);Array.add(w,ja);this.$kg(c,Sa,U)&&l++}f.spelling=l;return w}mWf(a,b,c){if(Qa.a.Wa(c)||!a)return a;const f=[],l=[];for(let H=0;H<a.Errors.length;++H){const U=a.Errors[H];var w=U.Offset+b.range.begin;this.Nog(c,w,w+U.Word.length)&&(w=H*wj.a.ppg,Array.add(f,wj.a.JZj(a.Suggestions,w)),Array.add(f,wj.a.fKh(a.Suggestions,w)),Array.add(l,U))}a.Suggestions=f;a.Errors=l;return a}}Object(n.a)(Wl,"ProofingResultsManager",Rn,[]);class zr{constructor(a,
b,c){this.XCc=new qd.a;this.eaf=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.XCc.add(63,c.value);this.XCc.add(4,this.eaf)}N3k(a){if(this.XCc.Gb(a.classId))return this.XCc.ga(a.classId);ka.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.eaf}}Object(n.a)(zr,"ProofingResultsManagerResolver",null,[1280]);class tm{constructor(a=null,b=null){this.JD=this.fd=null;this.sNd=a;this.tNd=b}get Sf(){!this.fd&&this.sNd&&this.sNd.instance&&
(this.fd=this.sNd.instance.instance);return this.fd}get cuc(){!this.JD&&this.tNd&&this.tNd.instance&&(this.JD=this.tNd.instance.instance);return this.JD}mZi(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:c}TYi(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;
" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}vUa(a){return a.properties.sa(Za.a.vUa,!1)}rWf(a){a=zb.ParagraphReader.text(a);let b;const c=[];for(;b=tm.yCj.exec(a);)Array.add(c,new Dk.a(b.index+b[1].length,b.index+b[0].length));return c}sWf(a,b=!0,c=!1){let f=[],l=!1,w=!1,H=!1,U=!1,ja=-1;a=a.Ra;for(let Sa=0;Sa<a.length;Sa++){var wa=a.ga(Sa);wa.hyperlink?w=!0:wa.kn&&(w=!1);b&&wa.formatting&&(H=wa.formatting.cache.SUa);if(c&&(wa.IL&&(U=!1),wa.Vp)){const eb=Object(qa.a)(440,wa.Vp.Hh);eb&&
(U=eb.MEa)}l!==(w||H||U||!!wa.blob)&&(wa=wa.cp,l?Array.add(f,new Dk.a(ja,wa)):ja=wa,l=!l)}l&&(b=Dk.a.createTextRange(ja,a.last.cp))&&Array.add(f,b);return f}MSc(a,b=!0,c=!1){return ql.e(this.rWf(a),this.sWf(a,b,c))}x4b(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return Dk.a.createTextRange(b,c)}pVc(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=tm.J_f(a,b,c);for(var l=0;l<f.length;l++){var w=f[l];if(a<
w.begin)break;a<w.end&&(a=tm.J_f(w.end,b,c))}b=tm.g2f(b,c);for(l=f.length-1;0<=l;l--){w=f[l];if(b>w.end)break;b>w.begin&&(b=tm.g2f(w.begin,c))}return(a=Dk.a.createTextRange(a,b))&&a.CYj()?a:null}static J_f(a,b,c){for(;a<b&&ha.a.iz(c.charCodeAt(a));)a++;return a}static g2f(a,b){for(;0<a&&tm.fLj(a,b);)a--;return a}static fLj(a,b){a=b.charAt(a-1).toString();return a===Sd.AParagraphNode.IOc||a===Sd.AParagraphNode.j_}}tm.yCj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)",
"ig");Object(n.a)(tm,"ProofingTextUtility",null,[1468]);class iq{constructor(){this.Da=null}get name(){return"Box4.Proofing"}Zb(a){this.Da=a;this.Da.register(wr,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().oa(()=>new wr(this.Da.resolve("Box4.IParagraphReader"),R.a.instance.ga(14),R.a.instance.ga(70)));this.Da.register(mp,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().oa(()=>new mp(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),
this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.ISelectionManager"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),u.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Da.register(ed,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().oa(()=>new ed);this.Da.register(lp,"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().oa(()=>
new lp(tr.a.instance,this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(fq,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().oa(()=>new fq(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),
this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),nj.a.instance,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(tm,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().oa(()=>new tm(this.Da.Ja("Box4.TrackChange.ITrackChangeManagerFactory"),this.Da.Ja("Box4.TrackChange.ITrackChangeReaderFactory")));
const b=()=>{const c=u.AFrameworkApplication.fa.Ga("ProofingWebServiceBase");return(void 0===c?Pc.App.webServiceBase:c)+"proofing.ashx?"+u.AFrameworkApplication.hh};this.Da.register(vr,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().oa(()=>new vr(u.AFrameworkApplication.Ke,b));this.Da.register(Pb,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().oa(()=>new Pb(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),
Nc.a.instance));this.Da.register(Ca,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().oa(()=>new Ca(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),Nc.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors")));this.Da.register(S,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().oa(()=>new S(u.AFrameworkApplication.fa,this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(1278,
"Box4.Proofing.IProofingDescriptors").ma().oa(()=>new t(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Da.register(bi,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().oa(()=>new bi(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),u.AFrameworkApplication.fa,Pc.App.Kb,u.AFrameworkApplication.Ke,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"),Ij.a.instance,
this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,Pq.a.LW(4,1,new ur),this.Da.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.Da.Ja("Box4.Proofing.ICritiqueTypeSettings"),db.a.get_instance(),u.AFrameworkApplication.ye));this.Da.register(Wl,"Box4.Proofing.ProofingResultsManager").ma().oa(()=>new Wl(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Da.register(1279,"Box4.Proofing.IIgnoreAllKeywords").ma().oa(()=>new Sq);this.Da.register(Il,"Box4.Proofing.ProofingCheckResultsManager").ma().oa(()=>new Il(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),
this.Da.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa));this.Da.register(1280,"Box4.Proofing.IProofingResultsManagerResolver").ma().oa(()=>new zr(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.ProofingResultsManager"),this.Da.ke("Box4.Proofing.ProofingCheckResultsManager")));this.Da.register(1281,"Box4.IProofingManager").ma().oa(()=>new Em(this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Da.resolve("Box4.IParagraphEditor"),this.Da.resolve("Box4.IAppFrame"),this.Da.resolve("Box4.Proofing.IProofingCheckOperator"),this.Da.rb("Box4.INotebookManager").kV,this.Da.rb("Box4.Proofing.IErrorRangeEditor"),4!==Pc.App.mode));this.Da.register(1282,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().oa(()=>new xc(u.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),Pq.a.LW(15,1,new Qq)));this.Da.register(1283,"Box4.Proofing.IProofingConfigV2Manager").ma().oa(()=>
new Tq(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),Nc.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){v.a.instance.Dc(new iq)}}Object(n.a)(iq,"Box4ProofingPackage",null,[2,3]);var Mi=d(175);class cg{constructor(a){this.B2e=0;this.Z$a=this.dJb=this.Ykb=null;this.Maa=
u.AFrameworkApplication.Aa.lV;this.DQ=a;this.DQ.yu(Ce.a.Lqh);this.DQ.KB(Ce.a.Lqh,Object(F.a)(this,this.$xk,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.Z$a)return ka.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.Z$a;this.Ykb=this.Maa.Ei("ComponentAttach","getCustomAuthConfig");return this.Z$a=new Promise((a,b)=>{const c={};let f=!1,l=!1,w=0;this.B2e=window.setInterval(()=>{4>w?(w++,this.DQ.sendMessage(Ce.a.getCustomAuthConfig,c)):(window.clearInterval(this.B2e),
f=!0,ka.ULS.sendTraceTag(588087303,344,10,Jc.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.dJb=(H,U)=>{window.clearInterval(this.B2e);f||l||(l=!0,H?(ka.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(H)):(ka.ULS.sendTraceTag(589050654,369,10,Jc.c({["error"]:U.toString()})),b(U)))};this.DQ.sendMessage(Ce.a.getCustomAuthConfig,c)})}$xk(a){try{const b=Jc.a(a.Values[Mi.a.Soi]);let c=u.AFrameworkApplication.fa.Ga("Application")||"";c=ha.a.rg(c);
b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.Ykb&&(this.Ykb.stop(),this.Ykb=null);this.dJb(b,"")}catch(b){ka.ULS.sendTraceTag(589050655,344,10,Jc.c({["error"]:b.message,["stack"]:b.stack})),
this.dJb(null,b.message)}}}Object(n.a)(cg,"AccountSwitchingManager",null,[1371]);class jq{get name(){return"Common.App.AccountSwitching"}Zb(a){a.register(cg,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().oa(()=>new cg(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){v.a.instance.Dc(new jq)}}Object(n.a)(jq,"AccountSwitchingPackage",null,[2,3]);class qt{constructor(){this.Pa=new vc.a}VGc(a){this.Pa.addHandler("OnEditHappenedEvent",
a)}jPk(){this.Pa.raiseEvent("OnEditHappenedEvent")}}Object(n.a)(qt,"EditNotificationEventSource",null,[]);var wo=d(102);class xu{constructor(a,b,c,f,l,w,H=0){this.VAd=!1;this.UAd=this.p4a=null;this.krf=!1;this.$d=b;this.QBc=a;this.JNa=c;this.qha=f;this.irf=l;this.CRh=w;this.syc=0;this.rzc=!1;try{0<H&&(this.syc=H,3E5>this.syc&&(this.syc=3E5),this.$d&&!this.UAd&&(this.UAd=new Le.a(3,2,this.syc,Object(F.a)(this,this.c2k,"reportEditDocumentUserActionTelemetryIfNecessary")),this.$d.Db(this.UAd)))}catch(U){ka.ULS.sendTraceTag(51246176,
383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+U)}}get $Il(){return this.krf}s1d(){this.$Il?this.rzc=!0:(this.krf=!0,dg.Health.instance.addQosPillar("Save"),dg.Health.instance.addQosPillar("ContentCreation"),wo.c(G.a.editDocument));this.VAd=!0;this.irf&&this.irf.xsf();this.qha&&this.qha.jPk();u.AFrameworkApplication.Zg&&u.AFrameworkApplication.Zg.tlk();this.CRh&&!this.p4a&&(this.kqc(null),this.p4a=new Le.a(3,2,this.QBc,Object(F.a)(this,this.kqc,
"sendPostMessageIfNecessary"),113),this.$d.Db(this.p4a))}kqc(){this.VAd&&(this.JNa.CWR(()=>this.JNa.result.sendMessage(Ce.a.editNotification,null)),ka.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.VAd=!1)}c2k(){try{this.rzc&&(wo.c(G.a.editDocument),this.rzc=!1)}catch(a){this.rzc=!1,ka.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}Object(n.a)(xu,"EditNotificationManager",null,[1370]);
class yu{constructor(a,b,c,f,l){this.vCd=this.p4a=null;this.tob=this.pxd=!1;this.$d=b;this.QBc=a;this.JNa=c;this.GP=f;this.SHd=l;this.xhh(null)}xhh(){const a=document.getElementById(u.AFrameworkApplication.uZb);!this.tob&&this.GP&&a&&(this.GP.pb(sa.a.mq,a,Object(F.a)(this,this.bFe,"mouseActivityHandler"),null),this.tob=!0);this.SHd(()=>{this.dispose()})}bFe(){this.tob&&(this.GP.yb(sa.a.mq,document.getElementById(u.AFrameworkApplication.uZb),Object(F.a)(this,this.bFe,"mouseActivityHandler")),this.tob=
!1);this.xsf();return!1}xsf(){this.pxd=!0;this.vCd||(this.vCd=new Le.a(3,2,this.QBc,Object(F.a)(this,this.xhh,"registerHandlerTask"),112),this.$d.Db(this.vCd));this.p4a||(this.kqc(null),this.p4a=new Le.a(3,2,this.QBc,Object(F.a)(this,this.kqc,"sendPostMessageIfNecessary"),111),this.$d.Db(this.p4a))}kqc(){this.pxd&&(this.JNa.CWR(()=>this.JNa.result.sendMessage(Ce.a.QIl,null)),ka.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.pxd=!1)}dispose(){this.tob&&
(this.GP.yb(sa.a.mq,document.getElementById(u.AFrameworkApplication.uZb),Object(F.a)(this,this.bFe,"mouseActivityHandler")),this.tob=!1)}}Object(n.a)(yu,"UserActivityHostNotificationManager",null,[1365,106]);var fm=d(134),Uq=d(291);class Pp{constructor(){this.Da=null}get name(){return"Common.App.EditNotification"}init(){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ff(Object(F.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){Pp.OQi&&0<Pp.t1d&&(this.Da.register(qt,"Common.App.HostNotification.EditNotificationEventSource").ma(),
this.Da.register(yu,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().oa(()=>new yu(6E4,fm.a.instance,Uq.a.av(this.Da.Ja("Postmessage.IHostPostmessenger")),ra.a.instance,u.AFrameworkApplication.vga)),this.Da.register(xu,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().oa(()=>new xu(Pp.t1d,fm.a.instance,Uq.a.av(this.Da.Ja("Postmessage.IHostPostmessenger")),this.Da.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.rb("Common.Interface.IUserActivityHostNotificationManager"),Pp.PQi,Pp.MQi)),this.Da.resolve("Common.Interface.IEditNotificationManager"),ka.ULS.shipAssertTag(38086291,209,0<Pp.t1d,"EditNotification Interval is less than or equal to 0."))}Zb(a){this.Da=a}dispose(){}static get t1d(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get MQi(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get OQi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get PQi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){v.a.instance.Dc(new Pp)}}Object(n.a)(Pp,"CommonHostNotificationPackage",null,[2,3]);class Sm{}Sm.kdd="ReactSharedHeaderMeControlFlexPane";Sm.JEa="headerui";Sm.Y_b="chat_wrapper_pane";Object(n.a)(Sm,"ReactSharedHeaderConstants",null,[]);class zu{constructor(a){this.emf=
0;this.czd=null;this.p_h=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get SXe(){return this.p_h.value}wb(){this.isInitialized?this.vld():this.pWk(Object(F.a)(this,this.vld,"registerActionsInternal"))}vld(){ka.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(F.a)(this,this.Qsk,"onChatContainerReady"))}).catch(a=>{ka.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(F.a)(this,this.Wri,"chatCountChanged"))}).catch(a=>{ka.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(F.a)(this,this.Tsk,"onChatKeyPress"))}).catch(a=>{ka.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){ka.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}Wri(a){ka.ULS.sendTraceTag(50595970,
333,50,"Chat count:{0}",a);if(!a)this.SXe.Psk();else if(1===a&&!this.emf){const b=document.getElementById(this.czd?this.czd:Sm.Y_b);b?this.SXe.Usk(b,Object(F.a)(this,this.Qyl,"transferFocusToChat")):ka.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.emf=a}Qsk(a){this.czd=a}Tsk(a){a.ctrlKey&&"f6"===a.key.toLowerCase()&&this.Pyl(a.shiftKey)}pWk(a){ze.a.instance.pb(sa.a.Vtl,window.self,()=>{a();return!0})}Qyl(){ka.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&
this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{ka.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){ka.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}Pyl(a){ka.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.SXe.Rsk(a)}}Object(n.a)(zu,"ChatManager",null,[1364]);class $v{constructor(){this.Pa=new vc.a;this.Cqf=!1}cbi(a){this.Pa.addHandler("OnTopRowControlsCreatedEvent",a)}Kai(a){this.Pa.addHandler("OnRenameTextboxStatusChangedEventKey",
a)}get iyl(){return this.Cqf}ZPk(){this.Cqf=!1;this.Pa.raiseEvent("OnTopRowControlsDisposingEvent")}pfh(a){this.Pa.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(n.a)($v,"HeaderEventSource",null,[]);var kq=d(201);class Au{constructor(a,b,c,f,l){this.pFc=null;this.Od=a;this.xK=b;this.GP=c;this.l3h=f;this.Ca=l}whh(a,b,c,f=null){const l=this.Od.Fc(b);l.parent=c;l.dJ=!0;f&&l.kca(f);this.GP.N7(b,a,!1);this.l3h.N7(b,a,!1);b=new kq.DOMFocusListing(()=>a);b.Io(2);b.Io(1);b.Io(8);
b.Io(5);b.Io(3);b.Io(6);this.Od.Yia(()=>a,l,b).rX=!0;b=x.KeyInputManager.Oa(A.a.Sq,0);c=x.KeyInputManager.Oa(A.a.Sq,4);l.Dp(b);l.Dp(c)}onFlexPaneOpen(a){this.whh(a,Sm.kdd,Sm.JEa);this.Od.rf(Sm.kdd);this.xK.P2(Sm.kdd)}onFlexPaneClose(){this.xK.Lo(Sm.kdd);this.Od.rf(Sm.JEa)}Usk(a,b){this.pFc||(this.pFc=b,this.whh(a,Sm.Y_b,E.AFrame.ND,Object(F.a)(this,this.Ssk,"onChatFocus")));this.Od.rf(Sm.Y_b);this.xK.P2(Sm.Y_b)}Ssk(){this.pFc&&this.pFc()}Psk(){this.xK.Lo(Sm.Y_b);this.Od.aRc(E.AFrame.EW)}Rsk(a){this.Ca.processAction(a?
G.a.a3d:G.a.Jwd,2)}}Object(n.a)(Au,"ReactSharedHeaderFocusManager",null,[633]);var iy=d(524);class Bu{constructor(a){this.Ca=a}wb(){this.Ca.ya(G.a.oRc,Xd.a.frame,Object(F.a)(this,this.l0g,"navigateToUpsellPage"));this.Ca.ya(G.a.w1i,Xd.a.frame,Object(F.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.Ca.ya(G.a.i2k,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.Okh,Xd.a.frame,ac.ActionManager.Ng)}l0g(a,b,c,f,l){if(1===c)return 32;a=8;2===c&&(c=this.N6d(l,"experience","gopremiumribbon"),
l=ig.a.OW("2116536"),l=ig.a.f6a(l,"ocid",iy.b(u.AFrameworkApplication.Aa.hb.Uk,u.AFrameworkApplication.Aa.hb.gJa,c)),Kd.a.vn(l,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Ca.processAction(G.a.Okh,2),ka.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return a}launchUpsellExperience(a,b,c,f,l){if(1===c)return 32;var w=8;2===c&&(ka.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(w=Ab.a.instance.rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(a=this.N6d(l,"experience","gopremium"),l=this.N6d(l,"dimeCampaignId",null),w.launchUpsellExperience(a,l),w=32):(ka.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),w=this.l0g(a,b,c,f,l)));return w}N6d(a,b,c){a&&a[b]&&(c=Object(qa.a)(String,a[b]));return c}}Object(n.a)(Bu,"UpsellActor",null,[1363]);class Cu{constructor(){this.Da=null}get name(){return"Common.App.Header"}init(){Ab.a.instance.resolve("Common.App.Header.IUpsellActor").wb();Ab.a.instance.resolve("Common.App.Header.IChatManager").wb()}dispose(){}Zb(a){this.Da=
a;this.Da.register($v,"Common.App.Header.HeaderEventSource").ma();this.Da.register(Bu,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().oa(()=>new Bu(u.AFrameworkApplication.Ta));this.Da.register(Au,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().oa(()=>new Au(u.AFrameworkApplication.Aa.Vr,u.AFrameworkApplication.Aa.Pw,u.AFrameworkApplication.Aa.WR,u.AFrameworkApplication.Aa.xlb,u.AFrameworkApplication.Ta));this.Da.register(zu,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().oa(()=>new zu(this.Da.ke("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){v.a.instance.Dc(new Cu)}}Object(n.a)(Cu,"CommonAppHeaderPackage",null,[2,3]);class aw{constructor(a,b,c,f=null,l=null){this.nF=a;this.aTb=b;this.YSb=c;this.Wlf=f;this.VVb=l}zPc(a){const b=new Sys.StringBuilder(this.nF.Bpc);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.W9d(a));
b.append("&");b.append(u.AFrameworkApplication.hh);u.AFrameworkApplication.Ke.nj(b.toString(),1,null,null,!0,2,Object(F.a)(this,this.oEa,"getRequestSuccessCallback"),Object(F.a)(this,this.nka,"getRequestFailureCallback"),null)}zvb(a){var b=new Sys.StringBuilder(this.nF.Bpc);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(u.AFrameworkApplication.hh);b=b.toString();a=Jc.c(a);u.AFrameworkApplication.Ke.nj(b,2,a,null,!0,4,Object(F.a)(this,
this.$Hk,"postRequestSuccessCallback"),Object(F.a)(this,this.kaa,"postRequestFailureCallback"),null)}oEa(a){let b=!1,c=null;try{if(0<a.data.Wd.length){const f=Object(qa.a)(Object,Jc.a(a.data.Wd)),l=f?f[this.nF.fRd]:null;l&&(c=Object(qa.a)(Object,Jc.a(l.toString())))}b=!0}catch(f){this.nka(null)}b&&this.aTb&&this.aTb(a.data,c)}nka(a){this.YSb&&this.YSb(a?a.data:null)}$Hk(a){this.Wlf&&this.Wlf(a?a.data:null)}kaa(a){this.VVb&&this.VVb(a?a.data:null)}W9d(a){const b=new Sys.StringBuilder("requestedsettings=");
for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(n.a)(aw,"FirstRunExperienceRequestHandler",null,[]);var Du=d(403);class bw{constructor(){this.HSb=this.Wyc=this.nF=null}aZe(a){a?(this.nF=a,this.oRj()&&(ka.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Ka.a,a.add(this.nF.fRd),this.Wyc=new aw(this.nF,Object(F.a)(this,this.oEa,"getRequestSuccessCallback"),Object(F.a)(this,this.nka,
"getRequestFailureCallback"),null,Object(F.a)(this,this.kaa,"postRequestFailureCallback")),this.Wyc.zPc(a)),(this.nF.cog||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.bZe()):ka.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}oRj(){try{if(this.nF.cog)return!0;if(!u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||u.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;
if(this.nF.eNj||this.nF.IAb||u.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=u.AFrameworkApplication.fa.Ga("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){ka.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",a?a.toString():null)}return!1}uoh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.nF.fRd]=Jc.c(c);ka.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.Wyc&&this.Wyc.zvb(b)}oEa(a,b){a=a?+a.qv-+a.Zt:-1;a>this.nF.Umh?ka.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",a,this.nF.Umh):b?this.yll(b)?(ka.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.nF.TZg),this.bZe()):(this.y0d(!1),
ka.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ka.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.bZe())}nka(a){this.y0d(!1);ka.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.ie:-1)}kaa(a){ka.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
a?a.ie:-1)}bZe(){this.y0d(!0);var a=Ab.a.instance.rb("Common.ISystemInitiatedFeedback");a?this.rwh(a):(ka.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((a=Ab.a.instance.Ja("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.rwh(b)}):ka.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}rwh(a){if(a){var b=this.nF.S_i;
b&&(u.AFrameworkApplication.Wj(b),u.AFrameworkApplication.Ibc(b));ka.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.HSb=Object(F.a)(this,this.Fuk,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.HSb,!0),window.addEventListener("FRELaunchedEvent",this.HSb,!0)):(ka.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.uoh(this.nF.currentVersion))}else ka.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}Fuk(a){if(a){var b=a.detail;a=a.type;var c=this.nF&&this.nF.vDf?this.nF.vDf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(ka.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.uoh(this.nF.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.HSb,!0),window.removeEventListener("FRELaunchedEvent",
this.HSb,!0))}}yll(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.nF.TZg)return!0}else if(u.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in a&&a.VersionDisplayed<this.nF.currentVersion)return ka.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}y0d(a){u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Du.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(n.a)(bw,"FirstRunExperienceLauncher",null,[1338]);class Eu{constructor(){this.Da=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Zb(a){this.Da=a;this.Da.register(1338,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().oa(()=>new bw)}init(){}dispose(){}static main(){v.a.instance.Dc(new Eu)}}Object(n.a)(Eu,"FirstRunExperienceLauncherPackage",null,[2,3]);class rt{constructor(){this.mxd={}}m5h(a){this.mxd[a.id.toString()]=
a}tqk(a){const b=this.mxd;for(let c in b)b[c].notify(a,!1);this.mxd={}}uNk(a,b){b&&this.m5h(b);return this.x6g(a,b)}A1d(a){this.tqk(a)}XRf(a,b){a.notify(b,!0)}}Object(n.a)(rt,"AEventEmitter",null,[1362]);var ms;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(ms||(ms={}));Object(n.b)("EventResultState",ms);class ns{constructor(){this._state=0}get state(){return this._state}set state(a){ka.ULS.sendTraceTag(5849616,202,
50,"Changing event result state. {0}",{["OldState"]:ms[this._state],["NewState"]:ms[a]},"ResultType",this.E6f());this._state=a}}Object(n.a)(ns,"AEventResult",null,[1399]);class cw extends ns{constructor(){super();this.aMd=this.RVb=null;this.state=0;this.BDd=this.Qef=!1}get DR(){return this.RVb}get CLa(){return this.aMd}get BIj(){return this.Qef}E6f(){return"GetMoreInfo Result"}}Object(n.a)(cw,"GetMoreInfoResult",ns,[1398,1399]);var Fu=d(438),dw=d(525);class op{constructor(a,b,c,f,l,w,H,U){this.Ca=
a;this.Yh=b;this.YH=c;this.Zga=f;this.$d=l;this.XSb=w;this.zTh=H;this.HEc=U}dVk(){this.NGb.ya(G.a.OHb,Xd.a.frame,Object(F.a)(this,this.OHb,"openUrlInNewTab"));this.NGb.ya(G.a.NJe,Xd.a.frame,Object(F.a)(this,this.NJe,"openDocumentUrl"));u.AFrameworkApplication.Pca?this.Crg():this.NGb.ra(G.a.mOc,Xd.a.frame,Object(F.a)(this,this.mOc,"documentLoaded"),96)}OHb(a,b,c,f,l){l&&l.MenuItemId&&(ka.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:dw.a[this.una]}),Kd.a.vn(l.MenuItemId.toString(),
"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}NJe(a,b,c,f,l){if(l&&l.MenuItemId){const w=u.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),H=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");ka.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",w,H);if(w&&H){ka.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:dw.a[this.una]});a=l.MenuItemId.toString();
const U={};U[Mi.a.$Jb]="1";U[Mi.a.documentUrl]=a;U[Mi.a.reason]=Fu.a.open;ka.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");u.AFrameworkApplication.nT().execute(ja=>{ja.sendMessage(Ce.a.mDa,U)})}else this.OHb(a,b,c,f,l)}return 32}mOc(){this.Crg();return 32}$bb(a,b,c=""){if(b&&b.Zt){const f=ck.a[b.status];b=b.Zt.getTime();const l=this.EF()-b;ka.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,
["StartTime"]:b,["Notes"]:c})}else ka.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}Crg(){var a=u.AFrameworkApplication.fa.ka("QPGVCI"),b=ig.a.kT(document.URL,"wdNewAndOpenCt",a);if(b){b=parseInt(b);var c=ig.a.kT(document.URL,"wdPreviousSession",a);a=ig.a.kT(document.URL,"wdPreviousCorrelation",a);var f=u.AFrameworkApplication.fa.ka("NAOPLP");if(u.AFrameworkApplication.Pca){var l=u.AFrameworkApplication.Pca.getTime();!b||
b>l?ka.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):ka.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else ka.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get NGb(){return this.Ca.value}get Njc(){return this.Yh.value}get s0g(){return this.YH.value}get una(){return this.Zga.value}get bed(){return this.$d.value}get EF(){return this.XSb}get tna(){return this.zTh.value}get DLa(){return this.HEc.value}static get instance(){return op.Ka||(op.Ka=op.xr())}static xr(){return new op(new kc.a(()=>u.AFrameworkApplication.Ta),new kc.a(()=>u.AFrameworkApplication.Ke),new kc.a(()=>u.AFrameworkApplication.Aa),
new kc.a(()=>u.AFrameworkApplication.Aa.hb.Uk),new kc.a(()=>u.AFrameworkApplication.ye),()=>(new Date).getTime(),new kc.a(()=>u.AFrameworkApplication.Aa.hb.tna),new kc.a(()=>u.AFrameworkApplication.DLa))}}op.Ka=null;Object(n.a)(op,"NewAndOpenCommonHelpers",null,[1361]);class ew{constructor(a,b,c){this.bEc=this.Xm=null;this.gKd=0;this.D0h=a;this.$d=b;this.maf=c}Kdi(){this.gKd=this.UKb+1}YSe(a){this.Xm&&(this.$d.Mg(this.Xm),this.Xm=null);a&&(this.gKd=0)}Prl(a){const b=this.lxl;0<=b?(this.Kdi(),this.YSe(!1),
this.Xm=new Le.a(4,1,b,a,107),this.$d.Db(this.Xm)):(this.YSe(!0),ka.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.maf}))}get UKb(){return this.gKd}get lxl(){return this.UKb>=this.dqh.length?-1:this.dqh[this.UKb]}get dqh(){if(!this.bEc){const a=(this.D0h.value||"0").split(",");this.bEc=[];for(let b=0;b<a.length;b++){const c=parseInt(a[b]);isNaN(c)?ka.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.maf,["Entry"]:a[b]}):
Array.add(this.bEc,c)}}return this.bEc}}Object(n.a)(ew,"RetryHelper",null,[]);class um extends rt{constructor(a,b){super();this.Pha=a;this.uWb=new ew(b,this.sjc.bed,"GetMoreInfo");this.Wx=new cw}Tkk(){this.eEe("Document opened")}PFi(a){return()=>{this.eEe(a,!0)}}x6g(a,b=null){ka.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.Wx.state?(b&&this.XRf(b,this.Wx),ka.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):
this.eEe(a);return this.Wx}eEe(a,b=!1){this.uWb.YSe(!b);1===this.Wx.state?ka.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.uWb.UKb}):(ka.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.uWb.UKb}),this.Wx.state=1,b=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.sjc.tna,u.AFrameworkApplication.hh),this.sjc.Njc.cW(b,1,null,null,[um.Llf,um.Npf],5,this.SEi(),this.REi(a),
null))}SEi(){return a=>{var b=!1;let c=!1;var f=!1,l;u.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.Wd?({sv:l}=Jc.d(a.data.Wd)).returnValue?l?(f=!0,this.Wx.aMd=l.StorageServiceDisplayName,this.Wx.RVb=um.Gog(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.Wx.DR&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ga("FileSource")&&(this.Wx.RVb=ig.a.joa(u.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.Wx.DR&&""!==this.Wx.CLa):ka.ULS.sendTraceTag(25298113,
202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):ka.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):ka.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));f||((l=a.data.tj)?(this.Wx.aMd=(l[um.Npf]||"").toString(),b=(l[um.Llf]||"").toString(),
this.Wx.RVb=um.Gog(b)?b:"",""===this.Wx.DR&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ga("FileSource")?(this.Wx.RVb=ig.a.joa(u.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.Wx.DR&&""!==this.Wx.CLa):b=""===b&&""!==this.Wx.CLa):(ka.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.uWb.UKb,c,b,f);this.sjc.$bb("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",
a.data,f);this.qqh(3,b,c)}}REi(a){return b=>{this.sjc.$bb("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.qqh(2);this.uWb.Prl(this.PFi(a))}}qqh(a,b=!1,c=!1){this.Wx.state=a;this.Wx.Qef=b;this.Wx.BDd=c;this.A1d(this.Wx)}get sjc(){return this.Pha.value}static get instance(){return um.Ka||(um.Ka=um.xr())}static xr(){return new um(new kc.a(()=>op.instance),new kc.a(()=>u.AFrameworkApplication.wej))}static Gog(a){if(!a)return ka.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),
!1;if(ha.a.rg(a).startsWith("https://"))return!0;ka.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}um.Llf="PersonalFileStorageUrl";um.Npf="StorageServiceDisplayName";um.Ka=null;Object(n.a)(um,"GetMoreInfoActor",rt,[]);class pp{constructor(a,b,c,f,l){this.bUh=6E4;this.veg="inactive";this.psf="active";this.Jha=!0;this.$d=a;this.bTh=b;this.XSb=c;this.iFc=f;this.Pa=new vc.a;l&&this.Hrl();this.phf=this.$3f()}Fsf(a){this.Pa.addHandler(this.psf,a)}H7h(a){this.Pa.addHandler(this.veg,
a)}Hrl(){const a=new Le.a(5,2,this.bUh,Object(F.a)(this,this.wDj,"inactiveLoop"),108);this.xDj.Db(a)}wDj(){const a=this.$3f(),b=this.EF()-a;b>this.ytd&&this.Jha&&(ka.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.Jha=!1,this.Pa.raiseEvent(this.veg));a-this.phf>this.ytd&&(this.Jha=!0,this.Pa.raiseEvent(this.psf));this.phf=a}get xDj(){return this.$d.value}get $3f(){return this.bTh}get EF(){return this.XSb}get ytd(){return this.iFc.value}static get instance(){return pp.Ka||
(pp.Ka=pp.xr())}static xr(){return new pp(new kc.a(()=>fm.a.instance),()=>u.AFrameworkApplication.$ne.getTime(),()=>(new Date).getTime(),new kc.a(()=>u.AFrameworkApplication.ytd),!0)}}pp.Ka=null;Object(n.a)(pp,"InactivityManager",null,[]);var os=d(923);class fw extends ns{constructor(){super();this.KXh=this.Gjf=this.Fjf=null;this.state=this.yqf=0;this.BDd=!1}get HFe(){return this.Fjf}get S_g(){return this.Gjf}get oxl(){return this.yqf}E6f(){return"MruActor Result"}}Object(n.a)(fw,"MruResult",ns,[1400,
1399]);class Gu{constructor(a,b,c){this.task=null;this.mab=a;this.Bmk=b;this.taskManager=c;this.retryCount=this.l9b=0;this.gJd=this.dbc=null}dTj(a,b){return a===Nk.a.c5d||20===b||18===b||3===b}GUj(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get qjd(){return this.gJd}reset(){this.l9b=this.retryCount=0;this.gJd=this.dbc=null;this.task&&(this.taskManager.Mg(this.task),this.task=null)}nHj(a,b,c,f){this.gJd=String.format("{0}_{1}",
c,f);if(this.retryCount>=this.Bmk)return ka.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.dTj(c,f))return ka.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.GUj(f)&&1<=this.l9b)return this.dbc=c,!1;b=Math.max(b,this.mab*Math.pow(2,this.l9b));if(26===f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.dbc||412!==this.dbc)?b=500:this.l9b+=1;this.dbc=c;this.retryCount+=1;this.task&&this.taskManager.Mg(this.task);
ka.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new Le.a(2,1,b,a,107);this.taskManager.Db(this.task);return!0}}Object(n.a)(Gu,"RetryManager",null,[]);var Sn=d(222),Sg=d(70);class gw{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(gw,"WriteOptions",null,[]);class ln extends rt{constructor(a,b,c,f,l,w,H){super();this.Pha=a;this.RWh=b;this.SOa=new Gu(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.VO.bed);this.vPa=new Gu(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.VO.bed);this.t_h=c;this.Rrf=f;this.G4h={};this.r7=new fw;this.YSh=l;this.GBc="";this.gF=w;this.Ebf=H}get Awd(){return this.G4h}lXk(){this.VO.NGb.ya(G.a.ckh,Xd.a.frame,
Object(F.a)(this,this.M0k,"renameMruEntry"))}M0k(){return this.f7e("Rename")}alk(){this.xYg("File Opened")}blk(){this.xYg("IntervalUpdate")}xYg(a){ka.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.f7e(a)}pQ(a){(a=ha.a.pQ(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}t_f(){switch(this.VO.una){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}$oj(a){var b=this.YSh();
if(!b)return null;const c=new gw;c.documentUrl=this.Ebf.value?encodeURI(b):b;c.mruItemId=this.GBc;c.app=this.t_f();if(b=this.gF())c.folderName=b.breadcrumbFolderName,b=b.$w,c.documentName=ha.a.XG(b),c.documentExt=this.pQ(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(c)}f7e(a,b=!1){if(4===
this.VO.una&&!u.AFrameworkApplication.kOc)return 2;var c=Sn.a.Uz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.GBc?"true":"false"),c.set("URLEncoded",this.Ebf.value?"true":"false"));dg.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.$oj(c);if(!a)return b=!u.AFrameworkApplication.smb,c&&(c.set("WebEditingIsEnabled",u.AFrameworkApplication.smb?"true":"false"),c.set("ProtectedFile",u.AFrameworkApplication.BM?"true":"false")),dg.Health.instance.recordKpiFailure("WriteMru",
"MissingDocumentUrl",b,!1,Object.assign(new Nj.a,{extendedProperties:c})),2;this.vPa&&!b&&this.vPa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.VO.tna,this.Uqg);this.Rrf?this.Awd["X-FileId"]=u.AFrameworkApplication.hh:c+=String.format("&{0}",u.AFrameworkApplication.hh);u.AFrameworkApplication.gd&&(this.Awd["X-Office-AudienceGroup"]=Object(qa.a)(String,u.AFrameworkApplication.gd.AudienceGroup)||"");this.Awd["X-Timeout"]=15E3;return this.VO.Njc.nj(c,2,a,this.Awd,!0,5,Object(F.a)(this,
this.DMl,"writeMruV2EntryOnServerSuccessCallback"),Object(F.a)(this,this.mJi,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}DMl(a){this.Dag(a.data)}Dag(a){const b=Sn.a.Uz();this.vPa&&(b&&this.vPa.qjd&&(b.set("LastError",this.vPa.qjd),b.set("NumRetries",this.vPa.retryCount.toString())),this.vPa.reset());const c=os.c(a.Wd);c&&c.diagnostics_data&&(this.GBc=c.diagnostics_data.mru_id);a=+a.qv-+a.Zt;b&&b.set("RequestDuration",a.toString());dg.Health.instance.recordKpiSuccess("WriteMru",
Object.assign(new Nj.a,{extendedProperties:b}))}mJi(a){if(a.data.ie===Nk.a.T1b)this.Dag(a.data);else{var b=a.data.ie===Nk.a.Pmc,c=Sn.a.Uz();this.abg(this.vPa,a,this.aJi(),c);c&&(c.set("StatusCode",a.data.ie.toString()),b||this.WOd(a.data,c));dg.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.ie),b,!1,Object.assign(new Nj.a,{extendedProperties:c}))}}aJi(){return()=>{this.f7e("Retry",!0)}}Cej(){this.Qcd("Polling")}Bej(){this.Qcd("Retry",!0)}Vkk(){this.Qcd("Open")}Ukk(){this.Qcd("Activity")}Qcd(a,
b=!1){ka.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const c=Sn.a.Uz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"));dg.Health.instance.recordKpiUsage("GetMru",0,"smartfio",c);this.SOa&&!b&&this.SOa.reset();this.TEi(Object(F.a)(this,this.Eej,"getMruV2FromServerSuccessCallback"),Object(F.a)(this,this.Aej,"getMruFromServerFailureCallback"))}WOd(a,b){a&&a.tj&&(a=a.tj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}Y3j(a,b){a&&(b&&b.set("RequestDuration",
(+a.qv-+a.Zt).toString()),dg.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Nj.a,{extendedProperties:b})))}Eej(a){this.Fej(a)}Fej(a){var b="";let c=null,f=null,l=null;const w=os.c(a.data.Wd);w&&(c=w.places?w.places.items:[],f=w.documents?w.documents.items:[],(l=os.a(w,!1))&&(b=Jc.c(l)));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.GFa&&Sg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0));b=Sn.a.Uz();this.SOa&&(b&&this.SOa.qjd&&(b.set("LastError",this.SOa.qjd),
b.set("NumRetries",this.SOa.retryCount.toString())),this.SOa.reset());l||c||f?(this.VO.$bb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.mvd(3,l,c,f),this.Y3j(a.data,b)):(this.VO.$bb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),b&&this.WOd(a.data,b),dg.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Nj.a,{extendedProperties:b})),this.mvd(3,null,null,null,!0));this.A1d(this.r7)}abg(a,b,c,f){let l=0,w=0;const H=
os.c(b.data.Wd);H&&(null!=H.response_code&&(l=H.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.GBc="")),H.error_data&&null!=H.error_data.retry_after_ms&&(w=H.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",w.toString())));a&&(b=a.nHj(c,w,b.data.ie,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}Aej(a){this.Dej(a)}Dej(a){const b=a.data.ie===Nk.a.Pmc,c=Sn.a.Uz();c&&(c.set("StatusCode",a.data.ie.toString()),b||this.WOd(a.data,
c));this.VO.$bb("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.mvd(2);this.abg(this.SOa,a,Object(F.a)(this,this.Bej,"getMruFromServerRetryTask"),c);dg.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.ie),b,!1,Object.assign(new Nj.a,{extendedProperties:c}));this.A1d(this.r7);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.GFa&&Sg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}mvd(a,b=null,c=null,f=null,l=!1){if(3!==this.r7.state||3===a)this.r7.Fjf=b,this.r7.Gjf=c,this.r7.KXh=f,this.r7.state=a,this.r7.BDd=l,this.r7.yqf=this.VO.EF()}x6g(a,b){ka.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.r7.state});b&&3===this.r7.state&&this.XRf(b,this.r7);return this.r7}TEi(a,b){this.mvd(1);let c;const f={};c=String.format(this.VO.tna+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.t_f(),this.Uqg);this.t_h.value||
(c+="&entity=docs");u.AFrameworkApplication.gd&&(f["X-Office-AudienceGroup"]=Object(qa.a)(String,u.AFrameworkApplication.gd.AudienceGroup)||"");this.Rrf?f["X-FileId"]=u.AFrameworkApplication.hh:c+=String.format("&{0}",u.AFrameworkApplication.hh);this.VO.Njc.nj(c,1,null,f,!0,5,a,b,null)}get VO(){return this.Pha.value}get Uqg(){return this.RWh.value}static get instance(){return ln.Ka||(ln.Ka=ln.xr())}static xr(){return new ln(new kc.a(()=>op.instance),new kc.a(()=>Xa.a.xe(u.AFrameworkApplication.lcid).name),
new kc.a(()=>u.AFrameworkApplication.Aa.hb.IC),u.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>u.AFrameworkApplication.Aa.hb.zca,()=>u.AFrameworkApplication.St,new kc.a(()=>u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}ln.Ka=null;Object(n.a)(ln,"MruActor",rt,[]);class hw{constructor(){this.XXb=this.Hmf=this.Da=null;this.ro=!1}get name(){return"Common.App.NewAndOpen.Core"}Zb(a){this.Da=a;a.register(1361,"Common.INewAndOpenCommonHelpers").ma().oa(()=>op.instance);a.register(1362,
"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().oa(()=>um.instance);a.register(1362,"Common.IEventEmitter<Common.IMruResult>").ma().oa(()=>ln.instance)}init(){u.AFrameworkApplication.fa.ff(()=>{this.REa()})}REa(){this.Da.resolve("Common.INewAndOpenCommonHelpers");this.Da.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Da.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;op.instance.dVk();u.AFrameworkApplication.Swa&&(a=!0);u.AFrameworkApplication.XPe&&(ln.instance.Vkk(),
0<u.AFrameworkApplication.T_g&&this.ptf(),this.nhl(),a=!0);u.AFrameworkApplication.DLa&&a&&um.instance.Tkk();u.AFrameworkApplication.iGl&&(a=ln.instance,a.lXk(),a.alk(),fm.a.instance.Db(this.jGl))}nhl(){pp.instance.Fsf(Object(F.a)(ln.instance,ln.instance.Ukk,"makeGetMruRequestActivityTrigger"));pp.instance.Fsf(Object(F.a)(this,this.ptf,"addGetMruFromServerTask"));pp.instance.H7h(Object(F.a)(this,this.RLi,"deleteGetMruFromServerTask"))}RLi(){fm.a.instance.Mg(this.U_g)}ptf(){fm.a.instance.Db(this.U_g)}get U_g(){return this.Hmf||
(this.Hmf=new Le.a(5,2,u.AFrameworkApplication.T_g,Object(F.a)(ln.instance,ln.instance.Cej,"getMruFromServerTask"),109))}get jGl(){return this.XXb||(this.XXb=new Le.a(2,2,6E4*u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(F.a)(ln.instance,ln.instance.blk,"makeUpdateMruTask"),197))}dispose(){this.ro||(this.ro=!0,this.XXb&&(fm.a.instance.Mg(this.XXb),this.XXb=null))}}Object(n.a)(hw,"CorePackageManager",null,[2,3,106]);var Zi=d(124);
class jy{constructor(a,b,c,f,l,w,H,U,ja,wa){this.HHg=new Ka.a;this.TTg=null;this.Vb=f;this.ua=l;this.Fa=c;this.Xua=H;this.Ela=U;this.jA=w;this.pa=b;this.la=ja;this.Nq=a;this.ld=wa;this.la.fVj&&(this.pa&&this.pa.KG(Object(F.a)(this,this.EH,"onSelectionChanged")),U&&U.jWk(this),this.Nq.SGc(Object(F.a)(this,this.EU,"onFocusChanged")),this.ld.Kvf(Object(F.a)(this,this.Ukc,"onShapeViewElementUnlocked")),this.ld.rci(Object(F.a)(this,this.X7g,"onThumbnailsSetFakeImage")),this.ld.sci(Object(F.a)(this,this.Y7g,
"onThumbnailsSetFocus")),this.ld.tci(Object(F.a)(this,this.Z7g,"onThumbnailsSetSelected")),this.la.ZZc&&this.Nq.abi(Object(F.a)(this,this.s7g,"onSlideshowNavigationToolbarClickedHandler")),this.la.vg&&this.Nq.$ai(Object(F.a)(this,this.q7g,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Nq.Vld(Object(F.a)(this,this.EU,"onFocusChanged"));this.Nq.BZk(Object(F.a)(this,this.Otk,"onDesignerClickSuggestion"));this.ld.Ujh(Object(F.a)(this,this.Ukc,"onShapeViewElementUnlocked"));this.ld.D0k(Object(F.a)(this,
this.X7g,"onThumbnailsSetFakeImage"));this.ld.E0k(Object(F.a)(this,this.Y7g,"onThumbnailsSetFocus"));this.ld.F0k(Object(F.a)(this,this.Z7g,"onThumbnailsSetSelected"));this.la.ZZc&&this.Nq.P_k(Object(F.a)(this,this.s7g,"onSlideshowNavigationToolbarClickedHandler"));this.la.vg&&this.Nq.O_k(Object(F.a)(this,this.q7g,"onSlideshowContextMenuFocusedHandler"))}EH(a,b){if(b&&b.ll&&this.pa.P_(b.ll))try{this.lxj(b.ll)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
c.message,c.stack),va.a.J(17367906,822,10,a)}}lxj(a){var b=this.pa.tg();if(1===a.length||1===b.length&&b[0].Og){if(a=this.pa.kp()){b=new Ka.a;let c=this.m6f(a,b,Object(F.a)(this,this.mkj,"getShapeName"));c||b.count||(c=this.Ela.i7f(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:ha.a.Wa(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.Ela.ukj(a);({Vyf:c,r7e:b}=this.nxf(f,c,b));!a.As&&a.isUnread&&({Vyf:c,r7e:b}=this.nxf(this.Ela.vkj(a,this.TTg),c,b));0<b.count?
this.lgh(b):this.Sfa(c||"")}}else 1<a.length&&(a=this.Ela.Hej(this.pa.Xd()),this.Sfa(a||""))}nxf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{Vyf:b,r7e:c}}EU(a,b){b=b.Hgb;if(b===Zi.a.PD||b===Lb.a.sg){a=this.ua.Ba;let c=null;b===Zi.a.PD?c=(a=this.Vb.Etc.$da)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.a$a()+this.Ela.Cae(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.a$a()):b!==Lb.a.sg||
!this.pa.Bs()&&this.pa.b4()||(this.jA&&this.jA.value&&(b=this.jA.value.Qd)&&a&&b.pp&&Tj.e(a,b.Ma),c=this.Ela.Xkj());this.Sfa(c||"")}}setAttribute(a,b,c){a&&Bc.a.eP(a,b,c)}V5(a){this.HHg.add(a)}m6f(a,b,c=null){try{if(a&&this.Fa)for(let f of this.HHg)if(f){const l=f(a,this.Fa.Ae?this.Fa.Ae.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),va.a.J(17662480,822,10,a)}return null}lgh(a){if(this.Xua&&
this.Xua.value){const b=this.Xua.value.rdj();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let f of a)c.appendChild(f);b.appendChild(c)}}}ogh(a,b){if(a){const c=new Ka.a;let f=this.m6f(a,c);f||c.count||(f=this.Ela.i7f(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.lgh(c)):(b&&(f+=" "+b),this.Sfa(f||""))}}Sfa(a){this.Xua&&this.Xua.value&&this.Xua.value.sendNotification(a,!0)}Ukc(a,b){b.presenceUser&&b.mVj&&this.Sfa(String.format(ResourceStrings.L_EditorLeavingHint,
b.presenceUser.userName))}Otk(a,b){this.Sfa(this.Ela.l9i(b.P8k,b.wtl))}X7g(a,b){this.setAttribute(b.D6.image,Bc.a.af,Bc.a.YPa)}Y7g(a,b){b.hasFocus&&b.D6.isSelected&&this.Sfa(this.a$a()+this.Ela.Cae(b.D6));this.setAttribute(b.D6.zlb,Bc.a.z6a,b.hasFocus&&b.D6.isSelected?"true":"false")}Z7g(a,b){b.D6.isSelected&&b.hasFocus?this.Sfa(this.a$a()+this.Ela.Cae(b.D6)):b.D6.isSelected||this.Sfa(this.a$a());this.setAttribute(b.D6.zlb,Bc.a.z6a,b.D6.isSelected?"true":"false")}s7g(a,b){this.Sfa(b.text)}mkj(a){this.TTg=
a||ResourceStrings.l_Object}q7g(a,b){this.Sfa(b.text)}a$a(){let a="";const b=this.pa.Qe();b&&1<b.length&&(b.sort((c,f)=>c.me-f.me),this.csb(b)&&(a=this.Ela.a$a(b[0].me+1,b[b.length-1].me+1)));return a}csb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].me-a[0].me+1===b?!0:!1}}Object(n.a)(jy,"AriaManager",null,[1277,106]);var ps=d(924);class Hu{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}Zb(a){this.K=a;this.K.register(813,"PowerPointWebEditor.IAriaMessageHelper").ma().oa(()=>
new ps.a(this.K.Ja("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Ja("PowerPointWebEditor.Graph.ICommentReader"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.ke("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1277,
"PowerPointWebEditor.IAriaManager").ma().oa(()=>new jy(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.ke("Box4.IInteractiveViewManager"),this.K.ke("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){v.a.instance.Dc(new Hu)}}Object(n.a)(Hu,"PptAriaPackage",null,[2,3]);var iw=d(1042);class qs{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=qs.zRi;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=
this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}qs.zRi=[];Object(n.a)(qs,"Critique",null,[]);class ky{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(n.a)(ky,"Suggestion",null,[]);class Iu{lJf(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new qs,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||
"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.OBi(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.uBi(c.supportedActions)),c.suggestions&&(a.Suggestions=this.NBi(c.suggestions)),b.push(a);return b}NBi(a){if(!a)return null;const b=[];for(const c of a)(a=this.LBi(c))&&b.push(a);return b}LBi(a){if(!a)return null;
const b=Object.assign(new ky,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.tBi(a.confidenceLevel)});a.actions&&(b.Action=this.MBi(a.actions));return b}tBi(a){return 1===a?0:2===a?1:2}MBi(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}OBi(a){return a.consistency?1:0}uBi(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&
(b|=8);a.showDetails&&(b|=32);return b}}Object(n.a)(Iu,"CloudALResponseTransformer",null,[1480]);var yg=d(84),Ju=d(527);class jw{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.Rva=a;this.qeb=b;this.VTg=c;this.ua=f;this.Jb=l;this.ia=w;this.ic=U;this.Yl=ja;this.Ih=wa;this.Oc=H;this.nA=Sa;this.Rva.TBa(Object(F.a)(this,this.lJa,"onBeforeParagraphDisconnect"));this.Rva.kk(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.y$h(Object(F.a)(this,this.c5g,"onLanguageOnRangeChanged"));
this.qeb.TBa(Object(F.a)(this,this.P2g,"onBeforeNumberListDisconnect"));this.qeb.kk(Object(F.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.VTg.wF(Object(F.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.ua.Ba;if(!b||!b.isConnected)return!1;const c=Object.assign(new Ju.a,{slideId:b.Cb});this.ia.La(L.a.XZa,2,c);return 0<c.bsc?(va.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",
a,b.id),!1):!0}initialize(){this.tie(this.ua.Ba)}dispose(){this.Rva.vKa(Object(F.a)(this,this.lJa,"onBeforeParagraphDisconnect"));this.Rva.Rm(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.QZk(Object(F.a)(this,this.c5g,"onLanguageOnRangeChanged"));this.qeb.vKa(Object(F.a)(this,this.P2g,"onBeforeNumberListDisconnect"));this.qeb.Rm(Object(F.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.VTg.bP(Object(F.a)(this,this.onShapeChildTopologyChanged,
"onShapeChildTopologyChanged"))}lJa(a,b){this.nuc(Object(qa.a)(Sd.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==Za.a.pq&&b.property!==Va.a.listLevel||this.nuc(Object(qa.a)(Sd.AParagraphNode,b.node),!1)}c5g(a,b){this.nuc(b.paragraphNode,!0)}P2g(a,b){b.node&&Object(Ya.a)(yg.a,b.node)&&this.nuc(this.nA.L8d(Object(qa.a)(yg.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(Ya.a)(yg.a,b.node)&&b.node.isConnected&&b.property===Za.a.Ui&&this.nuc(this.nA.L8d(Object(qa.a)(yg.a,
b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(qa.a)(4,b.node))a=this.ic.jg(a),this.tie(a)}nuc(a,b){!this.xjl(a)||b&&this.bzj(a)||(a=Object(qa.a)(116,this.ic.jg(a)),this.tie(a))}tie(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Jb.oe(7,D.a.N5e);b.nc(a);a.isSlideCritiqueReady=!1;b.dispose()}}xjl(a){return!!a&&a.isConnected&&this.Ih.ae(a)&&!this.Yl.Tka(a)&&!a.sa(hb.a.GT,!1)}bzj(a){a=a.sa(Za.a.pq,"");return!a||!a.length}}Object(n.a)(jw,"ConsistencyCheckManager",null,[1265,106]);
var Xl=d(161),Qp=d(526);class Rp{constructor(){this.d=this.p=this.w=null}}Object(n.a)(Rp,"ProofingDashboardTraceMetrics",null,[]);class Ek{}Ek.Jne="bs";Ek.E1c="bd";Ek.BKh="was";Ek.CKh="wad";Ek.EUj="rm";Ek.wMl="wd";Ek.hLl="ad";Ek.m4k="rs";Object(n.a)(Ek,"TelemetryFieldNames",null,[]);class vm{}vm.axl="tcw";vm.vtd="tcc";vm.spg="bs";vm.a_j="bd";vm.rpg="bpc";vm.GYg="md";Object(n.a)(vm,"TelemetryValues",null,[]);class Ar{constructor(){this.wn=this.i=null}}Object(n.a)(Ar,"Workflow",null,[]);class kw{constructor(a,
b,c,f,l,w,H,U,ja,wa,Sa,eb){this.ua=a;this.PC=b;this.SAe=c;this.Jb=f;this.k9j=l;this.DRg=w;this.u$=H;this.Ea=U;this.Yl=ja;this.Ha=wa;this.gre=Sa;this.w$=eb}initialize(){this.u$.execute(a=>{a.addEventHandler(Qp.a.zzf,Object(F.a)(this,this.Wrj,"handleAugResults"));this.Ha.pptAugmentationLoopCloudALEnabled&&a.addEventHandler(Qp.a.nWd,Object(F.a)(this,this.zsj,"handleCloudALResults"))})}Wrj(a,b,c,f){va.a.J(36962498,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",f.Telemetry,
(new Date).getTime().toString());var l=this.z_f(b.Content);c=this.Y9i(f.Payload);if(l&&c){var w=!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopCloudALEnabled||this.Ha.pptAugmentationLoopShadowCloudALEnabled)this.HYg(c.Critiques,l),w=!0;l=(new Date).getTime();if(f=this.w$.O_d(f.DashboardTelemetry))try{const H={};H[Ek.m4k]=c.ResponseStatus;H[Ek.EUj]=w;H[Ek.wMl]=l-f.d[Ek.Jne];H[Ek.hLl]=f.d[Ek.CKh]-f.d[Ek.BKh];f.d=H;f.p=vm.GYg;this.w$.track(f)}catch(H){va.a.J(37487777,
375,15,"trace metrics exception {0}",H.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());va.a.J(36702229,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",w,b.Id,c.Critiques?c.Critiques.length:0,a)}else va.a.J(36577357,375,10,c?"Aug slide is null":"Result is null")}}zsj(a,b,c,f){va.a.J(36962502,375,50,"Handle Cloud AL results");c=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&va.a.J(37057568,375,15,"Get partial success response");a=String.format("MarkStart:{0}",c.toString());
var l=this.z_f(b.Content);if(l){var w=!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopShadowCloudALEnabled)w=this.gre.lJf(f.critiques),this.HYg(w,l),w=!0;l=(new Date).getTime();c=Object.assign(new Rp,{w:Object.assign(new Ar,{wn:vm.vtd,i:b.Id}),p:vm.GYg,d:{["ms"]:c,["md"]:l,["rm"]:w,["rs"]:f.partialSuccess?1:0}});this.w$.track(c);a=String.format("{0}, MarkDone:{1}",a,l.toString());va.a.J(36783304,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",
w,b.Id,f.critiques?f.critiques.length:0,a)}else va.a.J(36783302,375,10,"Aug slide is null")}}z_f(a){let b=null;try{b=Jc.a(a)}catch(c){return va.a.J(36577355,375,10,"Try parse aug slide failed"),null}return b}Y9i(a){let b=null;try{b=Jc.a(a)}catch(c){return va.a.J(36525519,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return va.a.J(38545173,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return va.a.J(36525521,
375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&va.a.J(37057603,375,15,"Get partial success response");return b}HYg(a,b){try{const H=this.ua.Ba;if(!this.Ukl(b,H)){var c=this.A5f(a,!1);if(c){var f=this.ua.Ba.aja,l=new Ka.a,w=this.Jb.oe(7,D.a.N5e);w.nc(H);for(const U of b.drawingElems)if(U.text&&U.text.paragraphs)for(const ja of U.text.paragraphs){const wa=ja.id;l.add(wa);const Sa=Object(qa.a)(Sd.AParagraphNode,f.Be(ia.a.Gf(wa)));if(Sa&&
!Sa.sa(Xl.a.Uda,!1)){if(this.Ha.pptEditorGrammarAndWritingStyleIsEnabled)if(wa in c){const eb=Array.isArray(c[wa])?c[wa]:null;if(!eb||!eb.length||eb[0].RevisionId!==Sa.sa(Xl.a.S1c,0).toString())continue;this.Glk(Sa,eb,this.Yij(ja.cfRuns))}else this.NYk(Sa);Sa.setValue(Xl.a.Uda,!0)}}if(this.Ha.pptEditorConsistencyCheckIsEnabled){const U=String.format("Start:{0}",(new Date).getTime().toString());b=0;const ja=H.isSlideCritiqueReady;c=!1;if(!ja){const wa=new Ka.a,Sa=this.A5f(a,!0);(c=this.zYi(Sa,l,H,
wa))&&(b=this.Zfi(Sa,l,H,wa))}va.a.J(37298713,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",U,(new Date).getTime().toString(),ja,c,b)}H.setValue(Xl.a.fjg,!0);w.dispose()}}}catch(H){va.a.J(36525523,375,10,"MarkEditorServiceResults failed {0}",H.message)}}Yij(a){const b=new La.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}Glk(a,b,c){var f=this.PC.GF(a,w=>!!w.Hh);const l=[];for(const w of f)1===w.Hh.proofingType&&Array.add(l,
w);b=this.yYi(a,b,l);f=this.xYi(b,f);this.PC.uKa(a,f);this.FYg(b,a,c);a.setValue(Xl.a.Uda,!0)}NYk(a){const b=this.PC.GF(a,c=>!!c.Hh&&1!==c.Hh.proofingType);this.PC.uKa(a,b);a.setValue(Xl.a.Uda,!0)}Zfi(a,b,c,f){const l=c.aja,w=new qd.a;let H=0;this.u3k(c);for(let ja in a){var U=a[ja];const wa=Object(qa.a)(Sd.AParagraphNode,l.Be(ia.a.Gf(ja)));U=Array.isArray(U)?U:null;if(!(wa&&wa.isConnected&&U&&U.length))continue;const Sa=[];for(const eb of U)this.$hg(eb)&&!f.contains(eb.BucketId)&&Sa.push(eb);0<Sa.length&&
(this.FYg(Sa,wa),w.Gb(wa.id.toString())||w.$(wa.id.toString(),wa),H+=Sa.length)}if(0<w.count)for(let ja of b)w.Gb(ja)&&(a=w.ga(ja))&&c.tLa.add(a);c.isSlideCritiqueReady=!0;return H}zYi(a,b,c,f){var l=this.$fj(c);if(b.count!==l.count)return this.F2c(String.format("Topology changed from {0} to {1}",b.count,l.count)),!1;c=c.aja;for(var w of b){if(!l.contains(w))return this.F2c("ParaId changed"),!1;b=Object(qa.a)(Sd.AParagraphNode,c.Be(ia.a.Gf(w)));if(!b||!b.isConnected)return this.F2c("Invalid ParaId"),
!1;if(!b.sa(Xl.a.Uda,!1))return this.F2c("Para pending proofing"),!1}for(let H in a){w=a[H];l=Object(qa.a)(Sd.AParagraphNode,c.Be(ia.a.Gf(H)));w=Array.isArray(w)?w:null;if(!w||!w.length)continue;b=this.PC.GF(l,ja=>!!ja.Hh&&(1===ja.Hh.proofingType||2===ja.Hh.proofingType||3===ja.Hh.proofingType));const U=this.PC.GF(l,ja=>{ja=Object(qa.a)(440,ja.Hh);return!!ja&&5===ja.proofingType&&ja.MEa});l=this.SAe.MSc(l,!1,!0);for(const ja of w)if(this.$hg(ja)){if(this.lZc(ja,b)||this.SMj(ja,w))f.add(ja.BucketId),
va.a.J(37298716,375,50,"Overlap critique: {0}",ja.BucketId);(this.lZc(ja,l)||this.lZc(ja,U))&&f.add(ja.BucketId)}}return!0}F2c(a){va.a.J(37298718,375,50,"Skip apply: {0}",a)}yYi(a,b,c){const f=[];for(const l of b){if(this.Vyj(b,l)||a.characterData.length<l.Start+l.Length||this.lZc(l,c))continue;const w=wn.b(l);2!==w&&3!==w||f.push(l)}return f}xYi(a,b){const c=[];for(const f of b)this.yjl(a,f)||Array.add(c,f);return c}yjl(a,b){const c=b.Hh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===
c){for(const f of a)if(this.g0c(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}lZc(a,b){const c=a.Start;a=a.Start+a.Length;for(const f of b)if(this.g0c(c,a,f.begin,f.end))return!0;return!1}A5f(a,b){const c={};if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}WSa(a,b){let c=0;for(let f of a)if(b>=f.key)c=f.value;else break;return c}FYg(a,b,c=null){if(a&&a.length&&b){var f={},l=[];for(const H of a){var w=H.Start;const U=w+
H.Length,ja=b.characterData.substring(w,U);a=this.k9j.create(H,this.DRg);a.token=ja;c&&(a.lcid=this.WSa(c,w));w=new Rm(w,U,a);Array.add(l,w);a=1===a.proofingType?fl[a.proofingType]:a.typeId;f[a]=a in f?f[a]+1:1}this.PC.$sf(b,l);this.DRg.track(()=>Object.assign(new Qn.a,{E:2,C:this.MCi(b.characterData),F:f}))}}Vyj(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.g0c(c,f,l.Start,l.Start+l.Length)&&wn.a(l)>wn.a(b))return!0;return!1}SMj(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==
a&&this.g0c(c,f,l.Start,l.Start+l.Length))return!0;return!1}g0c(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}MCi(a){return tr.a.instance.C9f(a,0,a.length-1)}Ukl(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}$hg(a){return!!a&&5===wn.b(a)}$fj(a){const b=new Ka.a;a=a?a.gk():[];for(const c of a)this.Yl.yFa(c)||this.Ea.NJ(c,f=>{b.add(f.id.toString())});return b}u3k(a){for(let b of a.tLa){const c=b;if(c){const f=this.PC.GF(c,l=>{l=Object(qa.a)(440,l.Hh);return!!l&&5===l.proofingType&&!l.MEa});this.PC.uKa(c,
f)}}a.tLa.clear()}}Object(n.a)(kw,"EditorServiceResultsManager",null,[]);class ly extends Uo.a{constructor(a,b,c,f,l,w=null){super(a,b,c,f,w);this.bG=l}get proofingType(){const a=super.proofingType;return this.bG.rUa||2!==a?a:1}}Object(n.a)(ly,"PPTEditorServiceErrorDetails",Uo.a,[]);class my{constructor(a,b,c){this.xbk=a;this.Zfk=b;this.bG=c}create(a,b,c=null){return new ly(a,b,this.xbk,this.Zfk,this.bG,c)}}Object(n.a)(my,"PPTEditorServiceErrorDetailsFactory",null,[1262]);class lw{constructor(a){this.Ha=
a}filter(a){if(a&&(!this.Ha.pptEditorConsistencyCheckIsEnabled||!this.Ha.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;for(let l=f.length-1;0<=l;--l){var b=f[l];b=wn.c(b.CritiquePriority,b.CritiqueTag);this.Ha.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Ha.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(n.a)(lw,"PPTProofingCritiqueCategoryInfoFilter",
null,[1263]);class st extends yr.a{constructor(a,b){super(null);this.nJd=a;this.errorType=2;this.Rqg=b}get proofingType(){return this.nJd}get suggestions(){return[]}dMa(){}}Object(n.a)(st,"UnknownErrorDetails",yr.a,[]);class Br{constructor(a,b,c,f,l){this.r9e=this.o9e=null;this.ENd=this.TGd=0;this.Qzd=!1;this.Ki=a;this.aWb=b;this.Oz=c;this.Fm=f;this.jN=l;this.Oxc=0}Igh(a,b,c){return{Hdh:a,a2g:b,$1g:c}}wFh(){}Goe(a,b,c,f,l,w,H,U){!w&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.Ki.Ra.last.cp,w=
this.Ki.characterData.length,Array.add(H,new Dk.a(b,w)),(c||f)&&Array.add(U,new Rm(b,w,new st(this.jN.vne?l?l[a]:0:f?2:1,c?1:2))))}sGl(a,b){this.Oz.oSe(this.Ki,a);b&&this.Fm.C1k(this.Ki,b);this.Gdh()}Gdh(){this.aWb.TR(this.Ki)}a7k(a,b,c,f){this.soh(this.Oxc,b,c,f);this.mUe(a,this.Qzd)}soh(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.jN.vne?a:0)}mUe(a,b){a.add(b)}O1j(a){let b,c,f,l;b=this.Ki.sa(Za.a.Uwa,null);c=this.Ki.sa(Za.a.zLa,null);f=this.Ki.sa(Va.a.C$a,null);l=this.Ki.sa(Va.a.JZa,null);
this.Ki.rzb=this.Ki.sa(eh.a.Tjc,!1);({Uwa:b,zLa:c,C$a:f,JZa:l}=this.eKh(b,c,f,l,a,"loading"));return{Uwa:b,zLa:c,C$a:f,JZa:l}}oUe(a,b,c,f,l){({Uwa:a,zLa:b,C$a:c,JZa:f}=this.eKh(a,b,c,f,l,"saving"));this.AWe(Za.a.Uwa,a);this.AWe(Za.a.zLa,b);this.AYe()&&this.AWe(Va.a.C$a,c);this.vdl(Va.a.JZa,f);this.Ki.rzb?this.Ki.we(eh.a.Tjc,!0):this.Ki.removeProperty(eh.a.Tjc)}AYe(){return!0}AWe(a,b){b&&Array.contains(b,!0)?this.Ki.we(a,b):this.Ki.removeProperty(a)}vdl(a,b){!b||Qa.a.all(b,c=>0===c)?this.Ki.removeProperty(a):
this.Ki.we(a,b)}svi(a,b){(b=this.Ki.Ra.ga(b).formatting)?(a.formatting=b.ee(a),R.a.instance.ga(57)&&(this.Ki.gv(),-1!==a.formatting.qg&&this.Ki.wordRunProperties.Oyb(b.qg,64))):(ka.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),Nc.a.instance.Xb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}eKh(a,b,c,f,l,w){const H=Nc.a.instance.Wp(D.a.YJl);H.properties.$(Xc.a.source,
w);let U=!1;a&&a.length!==l&&(ka.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,l,w),U=!0);b&&b.length!==l&&(ka.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,l,w),U=!0);this.AYe()&&c&&c.length!==l&&(ka.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
c.length,l,w),U=!0);f&&f.length!==l&&(ka.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",f.length,l,w),U=!0);if(U)for(f=c=b=null,a=[],w=0;w<l;w++)Array.add(a,!0);H.end();return{returnValue:!U,Uwa:a,zLa:b,C$a:c,JZa:f}}D7g(){}iHe(){this.Oxc=0;this.o9e=this.Ki.R0||[];this.r9e=this.Ki.hPb||[];this.ENd=this.TGd=0;this.Qzd=!1}lHe(a,b){a.Vp&&a.Vp.Hh?this.Oxc=a.Vp.Hh.proofingType:a.IL&&(this.Oxc=0);a=a.cp;b=b?b.cp:a;
this.Qzd=({Z_e:this.TGd}=this.oig(a,b,this.o9e,this.TGd)).returnValue||({Z_e:this.ENd}=this.oig(a,b,this.r9e,this.ENd)).returnValue}oig(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=a)++f;else return{returnValue:b>l.begin,Z_e:f}}return{returnValue:!1,Z_e:f}}}Object(n.a)(Br,"ProofingDataHandler",null,[1503]);var mw=d(511);class nw extends Br{constructor(a,b,c,f,l,w,H,U,ja){super(a,b,c,f,U);this.FCg=!1;this.tcc=null;this.wJ=l;this.ia=w;this.Ea=H;this.ic=ja;this.g4c=null}D7g(){this.wJ.HBl(this.Ki)}Igh(a,
b,c){this.Ki.Aje||(a=!1,c=this.Fm.GF(this.Ki));this.g4c=this.Fm.GF(this.Ki,f=>{f=Object(qa.a)(440,f.Hh);return!!f&&5===f.proofingType&&!f.MEa});return{Hdh:a,a2g:b,$1g:c}}wFh(a,b,c,f,l){const w=Object(qa.a)(116,this.ic.jg(this.Ki));this.Ki&&w&&w.isConnected&&w.isSlideCritiqueReady&&ha.a.$Rd(this.Ki.characterData,b)&&this.g4c&&0<this.g4c.length&&(Array.addRange(l,this.g4c),l.sort((H,U)=>H.end-U.end));if(!a&&c&&0<c.length&&ha.a.$Rd(this.Ki.characterData,b)&&f&&0<f.length){for(const H of c)this.rmg(H,
f)&&!this.rmg(H,l)&&Array.add(l,H);l.sort((H,U)=>H.end-U.end)}}rmg(a,b){a=ql.c([a],b);return!Qa.a.Wa(a)&&Qa.a.any(a,c=>c.begin<c.end)}Gdh(){this.wJ.WTj(this.Ki)&&this.aWb.TR(this.Ki)}AYe(){return!1}mUe(a,b){this.FCg=!0;super.mUe(a,b);b&&(this.Ki.we(Xl.a.Uda,!1),this.Ki.we(Xl.a.S1c,(new Date).getTime()))}soh(a,b){this.tcc||(this.tcc=this.Fm.GF(this.Ki));b.add(1===a)}iHe(){super.iHe();this.tcc=null}Goe(a,b,c,f,l,w,H,U){w||(b=!!b&&b[a],a=!!c&&c[a],c=this.Ki.Ra.ga(this.Ki.Ra.length-1),b?(Array.add(H,
new Dk.a(c.cp,this.Ki.characterData.length)),this.$6k()):(b=this.H5i(c.cp,this.Ki.characterData.length,this.Ki.characterData,ja=>{ja=ja.Hh.proofingType;return 2===ja||3===ja}))&&0<b.length&&Array.addRange(U,b),a&&(Array.add(H,new Dk.a(c.cp,this.Ki.characterData.length)),Array.add(U,new Rm(c.cp,this.Ki.characterData.length,new st(1,1)))))}oUe(a,b,c,f,l){this.FCg||this.Ozj()||va.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.oUe(a,
b,c,null,l)}Ozj(){if(!this.Ki)return va.a.J(37368032,375,10,"ParagraphNode is null"),!1;var a=this.Ea.en(this.Ki);if(!a)return va.a.J(37368034,375,10,"ShapeNode is null"),!1;a=new mw.a(a,Pc.App.Ym);this.ia.La(L.a.iib,2,a);return a.oua}$6k(){const a=new qf.GraphTransaction(4);a.kd(this.Ki);this.Ki.we(Xl.a.Uda,!1);this.Ki.we(Xl.a.S1c,(new Date).getTime());a.dispose()}H5i(a,b,c,f){const l=[];if(this.tcc)for(const w of this.tcc){const H=Object(qa.a)(Rm,w);H&&H.Hh&&H.Hh.token===c.substring(H.begin,H.end)&&
H.end>a&&H.end<=b&&f(H)&&Array.add(l,H)}return l}}Object(n.a)(nw,"PPTProofingDataHandler",Br,[]);class ow{constructor(a,b,c,f,l,w,H,U){this.x$=a;this.gdk=b;this.PC=c;this.wJ=f;this.bG=H;this.ia=l;this.ic=U;this.Ea=w}BGi(a){return new nw(a,this.x$,this.gdk,this.PC,this.wJ,this.ia,this.Ea,this.bG,this.ic)}}Object(n.a)(ow,"PPTProofingDataHandlerFactory",null,[1266]);class Ku{constructor(a,b){this.u$=a;this.Gtg=b}initialize(){this.u$.execute(a=>{if(this.Gtg)for(const b of this.Gtg)this.kXk(a,b)})}kXk(a,
b){a.registerSimpleRemoteWorkflow(b.sG,b.ssb,b.mKb,b.Erb)}}Object(n.a)(Ku,"ProofingAugLoopRuntimeManager",null,[]);class Vq{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){this.Ea=a;this.Yl=b;this.ic=c;this.Ml=f;this.Jb=l;this.Pb=w;this.Qk=H;this.ua=U;this.x$=ja;this.PC=wa;this.wi=eb;this.Ih=ub;this.Uma=Ub;this.zb=cc;this.ld=Ic;this.xNg=Cc;this.nYa=new Ka.a;this.Qk.yci(Object(F.a)(this,this.e8g,"onUndoRevisionStateChanged"));this.kU=Sa.xd(12);this.kU.kk(Object(F.a)(this,this.onParagraphPropertyChanged,
"onParagraphPropertyChanged"));this.kM=Sa.xd(10);this.kM.wF(Object(F.a)(this,this.Y6g,"onShapeTopologyChanged"));this.Jgk=new Le.a(3,1,0,Object(F.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.Nhc=this.mHa=!1;this.ld.eW(Object(F.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.Qk.I0k(Object(F.a)(this,this.e8g,"onUndoRevisionStateChanged"));this.kU.Rm(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.kM.bP(Object(F.a)(this,
this.Y6g,"onShapeTopologyChanged"));this.ld.Yxa(Object(F.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}zqc(a,b){this.Ea.NJ(a,c=>{this.Nrh(c,b)})}Orh(a,b){this.Yl.Omc(a,c=>{this.Nrh(c,b)})}HGl(a,b){b?this.Ea.NJ(a,c=>{c&&this.PC.HVd(c)}):this.Ea.NJ(a,c=>{c&&(c.fZb=!0)})}xFh(a){if(a&&a.isConnected&&!a.aq){var b=this.Jb.oe(4);try{let c=!1;const f=this.Pb.Mc(a);b.nc(f);const l=this.Ml.jsa(a);for(;l.moveNext();){const w=l.currentNode;this.jkl(w)&&(c=!0,w.wgd(),w.bnc=!0)}c&&this.NYg(a)}finally{b&&
b.dispose()}this.wi.forceOutbound()}}HBl(a){if(this.tua(a)&&a.fZb)if(this.Nhc&&!this.nYa.contains(a))this.nYa.add(a);else{var b=this.Jb.oe(4);try{b.nc(a),a.wgd(),a.bnc=!0,this.Hlk(a)}finally{b&&b.dispose()}a.fZb=!1}}wjd(a){this.tua(a)&&this.Ea.NJ(a,b=>{this.x$.TR(b)})}zMk(a){this.tua(a)&&this.Yl.Omc(a,b=>{this.x$.TR(b)})}WTj(a){return this.tua(a)&&(this.YTj(a)||this.XTj(a))}NYg(a){a&&a.isConnected&&this.Ea.MFa(a)&&this.Yrh(a)}Hlk(a){const b=this.Ea.en(a);this.NYg(b);this.Yl.Tka(a)&&(a=this.Yl.rxb(a))&&
a.isConnected&&this.Yl.yFa(a)&&this.Yrh(a)}e8g(a,b){if(b)switch(b.state){case 0:this.Nhc=!0;break;case 3:this.Nhc=!1,this.mHa||(this.zb.Db(this.Jgk),this.mHa=!0)}}jkl(a){return this.tua(a)?a.sa(Za.a.Uwa,null)?!0:a.sa(Za.a.zLa,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.Nhc&&b&&b.node&&(12!==b.node.type||this.nYa.contains(b.node)||this.nYa.add(b.node))}Y6g(a,b){this.Nhc&&b&&b.node&&(10!==b.node.type||this.nYa.contains(b.node)||this.nYa.add(b.node))}resumeProofingAfterUndo(){this.mHa=!1;for(let b of this.nYa)if(this.tua(b))if(this.Ea.MFa(b)){var a=
b;a&&(this.zqc(a,!0),this.wjd(a))}else this.Ih.ae(b)&&(a=b)&&(a.fZb=!0,this.x$.TR(a));this.nYa.clear()}Nrh(a,b){a&&(a.fZb=b&&a.R0&&0<a.R0.length?!0:!1)}YTj(a){if(this.xNg){const b=this.ua.Ba;if(!this.tua(b))return!1;a=this.Ea.oda(a);return this.ic.jg(a)===b}return this.Uma.vMj(a)}XTj(a){var b=this.ua.Ba;if(!this.tua(b))return!1;a=this.Yl.rxb(a);b=b.aTa();return this.tua(a)&&this.tua(b)&&ia.a.WP(a.id,b.id)}Yrh(a){a.setValue(hb.a.xjd,a.sa(hb.a.xjd,0)+1)}tua(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.xNg){var a=
this.ua.Ba;if(a&&(a=a.gk())&&0<a.length)for(const b of a)this.Ea.fB(b)&&this.wjd(b)}}}Object(n.a)(Vq,"ProofingBehaviorController",null,[1267,106]);class pw extends Pq.a{constructor(a,b,c,f,l,w=!0,H=!1,U=50){super(a,b,c,f,l,w);this.Rbk=H;this.zHg=U}Wph(a){a=Array.isArray(a)?a:null;if(!Qa.a.Wa(a))if(a.length<=this.zHg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.zHg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&va.a.J(37325012,375,
this.Rbk?15:50,"{0}",Dl.c(a))}}Object(n.a)(pw,"DashboardAggregator",Pq.a,[]);class qw{constructor(a){this.w$=new pw(new kc.a(()=>u.AFrameworkApplication.ye),u.AFrameworkApplication.vga,15,a.pptProofingDashboardTraceIntervalInMinutes,new Qq,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.w$.track(a,"")}O_d(a){let b=null;try{b=Jc.a(a)}catch(c){va.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(n.a)(qw,"ProofingDashboardAggregator",
null,[1264]);class rw{track(){}O_d(){return null}}Object(n.a)(rw,"ProofingDashboardNonOperationAggregator",null,[1264]);var sw=d(440),tt=d(439);class Lu{constructor(a){this.Dgk=a}Lx(a,b,c){this.Dgk(b,c);return!0}}Object(n.a)(Lu,"NonOpProofingALRequestManager",null,[1373]);class Mu{constructor(a,b,c){this.D0=this.a0=null;this.vDe=a;this.Mcc=b.pptEditorConsistencyCheckIsEnabled;this.Yye=b.pptProofingLogWorkflowExceptionEnabled;this.w$=c;this.RAe=new Lu(Object(F.a)(this,this.ESe,"requestAL"))}get sG(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get ssb(){this.a0||
(this.a0=Object.assign(new tt.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:sw.a.csc,outputSchema:Qp.a.YGf,func:Object(F.a)(this,this.Lbb,"lambdaBeforeFunc")}));return this.a0}get Erb(){return null}get mKb(){this.D0||(this.D0=Object.assign(new tt.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:Qp.a.YGf,outputSchema:Qp.a.nWd,func:null}));return this.D0}ESe(a,b){b(a)}Lbb(a,b,c){try{va.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.sG);const H=Object.assign(new Rp,{d:{["bs"]:(new Date).getTime()},
w:Object.assign(new Ar,{wn:vm.vtd})});this.w$.track(Object.assign(new Rp,{w:Object.assign(new Ar,{wn:vm.vtd}),p:vm.spg}));let U=String.format("LambdaBeforeStart:{0}",H.d[Ek.Jne].toString());if(a){H.w.i=a.Id;try{var f=Jc.a(a.Content)}catch(ja){va.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady;b=!1;var w=({FFa:b}=this.vDe.Gpl(f)).returnValue;w?b&&(!this.Mcc||this.Mcc&&l)?(c(null),this.w$.track(Object.assign(new Rp,{w:Object.assign(new Ar,{wn:vm.vtd}),
p:vm.rpg})),va.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.sG,a.Id,b,l)):(H.d[Ek.E1c]=(new Date).getTime(),H.p=vm.a_j,U=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,U,H.d[Ek.E1c].toString()),this.w$.track(H),va.a.J(36783312,375,50,U),this.RAe.Lx(f.id,w,c)):(c(null),va.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.sG,a.Id))}else c(null)}else c(null),va.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.sG)}catch(H){a=
"CloudAL LambdaBefore Exception",this.Yye&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",H.message,H.stack)),va.a.J(37835201,375,10,a),c(null)}}}Object(n.a)(Mu,"ProofingTileCheckCloudALWorkflow",null,[656,1334]);class tw{}Object(n.a)(tw,"AugEditorServiceTileCheckRequest",null,[]);class uw{constructor(){this.contextId=this.F1c=null}}Object(n.a)(uw,"RequestStateObject",null,[]);class xj{constructor(a,b,c,f){this.Egk=0;this.D0=this.a0=null;this.vDe=a;this.TT=b;this.Mcc=c.pptEditorConsistencyCheckIsEnabled;
this.Yye=c.pptProofingLogWorkflowExceptionEnabled;this.w$=f;this.RAe=new Lu(Object(F.a)(this,this.ESe,"requestAL"))}get sG(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get ssb(){this.a0||
(this.a0=Object.assign(new tt.a,{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:sw.a.csc,outputSchema:Qp.a.yzf,func:Object(F.a)(this,this.Lbb,"lambdaBeforeFunc")}));return this.a0}get Erb(){return null}get mKb(){this.D0||(this.D0=Object.assign(new tt.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:Qp.a.yzf,outputSchema:Qp.a.zzf,func:Object(F.a)(this,this.Kne,"lambdaRemoteFunc")}));return this.D0}ESe(a,b){if(b){var c=this.w$.O_d(a.DashboardTelemetry);c&&(c.d[Ek.BKh]=(new Date).getTime());
var f=String.format("{0}, LambdaRemoteStart:{1}",a.Telemetry,(new Date).getTime());this.TT.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.fpc(a.Topic,a.Data,a.ContextId,w=>{this.DKa(w,f,c)},w=>{this.BKa(w,f)},Object.assign(new uw,{contextId:a.ContextId,F1c:b}))})}}Lbb(a,b,c){try{va.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.sG);const H=Object.assign(new Rp,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Ar,{wn:vm.axl})});let U=String.format("LambdaBeforeStart:{0}",
H.d[Ek.Jne].toString());this.w$.track(Object.assign(new Rp,{w:H.w,p:vm.spg}));if(a){try{var f=Jc.a(a.Content)}catch(ja){c(null);va.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady;b=!1;var w=({FFa:b}=this.vDe.Hpl(f,++this.Egk)).returnValue;w?b&&(!this.Mcc||this.Mcc&&l)?(c(null),this.w$.track(Object.assign(new Rp,{w:H.w,p:vm.rpg})),va.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.sG,a.Id,b,l)):(H.d[Ek.E1c]=
(new Date).getTime(),U=String.format("{0}, LambdaBeforeDone:{1}",U,H.d[Ek.E1c].toString()),c(Object.assign(new tw,{Topic:Qp.a.lRi,Data:Jc.c(w),ContextId:f.id,Telemetry:U,DashboardTelemetry:Dl.c(H)})),va.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.sG,a.Id)):(c(null),va.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.sG,a.Id))}else c(null)}else c(null),va.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.sG)}catch(H){a="WACAL LambdaBefore Exception",this.Yye&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
H.message,H.stack)),va.a.J(37835210,375,10,a),c(null)}}Kne(a,b,c){va.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.sG);a?this.RAe.Lx(a.ContextId,a,c):(c(null),va.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.sG))}DKa(a,b,c){if(!u.AFrameworkApplication.Ug&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var w=Jc.a(a.data.Wd)}catch(H){l.F1c(null);va.a.J(36525527,375,10,"Try parse aug response failed:{0}",H.message);return}w&&(w.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[Ek.CKh]=f,w.DashboardTelemetry=Dl.c(c)));l.F1c(w);va.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.sG)}}}BKa(a,b){!u.AFrameworkApplication.Ug&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),va.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.Wd,b),(a=a.data.state)&&a.F1c(null))}}Object(n.a)(xj,"ProofingTileCheckWacALWorkflow",null,[656,1334]);class xo{constructor(){this.groupType=0}}
Object(n.a)(xo,"AnalyzerData",null,[]);class ut{constructor(){this.nodes=this.metadata=null}}Object(n.a)(ut,"TopologyNode",null,[]);class Nu{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(n.a)(Nu,"Content",null,[]);class Ou{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(n.a)(Ou,"CritiqueTypeOption",null,[]);class ny{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(n.a)(ny,"Descriptors",null,[]);class qp{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(n.a)(qp,"EditorServiceTileCheckRequest",null,[]);class vw{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(n.a)(vw,"ListMetadata",null,[]);var vt;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(vt||
(vt={}));Object(n.b)("ListNumeration",vt);var wt;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(wt||(wt={}));Object(n.b)("ListType",wt);class ww{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(n.a)(ww,"ProofingRequest",null,[]);class rs{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(n.a)(rs,"TopologyNode",null,[]);class xw{constructor(){this.nodes=null}}Object(n.a)(xw,"ReadingOrderTopology",null,[]);class Pu{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(n.a)(Pu,"Span",null,[]);class Qu{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(n.a)(Qu,"TextTile",null,[]);class oy{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(n.a)(oy,"TextTileElement",null,[]);class Ru{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(n.a)(Ru,"TextTileElementSpan",null,[]);class xt{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(n.a)(xt,"TileContext",null,[]);class Su{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(n.a)(Su,"TileElement",null,[]);class yt{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(n.a)(yt,"TileMetadata",null,[]);class Tu{constructor(a,b,c,f,l,w){this.BRg=a;this.n4c=b;this.ARg=c;this.bG=f;this.Ha=l;this.oc=w;this.F4c=null}get Cng(){return u.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.bG.rUa}get descriptors(){this.F4c||(this.F4c=this.k9i(),va.a.J(37090579,375,50,"Descriptors: {0}",Jc.c(this.F4c)));return this.F4c}Hpl(a,b){let c;c=!0;var f=Xa.a.xe(u.AFrameworkApplication.lcid);if(!f)return{returnValue:null,FFa:c};
var l=new rs,w=new rs;b=Object.assign(new qp,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:u.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.n4c.U6d()});this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=gh.a.S1b(u.AFrameworkApplication.fa.Ga("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.oc.qj(),l.AreChildrenOrdered=!1,w.Id=a.id,
w.Type=3,w.AnalyzerData=null,w.Children=[],w.NumberOfChildren=null,w.AreChildrenOrdered=!0,Array.add(l.Children,w));for(var H of a.drawingElems)if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(w.Children,this.Tyl(H)),H.text&&H.text.paragraphs)for(const ja of H.text.paragraphs){if(null===ja.chars||!ja.cfRuns||!ja.cfRuns.length)continue;a=new Nu;a.TileId=ja.id;a.TileElements=[];l=new Su;l.Text=ja.chars;l.TextUnit=8;if(ja.pfRuns&&ja.pfRuns.length&&ja.pfRuns[0].pf){f=ja.pfRuns[0].pf;
l.AnalyzerData={};if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var U=wt[this.F6d(f.listType)];1===f.listType?(l.AnalyzerData.ListType=U,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=U,l.AnalyzerData.ListNumeration=vt[this.D0f(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;U=0;const wa=[];let Sa=null;for(const eb of ja.cfRuns)if(eb)if(f=Xa.a.xe(eb.cf.lang)){this.ARg.Mid(eb.cf.lang);f=Object.assign(new Pu,{Start:U,Length:eb.len,LanguageId:f.name,DoNotCheck:eb.cf.noProof});Sa||(Sa=f.LanguageId);if(Sa!==f.LanguageId||eb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?wa.push(f):(f.Length||f.Start!==l.Text.length)&&va.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
U+=eb.len}else U+=eb.len;!l.IsClean&&0<wa.length&&(l.Spans=Array.clone(wa));l.LanguageId=Sa;ha.a.Wa(l.LanguageId)?va.a.J(38385410,375,15,"Empty LanguageId, span length {0}",wa.length):(a.TileElements.push(l),b.Content.push(a))}for(w=b.Content.length-1;0<=w;w--)H=b.Content[w],H.TileElements.length&&null!==H.TileElements[0].Text||(va.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",H.TileId),Array.removeAt(b.Content,w));b.Content.length||va.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
FFa:c}}Tyl(a){const b=Object.assign(new rs,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new rs,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}Gpl(a){let b;b=!0;var c=Xa.a.xe(u.AFrameworkApplication.lcid);if(!c)return{returnValue:null,FFa:b};var f={};c=Object.assign(new ww,{descriptors:this.A6i(this.descriptors),
languageUxId:c.name,documentSessionId:u.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.z6i(this.n4c.U6d()),tileContextDictionary:f,documentId:gh.a.S1b(u.AFrameworkApplication.fa.Ga("ServerDocId")).toString(),readingOrderTopology:Object.assign(new xw,{nodes:[]})});const l=this.E8h(a,c.readingOrderTopology,f);for(var w of a.drawingElems)if(w.text&&w.text.paragraphs){a=this.Z6h(w,l,f);for(const H of w.text.paragraphs)({FFa:b}=this.a9h(c.tiles,H,b)),this.P7h(H,a,f)}for(f=
c.tiles.length-1;0<=f;f--)w=c.tiles[f],w.elements.length&&null!==w.elements[0].text||(va.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",w.metadata?w.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||va.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,FFa:b}}k9i(){if(!this.BRg.descriptors)return null;const a=Array.clone(this.BRg.descriptors);for(const b of a)if(this.Cng&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.Cng&&Array.add(a,
Object.assign(new rl,{Name:"LicenseType",Value:"Subscription"}));return a}A6i(a){const b=new ny;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}F6d(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}z6i(a){const b=[];for(const c of a)a=Object.assign(new Ou,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}D0f(a){return a+
1}B6i(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}a9h(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,FFa:c};const f=new Qu;f.metadata=new yt;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new oy;l.text=b.chars;l.textUnit=4;l.listMetadata=new vw;var w=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){w=b.pfRuns[0].pf;if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
w.listType){l.listMetadata.listLevel=w.lvl;var H=this.F6d(w.listType);1===w.listType?(l.listMetadata.listType=H,l.listMetadata.listTag=w.listTag):0===w.listType&&(l.listMetadata.listType=H,l.listMetadata.listNumeration=this.D0f(w.listNumeration),l.listMetadata.listElementIndex=w.listElementIndex)}else l.listMetadata.indentationLevel=w.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.F6d(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
w=!b.pfRuns[0].pf.proofingDirty;c=c&&w}H=0;const U=[];let ja=null;for(const wa of b.cfRuns)if(wa)if(b=Xa.a.xe(wa.cf.lang)){this.ARg.Mid(wa.cf.lang);b=Object.assign(new Ru,{start:H,length:wa.len,languageId:b.name,doNotProcess:wa.cf.noProof});ja||(ja=b.languageId);if(ja!==b.languageId||wa.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?U.push(b):(b.length||b.start!==l.text.length)&&va.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);H+=wa.len}else H+=wa.len;!w&&0<U.length&&(l.spans=Array.clone(U));l.languageId=ja;if(ha.a.Wa(l.languageId))return va.a.J(38385415,375,15,"Empty LanguageId, span length {0}",U.length),{returnValue:null,FFa:c};f.elements.push(l);a.push(f);return{returnValue:f,FFa:c}}E8h(a,b,c){const f=Object.assign(new ut,{metadata:Object.assign(new yt,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new xt,{analyzerData:new xo,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}Z6h(a,b,c){const f=Object.assign(new ut,{metadata:Object.assign(new yt,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new xt,{analyzerData:Object.assign(new xo,{groupType:this.B6i(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}P7h(a,b,c){const f=Object.assign(new ut,{metadata:Object.assign(new yt,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new xt,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(n.a)(Tu,
"TileToTileCheckRequestTransformer",null,[1324]);class Uu{constructor(){this.bG=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}Zb(a){this.K=a;this.pzi();this.qzi();this.K.register(1262,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().oa(()=>new my(u.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(1263,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().oa(()=>
new lw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1264,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().oa(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?new qw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new rw);this.K.register(kw,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().oa(()=>new kw(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));this.K.register(1265,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().oa(()=>new jw(this.K.resolve("Box4.Graph.IGraphInstance").xd(12),this.K.resolve("Box4.Graph.IGraphInstance").xd(22),this.K.resolve("Box4.Graph.IGraphInstance").xd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(Tu,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().oa(()=>
new Tu(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(Iu,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().oa(()=>
new Iu);this.K.register(xj,"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>new xj(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Mu,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>
new Mu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Ku,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().oa(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka("576");this.K.resolve("Common.IAppSettingsManager").ka("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new Ku(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(iw.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().oa(()=>new iw.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
u.AFrameworkApplication.fa.Ga("PptRoamingServiceGetActionName"),u.AFrameworkApplication.fa.Ga("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.bG=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.bG.rUa=a.ka("810");this.bG.gzb=a.ka("809");this.bG.WUa=a.ka("299");if(this.bG.rUa||this.bG.gzb)this.K.resolve("Box4.Proofing.IProofingDescriptors").Pee(),this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.bG.WUa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.bG.gzb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.bG.gzb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose()}pzi(){this.K.register(1266,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().oa(()=>new ow(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader")))}qzi(){this.K.register(1267,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().oa(()=>new Vq(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").CTj))}static main(){v.a.instance.Dc(new Uu)}}Object(n.a)(Uu,"PPTWebEditorProofingPackage",null,[2,3]);class Vu{constructor(a,b,c,f,l,w,H,U,ja,wa){this.ld=a;this.ld.hHc(Object(F.a)(this,this.S7g,"onTextEditViewClose"));this.ld.YYb(Object(F.a)(this,this.T7g,"onTextEditViewOpen"));this.ld.Qbi(Object(F.a)(this,this.U2g,"onBeforeTextEditViewClose"));this.ld.Ubi(Object(F.a)(this,
this.U7g,"onTextEditViewUpdate"));this.pre=b;this.wi=l;this.xt=w;this.wJ=c;this.Qfb=f;this.gec=H;this.tdc=U;this.abd=ja;this.wE=wa}get AKc(){return this.pre.instance}dispose(){this.ld.RRe(Object(F.a)(this,this.S7g,"onTextEditViewClose"));this.ld.gmd(Object(F.a)(this,this.T7g,"onTextEditViewOpen"));this.ld.l0k(Object(F.a)(this,this.U2g,"onBeforeTextEditViewClose"));this.ld.o0k(Object(F.a)(this,this.U7g,"onTextEditViewUpdate"))}U7g(){this.tdc.YY()}T7g(a,b){a=b.Px.shapeNode;this.wJ.zqc(a,!1);this.wJ.wjd(a);
this.AKc&&this.AKc.dzk(a)}U2g(a,b){this.gec.f2d(b.Px.Nd)}S7g(a,b){a=b.Px;const c=b.Px.shapeNode,f=!!c&&c.isConnected;b.oua?this.wE.instance&&((this.wE.instance.rAb||this.wE.instance.N_)&&2===this.wE.instance.NE||this.wE.instance.z0c)?va.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",this.wE.instance.NE,this.wE.instance.z0c):(f&&c.Ppd(),c.ud?(this.wJ.xFh(c),this.Qfb.l3g(),this.xt.d1e()):(this.wi.q7a(c),this.xt.EVd())):
this.abd||this.wJ.xFh(c);this.wJ.zqc(b.Px.shapeNode,f&&c.IZc);this.AKc&&!a.aq&&this.AKc.czk(c)}}Object(n.a)(Vu,"ShapeViewElementTextEditHandler",null,[106]);class yw{constructor(a){this.vic=null;this.Pbk=a;this.reset()}FDh(a,b){a&&this.vic.$(a,b)}Oxb(a){let b=0;this.vic.Gb(a)&&(b=this.vic.ga(a)?1:2);return b}NFe(a){return this.Pbk?1===this.Oxb(a):!1}reset(){const a=this.vic;this.vic=new qd.a(!1);return a}}Object(n.a)(yw,"TextEditingRevisionInfoTracker",null,[1327,1328]);var zt=d(1072),te=d(583),zw=
d(419),si=d(852),Wu=d(323);class py{constructor(){this.typeField=this.startAtField=0}}Object(n.a)(py,"CT_TextAutonumberBullet",null,[]);class lq{constructor(){this.charField=null}}Object(n.a)(lq,"CT_TextCharBullet",null,[]);class Xu{}Object(n.a)(Xu,"CT_TextNoAutofit",null,[]);class Aw{}Object(n.a)(Aw,"CT_TextNoBullet",null,[]);class ss{constructor(){this.lnSpcReductionField=this.fontScaleField=0}}Object(n.a)(ss,"CT_TextNormalAutofit",null,[]);class Cr{constructor(){this.itemField=null}}Object(n.a)(Cr,
"CT_TextSpacing",null,[]);class qy{constructor(){this.valField=0}}Object(n.a)(qy,"CT_TextSpacingPercent",null,[]);class ts{constructor(){this.tField=this.rPrField=null}}Object(n.a)(ts,"CT_WebRegularTextRun",null,[]);class ry{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(n.a)(ry,"CT_WebTextBody",null,[]);class sy{constructor(){this.lInsField=this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=
0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(n.a)(sy,"CT_WebTextBodyProperties",null,[]);class rp{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=
this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;
this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(n.a)(rp,"CT_WebTextCharacterProperties",null,[]);class Tn{constructor(){this.pPrField=
this.itemsField=this.endParaRPrField=null}}Object(n.a)(Tn,"CT_WebTextParagraph",null,[]);class At{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=
null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;
this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(n.a)(At,"CT_WebTextParagraphProperties",null,[]);class Yu{constructor(a,b){this.shapeText=a;this.$Pb=b}}Object(n.a)(Yu,"ShapeTextState",null,[]);class Bw{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(n.a)(Bw,
"IncrementalRequestTextOperation",null,[]);class ij{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}PG(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.PG()}qxa(a){return this.contains(a.cp)||a.contains(this.cp)}cFa(a){const b=Math.max(a.cp,this.cp);return new ij(b,Math.max(0,Math.min(a.PG(),this.PG())-1-b+1))}static copy(a){return new ij(a.cp,a.len)}}Object(n.a)(ij,"TextRange",null,[]);class sp{constructor(a){this.Lq=a}}Object(n.a)(sp,"ChangeState",null,[]);const Cw=(a,b)=>
{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new rp;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,
f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=
b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||
(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},Dw=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new At;let f=!1;mq(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);mq(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);mq(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);mq(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);mq(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,
f=!0);mq(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);Jc.c(a.defRPrField)!==Jc.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);Jc.c(a.buCharField)!==Jc.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);Jc.c(a.buAutoNumField)!==Jc.c(b.buAutoNumField)&&(c.buAutoNumField=b.buAutoNumField,f=!0);Jc.c(a.buFontField)!==Jc.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==
b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||
a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=
b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=
b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,
c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},mq=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class us{constructor(){this.eo=this.NHa=null}}Object(n.a)(us,"TextParaRange",null,[]);class Bt{constructor(){this.eo=this.GIa=null}}Object(n.a)(Bt,"TextRunRange",null,[]);class vs{constructor(a,
b,c,f,l,w){this.afa=this.Kma=null;this.e5=this.Fla=0;this.PL=this.u4=null;this.kwa=this.oGa=0;this.pGa=c;this.cIa=f;this.Hla=l;this.z$=w;this.Epd(new ij(0,a.shapeText.length),new ij(0,b.shapeText.length))}Epd(a,b){this.Kma=a;this.afa=b;for(a=Math.max(0,this.oGa-1);a<this.pGa.length;a++)if(this.pGa[a].eo.qxa(this.Kma)||this.Kma.PG()<=this.pGa[a].eo.cp){this.oGa=a;break}for(a=Math.max(0,this.kwa-1);a<this.cIa.length;a++)if(this.cIa[a].eo.qxa(this.afa)||this.afa.PG()<=this.cIa[a].eo.cp){this.kwa=a;break}this.PL=
this.u4=null;for(a=Math.max(0,this.Fla-1);a<this.Hla.length;a++)if(this.Hla[a].eo.qxa(this.Kma)||this.Kma.PG()<=this.Hla[a].eo.cp){this.Fla=a;break}for(a=Math.max(0,this.e5-1);a<this.z$.length;a++)if(this.z$[a].eo.qxa(this.afa)||this.afa.PG()<=this.z$[a].eo.cp){this.e5=a;break}}zMf(){return this.oGa>=this.pGa.length?null:Object.assign(new us,{NHa:this.pGa[this.oGa].NHa,eo:this.pGa[this.oGa].eo.cFa(this.Kma)})}AMf(){return this.kwa>=this.cIa.length?null:Object.assign(new us,{NHa:this.cIa[this.kwa].NHa,
eo:this.cIa[this.kwa].eo.cFa(this.afa)})}CMf(){return this.Nje()&&this.u4?Object.assign(new Bt,{GIa:this.Hla[this.Fla].GIa,eo:this.u4}):null}DMf(){return this.M9b()&&this.PL?Object.assign(new Bt,{GIa:this.z$[this.e5].GIa,eo:this.PL}):null}Mje(){return this.qig()&&this.L9b()}qig(){return this.oGa>=this.pGa.length?!1:this.pGa[this.oGa].eo.qxa(this.Kma)}L9b(){return this.kwa>=this.cIa.length?!1:this.cIa[this.kwa].eo.qxa(this.afa)}Nje(){return!this.qig()||this.Fla>=this.Hla.length?!1:this.Hla[this.Fla].eo.qxa(this.pGa[this.oGa].eo)&&
this.Hla[this.Fla].eo.qxa(this.Kma)}M9b(){return!this.L9b()||this.e5>=this.z$.length?!1:this.z$[this.e5].eo.qxa(this.cIa[this.kwa].eo)&&this.z$[this.e5].eo.qxa(this.afa)}fFh(){this.Mje()&&(this.oGa++,this.kwa++);return this.Mje()}gFh(){this.L9b()&&this.kwa++;return this.L9b()}lBl(){if(!this.Nje()||!this.M9b())return!1;if(this.u4&&this.PL){this.u4.PG()===this.Hla[this.Fla].eo.PG()&&this.Fla++;this.PL.PG()===this.z$[this.e5].eo.PG()&&this.e5++;if(!this.Nje()||!this.M9b())return!1;var a=this.Hla[this.Fla].eo.cFa(this.Kma);
this.u4.cp=Math.max(a.cp,this.u4.PG());this.u4.len=a.PG()-this.u4.cp;a=this.z$[this.e5].eo.cFa(this.afa);this.PL.cp=Math.max(a.cp,this.PL.PG());this.PL.len=a.PG()-this.PL.cp}else this.u4=this.Hla[this.Fla].eo.cFa(this.Kma),this.PL=this.z$[this.e5].eo.cFa(this.afa);a=Math.min(this.u4.len,this.PL.len);this.u4.len=a;this.PL.len=a;return 0<a}mBl(){if(!this.M9b())return!1;this.u4||(this.u4=this.Hla[this.Fla].eo.cFa(this.Kma));if(this.PL){if(this.PL.PG()===this.z$[this.e5].eo.PG()&&(this.e5++,!this.M9b()))return!1;
const a=this.z$[this.e5].eo.cFa(this.afa);this.PL.cp=Math.max(a.cp,this.PL.PG());this.PL.len=a.PG()-this.PL.cp}else this.PL=this.z$[this.e5].eo.cFa(this.afa);return 0<this.PL.len}}Object(n.a)(vs,"TextFormatIterator",null,[]);class Ew{constructor(){this.txt=this.txtrng=null}}Object(n.a)(Ew,"TextModificationData",null,[]);class Ct{constructor(a,b){this.textRange=new ij(a.cp,a.len);this.text=b}}Object(n.a)(Ct,"TextModificationInfo",null,[]);class Fw{constructor(){this.len=this.cp=0}}Object(n.a)(Fw,"TextRangeData",
null,[]);class Fm{constructor(){this.charPrp=this.txtrng=null}}Object(n.a)(Fm,"WebTextCharFormatChange",null,[]);class yo{constructor(){this.paraPrp=this.txtrng=null}}Object(n.a)(yo,"WebTextParaFormatChange",null,[]);class Dr{constructor(a,b){this.Otg=this.qXa=this.PDb=this.vma=this.jU=-1;this.bAe=this.$qe=null;this.jWa=new ij(0,0);this.Tla=new ij(0,0);this.v0=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.FBb=a;this.jfb=b;let c,
f;({TTe:a,pKe:c}=this.L8f(a.$Pb));1<a.length&&(this.Otg=a[a.length-1].eo.PG());({TTe:b,pKe:f}=this.L8f(b.$Pb));this.rO=new vs(this.FBb,this.jfb,c,f,a,b)}Wxi(){this.Nxi();this.Oxi();this.Yxi();const a=[],b=this.dyi();b&&a.push(b);a.push.apply(a,this.Uxi());a.push.apply(a,this.Txi());a.push.apply(a,this.Vxi());return a}L8f(a){const b=[],c=[];var f=[];var l=[];let w=0;if(!a.pField)return{TTe:f,pKe:l};for(const H of a.pField)if(a=new us,a.NHa=H,a.eo=new ij(w,0),f=0,H.itemsField&&H.itemsField.length){for(const U of H.itemsField)U.tField&&
U.tField.length&&(l=new Bt,l.eo=new ij(w,U.tField.length),l.GIa=U,w+=U.tField.length,f+=U.tField.length,b.push(l));w+=1;a.eo.len=f;c.push(a)}return{TTe:b,pKe:c}}Nxi(){this.jU=this.$cd(!0)}Oxi(){this.jU===this.FBb.shapeText.length?this.vma=0:(this.vma=this.$cd(!1),this.jU+this.vma>this.FBb.shapeText.length?this.vma=this.FBb.shapeText.length-this.jU:this.jU+this.vma>this.jfb.shapeText.length&&(this.vma=this.jfb.shapeText.length-this.jU))}Yxi(){this.PDb=this.FBb.shapeText.length-this.jU-this.vma;this.qXa=
this.jfb.shapeText.length-this.jU-this.vma}Uxi(){const a=[];if(!this.jU)return a;this.rO.Epd(new ij(0,this.jU),new ij(0,this.jU));do this.v0=this.DEh(),0!==this.v0.Lq&&a.push(this.cSc(this.v0));while(0!==this.v0.Lq);return a}dyi(){if(!this.PDb&&!this.qXa)return null;this.jWa=new ij(this.jU,this.PDb);this.Tla=new ij(this.jU,this.qXa);this.v0=!this.PDb&&0<this.qXa?new sp(4):0<this.PDb&&!this.qXa?new sp(5):new sp(6);return this.cSc(this.v0)}Txi(){const a=[];if(!this.qXa)return a;const b=new ij(this.jU-
1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.Otg-1);this.rO.Epd(b,new ij(this.jU,this.qXa));do this.v0=this.EAl(),0!==this.v0.Lq&&a.push(this.cSc(this.v0));while(0!==this.v0.Lq);return a}Vxi(){const a=[];if(!this.vma)return a;this.v0=null;this.rO.Epd(new ij(this.jU+this.PDb,this.vma),new ij(this.jU+this.qXa,this.vma));do this.v0=this.DEh(),0!==this.v0.Lq&&a.push(this.cSc(this.v0));while(0!==this.v0.Lq);return a}cSc(a){if(!a)return null;const b=new Bw;b.chngTyp=a.Lq;switch(a.Lq){case 3:b.charFrmtChng=
Object.assign(new Fm,{txtrng:this.Tla,charPrp:this.$qe});break;case 2:b.paraFrmtChng=Object.assign(new yo,{txtrng:this.Tla,paraPrp:this.bAe});break;case 4:b.insChar=Dr.g2e(new Ct(this.jWa,this.jfb.shapeText.substring(this.Tla.cp,this.Tla.PG())));break;case 5:b.delChar=Dr.g2e(new Ct(this.jWa,""));break;case 6:b.repChar=Dr.g2e(new Ct(this.jWa,this.jfb.shapeText.substring(this.Tla.cp,this.Tla.PG())))}return b}$cd(a){const b=this.FBb.shapeText,c=this.jfb.shapeText,f=new ij(0,b.length),l=new ij(0,c.length);
let w=a?0:b.length-1,H=a?0:c.length-1;for(;f.contains(w)&&l.contains(H)&&b.charAt(w)===c.charAt(H);)w=a?w+1:w-1,H=a?H+1:H-1;return a?w:b.length-w-1}EAl(){do{for(;this.rO.mBl();){var a=this.rO.CMf(),b=this.rO.DMf();if(a&&b){var c=Cw(a.GIa,b.GIa);this.jWa=ij.copy(a.eo);this.Tla=ij.copy(b.eo);if(c)return this.$qe=c,new sp(3)}}if(this.rO.L9b()&&(a=this.rO.zMf(),b=this.rO.AMf(),a&&b&&(c=Dw(a.NHa,b.NHa),this.jWa=ij.copy(a.eo),this.Tla=ij.copy(b.eo),c)))return this.bAe=c,this.rO.gFh(),new sp(2)}while(this.rO.gFh());
return new sp(0)}DEh(){do{for(;this.rO.lBl();){var a=this.rO.CMf(),b=this.rO.DMf();if(a&&b){var c=Cw(a.GIa,b.GIa);this.jWa=ij.copy(a.eo);this.Tla=ij.copy(b.eo);if(c)return this.$qe=c,new sp(3)}}if(this.rO.Mje()&&(a=this.rO.zMf(),b=this.rO.AMf(),a&&b&&(c=Dw(a.NHa,b.NHa),this.jWa=ij.copy(a.eo),this.Tla=ij.copy(b.eo),c)))return this.bAe=c,this.rO.fFh(),new sp(2)}while(this.rO.fFh());return new sp(0)}static g2e(a){return Object.assign(new Ew,{txt:a.text,txtrng:Dr.ywl(a.textRange)})}static ywl(a){return Object.assign(new Fw,
{cp:a.cp,len:a.len})}}Object(n.a)(Dr,"IncrementalChangeIterator",null,[]);class Gw{constructor(){this.rh=this.bh=this.increq=null}}Object(n.a)(Gw,"TextLayoutDeltaClientRequestData",null,[]);class Hw{constructor(){this.tb=null;this.h=this.w=0}}Object(n.a)(Hw,"TextLayoutFullClientRequest",null,[]);class Iw{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(n.a)(Iw,"TextLayoutRequest",null,[]);class Zu{constructor(a,b,c,f,l,w){this.rgc=this.Nl=null;this.Jdc=!0;this.THa=
-1;this.oek=(new Date).getTime();this.geb=this.Rla=0;this.Ecc=-1;this.ere=5E3;const H=document.createElement("a");H.href=a;H.protocol="http:"===H.protocol?"ws":"wss";this.$Fb=H.href;this.K4=b;this.U0b();this.nHg=c;this.uIg=f;this.Ldk=l;this.sAe=w.twl;this.S8c=w.swl;this.JSg=w.pwl;this.bad=w.owl;this.Pma=this.JSg;this.AXe()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.xHb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.uIg&&this.uIg(a)}catch(b){va.a.J(578828128,
824,50,(this.K4?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.nHg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.Jdc;this.nHg(b)}this.Jdc=!1}else va.a.J(592304271,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){va.a.J(592840414,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){va.a.J(592840412,
820,10,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){va.a.J(592840410,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.kpc();this.ping();this.Ldk()}AXe(){this.rgc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Ecc),this.Nl||(va.a.J(587522389,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.eya())):this.Ecc=
window.setTimeout(()=>{this.Nl&&(va.a.J(587522387,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Nl.close(),this.Nl=null,window.clearTimeout(this.THa))},this.ere)};window.self.addEventListener("visibilitychange",this.rgc)}U0b(){this.Nl&&this.Nl.close();this.Nl=new WebSocket(this.$Fb,[]);this.Nl.onopen=Object(F.a)(this,this.onOpen,"onOpen");this.Nl.onerror=Object(F.a)(this,this.onError,"onError");this.Nl.onclose=Object(F.a)(this,
this.onClose,"onClose");this.Nl.onmessage=Object(F.a)(this,this.onMessage,"onMessage")}kpc(){this.Rla=0}SQd(){0<this.bad&&(new Date).getTime()-this.geb>this.bad&&(this.kpc(),va.a.J(587337758,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}LUd(){return(new Date).getTime()-this.geb>this.Pma&&this.Rla<this.S8c&&(!this.Nl||3===this.Nl.readyState||2===this.Nl.readyState)}JWe(){this.geb=(new Date).getTime();this.Pma=Math.pow(2,this.Rla)*this.JSg;
0<this.bad&&(this.Pma=Math.min(this.Pma,this.bad));window.setTimeout(()=>{this.eya()},this.Pma)}eya(){this.SQd();this.LUd()&&(this.U0b(),this.JWe(),this.Rla++,va.a.J(588071072,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.Rla===this.S8c&&va.a.J(588071070,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.Nl?(va.a.J(587804674,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",
kn[this.Nl.readyState]),1===this.Nl.readyState?this.Nl.send(Jc.c(a)):this.eya()):va.a.J(587522383,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.Nl?1===this.Nl.readyState?this.Nl.send("ping"+((new Date).getTime()-this.oek).toString()):(va.a.J(588294232,820,10,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.Nl.readyState),this.eya()):va.a.J(587522380,820,50,(this.K4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}xHb(){-1!==
this.THa&&window.clearTimeout(this.THa);this.THa=window.setTimeout(()=>{this.ping()},this.sAe)}}Object(n.a)(Zu,"WebSocketTextLayoutFetcher",null,[1360]);class Er{constructor(a,b,c,f,l,w,H){this.qFb=this.yfb=this.Zyg=this.Yyg=null;this.nextId=1;this.lre=-1;this.kre=0;this.Vue=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");
if(!w)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Ea=a;this.kq=b;this.mfa=f;this.la=l;this.zU=-1;w.execute(U=>{this.yfb=U});this.la.vwl&&(this.Yyg=new Zu(this.la.rwl,!1,Object(F.a)(this,this.P4j,"logOnResponseReceived"),Object(F.a)(this,this.bAk,"onTextLayoutReceived"),Object(F.a)(this,this.p3g,"onConnectionOpen"),this.la),this.la.Ybh&&(this.Zyg=new Zu(this.la.qwl,!0,Object(F.a)(this,this.O4j,"logOnDarkTrafficResponseReceived"),null,Object(F.a)(this,this.p3g,"onConnectionOpen"),this.la)));
this.Yea=H}uM(a,b,c){va.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.zU){window.clearTimeout(this.zU);this.zU=-1;var f=this.kq.presentation;f?(a=Object(qa.a)(116,f.AC(N.a.VE(a,b))))?(c=a.lT(c))?c.hmb(!1):va.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):va.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):va.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}N4j(){this.kre++;
-1===this.lre&&(this.lre=window.setTimeout(Object(F.a)(this,this.jtk,"onCoauthLogTimer"),3E5))}jtk(){this.lre=-1;va.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.kre);this.kre=0}o7f(a){let b="";a.NJ(c=>{(c=Object(qa.a)(Sd.AParagraphNode,c))&&(b+=zb.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}Xxi(a){try{var b=Object,c=b.assign,f=new Gw,l=this.qFb;const wa=[];var w,H=l.$Pb.bodyPrField,U=a.$Pb.bodyPrField;let Sa=!1;H.anchorField!==U.anchorField&&
(Sa=!0);H.bInsField!==U.bInsField&&(Sa=!0);H.tInsField!==U.tInsField&&(Sa=!0);H.lInsField!==U.lInsField&&(Sa=!0);H.rInsField!==U.rInsField&&(Sa=!0);H.horzOverflowField!==U.horzOverflowField&&(Sa=!0);H.vertOverflowField!==U.vertOverflowField&&(Sa=!0);Jc.c(H.normAutofitField)!==Jc.c(U.normAutofitField)&&(Sa=!0);Jc.c(H.spAutoFitField)!==Jc.c(U.spAutoFitField)&&(Sa=!0);H.rotField!==U.rotField&&(Sa=!0);H.spcFirstLastParaField!==U.spcFirstLastParaField&&(Sa=!0);H.wrapField!==U.wrapField&&(Sa=!0);(w=Sa?
U:null)&&wa.push(Object.assign(new Bw,{chngTyp:1,bodyPrChng:w}));const eb=new Dr(l,a);var ja=wa.concat.apply(wa,eb.Wxi());const ub=c.call(b,f,{increq:ja});va.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",Jc.c(ub).length);return ub}catch(wa){va.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",wa.message)}return null}B3d(a,b){if(this.la.tCh&&a)if(b&&va.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),
this.mfa.aqi())if(0!==this.mfa.kti(a,this.Ea))a.hmb(!1);else{if(!a.BCb)if(b)a.hmb(this.la.oOb);else return;if(!a.gB&&a.rda().length&&(a.RLa||4===a.TK))try{const c=this.abe(a),f=Object.assign(new Iw,{id:this.nextId.toString(),corr:gh.a.create().toString()});if(this.la.uwl)if(!this.qFb||b||this.Vue)this.qFb=new Yu(this.o7f(a),c),this.Vue=!1;else{const w=this.o7f(a),H=new Yu(w,c),U=zt.a.rwb(Jc.c(this.qFb.$Pb));f.delta=this.Xxi(H);f.delta&&(f.delta.bh=U,f.delta.rh=zt.a.rwb(Jc.c(H.$Pb)));if(f.delta&&!f.delta.increq.length)if(this.la.f2e)f.delta=
null;else return;if(f.delta&&f.delta.increq.length)for(const ja of f.delta.increq)if(ja.repChar){ja.repChar.txtrng.len===this.qFb.shapeText.length&&(f.delta=null);break}this.qFb=H}f.delta&&f.delta.increq.length&&!this.la.f2e||(f.full=Object.assign(new Hw,{tb:c,w:a.RLa?a.RLa.Right:a.get_widthPersisted(),h:a.RLa?a.RLa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.zU&&window.clearTimeout(this.zU);this.zU=window.setTimeout(()=>{this.uM(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.wwl);
f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.zU;f.h.reqHash=zt.a.rwb(Jc.c(c));f.h.reqSz=Jc.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.la.f2e;const l=a.wnj();b&&l&&(f.h.initialTextLayout=l.toString());this.Yyg.fetch(f);this.la.Ybh&&this.Zyg.fetch(f)}catch(c){va.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.N4j(),a.hmb(!1)}rJf(a,b){switch(a.listType){case 16:b.buNoneField=
new Aw;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new py,{startAtField:a.yA});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new lq,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new Sl,b.buFontField.typefaceField=a.font}}dTa(a){const b=new qy;b.__type=Er.z0j;b.valField=Math.floor(1E5*a);return b}DBi(a){const b=new At;var c=new ob.GraphIterator;c.set(a);c.rc(11);c.Jg(11);
a.Rf.lw(c)?this.rJf(a.Rf.lw(c),b):this.rJf(cf.a.yN(16,0),b);c=a.sa(Va.a.$l,Jg.a.leftMargin);const f=a.sa(Va.a.wY,Jg.a.rightMargin);b.indentField=te.a.Cud(a.sa(Va.a.ho,Jg.a.indent));b.indentFieldSpecified=!0;b.marLField=te.a.Cud(c);b.marLFieldSpecified=!0;b.marRField=te.a.Cud(f);b.marRFieldSpecified=!0;b.defTabSzField=te.a.Cud(a.sa(Va.a.Gub,Er.jJc));b.defTabSzFieldSpecified=!0;b.lvlField=a.sa(Va.a.listLevel,Jg.a.PEa);b.lvlFieldSpecified=!0;b.algnField=this.mwl(a.sa(Za.a.Jl,1));b.algnFieldSpecified=
!0;2===this.Yea.QW(a).lineSpacing.unit&&(b.lnSpcField=new Cr,b.lnSpcField.itemField=this.dTa(this.Yea.QW(a).lineSpacing.value));2===this.Yea.QW(a).beforeSpacing.unit&&(b.spcBefField=new Cr,b.spcBefField.itemField=this.dTa(this.Yea.QW(a).beforeSpacing.value));2===this.Yea.QW(a).afterSpacing.unit&&(b.spcAftField=new Cr,b.spcAftField.itemField=this.dTa(this.Yea.QW(a).afterSpacing.value));a=Pa.OutlineElementNavigator.WA(a);a.properties.Sa(Za.a.vY)&&(b.rtlField=a.Mh(Za.a.vY));return b}mwl(a){switch(a){case 2:return 1;
case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}abe(a){try{const b=Object.assign(new ry,{bodyPrField:new sy,pField:[]});b.bodyPrField.noAutofitField=a.Z$?new Xu:null;a.Sa(hb.a.W2)&&(b.bodyPrField.normAutofitField=new ss,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.W2));a.Sa(hb.a.Nra)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new ss),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.Nra));b.bodyPrField.rotField=Math.floor(a.i2e);
b.bodyPrField.vertField=a.B6;b.bodyPrField.lInsField=Math.floor(Of.a.CGb(a.Tia));b.bodyPrField.tInsField=Math.floor(Of.a.CGb(a.Via));b.bodyPrField.rInsField=Math.floor(Of.a.CGb(a.Uia));b.bodyPrField.bInsField=Math.floor(Of.a.CGb(a.Sia));b.bodyPrField.anchorField=a.gpa;b.bodyPrField.wrapField=a.Q0c?0:1;this.Ea.NJ(a,c=>{if(c=Object(qa.a)(Sd.AParagraphNode,c)){var f=Object.assign(new Tn,{itemsField:[]});f.pPrField=this.DBi(c);for(var l=zb.ParagraphReader.text(c),w=0;w<c.Ra.length;){const U=new ts;U.__type=
"CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var H=c.Ra.ga(w);const ja=H.cp,wa=w<c.Ra.length-1?c.Ra.ga(w+1).cp:zb.ParagraphReader.textLength(c);w++;H.formatting?U.rPrField=this.M8f(H.formatting.cache):(H=zw.c(c.Ra,H.cp).N1c,U.rPrField=H?this.M8f(H.cache):this.znj(a));U.tField=ha.a.substring(l,ja,wa);f.itemsField.push(U)}b.pField.push(f)}});return b}catch(b){throw va.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");
}}M8f(a){const b=new rp;b.bField=a.isBold;b.bFieldSpecified=a.LTa;b.iField=a.isItalic;b.iFieldSpecified=a.R$a;b.uField=a.hE;b.uFieldSpecified=a.iyb;b.strikeFieldSpecified=a.hyb;b.strikeField=a.PF;b.szField=a.fontSize*Ef.a.xmc*Ef.a.$$a;b.szFieldSpecified=a.Ota;b.baselineFieldSpecified=a.Sa(hb.a.qN);b.baselineField=a.eb(hb.a.qN);b.capFieldSpecified=a.MTa;b.capField=a.capitalization;if(a.dcg){const c=Xa.a.xe(a.language);b.langField=c?c.dwb:"en-US"}a.Sa(hb.a.latinFont)&&(b.latinField=Object.assign(new Sl,
{typefaceField:a.eb(hb.a.latinFont)}));a.Sa(hb.a.eastAsianFont)&&(b.eaField=Object.assign(new Sl,{typefaceField:a.eb(hb.a.eastAsianFont)}));a.V3&&(b.rawSolidFillField=Object.assign(new Wu.a,{srgbClrField:Object.assign(new si.a,{valField:tc.a.usb(a.fontColor)})}));a.RTa&&(b.highlightField=Object.assign(new bm.a,{srgbClrField:Object.assign(new si.a,{valField:tc.a.usb(a.highlight)})}));a.Sa(hb.a.ttb)&&(b.spcField=a.eb(hb.a.ttb),b.spcFieldSpecified=!0);a.Sa(hb.a.NAb)&&(b.kernField=a.eb(hb.a.NAb),b.kernFieldSpecified=
!0);return b}znj(a){const b=new rp;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.hE;b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.PF;b.szField=a.Paa*Ef.a.xmc;b.szFieldSpecified=!!b.szField;const c=Xa.a.xe(a.WSa());b.langField=c?c.dwb:"en-US";a.Sa(hb.a.latinFont)&&(b.latinField=Object.assign(new Sl,{typefaceField:a.eb(hb.a.latinFont)}));a.Sa(hb.a.eastAsianFont)&&(b.eaField=Object.assign(new Sl,{typefaceField:a.eb(hb.a.eastAsianFont)}));
b.baselineField=a.qN;b.baselineFieldSpecified=!0;return b}P4j(a){if(a){va.a.J(512493790,820,50,Dl.c(a));var b=new Map;for(let l in a){var c=l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}dg.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else va.a.J(512493791,820,50,"response data null")}O4j(a){a?va.a.J(512493788,820,50,"Dark Traffic"+Dl.c(a)):va.a.J(512493789,820,50,"Dark Traffic response data null")}p3g(){this.Vue=!0}s1f(a){var b=
this.kq.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.Vlb(a,"cid"),f=this.Vlb(a,"sid");a=this.Vlb(a,"shapeId");if(!c||!f||!a)return va.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(qa.a)(116,b.AC(N.a.VE(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.lT(Number.parseInvariant(a)):(va.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}bAk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&
a.h)va.a.J(512493785,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.s1f(a.h))?this.B3d(a,!0):va.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");else{if(va.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?dg.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new Nj.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),
dg.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new Nj.a,{extendedProperties:b})))}}else if(this.la.oOb){b=this.Vlb(a.h,"timeoutId");var c=this.Vlb(a.h,"firstRequest");if(b&&-1!==this.zU&&this.zU===Number.parseInvariant(b))window.clearTimeout(this.zU),this.zU=-1;else if(!c||!Boolean.parse(c))return;if(b=this.s1f(a.h)){var f=this.Vlb(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",
a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),dg.Health.instance.recordKpiFailure("TextLayoutServiceResponse","ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new Nj.a,{extendedProperties:c})),va.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.hmb(!1)):b.hmb(!0):(f=this.Vlb(a.h,"reqHash"))?(c=this.abe(b),zt.a.rwb(Jc.c(c))!==f?va.a.J(512493779,820,50,
"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.yfb&&this.yfb.xdl(f,a.l,b),b.Avd(a.l))):va.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else va.a.J(512493782,820,50,"OnTextLayoutReceived - IShapeNode is null")}}Vlb(a,b){return b in a?a[b].toString():null}}Er.z0j="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Er.jJc=1440;Object(n.a)(Er,"TextLayoutManager",null,[1275]);var ws;(function(a){a[a.noWall=0]="noWall";
a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(ws||(ws={}));Object(n.b)("TextLayoutWall",ws);var $u=d(872);class Jw{constructor(a,b){this.$ye=new qd.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.cWa=a;this.mfa=b.wCh}Sac(a){switch(a){case 1:return!!this.mfa.COAUTH;case 2:return!!this.mfa.LINEBREAKBLOBS;case 3:return!!this.mfa.TABLE;case 4:return!!this.mfa.SMARTART;
case 5:return!!this.mfa.NONRECTSHAPE}return!1}aqi(){return!this.Sac(1)||this.cWa.TDa}yti(a,b){return a?this.Sac(2)&&$u.a.oVf(a,b)?2:this.Sac(3)&&a.ud?3:this.Sac(4)&&a.Qf?4:this.Sac(5)&&4!==a.TK?5:0:0}kti(a,b){b=this.yti(a,b);if(!this.$ye.Gb(a.lMa)||this.$ye.ga(a.lMa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.lMa.toString());c.set("IsShapeWalled",ws[b]);dg.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",
ws[b]),dg.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new Nj.a,{extendedProperties:c})))}this.$ye.$(a.lMa,b);return b}}Object(n.a)(Jw,"TextLayoutServiceWalls",null,[1274]);class Kw{constructor(a,b,c,f){this.yt=a;this.Te=b.Ma;this.wO=c;this.a7c=f}initialize(){this.yt.FPa(Object(F.a)(this,this.jwf,"adjustShapeViews"))}dispose(){this.yt.xKb(Object(F.a)(this,this.jwf,"adjustShapeViews"))}jwf(a,b){if((a=b.nG)&&a.Fd&&(a=a.Fd.N3(c=>c.isEditable&&
c.MQ))&&a.length)for(const c of a)if(a=Object(qa.a)(117,c.ng(this.Te)))a.ZIh(),c.ud&&a.Wn&&a.mHl(),!this.a7c||this.wO&&!b.D0c||a.fO||!a.fB||a.IAh()}}Object(n.a)(Kw,"TextLocalRenderAdjustManager",null,[106]);class Dt{constructor(){this.zic=this.xEb=null;this.ivg=-1;this.Qcc=Date.now()}Gbg(){return 0<=this.ivg}}Object(n.a)(Dt,"LineBreakComparison",null,[]);class ty{constructor(a){this.qH=new qd.a;this.wGg=0;this.fCf="TextLayoutServiceAccuracy";this.jic=a}wdl(a,b){try{if(a&&b){var c=a.xC(),f=zt.a.rwb(Jc.c(b.abe(a)));
if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const w=ki.a.ki(c[l],hb.a.nOb,null);w&&(b.push.apply(b,w.Lines),b.push(-1))}if(b.length){if(!this.qH.Gb(f))this.qH.add(f,new Dt);else if(this.qH.ga(f).Gbg())return;this.qH.ga(f).xEb=b;this.dIf(f,a)}}}}catch(l){va.a.J(512493704,820,10,l.message)}}xdl(a,b,c){try{if(!this.qH.Gb(a))this.qH.add(a,new Dt);else if(this.qH.ga(a).Gbg())return;this.qH.ga(a).zic=b;this.dIf(a,c)}catch(f){va.a.J(512493703,820,10,f.message)}}dIf(a,b){if(this.qH.ga(a)&&this.qH.ga(a).xEb&&
this.qH.ga(a).zic){var c=!0;if(this.qH.ga(a).xEb.length!==this.qH.ga(a).zic.length)c=!1;else for(var f=0;f<this.qH.ga(a).xEb.length;f++)if(this.qH.ga(a).xEb[f]!==this.qH.ga(a).zic[f]){c=!1;break}va.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.rda().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());dg.Health.instance.recordKpiUsage(this.fCf,0,"pptotext",
f);c||(f.set("UnifiedResponseLineCount",this.qH.ga(a).xEb.length.toString()),f.set("TextLayoutResponseLineCount",this.qH.ga(a).zic.length.toString()),dg.Health.instance.recordKpiFailure(this.fCf,"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new Nj.a,{extendedProperties:f})));this.qH.ga(a).ivg=Date.now()}this.Lti()}Lti(){const a=Date.now();a-this.wGg<this.jic||(this.qH.keys.forEach(b=>{a-this.qH.get(b).Qcc>this.jic&&this.qH.remove(b);return!0}),this.wGg=a)}}Object(n.a)(ty,
"ServiceComparisonLineBreakTelemetry",null,[1276]);class Et{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}Zb(a){this.K=a;this.K.register(yw,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().oa(()=>new yw(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(Vu,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().oa(()=>
new Vu(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Ja("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,
a.Ja("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(Kw,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().oa(()=>new Kw(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").Fig));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").tCh;va.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",
b);b&&(this.K.register(1274,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().oa(()=>new Jw(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1275,"PowerPointWebEditor.ITextLayoutManager").ma().oa(()=>{try{return new Er(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.AFrameworkApplication.Ke,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.Ja("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return va.a.J(593892503,820,10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),this.K.register(1276,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().oa(()=>new ty(this.K.resolve("PowerPointWebEditor.IApplicationSettings").nwl)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.Fig&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){v.a.instance.Dc(new Et)}}Object(n.a)(Et,"PPTWebEditorTextEditingPackage",null,[2,3]);class av{constructor(){this.capabilities=
2}}Object(n.a)(av,"IExternalPeopleAPI",null,[]);class Lw{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(n.a)(Lw,"ExternalGrantAccessResponse",null,[]);class bv{constructor(a,b,c,f){this.authorImageURL=this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(n.a)(bv,"PersonaIconProperties",null,[]);var Ft=d(669),tp=d(670),Mw=d(529);class cv extends av{constructor(a,b,c,f,l){super();this.QV=a;this.lZh=b;this.gdf=
c;this.WNh=l}h9g(a){this.QV.rya=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.QV.xhg.continueWith(c=>{c.Vn||c.rm?(ka.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(tp.a.Ys(-2130915318))):a(this.QV.xhg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.QV.checkUserAccess([a]);f.continueWith(l=>{l.Vn||l.rm?(ka.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(tp.a.Ys(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){ka.ULS.sendTraceTag(37582727,
380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.QV.oCa(a);f.continueWith(l=>{if(l.Vn||l.rm)ka.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),c(tp.a.Ys(-2130915318));else{l=f.result;var w=!l.Canceled;for(var H of l.Result)if(!H.UserCanWrite&&!H.UserCanReview){w=!1;break}H=new Lw(w,l);b(H)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const w=this.QV.getUserContacts(a,b,0,c,"AtMentions");
w.continueWith(H=>{H.Vn||H.rm?(ka.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(tp.a.Ys(-2130915318))):f(w.result)})})}getAuthToken(){ka.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,b)=>{this.gdf.continueWith(c=>{c.Vn||c.rm?(ka.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(tp.a.Ys(-2130915318))):this.gdf.result.ydj().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(ka.ULS.sendTraceTag(539100294,380,
15,"PeopleManager GetAuthToken use AAD token"),a(f.token)):u.AFrameworkApplication.fa.Ga("LokiUserDataSignature")?(ka.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.WNh.execute(l=>{l.u4i().then(w=>{void 0!==w&&null!==w&&0<w.length?(ka.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(w)):0<u.AFrameworkApplication.fa.Ga("LokiUserDataSignature").length&&(ka.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),
a(u.AFrameworkApplication.fa.Ga("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(ka.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(tp.a.Ys(-2130915318))):(ka.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(tp.a.Ys(-2130915318)))}).catch(f=>{ka.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(tp.a.Ys(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>
{const c=[];for(const l of a){let w=null;var f=l;let H=l.Email;H&&""!==H||!l.UserId||""===l.UserId||"AD"!==l.Provider||(H=Mw.a.L8a(l.UserId));H&&""!==H&&(w=this.QV.rub(H,l.Provider,u.AFrameworkApplication.hh,0),f=new Ft.a(H,void 0,l.DisplayName));f=this.lZh.Kta(f,2);Array.add(c,new bv(l.DisplayName,l.UserId,f,w))}b(c)})}}Object(n.a)(cv,"ExternalPeopleAPI",av,[]);class Wq{constructor(){this.O5a={};this.Snb={};this.cHd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in
this.O5a?(b=this.O5a[a.UserId],!c||c in this.Snb||(this.Snb[c]=b)):c&&c in this.Snb&&(b=this.Snb[c],a.UserId&&(c in this.cHd?(delete this.cHd[c],this.O5a[a.UserId]=b):a.UserId in this.O5a||(b=null)));return b}add(a,b){a.UserId&&(this.O5a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.Snb||(this.Snb[c]=b,a.UserId||(this.cHd[c]=!0))}E6i(a){a=Array(a.KKc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of pa.a.nL(this.O5a))b=this.O5a[c],b.sources.contains(1)&&a[b.nHf]++;return a}normalize(a){return a?
a.toLowerCase():null}}Object(n.a)(Wq,"ColorLookupDict",null,[]);class uy{constructor(a,b){this.nHf=a;this.sources=new Ka.a;this.sources.add(b)}H8h(a){this.sources.contains(a)||this.sources.add(a)}}Object(n.a)(uy,"ColorSource",null,[]);class nq{constructor(a){this.iRb=a;this.PNd=new Wq;this.rhf=-1;this.eOh=0}Kta(a,b,c=!0){if(!this.iRb||!this.iRb.KKc.length)return ka.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.r2i();else if(!a.UserId&&
!a.DisplayName)return ka.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.PNd.get(a);if(f)c=f.nHf,f.H8h(b);else{if(!c)return null;c=this.Tej();this.PNd.add(a,new uy(c,b));this.rhf=c}return this.K6i(this.iRb.KKc[c])}Tej(){const a=this.iRb.KKc.length,b=this.PNd.E6i(this.iRb),c=this.Aeg(this.rhf,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.Aeg(f,a))||(l=!0);else break;l&&ka.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");
return f}Aeg(a,b){return(a+1)%b}r2i(){return"anonymous"+ ++this.eOh}K6i(a){return 16777215>=a?"#"+ha.a.jw((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}Object(n.a)(nq,"PeopleColorUtils",null,[1397]);class Gt{constructor(a,b,c,f,l,w){this.yhg=new fk.a;this.Jqa=a;this.N5a=b;this.jrf=f;this.$a=c;this.S6=l;this.nrf=w;this.$a.ff(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=u.AFrameworkApplication.kmb||u.AFrameworkApplication.PQ,b=this.$a.ka("PeopleEndPointIsEnabled");let c=b&&!a&&
(this.Wlc||this.PNb&&this.QNb);const f=this.$a.ka("DisableAtmentionsForTeams"),l=this.$a.ka("ConsumerMentionsHostIsEnabled")||this.jrf.pAh;c=c&&l&&this.nAh&&this.mAh&&!f;this.$a.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.$a.ka("OneDriveConsumerMentionsIsEnabled"));ka.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",
c,b,this.Wlc,this.PNb,this.QNb,this.nAh,a,this.mAh);this.yhg.Kg(c);c&&this.S6&&this.S6.Uj(4,Object(F.a)(this,this.AIe,"onInteractiveReady"))}AIe(){const a=this.$a.Bc("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.rm||b.Vn)&&ka.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get PNb(){return this.N5a.PNb}get a1c(){return this.nrf.a1c}get QNb(){return this.N5a.QNb}get Wlc(){return this.N5a.Wlc}get nAh(){return this.$a.ka("SupportsAddActivities")}get mAh(){return this.$a.ka("SupportsActivitiesNotification")}oCa(a){return this.N5a.oCa(a)}G1b(a,
b){return this.N5a.G1b(a,b)}get xhg(){return this.yhg.task}get rya(){return this.Jqa.rya}set rya(a){this.Jqa.rya=a}checkUserAccess(a){ka.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.N5a.checkUserAccess(a)}grantUserAccess(a,b,c,f,l){return this.N5a.grantUserAccess(a,b,c,f,l)}getUserContacts(a,b,c,f,l){return this.jrf.getUserContacts(a,b,c,f,l)}rub(a,b,c,f){return this.nrf.rub(a,b,c,f)}supportsExchangeRestApis(){const a=new fk.a,b=this.Jqa.supportsExchangeRestApis();b.continueWith(()=>
{b.rm||b.Vn?a.Kg(!1):a.Kg(!0)});return a.task}}Object(n.a)(Gt,"PeopleManager",null,[1396,1394]);var zo=d(380);class dv{}Object(n.a)(dv,"CheckUserAccessRequestItem",null,[]);class ev extends zo.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.kYd(c)}kYd(a){const b=[];for(const c of a)Array.add(b,Object.assign(new dv,{Id:c.UserId,Provider:c.Provider}));return b}Zk(){return 1}}Object(n.a)(ev,"CheckUserAccessRequest",zo.a,[]);class Nw extends zo.a{constructor(a,b,c,f,l,w,H){super(a,b);
this.Filter=null;this.Skip=this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=w;this.Skip=l;this.Scenario=H}Zk(){return 2}}Object(n.a)(Nw,"GetUserContactsRequest",zo.a,[]);class Ow extends zo.a{constructor(a,b,c,f,l,w,H){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.kYd(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=w;this.GrantReviewAccess=H}kYd(a){const b=[];
for(const c of a)Array.add(b,Object.assign(new dv,{Id:c.UserId,Provider:c.Provider}));return b}Zk(){return 4}}Object(n.a)(Ow,"GrantUserAccessRequest",zo.a,[]);class Pw extends zo.a{constructor(a,b){super(a,b)}Zk(){return 5}}Object(n.a)(Pw,"SupportsExchangeRestApisRequest",zo.a,[]);var Fr=d(528);class xs{constructor(a,b,c,f){this.rya=null;this.K_h=a;this.p2a=b;this.$a=c;this.A2a=f}get I2k(){return this.$a.Bc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return ka.ULS.sendTraceTag(37757202,
380,15,"no user in the request"),a=new fk.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;ka.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new fk.a,c=this.A2a.execute(new ev(this.p2a(),null,a),(f,l,w)=>this.cOc(f,l,w,"CheckUserAccess"),this.rya);c.continueWith(()=>{if(c.Vn||c.rm)b.qG(c.$i);else{var f=this.EEk(c.result.Yi);b.Kg(f)}});return b.task}grantUserAccess(a,b,c,f,l){if(!a||!a.length)return ka.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new fk.a,a.Kg(null),a.task;ka.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const w=new fk.a,H=this.A2a.execute(new Ow(this.p2a(),null,a,b,c,f,l),(U,ja,wa)=>this.cOc(U,ja,wa,"GrantUserAccess"),this.rya);H.continueWith(()=>{if(H.Vn||H.rm)ka.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",H.$i),w.qG(H.$i);else{var U=this.fEk(H.result.Yi);w.Kg(U)}});return w.task}EEk(a){if(!a.data)return ka.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.Wd)return ka.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=Fr.a.a8a(a.data.Wd);return a?a.Result?a.Result:(ka.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(ka.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}fEk(a){if(!a.data)return ka.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.Wd)return ka.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=Fr.a.a8a(a.data.Wd);return a?a.Result?a.Result:(ka.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(ka.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,f,l){const w=new fk.a,H=this.A2a.execute(new Nw(this.p2a(),null,a,b,c,f,l),(U,ja,wa)=>this.cOc(U,ja,wa,"GetUserContacts"),
this.rya);H.continueWith(()=>{if(H.Vn||H.rm)w.qG(H.$i);else{var U=H.result;try{const ja=this.DEk(U.Yi);w.Kg(ja.Result)}catch(ja){w.qG(ja)}}});return w.task}DEk(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.Wd)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=Fr.a.a8a(a.data.Wd);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new fk.a,b=this.A2a.execute(new Pw(this.p2a(),null),(c,f,l)=>this.cOc(c,f,l,"SupportsExchangeRestApisRequest"),this.rya);b.continueWith(()=>{b.Vn||b.rm?(a.qG(b.$i),ka.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(ka.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.eK(!0))});return a.task}cOc(a,b,c,f){return this.K_h.krb(a,2,c,b,2,f,null,!1,null,this.I2k)}}Object(n.a)(xs,"PeopleRequestHandler",null,[1395]);class vy{constructor(a,
b){this.QV=a;this.Ca=b;this.Ca.ya(G.a.rti,Xd.a.frame,Object(F.a)(this,this.mti,"checkUserAccessAction"));this.Ca.ya(G.a.Ooj,Xd.a.frame,Object(F.a)(this,this.Noj,"getUserContactsAction"));this.Ca.ya(G.a.qti,Xd.a.frame,Object(F.a)(this,this.oti,"checkUserAccessAndGrantPermissionsAction"));this.Ca.ya(G.a.Soj,Xd.a.frame,Object(F.a)(this,this.Roj,"getUserProfilePictureAction"));this.Ca.ya(G.a.Ctl,Xd.a.frame,Object(F.a)(this,this.Dtl,"supportsExchangeRestApisTestAction"))}Dtl(){this.supportsExchangeRestApis();
return 32}mti(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}Noj(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}oti(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.oCa(a);return 32}Roj(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.r9f(a);return 32}Bnh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.oCa(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.r9f(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}el.Task.delay(5E3).continueWith(()=>{this.Bnh()})}O5k(){window.setTimeout(Object(F.a)(this,
this.Bnh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.QV.supportsExchangeRestApis();a.continueWith(b=>{if(b.rm)alert("Exception: "+b.$i.message);else{b=a.result;var c=new Bi.StandardDialog;c.yd=0;c.Xe(1,"Close");document.createElement("pre").innerText=b.toString();c.Gx("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}r9f(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.w9i(a)}catch(l){alert("Invalid dimension value");return}Ab.a.instance.Ja("Common.App.People.IPeopleManager").execute(l=>
{var w=l.rub(b,c,u.AFrameworkApplication.hh,f);l=document.createElement("img");l.src=w;w=new Bi.StandardDialog;w.yd=0;w.Xe(1,"Close");w.Gx("Profile photo",null,3,null,l)})}w9i(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.QV.G1b(a,"O365");
const b=this.QV.checkUserAccess(a);b.continueWith(c=>{if(c.rm)alert("Exception: "+c.$i.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new Bi.StandardDialog;l.yd=0;l.Xe(1,"Close");f=document.createElement("pre");f.innerText=c;l.Gx("Check User Access Results",null,3,null,f)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.QV.G1b(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),w=0<=c.toUpperCase().indexOf("REVIEW"),H=this.QV.grantUserAccess(a,b,f,l,w);H.continueWith(U=>{if(U.rm)alert("Exception: "+U.$i.message);else{U=H.result;var ja="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(w?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const wa of U.Result)ja+="User: "+wa.Id+"\nMessage: "+wa.Message+"\nStatus Code: "+wa.Status+"\nProvider: "+wa.Provider+"\n\n";alert(ja)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.QV.getUserContacts(a,b,c,f,"AtMentions");
l.continueWith(w=>{if(w.rm)alert("Something went wrong"+w.$i.message);else if(w.Vn)alert("Task was canceled");else{var H=l.result;w="";for(var U of H)H="ID => "+U.Id+" \n",H+="Provider => "+U.Provider+" \n",H+="DisplayName => "+U.DisplayName+" \n",H+="GivenName => "+U.GivenName+" \n",H+="Surname => "+U.Surname+" \n",H+="Email => "+U.Email+" \n",H+="Title => "+U.Title+" \n",w+=H+"----------------------\n";U=new Bi.StandardDialog;U.yd=0;U.Xe(1,"Close");H=document.createElement("pre");H.innerText=w;
U.Gx("Contacts",null,3,null,H)}})}oCa(a){a=a.split(";");a=this.QV.G1b(a,"O365");const b=this.QV.oCa(a);b.continueWith(c=>{if(c.rm)alert("Exception: "+c.$i.message);else{c=b.result;var f="";for(var l of c.Result){var w=[];Array.add(w,l.UserCanRead?"Read YES":"Read NO");Array.add(w,l.UserCanReview?"Review YES":"Review NO");Array.add(w,l.UserCanWrite?"Write YES":"Write NO");w=l.Id+"=>"+w.join(" | ");f+=w+"\r\n"}l=new Bi.StandardDialog;l.yd=0;l.Xe(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.Gx("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(n.a)(vy,"PeopleTestHook",null,[]);var Gr=d(215);class up{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(n.a)(up,"ShowSharingUiRequestBody",null,[]);class Ht{constructor(a,b){this.j5a=null;this.zDc=new fk.a;this.dXb=new up(this.gGi(),a,b);ka.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.dXb.Persons?
this.dXb.Persons.length:0,this.dXb.UserPermissionsVerified)}get i4k(){return this.zDc.task}get id(){return this.dXb.Id}get payload(){return this.dXb}uel(a){this.j5a=a;this.kKl()?this.zDc.eK(this.j5a):this.zDc.qG(Error.format("Format of the "+Ce.a.yVd+" body is not valid"))}setException(a){ka.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.zDc.qG(a)}gGi(){return Ht.TTh++}lKl(a){if(void 0===a.Id)return ka.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return ka.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(ka.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(ka.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):ha.a.Wzb(a.Status)?!0:(ka.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}kKl(){if(void 0===this.j5a.Persons)return ka.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!Qa.a.isArray(this.j5a.Persons))return ka.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.j5a.Persons.length;a++)if(!this.lKl(this.j5a.Persons[a]))return!1;return void 0===this.j5a.DialogCanceled?(ka.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(ka.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):ha.a.Wzb(this.id)?!0:(ka.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}Ht.TTh=0;Object(n.a)(Ht,"PostmessageRequestState",null,[]);class ys{constructor(a){this.TJd=new Gr.a;this.ATb=this.s3a=null;this.Ief=!1;this.JNa=a}aEj(){ka.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.ATb)return this.ATb.task;this.ATb=new fk.a;this.JNa.continueWith(()=>{ka.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.s3a=this.JNa.result;this.Cee();this.ATb.Kg(!0)});return this.ATb.task}Cee(){this.Ief||(ka.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.Ief=!0,this.s3a.yu(Ce.a.yVd),this.s3a.KB(Ce.a.yVd,Object(F.a)(this,this.pti,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}pti(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)ka.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.TJd.Tf(a.Id)).returnValue?(ka.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.uel(a),this.TJd.remove(a.Id)):ka.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else ka.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}nti(a,b){const c=new Ht(a,b);this.aEj().continueWith(()=>{const f=gh.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,
f);ka.ULS.sendTraceTag(25036179,380,50,l);this.s3a.sendMessage(Ce.a.oCa,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.TJd.add(c.id,c)});return c.i4k}}Object(n.a)(ys,"ShowSharingUiPostMessageHandler",null,[]);class It{}Object(n.a)(It,"GrantUserAccessResponse",null,[]);var ci=d(79);class fv extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.UFk=a;this.PLa=c;this.scenario=f}}Object(n.a)(fv,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class zs{static gEi(a){return ci.a.VA(zs.En,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}zs.En="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(n.a)(zs,"ShareAndNotifyDialogHtml",null,[]);class gv extends ci.a{constructor(a,b,c){super();this.rNa=!1;this.Pa=new vc.a;this.nZh=a;this.g4h=gv.c1i(a);this.dw=b;this.EZ=c}Wbi(a){this.Pa.addHandler("SNEK",a)}EZe(){this.eg=zs.gEi(this.g4h);this.yd=8;this.ig="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(F.a)(this,this.Nhl,"shareAndNotifyDialogResultHandler"));this.f6("ShareAndNotifyDialogTextId")}axa(){}dispose(){this.rNa||(super.dispose(),this.rNa=!0)}Nhl(a){this.Pa.raiseEvent("SNEK",new fv(this.nZh,a,this.dw,this.EZ))}static c1i(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(n.a)(gv,"ShareAndNotifyDialog",ci.a,[]);class hv{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(n.a)(hv,"ShowSharingUiRequestPerson",null,[]);class As{constructor(a,b,c,f,l,w){this.Jqa=a;this.$a=b;this.y1h=c;this.YV=f;this.$Oh=l;this.$d=w}get PNb(){return this.$a.ka("SupportsCheckUserAccess")}get QNb(){return this.$a.ka("SupportsGrantUserAccess")}get Wlc(){return this.$a.ka("PermissionsPostMessage")&&!this.$a.ka("CrossDocumentMessengerDisabled")&&this.$Oh()}oCa(a){const b=new fk.a;if(Qa.a.Wa(a))return b.Kg(this.YV.SQa([])),b.task;let c;const f=({A_b:c}=this.YV.t6e(a)).returnValue,
l=As.EBi(f);0<f.length?this.Wlc?this.Vml(f,b,c,l):this.PNb&&this.QNb&&this.EZe(l,b,"mention"):b.Kg(this.YV.SQa(a));return b.task}Vml(a,b,c,f){const l=Date.now();ka.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const w=this.y1h.nti(f,c);c=new Le.a(4,1,this.$a.Bc("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(F.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.$d.Db(c);c.customData=w;w.continueWith(H=>{if(H.rm)ka.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",H.$i?H.$i.message:"No inner exception"),b.qG(H.$i);else{H=w.result;this.YV.lEl(H);var U=this.YV.SQa(a);U.Canceled=H.DialogCanceled;b.Kg(U);ka.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}checkToMakeSureDialogWasOpened(a){ka.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.Vn?ka.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.rm?ka.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||ka.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):ka.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}EZe(a,b,c){a=new gv(a,b,c);a.Wbi(Object(F.a)(this,this.rzk,"onShareAndNotify"));a.EZe()}rzk(a,b){let c;const f=As.IBi(b.UFk);switch(b.result){case 1:this.grantUserAccess(f,b.scenario,!0,!0,!0).continueWith(l=>{l.rm?(ka.ULS.sendTraceTag(36300674,380,15,
"GrantUserAccess from OnShareAndNotify failed with exception. {0}",l.$i?l.$i.message:"No inner exception"),b.PLa.qG(l.$i)):(ka.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.YV.SQa(f),c.Canceled=!1,b.PLa.Kg(c))});break;default:ka.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.YV.SQa(f),c.Canceled=!0,b.PLa.Kg(c)}}checkUserAccess(a){const b=new fk.a;if(!this.PNb)return ka.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),
b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),b.task;if(!a||!a.length)return b.Kg(this.YV.SQa([])),b.task;let c;const f=({A_b:c}=this.YV.t6e(a)).returnValue;if(c)ka.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Kg(this.YV.SQa(a));else{const l=this.Jqa.checkUserAccess(f);l.continueWith(()=>{if(l.Vn||l.rm)ka.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));
else{ka.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var w=l.result;w&&this.YV.jEl(w);w=this.YV.SQa(a);b.Kg(w)}})}return b.task}grantUserAccess(a,b,c,f,l){const w=new fk.a;if(!this.QNb)return ka.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),w.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),w.task;if(!a||!a.length)return w.Kg(this.YV.MKf([])),w.task;let H;const U=({A_b:H}=
this.YV.t6e(a)).returnValue;if(H)ka.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),w.Kg(this.YV.MKf(a));else{const ja=this.Jqa.grantUserAccess(U,b,c,f,l);ja.continueWith(()=>{if(ja.Vn||ja.rm)ka.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),w.setException(Error.create("GrantUserAccess Call failed."));else{ka.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var wa=ja.result;this.YV.kEl(wa,c,f,l);wa=Object.assign(new It,{Result:wa});
w.Kg(wa)}})}return w.task}G1b(a,b){const c=[];for(const f of a)c.push(new Ft.a(f,b));return c}static EBi(a){const b=[];for(const c of a)a=new hv(c.UserId,c.Provider,""),b.push(a);return b}static IBi(a){const b=[];for(const c of a)a=new Ft.a(c.Id,c.Provider),b.push(a);return b}}Object(n.a)(As,"UserAccessUtils",null,[1394]);class Bs{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=
a.Title)}}Object(n.a)(Bs,"PersonaProperties",null,[]);class iv{constructor(a,b){this.mof=[];this.Lyd=[];this.hif=-1;this.$a=a;this.Jqa=b}get pAh(){return this.$a.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,f,l){ka.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const w=new Map;w.set("Limit",b.toString());w.set("SearchGal",f.toString());w.set("Scenario",l);dg.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser",
"wackpitesting",w);if(!this.pAh)return ka.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),dg.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new fk.a,a.qG(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return ka.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),dg.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser",
"LimitShouldBeGreaterThanZero",!1,!0,null),a=new fk.a,a.qG(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===l&&ka.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.hif&&!a&&!f)return a=new fk.a,c=this.Lyd.slice(0,Math.max(b-1,this.Lyd.length-1)),c=this.FZg(this.mof,c),a.Kg(c),a.task;const H=new fk.a;let U;try{U=this.Jqa.getUserContacts(a,b,c,f,l)}catch(ja){return H.qG(ja),H.task}if(f||"AtMentions"!==l)return U;U.continueWith(ja=>{if(ja.Vn||ja.rm){ja=ja.Vn?
"Canceled":ja.$i.message;ka.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",ja);var wa=new Map;w.set("ErrorMessage",ja);wa=Object.assign(new Nj.a,{extendedProperties:wa});dg.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,wa);H.qG(Error.create(ja))}else this.Lyd=ja=U.result,this.hif=b,ja=this.FZg(this.mof,ja),H.Kg(ja)});return H.task}FZg(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>
{this.tuf(f,c)});b.forEach(f=>{this.tuf(f,c)});a=[];for(let f in c)Array.add(a,c[f]);return a}tuf(a,b){if(a&&(a=new Bs(a),a.Email&&a.DisplayName&&a.Id&&a.Provider)){const c=b[this.wLf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.wLf(a)]=a}}wLf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(n.a)(iv,"UserContactsUtils",null,[1393]);class Qw{}Object(n.a)(Qw,"CheckUserAccessResponse",null,[]);class Rw{}Object(n.a)(Rw,"GrantUserAccessResponseItem",
null,[]);class jv{}Object(n.a)(jv,"UserPermissions",null,[]);class Ao{constructor(){this.aN=new Vc.a;this.G0e=0}t6e(a){let b;const c=[];if(!a)return ka.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,A_b:!1};if(!a.length)return ka.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,A_b:!1};b=!0;const f={};for(const l of a){a=
Ao.hYd(l);if(a in f)continue;f[a]=!0;const w=({value:a}=this.aN.Tf(Ao.hYd(l))).returnValue;w&&(!a||a.UserCanWrite||a.UserCanReview)||Array.add(c,l);b=b&&w}return{returnValue:c,A_b:b}}jEl(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.aN.remove(Ao.NLc(b));this.aN.add(Ao.NLc(b),b)}}kEl(a,b,c,f){if(!a)throw Error.argumentNull("result");
for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");if(void 0===l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){const w=Ao.iYd(l.Id,l.Provider);({value:a}=this.aN.Tf(w)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=f):(a=Object.assign(new jv,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.aN.remove(w),this.aN.add(w,a))}}}lEl(a){if(!a)throw Error.argumentNull("showSharingUiResponse");
a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");for(let b=0;b<a.length;b++){const c=new jv,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?ka.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.G0e,c.UserCanWrite=f.Status===this.G0e,c.UserCanReview=f.Status===this.G0e,c.Id=f.Id,c.Provider=f.Provider,this.aN.remove(Ao.NLc(c)),
this.aN.add(Ao.NLc(c),c))}}q9f(a){const b=[];for(const c of a)a=Ao.hYd(c),this.aN.Gb(a)&&Array.add(b,this.aN.ga(a));return b}SQa(a){a=this.q9f(a);return Object.assign(new Qw,{Result:a,Canceled:!1})}MKf(a){a=this.q9f(a);const b=[];for(const c of a)b.push(Object.assign(new Rw,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new It,{Result:b,Canceled:!1})}static NLc(a){return Ao.iYd(a.Id,a.Provider)}static hYd(a){return Ao.iYd(a.UserId,
a.Provider)}static iYd(a,b){return b+a}}Object(n.a)(Ao,"UserPermissionsCache",null,[1392]);class Sw{constructor(a,b,c,f){this.Jqa=a;this.$a=b;this.j4h=c;this.h4h=f}rub(a,b,c,f){var l=this.Jqa.rya;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new ue.QueryStringBuilder(l);l.Xg("oid","3");l.Xg("bdqs",c);(c=this.wBi(f))&&2<=c.length&&(f=c[1],l.Xg("w",c[0]),l.Xg("h",f));l.Xg("uid",a);l.Xg("p",b);l.Xg("usid",this.j4h);l.Xg("WacUserType",this.h4h);return l.toString()}wBi(a){switch(a){case 1:return["48",
"48"];case 2:return["64","64"];case 3:return["96","96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get a1c(){return this.$a.ka("IsUserProfilePictureResolutionEnabled")}}Object(n.a)(Sw,"UserProfilePictureUtils",null,[1390,1391]);var Tw=d(574);class Hr{get name(){return"Common.App.People"}Zb(a){a.register(xs,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().oa(()=>
new xs(u.AFrameworkApplication.Ke,()=>u.AFrameworkApplication.hh,u.AFrameworkApplication.fa,new Fr.a));a.register(Ao,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(ys,"Common.App.People.ShowSharingUiPostMessageHandler").ma().oa(()=>new ys(Uq.a.av(a.Ja("Postmessage.IHostPostmessenger"))));a.register(As,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().oa(()=>new As(a.resolve("Common.App.People.PeopleRequestHandler"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),Tw.a,fm.a.instance));a.register(iv,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().oa(()=>new iv(u.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(Sw,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().oa(()=>
new Sw(a.resolve("Common.App.People.PeopleRequestHandler"),u.AFrameworkApplication.fa,u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.userType));a.register(nq,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().oa(()=>new nq(a.rb("Common.IColorTable")));a.register(Gt,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().oa(()=>new Gt(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),db.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(cv,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().oa(()=>new cv(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),Uq.a.av(a.Ja("Common.ILokiTokenManager")),u.AFrameworkApplication.fa,a.Ja("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.ff(Object(F.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){const a=Ab.a.instance.resolve("Common.App.People.IPeopleManager");Ab.a.instance.resolve("Common.App.People.IExternalPeopleAPI");u.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new vy(a,u.AFrameworkApplication.Ta)).O5k()}dispose(){}static main(){v.a.instance.Dc(new Hr)}}Object(n.a)(Hr,"PeoplePackage",null,[2,3]);var oq={};oq.fQb=function(){function a(){return H()&&(cc()||3<=(eb()?Fc("version/"):
0))}function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f(Md){Md=(new RegExp(Md+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Pe=-1;null!=Md&&2<=Md.length&&(Pe=parseFloat(Md[1]),isNaN(Pe)&&(Pe=-1));return Pe}function l(){wm||(wm=!0,Fk=f("Windows Phone"));return 8<=Fk}function w(){return"function"==typeof navigator.msLaunchUri&&!c()&&!Ub()&&!U()}function H(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function U(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ja(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function wa(){return ja()?8==window.document.documentMode:!1}function Sa(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function eb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function ub(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Ub(){var Md=window.navigator.userAgent.toLowerCase();
return 0<=Md.indexOf("android")&&0<=Md.indexOf("chrome")}function cc(){return 3<=(Sa()?Fc("firefox/"):0)}function Fc(Md){var Pe=window.navigator.userAgent.toLowerCase(),zf=Pe.indexOf(Md);return 0<=zf?parseInt(Pe.substring(zf+Md.length,Pe.length)):0}function Ic(Md,Pe,zf,ge,Lg){if(ge&&null!=Pe)Pe();else if(w())navigator.msLaunchUri(Md,Pe,zf);else if(!(ub()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&H())||U())Ud(Md,Pe,
zf);else if(ub()&&Lg)a:{try{window.open(Md,"_self")}catch(ei){null!=zf&&zf();break a}null!=Pe&&Pe()}else Cc(Md,Pe,zf)}function Cc(Md,Pe,zf){var ge=document.getElementById("OICLinkTag");null==ge&&(ge=document.createElement("a"),ge.id="OICLinkTag",ge.style.visibility="hidden",ge.href="",0==(wh.Options&Di.SupportsTopTargetNavigation)||wh.NoBrowserModalDialogs?ge.target="_blank":ge.target="_top",document.body.appendChild(ge),null!=ge.addEventListener&&ge.addEventListener("click",function(Lg){null!=Lg.stopPropagation&&
Lg.stopPropagation()},!1));try{ge.href=Md,ge.click()}catch(Lg){null!=zf&&zf();return}null!=Pe&&Pe()}function Ud(Md,Pe,zf){var ge=document.getElementById("OICFrame");null==ge&&(ge=document.createElement("iframe"),ge.className="ObjectInDialog",ge.style.visibility="hidden",ge.src="about:blank",document.body.appendChild(ge),ge.id="OICFrame");try{ge.contentWindow.location.href=Md}catch(Lg){null!=zf&&zf();return}null!=Pe&&Pe()}function je(Md){return 0!=(Md.Options&Di.SkipProtocolHandler)||wa()}function Vd(Md){return Md===
Gk.ReadOnly||Md===Gk.ReadWrite}function Ve(Md,Pe,zf,ge){var Lg;try{var ei=new ActiveXObject("SharePoint.OpenDocuments.4");return(Lg=ei.ViewDocument3(window.self,Md,Pe,ge))?(vk(Ei.O14ActiveX),Mg.None):Mg.Failed}catch(ti){}if(Di.O14Only===(zf&Di.O14Only))return wh.DescriptiveUnattemptedEnums?Mg.O14AttemptFailure:Mg.Unattempted;try{return ei=new ActiveXObject("SharePoint.OpenDocuments.3"),(Lg=ei.ViewDocument3(window.self,Md,Pe,ge))?(vk(Ei.O12ActiveX),Mg.None):Mg.Failed}catch(ti){}if(Di.O12UpOnly===(zf&
Di.O12UpOnly))return wh.DescriptiveUnattemptedEnums?Mg.O12UpOnlyFail:Mg.Unattempted;try{return ei=new ActiveXObject("SharePoint.OpenDocuments.2"),(Lg=Vd(Pe)?ei.ViewDocument2(window.self,Md,ge):ei.EditDocument2(window.self,Md,ge))?(vk(Ei.O11ActiveX),Mg.None):Mg.Failed}catch(ti){}return wh.DescriptiveUnattemptedEnums?Mg.ActiveXUnattempted:Mg.Unattempted}function af(Md,Pe,zf,ge,Lg){Md==mg.Visio&&zf==Gk.ReadWrite&&(zf=Gk.WriteOnly);ge=ge||c()&&!l();if(!ge){ge="";if(Md==mg.PowerPoint){Md=ge;ge=wh.DocumentExtension;
zf=Vd(zf);var ei=new Set([".pot",".potm",".potx"]),ti=new Set([".pps",".ppsm",".ppsx"]);zf=zf&&ei.has(ge)?"nft|ofc|":zf&&ti.has(ge)?"ofv|ofs|t|":!zf&&ti.has(ge)?"ofe|ofs|t|":zf?"ofv|ofc|":"ofe|";zf=Md+zf}else zf=Vd(zf)?ge+"ofv|ofc|":ge+"ofe|";Lg+=lg(zf+"u|")}Lg+=lg(Pe);wh.NewTelemetryDataIsEnabled&&(Pe=wh.SessionOrigin?"|or|"+wh.SessionOrigin:"",Pe+=wh.ClickTime?"|ct|"+wh.ClickTime:"",Pe+=wh.CorrelationId?"|cid|"+wh.CorrelationId:"",Lg+=lg(Pe));Pe=window.location.href;zf=Pe.toLowerCase().indexOf("&wdlor=");
-1!=zf?(zf+=7,Md=Pe.indexOf("&",zf),Pe=-1==Md?Pe.substr(zf):Pe.substring(zf,Md)):Pe=void 0;if(null!=Pe&&"undefined"!=typeof Pe){zf="";try{zf=decodeURIComponent(Pe)}catch(Un){}0<zf.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(zf)&&(Lg=Lg+"|f|"+zf)}return Lg}function Zf(Md,Pe,zf,ge,Lg,ei){var ti=sg(Md);if(null==ti)return Ni(wh.DescriptiveUnattemptedEnums?Mg.ProtocolHandlerIsNull:Mg.Unattempted,wh.Application),!1;Md=af(Md,Pe,zf,ge,ti);Ic(Md,Tg,Ug,Lg,ei);return!0}function lg(Md){if(H()&&
ub()){var Pe="";try{Pe=decodeURI(Md)}catch(zf){}if(Pe==Md)return encodeURI(Md)}return Md}function Tg(){vk(Ei.ProtocolHandler)}function Ug(){wh.Options|=Di.SkipProtocolHandler;sh(wh,Wj,nk)}function ag(){null!=gl&&gl(Ei.RoamingProtocolHandler)}function ih(){null!=yj&&yj(Mg.ControlNeeded)}function Vg(){var Md=document.getElementById("npSharePointPlugin");if(null==Md){Md="application/x-sharepoint";H()&&3<=(eb()?Fc("version/"):0)&&di("application/x-sharepoint-webkit",!0)&&(Md="application/x-sharepoint-webkit");
if(!di(Md,!0))if(H()&&di("application/officelive",!0))Md="application/officelive";else return null;var Pe=document.createElement("object");Pe.id="npSharePointPlugin";Pe.type=Md;Pe.style.width="0px";Pe.style.height="0px";Pe.style.setProperty("visibility","hidden","");document.body.appendChild(Pe);Md=document.getElementById("npSharePointPlugin")}return Md}function di(Md,Pe){var zf=window.navigator.mimeTypes;if(null==zf)return!1;Md=zf[Md];return!Md||Pe&&!Md.enabledPlugin?!1:!0}function Si(Md){try{if(null!=
new ActiveXObject(Md))return!0}catch(Pe){}return!1}function rj(Md){switch(Md){case mg.OneNote:return"OneNote.Notebook";default:return""}}function sg(Md){if(Md!=mg.OneNote&&c()&&!l())return"office:";switch(Md){case mg.Excel:return"ms-excel:";case mg.OneNote:return"onenote:";case mg.PowerPoint:return"ms-powerpoint:";case mg.Visio:return"ms-visio:";case mg.Word:return"ms-word:";case mg.Project:return"ms-project:";case mg.Publisher:return"ms-publisher:";case mg.Infopath:return"ms-infopath:";case mg.Access:return"ms-access:";
default:return""}}function Cg(Md){switch(Md){case mg.Excel:return"root\\office15\\excel.exe";case mg.PowerPoint:return"root\\office15\\powerpnt.exe";case mg.Visio:return"root\\office15\\visio.exe";case mg.Word:return"root\\office15\\winword.exe";case mg.Project:return"root\\office15\\winproj.exe";case mg.Publisher:return"root\\office15\\mspub.exe";case mg.Infopath:return"root\\office15\\infopath.exe";case mg.Access:return"root\\office15\\msaccess.exe";default:return null}}function sh(Md,Pe,zf){wh=
Md;Wj=Pe;nk=zf;if(Md.DocumentUrl){var ge=zf=Pe=Md.DocumentUrl;try{ge=decodeURIComponent(Md.DocumentUrl)}catch(Bo){}try{zf=encodeURI(Md.DocumentUrl)}catch(Bo){}Pe=Pe+""+Md.CorrelationIdForWinClient;ge+=Md.CorrelationIdForWinClient;zf+=Md.CorrelationIdForWinClient;Md.Mode===Gk.ReadWrite&&Di.CheckoutRequired===(Md.Options&Di.CheckoutRequired)&&(Md.Mode=Gk.ForceCheckout);Di.HostIsEditOnly===(Md.Options&Di.HostIsEditOnly)&&(Md.Mode=Gk.WriteOnly);if(je(Md)?0:H()&&(Md.Application==mg.OneNote||di("application/x-sharepoint-protocolhandler",
!1)||di("application/x-sharepoint-webkit-protocolhandler",!1))||w()||Ub()||!(a()||cc()||"ActiveXObject"in window&&!c()||ub())||15<=wk())Zf(Md.Application,Md.EncodeUrl?zf:Pe,Md.Mode,Md.Application==mg.OneNote,Md.SilentExternalHandler,Md.NavigateUsingWindowOpen);else{var Lg;if(Lg=wa())a:{var ei=Md.EncodeUrl?Pe:ge,ti=Md.Mode,Un=rj(Md.Application);try{Lg=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,ei,ti,Un);break a}catch(Bo){}Lg=!1}if(Lg)vk(Ei.O15ActiveX);else{if(a()||
cc()){var xk=Md.EncodeUrl?Pe:ge;ge=Md.Mode;Lg=rj(Md.Application);ei=Vg();if(null==ei)xk=wh.DescriptiveUnattemptedEnums?Mg.PluginIsNull:Mg.Unattempted;else{ti=!1;try{ti=ei.ViewDocument3(window.self,xk,ge,Lg)}catch(Bo){}if(!ti)try{ti=Vd(ge)?ei.ViewDocument2(window.self,xk,Lg):ei.EditDocument2(window.self,xk,Lg)}catch(Bo){}ti?(vk(Ei.NpapiPlugin),xk=Mg.None):xk=Mg.Failed}}else{try{xk=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=xk&&xk.SaveSSOCreds()}catch(Bo){}xk=Ve(Md.EncodeUrl?Pe:ge,Md.Mode,Md.Options,
rj(Md.Application))}if(xk!=Mg.None){if(ge=Md.CouldUseRoamingApps)hl||(hl=!0,Yl=f("Windows NT")),ge=6.1<=Yl&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ja()||cc()||ub());if(ge&&Md.Application!=mg.OneNote){if(!oq.fQb.lNl()){Ni(Mg.ControlNeeded,wh.Application);return}if(Md.RoamingAppsLauncher){"undefined"==typeof Md.RoamingAppsLauncher||null==Md.RoamingAppsLauncher?Ni(wh.DescriptiveUnattemptedEnums?Mg.RoamingLauncherIsNull:Mg.Unattempted,wh.Application):"undefined"==typeof Md.RoamingBitsUrl||
null==Md.RoamingBitsUrl?oq.fQb.ANl(Md.DocumentUrl,Md.RoamingAppsLauncher,Md.Application,Md.ApplicationParameters,Wj,nk):oq.fQb.CMh(Md.DocumentUrl,Md.RoamingAppsLauncher,Md.RoamingApplicationExe,Md.ApplicationParameters,Md.RoamingPlatform,Md.RoamingBitsUrl,Wj,nk);return}if(!Md.ContinueIfLauncherIsNull){Ni(Mg.LauncherNeeded,wh.Application);return}}Di.NoProtocolHandlerFallback==(Md.Options&Di.NoProtocolHandlerFallback)||je(Md)||ja()||H()&&!(wh.DescriptiveUnattemptedEnums?xk>=Mg.O14Unattempted&&xk<=Mg.DocumentUrlIsNull:
xk==Mg.Unattempted)?Ni(xk,wh.Application):Zf(Md.Application,Md.EncodeUrl?zf:Pe,Md.Mode,Md.Application==mg.OneNote,Md.SilentExternalHandler,Md.NavigateUsingWindowOpen)}}}}else Ni(wh.DescriptiveUnattemptedEnums?Mg.DocumentUrlIsNull:Mg.Unattempted,wh.Application)}function vk(Md){null!=Wj&&Wj(Md)}function Ni(Md,Pe){"undefined"==typeof Pe&&(Pe=null);null!=nk&&nk(Md,Pe)}function wk(){var Md=0;if(a()||cc()||ub()){var Pe=Vg();try{null!=Pe&&(Md=Pe.GetOfficeVersion())}catch(zf){}}else Si("SharePoint.OpenDocuments.5")?
Md=15:Si("SharePoint.OpenDocuments.4")?Md=14:Si("SharePoint.OpenDocuments.3")?Md=12:Si("SharePoint.OpenDocuments.2")&&(Md=11);return Md}function Jl(){return H()&&(di("application/x-sharepoint",!0)||di("application/x-sharepoint-webkit",!0))}var hk="",Kl="",Vj="",Wj,nk,gl,yj,wh,hl,Yl,wm,Fk,Gk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Di={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
Mg={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Ei={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},mg={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Gk,OpenDocumentOptions:Di,OpenDocumentFailureType:Mg,OpenDocumentControl:Ei,OfficeApplication:mg,EditDocumentInClient:sh,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=mg.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:wk,IsO14MacPluginInstalled:Jl,OfferOfficeInDialog:function(){return b()&&11>=wk()},OfferOfficeNoIntrusive:function(){return b()&&15>wk()},OfferMacOffice:function(){return H()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!Jl()},InstallRoamingControl:function(){Sa()?window.InstallTrigger.install({Office:{URL:Kl}}):Ud(Vj,null,null)},CanUseRoamingControl:function(){if(w())return!0;if(ub())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Sa()){var Md=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Md);var Pe=document.createEvent("Events");Pe.initEvent("RoamingOfficeInstalled",!0,!1);Md.dispatchEvent(Pe);
return!!Md.getAttribute("installed")}if(ja())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(zf){}return!1},InitUrls:function(Md,Pe,zf){hk=Md;Kl=zf;Vj=Pe},LaunchRoamingApps:function(Md,Pe,zf,ge,Lg,ei){oq.fQb.CMh(Md,Pe,Cg(zf),ge,"x86",hk,Lg,ei)},LaunchRoamingApps2:function(Md,Pe,zf,ge,Lg,ei,ti,Un){var xk="";null!=ge&&(xk+=" "+ge);null!=Md&&(xk+=' "'+Md+'"');if(w()||ub())gl=ti,yj=Un,ti='office: "'+(ei+'" "')+(zf+'" "ROAMING"'),ti+=' "'+Pe+'"',ti+=' "'+Lg+'"',ti+=
" "+xk,Ic(ti,ag,ih,!1,!1);else if(Sa())Md=document.createElement("RoamingExtensionElement"),Md.setAttribute("cabUrl",ei),Md.setAttribute("app",zf),Md.setAttribute("licensingEntitlements",Pe),Md.setAttribute("platform",Lg),Md.setAttribute("args",xk),document.documentElement.appendChild(Md),Pe=document.createEvent("Events"),Pe.initEvent("RoamingOfficeLaunch",!0,!1),Md.dispatchEvent(Pe),null!=ti&&ti(Ei.RoamingFFExtension);else if(ja()){if(Md=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Md)try{Md.HrConfigureSingle(ei,zf,Pe,Lg,xk),null!=ti&&ti(Ei.RoamingActiveX)}catch(Bo){}}else null!=Un&&Un(Mg.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:Cc,OpenDocumentWithProtocolHandler:Zf,OpenDocumentWithProtocolHandlerNoCallBack:function(Md,Pe,zf,ge){var Lg=sg(Md);if(null==Lg)return Ni(wh.DescriptiveUnattemptedEnums?Mg.ProtocolHandlerNoCallbackIsNull:Mg.Unattempted,wh.Application),!1;Md=af(Md,Pe,zf,ge,Lg);Ic(Md,null,null,!1,!1);return!0}}}();oq.ClientUtils=
oq.fQb;class Jt{constructor(a,b,c){this.Ca=a;this.oVh=b;this.CG=c}wb(){this.Ca.ya(G.a.tryMacOffice,Xd.a.frame,Object(F.a)(this,this.qAk,"onTryMacOffice"));this.Ca.ya(G.a.bFh,Xd.a.frame,Object(F.a)(this,this.b8g,"onTryMacOfficeFromViewer"));this.Ca.ya(G.a.aFh,Xd.a.frame,Object(F.a)(this,this.b8g,"onTryMacOfficeFromViewer"))}qAk(a,b,c,f,l){if(1===c)return 32;l?(a=l.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?Kd.a.vn(ig.a.fEa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===
a&&Kd.a.vn(ig.a.fEa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Vpg();return 32}b8g(a,b,c){if(1===c)return 32;switch(a){case G.a.bFh:Kd.a.vn(ig.a.fEa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case G.a.aFh:Kd.a.vn(ig.a.fEa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Vpg(){Kd.a.vn(Jt.Fkk,"_blank",void 0,"LaunchMacTrialWindow")}get vrc(){return this.oVh&&B.a.wk&&!B.a.Ile&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get cvh(){const a=
this.vrc;a||u.AFrameworkApplication.kj.nal();return a}get Mjl(){return this.vrc}static get Fkk(){return ig.a.OW("522401")}}Object(n.a)(Jt,"MacOfficeOffer",null,[1384]);class Kt{constructor(a,b,c){this.Ca=a;this.rVh=b;this.Wxd=null;(this.EFc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.Wxd=f});this.CG=c}wb(){this.Ca.ya(G.a.tryOffice,
Xd.a.frame,Object(F.a)(this,this.rAk,"onTryOffice"));this.Ca.ya(G.a.d4e,Xd.a.frame,Object(F.a)(this,this.d4e,"tryOfficeThroughTellMe"));this.Ca.ya(G.a.jFh,Xd.a.frame,Object(F.a)(this,this.kFh,"tryOfficeThroughViewer"));this.Ca.ya(G.a.iFh,Xd.a.frame,Object(F.a)(this,this.kFh,"tryOfficeThroughViewer"))}rAk(a,b,c,f,l){if(this.EFc&&1===c)return this.isFreemiumUpsellEnabled&&this.wrc?32:8;2===c&&(l?(a=l.SourceControlId,"btnjTryOfficeForWordEditor"===a?Kd.a.vn(ig.a.fEa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===a?Kd.a.vn(ig.a.fEa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.eoe()):this.eoe());return 32}d4e(a,b,c,f,l){if(this.EFc&&1===c)return this.isFreemiumUpsellEnabled&&this.wrc?32:8;2===c&&(l?(a=l.SourceControlId,Kd.a.vn(ig.a.OW("862405")+this.ggj(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Kd.a.vn(ig.a.OW("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}kFh(a,b,c){if(this.EFc&&1===c)return this.isFreemiumUpsellEnabled&&
this.wrc?32:8;if(2===c)switch(a){case G.a.jFh:Kd.a.vn(ig.a.fEa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case G.a.iFh:Kd.a.vn(ig.a.fEa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get L1g(){return this.wrc}get lrk(){return this.wrc&&MSOJS.ClientUtils.OfferOfficeInDialog()}get wrc(){return this.rVh&&!B.a.wk}get isFreemiumUpsellEnabled(){let a=!1;this.Wxd&&(a=this.Wxd.isFreemiumUpsellEnabled());return a}eoe(a=null){let b=0;a&&(b=a);Kd.a.vn(Kt.Ycj(b),"_blank",void 0,"LaunchOfficeOffer")}ggj(a){let b=
0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static Ycj(a){if(B.a.Pi)switch(a){case 1:return ig.a.OW("393806");case 2:return ig.a.OW("393810");case 3:return ig.a.OW("393809");case 5:return ig.a.OW("393805")}else if(B.a.TI)switch(a){case 1:return ig.a.OW("521979");case 3:return ig.a.OW("521980");case 5:return ig.a.OW("521978");case 2:return ig.a.OW("522490")}else{if(2===a)return ig.a.OW("517778");
if(1===a)return ig.a.fEa(30)}return ig.a.OW("522402")}}Object(n.a)(Kt,"OfficeTrialExperience",null,[1382]);class Cs{Zb(a){a.register(Kt,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().oa(()=>new Kt(u.AFrameworkApplication.Ta,u.AFrameworkApplication.ple,u.AFrameworkApplication.lcid));a.register(Jt,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().oa(()=>new Jt(u.AFrameworkApplication.Ta,u.AFrameworkApplication.Pkg,u.AFrameworkApplication.lcid))}}
Object(n.a)(Cs,"OpenInClientConfiguration",null,[3]);var vp=d(174),gf=d(49);class kv{constructor(a,b,c){this.OX=this.gu=this.K=null;this.kf=a;this.YF=b;this.WBe=c}RKf(a,b,c){if(!this.kf)return null;if(!this.K){this.K=gf.a.Ie();this.K.id=this.YF;this.K.className="HTMLSpinnerIndicator";const f=gf.a.Ie();f.className="HtmlspinnerOverlay";this.gu=gf.a.Ie();this.gu.className="HtmlspinnerInner";const l=gf.a.Sn();l.className="BootSpinner";this.gu.appendChild(l);this.WBe&&(this.OX=gf.a.Sn(),this.OX.id="htmlspinner_label",
this.gu.appendChild(this.OX));this.K.appendChild(f);this.K.appendChild(this.gu);this.kf.appendChild(this.K)}this.WBe&&(this.OX.innerText=a||ResourceStrings.l_Loading);this.GQd(b,c);return this.K}rPb(a){this.OX&&(this.OX.innerText=a)}GQd(a,b){this.K.style.left=gf.a.Pc(a);this.K.style.top=gf.a.Pc(b);this.gu.style.bottom=this.WBe?gf.a.Pc(this.kf.clientHeight/2+16):gf.a.Pc(this.kf.clientHeight/2+24)}}Object(n.a)(kv,"HtmlSpinnerIndicator",null,[]);class Lt extends kv{constructor(a,b,c){super(a,b,!1);this.YBe=
c}RKf(a,b,c){if(!this.kf)return null;if(!this.K){this.K=gf.a.Ie();this.K.id=this.YF;this.K.className="HTMLProgressIndicator";const f=gf.a.Ie();f.className="HtmlprogressOverlay";this.gu=gf.a.Ie();this.gu.className="HtmlprogressInner";if(this.YBe){const l=gf.a.SA();l.src=vp.a.ZK(Pf.a.Zna);l.width=Pf.a.cJb;l.height=Pf.a.vjd;this.gu.appendChild(l)}this.OX=gf.a.Sn();this.gu.appendChild(this.OX);this.K.appendChild(f);this.K.appendChild(this.gu);this.kf.appendChild(this.K)}this.OX.innerText=a||ResourceStrings.l_Loading;
this.GQd(b,c);return this.K}GQd(a,b){this.K.style.left=gf.a.Pc(a);this.K.style.top=gf.a.Pc(b);this.K.style.display=nf.a.Wk;this.gu.style.position=nf.a.dpa;a=this.gu.clientWidth;this.gu.style.top=gf.a.Pc(this.kf.clientHeight/2-this.gu.clientHeight/2);u.AFrameworkApplication.isRtl?(this.gu.style.right=gf.a.Pc(this.kf.clientWidth/2-a/2),this.gu.style.direction=nf.a.S0a):(this.gu.style.left=gf.a.Pc(this.kf.clientWidth/2-a/2),this.gu.style.direction=nf.a.aAh);this.K.style.display=nf.a.Ff}}Object(n.a)(Lt,
"HtmlProgressIndicator",kv,[]);class wy{constructor(a,b){this.zJ=this.MO=this.K=null;this.Eb=!0;this.RAg=a;this.hJ=b}cNb(a,b,c,f,l){u.AFrameworkApplication.zAb()||(this.K=this.RAg.RKf(a,c,f),b?(this.MO&&(window.clearTimeout(this.MO),this.MO=null),this.zJ&&(window.clearTimeout(this.zJ),this.zJ=null),this.kZe(l)):this.MO||this.zJ||(this.MO=window.setTimeout(()=>{this.KZe(l)},200)))}IWc(){this.MO&&(window.clearTimeout(this.MO),this.MO=null);this.zJ&&(window.clearTimeout(this.zJ),this.zJ=null);this.K&&
(this.K.style.display=nf.a.Ff,this.K.style.opacity="0")}rPb(a){this.RAg.rPb(a)}kZe(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=nf.a.Hz,this.Eb&&(this.K.style.display=nf.a.Wk),va.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.ouc(a)))}KZe(a){this.MO=null;this.K&&(this.K.style.visibility=nf.a.Hz,this.Eb&&(this.K.style.display=nf.a.Wk),this.K.style.opacity="0.0",this.zJ||(this.zJ=window.setTimeout(()=>{this.JZe(a)},1800)))}JZe(a){this.zJ=null;
this.K&&(this.K.style.opacity="1.0",this.Eb&&(this.K.style.display=nf.a.Wk),va.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.ouc(a)))}ouc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.hJ.Z5(a):null:null}get visible(){return this.Eb}set visible(a){this.Eb=a;this.K&&(this.K.style.display=a?nf.a.Wk:nf.a.Ff)}}Object(n.a)(wy,"HtmlProgressIndicatorView",null,[1329]);class xy{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=
null}}Object(n.a)(xy,"UploadConvertedFileToHostParams",null,[]);var yy=d(1014),wp=d(75);const pq=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},lv=a=>a.qc.keyCode===A.a.tq||a.qc.keyCode===A.a.pP?(a.Ec.click(),!0):!1,Ds=(a,b,c,f,l,w,H)=>{const U=document.createElement("a");U.className="ProtocolLaunchingDialogButtonAnchor";U.className+=" OICDialog";U.id=a;U.setAttribute(Bc.a.af,Bc.a.Au);U.style.padding=
"0";U.style.margin="0";f&&Uw(l,b,c,f,U);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;U.appendChild(a);U.tabIndex=0;w&&Ed.a.instance.pb(sa.a.click,U,w);H&&x.KeyInputManager.instance.pb(sa.a.Il,U,H);return U},Uw=(a,b,c,f,l)=>{var w=document.createElement("img");w.alt=a;w.className=wp.getImageClassWithCluster(c,f);w.src=b;w.setAttribute(Bc.a.af,Bc.a.pN);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(w);
w=document.createElement("span");w.className="ProtocolLaunchingDialogIconContainer";w.appendChild(a);l.appendChild(w)};class qq{static get eg(){return ci.a.VA(qq.En,CommonUIStrings.l_OICLaunchDialogTitle)}}qq.En="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(qq,"OICLaunchDialogHtml",null,[]);class Oh extends ci.a{constructor(a){super();this.jnb=this.t2a=null;this.rNa=!1;this.Xw=a;this.eg=qq.eg;this.yd=5;this.ig="OICLaunchDialog";this.showDialog("",Object(F.a)(this,this.rrk,"oicLaunchDialogResultHandler"));this.srh();this.f6("ProtocolLaunchingDialogTitle");4!==u.AFrameworkApplication.Aa.hb.Isa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.KR(this.t2a);ka.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}axa(){this.t2a=Ds("BtnRichClient",this.Xw.Wub,this.Xw.fab,this.Xw.Yde,CommonUIStrings.l_OICLaunchRichClient,Object(F.a)(this,this.B6g,"onRichClientButtonClick"),lv);document.getElementById("OICLaunchRichClient").appendChild(this.t2a);pq(this.t2a);this.jnb=Ds("BtnReturn",this.Xw.Wub,this.Xw.fab,this.Xw.neg,CommonUIStrings.l_OICReturnToOnlineClient,Object(F.a)(this,this.z6g,"onReturnButtonClick"),
lv);document.getElementById("OICReturnToApp").appendChild(this.jnb);pq(this.jnb)}z6g(){this.hide();this.Xw.A_a();return!0}B6g(){ka.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();u.AFrameworkApplication.Ta.processAction(G.a.mjb,2);return!0}rrk(){this.Xw.A_a()}dispose(){this.rNa||(this.t2a&&(Ed.a.instance.yb(sa.a.click,this.t2a,Object(F.a)(this,this.B6g,"onRichClientButtonClick")),x.KeyInputManager.instance.yb(sa.a.Il,this.t2a,lv)),this.jnb&&(Ed.a.instance.yb(sa.a.click,
this.jnb,Object(F.a)(this,this.z6g,"onReturnButtonClick")),x.KeyInputManager.instance.yb(sa.a.Il,this.jnb,lv)),super.dispose(),this.rNa=!0)}}Object(n.a)(Oh,"OICLaunchDialog",ci.a,[]);class k{static get eg(){return ci.a.VA(k.En,CommonUIStrings.l_OICDialogTitle)}}k.En="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(k,"ProtocolLaunchingDialogV2Html",null,[]);var C=d(198);class W extends ci.a{constructor(a){super();this.inb=this.Xza=null;this.rNa=!1;this.XMa=null;this.Xw=a;this.eg=k.eg;this.yd=5;this.ig="ProtocolLaunchingDialog";this.Vxc="OICRetryDialog";u.AFrameworkApplication.ye.Pta&&u.AFrameworkApplication.ye.z_a();u.AFrameworkApplication.ye.Db(new Le.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(F.a)(this,this.cnc,"protocolLaunchingDialogResultHandler"));this.srh();
this.f6("Issues");this.gYf();ka.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}axa(){const a=document.getElementById("Issues");if(a){Uw("",this.Xw.Wub,this.Xw.fab,this.Xw.Yde,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.Xw.v8g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);pq(a);a.style.display="none"}u.AFrameworkApplication.Aa.hb.V9f?
(this.inb=Ds("GiveFeedback",this.Xw.Wub,this.Xw.fab,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(F.a)(this,this.Afd,"onGiveFeedbackClick"),Object(F.a)(this,this.E4g,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.inb),pq(this.inb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===u.AFrameworkApplication.Aa.hb.Isa||u.AFrameworkApplication.VNi?document.getElementById("ButtonEdit").style.display="none":(this.Xza=
Ds("Edit",this.Xw.Wub,this.Xw.fab,"",2===u.AFrameworkApplication.Aa.hb.Uk?4===u.AFrameworkApplication.Aa.hb.Isa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===u.AFrameworkApplication.Aa.hb.Isa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(F.a)(this,this.S3g,"onEditClick"),Object(F.a)(this,this.W3g,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Xza),pq(this.Xza));0===u.AFrameworkApplication.Aa.hb.Isa&&
!u.AFrameworkApplication.ple&&a&&(a.style.display="none")}hYf(){return this.XMa?(this.KR(this.XMa),!0):!1}gYf(){return this.Xza?(this.KR(this.Xza),!0):!1}W3g(a){return this.tHe(a,0)}E4g(a){return this.tHe(a,2)}y6g(a){return this.tHe(a,1)}tHe(a,b){let c=!1;if(a.qc.keyCode===A.a.tq||a.qc.keyCode===A.a.pP)a.Ec.click(),c=!0;else if(a.qc.keyCode===Sys.UI.Key.down||a.qc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.gYf();break;case 0:c=this.hYf()}return c}S3g(){this.hide();4===u.AFrameworkApplication.Aa.hb.Isa?
(ka.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Xw.A_a()):(ka.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Xw.B7b());return!0}Afd(){ka.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}Bgd(){ka.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";u.AFrameworkApplication.Ta.processAction(G.a.mjb,2);return!0}cnc(){this.Xw.A_a()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.XMa=Ds("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(F.a)(this,this.Bgd,"onRetryOICClick"),Object(F.a)(this,this.y6g,"onRetryOICKeyUp")),a.appendChild(this.XMa),pq(this.XMa),this.Xza||this.hYf())}}dispose(){this.rNa||(this.Xza&&(Ed.a.instance.yb(sa.a.click,this.Xza,Object(F.a)(this,
this.S3g,"onEditClick")),x.KeyInputManager.instance.yb(sa.a.Il,this.Xza,Object(F.a)(this,this.W3g,"onEditKeyUp"))),this.inb&&(Ed.a.instance.yb(sa.a.click,this.inb,Object(F.a)(this,this.Afd,"onGiveFeedbackClick")),x.KeyInputManager.instance.yb(sa.a.Il,this.inb,Object(F.a)(this,this.E4g,"onGiveFeedbackKeyUp"))),this.XMa&&(Ed.a.instance.yb(sa.a.click,this.XMa,Object(F.a)(this,this.Bgd,"onRetryOICClick")),x.KeyInputManager.instance.yb(sa.a.Il,this.XMa,Object(F.a)(this,this.y6g,"onRetryOICKeyUp"))),super.dispose(),
this.rNa=!0)}}Object(n.a)(W,"ProtocolLaunchingDialog",ci.a,[]);class oa extends Bi.StandardDialog{constructor(a){super();this.Xw=a;this.ig="ProtocolLaunchingDialog";u.AFrameworkApplication.ye.Pta&&u.AFrameworkApplication.ye.z_a();u.AFrameworkApplication.Aa.hb.V9f&&this.cPd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(F.a)(this,this.Afd,"onGiveFeedbackClick"));oa.Kbg?(this.yd=12,this.Xe(1,CommonUIStrings.l_CloseFile),this.Xe(2,CommonUIStrings.l_OICDialogContinueHere),this.Xe(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.yd=4,this.Xe(1,CommonUIStrings.l_OICDialogContinueHere),this.Xe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.pGb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Xw.v8g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(F.a)(this,this.cnc,"protocolLaunchingDialogResultHandler"),null)}Afd(a){ka.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.h4g(a)}Bgd(){ka.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");u.AFrameworkApplication.Ta.processAction(G.a.mjb,
2)}cnc(a){oa.Kbg?3===a?this.Amh():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.Amh():(1===a||0===a)&&this.continueEditing()}closeDocument(){ka.ULS.sendTraceTag(577783557,211,50,"Closing the document");u.AFrameworkApplication.Ta.La(G.a.close,2,Dj.a)}Amh(){ka.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(F.a)(this,this.Bgd,"onRetryOICClick"),0)}continueEditing(){4===u.AFrameworkApplication.Aa.hb.Isa||u.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===u.AFrameworkApplication.Aa.mode?(ka.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Xw.A_a()):(ka.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Xw.B7b())}static get Kbg(){return u.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===u.AFrameworkApplication.Ta.processAction(G.a.close,1)}}Object(n.a)(oa,"StandardProtocolLaunchingDialog",Bi.StandardDialog,[]);var Ea=d(671);class ab{}Object(n.a)(ab,"EditDocumentInClientParams",null,[]);
class tb{static lRf(a,b,c,f,l,w,H=!1,U=!1,ja="",wa=!1,Sa=!1,eb=!1,ub="",Ub="",cc="",Fc=!1,Ic=""){const Cc=new ab;Cc.DocumentUrl=a;Cc.DocumentExtension=Ic;Cc.Mode=b;Cc.Options=c;Cc.Application=f;Cc.SilentExternalHandler=H;Cc.EncodeUrl=U;Cc.CorrelationIdForWinClient=ja;Cc.NavigateUsingWindowOpen=wa;Cc.DescriptiveUnattemptedEnums=Sa;Cc.NoBrowserModalDialogs=eb;Cc.SessionOrigin=ub;Cc.CorrelationId=Ub;Cc.ClickTime=cc;Cc.NewTelemetryDataIsEnabled=Fc;MSOJS.ClientUtils.EditDocumentInClient(Cc,l,w)}}Object(n.a)(tb,
"ClientUtils",null,[]);var Yb=d(568),Dc=d(530),$c=d(126);class ud{constructor(a){this.UAa=this.YRb=this.dRb=null;this.MSb=!1;this.FAd=this.tGd=this.zkf=null;this.$wc=this.Upa=this.dEc="";this.application=this.Sy=0;this.Ltl=this.R0e=!1;this.BIl=a&&u.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");u.AFrameworkApplication.Ta.hT(G.a.mjb)||u.AFrameworkApplication.Ta.ya(G.a.mjb,Xd.a.frame,Object(F.a)(this,this.R4k,"retryOpenInClientAction"));this.xxh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("SilentExternalHandler")}get v8g(){return this.Sy}Mfl(a,
b="",c=""){this.Upa=c||gh.a.create().toString();this.dEc=b||Yb.a.Z4f();this.$wc=a}R4k(a,b,c){return b.contextId!==Xd.a.frame?2:1===c?32:this.mjb()}get options(){let a=0;u.AFrameworkApplication.requiresCheckout&&(a|=1);u.AFrameworkApplication.B8g&&(a|=4);this.Jtl()&&(a|=64);return a}Jtl(){return!(2===this.application&&u.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get Wub(){return u.AFrameworkApplication.qm}get fab(){return u.AFrameworkApplication.UN}get neg(){return""}get Yde(){return""}get Ktl(){return u.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get Fwl(){return this.zkf||
(this.zkf=Ab.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.R0e||this.LUi()}A_a(){this.Ltl||this.sUf()}xSk(a){return this.BIl&&B.a.Pi?(new Oh(this),32):this.Ptb(a)}Ptb(a){const b=({m1a:a}=this.t_j(a)).returnValue;ka.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,f,l,w,H=""){this.dRb=a;this.FAd=H;this.YRb=b;this.UAa=w;this.application=c;this.Sy=f;return u.AFrameworkApplication.LQf?(this.Rpg(),32):u.AFrameworkApplication.PQ&&!u.AFrameworkApplication.kdg?
(u.AFrameworkApplication.bxh(),8):this.Zzf(l)}get qrk(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}mjb(){this.qrk&&this.S2j();return this.Ptb(this.MSb)}Pph(){const a=new Dc.a(Ce.a.openInClient);a.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();a.Values[Ea.a.GMf]=u.AFrameworkApplication.userSessionId;return this.UAa.value.send(a)?32:8}S2j(){dg.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Nj.a,{inStaging:!0}))}V9k(a){const b=new Dc.a(Ce.a.ZKl);b.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();b.Values[Ea.a.GMf]=u.AFrameworkApplication.userSessionId;b.Values[Mi.a.YKl]=a;this.UAa.value.send(b)}t_j(a){this.MSb=a;this.V9k(5===this.Sy?ud.jBk:ud.pBk);return 5===this.Sy?this.s_j():this.u_j()}s_j(){this.Wpg();return{returnValue:32,m1a:"HostEditUrl,"}}u_j(){let a;var b=a="";u.AFrameworkApplication.guf&&(b="|f|"+u.AFrameworkApplication.userSessionId);
const c=u.AFrameworkApplication.fa.ka("IsAssignmentMode")&&u.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||u.AFrameworkApplication.Lac||B.a.OFa,f=u.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),l=u.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(u.AFrameworkApplication.Ta.ged){var w=u.AFrameworkApplication.Ta.Y6b(3588168074);w&&this.Mfl(w.epochClickTime,w.sessionOrigin,w.correlationId);this.Grg()}if(u.AFrameworkApplication.ech){a+="NewOrder,";
w=8;this.UAa&&this.UAa.value&&this.UAa.value.isEnabled()&&u.AFrameworkApplication.$uc&&(a+="Post,",w=this.Pph());if(32===w)return{returnValue:w,m1a:a};ka.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return u.AFrameworkApplication.St.mxa?(ka.ULS.shipAssertTag(5566816,211,!!u.AFrameworkApplication.St.mxa),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.rM(!0,u.AFrameworkApplication.St.mxa),m1a:a}):this.dRb?(ka.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId),a+="DocUrl,",tb.lRf(this.dRb,this.Sy,this.options,this.application,Object(F.a)(this,this.V3g,"onEditInClientSuccess"),Object(F.a)(this,this.U3g,"onEditInClientFailure"),this.xxh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.dEc,this.Upa,this.$wc,u.AFrameworkApplication.Ta.ged,this.FAd),{returnValue:32,m1a:a}):{returnValue:8,m1a:a}}a+="OldOrder,";if(!this.dRb&&u.AFrameworkApplication.St.mxa)return this.UAa&&
this.UAa.value&&this.UAa.value.isEnabled()&&u.AFrameworkApplication.$uc?(a+="Post,",b=this.Pph()):(ka.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(ka.ULS.shipAssertTag(22595484,211,!!u.AFrameworkApplication.St.mxa),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.rM(!0,u.AFrameworkApplication.St.mxa),m1a:a}):{returnValue:b,m1a:a};ka.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId);
a+="DocUrl,";tb.lRf(this.dRb,this.Sy,this.options,this.application,Object(F.a)(this,this.V3g,"onEditInClientSuccess"),Object(F.a)(this,this.U3g,"onEditInClientFailure"),this.xxh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.dEc,this.Upa,this.$wc,u.AFrameworkApplication.Ta.ged,this.FAd);return{returnValue:32,m1a:a}}a2k(a){u.AFrameworkApplication.kj.setDw(8981,a)}V3g(a){this.a2k(a);ka.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.Ktl||this.Wpg(),this.Grg()):this.R0e||this.closeApplication()}U3g(a,b=0){ka.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.YRb&&!this.MSb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.R0e=!0));this.Fwl.lrk?(ka.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),yy.a.instance.rGi(this.MSb?Object(F.a)(this,
this.U1g,"oicErrorDialogHandlerCloseForced"):Object(F.a)(this,this.V1g,"oicErrorDialogHandlerNoCloseForced"),c?Object(F.a)(this,this.d5g,"onLaunchDownload"):null,this.rPf(!1)?Object(F.a)(this,this.JBj,"iHaveOfficeButtonHandler"):null,f,b)):(ka.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),yy.a.instance.pGi(this.MSb?Object(F.a)(this,this.U1g,"oicErrorDialogHandlerCloseForced"):Object(F.a)(this,this.V1g,"oicErrorDialogHandlerNoCloseForced"),c?Object(F.a)(this,this.d5g,
"onLaunchDownload"):null,f))}}Grg(){try{const a=[Object.assign(new $c.a,{name:"CorrelationId",string:this.Upa}),Object.assign(new $c.a,{name:"SessionOrigin",string:this.dEc}),Object.assign(new $c.a,{name:"ClickTime",string:this.$wc}),Object.assign(new $c.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];wo.a("OpenInClientCompleted",!0,0,a)}catch(a){ka.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}Wpg(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.IC&&
u.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?new oa(this):new W(this)}U1g(){this.closeApplication()}V1g(){this.A_a()}d5g(){this.Rpg()}JBj(){return this.rPf(!0)}rPf(a){const b=(B.a.IUa||B.a.vo)&&!!u.AFrameworkApplication.JNc;b&&a&&(Kd.a.vn(u.AFrameworkApplication.JNc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}ud.pBk="OpenInDesktop";ud.jBk="OpenInBrowser";Object(n.a)(ud,"AOpenInClientOperation",null,[]);class pe extends ud{constructor(a,b,c=!1){super(c);this.aUh=
a;this.$Th=b}get neg(){return this.$Th}get Yde(){return this.aUh}LUi(){u.AFrameworkApplication.Ta.La(G.a.close,2,Dj.a)}sUf(){}Zzf(a){return this.xSk(a)}Rpg(){ka.ULS.shipAssertTag(5566817,211,!!this.YRb);u.AFrameworkApplication.Kda?u.AFrameworkApplication.Aa.rM(!0,this.YRb):Kd.a.vn(this.YRb,void 0,void 0,"LaunchDownload")}B7b(){u.AFrameworkApplication.Aa.hb.B7b()}}Object(n.a)(pe,"OpenInClientOperation",ud,[]);class Te extends pe{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");
if(!a)throw Error.argumentNull("pathManager");this.qIg=b;this.qe=a;this.Yn=c;this.ia=f}get Wub(){return this.qe.rk(this.fab+".png")}get fab(){return"prt2"}Zzf(a){return this.qIg?this.qIg(a):this.Ptb(a)}sUf(){va.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.La(L.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}Ptb(a){this.Yn.B$b=!0;return super.Ptb(a)}}Object(n.a)(Te,"OpenInPowerPointOperation",pe,[]);class Qf{constructor(a,
b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve){this.OAg=null;this.uE=w;this.ia=a;this.Fa=b;this.pa=c;this.qe=f;this.pIg=new Te(this.qe,Object(F.a)(this,this.Tii,"beginSaveBeforeOpenInClient"),eb,a);H.execute(af=>{this.OAg=new kc.a(()=>af)});this.$wg=l;this.Pu=U;this.zkk=ja;this.ua=wa;this.fc=Sa;this.Ha=ub;this.Xa=Ub;this.Xea=cc;this.Rb=Fc;this.Sd=Ic;this.Mm=Cc;this.Mv=Ud;this.Teb=je;this.t$=Vd;this.lR=Ve}wb(){this.ia.ya(L.a.openInClient,nc.a.application,Object(F.a)(this,this.x8g,"openExternal"));
this.ia.ya(G.a.PJe,nc.a.application,Object(F.a)(this,this.x8g,"openExternal"));this.ia.ya(L.a.convertAndEdit,nc.a.application,Object(F.a)(this,this.qBi,"convertBinaryFormat"));this.ia.ya(L.a.repair,nc.a.application,Object(F.a)(this,this.x1k,"repairCorruptedFile"));this.ia.ya(L.a.$oc,nc.a.application,Object(F.a)(this,this.$oc,"replaceOriginalFile"));this.ia.ya(L.a.fLb,nc.a.application,Object(F.a)(this,this.fLb,"saveRepairedFile"));this.ia.ya(L.a.h3b,nc.a.application,Object(F.a)(this,this.h3b,"editAnyway"));
this.ia.ya(L.a.n7b,nc.a.application,Object(F.a)(this,this.n7b,"goToEditMode"));this.ia.le(L.a.openInClient,12288)}Tii(a){if(this.Mm.isPaused)return this.Fa.Ed(),this.lUe(a),32;this.pa.Rh();this.Fa.Ed();if(1===this.Rb.mode&&this.Ha.umg)return this.fXf(a),32;this.uE.C3(a,!0,()=>{this.lUe(a)},()=>{this.lUe(a);return!0},3);this.Pu.show(!1,"OpenInClient");return 32}lUe(a){this.Pu.hide();this.fXf(a)}fXf(a){Rc.a.fud();this.pIg.Ptb(a)}x8g(a,b,c){if(b.contextId!==nc.a.application)return 2;b=!(!this.qe.documentUrl&&
!this.$wg.mxa&&!u.AFrameworkApplication.$uc);if(1===c)return b?32:8;if(!b)return 8;this.M4j();if(this.fc.$c(this.zkk.xf))return 16;a=a===G.a.PJe?5:2;1===this.Rb.mode&&this.Ha.umg&&(a=1);return this.pIg.begin(this.qe.documentUrl,u.AFrameworkApplication.zRa,3,a,this.Ha.aSj,this.OAg,Pd.a("OpenPPTTemplateInDesktopAppAsNFT")?ha.a.pQ(this.$wg.$w):"")}M4j(){try{let a="";const b=this.ua.fk;b&&(a=b.toString());va.a.J(509372432,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",this.ua.currentSlideIndex,
a)}catch(a){va.a.J(509372431,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}qBi(a,b,c){va.a.J(509372430,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");if(b.contextId!==nc.a.application)return 2;if(1===c)return 32;const f=Object.assign(new xy,{PodEndpointUrl:this.Ha.podsWebServiceBase,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string});this.Xea.Fvd(f,Object(F.a)(this,this.AAk,"onUploadConvertedFileToHostSucceeded"),l=>{this.zAk(l,
f.PodSessionID)});this.Pu.RZe(!0,ResourceStrings.L_FileConverting,a);return 32}AAk(a){va.a.J(509372429,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.Pu.hide();if(this.Rb)if(a=a.result,a.EditUrl){var b=!1,c=!1,f=!1;u.AFrameworkApplication.fa&&(b=u.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),f=u.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){va.a.J(509372426,801,
50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[Mi.a.$Jb]="1";l[Mi.a.documentUrl]=a.EditUrl;l[Mi.a.mode]="edit";l[Mi.a.reason]=Fu.a.convert;u.AFrameworkApplication.nT().execute(w=>{w.sendMessage(Ce.a.mDa,l)})}else this.Rb.rM(!0,a.EditUrl)}else va.a.J(509372427,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else va.a.J(509372428,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}zAk(a,
b){a=pf.a.$K(a.error.Im);va.a.J(509372425,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.Pu.hide();a=Object.assign(new oi.a,{Code:a,Source:5});this.Sd.zs(a,b,c=>{c.mC=1;c.sCa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}x1k(a,b,c){if(b.contextId!==nc.a.application)return 2;if(1===c)return 32;va.a.J(509372424,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.z1k();
return 32}z1k(){const a=new Date;va.a.J(509372423,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",a);const b=Rc.a.zk("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");this.lR.Ysb(()=>{va.a.J(509372422,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},
()=>{va.a.J(509372421,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});this.Teb.Dkh(b,()=>{va.a.J(509372420,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.pzl()},c=>{va.a.J(509372419,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-
+a,c);b.finish();this.bMk(c,this.Xa.podSessionId);return!0})}pzl(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Xa.podSessionId;a.fromInlineDocumentRepair=!0;this.Mv.SVe();a=this.ia.La(L.a.eKb,2,a);va.a.J(509372418,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}bMk(a,b){a=Object.assign(new oi.a,{Code:a,Source:5});this.Sd.zs(a,b,c=>{c.mC=1;c.sCa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;
return!1})}h3b(a,b,c,f,l){if(b.contextId!==nc.a.application)return 2;if(1===c)return 32;va.a.J(509372417,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.Mv.Pwb();0!==a&&(va.a.J(509372416,801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.zLf());if(20===l)this.Mv.XEl();else return va.a.J(509372387,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}fLb(a,b,c,f,l){if(b.contextId!==
nc.a.application)return va.a.J(509372386,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(l,1);va.a.J(509372385,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.L7f(1,l);return 32}L7f(a,b){va.a.J(509372384,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.Ha.podsWebServiceBase,this.Xa.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const l=new Date;u.AFrameworkApplication.Ke.nj(c,1,"",f,!1,0,w=>{this.oIe(w,l,b)},w=>{this.nIe(w,a,b)},null,null)}oIe(a,b,c){va.a.J(509372383,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.Wd).downloadUrl;ha.a.Wa(a)?(va.a.J(509372382,
801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.pyh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.La(c,2,b))}nIe(a,b,c){a=a.data?a.data.ie:-1;a===Nk.a.xii&&0<b--?(va.a.J(509372381,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.L7f(b,c)):(va.a.J(509372380,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",
a,c),this.pyh())}pyh(){const a=Object.assign(new oi.a,{Code:20,Source:6});this.Sd.zs(a,this.Xa.podSessionId,b=>{b.mC=1;b.sCa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}$oc(a,b,c){if(b.contextId!==nc.a.application)return va.a.J(509372379,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=
u.AFrameworkApplication.fa.Ga("DocumentPermissions")||"",b=this.Xa.k9g&&-1<a.indexOf("W"),va.a.J(509372378,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",this.Xa.k9g,a),b?32:8;va.a.J(509372377,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Xa.Kk=this.t$.q9a(this.Xa.presentationId.string);a=Object.assign(new bj.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,
PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Xa.Kk,UrlOverrides:this.Ha.Mfa,IsCreateNewSession:this.Ha.GQ,UseSharedHostFile:this.Ha.KPb});this.t$.rJc(a,()=>{this.vuk()},Object(F.a)(this,this.pHb,"onEnsureHostSessionFailed"),0,!0);return 32}vuk(){va.a.J(509372376,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.Mv.a3k();this.Xa.o3k();0!==this.Mv.Pwb()&&this.Mv.TVe(!1)}pHb(){va.a.J(509372375,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");
this.Mv.SVe();0!==this.Mv.Pwb()&&this.Mv.TVe(!0);return!1}n7b(a,b,c){if(b.contextId!==nc.a.application)return va.a.J(509372374,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return 32;a=new Date;this.zLf();va.a.J(509372373,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}zLf(){this.Xa.Kk=this.t$.q9a(this.Xa.presentationId.string);const a=
Object.assign(new bj.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Xa.Kk,UrlOverrides:this.Ha.Mfa,IsCreateNewSession:this.Ha.GQ,UseSharedHostFile:this.Ha.KPb});this.t$.rJc(a,()=>{this.wuk()},null,15,!0);this.Mv.TVe(!1)}wuk(){va.a.J(509372372,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(n.a)(Qf,"PowerPointAppFrameCommandUIActor",
null,[]);var hh=d(506);class Eh{constructor(a,b,c){this.Stg=a;this.m0=b;this.lDb=c}show(a,b){this.lDb?(b=new hh.a(b),b.message=ResourceStrings.l_Saving,b.Ijg=!0,b.$Mb=a,this.m0.jKa(b)):this.RZe(a,ResourceStrings.l_Saving,b)}RZe(a,b,c){this.lDb?(c=new hh.a(c),c.message=b,c.$Mb=a,this.m0.jKa(c)):this.Stg.cNb(b,a,0,0,c)}hide(){this.lDb?this.m0.jKa(Object.assign(new hh.a(null),{Hjg:!0})):this.Stg.IWc()}}Object(n.a)(Eh,"SaveBlockingUI",null,[1273]);var qi=d(241);class mi{constructor(a,b,c,f,l,w,H,U,ja){this.Dfc=
Pc.App.Ym;this.ZGg=ia.a.nil;this.zb=a;this.ua=b;this.Oc=c;this.Qk=f;this.WL=l;this.tad=w;this.yz=U;this.ut=H;this.Ack=ja.j7k;this.udk=ja.pptNotShowSavingStatusOfProofingOnlyRevision;this.Oc.LA(Object(F.a)(this,this.GB,"onSessionEnd"));this.Qk.YPd(Object(F.a)(this,this.LIh,"updateSavingStatus"));this.Qk.zvf(Object(F.a)(this,this.KIh,"updateSavedStatus"));this.ut.RK(Object(F.a)(this,this.rpa,"updateSaveStatusDisplay"));this.Kjk=new Le.a(3,1,ja.i7k,Object(F.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),
90,"28");this.hVa=!1;this.b$c=ja.powerPointTextEditOnlyMode}initialize(){this.rpa(this.ut)}KIh(){this.hVa||this.yz.N_||this.yz.dng||(this.zb.Db(this.Kjk),this.hVa=!0)}LIh(a,b){this.yz.N_||this.yz.dng||(this.udk&&mi.ZTj(b.node)||this.tad.updateSaveStatusText(!1),this.Dfc=new Date,this.ZGg=b?b.revisionId:ia.a.nil)}updateSaveStatusText(){this.hVa=!1;const a=!this.WL.aX(this.ua.presentation);this.tad.updateSaveStatusText(a);a&&(this.Pkh(0,0),this.Dfc=Pc.App.Ym);this.b$c&&mi.lFl(a)}rpa(a){this.tad.rpa(!1,
1===a.mode?1:3)}GB(a,b){this.tad.updateSaveStatusText(!0);this.Pkh(1,b.NE);this.Dfc=Pc.App.Ym}Pkh(a,b){if(this.Dfc!==Pc.App.Ym){var c=+new Date-+this.Dfc;c>=this.Ack&&(c=String.format("SavingTime {0};Type {1};Revision {2};",c,a,this.ZGg),1===a&&(c+=String.format("CloseReason {0};",b)),va.a.J(21604228,811,50,c))}}dispose(){this.Oc.qaa(Object(F.a)(this,this.GB,"onSessionEnd"));this.Qk.ERe(Object(F.a)(this,this.LIh,"updateSavingStatus"));this.Qk.Mjh(Object(F.a)(this,this.KIh,"updateSavedStatus"));this.ut.CY(Object(F.a)(this,
this.rpa,"updateSaveStatusDisplay"))}static lFl(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display="block";a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static ZTj(a){return a.Sa(hb.a.xjd)&&!a.Sa(qi.a.Lnd)}}Object(n.a)(mi,"SaveStatusManager",null,[106]);class Bk{constructor(){this.K=
null;this.Vxe=!1}get name(){return"PowerPointWebEditor.Actors"}Zb(a){(new Cs).Zb(a);this.K=a;a.register(Qf,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().oa(()=>new Qf(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Ja("Postmessage.IHostPostmessenger"),
a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(1273,"PowerPointWebEditor.ISaveBlockingUI").ma().oa(()=>new Eh(new wy(new Lt(a.resolve("PowerPointWebEditor.IPaneManager").xa,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),
a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").qlg));a.register(mi,"PowerPointWebEditor.SaveStatusManager").ma().oa(()=>new mi(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.Vxe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").ETj)&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").wb();this.K.resolve("Common.IOfficeTrialExperience").wb();this.K.resolve("Common.IMacOfficeOffer").wb()}dispose(){this.Vxe&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){v.a.instance.Dc(new Bk)}}Object(n.a)(Bk,"PowerPointActorsPackage",null,[2,3]);var Fh=d(1039),hn=d(1106);class so{constructor(){this.uPa=this.ES=this.KAa=null;this.apf=!1;this.X7e=null;this.Y7e=this.VUb=0}get messageId(){return this.KAa}get values(){return this.ES}get userSessionId(){return this.uPa}get shouldRetry(){return this.apf}get XFc(){return this.X7e}get Owa(){return this.VUb}get X4h(){return this.Y7e}static rHi(a,
b){var c=Ce.a.JKi;const f=new so;f.KAa=a;f.ES={};f.uPa=b;f.apf=!0;f.X7e=c;f.VUb=3;f.Y7e=1E3;return f}}Object(n.a)(so,"PostMessageData",null,[]);class Nn{constructor(a,b,c){this.iMd={};this.$a=a;this.UCd=c;this.X1j();this.JUk(b)}X1j(){if(this.$a.ka("DocRebootIsSupported")||this.$a.ka("UiHostSupportsDocRebootFeatures"))this.iMd[hn.a.refresh]=()=>this.H9k(Ce.a.mDa)}JUk(a){a.ya(G.a.Keh,Xd.a.frame,Object(F.a)(this,this.g9k,"sendActionToHostIfSupported"))}g9k(a,b,c,f,l){if(2!==c)return 32;if(!l)return ka.ULS.sendTraceTag(41972610,
204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.iMd[a]?(ka.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.iMd[a]()):2}H9k(a){const b=so.rHi(a,u.AFrameworkApplication.userSessionId);this.UCd.execute(c=>{c.postMessage(b)});return 32}}Object(n.a)(Nn,"HostActionExecutionManager",null,[]);var Ro=d(118),Dm=d(731);class Qm extends Ea.a{constructor(a,b,c,f){super(a,b,c);this.kTb=this.f7=0;this.Ydf=
!1;this.mTb=0;this.TCd=this.Bzc=null;this.Zdf=this.$df=!1;this.Ca=f;this._name="HostIntegrationMessenger";this.create()}hBj(a){const b=a.message,c=a.Zi.origin;u.AFrameworkApplication.wopiHostOriginFromPostMessage||(u.AFrameworkApplication.wopiHostOriginFromPostMessage=c);switch(b.MessageId){case Ce.a.bTd:case Ce.a.dTd:this.bBj(b);break;case Ce.a.rbe:case Ce.a.sbe:this.mud();break;case Ce.a.xde:this.jBj(b);break;case Ce.a.Gbb:this.pZj(b);break;case Ce.a.K6e:this.Kii(a);break;case Ce.a.O6e:this.QCl()}}oCl(a){switch(a.MessageId){case Ce.a.tde:u.AFrameworkApplication.Ta.La(G.a.Smd,
2,a.Values[Mi.a.direction]);break;case Ce.a.tyb:ka.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");u.AFrameworkApplication.Ta.La(G.a.tyb,2,(new Date).getTime());break;case Ce.a.ude:ka.ULS.sendTraceTag(544221062,204,50,"We received HostBackButtonPressed message in WAC");break;case Ce.a.vde:ka.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");u.AFrameworkApplication.Ta.processAction(G.a.q6i,2);break;case Ce.a.u8b:ka.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");
u.AFrameworkApplication.Ta.processAction(G.a.u8b,2);break;case Ce.a.wde:ka.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");u.AFrameworkApplication.Ta.processAction(G.a.Cpj,2);break;case Ce.a.Ade:ka.ULS.sendTraceTag(537424842,204,50,"Host_SendChannelId Received")}}mud(){y.FocusManager.instance()&&y.FocusManager.instance().Ae&&y.FocusManager.instance().Ae.name===u.AFrameworkApplication.Lhb&&y.FocusManager.instance().a1(y.FocusManager.instance().Ae.name)}bBj(a){y.FocusManager.instance().LU(u.AFrameworkApplication.Lhb,
!1);if(Mi.a.lrc in a.Values){const b={};b[Mi.a.lrc]=a.Values[Mi.a.lrc];ka.ULS.sendTraceTag(38278996,204,50,Jc.c(b))}}jBj(a){if(!ig.a.kT(document.URL,u.AFrameworkApplication.Edd)&&a.Values){var b=0,c=0;try{b=a.Values[Mi.a.kBj],c=a.Values[Mi.a.lBj],Mi.a.pdg in a.Values?this.Bzc=a.Values[Mi.a.pdg]:Mi.a.qdg in a.Values&&(this.Bzc=a.Values[Mi.a.qdg]),Mi.a.rdg in a.Values&&(this.TCd=a.Values[Mi.a.rdg])}catch(f){return}this.kTb=b;this.mTb=c;this.f7&&this.srg()}}pZj(a){ka.ULS.sendTraceTag(37536415,204,50,
"JsApiDiagnostics");var b=a.Values[Mi.a.gBj];b&&gj.a.instance.oTk(b);(b=a.Values[Mi.a.ZVd])&&gj.a.instance.bTk(b);(a=a.Values[Mi.a.Gbb])&&gj.a.instance.tTk(a)}Kii(a){ka.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.uAb=!0;u.AFrameworkApplication.Aa.N1.gHe(a.Zi.qc)}QCl(){ka.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.Aa.N1.MIe(null,Sys.EventArgs.Empty)}srg(){this.$3j();
this.a4j();null!=this.Bzc&&gj.a.instance.pTk(this.Bzc);null!=this.TCd&&gj.a.instance.qTk(this.TCd)}$3j(){this.f7&&this.kTb&&!this.Ydf&&(this.Ydf=!0,this.kTb>this.f7||(u.AFrameworkApplication.kj.setDw(10324,this.f7-this.kTb),gj.a.instance.Mgh(this.kTb)))}a4j(){this.f7&&this.mTb&&!this.$df&&(this.$df=!0,this.mTb>this.f7||(u.AFrameworkApplication.kj.setDw(10325,this.f7-this.mTb),gj.a.instance.VTk(this.mTb)))}Z1k(){var a=Kd.a.B9f();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.f7||
u.AFrameworkApplication.kj.setDw(11045,this.f7-b)}}create(){u.AFrameworkApplication.pig&&this.disable();this.NLa!==Dm.a.lZb&&this.LBa(this.NLa);this.Ca.ra(G.a.NOi,Xd.a.frame,Object(F.a)(this,this.SOi,"disposeInstance"),96);this.yu(Ce.a.bTd);this.yu(Ce.a.dTd);this.yu(Ce.a.rbe);this.yu(Ce.a.sbe);this.yu(Ce.a.xde);this.yu(Ce.a.zde);this.yu(Ce.a.hRd);const a=Object(F.a)(this,this.hBj,"hostMessageHandler");this.i_a(Ce.a.bTd,a);this.i_a(Ce.a.dTd,a);this.i_a(Ce.a.rbe,a);this.i_a(Ce.a.sbe,a);this.i_a(Ce.a.xde,
a);u.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.Bsf(Ce.a.K6e),this.Bsf(Ce.a.O6e),this.i_a(Ce.a.K6e,a),this.i_a(Ce.a.O6e,a));if(u.AFrameworkApplication.fa.ka("PostMessageEmbedded")||u.AFrameworkApplication.fa.ka("IsJsApi")){this.yu(Ce.a.tyb);const b=Object(F.a)(this,this.oCl,"uiHostMessageHandler");u.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.yu(Ce.a.tde),this.KB(Ce.a.tde,b));this.KB(Ce.a.tyb,b);u.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&
(this.yu(Ce.a.vde),this.KB(Ce.a.vde,b),this.yu(Ce.a.ude),this.KB(Ce.a.ude,b),this.yu(Ce.a.u8b),this.KB(Ce.a.u8b,b),this.yu(Ce.a.wde),this.KB(Ce.a.wde,b));u.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.yu(Ce.a.Ade),this.KB(Ce.a.Ade,b))}u.AFrameworkApplication.fa.ka("IsJsApi")&&(this.yu(Ce.a.Gbb),this.i_a(Ce.a.Gbb,a))}SOi(a,b,c){if(2!==c)return 32;Ro.a.Kx(this);return 32}reportDocumentLoadedTime(a){this.Zdf||(this.f7=a,this.Z1k(),this.NLa!==Dm.a.lZb&&this.sendMessage(Ce.a.Hei,
{["DocumentLoadedTime"]:a}),this.srg(),this.Zdf=!0)}}Object(n.a)(Qm,"HostIntegrationMessenger",Ea.a,[800,371,106]);class So{constructor(){this.Da=null}get name(){return"Common.App.Postmessengers"}init(){u.AFrameworkApplication.fa.ff(()=>{this.Cee(this.Da)})}Cee(a){u.AFrameworkApplication.DQ=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");u.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}Zb(a){this.Da=a;a.register(Qm,
"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().oa(()=>{u.AFrameworkApplication.fa.Nda||ka.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=u.AFrameworkApplication.Vna?u.AFrameworkApplication.Vna:Dm.a.lZb;ka.ULS.sendTraceTag(536987587,204,50,"HostIntegrationMessenger instantiating");return new Qm(window.parent,b,Fh.a.instance,u.AFrameworkApplication.Ta)});a.register(Nn,"Common.App.HostActionExecutionManager").ma().oa(()=>
{u.AFrameworkApplication.fa.Nda||ka.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new Nn(u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.Ja("Postmessage.IHostPostmessenger"))})}}Object(n.a)(So,"PostmessengersPackage",null,[2,3]);var jp=d(408),Tl=d(315),ek=d(273),kg=d(205);class lt extends kg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(n.a)(lt,"PersonaButtonProps",
kg.a,[]);class mt{I1b(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new ek.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.EEi(a,c.ControlList);b.push(c)}}EEi(a,b){const c=Object.assign(new jp.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Tl.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new ek.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,
b);this.MGi(a,b.ControlList)}MGi(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new lt,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}Object(n.a)(mt,"PresenceContextMenuSectionBuilder",null,[1080]);var yA=d(355);class zA{constructor(a,b,c,f){this.mZ=this.xn=this.Xm=this.Af=this.Kpa=null;this.rEc=a;this.w1h=f;this.rEc.eje&&
(this.Xm=new Le.a(3,2,5E3,Object(F.a)(this,this.$hi,"authenticationCheckTask"),2),u.AFrameworkApplication.ye.Db(this.Xm),this.wb(b,c));this.rEc.Q9h(()=>{this.ekc()});this.rEc.Huf(()=>{this.fkc()})}get businessBar(){return this.xn||(this.xn=Ab.a.instance.rb("CommonUI.IBusinessBar"))}get NBf(){return this.mZ||(this.mZ=Ab.a.instance.rb("CommonUI.IBusinessBarEntryFactory"))}wb(a,b){const c=u.AFrameworkApplication.Ta;c.ra(G.a.Czf,Xd.a.frame,a,96);c.ra(G.a.Dzf,Xd.a.frame,b,96);c.ya(G.a.lEf,Xd.a.frame,ac.ActionManager.vv);
c.ya(G.a.mEf,Xd.a.frame,ac.ActionManager.vv);c.ya(G.a.goe,Xd.a.frame,ac.ActionManager.vv)}ekc(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);u.AFrameworkApplication.Ta.processAction(G.a.Czf,2)}fkc(){this.Ivl();u.AFrameworkApplication.Ta.processAction(G.a.Dzf,2)}$hi(){this.rEc.authenticationCheck()}Ivl(){this.Af&&(this.Af.hide(),this.Af.dispose(),this.Af=null);this.Kpa&&this.businessBar&&(u.AFrameworkApplication.Ug||this.businessBar.removeEntry(this.Kpa),this.Kpa.dispose(),this.Kpa=
null)}showDialog(a){Ro.a.Kx(this.Af);this.Af=new Bi.StandardDialog;this.w1h||(this.Af.Ar=!1,this.Af.yd=0);this.Af.Xe(1,CommonUIStrings.l_SignIn);this.Af.fP(CommonUIStrings.l_DefaultDialogTitle,a,Object(F.a)(this,this.p3,"dialogHandler"))}p3(a){1===a?(yA.a.lid(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),u.AFrameworkApplication.Ta.processAction(G.a.goe,2)):(this.Mll(),u.AFrameworkApplication.Ta.processAction(G.a.mEf,2))}Mll(){this.businessBar&&this.NBf&&(this.Kpa=
this.NBf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.Kpa.closeable=!0,this.Kpa.addButton(CommonUIStrings.l_SignIn,zA.Smi,""),this.Kpa.e3=Object(F.a)(this,this.Tmi,"businessBarEntryCloseHandler"),this.businessBar.$h(this.Kpa,!1))}Tmi(){this.bOi();u.AFrameworkApplication.Ta.processAction(G.a.lEf,2)}bOi(){this.Xm&&(u.AFrameworkApplication.ye.Mg(this.Xm),this.Xm=null)}dispose(){this.Xm=this.Af=this.Kpa=null}static Smi(){yA.a.lid();u.AFrameworkApplication.Ta.processAction(G.a.goe,
2)}}Object(n.a)(zA,"SignOutResponseUI",null,[106]);class Ir{get name(){return"Common.App.UI"}Zb(a){a.register(mt,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){Ro.a.Kx(Ir.Yba);Ir.Yba=null}static main(){v.a.instance.Dc(new Ir)}static UEj(a,b,c){Ir.xll()&&(Ir.Yba=new zA(yA.a.instance,a,b,c))}static xll(){return u.AFrameworkApplication.r0g&&!u.AFrameworkApplication.isEmbedded}}Ir.Yba=null;Object(n.a)(Ir,"CommonAppUIPackage",
null,[2,3]);class AA{constructor(a){this.eBa=this.ZAa=this.jBa=this.iBa=null;this.Edf=this.Dhf=this.EP=this.Gba=!1;this.SJd=this.Vhf=null;this.Ohf=0;this.$a=this.Thf=null;this.qha=a;this.nK=3;this.KTb=!0}initialize(a,b,c){this.iBa=this.r$d(a,b);this.jBa=CommonUIStrings.l_SavingStatus;this.ZAa=CommonUIStrings.l_ReadOnlyStatus;this.eBa=CommonUIStrings.l_ReviewModeStatus;this.qha&&this.qha.execute(f=>{f.VGc(Object(F.a)(this,this.Suc,"updateToSavingStatus"))});this.EP=!0;this.$a=c;return!0}rpa(a,b){this.Gba=
a;this.nK=b;this.updateSaveStatusText(this.KTb)}updateSaveStatusText(a){!this.KTb&&a&&(this.Thf=new Date);this.KTb=a;a=null;3===this.nK&&(a=this.KTb?this.iBa:this.jBa);this.uOi(a)}r$d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}Suc(){this.updateSaveStatusText(!1)}lej(){switch(this.nK){case 1:return this.ZAa;case 2:return this.eBa;default:return null}}oNj(a){return this.Dhf===
this.Gba&&this.Ohf===this.nK&&this.Vhf===a}v0d(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.Gba,a,this.lej(),this.Thf,this.KTb);this.Edf=!0;return null});this.SJd=null}uOi(a){this.EP&&Sg.c()&&!this.oNj(a)&&(!this.Edf&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.v0d(a):Kd.a.ISe()?(this.SJd&&ka.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.SJd=window.requestIdleCallback(()=>
{this.v0d(a)})):window.requestAnimationFrame(()=>{this.v0d(a)}),this.Dhf=this.Gba,this.Vhf=a,this.Ohf=this.nK)}}Object(n.a)(AA,"ReactSaveStatusUIHandler",null,[1385]);class BA{constructor(a,b){this.DQ=null;this.iBa=CommonUIStrings.l_SavedStatus;this.jBa=CommonUIStrings.l_SavingStatus;this.ZAa=CommonUIStrings.l_ReadOnlyStatus;this.eBa=CommonUIStrings.l_ReviewModeStatus;this.yAa=b;this.qha=a;this.nK=3;this.ZOa=!0}QJ(){this.qha&&this.qha.execute(a=>{a.VGc(Object(F.a)(this,this.Suc,"updateToSavingStatus"))});
this.yAa.execute(a=>{this.DQ=a})}rpa(a,b){this.nK=b;3===b?this.updateSaveStatusText(this.ZOa):2===b?this.n4e(this.eBa):this.n4e(this.ZAa)}Suc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.ZOa=a;this.n4e(this.ZOa?this.iBa:this.jBa)}n4e(a){this.DQ&&this.DQ.sendMessage(Ce.a.mCl,this.kAi(a))}kAi(a){const b={};b.StatusText=a;return b}}Object(n.a)(BA,"SaveStatusPostMessageHandler",null,[1385]);var xm=d(265);class CA{constructor(a,b,c,f){this.eBa=this.ZAa=this.jBa=this.iBa=null;this.d4a=0;
this.LP=this.EKd=this.k2a=this.Rxd=this.bNd=null;this.$e=a;this.kqa=b;this.qha=c;this.Xi=f;this.Hff=!0;this.Gba=!1;this.nK=3;this.ZOa=!0}initialize(a,b){if(!this.$e)return!1;this.iBa=this.r$d(a,b);this.jBa=CommonUIStrings.l_SavingStatus;this.ZAa=CommonUIStrings.l_ReadOnlyStatus;this.eBa=CommonUIStrings.l_ReviewModeStatus;this.QJ();return!0}r$d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}QJ(){this.kqa&&
this.kqa.execute(a=>{a.cbi(Object(F.a)(this,this.YLf,"createStatusAndModeElements"));a.Kai(Object(F.a)(this,this.Tml,"showHideSaveStatusElement"));a.iyl&&this.YLf(null,null)});this.qha&&this.qha.execute(a=>{a.VGc(Object(F.a)(this,this.Suc,"updateToSavingStatus"))})}Dza(){this.LP&&this.$e&&this.$e.Qud(this.LP)}Tml(a,b){this.rpa("true"===b,this.nK)}rpa(a,b){this.Gba=a;this.nK=b;this.Rxd&&(this.Rxd.style.display=this.Gba||3===this.nK||!this.bNd?"none":"");this.k2a&&(this.k2a.style.display=this.Gba||
3===this.nK?"none":"",this.k2a.innerText=1===this.nK?this.ZAa:this.eBa,this.k2a.title=1===this.nK?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.EKd&&(this.EKd.style.display=this.Gba||1===this.nK||!this.bNd&&!this.k2a?"none":"");this.LP&&(this.LP.style.display=this.Gba||1===this.nK?"none":"",this.updateSaveStatusText(this.ZOa),this.LP.title=CommonUIStrings.l_SaveStatusTooltip)}YLf(a,b){a=document.getElementById(xm.CuiHelper.jAj);b&&b.FLl||!a||""===this.iBa||
""===this.jBa||""===this.ZAa||""===this.eBa||(this.bNd=document.getElementById(xm.CuiHelper.pTd),this.Rxd=xm.CuiHelper.MLc(a,"BreadcrumbAppModeDash","-"),this.k2a=xm.CuiHelper.MLc(a,"BreadcrumbAppModeStatus",1===this.nK?this.ZAa:this.eBa),this.AHh(this.k2a),this.EKd=xm.CuiHelper.MLc(a,"BreadcrumbSaveStatusDash","-"),this.LP=xm.CuiHelper.MLc(a,"BreadcrumbSaveStatus",this.iBa),this.AHh(this.LP),this.rpa(this.Gba,this.nK))}Suc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.ZOa=a;this.bHl(this.ZOa?
this.iBa:this.jBa)}bHl(a){!this.LP||3!==this.nK&&2!==this.nK||(this.Hff&&!this.ZOa?(this.d4a=this.LP.offsetWidth<this.d4a?this.d4a:this.LP.offsetWidth,this.UDl(this.jBa),this.Hff=!1):this.LP.innerText=a)}AHh(a){a.style.direction=this.Xi?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Xi?"right":"left";a.style.display=this.Gba?"none":"";a.setAttribute("Unselectable","on")}UDl(a){this.LP&&(this.LP.style.width="",this.LP.innerText=a,this.d4a=this.LP.offsetWidth<this.d4a?this.d4a:this.LP.offsetWidth,
a=Jf.a.Xt(this.LP),this.LP.style.width=this.d4a-za.a.xM(a.paddingLeft)-za.a.xM(a.paddingRight)+1+"px")}}Object(n.a)(CA,"SaveStatusUIHandler",null,[1385]);class BF{constructor(){this.FKd=this.xJd=this.EWb=this.Da=null}get name(){return"Common.App.SaveStatus"}Zb(a){this.Da=a;u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&u.AFrameworkApplication.CQ?this.Da.register(BA,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new BA(this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.Ja("Postmessage.IHostPostmessenger"))):u.AFrameworkApplication.Aa.hb.Lng||(u.AFrameworkApplication.Aa.hb.dO?this.Da.register(AA,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new AA(this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"))):this.Da.register(CA,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new CA(Ja.EventHandlerManager.instance,this.Da.Ja("Common.App.Header.HeaderEventSource"),
this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"),u.AFrameworkApplication.isRtl)))}init(){u.AFrameworkApplication.fa.ff(Object(F.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){const a=u.AFrameworkApplication.fa,b=!!u.AFrameworkApplication.Aa.hb&&4===u.AFrameworkApplication.Aa.hb.Uk;if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&
u.AFrameworkApplication.CQ?(this.FKd=this.Da.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.FKd.QJ():u.AFrameworkApplication.Aa.hb.Lng||a.ka("PreventSaveStatusInitializationWithHiddenHeader")&&u.AFrameworkApplication.hideHeader||(u.AFrameworkApplication.Aa.hb.dO?(this.xJd=this.Da.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.xJd.initialize(a.ka("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus"),u.AFrameworkApplication.fa):(this.EWb=this.Da.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.EWb.initialize(a.ka("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus")))}dispose(){this.EWb&&this.EWb.Dza()}}Object(n.a)(BF,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2022-09-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_OneClickPromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1",
"nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURFhIWVJFRVVSTDRCSExHUEdXMzQ3OFoyMy4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},
Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCpFge6Cl3sRFoOMTPf8V7pNUMFpIMk1RSVo3WDhFQ0tPM0JPQ0VZOFc0Ty4u"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",
RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,
IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2",
"nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURDNVQ1BHVkxLUUpKTk80UDZDMk1TMFlPOC4u"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",
RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2",
"VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied",
"4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3",
"nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},
{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",
IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},
{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",
Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",
RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,
IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},
Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},
Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},
{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1",
"FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},
{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",
IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",
EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,
Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},
{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,
Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,
Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},
Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",
EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",
Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-06-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}},{CampaignId:"c855ff69-ff13-48f9-83b8-e76d1b65ee6a",
StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"InsertPicture",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"PPTO_Picture_FloodgatePromptTitle",
Question:"PPTO_Picture_FloodgatePromptQuestion",YesLabel:"PPTO_Picture_FloodgatePrompt_YesLabel",NoLabel:"PPTO_Picture_FloodgatePrompt_NoLabel"},Rating:{Question:"PPTO_Picture_FloodgateRatingQuestion",RatingValuesAscending:["PPTO_Picture_FloodgateRating_1","PPTO_Picture_FloodgateRating_2","PPTO_Picture_FloodgateRating_3","PPTO_Picture_FloodgateRating_4","PPTO_Picture_FloodgateRating_5"]},Question:{Question:"PPTO_Picture_FloodgateWhyQuestion"}}}}];var zP=d(672);class CF{q_f(){return null}M5i(){return Jc.c(window.PPTCampaignsObj_FromAppPackage)}Sae(a){return zP.a.Sae(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(n.a)(CF,"PowerPointFeedbackAppData",null,[1272]);class DA{constructor(){this.Da=null}Zb(a){this.Da=a;a.register(1272,"Common.App.IAppSpecificFeedbackData").ma().oa(()=>new CF)}init(){this.Da.rb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){v.a.instance.Dc(new DA)}}Object(n.a)(DA,"PPTWebEditorFeedbackPackage",null,[2,3]);class EA{get name(){return"Box4.ListEditors"}Zb(){}init(){}dispose(){}static main(){v.a.instance.Dc(new EA)}}
Object(n.a)(EA,"Box4ListEditorsPackage",null,[2,3]);var sj=d(141),Hk=d(125);const FA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class DF{constructor(a){this.WNd=this.BCd=!1;this.gNa=null;this.B9e=!1;this.Q6=null;this.Fba=!1;this.o_h=a;ra.a.instance.pb(sa.a.mouseDown,this.E5b(),Object(F.a)(this,this.ztk,"onContextualUIMouseDown"));(a=Ab.a.instance.Ja("Common.IActionContextProvider"))&&a.execute(b=>{this.Q6=b});u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
u.AFrameworkApplication.Aa.hb.dO?db.a.get_instance().Uj(16,()=>{this.gg?this.initializeContextualUI(this.E5b()):db.a.get_instance().Uj(7,()=>{this.initializeContextualUI(this.E5b())})}):db.a.get_instance().Uj(7,()=>{this.initializeContextualUI(this.E5b())})}get Bzb(){return this.Fba}get gg(){return u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&u.AFrameworkApplication.Aa.hb.dO?db.a.get_instance().isCompleted(16)&&db.a.get_instance().isCompleted(7):db.a.get_instance().isCompleted(7)}qqi(){if(this.B9e)return!0;
try{return Promise.resolve(null),this.B9e=!0}catch(a){return!1}}E4e(a){if(!this.gg||this.WNd)return this.npe("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.qqi())return this.npe("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(u.AFrameworkApplication.jOc)return this.npe("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.WNd=!0;let b=G.a.ve;switch(a){case 1:b=G.a.showContextMenu;break;case 0:b=
G.a.showFloatie;break;case 2:b=G.a.$qd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.WNd=!1;wo.c(b)},0)});return!1}A9f(a){return sj.UISurfaces.ZDa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f=null){this.E4e(0)||this.A9f(b).then(l=>{if(0>=l.length)return null;this.wXe(l).then(()=>{const w={};w.target=
a;sj.UISurfaces.ZDa().then(H=>{appChrome.api.dispatch(H.showFloatie(w,c,void 0,this.d9d(),f));this.Fba=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.processAction(G.a.Z2j,2);return null})});return null})}showContextMenu(a,b,c=null,f=null){this.E4e(1)||this.gwh(a,b,c,f)}gwh(a,b,c=null,f=null){this.wXe(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);sj.UISurfaces.ZDa().then(w=>
{appChrome.api.dispatch(w.showContextMenu(l,b,c,void 0,this.d9d()));return null})})}Lya(a,b,c){this.E4e(2)||this.A9f(b).then(f=>{0>=f.length?this.gwh(a,c,null):this.wXe(f).then(()=>{const l={};l.target=a;const w={};w.target=a;sj.UISurfaces.ZDa().then(H=>{appChrome.api.dispatch(H.showContextualUI(l,w,c,void 0,null,this.d9d()));this.Fba=!0;return null})});return null})}npe(a){ka.ULS.sendTraceTag(561394519,340,15,a)}s0d(){this.gg&&sj.UISurfaces.isLoaded()&&sj.UISurfaces.ZDa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());
return null})}tC(){this.gg&&sj.UISurfaces.isLoaded()&&sj.UISurfaces.ZDa().then(a=>{this.Fba=!1;appChrome.api.dispatch(a.hideFloatie());return null})}H2b(){this.gg&&sj.UISurfaces.isLoaded()&&sj.UISurfaces.ZDa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.Fba=!1;return null})}initializeContextualUI(a){return sj.UISurfaces.ZDa().then(b=>{this.BCd||(b.initializeContextualUI(a),this.BCd=!0);return null})}wXe(a){if(!this.BCd)return this.initializeContextualUI(this.E5b()).then(()=>{this.setActiveFloatieGroups(a);
return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];sj.UISurfaces.ZDa().then(f=>{c.push.apply(c,this.o_h.XJb.lVc(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}E5b(){if(this.gNa)return this.gNa;this.gNa=FA("div");this.gNa.id="ReactContextualUIDiv";this.gNa.style.position="absolute";this.gNa.style.zIndex=
"1001";document.body.insertBefore(this.gNa,document.body.firstChild);return this.gNa}ztk(a){a.qc&&a.qc.target&&"input"===a.qc.target.tagName.toLowerCase()&&y.FocusManager.instance().iD("ribbon");return!1}d9d(){return this.Q6?this.Q6.contentType:"Unknown"}}Object(n.a)(DF,"ReactContextualUILauncher",null,[1268]);var tj=d(131);class GA{constructor(a){this.oWb=a}create(a,b){const c=new Sys.StringBuilder;this.M1b(c,a,b);this.AYd(c,a);return c.toString()}Rt(a,b){const c=[];this.gZd(c,a,b);this.BYd(c,a);
return c}M1b(a,b,c){switch(b.errorType){case 0:a.append(this.oWb.build());break;case 1:case 2:a.append(this.wTd(b,c))}}gZd(a,b,c){switch(b.errorType){case 0:a.push(this.oWb.tBf());break;case 1:case 2:a.push(this.cli(b,c))}}AYd(a,b){R.a.instance.ga(92)||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(tj.a("btnIgrnoreSpellingError",(2===b.errorType?D.a.Sud:D.a.Eka).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}BYd(a,
b){if(!R.a.instance.ga(92)){var c=Object.assign(new ek.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:b}));a.push(c)}}wTd(a,b){a=this.o3i(a.suggestions,b);return 0<a.length?tj.e("msUnknownWord",tj.c(null,a),"Menu16"):tj.e("msUnknownWord",tj.c(null,[tj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}o3i(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=
0;l<f;++l)a[l]&&c.push(tj.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}cli(a,b){const c=Object.assign(new ek.a,{Id:"Suggestions",ControlList:[]});this.n3i(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new kg.a,{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}n3i(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const w=Object.assign(new kg.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});
Array.add(c,w)}}}}Object(n.a)(GA,"DefaultProofingContextMenuCreator",null,[]);class HA{constructor(a,b){this.aaf=a;this.tbf=b;this.iPa=[D.a.kza,D.a.lza,D.a.mza,D.a.LLa,D.a.MLa]}create(a,b){return b?Object(Ya.a)(Uo.a,b)?this.tbf.create(a,b,this.iPa):this.aaf.create(b,this.iPa):""}I1b(a,b){return b?Object(Ya.a)(Uo.a,b)?this.tbf.Rt(a,b,this.iPa):this.aaf.Rt(b,this.iPa):null}}Object(n.a)(HA,"ProofingContextMenuSectionFactory",null,[1333]);class EF{build(){const a=[tj.a("btnDeleteRepeatedWord","2023591105",
Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return tj.e("msRepeatedWord",tj.c(null,a),"Menu16")}tBf(){const a=Object.assign(new ek.a,{ControlList:[]}),b=Object.assign(new kg.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,b);return a}}Object(n.a)(EF,"ProofingRepeatedWordSectionBuilder",null,[1332]);var IA=d(1123);class Es{constructor(a,b){this.I2a=a;this.Vm=b}get isVisible(){return this.I2a.Bzb}get controls(){return null}tC(){this.I2a.tC();return!0}cZe(a,b){this.I2a.showFloatie(Object.assign(new IA.a,
{x:a.x,y:a.y}),this.f5b(b),b,null)}H2f(){return new Sys.UI.Bounds(0,0,0,0)}Bsa(){return this.tC()}f5b(){return[]}}Object(n.a)(Es,"ReactFloatie",null,[1065,1066]);class FF{constructor(a){this.Kxc=null;this.I2a=a}dispose(){}Bsa(){this.I2a.H2b();return!0}showContextMenu(a,b){this.k6(a,b.clientPoint,b.Wf)}k6(a,b,c){this.Zqd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);ka.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}Zqd(a,b,c,f=null){this.Kxc?this.I2a.Lya(Object.assign(new IA.a,
{x:b.x,y:b.y}),this.Kxc.f5b(c),c):this.I2a.showContextMenu(Object.assign(new IA.a,{x:b.x,y:b.y}),c,void 0,f);this.Kxc=null}$qd(a,b,c,f){this.Kxc=Object(qa.a)(Es,c);f.Iaa(a,b);return!0}}Object(n.a)(FF,"ReactContextMenuController",null,[1269,106]);var Jr=d(441);class zy{static get eg(){return ci.a.VA(zy.En,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}zy.En="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(n.a)(zy,"AutoCorrectOptionsDialogHTML",null,[]);class Ay{static get eg(){return ci.a.VA(Ay.En,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Ay.En="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(n.a)(Ay,"AutoCorrectOptionsDialogHTML2",null,[]);class GF extends ci.a{constructor(a,b){super();this.$R=a;this.J2=b;this.ig="AutoCorrectOptionsDialog"}Prc(){ka.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.eg=this.J2?Ay.eg:zy.eg;const a={};a.ReplaceTextAsYouType=this.$R.Yib;a.CapitalizeFirstLetterOfSentences=this.$R.FJc;a.ReplaceOrdianalsWithSuperscript=this.$R.tmd;a.ReplaceHyphensWithDash=this.$R.Zoc;a.ReplaceFractionsWithFractionCharacter=this.$R.rmd;this.J2&&
(a.ReplaceQuoteWithSmartQuote=this.$R.pSe);this.aj(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(F.a)(this,this.hal,"setAutoCorrectOptionsHandler"),a)}hal(a,b){R.a.instance.ga(70)&&(1!==a?ka.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.$R.Yib||b.CapitalizeFirstLetterOfSentences!==this.$R.FJc||b.ReplaceOrdianalsWithSuperscript!==this.$R.tmd||b.ReplaceHyphensWithDash!==this.$R.Zoc||b.ReplaceFractionsWithFractionCharacter!==
this.$R.rmd||this.J2&&b.ReplaceQuoteWithSmartQuote!==this.$R.pSe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.J2&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.$R.S6k(a),ka.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.J2,["ReplaceQuoteWithSmartQuote"]:this.J2&&b.ReplaceQuoteWithSmartQuote}),
Pc.App.Kb.updateCommandUI(!0)):ka.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(n.a)(GF,"AutoCorrectOptionsDialog",ci.a,[1271]);class By{static get eg(){return ci.a.VA(By.En,CommonUIStrings.l_AlternativeTextDialogLabel)}}By.En="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='titleText' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='500' autocomplete=\"off\"/> </div>";
Object(n.a)(By,"AltTextDialogHtml",null,[]);class Cy{static get eg(){return ci.a.VA(Cy.En,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Cy.En="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(Cy,"AltTextDialogWithDescriptionHtml",null,[]);class rq extends ci.a{constructor(a=!1,b=!1){super(!1,!1,a);this.cdg=!1;b?(this.cdg=!0,this.eg=By.eg):this.eg=Cy.eg;this.ig=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}WCi(a){this.aj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(F.a)(this,this.UQd,"altTextDialogHandler"),this.HSc(a));a=document.getElementById(rq.WQd);a.focus();a.select()}YCi(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.HSc(a)};this.aj(CommonUIStrings.l_AlternativeTextDialogTitle,
Object(F.a)(this,this.UQd,"altTextDialogHandler"),a)}HSc(a){const b={};b[rq.WQd]=this.getAltText(a);this.cdg||(b[rq.TQd]=this.H1f(a)||"");return b}DN(a){return a.Ec.id===rq.TQd?!1:super.DN(a)}}rq.WQd="titleText";rq.TQd="descriptionText";Object(n.a)(rq,"BaseAltTextDialogWithDescription",ci.a,[]);class Mt extends rq{constructor(a,b=!1,c=!1){super(b,c);this.ig=Mt.SBj;b&&u.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?this.YCi(a):this.WCi(a)}}Mt.SBj="AAltTextDialogWithDescription";Object(n.a)(Mt,
"AAltTextDialogWithDescription",rq,[]);class HF extends Mt{constructor(a,b,c,f,l){super(a);this.Iqb=this.sRb=null;this.HD=b;this.gha=c;this.Bk=f;this.fd=l}H1f(a){this.sRb=a.node;this.Iqb=hd.TableReader.u8f(a);return hd.TableReader.nae(this.Iqb)}getAltText(a){this.sRb=a.node;this.Iqb=hd.TableReader.u8f(a);return hd.TableReader.oae(this.Iqb)}UQd(a){if(1===a){hd.TableReader.oae(this.Iqb);hd.TableReader.nae(this.Iqb);this.hide();a=this.Bk.oe(15);try{a.kd(this.sRb)}finally{a&&a.dispose()}}R.a.instance.ga(50)&&
this.gha.vw&&this.gha.aZ.mra(this.sRb)}}Object(n.a)(HF,"TableAltTextDialog",Mt,[]);class JA{constructor(a,b,c){this.HD=a;this.Bk=b;this.fd=c}create(a){return new HF(a,this.HD,Pc.App.Jh,this.Bk,this.fd)}}Object(n.a)(JA,"TableAltTextDialogFactory",null,[]);const AP=()=>{Pc.App.nei=!0;return 32},BP=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Iu:b}=IF(l)).returnValue)return 16;Pc.App.Kb.Lya(a,b);return 32},CP=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Iu:b}=IF(l)).returnValue)return 16;Pc.App.Kb.l6(a,
b);return 32},IF=a=>{let b,c;b=null;c=0;if(!a)return{returnValue:!1,point:b,Iu:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,Iu:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,Iu:c}};var DP=d(1124);class JF extends Sys.EventArgs{constructor(a,b,c,f,l,w=0,H=0,U=null){super();this.controlId=a;this.commandId=f;this.time=l;this.commandSurface=w;this.Iu=H;this.contentType=U}}Object(n.a)(JF,"CommandClickEventArgs",Sys.EventArgs,[]);class KF{constructor(a,
b){this.Cba=a.n8i();this.yRb=a;this.LMa=b}tUf(a,b,c,f=null,l=null){c&&(this.LMa.xq=c.CommandLocation,this.LMa.vT=c.InvocationMethod,this.LMa.asa=c.CommandTabName);let w=this.yRb.j2f(parseInt(a),b,c);w.BE&&(w=this.yRb.j2f(w.Hm,b,c));if(void 0!==w.fL&&null!==w.fL)return w.fL;if(w.Tce)l=32;else{var H=null;this.Cba&&this.Cba.oMe&&(H=this.Cba.oMe(w,l));w.hX||w.Ple?w.$q?l=16:(l=this.LMa.La(w.Hm,w.Ole?2:1,w.rd,l),2===l&&(l=32)):w.$q?l=this.LMa.sjd(null,w.Hm,w.rd,U=>{f&&f(U.response)},l):(l=this.LMa.La(w.Hm,
2,w.rd,l),f&&f(l));this.Cba&&this.Cba.LLe&&this.Cba.LLe(w,l,H);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";H=b.ParentMenuId;void 0!==H&&null!==H||!b.MenuId||(H=b.MenuId);let U=b.SqmControlId;void 0!==U&&null!==U||!b.SourceControlId||(U=b.SourceControlId);(void 0!==U&&null!==U||void 0!==H&&null!==H)&&DP.a.YOk(new JF(U,c,H,a,Date.now()))}}w.hX&&32===l&&this.Cba&&this.Cba.zZb&&this.Cba.zZb(w,b);w.Ple&&32===l&&this.Cba&&this.Cba.FRd&&this.Cba.FRd(w,
b);return 32===l||1===l}aac(a,b=null){if(u.AFrameworkApplication.Ug||fm.a.instance.ww)return!1;const c=parseInt(a);b&&b.UILocation&&(this.LMa.xq=b.UILocation);if(!a||c===ac.ActionManager.w3b)return!0;a=this.yRb.WSc(c,b);a.BE&&(a=this.yRb.WSc(a.Hm,b));if(void 0!==a.fL&&null!==a.fL)return a.fL;c===G.a.e6a&&b&&(a.rd=b);return 32===this.LMa.La(a.Hm,1,a.rd)}clearCache(){this.yRb.clearCache()}}Object(n.a)(KF,"GeneralCuiUser",null,[1270,1331]);class LF{constructor(a,b,c,f){this.oqf=a;this.mia=b;this.vwc=
c;this.Q3a=f}W6f(){let a;a=this.Q3a.nhj(this.oqf);return{returnValue:this.Q3a.DTc(this.oqf),Idh:a}}vsh(a,b){if(this.mia){var c=new K.DictionaryPropertySet;this.vwc.execute(f=>{f.G3b(a)});c.setValue(Za.a.kt,a);c.setValue(R.a.instance.ga(20)?Va.a.noProof:Yd.a.Twa,b);b=new qf.GraphTransaction(15);b.set(Pc.App.lP.kV);this.mia.$U(c);b.dispose()}}}Object(n.a)(LF,"LanguageEditor",null,[383]);var ui=d(212);class Xq{constructor(a=!1,b=0){this.Jxd=null;this.uFd=Xq.M7f(Xa.a.p8i());this.XAc=new Gr.a;this.Gqa=
[];this.Ppb=new Ua.a;this.Lmf=a;this.Mmf=0>=b?7:b;this.Kmf=this.FJd=0;this.ydf=!1;a&&(this.EGj(),u.AFrameworkApplication.vga(()=>{this.g5j()}))}get languages(){return this.uFd}EGj(){for(var a of this.uFd)this.XAc.$(a.LCID,a);a=[];try{var b=ui.a.get("RecentlyUsedLcids");if(b&&""!==b){const f=decodeURIComponent(b).split(",").slice(0,this.Mmf);for(const l of f){let w;({value:w}=this.XAc.Tf(parseInt(l))).returnValue&&a.push(w)}}}catch(f){ka.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
f.message),Array.clear(a)}if(a.length)for(var c of a)b=c.LCID,this.Ppb.contains(b)||(this.Gqa.push(c),this.Ppb.add(b));else c=u.AFrameworkApplication.lcid,({value:b}=this.XAc.Tf(c)).returnValue&&(this.Gqa.push(b),this.Ppb.add(c));this.yoh()}yoh(){const a=Ma.toArray(Ma.select(Ma.asEnumerable(this.Gqa),b=>b.LCID)).join(",");ui.a.aK("RecentlyUsedLcids",a,180)}rHk(a,b){if(a&&!(0<a.options.length)){var c=-1,f=Xq.M7f(this.Gqa);this.Lmf&&0<f.length&&(c=Xq.nBf(f),c=Xq.Ktf(a,c,b),a.add(Xq.hli(),null));this.Jxd||
(this.Jxd=Xq.nBf(this.uFd));b=Xq.Ktf(a,this.Jxd,b);-1===c&&(c=b);a.selectedIndex=c}}Jcl(a,b){if(this.Lmf&&({value:c}=this.XAc.Tf(a)).returnValue){b=a!==b;if(this.Ppb.contains(a))a=Array.indexOf(this.Gqa,c),0<=a&&(Array.removeAt(this.Gqa,a),this.Gqa.push(c)),b&&this.FJd++;else{this.Ppb.add(a);this.Gqa.push(c);if(this.Gqa.length>this.Mmf){var c=this.Gqa.shift();this.Ppb.remove(c.LCID)}b&&this.Kmf++}this.yoh()}}g5j(){const a=this.FJd+this.Kmf;!this.ydf&&0<a&&(ka.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.FJd/a),this.ydf=!0)}static nBf(a){return Ma.toArray(Ma.select(Ma.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static hli(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static Ktf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static M7f(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(n.a)(Xq,"LanguageListHelper",null,[1326]);var KA=d(242);class Nt extends KA.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(n.a)(Nt,"NumberButtonProps",KA.a,[]);class Kr{static get xql(){return Kr.vpf||(Kr.vpf=
Ab.a.instance.rb("Box4.ISpacingCommands"))}static get gvh(){return!!Kr.xql}static wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.OJa,Cb.a.view,Kr.OJa);a.le(D.a.OJa,1126)}static OJa(a,b,c,f,l){if(1===c||!Kr.gvh)return Kr.gvh?32:8;if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp)a=[],a.push(Object.assign(new Nt,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new Nt,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new Nt,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new Nt,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new Nt,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new Nt,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=tj.d(a);else{a=tj.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=tj.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=tj.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=tj.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const w=tj.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),H=tj.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),U=tj.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=tj.c("LineSpacing.Menu.Controls",[a,b,c,f,w,H,U]);a=tj.e("msLineSpacing",a,"Menu");a=tj.f([a]);l.PopulationXML=a}return 32}}Kr.vpf=null;Object(n.a)(Kr,"LineSpacingRibbonMenu",null,[]);var EP=d(1122),FP=d(933);const GP=(a,b,c)=>{if(1===
c)return 32;a=Pc.App.Kb.notificationBar.LCa("Automation test",!1);a.image=3;Pc.App.Kb.notificationBar.$h(a);return 32},IP=(a,b,c,f,l)=>{let w;if(!({EJh:w}=HP(l)).returnValue)return 16;sj.UISurfaces.oL().then(H=>{let U=null;var ja=Object.assign(new EP.a,{label:"OK",onExecute:()=>{U&&H.removeNotification(U)}});ja=Object.assign(new FP.a,{target:"#"+O.AppFrame.Nmh,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:ja,useTeachingStyles:w});ja=H.callout(ja);U=H.addNotification(ja);
return null},H=>{ka.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null});return 32},HP=a=>{let b;b=!1;if(!a)return{returnValue:!1,EJh:b};b=Boolean.parse(a);return{returnValue:!0,EJh:b}};class LA{constructor(a){this.YH=a}nPb(a){this.YH&&this.YH.rG(a)}}Object(n.a)(LA,"RibbonButtonUpdater",null,[1325]);var MF=d(295);class MA{constructor(){this.c7=this.Da=null}get name(){return"Box4.UI"}Zb(a){this.Da=a;a.register(1268,"Common.IReactContextualUILauncher").ma().oa(()=>
new DF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(1269,"Box4.IContextMenuController").ma().oa(()=>new FF(a.resolve("Common.IReactContextualUILauncher")));a.register(1270,"Box4.IGeneralCuiUser").oa(()=>new KF(a.resolve("Box4.UI.CuiActionBridge"),u.AFrameworkApplication.Ta)).ma();a.register(JA,"Box4.UI.TableAltTextDialogFactory").ma().oa(()=>new JA(a.resolve("Box4.ITableEditor"),new MF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(383,"Box4.UI.ILanguageEditor").oa(()=>new LF(de.a.instance.Qj,a.rb("Box4.ITextFormattingCommands"),a.Ja("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(1271,"Box4.UI.IAutoCorrectOptionsDialog").oa(()=>new GF(a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(Xq,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().oa(()=>new Xq(u.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(EF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(GA,"Box4.UI.DefaultProofingContextMenuCreator").ma().oa(()=>new GA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(HA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().oa(()=>new HA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(LA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().oa(()=>new LA(this.Da.resolve("Box4.IAppFrame")))}init(){var a=Pc.App.Kb;const b=a.hb;Ir.UEj(Object(F.a)(b,b.ekc,"onAuthenticationLost"),Object(F.a)(b,b.fkc,"onAuthenticationRestored"),a.Cqi);Jr.a.wb();a=u.AFrameworkApplication.Ta;a.ya(D.a.IKk,Cb.a.application,AP);a.ra(D.a.cml,Cb.a.application,BP,96);a.ra(D.a.Eml,Cb.a.application,CP,96);a=u.AFrameworkApplication.Ta;a.ra(D.a.sol,Cb.a.application,GP,96);a.ra(D.a.Sll,Cb.a.application,
IP,96);Kr.wb();this.c7=this.Da.rb("Box4.IContextMenuController")}dispose(){this.c7&&(this.c7.dispose(),this.c7=null)}static main(){v.a.instance.Dc(new MA,6)}}Object(n.a)(MA,"Box4UIPackage",null,[2,3]);var NF=d(461),JP=d(884),Fs=d(203),KP=d(545),mv=d(376),Tm=d(316),jj=d(74);class OF{constructor(a){this.zna=a}}Object(n.a)(OF,"ValidParentData",null,[]);var Dy=d(370),LP=d(817),nv=d(293),PF=d(816),ov=d(607),ym=d(247),QF=d(357),sq=d(227);class RF{constructor(){this.Kub=0}}Object(n.a)(RF,"BelowOutlineElementData",
null,[]);var Gs=d(420),MP=d(595),NP=d(479);class SF extends Gs.a{constructor(a,b,c,f){super(4,f);this.cRh=a;this.Ywd=b;this.syd=c}get lNc(){return this.cRh}get oYb(){return this.Ywd}get SSd(){return this.syd}Rxb(){var a=this.lNc;if(!a)return ka.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new MP.a(this.lNc.id,this.lNc.lo,this.oYb?this.oYb.id:null);""!==a.characterData&&a.characterData&&(a=new NP.DeleteTextUpdateHint(this.lNc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(n.a)(SF,"DeleteParagraphOperation",Gs.a,[]);var OP=d(594),PP=d(478);class NA extends Gs.a{constructor(a,b,c,f,l){super(3,l);this.KHd=a;this.LHd=b;this.jVb=f}get hJa(){return this.KHd}get eHb(){return this.LHd}get $Ia(){return this.jVb}Rxb(){const a=[];var b=new OP.AddParagraphUpdateHint(this.$Ia.id,this.$Ia.lo,this.hJa?this.hJa.id:null);Array.add(a,b);""!==this.$Ia.characterData&&this.$Ia.characterData&&(b=new PP.a(this.$Ia.id,0,this.$Ia.characterData),
Array.add(a,b));return a}}Object(n.a)(NA,"InsertNewParagraphOperation",Gs.a,[]);var QP=d(593);class TF extends Gs.a{constructor(a,b,c,f){super(2,f);this.KHd=a;this.LHd=b;this.EXh=c}get hJa(){return this.KHd}get eHb(){return this.LHd}get PZg(){return this.EXh}Rxb(){const a=[],b=new QP.MergeParagraphUpdateHint(this.hJa.id,this.hJa.lo,this.hJa.characterData.length,this.eHb.id,this.eHb.lo,this.PZg.id,this.PZg.lo);Array.add(a,b);return a}}Object(n.a)(TF,"MergeParagraphOperation",Gs.a,[]);var RP=d(592);
class UF extends Gs.a{constructor(a,b,c,f,l){super(1,l);this.NHd=a;this.T1h=b;this.Ywd=c;this.syd=f}get iJa(){return this.NHd}get oYb(){return this.Ywd}get SSd(){return this.syd}get Wql(){return this.T1h}Rxb(){const a=[],b=new RP.a(this.iJa.id,this.iJa.lo,this.Wql,this.oYb.id,this.oYb.lo,this.SSd.id,this.SSd.lo);Array.add(a,b);return a}}Object(n.a)(UF,"SplitParagraphOperation",Gs.a,[]);var VF=d(319);class Xj{constructor(a,b,c,f,l,w=null){this.ap=this.fd=null;this.Ux=a;this.Zo=b;this.Wg=c;this.BQh=
f;this.BXh=l;this.iqa=w}Y4h(a){R.a.instance.ga(50)&&Pc.App.Jh&&Pc.App.Jh.vw&&Pc.App.Jh.aZ.mra(a)}Wjb(a,b,c){Pa.OutlineElementNavigator.oi(a);zb.ParagraphReader.el(a)?Xj.paragraphEditor.Bv.Wjb(a,b,c):hd.TableReader.eq(a)&&14===a.vi&&(b=(new nv.a(1,c)).WM,this.Jfl(Object(qa.a)(Dy.a,a.currentNode),b));Pa.OutlineElementNavigator.Re(a)}Jfl(a,b){a&&Object(Ya.a)(Dy.a,a)&&(a.$l=b)}get Bv(){return mv.a.mxb}get Sf(){return this.fd||(this.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get F6(){return this.ap||
(this.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get fq(){return this.Zo.value}get Rf(){return this.Wg.value}get HB(){return this.Ux.value}get ej(){return Kh.a.instance}OYd(){const a=KP.a.instance.createInstance(393229);a.setValue(Za.a.GE,Tm.a.first);a.setValue(Za.a.pJi,new Date);a.gvd();return a}zGi(){const a=new JP.a;a.setValue(Za.a.GE,Tm.a.first);return a}Yod(a,b,c){const f=a.Gh;if(f){f.id.equals(Xj.n9e)||(Xj.n9e=f.id,Xj.Iwc={});var l=Xj.Iwc[b];b in Xj.Iwc&&
f.T$a(l.id)&&f.hx&&f.hx.K_(l.id)||(l=new sq.a,l.setValue(Za.a.author,b),l=f.qKa(l));a.properties.setValue(c,l.id);Xj.Iwc[b]=l}}$Lb(a,b){a.properties.setValue(Za.a.lastModifiedTime,b)}Z4e(a,b=null){const c=new qf.GraphTransaction(7);c.kd(a);b||(b=new Date);this.$Lb(a,b);this.Yod(a,this.oVc(),Za.a.OZb);""===fe.OutlineElementReader.QRc(a,Za.a.oIc)&&this.Yod(a,this.oVc(),Za.a.oIc);c.dispose()}oVc(){return Pc.App.r2e.name}l1d(a,b,c=!1){if(R.a.instance.ga(56))fe.OutlineElementReader.cme(a)?(a=fe.OutlineElementReader.isRtl(a),
c?this.Hpd(b,a):this.eLa(b,a)):this.dZk(b);else if(R.a.instance.ga(26)||R.a.instance.ga(89))a=fe.OutlineElementReader.isRtl(a),c?this.Hpd(b,a):this.eLa(b,a)}wMb(a,b){var c=new ob.GraphIterator;c.set(a);c.rc(11);c=c.Jg(11);fe.OutlineElementReader.um(c)!==b&&(this.eLa(c,b),R.a.instance.ga(54)?a.anchor.Dr(4):(c=1,b&&(c=3),a.setValue(Za.a.Jl,c),a.setValue(Za.a.gJ,c)))}eLa(a,b){const c=new qf.GraphTransaction(7);c.kd(a);this.Hpd(a,b);if(R.a.instance.ga(26)){var f=new ob.GraphIterator;f.set(a);f.Bb(2)&&
zb.ParagraphReader.el(f)&&(f=f.currentNode,b?(f.we(eh.a.ild,!0),Xj.paragraphEditor.$J(f,3)):(f.removeProperty(eh.a.ild),Xj.paragraphEditor.$J(f,1)))}f=new ob.GraphIterator;f.set(a);VF.a.instance.VIj(f);if(f.rc(10)){const l=f.Jg(10);f.Bb(1)===a&&this.HB.eLa(l,b)}c.dispose()}Hpd(a,b){let c=null,f=null;if(this.Sf.hg&&a.isConnected){c=zb.ParagraphReader.hUc(a,!0,!0);f=new Ka.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).K8())}b?a.properties.setValue(Za.a.vY,!0):R.a.instance.ga(56)?a.properties.setValue(Za.a.vY,
!1):(R.a.instance.ga(26)||R.a.instance.ga(89))&&a.properties.removeProperty(Za.a.vY);if(this.Sf.hg&&c&&f)if(c.count!==f.count)ka.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}dZk(a){a.properties.removeProperty(Za.a.vY)}Hca(a,b=null,c=!1){let f=null,l=null;if(!fe.OutlineElementReader.$g(a))return ka.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var w=null;let H=null,U=0;b&&(w=b.formatting,H=b.style,U=b.languageId);c||({hJa:f,eHb:l}=this.YZf(a));b=Fs.a.instance.createInstance(393230);b.setValue(Za.a.pq,"");a.Cl(b,2);a.Pk(b);Xj.paragraphEditor.Goc(b);Xj.paragraphEditor.Pkk(b);Xj.paragraphEditor.zPb(b);this.Y4h(b);w&&(b.Ra.first.formatting.nm=w);U||(U=u.AFrameworkApplication.lcid);a.currentNode.we(Za.a.ojb,a.currentNode.sa(Za.a.ojb,U));R.a.instance.ga(54)&&a.currentNode.setValue(Va.a.Dlc,0);!R.a.instance.ga(71)||R.a.instance.ga(61)||H||
(w=mb.StyleReader.sL(b))&&(H=w.$G(mb.StyleReader.cpa));this.BQh.CVi(a);H&&Xj.jP.Eaa(H,b,!0);!c&&f&&(c=new NA(f,l,f,new ov.a(b),b.yRa),a.currentNode.YG().graphTransactionOperations.KZ(c));return b}YZf(a){let b;const c=new ob.GraphIterator;c.Rc(a);b=null;c.zjg?c.currentNode.YG().graphTransactionOperations.Ria(6):(Pa.OutlineElementNavigator.Rwa(c,!0,!1),b=this.jTc(c));c.Rc(a);a=this.K_f(c);return{hJa:b,eHb:a}}K_f(a){const b=new ob.GraphIterator;b.Rc(a);a=null;b.Izb||(Pa.OutlineElementNavigator.HJ(b,
!0,!1),a=this.jTc(b));return a}jTc(a,b=!1){a=Pa.OutlineElementNavigator.oi(a,!0);return a?this.c3f(a,b):(ka.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}c3f(a,b=!1){if(12===a.type)return b?new ov.a(a):new PF.a(a);a.YG().graphTransactionOperations.Ria(5);return new LP.a(a)}rvi(a,b){var c=b.currentNode.clone();a.xL(c,null,1);a.Pk(c);c.YZ=b.currentNode;Pa.OutlineElementNavigator.oi(b);b.XW&1&&b.currentNode.S1a(null);c=b.currentNode.clone();c.eV=b.currentNode.eV;a.xL(c,
null,2);a.Pk(c);a.uT(1);c.YZ=b.currentNode;R.a.instance.ga(55)&&c.setValue(Va.a.lo,Cf.a.a_a());b.LB(11)}Goc(a){a.Bb(2)&&a.Oi()}Gkh(a,b){const c=a.currentNode;Pa.OutlineElementNavigator.oi(a);const f=a.currentNode;Pa.OutlineElementNavigator.Re(a);b.aB(1);Pa.OutlineElementNavigator.oi(b);a.Cl(b.currentNode,2);b.Oi();var l=new ob.GraphIterator;l.Rc(b);if(l.Bb(1)){const w=new ob.GraphIterator;w.Rc(a);const H=new OF(null);if(!this.bpj(w,l.currentNode,H))return;ym.h(w,null,1,1,l,-1)}b.Oi();l=null;a.JF(1)&&
(l=a.currentNode);for(a.zc();Xg.OutlineNavigator.Y$(b);)a.xL(b.currentNode,l,1),l=b.currentNode,b.Oi();a.Pk(c);a.Pk(f);a.Oi()}wNb(a,b,c,f,l,w=!1){this.Goc(b);const H=b.vi;var U=a.currentNode;let ja=null;var wa=null;let Sa=null,eb=!1;Pa.OutlineElementNavigator.oi(a);const ub=a.vi;if(zb.ParagraphReader.el(a)){var Ub=a.currentNode;(wa=Object(qa.a)(Sd.AParagraphNode,Ub))?wa.Ra&&wa.Ra.length||ka.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",wa):ka.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");wa=new ov.a(wa);(eb=c.Qa===zb.ParagraphReader.textLength(Ub))&&(Sa=this.K_f(b));var cc=b.currentNode;ja=this.Hca(b,void 0,!0);Xj.paragraphEditor.G_e(a,b,c,l,!0,w);R.a.instance.ga(71)&&(f?(l=mb.StyleReader.aE(Ub))&&Xj.jP.Eaa(l,ja,!0):eb&&(l=mb.StyleReader.aE(Ub))&&((Ub=l.sa(eh.a.H0g,null))?(l=mb.StyleReader.sL(ja).$G(Ub),Xj.jP.Eaa(l,ja,!1)):Xj.jP.Eaa(l,ja,!0)));this.l1d(U,cc);this.fq.j1d(U,cc)}Pa.OutlineElementNavigator.Re(a);Pa.OutlineElementNavigator.Re(b);U=fe.OutlineElementReader.isEmpty(a,
!0);cc=fe.OutlineElementReader.isEmpty(b,!0);R.a.instance.ga(27)&&U&&!cc&&(b.XW&1&&(U=new QF.a,U.Rc(b),b.currentNode.S1a(U)),this.Yod(b.currentNode,fe.OutlineElementReader.QRc(a.currentNode,Za.a.OZb),Za.a.OZb),this.Yod(b.currentNode,fe.OutlineElementReader.QRc(a.currentNode,Za.a.oIc),Za.a.oIc),this.$Lb(b.currentNode,fe.OutlineElementReader.Gcj(a.currentNode)));Pa.OutlineElementNavigator.oi(a);(U=Object(qa.a)(Sd.AParagraphNode,a.currentNode))?U.Ra&&U.Ra.length||ka.ULS.sendTraceTag(38925762,307,15,
"srcParaNode: {0}. srcParaNode has no characterProperties",U):ka.ULS.sendTraceTag(38925761,307,15,"srcPara is null");U=new ov.a(U);Pa.OutlineElementNavigator.Re(a);(a=ja)?a.Ra&&a.Ra.length||ka.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(ka.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),ka.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:eb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:ub,
["destinationOutlineElementNodeType"]:H,["alwaysMoveEopToDestinationPara"]:w}));eb?(c=new NA(wa,Sa,U,new ov.a(a),a.yRa),b.currentNode.YG().graphTransactionOperations.KZ(c)):(c=new UF(wa,c.Qa,U,new ov.a(a),a.yRa),b.currentNode.YG().graphTransactionOperations.KZ(c))}EDf(a,b){Pa.OutlineElementNavigator.oi(a);let c=zb.ParagraphReader.ps(a.currentNode);const f=a.currentNode;R.a.instance.ga(14)&&(c=b?c&&!this.ej.hDk(f):c&&!this.ej.bDk(f));Pa.OutlineElementNavigator.Re(a);return c}merge(a,b,c,f,l=null,w=
!1,H=!1,U=!1){if(a.currentNode.id===b.currentNode.id)return!1;let ja,wa;var Sa=new ob.GraphIterator;Sa.Rc(b);ja=this.jTc(Sa);Sa.Rc(a);wa=this.jTc(Sa,!0);if(!this.EDf(b,!0)||!this.EDf(a,!1))return!1;if(this.Rf.enc){var eb=Object(qa.a)(Sd.AParagraphNode,a.currentNode);eb=(c||!eb||!eb.characterData.length)&&!rb.ListReader.vk(a)}else eb=this.BXh.KIl(c,a);U||this.fq.merge(a,b,eb,l);Pa.OutlineElementNavigator.oi(a);l=a.currentNode.yRa;Pa.OutlineElementNavigator.oi(b);if(zb.ParagraphReader.el(b)){if(R.a.instance.ga(50)&&
Pc.App.Jh.vw){U=b.currentNode;eb=a.currentNode;const ub=NF.CoauthLockEditor.getInstance();if(ub.RMb(this.ej.A5b(U))||ub.RMb(this.ej.A5b(eb)))return b.zc(),a.zc(),!1}U=!1;rb.ListReader.qx&&(eb=a.parentNode)&&fe.OutlineElementReader.r9(eb)&&(U=rb.ListReader.KUa(eb));R.a.instance.ga(71)&&(eb=(eb=zb.ParagraphReader.isEmpty(a)||c)&&!U)&&(eb=mb.StyleReader.d8f(b))&&Xj.jP.Eaa(eb,a.currentNode,!0);c&&this.iqa.hnk(b.currentNode,a.currentNode,U,H);c=Xj.paragraphEditor.merge(a,b,c,f,w);f=Sa.currentNode;Sa=a.currentNode;
a.zc();c&&fe.OutlineElementReader.isEmpty(b,!0)&&this.gDa(b);a=new TF(wa,ja,new PF.a(f),l);Sa.YG().graphTransactionOperations.KZ(a);return!0}b.zc();a.zc();return!1}WHj(a){const b=new ob.GraphIterator;b.set(a.node);b.Ze();Pa.OutlineElementNavigator.Re(b);const c=this.i9b(b),f=this.i9b(b);this.wNb(b,c,a,!1,!0);fe.OutlineElementReader.isEmpty(b,!1)&&(this.fq.moa(b),b.Oi());fe.OutlineElementReader.isEmpty(c,!1)&&!fe.OutlineElementReader.fbb(c)&&(this.fq.moa(c),c.Oi());return f}Gda(a,b,c,f=null,l=!1){if(!this.tqi(a))return null;
const w=a.currentNode,H=rb.ListReader.vk(a);b||l||fe.OutlineElementReader.isEmpty(a,!1);l=this.fq.fll(H);b=b?a.JF(1):a.currentNode;a.zc();c=this.HB.h9b(a,b,c,f);if(!c)return null;this.l1d(w,c);this.fq.j1d(w,c);l&&this.fq.Ryl(a,w);return c}tqi(a){return fe.OutlineElementReader.$g(a)&&(a=a.parentNode,jj.OutlineReader.F$b(a)||fe.OutlineElementReader.r9(a)||fe.OutlineElementReader.xua(a))?!0:!1}YXk(a){const b=new ob.GraphIterator;b.set(a);b.Ze();b.LB(11);let c,f;({hJa:c,eHb:f}=this.YZf(b));let l=-1;12===
a.type&&(l=a.yRa);b.currentNode.YG().graphTransactionOperations.KZ(new SF(this.c3f(a,!0),c,f,l));this.gDa(b)}gDa(a){if(a.QI(1)){const b=new RF,c=new ob.GraphIterator;c.Rc(a);this.f5i(c,b)&&this.Bv.qNc(a,-b.Kub)}a.Oi();hd.TableReader.Cs(a)&&this.XHk(a)}sfe(a,b,c){if(!jj.OutlineReader.au(a)&&!fe.OutlineElementReader.$g(a))return null;const f=this.zGi();0<c&&c<Tm.a.last&&f.setValue(Za.a.GE,Math.min(Tm.a.nil,c));a.xL(f,b,1);return f}YHj(a,b){if(!fe.OutlineElementReader.$g(a)&&!fe.OutlineElementReader.ZI(a)||
!jj.OutlineReader.gX(a.parentNode)&&!fe.OutlineElementReader.r9(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.zc();b=this.sfe(a,f,b);a.Pk(c);return b}XHk(a){fe.OutlineElementReader.ZI(a)&&(a.QI(1)||a.Oi());this.HXf(a,!1);this.gwf(a)}HXf(a,b){var c,f=null;for(c=a.Bb(1);c;){var l=!1;fe.OutlineElementReader.xua(c)&&!a.QI(1)&&(l=!0);var w=c;c=a.Fj(1);if(l)l=new ob.GraphIterator,l.set(w),l.Ze(),l.Oi();else if(fe.OutlineElementReader.xua(w)){if(f){l=new ob.GraphIterator;l.set(f);
var H=new ob.GraphIterator;H.set(w);H.Ze();l.Cl(H.currentNode,1);H.Oi();H=fe.OutlineElementReader.L3(w);H===Tm.a.nil&&(H=1);(H=Math.max(0,fe.OutlineElementReader.L3(w)-H))?w.setValue(Za.a.GE,Math.min(Tm.a.nil,H)):(l.Pk(w),a.Bb(1),ym.e(l),l.zc());b&&this.HXf(l,!0)}}else f=w}b=null;f=Tm.a.last+1;for(c=a.Bb(1);c;c=a.Fj(1))if(fe.OutlineElementReader.ZI(a))w=fe.OutlineElementReader.L3(c),f>w&&(f=w,b=c);else{a.zc();return}if(b){for(c=a.Bb(1);c;c=a.Fj(1))c!==b&&a.currentNode.setValue(Za.a.GE,Math.min(Tm.a.nil,
fe.OutlineElementReader.L3(c)-f));f+=fe.OutlineElementReader.L3(a.currentNode);a.currentNode.setValue(Za.a.GE,Math.min(Tm.a.nil,f));c=new ob.GraphIterator;c.Rc(a);c.Pk(b);c.Bb(1);ym.e(c)}}bpj(a,b,c){var f=fe.OutlineElementReader.L3(a.currentNode);if(1===f)return!0;if(fe.OutlineElementReader.ZI(a))return!1;if(!a.H8(1)||this.nSj(a,b))return a.currentNode.setValue(Za.a.GE,Math.min(Tm.a.nil,1)),!0;if(c.zna&&a.Pk(c.zna)){if(fe.OutlineElementReader.ZI(a)&&1===f+fe.OutlineElementReader.L3(a.currentNode))return c.zna=
a.aB(1),a.zc(),!0;a.zc()}if(c.zna&&a.Pk(c.zna)||!c.zna&&a.Bb(1)){if(a.currentNode!==b&&a.Cf(1)&&fe.OutlineElementReader.ZI(a)&&1===f+fe.OutlineElementReader.L3(a.currentNode))return c.zna=null,!0;a.zc()}if(a.OTa(b)&&this.mSj(a,b)){for(c=a.Bb(1);c;c=a.Fj(1))c!==b&&c.setValue(Za.a.GE,Math.min(Tm.a.nil,fe.OutlineElementReader.L3(c)+(f-1)));a.currentNode.setValue(Za.a.GE,Math.min(Tm.a.nil,1));return!0}if(1>f)return f=this.sfe(a,c.zna,1-f),a.Pk(f),c.zna=null,!0;if(1<f){a.currentNode.setValue(Za.a.GE,Math.min(Tm.a.nil,
1));b=null;let l=a.Bb(1);for(;l;){if(fe.OutlineElementReader.ZI(a)){l.setValue(Za.a.GE,Math.min(Tm.a.nil,f-1+fe.OutlineElementReader.L3(l)));l=a.Fj(1);continue}b||(b=this.YHj(a,f-1));const w=l;l=ym.j(a,b,1);l===b&&(l=a.Fj(1));c.zna===w&&(c.zna=b,b=null)}return!0}return!1}nSj(a,b){return ob.GraphIterator.Yca(()=>{if(1===a.H8(1)){const c=a.Bb(1);a.zc();if(c===b)return!0}return!1})}mSj(a,b){return ob.GraphIterator.Yca(()=>{let c;for(c=a.Bb(1);c;c=a.Fj(1))if(c!==b&&!fe.OutlineElementReader.ZI(a))return a.zc(),
!1;return!0})}f5i(a,b){b.Kub=0;do{const c=a.currentNode;if(a.Bb(1))b.Kub-=fe.OutlineElementReader.L3(c);else{if(jj.OutlineReader.au(a)||null===a.currentNode)return!1;if(3!==a.role||!a.vka(1))for(;!a.Fj(1);)if(b.Kub+=fe.OutlineElementReader.L3(a.currentNode),jj.OutlineReader.au(a)||null===a.currentNode)return!1}}while(fe.OutlineElementReader.ZI(a));return!0}i9b(a,b=!1){return this.rfe(a,!1,b)}rfe(a,b,c=!1){const f=new ob.GraphIterator;f.Rc(a);a=new ob.GraphIterator;a.Rc(f);this.Gda(a,b,!1,null,c);
a.currentNode.setValue(Za.a.GE,Math.min(Tm.a.nil,fe.OutlineElementReader.L3(f.currentNode)));f.Bb(1)&&ym.h(a,null,1,1,f,-1);return a}gwf(a){if(fe.OutlineElementReader.O2k(a)){1!==fe.OutlineElementReader.L3(a.currentNode)&&a.currentNode.setValue(Za.a.GE,Tm.a.first);for(var b=a.Bb(1);b;)if(fe.OutlineElementReader.ZI(a)){b=new ob.GraphIterator;b.Rc(a);b.zc();const c=new ob.GraphIterator;c.Rc(a);c.Bb(1);ym.h(b,a.currentNode,1,1,c,-1);b=a.vRa(1)}else this.gwf(a),b=a.Fj(1)}}static get jP(){return Xj.KK||
(Xj.KK=Ab.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set jP(a){Xj.KK=a}static get paragraphEditor(){return Xj.Yw||(Xj.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Xj.Yw=a}}Xj.KK=null;Xj.Yw=null;Xj.n9e=null;Xj.Iwc=null;Object(n.a)(Xj,"OutlineElementEditor",null,[1358]);var Ww=d(112),Xw=d(412),WF=d(598),tq=d(257);class Vn{constructor(a){this.klf=a}AGi(){const a=Fs.a.instance.createInstance(393228);a.setValue(Za.a.GE,Tm.a.first);a.setValue(Za.a.Fji,0);
a.setValue(Za.a.wx,jj.OutlineReader.ANf);(new WF.OutlineIndentInfo(!0)).Coh(a);return a}iW(a,b,c=null){const f=a.currentNode;if(!a.aB(1))return this.h9b(a,null,b,c);fe.OutlineElementReader.ZI(a)&&Pa.OutlineElementNavigator.DFe(a,!0);return fe.OutlineElementReader.$g(a)?Vn.Qh.Gda(a,!1,b,c):(a.vpc(f),null)}sqi(a){return jj.OutlineReader.vle(a.currentNode)||fe.OutlineElementReader.$g(a)||fe.OutlineElementReader.ZI(a)||Ie.isTableCell(a)}h9b(a,b=null,c=!1,f=null){if(!this.sqi(a))return null;const l=Vn.Qh.OYd();
this.Eel(l,a);a.KXc(l,b,1,this.klf.JZf());a.Pk(l);c&&(Vn.Qh.Hca(a,f),Pa.OutlineElementNavigator.Re(a));R.a.instance.ga(25)&&Vn.Qh.Z4e(a.currentNode);return l}Eel(a,b){if(b=this.Vij(b))switch(b.type){case 11:Vn.Qh.l1d(b,a,!0);break;case 8:b=Vn.Jk.isRtl(b),Vn.Qh.Hpd(a,b)}}Vij(a){return this.klf.p$d(a)}Z8i(a,b){a=Vn.Jk.LTc(a);return new Xw.a(a.x+jj.OutlineReader.ZMc*(b?-1:1),a.y+jj.OutlineReader.INf)}zpd(a){if(R.a.instance.ga(17)){var b=new ob.GraphIterator;b.set(a);b.fv();b=this.Z8i(b.origin,jj.OutlineReader.um(a));
tq.c(a,b.x,b.y)}}eLa(a,b){R.a.instance.ga(43)&&xf.c(a)||a.setValue(Za.a.gJ,b?11:9)}static get Jk(){return Ww.PageReader.instance}static get Qh(){return Vn.Fi||(Vn.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Qh(a){Vn.Fi=a}}Vn.Fi=null;Vn.Jf=null;Object(n.a)(Vn,"OutlineEditor",null,[1359]);const SP=a=>{a.register(Vn,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().oa(()=>new Vn(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(Xj,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().oa(()=>
new Xj(a.ke("Box4.IOutlineEditor"),a.ke("Box4.List.IListEditor"),a.ke("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class OA{get name(){return"Box4.OutlineLevelEditors"}Zb(a){SP(a)}init(){}dispose(){}static main(){v.a.instance.Dc(new OA)}}Object(n.a)(OA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class PA{get name(){return"Box4.TableEditors"}Zb(){}init(){}dispose(){}static main(){v.a.instance.Dc(new PA)}}
Object(n.a)(PA,"Box4TableEditorsPackage",null,[2,3]);class QA{get name(){return"Box4.TextLevelEditors"}Zb(){}init(){}dispose(){}static main(){v.a.instance.Dc(new QA)}}Object(n.a)(QA,"Box4TextLevelEditorsPackage",null,[2,3]);class Lr{constructor(a,b,c){this.PHd=this.M4a=this.MHd=this.L4a=this.LFd=null;this.uG=a;this.FRh=b;this.Tc=c;this.init()}init(){this.FRh.pb(Object(F.a)(this,this.mtj,"handleEditingViewUpdatesSafe"));this.L4a=new qd.a;this.MHd=new qd.a;this.M4a=new qd.a;this.PHd=new qj.a}h_a(a){this.L4a.add(a.key,
a)}TQe(a){this.M4a.add(a.key,a)}mtj(a){try{this.ltj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),ka.ULS.sendTraceTag(5285580,334,10,a)}}ltj(a){let b;({PZd:b}=Lr.VAl(this.Tc.Na.mb)).returnValue&&(a=Lr.D7i(a,this.LFd,b),this.tLk(a,b),this.LFd=b)}tLk(a,b){a=this.g4i(a,b);let c;({notification:c}=Lr.OAl(a)).returnValue&&this.uG.sendNotification(c,!1)}g4i(a,b){const c=new qd.a;c.$(1,new qj.a);c.$(0,new qj.a);a.forEach(f=>
{3===f?(nd.ImageReader.iH(b.node)||this.T2k(b),this.bgj(c,b)):0===f&&this.c8i(c,b);return!0});return c}T2k(a){this.L4a.forEach((b,c)=>{c.reset(a);return!0})}c8i(a,b){let c=new qd.a;nd.ImageReader.iH(b.node)||(c=this.$7i(b.Qa));this.a8i(a,this.MHd,c,Lr.wph(this.LFd,b));this.MHd=c}$7i(a){const b=new qd.a;this.L4a.forEach((c,f)=>{c=null;({KBa:c}=f.muc(a)).returnValue&&b.$(f.key,c);return!0});return b}a8i(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((w,H)=>{const U=
this.L4a.ga(w).i8||H.title;let ja;({value:ja}=c.Tf(w)).returnValue?f&&ja.bQ!==H.bQ&&(U&&a.ga(1).add(U),w=this.L4a.ga(w).i8,w=String.format(l,ja.title,w),ja.description&&(w+=", "+ja.description),a.ga(0).add(w)):U&&a.ga(1).add(U);return!0});c.forEach((w,H)=>{b.Gb(w)||(w=this.L4a.ga(w).i8,w=String.format(l,H.title,w),H.description&&(w+=", "+H.description),a.ga(0).add(w));return!0})}bgj(a,b){b=this.Xlj(b.node);b=this.owi(b);this.Ylj(a,this.PHd,b);this.PHd=b}Xlj(a){const b=new ob.GraphIterator;b.set(a);
if(!b.rc(1))return null;const c=new qj.a;for(;1!==b.vi;)this.M4a.forEach((f,l)=>{let w;({Utb:w}=l.P3e(b)).returnValue&&c.add(w);return!0}),b.zc();c.reverse();return c}owi(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.e1===a[b+1].e1&&(this.M4a.ga(c.e1),({rwi:c}={returnValue:!1,rwi:null}).returnValue)){a.splice(b,2,c);continue}b++}return new qj.a(a)}Ylj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.M4a.ga(c.ga(f).e1).ASc(c.ga(f),
b.ga(f));l&&(c.ga(f).description&&(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let w=this.M4a.ga(c.ga(l).e1).ASc(c.ga(l),null);w&&(c.ga(l).description&&(w+=", "+c.ga(l).description),a.ga(0).add(w))}for(c=f;c<b.length;c++)(f=this.M4a.ga(b.ga(c).e1).i8)&&a.ga(1).add(f)}static D7i(a,b,c){const f=new qj.a;(a=a||Lr.X8k(b,c))?(f.add(3),f.add(0)):Lr.wph(b,c)&&f.add(0);return f}static X8k(a,b){return!a||!a.node.id.equals(b.node.id)}static wph(a,b){return!a||!a.equals(b)}static VAl(a){let b;
b=null;if(!a||!(nb.SelectionEditor.ox(a)||(a=nb.SelectionEditor.Sl(a,!0,!1),nb.SelectionEditor.ox(a)||a.Ua&&nd.ImageReader.iH(a.Ua.node))))return{returnValue:!1,PZd:b};b=a.Ua;return{returnValue:!!b,PZd:b}}static OAl(a){const b=new qj.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<
b.length,notification:a}}}Object(n.a)(Lr,"AccessibilityContextManager",null,[1204]);class Yw{constructor(a,b){this.qgf=!1;this.GWb=null;this.YDc=this.CFc=!1;this.sbf=null;this.$d=a;this.xnb=b}get Lzj(){return!!this.GWb}pb(a){this.qgf||(this.xnb.Suf(Object(F.a)(this,this.uHc,"afterEditingViewValidateEventHandler")),this.qgf=!0);this.sbf=a}uHc(a,b){(b.TM||b.VU)&&this.Bqk(b.TM,b.VU)}Bqk(a,b){this.Lzj&&this.$d.Mg(this.GWb);this.CFc=this.CFc||a;this.YDc=this.YDc||b;this.GWb=new Le.a(4,1,Yw.CUi,()=>{this.sbf(this.CFc,
this.YDc);this.reset()},126);this.$d.Db(this.GWb)}reset(){this.GWb=null;this.YDc=this.CFc=!1}}Yw.CUi=100;Object(n.a)(Yw,"EditingViewOnAfterValidateEventsConsolidator",null,[1203]);class RA{constructor(){this.Da=null}get name(){return"Box4.Accessibility"}init(){Pc.App.Tyf&&this.Da.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Zb(a){this.Da=a;a.register(Yw,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().oa(()=>
new Yw(u.AFrameworkApplication.ye,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Lr,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().oa(()=>new Lr(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),de.a.instance))}static main(){v.a.instance.Dc(new RA)}}Object(n.a)(RA,"Box4AccessibilityPackage",null,[2,3]);class SA{constructor(a,b){this.Enf=a;this.J2=b;this.anf=
this.Ymf=this.Zmf=this.$mf=this.I9e=this.bnf=!0}get Yib(){return this.bnf}get FJc(){return this.I9e}get tmd(){return this.$mf}get Zoc(){return this.Zmf}get rmd(){return this.Ymf}get pSe(){return this.anf}SCf(a){if(a)for(let c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.bnf=f;break;case "CapitalizeFirstLetterOfSentences":this.I9e=f;break;case "ReplaceOrdianalsWithSuperscript":this.$mf=f;break;case "ReplaceHyphensWithDash":this.Zmf=f;break;
case "ReplaceFractionsWithFractionCharacter":this.Ymf=f;break;case "ReplaceQuoteWithSmartQuote":this.anf=this.J2&&f}}}S4i(){this.Enf.Tae("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(F.a)(this,this.fvk,"onGetRequestFinished"),8);ka.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}S6k(a){this.Enf.$sh("saveAutoCorrectOptionsSettings",
a);ka.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.SCf(a)}fvk(a){a.rm?ka.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.SCf(a),ka.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!pa.a.count(a)))}}Object(n.a)(SA,"AutoCorrectOptionsInfo",null,[547]);var Ey=d(219);class zj{static get Gzf(){zj.EQb||(zj.EQb=[],
zj.oGb(Xa.a.xe("ar-sa")),zj.oGb(Xa.a.xe("de-de")),zj.oGb(Xa.a.xe("es-es")),zj.xR(Xa.a.xe("en-029"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("en-au"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("en-bz"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("en-ca"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("en-gb"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("en-id"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("en-my"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("en-ph"),Xa.a.xe("en-us")),zj.xR(Xa.a.xe("zh-tw"),Xa.a.xe("en-us")),zj.oGb(Xa.a.xe("fr-fr")),zj.xR(Xa.a.xe("hr-ba"),Xa.a.xe("hr-hr")),
zj.xR(Xa.a.xe("it-ch"),Xa.a.xe("it-it")),zj.xR(Xa.a.xe("nb-no"),Xa.a.xe("nn-no")),zj.oGb(Xa.a.xe("nl-nl")),zj.xR(Xa.a.xe("ro-md"),Xa.a.xe("ro-ro")),zj.xR(Xa.a.xe("ru-md"),Xa.a.xe("ru-ru")),zj.xR(Xa.a.xe("sr-latn-ba"),Xa.a.xe("sr-latn-cs")),zj.xR(Xa.a.xe("sr-latn-me"),Xa.a.xe("sr-latn-cs")),zj.xR(Xa.a.xe("sr-latn-rs"),Xa.a.xe("sr-latn-cs")),zj.oGb(Xa.a.xe("sr-cyrl-cs")),zj.xR(Xa.a.xe("sv-fi"),Xa.a.xe("sv-se")));return zj.EQb}static oGb(a){zj.EQb[a.languageId]=a.LCID}static xR(a,b){zj.EQb[a.LCID]=b.LCID}static p2f(a){var b=
Xa.a.xe(a);if(!b)return 0;b=zj.Gzf[b.LCID]||zj.Gzf[b.languageId]||0;return b===a?0:b}}zj.EQb=null;Object(n.a)(zj,"AutoCorrectListFallback",null,[]);class Wn{constructor(a,b,c,f,l){this.Eff=!1;this.fif=0;this.FNa=null;this.y0h=!1;this.$hf=this.Rjf=!0;this.Vef=null;this.VAc=!0;this.Aob=a;this.GNa=b;this.c4a=c;this.p7=f;this.gh=l;this.xVb=a?a.innerText:zb.ParagraphReader.text(b)}get nx(){throw Error.notImplemented("The inherit class should have the default value.");}set nx(a){}get g2c(){return this.fif}tth(a){this.fif=
a}get mb(){return this.FNa}set mb(a){this.FNa=a}get Adg(){return this.Aob}get A$f(){return this.GNa}get tA(){return this.c4a}get yR(){return this.p7}get LGb(){return this.Rjf}set LGb(a){this.Rjf=a}get sjg(){return this.Eff}get tog(){return!1}get Rna(){return this.xVb}invoke(){this.Eff=!0;if(this.Aob&&this.Aob.parentNode&&!this.nx){var a=this.Aob.innerText;if(this.LGb&&ha.a.substring(this.xVb,this.c4a,this.p7)!==ha.a.substring(a,this.c4a,this.p7))return 0;this.h8a(this.Aob);this.tth(this.Aob.innerText.length-
a.length);return 1}this.VAc||Nc.a.instance.Xb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.$hf)return Nc.a.instance.Xb("AbortedAction",{["Reason"]:this.Vef}),0;var b=zb.ParagraphReader.text(this.GNa);a=b.length;var c=this.xVb.length,f=ha.a.substring(this.xVb,this.c4a,this.p7).trimEnd();b=ha.a.substring(b,this.c4a,this.p7).trimEnd();f===b&&this.p7>c&&(this.p7=c);if(this.LGb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===ha.a.substr(b,0,c.length))this.p7-=2;else return 0;if(R.a.instance.ga(50)&&
Pc.App.Jh.vw&&NF.CoauthLockEditor.getInstance().RMb(Wn.ej.A5b(this.GNa)))return 0;c=new qf.GraphTransaction(15);c.kd(this.GNa);c.jd=this.commandId;this.t8(this.GNa);this.tth(zb.ParagraphReader.textLength(this.GNa)-a);this.FNa&&!this.y0h&&nb.SelectionEditor.ox(this.FNa)&&(b=this.FNa.Ua,a=b.Qa,f=b.Lb,b=b.node,b===this.GNa&&this.g2c&&(a>=this.p7&&(a+=this.g2c),f>=this.p7&&(f+=this.g2c),this.FNa=Od.SelectionFactory.k3(b,a,f)));c.dispose();return 2}TJh(){this.VAc=this.kFf()}h8a(){}kFf(){var a=zb.ParagraphReader.text(this.GNa);
const b=ha.a.substring(this.xVb,this.c4a,this.p7).trimEnd();a=ha.a.substring(a,this.c4a,this.p7).trimEnd();return b===a}static get ej(){return Kh.a.instance}}Object(n.a)(Wn,"AutoCorrectAction",null,[453]);class Xn extends Wn{constructor(a,b,c,f,l,w){super(a,b,c,f,w);this.oif=null;this.kna=l;this.yV=w}get BVa(){return this.oif||(this.oif=Ab.a.instance.rb("Box4.List.IListCommands"))}get fq(){return Xn.Zo||(Xn.Zo=Ab.a.instance.resolve("Box4.List.IListEditor"))}get nx(){return!0}get commandId(){return D.a.CSd}set nx(a){super.nx=
a}}Xn.Zo=null;Object(n.a)(Xn,"RegexCorrectAction",Wn,[]);const pv={[0]:{"a)":{autonumberBulletType:2,Ui:[65533,4,41]},"a.":{autonumberBulletType:4,Ui:[65533,4,46]},"A.":{autonumberBulletType:5,Ui:[65533,3,46]},"1)":{autonumberBulletType:7,Ui:[65533,0,41]},"1.":{autonumberBulletType:8,Ui:[65533,0,46]},"i.":{autonumberBulletType:14,Ui:[65533,2,46]},"I.":{autonumberBulletType:15,Ui:[65533,1,46]}},[1]:{"*":{Ui:[8226],font:"Arial"},"-":{Ui:[45],font:"Calibri"},"--":{Ui:[167],font:"Wingdings"},">":{Ui:[216],
font:"Wingdings"},"<>":{Ui:[118],font:"Wingdings"}}};class Vo extends Xn{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w);Vo.cNa=w}get commandId(){return D.a.uSd}t8(a){if(this.BVa){var b=ob.GraphIterator.nb(a);b.Ze();Pa.OutlineElementNavigator.Re(b);var c=Vo.Rf.lw(b),f=this.kna[0];switch(ha.a.charAt(f,0)){case "*":var l=cf.a.yN(1,1);l.Ora="*";break;default:l=cf.a.yN(1,0)}c&&l.Ace(c)||(c=new qf.GraphTransaction(15),c.Iy(b),b=this.A5i(l.listType,l.listStyle,f),null!=b&&this.BVa.Rmi(b)&&(ka.ULS.sendTraceTag(509747285,
393,50,"Found list insert matching string "+f),Vo.cNa.replaceTextRange(Id.a.createTextRange(a,this.tA,this.yR+1),"",!0,!1)),c.dispose())}}A5i(a,b,c){var f;let l=null===(f=null===pv||void 0===pv?void 0:pv[a])||void 0===f?void 0:f[c];if(null==l)return null;c=new K.DictionaryPropertySet;c.setValue(Yd.a.jE,a);c.setValue(Yd.a.eea,b);c.setValue(Za.a.Ui,l.Ui);c.setValue(Za.a.font,l.font);return c}static get characterPropertiesEditor(){return Vo.cNa||(Vo.cNa=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Rf(){return Vo.Wg||
(Vo.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}static qC(a,b,c,f,l){return new Vo(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new Vo(a,Hf.a(a).gb,b,c,f,l)}}Vo.cNa=null;Vo.Wg=null;Object(n.a)(Vo,"BulletListAction",Xn,[]);class nh extends Xn{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w);this.PTb=!1;this.nx=!a;this.cNa=w;nh.pl=new Vc.a}get nx(){return this.PTb}set nx(a){this.PTb=a}h8a(a){this.tVd(a.innerText,(b,c,f)=>{a.innerText=ha.a.substring(a.innerText,0,b)+f+ha.a.right(a.innerText,c)})}t8(a){this.tVd(zb.ParagraphReader.text(a).substring(this.tA,
this.yR),(b,c,f)=>{this.cNa.replaceTextRange(Id.a.createTextRange(a,this.tA+b,this.tA+c),f,!0,!1)})}tVd(a,b){if(!(2>this.kna.length)&&this.kna[1]){var c=this.kna[1];nh.pl.count||this.bbh();nh.pl.Gb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,nh.pl.ga(c)))}}}nh.pl=null;Object(n.a)(nh,"DictionarySequenceReplacerAction",Xn,[]);class Zw extends nh{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w)}get commandId(){return D.a.PZb}bbh(){nh.pl.$("--","\u2014");nh.pl.$(" -- "," \u2013 ");nh.pl.$(" - "," \u2013 ");
nh.pl.$("-- ","\u2014");nh.pl.$(" --"," \u2013");nh.pl.$(" -"," \u2013")}static qC(a,b,c,f,l){return new Zw(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new Zw(a,Hf.a(a).gb,b,c,f,l)}}Object(n.a)(Zw,"DashAction",nh,[]);class Ot extends nh{constructor(a,b,c,f,l,w,H){super(a,b,c,f,l,w);this.Ca=H}get commandId(){return D.a.wSd}bbh(){nh.pl.$(":)","\ud83d\ude0a");nh.pl.$(":-)","\ud83d\ude0a");nh.pl.$(":|","\ud83d\ude10");nh.pl.$(":-|","\ud83d\ude10");nh.pl.$(":(","\ud83d\ude41");nh.pl.$(":-(","\ud83d\ude41");
nh.pl.$(";)","\ud83d\ude09");nh.pl.$(";-)","\ud83d\ude09");nh.pl.$(":D","\ud83d\ude00");nh.pl.$(":-D","\ud83d\ude00");nh.pl.$(":')","\ud83d\ude02");nh.pl.$("=D","\ud83d\ude03");nh.pl.$(":>","\ud83d\ude06");nh.pl.$(":->","\ud83d\ude06");nh.pl.$(":3","\ud83d\ude0a");nh.pl.$(":-3","\ud83d\ude0a");nh.pl.$("B-)","\ud83d\ude0e");nh.pl.$("*-*","\ud83d\ude0d");nh.pl.$(":*","\ud83d\ude19");nh.pl.$(":-*","\ud83d\ude19");nh.pl.$(":X","\ud83d\ude36");nh.pl.$(":-X","\ud83d\ude36");nh.pl.$(":O","\ud83d\ude2e");
nh.pl.$(":-O","\ud83d\ude2e");nh.pl.$(":#","\ud83e\udd10");nh.pl.$(":-#","\ud83e\udd10");nh.pl.$(":P","\ud83d\ude1b");nh.pl.$(":-P","\ud83d\ude1b");nh.pl.$(";P","\ud83d\ude1c");nh.pl.$(";-P","\ud83d\ude1c");nh.pl.$(":-/","\ud83d\ude15");nh.pl.$("$-$","\ud83e\udd11");nh.pl.$(":S","\ud83d\ude16");nh.pl.$(":-S","\ud83d\ude16");nh.pl.$(":[","\ud83d\ude1f");nh.pl.$(":-[","\ud83d\ude1f");nh.pl.$(":\u2019(","\ud83d\ude22");nh.pl.$(":'(","\ud83d\ude22");nh.pl.$("@-@","\ud83d\ude31")}t8(a){this.tVd(zb.ParagraphReader.text(a).substring(this.tA,
this.yR),(b,c,f)=>{b=Id.a.createTextRange(a,this.tA+b,this.tA+c);c={};c.MenuItemId=f;this.Ca.pi(b,D.a.HHj,2,!1,null,c,null)})}static qC(a,b,c,f,l,w){return new Ot(null,a,b,c,f,l,w)}static dQ(a,b,c,f,l,w){return new Ot(a,Hf.a(a).gb,b,c,f,l,w)}}Object(n.a)(Ot,"EmojiAction",nh,[]);class Sp{constructor(a,b,c,f){this.uK=a;this.rFc=b;this.jhf=f;this.Pz=c}Hlg(){if(!this.Pz)return!1;this.uK=this.uK.trimStart();return this.uK===this.Pz?!0:!1}$Yj(){if(!this.uK)return!1;const a=this.uK.lastIndexOf(" ");return-1!==
a&&"."===this.uK.charAt(a-1)&&"."===this.uK.charAt(a-3)?!0:!1}ZYj(){if(!this.uK)return!1;const a=this.uK.lastIndexOf(" ");return-1!==a&&"."===this.uK.charAt(this.uK.substring(0,a-1).lastIndexOf(" ")+2)?!0:!1}fSj(){return this.Hlg()&&(1===this.Pz.length&&"."===this.rFc||"."===this.uK.charAt(1))?!0:!1}gSj(){return this.Pz?0<="\\/".indexOf(this.rFc)||3===this.Pz.length&&0<="\\/".indexOf(this.Pz.charAt(1))?!0:!1:!1}gRj(){return this.Pz?0<=this.Pz.indexOf("@")?!0:!1:!1}it(){if(!this.Pz)return!1;for(const a of Sp.ibe())if(ha.a.startsWith(this.Pz+
this.rFc,a))return!0;return!1}QQj(){return this.Pz?"i"===this.Pz&&0<=Sp.quotes.indexOf(this.rFc)?!0:!1:!1}oMj(){if(!this.uK)return!1;const a=ha.a.UFa(this.uK,this.uK.length-1);if(-1!==a&&this.uK.substring(a+1,this.uK.length)===this.Pz){const b=this.uK.charAt(a-1);if(0<=Sp.nVe.indexOf(b)||0<=Sp.quotes.indexOf(b)&&0<=Sp.nVe.indexOf(this.uK.charAt(a-2)))return!0}return!1}jsi(){return!this.uK||this.$Yj()||this.fSj()||this.gSj()||this.ZYj()||this.gRj()||this.it()?!1:this.Hlg()||this.QQj()||this.oMj()?
!0:!1}static ibe(){return Sp.nif||(Sp.nif="http: https: ftp:// mailto: \\\\ www.".split(" "))}}Sp.nVe=".!?";Sp.quotes="'\"";Sp.nif=null;Object(n.a)(Sp,"FirstLetterUpperCaseRules",null,[]);class uq{constructor(a){this.Pz=a}j1i(){if(!this.Pz)return null;for(let a=0;a<uq.M9f().length;a++)if(this.Pz===uq.M9f()[a])return uq.$pj()[a];return null}static M9f(){return uq.Ycf||(uq.Ycf=["1/2","1/4","3/4"])}static $pj(){return uq.Xcf||(uq.Xcf=["\u00bd","\u00bc","\u00be"])}}uq.Ycf=null;uq.Xcf=null;Object(n.a)(uq,
"FractionsCollection",null,[]);class TA extends Wn{constructor(a,b,c,f,l,w){super(a,b,c,f,w);this.wRb=l;this.yV=w}get nx(){return!0}get commandId(){return D.a.xSd}h8a(a){a.innerText=ha.a.substring(a.innerText,0,this.tA)+this.wRb+ha.a.right(a.innerText,this.yR)}t8(a){this.yV.replaceTextRange(Id.a.createTextRange(a,this.tA,this.yR),this.wRb,!0,!1)}set nx(a){super.nx=a}static qC(a,b,c,f,l){return new TA(null,a,b,c,f,l)}}Object(n.a)(TA,"FractionsReplaceCorrectAction",Wn,[]);class Hs extends Xn{constructor(a,
b,c,f,l,w){super(a,b,c,f,l,w)}get commandId(){return D.a.zSd}t8(a){if(this.BVa){var b=ob.GraphIterator.nb(a);b.Ze();Pa.OutlineElementNavigator.Re(b);var c=this.kna[0],f=Hs.Vqk(c),l=ha.a.Nac(c.charAt(0))?4:2,w=Id.a.createTextRange(a,this.tA,this.yR+1);this.fq.aQa(a,b,l,f,w,c,this.BVa)}}static qC(a,b,c,f,l){return new Hs(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new Hs(a,Hf.a(a).gb,b,c,f,l)}static Vqk(a){if(!a)return 0;a=ha.a.rg(a);if(!ha.a.PYc(a.charAt(0)))return 0;const b=a.charCodeAt(0)-97+1;let c;
for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(n.a)(Hs,"LetterListAction",Xn,[]);class $w extends Xn{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w)}get commandId(){return D.a.aQa}t8(a){if(this.BVa){var b=ob.GraphIterator.nb(a);b.Ze();Pa.OutlineElementNavigator.Re(b);var c=this.kna[0],f=parseInt(c);if(!(99999999<=f)){var l=Id.a.createTextRange(a,this.tA,this.yR+1);this.fq.aQa(a,b,1,f,l,c,this.BVa)}}}static qC(a,b,c,f,l){return new $w(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new $w(a,
Hf.a(a).gb,b,c,f,l)}}Object(n.a)($w,"NumberListAction",Xn,[]);class Tp extends Wn{constructor(a,b,c,f,l){super(a,b,c,f,l);Tp.yV=l}get nx(){return!0}get commandId(){return D.a.ASd}h8a(){}t8(a){const b=Id.a.createTextRange(a,this.yR-2,this.yR),c=new qf.GraphTransaction(15);c.kd(a);let f=!1,l=null,w=0;for(;w<a.Ra.length;){var H=a.Ra.ga(w),U=!!H.Mo||H.Wda;let ja=!!H.fieldRangeEnd||H.E_;if(H.cp>=b.Qa){H.cp>b.Qa||!H.formatting?l=f?H.formatting:Tp.yV.rga(a,w,b.Qa,l):(l=H.formatting,ja&&(f=!1),U&&(f=!0));
w++;break}H.formatting&&(l=H.formatting);ja&&(f=!1);U&&(f=!0);w++}for(;w<a.Ra.length;){U=a.Ra.ga(w);if(U.cp>=b.Lb){if(U.cp>b.Lb||!U.formatting&&!U.Nj)f||Tp.yV.rga(a,w,b.Lb,l);f||Tp.mh.OY(l,!0);break}U.formatting&&(f||Tp.mh.OY(l,!0),l=U.formatting);H=!!U.Mo||U.Wda;U=!!U.fieldRangeEnd||U.E_;H&&(f=!0);!H&&U&&(f=!1);w++}c.dispose()}set nx(a){super.nx=a}static get mh(){return Tp.Jf||(Tp.Jf=Ab.a.instance.resolve("Box4.IFormattingEditor"))}static qC(a,b,c,f){return new Tp(null,a,b,c,f)}}Tp.yV=null;Tp.Jf=
null;Object(n.a)(Tp,"OrdinalsReplaceCorrectAction",Wn,[]);class tl extends Xn{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w);tl.Opb||tl.jsl();this.cNa=w}get commandId(){return D.a.BSd}t8(a){if(!a.Tyj){var b=this.FNa.Ua.node===a,c=-1,f=3;this.kna[2]&&(c=parseInt(this.kna[2]));this.kna[1]&&(f=parseInt(this.kna[1]));if(!(20<c||100<f)){a.YG().graphTransactionOperations.Ria(7);var l=ob.GraphIterator.nb(a);l.Ze();Pa.OutlineElementNavigator.Re(l);tl.Qh.Gda(l,!1,!1);tl.Qh.Hca(l);for(let U=0;U<f;++U){const ja=
[];var w=U%tl.Opb.length,H=0<c?c:tl.Opb[w].length;for(let wa=0;wa<H;++wa)Array.add(ja,tl.Opb[w][wa%tl.Opb[w].length]);w=Id.a.Mj(l.currentNode,0);H=Kb.a.xs(w);2!==Pc.App.mode?tl.mh.h0a(H,1142):tl.mh.Cm(H,Va.a.noProof,!0);this.cNa.replaceTextRange(w,ja.join(" "),!0,!1);U<f-1&&(Pa.OutlineElementNavigator.Re(l),tl.Qh.Gda(l,!1,!1),tl.Qh.Hca(l))}c=l.currentNode;l=ob.GraphIterator.nb(a);l.Ze();Pa.OutlineElementNavigator.Re(l);l.Oi();b&&(this.FNa=Od.SelectionFactory.Sg(c,zb.ParagraphReader.textLength(c)))}}}static get Qh(){return tl.Fi||
(tl.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get mh(){return tl.Jf||(tl.Jf=Ab.a.instance.resolve("Box4.IFormattingEditor"))}static jsl(){tl.Opb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static qC(a,b,c,f,l){return new tl(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new tl(a,Hf.a(a).gb,b,c,f,l)}}tl.Opb=null;tl.Fi=null;tl.Jf=null;Object(n.a)(tl,"RandAction",Xn,[]);class XF{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.wBj=b;this.Vqj=c;this.flags=f}}Object(n.a)(XF,"RegexAutoCorrectEntry",null,[]);class mn extends Xn{constructor(a,b,c,f,l,w){super(a,b,c,f,l,w)}get commandId(){return D.a.DSd}t8(a){if(this.BVa){var b=
ob.GraphIterator.nb(a);b.Ze();Pa.OutlineElementNavigator.Re(b);var c=this.kna[0],f=ha.a.substring(c,0,c.indexOf("."));f=mn.Wqk(f);if(!(0>=f)){var l=ha.a.Nac(c.charAt(0))?5:3,w=Id.a.createTextRange(a,this.tA,this.yR+1);this.fq.aQa(a,b,l,f,w,c,this.BVa)}}}static qC(a,b,c,f,l){return new mn(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new mn(a,Hf.a(a).gb,b,c,f,l)}static OTi(){mn.Mqa||(mn.Mqa={},mn.Mqa.M=1E3,mn.Mqa.D=500,mn.Mqa.C=100,mn.Mqa.L=50,mn.Mqa.X=10,mn.Mqa.V=5,mn.Mqa.I=1)}static Wqk(a){if(!a)return 0;
mn.OTi();a=ha.a.RB(a);let b=0,c=0;for(let f=a.length-1;0<=f;f--){const l=mn.Mqa[ha.a.charAt(a,f).toString()];c=l<b?c-l:c+l;b=l}return c}}mn.Mqa=null;Object(n.a)(mn,"RomanListAction",Xn,[]);class ax extends Wn{constructor(a,b,c,f,l,w){super(a,b,c,c+1,w);this.yV=w;this.x3h=f;this.I$e=l;this.LGb=!1}get nx(){return!1}get commandId(){return D.a.bii}h8a(a){a.innerText=ha.a.substring(a.innerText,0,this.tA)+this.I$e+ha.a.right(a.innerText,this.yR)}t8(a){this.yV.replaceTextRange(Id.a.createTextRange(a,this.tA,
this.yR),this.x3h,!0,!1);this.yV.replaceTextRange(Id.a.createTextRange(a,this.tA,this.tA+1),this.I$e,!0,!1)}set nx(a){super.nx=a}static qC(a,b,c,f,l,w){if("'"!==c&&'"'!==c)return null;var H=ob.GraphIterator.nb(a);H.Ze();Pa.OutlineElementNavigator.Re(H);if(fe.OutlineElementReader.um(H.currentNode))return null;f=!b||ha.a.rne(f)||-1!==Array.indexOf(ax.aBk,f);H="'"===c;return new ax(w,a,b,c+"",f?H?"\u2018":"\u201c":H?"\u2019":"\u201d",l)}}ax.aBk=["[","{","("];Object(n.a)(ax,"SmartQuoteCorrectAction",
Wn,[]);class Is extends Wn{constructor(a,b,c,f,l,w){super(a,b,c,f,w);this.wRb=l;this.yV=w}get nx(){return Is.PTb}set nx(a){Is.PTb=a}get commandId(){return D.a.FSd}TJh(){this.VAc=this.kFf();this.VAc||(this.$hf=!1,this.Vef="MatchTextIsNotTheSame")}h8a(a){a.innerText=ha.a.substring(a.innerText,0,this.tA)+this.wRb+ha.a.right(a.innerText,this.yR)}t8(a){this.yV.replaceTextRange(Id.a.createTextRange(a,this.tA,this.yR),this.wRb,!0,!1)}static dQ(a,b,c,f,l){const w=Hf.a(a);return new Is(a,w?w.gb:null,b,c,f,
l)}static qC(a,b,c,f,l){return new Is(null,a,b,c,f,l)}}Is.PTb=!1;Object(n.a)(Is,"StringReplaceCorrectAction",Wn,[]);class Fy extends Wn{constructor(a,b,c,f,l,w,H,U){super(a,b,c,f,l);this.yV=l;this.DD=w;this.nVh=H;this.JD=U}get nx(){return!0}get commandId(){return D.a.HSd}h8a(a){let b=ha.a.substring(a.innerText,this.tA,this.yR);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=ha.a.substring(a.innerText,0,this.tA)+b+ha.a.right(a.innerText,this.yR)}t8(a){const b=
this.tA,c=this.tA+1,f=a.characterData.substring(b,c).charAt(0);ha.a.Nac(f)||(a=Id.a.createTextRange(a,b,c),this.FMj(a)||this.yV.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}FMj(a){return this.nVh?!!this.DD&&this.DD.uua(a):!1}set nx(a){super.nx=a}static dQ(a,b,c,f){const l=Hf.a(a);return new Fy(a,l?l.gb:null,b,c,f,null,!1,null)}static qC(a,b,c,f,l,w,H){return new Fy(null,a,b,c,f,l,w,H)}}Object(n.a)(Fy,"UpperFirstLetterAutoCorrect",Wn,[]);class Mr{constructor(a,b){this.jhf=b;this.Pz=a}QJl(){const a=
Number.parseInvariant(this.Pz.substring(0,this.Pz.length-2));switch(Number.parseInvariant(this.Pz.charAt(this.Pz.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}qSj(){var a=Xa.a.xe(this.jhf);if(!a||!a.name.toLowerCase().startsWith("en")||!this.Pz||2>=this.Pz.length)return!1;for(a=0;a<Mr.yVc().length;a++)if(this.Pz.toLowerCase().endsWith(Mr.yVc()[a])){if(RegExp("^\\d+$").test(this.Pz.substr(0,
this.Pz.length-2))){const b=this.QJl();if(this.Pz.toLowerCase().endsWith(Mr.yVc()[a])&&b===Mr.yVc()[a])return!0}break}return!1}static yVc(){return Mr.Xkf||(Mr.Xkf=["st","nd","rd","th"])}}Mr.Xkf=null;Object(n.a)(Mr,"ValidateOrdinalsRule",null,[]);class Um{constructor(a,b,c,f,l,w,H){this.K4a=[];this.enb=[];this.DQb=[];this.fyd=[];this.mqa=-1;this.qef=this.J2=this.xyc=!1;this.Gzc=a;this.gh=b;this.DD=c;this.Ca=f;this.$R=w;this.JD=H;l?(this.xyc=l.ka("WordEditorEmoticonAutoCorrectIsEnabled")||l.ka("OneNoteInsertEmojiIsEnabled"),
this.J2=l.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.qef=l.ka("HyperlinkUrlValidationIsEnabled"),ka.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.xyc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.J2})):(ka.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.J2=this.xyc=!1)}Qje(a){return 0<=Um.vSd.indexOf(a)}PXj(a){return 0<=Um.GSd.indexOf(a)}Nkg(a){return a.toLowerCase()===a}Nac(a){return a.toUpperCase()===
a}PYc(a){return a.toLowerCase()!==a.toUpperCase()}wOj(a,b,c,f){return(new Sp(a,b,c,f)).jsi()}o8i(a){do{if(a.getAttribute("xml:lang"))return Xa.a.xe(a.getAttribute("xml:lang"))||Xa.a.s9b;if(a.getAttribute("lang"))return Xa.a.xe(a.getAttribute("lang"))||Xa.a.s9b;a=a.parentNode}while(a&&1===a.nodeType);return Xa.a.s9b}Z6d(a){return Xa.a.xe(Kb.a.language(Kb.a.xs(a)))||Xa.a.s9b}sQc(a,b){0>b&&(b=0);let c=-1;const f=Um.vSd.length;for(let l=0;l<f;++l){const w=a.lastIndexOf(ha.a.charAt(Um.vSd,l),b);w>c&&(c=
w)}a=ha.a.UFa(a,b);a>c&&(c=a);return c}RYi(a){for(let b=0;b<a.length;++b)if(this.PYc(ha.a.charAt(a,b)))return b;return-1}bXf(a,b){if(!a||0>b)return-1;let c=b;c=c?this.sQc(a,c-1):-1;c=c>ha.a.UFa(a,b-1)?c:ha.a.UFa(a,b-1);c++;return c}VWf(a,b,c){if(!R.a.instance.ga(70))return null;this.G3b(b);if(!this.enb[b])if(b=zj.p2f(b),0<b){if(this.G3b(b),!this.enb[b])return null}else return null;if(c&&this.DQb[b]&&Array.contains(this.DQb[b],a+c))return null;c=this.enb[b][ha.a.rg(a)];if("string"!==typeof c||c===
a)return null;if(c){var f=this.RYi(a);if(0>f||this.Nkg(ha.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=ha.a.charAt(a,f);b&&!this.Nac(l)&&(b=!1)}return b?ha.a.RB(c):ha.a.RB(ha.a.substring(c,0,1))+ha.a.right(c,1)}return null}ZYi(a,b,c,f){fd.a.mark(4666);const l=this.o8i(b).LCID;let w=0,H=a;const U=b.innerText;if(this.gke(U.substring(U.lastIndexOf(" ",a)+1,a)))return fd.a.mark(4667),null;let ja=null;var wa=!1;do{H=H?this.sQc(U,H-1):-1;if(-1===H&&!c){wa=b;var Sa=null;if(!this.Qje(U.charAt(0))){do{for(;wa&&
!wa.previousSibling;)wa=wa.parentNode;wa&&(wa=wa.previousSibling,Sa=wa.innerText)}while(wa&&!Sa);if(wa&&Sa&&!this.Qje(ha.a.charAt(Sa,Sa.length-1)))return fd.a.mark(4667),null}wa=!0}Sa=ha.a.substring(U,H+1,a);++w;var eb=this.VWf(Sa,l,f.toString());if(eb)ja=Is.dQ(b,H+1,a,eb,this.gh);else for(eb=0;eb<this.K4a.length;++eb){const ub=this.K4a[eb];if(!(ub.flags&1&&!(c&&1>H)||ub.flags&4||ub.flags&2&&" "!==f)){const Ub=ub.pattern.exec(Sa);if(Ub){ja=ub.wBj(b,H+1,a,Ub,this.gh,this.Ca);break}}}}while(!wa&&!ja&&
w<Um.$Yg&&0<=H);fd.a.mark(4667);return ja}VYi(a,b,c){const f=a.node;let l=zb.ParagraphReader.text(f);0>b&&(b=a.Qa);a=this.Z6d(a).LCID;if(this.gke(l.substring(ha.a.UFa(l,b)+1,b)))return null;var w=-1,H=vb.HyperlinkReader.T5b(f);for(var U=0;U<H.length;U++)if(b>H[U].Lb)w=H[U].Lb;else{if(b>H[U].Qa)return null;break}H=null;U=(U=b)?this.sQc(l,U-1):-1;U<w&&(U=w-1);w=ha.a.substring(l,U+1,b);w=w.trimStart();if(1>U)for(let ja=0;ja<this.K4a.length;++ja){const wa=this.K4a[ja];let Sa=l;" "!==c&&(Sa=l+c);if(wa.pattern.exec(Sa))return null}l=
l.substring(0,b);if(!this.wOj(l,c.toString(),w,a))return null;w.charAt(0).toUpperCase()!==w.charAt(0)&&(H=Fy.qC(f,U+1,b,this.gh,this.DD,R.a.instance.ga(14),this.JD));return H}zWf(a,b,c){a=Od.SelectionFactory.uj(a,!1);if(!a)return null;a=a.Ye;return nb.SelectionEditor.Tg(a)?this.VYi(a,b,c):null}gke(a){return ha.a.n9(a)}f4d(a,b,c,f){fd.a.mark(4666);const l=a.node,w=this.Z6d(a).LCID,H=zb.ParagraphReader.text(l);0>b&&(b=a.Qa);if(c&&!this.Qje(ha.a.charAt(H,b))||this.gke(H.substring(ha.a.UFa(H,b)+1,b)))return fd.a.mark(4667),
null;a=-1;c=vb.HyperlinkReader.T5b(l);for(var U=0;U<c.length;U++)if(b>c[U].Lb)a=c[U].Lb;else{if(b>c[U].Qa)return null;break}c=0;U=b;let ja=null;do{U=U?this.sQc(H,U-1):-1;U<a&&(U=a-1);const Sa=ha.a.substring(H,U+1,b);++c;var wa=this.VWf(Sa,w,f==A.a.xMa?".":null);if(wa)this.$R.Yib&&(ja=Is.qC(l,U+1,b,wa,this.gh));else for(wa=0;wa<this.K4a.length;++wa){const eb=this.K4a[wa];if(!(eb.flags&1&&!(0>U)||eb.flags&4&&f!==A.a.tq||eb.flags&2&&f!==A.a.pP)){const ub=eb.pattern.exec(Sa);if(ub){ja=eb.Vqj(l,U+1,b,
ub,this.gh,this.Ca);if(ja.commandId!==D.a.PZb&&!this.$R.Yib||ja.commandId===D.a.PZb&&!this.$R.Zoc)ja=null;break}}}}while(0<=U&&U>=a&&!ja&&c<Um.$Yg);fd.a.mark(4667);return ja}yWf(a,b,c){a=Od.SelectionFactory.uj(a,!1);if(!a)return null;a=a.Ye;return nb.SelectionEditor.Tg(a)?this.f4d(a,b,!1,c):null}FWf(a,b){a=Od.SelectionFactory.uj(a,!1);if(!a)return null;a=a.Ye;if(!nb.SelectionEditor.Tg(a)||vb.HyperlinkReader.bla(a,!1))return null;var c=zb.ParagraphReader.text(a.node);const f=0<b?ha.a.UFa(c,b-1)+1:
ha.a.UFa(c,c.length-1)+1;b=0<b?b:c.length;c=ha.a.substring(c,f,b);return!c||this.qef&&!vb.HyperlinkReader.lne(c)||!ha.a.n9(c)&&!ha.a.T9b(c)||!Um.hyperlinkEditor.TYk(a,f,b)?null:this.Gzc.fFi(a.node,f,b)}JWf(a,b){var c=Od.SelectionFactory.uj(a,!1);if(!c)return null;var f=c.Ye;if(!nb.SelectionEditor.Tg(f))return null;0>b&&(b=f.Qa);var l=zb.ParagraphReader.text(f.node);c=this.bXf(l,b);const w=Um.GSd.length;for(let H=0;H<w;++H){const U=l.lastIndexOf(ha.a.charAt(Um.GSd,H),b-1);U>c&&(c=U+1)}l=ha.a.substring(l,
c,b);if(!l)return null;f=this.Z6d(f).LCID;return(new Mr(l,f)).qSj()?Tp.qC(a,c,b,this.gh):null}xWf(a,b){var c=Od.SelectionFactory.uj(a,!1);if(!c)return null;c=c.Ye;if(!nb.SelectionEditor.Tg(c))return null;0>b&&(b=c.Qa);var f=zb.ParagraphReader.text(c.node);c=this.bXf(f,b);f=ha.a.substring(f,c,b);return f?(f=(new uq(f)).j1i())?TA.qC(a,c,b,f,this.gh):null:null}EZi(a,b,c,f,l){var w=Od.SelectionFactory.uj(a,!1);if(!w)return null;w=w.Ye;if(c>b||!nb.SelectionEditor.Tg(w))return null;0>b&&(b=w.Qa);if(0>b)return null;
w=zb.ParagraphReader.text(w.node);return ax.qC(a,c,l,b?w.charAt(b-1):"\x00",this.gh,f)}RBa(a,b,c,f){Array.add(this.K4a,new XF("^"+a+"$",b,c,f))}IEe(a){if(this.enb[this.mqa]){const b=this.enb[this.mqa];for(let c in a)b[c]=a[c]}else this.enb[this.mqa]=a}JEe(a){this.DQb[this.mqa]?Array.addRange(this.DQb[this.mqa],a):this.DQb[this.mqa]=a}USe(){this.mqa=-1}ESd(){this.VSi(this.mqa);this.mqa=-1}b1j(a,b){this.fyd[b]||(this.fyd[b]=!0,this.mqa=b,b=document.createElement("script"),b.type="text/javascript",b.src=
a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}VSi(a){a=zj.p2f(a);0<a&&this.G3b(a)}l1j(){R.a.instance.ga(70)&&(this.G3b(1033),this.RBa("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",tl.dQ,tl.qC,5),this.RBa("(\\d+)[\\.|\\)]",$w.dQ,$w.qC,3),this.RBa("(L|l|C|c|D|d|M|m){1}\\.",Hs.dQ,Hs.qC,3),this.RBa("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",mn.dQ,mn.qC,11),this.RBa("([A-Za-z]){1}[\\.|\\)]",Hs.dQ,Hs.qC,
3),this.RBa("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",Vo.dQ,Vo.qC,3),this.RBa("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Zw.dQ,Zw.qC,0),this.xyc&&(this.RBa("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Ot.dQ,Ot.qC,0),this.RBa("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Ot.dQ,Ot.qC,0)))}G3b(a){this.fyd[a]||this.b1j(Ey.a.aki(String.format("Acl/Acl{0}.js",a)),a)}static get hyperlinkEditor(){return Um.zn||(Um.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}}Um.vSd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";
Um.GSd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Um.nVe=".!?";Um.$Yg=5;Um.zn=null;Object(n.a)(Um,"AutoCorrectRules",null,[546]);class UA{constructor(a,b,c,f,l,w){this.pqa=this.qF=null;this.oK=a;this.Tc=b;this.nd=c;this.M8e=f.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.P8e=f.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.J2=f.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.Sba=l;this.Tza=!!w;this.Xs=w;this.x_h=new Gr.a;this.Tza&&this.Tc.KG(Object(F.a)(this,
this.EHb,"onSetSelectionFinished"))}puc(a,b,c=-1){if(this.Sba.Yib||this.Sba.Zoc)if(b=this.oK.FWf(a,c)||this.oK.yWf(a,c,b))this.qF||(this.qF=new qg),this.qF.ya(b);this.M8e&&this.Sba.FJc&&(b=this.oK.zWf(a,c," "))&&(this.qF||(this.qF=new qg),0<this.qF.YFa&&(this.qF.jta(0).nx=!0,b.LGb=!1),this.qF.ya(b));this.P8e&&(this.Sba.tmd&&4!==Pc.App.mode&&(b=this.oK.JWf(a,c))&&(this.qF||(this.qF=new qg),this.qF.ya(b),ka.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.Sba.rmd&&
(a=this.oK.xWf(a,c))&&(this.qF||(this.qF=new qg),this.qF.ya(a),ka.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}jKf(a,b,c,f,l,w){const H=new qg;if(0<b){if(!this.M8e&&this.Sba.Yib){var U=this.oK.ZYi(c,f,l,w);U&&H.ya(U)}else{if(this.Sba.Yib||this.Sba.Zoc)if(U=0," "===w?U=A.a.pP:"."===w&&(U=A.a.xMa),U=this.oK.yWf(a,b,U))U.nx=!0,H.ya(U);this.Sba.FJc&&(U=this.oK.zWf(a,b,w))&&(0<H.YFa&&(U.LGb=!1),H.ya(U))}this.P8e&&(this.Sba.tmd&&4!==Pc.App.mode&&(U=this.oK.JWf(a,b))&&(H.ya(U),
ka.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.Sba.rmd&&(U=this.oK.xWf(a,b))&&(H.ya(U),ka.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===w||'"'===w)&&this.J2&&this.Sba.pSe&&(U=this.oK.EZi(a,b,c,f,w))&&(H.ya(U),ka.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."));for(let ja of this.x_h.values)if((U=ja.jKf(a,b,c,f,l,w))&&!U.isEmpty())for(let wa=0;wa<U.YFa;wa++)H.ya(U.jta(wa));return H}fEe(a,b){return this.oK.FWf(a,
b)}Ooh(a){this.qF||(this.qF=new qg);this.qF.ya(a)}vJj(a){if(this.qF){var b=!1;for(var c=0;c<this.qF.YFa;c++){var f=this.qF.jta(c);if(!f)return;if(!f.sjg){b=!0;break}}if(b){b=this.pqa=null;c=new qf.GraphTransaction(15);c.jd=a;a=!1;for(f=0;f<this.qF.YFa;f++){let l=this.qF.jta(f);if(!l)return;if(l.sjg)continue;this.Tza&&l.nx&&l.tog&&(b=l);a||(a=!0,c.kd(l.A$f));l.mb=this.Tc.Na.mb;const w=this.nd.Wp(l.commandId);l.invoke();w.end();this.Tc.setSelection(l.mb)}this.qF=null;this.pqa=b?b.commandId:null;a&&
c.dispose()}}}wJj(a){this.pqa=null;const b=new qf.GraphTransaction(15);b.kd(a.A$f);b.jd=a.commandId;a.mb=this.Tc.Na.mb;const c=this.nd.Wp(a.commandId);a.invoke();c.end();this.Tc.setSelection(a.mb);this.Tza&&a.nx&&a.tog&&(this.pqa=a.commandId);b.dispose()}xJj(a){this.pqa=null;return a.invoke()}Wzj(){return this.Tza&&!!this.pqa}Ask(a){if(!this.Tza||!this.pqa)return!1;const b=this.pqa;this.pqa=null;if(!a||!this.Xs.SW||this.Xs.QZd!==b)return!1;this.Xs.undo();return!0}EHb(){this.pqa=null}}Object(n.a)(UA,
"AutoCorrectScheduler",null,[545]);class Nr extends Wn{constructor(a,b,c,f,l,w){super(a,b,c,f,l);this.Vlf=this.z2=null;this.yV=l;this.fd=w}get e9(){return this.z2||(this.z2=Ab.a.instance.rb("Box4.IInternalLinkManager"))}get jbh(){return this.Vlf||(this.Vlf=Ab.a.instance.rb("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get nx(){return!0}get commandId(){return D.a.ySd}t8(a){fd.a.mark(7012);const b=new qf.GraphTransaction(15);b.kd(a);var c=this.tA,f=this.yR,l=zb.ParagraphReader.text(a),w=l.substring(c,
f);const H=({Pjc:U}=ha.a.j0e(w)).returnValue;w!==H&&(c+=U,f=c+H.length);w=Id.a.createTextRange(a,c,f);var U=l.substring(c,f);Nr.mQj(l,c,f)&&(this.yV.replaceTextRange(Id.a.createTextRange(a,c-1,f+1),U,!0,!1),--c,--f,w=Id.a.createTextRange(a,c,f),c=Od.SelectionFactory.Sg(a,f),de.a.instance.setSelection(c));c=vb.HyperlinkReader.qEa(U);Nr.hyperlinkEditor.tja(w,c,!1);l=U="";f=!1;this.e9&&({Whh:U,z1i:l}=this.e9.xEh(c,!0)).returnValue&&(c=U,f=!0,U=vb.HyperlinkReader.vC(w,!1),Nr.hyperlinkEditor.CM(U[0].paragraph,
U[0].hyperlink),""!==l&&(this.yV.replaceTextRange(w,l,!0,!1),w=Id.a.createTextRange(a,this.tA,this.tA+l.length),a=Od.SelectionFactory.Sg(a,this.tA+this.tA+l.length),de.a.instance.setSelection(a)),Nr.hyperlinkEditor.tja(w,c,!1));b.dispose();!f&&this.jbh&&this.jbh.qPl(w,c);fd.a.mark(7013)}set nx(a){super.nx=a}static get hyperlinkEditor(){return Nr.zn||(Nr.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static mQj(a,b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===
a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}Nr.zn=null;Object(n.a)(Nr,"HyperlinkAction",Wn,[]);class VA{constructor(a,b){this.gh=a;this.fd=b}fFi(a,b,c){return new Nr(null,a,b,c,this.gh,this.fd)}}Object(n.a)(VA,"Factory",null,[399]);class WA{constructor(){this.Da=null}get name(){return"Box4.AutoCorrect"}Zb(a){this.Da=a;a.register(Um,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().oa(()=>new Um(a.resolve("Box4.IHyperlinkActionFactory"),a.resolve("Box4.ICharacterPropertiesEditor"),
Kh.a.instance,u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(SA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().oa(()=>new SA(a.resolve("Box4.IRoamingServiceRequestManager"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(UA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().oa(()=>
new UA(a.resolve("Box4.IAutoCorrectRules"),de.a.instance,Nc.a.instance,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(VA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().oa(()=>new VA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Da.resolve("Box4.IAutoCorrectRules").l1j();
const a=u.AFrameworkApplication.fa;a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Da.resolve("Box4.IAutoCorrectOptionsInfo").S4i()}dispose(){}static main(){v.a.instance.Dc(new WA)}}Object(n.a)(WA,"Box4AutoCorrectPackage",null,[2,3]);class XA{get name(){return"Box4.Clipboard"}init(){}dispose(){}Zb(){}static main(){v.a.instance.Dc(new XA)}}Object(n.a)(XA,"Box4ClipboardPackage",null,[2,3]);var YA=d(584),bx=d(496),Wo=d(328);class Or{}Or.fontSize=0;Or.bold=
!1;Or.italic=!1;Or.spacing=0;Object(n.a)(Or,"DefaultTextCharPropertyBag",null,[]);class ZA{constructor(a,b,c,f,l,w,H,U){this.H3c=[Za.a.fontColor,hb.a.Yvb];this.L8c=[Za.a.Ui,Za.a.font,hb.a.autonumberBulletType,Za.a.EVa,Yd.a.CVa];this.nck=[new bx.a(hb.a.nX,hb.a.xx),new bx.a(hb.a.xla,hb.a.cea),new bx.a(hb.a.wla,hb.a.aea)];this.Qva=a;this.pJ=b;this.Ffc=c;this.mi=f;this.PWa=l;this.cXa=w;this.Pb=H;this.Ea=U}dtb(a){return this.KUd(a,-1)}vJc(a){return this.KUd(a,1)}KUd(a,b){return ob.GraphIterator.Yca(()=>
this.cXa?fe.OutlineElementReader.$g(a)&&!a.U7b(14)&&a.U7b(12)&&!this.aQj(a)&&this.RDf(a,b):rb.ListReader.vk(a)&&this.RDf(a,b))}aQj(a){return(a=this.Ea.en(a.currentNode))?a.m4:!1}RDf(a,b){return ob.GraphIterator.Yca(()=>{const c=a.currentNode.sa(Va.a.listLevel,Jg.a.PEa)+b;if(0>c||c>=Wo.a.e8||!this.pJ.qQ(a,c))return!1;this.cXa||(Pa.OutlineElementNavigator.oi(a),Pa.OutlineElementNavigator.Re(a));return!0})}dib(a,b){this.b9g(a,b)}qNc(a,b){this.b9g(a,b)}b9g(a,b){if(this.KUd(a,b)&&(this.cXa||rb.ListReader.vk(a))){var c=
a.Bb(2);a.zc();(new ob.GraphIterator).Rc(a);const f=a.currentNode.sa(Va.a.listLevel,Jg.a.PEa);(0>f||f>=Wo.a.e8)&&va.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",f);(0>f+b||f+b>=Wo.a.e8)&&va.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.pJ.qQ(a,f),w=this.pJ.qQ(a,f+b);if(l&&w){a.currentNode.setValue(Va.a.listLevel,f+b);c.setValue(Va.a.listLevel,
f+b);for(b=0;b<c.Ra.length;b++)c.Ra.ga(b).formatting&&c.Ra.ga(b).formatting.uie();this.pdi(c,l,w);this.gdi(c,l,w);this.ldi(c,l,w);c=a.Bb(4);a.zc();c&&this.adi(c,l,w)}}}gdi(a,b,c){b=c.sa(Za.a.fontSize,Or.fontSize)-b.sa(Za.a.fontSize,Or.fontSize);a.Sa(Za.a.fontSize)&&a.setValue(Za.a.fontSize,a.eb(Za.a.fontSize)+b);for(c=0;c<a.Ra.length;++c){const f=a.Ra.ga(c);f||va.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",c);f&&
f.formatting&&f.formatting.Yz&&f.formatting.Yz.Sa(Za.a.fontSize)&&this.mi.Pq(f.formatting,f.formatting.Yz.eb(Za.a.fontSize)+b)}this.PWa&&this.PWa.Sa(Za.a.fontSize)&&(a=this.PWa.fontSize(),this.PWa.Pq(a+b))}pdi(a,b,c){if(a.Sa(Va.a.$l)){var f=a.eb(Va.a.$l);let l=b.sa(Va.a.$l,Jg.a.leftMargin),w=c.sa(Va.a.$l,Jg.a.leftMargin);const H=this.Ea.en(a);H&&!H.ud&&(l=b.sa(hb.a.r2b,Jg.a.leftMargin),w=c.sa(hb.a.r2b,Jg.a.leftMargin));f=f+w-l;0>f&&a.setValue(Va.a.ho,a.sa(Va.a.ho,Jg.a.indent)+f);this.Qva.Bv.rpd(a,
1,f)}this.KPc(a,b,Va.a.ho)&&this.vXc(a,c,Va.a.ho)}ldi(a,b,c){for(const f of this.nck)this.KPc(a,b,f.first,f.second)&&this.vXc(a,c,f.first,f.second)}adi(a,b,c){if(this.KPc(a,b,Za.a.Ui,Za.a.font)){if(0===this.Ffc.gxb(a)&&a.sa(hb.a.autonumberBulletType,8)!==b.sa(hb.a.autonumberBulletType,8))return;if(c.sa(Za.a.Ui,null))this.Ffc.k0b(a),a.io.apply(a,this.L8c),this.vXc.apply(this,[a,c].concat(this.L8c));else{const f=this.Pb.Mc(a);f.rc(11);f.Oi()}}for(const f of this.H3c)this.KPc(a,b,f)&&(a.removeProperty(f),
this.vXc(a,c,f))}KPc(a,b,...c){for(const f of c)if(a.Sa(f)||b.Sa(f))if(!a.Sa(f)||!b.Sa(f)||!YA.APropertySet.MZa(f.type,a.Mh(f),b.Mh(f)))return!1;return!0}vXc(a,b,...c){for(const f of c)b.Sa(f)&&a.we(f,b.Mh(f))}}Object(n.a)(ZA,"OutlineElementIndentationEditor",null,[548]);var Gy=d(153);class xp{constructor(a,b){this.ap=this.fd=this.Jt=null;this.Zo=b;xp.Wg=a}get fq(){return this.Zo.value}get insertionPointFormatting(){return this.Jt||(this.Jt=Ab.a.instance.rb("Box4.IInsertionPointFormatting"))}get Sf(){return this.fd||
(this.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get F6(){return this.ap||(this.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}aae(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.t0f():null;if(c&&!c.equals(ia.a.nil)){a=b.Gh;if(!a)return null;c=a.Be(c);if(!c||c&&1!==mb.StyleReader.Ita(c))return null}else c=Kb.a.xs(a),c=Kb.a.Bwb(c);return c}Eaa(a,b,c){if(zb.ParagraphReader.ae(b))if(a)if(mb.StyleReader.f1c(a))if(2!==
mb.StyleReader.Ita(a))ka.ULS.shipAssertTag(7467991,324,!1);else{var f=mb.StyleReader.sL(b);if(f){var l=mb.StyleReader.wQ(a);if(!l)ka.ULS.shipAssertTag(7467993,324,!1);else if(f.$G(l)){l=null;this.Sf.hg&&b.K8();c||(l=this.fq.zSk(l),xp.paragraphEditor.l0b(b,!0));this.Puc(b,f);R.a.instance.ga(61)||(a=f.$G(mb.StyleReader.wQ(a)));b.properties.setValue(eh.a.paragraphStyle,a.id);b.eV=a;for(c=0;c<b.Ra.length;c++)b.Ra.ga(c).formatting&&b.Ra.ga(c).formatting.uie();xp.L2c.V2b(a)&&(l||(l=new ob.GraphIterator,
l.set(b),l.Ze(),Pa.OutlineElementNavigator.Re(l)),rb.ListReader.vk(l)||(b.io(Va.a.$l,Va.a.sxa,Va.a.ho,Va.a.zJa,Va.a.Dlc,Va.a.F9g),this.wRd(l,a)))}}else ka.ULS.shipAssertTag(7467992,324,!1)}else ka.ULS.shipAssertTag(7467990,324,!1);else ka.ULS.shipAssertTag(7467989,324,!1);else ka.ULS.shipAssertTag(7467988,324,!1)}wRd(){}lKc(a,b=!1){let c;c=xf.c(a)?xf.d(a)?mb.StyleReader.sL(a).$G(mb.StyleReader.jsd):mb.StyleReader.sL(a).$G(mb.StyleReader.lsd):mb.StyleReader.sL(a).$G(R.a.instance.ga(61)?mb.StyleReader.CMa:
mb.StyleReader.cpa);this.Eaa(c,a,b)}XWe(a,b){const c=mb.StyleReader.sL(b);c&&c.$G(mb.StyleReader.wQ(a))&&(this.Puc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.w_a(),this.insertionPointFormatting.hga(a,b)))}Puc(a,b){return(a=xp.Zl.KGb(a))?b.zfl(a):!1}static get paragraphEditor(){return xp.Yw||(xp.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){xp.Yw=a}static get L2c(){return xp.Wg||(xp.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}static get Zl(){return Gy.PageNavigator.instance}}
xp.Yw=null;xp.Wg=null;Object(n.a)(xp,"StyleEditor",null,[397]);class Yq{static jbe(){return Yq.C6j}static LUf(a){return new ia.a(a,1)}static zJf(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return gh.a.Gf(a)}}Yq.C6j=[hb.a.txa,hb.a.cellId,hb.a.rowId,hb.a.shapeId];Object(n.a)(Yq,"TransformHelper",null,[]);class $A{constructor(a,b){this.F3c=new xp(a,b);this.nA=a;this.pJ=b.value}aae(a){return this.F3c.aae(a)}XWe(a,b){this.F3c.XWe(a,b)}Eaa(a,b){const c=new ob.GraphIterator;c.set(b);
c.fv();c.zc();ym.d(a,c.currentNode,[Va.a.listLevel]);ym.d(a,b,[Za.a.Jl,Za.a.gJ,Va.a.ho,Va.a.$l,hb.a.xx,hb.a.nX,hb.a.xla,hb.a.cea,hb.a.wla,hb.a.aea]);if(this.nA.V2b(a)&&!rb.ListReader.vk(c)){a=cf.a.NCa(a,a);const f=cf.a.yN(a.listType,a.listStyle);f.yA=a.yA;a.propertySet.Sa(Za.a.Ui)&&f.propertySet.setValue(Za.a.Ui,a.propertySet.eb(Za.a.Ui));a.propertySet.Sa(Za.a.font)&&f.propertySet.setValue(Za.a.font,a.propertySet.eb(Za.a.font));a.propertySet.Sa(hb.a.autonumberBulletType)&&f.propertySet.setValue(hb.a.autonumberBulletType,
a.propertySet.eb(hb.a.autonumberBulletType));this.pJ.SPa(c,f,!1,!1,0);a=c.Bb(4);ym.b(b,a,Yq.jbe());c.zc()}}lKc(a,b=!1){this.F3c.lKc(a,b)}Puc(a,b){return this.F3c.Puc(a,b)}}Object(n.a)($A,"StyleEditor",null,[397]);class aB{constructor(a){this.hAg=a;this.hAg.Dia(Object(F.a)(this,this.XYa,"onBeforeValidatePersistence"))}dispose(){this.hAg.zKb(Object(F.a)(this,this.XYa,"onBeforeValidatePersistence"))}XYa(a,b){10!==b.node.type&&60!==b.node.type||b.node.XHh()}}Object(n.a)(aB,"LockableGraphNodeEditBehavior",
null,[106]);class bB{constructor(){}CVi(a){const b=a.parentNode.eb(hb.a.shapeId),c=a.parentNode.eb(hb.a.txa);let f=null,l=null;const w=Object(qa.a)(5,a.currentNode);w&&w.Cs()&&(f=a.parentNode.eb(hb.a.rowId),l=a.parentNode.eb(hb.a.cellId));this.FWe(a.currentNode,b,c,f,l)}FWe(a,b,c,f,l){a.we(hb.a.shapeId,b);a.we(hb.a.txa,c);l&&(a.we(hb.a.rowId,f),a.we(hb.a.cellId,l))}}Object(n.a)(bB,"PptCreateParagraphStrategy",null,[396]);var TP=d(31);class cB{constructor(a){this.Gv=a;this.Gv.Dia(Object(F.a)(this,
this.XYa,"onBeforeValidatePersistence"))}dispose(){this.Gv.zKb(Object(F.a)(this,this.XYa,"onBeforeValidatePersistence"))}XYa(a,b){Rc.a.Ib&&(a=Rc.a.Ib,a.Ur&&Rc.a.Tfa(Rc.a.Ib),b.revisionId&&(b=Rc.a.h$a(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?ka.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),TP.Debug.Vt()):a.SB(Bh.a.FY,b.toString())))}}Object(n.a)(cB,"PresentationNodeEditBehavior",null,[106]);class dB{pqc(a,
b,c){let f;({value:f}=a.Tf(b)).returnValue||(f=new Ka.a,a.$(b,f));f.add(c)}Bud(a,b,c,f){if(a.count)for(let l of a)l&&l!==ia.a.nil&&(a=b.YTc(l,ia.a.nil),a=f.ga(a))&&(b.$(l,a),this.pqc(c,a,l))}wud(a,b,c){a.Gb(b)&&ia.a.WP(a.ga(b),c)&&a.remove(b)}}Object(n.a)(dB,"GraphHotColdHelper",null,[395]);var Pr=d(207),Hy;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(Hy||(Hy={}));Object(n.b)("GraphNodeModificationType",
Hy);class YF{constructor(a,b,c,f,l,w){this.AXa=a;this.Wma=b;this.Tma=c;this.rU=f;this.eR=l;this.ana=w;this.Bgc=ia.a.nil}lG(a){return!!a&&(7===a.type||68===a.type)}tkc(a,b){this.AXa.$(a.id,b);this.ana.NFe(b)?this.Bgc=a.id:this.eR.pqc(this.rU,b,a.id)}P5e(a){if(this.Bgc&&this.Bgc!==ia.a.nil){let b;this.eR.Bud((b=new Ka.a,b.add(this.Bgc),b),this.AXa,this.rU,a);this.Bgc=ia.a.nil}}CHb(a,b){this.eR.wud(this.AXa,a,b)}i9(a){return this.AXa.Gb(a.id)}aX(a){return this.i9(a)||0<this.Wma.count||0<this.Tma.count}}
Object(n.a)(YF,"PresentationHotColdHandler",null,[423,392]);class ZF extends Sys.EventArgs{constructor(a,b){super();this.revisionId=a;this.node=b}}Object(n.a)(ZF,"RevisionPersistArgs",Sys.EventArgs,[]);var $F=d(907);class aG{constructor(a,b,c,f,l,w,H){this.twa=a;this.Tma=b;this.rU=c;this.eR=f;this.ana=l;this.ic=w;this.Ea=H;this.K9c=new Ka.a;this.SHa=new Ka.a}lG(a){return!!a&&(10===a.type||60===a.type||39===a.type)}tkc(a,b){let c=a;const f=this.ic.jg(a);60!==a.type&&39!==a.type&&(c=this.Ea.en(a));
f&&c&&(this.Tma.$(c.id,b),this.twa.$(f.id,b),this.ana.NFe(b)?(this.K9c.contains(c.id)||this.K9c.add(c.id),this.SHa.contains(f.id)||this.SHa.add(f.id)):(this.eR.pqc(this.rU,b,c.id),this.eR.pqc(this.rU,b,f.id)))}P5e(a){this.eR.Bud(this.K9c,this.Tma,this.rU,a);this.eR.Bud(this.SHa,this.twa,this.rU,a);this.K9c.clear();this.SHa.clear()}CHb(a,b){this.eR.wud(this.Tma,a,b);this.eR.wud(this.twa,a,b)}i9(a){return this.lG(a)&&this.Tma.Gb(a.id)}aX(a){return this.i9(a)}}Object(n.a)(aG,"ShapeLevelHotColdHandler",
null,[423,392]);class bG{constructor(a,b,c,f,l){this.Wma=a;this.twa=b;this.rU=c;this.eR=f;this.ana=l;this.SHa=new Ka.a}lG(a){return!!a&&8===a.type}tkc(a,b){this.Wma.$(a.id,b);this.ana.NFe(b)&&!this.SHa.contains(a.id)?this.SHa.add(a.id):this.eR.pqc(this.rU,b,a.id)}P5e(a){this.eR.Bud(this.SHa,this.Wma,this.rU,a);this.SHa.clear()}CHb(a,b){this.eR.wud(this.Wma,a,b)}i9(a){return this.Wma.Gb(a.id)}aX(a){return this.i9(a)||this.RLj(a)}RLj(a){return this.twa.Gb(a.id)}}Object(n.a)(bG,"SlideHotColdHandler",
null,[423,392]);class Iy{constructor(a,b,c,f,l,w,H,U,ja,wa=null,Sa=null,eb=null){this.Bl=this.rU=this.Tma=this.twa=this.Wma=this.AXa=null;this.ic=a;this.Ea=b;this.Oc=c;this.Es=f;this.eR=l;this.Gv=w;this.hAe=!1;this.m0=H;this.ua=U;this.ana=ja;this.Es.l6a(Object(F.a)(this,this.Cgd,"onRevisionProcessedOnServerHandler"));this.Es.Mvf(Object(F.a)(this,this.Bfd,"onGraphNodePersistHandler"));this.Gv.Dia(Object(F.a)(this,this.Bfd,"onGraphNodePersistHandler"));this.Oc.LA(Object(F.a)(this,this.GB,"onSessionEnd"));
this.Oc.h$h(Object(F.a)(this,this.d4g,"onFailoverHandler"));this.Oc.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.initialize(wa,Sa,eb);this.GWa=new qd.a}reset(){this.initialize();this.Es.sfh(new $F.a(null));this.NFh()}initialize(a=null,b=null,c=null){a||this.Ldj();this.rU=b||new qd.a;this.Bl=c||this.fka()}d4g(){this.reset()}Cgd(a,b){b&&(a=b.MH)&&this.gJe(a)}Bfd(a,b){this.tkc(b.node,b.revisionId)}tkc(a,b){if(!this.hAe&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.Bl)if(c.lG(a)){c.tkc(a,
b);this.Es.cPk(new ZF(b,a));break}}gJe(a){const b=ia.a.Gf(a.Id),c=this.rU.ga(b);if(c&&c.count){for(let f of c)for(const l of this.Bl)l.CHb(f,b);this.rU.remove(b);this.Es.sfh(new $F.a(a));this.NFh()}}BQi(){const a={},b=Iy.fHj(a);b(0,this.AXa);b(1,this.Wma);b(2,this.twa);b(3,this.Tma);pa.a.isEmpty(a)||va.a.J(21112097,811,50,pa.a.toJSON(a))}aX(a){for(const b of this.Bl)if(b.lG(a))return b.aX(a);return!1}i9(a){for(const b of this.Bl)if(b.lG(a))return b.i9(a);return!1}YIh(a){if(0<a.count)for(const b of this.Bl)b.P5e(a)}dispose(){this.Oc.qaa(Object(F.a)(this,
this.GB,"onSessionEnd"));this.Oc.GZk(Object(F.a)(this,this.d4g,"onFailoverHandler"));this.Gv.zKb(Object(F.a)(this,this.Bfd,"onGraphNodePersistHandler"));this.Es.Poc(Object(F.a)(this,this.Cgd,"onRevisionProcessedOnServerHandler"));this.Es.$jh(Object(F.a)(this,this.Bfd,"onGraphNodePersistHandler"));this.Oc.Xfa(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.GWa&&0<this.GWa.count&&va.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.GWa.count))}GB(){this.hAe=!0;this.BQi();
this.reset()}Eo(){this.ua.presentation.ZSe();this.reset();this.hAe=!1;this.m0.jKa(new hh.a("SessionRehydrated"))}fka(){return[new aG(this.twa,this.Tma,this.rU,this.eR,this.ana,this.ic,this.Ea),new bG(this.Wma,this.twa,this.rU,this.eR,this.ana),new YF(this.AXa,this.Wma,this.Tma,this.rU,this.eR,this.ana)]}Ldj(){this.AXa=new qd.a;this.Wma=new qd.a;this.twa=new qd.a;this.Tma=new qd.a}N2b(a,b){var c=Object(qa.a)(390,a);c.Rta+=1;({value:c}=this.GWa.Tf(b.id)).returnValue||(c=new Ka.a,this.GWa.add(b.id,c));
c.add(a)}NFh(){if(this.GWa.count&&this.ua.presentation&&this.ua.presentation.Gh){var a=this.ua.presentation.Gh;this.GWa.forEach((b,c)=>{if(!this.i9(Object(qa.a)(9,a.Be(b)))){for(let f of c)if(c=Object(qa.a)(390,f))--c.Rta,this.Szb(c)&&(this.m0.jKa(new hh.a("SessionRehydrated")),this.xmd(f));this.GWa.remove(b)}return!0})}}Szb(a){return a?!a.Rta&&!a.Vja:!1}xmd(a){var b=Object(qa.a)(390,a);a&&b&&(b=+new Date-+b.lja,12E4<b&&va.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static fHj(a){return(b,
c)=>{c=Pr.b(c.values.toArray(),f=>f.toString());c.length&&(a[Hy[b]]=c)}}}Object(n.a)(Iy,"GraphHotColdManager",null,[391,392,106,393]);class eB{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphEditor"}Zb(a){this.K=a;this.K.register(aB,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().oa(()=>new aB(this.K.resolve("Box4.Graph.IGraphInstance").ySa));this.K.register(cB,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().oa(()=>new cB(this.K.resolve("Box4.Graph.IGraphInstance").xd(7)));
this.K.register(ZA,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").oa(()=>new ZA(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register($A,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().oa(()=>new $A(this.K.resolve("Box4.List.IListReader"),this.K.ke("Box4.List.IListEditor")));this.K.register(dB,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").oa(()=>new dB);this.K.register(Iy,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().oa(()=>
new Iy(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").ySa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));
this.K.register(bB,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().oa(()=>new bB(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){v.a.instance.Dc(new eB)}}Object(n.a)(eB,"PPTWebEditorGraphEditorPackage",null,[2,3]);var UP=d(779),Jy=d(781),VP=d(780),Yn=d(454);const cG=a=>{a.element.style.top=""};var qv=d(790);class dG{constructor(a,b,c){this.K7=!1;this.lNa=0;this.iha=this.clf=null;this.AS=a;this.B2h=b;this.xn=c;this.zP=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.B2=!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.yua)&&!this.xn.ZNc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";B.a.fg&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.zP}get visible(){return this.K7}set_visible(a){if(this.K7!==a)return(this.K7=a)?this.rSd():this.A2b(),a}dispose(){this.visible&&this.A2b();za.a.qCa(this.htmlElement);this.AS=this.zP=null}pwh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);a.dmh();this.lNa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.Lwf,w=Object(F.a)(this,this.Vrk,"onAfterShowEntry");Yn.WacAirSpace.Z_a(c,"Shared_BasicClass");var H=new VP.a(c);H.jZb(0,1);const U=new Jy.a(c);U.kZb(c.clientTop-30,c.clientTop);l?(Yn.WacAirSpace.IYa(H,null,null),Yn.WacAirSpace.IYa(U,null,w)):(Yn.WacAirSpace.animate(H,null,null),Yn.WacAirSpace.animate(U,null,w));for(b+=1;b<
f.length;b++)w=f[b],Yn.WacAirSpace.Z_a(w,"Shared_BasicClass"),H=new Jy.a(w),H.kZb(w.clientTop-c.clientHeight,w.clientTop),l?Yn.WacAirSpace.IYa(H,null,null):Yn.WacAirSpace.animate(H,null,null);a.qml();this.set_visible(!0)}Pcg(a){const b=a.htmlElement;if(za.a.GUa(b)){this.lNa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.Lwf;var f=Object(F.a)(this,this.Qrk,"onAfterHideEntry");Yn.WacAirSpace.Z_a(b,"Shared_BasicClass");var l=new UP.a(b);l.jZb(1,0);a?Yn.WacAirSpace.IYa(l,null,f):Yn.WacAirSpace.animate(l,
null,f);f=!1;for(l=0;l<c.length;l++){if(f){const w=c[l];Yn.WacAirSpace.Z_a(w,"Shared_BasicClass");const H=new Jy.a(w);H.kZb(w.clientTop,-b.clientHeight);a?Yn.WacAirSpace.IYa(H,null,cG):Yn.WacAirSpace.animate(H,null,cG)}f||c[l]!==b||(f=!0)}}}Vrk(a){a.element.style.top="";u.AFrameworkApplication.Aa.Oq()}Qrk(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);u.AFrameworkApplication.Aa.Oq()}rSd(){""===this.AS.style.top.trim()&&(this.AS.style.top=this.AS.offsetTop+
"px");this.htmlElement.style.left=this.AS.style.left;this.htmlElement.style.top=this.AS.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.clf=this.AS.style.top;this.lNa=a.height;this.yvd();u.AFrameworkApplication.Aa.mca(Object(F.a)(this,this.onResize,"onResize"));Yc.a.addHandler(this.htmlElement,sa.a.ood,Yc.a.ftb);this.iha=Object(F.a)(this,this.oC,"contextMenuHandler");u.AFrameworkApplication.Aa.Qaa.pb(this.htmlElement,
this.iha,null);if(y.FocusManager.UM()){var b=y.FocusManager.instance();a=b.Fc(qv.a.P6a);a.parent=E.AFrame.hj;const c=new kq.DOMFocusListing(()=>this.htmlElement);c.Io(1);c.Io(2);c.Io(8);b.Yia(()=>this.htmlElement,a,c);b=b.uQ(qv.a.P6a);b.Lib();b.rX=!0;b.NQa=!0;const f=u.AFrameworkApplication.Aa.Pw;a.c6a(()=>{f.Lo(qv.a.P6a)});f.yia(qv.a.P6a);(c.Uja||u.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&f.rI(qv.a.P6a)}}A2b(){this.Svh()&&(this.AS.style.top=this.clf);this.htmlElement.style.visibility=
"hidden";u.AFrameworkApplication.Aa&&(y.FocusManager.UM()&&y.FocusManager.instance().tKb(qv.a.P6a),this.iha&&(u.AFrameworkApplication.Aa.Qaa.yb(this.htmlElement,this.iha),this.iha=null));Yc.a.removeHandler(this.htmlElement,sa.a.ood,Yc.a.ftb)}yvd(){if(this.Svh()&&this.visible){var a=this.AS,b=this.lNa+this.B2h;const c=za.a.xM(a.style.top);Yn.WacAirSpace.Z_a(a,"Shared_BasicClass");a=new Jy.a(a);a.kZb(c,b);Yn.WacAirSpace.animate(a,null,null)}}Svh(){return!this.B2&&!this.xn.ZNc}onResize(){const a=this.xn.entries.length,
b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let f=0;f<a;++f)c=this.xn.entries[f],c.htmlElement&&c.dmh();this.lNa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.lNa&&this.yvd()}oC(){return!0}}Object(n.a)(dG,"BusinessBarDom",null,[610,106]);var Pt;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]=
"fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=
17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=
27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=
36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(Pt||(Pt={}));Object(n.b)("BusinessBarId",Pt);class vq{constructor(a,b=0,c=null,f=null){this.ogf=this.Naf=!1;this.Gpb=null;
this.wP=[];this.Yza=f||new dG(a,b,this);this.AGj(c)}AGj(a){if(a){this.Gpb={};a=a.ranking;for(let b=0;b<a.length;b++)this.Gpb[Pt[a[b]]]=b}}dispose(){this.Yza.dispose();Ro.a.Knd(this.wP);this.wP=null}get htmlElement(){return this.Yza.htmlElement}get visible(){return this.Yza.visible}get ZNc(){return this.Naf}set ZNc(a){this.Naf=a}get Rle(){return this.ogf}set Rle(a){this.ogf=a}get entries(){return this.wP}set entries(a){this.wP=a}Mda(a){for(let b=0;b<this.wP.length;b++)if(this.wP[b].id===a)return!0;
return!1}$h(a,b=!1,c=null){a.businessBar=this;let f=this.Kbj(a.id);b&&!this.Gpb&&(f=0);f<vq.ogb&&(this.Yza.pwh(a,f),this.wP.length>=vq.ogb&&this.Yza.Pcg(this.wP[vq.ogb-1]),this.Yza.yvd());Array.insert(this.wP,f,a);ka.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Pt[a.id],void 0===a.BCa||null===a.BCa?"":a.BCa);a.errorCode&&u.AFrameworkApplication.zp(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.wP,a);-1!==b&&b<vq.ogb&&(this.wP.length>vq.ogb&&
this.Yza.pwh(this.wP[vq.ogb],vq.ogb),this.Yza.Pcg(a),this.Yza.yvd());Array.remove(this.wP,a);a.businessBar=null;a.dispose()}Kbj(a){if(!this.Gpb||0===a)return this.wP.length;a=this.Gpb[Pt[a]];if(void 0===a||null===a)return this.wP.length;for(let b=0;b<this.wP.length;b++)if(a<this.Gpb[Pt[this.wP[b].id]])return b;return this.wP.length}}vq.ogb=2;Object(n.a)(vq,"BusinessBar",null,[592,106,593]);class fB{constructor(a){this.MMc=null;this.Q1g=a.Ga("OfficeOnlineChromeExtensionId");this.Z1g=a.Ga("ChromeClipboardAccessExtensionId");
this.ALj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.Vof=!this.eSj();this.MMc=this.Gya?this.Z1g:this.Q1g}XSc(){return this.MMc}RSe(){this.MMc===this.Q1g&&this.Hkg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.MMc=this.Z1g;this.Vof=!0}get Gya(){return this.Vof}eSj(){if(this.ALj&&this.Hkg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&
"true"===a}return!1}get Hkg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){ka.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(n.a)(fB,"ChromeExtensionHelper",null,[551]);class eG{constructor(a=null,b=null,c=null){this.Uaa=a||{};this.qEh=b||[];this.Zzl=c||{}}}Object(n.a)(eG,"RibbonTrimmingProperties",
null,[]);var WP=d(458);class fG{create(a,b,c){return new WP.a(a,b,c)}}Object(n.a)(fG,"Factory",null,[555]);class gG{constructor(){u.AFrameworkApplication.Ta.ya(G.a.ZAb,Xd.a.frame,Object(F.a)(this,this.ORk,"reactFileMenuOpenFromTellMe"))}ORk(a,b,c,f,l){if(1===c||!l)return 32;a=l.SourceControlId;17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],Sg.d("setFileMenuSelectedPage")&&("New"===a&&u.AFrameworkApplication.Aa?2===u.AFrameworkApplication.Aa.hb.Uk?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&u.AFrameworkApplication.Aa&&(2===u.AFrameworkApplication.Aa.hb.Uk?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32}w_j(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}Object(n.a)(gG,"ReactFileMenu",null,[590]);class hG{createFileMenu(){const a=
new gG,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(n.a)(hG,"ReactFileMenuFactory",null,[556]);var Vh=d(534);class iG{constructor(a,b,c,f,l,w,H){this.cHa=!1;this.gA=null;this.kma=this.Cbd=this.dXa=!1;this.SCb="Edit";this.iTg=!1;this.mc=f;this.ia=a;this.Mv=b;this.Rb=l;this.Ik=H;this.Rb.RK(Object(F.a)(this,this.Fdd,"modeSwitched"));this.Ha=c;this.wb()}wb(){this.ia.ya(L.a.m_g,Xd.a.frame,
Object(F.a)(this,this.Vnk,"modeSwitcherHandler"));this.ia.ya(L.a.Ksc,Xd.a.frame,Object(F.a)(this,this.Ksc,"switchToDocumentEditMode"));this.ia.ya(L.a.Msc,Xd.a.frame,Object(F.a)(this,this.Msc,"switchToEmergencyViewMode"));this.ia.ya(L.a.Lsc,Xd.a.frame,Object(F.a)(this,this.Lsc,"switchToDocumentViewMode"));this.ia.ra(L.a.OOe,Xd.a.frame,Object(F.a)(this,this.beh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ra(L.a.POe,Xd.a.frame,Object(F.a)(this,this.beh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ya(L.a.iDa,
nc.a.application,Object(F.a)(this,this.iDa,"displayCallout"));this.ia.ya(G.a.EAh,Xd.a.frame,Object(F.a)(this,this.Wtl,"switchFromViewModeToEditMode"))}dispose(){this.Rb.CY(Object(F.a)(this,this.Fdd,"modeSwitched"))}Ee(){}Vnk(){return 32}Lsc(a,b,c){if(1===c||"View"===this.F9a())return 32;this.Mv.KAh();this.Fod("View");this.Cbd=!0;return 32}Ksc(a,b,c){if(u.AFrameworkApplication.JQ)return 8;a=this.F9a();if(1===c){if("Edit"===a||this.cHa||this.Cbd||this.dXa&&this.mc.getState(1))return 32;ka.ULS.sendTraceTag(512500510,
306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;this.Mv.ogl();c=this.dXa?this.ia.La(L.a.h3b,2,20):this.ia.processAction(L.a.n7b,2);this.cHa=this.dXa=this.Cbd=!1;this.Fod("Edit");return c}Wtl(a,b,c){if(u.AFrameworkApplication.JQ)return 8;a=this.F9a();if(1===c){if("Edit"===a||this.cHa||this.Cbd||this.dXa&&this.mc.getState(1))return 32;ka.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");
return 8}if("Edit"===a)return 32;if(2!==c)return ka.ULS.sendTraceTag(512500508,306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.La(L.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}Msc(a,b,c){if(1===c)return 32;this.cHa=!0;return this.initialize()}beh(a,b,c,f,l){b=this.F9a();l[Vh.a.On]=a===L.a.OOe&&"Edit"===b||a===L.a.POe&&"View"===b?!0:!1;return 32}iDa(a,b,c,f,l){if(!l||!Object(Ya.a)(Ul,l))return 8;this.gA=l;this.initialize();this.Ik&&
!this.iTg&&"View"===this.SCb&&(this.Ik.A3e(),this.iTg=!0);return this.initialize()}initialize(){if(!Sg.c())return ka.ULS.sendTraceTag(512500507,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.SCb=this.H3f();!this.kma&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.F9a()!==this.SCb&&ka.ULS.sendTraceTag(512500506,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",
this.SCb,this.F9a());var a=this.gA?this.gA.R9b||this.gA.W9b:!1,b=this.gA?this.gA.NUa:this.mc.getState(16);this.dXa=this.gA?this.gA.cle:this.mc.getState(524288);var c=this.gA?this.gA.O$a:this.mc.getState(1);const f=this.cHa||a||this.dXa||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.SCb;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.dXa;l.isReviewer=!1;l.isServiceDefaultedToView=this.cHa||a;l.forceShowNotificationByExternalTrigger=this.gA&&this.gA.KZc?!this.gA.KZc:f;a&&(a={},c={},
c.title=ResourceStrings.L_BizBarTitle_Readonly,this.gA.R9b?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:this.gA.W9b&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);if(!a)return ka.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),
8;ka.ULS.sendTraceTag(512500504,306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",!!this.gA,l.hasEditPermission,this.SCb,b,this.dXa,!!this.gA&&this.gA.R9b,!!this.gA&&this.gA.W9b,this.cHa,this.lhg());b=this.u0d(a);this.kma=!0;return b}u0d(a){if(appChrome.api)return appChrome.api.dispatch(a),32;ka.ULS.sendTraceTag(512500503,
306,10,"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}lhg(){return!!u.AFrameworkApplication.Aa&&1===u.AFrameworkApplication.Aa.mode}H3f(){return this.gA?this.cHa||this.gA.NUa||this.gA.cle||this.gA.R9b||this.gA.W9b||this.gA.KZc?"View":this.gA.O$a?"Edit":"View":this.cHa||this.lhg()?"View":"Edit"}F9a(){if(Sg.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:ka.ULS.sendTraceTag(512500502,
306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}Fod(a){if(Sg.c()&&this.F9a()!==a){var b={};b.activeMode=a;ka.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",a);a=appChrome.actions.updateModeSwitcher(b);this.u0d(a)}}Fdd(a){this.kma&&(1===a.mode?this.Fod("View"):2===a.mode&&this.Fod("Edit"))}U0k(){const a={hidden:!1};a.activeMode=
this.H3f();this.u0d(appChrome.actions.updateModeSwitcher(a))}}Object(n.a)(iG,"ModeSwitcherControlActor",null,[358]);var jG=d(253);class gB{constructor(a,b,c,f){this.ABa=this.kcf=this.vpb=this.Faf=this.oNa=this.J$e=null;this.Uqf=!1;this.xn=a;this.mZ=b;this.Ca=c;this.$a=f}LFk(){this.$_b();this.a0b();this.lti()}$_b(){const a=Pc.App.Kb.Ld.zi;a&&(this.J$e=this.zvd(this.J$e,1,2===Pc.App.Kb.mode&&a.kZc,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get XXj(){if(!Pc.App.PGh)return!1;B.a.eX&&u.AFrameworkApplication.Wj("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");
return B.a.Gj}lti(){this.XXj&&!this.vpb&&(this.vpb=this.mZ.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.vpb.id=15,this.vpb.closeable=!0,this.vpb.addButton(Box4Intl.Box4Strings.L_DownloadNow,O.AppFrame.BDl,""),wo.a("NewBrowserSuggestionShown"),this.xn.$h(this.vpb,!1))}a0b(){let a=null;const b=Pc.App.Kb.Ld.ica;if(b){const c=b.rlc;jG.a.B9b(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===c||20===c?a=B.a.Pi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:
21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=B.a.Pi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==Pc.App.Kb.mode||jG.a.xWc(b.rYb)||Pc.App.Y$b||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.kcf=this.zvd(this.kcf,5,!!a,a)}pgl(a){!!this.ABa===a||this.Uqf||(a?(this.ABa=this.mZ.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,
null),this.ABa.id=13,this.ABa.closeable=!0,this.ABa.e3=()=>{this.Uqf=!0;this.ABa=null},this.xn.$h(this.ABa)):(this.xn.removeEntry(this.ABa),this.ABa=null))}uwh(a,b,c,f){a=this.mZ.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.Ftf(b,()=>{Kd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.e3=f);this.xn.$h(a,!0)}Mml(a,b,c){this.uwh(a,b,c,null)}gml(a){a=this.mZ.create(null,a,null);a.closeable=!0;a.id=24;a.image=1;this.xn.$h(a,!0)}Xml(a){a=this.mZ.create(null,a,null);a.closeable=
!0;a.id=20;this.xn.$h(a)}mml(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.oNa||(this.oNa=this.mZ.create(a,b,null),this.oNa.closeable=!0,this.oNa.id=27,this.xn.$h(this.oNa))}BAj(){this.oNa&&(this.oNa=this.zvd(this.oNa,27,!1,""))}XYe(a){this.Faf=this.zvd(this.Faf,30,!0,a)}zvd(a,b,c,f){c?a?a.message=f:(a=this.mZ.create("",f,null),a.id=b,a.closeable=!1,this.xn.$h(a,!1)):a&&(this.xn.removeEntry(a),a=null);return a}}Object(n.a)(gB,
"BusinessBarController",null,[554]);var XP=d(262);class hB extends gB{constructor(a,b,c,f,l,w,H,U,ja){super(a,b,f,w);this.Ape=this.CAg=!1;this.bhc=[];this.gGa=0;this.lBe=null;this.mYk=wa=>{va.a.J(509195598,801,50,"BusinessBarController.removeFilterPrivacyHandler");XP.a.Ibl(this.Pfk.presentationId.string,this.jyk,this.iyk);this.xn.removeEntry(wa)};this.jyk=()=>{va.a.J(509195597,801,50,"BusinessBarController.onRemoveFilterPrivacySucceeded")};this.iyk=wa=>{va.a.J(509195596,801,10,"BusinessBarController.onRemoveFilterPrivacyFailed error: {0}",
pf.a.$K(wa.error.Im))};this.BZj=wa=>{va.a.J(509182920,801,50,"BusinessBarController.keepFilterPrivacyHandler");this.xn.removeEntry(wa)};this.upe=c;this.ia=f;this.S9=l;this.Fa=H;this.lA=U.oFa;this.Lgc=U.powerPointDragInsertMultipleImageQuantityLimit;this.Pfk=ja}initialize(){this.upe.RK(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"))}dispose(){this.upe.CY(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"))}uv(a,...b){this.I2b.apply(this,[a,this.S9.tUc(a),this.S9.Iae(a),this.S9.f9d(a)].concat(b))}I2b(a,
b,c,f){0===a||this.lBe||(c=this.mZ.create(c,f||"",null),c.closeable=!0,c.errorCode=pf.a.Vh(a),c.e3=Object(F.a)(this,this.pUi,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(F.a)(this,this.pld,"refreshActionHandler"),""),b&&(a?c.vPd(ResourceStrings.L_OpenInPowerPoint,Object(F.a)(this,this.hhd,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,Object(F.a)(this,this.hhd,"openInClientActionHandler"),"")),this.lBe=c,this.BYb(c))}dL(a){var b=
"";let c="",f=null,l="",w=null;var H=!1;let U=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;H=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;H=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;H=!0;break;case 2:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;
H=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;H=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;H=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;H=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;H=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;H=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;H=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;H=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;c=ResourceStrings.L_BizBarButton_Convert;f=Object(F.a)(this,this.nBi,"convertActionHandler");
H=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;H=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;H=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;H=!0;break;case 14:b=u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?
u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";H=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;H=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;H=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,this.Lgc);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,
this.Lgc);H=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.hjj();H=!1;a&&(this.gGa=a,a=this.ia.La(L.a.fLb,1,this.gGa),8!==a&&16!==a&&(H=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,f=Object(F.a)(this,this.A1k,"repairSaveCopyHandler")));32===this.ia.processAction(L.a.$oc,1)&&(H?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,w=Object(F.a)(this,this.Jkh,"replaceOriginalFileHandler")):(H=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(F.a)(this,this.Jkh,
"replaceOriginalFileHandler")));a=H?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;H=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(F.a)(this,this.Jqj,"goToEditModeHandler");H=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=
ResourceStrings.L_LearnMore;f=Object(F.a)(this,this.GBk,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;H=!1;break;case 27:U=!0;a=ResourceStrings.L_BizBarInlineFilterPrivacy;c=ResourceStrings.L_RemoveSetting;f=this.mYk;l=ResourceStrings.L_KeepSetting;w=this.BZj;break;default:return}b=this.mZ.create(b,a,null);b.image=3;b.closeable=
!0;b.e3=H?Object(F.a)(this,this.jgh,"readOnlyInfoEntryClosedHandler"):Object(F.a)(this,this.Jeg,"infoEntryClosedHandler");U&&(b.w_c=!1);f&&b.addButton(c,f,"");w&&b.vPd(l,w);this.BYb(b);H&&Array.add(this.bhc,b)}jDa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=
this.mZ.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.BYb(c)}XNc(a,b){let c,f=!1,l=!1,w=!1,H=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;
w=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;H=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;
f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;f=!0;b=1;break;default:return}a=this.mZ.create(a,c||"",null);a.closeable=!0;a.e3=Object(F.a)(this,this.jgh,"readOnlyInfoEntryClosedHandler");a.image=b;f?(va.a.J(512263711,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(F.a)(this,this.pld,"refreshActionHandler"),"")):l?(va.a.J(512263710,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,
Object(F.a)(this,this.K6k,"saveAsActionHandler"),"")):H?(va.a.J(512263709,801,15,"DownloadACopy button is show"),a.addButton(ResourceStrings.L_DownloadCopy,Object(F.a)(this,this.VPi,"downloadACopyActionHandler"),"")):w&&(va.a.J(512263708,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(F.a)(this,this.IQi,"editAnywayActionHandler"),""));this.BYb(a);Array.add(this.bhc,a)}Mda(a){return this.xn.Mda(a)}hjj(){let a=0;if(this.$a.ka("IsUIEmbedMode")||this.$a.ka("DisablePrint")||
!this.$a.Ga("DownloadACopyUrl")||"true"===this.$a.Ga("ProtectInClient")||B.a.Pi)return a;let b=!0;this.$a.ka("SaveToAnotherFolderBrsIsEnabled")&&this.$a.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.$a.ka("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.$a.ka("SaveAsToHostBrsIsEnabled")&&this.$a.ka("UserCanWriteRelative")&&this.$a.ka("SupportsEditing")||(f=!1);a=b?G.a.xjb:c?G.a.Rpc:a;va.a.J(512263707,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",
b,c,f,a);return a}BYb(a){const b=this.xn.visible;this.xn.$h(a);b||this.Fa.Ej(Zi.a.PTd,!0)}pld(a){va.a.J(512263706,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(L.a.refresh,2)}Jeg(){this.xn.entries.length||this.Fa.Ej(Zi.a.PTd,!1)}pUi(){this.lBe=null;this.xn.entries.length||this.Fa.Ej(Zi.a.PTd,!1)}jgh(a){Array.remove(this.bhc,a);this.Jeg(a);va.a.J(512263705,801,50,"Read-only info entry is closed")}hhd(){this.ia.La(L.a.openInClient,2,!0)}nBi(){this.ia.La(L.a.convertAndEdit,
2,!1)}A1k(){u.AFrameworkApplication.iG?this.BZe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(L.a.fLb,2,this.gGa)}Jkh(){this.ia.processAction(L.a.$oc,2)}Jqj(){this.ia.processAction(L.a.n7b,2)}K6k(){va.a.J(512263704,801,15,"SaveACopy button is clicked");u.AFrameworkApplication.iG?this.BZe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(G.a.xjb,2,!0)}VPi(){va.a.J(512263703,801,15,"DownloadACopy button is clicked");u.AFrameworkApplication.iG?this.BZe(CommonUIStrings.l_SensitivityDownloadDocumentError):
this.ia.La(G.a.downloadACopy,2,!0)}BZe(a){va.a.J(512263702,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new Bi.StandardDialog;b.yd=0;b.Jy(pf.a.GPi,Li.a.D3(ResourceStrings.l_GenericDialogTitle),Li.a.D3(a),null)}IQi(){va.a.J(512263701,801,50,"EditAnyway button is clicked");this.ia.La(L.a.h3b,2,20)}GBk(){va.a.J(512263700,801,50,"Learn More button is clicked");C.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}pVd(){if(this.upe.M$a&&!this.Ape&&!this.CAg){this.Ape=
!0;var a=this.mZ.create("",CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.e3=()=>{this.CAg=!0;this.Ape=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(F.a)(this,this.rtk,"onCompatWarningButtonClick"),"");this.BYb(a)}}rtk(){C.Redirect.showHelp("PPTODF")}QPf(){for(const a of this.bhc)this.xn.removeEntry(a);Array.clear(this.bhc)}Tu(a){this.lA&&2===a.mode&&this.QPf()}}Object(n.a)(hB,"BusinessBarController",gB,[553,554,106]);class kG{constructor(a,
b){this.rcb=null;this.hgk=b;this.qb=document.createElement("div");this.qb.className="BusinessBarPanel";this.qb.id="BusinessBarPanel";this.Ric=document.createElement("div");this.Ric.id="BusinessBarPanelWorking";this.qb.insertBefore(this.Ric,this.qb.firstChild);a.execute(c=>{this.rcb=c;this.hgk&&this.rcb&&(this.rcb.ZNc=!0);this.Ric.insertBefore(this.rcb.htmlElement,this.Ric.firstChild)});this.qb.style.position=nf.a.Csc}dispose(){}layout(a,b){if(!this.rcb||!this.rcb.visible)return this.Cr(),a;this.EOi(b);
this.qb.style.height=gf.a.Pc(this.rcb.htmlElement.offsetHeight);return a}Cr(){"none"!==this.qb.style.display&&(this.qb.style.display="none")}EOi(a){this.qb.style.display.length&&(this.qb.style.display="");a&&(this.qb.style.direction=nf.a.S0a)}get xa(){return this.qb}get xMl(){return this.Ric}get order(){return 2}}Object(n.a)(kG,"BusinessBarPane",null,[362,552,106]);var cx=d(572);class Xo{}Xo.Value="value";Xo.MinValue="MinValue";Xo.MaxValue="MaxValue";Xo.Text="Text";Object(n.a)(Xo,"SliderCommandProperties",
null,[]);var yp=d(1126);class Co{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(n.a)(Co,"CommonOptionalButtonProperties",null,[]);class rv extends Co{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(n.a)(rv,"OptionalButtonProperties",Co,[]);class lG extends rv{constructor(){super();
this.animateTransition=!1}}Object(n.a)(lG,"AdditionalInkButtonProperties",rv,[]);class Ky extends Co{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(n.a)(Ky,"OptionalFlyoutAnchorProperties",Co,[]);class mG extends Ky{constructor(){super();this.animateTransition=!1}}Object(n.a)(mG,"AdditionalInkFlyoutAnchorProperties",Ky,[]);class nG{constructor(){this.selected=
!1;this.iconColor=null}}Object(n.a)(nG,"InkControlState",null,[]);class oG{constructor(){this.keytip=this.LEa=this.label=null}}Object(n.a)(oG,"InkFlyoutAnchorResources",null,[]);class Js{constructor(){this.wBb=[]}ya(a){this.wBb.push(a)}commit(){appChrome.api.dispatch(this.wBb);Array.clear(this.wBb)}}Object(n.a)(Js,"AppChromeTransaction",null,[]);class ce{}ce.dB="InkPen1";ce.dE="InkPen2";ce.cE="InkHighlighter";ce.Zta="InkRuler";ce.oab="InkColorPicker1";ce.Fda="InkColorPicker2";ce.Yta="InkColorPicker3";
ce.Kka="InkColorPickerMRU1";ce.Lka="InkColorPickerMRU2";ce.TEa="InkColorPickerMRU3";ce.WEa="InkThicknessSlider1";ce.XEa="InkThicknessSlider2";ce.YEa="InkThicknessSlider3";ce.UEa="InkDrawWithTouch";ce.b9="InkEraser";ce.c9="InkLasso";ce.VEa="InkSelect";ce.aYf="label";ce.ZXf="iconName";ce.$Xf="keytip";ce.gfe=4;Object(n.a)(ce,"InkRibbonManagerConstants",null,[]);class wq{constructor(a,b,c,f,l){this.sXa=this.uXa=this.tXa=wq.YIc;this.X8=(w,H,U,ja,wa)=>{if(1===U)return this.Xcb?8:32;H=this.lma.ga(ce.Zta).selected;
w!==L.a.kod&&this.iKc(w===L.a.OKa);U=new Js;if(this.bYe(this.Cle(wa)))switch(w){case L.a.iod:case L.a.jod:case L.a.god:case L.a.fod:case L.a.hod:case L.a.$nd:case L.a.aod:case L.a.bod:case L.a.cod:case L.a.dod:case L.a.eod:this.ZJ(ce.UEa,!0,!1,U,!1)}switch(w){case L.a.iod:this.ZJ(ce.dB,!0,!0,U,!0);this.ia.La(L.a.dB,2,wa);this.nB=ce.dB;break;case L.a.cod:this.ZJ(ce.dB,!0,!0,U,!0);this.nLb(ce.dB,this.JWa,ce.Fda,[ce.Kka,ce.Lka],"#000000",wa,U);this.ia.La(L.a.Kka,2,wa);this.nB=ce.dB;break;case L.a.$nd:this.ZJ(ce.dB,
!0,!0,U,!0);this.nLb(ce.dB,this.JWa,ce.Fda,[ce.Kka,ce.Lka],"#000000",wa,U);this.ia.La(L.a.oab,2,wa);this.nB=ce.dB;break;case L.a.jod:this.ZJ(ce.dE,!0,!0,U,!0);this.ia.La(L.a.dE,2,wa);this.nB=ce.dE;break;case L.a.dod:this.ZJ(ce.dE,!0,!0,U,!0);this.nLb(ce.dE,this.JWa,ce.Fda,[ce.Kka,ce.Lka],"#e71224",wa,U);this.ia.La(L.a.Lka,2,wa);this.nB=ce.dE;break;case L.a.aod:this.nLb(ce.dE,this.JWa,ce.Fda,[ce.Kka,ce.Lka],"#e71224",wa,U);this.ZJ(ce.dE,!0,!0,U,!0);this.ia.La(L.a.Fda,2,wa);this.nB=ce.dE;break;case L.a.god:this.ZJ(ce.cE,
!0,!0,U,!0);this.ia.La(L.a.cE,2,wa);this.nB=ce.cE;break;case L.a.eod:this.ZJ(ce.cE,!0,!0,U,!0);this.nLb(ce.cE,this.VCb,ce.Yta,[ce.TEa],"#fffc00",wa,U);this.ia.La(L.a.TEa,2,wa);this.nB=ce.cE;break;case L.a.bod:this.ZJ(ce.cE,!0,!0,U,!0);this.nLb(ce.cE,this.VCb,ce.Yta,[ce.TEa],"#fffc00",wa,U);this.ia.La(L.a.Yta,2,wa);this.nB=ce.cE;break;case L.a.fod:this.ZJ(ce.b9,!0,!1,U,!1);this.ia.La(L.a.b9,2,wa);break;case L.a.kod:this.ZJ(ce.Zta,!H,!1,U,!1);this.ia.La(L.a.Zta,2,wa);break;case L.a.hod:this.ZJ(ce.c9,
!0,!1,U,!1);this.ia.La(L.a.c9,2,wa);break;case L.a.OKa:this.ZJ(ce.VEa,!0,!1,U,!1),this.ZJ(ce.UEa,!1,!1,U,!1),this.ia.processAction(L.a.VEa,2)}U.commit();this.Lbk&&cx.ShyRibbon.yQa(1,2);return 32};this.ia=a;this.Lbk=f;this.la=l;this.lma=new Vc.a;this.Hea=new Vc.a;for(const w of wq.cfe){a="";switch(w){case ce.dB:a="#000000";break;case ce.dE:a="#E71224";break;case ce.cE:a="#FFFC00"}this.lma.$(w,Object.assign(new nG,{selected:!1,iconColor:a}))}u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb&&
u.AFrameworkApplication.Aa.hb.Pp&&this.wb();this.JWa=new Ka.a;this.JWa.add("#FFC114");this.JWa.add("#F6630D");this.JWa.add("#FF0066");this.JWa.add("#5B2D90");this.VCb=new Ka.a;this.VCb.add("#00F900");this.VCb.add("#00FDFF");this.VCb.add("#FF40FF");this.VCb.add("#FF8517");this.nB=ce.dB;b.ZGc(Object(F.a)(this,this.EU,"onFocusChanged"));this.Xcb=!c||!c.Ic}wb(){this.ia.ra(L.a.dfe,Cb.a.application,Object(F.a)(this,this.RRi,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.ra(L.a.ufg,Cb.a.application,Object(F.a)(this,
this.Lwj,"handleRefreshInkUIValues"),4);this.ia.ra(L.a.FXc,Cb.a.application,Object(F.a)(this,this.auj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.ra(L.a.iod,Cb.a.application,this.X8,4);this.ia.ra(L.a.jod,Cb.a.application,this.X8,4);this.ia.ra(L.a.god,Cb.a.application,this.X8,4);this.ia.ra(L.a.kod,Cb.a.application,this.X8,4);this.ia.ra(L.a.$nd,Cb.a.application,this.X8,4);this.ia.ra(L.a.aod,Cb.a.application,this.X8,4);this.ia.ra(L.a.bod,Cb.a.application,this.X8,4);this.ia.ra(L.a.cod,Cb.a.application,
this.X8,4);this.ia.ra(L.a.dod,Cb.a.application,this.X8,4);this.ia.ra(L.a.eod,Cb.a.application,this.X8,4);this.ia.ra(L.a.RUe,Cb.a.application,Object(F.a)(this,this.hce,"handleThicknessSliderChanged"),4);this.ia.ra(L.a.SUe,Cb.a.application,Object(F.a)(this,this.hce,"handleThicknessSliderChanged"),4);this.ia.ra(L.a.TUe,Cb.a.application,Object(F.a)(this,this.hce,"handleThicknessSliderChanged"),4);this.ia.ra(L.a.QUe,Cb.a.application,Object(F.a)(this,this.Ztj,"handleInkDrawWithTouchSelected"),4);this.ia.ra(L.a.fod,
Cb.a.application,this.X8,4);this.ia.ra(L.a.hod,Cb.a.application,this.X8,4);this.ia.ra(L.a.OKa,Cb.a.application,this.X8,4)}auj(a,b,c,f,l){if(1===c)return 32;this.Xcb=l;return 32}Lwj(a,b,c){if(1===c)return 32;a=new Js;this.YLb(ce.WEa,this.tXa,a);this.YLb(ce.XEa,this.uXa,a);this.YLb(ce.YEa,this.sXa,a);a.commit();this.Hea.count||this.B1j();return 32}Ztj(a,b,c,f,l){if(1===c)return this.Xcb?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.lma.ga(ce.UEa).selected||a?(this.iKc(!1),this.yPf()):(this.iKc(!1),
a=new Js,this.ZJ(ce.UEa,!0,!1,a,!1),this.ZJ(this.nB,!0,!0,a,!0),a.commit(),this.ia.La(L.a.bfe,2,{enable:!0}));return 32}hce(a,b,c,f,l){if(1===c)return 32;b=new Js;this.ZJ(ce.UEa,!0,!1,b,!1);l&&l&&(l[wq.Lpl]=Xo.Value);switch(a){case L.a.RUe:this.ia.La(L.a.WEa,2,l);this.tXa=this.t$a(l);this.YLb(ce.WEa,this.tXa,b);this.nB=ce.dB;break;case L.a.SUe:this.ia.La(L.a.XEa,2,l);this.uXa=this.t$a(l);this.YLb(ce.XEa,this.uXa,b);this.nB=ce.dE;break;case L.a.TUe:this.ia.La(L.a.YEa,2,l),this.sXa=this.t$a(l),this.YLb(ce.YEa,
this.sXa,b),this.nB=ce.cE}b.commit();return 32}isEnabled(a){return this.lma.ga(a).selected}RRi(a,b,c){if(1===c)return 32;if(!Sg.c())return va.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.Hea.count)return 32;this.iKc(!1);this.yPf();this.lma.ga(this.nB).selected=!1;a=new Js;this.ZJ(this.nB,!0,!0,a,!0);this.ia.processAction(L.a.tfg,2);a.commit();return 32}B1j(){for(const a of wq.cfe)switch(a){case ce.dB:this.vbc(ce.dB);break;case ce.dE:this.vbc(ce.dE);
break;case ce.cE:this.vbc(ce.cE);break;case ce.b9:this.vbc(ce.b9);break;case ce.c9:this.vbc(ce.c9)}}vbc(a){const b=appChrome.selectors.getInkButtonState(a);this.Hea.$(a,Object.assign(new oG,{label:ce.aYf in b?Object(qa.a)(String,b[ce.aYf]):"",LEa:ce.ZXf in b?Object(qa.a)(String,b[ce.ZXf]):"",keytip:ce.$Xf in b?Object(qa.a)(String,b[ce.$Xf]):""}))}iKc(a){const b=new Js;for(const c of wq.cfe)if(c!==ce.Zta)switch(this.ZJ(c,!1,!1,b,!0),c){case ce.dB:this.Otb(ce.dB,b,!0,a);break;case ce.dE:this.Otb(ce.dE,
b,!0,a);break;case ce.cE:this.Otb(ce.cE,b,!0,a);break;case ce.b9:this.Otb(ce.b9,b,!0,a);break;case ce.c9:this.Otb(ce.c9,b,!0,a)}b.commit()}bJh(a,b,c){c.ya(appChrome.actions.toggleButton(a,b));this.lma.ga(a).selected=b}ZJ(a,b,c,f,l){c?b?(b&&!this.lma.ga(a).selected&&this.kxi(a,f,l),this.bJh(a,b,f)):this.Otb(a,f,l,a!==ce.VEa):this.bJh(a,b,f)}Otb(a,b,c,f){if(this.Hea.Gb(a)){var l=this.Hea.ga(a).LEa,w=this.Hea.ga(a).keytip,H=this.Hea.ga(a).label,U=this.K6d(a);a=appChrome.api.createInkButtonModel(a,U?
U:H,Object.assign(new lG,{iconSet:(new yp.a(l)).iconSet,iconColor:this.lma.ga(a).iconColor,keytip:w,animateTransition:c&&!f}));b.ya(appChrome.actions.addControls([a]))}}kxi(a,b,c){if(this.Hea.Gb(a)){var f=this.K6d(a),l=this.Hea.ga(a).LEa,w=this.Hea.ga(a).keytip,H=this.Hea.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,f?f:H,Object.assign(new mG,{iconSet:(new yp.a(l)).iconSet,iconColor:this.lma.ga(a).iconColor,keytip:w,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));
b.ya(appChrome.actions.addControls([a]))}}K6d(a){if(this.la.ka("InkColorLabelEnabled")){var b=void 0;switch(a){case ce.dB:case ce.dE:var c=appChrome.selectors.getColorPickerState(ce.Fda);break;case ce.cE:c=appChrome.selectors.getColorPickerState(ce.Yta)}c&&(c=this.oKf(Array.isArray(c.colorCells)?c.colorCells:null),b=this.Hea.ga(a).label,b=`${b.split(":")[0]}: ${c[this.lma.ga(a).iconColor].label}`);return b}}zcl(a,b,c){c.ya(appChrome.actions.updateIconColor(a,b));this.Acl(a,c)}Acl(a,b){let c=this.K6d(a);
c&&b.ya(appChrome.actions.setControlLabel(a,c))}Bcl(a,b,c){c.ya(appChrome.actions.populateColorPickerCells(a,b))}YLb(a,b,c){c.ya(appChrome.actions.updateSliderSelectedValue(a,b))}sHk(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.oKf(Array.isArray(a.colorCells)?a.colorCells:null);for(const l of b)this.Bcl(l,this.Fdj(a,c),f)}}Gdj(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}oKf(a){const b={};for(const c of a)b[c.id]=c;return b}Fdj(a,b){const c=
[];for(let f of b)f in a&&Array.add(c,a[f]);return c}Cle(a){return a&&a.InputMethod?a.InputMethod===ce.gfe:!1}bYe(a){return!a||B.a.Pi||B.a.F9b}vjj(a,b){a&&a.Color&&(b=6===Object(qa.a)(String,a.Color).length?"#"+a.Color:Object(qa.a)(String,a.Color));return b}nLb(a,b,c,f,l,w,H){l=this.vjj(w,l);this.lma.ga(a).iconColor=l;this.zcl(a,l,H);this.Gdj(b,l);this.sHk(c,f,b,H)}yPf(){const a=new Js;this.ZJ(ce.UEa,!1,!1,a,!1);this.ia.La(L.a.bfe,2,{enable:!1});a.commit()}EU(a,b){b.UIb===Lb.a.ZO&&b.Hgb!==Lb.a.ZO&&
this.ia.processAction(L.a.sfg,2);b.UIb!==Lb.a.sg&&b.Hgb===Lb.a.sg&&this.ia.processAction(L.a.wfg,2)}t$a(a){return a&&a[Xo.Value]?a[Xo.Value]:wq.YIc}}wq.Lpl="SliderCommandPropertiesValueKey";wq.YIc=3;wq.cfe=[ce.dB,ce.dE,ce.UEa,ce.b9,ce.cE,ce.Zta,ce.c9,ce.VEa];Object(n.a)(wq,"InkRibbonManager",null,[364]);class pG{constructor(a){this.bre=a}get Gya(){return this.bre.Gya}XSc(){return this.bre.XSc()}RSe(){this.bre.RSe()}}Object(n.a)(pG,"PPTChromeExtensionHelper",null,[357,551]);var Ra=d(533);class jh{constructor(a,
b){this.populateQueryCommandId=null;this.populateOnlyOnce=!1;this.populateQueryCommandId=a;this.populateOnlyOnce=b}}Object(n.a)(jh,"MenuPopulationProperties",null,[]);class dx{constructor(){this.zxc={};this.wxc={};this.aqf={};this.xxc={};this.rCd={};this.sCd={};this.aDd={};this.M5h()}XDa(a){return this.wxc[a]}v7d(a){return this.xxc[a]}Saj(a){return this.rCd[a]}getCommandByExternalUxId(a){return this.zxc[a]}mae(a){return this.aqf[a]}m2f(a){if(a in this.aDd)return this.aDd[a];ka.ULS.sendTraceTag(39946131,
306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",a);return"MissingIcon_20"}Raj(a){return this.sCd[a]}Asf(a){this.addCommandToMaps(a)}addCommandToMaps(a){var b=this.zxc[a.externalUxCommand];if(b){delete this.zxc[b.externalUxCommand];const c=this.wxc[b.commandId];for(let f=0;f<c.length;f++)if(c[f].externalUxCommand===b.externalUxCommand){Array.remove(c,c[f]);break}}this.zxc[a.externalUxCommand]=a;b=this.wxc[a.commandId];if(void 0===b||null===
b)b=[],this.wxc[a.commandId]=b;b.push(a);a.legacyControlId&&(this.xxc[a.legacyControlId]||(this.xxc[a.legacyControlId]=new Ka.a),this.xxc[a.legacyControlId].add(a.externalUxCommand))}addTabToMap(a,b){this.aqf[a]=b}addIconToMap(a,b){this.aDd[b]=a}Hi(a){if(a.legacyGroupId){var b=this.rCd[a.legacyGroupId];b||(b=[],this.rCd[a.legacyGroupId]=b);b.push(a)}a.externalUxGroupId&&(b=this.sCd[a.externalUxGroupId],b||(b=[],this.sCd[a.externalUxGroupId]=b),b.push(a))}M5h(){this.addCommandToMaps(Object.assign(new Ra.a("AccessibilityHelp",
"3276527670"),{legacyControlId:"jbtnAccessibilityHelp"}));this.addCommandToMaps(new Ra.a("AlwaysShowRibbon","336231556"));this.addCommandToMaps(new Ra.a("CoauthorsRendered","691867605"));this.addCommandToMaps(Object.assign(new Ra.a("CopyLink","981334692"),{legacyControlId:"CopyLink"}));this.addCommandToMaps(Object.assign(new Ra.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Ra.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",
queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Ra.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"}));this.addCommandToMaps(new Ra.a("CoEditInTeams","327119921"));this.addCommandToMaps(Object.assign(new Ra.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"}));this.addCommandToMaps(Object.assign(new Ra.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(Object.assign(new Ra.a("DownloadACopy",
"3555692408"),{legacyControlId:"jbtnDownloadACopy"}));this.addCommandToMaps(new Ra.a("FileMenuLauncher","1784018444"));this.addCommandToMaps(Object.assign(new Ra.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"}));this.addCommandToMaps(Object.assign(new Ra.a("Help","1454393937"),{legacyControlId:"jbtnHelp"}));this.addCommandToMaps(new Ra.a("HideRibbon","336231556"));this.addCommandToMaps(new Ra.a("InsertAddIns","1945259303"));this.addCommandToMaps(new Ra.a("InsertMoreAddInsFromFooter",
"1945259303"));this.addCommandToMaps(new Ra.a("InsertAddInsFromBackstage","1945259303"));this.addCommandToMaps(new Ra.a("InsertAddinTransitionEntry","1095658066"));this.addCommandToMaps(new Ra.a("InsertComment","2423504651"));this.addCommandToMaps(Object.assign(new Ra.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"}));this.addCommandToMaps(new Ra.a("ManageAccess","981334692"));this.addCommandToMaps(new Ra.a("MenuClose","336231556"));this.addCommandToMaps(new Ra.a("MenuOpen","336231556"));
this.addCommandToMaps(new Ra.a("MenuPopulate","336231556"));this.addCommandToMaps(new Ra.a("TriggerModeSwitcherTUI","1251719100"));this.addCommandToMaps(new Ra.a("MoveToFolder","1182470434"));this.addCommandToMaps(new Ra.a("NavigateToCoauthor","4033456482"));this.addCommandToMaps(new Ra.a("New","1056925771"));this.addCommandToMaps(new Ra.a("NewBrowserSuggestionClicked","3734060499"));this.addCommandToMaps(Object.assign(new Ra.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"}));this.addCommandToMaps(Object.assign(new Ra.a("PeopleWell",
"929022654"),{queryCommandId:"3798167515",populationProps:new jh("1285265560",!1)}));this.addCommandToMaps(Object.assign(new Ra.a("Privacy","1208554566"),{legacyControlId:"jbtnPrivacy"}));this.addCommandToMaps(Object.assign(new Ra.a("Rename","2382951455"),{legacyControlId:"jbtnRenameDialog"}));this.addCommandToMaps(Object.assign(new Ra.a("SaveAs","4246497969"),{legacyControlId:"jbtnSaveACopy"}));this.addCommandToMaps(Object.assign(new Ra.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"}));
this.addCommandToMaps(Object.assign(new Ra.a("SaveToSharePoint","3050207199"),{legacyControlId:"jbtnSaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Ra.a("SearchHelp","2918242107"),{legacyControlId:"btnHelp"}));this.addCommandToMaps(Object.assign(new Ra.a("Share","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Ra.a("ShareTopBar","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartLookUp","1435347209"),
{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Ra.a("TabSwitch","336231556"));this.addCommandToMaps(Object.assign(new Ra.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"}));this.addCommandToMaps(Object.assign(new Ra.a("Training","2918242107"),{legacyControlId:"btnShowTraining"}));this.addCommandToMaps(Object.assign(new Ra.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Ra.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"}));
this.addCommandToMaps(Object.assign(new Ra.a("Zoom","1738002952"),{legacyControlId:"btnViewZoomDialog"}));this.addCommandToMaps(Object.assign(new Ra.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"}));this.addCommandToMaps(new Ra.a("CommitNewDocumentTitle","1808554760"));this.addCommandToMaps(new Ra.a("RibbonModeToggledToMLR","536345575"));this.addCommandToMaps(new Ra.a("RibbonModeToggledToSLR","4031133701"));this.addCommandToMaps(new Ra.a("Workflow",
"2988588587"));this.addCommandToMaps(new Ra.a("ToggleVNextLook","1650341290"));this.addCommandToMaps(Object.assign(new Ra.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(Object.assign(new Ra.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ra.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ra.a("GetHelpFromTellMe2","2918242107"),
{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ra.a("GetHelpWithDescriptionFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ra.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(new Ra.a("AnswerForSearch","1914896509"));this.addCommandToMaps(new Ra.a("AnswerForSearchSingleLine","1914896509"));this.addCommandToMaps(new Ra.a("ReuseFileQuickActionForSearch","1914896509"));
this.addCommandToMaps(new Ra.a("PeopleSuggestion1","2133437452"));this.addCommandToMaps(new Ra.a("PeopleSuggestion2","2133437453"));this.addCommandToMaps(new Ra.a("PeopleSuggestion3","2133437454"));this.addCommandToMaps(new Ra.a("QuickActionOnFile","548581900"));this.addCommandToMaps(new Ra.a("GenerateSlidesFromTellMe","2862675062"));this.addCommandToMaps(new Ra.a("FileSuggestion1","2260671807"));this.addCommandToMaps(new Ra.a("FileSuggestion2","2260671810"));this.addCommandToMaps(new Ra.a("FileSuggestion3",
"2260671809"));this.addCommandToMaps(new Ra.a("FileSuggestion4","2260671804"));this.addCommandToMaps(new Ra.a("FileSuggestion5","2260671803"));this.addCommandToMaps(new Ra.a("NotesSuggestion1","1914896509"));this.addCommandToMaps(new Ra.a("NotesSuggestion2","1914896509"));this.addCommandToMaps(new Ra.a("NotesSuggestion3","1914896509"));this.addCommandToMaps(new Ra.a("OnenoteNotesSuggestion1","4083547050"));this.addCommandToMaps(new Ra.a("OnenoteNotesSuggestion2","4083547053"));this.addCommandToMaps(new Ra.a("OnenoteNotesSuggestion3",
"4083547052"));this.addCommandToMaps(new Ra.a("TellMeFeedback","2230755196"));this.addCommandToMaps(new Ra.a("TemplateForSearch","57037313"));this.addCommandToMaps(new Ra.a("AddinSuggestion1","1385019911"));this.addCommandToMaps(new Ra.a("AddinSuggestion2","981735384"));this.addCommandToMaps(new Ra.a("AddinSuggestion3","2547819325"));this.addCommandToMaps(new Ra.a("LaunchAddinDialogFromTellMe","1421877154"));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.OMb?(this.addCommandToMaps(new Ra.a("FindWithMatchesParameterized",
"1914896509")),this.addCommandToMaps(new Ra.a("FindParameterized","1914896509")),this.addCommandToMaps(new Ra.a("FindInDocumentSuggestion1","1914896509")),this.addCommandToMaps(new Ra.a("FindInDocumentSuggestion2","1914896509")),this.addCommandToMaps(new Ra.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new Ra.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new Ra.a("FindParameterized","1540292897")),this.addCommandToMaps(new Ra.a("FindInDocumentSuggestion1",
"1540292897")),this.addCommandToMaps(new Ra.a("FindInDocumentSuggestion2","1540292897")),this.addCommandToMaps(new Ra.a("FindInDocumentSuggestion3","1540292897")));this.addCommandToMaps(new Ra.a("ImageForSearch","1914896509"));this.addCommandToMaps(new Ra.a("LearningForSearch","1006342541"));this.addCommandToMaps(new Ra.a("SmartLookupFromTellMe","1914896509"));this.addCommandToMaps(new Ra.a("SmartLookupFromTellMeQueryTermAtTop","1914896509"));this.addCommandToMaps(new Ra.a("SmartLookupFromTellMeZeroTerm",
"3359903192"));this.addCommandToMaps(new Ra.a("ActionAIFromTellMe","1914896509"));!u.AFrameworkApplication.bFa||u.AFrameworkApplication.Tya||u.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new Ra.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new Ra.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new Ra.a("AnswerForSearch",
"3317204163")),this.addCommandToMaps(new Ra.a("AnswerForSearchSingleLine","3317204163")));this.addCommandToMaps(Object.assign(new Ra.a("SynonymsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Ra.a("TellMeLogMenuClose","4266170064"));this.addCommandToMaps(new Ra.a("TellMeLogMenuOpen","2480888384"));this.addCommandToMaps(new Ra.a("TellMeMenuItemExecuted","878547493"));this.addCommandToMaps(new Ra.a("TellMeSearchResultChange","2652476189"));this.addCommandToMaps(new Ra.a("TellMeSuggestion_1",
"1404166600"));this.addCommandToMaps(new Ra.a("TellMeSuggestion_2","1404166600"));this.addCommandToMaps(new Ra.a("TellMeSuggestion_3","1404166600"));this.addCommandToMaps(new Ra.a("TellMeSuggestion_4","1404166600"));this.addCommandToMaps(new Ra.a("TellMeSuggestion_5","1404166600"));this.addCommandToMaps(new Ra.a("TryOfficeUpsell","215809929"));this.addCommandToMaps(Object.assign(new Ra.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"}));this.addCommandToMaps(Object.assign(new Ra.a("DiagnosticsSection",
"336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"}));this.addCommandToMaps(Object.assign(new Ra.a("FileAboutPage","336231556"),{legacyControlId:"faAbout"}));this.addCommandToMaps(Object.assign(new Ra.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"}));this.addCommandToMaps(Object.assign(new Ra.a("FileHomePage","2074131365"),{legacyControlId:"faHome"}));this.addCommandToMaps(Object.assign(new Ra.a("FileGetAddinsPage","336231556"),{legacyControlId:"faGetAddinsFromBackstage"}));
this.addCommandToMaps(Object.assign(new Ra.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"}));this.addCommandToMaps(Object.assign(new Ra.a("FileNewPage","2074131365"),{legacyControlId:"faNew"}));this.addCommandToMaps(Object.assign(new Ra.a("FileOpenPage","2799130311"),{legacyControlId:"faOpen"}));this.addCommandToMaps(Object.assign(new Ra.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"}));this.addCommandToMaps(Object.assign(new Ra.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"}));
this.addCommandToMaps(Object.assign(new Ra.a("FileSharePage","336231556"),{legacyControlId:"faShare"}));this.addCommandToMaps(Object.assign(new Ra.a("FileTransformPage","336231556"),{legacyControlId:"faTransform"}));this.addCommandToMaps(new Ra.a("NewDocument","1056925771"));this.addCommandToMaps(new Ra.a("OpenUrlInNewTab","1959943459"));this.addCommandToMaps(new Ra.a("OpenDocumentUrl","2155708348"));this.addCommandToMaps(Object.assign(new Ra.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"}));
this.addCommandToMaps(Object.assign(new Ra.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"}));this.addCommandToMaps(Object.assign(new Ra.a("ThirdPartyNotices","2220417879"),{legacyControlId:"jbtnThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Ra.a("TrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"}));this.addCommandToMaps(Object.assign(new Ra.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Ra.a("TryMacOfficeForWordEditor",
"3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Ra.a("PreviousVersions","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Ra.a("FileVersionHistory","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Ra.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Ra.a("HostConversation","710925581"),{legacyControlId:"HostConversation"}));
this.addCommandToMaps(Object.assign(new Ra.a("HostClose","3033402446"),{legacyControlId:"HostClose"}));this.addCommandToMaps(Object.assign(new Ra.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"}));this.addCommandToMaps(Object.assign(new Ra.a("HostOpenInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"}));this.addCommandToMaps(Object.assign(new Ra.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"}));this.addCommandToMaps(Object.assign(new Ra.a("Sensitivity",
"941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new jh("1145315516",!0)}));this.addCommandToMaps(Object.assign(new Ra.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));Sg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel")&&this.addCommandToMaps(Object.assign(new Ra.a("OpenDocumentShortLabelPane","390001269"),{queryCommandId:"888027492"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertAddInFlyout",
"2749373765"),{populationProps:new jh("1230970894",!1)}));this.addCommandToMaps(Object.assign(new Ra.a("ReloadAddInPicker","2502873265"),{populationProps:new jh("1230970894",!1)}));this.addCommandToMaps(new Ra.a("PopularAddInsListItem0","1497204054"));this.addCommandToMaps(new Ra.a("PopularAddInsListItem1","1497204054"));this.addCommandToMaps(new Ra.a("PopularAddInsListItem2","1497204054"));this.addCommandToMaps(new Ra.a("PopularAddInsListItem3","1497204054"));this.addCommandToMaps(new Ra.a("PopularAddInsListItem4",
"1497204054"));this.addCommandToMaps(new Ra.a("PopularAddInsListItem5","1497204054"));this.addCommandToMaps(new Ra.a("PopularAddInsListItemAdd0","2882601901"));this.addCommandToMaps(new Ra.a("PopularAddInsListItemAdd1","2882601901"));this.addCommandToMaps(new Ra.a("PopularAddInsListItemAdd2","2882601901"));this.addCommandToMaps(new Ra.a("PopularAddInsListItemAdd3","2882601901"));this.addCommandToMaps(new Ra.a("PopularAddInsListItemAdd4","2882601901"));this.addCommandToMaps(new Ra.a("PopularAddInsListItemAdd5",
"2882601901"));this.addCommandToMaps(new Ra.a("SwitchPopularAddIns","152023954"));this.addCommandToMaps(new Ra.a("FreemiumUpsellEligible","1274543852"));this.addCommandToMaps(new Ra.a("FreemiumUpsellDialogShowUI","4180531998"));this.addCommandToMaps(new Ra.a("ReportFreemiumUpsellEligibleDisplayed","2539564555"));this.addCommandToMaps(new Ra.a("HandleDiscoverPremiumButtonClick","2280081216"));this.addCommandToMaps(new Ra.a("RequestFontInfo","3169500754"));this.addCommandToMaps(new Ra.a("PinOrUnpinFont",
"1500655301"));this.addCommandToMaps(new Ra.a("FontPickerMenuClose","146595126"));this.addCommandToMaps(new Ra.a("ShowAccessibilitySettingsDialog","2236763780"));this.addCommandToMaps(Object.assign(new Ra.a("ShowZoomDialog","1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"}));this.addCommandToMaps(Object.assign(new Ra.a("ZoomToPercentage","3745693956"),{queryCommandId:"2901130581",legacyControlId:"ZoomSlider"}));this.addCommandToMaps(new Ra.a("ZoomToPercentageCompleted",
"3139946409"));this.addCommandToMaps(Object.assign(new Ra.a("RecentLinks","2535492938"),{queryCommandId:"2535492938",populationProps:new jh("860679239",!1)}));let a;this.addCommandToMaps((a=new Ra.a("InsertLinkFlyout","1052791248"),a.queryCommandId="1052791248",a.populationProps=new jh("276140882",!1),a))}}Object(n.a)(dx,"ReactCommandDefinitionMapping",null,[1530]);class vg{constructor(a){this.externalUxCommandIds=this.commandId=this.externalUxGroupId=this.legacyGroupId=null;this.legacyGroupId=a}}
Object(n.a)(vg,"GroupMetadata",null,[]);class iB extends dx{constructor(a,b){super();this.b7j="AnimationNone AnimationAppear AnimationFadeIn AnimationFlyIn AnimationSplit AnimationWipe AnimationRandomBars AnimationGrowAndTurn AnimationZoom AnimationBasicZoom AnimationBlinds AnimationBox AnimationCheckerboard AnimationExpand AnimationPeekIn AnimationRiseUp AnimationStretch AnimationStrips AnimationEmphasis_Spin AnimationEmphasis_GrowShrink AnimationEmphasis_Transparency AnimationEmphasis_LineColor AnimationEmphasis_FillColor AnimationEmphasis_FontColor AnimationExit_Disappear AnimationExit_Fade AnimationExit_FlyOut AnimationExit_Split AnimationExit_Wipe AnimationExit_RandomBars AnimationExit_Zoom AnimationExit_BasicZoom AnimationExit_Blinds AnimationExit_Box AnimationExit_Checkerboard AnimationExit_PeekOut AnimationExit_Stretchy AnimationExit_Strips AnimationGalleryNone AnimationGalleryEntrance AnimationGalleryEmphasis AnimationGalleryExit".split(" ");
this.Z6j=26;this.Y6j="AnimationEffectOptionsDataSpin_Quarter AnimationEffectOptionsDataSpin_Half AnimationEffectOptionsDataSpin_Full AnimationEffectOptionsDataSpin_Two AnimationEffectOptionsDataTransparency_25 AnimationEffectOptionsDataTransparency_50 AnimationEffectOptionsDataTransparency_75 AnimationEffectOptionsDataTransparency_100 AnimationEffectOptionsDataGrowShrink_Tiny AnimationEffectOptionsDataGrowShrink_Smaller AnimationEffectOptionsDataGrowShrink_Larger AnimationEffectOptionsDataGrowShrink_Huge".split(" ");
this.a7j=31;this.$6j="AnimationEffectOptionsDirectionFromBottom AnimationEffectOptionsDirectionFromBottomLeft AnimationEffectOptionsDirectionFromLeft AnimationEffectOptionsDirectionFromTopLeft AnimationEffectOptionsDirectionFromTop AnimationEffectOptionsDirectionFromTopRight AnimationEffectOptionsDirectionFromRight AnimationEffectOptionsDirectionFromBottomRight AnimationEffectOptionsDirectionToBottom AnimationEffectOptionsDirectionToBottomLeft AnimationEffectOptionsDirectionToLeft AnimationEffectOptionsDirectionToTopLeft AnimationEffectOptionsDirectionToTop AnimationEffectOptionsDirectionToTopRight AnimationEffectOptionsDirectionToRight AnimationEffectOptionsDirectionToBottomRight AnimationEffectOptionsDirectionHorizontal AnimationEffectOptionsDirectionHorizontalIn AnimationEffectOptionsDirectionHorizontalOut AnimationEffectOptionsDirectionVertical AnimationEffectOptionsDirectionVerticalIn AnimationEffectOptionsDirectionVerticalOut AnimationEffectOptionsDirectionLeftDown AnimationEffectOptionsDirectionLeftUp AnimationEffectOptionsDirectionRightDown AnimationEffectOptionsDirectionRightUp AnimationEffectOptionsDirectionIn AnimationEffectOptionsDirectionInBottom AnimationEffectOptionsDirectionInCenter AnimationEffectOptionsDirectionInSlightly AnimationEffectOptionsDirectionOut AnimationEffectOptionsDirectionOutBottom AnimationEffectOptionsDirectionOutCenter AnimationEffectOptionsDirectionOutSlightly AnimationEffectOptionsDirectionFloatUp AnimationEffectOptionsDirectionFloatDown AnimationEffectOptionsDirectionObjectCenter AnimationEffectOptionsDirectionSlideCenter AnimationEffectOptionsDirectionObjectCenterOut AnimationEffectOptionsDirectionSlideCenterOut AnimationEffectOptionsDirectionClockwise AnimationEffectOptionsDirectionCounterClockwise AnimationEffectOptionsDirectionAcross AnimationEffectOptionsDirectionUp AnimationEffectOptionsDirectionDown AnimationEffectOptionsDirectionGrowShrinkHorizontal AnimationEffectOptionsDirectionGrowShrinkVertical AnimationEffectOptionsDirectionGrowShrinkBoth".split(" ");
this.Ajk=23;this.zjk="TransitionEffectOptionsTransitionExisting TransitionEffectOptionsTransitionExistingInMenu TransitionEffectOptionsTransitionNone TransitionEffectOptionsTransitionFade TransitionEffectOptionsTransitionFadeSmoothly TransitionEffectOptionsTransitionFadeThroughBlack TransitionEffectOptionsTransitionPush TransitionEffectOptionsTransitionPushFromBottom TransitionEffectOptionsTransitionPushFromLeft TransitionEffectOptionsTransitionPushFromRight TransitionEffectOptionsTransitionPushFromTop TransitionEffectOptionsTransitionCut TransitionEffectOptionsTransitionCutNone TransitionEffectOptionsTransitionCutThroughBlack TransitionEffectOptionsTransitionWipe TransitionEffectOptionsTransitionWipeFromRight TransitionEffectOptionsTransitionWipeFromTop TransitionEffectOptionsTransitionWipeFromLeft TransitionEffectOptionsTransitionWipeFromBottom TransitionEffectOptionsTransitionWipeFromTopRight TransitionEffectOptionsTransitionWipeFromBottomRight TransitionEffectOptionsTransitionWipeFromTopLeft TransitionEffectOptionsTransitionWipeFromBottomLeft TransitionEffectOptionsTransitionMorph TransitionEffectOptionsTransitionMorphByObject TransitionEffectOptionsTransitionMorphByWord TransitionEffectOptionsTransitionMorphByChar TransitionEffectOptionsTransitionSplit TransitionEffectOptionsTransitionSplitVerticalOut TransitionEffectOptionsTransitionSplitHorizontalIn TransitionEffectOptionsTransitionSplitHorizontalOut TransitionEffectOptionsTransitionSplitVerticalIn TransitionEffectOptionsTransitionRandom TransitionEffectOptionsTransitionRandomBars TransitionEffectOptionsTransitionRandomBarsVertical TransitionEffectOptionsTransitionRandomBarsHorizontal TransitionEffectOptionsTransitionShape TransitionEffectOptionsTransitionShapeCircle TransitionEffectOptionsTransitionShapeDiamond TransitionEffectOptionsTransitionShapePlus TransitionEffectOptionsTransitionShapeIn TransitionEffectOptionsTransitionShapeOut TransitionEffectOptionsTransitionCombHorizontal TransitionEffectOptionsTransitionCombVertical TransitionEffectOptionsTransitionWheelClockwise TransitionEffectOptionsTransitionWheelCounterclockwise TransitionEffectOptionsTransitionWheelWedge TransitionEffectOptionsTransitionRevealFromLeft TransitionEffectOptionsTransitionRevealFromRight TransitionEffectOptionsTransitionRevealSmoothlyFromLeft TransitionEffectOptionsTransitionRevealSmoothlyFromRight TransitionEffectOptionsTransitionDissolve TransitionEffectOptionsTransitionBlindsHorizontal TransitionEffectOptionsTransitionBlindsVertical TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionCoverFromBottom TransitionEffectOptionsTransitionCoverFromBottomLeft TransitionEffectOptionsTransitionCoverFromBottomRight TransitionEffectOptionsTransitionCoverFromLeft TransitionEffectOptionsTransitionCoverFromRight TransitionEffectOptionsTransitionCoverFromTop TransitionEffectOptionsTransitionCoverFromTopLeft TransitionEffectOptionsTransitionCoverFromTopRight TransitionEffectOptionsTransitionUncoverFromBottom TransitionEffectOptionsTransitionUncoverFromBottomLeft TransitionEffectOptionsTransitionUncoverFromBottomRight TransitionEffectOptionsTransitionUncoverFromLeft TransitionEffectOptionsTransitionUncoverFromRight TransitionEffectOptionsTransitionUncoverFromTop TransitionEffectOptionsTransitionUncoverFromTopLeft TransitionEffectOptionsTransitionUncoverFromTopRight TransitionEffectOptionsTransitionRippleCenter TransitionEffectOptionsTransitionRippleBottomLeft TransitionEffectOptionsTransitionRippleBottomRight TransitionEffectOptionsTransitionRippleTopRight TransitionEffectOptionsTransitionRippleTopLeft TransitionEffectOptionsTransitionCubeFromBottom TransitionEffectOptionsTransitionCubeFromLeft TransitionEffectOptionsTransitionCubeFromRight TransitionEffectOptionsTransitionCubeFromTop TransitionEffectOptionsTransitionBoxFromBottom TransitionEffectOptionsTransitionBoxFromLeft TransitionEffectOptionsTransitionBoxFromRight TransitionEffectOptionsTransitionBoxFromTop TransitionEffectOptionsTransitionSwitchLeft TransitionEffectOptionsTransitionSwitchRight TransitionEffectOptionsTransitionFallOverLeft TransitionEffectOptionsTransitionFallOverRight TransitionEffectOptionsTransitionDrapeLeft TransitionEffectOptionsTransitionDrapeRight TransitionEffectOptionsTransitionFlipLeft TransitionEffectOptionsTransitionFlipRight TransitionEffectOptionsTransitionWindLeft TransitionEffectOptionsTransitionWindRight TransitionEffectOptionsTransitionPrestige TransitionEffectOptionsTransitionFracture TransitionEffectOptionsTransitionCrush TransitionEffectOptionsTransitionPeelOffLeft TransitionEffectOptionsTransitionPeelOffRight TransitionEffectOptionsTransitionPageCurlSingleLeft TransitionEffectOptionsTransitionPageCurlSingleRight TransitionEffectOptionsTransitionPageCurlDoubleLeft TransitionEffectOptionsTransitionPageCurlDoubleRight TransitionEffectOptionsTransitionAirplaneLeft TransitionEffectOptionsTransitionAirplaneRight TransitionEffectOptionsTransitionOrigamiLeft TransitionEffectOptionsTransitionOrigamiRight TransitionEffectOptionsTransitionCheckerFromLeft TransitionEffectOptionsTransitionCheckerFromTop TransitionEffectOptionsTransitionVortexFromLeft TransitionEffectOptionsTransitionVortexFromTop TransitionEffectOptionsTransitionVortexFromRight TransitionEffectOptionsTransitionVortexFromBottom TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionGlitterHexagonLeft TransitionEffectOptionsTransitionGlitterHexagonTop TransitionEffectOptionsTransitionGlitterHexagonRight TransitionEffectOptionsTransitionGlitterHexagonBottom TransitionEffectOptionsTransitionGlitterDiamondLeft TransitionEffectOptionsTransitionGlitterDiamondTop TransitionEffectOptionsTransitionGlitterDiamondRight TransitionEffectOptionsTransitionGlitterDiamondBottom TransitionEffectOptionsTransitionOrbitFromTop TransitionEffectOptionsTransitionOrbitFromBottom TransitionEffectOptionsTransitionOrbitFromLeft TransitionEffectOptionsTransitionOrbitFromRight TransitionEffectOptionsTransitionRotateFromTop TransitionEffectOptionsTransitionRotateFromBottom TransitionEffectOptionsTransitionRotateFromLeft TransitionEffectOptionsTransitionRotateFromRight TransitionEffectOptionsTransitionConveyorFromRight TransitionEffectOptionsTransitionConveyorFromLeft TransitionEffectOptionsTransitionGalleryIconFromRight TransitionEffectOptionsTransitionGalleryIconFromLeft TransitionEffectOptionsTransitionPanFromBottom TransitionEffectOptionsTransitionPanFromLeft TransitionEffectOptionsTransitionPanFromRight TransitionEffectOptionsTransitionPanFromTop TransitionEffectOptionsTransitionDoorsVertical TransitionEffectOptionsTransitionDoorsHorizontal TransitionEffectOptionsTransitionWindowVertical TransitionEffectOptionsTransitionWindowHorizontal TransitionEffectOptionsTransitionZoomIn TransitionEffectOptionsTransitionZoomOut TransitionEffectOptionsTransitionZoomAndRotate TransitionEffectOptionsTransitionFlyThroughIn TransitionEffectOptionsTransitionFlyThroughOut TransitionEffectOptionsTransitionFlyThroughInWithBounce TransitionEffectOptionsTransitionFlyThroughOutWithBounce".split(" ");
this.jek="PictureStyles_SimpleFrameWhite_15505 PictureStyles_BeveledMatteWhite_15506 PictureStyles_MetalFrame_15507 PictureStyles_DropShadowRectangle_15508 PictureStyles_ReflectedRoundedRectangle_15509 PictureStyles_SoftEdgeRectangle_15510 PictureStyles_DoubleFrameBlack_15511 PictureStyles_ThickMatteBlack_15512 PictureStyles_SimpleFrameBlack_15513 PictureStyles_BeveledOvalBlack_15514 PictureStyles_CompoundFrameBlack_15515 PictureStyles_ModerateFrameBlack_15516 PictureStyles_CenterShadowRectangle_15517 PictureStyles_RoundedDiagonalCornerWhite_15518 PictureStyles_SnipDiagonalCornerWhite_15519 PictureStyles_ModerateFrameWhite_15520 PictureStyles_RotatedWhite_15521 PictureStyles_PerspectiveShadowWhite_15522 PictureStyles_RelaxedPerspectiveWhite_15523 PictureStyles_SoftEdgeOval_15524 PictureStyles_BevelEdgeRectangle_15525 PictureStyles_BevelPerspective_15526 PictureStyles_ReflectedPerspectiveRight_15527 PictureStyles_BevelPerspectiveLeftWhite_15528 PictureStyles_ReflectedBevelBlack_15529 PictureStyles_ReflectedBevelWhite_15530 PictureStyles_MetalRoundedRectangle_15531 PictureStyles_MetalOval_15532".split(" ");
this.iek="PictureCrop_ShapeAlternateProcess_126 PictureCrop_ShapeArc_84 PictureCrop_ShapeBentArrow_28 PictureCrop_ShapeBentUpArrow_31 PictureCrop_ShapeBevel_74 PictureCrop_ShapeBlockArc_77 PictureCrop_ShapeCan_7 PictureCrop_ShapeCard_139 PictureCrop_ShapeChevron_38 PictureCrop_ShapeChord_66 PictureCrop_ShapeCircularArrow_45 PictureCrop_ShapeCloud_83 PictureCrop_ShapeCloudCallout_93 PictureCrop_ShapeCollate_143 PictureCrop_ShapeConnector_137 PictureCrop_ShapeCross_72 PictureCrop_ShapeCube_8 PictureCrop_ShapeCurvedArrowConnector_153 PictureCrop_ShapeCurvedConnector_25 PictureCrop_ShapeCurvedDoubleArrowConnector_154 PictureCrop_ShapeCurvedDownArrow_46 PictureCrop_ShapeCurvedDownRibbon_120 PictureCrop_ShapeCurvedLeftArrow_33 PictureCrop_ShapeCurvedRightArrow_32 PictureCrop_ShapeCurvedUpArrow_34 PictureCrop_ShapeCurvedUpRibbon_119 PictureCrop_ShapeData_128 PictureCrop_ShapeDecagon_63 PictureCrop_ShapeDecision_127 PictureCrop_ShapeDelay_148 PictureCrop_ShapeDiagonalStripe_71 PictureCrop_ShapeDiamond_58 PictureCrop_ShapeDirectAccessStorage_151 PictureCrop_ShapeDisplay_152 PictureCrop_ShapeDocument_131 PictureCrop_ShapeDodecagon_64 PictureCrop_ShapeDonut_75 PictureCrop_ShapeDoubleBrace_86 PictureCrop_ShapeDoubleBracket_85 PictureCrop_ShapeDoubleWave_124 PictureCrop_ShapeDownArrow_0 PictureCrop_ShapeDownArrowCallout_40 PictureCrop_ShapeDownRibbon_118 PictureCrop_ShapeElbowArrowConnector_155 PictureCrop_ShapeElbowConnector_26 PictureCrop_ShapeElbowDoubleArrowConnector_156 PictureCrop_ShapeEllipse_9 PictureCrop_ShapeExplosion1_106 PictureCrop_ShapeExplosion2_107 PictureCrop_ShapeExtract_145 PictureCrop_ShapeFoldedCorner_78 PictureCrop_ShapeFrame_68 PictureCrop_ShapeGallery PictureCrop_ShapeHalfFrame_69 PictureCrop_ShapeHeart_18 PictureCrop_ShapeHeptagon_61 PictureCrop_ShapeHexagon_60 PictureCrop_ShapeHorizontalScroll_122 PictureCrop_ShapeInternalStorage_130 PictureCrop_ShapeLeftArrow_1 PictureCrop_ShapeLeftArrowCallout_41 PictureCrop_ShapeLeftBrace_89 PictureCrop_ShapeLeftBracket_87 PictureCrop_ShapeLeftRightArrow_2 PictureCrop_ShapeLeftRightArrowCallout_43 PictureCrop_ShapeLeftRightUpArrow_27 PictureCrop_ShapeLeftUpArrow_30 PictureCrop_ShapeLightningBolt_80 PictureCrop_ShapeLineCallout1_94 PictureCrop_ShapeLShape_70 PictureCrop_ShapeMagneticDisk_150 PictureCrop_ShapeManualInput_135 PictureCrop_ShapeManualOperation_136 PictureCrop_ShapeMathDivide_22 PictureCrop_ShapeMathEqual_23 PictureCrop_ShapeMathMinus_20 PictureCrop_ShapeMathMultiply_21 PictureCrop_ShapeMathNotEqual_24 PictureCrop_ShapeMathPlus_19 PictureCrop_ShapeMerge_146 PictureCrop_ShapeMoon_82 PictureCrop_ShapeMultidocument_132 PictureCrop_ShapeNoSymbol_76 PictureCrop_ShapeNotchedRightArrow_36 PictureCrop_ShapeOctagon_62 PictureCrop_ShapeOffpageConnector_138 PictureCrop_ShapeOr_142 PictureCrop_ShapeOvalCallout_92 PictureCrop_ShapeParallelogram_56 PictureCrop_ShapePentagon_37 PictureCrop_ShapePie_65 PictureCrop_ShapePlaque_73 PictureCrop_ShapePredefinedProcess_129 PictureCrop_ShapePreparation_134 PictureCrop_ShapeProcess_125 PictureCrop_ShapePunchedTape_140 PictureCrop_ShapeQuadArrow_47 PictureCrop_ShapeQuadArrowCallout_44 PictureCrop_ShapeRectangle_10 PictureCrop_ShapeRectangularCallout_91 PictureCrop_ShapeRightArrow_3 PictureCrop_ShapeRightArrowCallout_39 PictureCrop_ShapeRightBrace_90 PictureCrop_ShapeRightBracket_88 PictureCrop_ShapeRightTriangle_55 PictureCrop_ShapeRoundDiagonalCornerRectangle_48 PictureCrop_ShapeRoundedRectangle_11 PictureCrop_ShapeRoundedRectangleCallout_6 PictureCrop_ShapeRoundSameSideCornerRectangle_49 PictureCrop_ShapeRoundSingleCornerRectangle_50 PictureCrop_ShapeSequentialActionStorage PictureCrop_ShapeSequentialActionStorage_149 PictureCrop_ShapeSmileyFace_79 PictureCrop_ShapeSnipDiagonalCornerRectangle_52 PictureCrop_ShapeSnipRoundSingleCornerRectangle_51 PictureCrop_ShapeSnipSameSideCornerRectangle_53 PictureCrop_ShapeSnipSingleCornerRectangle_54 PictureCrop_ShapeSort_144 PictureCrop_ShapeSPentagon_59 PictureCrop_ShapeStar10_112 PictureCrop_ShapeStar12_113 PictureCrop_ShapeStar16_114 PictureCrop_ShapeStar24_115 PictureCrop_ShapeStar32_116 PictureCrop_ShapeStar4_108 PictureCrop_ShapeStar5_15 PictureCrop_ShapeStar6_109 PictureCrop_ShapeStar7_110 PictureCrop_ShapeStar8_111 PictureCrop_ShapeStoredData_147 PictureCrop_ShapeStraightConnector_12 PictureCrop_ShapeStraightConnectorArrow_13 PictureCrop_ShapeStraightConnectorTwoArrow_14 PictureCrop_ShapeStripedRightArrow_35 PictureCrop_ShapeSummingJunction_141 PictureCrop_ShapeSun_81 PictureCrop_ShapeTeardrop_67 PictureCrop_ShapeTerminator_133 PictureCrop_ShapeTrapezoid_57 PictureCrop_ShapeTriangle_17 PictureCrop_ShapeUpArrow_4 PictureCrop_ShapeUpArrowCallout_42 PictureCrop_ShapeUpDownArrow_5 PictureCrop_ShapeUpRibbon_117 PictureCrop_ShapeUTurnArrow_29 PictureCrop_ShapeVerticalScroll_121 PictureCrop_ShapeWave_123".split(" ");
this.a$j=["FormatBackgroundStandardColorsFromCanvas","FormatBackgroundThemeColorsFromCanvas","FormatBackgroundThemeColorsFromCanvasMCU"];this.UUg="SmartArtLayouts__orgChart1__hierarchy SmartArtLayouts__hList1__list SmartArtLayouts__vList2__list SmartArtLayouts__hierarchy1__hierarchy SmartArtLayouts__chevron2__process SmartArtLayouts__process3__process SmartArtLayouts__hProcess4__process SmartArtLayouts__process5__process SmartArtLayouts__default__list SmartArtLayouts__chevron1__process SmartArtLayouts__cycle2__cycle SmartArtLayouts__process1__process SmartArtLayouts__pyramid1__pyramid SmartArtLayouts__hProcess11__process SmartArtLayouts__cycle5__cycle SmartArtLayouts__lProcess3__process SmartArtLayouts__bProcess2__process SmartArtLayouts__hChevron3__process SmartArtLayouts__hProcess3__process SmartArtLayouts__hProcess9__process SmartArtLayouts__cycle3__cycle SmartArtLayouts__arrow5__relationship SmartArtLayouts__hProcess7__process SmartArtLayouts__arrow1__relationship SmartArtLayouts__equation1__relationship SmartArtLayouts__lProcess2__list SmartArtLayouts__hierarchy3__hierarchy SmartArtLayouts__hierarchy2__hierarchy SmartArtLayouts__hierarchy5__hierarchy SmartArtLayouts__pyramid3__pyramid SmartArtLayouts__hierarchy6__hierarchy SmartArtLayouts__venn3__relationship SmartArtLayouts__cycle7__cycle SmartArtLayouts__cycle6__cycle SmartArtLayouts__hProcess6__process SmartArtLayouts__lProcess1__process SmartArtLayouts__pyramid2__pyramid SmartArtLayouts__radial2__relationship SmartArtLayouts__bProcess3__process SmartArtLayouts__process4__process SmartArtLayouts__hList9__list SmartArtLayouts__hierarchy4__hierarchy SmartArtLayouts__hList3__list SmartArtLayouts__cycle1__cycle SmartArtLayouts__hList6__list SmartArtLayouts__arrow2__process SmartArtLayouts__vList6__process SmartArtLayouts__bProcess4__process SmartArtLayouts__list1__list SmartArtLayouts__equation2__relationship SmartArtLayouts__process2__process SmartArtLayouts__BasicTimeline__timeline SmartArtLayouts__HexagonTimeline__timeline SmartArtLayouts__RoundedRectangleTimeline__timeline SmartArtLayouts__DropPinTimeline__timeline SmartArtLayouts__HorizontalLabelsTimeline__timeline SmartArtLayouts__HorizontalPathTimeline__timeline SmartArtLayouts__AccentHomeChevronProcess__timeline".split(" ");
this.la=a;this.Qb=b;this.QOd();this.g6h();this.Q5h();this.P5h();this.T5h();this.W5h();this.Y5h();this.f6h();this.Z5h();this.V5h();this.S5h();this.c6h();this.$5h();this.a6h();this.e6h();this.CPd();this.W6h();this.d6h();this.d7h();this.N5h();this.U5h();this.R5h();this.O5h();this.X5h();this.b6h()}d7h(){this.addIconToMap("CheckMark_20","per_QuickSearchCompletedToday_16x16x32");this.addIconToMap("Info_20","per_Info_16x16x32")}QOd(){this.addCommandToMaps(new Ra.a("AddSection",L.a.i6a.toString()));this.addCommandToMaps(new Ra.a("AlternativeText",
L.a.Lrb.toString()));this.addCommandToMaps(new Ra.a("AlignAnchor",L.a.Awf.toString()));this.addCommandToMaps(Object.assign(new Ra.a("AlwaysUseSubtitles",L.a.bMa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:L.a.YZa.toString()}));this.addCommandToMaps(new Ra.a("ArrangeAnchor",L.a.fsb.toString()));this.addCommandToMaps(Object.assign(new Ra.a("AudioSettings",L.a.drd.toString()),{queryCommandId:L.a.JJb.toString()}));this.addCommandToMaps(new Ra.a("LivePollTaskPane",L.a.frd.toString()));
this.addCommandToMaps(new Ra.a("ArrangeShapeAnchor",L.a.fsb.toString()));this.addCommandToMaps(new Ra.a("BeginEditShapeText",L.a.H6a.toString()));this.addCommandToMaps(Object.assign(new Ra.a("Bold",L.a.vIb.toString()),{queryCommandId:L.a.uJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("BottomOverlaid",L.a.COb.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",queryCommandId:L.a.uib.toString()}));this.addCommandToMaps(new Ra.a("BringToFrontFlyout",
L.a.JAf.toString()));this.addCommandToMaps(new Ra.a("BringForward",L.a.bringForward.toString()));this.addCommandToMaps(new Ra.a("BringToFront",L.a.bringToFront.toString()));this.addCommandToMaps(Object.assign(new Ra.a("BulletLibrary",L.a.Wna.toString()),{legacyControlId:"PptRibbon.Home.Paragraph.BulletGallery",queryCommandId:L.a.vJb.toString(),populationProps:new jh(L.a.Amc.toString(),!1)}));this.addCommandToMaps(Object.assign(new Ra.a("CatchUpWithChanges",G.a.jDh.toString()),{legacyControlId:"CatchUpWithChanges",
queryCommandId:G.a.Geh.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ChangeCaseCapitalizeEachWord",D.a.$6a.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Capitalization"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangeCaseLower",D.a.otb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Lower"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangeCaseMenuEnabled",L.a.KEf.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangeCaseSentence",
D.a.K_b.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.SentenceCase"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangeCaseToggle",D.a.L_b.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.ToggleCase"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangeCaseUpper",D.a.ptb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Upper"}));this.addCommandToMaps(new Ra.a("ChangeLayout",L.a.cja.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ChangeGraphicContextMenu",
L.a.aVd.toString()),{legacyControlId:"PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangeGraphicFlyout",L.a.aVd.toString()),{legacyControlId:"PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePicture",L.a.NJc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.ChangePicture"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenu",L.a.fVd.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture"}));
this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenuBing",L.a.P_b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenuM365",L.a.rtb.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenuCreateWithAI",L.a.OJc.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromCreateWithAI"}));
this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenuIcons",L.a.a7a.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenuDevice",L.a.NJc.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenuOneDrive",L.a.Q_b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost",
queryCommandId:L.a.pnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureContextMenuMobileDevice",L.a.S_b.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyout",L.a.fVd.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyoutBing",L.a.P_b.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"}));
this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyoutM365",L.a.rtb.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyoutCreateWithAI",L.a.OJc.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromCreateWithAI"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyoutIcons",L.a.a7a.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"}));
this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyoutDevice",L.a.NJc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyoutOneDrive",L.a.Q_b.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost",queryCommandId:L.a.pnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ChangePictureFlyoutMobileDevice",L.a.S_b.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));
this.addCommandToMaps(Object.assign(new Ra.a("ChangeSmartArtColorAnchor",L.a.PEf.toString()),{populationProps:new jh(L.a.cbh.toString(),!1)}));this.addCommandToMaps(new Ra.a("CheckAccessibility",L.a.PLe.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ClearFormatting",L.a.clearFormatting.toString()),{legacyControlId:"PptRibbon.Home.Font.ClearFormatting"}));this.addCommandToMaps(new Ra.a("ClearTableFormatting",D.a.l7a.toString()));this.addCommandToMaps(Object.assign(new Ra.a("CommentsPane",
L.a.m6.toString()),{queryCommandId:L.a.KJb.toString()}));this.addCommandToMaps(new Ra.a("CopyHyperlink",D.a.yLc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ContextMenu",D.a.Jwf.toString()),{populationProps:new jh(D.a.Nid.toString(),!1)}));this.addCommandToMaps(Object.assign(new Ra.a("SelectionPane",L.a.n6.toString()),{queryCommandId:L.a.GJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("RenderFooterPane",L.a.VY.toString()),{queryCommandId:L.a.nnc.toString()}));this.addCommandToMaps(new Ra.a("InsertSlideNumber",
L.a.mUa.toString()));this.addCommandToMaps(Object.assign(new Ra.a("RenderSelectionPane",L.a.n6.toString()),{queryCommandId:L.a.GJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("CommentsShowMarkUp",L.a.YMb.toString()),{queryCommandId:L.a.skd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("CommentsShowAdvancedMarkUp",L.a.Krc.toString()),{queryCommandId:L.a.HOe.toString()}));this.addCommandToMaps(new Ra.a("Copy",L.a.wIb.toString()));this.addCommandToMaps(new Ra.a("CopyInVersionHistory",
L.a.iKh.toString()));this.addCommandToMaps(new Ra.a("ClickVersionHistoryRestore",L.a.p0b.toString()));this.addCommandToMaps(new Ra.a("ClickVersionHistorySaveACopy",L.a.WVd.toString()));this.addCommandToMaps(new Ra.a("ClickVersionHistoryDownloadVersion",L.a.VVd.toString()));this.addCommandToMaps(new Ra.a("Cut",L.a.xIb.toString()));this.addCommandToMaps(new Ra.a("Delete",L.a.deleteObject.toString()));this.addCommandToMaps(new Ra.a("DeleteAllCommentsInPresentation",L.a.Hub.toString()));this.addCommandToMaps(new Ra.a("DeleteAllCommentsInSlide",
L.a.qRa.toString()));this.addCommandToMaps(new Ra.a("DeleteAllResolvedComments",L.a.Iub.toString()));this.addCommandToMaps(Object.assign(new Ra.a("DeleteComment",L.a.deleteComment.toString()),{queryCommandId:L.a.iNk.toString()}));this.addCommandToMaps(new Ra.a("DeleteRepeatedWord",D.a.bDa.toString()));this.addCommandToMaps(new Ra.a("DeleteSlide",L.a.zI.toString()));this.addCommandToMaps(Object.assign(new Ra.a("DesignerHome",L.a.Mrc.toString()),{legacyControlId:"PptRibbon.Home.ShowHide.Designer",queryCommandId:L.a.Onc.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("DesignerNew",L.a.grd.toString()),{legacyControlId:"PptRibbon.Design.ShowHide.Designer.New",queryCommandId:L.a.Onc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("Dictation",D.a.Glb.toString()),{legacyControlId:"btnStartDictation",queryCommandId:D.a.Fjd.toString(),populationProps:new jh(D.a.jmc.toString(),!0)}));this.addCommandToMaps(Object.assign(new Ra.a("DocChat",G.a.kDh.toString()),{legacyControlId:"DocChat",queryCommandId:G.a.aeh.toString()}));
this.addCommandToMaps(new Ra.a("DoNotCheckThisCritiqueType",D.a.Xub.toString()));this.addCommandToMaps(new Ra.a("Duplicate",L.a.k1d.toString()));this.addCommandToMaps(new Ra.a("DuplicateSlide",L.a.iQ.toString()));this.addCommandToMaps(new Ra.a("EditHyperlink",L.a.insertHyperlink.toString()));this.addCommandToMaps(Object.assign(new Ra.a("EditInApp",L.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Ra.a("EditInAppWithIcon",L.a.openInClient.toString()),
{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Ra.a("EditorPane",L.a.SLe.toString()),{legacyControlId:"PptRibbon.Review.Proofing.EditorPane",queryCommandId:L.a.zOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("EditorPaneSplitButton",L.a.SLe.toString()),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButton",queryCommandId:L.a.AOe.toString()}));this.la.UOf&&this.addCommandToMaps(Object.assign(new Ra.a("DexLitePane",L.a.erd.toString()),{queryCommandId:L.a.Hjd.toString()}));
this.addCommandToMaps(new Ra.a("Find",L.a.find.toString()));this.addCommandToMaps(new Ra.a("FitToWindow",L.a.Fvc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("FixIt",L.a.fixIt.toString()),{legacyControlId:"FixIt",queryCommandId:L.a.aOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("FontColor",L.a.Cxa.toString()),{populationProps:new jh(L.a.CIb.toString(),!1)}));this.addCommandToMaps(Object.assign(new Ra.a("FontPicker",D.a.font.toString()),{legacyControlId:"fontPicker",queryCommandId:D.a.Jjd.toString(),
populationProps:new jh(D.a.kmc.toString(),!0)}));this.la.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Ra.a("FontName",L.a.yZa.toString()),{queryCommandId:L.a.jib.toString(),populationProps:new jh(L.a.Phb.toString(),!1),commandPreviewId:L.a.EIb.toString(),commandRevertId:L.a.HIb.toString()})),this.addCommandToMaps(Object.assign(new Ra.a("FontSize",L.a.zZa.toString()),{queryCommandId:L.a.kib.toString(),commandPreviewId:L.a.FIb.toString(),commandRevertId:L.a.IIb.toString()}))):(this.addCommandToMaps(Object.assign(new Ra.a("FontName",
L.a.yZa.toString()),{queryCommandId:L.a.jib.toString(),populationProps:new jh(L.a.Phb.toString(),!1)})),this.addCommandToMaps(Object.assign(new Ra.a("FontSize",L.a.zZa.toString()),{queryCommandId:L.a.kib.toString()})));this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundApplyToAll",L.a.dRc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundPicture",L.a.m5d.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundSolidFill",L.a.eta.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new jh(L.a.CLe.toString(),!1)}));this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundReset",L.a.eRc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundStandardColors",L.a.eta.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundThemeColors",L.a.eta.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundThemeColorsMCU",L.a.eta.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(new Ra.a("FormatBackgroundRecentColors",L.a.bjd.toString()));this.addCommandToMaps(Object.assign(new Ra.a("FormatPainter",L.a.rSa.toString()),
{queryCommandId:L.a.Xjd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("HideProofingErrors",L.a.$cg.toString()),{legacyControlId:"PptRibbon.Review.Proofing.HideProofingErrors",queryCommandId:L.a.Ljd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("GiveFeedback",G.a.jLb.toString()),{legacyControlId:"btnFeedback"}));this.addCommandToMaps(Object.assign(new Ra.a("GrammarOptions",D.a.MHb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.GrammarOptions"}));this.addCommandToMaps(Object.assign(new Ra.a("ProofingOptions",
D.a.MHb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButtonFallback"}));this.addCommandToMaps(Object.assign(new Ra.a("Grow",L.a.Mhb.toString()),{legacyControlId:"PptRibbon.Home.Font.Grow"}));this.addCommandToMaps(Object.assign(new Ra.a("HideSlide",L.a.o8b.toString()),{queryCommandId:L.a.ukd.toString()}));this.la.ide&&this.addCommandToMaps(new Ra.a("UnhideSlide",L.a.H4e.toString()));this.addCommandToMaps(Object.assign(new Ra.a("Highlight",L.a.AIb.toString()),{legacyControlId:"PptRibbon.Home.Font.FontBackgroundColor"}));
this.addCommandToMaps(new Ra.a("HighlighterColor",D.a.B1.toString()));this.addCommandToMaps(new Ra.a("IgnoreSpellingError",D.a.Eka.toString()));this.addCommandToMaps(new Ra.a("Indent",L.a.zIb.toString()));this.addCommandToMaps(new Ra.a("InsertAddIns",L.a.Nyb.toString()));this.addCommandToMaps(new Ra.a("InsertAddInsFromBackstage",L.a.Nyb.toString()));this.addCommandToMaps(Object.assign(new Ra.a("InsertAddinTransitionEntry",G.a.Gfg.toString()),{legacyControlId:"PptRibbon.InsertTab.InsertAddinTransitionEntry"}));
this.addCommandToMaps(new Ra.a("InsertMoreAddInsFromFooter",L.a.Nyb.toString()));this.addCommandToMaps(new Ra.a("InsertComment",L.a.jUa.toString()));this.addCommandToMaps(Object.assign(new Ra.a("InsertIcons",L.a.NXc.toString()),{legacyControlId:"InsertIconDialog"}));this.addCommandToMaps(new Ra.a("InsertLink",L.a.insertHyperlink.toString()));this.addCommandToMaps(new Ra.a("InsertSocialMediaVideo",L.a.Zfg.toString()));this.addCommandToMaps(new Ra.a("InsertPicturesFlyoutDalle",L.a.ife.toString()));
this.addCommandToMaps(new Ra.a("InsertPicturesDalle",L.a.jfe.toString()));this.addCommandToMaps(new Ra.a("InsertLiveFeed",L.a.Qfg.toString()));this.addCommandToMaps(Object.assign(new Ra.a("InsertOnlineVideo",L.a.dua.toString()),{legacyControlId:"PptRibbon.InsertTab.Media.OnlineVideo"}));(this.la.PXc||this.Qb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOInsertLocalVideoEnabledViaExp",!1))&&this.addCommandToMaps(new Ra.a("InsertVideoFromDevice",L.a.bNb.toString()));this.addCommandToMaps(Object.assign(new Ra.a("InsertPicturesFlyout",
L.a.Vfg.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertPicturesFlyoutBing",L.a.insertOnlinePicture.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture.FromSearch"}));var a;this.addCommandToMaps((a=new Ra.a("InsertPicturesFlyoutM365",L.a.g9b.toString()),a.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",a));let b;this.addCommandToMaps((b=new Ra.a("InsertPicturesM365",L.a.TXc.toString()),
b.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",b));let c;this.addCommandToMaps((c=new Ra.a("InsertPicturesFlyoutDevice",L.a.insertPicture.toString()),c.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromDevice",c));let f;this.addCommandToMaps((f=new Ra.a("InsertPicturesFlyoutOneDrive",L.a.Qyb.toString()),f.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromHost",f.queryCommandId=L.a.pnc.toString(),f));let l;this.addCommandToMaps((l=new Ra.a("InsertPicturesFlyoutMobileDevice",
L.a.YXc.toString()),l.legacyControlId="InsertPictureFromMobileDevice",l));this.addCommandToMaps(new Ra.a("InsertSlides",L.a.vna.toString()));let w;this.addCommandToMaps((w=new Ra.a("NewSlideSplit",L.a.sIb.toString()),w.populationProps=new jh(L.a.sIb.toString(),!1),w));let H;this.addCommandToMaps((H=new Ra.a("InsertSlideSplit",L.a.sIb.toString()),H.populationProps=new jh(L.a.sIb.toString(),!1),H));this.addCommandToMaps(new Ra.a("NewDefaultSlide",L.a.C5.toString()));let U;this.addCommandToMaps((U=new Ra.a("ChangeLayoutFlyout",
L.a.zLe.toString()),U.populationProps=new jh(L.a.zLe.toString(),!1),U));this.addCommandToMaps(new Ra.a("InsertTextBox",L.a.ZEa.toString()));this.addCommandToMaps(new Ra.a("InsertAudio",L.a.Nwh.toString()));let ja;this.addCommandToMaps((ja=new Ra.a("InsertFooterFlyout",L.a.qab.toString()),ja.legacyControlId="PptRibbon.InsertTab.FooterFlyout",ja));let wa;this.addCommandToMaps((wa=new Ra.a("InsertSymbol",D.a.Bsd.toString()),wa.populationProps=new jh(D.a.Ihb.toString(),!0),wa));this.addCommandToMaps(new Ra.a("InsertTable",
D.a.insertTable.toString()));this.addCommandToMaps(new Ra.a("InvokeFilesSerplet",G.a.Zyb.toString()));let Sa;this.addCommandToMaps((Sa=new Ra.a("Italic",L.a.BIb.toString()),Sa.queryCommandId=L.a.yJb.toString(),Sa));this.addCommandToMaps(new Ra.a("LeftToRight",L.a.tmc.toString()));let eb;this.addCommandToMaps((eb=new Ra.a("LineSpacing",L.a.Nhb.toString()),eb.legacyControlId="PptRibbon.Home.Paragraph.LineSpacing",eb.populationProps=new jh(L.a.DIb.toString(),!1),eb));let ub;this.addCommandToMaps((ub=
new Ra.a("LineSpacingButton1_00",L.a.Exa.toString()),ub.queryCommandId=L.a.Mxa.toString(),ub.menuItemId="1.00",ub));let Ub;this.addCommandToMaps((Ub=new Ra.a("LineSpacingButton1_50",L.a.Exa.toString()),Ub.queryCommandId=L.a.Mxa.toString(),Ub.menuItemId="1.50",Ub));let cc;this.addCommandToMaps((cc=new Ra.a("LineSpacingButton2_00",L.a.Exa.toString()),cc.queryCommandId=L.a.Mxa.toString(),cc.menuItemId="2.00",cc));let Fc;this.addCommandToMaps((Fc=new Ra.a("LineSpacingButton2_50",L.a.Exa.toString()),Fc.queryCommandId=
L.a.Mxa.toString(),Fc.menuItemId="2.50",Fc));let Ic;this.addCommandToMaps((Ic=new Ra.a("LineSpacingButton3_00",L.a.Exa.toString()),Ic.queryCommandId=L.a.Mxa.toString(),Ic.menuItemId="3.00",Ic));this.addCommandToMaps(new Ra.a("LineSpacingOptionsForParagraphDialog",L.a.$Ab.toString()));this.addCommandToMaps(new Ra.a("MarkActivitiesAsRead",L.a.lEe.toString()));let Cc;this.addCommandToMaps((Cc=new Ra.a("ModeSwitcherEditing",L.a.Ksc.toString()),Cc.queryCommandId=L.a.OOe.toString(),Cc.legacyControlId="ModeSwitcherModeEditing",
Cc));let Ud;this.addCommandToMaps((Ud=new Ra.a("ModeSwitcherViewing",L.a.Lsc.toString()),Ud.queryCommandId=L.a.POe.toString(),Ud.legacyControlId="ModeSwitcherModeViewing",Ud));this.addCommandToMaps(new Ra.a("ModeSwitcher",L.a.m_g.toString()));this.addCommandToMaps(new Ra.a("MoreSymbols",D.a.QXc.toString()));let je;this.addCommandToMaps((je=new Ra.a("MoreVariantsAnchor",L.a.nCa.toString()),je.queryCommandId=L.a.$nc.toString(),je.populationProps=new jh(L.a.Tid.toString(),!1),je.previewControlIds=["Variant1",
"Variant2","Variant3","Variant4"],je));this.addCommandToMaps(new Ra.a("MoveSectionDown",L.a.wFe.toString()));this.addCommandToMaps(new Ra.a("MoveSectionUp",L.a.xFe.toString()));let Vd;this.addCommandToMaps((Vd=new Ra.a("NewComment",L.a.jUa.toString()),Vd.queryCommandId=L.a.zNk.toString(),Vd));this.addCommandToMaps(new Ra.a("NewSlide",L.a.vna.toString()));this.addCommandToMaps(new Ra.a("NewSlideWithoutDialog",L.a.C5.toString()));let Ve;this.addCommandToMaps((Ve=new Ra.a("NextComment",L.a.$Fe.toString()),
Ve.queryCommandId=L.a.ENk.toString(),Ve));this.addCommandToMaps(new Ra.a("NoHighlight",D.a.fja.toString()));let af;this.addCommandToMaps((af=new Ra.a("Notes",L.a.pLa.toString()),af.queryCommandId=L.a.Rjd.toString(),af));let Zf;this.addCommandToMaps((Zf=new Ra.a("NumberingLibrary",L.a.RJa.toString()),Zf.legacyControlId="PptRibbon.Home.Paragraph.NumberedGallery",Zf.queryCommandId=L.a.zJb.toString(),Zf.populationProps=new jh(L.a.Bmc.toString(),!1),Zf));this.addCommandToMaps(new Ra.a("OpenHyperlink",
D.a.vJa.toString()));this.addCommandToMaps(new Ra.a("OpenPowerPointLanguageDialog",L.a.ihd.toString()));let lg;this.addCommandToMaps((lg=new Ra.a("OpenSetSlideSizeDialog",L.a.QJe.toString()),lg.queryCommandId=L.a.LOe.toString(),lg));this.addCommandToMaps(new Ra.a("OpenVersionHistory",L.a.Q8g.toString()));this.addCommandToMaps(new Ra.a("Outdent",L.a.GIb.toString()));this.addCommandToMaps(new Ra.a("ParagraphOptions",L.a.$Ab.toString()));this.addCommandToMaps(new Ra.a("Paste",L.a.SJa.toString()));this.addCommandToMaps(new Ra.a("PasteGalleryIcon",
L.a.SJa.toString()));this.addCommandToMaps(new Ra.a("PasteKeepingDestinationTheme",L.a.CJa.toString()));this.addCommandToMaps(new Ra.a("PasteKeepingSourceFormatting",L.a.DJa.toString()));let Tg;this.addCommandToMaps((Tg=new Ra.a("PasteTextOnlyGalleryIcon",L.a.Ohb.toString()),Tg.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",Tg));this.addCommandToMaps(new Ra.a("PasteAsImage",L.a.sZa.toString()));let Ug;this.addCommandToMaps((Ug=new Ra.a("PasteSlideKeepDestinationFromClipService",L.a.Rlc.toString()),
Ug.queryCommandId=L.a.xOe.toString(),Ug));let ag;this.addCommandToMaps((ag=new Ra.a("PasteSlideKeepSourceFromClipService",L.a.hIb.toString()),ag.queryCommandId=L.a.xOe.toString(),ag));let ih;this.addCommandToMaps((ih=new Ra.a("PasteTextOnly",L.a.Ohb.toString()),ih.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",ih));let Vg;this.addCommandToMaps((Vg=new Ra.a("PasteAsPlainText",L.a.Zhd.toString()),Vg.queryCommandId=L.a.nPe.toString(),Vg));let di;this.addCommandToMaps((di=new Ra.a("PasteTextKeepingSourceFormatting",
L.a.Yhd.toString()),di.queryCommandId=L.a.nPe.toString(),di));this.addCommandToMaps(new Ra.a("PlayFromBeginning",L.a.yNb.toString()));this.addCommandToMaps(new Ra.a("PlayFromBeginningTopBar",L.a.$lc.toString()));this.addCommandToMaps(new Ra.a("PlayFromCurrentSlide",L.a.Vya.toString()));let Si;this.addCommandToMaps((Si=new Ra.a("PresentLive",L.a.DZa.toString()),Si.legacyControlId="PresentLive",Si));let rj;this.addCommandToMaps((rj=new Ra.a("PresentLiveTopBar",L.a.Tmc.toString()),rj.legacyControlId=
"PresentLiveTopBar",rj));let sg;this.addCommandToMaps((sg=new Ra.a("PresentLiveSetAccessControlAnyone",L.a.EZa.toString()),sg.legacyControlId="PresentLiveSetAccessControlAnyone",sg.queryCommandId=L.a.CJb.toString(),sg));let Cg;this.addCommandToMaps((Cg=new Ra.a("PresentLiveSetAccessControlOrganization",L.a.Smc.toString()),Cg.legacyControlId="PresentLiveSetAccessControlOrganization",Cg.queryCommandId=L.a.DJb.toString(),Cg));let sh;this.addCommandToMaps((sh=new Ra.a("PresentLiveConsumer",L.a.DZa.toString()),
sh.legacyControlId="PresentLiveConsumer",sh));let vk;this.addCommandToMaps((vk=new Ra.a("PresentLiveEnterprise",L.a.DZa.toString()),vk.legacyControlId="PresentLiveEnterprise",vk));let Ni;this.addCommandToMaps((Ni=new Ra.a("PresentToTeams",L.a.Zhb.toString()),Ni.legacyControlId="PresentToTeams",Ni));let wk;this.addCommandToMaps((wk=new Ra.a("PresentToTeamsTopBar",L.a.DMe.toString()),wk.legacyControlId="PresentToTeamsTopBar",wk));let Jl;this.addCommandToMaps((Jl=new Ra.a("PreviousComment",L.a.JMe.toString()),
Jl.queryCommandId=L.a.PNk.toString(),Jl));this.addCommandToMaps(new Ra.a("ReadingView",L.a.hld.toString()));let hk;this.addCommandToMaps((hk=new Ra.a("PictureCrop",L.a.xZd.toString()),hk.queryCommandId=L.a.yOe.toString(),hk));this.addCommandToMaps(new Ra.a("PictureCropAnchor",L.a.vZd.toString()));let Kl;this.addCommandToMaps((Kl=new Ra.a("PictureCropMoreOptions",L.a.Orc.toString()),Kl.queryCommandId=L.a.LJb.toString(),Kl));this.addCommandToMaps(Object.assign(new Ra.a("FormatPicture",L.a.Orc.toString()),
{queryCommandId:L.a.LJb.toString()}));this.addCommandToMaps(new Ra.a("Redo",L.a.Cmc.toString()));let Vj;this.addCommandToMaps((Vj=new Ra.a("RehearsalFeedbackSettings",L.a.ird.toString()),Vj.legacyControlId="PptRibbon.View.Coach.Menu.FeedbackSettings",Vj.queryCommandId=L.a.tkd.toString(),Vj));let Wj;this.addCommandToMaps((Wj=new Ra.a("RehearsePresentation",L.a.Ufa.toString()),Wj.legacyControlId="PptRibbon.View.Coach.RehearseWithCoach",Wj));let nk;this.addCommandToMaps((nk=new Ra.a("RehearsePresentationTopBar",
L.a.zoc.toString()),nk.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachTopBar",nk));let gl;this.addCommandToMaps((gl=new Ra.a("RehearsePresentationDropDown",L.a.yoc.toString()),gl.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachSplit",gl));this.addCommandToMaps(new Ra.a("RemoveHyperlink",D.a.CM.toString()));this.addCommandToMaps(new Ra.a("RemoveSection",L.a.tRe.toString()));this.addCommandToMaps(new Ra.a("RenameSection",L.a.jmd.toString()));this.addCommandToMaps(new Ra.a("Replace",L.a.l1.toString()));
this.addCommandToMaps(new Ra.a("ResetPicture",L.a.Hmd.toString()));this.addCommandToMaps(new Ra.a("ResetPictureAndSize",L.a.Ulh.toString()));this.addCommandToMaps(new Ra.a("ResetPictureSplitButton",L.a.Vlh.toString()));this.addCommandToMaps(new Ra.a("RightToLeft",L.a.umc.toString()));this.addCommandToMaps(new Ra.a("RotateAnchor",L.a.anh.toString()));this.addCommandToMaps(new Ra.a("RotateShapeAnchor",L.a.bnh.toString()));let yj;this.addCommandToMaps((yj=new Ra.a("RotateLeft",L.a.yaa.toString()),yj.commandPreviewId=
L.a.GMe.toString(),yj.commandRevertId=L.a.xTe.toString(),yj));let wh;this.addCommandToMaps((wh=new Ra.a("RotateRight",L.a.HTe.toString()),wh.commandPreviewId=L.a.HMe.toString(),wh.commandRevertId=L.a.xTe.toString(),wh));this.addCommandToMaps(new Ra.a("RotateFlipVertical",L.a.Epc.toString()));this.addCommandToMaps(new Ra.a("RotateFlipHorizontal",L.a.Dpc.toString()));this.addCommandToMaps(new Ra.a("SelectHyperlink",D.a.Znd.toString()));this.addCommandToMaps(new Ra.a("SendBackward",L.a.sendBackward.toString()));
this.addCommandToMaps(new Ra.a("SendToBack",L.a.sendToBack.toString()));this.addCommandToMaps(new Ra.a("SendToBackFlyout",L.a.Uph.toString()));this.la.eB&&Pd.a("AnimationGalleryActionAIEnabled")&&this.addCommandToMaps(new Ra.a("AnimationGalleryActionAI",L.a.$Qd.toString()));this.la.Nrb?(this.addCommandToMaps(Object.assign(new Ra.a("SetAnimationDelay",L.a.Sod.toString()),{queryCommandId:L.a.$Ja.toString()})),this.addCommandToMaps(Object.assign(new Ra.a("SetAnimationDuration",L.a.Tod.toString()),{queryCommandId:L.a.aKa.toString()})),
this.addCommandToMaps(Object.assign(new Ra.a("AnimationStart",L.a.FHc.toString()),{queryCommandId:L.a.jJb.toString()})),this.addCommandToMaps(Object.assign(new Ra.a("SetAnimationDelayMLR",L.a.Sod.toString()),{queryCommandId:L.a.$Ja.toString()})),this.addCommandToMaps(Object.assign(new Ra.a("SetAnimationDurationMLR",L.a.Tod.toString()),{queryCommandId:L.a.aKa.toString()})),this.addCommandToMaps(Object.assign(new Ra.a("AnimationStartMLR",L.a.FHc.toString()),{queryCommandId:L.a.jJb.toString()})),a=new Ra.a("AnimationPane",
L.a.Awh.toString()),a.queryCommandId=L.a.fnc.toString(),this.addCommandToMaps(a),this.addCommandToMaps(new Ra.a("MoveEarlier",L.a.gFe.toString())),this.addCommandToMaps(new Ra.a("MoveLater",L.a.hFe.toString()))):(this.addCommandToMaps(new Ra.a("MoveEarlier",L.a.kSe.toString())),this.addCommandToMaps(new Ra.a("MoveLater",L.a.lSe.toString())));let hl;this.addCommandToMaps((hl=new Ra.a("SetHeight",L.a.Nod.toString()),hl.queryCommandId=L.a.eib.toString(),hl));let Yl;this.addCommandToMaps((Yl=new Ra.a("SetWidth",
L.a.Ood.toString()),Yl.queryCommandId=L.a.fib.toString(),Yl));let wm;this.addCommandToMaps((wm=new Ra.a("SetSlideSize",L.a.Mqc.toString()),wm.legacyControlId="PptRibbon.Design.Customize.SetSlideSizeAnchor",wm));let Fk;this.addCommandToMaps((Fk=new Ra.a("SetSlideSize4x3",L.a.Spd.toString()),Fk.queryCommandId=L.a.wkd.toString(),Fk));let Gk;this.addCommandToMaps((Gk=new Ra.a("SetSlideSize16x9",L.a.Rpd.toString()),Gk.queryCommandId=L.a.vkd.toString(),Gk));let Di;this.addCommandToMaps((Di=new Ra.a("SetTransitionApplyAll",
L.a.kkb.toString()),Di.queryCommandId=L.a.VJb.toString(),Di));this.addCommandToMaps(Object.assign(new Ra.a("SetTransitionDuration",L.a.lkb.toString()),{queryCommandId:L.a.Oxa.toString()}));this.addCommandToMaps(new Ra.a("ShapeAlignAnchor",L.a.Dth.toString()));this.addCommandToMaps(new Ra.a("ShapeAlignLeft",L.a.kqd.toString()));this.addCommandToMaps(new Ra.a("ShapeAlignRight",L.a.crc.toString()));this.addCommandToMaps(new Ra.a("ShapeAlignTop",L.a.lqd.toString()));this.addCommandToMaps(new Ra.a("ShapeAlignBottom",
L.a.Zqc.toString()));this.addCommandToMaps(new Ra.a("ShapeAlignCenter",L.a.$qc.toString()));this.addCommandToMaps(new Ra.a("ShapeAlignMiddle",L.a.brc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ShapeAlignToSlide",L.a.Vtc.toString()),{queryCommandId:L.a.IJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeAlignToSelectedObjects",L.a.Utc.toString()),{queryCommandId:L.a.HJb.toString()}));this.addCommandToMaps(new Ra.a("ShareSlide",L.a.vqd.toString()));this.addCommandToMaps(new Ra.a("DistributeShapesVertically",
L.a.kDa.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ImmersiveReader",L.a.immersiveReader.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(Object.assign(new Ra.a("ImmersiveReaderRibbon",L.a.$de.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(new Ra.a("DistributeShapesHorizontally",L.a.L2b.toString()));this.addCommandToMaps(new Ra.a("ShareSlide",L.a.vqd.toString()));this.addCommandToMaps(Object.assign(new Ra.a("Shrink",L.a.Qhb.toString()),
{legacyControlId:"PptRibbon.Home.Font.Shrink"}));this.addCommandToMaps(Object.assign(new Ra.a("ShowCommentsTopBar",G.a.yOb.toString()),{legacyControlId:"ShowCommentsTopBar",queryCommandId:G.a.oPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShowComments",L.a.m6.toString()),{queryCommandId:L.a.KJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShowEditTriPaneView",L.a.nLa.toString()),{queryCommandId:L.a.kJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShowHideChanges",
L.a.Gkb.toString()),{queryCommandId:L.a.IOe.toString()}));let Mg;this.addCommandToMaps((Mg=new Ra.a("ShowHideComments",L.a.m6.toString()),Mg.legacyControlId="PptRibbon.View.ShowHide.CommentsSplitButton",Mg.queryCommandId=L.a.KJb.toString(),Mg));let Ei;this.addCommandToMaps((Ei=new Ra.a("ShowHideCommentsInReview",L.a.m6.toString()),Ei.queryCommandId=L.a.KJb.toString(),Ei));let mg;this.addCommandToMaps((mg=new Ra.a("ShowHideRuler",L.a.jrd.toString()),mg.legacyControlId="btnShowHideRuler",mg.queryCommandId=
L.a.bkd.toString(),mg));this.addCommandToMaps(new Ra.a("ShowRevisionTrackingWithUrlOverrides",L.a.trd.toString()));let Md;this.addCommandToMaps((Md=new Ra.a("ShowMarkup",L.a.YMb.toString()),Md.queryCommandId=L.a.skd.toString(),Md));let Pe;this.addCommandToMaps((Pe=new Ra.a("ShowTranslatePane",L.a.tol.toString()),Pe.legacyControlId="PptRibbon.Review.Show.Translate",Pe));let zf;this.addCommandToMaps((zf=new Ra.a("ShowSmartLookupPane",G.a.IYc.toString()),zf.legacyControlId="PptRibbon.Review.Show.SmartLookup",
zf));this.addCommandToMaps(new Ra.a("SmartLookupContextMenu",G.a.HYc.toString()));this.addCommandToMaps(new Ra.a("SmartLookupSynonyms",G.a.KYc.toString()));let ge;this.addCommandToMaps((ge=new Ra.a("ShowSorterView",L.a.oga.toString()),ge.queryCommandId=L.a.NJb.toString(),ge));let Lg;this.addCommandToMaps((Lg=new Ra.a("ShowVersionHistoryDialog",G.a.Vrc.toString()),Lg.legacyControlId="PptJewel.Info.VersionHistory",Lg));let ei;this.addCommandToMaps((ei=new Ra.a("SpokenLanguage",L.a.Jhb.toString()),ei.legacyControlId=
"PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage",ei.queryCommandId=L.a.Jhb.toString(),ei.populationProps=new jh(L.a.Jhb.toString(),!0),ei));this.addCommandToMaps(new Ra.a("StandardFontColorPicker",L.a.Cxa.toString()));let ti;this.addCommandToMaps((ti=new Ra.a("Strikethrough",L.a.KIb.toString()),ti.legacyControlId="PptRibbon.Home.Font.Strikethrough",ti.queryCommandId=L.a.AJb.toString(),ti));let Un;this.addCommandToMaps((Un=new Ra.a("SubtitleLanguage",L.a.Khb.toString()),Un.legacyControlId=
"PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage",Un.queryCommandId=L.a.Khb.toString(),Un.populationProps=new jh(L.a.Khb.toString(),!0),Un));let xk;this.addCommandToMaps((xk=new Ra.a("SubtitleSettingsAnchor",L.a.xkd.toString()),xk.legacyControlId="PptRibbon.View.Subtitles.SubtitleSettings",xk));let Bo;this.addCommandToMaps((Bo=new Ra.a("Subscript",L.a.LIb.toString()),Bo.legacyControlId="PptRibbon.Home.Font.Subscript",Bo.queryCommandId=L.a.UZa.toString(),Bo));this.addCommandToMaps(new Ra.a("SummarizeSlides",
L.a.X0a.toString()));this.addCommandToMaps(new Ra.a("SummarizeSlidesFromTellMe",L.a.X0a.toString()));this.addCommandToMaps(new Ra.a("SummarizeDeck",L.a.H0e.toString()));this.addCommandToMaps(new Ra.a("SummarizeDeckFromTellMe",L.a.H0e.toString()));let Ks;this.addCommandToMaps((Ks=new Ra.a("Superscript",L.a.MIb.toString()),Ks.legacyControlId="PptRibbon.Home.Font.Superscript",Ks.queryCommandId=L.a.VZa.toString(),Ks));this.addCommandToMaps(new Ra.a("TabSwitch",G.a.Qmh.toString()));this.addCommandToMaps(new Ra.a("TextAlignmentAnchor",
L.a.i8a.toString()));let Qt;this.addCommandToMaps((Qt=new Ra.a("TextAlignmentCenterJustify",L.a.Bxa.toString()),Qt.queryCommandId=L.a.bKa.toString(),Qt));let Ls;this.addCommandToMaps((Ls=new Ra.a("TextAlignmentFullJustify",L.a.AZa.toString()),Ls.legacyControlId="PptRibbon.Home.Paragraph.FullJustify",Ls.queryCommandId=L.a.lib.toString(),Ls));let Rt;this.addCommandToMaps((Rt=new Ra.a("TextAlignmentLeftJustify",L.a.Dxa.toString()),Rt.queryCommandId=L.a.cKa.toString(),Rt));let St;this.addCommandToMaps((St=
new Ra.a("TextAlignmentRightJustify",L.a.Fxa.toString()),St.queryCommandId=L.a.eKa.toString(),St));let Tt;this.addCommandToMaps((Tt=new Ra.a("TextAnchoringBottom",L.a.b1.toString()),Tt.queryCommandId=L.a.fKa.toString(),Tt));let Ut;this.addCommandToMaps((Ut=new Ra.a("TextAnchoringMiddle",L.a.c1.toString()),Ut.queryCommandId=L.a.gKa.toString(),Ut));let Vt;this.addCommandToMaps((Vt=new Ra.a("TextAnchoringTop",L.a.d1.toString()),Vt.queryCommandId=L.a.hKa.toString(),Vt));this.addCommandToMaps(new Ra.a("ThemeFontColorPicker",
L.a.Cxa.toString()));this.addCommandToMaps(new Ra.a("ThemeFontColorPickerMCU",L.a.Cxa.toString()));let Ly;this.addCommandToMaps((Ly=new Ra.a("TopOverlaid",L.a.DOb.toString()),Ly.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",Ly.queryCommandId=L.a.vib.toString(),Ly));let jB;this.addCommandToMaps((jB=new Ra.a("Underline",L.a.NIb.toString()),jB.queryCommandId=L.a.BJb.toString(),jB));this.addCommandToMaps(new Ra.a("Undo",L.a.Imc.toString()));let kB;this.addCommandToMaps((kB=new Ra.a("UsePresenterView",
L.a.k6e.toString()),kB.queryCommandId=L.a.WJb.toString(),kB));this.addCommandToMaps(new Ra.a("Zoom",L.a.SJe.toString()));let My;this.addCommandToMaps((My=new Ra.a("ToggleUseSubtitles",L.a.bMa.toString()),My.legacyControlId="PptRibbon.View.Subtitles.UseSubtitles",My.queryCommandId=L.a.YZa.toString(),My));let lB;this.addCommandToMaps((lB=new Ra.a("ToggleShapeAlignToSlide",L.a.Vtc.toString()),lB.queryCommandId=L.a.IJb.toString(),lB));let mB;this.addCommandToMaps((mB=new Ra.a("ToggleShapeAlignToSelectedObjects",
L.a.Utc.toString()),mB.queryCommandId=L.a.HJb.toString(),mB));let Ny;this.addCommandToMaps((Ny=new Ra.a("ToggleSubtitlesBottomOverlay",L.a.COb.toString()),Ny.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",Ny.queryCommandId=L.a.uib.toString(),Ny));let Oy;this.addCommandToMaps((Oy=new Ra.a("ToggleSubtitlesTopOverlay",L.a.DOb.toString()),Oy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",Oy.queryCommandId=L.a.vib.toString(),Oy));let Py;this.addCommandToMaps((Py=
new Ra.a("ToggleRehearsalVisionEnabled",L.a.zOb.toString()),Py.legacyControlId="PptRibbon.View.Coach.Menu.Vision",Py.queryCommandId=L.a.FJb.toString(),Py));let nB;this.addCommandToMaps((nB=new Ra.a("HostOpenInClient",L.a.openInClient.toString()),nB.legacyControlId="HostOpenInClient",nB));let Qy;this.addCommandToMaps((Qy=new Ra.a("ToggleSubtitlesBelowSlide",L.a.BOb.toString()),Qy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Qy.queryCommandId=L.a.tib.toString(),Qy));let Ry;
this.addCommandToMaps((Ry=new Ra.a("ToggleSubtitlesAboveSlide",L.a.AOb.toString()),Ry.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Ry.queryCommandId=L.a.rib.toString(),Ry));let Sy;this.addCommandToMaps((Sy=new Ra.a("BelowSlide",L.a.BOb.toString()),Sy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Sy.queryCommandId=L.a.tib.toString(),Sy));let Ty;this.addCommandToMaps((Ty=new Ra.a("AboveSlide",L.a.AOb.toString()),Ty.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",
Ty.queryCommandId=L.a.rib.toString(),Ty));let oB;this.addCommandToMaps((oB=new Ra.a("PreviousVersions",G.a.Jrc.toString()),oB.legacyControlId="PptJewel.Info.FileVersion",oB));this.addCommandToMaps(new Ra.a("Present",L.a.TIb.toString()));this.addCommandToMaps(new Ra.a("PresentDropDown",L.a.Yhb.toString()))}X5h(){this.addCommandToMaps(Object.assign(new Ra.a("CenterJustify",L.a.Bxa.toString()),{queryCommandId:L.a.bKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("FullJustify",L.a.AZa.toString()),
{queryCommandId:L.a.lib.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("LeftJustify",L.a.Dxa.toString()),{queryCommandId:L.a.cKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("RightJustify",L.a.Fxa.toString()),{queryCommandId:L.a.eKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TextAnchoringAnchor",L.a.ejd.toString()),{queryCommandId:L.a.ejd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("AlignBottom",L.a.b1.toString()),{queryCommandId:L.a.fKa.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("AlignMiddle",L.a.c1.toString()),{queryCommandId:L.a.gKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTop",L.a.d1.toString()),{queryCommandId:L.a.hKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("UseSubtitles",L.a.bMa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:L.a.YZa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SubtitleSettings",L.a.xkd.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitleSettings"}));
this.addCommandToMaps(new Ra.a("NewBringForwardAnchorMLR",L.a.fsb.toString()));this.addCommandToMaps(new Ra.a("NewSendBackwardAnchorMLR",L.a.fsb.toString()));this.addCommandToMaps(new Ra.a("PowerPointGroupFlyoutAnchorMLR",L.a.TLe.toString()));this.addCommandToMaps(Object.assign(new Ra.a("SetLockAspectRatio",L.a.wqc.toString()),{queryCommandId:L.a.snc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SetTableHeight",L.a.Ooa.toString()),{queryCommandId:L.a.Znc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SetTableWidth",
L.a.hLa.toString()),{queryCommandId:L.a.Ckd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SetTableColumnWidth",L.a.gLa.toString()),{queryCommandId:L.a.OJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SetTableRowHeight",L.a.q0a.toString()),{queryCommandId:L.a.PJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("UpdatePictureCropWidth",L.a.tvd.toString()),{queryCommandId:L.a.sJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("UpdatePictureCropHeight",
L.a.qvd.toString()),{queryCommandId:L.a.qJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("UpdatePictureCropLeft",L.a.rvd.toString()),{queryCommandId:L.a.rJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("UpdatePictureCropTop",L.a.svd.toString()),{queryCommandId:L.a.wnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("Paste_MLR",L.a.SJa.toString()),{queryCommandId:L.a.Yjd.toString()}));this.addCommandToMaps(new Ra.a("PasteKeepingDestinationThemeMLR",L.a.CJa.toString()));
this.addCommandToMaps(new Ra.a("PasteKeepingSourceFormattingMLR",L.a.DJa.toString()));this.addCommandToMaps(new Ra.a("PasteAsImageMLR",L.a.sZa.toString()));this.addCommandToMaps(Object.assign(new Ra.a("TableCellBottomAnchoringMLR",L.a.b1.toString()),{queryCommandId:L.a.fKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellCenterJustifyMLR",L.a.Bxa.toString()),{queryCommandId:L.a.bKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellLeftJustifyMLR",L.a.Dxa.toString()),
{queryCommandId:L.a.cKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellMiddleAnchoringMLR",L.a.c1.toString()),{queryCommandId:L.a.gKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellRightJustifyMLR",L.a.Fxa.toString()),{queryCommandId:L.a.eKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellTopAnchoringMLR",L.a.d1.toString()),{queryCommandId:L.a.hKa.toString()}));this.addCommandToMaps(new Ra.a("ParagraphOptionsMLR",L.a.$Ab.toString()));
this.addCommandToMaps(new Ra.a("Delete_MLR",L.a.deleteObject.toString()));this.addCommandToMaps(new Ra.a("SmartArtStylesMLR",L.a.UK.toString()));this.addCommandToMaps(new Ra.a("PictureCropMLR",L.a.wZd.toString()))}CPd(){this.addTabToMap("FormatShape",L.a.dRf.toString());this.addTabToMap("FormatPicture",L.a.zah.toString());this.addTabToMap("SmartArtDesign",L.a.iyh.toString());this.addTabToMap("Table",L.a.COe.toString());this.addTabToMap("Graphics",L.a.deh.toString());this.addTabToMap("Playback",L.a.wzf.toString());
this.addTabToMap("AudioFormat",L.a.uzf.toString());this.addTabToMap("Audio",L.a.xzf.toString());this.addTabToMap("AccessibleAuthoring",L.a.vOd.toString())}d6h(){this.addCommandToMaps(Object.assign(new Ra.a("PptJewelDownloadACopyAsOdp",L.a.X2b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsOdp"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelDownloadACopyAsPdf",L.a.Y2b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsPdf"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelDownloadACopy",
L.a.downloadACopy.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopy"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelDownloadAsImages",L.a.Z2b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadAsImages"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelNew",G.a.ZAb.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelOpen",G.a.ZAb.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Ra.a("New",
G.a.ZAb.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Ra.a("Open",G.a.ZAb.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelPrintFullSlide",L.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintFullSlide"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelPrintHandouts",L.a.MMe.toString()),{legacyControlId:"PptJewel.Print.PrintHandouts"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelPrintNotes",
L.a.OMe.toString()),{legacyControlId:"PptJewel.Print.PrintNotes"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelPrintToPdf",L.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintToPdf"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelRename",G.a.AZe.toString()),{legacyControlId:"PptJewel.Rename.RenameDialog"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelSaveACopy",L.a.Dmc.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveACopy"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelSaveAsToHost",
L.a.ZLe.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveAsToHost"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelSaveToSharePoint",L.a.$Le.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelTrustCenter",G.a.hNb.toString()),{legacyControlId:"PptJewel.About.TrustCenter"}));this.addCommandToMaps(Object.assign(new Ra.a("PptJewelVersionHistory",G.a.Vrc.toString()),{legacyControlId:"PptJewel.Info.VersionHistory"}));
this.addCommandToMaps(Object.assign(new Ra.a("PptJewelPreviousVersions",G.a.Jrc.toString()),{legacyControlId:"PptJewel.Info.FileVersion"}))}$5h(){this.addCommandToMaps(Object.assign(new Ra.a("ApplyShapeStyleAnchor",L.a.ERd.toString()),{populationProps:new jh(L.a.GLe.toString(),!1)}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyShapeStylePreviewGallery",L.a.asb.toString()),{queryCommandId:L.a.mkd.toString(),populationProps:new jh(L.a.GLe.toString(),!1),previewControlIds:"ApplyShapeStyle0 ApplyShapeStyle1 ApplyShapeStyle2 ApplyShapeStyle3 ApplyShapeStyle4 ApplyShapeStyle5 ApplyShapeStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Ra.a("ApplyGraphicsStyleAnchor",L.a.uRd.toString()),{populationProps:new jh(L.a.DLe.toString(),!1)}));this.addCommandToMaps(new Ra.a("FontRecentColors",L.a.ymc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("GraphicsStylePreviewGallery",L.a.yZb.toString()),{queryCommandId:L.a.Kjd.toString(),populationProps:new jh(L.a.DLe.toString(),!1),previewControlIds:"ApplyGraphicsStyle0 ApplyGraphicsStyle1 ApplyGraphicsStyle2 ApplyGraphicsStyle3 ApplyGraphicsStyle4 ApplyGraphicsStyle5 ApplyGraphicsStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Ra.a("GraphicsFill",L.a.Yrb.toString()),{populationProps:new jh(L.a.FLe.toString(),!1)}));this.addCommandToMaps(new Ra.a("GraphicNoFill",L.a.iRe.toString()));this.addCommandToMaps(new Ra.a("GraphicNoOutline",L.a.jRe.toString()));this.addCommandToMaps(Object.assign(new Ra.a("GraphicsOutline",L.a.Zrb.toString()),{populationProps:new jh(L.a.Rid.toString(),!1)}));this.addCommandToMaps(new Ra.a("MoreFillColors",L.a.YEe.toString()));this.addCommandToMaps(new Ra.a("MoreFontColors",
L.a.t_g.toString()));this.addCommandToMaps(new Ra.a("MoreFormatBackgroundColors",L.a.ZEe.toString()));this.addCommandToMaps(new Ra.a("MoreOutlineColors",L.a.$Ee.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ShowHideFormatShapePane",L.a.Lrc.toString()),{queryCommandId:L.a.lJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("MoreRotationOptions",L.a.Lrc.toString()),{queryCommandId:L.a.lJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("PictureBorders",L.a.Kia.toString()),
{populationProps:new jh(L.a.Rid.toString(),!1)}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeFill",L.a.aCa.toString()),{populationProps:new jh(L.a.FLe.toString(),!1),commandPreviewId:L.a.VIb.toString(),commandRevertId:L.a.XKb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeFillRecentColors",L.a.ZHc.toString()),{commandPreviewId:L.a.VIb.toString(),commandRevertId:L.a.XKb.toString()}));this.addCommandToMaps(new Ra.a("ShapeNoFill",L.a.Qld.toString()));this.addCommandToMaps(new Ra.a("ShapeNoOutline",
L.a.Rld.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutline",L.a.Kia.toString()),{populationProps:new jh(L.a.Rid.toString(),!1)}));this.addCommandToMaps(new Ra.a("ShapeOutlineRecentColors",L.a.$Hc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineDashStyle_1",L.a.u6a.toString()),{menuItemId:"ShapeOutlineDashStyle,1"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineDashStyle_2",L.a.u6a.toString()),{menuItemId:"ShapeOutlineDashStyle,2"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineDashStyle_4",
L.a.u6a.toString()),{menuItemId:"ShapeOutlineDashStyle,4"}));this.addCommandToMaps(new Ra.a("ShapeOutlineDashStyleAnchor",L.a.aIc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineSketchStyle_1",L.a.v6a.toString()),{menuItemId:"ShapeOutlineSketchStyle,1"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineSketchStyle_2",L.a.v6a.toString()),{menuItemId:"ShapeOutlineSketchStyle,2"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineSketchStyle_3",L.a.v6a.toString()),
{menuItemId:"ShapeOutlineSketchStyle,3"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineSketchStyle_4",L.a.v6a.toString()),{menuItemId:"ShapeOutlineSketchStyle,4"}));this.addCommandToMaps(new Ra.a("ShapeOutlineSketchStyleAnchor",L.a.cIc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineEndStyle_1",L.a.Lia.toString()),{menuItemId:"ShapeOutlineEndStyle,1"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineEndStyle_2",L.a.Lia.toString()),{menuItemId:"ShapeOutlineEndStyle,2"}));
this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineEndStyle_3",L.a.Lia.toString()),{menuItemId:"ShapeOutlineEndStyle,3"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineEndStyle_4",L.a.Lia.toString()),{menuItemId:"ShapeOutlineEndStyle,4"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineEndStyle_5",L.a.Lia.toString()),{menuItemId:"ShapeOutlineEndStyle,5"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineEndStyle_6",L.a.Lia.toString()),{menuItemId:"ShapeOutlineEndStyle,6"}));
this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineEndStyle_7",L.a.Lia.toString()),{menuItemId:"ShapeOutlineEndStyle,7"}));this.addCommandToMaps(new Ra.a("ShapeOutlineEndStyleAnchor",L.a.bIc.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineWidth_1",L.a.UPa.toString()),{menuItemId:"ShapeOutlineWidth,1"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineWidth_2",L.a.UPa.toString()),{menuItemId:"ShapeOutlineWidth,2"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineWidth_3",
L.a.UPa.toString()),{menuItemId:"ShapeOutlineWidth,3"}));this.addCommandToMaps(Object.assign(new Ra.a("ShapeOutlineWidth_4",L.a.UPa.toString()),{menuItemId:"ShapeOutlineWidth,4"}));this.addCommandToMaps(new Ra.a("ShapeOutlineWidthAnchor",L.a.dIc.toString()));this.addCommandToMaps(new Ra.a("StandardGraphicFillColorPicker",L.a.Yrb.toString()));this.addCommandToMaps(new Ra.a("StandardGraphicOutlineColorPicker",L.a.Zrb.toString()));this.addCommandToMaps(Object.assign(new Ra.a("StandardShapeFillColorPicker",
L.a.aCa.toString()),{commandPreviewId:L.a.VIb.toString(),commandRevertId:L.a.XKb.toString()}));this.addCommandToMaps(new Ra.a("StandardShapeOutlineColorPicker",L.a.Kia.toString()));this.addCommandToMaps(new Ra.a("ThemeGraphicFillColorPicker",L.a.Yrb.toString()));this.addCommandToMaps(new Ra.a("ThemeGraphicFillColorPickerMCU",L.a.Yrb.toString()));this.addCommandToMaps(new Ra.a("ThemeGraphicOutlineColorPicker",L.a.Zrb.toString()));this.addCommandToMaps(new Ra.a("ThemeGraphicOutlineColorPickerMCU",L.a.Zrb.toString()));
this.addCommandToMaps(Object.assign(new Ra.a("ThemeShapeFillColorPickerMCU",L.a.aCa.toString()),{commandPreviewId:L.a.VIb.toString(),commandRevertId:L.a.XKb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemeShapeFillColorPicker",L.a.aCa.toString()),{commandPreviewId:L.a.VIb.toString(),commandRevertId:L.a.XKb.toString()}));this.addCommandToMaps(new Ra.a("ThemeShapeOutlineColorPicker",L.a.Kia.toString()));this.addCommandToMaps(new Ra.a("ThemeShapeOutlineColorPickerMCU",L.a.Kia.toString()))}e6h(){this.addCommandToMaps(Object.assign(new Ra.a("Themes",
L.a.iw.toString()),{queryCommandId:L.a.Dz.toString(),previewControlIds:"ThemesOfficeTheme ThemesAtlas ThemesMadison ThemesIon ThemesOrganic ThemesFrame".split(" ")}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesOfficeTheme",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesAtlas",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesMadison",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("ThemesIon",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesOrganic",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesFrame",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesIonBoardroom",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesMesh",
L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesRetrospect",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesSlice",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesSavon",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesBanded",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("ThemesQuotable",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesWoodType",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesBasis",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesIntegral",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesWisp",
L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesDividend",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesCelestial",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesParallax",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesMetropolitan",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("ThemesFacet",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ThemesViewTheme",L.a.iw.toString()),{queryCommandId:L.a.Dz.toString()}))}g6h(){this.addCommandToMaps(Object.assign(new Ra.a("Transitions",L.a.Rj.toString()),{queryCommandId:L.a.Aj.toString(),previewControlIds:"TransitionExisting TransitionNone TransitionMorph TransitionCut TransitionFade TransitionPush TransitionWipe".split(" ")}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionExisting",
L.a.Poa.toString()),{legacyControlId:"TransitionExisting",queryCommandId:L.a.coa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionExistingInMenu",L.a.Cya.toString()),{legacyControlId:"TransitionExistingInMenu",queryCommandId:L.a.Pxa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionNone",L.a.Rj.toString()),{legacyControlId:"TransitionNone",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionMorph",L.a.Rj.toString()),
{legacyControlId:"TransitionMorph",queryCommandId:L.a.Aj.toString()}));this.la.eB&&Pd.a("MorphTransitionActionAIEnabled")&&this.addCommandToMaps(Object.assign(new Ra.a("TransitionMorphActionAI",L.a.Rj.toString()),{legacyControlId:"TransitionMorph",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionCut",L.a.Rj.toString()),{legacyControlId:"TransitionCut",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionFade",L.a.Rj.toString()),
{legacyControlId:"TransitionFade",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionPush",L.a.Rj.toString()),{legacyControlId:"TransitionPush",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionWipe",L.a.Rj.toString()),{legacyControlId:"TransitionWipe",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionSplit",L.a.Rj.toString()),{legacyControlId:"TransitionSplit",queryCommandId:L.a.Aj.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("TransitionRandomBars",L.a.Rj.toString()),{legacyControlId:"TransitionRandomBars",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionShape",L.a.Rj.toString()),{legacyControlId:"TransitionShape",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionComb",L.a.Rj.toString()),{legacyControlId:"TransitionComb",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionBlinds",
L.a.Rj.toString()),{legacyControlId:"TransitionBlinds",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionBox",L.a.Rj.toString()),{legacyControlId:"TransitionBox",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionCover",L.a.Rj.toString()),{legacyControlId:"TransitionCover",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionCube",L.a.Rj.toString()),{legacyControlId:"TransitionCube",
queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionCurtains",L.a.Rj.toString()),{legacyControlId:"TransitionCurtains",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionDissolve",L.a.Rj.toString()),{legacyControlId:"TransitionDissolve",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionOrbit",L.a.Rj.toString()),{legacyControlId:"TransitionOrbit",queryCommandId:L.a.Aj.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("TransitionPageCurl",L.a.Rj.toString()),{legacyControlId:"TransitionPageCurl",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionPeelOff",L.a.Rj.toString()),{legacyControlId:"TransitionPeelOff",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionRandom",L.a.Rj.toString()),{legacyControlId:"TransitionRandom",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionReveal",
L.a.Rj.toString()),{legacyControlId:"TransitionReveal",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionRotate",L.a.Rj.toString()),{legacyControlId:"TransitionRotate",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionUncover",L.a.Rj.toString()),{legacyControlId:"TransitionUncover",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionWheel",L.a.Rj.toString()),{legacyControlId:"TransitionWheel",
queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionRipple",L.a.Rj.toString()),{legacyControlId:"TransitionRipple",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionBox",L.a.Rj.toString()),{legacyControlId:"TransitionBox",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionCube",L.a.Rj.toString()),{legacyControlId:"TransitionCube",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionSwitch",
L.a.Rj.toString()),{legacyControlId:"TransitionSwitch",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionFallOver",L.a.Rj.toString()),{legacyControlId:"TransitionFallOver",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionDrape",L.a.Rj.toString()),{legacyControlId:"TransitionDrape",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionFlip",L.a.Rj.toString()),{legacyControlId:"TransitionFlip",
queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionWind",L.a.Rj.toString()),{legacyControlId:"TransitionWind",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionPrestige",L.a.Rj.toString()),{legacyControlId:"TransitionPrestige",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionFracture",L.a.Rj.toString()),{legacyControlId:"TransitionFracture",queryCommandId:L.a.Aj.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("TransitionCrush",L.a.Rj.toString()),{legacyControlId:"TransitionCrush",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionAirplane",L.a.Rj.toString()),{legacyControlId:"TransitionAirplane",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionOrigami",L.a.Rj.toString()),{legacyControlId:"TransitionOrigami",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionChecker",
L.a.Rj.toString()),{legacyControlId:"TransitionChecker",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionVortex",L.a.Rj.toString()),{legacyControlId:"TransitionVortex",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionGlitter",L.a.Rj.toString()),{legacyControlId:"TransitionGlitter",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionPan",L.a.Rj.toString()),{legacyControlId:"TransitionPan",
queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionGalleryIcon",L.a.Rj.toString()),{legacyControlId:"TransitionGalleryIcon",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionConveyor",L.a.Rj.toString()),{legacyControlId:"TransitionConveyor",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionZoom",L.a.Rj.toString()),{legacyControlId:"TransitionZoom",queryCommandId:L.a.Aj.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("TransitionFlyThrough",L.a.Rj.toString()),{legacyControlId:"TransitionFlyThrough",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionWindow",L.a.Rj.toString()),{legacyControlId:"TransitionWindow",queryCommandId:L.a.Aj.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TransitionDoors",L.a.Rj.toString()),{legacyControlId:"TransitionDoors",queryCommandId:L.a.Aj.toString()}))}Q5h(){this.addCommandToMaps(Object.assign(new Ra.a("Animations",
L.a.Fz.toString()),{queryCommandId:L.a.$na.toString(),previewControlIds:["AnimationExisting","AnimationNone","AnimationAppear","AnimationFadeIn","AnimationFlyIn"]}));this.addCommandToMaps(Object.assign(new Ra.a("AnimationExisting",L.a.LLb.toString()),{queryCommandId:L.a.$na.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("AnimationExistingInMenu",L.a.b0a.toString()),{queryCommandId:L.a.$na.toString()}));for(const a of this.b7j)this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.Fz.toString()),
{queryCommandId:L.a.$na.toString()}))}P5h(){this.addCommandToMaps(Object.assign(new Ra.a("AnimationEffectOptions",L.a.WNe.toString()),{populationProps:new jh(L.a.Ghb.toString(),!1)}));for(const a of this.Y6j)this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.a0a.toString()),{queryCommandId:L.a.OZa.toString(),menuItemId:a.slice(this.Z6j)}));for(const a of this.$6j)this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.$_a.toString()),{queryCommandId:L.a.NZa.toString(),menuItemId:a.slice(this.a7j)}));this.addCommandToMaps(new Ra.a("AnimationEffectOptionsThemeColorPickerMCU",
L.a.uya.toString()));this.addCommandToMaps(new Ra.a("AnimationEffectOptionsThemeColorPicker",L.a.uya.toString()));this.addCommandToMaps(new Ra.a("AnimationEffectOptionsStandardColorPicker",L.a.uya.toString()));this.addCommandToMaps(Object.assign(new Ra.a("AnimationEffectOptionsSequenceAsOneObject",L.a.Vod.toString()),{queryCommandId:L.a.aoa.toString(),menuItemId:"AsOneObject"}));this.addCommandToMaps(Object.assign(new Ra.a("AnimationEffectOptionsSequenceAllAtOnce",L.a.Uod.toString()),{queryCommandId:L.a.aoa.toString(),
menuItemId:"AllAtOnce"}));this.addCommandToMaps(Object.assign(new Ra.a("AnimationEffectOptionsSequenceByParagraph",L.a.Wod.toString()),{queryCommandId:L.a.aoa.toString(),menuItemId:"ByParagraph"}));this.addCommandToMaps(Object.assign(new Ra.a("AnimationEffectOptionsSequenceOneByOne",L.a.Xod.toString()),{queryCommandId:L.a.aoa.toString(),menuItemId:"OneByOne"}))}T5h(){this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundSolidFillFromCanvas",L.a.fRc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",
populationProps:new jh(L.a.Zah.toString(),!1)}));for(const a of this.a$j)this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.fRc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundApplyToAllFromCanvas",L.a.IYf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundResetFromCanvas",L.a.KYf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Ra.a("FormatBackgroundPictureFromCanvas",L.a.JYf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}))}f6h(){this.addCommandToMaps(Object.assign(new Ra.a("TransitionEffectOptions",L.a.wib.toString()),{populationProps:new jh(L.a.tIb.toString(),!1)}));for(const a of this.zjk)this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.Sqc.toString()),{queryCommandId:L.a.Dkd.toString(),menuItemId:a.slice(this.Ajk)}))}Z5h(){this.addCommandToMaps(new Ra.a("PictureStyles",
L.a.Tra.toString()));for(const a of this.jek){const b=a.split("_")[2];this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.Tra.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:b}))}}a6h(){this.addCommandToMaps(new Ra.a("ChangeSmartArtLayoutAnchor",G.a.wRa.toString()));for(const a of this.UUg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Ra.a("Change"+a,L.a.V_b.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:b[1]+","+b[2]}))}this.addCommandToMaps(Object.assign(new Ra.a("SmartArtEditText",
L.a.sRf.toString()),{queryCommandId:L.a.Gjd.toString()}));this.addCommandToMaps(new Ra.a("SmartArtDemote",L.a.Emc.toString()));this.addCommandToMaps(new Ra.a("SmartArtPromote",L.a.JIb.toString()));this.addCommandToMaps(new Ra.a("SmartArtResetGraphic",L.a.bya.toString()));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtReverse",L.a.vTe.toString()),{queryCommandId:L.a.akd.toString()}));this.addCommandToMaps(new Ra.a("SmartArtStyles",L.a.UK.toString()));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__simple1__simple",
L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"simple1,simple"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__simple2__simple",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"simple2,simple"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__simple3__simple",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"simple3,simple"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__simple4__simple",L.a.UK.toString()),
{queryCommandId:L.a.wc.toString(),menuItemId:"simple4,simple"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__simple5__simple",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"simple5,simple"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d1__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d1,3D"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d2__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d2,3D"}));
this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d3__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d3,3D"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d4__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d4,3D"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d5__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d5,3D"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d6__3D",
L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d6,3D"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d7__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d7,3D"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d8__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d8,3D"}));this.addCommandToMaps(Object.assign(new Ra.a("SmartArtStyle__3d9__3D",L.a.UK.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:"3d9,3D"}))}W5h(){this.addCommandToMaps(new Ra.a("InsertSmartArtAnchor",
L.a.mie.toString()));for(const a of this.UUg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.$Ea.toString()),{queryCommandId:L.a.wc.toString(),menuItemId:b[1]+","+b[2]}))}}Y5h(){this.addCommandToMaps(new Ra.a("PictureCropToShapeAnchor",L.a.xah.toString()));for(const a of this.iek)this.addCommandToMaps(Object.assign(new Ra.a(a,L.a.wah.toString()),{queryCommandId:L.a.wc.toString()}))}V5h(){this.addCommandToMaps(new Ra.a("InsertShapesAll",L.a.Xfg.toString()));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStraightConnector",
L.a.hYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStraightConnectorArrow",L.a.iYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStraightConnectorTwoArrow",L.a.jYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeElbowConnector",L.a.fYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeElbowArrowConnector",
L.a.eYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeElbowDoubleArrowConnector",L.a.gYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeCurvedConnector",L.a.cYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeCurvedArrowConnector",L.a.bYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeCurvedDoubleArrowConnector",
L.a.dYc.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRectangle",L.a.uhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRoundedRectangle",L.a.Ehe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeSnipSingleCornerRectangle",L.a.Mhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeSnipSameSideCornerRectangle",
L.a.Lhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeSnipDiagonalCornerRectangle",L.a.Jhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeSnipRoundSingleCornerRectangle",L.a.Khe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRoundSingleCornerRectangle",L.a.Dhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRoundSameSideCornerRectangle",
L.a.Che.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRoundDiagonalCornerRectangle",L.a.Bhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeTextBox",L.a.ZEa.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeEllipse",L.a.kge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeTriangle",
L.a.eie.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRightTriangle",L.a.Ahe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeParallelogram",L.a.khe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeTrapezoid",L.a.die.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDiamond",
L.a.Zfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeSPentagon",L.a.Ghe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeHexagon",L.a.tge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeHeptagon",L.a.sge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeOctagon",L.a.ghe.toString()),
{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDecagon",L.a.Vfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDodecagon",L.a.cge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapePie",L.a.mhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeChord",L.a.Gfe.toString()),{queryCommandId:L.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeTeardrop",L.a.bie.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeFrame",L.a.pge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeHalfFrame",L.a.qge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLShape",L.a.wge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDiagonalStripe",
L.a.Yfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeCross",L.a.Mfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapePlaque",L.a.nhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeCan",L.a.Dfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeCube",L.a.Nfe.toString()),
{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeBevel",L.a.Bfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDonut",L.a.dge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeNoSymbol",L.a.ehe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeBlockArc",L.a.Cfe.toString()),{queryCommandId:L.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeFoldedCorner",L.a.oge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeSmileyFace",L.a.Ihe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeHeart",L.a.rge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLightningBolt",L.a.Gge.toString()),{queryCommandId:L.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeSun",L.a.aie.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeMoon",L.a.che.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeCloud",L.a.Ife.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeArc",L.a.yfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDoubleBracket",
L.a.fge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDoubleBrace",L.a.ege.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLeftBracket",L.a.Bge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRightBracket",L.a.zhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLeftBrace",
L.a.zge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRightBrace",L.a.yhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeRightArrow",L.a.whe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLeftArrow",L.a.xge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeUpArrow",L.a.gie.toString()),
{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeDownArrow",L.a.hge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLeftRightArrow",L.a.Cge.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeUpDownArrow",L.a.iie.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeQuadArrow",L.a.she.toString()),
{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLeftRightUpArrow",L.a.Ege.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeBentArrow",L.a.zfe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeUTurnArrow",L.a.fie.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeLeftUpArrow",L.a.Fge.toString()),
{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeBentUpArrow",L.a.Afe.toString()),{queryCommandId:L.a.wc.toString()}));let a;this.addCommandToMaps((a=new Ra.a("InsertShapeCurvedRightArrow",L.a.Rfe.toString()),a.queryCommandId=L.a.wc.toString(),a));let b;this.addCommandToMaps((b=new Ra.a("InsertShapeCurvedLeftArrow",L.a.Qfe.toString()),b.queryCommandId=L.a.wc.toString(),b));let c;this.addCommandToMaps((c=new Ra.a("InsertShapeCurvedUpArrow",L.a.Sfe.toString()),
c.queryCommandId=L.a.wc.toString(),c));let f;this.addCommandToMaps((f=new Ra.a("InsertShapeCurvedDownArrow",L.a.Ofe.toString()),f.queryCommandId=L.a.wc.toString(),f));let l;this.addCommandToMaps((l=new Ra.a("InsertShapeStripedRightArrow",L.a.Zhe.toString()),l.queryCommandId=L.a.wc.toString(),l));let w;this.addCommandToMaps((w=new Ra.a("InsertShapeNotchedRightArrow",L.a.fhe.toString()),w.queryCommandId=L.a.wc.toString(),w));let H;this.addCommandToMaps((H=new Ra.a("InsertShapePentagon",L.a.lhe.toString()),
H.queryCommandId=L.a.wc.toString(),H));let U;this.addCommandToMaps((U=new Ra.a("InsertShapeChevron",L.a.Ffe.toString()),U.queryCommandId=L.a.wc.toString(),U));let ja;this.addCommandToMaps((ja=new Ra.a("InsertShapeRightArrowCallout",L.a.xhe.toString()),ja.queryCommandId=L.a.wc.toString(),ja));let wa;this.addCommandToMaps((wa=new Ra.a("InsertShapeDownArrowCallout",L.a.ige.toString()),wa.queryCommandId=L.a.wc.toString(),wa));let Sa;this.addCommandToMaps((Sa=new Ra.a("InsertShapeLeftArrowCallout",L.a.yge.toString()),
Sa.queryCommandId=L.a.wc.toString(),Sa));let eb;this.addCommandToMaps((eb=new Ra.a("InsertShapeUpArrowCallout",L.a.hie.toString()),eb.queryCommandId=L.a.wc.toString(),eb));let ub;this.addCommandToMaps((ub=new Ra.a("InsertShapeLeftRightArrowCallout",L.a.Dge.toString()),ub.queryCommandId=L.a.wc.toString(),ub));let Ub;this.addCommandToMaps((Ub=new Ra.a("InsertShapeQuadArrowCallout",L.a.the.toString()),Ub.queryCommandId=L.a.wc.toString(),Ub));let cc;this.addCommandToMaps((cc=new Ra.a("InsertShapeCircularArrow",
L.a.Hfe.toString()),cc.queryCommandId=L.a.wc.toString(),cc));let Fc;this.addCommandToMaps((Fc=new Ra.a("InsertShapeMathPlus",L.a.ahe.toString()),Fc.queryCommandId=L.a.wc.toString(),Fc));let Ic;this.addCommandToMaps((Ic=new Ra.a("InsertShapeMathMinus",L.a.Yge.toString()),Ic.queryCommandId=L.a.wc.toString(),Ic));let Cc;this.addCommandToMaps((Cc=new Ra.a("InsertShapeMathMultiply",L.a.Zge.toString()),Cc.queryCommandId=L.a.wc.toString(),Cc));let Ud;this.addCommandToMaps((Ud=new Ra.a("InsertShapeMathDivide",
L.a.Wge.toString()),Ud.queryCommandId=L.a.wc.toString(),Ud));let je;this.addCommandToMaps((je=new Ra.a("InsertShapeMathEqual",L.a.Xge.toString()),je.queryCommandId=L.a.wc.toString(),je));let Vd;this.addCommandToMaps((Vd=new Ra.a("InsertShapeMathNotEqual",L.a.$ge.toString()),Vd.queryCommandId=L.a.wc.toString(),Vd));let Ve;this.addCommandToMaps((Ve=new Ra.a("InsertShapeProcess",L.a.qhe.toString()),Ve.queryCommandId=L.a.wc.toString(),Ve));let af;this.addCommandToMaps((af=new Ra.a("InsertShapeAlternateProcess",
L.a.xfe.toString()),af.queryCommandId=L.a.wc.toString(),af));let Zf;this.addCommandToMaps((Zf=new Ra.a("InsertShapeDecision",L.a.Wfe.toString()),Zf.queryCommandId=L.a.wc.toString(),Zf));let lg;this.addCommandToMaps((lg=new Ra.a("InsertShapeData",L.a.Ufe.toString()),lg.queryCommandId=L.a.wc.toString(),lg));let Tg;this.addCommandToMaps((Tg=new Ra.a("InsertShapePredefinedProcess",L.a.ohe.toString()),Tg.queryCommandId=L.a.wc.toString(),Tg));let Ug;this.addCommandToMaps((Ug=new Ra.a("InsertShapeInternalStorage",
L.a.vge.toString()),Ug.queryCommandId=L.a.wc.toString(),Ug));let ag;this.addCommandToMaps((ag=new Ra.a("InsertShapeDocument",L.a.bge.toString()),ag.queryCommandId=L.a.wc.toString(),ag));let ih;this.addCommandToMaps((ih=new Ra.a("InsertShapeMultidocument",L.a.dhe.toString()),ih.queryCommandId=L.a.wc.toString(),ih));let Vg;this.addCommandToMaps((Vg=new Ra.a("InsertShapeTerminator",L.a.cie.toString()),Vg.queryCommandId=L.a.wc.toString(),Vg));let di;this.addCommandToMaps((di=new Ra.a("InsertShapePreparation",
L.a.phe.toString()),di.queryCommandId=L.a.wc.toString(),di));let Si;this.addCommandToMaps((Si=new Ra.a("InsertShapeManualInput",L.a.Uge.toString()),Si.queryCommandId=L.a.wc.toString(),Si));let rj;this.addCommandToMaps((rj=new Ra.a("InsertShapeManualOperation",L.a.Vge.toString()),rj.queryCommandId=L.a.wc.toString(),rj));let sg;this.addCommandToMaps((sg=new Ra.a("InsertShapeConnector",L.a.Lfe.toString()),sg.queryCommandId=L.a.wc.toString(),sg));let Cg;this.addCommandToMaps((Cg=new Ra.a("InsertShapeOffpageConnector",
L.a.hhe.toString()),Cg.queryCommandId=L.a.wc.toString(),Cg));let sh;this.addCommandToMaps((sh=new Ra.a("InsertShapeCard",L.a.Efe.toString()),sh.queryCommandId=L.a.wc.toString(),sh));let vk;this.addCommandToMaps((vk=new Ra.a("InsertShapePunchedTape",L.a.rhe.toString()),vk.queryCommandId=L.a.wc.toString(),vk));let Ni;this.addCommandToMaps((Ni=new Ra.a("InsertShapeSummingJunction",L.a.$he.toString()),Ni.queryCommandId=L.a.wc.toString(),Ni));let wk;this.addCommandToMaps((wk=new Ra.a("InsertShapeOr",L.a.ihe.toString()),
wk.queryCommandId=L.a.wc.toString(),wk));let Jl;this.addCommandToMaps((Jl=new Ra.a("InsertShapeCollate",L.a.Kfe.toString()),Jl.queryCommandId=L.a.wc.toString(),Jl));let hk;this.addCommandToMaps((hk=new Ra.a("InsertShapeSort",L.a.Nhe.toString()),hk.queryCommandId=L.a.wc.toString(),hk));let Kl;this.addCommandToMaps((Kl=new Ra.a("InsertShapeExtract",L.a.nge.toString()),Kl.queryCommandId=L.a.wc.toString(),Kl));let Vj;this.addCommandToMaps((Vj=new Ra.a("InsertShapeMerge",L.a.bhe.toString()),Vj.queryCommandId=
L.a.wc.toString(),Vj));let Wj;this.addCommandToMaps((Wj=new Ra.a("InsertShapeStoredData",L.a.Yhe.toString()),Wj.queryCommandId=L.a.wc.toString(),Wj));let nk;this.addCommandToMaps((nk=new Ra.a("InsertShapeDelay",L.a.Xfe.toString()),nk.queryCommandId=L.a.wc.toString(),nk));let gl;this.addCommandToMaps((gl=new Ra.a("InsertShapeSequentialActionStorage",L.a.Hhe.toString()),gl.queryCommandId=L.a.wc.toString(),gl));let yj;this.addCommandToMaps((yj=new Ra.a("InsertShapeMagneticDisk",L.a.Tge.toString()),yj.queryCommandId=
L.a.wc.toString(),yj));let wh;this.addCommandToMaps((wh=new Ra.a("InsertShapeDirectAccessStorage",L.a.$fe.toString()),wh.queryCommandId=L.a.wc.toString(),wh));let hl;this.addCommandToMaps((hl=new Ra.a("InsertShapeDisplay",L.a.age.toString()),hl.queryCommandId=L.a.wc.toString(),hl));let Yl;this.addCommandToMaps((Yl=new Ra.a("InsertShapeExplosion1",L.a.lge.toString()),Yl.queryCommandId=L.a.wc.toString(),Yl));let wm;this.addCommandToMaps((wm=new Ra.a("InsertShapeExplosion2",L.a.mge.toString()),wm.queryCommandId=
L.a.wc.toString(),wm));let Fk;this.addCommandToMaps((Fk=new Ra.a("InsertShapeStar4",L.a.The.toString()),Fk.queryCommandId=L.a.wc.toString(),Fk));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar5",L.a.Uhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar6",L.a.Vhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar7",L.a.Whe.toString()),{queryCommandId:L.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar8",L.a.Xhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar10",L.a.Ohe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar12",L.a.Phe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar16",L.a.Qhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar24",
L.a.Rhe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeStar32",L.a.She.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("InsertShapeUpRibbon",L.a.jie.toString()),{queryCommandId:L.a.wc.toString()}));let Gk;this.addCommandToMaps((Gk=new Ra.a("InsertShapeDownRibbon",L.a.jge.toString()),Gk.queryCommandId=L.a.wc.toString(),Gk));let Di;this.addCommandToMaps((Di=new Ra.a("InsertShapeCurvedUpRibbon",L.a.Tfe.toString()),
Di.queryCommandId=L.a.wc.toString(),Di));let Mg;this.addCommandToMaps((Mg=new Ra.a("InsertShapeCurvedDownRibbon",L.a.Pfe.toString()),Mg.queryCommandId=L.a.wc.toString(),Mg));let Ei;this.addCommandToMaps((Ei=new Ra.a("InsertShapeVerticalScroll",L.a.kie.toString()),Ei.queryCommandId=L.a.wc.toString(),Ei));let mg;this.addCommandToMaps((mg=new Ra.a("InsertShapeHorizontalScroll",L.a.uge.toString()),mg.queryCommandId=L.a.wc.toString(),mg));let Md;this.addCommandToMaps((Md=new Ra.a("InsertShapeWave",L.a.lie.toString()),
Md.queryCommandId=L.a.wc.toString(),Md));let Pe;this.addCommandToMaps((Pe=new Ra.a("InsertShapeDoubleWave",L.a.gge.toString()),Pe.queryCommandId=L.a.wc.toString(),Pe));let zf;this.addCommandToMaps((zf=new Ra.a("InsertShapeRectangularCallout",L.a.vhe.toString()),zf.queryCommandId=L.a.wc.toString(),zf));let ge;this.addCommandToMaps((ge=new Ra.a("InsertShapeRoundedRectangleCallout",L.a.Fhe.toString()),ge.queryCommandId=L.a.wc.toString(),ge));let Lg;this.addCommandToMaps((Lg=new Ra.a("InsertShapeOvalCallout",
L.a.jhe.toString()),Lg.queryCommandId=L.a.wc.toString(),Lg));let ei;this.addCommandToMaps((ei=new Ra.a("InsertShapeCloudCallout",L.a.Jfe.toString()),ei.queryCommandId=L.a.wc.toString(),ei));let ti;this.addCommandToMaps((ti=new Ra.a("InsertShapeLineCallout1BorderAccent",L.a.Jge.toString()),ti.queryCommandId=L.a.wc.toString(),ti));let Un;this.addCommandToMaps((Un=new Ra.a("InsertShapeLineCallout2BorderAccent",L.a.Nge.toString()),Un.queryCommandId=L.a.wc.toString(),Un));let xk;this.addCommandToMaps((xk=
new Ra.a("InsertShapeLineCallout3BorderAccent",L.a.Rge.toString()),xk.queryCommandId=L.a.wc.toString(),xk));let Bo;this.addCommandToMaps((Bo=new Ra.a("InsertShapeLineCallout1Accent",L.a.Ige.toString()),Bo.queryCommandId=L.a.wc.toString(),Bo));let Ks;this.addCommandToMaps((Ks=new Ra.a("InsertShapeLineCallout2Accent",L.a.Mge.toString()),Ks.queryCommandId=L.a.wc.toString(),Ks));let Qt;this.addCommandToMaps((Qt=new Ra.a("InsertShapeLineCallout3Accent",L.a.Qge.toString()),Qt.queryCommandId=L.a.wc.toString(),
Qt));let Ls;this.addCommandToMaps((Ls=new Ra.a("InsertShapeLineCallout1",L.a.Hge.toString()),Ls.queryCommandId=L.a.wc.toString(),Ls));let Rt;this.addCommandToMaps((Rt=new Ra.a("InsertShapeLineCallout2",L.a.Lge.toString()),Rt.queryCommandId=L.a.wc.toString(),Rt));let St;this.addCommandToMaps((St=new Ra.a("InsertShapeLineCallout3",L.a.Pge.toString()),St.queryCommandId=L.a.wc.toString(),St));let Tt;this.addCommandToMaps((Tt=new Ra.a("InsertShapeLineCallout1NoBorder",L.a.Kge.toString()),Tt.queryCommandId=
L.a.wc.toString(),Tt));let Ut;this.addCommandToMaps((Ut=new Ra.a("InsertShapeLineCallout2NoBorder",L.a.Oge.toString()),Ut.queryCommandId=L.a.wc.toString(),Ut));let Vt;this.addCommandToMaps((Vt=new Ra.a("InsertShapeLineCallout3NoBorder",L.a.Sge.toString()),Vt.queryCommandId=L.a.wc.toString(),Vt));this.addCommandToMaps(new Ra.a("InsertShapeTextBoxBig",L.a.ZEa.toString()))}S5h(){this.addCommandToMaps(Object.assign(new Ra.a(ce.c9,L.a.hod.toString()),{queryCommandId:L.a.gOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.dB,
L.a.iod.toString()),{queryCommandId:L.a.hOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.dE,L.a.jod.toString()),{queryCommandId:L.a.iOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.cE,L.a.god.toString()),{queryCommandId:L.a.fOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.Zta,L.a.kod.toString()),{queryCommandId:L.a.geh.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.oab,L.a.$nd.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.Fda,
L.a.aod.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.Yta,L.a.bod.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.Kka,L.a.cod.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.Lka,L.a.dod.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.TEa,L.a.eod.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.UEa,
L.a.QUe.toString()),{queryCommandId:L.a.dOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.b9,L.a.fod.toString()),{queryCommandId:L.a.eOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.VEa,L.a.OKa.toString()),{queryCommandId:L.a.jOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.WEa,L.a.RUe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.XEa,L.a.SUe.toString()),{queryCommandId:L.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a(ce.YEa,
L.a.TUe.toString()),{queryCommandId:L.a.wc.toString()}))}c6h(){this.addCommandToMaps(Object.assign(new Ra.a("Select",G.a.wRa.toString()),{legacyControlId:"idTableSelect"}));this.addCommandToMaps(Object.assign(new Ra.a("SelectTable",D.a.rLb.toString()),{legacyControlId:"btnSelectTable"}));this.addCommandToMaps(Object.assign(new Ra.a("SelectColumn",D.a.Ynd.toString()),{legacyControlId:"btnSelectColumn"}));this.addCommandToMaps(Object.assign(new Ra.a("SelectRow",D.a.$pc.toString()),{legacyControlId:"btnSelectRow"}));
this.addCommandToMaps(Object.assign(new Ra.a("TableDelete",G.a.wRa.toString()),{legacyControlId:"idTableDelete"}));this.addCommandToMaps(Object.assign(new Ra.a("PowerPointDeleteTableColumn",L.a.Zid.toString()),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Ra.a("PowerPointDeleteTableRow",L.a.wmc.toString()),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Ra.a("DeleteTable",D.a.r8.toString()),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertRowAbove",
D.a.lUa.toString()),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertRowBelow",D.a.eua.toString()),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertColumnLeft",D.a.$8b.toString()),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertColumnRight",D.a.a9b.toString()),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(new Ra.a("ApplyTableStyleOptionAnchor",G.a.wRa.toString()));
this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableStyleOptionHeaderRow",D.a.QZ.toString()),{legacyControlId:"buttonFirstRow",queryCommandId:D.a.boa.toString(),menuItemId:"buttonFirstRow"}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableStyleOptionFirstColumn",D.a.QZ.toString()),{legacyControlId:"buttonFirstColumn",queryCommandId:D.a.boa.toString(),menuItemId:"buttonFirstColumn"}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableStyleOptionTotalRow",D.a.QZ.toString()),{legacyControlId:"buttonLastRow",
queryCommandId:D.a.boa.toString(),menuItemId:"buttonLastRow"}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableStyleOptionLastColumn",D.a.QZ.toString()),{legacyControlId:"buttonLastColumn",queryCommandId:D.a.boa.toString(),menuItemId:"buttonLastColumn"}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableStyleOptionBandedRows",D.a.QZ.toString()),{legacyControlId:"buttonBandedRow",queryCommandId:D.a.boa.toString(),menuItemId:"buttonBandedRow"}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableStyleOptionBandedColumns",
D.a.QZ.toString()),{legacyControlId:"buttonBandedColumn",queryCommandId:D.a.boa.toString(),menuItemId:"buttonBandedColumn"}));this.addCommandToMaps(Object.assign(new Ra.a("PowerPointCellShadingMenuOpen",L.a.Q5.toString()),{legacyControlId:"cellShadingColor",populationProps:new jh(L.a.Cbh.toString(),!1),menuItemId:"cellShadingColor"}));this.addCommandToMaps(new Ra.a("StandardCellShadingColorPicker",L.a.Q5.toString()));this.addCommandToMaps(new Ra.a("ThemeCellShadingColorPicker",L.a.Q5.toString()));
this.addCommandToMaps(new Ra.a("ThemeCellShadingColorPickerMCU",L.a.Q5.toString()));this.addCommandToMaps(new Ra.a("NoCellShading",L.a.TJa.toString()));this.addCommandToMaps(new Ra.a("CellShadingMoreColors",L.a.zbh.toString()));this.addCommandToMaps(new Ra.a("CellShadingRecentColors",L.a.Yid.toString()));this.addCommandToMaps(Object.assign(new Ra.a("SetSizeAnchor",L.a.Nrc.toString()),{queryCommandId:L.a.EJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("MergeTableCells",L.a.mergeTableCells.toString()),
{legacyControlId:"btnMergeTableCells"}));this.addCommandToMaps(Object.assign(new Ra.a("SplitTableCells",L.a.splitTableCells.toString()),{legacyControlId:"btnSplitTableCells"}));this.addCommandToMaps(new Ra.a("TableAnchor",L.a.$fg.toString()));this.addCommandToMaps(Object.assign(new Ra.a("TableStyles",D.a.PZ.toString()),{legacyControlId:"fsfaMoreTableStyles",queryCommandId:D.a.QJb.toString(),populationProps:new jh(D.a.rIb.toString(),!1),previewControlIds:"buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" ")}));
this.addCommandToMaps(new Ra.a("TableAlignmentAnchor",L.a.pbh.toString()));this.addCommandToMaps(Object.assign(new Ra.a("TableCellBottomAnchoring",L.a.b1.toString()),{legacyControlId:"btnTableCellBottomAnchoring",queryCommandId:L.a.fKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellCenterJustify",L.a.Bxa.toString()),{legacyControlId:"btnTableCellCenterJustify",queryCommandId:L.a.bKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellLeftJustify",L.a.Dxa.toString()),
{legacyControlId:"btnTableCellLeftJustify",queryCommandId:L.a.cKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellMiddleAnchoring",L.a.c1.toString()),{legacyControlId:"btnTableCellMiddleAnchoring",queryCommandId:L.a.gKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellRightJustify",L.a.Fxa.toString()),{legacyControlId:"btnTableCellRightJustify",queryCommandId:L.a.eKa.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellTopAnchoring",L.a.d1.toString()),
{legacyControlId:"btnTableCellTopAnchoring",queryCommandId:L.a.hKa.toString()}));this.addCommandToMaps(new Ra.a("TableAlternativeText",L.a.Lrb.toString()));this.addCommandToMaps(new Ra.a("DistributeRows",L.a.nQf.toString()));this.addCommandToMaps(new Ra.a("DistributeColumns",L.a.mQf.toString()));this.addCommandToMaps(new Ra.a("TableDistribute",L.a.zBh.toString()));this.addCommandToMaps(Object.assign(new Ra.a("SetCellBorderColor",L.a.bBh.toString()),{populationProps:new jh(L.a.Sah.toString(),!1)}));
this.addCommandToMaps(new Ra.a("CellBorderColorPickerMCU",L.a.b1a.toString()));this.addCommandToMaps(new Ra.a("CellBorderColorPicker",L.a.b1a.toString()));this.addCommandToMaps(new Ra.a("StandardCellBorderColorPicker",L.a.b1a.toString()));this.addCommandToMaps(new Ra.a("CellBorderRecentColors",L.a.sbh.toString()));this.addCommandToMaps(new Ra.a("CellBorderMoreColors",L.a.s_g.toString()));this.addCommandToMaps(new Ra.a("TableBorderWidthAnchor",L.a.pBh.toString()));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_1",
L.a.dza.toString()),{queryCommandId:L.a.cPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_2",L.a.dza.toString()),{queryCommandId:L.a.dPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_3",L.a.dza.toString()),{queryCommandId:L.a.ePe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_4",L.a.dza.toString()),{queryCommandId:L.a.fPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_5",L.a.dza.toString()),
{queryCommandId:L.a.gPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_6",L.a.dza.toString()),{queryCommandId:L.a.hPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_7",L.a.dza.toString()),{queryCommandId:L.a.iPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_8",L.a.dza.toString()),{queryCommandId:L.a.jPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBorderWidth_9",L.a.dza.toString()),{queryCommandId:L.a.kPe.toString()}));
this.addCommandToMaps(new Ra.a("TableBorderTypeAnchor",L.a.oBh.toString()));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersNoBorder",L.a.fpa.toString()),{queryCommandId:L.a.ZOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersAllBorders",L.a.fpa.toString()),{queryCommandId:L.a.ROe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersOutsideBorders",L.a.fpa.toString()),{queryCommandId:L.a.$Oe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersInsideBorders",
L.a.dBh.toString()),{queryCommandId:L.a.VOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersTopBorder",L.a.fpa.toString()),{queryCommandId:L.a.bPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersBottomBorder",L.a.fpa.toString()),{queryCommandId:L.a.SOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersLeftBorder",L.a.fpa.toString()),{queryCommandId:L.a.YOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersRightBorder",
L.a.fpa.toString()),{queryCommandId:L.a.aPe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersInsideHorizontalBorder",L.a.cBh.toString()),{queryCommandId:L.a.WOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersInsideVerticalBorder",L.a.eBh.toString()),{queryCommandId:L.a.XOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersDiagonalUpBorder",L.a.fpa.toString()),{queryCommandId:L.a.UOe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableBordersDiagonalDownBorder",
L.a.fpa.toString()),{queryCommandId:L.a.TOe.toString()}));this.addCommandToMaps(new Ra.a("TableCellMarginAnchor",L.a.m1e.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableCellMarginNormal",L.a.Tsc.toString()),{queryCommandId:L.a.Akd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableCellMarginNone",L.a.Ssc.toString()),{queryCommandId:L.a.zkd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableCellMarginNarrow",L.a.Rsc.toString()),{queryCommandId:L.a.ykd.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("ApplyTableCellMarginWide",L.a.Wsc.toString()),{queryCommandId:L.a.Bkd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TableCellMarginCustom",L.a.Nrc.toString()),{queryCommandId:L.a.EJb.toString()}))}W6h(){this.Hi(Object.assign(new vg("ContextualTabs.Tables.Design.Shading"),{externalUxCommandIds:["PowerPointCellShadingMenuOpen"]}));this.Hi(Object.assign(new vg("ContextualTabs.Tables.Design.TableStyleOptions"),{externalUxGroupId:"TableTableStyleOptions"}));
this.Hi(Object.assign(new vg("ContextualTabs.Tables.Design.TableStyles"),{externalUxGroupId:"TableStyles"}));this.Hi(Object.assign(new vg("ContextualTabs.Tables.Layout.Alignment"),{externalUxGroupId:"Alignment"}));this.Hi(Object.assign(new vg("ContextualTabs.Tables.Layout.CellSize"),{externalUxCommandIds:["SetSizeAnchor"]}));this.Hi(Object.assign(new vg("ContextualTabs.Tables.Layout.Properties"),{externalUxCommandIds:["AlternativeText"]}));this.Hi(Object.assign(new vg("ContextualTabs.Tables.Layout.RowColumn"),
{externalUxCommandIds:["TableDelete","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight"]}));this.Hi(Object.assign(new vg("ContextualTabs.Tables.Layout.Table"),{externalUxCommandIds:["Select"]}));this.Hi(Object.assign(new vg("ContextualTabs.Tables.Layout.TableSize"),{externalUxGroupId:"TableSize"}));this.Hi(Object.assign(new vg("PptRibbon.Animation.Gallery"),{externalUxGroupId:"AnimationGallery"}));this.Hi(Object.assign(new vg("PptRibbon.Animation.Timing"),{externalUxGroupId:"Timing"}));
this.Hi(Object.assign(new vg("PptRibbon.Design.Customize"),{externalUxGroupId:"Customize"}));this.Hi(Object.assign(new vg("PptRibbon.Design.Designer"),{externalUxGroupId:"Designer"}));this.Hi(Object.assign(new vg("PptRibbon.Design.Designer.New"),{externalUxGroupId:"DesignerNew"}));this.Hi(Object.assign(new vg("PptRibbon.Home.Designer"),{externalUxGroupId:"DesignerHome"}));this.Hi(Object.assign(new vg("PptRibbon.Home.Ideas"),{externalUxGroupId:"Ideas"}));(this.la.eB||this.la.$W)&&this.addCommandToMaps(Object.assign(new Ra.a("ChatPPTPane",
L.a.Z_b.toString()),{queryCommandId:L.a.Nnc.toString()}));this.Hi(Object.assign(new vg("PptRibbon.Design.ThemeVariants"),{externalUxGroupId:"MoreVariants"}));this.Hi(Object.assign(new vg("PptRibbon.DrawingFormat.InsertShapes"),{externalUxGroupId:"InsertShapes"}));this.Hi(Object.assign(new vg("PptRibbon.DrawingFormat.ShapeStyles"),{externalUxGroupId:"ShapeStyles"}));this.Hi(Object.assign(new vg("PptRibbon.Home.ClipboardCutEnabled"),{externalUxCommandIds:["Cut"]}));this.Hi(Object.assign(new vg("PptRibbon.Home.Delete"),
{externalUxGroupId:"Delete"}));this.Hi(Object.assign(new vg("PptRibbon.Home.Dictation"),{externalUxGroupId:"Dictation"}));this.Hi(Object.assign(new vg("PptRibbon.Home.Drawing"),{externalUxGroupId:"Drawing"}));this.Hi(Object.assign(new vg("PptRibbon.Home.Editing"),{externalUxGroupId:"Editing"}));this.Hi(Object.assign(new vg("PptRibbon.Home.Font"),{externalUxGroupId:"Font"}));this.Hi(Object.assign(new vg("PptRibbon.Home.Slides"),{externalUxGroupId:"Slides"}));this.Hi(Object.assign(new vg("PptRibbon.Home.UndoRedo"),
{externalUxGroupId:"Undo"}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.AppForOffice"),{externalUxCommandIds:["InsertAddIns"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.Comments"),{externalUxCommandIds:["InsertComment"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.Illustrations"),{externalUxCommandIds:["InsertShapesAll","InsertIconDialog","InsertSmartArtAnchor"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.Images"),{externalUxCommandIds:["Picture","OnlinePictures"]}));
this.Hi(Object.assign(new vg("PptRibbon.InsertTab.InsertHyperlink"),{externalUxCommandIds:["InsertLink"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.InsertSlides"),{externalUxCommandIds:["InsertSlides"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.InsertTables"),{externalUxCommandIds:["TableAnchor"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.InvokeFilesSerplet"),{externalUxCommandIds:["InvokeFilesSerplet"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.Media"),{externalUxCommandIds:["InsertOnlineVideo"]}));
this.Hi(Object.assign(new vg("PptRibbon.InsertTab.Symbols"),{externalUxCommandIds:["InsertSymbol"]}));this.Hi(Object.assign(new vg("PptRibbon.InsertTab.Text"),{externalUxCommandIds:["InsertTextBox"]}));this.Hi(Object.assign(new vg("PptRibbon.PictureFormat.Adjust"),{externalUxGroupId:"Adjust"}));this.Hi(Object.assign(new vg("PptRibbon.PictureFormat.Size"),{externalUxCommandIds:["PictureCropAnchor"]}));this.Hi(Object.assign(new vg("PptRibbon.PictureFormat.Style"),{externalUxGroupId:"PictureStyles"}));
this.Hi(Object.assign(new vg("PptRibbon.Review.Comments"),{externalUxGroupId:"Comments"}));this.Hi(Object.assign(new vg("PptRibbon.Review.Inspect"),{externalUxGroupId:"Accessibility"}));this.Hi(Object.assign(new vg("PptRibbon.Review.Translate "),{externalUxGroupId:"Translate"}));this.Hi(Object.assign(new vg("PptRibbon.Review.Activity"),{externalUxGroupId:"Activity"}));this.Hi(Object.assign(new vg("PptRibbon.SmartArt.CreateGraphic"),{externalUxGroupId:"SmartArtCreateGraphic"}));this.Hi(Object.assign(new vg("PptRibbon.SmartArt.Layouts"),
{externalUxGroupId:"SmartArtLayouts"}));this.Hi(Object.assign(new vg("PptRibbon.SmartArt.Reset"),{externalUxGroupId:"SmartArtReset"}));this.Hi(Object.assign(new vg("PptRibbon.SmartArt.Styles"),{externalUxGroupId:"SmartArtStyles"}));this.Hi(Object.assign(new vg("PptRibbon.Transition.AllSlides"),{externalUxGroupId:"TransitionAllSlides"}));this.Hi(Object.assign(new vg("PptRibbon.Transition.Gallery"),{externalUxGroupId:"Transitions"}));this.Hi(Object.assign(new vg("PptRibbon.Transition.Timing"),{externalUxGroupId:"TransitionTiming"}));
this.Hi(Object.assign(new vg("PptRibbon.Review.Proofing"),{externalUxGroupId:"Proofing"}));this.Hi(Object.assign(new vg("PptRibbon.View.PresentationViews"),{externalUxCommandIds:["ReadingView"]}));this.Hi(Object.assign(new vg("PptRibbon.View.ShowHide"),{externalUxCommandIds:["Notes","ShowHideComments"]}));this.Hi(Object.assign(new vg("PptRibbon.View.StartSlideShow"),{externalUxGroupId:"StartSlideShow"}));this.Hi(Object.assign(new vg("PptRibbon.View.Zoom"),{externalUxGroupId:"Zoom"}));this.Hi(Object.assign(new vg("PptRibbon.View.Subtitles"),
{externalUxGroupId:"Subtitles"}));this.Hi(Object.assign(new vg("PptRibbon.Help.GroupHelp"),{externalUxGroupId:"Help"}));this.Hi(Object.assign(new vg("PptRibbon.PictureFormat.PictureBorders"),{externalUxGroupId:"PictureBorders"}));this.Hi(Object.assign(new vg("PptRibbon.DrawingFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Hi(Object.assign(new vg("PptRibbon.PictureFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Hi(Object.assign(new vg("PptRibbon.Graphics.NewArrange"),{externalUxGroupId:"GraphicsArrange"}));
this.Hi(Object.assign(new vg("PptRibbon.DrawingFormat.FormatOptions"),{externalUxGroupId:"Properties"}));this.Hi(Object.assign(new vg("PptRibbon.PictureFormat.FormatOptions"),{externalUxGroupId:"Size"}));this.Hi(Object.assign(new vg("PptRibbon.Graphics.FormatOptions"),{externalUxGroupId:"Properties"}))}N5h(){this.addCommandToMaps(Object.assign(new Ra.a("PptFileMenuEmbed",L.a.Ekb.toString()),{legacyControlId:"PptJewel.Share.Embed"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileMenuShare",
G.a.Xsa.toString()),{legacyControlId:"PptJewel.Share.ShareWithPeople"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileMenuTermsOfUse",G.a.NHb.toString()),{legacyControlId:"PptJewel.About.TermsOfUse"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileMenuThirdPartyNotices",G.a.gNb.toString()),{legacyControlId:"PptJewel.About.ThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileMenuPrivacy",G.a.YIb.toString()),{legacyControlId:"PptJewel.About.Privacy"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileAboutPage",
G.a.ve.toString()),{legacyControlId:"PptJewel.About"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileHomePage",G.a.omc.toString()),{legacyControlId:"PptJewel.Home"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileAddinPage",G.a.ve.toString()),{legacyControlId:"PptJewel.Addin"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileInfoPage",G.a.ve.toString()),{legacyControlId:"PptJewel.Info"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileNewPage",G.a.omc.toString()),{legacyControlId:"PptJewel.New"}));
this.addCommandToMaps(Object.assign(new Ra.a("PptFileOpenPage",G.a.Qid.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFilePrintPage",G.a.ve.toString()),{legacyControlId:"PptJewel.Print"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileSaveAsPage",G.a.ve.toString()),{legacyControlId:"PptJewel.SaveACopy"}));this.addCommandToMaps(Object.assign(new Ra.a("PptFileSharePage",G.a.ve.toString()),{legacyControlId:"PptJewel.Share"}))}U5h(){this.addCommandToMaps(new Ra.a("GroupAnchor",
L.a.TLe.toString()));this.addCommandToMaps(new Ra.a("GroupShapes",L.a.ULe.toString()));this.addCommandToMaps(new Ra.a("UngroupShapes",L.a.bMe.toString()))}R5h(){this.addCommandToMaps(new Ra.a("AudioPlay",L.a.mIc.toString()));this.addCommandToMaps(new Ra.a("AudioPause",L.a.KZb.toString()));this.addCommandToMaps(Object.assign(new Ra.a("SetAudioOptions",L.a.uqh.toString()),{queryCommandId:L.a.gnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("PlayAcrossSlides",L.a.playAcrossSlides.toString()),
{queryCommandId:L.a.xnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("LoopUntilStopped",L.a.loopUntilStopped.toString()),{queryCommandId:L.a.tnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("HideDuringShow",L.a.hideDuringShow.toString()),{queryCommandId:L.a.onc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("RewindAfterPlaying",L.a.rewindAfterPlaying.toString()),{queryCommandId:L.a.Cnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("PlayInBackground",
L.a.playInBackground.toString()),{queryCommandId:L.a.ync.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("NoAudioStyle",L.a.noAudioStyle.toString()),{queryCommandId:L.a.unc.toString()}));this.addCommandToMaps(new Ra.a("SetVolume",L.a.setVolume.toString()));this.addCommandToMaps(Object.assign(new Ra.a("SetVolumeLow",L.a.fqd.toString()),{queryCommandId:L.a.Gnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SetVolumeMedium",L.a.gqd.toString()),{queryCommandId:L.a.Hnc.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("SetVolumeHigh",L.a.eqd.toString()),{queryCommandId:L.a.Fnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SetVolumeMute",L.a.hqd.toString()),{queryCommandId:L.a.Inc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("StartAudio",L.a.Pyh.toString()),{queryCommandId:L.a.Qnc.toString()}))}b6h(){this.addCommandToMaps(Object.assign(new Ra.a("GetSlideInformation",G.a.X7.toString()),{queryCommandId:L.a.MJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("OpenLanguageDialog",
L.a.ihd.toString()),{legacyControlId:"PptEditingStatusBar.LanguageButton",queryCommandId:L.a.oJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("OpenDocumentLabelPane",G.a.MJe.toString()),{queryCommandId:G.a.tJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("TextForOfficeOnlineInGallatin",G.a.X7.toString()),{legacyControlId:"PptEditingStatusBar.MiddleStatus"}));this.addCommandToMaps(Object.assign(new Ra.a("GetEnvironmentName",G.a.X7.toString()),{legacyControlId:"EnvironmentLabel",
queryCommandId:G.a.ZNe.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("GetSlideScore",G.a.X7.toString()),{legacyControlId:"SlideScoreLabel",queryCommandId:L.a.yeh.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("GetCoAuthStatus",G.a.X7.toString()),{legacyControlId:"CoauthStatusLabel",queryCommandId:L.a.Zdh.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("GetDataSyncMode",G.a.X7.toString()),{legacyControlId:"DataSyncModeLabel",queryCommandId:L.a.$dh.toString()}));
this.addCommandToMaps(Object.assign(new Ra.a("GetOfflineStatus",G.a.X7.toString()),{legacyControlId:"PptEditingStatusBar.OfflineModeStatusLabel",queryCommandId:L.a.neh.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShowAddInCommandsLoadStatusCallout",G.a.RYe.toString()),{legacyControlId:"PptEditingStatusBar.AddInCommandsLoadStatus",queryCommandId:G.a.iJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("OpenFeedbackDialog",G.a.giveFeedback.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedback"}));
this.addCommandToMaps(Object.assign(new Ra.a("GiveFeedbackPane",G.a.jLb.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedbackPane"}));this.addCommandToMaps(Object.assign(new Ra.a("ShowHidePerfStats",L.a.hrd.toString()),{legacyControlId:"PptEditingStatusBar.PerfStats",queryCommandId:L.a.vnc.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShowHideNotes",L.a.pLa.toString()),{legacyControlId:"PptEditingStatusBar.Notes",queryCommandId:L.a.Rjd.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShowEditTriPaneViewInStatusBar",
L.a.nLa.toString()),{legacyControlId:"PptEditingStatusBar.Edit",queryCommandId:L.a.kJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("ShowSorterViewInStatusBar",L.a.oga.toString()),{legacyControlId:"PptEditingStatusBar-SlideSorterView",queryCommandId:L.a.NJb.toString()}));this.addCommandToMaps(Object.assign(new Ra.a("SwitchToReadingMode",L.a.hld.toString()),{legacyControlId:"PptEditingStatusBar.Reading"}));this.addCommandToMaps(Object.assign(new Ra.a("StartSlideShowFromCurrentSlide",
L.a.Vya.toString()),{legacyControlId:"PptEditingStatusBar.SlideShow"}));this.addCommandToMaps(new Ra.a("ZoomOut",G.a.Cub.toString()));this.addCommandToMaps(Object.assign(new Ra.a("OpenZoomConfig",L.a.SJe.toString()),{legacyControlId:"PptEditingStatusBar.ZoomScale",queryCommandId:L.a.sPe.toString()}));this.addCommandToMaps(new Ra.a("ZoomIn",G.a.Gyb.toString()));this.addCommandToMaps(Object.assign(new Ra.a("ZoomToFit",L.a.Fvc.toString()),{legacyControlId:"PptEditingStatusBar.FitToWindow"}))}O5h(){this.addCommandToMaps(new Ra.a("AccessibleAuthoringHelp",
L.a.fsf.toString()));this.addCommandToMaps(new Ra.a("AddHiddenSlideTitle",L.a.stf.toString()));this.addCommandToMaps(new Ra.a("AddSlideTitle",L.a.addSlideTitle.toString()));this.addCommandToMaps(new Ra.a("EditSlideTitle",L.a.editSlideTitle.toString()));this.addCommandToMaps(new Ra.a("InsertCaptions",L.a.Ifg.toString()));this.addCommandToMaps(new Ra.a("InsertCaptionsSplitButton",L.a.Jfg.toString()));this.addCommandToMaps(new Ra.a("LinkText",L.a.wbh.toString()));this.addCommandToMaps(new Ra.a("RemoveAllCaptions",
L.a.cih.toString()));this.addCommandToMaps(new Ra.a("SetAsSlideTitle",L.a.setAsSlideTitle.toString()));this.addCommandToMaps(new Ra.a("SlideTitle",L.a.Zsf.toString()))}}Object(n.a)(iB,"PPTWebEditReactCommandDefinitionMapping",dx,[]);class Uy{}Uy.UAh="TabId";Object(n.a)(Uy,"RibbonSQMProperties",null,[]);class pB{constructor(a){this.Ca=a;this.Ca.ya(G.a.ymd,Xd.a.frame,Object(F.a)(this,this.ymd,"reportTabSwitch"));this.Ca.ya(G.a.jlh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.llh,Xd.a.frame,ac.ActionManager.Ng)}ymd(a,
b,c,f,l){this.Ca.processAction(this.wij(l[Uy.UAh]),2);return 32}}Object(n.a)(pB,"RibbonSQMInformation",null,[363]);class Hh{}Hh.uGc="PptRibbon.AddIns";Hh.hW="PptRibbon.Animation";Hh.design="PptRibbon.Design";Hh.zNc="PptRibbon.Developer";Hh.PVc="PptRibbon.Graphics";Hh.help="PptRibbon.Help";Hh.home="PptRibbon.Home";Hh.insert="PptRibbon.InsertTab";Hh.picture="PptRibbon.PictureFormat";Hh.review="PptRibbon.Review";Hh.shape="PptRibbon.DrawingFormat";Hh.slideShow="PptRibbon.SlideShow";Hh.smartArt="PptRibbon.SmartArt";
Hh.yBh="ContextualTabs.Tables.Design";Hh.tableLayout="ContextualTabs.Tables.Layout";Hh.n1a="PptRibbon.Transition";Hh.view="PptRibbon.View";Object(n.a)(Hh,"MLRTabIds",null,[]);class Aj{}Aj.uGc="AddIns";Aj.hW="Animations";Aj.design="Design";Aj.zNc="Developer";Aj.draw="Draw";Aj.PVc="Graphics";Aj.help="Help";Aj.home="Home";Aj.insert="Insert";Aj.picture="FormatPicture";Aj.review="Review";Aj.shape="FormatShape";Aj.slideShow="SlideShow";Aj.smartArt="SmartArtDesign";Aj.table="Table";Aj.n1a="Transitions";
Aj.view="View";Object(n.a)(Aj,"SLRTabIds",null,[]);class qG extends pB{constructor(a){super(a)}PWk(){this.Ca.ya(G.a.Wkh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.Xkh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.Ykh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.Zkh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.alh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.blh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.clh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.dlh,Xd.a.frame,ac.ActionManager.Ng);
this.Ca.ya(L.a.elh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.flh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.glh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.hlh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.ilh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.ASe,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(L.a.klh,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ya(G.a.mlh,Xd.a.frame,ac.ActionManager.Ng)}wij(a){let b=G.a.llh,c="PptRibbon.Unknown";switch(a){case Hh.uGc:case Aj.uGc:c=Hh.uGc;b=G.a.Wkh;
break;case Hh.hW:case Aj.hW:c=Hh.hW;b=L.a.Xkh;break;case Hh.design:case Aj.design:c=Hh.design;b=L.a.Ykh;break;case Hh.zNc:case Aj.zNc:c=Hh.zNc;b=G.a.Zkh;break;case Aj.draw:c=a;b=L.a.$kh;break;case Hh.PVc:case Aj.PVc:c=Hh.PVc;b=L.a.alh;break;case Hh.help:case Aj.help:c=Hh.help;b=G.a.blh;break;case Hh.home:case Aj.home:c=Hh.home;b=G.a.clh;break;case Hh.insert:case Aj.insert:c=Hh.insert;b=G.a.dlh;break;case Hh.picture:case Aj.picture:c=Hh.picture;b=L.a.elh;break;case Hh.review:case Aj.review:c=Hh.review;
b=G.a.flh;break;case Hh.shape:case Aj.shape:c=Hh.shape;b=L.a.glh;break;case Hh.slideShow:case Aj.slideShow:c=Hh.slideShow;b=L.a.hlh;break;case Hh.smartArt:case Aj.smartArt:c=Hh.smartArt;b=L.a.ilh;break;case Hh.yBh:case Hh.tableLayout:c=a;b=L.a.ASe;break;case Aj.table:c=Hh.yBh;b=L.a.ASe;break;case Hh.n1a:case Aj.n1a:c=Hh.n1a;b=L.a.klh;break;case Hh.view:case Aj.view:c=Hh.view,b=G.a.mlh}if(a=Rc.a.Ib)a.actionName=c,a.Oj=!0,a.Ur=!1;return b}}Object(n.a)(qG,"PPTWebEditorRibbonSQMInformation",pB,[]);var sv=
d(927);class qB{constructor(){this.lQb=null}FBl(){this.lQb||(this.lQb=Ab.a.instance.rb("Common.App.AccountSwitching.IAccountSwitching"))||ka.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}H3i(){this.FBl();return this.lQb?this.lQb.getCustomAuthConfig():null}static ZMj(){return u.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}Object(n.a)(qB,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class rB{constructor(){this.cbc=this.cultureName=null}}Object(n.a)(rB,
"HeaderCultureInfo",null,[]);var Vy=d(675);class rG{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(n.a)(rG,"SearchInitializationSettings",null,[]);class sG{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=
null;this.isShared=!1}}Object(n.a)(sG,"DocumentTitleAppProps",null,[]);class tG{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(n.a)(tG,"DocumentTitleCalloutAppProps",null,[]);class uG{constructor(){this.language=this.culture=this.userID=
this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;
this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(n.a)(uG,"HeaderAppProps",null,[]);class vG{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(n.a)(vG,"HeaderControls",null,[]);class wG{constructor(){this.command=this.label=
null}}Object(n.a)(wG,"WorkflowButtonAppProps",null,[]);var Wy;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(Wy||(Wy={}));Object(n.b)("RenameDisableReason",Wy);class xG{constructor(a=""){this.CUe=this.documentTitleAppProps=this.c7e=null;this.$1h=""!==a?a:vp.a.iP}Khj(a){const b=Ab.a.instance.rb("Common.IExternalUICommandDefinitionMapping").XDa(a);
if(b&&0<b.length)return b[0].externalUxCommand;ka.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}ebe(){if(!this.c7e){const a=sv.a();if(a){const b=this.Khj(a.command);b&&(this.c7e=Object.assign(new wG,{command:b,label:a.label}))}}return this.c7e}M7i(){return Object.assign(new vG,{workflowButton:this.ebe()})}luk(){db.a.get_instance().YJ(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;u.AFrameworkApplication.Ta.La(G.a.Bgb,
2,a)}jij(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}J9i(){let a=null,b=null;var c=Ab.a.instance.rb("Common.IRenameProps");c?(c=c.v6f(),0!==c&&(a=this.jij(c),b=Wy[c])):ka.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new tG,
{breadcrumbBrandName:u.AFrameworkApplication.St.breadcrumbBrandName,breadcrumbBrandUrl:u.AFrameworkApplication.St.breadcrumbBrandUrl,breadcrumbFolderName:u.AFrameworkApplication.St.breadcrumbFolderName,breadcrumbFolderUrl:u.AFrameworkApplication.St.breadcrumbFolderUrl,hideDocumentTitleInput:u.AFrameworkApplication.Aa.hb.CAj,isVersionHistoryEnabled:this.Okl(),documentExtension:ha.a.pQ(u.AFrameworkApplication.fileName),isMoveEnabled:32===u.AFrameworkApplication.Ta.processAction(G.a.Bgb,1),onMove:Object(F.a)(this,
this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:u.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}W1f(){if(!this.documentTitleAppProps){const a=u.AFrameworkApplication.St.$w;this.documentTitleAppProps=Object.assign(new sG,{documentTitle:u.AFrameworkApplication.kOc?a:ha.a.XG(a),onFirstRender:Object(F.a)(this,this.luk,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(F.a)(this,this.J9i,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Okl(){return!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.jng}Vil(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.LVj}zkl(){const a=!sv.b()&&!u.AFrameworkApplication.hideHeader&&!u.AFrameworkApplication.Mcg&&(u.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||u.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));ka.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}gBi(a){appChrome.getHeaderApi().then(b=>{b.setNavBarData(a.result);return null});ka.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}cVk(){appChrome.getHeaderApi().then(a=>
{const b=Ab.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});a.setHeaderCommandHandler("SetCookie",c=>ui.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.N7i(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(F.a)(this,this.ebe,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(F.a)(this,this.W1f,"getDocumentTitleAppProps"));a.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.muk();return null});Vy.a.o0c()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(F.a)(this,this.T6f,"getSearchInitializationSettings"))})}muk(){Ab.a.instance.Ja("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.rpa(!1,u.AFrameworkApplication.Ta.mode)})}N7i(a){a=
ui.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}Cmj(){return $k.AppChromeOverrideUtilities.isEnabled?$k.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.$1h+u.AFrameworkApplication.s1+"suiteux-shell"}onFirstRender(){Ab.a.instance.Ja("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.eil.continueWith(Object(F.a)(this,this.gBi,"continueShellServiceDataAsync"),3)});db.a.get_instance().YJ(15)}onFullyLoaded(){db.a.get_instance().YJ(16)}uhj(){a:{try{var a=
Xa.a.xe(u.AFrameworkApplication.lcid);if(a){var b=Object.assign(new rB,{cultureName:a.name,cbc:a.cbc});break a}}catch(c){ka.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+u.AFrameworkApplication.lcid.toString())}b=Object.assign(new rB,{cultureName:"en-us",cbc:"en"})}a=Ab.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b=Object.assign(new uG,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.cbc,isConsumer:!u.AFrameworkApplication.Mvd,
showAppLauncher:sv.f(),showMeControl:sv.e(),hideUserName:u.AFrameworkApplication.cde,defaultDocumentTitleToLeft:u.AFrameworkApplication.rNf,assetsContainerOverride:this.Cmj(),controls:this.M7i(),documentTitleAppProps:this.W1f(),showDocumentTitleControl:!0,showWorkflowButton:!!this.ebe(),showChatControl:this.zkl(),showGoPremiumControl:sv.g(),showDiscoverPremiumButton:sv.d(),enableSearchControl:Vy.a.jVj(),onFlexPaneOpen:Object(F.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(F.a)(a,
a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.Vil(),testTraffic:u.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(F.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(F.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:u.AFrameworkApplication.Wil()});!u.AFrameworkApplication.kmb||u.AFrameworkApplication.WZe?(b.userDisplayName=u.AFrameworkApplication.userName,b.emailAddress=u.AFrameworkApplication.fa.Ga("UserPrincipalName"),
b.userID=u.AFrameworkApplication.fa.Ga("Puid")||"",b.signOutLink=u.AFrameworkApplication.WZe):u.AFrameworkApplication.signInUrl&&(b.signInLink=u.AFrameworkApplication.signInUrl);Vy.a.o0c()&&(a=this.T6f(),b.loadTellMeResources=a.loadTellMeResources,b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=u.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),b.userRing=a.userRing);qB.ZMj()&&(a=new qB,b.shellAuthProviderConfigPromise=Object(F.a)(a,a.H3i,"getAccountSwitchingConfig"));
this.cVk();return b}T6f(){if(!this.CUe){const a=new Vy.a;let b=u.AFrameworkApplication.fa.Ga("Microsoft365Ring");b&&b.length||(b="generalAudience");this.CUe=Object.assign(new rG,{loadTellMeResources:a.Y1j(),getTokenRequestDictionary:Object(F.a)(a,a.Unj,"getTokenRequestDict"),userRing:b})}return this.CUe}}Object(n.a)(xG,"ReactSharedHeaderPropsHelper",null,[636]);var Eg=d(346),YP=d(1230),ZP=d(1079);d(928);var yG=d(674);const Wt=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},zG=(a,b,c,f)=>{if(a&&
a.parentNode&&a.parentNode.parentNode){var l=(l=Jf.a.Xt(a))?za.a.xM(l.paddingLeft)+za.a.xM(l.paddingRight):0;var w=Jf.a.Xt(a.parentNode);w=w?za.a.xM(w.paddingLeft)+za.a.xM(w.paddingRight):0;let H=0,U=a;for(;U.nextSibling;)U=U.nextSibling,H+=U.offsetWidth;l=l+w+H;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-l+"px");w=f?c:b;c=f?b:c;f=Kd.a.ai(a.parentNode.parentNode);b=w?Kd.a.ai(w):new Sys.UI.Bounds(f.x,0,0,0);c=c?Kd.a.H9a(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===
a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=Kd.a.ai(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},Xy=a=>{a&&Zq(a)&&(a.style.display="",a._isHidden="0")},il=a=>{a&&!Zq(a)&&(a.style.display="none",a._isHidden="1")},Zq=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},Ms=(a,b,c)=>{if(a&&!Zq(a)){var f=Jf.a.Xt(a);f=za.a.xM(f.paddingLeft)+za.a.xM(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=
Jf.a.Xt(b))&&(l+=za.a.xM(f.paddingLeft)+za.a.xM(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},Qr=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},$P=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,top:l}=Kd.a.c2f(b,f,l));b=c?f-a.offsetWidth:f+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},xq=(a,b,c)=>!a||!b||Zq(a)||Zq(b)?!1:Kd.a.dqg(Kd.a.ai(a),Kd.a.ai(b),c),Ns=(a,b,c)=>{let f=0;a&&b&&(f=Kd.a.koe(Kd.a.ai(a),Kd.a.ai(b),c));return f};var Rr=d(364);class Yy{constructor(a,
b,c){this.lvb=this.v3b=this.kvb=this.u8a=this.GOc=this.u3b=this.TG=this.t3b=this.LRa=this.lQ=this.HOc=this.KRa=this.Tca=this.wv=this.gL=this.dT=this.JRa=this.t8a=this.s8a=this.sDa=null;this.jS=a;this.gSb=b;this.Xi=c}s7k(a){this.jS=a;this.gSb=null;this.q4d(this.jS);this.pGh();this.Joh()}K_a(){this.jS&&this.gSb&&this.gSb.clientHeight&&(this.q4d(this.jS),this.pGh(),this.Joh(),-1!==this.gSb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.YWf(this.gSb),this.GCl(),this.w7k()))}q4d(a){if(a)for(let c=
0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=za.a.cka(f),w=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.sDa=f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.s8a=f;else if(f.id===xm.CuiHelper.nTd)this.t8a=f;else if(f.id===xm.CuiHelper.mYf)this.JRa=f;else if(f.id===xm.CuiHelper.oTd)this.dT=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.gL=f;else if(f.id===xm.CuiHelper.pTd)this.wv=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.Tca=f;else{var b;if(b=w)b=f,b=!!b.id&&
(b.id.startsWith(xm.CuiHelper.MXe)||b.id.startsWith(xm.CuiHelper.wmd));b?this.KRa=f:w&&f.id.startsWith(xm.CuiHelper.apl)?this.HOc=f:-1!==l.indexOf("UsernameNameContainer")?this.lQ=f:-1!==l.indexOf("UsernameNameItem")&&(this.LRa=f)}this.q4d(f)}}pGh(){var a=[this.gL,this.wv,this.lQ],b=[this.s8a,this.t8a,this.JRa,this.dT,this.gL,this.wv,this.Tca,this.KRa,this.HOc,this.lQ];for(const c of b)Xy(c);for(const c of a)Qr(c);if(a=this.gL)a.style.position="static",a.style.left="auto"}Joh(){this.CXd()?this.u7k():
this.v7k();var a=this.JRa,b=this.dT;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}u7k(){let a;const b=this.K7d();a=[()=>{Ms(this.dT,this.dT,Ns(this.sDa,b,this.Xi))},()=>{il(this.s8a);il(this.t8a);il(this.JRa);il(this.dT)}];Wt(a,()=>xq(this.dT,b,this.Xi));xq(this.TG,this.gL,this.Xi)&&$P(this.gL,this.TG,this.Xi);this.jmh();a=[()=>{Ms(this.lQ,this.LRa,Ns(this.TG,this.Tca,this.Xi))},()=>{il(this.KRa)}];this.kmh();Zq(this.gL)||Zq(this.wv)||zG(this.wv,this.TG,this.Tca,this.Xi)}v7k(){const a=
!!this.dT,b=!!this.wv;let c=0;if((a||b)&&0<(c=Ns(this.sDa,this.gL,this.Xi))){let f=a;b&&(!a||this.wv.offsetWidth>this.dT.offsetWidth)&&(f=!1);Ms(f?this.dT:this.wv,f?this.dT:this.wv,f?c:2*c);a&&b&&0<(c=Ns(this.sDa,this.gL,this.Xi))&&(f=!f,Ms(f?this.dT:this.wv,f?this.dT:this.wv,f?c:2*c))}Wt([()=>{il(this.s8a);il(this.t8a);il(this.JRa);il(this.dT);Qr(this.wv)},()=>{Ms(this.wv,this.wv,2*Ns(this.sDa,this.gL,this.Xi))},()=>{il(this.wv)}],()=>xq(this.sDa,this.gL,this.Xi));this.jmh();this.kmh();Zq(this.gL)||
Zq(this.wv)||zG(this.wv,this.sDa,this.Tca,this.Xi)}jmh(){const a=Zq(this.wv);Wt([()=>{this.eTe()},()=>{il(this.KRa);Qr(this.wv);Qr(this.lQ);a||Xy(this.wv)},()=>{this.eTe()},()=>{il(this.HOc);Qr(this.wv);Qr(this.lQ);a||Xy(this.wv)},()=>{this.eTe()}],()=>xq(this.gL,this.Tca,this.Xi))}eTe(){const a=!!this.wv,b=!!this.lQ;let c=0;if((a||b)&&0<(c=Ns(this.gL,this.Tca,this.Xi))){const f=!!this.gL&&"absolute"!==this.gL.style.position;let l=a;b&&(!a||this.lQ.offsetWidth>this.wv.offsetWidth)&&(l=!1);Ms(l?this.wv:
this.lQ,l?this.wv:this.LRa,l&&f?2*c:c);a&&b?(0<(c=Ns(this.gL,this.Tca,this.Xi))&&(l=!l,Ms(l?this.wv:this.lQ,l?this.wv:this.LRa,l&&f?2*c:c)),xq(this.gL,this.Tca,this.Xi)&&(il(this.gL),Qr(this.lQ))):a&&xq(this.gL,this.Tca,this.Xi)&&il(this.wv)}}kmh(){const a=()=>{Ms(this.lQ,this.LRa,Ns(this.sDa,this.Tca,this.Xi))};Wt([a,()=>{il(this.KRa);Qr(this.lQ)},a,()=>{il(this.HOc);Qr(this.lQ)},a,()=>{il(this.lQ)}],()=>xq(this.sDa,this.Tca,this.Xi))}CXd(){if(!this.TG)return!1;for(let a=0;a<this.TG.childNodes.length;a++)if(-1!==
za.a.cka(this.TG.childNodes[a]).indexOf("cui-cg"))return!0;return!1}K7d(){if(!this.TG)return null;let a=null;for(let b=this.TG.childNodes.length-1;0<=b;b--){const c=this.TG.childNodes[b];if(-1===za.a.cka(c).indexOf("cui-cg"))break;a=c}return a}YWf(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b],f=za.a.cka(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.t3b=c:-1!==f.indexOf("cui-tts")?this.TG=c:-1!==f.indexOf("cui-TabRowInline")?this.u3b=c:-1!==f.indexOf("cui-separator")?
this.GOc=c:l&&c.id.startsWith(xm.CuiHelper.A8g)?this.u8a=c:l&&c.id.startsWith(xm.CuiHelper.TVf)?this.kvb=c:-1!==f.indexOf("cui-TabRowRight")?this.v3b=c:l&&c.id.startsWith(xm.CuiHelper.SKe)&&(this.lvb=c);this.YWf(c)}}GCl(){var a=[this.TG,this.u3b,this.GOc,this.u8a,this.kvb,this.v3b,this.lvb];for(const b of a)Xy(b);this.uMb(0)}w7k(){let a;a=[()=>{il(this.GOc);il(this.u8a)},()=>{this.uMb(1)},()=>{this.uMb(2)},()=>{il(this.u3b);this.uMb(0)}];Wt(a,()=>xq(this.TG,this.u3b,this.Xi));a=[()=>{il(this.GOc);
il(this.u8a)},()=>{il(this.kvb)},()=>{il(this.lvb)},()=>{il(this.v3b)}];Wt(a,()=>xq(this.u3b,this.v3b,this.Xi)||xq(this.TG,this.v3b,this.Xi));a=[()=>{this.uMb(1)},()=>{this.uMb(2)},()=>{il(this.TG)}];Wt(a,()=>xq(this.t3b,this.TG,this.Xi))}uMb(a){this.TG&&(this.TG.className=Yy.kul[a],this.TG._scaleStep=a)}}Yy.kul=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(n.a)(Yy,"TopBarScalingManager",null,[]);class AG{constructor(a,b){this.jS=this.wAa=null;this._clientId=a;this.jnf=b}ZTi(){if(!Hk.b(this.jS))return this.jS;
this.cTi();this.jS.style.display="block";this.jnf&&this.jnf.mca(Object(F.a)(this,this.onResize,"onResize"));return this.jS}onResize(){this.K_a()}K_a(){this.ySi()?(document.getElementById("application").style.minWidth="0px",(new Yy(this.jS,null,u.AFrameworkApplication.isRtl)).s7k(this.jS)):u.AFrameworkApplication.Aa.hb.dO||yG.a.t7k(this.jS,u.AFrameworkApplication.isRtl)}ySi(){return u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}cTi(){if(Hk.b(this.wAa)){var a;
({i8b:a}=Rr.a.XOb(!u.AFrameworkApplication.CQ)).returnValue&&(this.wAa=FA("div"),this.wAa.className=Rr.a.HVi,this.wAa.id=xm.CuiHelper.Z2d,a.appendChild(this.wAa),this.USi(),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.ZUa&&!u.AFrameworkApplication.CQ&&this.XSi(),this.YTi())}}YTi(){Hk.b(this.jS)&&(this.jS=FA("div"),this.jS.className=Rr.a.hyl,this.jS.style.display="none",this.wAa.appendChild(this.jS))}USi(){Sys.UI.DomElement.addCssClass(this.wAa,Rr.a.IVi);if(u.AFrameworkApplication.isRtl){var a=
this.wAa;if(!Hk.b(a)){var b=a.className;if(Hk.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}XSi(){Sys.UI.DomElement.addCssClass(this.wAa,"FlexBoxLayout")}}Object(n.a)(AG,"HeaderSkeleton",null,[]);var aQ=d(1255),sB=d(1206);class tB{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(n.a)(tB,"CommandDefinition",null,[]);class BG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=
null}}Object(n.a)(BG,"CommandDefinitionMapping",null,[]);const bQ=a=>Object.assign(new BG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new tB,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):Object.assign(new tB,{externalUxCommand:b})},getDoNothingCommand:()=>parseInt(G.a.ve),addCommandToMaps:Object(F.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(F.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(F.a)(a,
a.addTabToMap,"addTabToMap")});var CG=d(941);class DG{}Object(n.a)(DG,"RibbonInitState",null,[]);var cQ=d(398),EG=d(514);let Os;class zp{static Yzl(a){u.AFrameworkApplication.Aa.hb.Yhg||(a.ShowCommentsTopBar=!0);u.AFrameworkApplication.Aa.hb.Mhg||(a.CatchUpWithChanges=!0)}static mEh(a){for(let b of zp.HTh)a[b]=!0}static dIl(a,b){var c=u.AFrameworkApplication.w8b;if(u.AFrameworkApplication.fa.Eu(c)&&u.AFrameworkApplication.fa.Ga(c)){zp.mEh(b);c=u.AFrameworkApplication.fa.YA("HostDefinedUIControls");
for(let f=0;f<c.length;f++)zp.eIl(a,b,c[f]);zp.Tzl(b);zp.Szl(b)}}static eIl(a,b,c){if(c.id in a){a=a[c.id];for(let f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static Tzl(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static Hua(){const a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.gK);return!!a&&"teams"===a.toLowerCase()}static Ekl(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",
!1)}static ill(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)}static Szl(a){zp.Hua()&&(zp.Ekl()&&(a.HostOpenInClient=!1),zp.ill()&&(a.HostMoreOptions=!0))}}zp.HTh=(Os=new Ka.a,Os.add("HostOpenInClient"),Os.add("HostConversation"),Os.add("HostClose"),Os.add("HostDownload"),Os.add("HostOpenInBrowser"),Os.add("HostMoreOptions"),
Os);Object(n.a)(zp,"CommandTrimmer",null,[]);class FG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,c);return b}}Object(n.a)(FG,"ReactAsyncDispatcher",null,[]);class uB{}uB.wlc="PageId";Object(n.a)(uB,"FileMenuSQMProperties",null,[]);class GG{constructor(a,b){this.vq=null;this.pDc=!1;this.pOa=0;this.shf="";this.Qyd={};this.PGd=a;this.Od=b;this.Kkf=Object(F.a)(this,this.LIe,"onModalMouseWheel");this.Cgf=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.s9;this.B2=!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.yua}sHb(){0<this.pOa?this.pOa++:(this.pOa++,u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(F.a)(this,this.Tdh,"pushTransientFocusScope"),0)}):this.Tdh(),this.showModal())}Tdh(){this.Od&&this.Od.LU(E.AFrame.ZO,!0)}I5i(){const a=Sg.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.Cgf&&b.isActive&&1===b.state?"_ShyRibbon":
"")}$nj(a){var b=0;if(this.B2){if(this.Qyd[a])return this.Qyd[a];(b=document.getElementById("BusinessBar"))||ka.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");b=b?b.offsetTop:0;this.Qyd[a]=b}return b}showModal(){if(!this.vq)if(this.vq=this.createElement("div"),this.vq.setAttribute("id","ReactModalDiv"),this.vq.style.position="absolute",this.vq.style.bottom="0px",this.vq.style.left="0px",this.vq.style.right="0px",this.vq.style.backgroundColor=
"white",this.vq.style.opacity="0.0",this.B2){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.vq)}else this.PGd.appendChild(this.vq);a=this.I5i();if(a!==this.shf){const b=this.$nj(a),c=appChrome.selectors.getShyState();this.Cgf&&c.isActive&&1===c.state&&Sg.a("getRibbonHeight")?this.vq.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(Sg.f())):this.vq.style.top=String.format("{0}px",b);this.shf=a}this.vq.style.display="block";this.vq.style.visibility="visible";
this.vq.style.zIndex="1000";this.pDc||(window.addEventListener("wheel",this.Kkf,!0),this.u_c()?ye.a.instance.pb(sa.a.FR,this.vq,Object(F.a)(this,this.$fd,"onModalPointerUp")):ye.a.instance.pb(sa.a.pointerDown,this.vq,Object(F.a)(this,this.Zfd,"onModalPointerDown")),this.pDc=!0)}vwk(){this.pOa--;0<this.pOa||(0>this.pOa?this.pOa=0:this.Wcg())}EHe(){this.pOa=0;this.s0d();this.Wcg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}Vcg(){this.Od&&this.Od.Ae&&this.Od.Ae.name===
E.AFrame.ZO&&!u.AFrameworkApplication.ye.ww&&this.Od.a1(E.AFrame.ZO,!1);this.vq&&(this.vq.style.zIndex="-1",this.vq.style.visibility="hidden",this.vq.style.display="none");this.pDc&&(window.removeEventListener("wheel",this.Kkf,!0),this.u_c()?ye.a.instance.yb(sa.a.FR,this.vq,Object(F.a)(this,this.$fd,"onModalPointerUp")):ye.a.instance.yb(sa.a.pointerDown,this.vq,Object(F.a)(this,this.Zfd,"onModalPointerDown")),this.pDc=!1)}Wcg(){this.u_c()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Vcg()},
0)}):this.Vcg()}Zfd(){this.H2b();this.SPf();this.EHe();this.XKa();return!0}$fd(){this.H2b();this.SPf();this.EHe();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.XKa()},0)});return!0}XKa(){4===u.AFrameworkApplication.Aa.hb.Uk&&u.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?u.AFrameworkApplication.Aa.XKa():this.Od.rf(E.AFrame.EW)}LIe(a){a.stopPropagation()}H2b(){const a=Ab.a.instance.rb("Common.IReactContextualUILauncher");a&&a.H2b()}s0d(){const a=Ab.a.instance.rb("Common.IReactContextualUILauncher");
a&&a.s0d()}SPf(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.GFa&&(this.u_c()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}u_c(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(n.a)(GG,"ReactModalDiv",null,[]);var Vm=d(535);class HG{constructor(a,b){this.F1h=a;this.TPh=b}}Object(n.a)(HG,"ReactExecuteCommandContext",null,[]);class tv{}
tv.Color="Color";tv.IndexColorSelected="ColorSelected";Object(n.a)(tv,"ColorPickerCommandProperties",null,[]);var Zn=d(935);class $n{}$n.SelectedFont="SelectedFont";$n.Formatting="Format";$n.RequestUpdateMru="RequestUpdateMru";$n.FontPickerId="fontPickerId";$n.IsPinned="IsPinned";$n.Trigger="Trigger";Object(n.a)($n,"FontPickerCommandProperties",null,[]);class Yo{}Yo.Trigger="FontTrigger";Yo.Name="FontName";Yo.Action="FontAction";Yo.Level="FontLevel";Yo.IsPinned="FontIsPinned";Object(n.a)(Yo,"FontPickerLogProperties",
null,[]);class ex{}ex.Rows="Rows";ex.Columns="Columns";Object(n.a)(ex,"InsertTableCommandProperties",null,[]);class Wm{}Wm.Alt="Alt";Wm.Number="Number";Wm.UnitType="UnitType";Wm.Text="Text";Wm.MaxValue="MaxValue";Object(n.a)(Wm,"SpinnerCommandProperties",null,[]);class IG{constructor(a,b,c,f,l,w,H,U,ja,wa=null,Sa=null){this.f4a=null;this.Wof=!1;this.hBd=[];this.Jxc=-1;this.XEc=!1;this.o2h=0;this.lRb=null;this.gmf=!1;this.JP=a;this.ROa=b;this.nKd=Object(qa.a)(1532,a);this.Vm=c;this.Od=f;l&&(this.f4a=
new GG(l,f));this.b0h=w;this.sSh=H;this.zS=wa;this.Ca=U;this.T3a={};this.$a=ja;this.Q7e=Sa;ja&&(ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ja.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&gj.a.instance.Wwf.CWR(()=>this.Wof=!0);ja&&(a=this.$a.Ga("CommandControlIdPairsForLoggingOverride")||"")&&0<=a.trim().length&&({sv:this.lRb}=Jc.d(a));this.lRb||(this.lRb={})}get wod(){return!!window.appChrome&&!!appChrome.selectors}Qoh(){-1!==this.Jxc&&window.clearTimeout(this.Jxc);
this.Jxc=window.setTimeout(()=>{for(this.Jxc=-1;0<this.hBd.length;){if(fm.a.instance.ww){this.Qoh();break}const a=this.hBd.shift();a&&this.executeCommand(a.F1h,a.TPh)}},0)}executeCommand(a,b){if(fm.a.instance.ww){if(this.Wof){this.hBd.push(new HG(a,b));this.Qoh();return}ka.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",a,b.modelType,
pa.a.toJSON(b.payload));if(this.$a.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.Vm.getCommandByExternalUxId(a),f=b.modelType;this.Q7e&&this.Q7e.e3j(a,b);c?this.NUi(a,c,f,b):this.OUi(a,f,b);this.tsi(b);this.dlk(a,b)}}OUi(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.gUf(c,a);break;case "ButtonModel":this.KUi(c,a)}}vGl(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=
b.menuItemId;a.CommandValueId=c.payload.commandValueId;a.TerminalParentControlId=c.payload.terminalParentControlId;this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(b=!0,Hk.b(c.payload.dismissHostingSurfaceOnExecute)||(b=c.payload.dismissHostingSurfaceOnExecute),b&&this.uCa()):this.uCa();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=
b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}wGl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.Vm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":a=this.Vm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=b.payload.executedControl;c.ControlId=b.payload.executedControl;
c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.uCa();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}NUi(a,b,c,f){var l=this.aHk(f,c),w=b.commandId;const H={},U={};switch(c){case "SplitButtonModel":if(this.E7b(f.payload,Object(F.a)(this,this.BHl,"updateSplitButtonMenuState"),l))return;H.MenuItemId=b.menuItemId;this.eXe(f,H);break;case "StatefulSplitButtonModel":if(this.E7b(f.payload,
Object(F.a)(this,this.FHl,"updateStatefulSplitButtonMenuState"),l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?H.Color=c:"icon"===l&&(c=this.Vm.getCommandByExternalUxId(c))&&(H.MenuItemId=c.menuItemId);break;case "FileMenu":H.MenuItemId=b.menuItemId;H.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.Atj(w,f.payload,a);break;case "TellMe":w=this.wGl(w,f,H);H.SourceControlId=a;H.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===
f.payload.type?this.Yxj(H,f):w=this.vGl(H,b,f,a,w);break;case "CompoundButtonModel":H.MenuItemId=b.menuItemId;H.CommandValueId=f.payload.commandValueId;H.SourceControlId=a;this.eXe(f,H);this.uCa();break;case "ToggleButtonModel":case "InkButtonModel":H.MenuItemId=b.menuItemId;H.SourceControlId=a;this.eXe(f,H);this.uCa();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":w=this.Vm.getCommandByExternalUxId("FontPickerMenuClose").commandId;H[$n.FontPickerId]=
f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=ea.FontUtils.dG(c),H.CommandValueId=l,l=ea.FontUtils.kMc(l)):(c.data?(H.CommandValueId=c.data.fontToApply,H.MenuItemId=c.data.themeIndex,H[$n.Formatting]=c.data):H.CommandValueId=c.name,l=c);H.SourceControlId=a;H[$n.RequestUpdateMru]=l;U[Yo.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?ea.FontUtils.fZc(c)?"*"+c:ea.FontUtils.ake(c)?"[EF]":"[MF]":"";U[Yo.IsPinned]=f.payload.isPinned;
U[Yo.Level]=f.payload.level;this.Woe();break;case "FontPickerFontInfoRequestedPayload":H.CommandValueId=f.payload.font.name;H[$n.Trigger]=f.payload.trigger;U[Yo.Trigger]=f.payload.trigger;U[Yo.Name]=f.payload.nameToLog;this.Woe();break;case "FontPickerFontPinningPayload":c=f.payload.isPinned;H.CommandValueId=f.payload.fontKey;H[$n.IsPinned]=c;U[Yo.Name]=f.payload.nameToLog;U[Yo.Action]=c?"pin":"unpin";U[Yo.Level]=f.payload.level;this.Woe();break;default:return}break;case "ComboBoxModel":var ja=f.payload.type;
switch(ja){case "MenuOpenPayload":case "MenuPopulatePayload":this.SMb(f.payload.launcherId,l)&&(w={},w[f.payload.launcherId]=c,this.ROa.fmc(w,Sg.g(f.payload)),this.T3a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=f.payload.newValue;if(!c)return;c.value?(H[Zn.a.Value]=c.value,H[Zn.a.IsFreeForm]=!0):(H[Zn.a.Value]=c.text,H.MenuItemId=c.key,H.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===ja&&(w=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":w=
b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=pa.a.nL(f.payload);for(ja of c)H[ja]=f.payload[ja];break;default:this.E7b(f.payload,Object(F.a)(this,this.nFl,"updateFlyoutAnchorMenuState"),l),H.launcherId=f.payload.launcherId}break;case "InkFlyoutAnchorModel":this.E7b(f.payload,Object(F.a)(this,this.HFl,"updateInkFlyoutAnchorMenuState"),l);H.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":H[tv.Color]=
f.payload.selectedColorId;H.colorRGB=f.payload.color;break;case "ColorPickerPreviewPayload":w=b.commandPreviewId;H[tv.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":w=b.commandRevertId;break;default:return}break;case "SpinButtonModel":H[Wm.Number]=f.payload.value;H[Wm.UnitType]=te.a.h1b(f.payload.unitType.toLowerCase());H[Wm.Text]=f.payload.reservedValue;break;case "SliderModel":H[Xo.Value]=f.payload.value;break;case "InsertTableModel":H[ex.Rows]=f.payload.rows;H[ex.Columns]=
f.payload.columns;break;case "CheckboxModel":H[Vh.a.On]=f.payload.checked;H.MenuItemId=b.menuItemId;H.TerminalParentControlId=f.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.E7b(f.payload,Object(F.a)(this,this.GGl,"updatePreviewGalleryMenuState"),l)){H.launcherId=f.payload.launcherId;break}this.gUf(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":H.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":w=
{};w[f.payload.launcherId]=c;this.ROa.fmc(w,Sg.g(f.payload));this.T3a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":H.MenuItemId=f.payload.url;this.L3j(f.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":H.MenuItemId=f.payload.assetId;H.SourceControlId=a;u.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&(H.IsPremium=f.payload.isPremium||!1);this.M3j(f.payload.pageId);break;case "CoauthorGallery":H.RenderTime=
f.triggerTime;break;case "PeopleWell":H.RenderTime=f.triggerTime;break;case "SyncStatus":H.SourceControlId=a;break;case "InputBoxModel":H.Text=f.payload.newValue;break;case "PersonaButtonModel":H.CommandValueId=f.payload.commandValueId;this.Cvj(f.payload);break;case "MultiActionButtonModel":H.CommandValueId=f.payload.commandValueId;H.Href=f.payload.href;H.Type=f.payload.type;this.uCa();break;default:return}w&&!this.isShadowMenuOpen(f.payload)&&(H.CommandValueId||(H.CommandValueId=H.MenuItemId),b.legacyControlId&&
(H.LegacyId=b.legacyControlId),H.SourceControlId||(H.SqmControlId=a),this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&H.launcherId&&(b=this.Vm.getCommandByExternalUxId(H.launcherId))&&(H.launcherCommandId=parseInt(b.commandId)),f.payload&&!Hk.b(f.payload.PRIReadinessCheck)&&(H.PRIReadinessCheck=f.payload.PRIReadinessCheck,this.gmf=!0),f.payload&&!Hk.b(f.payload.shouldTakeFocus)&&(H[Vm.a.Haa]=f.payload.shouldTakeFocus),b=this.kPd(f,H),Hk.b(f.triggerTime)||
(U.TriggerTime=f.triggerTime),f.payload&&!Hk.b(f.payload.userActionKey)&&(U.userActionKey=f.payload.userActionKey),this.MVe(U,f,a,w),this.nKd.executeCommand(w,H,this.getSelectedTabId(),b,!0,()=>{this.pFe(H,a)},U,Sg.g(f.payload)))}MVe(a,b,c,f){this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&(c=b.payload&&!Hk.b(b.payload.launcherId)?b.payload.launcherId:c,a.ControlId=this.ioh(this.jfj(c,f),f,!1));this.$a&&this.$a.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&
b.payload&&"terminalParentControlId"in b.payload&&(a.TerminalParentControlId=this.ioh(b.payload.terminalParentControlId,f,!0))}ioh(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;ka.ULS.sendTraceTag(510247689,207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}jfj(a,b){b=parseInt(b);b=ac.ActionManager.wWd(b)||ac.ActionManager.W5a(b)||"";
return!Hk.b(b)&&b in this.lRb?this.lRb[b]:100<a.length?"":a}Woe(){this.zS&&this.zS.execute(a=>{a.Noe("ModernFontPickerExperience")})}kPd(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=a.payload.inputMethod,b[Vm.a.Iu]=c);return c}pFe(a,b){const c=Object(qa.a)(E.AFrame,u.AFrameworkApplication.Aa);if(this.Od&&this.avh(a)){if(!this.Od.Ae&&c){let f="null";if(a){const l=a.Value;delete a.Value;f=pa.a.toJSON(a);Hk.b(l)||(a.Value=l)}ka.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
b,f,c.JKa)}this.Od.dYf()}(this.Od&&this.Od.Ae&&this.Od.Ae.name!==E.AFrame.ZO&&c&&this.Od.Ae.name!==c.JKa||this.avh(a))&&this.qwi(a)}avh(a){return!!a&&!Hk.b(a[Vm.a.Haa])&&a[Vm.a.Haa]}qwi(a){Vm.a.Iu in a&&1===a[Vm.a.Iu]&&cx.ShyRibbon.yQa(1,0)}Yxj(a,b){Sg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.uCa();this.JP.emc();if(this.b0h&&this.Ca){const c={};c[Uy.UAh]=b.payload.tabId;this.Ca.La(G.a.ymd,2,c,this.Y6b(b));Hk.b(b.payload.inputMethod)||
(this.Ca.processAction(G.a.jlh,2),this.XEc||this.nol(b.payload.tabId))}b=b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.Vm.mae(b);ka.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.zS&&b){const c=b+"TabSwitchActivity";this.zS.execute(f=>{f.Noe(c)})}}E7b(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===f?(b(a,c),!0):!1}Cvj(a){a=a.type;"MenuOpenPayload"===a?u.AFrameworkApplication.vAh=!0:"MenuClosePayload"===a&&(u.AFrameworkApplication.vAh=
!1)}aHk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.Vm.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.ROa.BLe(f,b,a.payload))&&c in this.T3a&&delete this.T3a[c],a):!1}nFl(a,b){const c=a.launcherId;this.SMb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),this.tPb(b,c,Sg.g(a)))}HFl(a,b){const c=a.launcherId;this.SMb(c,b)&&(b=Sg.j("getInkFlyoutAnchorMenuItems")?
appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),this.tPb(b,c,Sg.g(a)))}GGl(a,b){const c=a.launcherId;this.SMb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.tPb(b,c,Sg.g(a)))}BHl(a,b){const c=a.launcherId;this.SMb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.tPb(b,c,Sg.g(a)))}FHl(a,b){const c=a.launcherId;this.SMb(c,b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.tPb(b,c,Sg.g(a)))}getSelectedTabId(){return this.wod?
appChrome.selectors.getSelectedTabId():null}tPb(a,b,c){this.ROa.fmc(a,c);this.T3a[b]=new Date}SMb(a,b){let c=!0;a in this.T3a&&(c=this.T3a[a].getTime()<this.JP.P1c.getTime());return c&&!b&&this.wod}gUf(a,b){const c={};var f=a.payload.selectedGalleryId;const l=this.Vm.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&(c.LegacyId=l.legacyControlId);a.payload&&!Hk.b(a.payload.shouldTakeFocus)&&(c[Vm.a.Haa]=a.payload.shouldTakeFocus);this.igj(a.payload,
c);(f=this.Y6b(a))||(f={});this.MVe(f,a,b,l.commandId);const w=this.kPd(a,c);this.nKd.executeCommand(l.commandId,c,this.getSelectedTabId(),w,!0,()=>{this.pFe(c,b)},f,Sg.g(a.payload))}}KUi(a,b){const c=this.Vm.getCommandByExternalUxId(b);if(c){const f={};f.SourceControlId=b;f.MenuItemId=b;f.SqmControlId=b;a.payload&&!Hk.b(a.payload.shouldTakeFocus)&&(f[Vm.a.Haa]=a.payload.shouldTakeFocus);let l=this.Y6b(a);l||(l={});this.MVe(l,a,b,c.commandId);const w=this.kPd(a,f);this.nKd.executeCommand(c.commandId,
f,this.getSelectedTabId(),w,!1,()=>{this.pFe(f,b)},l,Sg.g(a.payload))}}igj(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=a.character)}eXe(a,b){a.payload&&"toggled"in a.payload&&(b[Vh.a.On]=a.payload.toggled)}dlk(a,b){"MenuOpen"===a?!this.f4a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.f4a.sHb():"MenuClose"===a&&this.f4a&&this.f4a.vwk()}uCa(){this.f4a&&this.f4a.EHe()}Y6b(a){let b=null;Hk.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}Atj(a,b,c){if(this.sSh&&
this.Ca){const f={};f[uB.wlc]=c;this.Ca.La(G.a.f2k,2,f)}this.tPb(b.pageControlIdMap,a,Sg.g(b))}M3j(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.u2k,2);break;case "FileNewPage":this.Ca.processAction(G.a.v2k,2)}}L3j(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.n2k,2);break;case "FileOpenPage":this.Ca.processAction(G.a.o2k,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}nol(a){if(u.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&
"Help"===a)this.zS.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.XEc=!0;else{if(u.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.zS.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.o2h)){this.XEc=!0;return}u.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.processAction(G.a.Jkb,2)&&(this.XEc=!0)}}tsi(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.gmf&&appChrome.PRIToastManager.dismissToast()}}
Object(n.a)(IG,"ReactExecuteCommandHandler",null,[]);class JG{constructor(){this.fileMenu=null}get a6e(){return 0}K_a(){}Bsa(){return!1}T1(){return!1}get uph(){return null}e6(){}Gje(){return!1}gQa(){}RRa(){}refresh(){}get controls(){return null}VKc(){}emc(){}get xaa(){return null}set xaa(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(n.a)(JG,"ReactRibbonExternal",null,[360,1515,1516]);var dQ=d(271);class KG{constructor(a,b,c,f){this.Od=a;this.Ca=b;this.Hrf=c;this.aqb=
f}initialize(){this.Ca.ya(G.a.zpc,Xd.a.frame,Object(F.a)(this,this.Mmh,"ribbonMoveForwardAction"));this.Ca.ya(G.a.ypc,Xd.a.frame,Object(F.a)(this,this.Lmh,"ribbonMoveBackwardAction"));this.Ca.ya(G.a.dnd,Xd.a.frame,Object(F.a)(this,this.Kmh,"ribbonEscAction"));var a=Rr.a.Oee(this.aqb,null,this.Hrf,!1);a.dJ=!0;this.ZJb(a,G.a.zpc,G.a.ypc);a.bindAction(x.KeyInputManager.Oa(A.a.X1,0),G.a.dnd);a=this.Od.Fc(E.AFrame.ZO);a.dJ=!0;this.ZJb(a,G.a.Esa,G.a.Esa);ra.a.instance.pb(sa.a.mouseDown,this.Hrf,Object(F.a)(this,
this.vyk,"onRibbonMouseDown"));a=dQ.a.instance;Sg.a("enterKeytipMode")&&a.eMb(this.aqb,()=>{appChrome.api.enterKeytipMode(!1)});Sg.a("exitKeytipMode")&&a.yqc(this.aqb,()=>{appChrome.api.exitKeytipMode();cx.ShyRibbon.yQa(1,0)});u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.s9&&(a=Object(qa.a)(y.FocusManager,this.Od))&&a.pai(Object(F.a)(this,this.Nuk,"onFocusScopeChanged"))}Nuk(a,b){if((a=Object(qa.a)(E.AFrame,u.AFrameworkApplication.Aa))&&b.F0g&&u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.s9){const c=
appChrome.selectors.getShyState();c.isActive&&b.F0g.name===a.JKa&&cx.ShyRibbon.yQa(c.state,1)}}Mmh(){return 4}Lmh(){return 4}Kmh(){Sg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.s9&&appChrome.selectors.getShyState().isActive&&cx.ShyRibbon.yQa(1,0),this.Od.rf(E.AFrame.EW));return 4}ZJb(a,b,c){const f=x.KeyInputManager.Oa(A.a.Sq,0),l=x.KeyInputManager.Oa(A.a.Sq,4);a.Dp(f);a.Dp(l);a.bindAction(f,b);a.bindAction(l,c)}vyk(a){a.qc&&a.qc.target&&
"input"!==a.qc.target.tagName.toLowerCase()&&a.qc.preventDefault();return!1}dispose(){this.Ca.RJ(G.a.zpc,Xd.a.frame,Object(F.a)(this,this.Mmh,"ribbonMoveForwardAction"));this.Ca.RJ(G.a.ypc,Xd.a.frame,Object(F.a)(this,this.Lmh,"ribbonMoveBackwardAction"));this.Ca.RJ(G.a.dnd,Xd.a.frame,Object(F.a)(this,this.Kmh,"ribbonEscAction"))}}Object(n.a)(KG,"ReactRibbonFocusManager",null,[106]);class vB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(n.a)(vB,"CommandSqmInfo",
null,[]);var fx=d(356),gx;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})(gx||(gx={}));Object(n.b)("GalleryType",gx);class Do{constructor(){this.title=
this.style=this.hidden=this.disabled=null}}Object(n.a)(Do,"CommonGalleryButtonProps",null,[]);class Zy extends Do{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(n.a)(Zy,"AdditionalTableStyleGalleryButtonProps",Do,[]);class LG extends Zy{constructor(){super()}}Object(n.a)(LG,"AdditionalChangeColorsGalleryButtonProps",Zy,[]);class MG extends Do{constructor(){super();this.character=null}}Object(n.a)(MG,"AdditionalCharacterCodeGalleryButtonProps",Do,[]);class NG extends Do{constructor(){super();
this.previewStyleLabel=this.styleDisplayName=null}}Object(n.a)(NG,"AdditionalFontStyleGalleryButtonProps",Do,[]);class OG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(n.a)(OG,"AdditionalGalleryProperties",null,[]);class PG extends Do{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}
Object(n.a)(PG,"AdditionalIconButtonProperties",Do,[]);class QG extends Do{constructor(){super();this.styleDisplayName=null}}Object(n.a)(QG,"AdditionalInkThicknessGalleryButtonProps",Do,[]);class RG extends Do{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(n.a)(RG,"AdditionalListGallerButtonProps",Do,[]);class SG extends Do{constructor(){super();this.text=null}}Object(n.a)(SG,"AdditionalPageNumberGalleryButtonProps",Do,[]);var $y=d(673),gm=d(936),TG=d(1125);class wB{}wB.Text="Text";
Object(n.a)(wB,"TextBoxCommandProperties",null,[]);var hm=d(304);const eQ=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(qa.a)(Object,c[a])){if((a=Object(qa.a)(String,c.value))&&a===b)return!1;a=Object(qa.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:null;let f=null;for(let l=0;l<c.length;l++){const w=Object(qa.a)(Object,c[l]);if(Object(qa.a)(String,w.key)===a){f=w;break}}if(f&&Object(qa.a)(String,f.text)===b)return!1}}return!0},VG=
(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(az(a,c[Vh.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,c[Vh.a.On]));break;case "ComboBoxModel":if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!eQ(a,c[Zn.a.Value]))break;(b=c[Zn.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,
b,c[Zn.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[Zn.a.Value]));break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,c[$n.SelectedFont]));break;case "SplitButtonModel":f.push(az(a,c[TG.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,c[Wm.Number],te.a.i1b(c[Wm.UnitType]),c[Wm.Text],c[Wm.MaxValue],c[Wm.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[tv.IndexColorSelected]));
break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[gm.a.Text]));break;case "CompoundButtonModel":c[Vh.a.Description]&&f.push(appChrome.actions.updateCompoundButtonDescription(a,c[Vh.a.Description]));Vh.a.On in c&&f.push(az(a,c[Vh.a.On]));break;case "SliderModel":c.snapToStep?f.push(appChrome.actions.updateSliderSelectedValue(a,c[Xo.Value])):f.push(appChrome.actions.updateSliderValue(a,c[Xo.Value],c[Xo.MinValue]||0,c[Xo.MaxValue],c[Xo.Text]));break;
case "FlyoutAnchorModel":$y.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[$y.a.ImageIsVisible]));Vh.a.On in c&&f.push(az(a,c[Vh.a.On]));break;case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[wB.Text]))}b=f;var l=Object(qa.a)(String,c[hm.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,l));UG(a,c,f);b=f;(l=Object(qa.a)(Object,c[hm.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(qa.a)(String,c[hm.a.customTooltip]);
void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));a=f;(c=Array.isArray(c[hm.a.Ygh])?c[hm.a.Ygh]:null)&&a.push.apply(a,c);return f}return null},Xt=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),az=(a,b)=>appChrome.actions.toggleButton(a,b),UG=(a,b,c)=>{b=Object(qa.a)(String,b[hm.a.Icon]);void 0!==b&&null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class WG{constructor(a,b,c,f){this.Vm=f;this.Nqa=a;this.HK=b;this.bqb=c;this.kUb={}}kHk(a,b,c,f,l=null){const w=
a.ExternalGalleryId||a.ExternalId;var H=a.ExternalId;f.push(w);if(appChrome.selectors.isControlDefined(w))a.GalleryStyle&&Sg.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(w,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(w,Object.assign(new OG,{columns:a.Width,sections:[appChrome.api.gallerySection([],H)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Sg.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){H=[];const ja=[],wa=[],Sa={};for(var U of a.GallerySections){H.push(appChrome.api.gallerySection([],U.SectionId,U.Title));0===c&&U.GalleryButtons&&0<U.GalleryButtons.length&&(c=U.GalleryButtons[0].Type);f&&this.U5f(U.GalleryButtons,l,Sa);const eb=this.fPd(ja,U.GalleryButtons,Sa);ja.push.apply(ja,this.T9d(eb,
w,U.SectionId,!1,c,l,!0,Sa));wa.push.apply(wa,eb)}b.push(appChrome.actions.setGallerySections(w,H));b.push.apply(b,ja);b.push.apply(b,this.Z7d(w,gx[c],wa,null,5===a.Type,!0,null,Sa))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),U=f?this.U5f(a.GalleryItems,l,null):null,b.push.apply(b,this.T9d(this.fPd(b,a.GalleryItems,U),w,H,!1,c,l,!1,U))}fhj(a,b){const c=[];let f=null,l=!1;if(!a)return null;const w=this.Nqa.dmc(this.HK,a.commandId,b);c.push(Xt(a.externalUxCommand,!w));
if(a.previewControlIds){const ja=[];for(let wa=0;wa<a.previewControlIds.length;wa++){var H={},U=a.previewControlIds[wa];H.SourceControlId=U;const Sa=this.Vm.getCommandByExternalUxId(U);this.mUc(Sa||a,H);H[gm.a.On]&&(f=H.SourceControlId,H[gm.a.HighlightOn]&&(l=!0));UG(U,H,c);if(H=Object(qa.a)(fx.a,H[gm.a.GalleryButtonProps]))ja.push(H),w&&(U=this.Nqa.dmc(this.HK,H.Command,b),H.IsDisabled=!U)}0<ja.length&&c.push.apply(c,this.T9d(this.fPd(c,ja),a.externalUxCommand,a.externalUxCommand,!0,ja[0].Type));
c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(ka.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}fPd(a,b,c=null){const f=[],l=[];for(let H=0;H<b.length;H++){const U=b[H],ja=Hk.a(U.ExternalId)?U.Id:U.ExternalId;f.push(ja);const wa=c&&c[ja]?c[ja].result:-1;switch(U.Type){case 1:var w=U;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(ja,Object.assign(new MG,
{disabled:-1!==wa?1>(wa&1):w.IsDisabled,character:w.Character,style:w.Style,title:w.Alt})));break;case 2:w=U;l.push(appChrome.api.createFontStylesGalleryButtonModel(ja,Object.assign(new NG,{disabled:-1!==wa?1>(wa&1):w.IsDisabled,styleDisplayName:w.LabelText,style:w.Style,title:w.Alt,previewStyleLabel:w.PreviewStyleLabel})));break;case 3:w=U;l.push(appChrome.api.createInkThicknessGalleryButtonModel(ja,Object.assign(new QG,{disabled:-1!==wa?1>(wa&1):w.IsDisabled,styleDisplayName:w.LabelText,style:w.Style,
title:w.Alt})));break;case 4:w=U;l.push(appChrome.api.createIconGalleryButtonModel(ja,Object.assign(new PG,{disabled:-1!==wa?1>(wa&1):w.IsDisabled,icon:[w.Icon],fullIconStyle:w.FullIconStyle,previewIconStyle:w.PreviewIconStyle,largePreviewIconStyle:w.LargePreviewIconStyle,label:w.LabelText,title:w.Alt})));break;case 5:w=U;l.push(appChrome.api.createListGalleryButtonModel(ja,Object.assign(new RG,{disabled:-1!==wa?1>(wa&1):w.IsDisabled,infoAtLevel:w.LevelInfo,ariaLabel:w.Alt})));break;case 6:w=U;l.push(appChrome.api.createTableStyleGalleryButtonModel(ja,
Object.assign(new Zy,{disabled:-1!==wa?1>(wa&1):w.IsDisabled,tableCellStyles:w.TableCellStyles,tableStyles:w.TableStyles,title:w.Alt,columns:w.columns})));break;case 8:w=U;l.push(appChrome.api.createChangeColorsGalleryButtonModel(ja,Object.assign(new LG,{disabled:-1!==wa?1>(wa&1):w.IsDisabled,tableCellStyles:w.TableCellStyles,tableStyles:w.TableStyles,title:w.Alt})));break;case 7:w=U,l.push(appChrome.api.createPageNumberGalleryButtonModel(ja,Object.assign(new SG,{disabled:-1!==wa?1>(wa&1):w.IsDisabled,
text:w.Text,title:w.Alt})))}this.Vm.addCommandToMaps(Object.assign(new Ra.a(ja,U.Command),{queryCommandId:U.QueryCommand,menuItemId:U.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}T9d(a,b,c,f,l,w=null,H=!1,U=null){const ja=[];f?ja.push(appChrome.actions.populateGalleryItems(b,a)):(this.kUb[b]=!1,H||(f=!0,appChrome.selectors.isControlDefined(b)&&(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),ja.push.apply(ja,this.Z7d(b,gx[l],
a,null,5===l,f,w,U))),ja.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return ja}Eaj(a){return this.Z7d(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}Z7d(a,b,c,f,l,w=!0,H=null,U=null){const ja=[];if(a in this.kUb){if(this.kUb[a])return delete this.kUb[a],ja;this.kUb[a]=!0}let wa=null,Sa=-1;if(c)({wZf:Sa,returnValue:wa}=this.ntf(b,c,ja,w,H,U));else if(f)for(const eb of f)(c=({wZf:Sa}=this.ntf(b,eb.galleryButtons,
ja,w,null,U)).returnValue)&&(wa=c);ja.push(appChrome.actions.updateGallerySelectedId(a,wa));w&&ja.push(Xt(a,!1));l&&0<Sa&&ja.push(appChrome.actions.updateListGalleryTextDirection(a,2===Sa));return ja}T5f(a,b=null){const c={},f={};f.SourceControlId=a;f.Location=b;a=this.Vm.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.mUc(a,f);c.result=a;c.props=f;return c}U5f(a,b=null,c=null){c||(c={});for(const f of a)a=Hk.a(f.ExternalId)?f.Id:f.ExternalId,c[a]=this.T5f(a,b);return c}ntf(a,
b,c,f,l=null,w=null){let H,U=null;H=-1;let ja=!1;for(const Sa of b){var wa=this.Caj(a);b=w&&w[Sa]&&-1!==w[Sa].result?w[Sa]:this.T5f(Sa,l);const eb=b.result;b=b.props;f&&c.push(Xt(Sa,1>(eb&1)));(wa=VG(Sa,wa,b,eb))&&c.push.apply(c,wa);b[gm.a.On]&&(U=Sa,b[gm.a.HighlightOn]&&b[gm.a.HighlightOn]&&(ja=!0));void 0!==b[hm.a.labelText]&&null!==b[hm.a.labelText]&&(wa=this.Vm.getCommandByExternalUxId(Sa),c.push(appChrome.actions.setControlLabel(wa.externalUxCommand,b[hm.a.labelText])));b[gm.a.IsRtl]&&0>H&&(H=
b[gm.a.IsRtl])}ja&&(ka.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",U),c.push(appChrome.actions.highlightSelectedFontStyle(U)));return{returnValue:U,wZf:H}}Caj(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";
case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}mUc(a,b){b.MenuItemId=a.menuItemId;return this.Nqa.Jid(this.HK,this.bqb,a.commandId,a.queryCommandId,b)}}Object(n.a)(WG,"ReactGalleryPoller",null,[]);var fQ=d(587),bz=d(797),gQ=d(799);class xB extends kg.a{constructor(){super()}get ControlType(){return 3}}Object(n.a)(xB,"CompoundButtonProps",kg.a,
[]);var hQ=d(937),yq=d(586),iQ=d(588),jQ=d(938);class XG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(n.a)(XG,"PopulateFontPickerDataProps",null,[]);var Sr=d(409);class YG extends Co{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(n.a)(YG,"OptionalCompoundButtonProperties",Co,[]);class ZG extends Co{constructor(){super();this.onRetryCommandId=
this.retryButtonTitle=null}}Object(n.a)(ZG,"OptionalErrorViewProperties",Co,[]);class $G extends Co{constructor(){super();this.isBanner=null}}Object(n.a)($G,"OptionalLabelProperties",Co,[]);class aH extends Co{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.links=this.description=this.actionCommandId=this.commandId=this.label=null}}Object(n.a)(aH,"OptionalMultipActionButtonProperties",Co,[]);class bH extends rv{constructor(){super();this.styles=
this.secondaryText=null;this.flipIconInRtl=!1}}Object(n.a)(bH,"OptionalPersonaButtonProperties",rv,[]);class cz extends Co{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(n.a)(cz,"OptionalToggleButtonProperties",Co,[]);var kQ=d(940),lQ=d(939),dz=d(475);class cH{constructor(){this.FHf=this.actions=null;this.FKh=!1}}Object(n.a)(cH,"PopulateActions",null,[]);class yB{Y7f(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);
case "ToggleButtonModel":return this.yhj(a);case "InkButtonModel":return this.xhj(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}yhj(a){const b={};b[Vh.a.On]=appChrome.selectors.getButtonToggleState(a);return b}xhj(a){const b={};b[Vh.a.On]=Sg.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);
return b}}Object(n.a)(yB,"ReactStatePropsSelector",null,[]);class ez{constructor(a,b,c,f,l){this.Nqa=a;this.HK=b;this.bqb=c;this.Vm=f;this.hMd={};this.q_h=new yB;this.J4a=l}Exh(a){const b=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&b in this.hMd}Vhj(a,b,c=null){const f=[],l={};if(!this.Exh(a)){const w=a.populationProps.populateQueryCommandId,H={};H.MenuId=a.externalUxCommand;H.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.Nqa.Jid(this.HK,this.bqb,w,w,
H,this.Tbj(c))&1))if("FontPickerModel"===b)this.hMd[w]=!0,f.push(ez.Rgj(a,H)),l[a.externalUxCommand]="FontPickerModel";else if(H.MenuItems)switch(this.hMd[w]=!0,b){case "ComboBoxModel":f.push(ez.Pgj(a,H));l[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.m9f(a.externalUxCommand,b,H.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new cH,
{actions:f,FHf:l,FKh:this.isShadowMenuOpen(c)})}z4f(a,b,c,f,l,w,H,U,ja=null){let wa=null;const Sa=[];Hk.b(a.Title)||(wa=a.Title);for(let eb=0;eb<a.ControlList.length;eb++){const ub=Object(qa.a)(KA.a,a.ControlList[eb]);if(!ub||ub.ExternalId)w&&this.b7i(ub,w),b.push.apply(b,this.Qgj(ub,H,Sa,l,c,f,ja))}return U?appChrome.api.menuSection(Sa,wa,a.Lang):null}m9f(a,b,c,f,l=null){const w=[],H=[],U=[],ja=[];for(var wa=0;wa<c.MenuSectionList.length;wa++){var Sa=Object(qa.a)(ek.a,c.MenuSectionList[wa]);Sa&&
(Sa=this.z4f(Sa,w,a,b,ja,f,H,c.UpdateDynamically,l),c.UpdateDynamically&&U.push(Sa))}wa=null;c.MenuFooterSection&&(wa=this.z4f(c.MenuFooterSection,w,a,b,ja,f,H,c.UpdateDynamically,l));c.UpdateDynamically&&w.push(appChrome.actions.updateMenu(a,U,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor,wa));0<H.length&&w.splice(0,0,appChrome.actions.addControls(H));0<ja.length&&Sg.d("setStatefulSplitButtonMruBypassControls")&&w.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,
ja));return w}b7i(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]="CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(qa.a)(bz.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}Qgj(a,b,c,f,l,w,H=null){const U=[];switch(a.ControlType){case 14:u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&this.qHk(Object(qa.a)(iQ.a,a),U,c);break;case 1:case 3:f=Object(qa.a)(kg.a,a);this.TGk(f,U,b,c);f.MenuItemsStatefulData&&Sg.d("setStatefulSplitButtonMenuItemsStatefulData")&&U.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,f.MenuItemsStatefulData));break;case 2:this.KHk(Object(qa.a)(dz.a,a),U,b,c);break;case 6:this.WGk(Object(qa.a)(fQ.a,a),U,b,c);break;case 4:this.CHk(Object(qa.a)(lt,a),U,b,c);break;case 7:this.XGk(Object(qa.a)(bz.a,a),U,b,c);break;case 12:this.cHk(Object(qa.a)(hQ.a,
a),U,b,c);break;case 13:this.wHk(Object(qa.a)(jQ.a,a),U,b,c);break;case 9:l=Object(qa.a)(jp.a,a);this.fHk(l,U,b,c);"StatefulSplitButtonModel"===w&&f.push(l.ExternalId);break;case 8:this.J4a.kHk(Object(qa.a)(yq.a,a),U,b,c,H)}return U}qHk(a,b,c){c.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):(b=
null,a.IconName&&0<a.IconName.length&&(b=new yp.a(a.IconName)),appChrome.api.createLabelModel(a.ExternalId,a.LabelText,a.Id,Object.assign(new $G,{isBanner:a.IsBanner,iconSet:b?b.iconSet:null})))}TGk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,
a.CommandValueId)),this.CHc()&&((c=this.wta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new yp.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Ya.a)(xB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new YG,{iconSet:(new yp.a(this.wta(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==
a.Alt?a.Alt:null}))):(f=a.DismissHostingSurfaceOnExecute,c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new rv,{iconSet:(new yp.a(this.wta(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==f&&null!==f?f:!0})))),this.Vm.addCommandToMaps(Object.assign(new Ra.a(a.ExternalId,a.Command),
{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&Sg.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}WGk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.CHc()&&((c=this.wta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new yp.a(c)).iconSet)),
a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new cz,{iconSet:(new yp.a(this.wta(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.Vm.addCommandToMaps(Object.assign(new Ra.a(a.ExternalId,
a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}cHk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):c.push(appChrome.api.createErrorViewModel(a.ExternalId,a.Label,a.IconName,Object.assign(new ZG,{retryButtonTitle:a.RetryButtonTitle,onRetryCommandId:a.OnRetryCommandId})))}wHk(a,
b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(c={},a.Label&&(c.label=a.Label),a.Description&&(c.description=a.Description),a.iconSet&&(c.iconSet=a.iconSet),a.Links&&(c.links=a.Links),a.CommandValueId&&(c.commandValueId=a.CommandValueId),a.ActionCommandValueId&&(c.actionCommandValueId=a.ActionCommandValueId),a.ActionCommandId&&(c.actionCommandId=a.ActionCommandId),a.CommandId&&(c.commandId=a.CommandId),b.push(appChrome.actions.updateMultiActionButton(a.ExternalId,
c))):c.push(appChrome.api.createMultiActionButtonModel(a.Id,Object.assign(new aH,{label:a.Label,actionText:a.ActionText,description:a.Description,iconSet:a.iconSet,links:a.Links,actionId:a.ActionId,commandId:a.CommandId,actionCommandId:a.ActionCommandId||a.ActionId,commandValueId:a.CommandValueId,actionCommandValueId:a.ActionCommandValueId||a.CommandValueId})))}KHk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,
a.LabelText)),this.CHc()&&((c=this.wta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new yp.a(c)).iconSet)),u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?c.push(appChrome.api.createToggleButtonModel(a.ExternalId,
a.LabelText,Object.assign(new cz,{iconSet:(new yp.a(this.wta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new cz,{iconSet:(new yp.a(this.wta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),this.Vm.addCommandToMaps(Object.assign(new Ra.a(a.ExternalId,
a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}CHk(a,b,c,f){f.push(a.ExternalId);f=this.Bgj(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):Sg.a("createPersonaButtonModel")&&c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,f,a.LabelText,Object.assign(new bH,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}fHk(a,
b,c,f){f.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.CHc()&&((c=this.wta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new yp.a(c)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&b.push(appChrome.actions.toggleButton(a.ExternalId,
a.Toggled)));else{f=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new Ky,{iconSet:(new yp.a(this.wta(a))).iconSet,keytip:a.KeyTip,hideIcon:f,toggled:l,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));this.Vm.addCommandToMaps(Object.assign(new Ra.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,populationProps:new jh(a.PopulateQueryCommand,
a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.m9f(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}XGk(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(f=this.q_h.Y7f(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),this.Vm.addCommandToMaps(Object.assign(new Ra.a(a.McuExternalId,
a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.Vm.addCommandToMaps(Object.assign(new Ra.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));c=[];const l=[];for(let w=0;w<a.Colors.length;w++){const H=a.Colors[w];w<f?c.push(appChrome.api.colorPickerCell(H.Color,H.DisplayColor,H.Alt)):l.push(appChrome.api.colorPickerCell(H.Color,H.DisplayColor,
H.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}wta(a){return a.Image32by32Class?this.Vm.m2f(a.Image32by32Class):a.Image16by16Class?this.Vm.m2f(a.Image16by16Class):a.ExternalImageId}Bgj(a){return a?
Object.assign(new lQ.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new kQ.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}Tbj(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}CHc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static Rgj(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,
f)=>{Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>{l.isFeatureEnabled(Sr.a.vVa,!1).then(w=>{let H=b.fonts;w||l.isFreemiumUpsellEnabled()||(H=Qa.a.zpa(H,U=>U.fontType!==Sr.a.tMe));w=Object.assign(new XG,{commandId:a.externalUxCommand,fonts:H,isSubscriber:w,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});c(w)}).catch(f)})}))}static Pgj(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=
b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+f.toString(),l.Title));for(let w=0;w<l.ControlList.length;w++){const H=Object(qa.a)(gQ.a,l.ControlList[w]);H&&c.push(appChrome.api.comboBoxItem(H.MenuItemId,H.LabelText,H.Styles,H.CommandValueId,H.AriaLabel,H.Data,H.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(n.a)(ez,
"ReactPopulateQueryCommandPoller",null,[]);class dH{constructor(a,b,c,f,l){this.Vm=c;this.Nqa=a;this.HK=b;this.bqb=f;this.J4a=l}Uhj(a,b,c){const f=[];if(this.tMj(b))a=this.Nlj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.mUc(a,c);hm.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[hm.a.visible]));f.push(Xt(a.externalUxCommand,1>(l&1)));void 0!==c[hm.a.labelText]&&null!==c[hm.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,
c[hm.a.labelText]));void 0!==b&&null!==b&&(l=VG(a.externalUxCommand,b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.U7h(a.externalUxCommand,c,f))}return f}n$i(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var w=appChrome.selectors.getSplitButtonState(a);if(w=this.Vm.getCommandByExternalUxId(w.command))c=this.Nqa.dmc(this.HK,w.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,
!c)),f.push(Xt(a,!1));return f;default:return null}b=!1;for(w in l)if(l=this.Vm.getCommandByExternalUxId(w),Hk.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.Nqa.dmc(this.HK,l.commandId,c))return f.push(Xt(a,!1)),f;f.push(Xt(a,!b));return f}Nlj(a,b,c){switch(b){case "PreviewGalleryModel":return this.J4a.fhj(a,c);case "GalleryModel":return this.J4a.Eaj(c)}return null}tMj(a){return"GalleryModel"===a||"PreviewGalleryModel"===a}mUc(a,b){b.MenuItemId=a.menuItemId;return this.Nqa.Jid(this.HK,
this.bqb,a.commandId,a.queryCommandId,b)}U7h(a,b,c){const f=b[$y.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[$y.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.Doj(a,b))}Doj(a,b){return appChrome.actions.updatePeopleWell(this.I6i(a),b)}I6i(a){const b=[];var c={};a=this.Vm.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.Nqa.Jid(this.HK,this.bqb,"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=
c.ControlList[a],l={};l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(n.a)(dH,"ReactQueryCommandPoller",null,[]);class eH{Jid(a,b,c,f,l,w){let H=0;a&&(this.dmc(a,c,l)&&(H|=1),c=new vB,c.CommandLocation=b,void 0!==w&&null!==w&&(c.InvocationMethod=w),!Hk.b(f)&&a.tUf(f,l,c)&&(H|=2));return H}dmc(a,b,c=
null){return a?a.aac(b,c):!1}}Object(n.a)(eH,"RootPoller",null,[]);class fH{constructor(a,b,c){this.Vm=a;this.HK=b;a=new eH;this.Y1h=new yB;this.J4a=new WG(a,this.HK,c,this.Vm);this.Emf=new ez(a,this.HK,c,this.Vm,this.J4a);this.zmf=new dH(a,this.HK,this.Vm,c,this.J4a)}eTa(){const a=[];if(!Sg.c())return a;a.push.apply(a,this.Boj());var b=this.B9i();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),Object.keys(b).length){const c=this.C9i();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,
!0)),delete b[f];a.push.apply(a,this.lVc(b))}return a}fmc(a,b){Sg.c()&&(a=this.lVc(a,b),appChrome.api.dispatch(a))}BLe(a,b,c=null){if(!Hk.b(a)&&a.populationProps&&!this.Emf.Exh(a)){a=this.Emf.Vhj(a,b,c);if(!a.FKh){let f;(f=a.actions).push.apply(f,this.lVc(a.FHf,Sg.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}lVc(a,b=0){const c=[],f={};if(Sg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&
""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var w of appChrome.selectors.getVisibleControlsInGroup(l))f[w]=!0;for(let H in a)l=H,w=a[H],0===b&&f[l]&&(b=2),c.push.apply(c,this.Aoj(l,w,b));return c}Aoj(a,b,c=0){const f=[],l=this.Vm.getCommandByExternalUxId(a);let w={};appChrome.selectors.isControlDefined(a)&&(w=this.Y1h.Y7f(a,b));w[Vm.a.Gud]=c;Hk.b(l)?(w.ExternalUxId=a,(a=this.zmf.n$i(a,b,w))&&0<a.length&&f.push.apply(f,a)):(w.MenuItemId=l.menuItemId,
w.SourceControlId=a);f.push.apply(f,this.zmf.Uhj(l,b,w));return f}Boj(){const a=[],b=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());for(let w=0;w<c.length;w++){var l=this.Vm.mae(c[w]);if(l){l=this.HK.aac(l);let H=!0;b&&(H=0<=
Array.indexOf(f,c[w]));b&&H===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[w],l))}}return a}B9i(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.Vm.mae(a);c&&(this.HK.aac(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}C9i(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.Vm.Raj(c))for(const f of a)this.HK.aac(f.commandId)||((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),
b.push.apply(b,a));return b}}Object(n.a)(fH,"ReactRibbonRootPoller",null,[1531]);class hx{constructor(a,b,c=null){this.HK=this.wUb=this.ROa=null;this.n_h=b;a.mrb(this);this.xaa=c}get P1c(){this.wUb||(this.wUb=new Date,this.wUb.setTime(0));return this.wUb}set P1c(a){this.wUb=a}get p5k(){return 2}get xaa(){return this.HK}set xaa(a){this.HK=a}get XJb(){this.ROa||(this.ROa=new fH(this.n_h,this.xaa,this.p5k));return this.ROa}VKc(){const a=document.activeElement;za.a.isEditable(a)&&a.blur()}executeCommand(a,
b,c,f,l,w,H,U=2){Hk.b(this.xaa)||(l=new vB,l.CommandLocation=U,l.InvocationMethod=f,l.CommandTabName=c,b[Vm.a.Gud]=U,this.xaa.tUf(a,b,l,w,H),this.c3j(a,b))}eTa(){return Hk.b(this.xaa)?[]:this.XJb.eTa()}emc(){const a=this.eTa();0<a.length&&(this.P1c=new Date,appChrome.api.dispatch(a))}uPb(){Sg.c()&&this.XJb.fmc({PeopleWell:"PeopleWell"},18)}c3j(a,b){try{const c=Ab.a.instance.rb("Common.ISystemInitiatedFeedback");if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?
"_"+f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.Noe("Ribbon"+l)}}catch(c){ka.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(n.a)(hx,"ReactRibbonRoot",null,[1516,1532]);class zB{constructor(){this.Oqa=[]}mrb(a){a&&!Array.contains(this.Oqa,a)&&Array.add(this.Oqa,a)}Nih(a){Array.remove(this.Oqa,a)}VKc(){for(const a of this.Oqa)a.VKc()}dispose(){this.Oqa=null}}Object(n.a)(zB,"RootManagerBase",null,[1135,106]);class Tr extends zB{constructor(){super()}static get instance(){return Tr.Ka||
Tr.KGj()}static KGj(){Tr.Ka=new Tr;return Tr.Ka}}Tr.Ka=null;Object(n.a)(Tr,"ReactRootManager",zB,[1134,1135]);class Ap{constructor(a,b,c,f,l,w,H,U=null,ja=!0,wa=null,Sa=null){this.BSb=this.xFc=this.wzd=this.JP=null;this.Nof=[];this.GDc=null;this.R4a=a;this.PGd=b;this.aqb=c;this.Od=f;this.Ca=l;this.Vm=w;this.JP=wa?wa:new hx(Tr.instance,this.Vm);this.O3a=H;this.Dnf=new JG;this.XOa=U;this.sLd=ja;new FG;this.ncf=Sa;db.a.get_instance().Uj(7,Object(F.a)(this,this.zel,"setRibbonPostInteractiveReady"));db.a.get_instance().Uj(7,
Object(F.a)(this,this.n5j,"logRibbonLoadedActivity"));db.a.get_instance().Uj(19,Object(F.a)(this,this.Q2j,"logAppLoadedActivity"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&db.a.get_instance().Uj(7,Object(F.a)(this,this.VWk,"registerSubComponentReporting"));db.a.get_instance().Uj(7,Object(F.a)(this,this.zOk,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.sLd||this.YJ(5);c?c.then(()=>{this.pkh()}).catch(()=>ka.ULS.sendTraceTag(561394319,
340,10,"Failed to load the resources for the Ribbon")):EG.a.LCh(EG.a.LCh(el.Task.WAA(this.Kqg(a),this.Jqg(Ap.XPh)),()=>this.Jqg(Ap.fOh)),()=>this.Kqg(b)).continueWith(()=>{this.pkh()},11)}dispose(){this.zCl();this.GDc&&this.GDc.dispose();for(const a of this.Nof)db.a.get_instance().fui(a);u.AFrameworkApplication.Ta.RJ(G.a.p2k,Xd.a.frame,ac.ActionManager.Ng)}Jqg(a){return Ab.a.instance.resolve("Common.ISharedDependencyLoader").iBb(u.AFrameworkApplication.Bj(a,2))}Kqg(a){return""===a?el.Task.gt(!0):
Ab.a.instance.resolve("Common.ISharedDependencyLoader").iBb(u.AFrameworkApplication.Bj(a,3))}lfg(){(this.XOa||this.O3a)&&appChrome.api.dispatch(this.i9f());this.jXe();Sg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(u.AFrameworkApplication.tga);this.JP.emc()}pkh(){this.lfg();this.sLd&&(appChrome.renderAppChrome(this.R4a,Sg.e()),this.YJ(10));this.Hsf();this.NIc();this.sLd&&this.YJ(5);this.DXc()}DXc(){this.Od&&this.Ca&&this.aqb&&(this.GDc=new KG(this.Od,this.Ca,this.R4a,this.aqb),this.GDc.initialize())}get b5k(){return this.Dnf}setCommandDefinitionMapping(){if(Sg.a("setCommandDefinitionMapping")){const a=
bQ(this.Vm);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.s9&&Sg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{0===b&&this.oIb()})}Hsf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(qa.a)(hx,this.JP);this.wzd=new IG(this.JP,a.XJb,this.Vm,this.Od,this.PGd,Ab.a.instance.rb("Common.IRibbonSQMInformation"),Ab.a.instance.rb("Common.IFileMenuSQMInformation"),
u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,Ab.a.instance.Ja("Common.ISystemInitiatedFeedback"),null);this.nji();this.csj()}nji(){this.xFc=appChrome.api.bindCommandHandler((a,b)=>{this.wzd.executeCommand(a,b)})}zCl(){this.xFc&&(this.xFc(),this.xFc=null)}jXe(){appChrome.api.initializeLogger(new cQ.a)}eTa(){return this.JP?this.JP.eTa():[]}oIb(){Ad.a.instance.hG(()=>{let a=null;Ad.a.instance.hG(()=>{a=this.eTa()},"RB:GA");a&&0<a.length&&(this.JP.P1c=new Date,Ad.a.instance.hG(()=>{appChrome.api.dispatch(a)},
"RB:DA"));this.BSb&&Ad.a.instance.hG(()=>{},"RB:J")},"RB:PFSU")}uPb(){this.JP.uPb()}h5h(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}i9f(){var a=u.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>
{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));b.push.apply(b,this.r2f());a=new CG.a(this.Vm);this.XOa.Uaa&&(zp.Yzl(this.XOa.Uaa),b.push.apply(b,a.P5d(this.XOa.Uaa)));if(this.XOa.qEh)for(const c of this.XOa.qEh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.i2i,c.LE,c.$zl));b.push.apply(b,a.L3i(this.XOa.Zzl));
return b}r2f(){const a=[];if(this.O3a&&this.O3a.Uaa){const c=this.O3a.Uaa;for(let f in c){var b=c[f];const l=this.Vm.v7d(f);if(l)for(let w of l)a.push(appChrome.actions.updateControlHiddenState(w,b))}}return a}nPb(a){a&&this.JP.XJb.fmc(a,0)}BLe(a){this.JP.XJb.BLe(this.Vm.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}Dll(a){db.a.get_instance().Uj(5,null).continueWith(()=>{appChrome.api.dispatch(this.Mkj(a))})}vOi(){const a=u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?
"ShareMenu":"Share",b=u.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.oHl(a,"Shared"===(b.SharingStatus||"")))}zOk(){u.AFrameworkApplication.fa.ff(()=>{this.vOi()})}oHl(a,b){return appChrome.actions.updateSharingStatusIndicator(a,b)}Mkj(a){return appChrome.actions.updateControlHiddenState(a,!1)}Nkj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}YJ(a){db.a.get_instance().YJ(a);this.Nof.push(a)}zel(){Sg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new DG,
{postRibbonInteractiveReady:!0})))}NIc(){this.O3a&&this.ncf&&(this.BSb=this.ncf.createFileMenu(this.O3a,this.JP.xaa),this.Dnf.fileMenu=this.BSb)}B_j(){this.BSb&&this.BSb.w_j()}gnd(a,b,c){if(1===c)return 32;this.Dqc(!0);this.oIb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}hnd(a,b,c){if(1===c)return 32;this.Dqc(!1);this.Fel();this.oIb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}y3e(a,b,c){if(1===c)return 32;(a=Ab.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&a.execute(f=>
{f.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}Fel(){ui.a.aK(u.AFrameworkApplication.fa.Ga("IsSimplifiedRibbonOnCookieName"),"true",ui.a.FJ)}Dqc(a){ui.a.aK(u.AFrameworkApplication.fa.Ga("ReactRibbonMLRPreferenceCookieName"),a.toString(),ui.a.FJ)}n5j(){if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Po){const a=Ab.a.instance.Ja("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),
u.AFrameworkApplication.LL("d79fg304;61jba833;h856e313;f5i2f477")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),u.AFrameworkApplication.LL("69a7h198;dfd7j584"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFreemiumUpsellEnabled()&&u.AFrameworkApplication.LL("5fjej882;e0jjh200")})}}Q2j(){this.Ca.ya(G.a.y3e,
Xd.a.frame,Object(F.a)(this,this.y3e,"triggerModeSwitcherTUI"));const a=ui.a.I3(u.AFrameworkApplication.fa.Ga("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const b=Ab.a.instance.Ja("Common.ISystemInitiatedFeedback");b&&(u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):u.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&a&&b.execute(c=>
{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}VWk(){db.a.get_instance().Uj(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const a=appChrome.api.getRibbonSubComponentMappings();for(let c in a){var b=c;const f=a[c];if(f)for(const l of f)u.AFrameworkApplication.Ta.hT(l)?appChrome.api.reportRibbonSubComponentBehaviorMapped(b):u.AFrameworkApplication.Ta.rdl(l,this.tGi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}tGi(a){return()=>
{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}csj(){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Sg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&u.AFrameworkApplication.kIb.BOd){const a=u.AFrameworkApplication.kIb.BOd,b=u.AFrameworkApplication.kIb.qsf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:
a;Ap.ind.Gb(c)?Ap.ind.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.wzd.executeCommand(a,b))}}}Ap.XPh="common";Ap.fOh="appChrome";Ap.ind=new aQ.a(sB.a.O9f());Object(n.a)(Ap,"ReactRibbonUser",null,[370,550,106]);class AB{constructor(){this.label=this.value=null}}Object(n.a)(AB,"TextInfoSectionField",null,[]);class gH{constructor(a,b){this.Uaa=b}}Object(n.a)(gH,"ReactRibbonJewelProperties",null,[]);class BB extends Ap{constructor(a,
b,c,f,l,w,H,U,ja=null,wa=!0,Sa=null,eb=null){super(a,b,f,l,w,H,U,ja,wa,Sa,eb);this.izc=null;this.jzc=c;this.jzc.execute(ub=>{this.izc=ub});this.jzc.execute(ub=>{this.JP.xaa=ub})}eTa(){return this.izc?(this.izc.clearCache(),super.eTa()):[]}}Object(n.a)(BB,"ReactRibbonUser",Ap,[]);var CB=d(899),ix=d(237),DB=d(375),hH=d(719),EB=d(1121);class jx{static get Ung(){return"teams"===(u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.gK)||"").toLowerCase()}static get Euh(){return jx.Ung?(va.a.J(576030427,
811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.kSa,u.AFrameworkApplication.bub),u.AFrameworkApplication.kSa&&u.AFrameworkApplication.bub):u.AFrameworkApplication.kSa}}Object(n.a)(jx,"CopyLinkHelper",null,[]);class iH{constructor(a,b){this.oDe=null;this.la=a;this.qhk=b}dispose(){this.oDe&&(xm.CuiHelper.YOi(this.oDe),this.oDe=null)}aoj(){if(u.AFrameworkApplication.workflowEnabled){let a="";switch(u.AFrameworkApplication.Cvc){case "Assign":a=CommonUIStrings.l_Assign;
break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new EB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return u.AFrameworkApplication.Yle&&u.AFrameworkApplication.o_a||u.AFrameworkApplication.avc?Object.assign(new EB.a,{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:xm.CuiHelper.wmd}):u.AFrameworkApplication.kSa?Object.assign(new EB.a,{command:"981334692",label:ResourceStrings.L_Share,image:xm.CuiHelper.Ohl,id:xm.CuiHelper.MXe}):null}wkl(){if(jx.Ung&&
!this.qhk)return!1;const a=this.aoj();return a&&"981334692"===a.command?this.la.hmg||this.la.GTj:!1}Akl(){va.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.kSa,u.AFrameworkApplication.bub);return u.AFrameworkApplication.kSa&&(u.AFrameworkApplication.bub||u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}Object(n.a)(iH,"CuiControlUser",null,[106]);var kx=d(276);class jH extends BB{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud){super(b,
a.Ija,f,Lb.a.waa,l,w,H,null,wa,!0,null,ub);this.Gug=this.Ybc=this.Ptg=this.uCb=this.Ik=this.EHa=this.la=this.nh=this.$Va=this.iad=this.Nre=this.kwe=null;this.ZEg=!1;this.n8=0;this.fxe=this.u7c=this.d$=!1;this.Nu=this.O9c=this.Veb=null;this.oCf="hideTellMeWrapper";b=new DB.a("ReactRibbonUser::InitPptReactRibbon",!1);try{this.EHa=eb,this.la=Sa,this.Nre=new iH(this.la,Fc.ka("ShareMenuIsEnabled")),this.kwe=a,this.iad=ja,this.uCb=H,this.$Va=U||new hH.a,this.nh=this.$Va.PYd(2,"ReactRibbonUser"),this.n8=
0,this.Ptg=wa.Uaa,this.d$=!!window.performance&&!!window.performance.now,this.Ik=Ub,this.u7c=cc,this.Veb=Fc,this.fxe=Ic,this.O9c=Cc,this.Nu=Ud,this.O0k(),db.a.get_instance().Uj(10,Object(F.a)(this,this.TFj,"initializeFullPptRibbon"),11),db.a.get_instance().Uj(10,Object(F.a)(this,this.createHeader,"createHeader"),3)}finally{b&&b.dispose()}}kfg(){Eg.a.instance.jc("InitRibbon",(new Date).getTime());va.a.J(512496020,801,50,"Initialize SLR Iteration: {0}; IsReactMLRRendered: {1}",this.la.pJk?"2":"1",this.la.Voa);
this.la.eB&&this.la.ka("ActionAIRibbonLoadOn1stTimeEnabled")&&!this.la.ka("ActionAIRibbonLoadedOn1stTime")&&this.I$k();this.la.podsRibbonEarlyRendererExposureControl&&!this.la.QNf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(F.a)(this,this.HFj,"initializeEarlyRenderedPptRibbon")):(Eg.a.instance.jc("RenderRibbonStart",Date.now()),this.sdj(ix.a(Ab.a.instance)).catch(()=>{va.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>
{Eg.a.instance.jc("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(ix.a(Ab.a.instance));Sg.a("setCookieWithExpirationCallback")&&Sg.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>ui.a.aK(a,b,ui.a.FJ)),appChrome.api.setGetCookieValueCallback(a=>ui.a.get(a)));appChrome.setAppSettings(u.AFrameworkApplication.fa.appSettings);if(this.la.ka("DynamicBundlesIsEnabled")){const a=u.AFrameworkApplication.tga+"exp/";appResourceLoader.init(YP.a.resolveScript,a);
appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.jXe();Pd.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?appChrome.initializeRibbonStore(this.la.Voa):appChrome.initializeRibbonStore();this.lfg();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",!1)&&1!==u.AFrameworkApplication.Aa.mode&&(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",
!1)?this.Bhh():this.afe());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.EHa&&this.EHa.U0k();appChrome.renderAppChrome(this.R4a,Sg.e());this.la.XIa&&Pd.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");db.a.get_instance().YJ(5);db.a.get_instance().YJ(10);db.a.get_instance().YJ(6);this.Nrg();Eg.a.instance.jc("Stage1Ribbon",CB.a.v3d&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&null!==
PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}Bhh(){db.a.get_instance().Uj(4,()=>{db.a.get_instance().isCompleted(7)||this.afe()})}I$k(){ui.a.aK("PPTActionAIRibbonLoadedOnIstTime",(!0).toString(),ui.a.FJ)}sdj(a){return Pd.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?this.la.URk?a(this.la.Voa?"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):this.la.Voa?a("powerpoint-ribbon-intl").catch(()=>
{}).then(()=>a("powerpoint-ribbon-mlr-intl")).catch(()=>{}).then(()=>a("appChrome")):a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):a("appChrome")}HFj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&Eg.a.instance.jc("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&Eg.a.instance.jc("AppChromeReadyTime",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&Eg.a.instance.jc("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),
this.afe()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)&&this.Bhh();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.O9c.mqh(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?Eg.a.instance.jc("AppInitStatus_ribbonSkeletonDismissed",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.Nrg();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&ka.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.jXe();db.a.get_instance().YJ(5);db.a.get_instance().YJ(10);db.a.get_instance().YJ(6);
Du.a.dispatch("RibbonVisible")}TFj(){Eg.a.instance.jc("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{Eg.a.instance.jc("RibbonLazyPromiseFulfilled",(new Date).getTime());u.AFrameworkApplication.fa.ff(()=>{this.Nre.Akl()?db.a.get_instance().Uj(7,()=>{va.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");appChrome.api.dispatch(this.Nkj())}):db.a.get_instance().Uj(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});
this.XOa&&a.push.apply(a,this.i9f());if(u.AFrameworkApplication.Aa.hb.s9){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new ZP.a,{shyDismissalRegions:b})))}appChrome.api.dispatch(a);this.cXk();this.jzc.execute(b=>{if(void 0===this.JP.xaa||null===this.JP.xaa)this.JP.xaa=b;this.Hsf()});this.HUk();this.NIc();this.createFileMenu();this.EHa&&(a=this.EHa.initialize(),va.a.J(512496017,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));
this.DXc();db.a.get_instance().YJ(7);Eg.a.instance.jc("Stage3Ribbon",(new Date).getTime());this.d$&&Eg.a.instance.jc("RibbonInteractivePerfMark",window.performance.now());this.o5j();this.iYk();this.UFj();za.a.BI(this.kwe.FF(),"ScrollableRibbon");return null})}o5j(){if(Eg.a.instance.S$a)va.a.J(512496016,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};Eg.a.instance.hp("Stage1Ribbon")&&(a.RibbonDisplayed=Eg.a.instance.ih("Stage1Ribbon"));
Eg.a.instance.hp("Stage3Ribbon")&&(a.RibbonInteractive=Eg.a.instance.ih("Stage3Ribbon"));Eg.a.instance.hp("InitRibbon")&&(a.InitRibbon=Eg.a.instance.ih("InitRibbon"));Eg.a.instance.hp("InitFullRibbon")&&(a.InitFullRibbon=Eg.a.instance.ih("InitFullRibbon"));Eg.a.instance.hp("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=Eg.a.instance.ih("RibbonLazyPromiseFulfilled"));Eg.a.instance.hp("RenderRibbonStart")&&(a.RenderRibbonStart=Eg.a.instance.ih("RenderRibbonStart"));Eg.a.instance.hp("AppChromeReadyTime")&&
(a.AppChromeReadyTime=Eg.a.instance.ih("AppChromeReadyTime"));Eg.a.instance.hp("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=Eg.a.instance.ih("AppInitStatus_ribbonSkeletonDismissed"));va.a.J(512496015,809,50,"Ribbon Perf metrics: "+pa.a.toJSON(a))}}x4j(){if(Eg.a.instance.S$a)va.a.J(512496014,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};Eg.a.instance.hp("Stage2Ribbon")&&(a.RibbonEnabled=
Eg.a.instance.ih("Stage2Ribbon"));Eg.a.instance.hp("Stage4Ribbon")&&(a.RibbonFull=Eg.a.instance.ih("Stage4Ribbon"));va.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+pa.a.toJSON(a))}}UFj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);Eg.a.instance.jc("Stage4Ribbon",(new Date).getTime());this.x4j();return null})}oIb(){this.izc&&db.a.get_instance().isCompleted(7)&&(fd.a.mark(4893),super.oIb(),fd.a.mark(4894),this.ZEg||(Eg.a.instance.jc("Stage2RibbonStart",Date.now()),
appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),Eg.a.instance.jc("Stage2Ribbon",Date.now()),this.ZEg=!0))}HH(){this.oIb()}selectRibbonTabById(a){const b=ui.a.I3(kx.a.BZa,!0);this.la.eB&&b&&Pd.a("RemoveContextualFromActionAiRibbonMode")||this.h5h(a)}get uph(){return appChrome.selectors.getSelectedTabId()}aSi(){this.gFb||va.a.J(509637252,801,10,"Ribbon top bar1 is set to null");this.gFb.classList.remove(this.oCf)}DPf(){this.gFb||va.a.J(509637251,801,10,"Ribbon top bar1 is set to null");
this.gFb.classList.add(this.oCf)}qOi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();u.AFrameworkApplication.fa.ff(()=>{if(!Pd.a("PPTOHideLegacySharedHeaderBugFix")||!u.AFrameworkApplication.CQ){var b=(new Date).getTime(),c=this.nh.Bu("createHeader"),f=u.AFrameworkApplication.Aa.hb.dO,l=document.getElementById("HeaderPlaceholder");this.gFb=(new AG(Pf.a.QQi,this.kwe)).ZTi();this.la.eB&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&this.DPf();
if(f)try{va.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");var w=new xG;appChrome.renderSharedHeader(this.gFb,w.uhj()).then(()=>{this.K2j(b,a);l&&this.qOi()})}catch(H){va.a.J(512496011,801,10,"Exception while trying to render shared header {0}",H)}else throw va.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),Error.invalidOperation("Invalid request to render legacy Shared Header");u.AFrameworkApplication.CQ||(w=Rr.a.Oee(O.AppFrame.JEa,null,this.gFb,!0),f&&
(w.dJ=!0,this.ZJb(w,G.a.zpc,G.a.ypc),w.bindAction(x.KeyInputManager.Oa(A.a.X1,0),G.a.dnd)));!l&&CB.a.MVf&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.nh.Gu(c);this.n8|=1;this.uuc()}})}K2j(a,b){var c=(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;va.a.J(512496009,809,50,"Create Header Perf metrics: "+pa.a.toJSON(f))}ZJb(a,b,c){const f=x.KeyInputManager.Oa(A.a.Sq,0),l=x.KeyInputManager.Oa(A.a.Sq,4);a.Dp(f);a.Dp(l);
a.bindAction(f,b);a.bindAction(l,c)}NIc(){const a=()=>{const b=this.nh.Bu("createJewel");this.O3a=this.DGj();Ap.prototype.NIc.call(this);this.nh.Gu(b);this.n8|=2;this.uuc()};this.u7c&&this.Veb?this.Veb.bzb(a):u.AFrameworkApplication.fa.ff(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),f=this.nh.Bu("createFileMenu"),l=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var w=[Object.assign(new AB,{label:CommonUIStrings.L_DiagnosticsSessionId,value:u.AFrameworkApplication.userSessionId}),
Object.assign(new AB,{label:CommonUIStrings.L_DiagnosticsBuild,value:u.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",w))}l.push.apply(l,this.r2f());w=document.createElement("div");document.body.appendChild(w);appChrome.renderFileMenu(w,l);this.J2j(c,a);this.nh.Gu(f);this.n8|=22;this.uuc()};this.u7c&&this.Veb?this.Veb.bzb(b):u.AFrameworkApplication.fa.ff(b)}J2j(a,b){var c=(new Date).getTime();const f={};f.fileMenuCallbackRegistrationTime=
b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;va.a.J(512496008,809,50,"File Menu Perf metrics: "+pa.a.toJSON(f))}HUk(){const a=()=>{const b=this.nh.Bu("refreshRibbon");this.Ybc||(this.Ybc={},zp.mEh(this.Ybc),this.iad.cJh(this.Ybc),this.Gug=this.X5i(this.Ptg,this.Ybc));const c=new CG.a(this.uCb);appChrome.api.dispatch(c.P5d(this.Gug));this.nh.Gu(b);this.n8|=4;this.uuc()};this.u7c&&this.Veb?this.Veb.bzb(a):u.AFrameworkApplication.fa.ff(a)}X5i(a,b){const c={};for(let l in b){var f=
b[l];const w=l;f!==a[w]&&(c[w]=f,va.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",w,a[w],f))}return c}DGj(){const a={};this.iad.Hcl(a);this.iad.cJh(a);return new gH(null,a,"jewelPPTEditor")}iYk(){CB.a.v3d&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}Tih(a){db.a.get_instance().Uj(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}O0k(){const a=this.la.ka("ShareMenuIsEnabled"),b=a?"ShareTopBar":"Share";
u.AFrameworkApplication.bub?this.Tih(b):u.AFrameworkApplication.fa.ff(()=>{const c=this.nh.Bu("createShareAction"),f=this.Nre.wkl();f?this.Dll(b):(this.Tih(b),this.la.tjb&&this.Ik.caa(this.Ik.b6,this.Ik.wqd));a&&(f?this.la.tjb&&db.a.get_instance().Uj(7,()=>{this.Ik.daa(this.Ik.b6,this.Ik.wqd);this.Ik.baa(this.Ik.b6,this.Ik.wqd)}):db.a.get_instance().Uj(7,()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.nh.Gu(c);this.n8|=8;this.uuc()})}uuc(){31===this.n8&&
(this.$Va.H2c(2),this.n8=0)}afe(){this.O9c.mji();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));db.a.get_instance().Uj(7,()=>{this.O9c.yCl();Sg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.fxe||appChrome.PRIToastManager.dismissToast()},11)}Nrg(){db.a.get_instance().YJ(18);Du.a.dispatch("RibbonVisible")}uYg(){return()=>{this.Nu.YGc(()=>{appChrome.PRIToastManager.dismissToast()})}}cXk(){this.fxe&&(Ap.ind.$("NewDefaultSlide",
this.uYg()),Ap.ind.$("ChangeLayoutFlyout",this.uYg()))}}Object(n.a)(jH,"ReactRibbonUser",BB,[359,550,106]);class kH{constructor(a,b,c,f,l,w,H){this.HDb=null;this.zb=a;this.SIg=b;this.pa=c;this.tB=f;this.sO=l;this.ia=w;this.Tp=H;this.SIg.kk(Object(F.a)(this,this.Jmh,"ribbonChangeTabHandler"))}dispose(){this.SIg.Rm(Object(F.a)(this,this.Jmh,"ribbonChangeTabHandler"))}get SF(){return this.HDb}set SF(a){this.HDb!==a&&a&&(this.HDb=a,this.sO.O_?this.sO.O_=!1:this.Tp&&this.sO.kVa&&this.ia.processAction(D.a.Xja,
2))}Jmh(a,b){b.node.Sa(hb.a.shapeId)&&(a=b.node.eb(hb.a.shapeId),this.HDb&&this.HDb.id===b.node.id&&a&&(this.zb.Db(new Le.a(2,1,0,()=>{const c=this.pa.tjj(this.tB.uph,b.node);0<c.length&&this.tB.selectRibbonTabById(c)},90,"10")),this.HDb=null))}}Object(n.a)(kH,"RibbonChangeManager",null,[361]);class lH{constructor(a,b,c){this.i2i=a;this.LE=b;this.$zl=c}}Object(n.a)(lH,"GallerySectionData",null,[]);let FB,GB,fz,HB,lx,IB,JB,KB,LB;class uv{constructor(a,b,c,f,l,w){this.la=a;this.v9c=b;this.Q8c=c;this.lPg=
f;this.wCb=l;this.Ik=w}bqd(a){this.la.Xkg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=
!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.Ari,a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=
!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.Xkg||(a["PptRibbon.Home.Drawing.AllShapes"]=
!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.Sme||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=
!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=
!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=
!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.Qme){if(this.la.Rme||this.la.EAb||this.la.Pme)a["ContextualTabs.Tables.Layout"]=!1;this.la.Pme&&(a["ContextualTabs.Tables.Layout.Alignment"]=!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=
!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.la.Rme&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.EAb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=
!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=
!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.laa&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.QIb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.la.Shb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.K0c&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.Ume&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.Lmc&&
(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=!this.la.ka("InsertSymbolIsEnabled");this.la.Zlg||(a["PptRibbon.Home.Font.Shrink"]=
!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.yTj||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.wje||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.oEh(a,!0,!0,!0);this.nEh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.Tbh||(a["PptRibbon.AudioPlayback"]=!0);this.la.OIb||(a["PptRibbon.AudioFormat"]=!0);if(u.AFrameworkApplication.Asa||!this.la.pptEditInsertAppsForOfficeEnabled||
this.la.G$b)a["PptRibbon.InsertTab.AppForOffice"]=!0,a["PptRibbon.InsertTab.InsertAddinTransitionEntry"]=!0;this.la.vzb||(a["PptRibbon.View.Zoom"]=!0);this.la.SQj||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.ghg||(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=!0);var b=[];this.la.fMa&&(b=this.la.fMa.split(","));for(const c of b){const f=
c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.la.TRd||(a.AnimationMore=!0);this.la.OXj?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.vg&&(a["PptRibbon.View.PresentationViews"]=!0);this.lPg?a["PptRibbon.Home.Clipboard.Paste"]=
!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.blg?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.sle||(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?
a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=this.la.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.UNb&&!u.AFrameworkApplication.Asa)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&this.la.ka("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&this.la.ka("HelpTabShowTrainingIsEnabled"));a.btnWhatsNew=!(b&&this.la.ka("HelpTabWhatsNewIsEnabled"));
a.btnFeedbackPane=!0;this.la.rab&&this.la.SXc&&this.la.SXc.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!0;
a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=!0;a.PresentLive=!0;a.PresentLiveConsumer=
!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CacheDictateVisibility",!1)||(a["PptRibbon.Home.Dictation"]=!0,a.btnStartDictation=!0);this.wCb&&(a["PptRibbon.Review.Comments.Markers"]=!0);this.la.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.la.Gah;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.IJk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=!this.la.UJa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=
!this.la.UJa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.UJa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=!this.la.UJa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.UJa;a.FixIt=!this.la.HQc}mgl(a){if(!this.la.ka("HelpTabIsEnabled")||u.AFrameworkApplication.UNb||u.AFrameworkApplication.Asa)a.Help=!0;a.Draw=!this.la.vg}qoj(){const a=new Ka.a;if(this.la.fMa){var b=this.la.fMa.split(",");for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new lH("TransitionMore",
"Transition"+b,!0))}return a.toArray()}Hcl(a){a["PptJewel.Menu"]=!0;this.la.ka("WheresSaveButtonBrsIsEnabled")||(a["PptJewel.SaveACopy.WheresTheSaveButton"]=!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.v9c&&this.v9c.L1g||(a["PptJewel.About.TryOffice"]=!0);this.Q8c&&this.Q8c.cvh||(a["PptJewel.About.TryMacOffice"]=!0);this.la.ka("DocumentNameInJewelInfoMenuIsEnabled")&&u.AFrameworkApplication.St.$w||(a.lblBreadcrumbDocName=!0);this.la.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.UNb&&(a["PptJewel.Help"]=!0)}cJh(a){delete a["PptJewel.Menu"];const b=this.la.Ga(u.AFrameworkApplication.gK);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=
!0;a["PptJewel.Share.Embed"]=!0;var c=this.la.ka("SaveACopyIsEnabledForUiHost");const f=this.la.ka("UiHostSupportsDocRebootFeatures");c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}u.AFrameworkApplication.Swa||(a["PptJewel.New"]=!0);u.AFrameworkApplication.XPe||(a["PptJewel.Open"]=!0);u.AFrameworkApplication.UE||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);u.AFrameworkApplication.pEh&&(a["PptJewel.Info.OpenInClient"]=
!0,a.btnOpenInClient=!0);u.AFrameworkApplication.o_a||(a["PptJewel.Share.ReplyWithChanges"]=!0);u.AFrameworkApplication.T3d||u.AFrameworkApplication.h6e||(a["PptJewel.Info.FileVersion"]=!0);u.AFrameworkApplication.wAb?(a["PptJewel.Info.FileVersion"]=!0,u.AFrameworkApplication.Wj("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),ka.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):u.AFrameworkApplication.g1c()?
this.la.uGk?(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):this.la.RNi?this.la.ka("IsAnonymousUserCheckSupportedForVH")&&this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):
(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262733,832,15,"PPT shared version history menu item trimmed."));a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&(a["PptJewel.Info"]=!0);u.AFrameworkApplication.kSa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(u.AFrameworkApplication.BM||!u.AFrameworkApplication.f6e&&!u.AFrameworkApplication.syb&&!u.AFrameworkApplication.J3d)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&
a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);u.AFrameworkApplication.Vzl&&(a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);this.la.ka("DisablePrint")&&
(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.BM&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);this.la.ka("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=
!0);this.la.ka("SaveAsToHostBrsIsEnabled")&&this.la.ka("UserCanWriteRelative")&&this.la.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=!0);this.la.ka("SaveToAnotherFolderBrsIsEnabled")&&this.la.ka("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.DTj||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=
!0);this.la.gmg&&this.la.vg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!this.la.ka("153")||".odp"===this.la.Ga("152").toLowerCase()||u.AFrameworkApplication.BM)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0;this.la.ka("RenameDialogIsEnabled")&&u.AFrameworkApplication.V$b()&&!u.AFrameworkApplication.BM||(a["PptJewel.Rename"]=!0);u.AFrameworkApplication.cpc||(a["PptJewel.Help.ReportAbuse"]=!0);c=!u.AFrameworkApplication.tdd||!this.la.ka("1072");u.AFrameworkApplication.privacyUrl||!c||u.AFrameworkApplication.ntc||
this.v9c&&this.v9c.L1g||this.Q8c&&this.Q8c.cvh||this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);u.AFrameworkApplication.privacyUrl||(a["PptJewel.About.Privacy"]=!0);a["PptJewel.About.TrustCenter"]=c;u.AFrameworkApplication.ntc||(a["PptJewel.About.TermsOfUse"]=!0);this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);u.AFrameworkApplication.Kda||(a["PptJewel.SecondaryMenu"]=!0);c=!this.la.ka("248");a["PptRibbon.Design.Designer.New"]=
c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;(a["PptRibbon.Home.ShowHide.Designer"]=c)&&this.Ik&&this.Ik.caa(this.Ik.b6,this.Ik.W_d);c=!this.la.ka("822");a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!uv.HUj())||ka.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=c;ka.ULS.sendTraceTag(512262728,
352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",u.AFrameworkApplication.n$b(),u.AFrameworkApplication.insertOnlinePictureFromHostEnabled,u.AFrameworkApplication.TWc,u.AFrameworkApplication.wAb,u.AFrameworkApplication.SHc,u.AFrameworkApplication.pZb);this.la.ka("671")&&this.oEh(a,this.la.pptInsertOnlinePictureEnabled,
u.AFrameworkApplication.n$b(),this.la.rab);this.nEh(a,this.la.ZXc);this.la.ka("670")&&(c=!this.la.ka("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=!!c);a["PptRibbon.Review.Proofing.EditorPane"]=!this.la.ka("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!this.la.ka("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!this.la.ka("619");a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=
!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!1);c=this.la.ka("LiveSubtitlesEnabled");this.la.pla&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=
!1,Pd.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.Jac&&this.la.xmg&&
(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.la.pptRehearsalVisionEnabled||this.la.PIb?(a["PptRibbon.View.Coach.Menu"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=!1),this.la.PIb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);this.la.MXj&&this.la.pla&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=
!1,Pd.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);this.la.ka("WacLabelingPoliciesIsEnabled")&&this.la.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&this.la.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0,
this.Ik&&this.Ik.caa(this.Ik.b6,this.Ik.Yph));this.la.dictationIsEnabled&&B.a.uAh&&this.la.ka("UserCanUseDictation")?(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1):this.Ik&&this.Ik.caa(this.Ik.b6,this.Ik.$Of);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&
a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.Gah;a.FixIt=!this.la.HQc;this.la.Eu("IsPresentToTeamsSupportedHost")&&!this.la.ka("IsPresentToTeamsSupportedHost")?(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);this.la.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);
zp.dIl(uv.eBj,a);if(u.AFrameworkApplication.Asa||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.G$b)a["PptJewel.Addin"]=!0}oEh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=
!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=
!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}nEh(a,b){a.InsertPictureFromMobileDevice=!b;a.ChangePictureFromMobileDevice=!b}static HUj(){const a=u.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"),b=u.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");
var c=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.gK);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}uv.eBj={["ellipsisOpenInApp"]:(LB=new Ka.a,LB.add("HostOpenInClient"),LB),["ellipsisOpenInBrowser"]:(KB=new Ka.a,KB.add("HostOpenInBrowser"),KB),["ellipsisDownload"]:(JB=new Ka.a,JB.add("HostDownload"),JB),["conversation"]:(IB=new Ka.a,IB.add("HostConversation"),IB),["close"]:(lx=new Ka.a,lx.add("HostClose"),lx.add("btnjClose"),lx.add("msJewelSecondary"),lx),["copyLink"]:(HB=
new Ka.a,HB.add("CopyLink"),HB),["share"]:(fz=new Ka.a,fz.add("jbtnFileSharing"),fz.add("btnFileSharing"),fz),["docChat"]:(GB=new Ka.a,GB.add("DocChat"),GB),["openInApp"]:(FB=new Ka.a,FB.add("btnOpenInClient"),FB)};Object(n.a)(uv,"RibbonCommandTrimmer",null,[389]);class MB{constructor(){this.EHa=this.gl=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}Zb(a){this.K=a;a.register(iB,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().oa(()=>
new iB(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IAppSettingsManager")));a.register(357,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().oa(()=>new pG(new fB(u.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Yzb;B.a.Vj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").Gya);var c=this.K.resolve("PowerPointWebEditor.IFileInfo").jja;let f=2===c||3===c||0===c;c=1===c;const l=a.resolve("PowerPointWebEditor.IApplicationSettings").tjb?
a.resolve("PowerPointWebEditor.IPPTRumTracker"):null;f=f&&!c;a.register(uv,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().oa(()=>new uv(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f,l));a.register(358,"PowerPointWebEditor.IModeSwitcherControlActor").ma().oa(()=>new iG(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),db.a.get_instance(),l));a.register(359,"PowerPointWebEditor.IRibbonUser").ma().oa(()=>{const w=a.resolve("PowerPointWebEditor.IApplicationSettings"),H=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var U={};H.bqd(U);var ja={};H.mgl(ja);U=new eG(U,H.qoj(),ja);ja=new hG;const wa=a.resolve("Common.IAppSettingsManager"),Sa=new jH(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").xa,
a.resolve("PowerPoint.IPathManager"),a.Ja("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.rb("PowerPointWebEditor.Core.IBundleMetricRecorder"),H,U,w,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),ja,l,wa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(Ya.a)(108,wa)?wa:null,wa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1),u.AFrameworkApplication.kIb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"));w.QNf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").azb(()=>{Sa.kfg()}):Sa.kfg();return Sa});a.register(360,"Common.IRibbonExternal").ma().oa(()=>a.resolve("PowerPointWebEditor.IRibbonUser").b5k);a.register(361,"PowerPointWebEditor.IRibbonChangeManager").ma().oa(()=>new kH(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").xd(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(hB,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().oa(()=>new hB(a.resolve("CommonUI.IBusinessBar"),new fG,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IErrorMapping"),u.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.PresentationContext")));a.register(362,"PowerPointWebEditor.IBusinessBarPane").ma().oa(()=>new kG(a.Ja("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").goc));a.register(vq,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().oa(()=>new vq(a.resolve("PowerPointWebEditor.IBusinessBarPane").xMl));
a.register(363,"Common.IRibbonSQMInformation").ma().oa(()=>{const w=new qG(u.AFrameworkApplication.Ta);w.PWk();return w});a.register(364,"PowerPointWebEditor.IInkRibbonManager").ma().oa(()=>{const w=a.resolve("PowerPointWebEditor.IApplicationSettings");return new wq(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.AFrameworkApplication.Aa.hb.s9,w)})}init(){this.EHa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");
this.K.resolve("PowerPointWebEditor.BusinessBarController").LFk();this.gl=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.gl.initialize();u.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.Ja("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),b=this.K.resolve("PowerPointWebEditor.IPaneManager");
var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").toc?(c=document.getElementById("BusinessBarRegion"),b.CPa(a,c,null)):c?b.CPa(a,this.K.resolve("PowerPointWebEditor.AppFrame").c2,c):b.RP(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.gl&&this.gl.dispose();this.EHa&&this.EHa.dispose()}static main(){v.a.instance.Dc(new MB)}}Object(n.a)(MB,"PPTWebEditorRibbonPackage",null,
[2,3]);var mx=d(676);class mH{get name(){return"Box4.Insights"}init(){}dispose(){}Zb(a){a.register(mx.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().oa(()=>new mx.a)}}Object(n.a)(mH,"Box4InsightsPackage",null,[2,3]);class NB{constructor(a,b){this.oHd=0;this.Uha=new Ka.a;this.Ca=a;this.nd=b}get Wc(){return this.nd}get fee(){return 0<this.oHd}G5(a){this.elg(a)&&this.oHd++;this.fee?this.Wc.enabled=!1:this.Uha.add(this.Wc.Wp(a.actionId))}F5(a){!this.fee&&
0<this.Uha.count&&(this.Uha.ga(this.Uha.count-1),this.qSf(this.Uha.count-1));this.elg(a)&&this.oHd--;this.fee||(this.Wc.enabled=!0)}qSf(a){if(0<this.Uha.count&&0<=a&&a<this.Uha.count){const b=this.Uha.ga(a);this.Uha.removeAt(a);b.end()}}yvi(){let a=this.Uha.count-1;for(;0<=a;){var b=this.Uha.ga(a);(b=this.Ca.hT(b.activityName))&&b.flags[128]&&this.qSf(a);a--}}elg(a){if(2!==a.behavior)return!0;a=this.Ca.hT(a.actionId);return!!a&&a.flags[32]}}Object(n.a)(NB,"ActivityActionListener",null,[145]);var gz;
(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=2]="appError"})(gz||(gz={}));Object(n.b)("ActivityAutoEndReason",gz);class OB{constructor(a){this.nia=new Ci.a;this.tQb=a}cii(){for(let a of this.nia.keys)this.dii(a)}zYf(a){if(this.tQb.qIc)for(let b of this.nia.keys){const c=Array.clone(this.nia.ga(b));for(let f=0;f<c.length;f++){const l=c[f];l.d5d();this.Dgh(b,a,l.uniqueID)}}}dii(a){var b=this.nia.ga(a);b=this.Ddj(b);for(let c=0;c<b.length;c++){const f=b[c];f.d5d();this.Dgh(a,
0,f.uniqueID)}}Ddj(a){const b=[];for(let c=0;c<a.length;c++){const f=a[c];(new Date).getTime()-f.startTime>f.ZYg&&Array.add(b,f)}return b}Dgh(a,b,c){const f={};f.AID=c;f.A=a;f.AE=gz[b];Nc.a.instance.Xb("AutoEnded",f)}dhl(){if(this.tQb.qIc){var a=new Le.a(2,2,this.tQb.eii,Object(F.a)(this,this.cii,"autoEndLongRunningActivities"),67);u.AFrameworkApplication.ye.Db(a)}}register(a){if(this.tQb.qIc){var b=a.activityName;this.nia.Gb(b)&&this.nia.ga(b)||this.nia.$(b,[]);Array.add(this.nia.ga(b),a)}}unregister(a){if(this.tQb.qIc){var b=
a.activityName;this.nia.Gb(b)&&this.nia.ga(b)&&Array.remove(this.nia.ga(b),a)}}}Object(n.a)(OB,"ActivityAutoEndHelper",null,[429]);class Yt{constructor(a){this.d8e=null;this.lBc=0;this.gBd=this.yG=!1;this.zNd=0;this.Vx=new Vc.a;this.ewb=new Vc.a;this.FNh=a}get FOd(){return this.d8e||(this.d8e=this.FNh())}get properties(){return this.Vx}get ZYg(){return this.lBc}get enabled(){return this.yG}get ended(){return this.gBd}get uniqueID(){return this.zNd}wYg(){const a={};a.ID=this.uniqueID;a.A=this.activityName;
a.ST=this.startTime;a.ET=this.endTime;Ma.Ct(this.properties.keys)&&(a.P=Yt.j6f(this.properties));Ma.Ct(this.ewb.keys)&&(a.FP=Yt.j6f(this.ewb));return a}static j6f(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(n.a)(Yt,"AActivity",null,[451,452]);class PB extends Yt{constructor(a,b,c,f,l,w,H,U){super(H);this.It=0;this.HNh=a;this.bSh=b;this.Xga=c;this.Dj=(new Date).getTime();this.PXh=f;this.nxd=w;this.lBc=l;this.nxd.register(this);this.zNd=U()}get activityName(){return this.Xga}get startTime(){return this.Dj}get endTime(){return this.It}zSf(a){this.It=
(new Date).getTime();this.ended?this.xTk():(this.gBd=!0,this.It=(new Date).getTime(),this.It<this.Dj&&(ka.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.It,this.Dj,this.Xga)),this.It=this.Dj),this.nxd.unregister(this),this.PXh&&(!a&&this.FOd&&this.FOd.enabled?this.rrb():this.N0b()))}end(){this.zSf(!1)}d5d(){this.zSf(!0)}xTk(){const a={};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.bSh("AlreadyEnded",
this.endTime,a)}rrb(){this.FOd.rrb()}N0b(){this.HNh(this.wYg())}cancel(){this.ended||(this.gBd=!0,this.nxd.unregister(this))}}Object(n.a)(PB,"ActivityImpl",Yt,[]);class nH extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(n.a)(nH,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class Zt{constructor(a,b,c){this.Pa=new vc.a;this.yG=!0;this.settings=a;this.oxd=b;this.sxd=c}get enabled(){return this.yG&&this.settings.enabled}set enabled(a){this.yG=a}Wp(a,b=-1){-1===b&&(b=
this.settings.ZKi);return this.oxd(Object(F.a)(this,this.N0b,"completeActivity"),Object(F.a)(this,this.Egh,"recordEventInternal"),a,this.RJj(a.toString()),b)}Xb(a,b=null){this.Egh(a,(new Date).getTime(),b);this.Pa.raiseEvent("HHR",Object.assign(new nH,{name:a,properties:b}))}Egh(a,b,c){this.ajg(a)&&(a=this.e7f(a,c,b),ka.ULS.sendTraceTag(6068304,213,100,a))}eoa(a,b=null){this.ajg(a.toString())&&(a=this.e7f(a.toString(),b,(new Date).getTime()),ka.ULS.sendTraceTag(6415520,213,100,a))}RJj(a){return this.enabled&&
!this.SJj(a)}ajg(a){return this.enabled&&!this.dOj(a)}SJj(a){return this.settings.eOi.contains(a)}dOj(a){return this.settings.fOi.contains(a)}N0b(a){if(this.sxd.NDf(a.A.toString())){var b=[];Array.add(b,a);a=Jc.c(b);ka.ULS.sendTraceTag(5894867,213,100,a)}}e7f(a,b,c){const f={};f.ID=Zt.K5d();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return Jc.c(a)}static K5d(){return Zt.O3h++}}Zt.O3h=0;Object(n.a)(Zt,"ActivityManagerImpl",null,[428]);class Zo{constructor(){this.yG=!1;this.daf=this.O8e=0;this.N8e=
!1;this.Jaf=new To.a;this.Kaf=new To.a}$3b(a){this.yG=Boolean.parse(a[Zo.YNj]||"false");this.Jaf=this.g$g(a[Zo.dOi]);this.Kaf=this.g$g(a[Zo.gOi]);this.PVi(a)}get enabled(){return this.yG}get eOi(){return this.Jaf}get fOi(){return this.Kaf}PVi(a){this.N8e=Boolean.parse(a[Zo.SKj]||"false");this.O8e=parseInt(a[Zo.fii]||"60000");this.daf=parseInt(a[Zo.$Ki]||"5000")}get eii(){return this.O8e}get ZKi(){return this.daf}get qIc(){return this.N8e}g$g(a){const b=new To.a;for(const c of(a||"").split(","))""!==
c&&b.add(c);return b}}Zo.YNj="ActivityLoggingIsEnabled";Zo.dOi="DisabledClientActivityNames";Zo.gOi="DisabledClientActivityEventNames";Zo.SKj="ActivityAutoEndEnabled";Zo.fii="ActivityAutoEndTaskInterval";Zo.$Ki="ActivityDefaultMaxDuration";Object(n.a)(Zo,"ActivitySettings",null,[427]);class vv{constructor(a){this.CAd=new To.a;this.BWb=new Vc.a;this.gFc=a;this.ehl()}ehl(){this.gFc.enabled&&(vv.sqf=new Le.a(2,2,this.gFc.interval,Object(F.a)(this,this.uPi,"doThrottle"),65),u.AFrameworkApplication.ye.Db(vv.sqf))}uPi(){this.t3k()}t3k(){this.BWb=
new Vc.a;this.CAd=new To.a}TJj(a){return this.CAd.contains(a)}jAl(a){if(this.BWb.Gb(a)){if(this.BWb.ga(a)>=this.gFc.cmk)return this.CAd.add(a),ka.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.BWb).$(a,b.ga(a)+1)}else this.BWb.add(a,1);return!0}NDf(a){return this.gFc.enabled?!this.TJj(a)&&this.jAl(a):!0}}vv.sqf=null;Object(n.a)(vv,"ActivityThrottler",null,[426]);class Ur{constructor(){this.yG=!1;this.Tef=this.Yif=0}$3b(a){this.yG=Boolean.parse(a[Ur.K1d]||
"false");this.Yif=parseInt(a[Ur.dmk]||"600");this.Tef=parseInt(a[Ur.IIj]||"600000")}get enabled(){return this.yG}get cmk(){return this.Yif}get interval(){return this.Tef}}Ur.K1d="ActivityThrottlerEnabled";Ur.dmk="ActivityThrottlerMaxActivities";Ur.IIj="ActivityThrottlerInterval";Object(n.a)(Ur,"ActivityThrottlerSettings",null,[425]);class QB{constructor(){this.Da=null}get name(){return"Common.App.Activities"}init(){this.mFj()}mFj(){const a=this.Da.resolve("Common.App.Activities.IActivitySettings"),
b=u.AFrameworkApplication.fa.appSettings;a.$3b(b);this.Da.resolve("Common.App.Activities.IActivityThrottlerSettings").$3b(b);if(a.enabled){Nc.a.instance=new Zt(this.Da.resolve("Common.App.Activities.IActivitySettings"),(l,w,H,U,ja)=>new PB(l,w,H,U,ja,this.Da.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Da.rb("Common.App.Activities.IActivityAggregationManager"),Zt.K5d),this.Da.resolve("Common.App.Activities.IActivityThrottler"));var c=this.Da.resolve("Common.App.Activities.ActivityAutoEndHelper"),
f=this.Da.resolve("Common.App.Activities.ActivityActionListener");c.dhl();u.AFrameworkApplication.vga(()=>{f.yvi();c.zYf(1)});u.AFrameworkApplication.Ta.paa(f);u.AFrameworkApplication.RGc((l,w)=>{Nc.a.instance.eoa(w.errorCode,{["ErrorCause"]:w.w2d,["ErrorResolution"]:w.x2d});c.zYf(2)})}}dispose(){}Zb(a){this.Da=a;a.register(Zo,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(OB,"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().oa(()=>
new OB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(NB,"Common.App.Activities.ActivityActionListener").oa(()=>new NB(u.AFrameworkApplication.Ta,a.resolve("Common.IActivityManager")));a.register(Ur,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().oa(()=>new Ur);a.register(vv,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().oa(()=>new vv(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){v.a.instance.Dc(new QB)}}
Object(n.a)(QB,"ActivitiesPackage",null,[2,3]);class oH{constructor(){this.Ipa=new Vc.a}zVe(a,b){this.Ipa.$(a,b)}U5d(a){({value:a}=this.Ipa.Tf(a));return a}}Object(n.a)(oH,"AggregationMethodsForActivityName",null,[]);class RB{constructor(){this.RCc=new Ci.a;this.Ipa=new Ci.a}zVe(a,b,c){this.Ipa.Gb(a)&&this.Ipa.ga(a)||this.Ipa.$(a,new oH);this.Ipa.ga(a).zVe(b,c)}U5d(a,b){return this.Ipa.Gb(a)&&this.Ipa.ga(a)?this.Ipa.ga(a).U5d(b):null}l6b(a){this.RCc.Gb(a)&&this.RCc.ga(a)||this.RCc.$(a,new To.a);return this.RCc.ga(a)}yKi(a,
b){this.l6b(a).add(b)}}Object(n.a)(RB,"ActivityAggregationInfo",null,[433]);class nx extends Yt{constructor(a,b){super(a);this.zNd=(this.GNh=b)?b.laj():Zt.K5d()}get uia(){return this.GNh}get activityName(){return this.uia.name}get startTime(){return this.uia.startTime}get endTime(){return this.uia.endTime}end(){}cancel(){}d5d(){}rFl(){this.ewb.$("AM",this.uia.mode.toString());this.ewb.$("C",this.uia.count.toString());this.ewb.$("DA",this.uia.fRf.toFixed(2));this.ewb.$("DV",this.uia.CQi.toFixed(2))}V9d(a){return this.uia.V9d(a)}u$d(){return this.uia.u$d()}rrb(){for(let a of this.uia.via)a.rrb()}}
Object(n.a)(nx,"AggregatedActivity",Yt,[]);class pH{constructor(a,b){this.Gxd=0;this.Xga=a;this.Sza=b}aei(a,b){this.Gxd=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.bei(c)}}bei(a){const b=Object(qa.a)(nx,a);if(b)if(1===this.Gxd)this.Ydi(b);else if(2===this.Gxd){this.cei(b);for(let c of this.Sza.l6b(this.Xga)){const f=b.uia.via.ga(0);f.properties.Gb(c)&&a.properties.$(c,f.properties.ga(c))}}}Ydi(a){for(let b of this.Sza.l6b(this.Xga))this.tnh(a,b)}cei(a){for(let b of a.u$d())this.tnh(a,b)}tnh(a,b){const c=
this.Sza.U5d(this.Xga,b);if(c){const f=a.V9d(b);a.properties.$(b,c(f))}}}Object(n.a)(pH,"PropertyAggregationHelper",null,[]);class SB{constructor(a,b,c,f,l){this.Tmb=a;this.Sza=b;this.w$e=l;this.sxd=f;this.sWh=c}get wsf(){return this.sWh.value}N0b(a){if(Object(Ya.a)(PB,a))a.N0b();else if(Object(Ya.a)(nx,a)&&this.sxd.NDf(a.activityName.toString())){a=Object(qa.a)(nx,a);a.rFl();a=a.wYg();var b=[];Array.add(b,a);a=Jc.c(b);ka.ULS.sendTraceTag(6907266,213,50,a)}}cZb(a,b){const c=(new Date).getTime();var f=
this.w$e.list.ga(a);const l=({dei:f}=this.f4i(f)).returnValue;this.w$e.list.$(a,new Ka.a);b&&(f=this.BCi(f,c,this.Tmb.m$f));0<f.count&&(new pH(a,this.Sza)).aei(f,l)}BCi(a,b,c){const f=new Ka.a;for(let l=0;l<a.count;l++){const w=a.ga(l);w.startTime>b-c?w.rrb():f.add(w)}return f}f4i(a){const b=this.wsf.UCh(a);a=this.wsf.gxl(a);const c=this.eei(b,a);return{returnValue:c,dei:1===c?b:a}}eei(a,b){return a.count*this.Tmb.k_g<b.count?1:2}get enabled(){return this.Tmb.enabled}rrb(){}}Object(n.a)(SB,"ActivityAggregationManager",
null,[432]);class Eo{constructor(a){this.enabled=!1;this.fZg=500;this.RZg=2;this.Wsd=6E4;this.k_g=5;this.m$f=3E4;this.$3b(a.appSettings)}$3b(a){this.enabled=Boolean.parse(a[Eo.K1d]||"false");this.fZg=parseInt(a[Eo.smk]||"500");this.RZg=parseInt(a[Eo.Fnk]||"2");this.Wsd=parseInt(a[Eo.xvl]||"60000");this.k_g=parseInt(a[Eo.Unk]||"5");this.m$f=parseInt(a[Eo.Sqj]||"30000")}}Eo.K1d="ActivityAggregationEnabled";Eo.smk="ActivityAggregationMaxInterval";Eo.Fnk="ActivityAggregationMinChain";Eo.xvl="ActivityAggregationTaskInterval";
Eo.Unk="ActivityAggregationModeFactor";Eo.Sqj="ActivityAggregationGraceWindow";Object(n.a)(Eo,"ActivityAggregationParams",null,[]);class TB{constructor(a,b){this.Sza=a;this.e8e=b}UCh(a,b=1){if(!a||!a.count)return a;const c=new Ka.a;var f=null;for(let l=0;l<a.count;l++){const w=a.ga(l);if(!w)continue;const H=w.activityName;f?f.UYj(w)?f.add(w):(f=f.process(),c.addRange(f),f=this.e8e(H,b),f.add(w)):(f=this.e8e(H,b),f.add(w))}f&&(a=f.process(),c.addRange(a));return c}gxl(a){if(!a||!a.count)return a;const b=
{};var c=null;for(let l=0;l<a.count;l++){const w=a.ga(l);if(w){if(!c){c=new Ka.a;var f=this.Sza.l6b(w.activityName);for(let H of f)c.add(H)}f=this.thj(w,c);null!==f&&(f in b&&b[f]||(b[f]=new Ka.a),b[f].add(w))}}a=new Ka.a;for(const l of pa.a.nL(b))c=this.UCh(b[l],2),a.addRange(c);return a}thj(a,b){let c="";for(let f of b)c+=f,c=a.properties.Gb(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(n.a)(TB,"ActivityAggregationSchemes",null,[431]);
class qH{constructor(a,b,c,f,l){this.It=this.Dj=0;this.Tmb=c;this.oxd=f;this.Sza=l;this.name=a;this.Sy=b;this.via=new Ka.a}get mode(){return this.Sy}get count(){return this.via.count}get startTime(){return this.Dj}get endTime(){return this.It}get fRf(){if(!this.count)return 0;let a=0;for(let b of this.via)a+=b.endTime-b.startTime;return a/this.count}get CQi(){if(!this.count)return 0;let a=0;const b=this.fRf;for(let c of this.via){const f=c.endTime-c.startTime;a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?
this.It=a.endTime>this.endTime?a.endTime:this.endTime:(this.Dj=a.startTime,this.It=a.endTime);this.via.add(a)}UYj(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.Tmb.fZg}process(){if(this.count>=this.Tmb.RZg){const a=new Ka.a,b=this.oxd(this);a.add(b);return a}return this.via}V9d(a){const b=new Ka.a;for(let c of this.via)if(c.properties.Gb(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}u$d(){const a=this.Sza.l6b(this.name),b=new To.a;for(let c of this.l4i())a.contains(c)||
b.add(c);return b}l4i(){const a=new To.a;if(!this.via)return a;for(let b of this.via)for(let c of b.properties.keys)a.add(c);return a}laj(){return this.via.ga(0).uniqueID}}Object(n.a)(qH,"ActivityCollection",null,[430]);class UB{constructor(){this.B2a=new Ci.a}get list(){return this.B2a}add(a){const b=a.activityName;if(this.B2a.Gb(b)&&this.B2a.ga(b)){const c=this.Jbj(this.B2a.ga(b),a);this.B2a.ga(b).insert(c,a)}else this.B2a.$(b,new Ka.a),this.B2a.ga(b).add(a)}Jbj(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>
a.ga(c).startTime)return c+1;return 0}}Object(n.a)(UB,"CompletedActivitiesHelper",null,[424]);class VB{constructor(){this.Da=null}get name(){return"Common.App.ActivityAggregator"}init(){u.AFrameworkApplication.vga(()=>{this.Da.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Zb(a){this.Da=a;const b=f=>new nx(()=>a.rb("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new qH(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));
a.register(SB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().oa(()=>new SB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.ke("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(Eo,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().oa(()=>
new Eo(u.AFrameworkApplication.fa));a.register(RB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().oa(()=>new RB);a.register(TB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().oa(()=>new TB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(UB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().oa(()=>new UB)}static main(){v.a.instance.Dc(new VB)}}
Object(n.a)(VB,"ActivityAggregatorPackage",null,[2,3]);var rH=d(16);class $q{constructor(){this.l5k="getAddinShortcutsPreference";this.m5k="saveAddinShortcutsPreference";this.n5k="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Z3i=6E4;this.hed=this.p8=this.RY=null}H6f(a){return String.format(this.n5k,u.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",a,u.AFrameworkApplication.hh)}executeRequest(a,b,c,f,l=null){return $q.yca.krb(a,b,l,null,2,c,f,!1,null,this.Z3i)}saveSetting(a,
b,c,f,l){return this.zoh(a,b,c,null,f,l)}startBatchUpdateScope(){this.hed=[]}saveShortcutInfoArrayBatch(a,b,c){this.b7k(c,a,b)}b7k(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.TOd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;b=new rH.a(c.toString(),a);this.hed.push(b)}commitBatchUpdateScope(){return this.Erc()?this.d7k().then(()=>{this.Hsb();return Promise.resolve(!0)}):
this.f7k().then(()=>{this.Hsb();return Promise.resolve(!0)})}d7k(){return this.getSetting().then(a=>{let b=null;if(a&&!({sv:b}=Jc.d(a)).returnValue)return ka.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.hed){(a=b[c.key])||(a={});const f=c.value;for(const l of pa.a.nL(f))a[l]=f[l];b[c.key]=a}this.RY=b;try{return localStorage.setItem("AddinShortcutPreferenceData",Jc.c(b)),Promise.resolve(!0)}catch(c){return ka.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}f7k(){return this.l$k().then(a=>this.Nnd(a))}l$k(){return this.A$d().then(a=>{let b=null;a&&(({sv:b}=Jc.d(a)).returnValue||ka.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));b||(b={});for(const c of this.hed){(a=b[c.key])||(a={});const f=c.value;for(const l of pa.a.nL(f))a[l]=f[l];b[c.key]=a}this.RY=b;return Jc.c(b)})}saveShortcutInfoArray(a,
b,c){return this.zoh(0,"","",c,a,b)}zoh(a,b,c,f,l,w){const H=this.Erc(),U={};U.action=c;U.addinId=b;U.ownerType=a;U.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),w.toString());0===a&&f?(U.shortcutInfoArray=f,this.TOd(l,w,f)):b&&(U.shortcutInfoArray=b);a={};a[l.toString()]=U;l=new rH.a(w.toString(),a);return H?this.c7k(l):this.e7k(l)}c7k(a){return this.getSetting().then(b=>{let c=null;if(b&&!({sv:c}=Jc.d(b)).returnValue)return ka.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.RY=c;try{return localStorage.setItem("AddinShortcutPreferenceData",Jc.c(c)),Promise.resolve(!0)}catch(f){return ka.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",f),Promise.resolve(!1)}})}e7k(a){return this.k$k(a).then(b=>this.Nnd(b))}k$k(a){return this.A$d().then(b=>{let c=null;b&&(({sv:c}=Jc.d(b)).returnValue||ka.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
c||(c={});c[a.key]=a.value;this.RY=c;return Jc.c(c)})}saveSettings(a){this.RY=Jc.a(a);this.Hsb();return this.Erc()?this.Aoh(a):this.Nnd(a)}Aoh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return ka.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}Nnd(a){const b={};b.Wac=a;const c=Jc.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.H6f(this.m5k),
2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.Vn||l.rm)ka.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var w=l.result;void 0!==w.Yi&&null!==w.Yi&&void 0!==w.Yi.data&&null!==w.Yi.data&&w.Yi.data.ie===Nk.a.Wv?f(!0):f(!1)}})}}catch(w){ka.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",w.toString()),f(!1)}})}getSetting(){const a=this.Erc();return this.RY?Promise.resolve(Jc.c(this.RY)):a?this.ekj():
this.A$d()}Erc(){const a=u.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=u.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}ekj(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return ka.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}A$d(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.H6f(this.l5k),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.Vn||c.rm)ka.ULS.sendTraceTag(522739862,
0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.Yi&&f.Yi.data?f.Yi.data.ie!==Nk.a.Wv?ka.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.Yi.data.ie):f.Yi.data.Wd?(f=Jc.a(f.Yi.data.Wd),f.Wac&&(l=f.Wac)):ka.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):ka.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){ka.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",
c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.Erc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=Jc.a(f));if(!l)return ka.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const w of pa.a.nL(l)){f=l[w.toString()];for(const H of pa.a.nL(f)){const U=f[H];if(U.addinId===a)delete f[H.toString()];else if(0===U.ownerType&&U.shortcutInfoArray){const ja=U.shortcutInfoArray,wa=new Ka.a;
for(let Sa=0;Sa<ja.length;++Sa)ja[Sa].addinId!==a&&wa.add(ja[Sa]);U.shortcutInfoArray=wa.toArray()}}pa.a.count(f)||delete f[w]}c.RY=l;c.bYk(a);return b?c.Aoh(Jc.c(l)):c.Nnd(Jc.c(l))})}Hsb(){if(this.RY){this.p8=null;const c=this.RY;for(let f in c){var a=f;const l=c[f];for(let w in l){var b=w;const H=l[w];H.shortcutInfoArray&&this.TOd(parseInt(b),parseInt(a),H.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({sv:b}=Jc.d(a)).returnValue)return ka.ULS.sendTraceTag(522739868,
0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.RY=b;this.Hsb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.RY&&(c=this.RY[c])&&(b=c[b])&&b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.RY&&(b=this.RY[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,
b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.Hsb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.p8)return Promise.resolve(!0);var c=this.p8[a];if(!c)return Promise.resolve(!0);var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let w=0;for(const H of l){if(H.addinId===a&&H.action===b)break;++w}if(w>=l.length)return Promise.resolve(!0);l.splice(w,
1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.Hsb();return Promise.resolve(!0)})}TOd(a,b,c){this.p8||(this.p8={});for(const f of c){c=f.addinId;const l=f.action;let w=this.p8[c];w||(w={});const H={};H.modifiers=a;H.keyCode=b;w[l]=H;this.p8[c]=w}}bYk(a){a in this.p8&&delete this.p8[a]}isActionCustomized(a,b){return this.p8&&(a=this.p8[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.p8&&(a=this.p8[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.RY}static instance(){$q.zQd||
(ka.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),$q.zQd=new $q,$q.yca=u.AFrameworkApplication.Ke);return $q.zQd}}$q.zQd=null;$q.yca=null;Object(n.a)($q,"AddinShortcutsPreferenceSettingHelper",null,[]);class sH{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=
this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(n.a)(sH,"BrowserInfo",null,[]);class tH{constructor(){this.Version=this.Name=null}}Object(n.a)(tH,"PluginInfo",null,[]);class ik{static o4j(){if(u.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=
ik.l2i();try{const b=JSON.stringify(a);ka.ULS.sendTraceTag(6903563,102,50,b)}catch(b){ka.ULS.sendTraceTag(6903564,102,15,b.message)}}else ka.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static Igj(){const a=window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new tH,{Name:f,Version:l}))}return b}static l2i(){const a=new sH,b=new Sys.StringBuilder;ik.XA(c=>{a.DocElemClientHeight=
c},()=>document.documentElement.clientHeight,b);ik.XA(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);ik.XA(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);ik.XA(c=>{a.DocElemOffsetWidth=c},()=>document.documentElement.offsetWidth,b);ik.XA(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);ik.XA(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);ik.XA(c=>{a.ScreenWidth=c},()=>window.screen.width,b);ik.XA(c=>{a.ScreenHeight=c},()=>window.screen.height,
b);ik.XA(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);ik.XA(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);ik.XA(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);ik.XA(c=>{a.ScreenDeviceYdpi=c},()=>window.screen.deviceYDPI,b);ik.XA(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);ik.XA(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);ik.XA(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);ik.XA(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);
ik.XA(c=>{a.WinOrientation=c},()=>window.self.orientation,b);ik.XA(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);ik.XA(c=>{a.SupportsTouch=c},()=>B.a.ELa,b);ik.XA(c=>{a.NavAppName=c},()=>window.navigator.appName,b);ik.XA(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);ik.XA(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);ik.XA(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);ik.XA(c=>{a.NavPlatform=c},()=>window.navigator.platform,
b);ik.XA(c=>{a.NavPlugins=c},ik.Igj,b);ik.XA(c=>{a.CalculatedDevicePixelRatio=c},()=>ik.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/window.screen.logicalXDPI:a}static XA(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(n.a)(ik,"BrowserInfoLogger",null,[]);class WB{get name(){return"Common.App.BrowserInfoLogger"}Zb(){}init(){ik.o4j()}dispose(){}static main(){v.a.instance.Dc(new WB)}}
Object(n.a)(WB,"BrowserInfoLoggerPackage",null,[2,3]);class XB{get name(){return"Common.App.DialogWithLinkToResource"}Zb(){}init(){}dispose(){}static main(){v.a.instance.Dc(new XB)}}Object(n.a)(XB,"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var mQ=d(714);class YB{get name(){return"Common.App.EventsCachePackage"}Zb(){}init(){mQ.a.instance.init()}dispose(){}static main(){v.a.instance.Dc(new YB)}}Object(n.a)(YB,"EventsCachePackage",null,[2,3]);class ZB{constructor(a,b,c){this.i5a=null;this.$d=
a;this.Ca=b;this.Gcf=c.create()}xoc(){this.i5a?ka.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(ka.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.i5a=new Le.a(2,1,3E4,Object(F.a)(this,this.crd,"showFloatPane"),67),this.$d.Db(this.i5a))}crd(){this.i5a=null;ka.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Gcf.display()}Sxa(){this.Ca.ya(G.a.crd,Xd.a.frame,Object(F.a)(this,this.Cml,
"showFloatPaneHandler"))}Cml(a,b,c,f,l){return a!==G.a.crd?2:1===c?32:2===c&&l?(ka.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",l),l?this.xoc():(this.i5a?(ka.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.$d.Mg(this.i5a)):(ka.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Gcf.remove(null)),this.i5a=null),32):8}}Object(n.a)(ZB,"FloatPaneActor",null,[418]);class uH{constructor(a,b,c,f,
l){this.aGd=this.iTb=this.sDc=this.aBa=this.F2=this.aAa=this.Ayd=this.CZ=this.EVb=this.IUb=this.JUb=this.NBd=null;this.$d=b;this.$a=a;this.Nn=c;this.Da=l;this.Zga=f}tKf(){this.CZ=document.createElement("div");this.CZ.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.CZ.style.width=this.F2.width+"px";(this.aGd=this.ufj(this.Zga))?(this.aBa=document.createElement("a"),this.aBa.setAttribute(Bc.a.af,Bc.a.pN),this.Nn.pb(sa.a.click,this.aBa,Object(F.a)(this,this.j6g,"onRedirectClick")),
this.aBa.href=this.aGd,this.aBa.target="_blank",this.aBa.appendChild(this.F2),this.CZ.appendChild(this.aBa)):this.CZ.appendChild(this.F2);this.aAa=document.createElement("a");this.aAa.setAttribute(Bc.a.af,Bc.a.Au);this.aAa.className="StandardButton WACFloatPaneCloseButton";this.aAa.title=CommonUIStrings.l_Close;this.aAa.tabIndex=-1;this.Ayd=wp.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Ayd.setAttribute(Bc.a.af,Bc.a.pN);
this.aAa.appendChild(this.Ayd);this.Nn.pb(sa.a.click,this.aAa,Object(F.a)(this,this.onClose,"onClose"));this.CZ.appendChild(this.aAa);this.EVb.appendChild(this.CZ)}rk(a){const b=this.$a.ka("O365PromotionHasStarted");switch(a){case 2:return vp.a.ZK(String.format("adppt{0}.png",b?"sale":""));case 1:return vp.a.ZK(String.format("adxls{0}.png",b?"sale":""));case 3:return vp.a.ZK(String.format("addoc{0}.png",b?"sale":""))}return null}ufj(a){const b=this.$a.Ga("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,
"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.iTb=null;this.CZ&&!this.sDc&&(a?ka.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):ka.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.CZ.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.CZ.style.height="0px",this.sDc=new Le.a(2,1,1E3,Object(F.a)(this,this.remove,"remove"),67),this.$d.Db(this.sDc))}remove(){this.CZ&&
this.EVb&&(this.aBa&&this.Nn.yb(sa.a.click,this.aBa,Object(F.a)(this,this.j6g,"onRedirectClick")),this.Nn.yb(sa.a.click,this.aAa,Object(F.a)(this,this.onClose,"onClose")),this.EVb.removeChild(this.CZ),this.CZ=null);this.sDc=null}display(){if(this.NBd=this.Da.rb("Common.IFloatPaneContainer"))if(this.EVb=this.NBd.container){var a=this.rk(this.Zga);a?(ka.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.F2=document.createElement("img"),this.F2.className="WACFloatPaneImage",
this.JUb=Object(F.a)(this,this.owk,"onLoadImageFinish"),Yc.a.addHandler(this.F2,sa.a.load,this.JUb),this.IUb=Object(F.a)(this,this.nwk,"onLoadImageError"),Yc.a.addHandler(this.F2,sa.a.error,this.IUb),this.F2.src=a):ka.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else ka.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else ka.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}owk(){const a=
this.$a.Bc("O365AdPaneShowingDuration",60);this.tKf();this.CZ.style.display="block";this.CZ.style.height=this.F2.height+"px";this.iTb=new Le.a(2,1,1E3*a,Object(F.a)(this,this.hide,"hide"),67);this.$d.Db(this.iTb);this.wih()}nwk(){ka.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.wih();this.F2=null}wih(){this.JUb&&this.F2&&Yc.a.removeHandler(this.F2,sa.a.load,this.JUb);this.JUb=null;this.IUb&&this.F2&&Yc.a.removeHandler(this.F2,sa.a.error,this.IUb);
this.IUb=null}j6g(){ka.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.iTb&&this.$d.Mg(this.iTb);this.hide();return!0}dispose(){this.hide()}}Object(n.a)(uH,"FloatPane",null,[449]);class $B{constructor(a,b,c,f,l){this.$d=b;this.$a=a;this.Nn=c;this.Da=l;this.Zga=f}create(){return new uH(this.$a,this.$d,this.Nn,this.Zga,this.Da)}}Object(n.a)($B,"FloatPaneFactory",null,[417]);class aC{constructor(){this.Da=null}get name(){return"Common.App.FloatPane"}get Djg(){return u.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&
u.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.Djg&&(ka.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").xoc(),ka.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").Sxa())}Zb(a){this.Da=a;this.Djg&&(this.Da.register($B,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").oa(()=>
new $B(u.AFrameworkApplication.fa,u.AFrameworkApplication.ye,Ed.a.instance,u.AFrameworkApplication.Aa.hb.Uk,this.Da)).ma(),this.Da.register(ZB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").oa(()=>new ZB(u.AFrameworkApplication.ye,u.AFrameworkApplication.Ta,this.Da.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){v.a.instance.Dc(new aC)}}Object(n.a)(aC,"FloatPanePackage",null,[2,3]);const vH=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);
0>a&&(a+=2*Math.PI);return a};class nQ{constructor(a,b,c){this.IP=this.cob=this.Aqb=null;this.Vza=this.Wzd=this.Opa=0;this.BG=this.lAc=this.Yyc=this.Xyc=!1;this.iDd=this.Bef=this.Def=0;this.RNa=a;this.Ca=b;this.JZ=c}Dv(a){return Pc.App.Kb.Ld.isEditingAllowed?""!==this.nTc(a.Ec):!1}Uu(a){if(!this.Dv(a))return!1;this.Vza=this.RNa.xOl();this.pel(a);this.qel();({Eke:this.lAc,nne:this.BG}=this.jsh(this.Wzd));this.tel();this.Aqb=a.KE;this.IP=new Sys.UI.Point(0,0);({width:this.Def,height:this.Bef}=this.RNa.LSc());
ka.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}Gw(a){this.cob=a.KE;this.cpi();var b=this.IP.x,c=this.IP.y;a=this.Def;var f=this.Bef,l=this.lAc,w=this.BG,H=1;(b||c)&&a&&f&&(l&&w?(H=a+b,l=f+c,b=1/a,c=1/f,w=b>c?b:c,1>H?H=1:1920<H&&(H=1920),1>l?l=1:1280<l&&(l=1280),b=H-a,c=l-f,H=Math.abs(b/a)>Math.abs(c/f)?H/a:l/f,H<w&&(H=w)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),H=b/a):w&&(b=f+c,1>b?b=1:1280<b&&(b=1280),H=b/f));a=H;this.iDd=a;this.RNa.rQl(this.iDd,this.lAc,this.BG);return!0}fo(){this.lh();
ka.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}pu(){this.RNa.GPl();ka.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}qel(){this.Wzd=(Math.floor((this.Vza+22)/45)%8+this.Opa)%8}jsh(a){let b,c;if(this.Vza&&90!==this.Vza&&180!==this.Vza&&270!==this.Vza&&360!==this.Vza||this.qQj(a))return{Eke:!0,nne:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{Eke:b,nne:c}}tel(){this.Yyc=this.Xyc=!1;switch(this.Wzd){case 0:this.Yyc=this.Xyc=!0;break;case 1:case 2:this.Yyc=
!0;break;case 7:case 6:this.Xyc=!0}}qQj(a){return!(a%2)}nTc(a){var b=a.className;-1===b.indexOf("WACImageResizeHandle")&&a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}pel(a){switch(this.nTc(a.Ec)){case "WACImageResizeHandleNW":this.Opa=0;break;case "WACImageResizeHandleN":this.Opa=1;break;case "WACImageResizeHandleNE":this.Opa=2;break;case "WACImageResizeHandleE":this.Opa=
3;break;case "WACImageResizeHandleSE":this.Opa=4;break;case "WACImageResizeHandleS":this.Opa=5;break;case "WACImageResizeHandleSW":this.Opa=6;break;case "WACImageResizeHandleW":this.Opa=7}}cpi(){var a=1;this.JZ.instance&&(a=this.JZ.instance.n3);const b=(this.cob.x-this.Aqb.x)/a;a=(this.cob.y-this.Aqb.y)/a;this.IP.x=this.Xyc?-b:b;this.IP.y=this.Yyc?-a:a}lh(){const a=new K.DictionaryPropertySet;a.setValue(Yd.a.$Cj,100*this.iDd);a.setValue(Yd.a.aDj,!0);if(90===this.Vza||270===this.Vza){let b,c;({Eke:b,
nne:c}=this.jsh(this.Opa));a.setValue(Yd.a.heg,b);a.setValue(Yd.a.ieg,c)}else a.setValue(Yd.a.heg,this.lAc),a.setValue(Yd.a.ieg,this.BG);this.Ca.La(D.a.YCj,2,a)}}Object(n.a)(nQ,"ImageResizeDragAdapter",null,[244]);class bC{constructor(a,b){this.Ca=a;this.JZ=b}}Object(n.a)(bC,"ImageResizeDragAdapterFactory",null,[388]);class wH{constructor(a,b,c,f,l,w){this.cqb=this.KDc=this.mDd=this.cob=this.Aqb=this.LDc=null;this.nCc=this.TFc=0;this.Vx=null;this.ro=!1;this.Ca=a;this.Tc=b;this.Lg=c;this.RNa=f;this.JZ=
l;this.tif=this.eia=0;this.iqb=w}Dv(a){return Pc.App.Kb.Ld.isEditingAllowed&&a?(this.LDc=this.Tc.Qj)?!0:!1:!1}Uu(a){if(!this.Dv(a))return!1;this.LDc=this.Tc.Qj;if(this.Vx=nd.ImageReader.gEa(this.LDc))return this.Aqb=this.pta(a),this.mDd=Sys.UI.DomElement.getBounds(this.iqb),this.TFc=0<nd.ImageReader.u3f(this.Vx)?nd.ImageReader.u3f(this.Vx):0,this.nCc=nd.ImageReader.Abj(this.Vx),ka.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;ka.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");
return!1}Gw(a){this.cob=this.pta(a);this.fpi();if(this.RNa)return this.RNa.WGl(this.eia,this.tif),ka.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;ka.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}fo(){var a=this.eia;a%=360;0>a&&(a+=360);this.TFc=this.eia=a;this.setRotation();ka.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}pu(){this.RNa.WGl(this.nCc,0);ka.ULS.sendTraceTag(22052888,322,50,
"Image rotate drag event canceled.")}pta(a){return this.Lg.bka(a)}fpi(){var a=1;this.JZ&&this.JZ.instance&&(a=this.JZ.instance.n3);var b=new Sys.UI.Point(this.mDd.x+this.iqb.clientWidth/2*a,this.mDd.y+this.iqb.clientHeight/2*a);a=vH(this.Aqb,b);b=vH(this.cob,b);this.eia=Math.round(te.a.YO(b-a));0<this.TFc&&(this.eia+=this.TFc-this.nCc);this.tif=this.eia;this.eia+=this.nCc}setRotation(){const a=new K.DictionaryPropertySet;a.setValue(Yd.a.ZCj,0);a.setValue(Yd.a.M8b,this.eia);this.Ca.La(D.a.imageRotate,
2,a)}dispose(){ka.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");this.ro||(this.cqb&&(this.KDc&&this.cqb.contains(this.KDc)&&(this.cqb.removeChild(this.KDc),this.KDc=null),this.iqb&&this.iqb.contains(this.cqb)&&(this.iqb.removeChild(this.cqb),this.cqb=null)),this.ro=!0)}}Object(n.a)(wH,"ImageRotateDragAdapter",null,[415,244,106]);class cC{constructor(a,b,c){this.Ca=a;this.Tc=b;this.JZ=c}create(a,b,c){return new wH(this.Ca,this.Tc,a,b,this.JZ,c)}}Object(n.a)(cC,"ImageRotateDragAdapterFactory",
null,[387]);class dC{constructor(){this.Da=null}get name(){return"Box4.Images"}Zb(a){this.Da=a;this.Da.register(bC,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().oa(()=>new bC(u.AFrameworkApplication.Ta,Ab.a.instance.Ja("Common.IZoomManager")));this.Da.register(cC,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().oa(()=>new cC(u.AFrameworkApplication.Ta,de.a.instance,Ab.a.instance.Ja("Common.IZoomManager")))}init(){this.Da.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){v.a.instance.Dc(new dC)}}
Object(n.a)(dC,"Box4ImagesPackage",null,[2,3]);class xH{create(a){return new Dg.a(a)}}Object(n.a)(xH,"Factory",null,[997]);var hz=d(442);class yH{constructor(){this.Ki=null}get key(){return"COMMENTTEXTANCHOR"}get i8(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Ki=Object(qa.a)(Sd.AParagraphNode,a.node)}muc(a){a=(a=this.d7i(a))?Object.assign(new hz.a,{e1:this.key,bQ:a}):null;return{returnValue:!!a,KBa:a}}d7i(a){if(!this.Ki.Ra)return null;const b=new Ka.a;for(let c=0;c<this.Ki.Ra.length;c++){const f=
this.Ki.Ra.ga(c);if(f.cp>a)break;if(f.yg)for(let l=0;l<f.yg.length;l++){const w=f.yg.ga(l);w.xk?b.add(w.wI.Bq.toString()):b.remove(w.wI.Bq.toString())}}return 0<b.count?b.ga(0):null}}Object(n.a)(yH,"CommentTextAnchorDetailsProvider",null,[509,510]);class ox{constructor(){this.Ki=null}get i8(){return null}getTitle(){return null}G1f(){return null}reset(a){this.Ki=a.node}muc(a){const b=oe.d(this.Ki,a);a=null;if(!b||b.Wq!==this.Wq)return{returnValue:!1,KBa:a};a=Object.assign(new hz.a,{e1:this.key,bQ:b,
title:this.getTitle(b),description:this.G1f(b)});return{returnValue:!0,KBa:a}}}Object(n.a)(ox,"BlobDetailsProvider",null,[509,510]);class zH extends ox{constructor(){super()}get key(){return"EQUATION"}get Wq(){return 11}get i8(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(n.a)(zH,"EquationDetailsProvider",ox,[]);class AH{constructor(){this.pef=null}get key(){return"LINK"}get i8(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.pef=vb.HyperlinkReader.T5b(a.node)}muc(a){let b;
b=null;for(const c of this.pef)if(c.Qa<=a&&a<c.Lb)return b=Object.assign(new hz.a,{e1:this.key,bQ:c.hyperlink}),{returnValue:!0,KBa:b};return{returnValue:!1,KBa:b}}}Object(n.a)(AH,"HyperlinkDetailsProvider",null,[509,510]);class BH extends ox{constructor(){super()}get key(){return"IMAGE"}get Wq(){return 5}get i8(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return nd.ImageReader.rTc(a.properties)}G1f(a){return nd.ImageReader.k8d(a.properties)}}Object(n.a)(BH,"ImageDetailsProvider",
ox,[]);class iz{constructor(){this.description=this.contentId=this.bQ=this.e1=null}}Object(n.a)(iz,"StructuralContentDetails",null,[525]);class CH{get key(){return"IMAGENODE"}get i8(){return Box4Intl.Box4Strings.l_ImageContentTitle}P3e(a){let b;b=null;if(!a||!nd.ImageReader.iH(a.currentNode))return{returnValue:!1,Utb:b};b=Object.assign(new iz,{e1:this.key,contentId:a.currentNode.id,bQ:a.currentNode});return{returnValue:!0,Utb:b}}ASc(a,b){a=a.bQ;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.bQ.id||(f=String.format(c,nd.ImageReader.rTc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(n.a)(CH,"ImageNodeDetailsProvider",null,[1053,510]);let px,qx;class Vr{constructor(a,b){this.Rbf=null;this.Fm=b;this.nJd=a;this.lUb=Vr.keys.ga(a);this.mQh=Vr.XAi.ga(a)}get key(){return this.lUb}get i8(){return this.mQh}reset(a){this.Rbf=this.Fm.GF(a.node)}muc(a){var b=Vr.d_i(this.Rbf||[],c=>this.RMj(a,c));b=this.SDi(b);return{returnValue:!!b,KBa:b}}RMj(a,b){return b.begin<=
a&&a<b.end&&(!b.Hh||this.nJd===b.Hh.proofingType)}SDi(a){return a?Object.assign(new hz.a,{e1:this.key,bQ:a.Hh,description:this.R6d()}):null}R6d(){return u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static d_i(a,b){for(const c of a)if(b(c))return c;return null}}Vr.keys=(qx=new Ib.a,qx.add(1,"SPELLINGERROR"),qx.add(2,"GRAMMATICALERROR"),qx.add(3,"ADVANCEDERROR"),qx);Vr.XAi=(px=new Ib.a,
px.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),px.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),px.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),px);Object(n.a)(Vr,"ProofingDetailsProvider",null,[509,510]);class DH{constructor(){this.tableNode=null;this.BKc=this.qnd=this.columns=this.rows=0}}Object(n.a)(DH,"TableInfo",null,[]);var xn=d(148),Rd=d(85),ok=d(128);class EH{get key(){return"TABLE"}get i8(){return Box4Intl.Box4Strings.l_TableContentTitle}P3e(a){var b=
null;if(!Ie.isTableCell(a))return{returnValue:!1,Utb:b};b=new ob.GraphIterator;b.Rc(a);a=new DH;a.qnd=ok.c(b)+1;a.BKc=xn.a(b)+1;Rd.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=hd.TableReader.Ci(a.tableNode);a.rows=hd.TableReader.tk(a.tableNode);b=Object.assign(new iz,{e1:this.key,contentId:a.tableNode.id,bQ:a});return{returnValue:!0,Utb:b}}ASc(a,b){a=a.bQ;const c=new qj.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.bQ.BKc===a.BKc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.BKc));b&&b.bQ.qnd===a.qnd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.qnd));return c.toArray().join(" ")}}Object(n.a)(EH,"TableDetailsProvider",null,[1053,510]);class eC{constructor(a,b){this.VSh=a;this.Fm=b}IQe(){this.VSh.execute(a=>{a.h_a(new AH);a.h_a(new Vr(1,this.Fm));a.h_a(new Vr(2,this.Fm));a.h_a(new Vr(3,this.Fm));a.h_a(new zH);a.h_a(new BH);a.h_a(new yH);a.TQe(new EH);a.TQe(new CH)})}}
Object(n.a)(eC,"AccessibilityActor",null,[]);class fC{constructor(a,b,c){this.BXb=a;this.nd=b;this.GOh=c}wb(){this.BXb.ra(D.a.ZAk,Cb.a.view,Object(F.a)(this,this.$Ak,"openAutoCorrectOptionsView"),1028)}$Ak(a,b,c){if(1===c)return 32;this.GOh().Prc();return 32}}Object(n.a)(fC,"AutoCorrectActor",null,[]);class gC{constructor(a){this.uVh=a}GSj(a){if(!a||!a.rw||1>a.rw.count)return!1;const b=[Gc.a.GJi,Gc.a.FJi];return!!this.iSc(a.rw,1,c=>this.hLc(c,b))}Pig(a){return!a||!a.rw||1>a.rw.count?!1:!!this.iSc(a.rw,
1,b=>this.hLc(b,[Gc.a.FN]))}ZPj(a){return!a||!a.rw||1>a.rw.count?!1:!!this.iSc(a.rw,2,b=>this.hLc(b,[Gc.a.obc]))}el(a){return!a||!a.rw||1>a.rw.count?!1:!!this.iSc(a.rw,1,b=>this.hLc(b,[Gc.a.Gfa]))}TZc(a){if(!a||!a.rw)return!1;a=a.rw;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).Qhi)return!1;return!0}tUi(a,b){return this.Pig(b)||this.ZPj(b)?"":a}get R_c(){return this.uVh}iSc(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}hLc(a,
b){a=a&&a.wdg?a.wdg.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(n.a)(gC,"Box4PasteStewardUtils",null,[1041]);class FH{constructor(){this.eZ=0;this.dBb=Array(9)}}Object(n.a)(FH,"FullListMetadata",null,[]);class jz{constructor(){this.level=0;this.BMa=null;this.eZ=0;this.lXi=this.olc=null;this.gIb=!1}}Object(n.a)(jz,"ListItemMetadata",null,[]);class $t{constructor(){this.jZ=[]}e1f(){const a=new $t;for(let b=0;b<this.jZ.length;b++)a.add(this.ga(b));
return a}get count(){return this.jZ.length}ga(a){return this.jZ[a]}$(a,b){return this.jZ[a]=b}add(a){Array.add(this.jZ,a)}clear(){Array.clear(this.jZ)}contains(a){return Array.contains(this.jZ,a)}indexOf(a){return Array.indexOf(this.jZ,a)}insert(a,b){Array.insert(this.jZ,a,b)}remove(a){return Array.remove(this.jZ,a)}removeAt(a){Array.removeAt(this.jZ,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.jZ,a)}reverse(){this.jZ.reverse()}sort(){this.jZ.sort()}toArray(){return Array.clone(this.jZ)}}
Object(n.a)($t,"List",null,[]);class GH{constructor(){this.level=0;this.tagName="UL";this.HYa=null;this.ignore=!1;this.Xjc=0;this.listStyle="BulletListStyle1";this.A9=new $t;this.font=this.levelText=""}}Object(n.a)(GH,"ListLevelMetadata",null,[]);class hC{constructor(){this.Dqg={};this.LMc=-1}}Object(n.a)(hC,"LevelLists",null,[]);class iC{constructor(a){this.nodes=a;this.l3=0;this.lists={};this.A9=[];this.TAb=null;this.xja=[];this.xja[0]=new hC}}Object(n.a)(iC,"WordConverterArguments",null,[]);class HH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(n.a)(HH,"AbsolutePosition",null,[]);class Xm{constructor(a,b,c,f,l){this.cultureName=this.L5=this.rw=this.FU=null;a&&(this.FU=a);b&&(this.rw=b);this.L5=c?c:new Ka.a;f&&""!==f&&(this.cultureName=f);this.ria=l}}Object(n.a)(Xm,"GlobalAttributesArgs",null,[]);class au{constructor(a,b,c="",f=0){this.aw=!1;this.fef=this.gef=null;let l=!1;au.vPj(a)&&(l=!0,this.gef=a);au.KPj(b)&&(this.fef=b);this.MTh=c;this.BOh=f;this.aw=l&&this.y8b?!0:!1}get isValid(){return this.aw}get ydg(){return this.gef}get y8b(){return this.fef}get wdg(){return this.MTh}get Qhi(){return this.BOh}static vPj(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static KPj(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(n.a)(au,"HtmlElementInfo",null,[]);class IH{constructor(a){this.next=null;this.data=a}}Object(n.a)(IH,"StackNode",null,[]);class rx{constructor(){this.ov=null;this.Xk=0}get count(){return this.Xk}get isEmpty(){return!this.Xk||!this.ov}push(a){a=new IH(a);a.next=this.ov;this.ov=a;this.Xk++}peek(){return this.isEmpty?null:this.ov.data}pop(){if(this.isEmpty)return null;const a=this.ov;this.ov=a.next;
this.Xk--;return a.data}clear(){this.ov=null;this.Xk=0}toArray(){const a=Array(this.count);let b=this.ov;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(n.a)(rx,"Stack",null,[]);class th{constructor(a){this.QSb=this.eCc=null;this.tyc=!1;this.Ig=a}get fRa(){return this.QSb.peek()}reset(){this.Ig.reset();this.eCc=new rx;this.QSb=new rx;this.QSb.push(this.Ig.q2b);this.tyc=!1}Ped(){this.tyc=!1}hD(a){this.tyc||(this.eCc.push(null),this.tyc=!0);this.eCc.push(a)}onClose(){for(;;){const a=
this.eCc.pop();if(!a)break;a()}}Yqh(){return!1}Eqk(){this.Cq(()=>!0)}Cq(a){const b=this.fRa.clone();return a(b)?(this.QSb.push(b),this.Ig.Ina(b),this.hD(Object(F.a)(this,this.Ruk,"onFormattingEnd")),!0):!1}Ebe(a){return a.style?this.Cq(b=>this.Yqh(b,a))?1:2:2}Ruk(){this.QSb.pop();this.Ig.Ina(this.fRa)}Y0(){}Ied(){return 2}OGe(){return 2}PGe(){return 2}RGe(){return 2}YGe(){return 3}aHe(){}Ned(){return 2}bHe(){}cHe(){}dHe(){return 2}Ted(){return 2}Ued(){return 2}pHe(){return 2}Ved(){}uHe(){return 2}Wed(){return 2}Yed(){return 2}afd(){return 2}cfd(){return 2}GHe(){}HHe(){return 2}ffd(){return 2}gfd(){return 2}ifd(){return 2}jfd(){return 2}lfd(){return 2}mfd(){return 2}nfd(){return 2}qfd(){return 2}dIe(){return 2}yfd(){return 2}jIe(){return 2}kIe(){}lIe(){return 2}Dfd(){return 2}Efd(){return 2}Ffd(){return 2}Gfd(){return 2}Hfd(){return 2}Ifd(){return 2}pIe(){return 3}Jfd(){}rIe(){return 2}Kfd(){return 2}tIe(){return 3}Lfd(){}vIe(){}Mfd(){return 2}CIe(){return 3}Nfd(){return 2}Pfd(){return 2}Rfd(){return 2}Sfd(){return 2}GIe(){}HIe(){return 3}Wfd(){return 2}sHb(){return 2}KIe(){}NIe(){return 2}OIe(){return 2}PIe(){return 3}cgd(){return 2}QIe(){return 2}ggd(){return 2}jgd(){return 2}RIe(){}vgd(){return 2}ZIe(){return 2}Dgd(){return 2}Egd(){return 2}jJe(){return 3}kJe(){return 2}Ngd(){return 2}Ogd(){return 2}Pgd(){return 2}Qgd(){return 2}qJe(){return 3}Rgd(){return 2}Tgd(){return 2}Xgd(){return 2}tJe(){return 2}alc(){return 2}vJe(){return 2}wJe(){return 2}Ygd(){return 2}xJe(){return 2}zJe(){return 3}Zgd(){return 2}bhd(){return 2}chd(){return 2}dhd(){return 2}fhd(){return 2}static Dta(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(ha.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static Vkj(a){if(!a||""===a)return-1;const b=ha.a.rg(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(ha.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(ha.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static W5f(a){return a&&""!==a?th.Dta(a):null}static Dy(a){let b=null,c=null,f=null,l=null;a&&a.Uf&&(b=th.tta(a.Uf,"id"),c=th.tta(a.Uf,"lang"),f=a.Uf.tagName,
a.kfi&&(l=Object.assign(new HH,{x:th.Dta(a.Uf.style.left),y:th.Dta(a.Uf.style.top),left:th.W5f(a.Uf.style.left),top:th.W5f(a.Uf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new Xm(new au(b,f),a.rw,null,c,l)}static tta(a,b){return a[b]}}Object(n.a)(th,"AHtmlTranslator",null,[1073]);class JH extends Xm{constructor(a,b,c,f=0,l=0,w=null){super(w?w.FU:null,w?w.rw:null,w?w.L5:null,w?w.cultureName:null,w?w.ria:null);this.width=f;this.height=l}}Object(n.a)(JH,"AugmentationSemanticArgs",Xm,
[]);class KH{constructor(){this.stop=this.color=null}}Object(n.a)(KH,"ColorStopPair",null,[]);class kz{constructor(a,b){this.value=a;this.A1i=b}get UZc(){return this.A1i}}Object(n.a)(kz,"ElementValueWrapper",null,[]);class LH extends kz{constructor(a,b,c){super(a,b);this.zmg=c}}Object(n.a)(LH,"DimensionWrapper",kz,[]);class jC{constructor(a=0,b=0,c=0,f=0,l="",w="",H="",U="",ja="0pt",wa="0pt",Sa="0pt",eb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
f;this.borderTopColor=l;this.borderRightColor=w;this.borderBottomColor=H;this.borderLeftColor=U;this.borderTopWidth=ja;this.borderRightWidth=wa;this.borderBottomWidth=Sa;this.borderLeftWidth=eb}}Object(n.a)(jC,"TableCellBorderProperties",null,[]);class kC{constructor(a="",b="",c="",f=""){this.qri=a;this.pri=b;this.nri=c;this.ori=f}}Object(n.a)(kC,"TableCellMarginProperties",null,[]);class fh{static get xdg(){return fh.OTh}static get Ksd(){return fh.s2h}static get Gsd(){return fh.q2h}static Wae(a,
b,...c){b=fh.u9f(b);let f=!1;b||(b=fh.hpj.apply(null,[a].concat(c)),f=!!b);return new kz(b,f)}static u9f(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static hpj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static Dgj(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(Of.a.Nfa(b,0,!1));case "in":return Math.round(Of.a.y_(b,
0,!1));case "cm":return Math.round(Of.a.y_(te.a.IEf(b),0,!1));case "mm":return Math.round(Of.a.y_(te.a.IEf(.1*b),0,!1));default:return b}}static Vmd(a,b,...c){a=fh.Wae.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=ha.a.substring(a.value,0,a.value.length-1)):a.UZc?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=ha.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=fh.Dgj(c,f)}return new LH(c,a.UZc,b)}static Sxb(a){return fh.Vmd(a,
[a.style.width],"width","WIDTH","Width")}static P9a(a){return fh.Vmd(a,[a.style.height],"height","HEIGHT","Height")}static X8d(a){return fh.Vmd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static Y8d(a){return fh.Vmd(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static npj(a){a=fh.Wae(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in fh.Ksd&&void 0!==fh.Ksd[a.value]&&null!==fh.Ksd[a.value]?fh.Ksd[a.value]:0}static TWj(a){a=
fh.u9f([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static X4i(a){return fh.Wae(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static HBi(a){const b=ha.a.substring(a,0,1),c=ha.a.substring(a,1,2);a=ha.a.substring(a,2,3);return b+b+c+c+a+a}static nja(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=ha.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return ha.a.RB(b)}if(fh.xdg[ha.a.rg(b)])return fh.xdg[ha.a.rg(b)];b.startsWith("#")&&(b=ha.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=fh.HBi(b));return 6!==b.length?"":b}static mEk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();
if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static TVc(a,b){const c=fh.X4i(a);c&&""!==c&&b.Cq(f=>f.apd(fh.nja(c)))}static h0f(a){a=a.style;if(!a)return null;const b=fh.Gsd[a.borderTopStyle],c=fh.nja(a.borderTopColor),f=a.borderTopWidth,l=fh.Gsd[a.borderRightStyle],w=fh.nja(a.borderRightColor),H=a.borderRightWidth,U=fh.Gsd[a.borderBottomStyle],ja=fh.nja(a.borderBottomColor),wa=a.borderBottomWidth,Sa=fh.Gsd[a.borderLeftStyle],eb=fh.nja(a.borderLeftColor);return new jC(b,l,U,Sa,
c,w,ja,eb,f,H,wa,a.borderLeftWidth)}static R5i(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new kC(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}fh.OTh=pa.a.SH("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");fh.s2h=pa.a.SH("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);fh.q2h=pa.a.SH("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(n.a)(fh,"DefaultHtmlTranslatorHelper",null,[]);class MH{constructor(){this.direction=null;this.C0b=new $t}Ubg(){return!!this.direction&&0<this.direction.length}}Object(n.a)(MH,"LinearGradient",null,[]);class lC{constructor(){this.J9b=!1}}Object(n.a)(lC,"HtmlTranslatorContext",null,[]);class mC{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,w=!1,H=!0,U=!1,ja=!0,wa=!0,Sa=!0,eb=!1,ub=!1,
Ub=!1,cc=!1,Fc=!1,Ic=!1,Cc=!1,Ud=null,je=null,Vd=null,Ve=null,af=null,Zf=null,lg=null){this.J9b=!1;this.fZh=a;this.kZh=b;this.cZh=c;this.jZh=f;this.X0h=l;this.V0h=w;this.Q0h=H;this.R0h=U;this.T0h=ja;this.U0h=wa;this.S0h=Sa;this.f1h=eb;this.t1h=ub;this.e1h=Ub;this.h2h=cc;this.$0h=Fc;this.kUh=Ic;this.VUh=Cc;this.Z0h=Ud;this.d1h=je;this.W0h=af;this.b1h=Vd;this.Y0h=Ve;this.a1h=Zf;this.c1h=lg}get tZa(){return this.fZh}get fFk(){return this.kZh}get s$g(){return this.cZh}get eFk(){return this.jZh}get Luh(){return this.X0h}get Kuh(){return this.V0h}get cjl(){return this.Q0h}get djl(){return this.R0h}get fjl(){return this.T0h}get hjl(){return this.U0h}get ejl(){return this.S0h}get A0a(){return this.$0h}get uHj(){return this.kUh}get Puh(){return this.f1h}get Qkl(){return this.t1h}get pjl(){return this.e1h}get Atl(){return this.h2h}get CUa(){return this.VUh}get Muh(){return this.Z0h||
Object(F.a)(this,this.Ymd,"returnFalse")}get ojl(){return this.d1h||Object(F.a)(this,this.Ymd,"returnFalse")}get njl(){return this.b1h||Object(F.a)(this,this.uTe,"returnTrue")}get jjl(){return this.Y0h||Object(F.a)(this,this.uTe,"returnTrue")}get ijl(){return this.W0h||Object(F.a)(this,this.Ymd,"returnFalse")}get mjl(){return this.a1h||Object(F.a)(this,this.uTe,"returnTrue")}get Ouh(){return this.c1h||Object(F.a)(this,this.Ymd,"returnFalse")}uTe(){return!0}Ymd(){return!1}}Object(n.a)(mC,"HtmlTranslatorSettings",
null,[1088]);class NH extends Xm{constructor(a,b,c,f,l=null,w=0,H=0,U=null,ja=null){super(l?l.FU:null,l?l.rw:null,l?l.L5:null,l?l.cultureName:null,l?l.ria:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=w;this.maxHeight=H;this.href=U;this.desc=ja}}Object(n.a)(NH,"ImageSemanticArgs",Xm,[]);class OH{constructor(a,b){this.vql=a;this.uql=b}}Object(n.a)(OH,"IndentationProperties",null,[]);class sx extends Xm{constructor(a,b,c,f=0,l=-1,w=!1,H=!1,U="",ja="",wa=null,Sa=-1){super(c?c.FU:
null,c?c.rw:null,c?c.L5:null,c?c.cultureName:null,c?c.ria:null);this.$kf=a;this.FUb=0;this.SLd=b;this.HTb=1===b&&-1===l&&!this.b3a;this.bGd=f;this.cGd=l;this.BId=w;this.b3a=H;this.U3a=U;this.kob=ja;this.Wwc=wa;this.Fwc=Sa;this.Inb=-1;this.GFc=!0}get listStyleType(){return this.WQj?this.FUb:this.$kf}get WQj(){return 0!==this.FUb}get Qrl(){return this.SLd}get listLevel(){return this.cGd}set listLevel(a){this.cGd=a}get listId(){return this.bGd}set listId(a){this.bGd=a}get gIb(){return this.BId}set gIb(a){this.BId=
a}get K8a(){return this.b3a}set K8a(a){this.b3a=a}get levelText(){return this.U3a}set levelText(a){this.U3a=a}get font(){return this.kob}set font(a){this.kob=a}get zQa(){return this.Wwc}set zQa(a){this.Wwc=a}get Fsb(){return this.Fwc}set Fsb(a){this.Fwc=a}get Dkg(){return 6<=this.listStyleType}get TKj(){return this.HTb}get UJi(){return this.GFc?this.SLd+this.Inb:this.Inb}clone(){const a=new sx(this.$kf,this.SLd,new Xm(this.FU,this.rw,this.L5,this.cultureName,this.ria),this.bGd,this.cGd,this.BId,this.b3a);
a.FUb=this.FUb;a.HTb=this.HTb;a.Inb=this.Inb;a.GFc=this.GFc;a.U3a=this.U3a;a.kob=this.kob;a.Wwc=this.Wwc;a.Fwc=this.Fwc;return a}Jfi(a,b,c){this.FUb=a;0<b?(this.HTb=!1,this.Inb=b,this.GFc=!1):(this.Inb++,this.HTb=!c)}}Object(n.a)(sx,"ListSemanticArgs",Xm,[]);class lz extends Xm{constructor(a,b,c,f,l=null,w=0,H=null,U=null,ja=!1,wa=!1,Sa=69905,eb=null){super(eb?eb.FU:null,eb?eb.rw:null,eb?eb.L5:null,eb?eb.cultureName:null,eb?eb.ria:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.vAb=wa;this.height=
f;this.HFa=ja;this.Xqc=l;this.verticalAlignment=w;this.v6=H;this.Hsd=U;this.IJc=Sa}}Object(n.a)(lz,"TableCellSemanticArgs",Xm,[]);class nC extends Xm{constructor(a,b=null){super(b?b.FU:null,b?b.rw:null,b?b.L5:null,b?b.cultureName:null,b?b.ria:null);this.height=a}}Object(n.a)(nC,"TableRowSemanticArgs",Xm,[]);class oC extends Xm{constructor(a,b,c,f,l,w,H,U,ja,wa=null,Sa=-1,eb=null){super(eb?eb.FU:null,eb?eb.rw:null,eb?eb.L5:null,eb?eb.cultureName:null,eb?eb.ria:null);this.HQa=null;this.HY=a;this.$ra=
b;this.width=c;if(l)for(this.HQa=Array(l.length),a=0;a<l.length;++a)this.HQa[a]=l[a];this.Ehg=w;this.l1e=U;this.lLj=H;this.HFa=f;this.vee=ja;this.bAh=wa;this.tableLook=Sa}}Object(n.a)(oC,"TableSemanticArgs",Xm,[]);let Wr;class ul extends th{constructor(a,b=null,c=null,f=null){super(a);this.Z3a=null;this.NWh=pa.a.SH("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Jc=b||new mC;this.vu=c||new lC;this.eGd=f}get zqg(){return this.NWh}o4f(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.zqg[ha.a.rg(c)])||(c=th.tta(a,"type"))&&""!==c&&(c=this.zqg[c]))return c;if(this.Jc.tZa&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=ul.iVc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=ul.iVc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}h4f(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=za.a.x2f(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.PRc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=za.a.x2f(a,"p"))return ul.ddj(a)-1}return b}PRc(a,b,c){a=this.Jc.tZa?a.getAttribute(b):th.tta(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}jwk(){this.Z3a.pop();this.Ig.Lna()}D7b(a,b){this.Cq(l=>l.cLa(0,0));const c=this.o4f(a.Uf,b?6:2);let f=1;b&&(f=this.PRc(a.Uf,"start",1));b=!1;this.Jc.tZa&&(b=a.Uf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Uf.removeAttribute("data-pasteFromRc"),(B.a.DT||B.a.fg)&&ul.jKc(a.Uf));a=new sx(c,f,th.Dy(a),0,-1,b,this.Jc.tZa);this.Z3a.push(a);this.Ig.Nna(a);this.hD(Object(F.a)(this,this.jwk,"onListElementClose"));return 1}reset(){super.reset();this.Z3a=new rx}Yqh(a,
b){let c=!1;try{var f=b.getAttribute("xml:lang")||th.tta(b,"lang")}catch(U){f=null}f&&""!==f&&(c=a.kWe(f)||c);(f=th.tta(b,"dir"))&&(c=a.wMb(f)||c);if(f=b.style){if(f.fontWeight){var l=ha.a.RB(f.fontWeight),w=parseInt(l);isNaN(w)?"BOLD"===l?c=a.OH(!0)||c:"NORMAL"===l&&(c=a.OH(!1)||c):c=600<=w?a.OH(!0)||c:a.OH(!1)||c}this.Jc.Kuh&&f.fontSize&&(l=Math.round(th.Vkj(f.fontSize)),0<l&&(c=a.JLb(Math.floor(2*l))||c));this.Jc.njl(this.vu)&&(this.Jc.Puh&&b.getAttribute?(l=b.getAttribute("data-indent"))&&0<l.length&&
(l=Of.a.fK(parseInt(l),0)+"px",c=a.Xpd(l)||c):f.textIndent&&(c=a.Xpd(f.textIndent)||c));this.Jc.jjl(this.vu)&&f.marginLeft&&(this.Jc.Puh&&b.getAttribute?(l=b.getAttribute("data-margin"))&&0<l.length&&(c=a.xqc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.xqc(f.marginLeft)||c));this.Jc.ijl(this.vu)&&f.lineHeight&&(c=a.C1(f.lineHeight)||c);if(this.Jc.ejl)if(l=f.fontVariantCaps?ha.a.rg(f.fontVariantCaps):null,w=f.fontVariant?ha.a.rg(f.fontVariant):null,"uppercase"===(f.textTransform?ha.a.rg(f.textTransform):
null))c=a.Wpd("uppercase")||c;else if("small-caps"===l||w&&0<=w.indexOf("small-caps"))c=a.Wpd("small-caps")||c;this.Jc.mjl(this.vu)&&f.textAlign&&(c=a.jkb(ha.a.rg(f.textAlign))||c);f.fontStyle&&(l=ha.a.RB(f.fontStyle),"ITALIC"===l||"OBLIQUE"===l?c=a.g0a(!0)||c:"NORMAL"===l&&(c=a.g0a(!1)||c));l=ul.nnj(b);if(f.textDecoration||l){w=ha.a.rg(f.textDecoration||"");l=ha.a.rg(l||"");if(b.parentNode&&b.parentNode.tagName&&"a"===ha.a.rg(b.parentNode.tagName)){var H=(b.querySelector(".TextRun")||b).className;
H&&-1<H.indexOf("Underlined")&&(c=a.PY(!0)||c)}else if(f.kQl||ul.hE(w)||ul.hE(l))c=a.PY(!0)||c;if(f.jQl||ul.Ckg(w)||ul.Ckg(l))c=a.MY(!0)||c}if(f.verticalAlign){l=ha.a.RB(f.verticalAlign);if("SUB"===l||this.Jc.Ouh(this.vu)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.h6(!0)||c;else if("SUPER"===l||this.Jc.Ouh(this.vu)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.OY(!0)||c;this.Jc.Kuh&&("SUB"===l||"SUPER"===l)&&b.getAttribute&&(l=parseFloat(b.getAttribute("data-fontsize")),isNaN(l)||
(c=a.aWe(Math.floor(2*l))||c))}this.Jc.hjl&&f.fontFamily&&(this.Jc.CUa?c=this.$Ve(a,f.fontFamily,c):this.Jc.pjl&&b.getAttribute?(l=b.getAttribute("data-usefontface"))&&"true"===l&&(c=this.$Ve(a,f.fontFamily,c)):c=this.$Ve(a,f.fontFamily,c));l=null;this.Jc.fjl&&f.color&&(l=fh.nja(f.color));w=!!l;this.Jc.ojl(this.vu)&&b.getAttribute&&(w=b.getAttribute("data-scheme-color"),l=null!==w?w:l,w="inherit"!=f.color&&(""!==l||!this.vu.J9b||ul.qXj(b)));w&&(c=a.Sr(l)||c);this.Jc.cjl&&!this.vu.J9b&&f.backgroundColor&&
(this.Jc.fFk&&b.tagName&&ul.qvl.contains(ha.a.RB(b.tagName))||(c=a.Joa(fh.nja(f.backgroundColor))||c));if(this.Jc.djl&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&(f=ul.ipj(f.backgroundImage))&&0<f.C0b.count){l=f.C0b.ga(0).color;w=!0;for(H=0;H<f.C0b.count&&(w=w&&l===f.C0b.ga(H).color,w);H++);w&&(ka.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.Joa(fh.nja(l))||c)}}this.Jc.Muh(this.vu)&&b.getAttribute&&(f=b.getAttribute("data-ccp-props"))&&(c=a.Moa(f)||c);
if(b.getAttribute){if(f=b.getAttribute("data-ccp-charstyle"))u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Jc.A0a&&(c=a.hga(f)||c);if(b=b.getAttribute("data-ccp-parastyle"))u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Jc.A0a&&(c=a.Bpd(b)||c)}return c}Pkl(a){if(this.Jc.Qkl)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===
String&&-1<ha.a.RB(a.className).indexOf("MSOCOM"))return!0;if("DIV"===ha.a.RB(a.tagName))break;a=a.parentNode}return!1}$Ve(a,b,c){b=this.L2f(b);return a.YKa(b,this.Jc.Atl)||c}Y0(a,b){"\u200b"===a&&(a="\u00a0");b&&b.Uf&&this.Pkl(b.Uf)&&(a="");this.Ig.Y0(a,th.Dy(b))}Ied(a){const b=th.tta(a.Uf,"href");return b&&""!==b?(this.Ig.Ywa(b,th.Dy(a)),this.hD(Object(F.a)(this.Ig,this.Ig.Xwa,"onAnchorEnd")),1):2}Ned(){return this.Cq(a=>a.OH(!0))?1:2}Ted(){return this.Cq(a=>a.Bbe())?1:2}Ued(a){this.Ig.wA(th.Dy(a));
this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Ved(a){this.Ig.Kna(th.Dy(a))}Wed(a){this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}afd(){return this.Cq(a=>a.g0a(!0))?1:2}Yed(a){this.Cq(b=>b.jkb("center"));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}cfd(){return this.Cq(a=>a.YKa("consolas"))?1:2}gfd(){return this.Cq(a=>a.MY(!0))?1:2}ffd(a){return this.D7b(a,!1)}ifd(){return this.Cq(a=>a.g0a(!0))?
1:2}jfd(a){return this.D7b(a,!1)}lfd(a){var b=a.Uf.getAttribute("data-render-src");const c=a.Uf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const H=a.Uf.getAttribute("data-render-fallback");let U=0,ja=0;if(a.Uf.currentStyle){var f=a.Uf.currentStyle.width,l=a.Uf.currentStyle.height;f&&-1!==f.indexOf("px")&&(f=parseInt(ha.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(U=f));l&&-1!==l.indexOf("px")&&(l=parseInt(ha.a.substring(l,0,l.indexOf("px"))),isNaN(l)||(ja=l))}a=new JH(b,c,H,U,ja,
th.Dy(a));this.Ig.fZa(a);return 2}this.Jc.tZa&&(B.a.DT||B.a.fg)&&(b=a.Uf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Jc.tZa&&b&&b.length&&ul.jKc(a.Uf));const w=a.Uf.getAttribute("align");this.Cq(H=>H.jkb(w));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}mfd(a){this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}nfd(a){this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}qfd(){return this.Cq(a=>
a.g0a(!0))?1:2}yfd(a){return this.Cq(b=>{var c=this.L2f(a.Uf.getAttribute("face"));c=b.YKa(c);b=b.Sr(fh.nja(a.Uf.getAttribute("color")));return c||b})?1:2}Dfd(a){this.Cq(b=>this.Jc.A0a?b.l0a(1):b.m0a(1));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Efd(a){this.Cq(b=>this.Jc.A0a?b.l0a(2):b.m0a(2));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Ffd(a){this.Cq(b=>this.Jc.A0a?b.l0a(3):b.m0a(3));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,
this.Ig.vA,"onParagraphEnd"));return 1}Gfd(a){this.Cq(b=>this.Jc.A0a?b.l0a(4):b.m0a(4));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Hfd(a){this.Cq(b=>this.Jc.A0a?b.l0a(5):b.m0a(5));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Ifd(a){this.Cq(b=>this.Jc.A0a?b.l0a(6):b.m0a(6));this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Jfd(a){this.Ig.Kna(th.Dy(a))}Lfd(a){var b=a.Uf;const c=
b.src,f=b.alt,l=b.XOl;let w=0,H=0;b.style&&(w=th.Dta(b.style.width),H=th.Dta(b.style.height));w&&H||(w=b.width,H=b.height);let U=b=0;a.Uf.currentStyle&&(w||H||(w=th.Dta(a.Uf.currentStyle.width),H=th.Dta(a.Uf.currentStyle.height)),b=th.Dta(a.Uf.currentStyle.maxWidth),U=th.Dta(a.Uf.currentStyle.maxHeight));a=new NH(c,f,w,H,th.Dy(a),b,U,l);this.Ig.Jna(a)}Kfd(){return this.Cq(a=>a.g0a(!0))?1:2}Mfd(){return this.Cq(a=>a.PY(!0))?1:2}Nfd(){return this.Cq(a=>a.YKa("consolas"))?1:2}Pfd(a){this.Ig.wA(th.Dy(a));
this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Rfd(a){this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}Sfd(a){let b;const c=this.o4f(a.Uf,0);let f=this.PRc(a.Uf,"value",0);var l=!1;0<this.Z3a.count?b=this.Z3a.peek():(b=new sx(2,1,th.Dy(a)),f||(f=1));if(this.Jc.tZa){l=b.listLevel;let ja=b.listId;this.Jc.Luh?(l=this.h4f(a.Uf),l=0>l&&0>b.listLevel&&0<this.Z3a.count?b.listLevel=this.Z3a.count-1:b.listLevel=0<=l?l:b.listLevel,this.eGd&&this.eGd.b<
l&&(this.eGd.b=l)):0>l&&(l=b.listLevel=this.h4f(a.Uf));1>ja&&(ja=b.listId=this.PRc(a.Uf,"data-listid",0));a.Uf.getAttribute("data-leveltext")&&(b.levelText=a.Uf.getAttribute("data-leveltext"));var w=a.Uf.getAttribute("data-font");w&&(b.font=w);w=!1;u.AFrameworkApplication.fa&&(w=u.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));if(w){var H=a.Uf.getAttribute("data-charcodes");w=[];if(H&&""!==H)if(-1<H.indexOf(",")){H=H.split(",");for(var U=0;U<H.length;U++)Array.add(w,parseInt(H[U]))}else Array.add(w,
parseInt(H));if(w&&0<w.length){H=Array(w.length);for(U=0;U<w.length;U++)H[U]=w[U];b.zQa=H}(w=a.Uf.getAttribute("data-buAutoNum"))&&0<w.length&&(b.Fsb=parseInt(w))}(l=0<=l&&0<ja)&&ul.jKc(a.Uf)}b.Jfi(c,f,l);this.Ig.bxa(b.clone());this.hD(Object(F.a)(this.Ig,this.Ig.Mna,"onListItemEnd"));return 1}sHb(a){return this.D7b(a,!1)}Wfd(a){if(this.Cq(b=>b.dMb(!0))){const b=a.Uf.getAttribute("OuterHtml");this.Ig.cxa(b,th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.sJa,"onMathEnd"))}return 1}cgd(a){return this.D7b(a,
!0)}ggd(a){this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}jgd(a){const b=a.Uf.getAttribute("align");this.Cq(c=>c.jkb(b));if(this.Jc.tZa){const c=a.Uf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&ul.jKc(a.Uf,B.a.DT||B.a.fg)}this.Ig.wA(th.Dy(a));this.hD(Object(F.a)(this.Ig,this.Ig.vA,"onParagraphEnd"));return 1}vgd(){this.Cq(a=>a.YKa("consolas"));this.Ig.eZa();this.hD(Object(F.a)(this.Ig,this.Ig.dZa,"onPreFormattedTextEnd"));return 1}Dgd(){return this.Cq(a=>
a.MY(!0))?1:2}Egd(){return this.Cq(a=>a.YKa("consolas"))?1:2}Ngd(){return this.Cq(a=>a.UZe())?1:2}Ogd(a){var b=a.Uf.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=fh.mEk(c);if(0<b&&this.Jc.uHj){for(c=0;c<b;c++)this.Ig.kZa(th.Dy(a));return 3}return 2}Pgd(){return this.Cq(a=>a.MY(!0))?1:2}Qgd(){return this.Cq(a=>a.OH(!0))?1:2}Rgd(){return this.Cq(a=>a.h6(!0))?1:2}Tgd(){return this.Cq(a=>a.OY(!0))?1:2}Xgd(a){this.Cq(Sa=>Sa.clearFormatting()&&Sa.TSe());fh.TVc(a.Uf,this);const b=fh.Sxb(a.Uf),
c=fh.h0f(a.Uf),f=fh.X8d(a.Uf),l=fh.Y8d(a.Uf),w=!parseInt(th.tta(a.Uf,"border")),H=fh.TWj(a.Uf);let U=-1,ja="";var wa=-1;a.Uf.attributes.hasOwnProperty("style")&&-1!==(wa=a.Uf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?U=parseInt(a.Uf.attributes.getNamedItem("style").value.substr(wa+17)):a.Uf.attributes.hasOwnProperty(ua.a.d_d.toString())&&(U=parseInt(a.Uf.attributes.getNamedItem(ua.a.d_d.toString()).value));wa=-1;a.Uf.attributes.hasOwnProperty("class")&&-1!==(wa=a.Uf.attributes.getNamedItem("class").value.indexOf("Mso"))?
ja=a.Uf.attributes.getNamedItem("class").value.substr(wa).split(" ")[0]:a.Uf.attributes.hasOwnProperty(ua.a.e_d.toString())&&(ja=a.Uf.attributes.getNamedItem(ua.a.e_d.toString()).value);this.Ig.tY(new oC(0,0,b.value,b.zmg,null,w,H,c,new OH(f.value,l.value),ja,U,th.Dy(a)));this.hD(Object(F.a)(this.Ig,this.Ig.qY,"onTableEnd"));u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}alc(a){const b=fh.P9a(a.Uf),c=fh.Sxb(a.Uf);if(!c.value&&
c.UZc&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Jc.s$g))return 3;let f=parseInt(th.tta(a.Uf,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?1:0;let l=parseInt(th.tta(a.Uf,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let w=!1;a.Uf.attributes.hasOwnProperty("style")&&(w=-1!==a.Uf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Uf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));
!w&&a.Uf.attributes.hasOwnProperty("class")&&(w=-1!==a.Uf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let H=69905;if(a.Uf.attributes.hasOwnProperty(ua.a.c_d.toString())){var U=parseInt(a.Uf.attributes.getNamedItem(ua.a.c_d.toString()).value);isNaN(U)||(H=U)}U=fh.nja(a.Uf.style.backgroundColor);const ja=fh.npj(a.Uf);this.Cq(eb=>eb.cLa(0,0));fh.TVc(a.Uf,this);const wa=fh.h0f(a.Uf),Sa=this.Jc.eFk?fh.R5i(a.Uf):null;a=new lz(f,l,c.value,b.value,U,ja,wa,Sa,c.zmg,w,H,th.Dy(a));this.Ig.pY(a);
this.hD(Object(F.a)(this.Ig,this.Ig.oY,"onTableCellEnd"));this.Eqk();return 1}Ygd(a){const b=this.alc(a);if(3===b)return b;this.Cq(c=>{const f=c.OH(!0);c=c.jkb("center");return f||c});fh.TVc(a.Uf,this);return 1}Zgd(a){fh.TVc(a.Uf,this);const b=fh.P9a(a.Uf);if(b.UZc&&!b.value&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Jc.s$g))return 3;this.Ig.sY(new nC(b.value,th.Dy(a)));this.hD(Object(F.a)(this.Ig,this.Ig.rY,"onTableRowEnd"));return 1}bhd(){return this.Cq(a=>
a.YKa("consolas"))?1:2}chd(){return this.Cq(a=>a.PY(!0))?1:2}dhd(a){return this.D7b(a,!1)}fhd(){return this.Cq(a=>a.PY(!0))?1:2}g$i(a){if(!a)return null;a=a.split(",");return this.Jc.CUa&&a[0].startsWith("WordVisi")&&1<a.length?a[1].trim():a[0]}static Uzl(a){if(!a)return null;a=ha.a.vRe(a,'"');return a=ha.a.vRe(a,"'")}L2f(a){if(!a)return null;a=this.g$i(a);return a=ul.Uzl(a)}static muf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.Ubg())return!1;a.direction=b;return!0}if((c=
b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<c.length){if(a.Ubg())return!1;a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:fh.nja(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new KH;f.color=c;f.stop=b;a.C0b.add(f);return!0}static ipj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);
b=b.substr(0,b.lastIndexOf(")"));const c=new MH;for(;0<b.trim().length;){let f=b.indexOf(",");const l=b.indexOf("(");if(0<l&&l<f){const w=b.indexOf(")");if(w<l)return null;f=b.indexOf(",",w)}if(-1===f){if(!ul.muf(c,b))return null;b=""}else{const w=b.substr(0,f);b=b.substr(f+1);if(!ul.muf(c,w))return null}}return c}catch(b){return null}}static iVc(a,b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static jKc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin=
"",b&&ul.ZFf(a,b))}static ZFf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&(a.style.margin=""),b&&ul.ZFf(a,b)),a=a.nextSibling}static ddj(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static qXj(a){return!(void 0===
a.className||null===a.className)&&a.className.startsWith("TextRun")}static nnj(a){a=a.style.textDecorationLine;return void 0===a||null===a?null:a}static Ckg(a){return 0<=a.indexOf("line-through")}static hE(a){return 0<=a.indexOf("underline")}}ul.qvl=(Wr=new Ka.a,Wr.add("TABLE"),Wr.add("THEAD"),Wr.add("TBODY"),Wr.add("TFOOT"),Wr.add("TR"),Wr.add("TH"),Wr.add("TD"),Wr);Object(n.a)(ul,"DefaultHtmlTranslator",th,[]);var Gm=d(312);class Yj{constructor(a=null){this.CS=a||Gm.a.dbe("");this.KBc=Number.parseInvariant((new Date).format("HHmmss"))}get Nb(){return this.CS}process(a,
b){if(a&&a.querySelectorAll){const w=a.querySelectorAll("p");if(w&&0<w.length){for(var c=0,f=!1,l=w[0].parentNode;5>c&&l&&l!==a;){c++;const H=l.id.toLowerCase();if(H&&H.length&&-1!==H.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),
c=l}a=new ii.a(b,Object(F.a)(this,this.jNe,"processNodesDiscovery"),new iC(w));a.Pl("Word Converter Operation");a.Qi=!b||b.Qi;a.run()}}}jNe(a,b){const c=b.nodes[b.l3];var f=Yj.I8d(c);if(f){let w=f.BMa.replace(RegExp("level[0-9]"),"").trim();w=w&&w.length?w:f.BMa;let H=b.lists[w];H||(H=new FH,H.eZ=this.KBc++);let U=H.dBb[f.level-1];U||(U=new GH,U.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(U.tagName=l)}else U.HYa=
Yj.o2f(c,5),U.HYa&&U.HYa.length||(U.HYa=Yj.iae(c,5)),U.ignore=!U.HYa||!U.HYa.length,U.tagName=Yj.YSc(U.HYa);f.eZ=H.eZ;U.Xjc++;U.ignore||"li"===c.parentNode.tagName.toLowerCase()||(l=(l=Yj.iae(c,5))?l:U.HYa)&&l.length&&(f.lXi=l,(l=Yj.Xcl(c,l,U.listStyle,f.level-1))&&l.length&&(U.listStyle=l));b.A9[b.A9.length]=f;U.A9.contains(f)||U.A9.add(f);if(void 0===H.dBb[f.level-1]||null===H.dBb[f.level-1]||H.dBb[f.level-1]!==U)H.dBb[f.level-1]=U;b.lists[w]&&b.lists[w]===H||(b.lists[w]=H);b.TAb=c}else if((f=b.TAb)&&
Yj.q6b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.l3++;if(b.nodes.length<=b.l3){if(!b.A9.length)return!1;b.l3=0;a.Yg(Object(F.a)(this,this.iNe,"processNodeConvert"))}return!0}iNe(a,b){a=b.A9[b.l3];var c=a.olc,f=a.BMa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.BMa;f=b.lists[f];var l=f.dBb[a.level-
1],w=c.parentNode.tagName.toLowerCase();if(!l.ignore&&c.parentNode&&"li"!==w){if(w=Yj.CFi(c,l)){Yj.g0b(c,5);const H=c.ownerDocument.createElement("LI");H.setAttribute("data-aria-level",String.format("{0}",a.level));for(H.setAttribute("data-listid",String.format("{0}",f.eZ));c.firstChild;)H.appendChild(c.firstChild);w.appendChild(H);c.parentNode.removeChild(c);"UL"===l.tagName?this.Nb.b++:this.Nb.c++}}else"li"===w&&(l=l.tagName,c=c.parentNode,a.gIb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc",
"true"),c.setAttribute("data-listid",String.format("{0}",f.eZ)),"UL"===l?this.Nb.b++:this.Nb.c++);b.l3++;return b.l3<b.A9.length}static CFi(a,b){a=Yj.zFi(a,b.tagName);return Yj.GXd(a,b)}static GXd(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static zFi(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",
c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?ul.iVc(c,"NumberListStyle"):ul.iVc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static g0b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&Yj.g0b(f,b-1);if(Yj.cke(f)||Yj.i$b(f))a.removeChild(f),c--}}static I8d(a){if(1===a.nodeType){var b=Yj.Q6b(a,"mso-list");if(b&&0<b.length)try{var c=
b.split(" ");if(3===c.length){var f=new jz;f.level=Number.parseInvariant(c[1].substr(5));f.BMa=b;f.olc=a;f.gIb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+Bc.a.EZb),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new jz,f.level=Number.parseInvariant(b),f.BMa=c+" level"+b,f.olc=a,f.gIb=!1,f}return null}static Xcl(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===Yj.YSc(b))return c=Yj.B5i(b),
Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?Yj.Bij(c,f):1,1!==f&&((c=Yj.sLc(a,l,RegExp("^[ivxlcdm]+"),ha.a.pJf,"NumberListStyle3"))||(c=Yj.sLc(a,l,RegExp("^[IVXLCDM]+"),ha.a.pJf,"NumberListStyle5")))||f&&((c=Yj.sLc(a,l,RegExp("^[a-z]+"),ha.a.oJf,"NumberListStyle2"))||
(c=Yj.sLc(a,l,RegExp("^[A-Z]+"),ha.a.oJf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static B5i(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static Bij(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static sLc(a,
b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static YSc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static iae(a,b){let c=null;var f;let l,w;for(let H=-1;!c&&H<a.childNodes.length;H++){const U=-1===H?a:a.childNodes[H];if(U)if((f=U.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(w=f.indexOf("\x3c!--[endif]--\x3e"),0<=w)){f=f.substring(l,w+14);U.innerHTML=
U.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=H&&1===U.nodeType&&1<b&&(c=Yj.iae(U,b-1))}return c}static o2f(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];Yj.i$b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=Yj.o2f(l,b-1))}return c}static i$b(a){return 1===a.nodeType&&
(a=Yj.Q6b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static cke(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static Q6b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static q6b(a){do a=a.previousSibling;while(a&&Yj.U9b(a));return a}static U9b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Yj.$Fd,
""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Yj.U9b(a.firstChild):!0}}Yj.$Fd=RegExp("[\n|\r]","gi");Object(n.a)(Yj,"WacAndRichClientWordConverter",null,[1060]);class PH{constructor(){this.eZ=0;this.tagName="UL";this.A4b=null;this.ignore=!1;this.Xjc=0}}Object(n.a)(PH,"ListMetadata",null,[]);class jl{constructor(a=null){this.KBc=1;this.CS=a||Gm.a.dbe("")}get Nb(){return this.CS}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&
0<a.length&&(a=new ii.a(b,Object(F.a)(this,this.jNe,"processNodesDiscovery"),new iC(a)),a.Pl("Word Converter Operation"),a.Qi=!b||b.Qi,a.run())}jNe(a,b){const c=b.nodes[b.l3];var f=jl.I8d(c);if(f){let l=b.xja[f.level-1];l||(l=new hC,b.xja[f.level-1]=l);b.TAb&&jl.q6b(c)!==b.TAb&&jl.Z2k(b);let w=l.Dqg[f.BMa];if(!w)w=new PH,w.eZ=this.KBc++,w.A4b=jl.x7d(c,5),w.ignore=!w.A4b||!w.A4b.length,w.tagName=jl.YSc(w.A4b),l.Dqg[f.BMa]=w,b.lists[w.eZ.toString()]=w;else if(!w.ignore&&1===w.Xjc){const H=jl.x7d(c,
5);w.tagName=w.A4b===H?"UL":"OL"}f.eZ=w.eZ;w.ignore||"OL"===w.tagName&&0<w.Xjc&&l.LMc!==f.eZ?(w.ignore=!0,b.xja[0].LMc=-1,b.xja=b.xja.slice(0,1)):(b.xja.length>f.level&&(b.xja=b.xja.slice(0,f.level)),l.LMc=f.eZ,b.A9[b.A9.length]=f,w.Xjc++);b.TAb=c}else if((f=b.TAb)&&jl.q6b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.l3++;
if(b.nodes.length<=b.l3){if(!b.A9.length)return!1;b.l3=0;a.Yg(Object(F.a)(this,this.iNe,"processNodeConvert"))}return!0}iNe(a,b){var c=b.A9[b.l3];a=c.olc;const f=b.lists[c.eZ.toString()];if(!f.ignore&&(c=jl.Hfj(a,c,f))){jl.g0b(a,5);const l=a.ownerDocument.createElement("LI");for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===f.tagName?this.Nb.b++:this.Nb.c++}b.l3++;return b.l3<b.A9.length}static Hfj(a,b,c){let f=jl.Tgh(a,b.level,c);const l=T.a.Be(f,
"UniqueListId");if(l&&l!==b.eZ||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;T.a.Sv(f,"UniqueListId",b.eZ);return jl.GXd(f,c)}static GXd(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(T.a.Sv(b,"UniqueListId",T.a.Be(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static Tgh(a,b,c){let f=null,l;1===b?l=jl.q6b(a):(f=jl.Tgh(a,
b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const w=l.tagName.toUpperCase();if("UL"===w||"OL"===w)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static g0b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&jl.g0b(f,b-1);if(jl.cke(f)||jl.i$b(f))a.removeChild(f),c--}}static I8d(a){if(1===a.nodeType){const b=jl.Q6b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=
new jz;f.level=Number.parseInvariant(c[1].substr(5));f.BMa=b;f.olc=a;return f}}catch(c){}}return null}static YSc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static x7d(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];jl.i$b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&(c=jl.x7d(l,b-1))}return c}static i$b(a){return 1===a.nodeType&&(a=jl.Q6b(a,"mso-list"))&&0<a.length&&"ignore"===
a.trim().toLowerCase()?!0:!1}static cke(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static Q6b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static q6b(a){do a=a.previousSibling;while(a&&jl.U9b(a));return a}static U9b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(jl.$Fd,""),!a.trim().length):1!==a.nodeType||
a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:jl.U9b(a.firstChild):!0}static Z2k(a){for(let b=0;b<a.xja.length;b++){const c=a.xja[b];c&&(c.LMc=-1)}}}jl.$Fd=RegExp("[\n|\r]","gi");Object(n.a)(jl,"WordConverter",null,[1060]);class pC{constructor(a){this.b3a=a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get K8a(){return this.b3a}create(a=null){return this.b3a?new Yj(a):new jl(a)}}Object(n.a)(pC,"Box4WordConverterFactory",null,[1042]);var QH=d(707);class RH{constructor(a,
b,c,f,l){this.Lbf=0;this.nd=a;this.zd=b;this.izd=l;this.GZ=c;this.gPa=f}jti(a,b,c){ka.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.zd.Wy);a.Qi&&this.zd.Vj&&window.chrome&&ka.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.GZ.Wca(!!(b&16));this.gPa.create(a,Object(F.a)(this,this.Q6e,"waitingForEnsureAccessOperationResult"),null).Pl("ClipboardPreProcess");this.Lbf=Date.now()}y3k(){this.GZ.reset()}Q6e(a){let b=
!0;const c=this.GZ.HTi,f=null==this.GZ.nTi;null!=c?(a.J5=c,b=!1):Date.now()-this.Lbf>this.izd&&!f&&(ka.ULS.sendTraceTag(18354843,307,50,null),this.nd.Xb(Ld.a.Qja,{["Reason"]:od.a.R8g}),b=a.J5=!1);return b}}Object(n.a)(RH,"ClipboardOperationClipboardAccessHelper",null,[1001]);class mz{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){this.Ca=a;this.nd=b;this.es=c;this.Fi=f;this.Tc=l;this.GZ=w;this.sr=H;this.jf=U;this.Vha=ja;this.AK=wa;this.Wha=Sa;this.Rpb=eb;this.Y4a=ub;this.jk=cc;this.wTb=Ub?Ub.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.RTb=Ub?Ub.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.eUb=Ub?Ub.ka("TextLayoutServiceUseResponse"):!1}get Qh(){return this.Fi}get Wc(){return this.nd}iLl(a){a.Bpa();return!0}EJf(a,b){a=b.ks;ka.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){B.a.zua&&u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.Hf&&b.Hf.zg&&(c=b.Hf.zg.Tn);let f=!1;this.wTb&&B.a.zua&&this.jk.smd(c,"data-src","data-srcurl");this.RTb&&(f=this.jk.M_b(b.Hf.zg.Tn,
b.Hf.Md,!0));this.eUb&&this.jk.hvd(c,!1);a=this.GZ.copy();this.wTb&&B.a.zua&&this.jk.smd(c,"data-srcurl","data-src");this.RTb&&f&&this.jk.M_b(b.Hf.zg.Tn,b.Hf.Md,!1);this.eUb&&this.jk.hvd(c,!0);if(!a)return ka.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Wc.Xb(Ld.a.P8a,{["Reason"]:od.a.j1e}),b.$0&&b.$0.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}l1b(a,b){const c=b.Hf;ka.ULS.shipAssertTag(18130961,307,!!(b.ks&16));b.Rol?this.es.eGf():this.es.OXd(c,a);return!0}gNc(a,
b){var c=b.context,f=b.rd;const l=b.UJ;var w=!1;a=this.Tc.Na.mb.Ye;if(this.sr.tm(a)||this.jf.Xl(a)){const H=this.AK.Mc(a.node);let U=H.Ze();ka.ULS.shipAssertTag(18130962,307,U);this.Vha.Re(H);this.Wha.fbb(H)&&(w=!0)}f=b.ks&64?new K.DictionaryPropertySet:f||new K.DictionaryPropertySet;f.setValue(Yd.a.Yub,!1);c=this.Ca.pi(c,D.a.bL,2,!0,l,f);8===c&&(ka.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Wc.Xb(Ld.a.Qja,{["Reason"]:od.a.cOf}),b.$0&&b.$0.fail("DeleteKey failed",!1),b.failed=!0);32===
c&&w&&(b=this.Tc.Na.mb,this.jf.ox(b)&&b.Ua.node===a.node&&!this.sr.textLength(b.Ua.node)&&(b=this.AK.Mc(b.Ua.node),a=this.jf.Gt(b),ka.ULS.shipAssertTag(18130964,307,a),this.Vha.Re(b),this.Wha.Azb(b)||(a=this.Rpb.create(),a.Rc(b),this.Vha.Rwa(a,!1,!1),w=this.Vha.oi(a),this.sr.ae(w)&&(this.Vha.Re(a),this.Qh.merge(a,b,!1,!1),this.Tc.setSelection(this.Y4a.Sg(w,this.sr.textLength(w)))))));return!0}}Object(n.a)(mz,"ClipboardOperationCutCopy",null,[1052]);class SH{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,
ub,Ub,cc){this.Ca=a;this.nd=b;this.es=c;this.GZ=w;this.Tc=l;this.Fi=f;this.sr=H;this.jf=U;this.Vha=ja;this.AK=wa;this.Wha=Sa;this.Rpb=eb;this.Y4a=ub;this.$a=Ub;this.jk=cc}create(){return new mz(this.Ca,this.nd,this.es,this.Fi,this.Tc,this.GZ,this.sr,this.jf,this.Vha,this.AK,this.Wha,this.Rpb,this.Y4a,this.$a,this.jk)}}Object(n.a)(SH,"Factory",null,[1E3]);class TH{Buh(){return!0}}Object(n.a)(TH,"ClipboardOperationCutStrategy",null,[993]);var Ps=d(466),qC=d(1225),rC=d(229);class $o{constructor(a,b,
c,f,l,w=null,H="",U=!0){this.Ysa=this.Wrd=this.LZa=this.vmd=null;this.m$b=!1;this.mee=null;this.DGe=0;this.context=a;this.Hf=a.view;this.ks=b;this.rd=l;this.$0=c;this.UJ=f;this.qLb=this.failed=!1;this.lhd=null;this.Mab=this.Xzb=!1;this.Rol=$o.vXd(a);this.browserName=H;this.DJh=U;this.tMa=!1;this.RQa=0;this.dWd=ia.a.create().toString();if(a=Object(Ya.a)(10,l)?l:null){this.LZa=new K.DictionaryPropertySet;this.LZa.ay(a);if(a.sa(Yd.a.bid,!1)){this.Xzb=!0;this.Mab=a.sa(Yd.a.Mab,!1);this.lhd=w;for(w=this.Hf.Mb.Qj;w.lx;)w=
w.getContext(0);if(l=Object(qa.a)(Sd.AParagraphNode,w.node)){c=0;f=zb.ParagraphReader.textLength(l);switch(w.contextId){case Cb.a.textRange:c=w.Qa;f=w.Lb;break;case Cb.a.endOfParagraph:c=f}this.vmd=Kb.a.aaj(w.node,c);ka.ULS.shipAssertTag(6305503,307,!!this.vmd);l=vb.HyperlinkReader.T5b(l);for(const ja of l)ja.Lb<=c||ja.Qa>=f||$o.hyperlinkEditor.CM(w.node,ja.hyperlink)}}this.qLb=a.sa(Yd.a.qLb,!1);this.tMa=a.sa(Yd.a.tMa,!1)}b&64&&(this.qLb=!0)}static get Wc(){return Nc.a.instance}static get hyperlinkEditor(){return $o.zn||
($o.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static vXd(a){if(a){if(a.lx){for(let b=0;b<a.length;b++)if($o.vXd(a.getContext(b)))return!0;return!1}if(Object(Ya.a)(rC.a,a))return $o.vXd(a.CE);if(zb.ParagraphReader.ae(a.node)&&a.node.nC)return!0}return!1}}$o.zn=null;Object(n.a)($o,"ClipboardActionArguments",null,[]);var wv;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";
a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(wv||(wv={}));Object(n.b)("ClipboardActionFlags",wv);const UH=a=>{a=a.Na.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},VH=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),
b[c]=b[c]?b[c]+1:1;a="";for(let f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};class WH extends Ps.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug=!0){super();this.RKd=this.Rba=this.Z6=this.bC=null;this.init(a);this.Pl("ClipboardOperation");this.QEa(ja,b,l,w,H);this.nd=wa;this.jf=Sa;this.zd=eb;this.Bk=ub;this.a$e=Ub;this.d$e=cc;this.b$e=Fc;this.e$e=Ic;this.bxc=Cc;this.ozd=Ud;this.cRb=U;this.UQb=je;this.gPa=Vd;this.b4h=Ug;this.JD=Ve;this.fd=
af;this.Xs=Zf;this.Tba=lg;this.vu=f;this.wBa=Tg;H&&Object(Ya.a)(10,H)&&(this.Rba=Object(qa.a)(1064,H.sa(Yd.a.EQa,null)));this.Rba||(this.Rba=this.wBa.S_e());this.d2a=void 0===c||null===c?"NotAvailable":Object(qC.a)(wv,c);this.Rba.$ei(this.d2a.split(", "));a=this.vu;a.view.Nh?(this.Lg=a.view,this.Lg.Mb?(this.lI=0,this.vV=c,this.Kqb=Ic.iIb,!Ug||this.Kqb&&this.Kqb.mb&&this.Kqb.length?(Ic=nb.SelectionEditor.ox(this.Kqb.mb),Ic=!(this.vV&16&&Ic),Ic=Ud.cMj(c,this.Qj)&&Ic,1!==this.behavior&&Ic||(Ic||this.Rba.fail("Clipboard operation disabled for selection",
!0),this.Gp=Ic?32:8,this.KY())):(this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),this.Rba.fail("No selection when one required",!0),this.Gp=8,this.finish())):(this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),this.Rba.fail("No selection manager",!1),this.Gp=8,this.finish())):(this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.sed}),this.Rba.fail("Not in interactive view",!0),this.Gp=8,this.finish())}get Qj(){this.RKd||(this.RKd=de.a.Isb(this.Kqb));return this.RKd}j1(){super.j1();this.Kqb=null}run(){0===this.lI&&
this.setup();1===this.lI&&this.process();2===this.lI&&this.teardownSync();3===this.lI&&this.teardownAsync();4===this.lI&&this.finish()}setup(){if(this.vV&256&&this.cRb){this.ax||this.bxc.jti(this,this.vV,this.d2a);this.ax.run();if(this.ax.inProgress)return;const a=this.ax.J5;this.eKc();if(!a){this.Rba.fail("No access to system clipboard",!0);this.Gp=8;this.lI=4;this.k3j();return}}else ka.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.vV,this.d2a,this.zd.Wy);
this.vV&32&&!this.jf.pZc(this.Lg.Mb.Qj)?(ka.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.ZZd}),this.Rba.fail("Cut not allowed",!0),this.UQb.show(),this.Gp=8,this.lI=4):(this.vV&4096&&(this.Tba.Vkd(Object.assign(new Hj.a,{Fjg:!0,r$g:this.d2a})),this.Xs.undo()),this.ozd.jKk(this.vV),this.bC=this.Bk.oe(15),this.bC.kd(this.Lg.xg),this.lI=1)}process(){if(!this.ax){ka.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.vV,this.d2a,
this.zd.Wy);ka.ULS.shipAssertTag(6305507,307,!this.Z6);this.Z6=new $o(this.vu,this.vV,this.Rba,this.UJ,this.uV,void 0,this.zd.Wy,this.b4h);let a;a=this.vV&65536?Object(F.a)(this.a$e,this.a$e.process,"process"):this.vV&64?Object(F.a)(this.d$e,this.d$e.process,"process"):this.vV&1?Object(F.a)(this.e$e,this.e$e.process,"process"):Object(F.a)(this.b$e,this.b$e.process,"process");this.vV&16&&this.Lg.Mb.hpa.g5d();this.gPa.create(this,a,this.Z6).Pl("ClipboardAction")}ka.ULS.shipAssertTag(6305536,307,!!this.ax);
this.ax.run();this.ax.inProgress||(this.eKc(),this.lI=this.Qi?2:3)}teardownSync(){this.Z6.Xzb&&(this.bC.jd=D.a.typing);this.Z6.m$b&&this.bC.Rcd(this.Z6.mee,this.Z6.DGe);this.bC.dispose();this.Gp=this.Z6.failed?8:32;this.lI=4}teardownAsync(){if(this.ax){if(this.ax.run(),this.ax.inProgress)return}else if(this.Z6.Xzb&&(this.bC.jd=D.a.typing),this.bC.XU(this),this.Z6.m$b&&this.bC.Rcd(this.Z6.mee,this.Z6.DGe),this.bC.dispose(),this.iGc)return;this.Gp=this.Z6.failed?8:32;this.lI=4}finish(){this.Tba.Vkd(Object.assign(new Hj.a,
{Fjg:!1}));this.KY();32===this.response?ka.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.vV,this.d2a,this.zd.Wy):ka.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.vV,this.d2a,this.zd.Wy);this.wBa.vDa(this.Rba)}k3j(){var a=!!(this.vV&1),b=this.vu.view;if(b){var c=b.Mb;b=this.zd.Wy;u.AFrameworkApplication.Ta.processAction(D.a.TMf,
2);a?ka.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(ka.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=UH(c),1===a.length?ka.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=VH(a),ka.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}
Object(n.a)(WH,"ClipboardOperation",Ps.a,[]);class XH{constructor(a,b){this.qxc=null;this.es=a;this.AV=b;this.XB=0}process(a,b){this.XB||(this.qxc=[Object(F.a)(this,this.gCi,"copyGlossarySelection"),Object(F.a)(this.AV,this.AV.UEk,"pasteGlossaryPlaceholder")]);let c=!0;this.XB<this.qxc.length&&(c=this.qxc[this.XB++](a,b));return c?this.XB<this.qxc.length:!1}gCi(a,b){if(!Object(Ya.a)(10,b.rd))return!1;const c=Object(qa.a)(10,b.rd);if(!c.Sa(Yd.a.W9f))return!1;const f=c.eb(Yd.a.W9f),l=b.Hf,w=l.Mb;this.es.MIl();
w.xnd(()=>{w.setSelection(f,void 0,!0);this.es.OXd(l,a)},!0);return!0}}Object(n.a)(XH,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[1063]);class YH{constructor(a){this.N2a=null;this.bS=a;this.XB=-1}process(a,b){-1===this.XB&&(this.jKi(a,b),this.XB=0);let c=!1;this.XB<this.N2a.length&&(c=this.N2a[this.XB++](a,b));return c?this.XB<this.N2a.length:!1}jKi(a,b){B.a.q9||b.ks&512?(this.N2a=[Object(F.a)(this.bS,this.bS.l1b,"copyInternal")],ka.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.Qi&&b.ks&256?(this.N2a=[Object(F.a)(this.bS,this.bS.iLl,"waitBeforeCopy"),Object(F.a)(this.bS,this.bS.EJf,"copyExternal"),Object(F.a)(this.bS,this.bS.l1b,"copyInternal")],ka.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.N2a=[Object(F.a)(this.bS,this.bS.EJf,"copyExternal"),Object(F.a)(this.bS,this.bS.l1b,"copyInternal")],ka.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
b.ks&32&&(a=Object(F.a)(this.bS,this.bS.gNc,"deleteForCut"),this.N2a.push(a),ka.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;ka.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.Hf)if(b=UH(b.Hf.Mb),1===b.length)ka.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=VH(b);ka.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",
b.length,c,a)}}}Object(n.a)(YH,"ClipboardOperationCutCopyProcessor",null,[1062]);class ZH{constructor(a,b,c,f){this.FBc=null;this.es=a;this.Tc=b;this.bS=c;this.AV=f;this.XB=0}process(a,b){this.XB||(this.FBc=[Object(F.a)(this,this.kCi,"copyMovedSelection"),Object(F.a)(this.bS,this.bS.gNc,"deleteForCut"),Object(F.a)(this,this.B_g,"moveIp"),Object(F.a)(this.AV,this.AV.z$g,"pasteInternal"),Object(F.a)(this.AV,this.AV.xsh,"setSelectionAfterPaste")]);let c=!0;this.XB<this.FBc.length&&(c=this.FBc[this.XB++](a,
b));return c?this.XB<this.FBc.length:!1}kCi(a,b){b=b.Hf;this.es.zIl();this.es.OXd(b,a);return!0}B_g(a,b){b=new gb.Selection([b.rd],!0);this.Tc.setSelection(b,a);return!0}}Object(n.a)(ZH,"ClipboardOperationMoveProcessor",null,[1050]);class $H{constructor(a,b,c,f,l,w){this.AId=null;this.Zlf=0;this.nd=f;this.zd=b;this.AV=l;this.XCd=c;this.cRb=u.AFrameworkApplication.Vqd()&&!(B.a.zT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.izd=a.appSettings.ChromeClipboardAccessOperationTimeout;
this.XB=0;this.GPh=w}get iIb(){return this.AV.iIb}process(a,b){if(0===this.XB)return this.bFk(b);if(1===this.XB)return this.prepareForPaste(a,b);if(2===this.XB)return this.XB=3,this.AId(a,b);3===this.XB&&this.AV.xsh(a,b);return!1}bFk(a){this.zd.q9||a.ks&512?(this.AId=a.ks&2?Object(F.a)(this.AV,this.AV.paste,"paste"):Object(F.a)(this.AV,this.AV.z$g,"pasteInternal"),this.XB=2):(this.cRb?(this.XB=1,this.Zlf=Date.now()):this.XB=2,this.AId=Object(F.a)(this.AV,this.AV.paste,"paste"));ka.ULS.sendTraceTag(18617486,
307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.XCd.value.hch())this.XB=2;else{const c=Date.now()-this.Zlf;c>this.izd&&(ka.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.nd.Xb(Ld.a.Qja,{["Reason"]:od.a.R8g}),b.$0&&b.$0.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.GPh.y3k())}return a}}Object(n.a)($H,"ClipboardOperationPasteProcessor",null,[1049]);class aI{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){this.es=a;this.Ca=
b;this.cRb=c;this.nd=f;this.jf=l;this.zd=w;this.Bk=H;this.KPh=U;this.IPh=ja;this.bxc=wa;this.ozd=Sa;this.UQb=eb;this.gPa=ub;this.JD=Ub;this.fd=cc;this.Xs=Fc;this.Tba=Ic;this.wBa=Cc}create(a,b,c,f,l,w,H,U,ja=!0){const wa=this.KPh.create(f,Object(qa.a)(10,U));var Sa=this.IPh.create();const eb=new XH(this.es,wa),ub=new ZH(this.es,de.a.instance,Sa,wa);Sa=new YH(Sa);f=new $H(u.AFrameworkApplication.fa,id.a.instance,f,Nc.a.instance,wa,this.bxc);return new WH(a,b,c,l,w,H,U,this.cRb,this.Ca,this.nd,this.jf,
this.zd,this.Bk,eb,ub,Sa,f,this.bxc,this.ozd,this.UQb,this.gPa,this.JD,this.fd,this.Xs,this.Tba,this.wBa,ja)}}Object(n.a)(aI,"Factory",null,[1003]);class nz{constructor(a,b){this.D$a=a.lTc(b);this.XXd=a.d8i(b);this.g7a=a.fSc(b);this.hQa=a.TRc(b)}static LW(a){return nz.xr(a)}static xr(a){return new nz(Lc.a.instance,a)}}Object(n.a)(nz,"CpUsageHelper",null,[]);var Qs=d(177);class bI{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.nd=a;this.es=b;this.KVb=c;this.fca=f;this.Tc=l;this.Ca=w;this.XCd=H;this.UXb=
ja;this.DId=U;this.HAd=wa;this.nzd=Sa;this.fd=eb}get Mn(){return this.UXb.value}get aba(){return this.fca}get Wc(){return this.nd}get iIb(){return this.DId.iIb}paste(a,b){const c=this.fd.tsb();try{const f=b.Hf;ka.ULS.shipAssertTag(18131010,307,!!(b.ks&1));Object(Ya.a)(10,b.rd)&&b.rd.setValue(Qs.a.k3b,f.zg.Tn.clientWidth);this.nzd.TBl(a,b);let l;if(!({oLc:l}=this.XCd.value.MEh()).returnValue)return b.$0&&b.$0.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.Mn.uw();let w=!0,H=null;const U=
this.HAd.create(l),ja=b.DJh;f.Mb.xnd(()=>{ja&&2===this.Ca.processAction(D.a.$Ca,2)?w=!1:(H=ja?this.Tc.Na.mb.Ua:b.rd,ka.ULS.shipAssertTag(18158338,307,nb.SelectionEditor.Tg(H)),this.Arg(H,"paste"))},this.DId.Qlg);if(!w)return!1;f.editingView.disable(!0,25);U.restore();this.KVb.OEk(l,H,a);return!0}finally{c&&c.dispose()}}UEk(a,b){this.Mn.uw();const c=(new MF.a).oe(15);c.kd(this.es.p2e);b=Object(qa.a)(10,b.rd).eb(Yd.a.Cqj);ka.ULS.shipAssertTag(20492440,307,nb.SelectionEditor.Tg(b));this.KVb.qgg(b,a);
this.es.eGf();c.dispose();return!0}z$g(a){this.Mn.uw();this.Ca.processAction(D.a.$Ca,2);const b=this.Tc.Na.mb.Ua;ka.ULS.shipAssertTag(18158339,307,nb.SelectionEditor.Tg(b));this.Arg(b,"intPaste");this.KVb.qgg(b,a);return!0}Arg(a,b){b=nz.LW(b);this.aba.hTk(b,a.node,a.Qa);this.aba.l3j(b.XXd);this.aba.Xoe(b.D$a);this.aba.Roe(b.g7a);this.aba.Qoe(b.hQa)}xsh(a,b){if(!b.DJh)return!1;b.ks&64&&this.es.LIl();if(!b.Ysa)return ka.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Wc.Xb(Ld.a.R1,
{["Reason"]:od.a.wgg}),b.$0&&b.$0.fail("No selection after paste",!1),b.failed=!0,!1;this.DId.rIl(b);this.Mn.uw();return!1}}Object(n.a)(bI,"ClipboardOperationPaste",null,[1048]);class cI{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.nd=a;this.es=b;this.KVb=c;this.fca=f;this.Tc=l;this.Ca=w;this.UXb=U;this.iZh=H;this.HAd=ja;this.nzd=wa;this.fd=Sa}create(a,b){b=this.iZh.create(this.Tc,b);return new bI(this.nd,this.es,this.KVb,this.fca,this.Tc,this.Ca,a,b,this.UXb,this.HAd,this.nzd,this.fd)}}Object(n.a)(cI,
"Factory",null,[999]);class dI{constructor(a,b){this.e2h=a;this.YYh=b}get stylePropertySet(){return this.e2h}get KDk(){return this.YYh}}Object(n.a)(dI,"ParagraphFormatStore",null,[]);class eI{constructor(a,b,c,f){this.Tc=a;this.sr=b;this.LK=c;this.LVh=f}TBl(a,b){if(b.Xzb&&this.LVh){b=a.J5;var c=this.Tc.Na.mb.Ua.node,f=null;this.sr.ae(c)&&(f=this.LK.aE(c),c=this.sr.Cta(c),f=new dI(f,c));b=new $o(b.context,b.ks,b.$0,b.UJ,b.rd,f);a.J5=b}}}Object(n.a)(eI,"ClipboardOperationPasteOvertypeStrategy",null,
[998]);class tx{constructor(a){this.fGd=null;this.Tc=a;a.xnd(b=>{this.fGd=b},!1)}get Qlg(){return!1}rIl(a){a=this.bZb(a);this.setSelection(this.Tc,a)}bZb(a){let b=a.Ysa;(a.tMa||a.qLb)&&a.Wrd&&(b=Od.SelectionFactory.GN(a.Wrd,b.Ua));return b}setSelection(a,b){a.setSelection(b)}}Object(n.a)(tx,"AClipboardOperationPasteStrategy",null,[1072]);class fI extends tx{constructor(a){super(a)}get iIb(){return this.fGd}}Object(n.a)(fI,"ClipboardOperationPasteToLiveSelectionStrategy",tx,[]);class gI extends tx{constructor(a,
b){super(a);this.VNd=null;this.bVb=b;a.xnd(c=>{this.VNd=c},!0)}get Qlg(){return!0}get iIb(){return this.VNd}bZb(a){let b=super.bZb(a);a.rd.setValue(Yd.a.hFk,b);return b=this.bVb.BOl(this.fGd.mb,this.VNd.mb,b)}}Object(n.a)(gI,"ClipboardOperationPasteToVirtualSelectionStrategy",tx,[]);class hI{constructor(a){this.bVb=null;this.UNd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.sa(Yd.a.tMa,!1)&&this.UNd?new gI(a,this.OKl):new fI(a)}get OKl(){this.bVb||(this.bVb=Ab.a.instance.rb("Box4.Actors.IVirtualSelectionMerger"));
return this.bVb}}Object(n.a)(hI,"ClipboardOperationPasteStrategyFactory",null,[1002]);class sC{constructor(a,b,c,f,l,w){this.nd=a;this.Tc=b;this.gha=c;this.DD=f;this.mVh=l;this.$Vh=w}jKk(a){this.$Vh&&(a&1||a&32)&&this.gha.vw&&this.Tc.sYb()}cMj(a,b){return this.mVh?a&1&&this.DD.C7a(b)?(this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),!1):!0:!0}}Object(n.a)(sC,"ClipboardOperationWordStrategy",null,[]);class iI{constructor(a){this.GQh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}KBi(a,b){if(b)if(b=
b.sheet)if(b=b.cssRules){var c=Array.clone(b);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");this.GQh&&c.reverse();var f=b=0,l=0,w=0;for(const U of c){c=U.style;var H=U.selectorText;c=c?c.cssText:null;H=H?H.split(","):null;if(c&&H&&U.type===U.STYLE_RULE){w+=H.length;for(const ja of H){0<=ja.indexOf("#")&&b++;0<=ja.indexOf(".")&&f++;0>ja.indexOf("#")&&0>ja.indexOf(".")&&l++;H=null;try{H=a.querySelectorAll(ja)}catch(wa){ka.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ja,wa.message)}if(H)for(let wa=0;wa<H.length;wa++)H[wa].setAttribute("style",c+(H[wa].getAttribute("style")||""))}}}ka.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",w,b,f,l)}else this.Trg();else this.Trg()}Trg(){ka.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
B.a.Wy)}}Object(n.a)(iI,"ExternalPasteCssConverter",null,[1007]);var oz=d(1232);class ux{constructor(a){this.FV=this.iUb=null;this.yXb=a.currentNode;const b=new ob.GraphIterator;b.Rc(a);this.fId=new ob.GraphIterator;this.fId.Rc(a);this.bId=b.origin;this.fzd=Array(b.depth);this.snb=Array(b.depth);this.gzd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.snb[a]=b.role;this.gzd[a]=c;b.zc();this.fzd[a]=b.i6i(c,this.snb[a])}}em(a,b){this.iUb=a;this.FV=b}restore(a){const b=new oz.a,c=
new oz.a;this.pmh(a,b,c);return c.value}pmh(a,b,c){b.value=!0;if(this.fId.isValid)a.Rc(this.fId),c.value=!1;else{for(let f=this.gzd.length-1;0<=f;--f){const l=this.gzd[f];if(l.anchor&&!l.anchor.$I&&(a.set(l),a.Vaa(this.bId)||this.bId.Bke&&a.JFh())){c.value=this.JUf(a,f+1);return}b.value=!1}a.set(this.bId);c.value=this.JUf(a,0)}}JUf(a,b){let c=!1,f,l;f=this.fzd[b];l=this.snb[b];const w=a.H8(l);if(f<w)a.$p(f,l);else if(c=!0,!a.aB(l))return!0;if(!this.G_g(a,l))return c;for(b+=1;b<this.fzd.length;++b){if(c){if(!a.aB(this.snb[b]))return!0}else if(!a.Bb(this.snb[b]))return!1;
if(!this.G_g(a,this.snb[b]))break}return c}G_g(a,b){if(this.iUb&&!this.iUb(a,this.FV)){const c=new ob.GraphIterator;c.Rc(a);let f=!0;do if(!a.Cf(b)){f=!1;break}while(!this.iUb(a,this.FV));if(!f){a.Rc(c);do if(!a.JF(b))return a.zc(),!1;while(!this.iUb(a,this.FV))}}return!0}}Object(n.a)(ux,"NodeReference",null,[]);var nn=d(185);class Fj{constructor(a,b,c,f){this.hXb=this.Zo=this.Wg=this.Yw=this.KK=this.mI=null;this.GDd=!1;this.QQh=100;this.Rpb=this.GId=this.bNa=this.fd=this.JD=this.ap=this.rDh=null;
this.B7k=()=>{this.GDd&&this.Pwc&&fm.a.instance.Mg(this.Pwc);this.Pwc||(this.Pwc=new Le.a(3,1,this.QQh,()=>{this.uUd();this.GDd=!1},215));fm.a.instance.Db(this.Pwc);this.GDd=!0;return!1};this.ezb=a;this.U4d=this.Thb=null;this.Bg=b;this.transaction=c;this.qia=f}get fa(){return u.AFrameworkApplication.fa}get jP(){return this.KK||(this.KK=Ab.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.Yw||(this.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}get LJ(){return this.mI||
(this.mI=Ab.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get HB(){return Fj.Ux||(Fj.Ux=Ab.a.instance.resolve("Box4.IOutlineEditor"))}get Rf(){return this.Wg||(this.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}get fq(){return this.Zo||(this.Zo=Ab.a.instance.resolve("Box4.List.IListEditor"))}get $rc(){return this.hXb||(this.hXb=Ab.a.instance.rb("Box4.List.ISingleLevelListEditor"))}get F6(){return this.ap||(this.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get cuc(){return this.JD||
(this.JD=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Sf(){return this.fd||(this.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get cVd(){return this.bNa||(this.bNa=Ab.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get TEk(){return this.Tba||(this.Tba=Ab.a.instance.resolve("Box4.IPasteFloatieEventSource"))}get vtc(){return this.Y2h||(this.Y2h=Ab.a.instance.resolve("Box4.ITextPasteFloatieManager"))}get aid(){return this.GId||
(this.GId=Ab.a.instance.rb("Box4.IPastedParagraphSpaceHandler"))}set aid(a){this.GId=a}get T$g(){return!1}get Nuh(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}mUf(){}E$g(a){var b=void 0===this.Bg.ks||null===this.Bg.ks?"not available":Object(qC.a)(wv,this.Bg.ks);ka.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Bg.ks,b);ka.ULS.shipAssertTag(6305487,307,nb.SelectionEditor.Tg(this.ezb));if(this.wed)return ka.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Bg.Ysa=Od.SelectionFactory.Fu(this.ezb),
a.Yg(Object(F.a)(this,this.uZa,"pasteTeardown")),!0;b=new ob.GraphIterator;b.set(this.ezb.node);nb.SelectionEditor.Gt(b);Pa.OutlineElementNavigator.Re(b);this.rDh=b.origin;if(this.T$g)return b.LB(10),this.mUf(b,a),a.Yg(Object(F.a)(this,this.Tel,"setSelectionAfterPastingOutlines")),!0;if(xf.b(b)){if(this.gig)return this.Bg.Ysa=this.aFk(this.ezb,this.QIf),a.Yg(Object(F.a)(this,this.uZa,"pasteTeardown")),!0;this.ezb=this.ook(b).ga(0)}this.$ql(this.ezb);const c=new nn.a;c.Rc(b);Pa.OutlineElementNavigator.HJ(c,
!1,!1);this.Thb=new ux(b);this.U4d=new ux(c);a.Yg(Object(F.a)(this,this.REk,"pasteExecution"));return!0}REk(a){fd.a.mark(5568);this.lUf(a);let b=Object(F.a)(this,this.Pmk,"mergeAfterPaste");if(this.Ukg){const c=this.Bvh();c&&(b=Object(F.a)(this,this.uZa,"pasteTeardown"));ka.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.Yg(b);return!0}Bvh(){return!1}get Ukg(){return this.fa.ka("PptCcpFix2IsEnabled")}get ljl(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}Pmk(a){fd.a.mark(5569);
var b=new ob.GraphIterator;this.Thb.restore(b);this.Thb=null;var c=new ob.GraphIterator;this.U4d.restore(c);this.U4d=null;ka.ULS.shipAssertTag(6305489,307,fe.OutlineElementReader.$g(b));ka.ULS.shipAssertTag(6305490,307,fe.OutlineElementReader.$g(c));Pa.OutlineElementNavigator.oi(b);zb.ParagraphReader.el(b)&&zb.ParagraphReader.textLength(b.currentNode);Pa.OutlineElementNavigator.Re(b);Pa.OutlineElementNavigator.oi(c);ka.ULS.shipAssertTag(6305491,307,zb.ParagraphReader.el(c));var f=zb.ParagraphReader.textLength(c.currentNode);
Pa.OutlineElementNavigator.Re(c);const l=this.Zuh;var w=new nn.a;w.Rc(b);Pa.OutlineElementNavigator.HJ(w,!1,!1);var H=w.currentNode===c.currentNode;var U=!!this.Bg&&!!(this.Bg.ks&8192);let ja=!1;!U&&this.Bg.rd&&Object(Ya.a)(K.DictionaryPropertySet,this.Bg.rd)&&2===Pc.App.mode&&(U=(U=this.Bg.rd.Mh(Yd.a.yhb))&&""!==U?!0:!1);if(H)w=ob.GraphIterator.nb(b.currentNode),zb.ParagraphReader.ps(Pa.OutlineElementNavigator.oi(w))||(b=c),b.currentNode.id!==c.currentNode.id&&(ka.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",rb.ListReader.vk(b),rb.ListReader.vk(c)),w=Fj.Qh.merge(b,c,!0,U),ka.ULS.shipAssertTag(6305492,307,w)),c=b,U=!0;else{var wa=!!(this.Bg.ks&4);H=this.Sf.hg&&this.Sf.Yy&&wa&&this.Bg.Mab;this.aid&&this.Bg&&2===Pc.App.mode&&!wa&&(this.aid.Oxj(b,!1),this.aid.Oxj(c,!0));Pa.OutlineElementNavigator.oi(w);zb.ParagraphReader.el(w)&&zb.ParagraphReader.textLength(w.currentNode);Pa.OutlineElementNavigator.Re(w);this.mgi(w,
b,c);if(this.cVd.I_b||this.ljl)if(wa=new nn.a,wa.Rc(w),Pa.OutlineElementNavigator.HJ(wa,!1,!1),wa.yq.id!==c.yq.id){for(;w.currentNode.id!==c.currentNode.id;)Pa.OutlineElementNavigator.oi(w,!1),Id.a.create(w.currentNode),w.zc(),Pa.OutlineElementNavigator.HJ(w,!1,!1);w.Rc(b);Pa.OutlineElementNavigator.HJ(w,!1,!1)}else ja=!0;if(this.Bg.vmd&&(ka.ULS.shipAssertTag(6305493,307,this.Bg.Xzb),wa=new ob.GraphIterator,wa.Rc(w),wa=Pa.OutlineElementNavigator.oi(wa))){var Sa=this.Bg.vmd.ee(wa.Ra.ga(0));wa.Ra.ga(0).formatting=
Sa}rb.ListReader.vk(b)?(Fj.KL.jac&&this.$rc&&this.$rc.LOl(b),wa=rb.ListReader.vk(w)?this.$uh:!0):fe.OutlineElementReader.isEmpty(b,!0)?(Fj.Qh.gDa(b),wa=!1):wa=rb.ListReader.qx||!rb.ListReader.vk(w);this.Bg.Wrd=null;if(this.Bg.qLb||this.Bg.tMa)this.Bg.Wrd=this.Jlj(wa?b.currentNode:w.currentNode,wa);if(wa&&(Sa=rb.ListReader.vk(b),ka.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Sa,rb.ListReader.vk(c)),Fj.Qh.merge(b,w,!0,U,c,void 0,
ja,H),rb.ListReader.vk(b)&&this.Rf.enc)){var eb=new nn.a;eb.Rc(b);Pa.OutlineElementNavigator.HJ(eb,!1,!1);if(eb.yq.id!==c.yq.id){var ub=this.Rf.lw(b);this.Rf.qna(b);const Fc=b.currentNode.sa(Va.a.listID,0);b.zc();for(ub.yA=rk.a.Nw;eb.currentNode.id!==c.currentNode.id;){if(!rb.ListReader.vk(eb))({kab:ub}=this.fq.Vrb(ub.propertySet,eb,ub));else if(Sa){var Ub=this.Rf.edj(eb),cc=this.Rf.M8d(b.currentNode,Fc,Ub);cc=cc?cf.a.NCa(cc,null):ub;Ub=cf.a.yN(cc.listType,ub.listStyle,null,0,Ub,"","");Ub.jrk=b.currentNode;
this.fq.Ndl(Ub);this.fq.nWe(eb,!0)}Pa.OutlineElementNavigator.HJ(eb,!1,!1)}}}l?(Sa=new nn.a,Sa.Rc(c),Pa.OutlineElementNavigator.Rwa(Sa,!1,!1),eb=rb.ListReader.vk(Sa),ub=rb.ListReader.vk(c),U=Fj.Qh.merge(Sa,c,!0,U,void 0,!0,void 0,H),ka.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",eb,ub,U?"True":"False, will cause IP to reset to zero."),c=U?Sa:c):(U=!1,ka.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.cVd.I_b&&ja&&(wa?(w=new ob.GraphIterator,w.Rc(b),Pa.OutlineElementNavigator.oi(w)):l?(b=new ob.GraphIterator,b.Rc(w),Pa.OutlineElementNavigator.oi(b)):(b=new ob.GraphIterator,b.Rc(w),b=Pa.OutlineElementNavigator.oi(b),Id.a.create(b)))}ka.ULS.shipAssertTag(6305494,307,c.isValid);b=Pa.OutlineElementNavigator.oi(c);f=U?zb.ParagraphReader.textLength(b)-f:0;w=!1;Object(Ya.a)(10,this.Bg.rd)&&(w=this.Bg.rd.sa(Yd.a.e_c,!1));w&&R.a.instance.ga(11)?this.Bg.Ysa=Od.SelectionFactory.k3(b,f-1,f):this.Bg.Ysa=
Od.SelectionFactory.Sg(b,f);R.a.instance.ga(71)&&this.Bg&&this.Bg.Xzb&&zb.ParagraphReader.ae(b)&&this.Bg.lhd&&((f=this.Bg.lhd.stylePropertySet)&&this.jP.Eaa(f,b,!0),(f=this.Bg.lhd.KDk)&&this.paragraphEditor.iyf(b,f));a.Yg(Object(F.a)(this,this.uZa,"pasteTeardown"));return!0}mgi(a,b,c){var f=!1;this.Sf.hg&&this.Sf.Yy&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){Pa.OutlineElementNavigator.oi(a,!1);f=this.cuc.Tql(Id.a.create(a.currentNode));f.l9f();for(let l=0;l<f.length;l++){let w;const H=({nog:w}=
f.getContext(l)).returnValue;w&&Fj.hyperlinkEditor.XGb(H,1)}a.zc();Pa.OutlineElementNavigator.HJ(a,!1,!1)}a.Rc(b);Pa.OutlineElementNavigator.HJ(a,!1,!1)}}Jlj(a,b){a=ob.GraphIterator.nb(a);Pa.OutlineElementNavigator.oi(a);return zb.ParagraphReader.ae(a.currentNode)?(b=b?zb.ParagraphReader.textLength(a.currentNode):0,Od.SelectionFactory.Sg(a.currentNode,b)):hd.TableReader.zbb(a.currentNode)?Od.SelectionFactory.wl(a.currentNode):null}Tel(a){const b=ob.GraphIterator.nb(this.rDh);b.aB(1);this.Bg.Ysa=Od.SelectionFactory.uj(b.currentNode,
!1);a.Yg(Object(F.a)(this,this.uZa,"pasteTeardown"));return!0}uZa(a){var b=void 0===this.Bg.ks||null===this.Bg.ks?"not available":Object(qC.a)(wv,this.Bg.ks);ka.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Bg.ks,b);ka.ULS.shipAssertTag(6305497,307,!!this.Bg.Ysa);this.transaction.dispose();b=this.qia.PK;if(!b.Nh||!b.editingView.Wl)return!1;b.editingView.Gvl();return this.fa.ka("IsPasteTextFloatieEnabled")?(a.Yg(this.B7k,"scheduleCallPasteFloatieTask"),!0):!1}uUd(){this.TEk.MPe(new Vi(1,
u.AFrameworkApplication.isRtl));this.Bg&&this.Bg.ks&&(1===this.Bg.ks?this.vtc.S_=D.a.d8:257===this.Bg.ks?this.vtc.S_=D.a.paste:8449===this.Bg.ks?this.vtc.S_=D.a.O5:4097===this.Bg.ks?this.vtc.S_=D.a.reformatPastedContent:12289==this.Bg.ks&&(this.vtc.S_=D.a.f_a))}xil(a,b){const c=new ob.GraphIterator;c.Rc(a);a=Pa.OutlineElementNavigator.oi(c);b=zb.ParagraphReader.ae(a)&&b===zb.ParagraphReader.textLength(a);ka.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}$ql(a){ka.ULS.shipAssertTag(6305498,
307,nb.SelectionEditor.Tg(a));const b=ob.GraphIterator.nb(a.node);var c=b.Ze();Pa.OutlineElementNavigator.Re(b);ka.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=Fj.Qh.i9b(b,!0);const f=this.xil(b,a.Qa);Fj.Qh.wNb(b,c,a,!1,!1,f)}aFk(a,b){ka.ULS.shipAssertTag(6305500,307,a.contextId===Cb.a.Of);const c=a.node;b=b.replace(ha.a.$Ac," ");Fj.characterPropertiesEditor.replaceTextRange(a,b);return Od.SelectionFactory.Sg(c,
a.Qa+b.length)}ook(a){a.fv();Fj.Zl.HKa(a);const b=Fj.Jk.r5f(a),c=this.LJ.F1b(a);b?tq.c(a.currentNode,b+1,b+2):this.HB.zpd(c,Pc.App.Kb.Ld.Dn.j7b());this.HB.h9b(a,null,!0);return Od.SelectionFactory.uj(a.currentNode,!0)}static get Zl(){return Gy.PageNavigator.instance}static get characterPropertiesEditor(){return Fj.gh||(Fj.gh=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return Fj.zn||(Fj.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Jk(){return Ww.PageReader.instance}static get Qh(){return Fj.Fi||
(Fj.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get KL(){return Fj.CK||(Fj.CK=Ab.a.instance.rb("Box4.List.ListSettings"))}static get ze(){return Fj.hd||(Fj.hd=Ab.a.instance.rb("Box4.IFeatureHelper"))}}Fj.Ux=null;Fj.hd=null;Fj.Fi=null;Fj.gh=null;Fj.zn=null;Fj.CK=null;Object(n.a)(Fj,"APasteExecutionManager",null,[]);var oQ=d(1231);class jI{constructor(){this.ks=0;this.m1b=6;this.v5d=this.u5d=this.TYf=this.t5d=this.s5d=this.r5d=this.q5d=!1;this.GNe=null;this.SYf=this.k9a=this.Y4b=
this.RYf=this.VYf=!1;this.M$g=this.fIb=0;this.UJe=this.platform=null;this.u3a={}}get u_e(){if(this.v5d)return"Word Online";if(this.t5d)return"Google Docs";if(this.u5d||this.r5d||this.s5d)return"PowerPoint Online";if(this.q5d)return"Excel Online";switch(this.GNe){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}d4j(){ka.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.yli()))}e4j(){const a=
this.u3a;for(let c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.u_e,f.Browser=oQ.a[this.fIb],f.TagName=b,f.OperationId=this.UJe,ka.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}HDj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.u3a||(this.u3a[a]={}),this.u3a[a][b]=this.dmj(a,b)+1)}dmj(a,b){if(!(a&&a.length&&b&&b.length&&this.u3a&&a in this.u3a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.u3a[a])&&b in a?a[b]:0}yli(){const a={};a.ActionIdFlags=
this.ks;a.FoundDataCcpTimestampAttribute=this.q5d;a.FoundDataClipserviceCcpidAttribute=this.r5d;a.FoundDataShapeIdsAttribute=this.s5d;a.FoundGoogleDocsInternalGuidId=this.t5d;a.FoundOneNoteOnlineSequenceClass=this.TYf;a.FoundPowerPointOnlineSequenceClass=this.u5d;a.FoundWordOnlineSequenceClass=this.v5d;a.ProgId=this.GNe;a.SourceApp=this.u_e;a.FoundText=this.VYf;a.FoundEquation=this.RYf;a.FoundList=this.Y4b;a.FoundTable=this.k9a;a.FoundImage=this.SYf;a.CopySourceBrowser=this.m1b;a.PasteBrowser=this.fIb;
a.IsSameBrowserPaste=this.XUj(this.m1b,this.fIb);a.IsCrossBrowserPaste=this.UMj(this.m1b,this.fIb);a.IsUncategorizedBrowserPaste=this.TXj(this.m1b,this.fIb);a.Platform=this.platform;a.PastedHtmlLength=this.M$g;a.OperationId=this.UJe;return a}XUj(a,b){return 5===a||6===a?!1:a===b}UMj(a,b){return 6===a?!1:a!==b}TXj(a,b){return 5===a&&5===b}}Object(n.a)(jI,"HtmlContentMetadata",null,[]);class pz{constructor(a,b,c=!1){this.Uf=a;this.rw=b;this.kfi=c}}Object(n.a)(pz,"TagEventParam",null,[]);class tC{constructor(a,
b=null){this.kyc=this.wmf=this.vNd=this.Crf=null;this.Nc=a;this.CS=b||Gm.a.o3f("");this.rgl()}get Nb(){return this.CS}Tqk(a,b,c){this.vNd[b]?this.p1g():(this.Nb.e++,(b=this.kyc[b])&&b(new pz(a,c,!1)),this.Nb.b++)}p1g(){this.Nb.d++}Mqk(){this.Nb.c++}Cqk(a,b,c){if(this.vNd[b])this.p1g();else{if(b=this.kyc[b])return this.Nb.b++,b(new pz(a,c,!1));this.Nb.f++}return 2}rgl(){this.Crf=pa.a.SH("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",
!0);this.vNd=pa.a.SH("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.wmf=pa.a.SH("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Nc,b=this.Nc,c=this.Nc,f=this.Nc,l=this.Nc,w=this.Nc,H=this.Nc,U=this.Nc,
ja=this.Nc,wa=this.Nc,Sa=this.Nc,eb=this.Nc,ub=this.Nc,Ub=this.Nc,cc=this.Nc,Fc=this.Nc,Ic=this.Nc,Cc=this.Nc,Ud=this.Nc,je=this.Nc;this.kyc=pa.a.SH("A",Object(F.a)(this.Nc,this.Nc.Ied,"onAOpen"),"ABBR",Object(F.a)(this.Nc,this.Nc.OGe,"onAbbrOpen"),"ACRONYM",Object(F.a)(this.Nc,this.Nc.PGe,"onAcronymOpen"),"ADDRESS",Object(F.a)(this.Nc,this.Nc.RGe,"onAddressOpen"),"APPLET",Object(F.a)(this.Nc,this.Nc.YGe,"onAppletOpen"),"AREA",Object(F.a)(this.Nc,this.Nc.aHe,"onAreaTag"),"B",Object(F.a)(this.Nc,this.Nc.Ned,
"onBOpen"),"BASE",Object(F.a)(this.Nc,this.Nc.bHe,"onBaseTag"),"BASEFONT",Object(F.a)(this.Nc,this.Nc.cHe,"onBasefontTag"),"BDO",Object(F.a)(this.Nc,this.Nc.dHe,"onBdoOpen"),"BIG",Object(F.a)(this.Nc,this.Nc.Ted,"onBigOpen"),"BLOCKQUOTE",Object(F.a)(this.Nc,this.Nc.Ued,"onBlockquoteOpen"),"BODY",Object(F.a)(this.Nc,this.Nc.pHe,"onBodyOpen"),"BR",Object(F.a)(this.Nc,this.Nc.Ved,"onBrTag"),"BUTTON",Object(F.a)(this.Nc,this.Nc.uHe,"onButtonOpen"),"CAPTION",Object(F.a)(this.Nc,this.Nc.Wed,"onCaptionOpen"),
"CENTER",Object(F.a)(this.Nc,this.Nc.Yed,"onCenterOpen"),"CITE",Object(F.a)(this.Nc,this.Nc.afd,"onCiteOpen"),"CODE",Object(F.a)(this.Nc,this.Nc.cfd,"onCodeOpen"),"COL",Object(F.a)(this.Nc,this.Nc.GHe,"onColTag"),"COLGROUP",Object(F.a)(this.Nc,this.Nc.HHe,"onColgroupOpen"),"DD",Object(F.a)(this.Nc,this.Nc.ffd,"onDdOpen"),"DEL",Object(F.a)(this.Nc,this.Nc.gfd,"onDelOpen"),"DFN",Object(F.a)(this.Nc,this.Nc.ifd,"onDfnOpen"),"DIR",Object(F.a)(this.Nc,this.Nc.jfd,"onDirOpen"),"DIV",Object(F.a)(this.Nc,
this.Nc.lfd,"onDivOpen"),"DL",Object(F.a)(this.Nc,this.Nc.mfd,"onDlOpen"),"DT",Object(F.a)(this.Nc,this.Nc.nfd,"onDtOpen"),"EM",Object(F.a)(this.Nc,this.Nc.qfd,"onEmOpen"),"FIELDSET",Object(F.a)(this.Nc,this.Nc.dIe,"onFieldsetOpen"),"FONT",Object(F.a)(this.Nc,this.Nc.yfd,"onFontOpen"),"FORM",Object(F.a)(this.Nc,this.Nc.jIe,"onFormOpen"),"FRAME",Object(F.a)(this.Nc,this.Nc.kIe,"onFrameTag"),"FRAMESET",Object(F.a)(this.Nc,this.Nc.lIe,"onFramesetOpen"),"H1",Object(F.a)(this.Nc,this.Nc.Dfd,"onH1Open"),
"H2",Object(F.a)(this.Nc,this.Nc.Efd,"onH2Open"),"H3",Object(F.a)(this.Nc,this.Nc.Ffd,"onH3Open"),"H4",Object(F.a)(this.Nc,this.Nc.Gfd,"onH4Open"),"H5",Object(F.a)(this.Nc,this.Nc.Hfd,"onH5Open"),"H6",Object(F.a)(this.Nc,this.Nc.Ifd,"onH6Open"),"HEAD",Object(F.a)(this.Nc,this.Nc.pIe,"onHeadOpen"),"HR",Object(F.a)(this.Nc,this.Nc.Jfd,"onHrTag"),"HTML",Object(F.a)(this.Nc,this.Nc.rIe,"onHtmlOpen"),"I",Object(F.a)(this.Nc,this.Nc.Kfd,"onIOpen"),"IFRAME",Object(F.a)(this.Nc,this.Nc.tIe,"onIframeOpen"),
"IMG",Object(F.a)(this.Nc,this.Nc.Lfd,"onImgTag"),"INPUT",Object(F.a)(this.Nc,this.Nc.vIe,"onInputTag"),"INS",Object(F.a)(this.Nc,this.Nc.Mfd,"onInsOpen"),"ISINDEX",Object(F.a)(this.Nc,this.Nc.CIe,"onIsindexOpen"),"KBD",Object(F.a)(this.Nc,this.Nc.Nfd,"onKbdOpen"),"LABEL",Object(F.a)(this.Nc,this.Nc.Pfd,"onLabelOpen"),"LEGEND",Object(F.a)(this.Nc,this.Nc.Rfd,"onLegendOpen"),"LI",Object(F.a)(this.Nc,this.Nc.Sfd,"onLiOpen"),"LINK",Object(F.a)(this.Nc,this.Nc.GIe,"onLinkTag"),"MAP",Object(F.a)(this.Nc,
this.Nc.HIe,"onMapOpen"),"MATH",Object(F.a)(this.Nc,this.Nc.Wfd,"onMathOpen"),"MENU",Object(F.a)(this.Nc,this.Nc.sHb,"onMenuOpen"),"META",Object(F.a)(this.Nc,this.Nc.KIe,"onMetaTag"),"NOFRAMES",Object(F.a)(this.Nc,this.Nc.NIe,"onNoframesOpen"),"NOSCRIPT",Object(F.a)(this.Nc,this.Nc.OIe,"onNoscriptOpen"),"OBJECT",Object(F.a)(this.Nc,this.Nc.PIe,"onObjectOpen"),"OL",Object(F.a)(this.Nc,this.Nc.cgd,"onOlOpen"),"OPTGROUP",Object(F.a)(this.Nc,this.Nc.QIe,"onOptgroupOpen"),"OPTION",Object(F.a)(this.Nc,
this.Nc.ggd,"onOptionOpen"),"P",Object(F.a)(this.Nc,this.Nc.jgd,"onPOpen"),"PARAM",Object(F.a)(this.Nc,this.Nc.RIe,"onParamTag"),"PRE",Object(F.a)(this.Nc,this.Nc.vgd,"onPreOpen"),"Q",Object(F.a)(this.Nc,this.Nc.ZIe,"onQOpen"),"S",Object(F.a)(this.Nc,this.Nc.Dgd,"onSOpen"),"SAMP",Object(F.a)(this.Nc,this.Nc.Egd,"onSampOpen"),"SCRIPT",Object(F.a)(this.Nc,this.Nc.jJe,"onScriptOpen"),"SELECT",Object(F.a)(this.Nc,this.Nc.kJe,"onSelectOpen"),"SMALL",Object(F.a)(a,a.Ngd,"onSmallOpen"),"SPAN",Object(F.a)(b,
b.Ogd,"onSpanOpen"),"STRIKE",Object(F.a)(c,c.Pgd,"onStrikeOpen"),"STRONG",Object(F.a)(f,f.Qgd,"onStrongOpen"),"STYLE",Object(F.a)(l,l.qJe,"onStyleOpen"),"SUB",Object(F.a)(w,w.Rgd,"onSubOpen"),"SUP",Object(F.a)(H,H.Tgd,"onSupOpen"),"TABLE",Object(F.a)(U,U.Xgd,"onTableOpen"),"TBODY",Object(F.a)(ja,ja.tJe,"onTbodyOpen"),"TD",Object(F.a)(wa,wa.alc,"onTdOpen"),"TEXTAREA",Object(F.a)(Sa,Sa.vJe,"onTextareaOpen"),"TFOOT",Object(F.a)(eb,eb.wJe,"onTfootOpen"),"TH",Object(F.a)(ub,ub.Ygd,"onThOpen"),"THEAD",
Object(F.a)(Ub,Ub.xJe,"onTheadOpen"),"TITLE",Object(F.a)(cc,cc.zJe,"onTitleOpen"),"TR",Object(F.a)(Fc,Fc.Zgd,"onTrOpen"),"TT",Object(F.a)(Ic,Ic.bhd,"onTtOpen"),"U",Object(F.a)(Cc,Cc.chd,"onUOpen"),"UL",Object(F.a)(Ud,Ud.dhd,"onUlOpen"),"VAR",Object(F.a)(je,je.fhd,"onVarOpen"))}}Object(n.a)(tC,"AHtmlProcessor",null,[]);class uC{constructor(a,b){this.childNodes=a.childNodes;this.rw=b;this.GZd=0;this.mZc=!1}}Object(n.a)(uC,"HtmlProcessorArguments",null,[]);class ar extends tC{constructor(a,b=null){super(a,
b);this.BEd=null}get ZSj(){null==this.BEd&&(this.BEd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.BEd}process(a,b=null){a&&(this.Nc.reset(),this.$ch(new uC(a,new $t),b))}$ch(a,b){a.childNodes.length&&(a=new ii.a(b,Object(F.a)(this,this.qLk,"processChild"),a),a.Pl("HTML Processing Operation"),b||(a.Qi=!0),a.run())}qLk(a,b){const c=b.childNodes[b.GZd];if(3===c.nodeType)return this.Nc.Ped(),this.Nc.Y0(c.nodeValue,new pz(c,b.rw.e1f())),
ar.bPb(b);if(1!==c.nodeType)return ar.bPb(b);if(!b.mZc){const l=ha.a.RB(c.tagName);if(!ar.Pyj(c))if(this.wmf[l])this.Mqk();else{ar.rlk(c);this.Nc.Ped();var f=c.id;const w=c.tagName,H=b.rw.e1f(),U=c.getAttribute?c.getAttribute("class"):null;f=new au(f,w,U?U:"",c.attributes?c.attributes.length:0);f.isValid&&H.add(f);if(this.Crf[l])return this.Tqk(c,l,H),ar.bPb(b);f=!1;switch(this.Cqk(c,l,H)){case 1:f=!0;break;case 3:return ar.bPb(b)}switch(this.Nc.Ebe(c)){case 1:f=!0}b.mZc=f;this.$ch(new uC(c,H),a);
if(!a.Qi)return!0}}if(b.mZc){if(this.ZSj&&!this.kyc[ha.a.RB(c.tagName)])return ar.bPb(b);this.Nc.onClose()}return ar.bPb(b)}static rlk(a){3!==a.nodeType&&T.a.Sv(a,"alreadyPasted",!0)}static Pyj(a){return 3!==a.nodeType&&T.a.Be(a,"alreadyPasted")}static bPb(a){a.GZd++;a.mZc=!1;return a.GZd<a.childNodes.length}}Object(n.a)(ar,"HtmlProcessor",tC,[]);var Xr=d(943);class kI{constructor(a,b=null,c=null,f=null){this.ge=a;this.CS=b||Gm.a.n3f(B.a.N6a,"");this.uq=c;this.Tqa=f?f.ka("ParseStyleForHtmlTagEventIsEnabled"):
!1}get Nb(){return this.CS}get Rn(){return this.uq}Ef(a){return a?a+1:1}reset(){this.ge.reset()}Ped(){this.ge.Ped()}Ebe(a){if(a&&this.Rn&&(a.getAttribute&&(a.getAttribute(Xr.a.YMf)&&(this.Rn.q5d=!0),a.getAttribute(Xr.a.ZMf)&&(this.Rn.r5d=!0),a.getAttribute(Xr.a.cNf)&&(this.Rn.s5d=!0)),a.id&&a.id.startsWith&&a.id.startsWith(Xr.a.k$f)&&(this.Rn.t5d=!0),a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(Xr.a.o8g)&&(this.Rn.TYf=!0);b.startsWith(Xr.a.Abh)&&(this.Rn.u5d=
!0);b.startsWith(Xr.a.UKh)&&(this.Rn.v5d=!0);if(b.startsWith(B.a.a_b)&&b.length===B.a.a_b.length+1){const c=parseInt(ha.a.substring(b,b.length-1,b.length));isNaN(c)||(this.Rn.m1b=c)}if(b===Xr.a.c0g||b===Xr.a.d0g)this.Rn.Y4b=!0}return this.ge.Ebe(a)}onClose(){this.ge.onClose()}Y0(a,b){this.Rn&&(this.Rn.VYf=!0);this.Nb.d=this.Ef(this.Nb.d);this.Tqa&&this.vxa(b);this.ge.Y0(a,b)}Ied(a){this.Nb.e=this.Ef(this.Nb.e);this.Tqa&&this.vxa(a);return this.ge.Ied(a)}OGe(a){this.Nb.f=this.Ef(this.Nb.f);return this.ge.OGe(a)}PGe(a){this.Nb.g=
this.Ef(this.Nb.g);return this.ge.PGe(a)}RGe(a){this.Nb.h=this.Ef(this.Nb.h);return this.ge.RGe(a)}YGe(a){this.Nb.i=this.Ef(this.Nb.i);return this.ge.YGe(a)}aHe(a){this.Nb.j=this.Ef(this.Nb.j);this.ge.aHe(a)}Ned(a){this.Nb.k=this.Ef(this.Nb.k);return this.ge.Ned(a)}bHe(a){this.Nb.l=this.Ef(this.Nb.l);this.ge.bHe(a)}cHe(a){this.Nb.m=this.Ef(this.Nb.m);this.ge.cHe(a)}dHe(a){this.Nb.n=this.Ef(this.Nb.n);return this.ge.dHe(a)}Ted(a){this.Nb.o=this.Ef(this.Nb.o);return this.ge.Ted(a)}Ued(a){this.Nb.p=
this.Ef(this.Nb.p);return this.ge.Ued(a)}pHe(a){this.Nb.q=this.Ef(this.Nb.q);return this.ge.pHe(a)}Ved(a){this.Nb.r=this.Ef(this.Nb.r);this.ge.Ved(a)}uHe(a){this.Nb.s=this.Ef(this.Nb.s);return this.ge.uHe(a)}Wed(a){this.Nb.t=this.Ef(this.Nb.t);return this.ge.Wed(a)}Yed(a){this.Nb.u=this.Ef(this.Nb.u);return this.ge.Yed(a)}afd(a){this.Nb.v=this.Ef(this.Nb.v);return this.ge.afd(a)}cfd(a){this.Nb.w=this.Ef(this.Nb.w);return this.ge.cfd(a)}GHe(a){this.Nb.x=this.Ef(this.Nb.x);this.ge.GHe(a)}HHe(a){this.Nb.y=
this.Ef(this.Nb.y);return this.ge.HHe(a)}ffd(a){this.Nb.z=this.Ef(this.Nb.z);return this.ge.ffd(a)}gfd(a){this.Nb.ba=this.Ef(this.Nb.ba);return this.ge.gfd(a)}ifd(a){this.Nb.bb=this.Ef(this.Nb.bb);return this.ge.ifd(a)}jfd(a){this.Nb.bc=this.Ef(this.Nb.bc);return this.ge.jfd(a)}lfd(a){this.Nb.bd=this.Ef(this.Nb.bd);return this.ge.lfd(a)}mfd(a){this.Nb.be=this.Ef(this.Nb.be);return this.ge.mfd(a)}nfd(a){this.Nb.bf=this.Ef(this.Nb.bf);return this.ge.nfd(a)}qfd(a){this.Nb.bg=this.Ef(this.Nb.bg);return this.ge.qfd(a)}dIe(a){this.Nb.bh=
this.Ef(this.Nb.bh);return this.ge.dIe(a)}yfd(a){this.Nb.bi=this.Ef(this.Nb.bi);return this.ge.yfd(a)}jIe(a){this.Nb.bj=this.Ef(this.Nb.bj);return this.ge.jIe(a)}kIe(a){this.Nb.bk=this.Ef(this.Nb.bk);this.ge.kIe(a)}lIe(a){this.Nb.bl=this.Ef(this.Nb.bl);return this.ge.lIe(a)}Dfd(a){this.Nb.bm=this.Ef(this.Nb.bm);return this.ge.Dfd(a)}Efd(a){this.Nb.bm=this.Ef(this.Nb.bm);return this.ge.Efd(a)}Ffd(a){this.Nb.bm=this.Ef(this.Nb.bm);return this.ge.Ffd(a)}Gfd(a){this.Nb.bm=this.Ef(this.Nb.bm);return this.ge.Gfd(a)}Hfd(a){this.Nb.bm=
this.Ef(this.Nb.bm);return this.ge.Hfd(a)}Ifd(a){this.Nb.bm=this.Ef(this.Nb.bm);return this.ge.Ifd(a)}pIe(a){this.Nb.bn=this.Ef(this.Nb.bn);return this.ge.pIe(a)}Jfd(a){this.Nb.bo=this.Ef(this.Nb.bo);this.ge.Jfd(a)}rIe(a){this.Nb.bp=this.Ef(this.Nb.bp);return this.ge.rIe(a)}Kfd(a){this.Nb.bq=this.Ef(this.Nb.bq);return this.ge.Kfd(a)}tIe(a){this.Nb.br=this.Ef(this.Nb.br);return this.ge.tIe(a)}Lfd(a){this.Rn&&(this.Rn.SYf=!0);this.Tqa&&this.vxa(a);this.Nb.bs=this.Ef(this.Nb.bs);this.ge.Lfd(a)}vIe(a){this.Nb.bt=
this.Ef(this.Nb.bt);this.ge.vIe(a)}Mfd(a){this.Nb.bu=this.Ef(this.Nb.bu);return this.ge.Mfd(a)}CIe(a){this.Nb.bv=this.Ef(this.Nb.bv);return this.ge.CIe(a)}Nfd(a){this.Nb.bw=this.Ef(this.Nb.bw);return this.ge.Nfd(a)}Pfd(a){this.Nb.bx=this.Ef(this.Nb.bx);return this.ge.Pfd(a)}Rfd(a){this.Nb.by=this.Ef(this.Nb.by);return this.ge.Rfd(a)}Sfd(a){this.Rn&&(this.Rn.Y4b=!0);this.Nb.bz=this.Ef(this.Nb.bz);this.Tqa&&this.vxa(a);return this.ge.Sfd(a)}GIe(a){this.Nb.ca=this.Ef(this.Nb.ca);this.ge.GIe(a)}HIe(a){this.Nb.cb=
this.Ef(this.Nb.cb);return this.ge.HIe(a)}Wfd(a){this.Rn&&(this.Rn.RYf=!0);this.Nb.cc=this.Ef(this.Nb.cc);return this.ge.Wfd(a)}sHb(a){this.Nb.cd=this.Ef(this.Nb.cd);return this.ge.sHb(a)}KIe(a){this.Nb.ce=this.Ef(this.Nb.ce);this.ge.KIe(a)}NIe(a){this.Nb.cf=this.Ef(this.Nb.cf);return this.ge.NIe(a)}OIe(a){this.Nb.cg=this.Ef(this.Nb.cg);return this.ge.OIe(a)}PIe(a){this.Nb.ch=this.Ef(this.Nb.ch);return this.ge.PIe(a)}cgd(a){this.Rn&&(this.Rn.Y4b=!0);this.Nb.ci=this.Ef(this.Nb.ci);this.Tqa&&this.vxa(a);
return this.ge.cgd(a)}QIe(a){this.Nb.cj=this.Ef(this.Nb.cj);return this.ge.QIe(a)}ggd(a){this.Nb.ck=this.Ef(this.Nb.ck);return this.ge.ggd(a)}jgd(a){this.Nb.cl=this.Ef(this.Nb.cl);this.Tqa&&this.vxa(a);return this.ge.jgd(a)}RIe(a){this.Nb.cm=this.Ef(this.Nb.cm);this.ge.RIe(a)}vgd(a){this.Nb.cn=this.Ef(this.Nb.cn);return this.ge.vgd(a)}ZIe(a){this.Nb.co=this.Ef(this.Nb.co);return this.ge.ZIe(a)}Dgd(a){this.Nb.cp=this.Ef(this.Nb.cp);return this.ge.Dgd(a)}Egd(a){this.Nb.cq=this.Ef(this.Nb.cq);return this.ge.Egd(a)}jJe(a){this.Nb.cr=
this.Ef(this.Nb.cr);return this.ge.jJe(a)}kJe(a){this.Nb.cs=this.Ef(this.Nb.cs);return this.ge.kJe(a)}Ngd(a){this.Nb.ct=this.Ef(this.Nb.ct);return this.ge.Ngd(a)}Ogd(a){this.Nb.cu=this.Ef(this.Nb.cu);this.Tqa&&this.vxa(a);return this.ge.Ogd(a)}Pgd(a){this.Nb.cv=this.Ef(this.Nb.cv);return this.ge.Pgd(a)}Qgd(a){this.Nb.cw=this.Ef(this.Nb.cw);return this.ge.Qgd(a)}qJe(a){this.Nb.cx=this.Ef(this.Nb.cx);return this.ge.qJe(a)}Rgd(a){this.Nb.cy=this.Ef(this.Nb.cy);return this.ge.Rgd(a)}Tgd(a){this.Nb.cz=
this.Ef(this.Nb.cz);return this.ge.Tgd(a)}Xgd(a){this.Rn&&(this.Rn.k9a=!0);this.Nb.da=this.Ef(this.Nb.da);this.Tqa&&this.vxa(a);return this.ge.Xgd(a)}tJe(a){this.Rn&&(this.Rn.k9a=!0);this.Nb.db=this.Ef(this.Nb.db);this.Tqa&&this.vxa(a);return this.ge.tJe(a)}alc(a){this.Rn&&(this.Rn.k9a=!0);this.Nb.dc=this.Ef(this.Nb.dc);this.Tqa&&this.vxa(a);return this.ge.alc(a)}vJe(a){this.Nb.dd=this.Ef(this.Nb.dd);return this.ge.vJe(a)}wJe(a){this.Nb.de=this.Ef(this.Nb.de);return this.ge.wJe(a)}Ygd(a){this.Rn&&
(this.Rn.k9a=!0);this.Nb.df=this.Ef(this.Nb.df);return this.ge.Ygd(a)}xJe(a){this.Rn&&(this.Rn.k9a=!0);this.Nb.dg=this.Ef(this.Nb.dg);return this.ge.xJe(a)}zJe(a){this.Nb.dh=this.Ef(this.Nb.dh);return this.ge.zJe(a)}Zgd(a){this.Rn&&(this.Rn.k9a=!0);this.Nb.di=this.Ef(this.Nb.di);return this.ge.Zgd(a)}bhd(a){this.Nb.dj=this.Ef(this.Nb.dj);return this.ge.bhd(a)}chd(a){this.Nb.dk=this.Ef(this.Nb.dk);return this.ge.chd(a)}dhd(a){this.Rn&&(this.Rn.Y4b=!0);this.Nb.dl=this.Ef(this.Nb.dl);return this.ge.dhd(a)}fhd(a){this.Nb.dm=
this.Ef(this.Nb.dm);return this.ge.fhd(a)}vxa(a){if((a=a.Uf)&&a.style&&this.Rn){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.Rn.HDj(a.tagName,c)}}}Object(n.a)(kI,"HtmlEventUsageCollector",null,[1073]);class lI{constructor(a,b=null,c=null){this.ge=a;this.CS=b||Gm.a.c7f("");this.x2h=c||Gm.a.d7f("")}get Nb(){return this.CS}get v1e(){return this.x2h}tY(a){this.v1e.b++;this.ge.tY(a)}qY(){this.ge.qY()}sY(a){this.v1e.c++;this.ge.sY(a)}rY(){this.ge.rY()}pY(a){this.v1e.d++;this.ge.pY(a)}oY(){this.ge.oY()}reset(){this.ge.reset()}get q2b(){return this.ge.q2b}Y0(a,
b){this.Nb.b++;this.ge.Y0(a,b)}Kna(a){this.Nb.c++;this.ge.Kna(a)}kZa(a){this.Nb.b++;this.ge.kZa(a)}Jna(a){this.Nb.d++;this.ge.Jna(a)}Ina(a){this.Nb.f++;this.ge.Ina(a)}Ywa(a,b){this.Nb.g++;this.ge.Ywa(a,b)}Xwa(){this.ge.Xwa()}wA(a){this.Nb.h++;this.ge.wA(a)}vA(){this.ge.vA()}eZa(){this.ge.eZa()}dZa(){this.ge.dZa()}cxa(a,b){this.Nb.i++;this.ge.cxa(a,b)}sJa(){this.ge.sJa()}Nna(a){this.Nb.j++;this.ge.Nna(a)}Lna(){this.ge.Lna()}bxa(a){this.Nb.k++;this.ge.bxa(a)}Mna(){this.ge.Mna()}fZa(a){this.Nb.l++;this.ge.fZa(a)}}
Object(n.a)(lI,"SemanticEventUsageCollector",null,[1069,1046]);class vC{constructor(a){this.yh=a}reset(){this.yh.reset()}get q2b(){return this.yh.q2b}Y0(a,b){this.yh.Y0(a,b)}Kna(a){this.yh.Kna(a)}kZa(a){this.yh.kZa(a)}Jna(a){this.yh.Jna(a)}Ina(a){this.yh.Ina(a)}Ywa(a,b){this.yh.Ywa(a,b)}Xwa(){this.yh.Xwa()}wA(a){this.yh.wA(a)}vA(){this.yh.vA()}eZa(){this.yh.eZa()}dZa(){this.yh.dZa()}Nna(a){this.yh.Nna(a)}Lna(){this.yh.Lna()}bxa(a){this.yh.bxa(a)}Mna(){this.yh.Mna()}fZa(a){this.yh.fZa(a)}tY(a){this.yh.tY(a)}qY(){this.yh.qY()}sY(a){this.yh.sY(a)}rY(){this.yh.rY()}pY(a){this.yh.pY(a)}oY(){this.yh.oY()}cxa(a,
b){this.yh.cxa(a,b)}sJa(){this.yh.sJa()}}Object(n.a)(vC,"AHtmlNormalizer",null,[1069,1046]);class wC extends vC{constructor(a){super(a);this.gD=!1}Y0(a,b){this.gD?this.jG.zF(()=>{this.CNe(a,b)}):this.CNe(a,b)}CNe(a,b){this.yh.Y0(a,b)}Kna(a){this.gD?this.jG.zF(()=>{this.cNe(a)}):this.cNe(a)}cNe(a){this.yh.Kna(a)}Jna(a){this.gD?this.jG.zF(()=>{this.Zmc(a)}):this.Zmc(a)}Zmc(a){this.yh.Jna(a)}Ina(a){this.gD?this.jG.zF(()=>{this.bNe(a)}):this.bNe(a)}bNe(a){this.yh.Ina(a)}Ywa(a,b){this.gD?this.jG.zF(()=>
{this.XMe(a,b)}):this.XMe(a,b)}XMe(a,b){this.yh.Ywa(a,b)}Xwa(){this.gD?this.jG.zF(Object(F.a)(this,this.WMe,"processAnchorEnd")):this.WMe()}WMe(){this.yh.Xwa()}wA(a){this.gD?this.jG.zF(()=>{this.mNe(a)}):this.mNe(a)}mNe(a){this.yh.wA(a)}vA(){this.gD?this.jG.zF(Object(F.a)(this,this.lNe,"processParagraphEnd")):this.lNe()}lNe(){this.yh.vA()}eZa(){this.gD?this.jG.zF(Object(F.a)(this,this.oNe,"processPreFormattedTextStart")):this.oNe()}oNe(){this.yh.eZa()}dZa(){this.gD?this.jG.zF(Object(F.a)(this,this.nNe,
"processPreFormattedTextEnd")):this.nNe()}nNe(){this.yh.dZa()}Nna(a){this.gD?this.jG.zF(()=>{this.gNe(a)}):this.gNe(a)}gNe(a){this.yh.Nna(a)}Lna(){this.gD?this.jG.zF(Object(F.a)(this,this.dNe,"processListEnd")):this.dNe()}dNe(){this.yh.Lna()}bxa(a){this.gD?this.jG.zF(()=>{this.fNe(a)}):this.fNe(a)}fNe(a){this.yh.bxa(a)}Mna(){this.gD?this.jG.zF(Object(F.a)(this,this.eNe,"processListItemEnd")):this.eNe()}eNe(){this.yh.Mna()}tY(a){this.gD?this.jG.zF(()=>{this.BNe(a)}):this.BNe(a)}BNe(a){this.yh.tY(a)}qY(){this.gD?
this.jG.zF(Object(F.a)(this,this.yNe,"processTableEnd")):this.yNe()}yNe(){this.yh.qY()}sY(a){this.gD?this.jG.zF(()=>{this.ANe(a)}):this.ANe(a)}ANe(a){this.yh.sY(a)}rY(){this.gD?this.jG.zF(Object(F.a)(this,this.zNe,"processTableRowEnd")):this.zNe()}zNe(){this.yh.rY()}pY(a){this.gD?this.jG.zF(()=>{this.xNe(a)}):this.xNe(a)}xNe(a){this.yh.pY(a)}oY(){this.gD?this.jG.zF(Object(F.a)(this,this.wNe,"processTableCellEnd")):this.wNe()}wNe(){this.yh.oY()}cxa(a,b){this.gD?this.jG.zF(()=>{this.hNe(a,b)}):this.hNe(a,
b)}hNe(a,b){this.yh.cxa(a,b)}sJa(){this.gD?this.jG.zF(Object(F.a)(this,this.mdh,"processMathEnd")):this.mdh()}mdh(){this.yh.sJa()}}Object(n.a)(wC,"AQueuingHtmlNormalizer",vC,[]);class mI{constructor(a){this.next=null;this.data=a}}Object(n.a)(mI,"QueueNode",null,[]);class xC{constructor(){this.h3a=this.o2a=null;this.Xk=0}get count(){return this.Xk}get isEmpty(){return!this.Xk||!this.o2a||!this.h3a}enqueue(a){a=new mI(a);this.isEmpty?this.h3a=this.o2a=a:this.o2a=this.o2a.next=a;this.Xk++}back(){return this.isEmpty?
null:this.o2a.data}dequeue(){if(this.isEmpty)return null;const a=this.h3a;this.h3a=a.next;this.Xk--;this.h3a||(this.o2a=null);return a.data}clear(){this.h3a=this.o2a=null;this.Xk=0}toArray(){const a=Array(this.count);let b=this.h3a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(n.a)(xC,"Queue",null,[]);class vx{constructor(){this.tJd=new xC}zF(a){this.tJd.enqueue(a)}flush(a=!1){for(a&&this.dpd();!this.tJd.isEmpty;)this.tJd.dequeue()();a&&this.Emd()}dpd(){}Emd(){}}Object(n.a)(vx,
"QueuedEventManager",null,[]);class qz extends vx{constructor(a){super();this.id=void 0;this.LZd=null;this.k_c=!1;this.Hlc="";this.j_c=this.b0c=!1;this.JZd=this.xub=null;this.Ljc=0;this.p$b=this.Kac=this.cne=!1;this.table=null;this.QFe=0;this.HP=a}get hZb(){return!!this.table}dpd(){this.HP.PHb.push(this.HP.currentState);this.HP.currentState=this}Emd(){this.HP.currentState=this.HP.PHb.pop()}}qz.nextId=void 0;Object(n.a)(qz,"ContentState",vx,[]);class nI{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.HFa=a.HFa;this.Xqc=a.Xqc;this.verticalAlignment=a.verticalAlignment;this.v6=a.v6;this.Hsd=a.Hsd;this.vAb=a.vAb;this.IJc=a.IJc;this.contents=c;this.Aqj=b}}Object(n.a)(nI,"TableCell",null,[]);class oI extends vx{constructor(a,b){super();this.HP=a;this.eqf=new $t;this.wG=new $t;this.IGd=[];this.MDc=[];this.Xpa=-1;this.fAa=0;this.JUh=b.Ehg;this.IUh=b.lLj;this.p2h=b.l1e;this.T5a=b.width;this.rgf=b.HFa;this.qTh=new Xm(new au(b.FU.ydg,b.FU.y8b),b.rw,
b.L5,b.cultureName,b.ria);this.gUh=b.vee;this.SEc=b.bAh;this.v2h=b.tableLook}get yh(){return this.HP.yh}sKk(a){this.Xpa++;this.eqf.add(a);this.MDc[this.Xpa]=a.height;this.fAa=0}get QJi(){for(;this.fAa>=this.wG.count;)this.wG.add(Array(this.Xpa+1));return this.wG.ga(this.fAa)}OOd(a,b,c,f,l,w,H){if(0>this.Xpa)return!1;for(;this.IGd[this.fAa]>=this.Xpa;)this.fAa++;a=new nI(a,new Xm(b,c,f,l,w),H);this.QJi[this.Xpa]=a;if(1<a.rowSpan)for(b=this.Xpa+a.rowSpan-1,f=this.fAa,c=this.fAa+a.colSpan-1;f<=c;f++)this.IGd[f]>=
b||(this.IGd[f]=b);this.fAa+=a.colSpan;this.MDc[this.Xpa]<a.height&&(this.MDc[this.Xpa]=a.height);return!0}dpd(){this.HP.currentState.table=this}Emd(){this.HP.currentState.table=null}YXf(){this.flush(!0);const a=this.Xpa+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.wG.count);c=!0;var f=0;for(var l=0;l<this.wG.count;l++){var w=this.wG.ga(l),H=!0;for(var U=0;U<a;U++){var ja=w[U];ja&&(H=!1,b[U][l+f]=new lz(ja.colSpan,ja.rowSpan,ja.width,ja.height,void 0,void 0,void 0,void 0,ja.HFa,ja.vAb))}H?
(this.wG.removeAt(l),l--,++f):c=!1}if(!c){(b=this.rgf?this.HP.qDf(b,this.T5a/100):this.HP.qDf(b))&&b.length!==this.wG.count&&(b=null);this.HP.xDa(!0);this.HP.uKc();this.yh.tY(new oC(a,this.wG.count,this.T5a,this.rgf,b,this.JUh,this.IUh,this.p2h,this.gUh,this.SEc,this.v2h,this.qTh));for(b=0;b<a;b++){c=this.eqf.ga(b);this.yh.sY(new nC(this.MDc[b],new Xm(c.FU,c.rw,c.L5,c.cultureName,c.ria)));for(c=0;c<this.wG.count;c++){f=this.wG.ga(c)[b];var wa=!!this.SEc&&""!==this.SEc&&"Custom"!==this.SEc;l=f?f.colSpan:
0;w=f?f.rowSpan:0;H=f?f.width:0;U=f?f.height:0;ja=f?f.IJc:0;const Sa=f?f.HFa:!1,eb=f&&(65536&ja||!wa)?f.Xqc:"",ub=f?f.verticalAlignment:0,Ub=f?f.vAb:!1;wa=f?this.HP.mfj(f.v6,c,b,this.wG,wa,f.IJc):new jC;const cc=f?f.Hsd:new kC,Fc=f?f.Aqj:null;this.yh.pY(new lz(l,w,H,U,eb,ub,wa,cc,Sa,Ub,ja,new Xm(Fc?Fc.FU:null,Fc?Fc.rw:null,Fc?Fc.L5:null,Fc?Fc.cultureName:null,Fc?Fc.ria:null)));f&&!f.vAb&&(f.contents.dpd(),f.contents.flush(),this.HP.xDa(!1),this.HP.uKc(),f.contents.Emd());this.yh.oY()}this.yh.rY()}this.yh.qY();
this.HP.currentState.p$b=!1;this.HP.lTf(!1)}}}Object(n.a)(oI,"NormalizedTable",vx,[]);class yC{constructor(a=!1,b=!1){this.gVh=a;this.pI=b}get fQj(){return this.gVh}get bV(){return this.pI}}Object(n.a)(yC,"HtmlNormalizerSettings",null,[1130]);class Yr extends wC{constructor(a,b=null){super(a);this.currentState=null;this.PHb=new rx;this.zob=b||new yC}reset(){super.reset();this.currentState=new qz(this);this.PHb.clear();this.gD=!1}get jG(){return this.currentState&&this.currentState.hZb?this.currentState.table:
this.currentState}jPc(a=!1){this.currentState.k_c||(this.uKc(),this.yh.wA(this.currentState.LZd),this.currentState.k_c=!0,this.currentState.p$b=!1);a||!this.currentState.xub||this.currentState.j_c||(this.yh.Ywa(this.currentState.xub,this.currentState.JZd),this.currentState.j_c=!0)}L3b(){this.currentState.j_c&&(this.yh.Xwa(),this.currentState.j_c=!1)}ITi(){this.currentState.k_c&&(this.yh.vA(),this.currentState.k_c=!1,this.currentState.Hlc="")}lTf(a){this.currentState.Kac&&(this.currentState.p$b?a||
(this.yh.wA(null),this.yh.vA(),this.yh.Mna(),this.currentState.Kac=!1):(this.yh.Mna(),this.currentState.Kac=!1,this.currentState.p$b=!0))}xDa(a){this.L3b();this.ITi();this.lTf(a)}xBk(a){this.yh.Nna(new sx(2,1,a));this.currentState.Ljc++;this.currentState.cne=!0}uKc(){!this.currentState.Kac&&this.currentState.cne&&(this.yh.Lna(),this.currentState.Ljc--,this.currentState.cne=!1)}CNe(a,b){a=this.Wpk(a);if(""!==a)if(this.jPc(),this.currentState.b0c)this.DNe(a,b);else{a=a.split(Yr.Foi);for(let c=0;c<a.length-
1;c++)this.DNe(a[c],b),this.yh.kZa(b);this.DNe(a[a.length-1],b)}}hNe(a,b){""!==a&&(this.jPc(),this.yh.cxa(a,b))}cNe(a){this.zob.bV||this.L3b();this.jPc(!0);this.yh.Kna(a)}bNe(a){this.currentState.hZb||this.yh.Ina(a)}Zmc(a){this.currentState.xub&&(a.href=this.currentState.xub);super.Zmc(a)}XMe(a,b){this.L3b();this.currentState.xub=a;this.currentState.JZd=b}WMe(){this.L3b();this.currentState.xub=null;this.currentState.JZd=null}mNe(a){this.currentState.LZd=a;this.xDa(!0)}lNe(){this.currentState.LZd=
null;this.xDa(!0)}oNe(){this.currentState.b0c=!0}nNe(){this.currentState.b0c=!1}gNe(a){this.xDa(!1);this.uKc();this.yh.Nna(a);this.currentState.Ljc++}dNe(){this.xDa(!1);this.yh.Lna();this.currentState.Ljc--}fNe(a){this.xDa(!1);this.currentState.Ljc||this.xBk(a);this.yh.bxa(a);this.currentState.Kac=!0;this.currentState.p$b=!0}eNe(){this.xDa(!1)}tY(a){this.currentState.hZb||(this.gD=!0,this.currentState.table=new oI(this,a))}BNe(){}qY(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.PHb.isEmpty?(this.gD=!1,a.YXf()):this.jG.zF(Object(F.a)(a,a.YXf,"flushTable"))}}yNe(){}sY(a){this.currentState.hZb&&this.currentState.table.sKk(a)}ANe(){}rY(){}zNe(){}pY(a){let b=!1;if(this.currentState.hZb){const c=new qz(this);this.currentState.table.OOd(a,new au(a.FU.ydg,a.FU.y8b),a.rw,a.L5,a.cultureName,a.ria,c)?(this.PHb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.QFe++}xNe(){}oY(){0<this.currentState.QFe?this.currentState.QFe--:this.currentState=
this.PHb.pop()}wNe(){}qDf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const w=Array(f+1);for(var H=0;H<w.length;H++)w[H]=!1;H=new Ka.a;for(let ja=0;ja<f;ja++){for(var U=0;U<c;U++)if(a[U][ja]&&0<a[U][ja].width){const wa=Math.min(ja+a[U][ja].colSpan,f);l[wa]=l[ja]+a[U][ja].width*(a[U][ja].HFa?b:1);w[wa]=!0}if(w[ja+1]){U=l[ja+1]-l[ja];if(0>=U)return null;H.add(U)}else l[ja+1]=l[ja]}return H.toArray()}Plk(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}mfj(a,b,c,f,l,w){if(!a)return null;l&&(a=this.Plk(a,w));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.v6.borderRightStyle&&(a.borderLeftStyle=l.v6.borderRightStyle,a.borderLeftColor=l.v6.borderRightColor,a.borderLeftWidth=l.v6.borderRightWidth);0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-
1])&&1!==b.v6.borderBottomStyle&&(a.borderTopStyle=b.v6.borderBottomStyle,a.borderTopColor=b.v6.borderBottomColor,a.borderTopWidth=b.v6.borderBottomWidth);return a}Wpk(a){this.currentState.b0c||(a=this.zob.fQj?a.replace(Yr.CBj," "):a.replace(Yr.BBj," "));a.startsWith(" ")&&(this.currentState.Hlc.endsWith(" ")||""===this.currentState.Hlc)&&(a=ha.a.substring(a,1,a.length));return a}DNe(a,b){""!==a&&(this.yh.Y0(a,b),this.currentState.Hlc+=a)}}Yr.BBj=RegExp("[ \t\f\u200b\r\n]+","g");Yr.CBj=RegExp("[ \f\u200b\r\n]+",
"g");Yr.Foi="\t";Object(n.a)(Yr,"DefaultHtmlNormalizer",wC,[]);class pI extends Yr{constructor(a,b,c){super(a,c);this.Mdf=!1;this.x3a=b}Zmc(a){this.x3a.qid&&(u.AFrameworkApplication.PQ?this.Mdf||(a=new Bi.StandardDialog,a.yd=0,a.Xe(1,CommonUIStrings.l_DialogClose),a.Gx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.Mdf=!0):this.x3a.ymk?this.x3a.iZg=!0:a.src&&""!==a.src?ig.a.sQ(a.src)===ig.a.sQ(window.location.href)?u.AFrameworkApplication.Ta.processAction(D.a.R$g,
2):a.src.startsWith("data:")&&19922944<a.src.length?u.AFrameworkApplication.Ta.processAction(D.a.P$g,2):a.src.startsWith("webkit-fake-url")?u.AFrameworkApplication.Ta.processAction(D.a.O$g,2):(R.a.instance.ga(1)?this.xDa(!1):R.a.instance.ga(11)&&(this.L3b(),this.jPc(!0)),this.yh.Jna(a)):u.AFrameworkApplication.Ta.processAction(D.a.Q$g,2))}}Object(n.a)(pI,"Box4HtmlNormalizer",Yr,[]);class qI{constructor(a,b,c,f,l,w,H,U,ja,wa){this.htmlProcessor=a;this.Xde=b;this.TKh=c;this.h1i=f;this.d9k=l;this.e9k=
w;this.VWc=H;this.vBj=U;this.xBj=ja;this.W0j=wa}}Object(n.a)(qI,"ExecutePasteArguments",null,[]);class rI extends Fj{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){super(b,c,f,Sa);this.k7=null;this.aia=a;this.wyd=l;this.jDd=w;this.wMd=H;this.fOd=U;this.nTb=ja;this.zob=ub;this.$a=wa;this.ief=Object.assign(new lC,{J9b:2===this.Bg.RQa||3===this.Bg.RQa});this.vBd=eb;this.WWb=wa.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.N0h=wa.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get wed(){return!1}get gig(){return!ha.a.awl(ha.a.$Ac,
this.aia.innerText)}get QIf(){return this.aia.innerText}lUf(a){this.k7=new ob.GraphIterator;this.Thb.restore(this.k7);ka.ULS.shipAssertTag(6305550,307,fe.OutlineElementReader.$g(this.k7));this.Bg.$0&&this.Bg.$0.THc("external");var b=this.Bg.ks&8192?1:0,c=this.jDd.value.create(b,this.k7);const f=this.wMd.value.create(b,this.k7),l=Gm.a.dbe(u.AFrameworkApplication.userSessionId),w=Gm.a.W7d(B.a.N6a,this.Bg.dWd),H=Gm.a.c7f(u.AFrameworkApplication.userSessionId),U=Gm.a.d7f(u.AFrameworkApplication.userSessionId),
ja=this.WWb?this.aGj():null,wa=Gm.a.n3f(B.a.N6a,this.Bg.dWd),Sa=Gm.a.o3f(u.AFrameworkApplication.userSessionId),eb=this.nTb.Luh?Gm.a.pdj(u.AFrameworkApplication.userSessionId):null;b=this.wyd.value.create(b,this.k7,c,f,null,w);b=new lI(b,H,U);b=new pI(b,c,this.zob);b=new ul(b,this.nTb,this.ief,eb);b=new kI(b,wa,ja,this.$a);b=new ar(b,Sa);c=new qI(b,c,l,w,H,U,ja,wa,Sa,eb);c=new ii.a(a,Object(F.a)(this,this.uKk,"preprocessStyle"),c);c.Pl("paste and request pictures");c.Qi=!a||a.Qi;c.run()}uKk(a){if(this.N0h){const b=
this.aia.getElementsByTagName("style");if(b&&0<b.length){ka.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.vBd.KBi(this.aia,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.Yg(Object(F.a)(this,this.bCi,"convertWordListHtml"));return!0}bCi(a,b){this.fOd.value.create(b.TKh).process(this.aia,a);a.Yg(Object(F.a)(this,this.FLk,"processHtml"));return!0}FLk(a,b){b.htmlProcessor.process(this.aia,a);b=b.Xde&&
b.Xde.qid?Object(F.a)(this,this.Cmd,"requestImages"):Object(F.a)(this,this.BSf,"endPasteOperation");a.Yg(b);return!0}Cmd(a,b){if(b=b.Xde){let c=!1,f=!1,l=!1,w=!1,H=-1;const U=new K.DictionaryPropertySet,ja=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Ya.a)(10,this.Bg.rd)){c=this.Bg.rd.sa(Va.a.Ike,!1);const wa=this.Bg.rd.sa(Yd.a.JU,"");l=this.Bg.rd.sa(Yd.a.e_c,!1);w=this.Bg.rd.sa(Za.a.bO,!1);ja.test(wa)&&(f=!0);this.Nuh&&(H=this.Bg.rd.sa(Qs.a.k3b,-1))}else this.Bg.ks&256&&this.aia&&
(c=!0,ja.test(this.aia.innerHTML)&&(f=!0));U.setValue(Va.a.Ike,c);U.setValue(Yd.a.aYj,f);U.setValue(Yd.a.e_c,l);U.setValue(Qs.a.k3b,H);U.setValue(Za.a.bO,w);b.x1g&&(this.Bg.m$b=!0,this.Bg.mee=b.vNc,this.Bg.DGe=b.x1g,u.AFrameworkApplication.Ta.processAction(D.a.Cmd,2))}a.Yg(Object(F.a)(this,this.BSf,"endPasteOperation"));return!0}BSf(a,b){Gm.a.f6j(b.TKh);Gm.a.g4j(b.xBj);Gm.a.t5j(b.d9k);Gm.a.u5j(b.e9k);Gm.a.z4j(b.W0j);a="Others";b.VWc&&(b.VWc.d4j(),b.VWc.e4j(),a=b.VWc.u_e);Gm.a.f4j(b.vBj,a);Gm.a.V3j(b.h1i,
a);return!1}aGj(){const a=new jI;a.fIb=B.a.N6a;this.Bg&&(a.ks=this.Bg.ks,a.UJe=this.Bg.dWd,this.Bg.rd&&(a.GNe=this.Bg.rd.sa(Yd.a.N$g,"")));this.aia&&this.aia.innerHTML&&(a.M$g=this.aia.innerHTML.length);u.AFrameworkApplication.gd&&(a.platform=u.AFrameworkApplication.gd.Platform);return a}get $uh(){return!0}get Zuh(){ka.ULS.shipAssertTag(6305551,307,!!this.k7);if(this.nTb.Muh(this.ief)){let a=!1;fe.OutlineElementReader.$g(this.k7)&&(this.k7.p7b(),a=!0);const b=zb.ParagraphReader.el(this.k7)&&!this.k7.currentNode.sa(Yd.a.Zig,
!1);a&&this.k7.zc();return b}return zb.ParagraphReader.el(this.k7)}}Object(n.a)(rI,"ExternalPasteExecutionManager",Fj,[]);class sI{constructor(a,b,c,f,l,w,H,U){this.wyd=a;this.jDd=b;this.wMd=c;this.fOd=f;this.nTb=l;this.$a=w;this.vBd=H;this.zob=U}create(a,b,c,f){return new rI(a,b,c,f,this.wyd,this.jDd,this.wMd,this.fOd,this.nTb,this.$a,Pc.App.Kb.Ld,this.vBd,this.zob)}}Object(n.a)(sI,"Factory",null,[1004]);class rz{constructor(a){this.Oka=a.bcj();this.D$a=a.lTc("intCopy");this.Bhd=a.F9d("intCopy");
this.g7a=a.fSc("intCopy");this.hQa=a.TRc("intCopy")}static LW(){return rz.xr()}static xr(){return new rz(Lc.a.instance)}}Object(n.a)(rz,"InternalCopyUsageHelper",null,[]);class wx{constructor(a,b,c){this.nN=rz.LW();this.YJc=null;this.Eqd=this.Jvd=!1;this.gcf=null;this.source=a;this.target=b;this.rKe=c}get N6(){return this.nN}get hL(){return this.gcf}set hL(a){this.gcf=a}}Object(n.a)(wx,"InternalCopyArguments",null,[]);class tI extends wx{constructor(a,b,c,f){super(a,b,{});this.tLb=[];for(a=0;a<c.length;a++)Array.addRange(this.tLb,
c.ga(a).toArray());this.fsa=0;this.$qj=f}}Object(n.a)(tI,"BasicInternalCopyArguments",wx,[]);class uI extends Sys.EventArgs{constructor(a){super();this.hL=a}}Object(n.a)(uI,"BeforePasteArguments",Sys.EventArgs,[]);class sz extends wx{constructor(a,b){super(a.source,a.target,a.rKe);this.Bg=a;this.insertAfter=b}get N6(){return this.Bg.N6}get hL(){return this.Bg.hL}set hL(a){this.Bg.hL=a}}Object(n.a)(sz,"CoreInternalCopyArguments",wx,[]);class tz{constructor(a,b,c,f,l=null){this.source=a;this.target=
b;this.insertAfter=c;this.nhd=f;this.hL=l||{}}}Object(n.a)(tz,"CoreInternalPasteArguments",null,[]);class vI{constructor(a,b,c,f,l,w,H,U,ja){this.aOb=a;this.source=b;this.target=c;this.nhd=f;this.rowIndex=l;this.ija=w;this.B$g=U;this.Hf=ja}}Object(n.a)(vI,"CoreInternalTablePasteArguments",null,[]);class uz extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.hL=l}}Object(n.a)(uz,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var br=d(206);class Fi{static qr(){Fi.$Kb=
new Ib.a;Fi.$Kb.$(88,!0);Fi.$Kb.$(4,!0)}static hta(a,b,c){const f=[];if(R.a.instance.ga(104)&&a.Hl&&Od.SelectionFactory.ZWj(a))a=ob.GraphIterator.nb(a.mb.mg.Ua.node),a.rc(14),c=Id.a.create(a.origin),c=Fi.iIc(c,!0,!0,null),a.set(c),nb.SelectionEditor.Gt(a),Fi.wSa(a,f);else for(let wa=0;wa<a.length&&!(c&&0<f.length);++wa){var l=a.ga(wa),w=Fi.eTc(l,!0),H=Fi.eTc(l,!1);if(!w||!H)continue;if(w===H&&w.contextId===Cb.a.Of){l=ob.GraphIterator.nb(w.node);l.rc(11)&&Fi.wSa(l,f);continue}var U=void 0;U=l=null;
var ja=-1;let Sa;if(w.node===H.node)Sa=w.node,H=H.node;else{U=Fi.e_f(w.node);l=Fi.e_f(H.node);for(ja=0;ja<U.length&&ja<l.length&&U[ja]===l[ja];++ja);U=U[ja-1];--ja;Sa=Fi.iIc(w,!0,!1,U);H=Fi.iIc(H,!1,!0,U)}if(Sa===H)l=Sa===w.node?w:Id.a.create(Sa),l=Fi.iIc(l,!0,!0,null),w=new nn.a,w.set(l),nb.SelectionEditor.Gt(w),Fi.wSa(w,f);else{w=new nn.a;w.set(Sa);nb.SelectionEditor.Gt(w);Sa===U&&w.Ii();for(Fi.wSa(w,f);w.parentNode!==U;){for(;w.lp();)Fi.wSa(w,f);w.zc()}if(H===U)for(;w.lp();)Fi.wSa(w,f);else{w.lp();
for(U=ja+1;U<l.length;++U){for(;w.currentNode!==l[U];)Fi.wSa(w,f),w.lp();if(H===l[U])break;w.Ii()}Fi.wSa(w,f)}}}if(0>=f.length)return null;if(b)for(b=new ob.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),Pa.OutlineElementNavigator.oi(b),f[a]=Id.a.create(b.currentNode);return Wa.a.$Qa(f)}static eTc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).al)return a.ga(b);if(a.ga(b).lx){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).al)return c.getContext(f)}}else for(b=a.length-1;0<=b;--b){if(a.ga(b).al)return a.ga(b);
if(a.ga(b).lx)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).al)return c.getContext(f)}return null}static wSa(a,b){Fi.Mlg(a)?Fi.HYi(a,b):Fi.$Kb.Gb(a.role)||(a=a.Sw(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,Id.a.create(a)))}static e_f(a){const b=[],c=new ob.GraphIterator;c.set(a);nb.SelectionEditor.Gt(c);for(Array.add(b,a);c.zc();)Array.add(b,c.currentNode);b.reverse();return b}static iIc(a,b,c,f){let l=a.node;if(nb.SelectionEditor.ik(a)&&(b&&0<a.Qa||c&&a.Lb<zb.ParagraphReader.textLength(l))||
nb.SelectionEditor.Xl(a)&&b&&0<zb.ParagraphReader.textLength(l))return l;a=new nn.a;a.set(l);for(nb.SelectionEditor.Gt(a);!a.fr;){l=a.currentNode;if(f===l||b&&!Fi.zOj(a)||c&&!Fi.JQj(a))return l;a.zc()}return a.currentNode}static JQj(a){let b=!0;if(a.lp())for(b=!1;Fi.$Kb.Gb(a.role)||R.a.instance.ga(77)&&16===a.vi&&Ie.isGhostCell(a);)if(!a.lp()){b=!0;break}return b}static zOj(a){const b=a.currentNode;let c=!0;if(a.Mta())for(c=!1;Fi.$Kb.Gb(a.role);)if(!a.Mta()){c=!0;break}a.zc();a.Pk(b);return c}static HYi(a,
b){a=Vl.a.rv(a);for(a.em(Fi.wYi,null);a.moveNext();)fe.OutlineElementReader.r9(a.currentNode)&&Array.add(b,Id.a.create(a.currentNode))}static wYi(a){return Fi.Mlg(a)}static Mlg(a){return a.fr||1===a.role||27===a.role}}Fi.$Kb=null;Object(n.a)(Fi,"OutlineElementGeneralizer",null,[]);Fi.qr();class wI{constructor(){this.controlCell=this.gp=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(n.a)(wI,"ComplexCellData",null,[]);var xx=d(178);class zC{constructor(a){this.Wm=a;a.A2j()}dispose(){this.Wm.VCl()}static nb(a){return new zC(a.Tj)}}
Object(n.a)(zC,"TempGraphAlgorithmLock",null,[106]);class Rh{constructor(a,b,c){this.Xaf=this.mI=null;this.yCc=[];this.$xc=[];this.MEc=[];this.jRb={};this.OHd={};this.Qxd={};this.HD=null;this.x5a=Rh.Znj(a);this.x5a.Ulk();this.Q2h=zC.nb(this.x5a);Rh.Hnb=this;this.A7=1;this.hAd=b;this.Q2a=c}get Rq(){return this.HD||(this.HD=Ab.a.instance.resolve("Box4.ITableEditor"))}get LJ(){return this.mI||(this.mI=Ab.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<--this.A7)){var a=new qf.GraphTransaction(7);
a.kd(this.x5a);this.VMk();this.Rmk();this.m_i();R.a.instance.ga(63)&&this.Wti();this.o_i();a.dispose();this.b3()}}Ffl(a){this.Xaf=a}o_i(){var a=ob.GraphIterator.nb(this.x5a);if(!a.HEa()){const b=this.LJ.F1b(a);Rh.HB.iW(a,!0);a=Pc.App.Kb.Ld.Dn;a.pp&&Rh.HB.zpd(b,a.j7b())}}cancel(){if(!(0<--this.A7)){var a=xx.a.Vz(this.x5a);for(a.em(Rh.A9e,null);a.moveNext();)a.iterator.fr||a.iterator.gZ(16,!1);this.b3()}}b3(){this.x5a.WCl();this.Q2h.dispose();Rh.Hnb=null}kpa(a){a.al?(Rh.WXj(a)&&Array.add(this.yCc,a.node),
this.EDh(a.node)):a.lx&&this.wyl(a)}wyl(a){for(let b=0;b<a.length;++b)this.kpa(a.getContext(b))}EDh(a){a.anchor.uT(16)}Rmk(){for(let b=0;b<this.yCc.length;++b){var a=this.yCc[b];if(!a.anchor||a.anchor.$I)continue;const c=new ob.GraphIterator;c.set(a);if(!nb.SelectionEditor.Gt(c))continue;Pa.OutlineElementNavigator.Re(c);if(this.Q2a.mqi(c)){Rh.Qh.gDa(c);continue}a=new nn.a;a.Rc(c);if(!Pa.OutlineElementNavigator.HJ(a,!1,!1))continue;if(36===a.role)continue;Pa.OutlineElementNavigator.oi(a);if(a.currentNode.YW)continue;
if(hd.TableReader.eq(a))continue;Pa.OutlineElementNavigator.Re(a);const f=new ob.GraphIterator;f.Rc(a);f.zc();Rh.Qh.merge(c,a,!1,!1);fe.OutlineElementReader.ZI(f)&&!f.HEa()&&a.Oi()}Array.clear(this.yCc)}Wti(){for(let a=0;a<this.MEc.length;++a){const b=this.MEc[a];if(!b.anchor||b.anchor.$I)continue;if(Ie.isGhostCellNode(b))continue;const c=new ob.GraphIterator;c.set(b);c.aB(1);c.Bb(2);hd.TableReader.eq(c)&&(c.zc(),Rh.Qh.Gda(c,!1,!0,null))}Array.clear(this.MEc)}R6i(a){const b=a.id.toString();if(this.jRb[b])return this.jRb[b];
const c=Array(hd.TableReader.Ci(a));for(let f=0;f<hd.TableReader.Ci(a);++f)c[f]=0;this.jRb[b]=c;this.OHd[b]=hd.TableReader.tk(a);return c}VMk(){const a=xx.a.Vz(this.x5a);a.em(Rh.A9e,null);var b=a.moveNext();const c=new ob.GraphIterator;let f=0;for(;b;)if(a.iterator.fr)this.Jti(a.iterator),b=a.moveNext();else if(this.Q2a.TSj(a.iterator)&&Array.add(this.$xc,a.iterator.currentNode),R.a.instance.ga(63)&&Ie.isTableCell(a.iterator)&&Array.add(this.MEc,a.iterator.currentNode),Rh.uqi(a.iterator))switch(a.iterator.vi){case 16:b=
Rd.getContainingTable(a.iterator);if(this.hAd&&!hd.TableReader.Lu(b)&&!Ie.isGhostCell(a.iterator)){b=this.R6i(b);var l=xn.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=Rd.getContainingTable(a.iterator);this.hAd&&!hd.TableReader.Lu(b)?(this.Qxd[b.id.toString()]=!0,c.Rc(a.iterator),b=a.moveNext(),this.Rq.hNc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.Xaf?(a.moveNext(),c.Rc(a.iterator),b=a.moveNext(),Rh.Qh.gDa(c)):(a.iterator.gZ(16,!1),b=a.moveNext());break;case 23:c.Rc(a.iterator);
b=a.moveNext();c.Oi();break;case 11:f++;xf.b(a.iterator)?(a.iterator.gZ(16,!1),b=a.moveNext()):(c.Rc(a.iterator),rb.ListReader.vk(c)&&!this.Q2a.nYe(c,f)&&Rh.fq.moa(c),c.QI(2)?this.Q2a.zjl(c,f)?b=a.moveNext():(c.Rc(a.iterator),b=a.moveNext(),Rh.Qh.gDa(c)):(b=a.moveNext(),Rh.Qh.gDa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(hd.TableReader.eq(a.iterator)&&this.hAd){var w=a.currentNode;let H=w.id.toString();const U=this.jRb[H];let ja=!1;if(U){const wa=this.OHd[H];for(w=
hd.TableReader.Ci(w)-1;0<=w;--w)U[w]===wa&&(this.Rq.fNc(a.iterator,w),ja=!0)}hd.TableReader.Ci(a.iterator.currentNode)?R.a.instance.ga(30)&&(ja||this.Qxd[H])&&hd.TableReader.wme(a.iterator.currentNode)&&(c.Rc(a.iterator),Rd.moveToFirstRow(c),Rd.moveToFirstColumn(c),b=a.moveNext(),Rh.Qh.Gkh(a.iterator,c)):(a.moveNext(),c.Rc(a.iterator),b=a.moveNext(),c.Oi(),l=!1)}l&&(a.iterator.gZ(16,!1),b=a.moveNext())}this.jRb={};this.OHd={};this.Qxd={}}Jti(a){if(a.Ii()){do a.gZ(16,!1);while(a.EEa())}}m_i(){for(let b=
0;b<this.$xc.length;++b){var a=this.$xc[b];if(a.anchor&&!a.anchor.$I){const c=new ob.GraphIterator;c.set(a);Xg.OutlineNavigator.Y$(c)||(c.currentNode.setValue(Za.a.GE,Tm.a.first),R.a.instance.ga(41)&&10===c.vi&&(a=Rh.Qh.sfe(c,null,1),c.Pk(a)),Rh.HB.iW(c,!0))}}Array.clear(this.$xc)}static get fq(){return Rh.Zo||(Rh.Zo=Ab.a.instance.resolve("Box4.List.IListEditor"))}static get HB(){return Rh.Ux||(Rh.Ux=Ab.a.instance.resolve("Box4.IOutlineEditor"))}static get Qh(){return Rh.Fi||(Rh.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get UH(){return am.a.instance}static get ej(){return Kh.a.instance}static UTc(a,
b){Rh.Hnb?Rh.Hnb.A7++:Rh.Hnb=new Rh(a,b,Ab.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Rh.Hnb}static Znj(a){a=ob.GraphIterator.nb(a);nb.SelectionEditor.Gt(a);a.WKb(b=>b.Hac);return a.currentNode}static WXj(a){let b=!1;nb.SelectionEditor.Xl(a)&&(b=!R.a.instance.ga(14)||!Rh.ej.FZc(a));!b&&zb.ParagraphReader.tm(a)&&(b=!R.a.instance.ga(14)||!Rh.ej.M_c(a)&&!a.node.sa(Va.a.rbb,!1));return b}static uqi(a){switch(a.vi){case 12:return a.currentNode.uJc}if(!a.Ii())return Rh.UH.wog(a)?
Rh.UH.AUd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.XW&16||16===a.vi&&Ie.isGhostCell(a)||(b=!1)}a.gZ(16,!0)}while(a.EEa());b&&Rh.UH.wog(a)&&(b=Rh.UH.AUd(a.currentNode));return b}static lqi(a){return a.fr||!!(a.XW&16)}}Rh.A9e=Rh.lqi;Rh.Hnb=null;Rh.Pa=new vc.a;Rh.Ux=null;Rh.Zo=null;Rh.Fi=null;Object(n.a)(Rh,"GraphStructureNormalizer",null,[]);class bu{constructor(){this.kNb=this.gp=this.fD=null;this.Mgb=0;this.response=2}}Object(n.a)(bu,"TableGeneralizeData",
null,[]);class ni{static get jm(){return vh.ContextSetEditor.instance}static P5(a,b,c,f,l,w,H){let U=!1;w&&w[ni.SPb]&&w[ni.SPb]&&(U=!0);if(!b.view.Nh)return 2;const ja=b.view;var wa=ja.Mb;if(1===c){if(!wa||!wa.Na.mb)return 8;b=0===H?b.CE:ni.jm.b5b(b.CE,H,!0);return u.AFrameworkApplication.Ta.pi(b,a,c,!0,f,l)}w&&w[ni.xpa]&&fd.a.mark(w[ni.xpa]);const Sa=fn.SelectionReferenceFactory.instance.ksa(),eb=wa.Na.mb.Ua;wa=new qf.GraphTransaction(15);wa.kd(eb.node);wa.tya();b=0===H?b.CE:ni.jm.b5b(b.CE,H);a=
u.AFrameworkApplication.Ta.pi(b,a,c,!0,f,l);32===a&&Sa.QU(U);y.FocusManager.instance().rf(ja.FI);wa.dispose();Pc.App.Kb.updateCommandUI();w&&w[ni.wpa]&&fd.a.mark(w[ni.wpa]);return a}static Ahb(a,b,c,f,l,w){var H=de.a.instance;let U,ja=!1;w&&w[ni.SPb]&&w[ni.SPb]&&(ja=!0);if(1===c)return H&&H.Na.mb?(U=Fi.hta(H.Na,!1,!0))?u.AFrameworkApplication.Ta.pi(U,a,c,!0,f,l):8:8;w&&w[ni.xpa]&&fd.a.mark(w[ni.xpa]);const wa=fn.SelectionReferenceFactory.instance.ksa(),Sa=H.Na.mb.Ua;U=Fi.hta(H.Na,!1);if(!U)return 8;
H=new qf.GraphTransaction(15);H.kd(Sa.node);H.tya();a=u.AFrameworkApplication.Ta.pi(U,a,c,!0,f,l);32===a&&wa.QU(ja);(b=b.view)&&y.FocusManager.instance().rf(b.FI);H.dispose();Pc.App.Kb.updateCommandUI();w&&w[ni.wpa]&&fd.a.mark(w[ni.wpa]);return a}}ni.xpa="PerfMarkStart";ni.wpa="PerfMarkEnd";ni.SPb="CollapseIp";Object(n.a)(ni,"ViewActionHandler",null,[]);var xI=d(561);class yI{constructor(){this.controlCell=null;this.jHf=this.hnh=0;this.qXf=this.rXf=null}}Object(n.a)(yI,"MergedCellInfo",null,[]);var yx=
d(318),zI=d(677),pQ=d(726),yn=d(366);class xv extends Kj.a{constructor(a){super(0,0,0);this.h8=a;this.dNa=Array(a)}U6i(a){return this.dNa[a]}Fqh(a,b){this.dNa[a]=b}copy(){const a=new xv(this.h8);for(let b=0;b<this.h8;++b)a.dNa[b]=this.dNa[b];return a}Zmk(){let a=yn.a.mlb;for(let b=0;b<this.h8;++b)a+=this.dNa[b]+1;return a}static Bwi(a,b){const c=new xv(a.h8);for(let f=0;f<c.h8;f++)c.dNa[f]=Math.max(a.dNa[f],b.dNa[f]);return c}}Object(n.a)(xv,"TableRowViewSizeConstraints",Kj.a,[]);class cu extends dh.a{constructor(a,
b,c,f,l,w=null){super(a,b,c);this.n2a=null;this.Hzd=0;this.Vwc=-1;this.hd=f;this.fd=l;this.nc(this.Nd.jp(Ga.a.tr));this.htmlElement.className="TableRow";Fb.d(this.htmlElement,ua.a.role,"row");this.ukh();this.ibf=w}Ny(){this.gb.S9g=[];this.htmlElement.style.height=this.fnh;this.ukh()}ukh(){this.hd&&this.hd.lFa(65)&&(this.gb.b1b?Sys.UI.DomElement.addCssClass(this.htmlElement,jc.Z3):Sys.UI.DomElement.removeCssClass(this.htmlElement,jc.Z3))}Dal(a){const b=this.Vwc!==a;this.Vwc=a;return b}YGl(){this.htmlElement.style.height=
this.gnh+"px"}get gnh(){let a=0>=this.Vwc?cu.d_g:this.Vwc;this.gb.Sa(Va.a.tu)&&(a=Math.max(a,this.Nd.Md.Pe(this.gb.eb(Va.a.tu),1)));return a}get fnh(){return this.gb.Sa(Va.a.tu)?this.Nd.Md.Pe(this.gb.eb(Va.a.tu),1)+"px":"auto"}NU(a){super.NU(a);var b=hd.TableReader.Ci(Rd.getContainingTable(a));let c=0;b=new xv(b);if(a.Bb(1)){do b.Fqh(c,a.Xq.sLa.total),c++;while(a.Fj(1))}return b}iK(a){super.iK(a);this.IR.AU(this.htmlElement)}get author(){return this.n2a}$4e(a){let b=!0;if(this.Qc.pp&&this.Qc.QKj){a=
Vl.a.rv(a);for(var c={};a.moveNext();){if(!fe.OutlineElementReader.$g(a.iterator)||fe.OutlineElementReader.Oce(a.iterator))continue;const f=fe.OutlineElementReader.QRc(a.currentNode,Za.a.OZb);f&&(c[f]="")}a=pa.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.n2a=a,this.Hzd=c.height,b=!1)}b&&(this.n2a="",this.Hzd=-1)}get sXd(){return this.Hzd}T0k(){this.ibf&&this.ibf.oQl(this)}}cu.d_g=20;Object(n.a)(cu,"TableRowViewElement",
dh.a,[471]);class Sh{constructor(a,b){Sh.Ux=a;Sh.Fi=b}r3k(a){const b=a.Nsd.currentNode;this.sFl(b);let c=this.HCi(b);var f=this.Ymj(b,c);let l=f.length;a.mNc=this.tZi(f);a.kNc=this.KYi(f);f=a.mNc.toArray().length;const w=a.kNc.toArray().length;if(0<f||0<w)l-=f,c-=w,this.LHl(a);this.gMb(Object(qa.a)(yg.a,b),l);this.QLb(Object(qa.a)(yg.a,b),c);this.X2k(a)}KYi(a){const b=new Ka.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}tZi(a){const b=
new Ka.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===a[c][l]){f=!1;break}f&&b.add(c)}return b}HCi(a){let b=0;a=ob.GraphIterator.nb(a);Rd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,a));Rd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));let c=Object(qa.a)(126,a.yq),f=!1;for(;c;)!c.isGhostCell||Ie.isSkippedCell(Object(qa.a)(yg.a,c))?(b+=c.L$a?c.colSpan:1,f=!0):f||b++,c=Object(qa.a)(126,Rd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,a)));return b}LHl(a){const b=
ob.GraphIterator.nb(a.Nsd.yq);let c=0;Rd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,b));var f=b.yq;const l=Of.a.qf(cu.d_g,1);for(;f;){for(;a.mNc.contains(c);)c++;var w=1,H=a.jsc?a.jsc.rowIndex:0,U=a.wyh[H+c];for(U<l&&(U=l);a.mNc.contains(c+w);){var ja=a.wyh[H+c+w];ja<l&&(ja=l);U+=ja;w++}f.setValue(Va.a.tu,U);f=w-1;w=0;Rd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,b));for(H=Object(qa.a)(126,b.yq);H;){U=H.L$a?H.colSpan:1;if(!H.isGhostCell||1<U){0<f&&(H.rowSpan-=f,1>H.rowSpan&&(H.rowSpan=1));
ja=0;for(let wa=1;wa<U;wa++)a.kNc.contains(w+wa)&&ja++;0<ja&&(H.colSpan-=ja,1>H.colSpan&&(H.colSpan=1))}w+=U;H=Object(qa.a)(126,Rd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,b)))}c++;Rd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,b));b.zc();f=Rd.moveToNextRow(Object(qa.a)(ob.GraphIterator,b))}}sFl(a){const b=new Ka.a;a=ob.GraphIterator.nb(a);Rd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,a));for(var c=a.yq;c;){c=!1;let l=0;Rd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));for(var f=
Object(qa.a)(yx.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.L$a?(c=!0,b.contains(l)||(f.isGhostCell=!1,f.GVd())):Ie.isSkippedCell(Object(qa.a)(yg.a,f))||b.contains(l)&&(c||R.a.instance.ga(77))||(f.isGhostCell=!1,f.GVd());else{c=!0;f=f.L$a?f.colSpan:1;for(let w=0;w<f;w++)b.contains(l+w)||b.add(l+w)}l++;f=Object(qa.a)(yx.TableCellNode,Rd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,a)))}Rd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));a.zc();c=Rd.moveToNextRow(Object(qa.a)(ob.GraphIterator,
a))}}Ymj(a,b){const c=[];let f=0;a=ob.GraphIterator.nb(a);Rd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,a));for(var l=a.yq;l;){l=0;Rd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));for(var w=Object(qa.a)(126,a.yq);w;){if(!w.isGhostCell||Ie.isSkippedCell(Object(qa.a)(yg.a,w))){const H=w.L$a?w.colSpan:1;for(w=w.Jce?w.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let U=0;U<w;U++){const ja=f+U;ja===c.length&&Array.add(c,Array(b));for(let wa=0;wa<H;wa++)c[ja][l+wa]=0<U||0<wa?2:1}l+=H}w=
Object(qa.a)(126,Rd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,a)))}Rd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));a.zc();l=Rd.moveToNextRow(Object(qa.a)(ob.GraphIterator,a));f++}return c}X2k(a){if(hd.TableReader.eq(a.Nsd)&&a.jsc&&a.uyh){var b=Object(qa.a)(129,a.Nsd.yq),c=a.uyh,f=Array(b.h8),l=a.jsc.ija;for(let w=0;w<f.length;w++)for(f[w]=c[l],l++;a.kNc.contains(l-a.jsc.ija);)f[w]+=c[l],l++;b.KQa=f}}Fza(a){if(R.a.instance.ga(77)||R.a.instance.ga(63))Rd.forEachCellInTable(a,b=>{b.currentNode.WIa=
null;return!0}),Rd.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;1<f||1<l?this.VFi(b,f,l):c.PSe()}return!0})}VFi(a,b,c){const f=a.currentNode,l=new ob.GraphIterator;l.Rc(a);Rd.forEachCell(l,b,c,(w,H,U)=>{const ja=w.currentNode;if(ja!==f){ja.isGhostCell=!0;let Sa=!1;var wa=!0;const eb=Sh.ze;eb&&(Sa=eb.isFeatureEnabled(136),eb.acb(136));do{w.Bb(1);if(Object(Ya.a)(xI.a,w.currentNode)){if((wa=wa&&fe.OutlineElementReader.isEmpty(w,!1))||!Sa)wa=ob.GraphIterator.nb(w.yq),
wa.rc(16),wa=!wa.Cf(1);wa||a.Cl(w.currentNode,1);w.Oi()}wa=!1}while(Sa&&w.QI(1))}ja.WIa=Object.assign(new yI,{controlCell:f,hnh:H,jHf:U});1!==H||U||(f.WIa.qXf=ja);H||1!==U||(f.WIa.rXf=ja);ja.PSe();U||(ja.colSpan=c)});f.rowSpan=b;f.colSpan=c}lfe(a){const b=new ob.GraphIterator;b.Rc(a);Rd.returnToContainingRow(b);var c=b.currentNode;b.Bb(1);const f=new ob.GraphIterator;f.Rc(a);Rd.returnToContainingTable(f);a=f.currentNode;this.Fza(f);const l=Fs.a.instance.createInstance(393251);this.j9b(f,l,c,c,!1);
f.Pk(l);c=hd.TableReader.Ci(a);for(let w=0;w<c;++w){const H=b.currentNode,U=this.osa();this.DYb(f,U,H,!1,!0);if(!U.isGhostCell)if(H.isGhostCell){let ja;(ja=H.WIa.controlCell).rowSpan=ja.rowSpan+1}else H.rowSpan=2;b.Cf(1)}this.gMb(a,hd.TableReader.tk(a)+1);Rd.returnToContainingTable(f);this.Fza(f);return l}kfe(a){const b=ob.GraphIterator.nb(a.vJh());let c=hd.TableReader.Ci(b.currentNode);a=xn.a(a);const f=a+1;this.Fza(b);b.Bb(1);do{const w=b.$p(a,1);b.zc();const H=this.osa();this.Z8b(b,H,w,!1,!1);
if(!H.isGhostCell)if(w.isGhostCell){var l=void 0;(l=w.WIa.controlCell).colSpan=l.colSpan+1}else w.colSpan=2}while(b.Fj(1));this.Fza(b);(l=b.currentNode.sa(Za.a.$u,null))&&(l=Qa.a.clone(l));this.QLb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue(Za.a.$u,l));this.wkc(b.currentNode,f,!1,1,null)}Mld(a,b){hd.TableReader.Lu(a.currentNode)&&R.a.instance.ga(63)&&this.iih(a,c=>this.Zaj(c,b),(c,f)=>{c.we(Va.a.tu,f)},Va.a.complexTable)}fuj(a,b,c,f){let l=b;const w=b.WIa;R.a.instance.ga(77)&&
(a.isGhostCell=!1);if(w)if(Sh.WTc(w,!f))a.isGhostCell=!0;else{const H=Sh.Awb(w.controlCell,f);!b.isGhostCell&&c||!c&&Sh.WTc(w,f)===H-1?(l=w.controlCell,!f&&l.Jce&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,Sh.Pjb(w.controlCell,f,H+1));f&&l.L$a&&(a.colSpan=l.colSpan)}return l}Qsj(a,b,c){var f=a.WIa;if(f)if(a.isGhostCell)this.Ltj(f,b);else if(f=Sh.Awb(a,b),1<f){const l=Sh.Awb(a,!b),w=new ob.GraphIterator;w.set(a);w.rc(14);a=new ob.GraphIterator;a.Rc(w);const H=b?Rd.moveToNextRow(a):a.Cf(1);Sh.Pjb(H,b,
f-1);Sh.Pjb(H,!b,l);c(a,w)}}Ltj(a,b){Sh.WTc(a,!b)||Sh.Pjb(a.controlCell,b,Sh.Awb(a.controlCell,b)-1)}sPb(a,b){let c=!1;Rd.forEachCellInTable(a,f=>Ie.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.we(b,c)}iih(a,b,c,f){var l=hd.TableReader.tk(a.currentNode);const w=hd.TableReader.Ci(a.currentNode);if(l&&w){var H=!1,U=!1,ja=Array(l);Rd.forEachCellInTable(a,(Ub,cc,Fc)=>{Fc||(ja[cc]=Array(w));Ub=Ub.currentNode;Ub.isGhostCell?Ie.isSkippedCell(Ub)?ja[cc][Fc]=2:ja[cc][Fc]=1:ja[cc][Fc]=0;return!0});var wa=Array(l),
Sa=Array(l);for(var eb=0;eb<l;eb++){var ub=!!eb;let Ub=!0;for(let cc=0;cc<w;cc++)if(ja[eb][cc])1===ja[eb][cc]?Ub=!1:eb&&2===ja[eb-1][cc]||(ub=!1);else{Ub=ub=!1;break}wa[eb]=ub;Sa[eb]=Ub}for(--l;0<=l;l--)Sa[l]?(a.$p(l,1),this.hNc(a),Array.removeAt(ja,l),H=!0):wa[l]&&b&&(a.$p(l,1),H=a.k6b(1),eb=b(a.currentNode),ub=b(H),c(H,eb+ub),this.hNc(a),Array.removeAt(ja,l),H=!0);l=ja.length;if(0<l){wa=Array(w);Sa=Array(w);for(b=0;b<w;b++){c=!!b;eb=!0;for(ub=0;ub<l;ub++)if(ja[ub][b])1===ja[ub][b]?eb=!1:b&&2===
ja[ub][b-1]||(c=!1);else{eb=c=!1;break}wa[b]=c;Sa[b]=eb}b=a.currentNode.sa(Za.a.$u,null);c=!1;if(b)for(c=!0,b=Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=w-1;0<=l;l--)Sa[l]?(b&&Array.removeAt(b,l),this.fNc(a,l),U=!0):wa[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.fNc(a,l),U=!0);U&&b&&a.currentNode.setValue(Za.a.$u,b)}(H||U)&&this.sPb(a,f)}}Zaj(a,b){let c=ok.b(a);c||(a=a.sc(b))&&(c=te.a.GH(a.htmlElement.offsetHeight));return c}gMb(a,b){hd.TableReader.tk(a)!==b&&a.properties.setValue(Za.a.iza,
b)}QLb(a,b){const c=hd.TableReader.Ci(a);c!==b&&(b&&c&&a.properties.io(Za.a.$u,Za.a.c1a),a.properties.setValue(Za.a.Dga,b))}j3(a,b,c,f=null,l=!1,w=!1){a=this.aMf(a);R.a.instance.ga(71);this.dXf(a,b,c,f,l,w);R.a.instance.ga(71);return a}aMf(a){R.a.instance.ga(63)&&hd.TableReader.Cs(a)&&Rd.getContainingTable(a);const b=Fs.a.instance.createInstance(393250);a.Cl(b,2);a.Pk(b);return b}YTk(a,b,c,f,l){a=this.aMf(a);R.a.instance.ga(71);this.dXf(a,b,c,f,!1,l);ka.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",
a.id.toString(),b,c));return a}dXf(a,b,c,f=null,l=!1,w=!1){const H=ob.GraphIterator.nb(a);this.ILf(H,b,c,f,l);this.gMb(a,b);this.QLb(a,c);R.a.instance.ga(63);a.setValue(Za.a.llb,!w)}ILf(a,b,c,f=null,l=!1){for(var w=0;w<b;++w){var H=new pQ.a;a.Cl(H,1);R.a.instance.ga(55)&&H.setValue(Va.a.lo,Cf.a.a_a())}b=null;w=!0;a.Bb(1);do for(H=0;H<c;++H){const U=this.osa();a.Cl(U,1);({bph:b,isFirst:w}=this.cXf(a,U,l,f,b,w));Rd.returnToContainingRow(a)}while(a.Fj(1))}cXf(a,b,c,f,l,w){a.Pk(b);l&&c?Sh.Fi.rvi(a,l):
(Sh.Ux.iW(a,!0,f),!w&&c&&(l=new ob.GraphIterator,l.Rc(a)),w=!1);return{bph:l,isFirst:w}}wfe(a,b,c,f){const l=new ob.GraphIterator;l.Rc(a);var w=l.currentNode;l.Bb(1);let H=ok.c(a);if(b)var U=a.JF(1);else U=a.currentNode,H++;const ja=a.zc();R.a.instance.ga(63);this.Fza(a);let wa=null,Sa=null;for(var eb=0;eb<c;++eb){var ub=Fs.a.instance.createInstance(393251);Sa||(Sa=ub);wa=ub;this.j9b(a,ub,U,w,b)}w=hd.TableReader.Ci(a.currentNode);U=!0;do{U?(a.Pk(wa),U=!1):a.Cf(1);for(eb=0;eb<w;++eb){ub=this.osa();
const Ub=this.DYb(a,ub,l.currentNode,b,!0);this.oxf(a,ub,f(Ub));l.Cf(1)}l.vka(1)}while(a.currentNode!==Sa);this.gMb(ja,hd.TableReader.tk(ja)+c);this.xIe(ja,b,H,c)}hNc(a){const b=ok.c(a);var c=b+1;a.zc();R.a.instance.ga(63);this.Fza(a);for(--c;c>=b;--c){a.$p(c,1);let f=a.Bb(1);for(;f;)this.wHe(f,!0),f=a.Fj(1);a.Oi()}this.gMb(a.currentNode,hd.TableReader.tk(a.currentNode)-1);this.RHe(a,b,1)}Kfg(a,b,c,f,l){R.a.instance.ga(63);this.Fza(a);let w=hd.TableReader.Ci(a.currentNode);-1===b&&(b=w);const H=c?
b:b-1;a.Bb(1);do{const U=a.$p(H,1);a.zc();for(let ja=0;ja<f;++ja){const wa=this.osa(),Sa=this.Z8b(a,wa,U,c,!1);this.oxf(a,wa,l(Sa))}}while(a.Fj(1));this.KSk(a,w+f,f,b,c);this.wkc(a.currentNode,b,c,f,l)}KSk(a,b,c,f,l){let w=a.currentNode.sa(Za.a.c1a,null),H=a.currentNode.sa(Za.a.$u,null);w&&(w=Qa.a.clone(w));H&&(H=Qa.a.clone(H));this.QLb(a.currentNode,b);if(R.a.instance.ga(30)&&w){const U=Array(b);let ja=0;for(;ja<f;++ja)U[ja]=w[ja];for(;ja<f+c;++ja)U[ja]=!1;for(;ja<b;++ja)U[ja]=w[ja-c];a.currentNode.setValue(Za.a.c1a,
U)}H&&(b=this.zwf(a,H,b,f,l,c),a.currentNode.setValue(Za.a.$u,b))}zwf(a,b,c,f,l,w){a=Array(c);let H=l=0;for(;l<f;++l)a[l]=b[l],H+=a[l];for(;l<c;++l)a[l]=0>l-w?b[0]:b[l-w],H+=a[l];if(R.a.instance.ga(63)&&0<H)for(b=0/H,l=0;l<c;++l)a[l]=Math.max(Of.a.qf(yn.a.Isd,0),a[l]*b);return a}wkc(){}xIe(){}j9b(a,b,c){a.KXc(b,c,1,Sh.j3a?Sh.j3a():null)}Z8b(a,b,c,f){a.Pk(c);f=f?a.k6b(1):c;a.zc();a.KXc(b,f,1,Sh.j3a?Sh.j3a():null);return c}DYb(a,b,c){a.Msf(b,1,Sh.j3a?Sh.j3a():null);return c}oxf(a,b,c){Ie.isGhostCellNode(b)||
(a.Pk(b),Sh.Ux.iW(a,!0,c),Rd.returnToContainingRow(a))}fNc(a,b){R.a.instance.ga(63);this.Fza(a);let c=hd.TableReader.Ci(a.currentNode);-1===b&&(b=c-1);a.Bb(1);do for(let f=b+1-1;f>=b;--f)a.$p(f,1),this.wHe(a.currentNode,!1),a.Oi();while(a.Fj(1));this.JSk(a,c-1,b);this.QHe(a,b,1)}JSk(a,b,c){var f=a.currentNode.sa(Za.a.c1a,null);let l=a.currentNode.sa(Za.a.$u,null);f&&(f=Qa.a.clone(f));l&&(l=Qa.a.clone(l));this.QLb(a.currentNode,b);if(f){var w=Array(b);let H=0;for(;H<c;++H)w[H]=f[H];for(;H<b;++H)w[H]=
f[H+1];a.currentNode.setValue(Za.a.c1a,w)}if(l){f=Array(b);for(w=0;w<c;++w)f[w]=l[w];for(;w<b;++w)f[w]=l[w+1];a.currentNode.setValue(Za.a.$u,f)}}mergeCells(){}wHe(){}RHe(){}QHe(){}NLi(a){const b=xn.a(a);a.zc();a.zc();this.fNc(a,b)}osa(){const a=Fs.a.instance.createInstance(393252);a.setValue(Za.a.GE,Tm.a.first);(new WF.OutlineIndentInfo(!0)).Coh(a);return a}$J(a,b){a.setValue(Za.a.Jl,b);a.setValue(Za.a.gJ,b)}aGf(){}d0a(a,b,c){const f=hd.TableReader.Ci(a);let l=a.sa(Za.a.c1a,null);l=l?Qa.a.clone(l):
Array(f);let w=a.sa(Za.a.$u,null);w=w?Qa.a.clone(w):Array(f);l[b]=!0;w[b]=c;a.setValue(Za.a.$u,w);a.setValue(Za.a.c1a,l)}static get mh(){return Sh.Jf||(Sh.Jf=Ab.a.instance.resolve("Box4.IFormattingEditor"))}static get ze(){return Sh.hd||(Sh.hd=Ab.a.instance.rb("Box4.IFeatureHelper"))}static t5f(a,b=!0){const c=new zI.a;if(a){let f=null;a=Od.SelectionFactory.uj(a,b);if(!a)ka.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(Kb.a.DIf(a.ga(b))){f=a.ga(b);break}f&&
(a=Kb.a.xs(f),a.cache.it&&(a=a.ee(null),Sh.mh.SJ(a)),c.formatting=a.nm,c.languageId=Kb.a.language(a),R.a.instance.ga(71)&&(c.style=mb.StyleReader.aE(f.node)))}return c}static Pjb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static Awb(a,b){return b?a.rowSpan:a.colSpan}static WTc(a,b){return b?a.hnh:a.jHf}static baj(a,b){return b?a.rXf:a.qXf}static lui(a,b,c){let f=a.sa(Za.a.$u,null);f=f?Qa.a.clone(f):Array(c);f[b]=0;a.setValue(Za.a.$u,f)}}Sh.Jf=null;Sh.hd=null;Sh.Ux=null;Sh.Fi=null;Sh.j3a=null;Object(n.a)(Sh,
"TableEditor",null,[448]);class cr{constructor(a){this.pnb=this.IP=0;nb.SelectionEditor.ox(a)||(a=nb.SelectionEditor.Sl(a,!0,!1));a=a.Ua;const b=new ob.GraphIterator;b.set(a.node);nb.SelectionEditor.Gt(b);nb.SelectionEditor.Tg(a)&&(this.IP=a.Qa,this.pnb=a.SS);nb.SelectionEditor.g9(a)&&b.Jg(12);this.ckf=new ux(b)}restore(){var a=new ob.GraphIterator;this.ckf.em(Object(F.a)(this,this.K8k,"selectableFilter"),null);var b=new oz.a;const c=new oz.a;this.ckf.pmh(a,c,b);if(zb.ParagraphReader.ps(a.currentNode)){if(!c.value&&
b.value)return Od.SelectionFactory.uj(a.currentNode,!1);b=Id.a.Mj(a.currentNode,this.IP);-1!==this.pnb&&(a=zb.ParagraphReader.JSa(a.currentNode,this.IP),0<this.pnb&&this.pnb<=a&&(b.SS=this.pnb,b.Sra=this.pnb));return Od.SelectionFactory.Fu(b)}return a.currentNode.hB?nb.SelectionEditor.Sl(Od.SelectionFactory.wl(a.currentNode),!b.value,!1):(a=nb.SelectionEditor.Sja(a,!b.value))?zb.ParagraphReader.ps(a)?Od.SelectionFactory.Sg(a,b.value?zb.ParagraphReader.textLength(a):0):Od.SelectionFactory.wl(a):null}K8k(a){return a.currentNode.KFa||
a.currentNode.aJ}}Object(n.a)(cr,"IpReference",null,[]);class AI{constructor(){this.tableNode=null;this.columns=this.rows=0;this.KUj=!1}}Object(n.a)(AI,"TableActionData",null,[]);var qQ=d(183);class Rs{constructor(){this.X4b=!1}}Object(n.a)(Rs,"TrackChangeDeletionActionData",null,[]);class Ec{static get qca(){return Ec.hv||(Ec.hv=Ab.a.instance.rb("Box4.IAutoCorrectScheduler"))}static get wM(){return Ec.DG||(Ec.DG=Ab.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get nul(){return Ec.cqf||
(Ec.cqf=Ab.a.instance.rb("Box4.UI.TableAltTextDialogFactory"))}static get XLi(){return Ec.iaf||(Ec.iaf=Ab.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static er(){return Ec.Gm||(Ec.Gm=Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}static get jxb(){return Ec.l3a||(Ec.l3a=a=>Sh.t5f(a))}static set jxb(a){Ec.l3a=a}static get b$d(){return Ec.jCd||(Ec.jCd=Ec.cij)}static set b$d(a){Ec.jCd=a}static get Z9d(){return Ec.gCd||(Ec.gCd=Ec.Xhj)}static set Z9d(a){Ec.gCd=a}static get $9d(){return Ec.hCd||
(Ec.hCd=Ec.Zhj)}static set $9d(a){Ec.hCd=a}static get a$d(){return Ec.iCd||(Ec.iCd=Ec.aij)}static set a$d(a){Ec.iCd=a}static get c$d(){return Ec.kCd||(Ec.kCd=Ec.eij)}static set c$d(a){Ec.kCd=a}static get qbe(){return Ec.mCd||(Ec.mCd=Ec.Rqj)}static set qbe(a){Ec.mCd=a}static get n$d(){return Ec.lCd||(Ec.lCd=Ec.Pij)}static set n$d(a){Ec.lCd=a}static get kAb(){return Ec.LEd||(Ec.LEd=Ec.QUj)}static set kAb(a){Ec.LEd=a}static get ze(){return Ec.hd||(Ec.hd=Ab.a.instance.rb("Box4.IFeatureHelper"))}static get mh(){return Ec.Jf||
(Ec.Jf=Ab.a.instance.resolve("Box4.IFormattingEditor"))}static get Sf(){return Ec.fd||(Ec.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get F6(){return Ec.ap||(Ec.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get cVd(){return Ec.bNa||(Ec.bNa=Ab.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get UH(){return am.a.instance}static get ej(){return Kh.a.instance}static get Rf(){return Ec.Wg||(Ec.Wg=
Ab.a.instance.resolve("Box4.List.IListReader"))}static get fq(){return Ec.Zo||(Ec.Zo=Ab.a.instance.resolve("Box4.List.IListEditor"))}static get Qh(){return Ec.Fi||(Ec.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get jm(){return Ec.jha||(Ec.jha=vh.ContextSetEditor.instance)}static set jm(a){Ec.jha=a}static get Wc(){return Nc.a.instance}static get Rq(){return Ec.HD||(Ec.HD=Ab.a.instance.resolve("Box4.ITableEditor"))}static get Ev(){null==Ec.mF&&(Ec.mF=u.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&
!R.a.instance.ga(30));return Ec.mF}static wb(a){const b=w=>Fi.hta(w.Na,!1),c=(w,H,U,ja,wa)=>{const Sa=Pc.App.ULa.wKf(b);wa[Ec.vMf]={};return Sa(w,H,U,ja,wa)};Ec.lFj();const f=u.AFrameworkApplication.Ta;a=a.xKf();f.ya(D.a.j3,Cb.a.view,Ec.KIi);f.ya(D.a.j3,Cb.a.Of,Ec.j3);f.le(D.a.j3,1028);f.ya(D.a.eua,Cb.a.view,Ec.vfe);f.ya(D.a.eua,Cb.a.tableRow,Ec.insertRow);f.le(D.a.eua,1028);f.ya(D.a.lUa,Cb.a.view,Ec.vfe);f.ya(D.a.lUa,Cb.a.tableRow,Ec.insertRow);f.le(D.a.lUa,1028);f.ya(D.a.iUa,Cb.a.view,Ec.b9b);f.ya(D.a.iUa,
Cb.a.tableCell,Ec.insertColumn);f.le(D.a.iUa,4);f.ya(D.a.a9b,Cb.a.view,Ec.b9b);f.le(D.a.a9b,4);f.ya(D.a.pab,Cb.a.view,Ec.b9b);f.ya(D.a.pab,Cb.a.tableCell,Ec.insertColumn);f.le(D.a.pab,4);f.ya(D.a.$8b,Cb.a.view,Ec.b9b);f.le(D.a.$8b,4);f.ya(D.a.ZCa,Cb.a.view,Ec.lOf);f.ya(D.a.ZCa,Cb.a.tableCell,Ec.ZCa);f.le(D.a.ZCa,4);f.ya(D.a.deleteRow,Cb.a.view,Ec.lOf);f.ya(D.a.deleteRow,Cb.a.tableRow,Ec.deleteRow);f.le(D.a.deleteRow,1028);f.ya(D.a.r8,Cb.a.view,Ec.YLi);f.ya(D.a.r8,Cb.a.table,Ec.r8);f.le(D.a.r8,1028);
f.ya(D.a.t7a,Cb.a.table,Ec.t7a);f.ya(D.a.t7a,Cb.a.view,a);f.le(D.a.t7a,4);f.ya(D.a.insertTable,Cb.a.view,Ec.mIj);f.ya(D.a.insertTable,Cb.a.Of,Ec.insertTable);f.le(D.a.insertTable,1036);f.ya(D.a.mergeCells,Cb.a.view,Ec.Umk);f.ya(D.a.mergeCells,Cb.a.tableCell,Ec.mergeCells);f.le(D.a.mergeCells,4);f.ya(D.a.splitCells,Cb.a.view,Ec.Xql);f.ya(D.a.splitCells,Cb.a.tableCell,Ec.splitCells);f.le(D.a.splitCells,4);f.ra(D.a.mOk,Cb.a.view,Jr.a.h1,96);f.ra(D.a.oOk,Cb.a.view,Jr.a.h1,96);f.ya(D.a.Pul,Cb.a.view,Jr.a.dH);
f.ya(D.a.cvl,Cb.a.view,Jr.a.dH);f.ya(D.a.mYc,Cb.a.view,Ec.mYc);f.le(D.a.mYc,1124);f.ya(D.a.yOc,Cb.a.view,Ec.yOc);f.le(D.a.yOc,100);f.ya(D.a.rLb,Cb.a.view,Ec.rLb);f.ya(D.a.$pc,Cb.a.view,Ec.F8k);f.ya(D.a.Ynd,Cb.a.view,Ec.Ynd);f.ya(D.a.LUe,Cb.a.view,Ec.LUe);f.ya(D.a.Stc,Cb.a.view,a);f.ya(D.a.Stc,Cb.a.table,Ec.Stc);f.le(D.a.Stc,4);f.ya(D.a.inc,Cb.a.view,a);f.ya(D.a.inc,Cb.a.table,Ec.inc);f.le(D.a.inc,96);R.a.instance.ga(30)&&(f.ya(D.a.J0a,Cb.a.view,Ec.b9b),f.ya(D.a.J0a,Cb.a.Of,Ec.insertColumn),f.le(D.a.J0a,
4),f.ya(D.a.msc,Cb.a.Of,Ec.insertRow),f.ya(D.a.msc,Cb.a.view,Ec.vfe),f.le(D.a.msc,4));f.ya(D.a.RJb,Cb.a.view,Ec.RJb);R.a.instance.ga(63)?f.le(D.a.RJb,96):f.le(D.a.RJb,1124);a=[D.a.hpg,D.a.fpg,D.a.jpg,D.a.gpg,D.a.kpg,D.a.ipg,D.a.epg,D.a.w1c,D.a.v1c,D.a.x1c,D.a.t1c,D.a.s1c,D.a.u1c,D.a.p1c,D.a.o1c,D.a.q1c];for(var l of a)f.ya(l,Cb.a.view,Ec.aka),f.ya(l,Cb.a.tableCell,Ec.egi),f.le(l,4);l=[D.a.rOe,D.a.qOe,D.a.sOe,D.a.oOe,D.a.nOe,D.a.pOe,D.a.lOe,D.a.kOe,D.a.mOe];for(const w of l)f.ya(w,Cb.a.view,c),f.ya(w,
Cb.a.paragraph,Ec.lNk),f.le(w,68)}static lFj(){Ec.uD.$(D.a.kpg,Ec.uD.$(D.a.w1c,Ec.uD.$(D.a.v1c,Ec.uD.$(D.a.x1c,Ec.uD.$(D.a.rOe,Ec.uD.$(D.a.qOe,Ec.uD.$(D.a.sOe,Ec.qDh)))))));Ec.uD.$(D.a.ipg,Ec.uD.$(D.a.t1c,Ec.uD.$(D.a.s1c,Ec.uD.$(D.a.u1c,Ec.uD.$(D.a.oOe,Ec.uD.$(D.a.nOe,Ec.uD.$(D.a.pOe,Ec.Cnk)))))));Ec.uD.$(D.a.epg,Ec.uD.$(D.a.p1c,Ec.uD.$(D.a.o1c,Ec.uD.$(D.a.q1c,Ec.uD.$(D.a.lOe,Ec.uD.$(D.a.kOe,Ec.uD.$(D.a.mOe,Ec.Uji)))))));Ec.WB.$(D.a.hpg,Ec.WB.$(D.a.w1c,Ec.WB.$(D.a.t1c,Ec.WB.$(D.a.p1c,Ec.WB.$(D.a.rOe,
Ec.WB.$(D.a.oOe,Ec.WB.$(D.a.lOe,1)))))));Ec.WB.$(D.a.fpg,Ec.WB.$(D.a.v1c,Ec.WB.$(D.a.s1c,Ec.WB.$(D.a.o1c,Ec.WB.$(D.a.qOe,Ec.WB.$(D.a.nOe,Ec.WB.$(D.a.kOe,2)))))));Ec.WB.$(D.a.jpg,Ec.WB.$(D.a.x1c,Ec.WB.$(D.a.u1c,Ec.WB.$(D.a.q1c,Ec.WB.$(D.a.sOe,Ec.WB.$(D.a.pOe,Ec.WB.$(D.a.mOe,3)))))));Ec.WB.$(D.a.gpg,6)}static yOc(a,b,c){if(1===c)return 32;if(!b.view.Nh)return 2;a=b.view;if(!a.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;a=a.Mb.Qj;a=Ec.jm.V2(a,14);if(!a)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),
8;Ec.nul.create(a);return 32}static rLb(a,b,c){fd.a.mark(5756);if(!b.view.Nh)return 2;const f=b.view;if(!f.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;a=f.Mb.Qj;a=Ec.jm.V2(a,14);if(!a)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),8;if(2===c){let l=null;b=a.node;c=hd.TableReader.Lu(b);const w=Ec.Ev;if(!R.a.instance.ga(104)||c&&!w)l=Od.SelectionFactory.wl(a.node);else if(R.a.instance.ga(77))c=Od.SelectionFactory.uMc(b,w),f.Mb.iMb(c,null);else{a=ob.GraphIterator.nb(b);a.Bb(1);for(b=[br.TableNodeContext.create(a.currentNode)];a.Cf(1);)c&&
ok.h(a)||Array.add(b,br.TableNodeContext.create(a.currentNode));l=new gb.Selection(b,!0)}l&&(c=new ii.a(null,H=>{f.Mb.setSelection(l,H);return!1},null),c.Pl("SelectTable"),c.run())}fd.a.mark(5757);return 32}static F8k(a,b,c){fd.a.mark(5752);if(!b.view.Nh)return 2;a=b.view;if(!a.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;b=a.Mb.Na;if(!b)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),2;b=Ec.c$d(b);if(32!==b.response)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),b.response;if(2===c){var f=
b.fD;b=c=f[0].node;var l=ob.GraphIterator.nb(c);l.rc(14);let U=null;var w=Rd.getContainingTable(l);w=hd.TableReader.Lu(w);var H=Ec.Ev;H=R.a.instance.ga(104)&&(!w||H);const ja=[];for(let wa=0;wa<f.length;++wa){const Sa=l.currentNode===f[wa].node;if(Sa||w&&ok.d(l))b=l.currentNode,!H||w&&ok.h(l)||Array.add(ja,br.TableNodeContext.create(l.currentNode)),Rd.moveToNextRow(l),Sa||--wa}f=a.Mb.Na.mb;l=null;H?R.a.instance.ga(77)?(l=new ob.GraphIterator,H=new ob.GraphIterator,f.yf?(l.set(c),H.set(b)):(l.set(b),
H.set(c)),l.rc(14),Rd.moveToFirstColumn(l),H.rc(14),Rd.moveToLastColumn(H),l=w?Od.SelectionFactory.O1b(l,H):Od.SelectionFactory.ZLf(l,H)):U=new gb.Selection(ja,R.a.instance.ga(63)||f.yf):U=Od.SelectionFactory.LLf(c,b);U&&(l=new wc.SelectionCollection([U],0));a.Mb.iMb(l,null)}fd.a.mark(5753);return 32}static Ynd(a,b,c){fd.a.mark(5754);if(!b.view.Nh)return 2;a=b.view;if(!a.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;b=a.Mb.Na;if(!b)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),2;b=
Ec.a$d(b);if(32!==b.response)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),b.response;if(2===c){c=[];var f=b.fD,l=new ob.GraphIterator;l.set(f[0].node);l.rc(14);b=Rd.getContainingTable(l);var w=Number.MAX_VALUE,H=0;if(f.length===hd.TableReader.Ci(Rd.getContainingTable(l)))H=null,R.a.instance.ga(104)&&(H=Od.SelectionFactory.uMc(b,Ec.Ev))?c=H.toArray():(H=Od.SelectionFactory.wl(b),Array.add(c,H)),w=0,H=hd.TableReader.Ci(b)-1;else{for(l=0;l<f.length;++l){var U=ob.GraphIterator.nb(f[l].node);U.rc(14);
U=xn.a(U);w=Math.min(w,U);H=Math.max(H,U)}f=ob.GraphIterator.nb(b);Rd.moveToFirstRow(f);Rd.moveToColumnByIndex(f,w);l=new ob.GraphIterator;l.Rc(f);Rd.moveToColumnByIndex(l,H);var ja;U=b.Np();U=R.a.instance.ga(104)&&(!U||Ec.Ev);do(ja=U?Od.SelectionFactory.rMc(f,l,!0,!0):Od.SelectionFactory.LLf(f.currentNode,l.currentNode))&&Array.add(c,ja),ja=!Rd.moveToNextRow(f),Rd.moveToNextRow(l);while(!ja)}f=ob.GraphIterator.nb(b);Rd.moveToCell(f,0,w);w=hd.TableReader.tk(b);b=ob.GraphIterator.nb(b);Rd.moveToCell(b,
w-1,H);c=new wc.SelectionCollection(c,c.length-1,0,f,b);a.Mb.iMb(c,null)}fd.a.mark(5751);return 32}static LUe(a,b,c){fd.a.mark(5750);if(!b.view.Nh)return 2;a=b.view;if(!a.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;b=a.Mb.Qj;if(!b)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),2;var f=Ec.jm.MA(b);b={};for(var l=0;l<f.length;++l)if(f[l].al){var w=ob.GraphIterator.nb(f[l].node);w.Ze();if(!Ie.isTableCellOrInside(w))return 8;Rd.returnToCell(w);b[w.currentNode.id.toString()]=w}if(2===c){if(R.a.instance.ga(104)){c=
a.Mb.Na;if(c.mb.mg)return fd.a.mark(5751),32;f=c.mb;w=f.yf?f.Ua:f.Ye;l=f.yf?f.Ye:f.Ua;c=new ob.GraphIterator;c.set(w.node);c.Ze();w=new ob.GraphIterator;w.set(l.node);w.Ze();l=null;if((l=Rd.returnToLowestCommonTable(c,w))&&!l.Np()){var H=nb.SelectionEditor.Sl(f,!0,!1);H=br.TableNodeContext.create(c.currentNode,H.Ua);H=Od.SelectionFactory.K1b(Od.SelectionFactory.Fu(H));a.Mb.RE(H);fd.a.mark(5751);return 32}}c=[];for(H in b)f=Od.SelectionFactory.wl(b[H].currentNode),Array.add(c,f);0<c.length&&(H=new wc.SelectionCollection(c,
c.length-1),a.Mb.iMb(H,null))}fd.a.mark(5751);return 32}static Mmj(){return u.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static egi(a,b,c,f,l){f=Ec.gei();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(Ie.isGhostCellNode(b))return 32;Ec.uD.Gb(a)&&(c=Ec.uD.ga(a),b.we(Va.a.o1e,c));Ec.WB.Gb(a)&&(a=Ec.WB.ga(a),Ec.cyf(b,a));return 32}static cyf(a,b){if(!Ie.isGhostCellNode(a)&&(a=ob.GraphIterator.nb(a),Xg.OutlineNavigator.Y$(a))){do if(a.Bb(2)){const c=a.currentNode;
12===c.type?c.we(Za.a.Jl,b):14===c.type?hd.TableReader.GYf(c,f=>{Ec.cyf(f,b)}):ka.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",qQ.a[c.type]);a.zc()}while(a.lp())}}static lNk(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[Ec.vMf];if(Ec.cXd in c&&!c[Ec.cXd])return 32;f=Ec.WB.ga(a);a=Ec.uD.ga(a);if(!b||!b.node)return 2;var w=b.node;b=zb.ParagraphReader.KN(w);w=ob.GraphIterator.nb(w);w.rc(16);w.Jg(16);w=w.currentNode.sa(Va.a.o1e,Ec.qDh);c[Ec.cXd]=l[Vh.a.On]=f===
b&&a===w;return 32}static YLi(a,b,c,f,l){if(!b.view.Nh)return 2;a=b.view;if(!a.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;let w=a.Mb.Qj;w=Ec.jm.V2(w,14);if(!w)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),8;if(1===c)return u.AFrameworkApplication.Ta.pi(w,D.a.r8,c,!0,f,l);fd.a.mark(7117);const H=new cr(nb.SelectionEditor.Sl(Od.SelectionFactory.Fu(w),!0,!1)),U=new qf.GraphTransaction(15);try{U.kd(b.view.xg);const ja=Rh.UTc(w.node,!0);ja.kpa(w);const wa=Object(qa.a)(Rs,l)||new Rs;let Sa=u.AFrameworkApplication.Ta.pi(w,
D.a.r8,c,!0,f,Ec.Sf.hg?wa:l);const eb=!Ec.Sf.hg||!Ec.Sf.Yy||wa.X4b;32===Sa&&2===c&&eb?(ja.normalize(),a.Mb.setSelection(H.restore()),y.FocusManager.instance().rf(a.FI)):ja.cancel()}finally{U&&U.dispose()}fd.a.mark(7118);return 32}static KIi(a,b,c,f,l){fd.a.mark(4943);let w=null;2===c&&(w=new qf.GraphTransaction(15),w.kd(b.view.xg));a=u.AFrameworkApplication.Ta.pi(b.CE,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Nh)return 2;b=b.view;c=b.Mb.Qj;c=Ec.jm.V2(c,16);f=new ob.GraphIterator;f.set(c.node);f.rc(14);
Rd.moveToNextOrPreviousCell(f,!1);b.Mb.setSelection(Od.SelectionFactory.uj(f.currentNode,!0))}w&&w.dispose();fd.a.mark(4944);return a}static b9b(a,b,c,f){if(!b.view.Nh)return 2;var l=b.view;if(!l.Mb||!l.Mb.Na.mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;fd.a.mark(4945);var w=l.Mb.Qj;if(!w)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;l=a===D.a.iUa||a===D.a.J0a;var H=Ec.jm.MA(w);if(!H||0>=H.length)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;H=H[0].node;if(!H)return Ec.Wc.Xb(Ld.a.xh,
{["Reason"]:od.a.noSelection}),8;l=hd.TableReader.um(H)?a===D.a.$8b||l:a===D.a.a9b||l;const U=Ec.Z9d(w,l);if(32!==U.response)return U.response;w=U.gp;H=hd.TableReader.Lu(w);const ja=a;let wa;wa=l?Object(qa.a)(189,U.fD[U.fD.length-1]):Object(qa.a)(189,U.fD[0]);a!==D.a.J0a&&(a=l?D.a.iUa:D.a.pab);l=null;2===c&&(l=new qf.GraphTransaction(15),l.kd(b.view.xg));a=u.AFrameworkApplication.Ta.pi(wa,a,c,!0,f,U.Mgb);l&&l.dispose();2===c&&ka.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",
ja,D.a.mw(ja)||"Unknown",R.a.instance.ga(77),H,a,w.id.toString(),hd.TableReader.Ci(w)));fd.a.mark(4946);return a}static vfe(a,b,c,f){if(!b.view.Nh)return 2;const l=a===D.a.msc,w=a===D.a.lUa;fd.a.mark(4947);var H=b.view;if(!H.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;const U=H.Mb.Qj;if(!U)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;H=Ec.b$d(U,w);if(32!==H.response)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),H.response;const ja=hd.TableReader.Lu(H.gp);let wa=null;2===c&&(wa=
new qf.GraphTransaction(15),wa.kd(b.view.xg));b=w?Object(qa.a)(189,H.fD[0]):Object(qa.a)(189,H.fD[H.fD.length-1]);f=u.AFrameworkApplication.Ta.pi(l?U:b,a,c,!1,f,H.Mgb);wa&&wa.dispose();2===c&&ka.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",a,D.a.mw(a)||"Unknown",R.a.instance.ga(77),ja,f,H.gp.id.toString(),hd.TableReader.tk(H.gp)));fd.a.mark(4948);return f}static H_g(a){for(Rd.moveToFirstColumn(a);Ie.isGhostCell(a)&&
Rd.moveToPreviousRow(a););}static yok(a){for(Rd.moveToFirstRow(a);Ie.isGhostCell(a)&&Rd.moveToPreviousColumn(a););}static Umk(a,b,c,f){if(R.a.instance.ga(30)||!b.view.Nh)return 2;const l=b.view;if(!l.Mb||!l.Mb.Na.mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;const w=Ec.Tdj(l.Mb.Qj);if(32!==w.response)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),w.response;let H=null,U=null;2===c&&(H=new cr(l.Mb.Na.mb),H.restore(),U=new qf.GraphTransaction(15),U.kd(b.view.xg));a=u.AFrameworkApplication.Ta.pi(Id.a.create(w.controlCell),
a,c,!1,f,w);2===c&&32===a&&(b=ob.GraphIterator.nb(w.gp),b.Ze()&&Ec.Rq.Mld(b,l.Ma),H&&(l.Mb.setSelection(Od.SelectionFactory.uj(w.controlCell,!0)),y.FocusManager.instance().rf(l.FI)));U&&U.dispose();2===c&&ka.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static Tdj(a){const b=new wI;b.gp=null;b.controlCell=null;if(!a)return b.response=8,b;var c=Ec.jm.MA(a);if(1>=c.length)return b.response=2,b;const f=new Ka.a;a={};for(let U=0;U<c.length;++U)if(c[U].al){const ja=
ob.GraphIterator.nb(c[U].node);ja.Ze();if(!Ie.isTableCellOrInside(ja))return b.response=8,b;var l=Object(qa.a)(Sd.AParagraphNode,ja.currentNode);if(l&&!l.sa(Va.a.yke,!0))return b.response=8,b;Rd.returnToCell(ja);l=ja.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());var w=Rd.getContainingTable(ja),H=Rd.getContainingTableRow(ja).id.toString();if(b.gp)if(b.gp!==w)if(ja.JTa(b.gp))continue;else if(ob.GraphIterator.nb(b.gp).Vaa(w))a={},b.gp=w,b.controlCell=l,a[H]=l.colSpan;else return b.response=
8,b;else a[H]=H in a?a[H]+l.colSpan:l.colSpan;else a={},b.gp=w,b.controlCell=l,a[H]=l.colSpan;for(w=1;w<l.rowSpan;w++)Rd.moveToNextRow(ja),H=Rd.getContainingTableRow(ja).id.toString(),a[H]=H in a?a[H]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=a[c[0]];for(const U of c)if(b.colSpan!==a[U])return b.response=2,b;b.response=32;return b}static Xql(a,b,c,f,l){if(R.a.instance.ga(30)||!b.view.Nh)return 2;const w=b.view;if(!w.Mb||!w.Mb.Na.mb)return Ec.Wc.Xb(Ld.a.xh,
{["Reason"]:od.a.noSelection}),8;if(nb.SelectionEditor.ox(w.Mb.Na.mb))var H=w.Mb.Na.mb.Ua.node;else{H=w.Mb.Qj;if(!H)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),8;H=Ec.jm.MA(H);if(1!==H.length||!Object(Ya.a)(Id.a,H[0]))return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.IIf}),8;H=H[0].node}H=ob.GraphIterator.nb(H);H.Ze();if(!Ie.isInTableCell(H))return 2;Rd.returnToContainingCell(H);H=H.currentNode;let U=null,ja=null;2===c&&(U=new cr(w.Mb.Na.mb),U.restore(),ja=new qf.GraphTransaction(15),ja.kd(b.view.xg));
b=Id.a.create(H);a=u.AFrameworkApplication.Ta.pi(b,a,c,!1,f,l);2===c&&32===a&&U&&(w.Mb.setSelection(Od.SelectionFactory.uj(H,!0)),y.FocusManager.instance().rf(w.FI));ja&&ja.dispose();2===c&&ka.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));return a}static lOf(a,b,c,f,l){if(!b.view.Nh)return 2;const w=a===D.a.deleteRow;w?fd.a.mark(4951):fd.a.mark(4949);const H=b.view;if(!H.Mb||!H.Mb.Na.mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;var U=H.Mb.Qj;
const ja=Ec.n$d(U,w,H.Mb);if(32!==ja.response)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Tsa}),ja.response;const wa=hd.TableReader.Lu(ja.gp);var Sa=null,eb=null,ub=null;let Ub=!1;var cc=!1;2===c&&(Sa=new cr(H.Mb.Na.mb),cc=Sa.restore(),ub=ob.GraphIterator.nb(cc.Ua.node),ub.rc(14),Rd.returnToContainingCell(ub),cc=Ie.isLastCellInRow(ub),Rd.returnToContainingRow(ub),Ub=ok.j(ub),eb=Rh.UTc(b.view.xg,!0),wa&&(U=Ec.XLi.ZTf(U)),eb.kpa(U),ub=new qf.GraphTransaction(15),ub.kd(b.view.xg));b=Object(qa.a)(Rs,l)||
new Rs;f=u.AFrameworkApplication.Ta.pi(Wa.a.$Qa(ja.fD),a,c,!1,f,Ec.Sf.hg&&w?b:l);U=!Ec.Sf.hg||!Ec.Sf.Yy||!w||b.X4b;b=l=!1;if(2===c&&32===f&&U){let Fc=ob.GraphIterator.nb(ja.gp);Fc.Ze()&&Ec.Rq.Mld(Fc,H.Ma)}2===c&&32===f&&R.a.instance.ga(30)&&hd.TableReader.wme(ja.gp)&&U&&ob.GraphIterator.nb(ja.gp).Ze()&&(Sa=w?new cr(Od.SelectionFactory.uj(ja.gp,!Ub)):new cr(Od.SelectionFactory.uj(ja.gp,!cc)),H.Mb.setSelection(nb.SelectionEditor.Sl(Od.SelectionFactory.wl(ja.gp),!1,!1)),u.AFrameworkApplication.Ta.processAction(D.a.t7a,
2),b=l=!0);if(32===f&&2===c&&U){if(!l&&0>=hd.TableReader.Ci(ja.gp)||0>=hd.TableReader.tk(ja.gp))l=!0;eb.normalize();if(Sa){Sa=Sa.restore();if(l)Sa=b&&!w?Od.SelectionFactory.uj(Sa.Ua.node,!cc):Od.SelectionFactory.uj(Sa.Ua.node,!0);else if(eb=ob.GraphIterator.nb(Sa.Ua.node),eb.rc(14),w)Rd.returnToContainingRow(eb),Ub&&!R.a.instance.ga(77)?(eb.Ze(),Pa.OutlineElementNavigator.Re(eb),Ec.Qh.Gda(eb,!1,!0)):Ec.H_g(eb),Sa=Od.SelectionFactory.uj(eb.currentNode,!0);else if(Rd.returnToCell(eb),cc&&R.a.instance.ga(30))Rd.moveToLastRow(eb),
Sa=Od.SelectionFactory.uj(eb.currentNode,!1);else if(R.a.instance.ga(63)||R.a.instance.ga(77))Ec.yok(eb),Sa=Od.SelectionFactory.uj(eb.currentNode,!0);H.Mb.setSelection(Sa);y.FocusManager.instance().rf(H.FI)}}else eb&&eb.cancel();ub&&ub.dispose();2===c&&ka.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,D.a.mw(a)||"Unknown",R.a.instance.ga(77),wa,f,ja.gp.id.toString()));w?fd.a.mark(4952):fd.a.mark(4950);return f}static Rqj(a,
b){Rd.moveToFirstRow(a);const c=Object(qa.a)(yx.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)Rd.moveToNextColumn(a);else Rd.moveToPreviousColumn(a)}static cij(a){return Ec.c5b(a,!1,!0)}static Xhj(a){return Ec.c5b(a,!0,!0)}static Zhj(a,b){let c=xn.a(a);b&&(c+=a.currentNode.colSpan-1);return c}static aij(a){a=de.a.Isb(a);return Ec.c5b(a,!0,R.a.instance.ga(104)&&Ec.Ev)}static eij(a){a=de.a.Isb(a);return Ec.c5b(a,!1,R.a.instance.ga(104)&&Ec.Ev)}static Pij(a,b){return Ec.c5b(a,!b,!0)}static c5b(a,
b,c){const f=new bu;f.gp=null;if(!a)return f.response=8,f;var l={};let w=[],H=!1;a=Ec.jm.MA(a);1===a.length&&(H=!0);for(let Sa=0;Sa<a.length;++Sa)if(a[Sa].al){const eb=[];let ub=ob.GraphIterator.nb(a[Sa].node);ub.Ze();if(!Ie.isTableCellOrInside(ub))return f.response=8,f;if(b)Rd.returnToCell(ub),c&&1<Ie.getColSpan(ub.currentNode)?Ie.foreachMergedCells(ub.currentNode,Ub=>{Ub=ob.GraphIterator.nb(Ub);Ub.Ze();Rd.moveToFirstRow(Ub);Array.add(eb,Ub)},2):Array.add(eb,ub),Rd.moveToFirstRow(ub);else{Ie.isTableCell(ub)||
Rd.returnToCell(ub);var U=ub.currentNode.rowSpan;Rd.returnToContainingRow(ub);if(1<U)for(var ja=1;ja<U;ja++){var wa=ob.GraphIterator.nb(ub.currentNode);wa.Ze();Array.add(eb,wa);Rd.moveToNextRow(ub)}Array.add(eb,ub)}for(U=0;U<eb.length;++U)if(ub=eb[U],ja=Rd.getContainingTable(ub),wa=ub.currentNode.id.toString(),!l[wa])if(l[wa]=!0,f.gp)if(f.gp!==ja)if(ub.JTa(f.gp))Ec.yZf(ub,f.gp,b),wa=ub.currentNode.id.toString(),l[wa]||(l[wa]=!0,Array.add(w,ub));else if(l[wa]=!1,ob.GraphIterator.nb(f.gp).Vaa(ja)){const Ub=
[];for(let cc=0;cc<w.length;cc++){const Fc=w[cc];Ec.yZf(Fc,ja,b);wa=Fc.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(Ub,Fc))}wa=ub.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(Ub,ub));f.gp=ja;Array.clear(w);w=Ub}else return f.response=8,f;else Array.add(w,ub);else f.gp=ja,Array.add(w,ub);Array.clear(eb)}if(!w.length)return f.response=8,f;f.kNb=w[0].currentNode;b=[];for(l=0;l<w.length;l++){a=w[l];if(!c&&hd.TableReader.Ezb(a))return f.response=8,f;Array.add(b,Id.a.create(a.currentNode))}f.Mgb=
H?1:b.length;f.fD=b;f.response=32;return f}static yZf(a,b,c){do c?Rd.returnToContainingCell(a):Rd.returnToContainingRow(a);while(Rd.getContainingTable(a)!==b);c&&Rd.moveToFirstRow(a)}static mYc(a,b,c,f,l){return 1===c?(a=b.CE)&&nb.SelectionEditor.Tg(a)?u.AFrameworkApplication.Ta.pi(a,D.a.insertTable,c,!0,f,l):2:32}static mIj(a,b,c,f,l){f.CN=0;f.o3=0;let w=-1,H=null,U=null,ja=null;if(!b.view.Nh)return 2;const wa=b.view;if(!wa.Mb)return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;fd.a.mark(4941);if(2===
c){const Sa=wa.Mb.Qj;Sa.al&&(ja=new qf.GraphTransaction(15),U=VF.a.instance.noj(Sa.node),ja.Iy(U),H=new ob.GraphIterator,H.Rc(U),H.zc(),w=H.GSa(U.currentNode))}a=u.AFrameworkApplication.Ta.pi(b.CE,a,c,!0,f,l);32===a&&2===c&&(U.isValid?(Pa.OutlineElementNavigator.HJ(U,!1,!1),Pa.OutlineElementNavigator.oi(U),c=Od.SelectionFactory.uj(U.currentNode,!0)):(H.pbe(w),Pa.OutlineElementNavigator.oi(H),c=Od.SelectionFactory.uj(H.currentNode,!0)),wa.Mb.setSelection(c),y.FocusManager.instance().rf(wa.FI));ja&&
ja.dispose();fd.a.mark(4942);return a}static RJb(a,b){if(!b.view.Nh)return 8;a=b.view;if(!a.Mb)return 8;a=Ec.jm.MA(a.Mb.Qj);if(0>=a.length)return 8;b=new ob.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.Ze(),!hd.TableReader.Cs(b))return 8;return 32}static j3(a,b,c){var f=b.contextId===Cb.a.Of;let l=null,w=null;if(f){l=b;if(vb.HyperlinkReader.bla(l,!0))return Ec.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.EIf}),8;w=new ob.GraphIterator;w.set(l.node);nb.SelectionEditor.Gt(w);xf.b(w)&&(Ec.Wc.Xb(Ld.a.Wo,
{["Reason"]:od.a.mXd}),f=!1);!l.Qa&&w.zjg&&(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.ygg}),f=!1)}if(1===c||!f)return f?32:8;fd.a.mark(4929);b=new qf.GraphTransaction(7);b.Iy(w);Pa.OutlineElementNavigator.Re(w);c=w.currentNode;Ec.Qh.Gda(w,!1,!1);f=Ec.Rq.j3(w,1,2);const H=new ob.GraphIterator;H.set(c);H.Ze();Rd.moveToCellContent(w,0,1);Ec.Qh.wNb(H,w,l,!0,!0);Rd.returnToContainingTable(w);Rd.moveToCellContent(w,0,0);w.Oi();ym.i(H,w,null,H.role);Ec.fq.SPa(H,null);Rd.returnToContainingTable(w);Pa.OutlineElementNavigator.Re(w);
H.Bb(1)&&ym.h(w,null,1,1,H,-1);Ec.qca&&Ec.qca.puc(c,A.a.Sq);b.dispose();ka.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.mw(a)||"Unknown",R.a.instance.ga(77),f.id.toString()));fd.a.mark(4930);return 32}static insertColumn(a,b,c,f,l){u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?ka.ULS.sendTraceTag(541172701,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):
ka.ULS.sendTraceTag(541172702,324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var w=nb.SelectionEditor.Tg(b)&&a===D.a.J0a||b.contextId===Cb.a.tableCell;f=null;if(w&&(f=new ob.GraphIterator,f.set(b.node),f.rc(14),Ie.isTableCellOrInside(f)||(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.a1b}),w=!1),w&&!Ec.kAb(f,a)&&(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.$0b}),w=!1),w)){Rd.returnToContainingCell(f);var H=R.a.instance.ga(63)?63:255;if(hd.TableReader.Ci(Rd.getContainingTable(f))>=H)return Ec.Wc.Xb(Ld.a.Wo,
{["Reason"]:od.a.aZg}),8}if(1===c||!w)return w?32:8;fd.a.mark(4931);c=a!==D.a.pab;w=new qf.GraphTransaction(15);w.Iy(f);b.node.YG().graphTransactionOperations.Ria(2);H=new ob.GraphIterator;H.set(f.currentNode);H.rc(15);Rd.returnToContainingTable(f);let U=Ec.$9d(H,c);c&&U++;Ec.Rq.Kfg(f,U,!c,l?l:1,Ec.jxb);f.set(b.node);f.rc(16);a===D.a.J0a?(Rd.moveToNextColumn(H),Xg.OutlineNavigator.Y$(H),Pa.OutlineElementNavigator.Re(f),Ec.Qh.Goc(H),Ec.Qh.wNb(f,H,b,!0,!0),Ec.qca&&Ec.qca.puc(f.currentNode,A.a.Sq)):
(a=Pc.App.Kb.Ld,b=ob.GraphIterator.nb(b.node),b.Ze(),Ec.qbe(b,c),a.Dn.Mb.setSelection(Od.SelectionFactory.uj(b.currentNode,!0)));w.dispose();fd.a.mark(4932);return 32}static QUj(a){return!(R.a.instance.ga(14)&&hd.TableReader.$Pj(a))&&!(R.a.instance.ga(30)&&hd.TableReader.Ezb(a))}static insertRow(a,b,c,f,l){const w=a===D.a.msc;f=a===D.a.lUa;var H=b.node;const U=new ob.GraphIterator;U.set(H);U.Ze();let ja=!0;ok.m(H)||hd.TableReader.Cs(U)||(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.T0d}),ja=!1);ja&&!Ec.kAb(U,
a)&&(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.$0b}),ja=!1);if(1===c||!ja)return ja?32:8;fd.a.mark(4933);a=new qf.GraphTransaction(15);a.Iy(U);b.node.YG().graphTransactionOperations.Ria(2);w?(l=new ob.GraphIterator,l.Rc(U),Pa.OutlineElementNavigator.Re(l),Rd.returnToContainingRow(U),Ec.Rq.wfe(U,f,1,Ec.jxb),Rd.moveToFirstColumn(U),Xg.OutlineNavigator.Y$(U),Ec.Qh.wNb(l,U,b,!1,!0),Rd.returnToContainingRow(U),Ec.qca&&Ec.qca.puc(l.currentNode,A.a.Sq)):Ec.Rq.wfe(U,f,l?l:1,Ec.jxb);b=Pc.App.Kb.Ld;H=ob.GraphIterator.nb(H);
H.rc(14);ok.l(H)||Rd.returnToContainingRow(H);f?Rd.moveToPreviousRow(H):Rd.moveToNextRow(H);Ec.H_g(H);b.Dn.Mb.setSelection(Od.SelectionFactory.uj(H.currentNode,!0));a.dispose();fd.a.mark(4934);return 32}static aka(a,b,c,f,l){b=ni.P5(a,b,c,f,l,{},16);2===c&&Ec.Uoa(a)&&ka.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,D.a.mw(a)||"Unknown",b));return b}static Uoa(a){return a===D.a.w1c||a===D.a.v1c||a===D.a.x1c||a===D.a.t1c||a===D.a.s1c||a===D.a.u1c||a===
D.a.p1c||a===D.a.o1c||a===D.a.q1c}static ZCa(a,b,c){const f=new ob.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.Ze()||(Ec.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.SPc}),l=!1),Ie.isTableCellNode(b.node)||(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.a1b}),l=!1));l&&!Ec.kAb(f,a)&&(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.$0b}),l=!1);if(l&&!Ec.UH.URd()){a=new ob.GraphIterator;a.Rc(f);do if(!Ec.UH.C_b(a.currentNode)){Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.nLc});l=!1;break}while(Rd.moveToNextRow(a))}if(l&&(a=new ob.GraphIterator,
a.Rc(f),1!==c&&R.a.instance.ga(50)&&Pc.App.Jh.vw)){do for(b=Vl.a.Vz(a.currentNode);b.moveNext();){const w=b.currentNode;zb.ParagraphReader.ae(w)&&Pc.App.Jh.aZ.mra(w)}while(Rd.moveToNextRow(a))}if(1===c)return l?32:8;if(l){fd.a.mark(4935);c=new qf.GraphTransaction(7);try{c.Iy(f),Ec.Rq.NLi(f)}finally{c&&c.dispose()}fd.a.mark(4936);return 32}return 2}static mergeCells(a,b,c,f,l){a=new ob.GraphIterator;if(f=b.isValid){a.set(b.node);a.Ze()||(Ec.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.SPc}),f=!1);Ie.isTableCellNode(b.node)||
(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.a1b}),f=!1);if(f&&!Ec.UH.URd()){b=new ob.GraphIterator;b.Rc(a);var w=new ob.GraphIterator;w.Rc(a);for(var H=0;H<l.rowSpan;H++){for(var U=0;U<l.colSpan;U++){if(!Ec.UH.C_b(b.currentNode)){Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.nLc});f=!1;break}b.Cf(1)}if(!f)break;Rd.moveToNextRow(w);b.Rc(w)}}if(f&&1!==c&&R.a.instance.ga(50)&&Pc.App.Jh.vw)for(b=new ob.GraphIterator,b.Rc(a),w=new ob.GraphIterator,w.Rc(a),H=0;H<l.rowSpan;H++){for(U=0;U<l.colSpan;U++)Pc.App.Jh.aZ.mra(b.currentNode),
b.Cf(1);if(!f)break;Rd.moveToNextRow(w);b.Rc(w)}}if(1===c)return f?32:8;if(f){c=new qf.GraphTransaction(7);try{c.Iy(a),Ec.Rq.mergeCells(a,l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static splitCells(a,b,c){a=new ob.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.Ze()||(Ec.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.SPc}),f=!1),Ie.isTableCellNode(b.node)||(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.a1b}),f=!1),f&&1!==c&&R.a.instance.ga(50)&&Pc.App.Jh.vw&&(b=new ob.GraphIterator,b.Rc(a),Pc.App.Jh.aZ.mra(b.currentNode)));
if(1===c)return f?32:8;if(f){c=new qf.GraphTransaction(7);try{c.Iy(a)}finally{c&&c.dispose()}return 32}return 2}static r8(a,b,c,f,l){b=b.node;f=!0;hd.TableReader.zbb(b)||(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.lLc}),f=!1);Ec.UH.C_b(b)||(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.nLc}),f=!1);f&&(R.a.instance.ga(14)||R.a.instance.ga(63))&&Ec.ej.Tme(b)&&(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),f=!1);if(1===c)return f?32:8;if(f){if(R.a.instance.ga(50)&&Pc.App.Jh.vw)for(c=Vl.a.Vz(b);c.moveNext();)f=c.currentNode,12===
f.type&&Pc.App.Jh.aZ.mra(f);l=Object(qa.a)(Rs,l);c=new qf.GraphTransaction(7);c.kd(b);f=new ob.GraphIterator;f.set(b);f.Ze();f.zc();Ec.Qh.gDa(f);c.dispose();l&&(l.X4b=!0);ka.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.mw(a)||"Unknown",R.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!Ec.UH.C_b(b))return 8;f=new ob.GraphIterator;f.set(b);f.Ze();let w=ok.m(b);w||Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.LIf});
w&&!Ec.kAb(f,a)&&(Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.$0b}),w=!1);if(1===c)return w?32:8;if(w){if(R.a.instance.ga(50)&&!Pc.App.Jh.amIAlone)for(a=Vl.a.Vz(b);a.moveNext();)c=a.currentNode,12===c.type&&Pc.App.Jh.aZ.mra(c);fd.a.mark(4937);l=Object(qa.a)(Rs,l);a=new qf.GraphTransaction(7);a.kd(b);Ec.Rq.hNc(f);a.dispose();l&&(l.X4b=!0);fd.a.mark(4938);return 32}return 2}static t7a(a,b,c){let f=!1;a=null;b.al&&(a=new ob.GraphIterator,a.set(b.node),(f=hd.TableReader.eq(a)&&hd.TableReader.wme(a.currentNode))?
a.Ze():Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.KIf}));return 1===c?f?32:8:f?(fd.a.mark(4939),b=new ob.GraphIterator,b.Rc(a),Rd.moveToCell(b,0,0),Pa.OutlineElementNavigator.Re(a),c=new qf.GraphTransaction(7),c.Iy(b),Ec.Qh.Gkh(a,b),c.dispose(),fd.a.mark(4940),32):2}static insertTable(a,b,c,f,l){if(!b.al||!nb.SelectionEditor.Tg(b))return 2;if(R.a.instance.ga(14)&&Ec.ej.uua(b))return Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),2;if(Ec.er()&&Ec.er().instance&&Ec.er().instance.bX(b))return 2;var w=new ob.GraphIterator;
w.set(b.node);nb.SelectionEditor.Gt(w);if(xf.b(w))return Ec.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.mXd}),2;if(1===c)return 32;c=1;w=2;l&&(c=l.rows,w=l.columns);f.CN=w;f.o3=c;if(nb.SelectionEditor.Tg(b)){f=new qf.GraphTransaction(7);fd.a.mark(4927);f.kd(b.node);b.node.YG().graphTransactionOperations.Ria(2);const U=new zI.a;R.a.instance.ga(50)&&Pc.App.Jh.vw&&Pc.App.Jh.aZ.mra(b.node);var H=Kb.a.xs(b);R.a.instance.ga(49)&&(H.cache.it&&(H=H.ee(null),Ec.mh.SJ(H)),U.formatting=H.nm);U.languageId=Kb.a.language(H);
R.a.instance.ga(71)&&(U.style=mb.StyleReader.aE(b.node),Ec.Rf.V2b(U.style)&&(H=mb.StyleReader.sL(b.node)))&&(U.style=H.$G(mb.StyleReader.CMa));R.a.instance.ga(54)?(H=ob.GraphIterator.nb(b.node),H.rc(11),Ec.wM.N8(H.currentNode)):new nv.a(1,-1);b=Ec.Qh.WHj(b);H=l&&l.KUj?Ec.Rq.j3(b,c,w,U):Ec.Rq.j3(b,c,w,U,!0);l&&(l.tableNode=H);Pa.OutlineElementNavigator.Re(b);R.a.instance.ga(56)&&U.style&&!fe.OutlineElementReader.cme(b.currentNode)&&U.style.sa(Za.a.vY,!1)&&Ec.Qh.eLa(b.currentNode,!0);Ec.fq.SPa(b,null,
!0,!1,-1);fe.OutlineElementReader.fbb(b)&&Ec.Qh.Gda(b,!1,!0,U);f.dispose();ka.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,D.a.mw(a)||"Unknown",R.a.instance.ga(77),H.id.toString(),c,w));fd.a.mark(4928);u.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static Stc(a,b,c){if(1===c)return 32;fd.a.mark(5748);a=b.node;b=new qf.GraphTransaction(15);
b.kd(a);a.setValue(Za.a.llb,!a.sa(Za.a.llb,!0));b.dispose();fd.a.mark(5749);return 32}static inc(a,b,c,f,l){l.setValue(Za.a.llb,!b.node.sa(Za.a.llb,!0));return 32}}Ec.qDh="top";Ec.Cnk="center";Ec.Uji="bottom";Ec.vMf="__cumulative__";Ec.cXd="__consistent__";Ec.WB=new Ci.a;Ec.uD=new Ci.a;Ec.Fi=null;Ec.hv=null;Ec.DG=null;Ec.cqf=null;Ec.iaf=null;Ec.mF=null;Ec.Gm=null;Ec.l3a=null;Ec.gei=Ec.Mmj;Ec.jCd=null;Ec.gCd=null;Ec.hCd=null;Ec.iCd=null;Ec.kCd=null;Ec.mCd=null;Ec.lCd=null;Ec.LEd=null;Ec.hd=null;Ec.Jf=
null;Ec.fd=null;Ec.ap=null;Ec.bNa=null;Ec.Wg=null;Ec.Zo=null;Ec.jha=null;Ec.HD=null;Object(n.a)(Ec,"TableActor",null,[]);var BI=d(311),rQ=d(828),CI=d(887),sQ=d(406),tQ=d(813);class DI{constructor(a,b,c,f){this.mNc=this.kNc=null;this.jsc=a;this.Nsd=b;this.uyh=c;this.wyh=f}}Object(n.a)(DI,"TableSimplificationInformation",null,[]);var yv=d(421),uQ=d(455),du=d(255),zq=d(218);class Wh{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){this.Wg=this.l3a=this.nN=this.Ip=null;this.mHd=!1;this.gYh=w;this.DG=
H;this.Cob=a;this.HD=b;this.Ux=c;this.Fi=f;this.Zo=l;this.$a=U;this.Bk=wa;this.ONd=ja.create(2097162);this.HQe(this.ONd);this.kbf=ja.create(2097162);this.HQe(this.kbf);this.yrf=ja.create(2097162);this.HQe(this.yrf);this.l2=this.ONd;this.uMd=Sa;this.JD=eb;this.fd=ub;this.RWb=Ub;this.B0h=Ub.substr(0,3);this.iqa=cc}get Rf(){return this.Wg||(this.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}get Rr(){return this.Ip?this.Ip.Rr:0}get z7a(){return this.Ip.mb.z7a}get Mja(){return this.Ip.mb.Mja}get p2e(){return this.l2}get kXd(){return this.Ip.jH&&
!this.mHd}kth(){this.mHd=!0}get r8g(){return!this.Ip.jH}get aba(){return Lc.a.instance}get YSj(){return this.$a.ka("InternalPasteTableWithReplacingCellIsEnabled")&&R.a.instance.ga(63)||R.a.instance.ga(77)}HQe(a){var b=new uQ.a(-1);this.gYh.kV.mrb(b);const c=new ob.GraphIterator;c.set(b);b=this.Bk.oe(3);b.Iy(c);c.Cl(a,80);b.dispose()}OXd(a,b=null){a=a.Mb;this.Ip=a.Na.clone();this.mHd=!1;a=ob.GraphIterator.nb(a.wlb);const c=ob.GraphIterator.nb(this.l2),f=this.Bk.oe(3);f.Iy(c);a.Bb(82);do a.currentNode.S1a(null);
while(a.Fj(82));a=new ii.a(b,Object(F.a)(this,this.Bui,"clearInternalClipboard"),new tI(a,c,this.Ip,f));a.Pl("InternalCopy");a.Qi=!b||b.Qi;a.run()}Bui(a,b){fd.a.mark(5566);b=b.target;if(b.Ii())return b.Oi(),!0;a.Yg(Object(F.a)(this,this.wPc,"executeCopy"));return!0}wPc(a,b){b=new sz(b,null);b=new ii.a(a,Object(F.a)(this,this.o1b,"coreCopySetup"),b);b.Pl("ExecuteCoreCopyToInternalClipboard");b.run();a.Yg(Object(F.a)(this,this.Xzl,"trimNewText"));return!0}o1b(a,b){if(!b.source.Ii())return b.Bg&&(b.Bg.YJc=
null),ka.ULS.shipAssertTag(6305560,307,!1),!1;a.Yg(Object(F.a)(this,this.NJf,"coreCopyIteration"));return!0}NJf(a,b){const c=b.insertAfter,f=b.source,l=b.target,w=f.currentNode;var H=this.r8g;if(!w.Dle)return a.Yg(Object(F.a)(this,this.CLc,"coreCopyIncrement")),!0;b.Bg.Eqd&&(b.Eqd=!0);if(!b.Eqd&&(w.U3b()&&b.N6.Oka.c++,w.U3b()||H&&!w.Zzb(this.Rr)))return a.Yg(Object(F.a)(this,this.CLc,"coreCopyIncrement")),!0;if(!b.Eqd&&H&&!w.Hy)return f.HEa()&&(b.Jvd=!0,b=new ii.a(a,Object(F.a)(this,this.o1b,"coreCopySetup"),
new sz(b,c)),b.Pl("RecursiveCoreCopyToInternalClipboard"),b.run()),a.Yg(Object(F.a)(this,this.CLc,"coreCopyIncrement")),!0;H=l.currentNode.Oo().Bi;H=ym.a(w,H,!0);this.aba.moc(b.N6.D$a,H);l.xL(H,c,18===f.parentNode.type?1:f.role);l.Pk(H);b.insertAfter=H;zb.ParagraphReader.ae(H)&&(this.wLk(a,Object(F.a)(this,this.o1b,"coreCopySetup"),w,H,b),this.vLk(w,H));this.xTf(w,H);f.HEa()&&(ka.ULS.shipAssertTag(6305562,307,!b.Jvd),b=new ii.a(a,Object(F.a)(this,this.o1b,"coreCopySetup"),new sz(b,null)),b.Pl("RecursiveCoreCopyToInternalClipboard"),
b.run());a.Yg(Object(F.a)(this,this.uCi,"coreCopyIterationPostProcessing"));return!0}uCi(a,b){var c=b.source;const f=b.target;var l=f.currentNode,w=c.currentNode;zb.ParagraphReader.el(f)&&(b.rKe[w.id.toString()]=l);if(R.a.instance.ga(54)&&zb.ParagraphReader.ae(l)){if(0<zb.ParagraphReader.o8f(w))if(0<this.DG.O9a(w).WM)w.setValue(Va.a.Dlc,0);else{var H=this.DG.Uwb(w).WM;Wh.paragraphEditor.Bv.Vjb(l,H)}if(!this.Bab&&this.iqa.Thd){c.zc();if(!hd.TableReader.Cs(f)&&c.Izb&&!this.Mja)for(var U of this.iqa.fDk)l.removeProperty(U);
c.Pk(w)}}if(R.a.instance.ga(57)&&zb.ParagraphReader.ae(l)){H=[];U=[];for(let ja=0;ja<l.wordRunProperties.length;ja++)l.wordRunProperties.IY.$(ja,BI.CharacterPropertiesEditor.sfa),l.wordRunProperties.Ffa.$(ja,BI.CharacterPropertiesEditor.rfa),H[ja]=!0,U[ja]=!1;l.we(Va.a.jed,H);ka.ULS.shipAssertTag(6305563,307,H.length===l.wordRunProperties.length);ka.ULS.shipAssertTag(6305564,307,R.a.instance.ga(50));ka.ULS.shipAssertTag(6305565,307,!!Pc.App.Jh);R.a.instance.ga(50)&&Pc.App.Jh.vw&&(l.we(Qs.a.Kw,U),
ka.ULS.shipAssertTag(6305566,307,U.length===l.wordRunProperties.length));(this.fd.hg&&this.fd.Yy||R.a.instance.ga(45)&&Pc.App.OD.LOb)&&l.setValue(Va.a.w$b,!0);R.a.instance.ga(14)&&l.io(Va.a.F3d,Va.a.VCk,Va.a.XCk);R.a.instance.ga(45)&&zb.ParagraphReader.ae(l)&&l.io(Va.a.rbb)}this.p8g(f)&&(H=f.currentNode.YG(),l=nd.ImageReader.jUc(f.currentNode.properties,H.Bi,!1),H=nd.ImageReader.jUc(f.currentNode.properties,H.Bi,!0),U=null,Eb.EmbeddedFileReader.CZc(f)&&(U=Eb.EmbeddedFileReader.TSc(f.currentNode)),
this.H3d(l,w),this.H3d(H,w),this.H3d(U,w));this.r8g&&(this.wTf(f),hd.TableReader.eq(f)&&(w=this.Ip.zW(),w.moveNext(),(w=Ie.getCellLocation(c,w.current.node))||(w=new tQ.a(0,0)),c=new DI(w,f,hd.TableReader.V6i(c),hd.TableReader.Mij(c)),this.HD.r3k(c)));fe.OutlineElementReader.$g(f)&&!f.QI(2)&&(this.Fi.Hca(f),f.zc());f.zc();b.Bg&&(b.Bg.YJc=b.insertAfter);a.Yg(Object(F.a)(this,this.CLc,"coreCopyIncrement"));return!0}CLc(a,b){b.Jvd&&(b.insertAfter=b.YJc,b.Jvd=!1);if(!b.source.EEa()){b.Bg&&(b.Bg.YJc=b.insertAfter);
const c=b.source;11!==c.vi||c.TTc(-1)||this.QLk(a,c.currentNode,b.target.currentNode,b);return!1}a.Yg(Object(F.a)(this,this.NJf,"coreCopyIteration"));return!0}vLk(a,b){a=oe.f(a);oe.f(b);for(b=0;b<a.length;b++)Object(F.a)(this,this.o1b,"coreCopySetup")}Xzl(a,b){if(b.fsa>=b.tLb.length)return a.Yg(Object(F.a)(this,this.tCi,"copyTeardown")),!0;a=b.tLb[b.fsa];var c=a.node,f=a.Qa,l=a.Lb;if(!nb.SelectionEditor.$t(a))if(!b.fsa&&nb.SelectionEditor.Xl(a))l=f=zb.ParagraphReader.textLength(c);else if(zb.ParagraphReader.tm(a))f=
0,l=zb.ParagraphReader.textLength(c);else if(nb.SelectionEditor.g9(a)){ka.ULS.shipAssertTag(6305568,307,!b.fsa);var w=ob.GraphIterator.nb(c);f=w.rc(12);ka.ULS.shipAssertTag(6305569,307,f);c=w.origin;l=f=zb.ParagraphReader.textLength(c)}else{if(jj.OutlineReader.D$b(a))for(a=xx.a.Vz(a.node);a.moveNext();)w=a.currentNode,zb.ParagraphReader.ae(w)&&Array.add(b.tLb,Id.a.createTextRange(w,0,zb.ParagraphReader.textLength(w)));b.fsa++;return!0}w=b.rKe[c.id.toString()];ka.ULS.shipAssertTag(6305570,307,!!w);
if(!w)return ka.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.fsa,["SelectedContextsLength"]:b.tLb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.fsa++,!0;c=oe.f(w);let H,U=!1;for(H=c.length-1;0<=H;H--)if(!c[H].tJc)if(4===c[H].Wq)c[H].He.blob=null,c[H].He.blob=new yv.a(c[H].He,yv.a.$Mc),b.N6.Oka.e++;else{c[H].He.blob=null;if(R.a.instance.ga(57)&&-1!==c[H].qg){var ja=c[H].He.formatting,wa=void 0,Sa=void 0;ja&&-1===ja.qg?(Sa=c[H].qg+1,wa=
c[H].aaa-1,ja.qg=c[H].qg):(wa=c[H].aaa,Sa=c[H].qg);for(ja=0;ja<wa;ja++)w.wordRunProperties.removeAt(Sa,16);0<wa&&(U=!0)}wa="";du.f(c[H])?(wa=" ",b.N6.Oka.f++):du.g(c[H])&&(Sa=du.b(c[H]))&&(wa=du.a(Sa),b.N6.Oka.g++);Sa=c[H].He.cp;Sa>=f&&Sa<l&&(Wh.characterPropertiesEditor.replaceTextRange(Id.a.createTextRange(w,Sa,Sa+1),wa),l=l-1+wa.length,b.N6.Oka.i++)}U&&w.gv();this.UYk(w);c=zb.ParagraphReader.textLength(w);l<c&&Wh.characterPropertiesEditor.replaceTextRange(Id.a.createTextRange(w,l,c),"");0<f&&Wh.characterPropertiesEditor.replaceTextRange(Id.a.createTextRange(w,
0,f),"");f=0;l=ob.GraphIterator.nb(w);for(l.Bb(6);!l.fr;)c=l.currentNode,l.Fj(6),nd.ImageReader.iH(c)?nd.ImageReader.Zle(c)?(Wh.paragraphEditor.iJf(c,Id.a.Mj(w,f)),f++,b.N6.Oka.d++):(c=ob.GraphIterator.nb(c),c.rc(12),c.Oi(),b.N6.Oka.h++):ka.ULS.shipAssertTag(6305571,307,!1);!zb.ParagraphReader.textLength(w)&&b.fsa===b.tLb.length-1&&nb.SelectionEditor.$t(a)&&(a=ob.GraphIterator.nb(w),a.rc(25)&&(Pa.OutlineElementNavigator.Re(a),this.Fi.gDa(a),b.fsa&&(this.Ip.mb.Mja=!0)));this.aba.c_a(b.N6.Bhd,b.N6.g7a,
b.N6.hQa,w);b.fsa++;return!0}UYk(a){const b=R.a.instance.ga(14),c=!this.fd.hg&&R.a.instance.ga(45),f=Wh.$N,l=a.Ra;if(R.a.instance.ga(57)&&l&&(b||c)){var w=new Ka.a,H=new Ka.a;for(let ja=0;ja<l.length;ja++){const wa=l.ga(ja);if(b){wa.xl&&w.add(wa);if(f){if(wa.Xh){for(var U=0;U<wa.Xh.length;U++)H.add(wa.Xh.ga(U).qg);wa.Xh=null}}else wa.fieldRangeEnd&&(H.add(wa.fieldRangeEnd.qg),wa.fieldRangeEnd=null),wa.Mo&&(H.add(wa.Mo.qg),wa.Mo=null);if(wa.nk){for(U=0;U<wa.nk.length;U++)H.add(wa.nk.ga(U).qg);wa.nk=
null}}if(c){if(Pc.App.OD.LOb){wa.formatting&&Wh.mh.SJ(wa.formatting);if(wa.hyperlink){for(U=0;U<wa.hyperlink.aaa;U++)H.add(wa.hyperlink.qg+U);wa.hyperlink=null}wa.kn=!1}wa.trackedChange=null;wa.bJ=!1}}a.sKa(!0,H);for(let ja of w)ja.xl=null;c&&1<l.length&&(a=l.first,a.trackedChange=new rQ.a(a),l.last.bJ=!0)}}tCi(a,b){this.l2.S1a(null);b.$qj.dispose();fd.a.mark(5567);this.Qpk();this.nN=b.N6;this.grg("Copy");this.dMj&&ka.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get dMj(){return!ob.GraphIterator.nb(this.l2).Ii()}MIl(){this.l2=
this.yrf}LIl(){this.l2=this.ONd}zIl(){this.l2=this.kbf}eGf(){const a=ob.GraphIterator.nb(this.l2);for(;a.Ii();)a.Oi()}grg(a){const b=this.nN.Oka.b;a+="-"+b;this.nN.Oka.b=a;this.nN.D$a.b=a;this.nN.Bhd.b=a;this.nN.g7a.b=a;this.nN.hQa.b=a;this.aba.q4j(this.nN.Oka);this.aba.Xoe(this.nN.D$a);this.aba.Hrg(this.nN.Bhd);this.aba.Roe(this.nN.g7a);this.aba.Qoe(this.nN.hQa);this.nN.Oka.b=b;this.nN.D$a.b=b;this.nN.Bhd.b=b;this.nN.g7a.b=b;this.nN.hQa.b=b}w$g(a,b,c,f,l=null,w=null){this.grg("Paste");b=ob.GraphIterator.nb(b);
const H=ob.GraphIterator.nb(this.l2);var U=null;l&&(U=new Xw.a(jj.OutlineReader.ZMc,jj.OutlineReader.INf),U=l.equals(new Xw.a(-1,-1))?new Xw.a(0,0):l.fV(U));if(this.sYc())if(H.Ii(),nd.ImageReader.iH(H.currentNode))l=H.currentNode,H.zc(),H.xL(this.Fi.OYd(),null,1),H.Ii(),H.xL(l,null,2),H.zc(),H.Pk(l),H.Oi(),this.Cob.Juk(),this.kth();else if(Eb.EmbeddedFileReader.Rab(H.currentNode)){l=H.currentNode;H.zc();H.xL(this.Fi.OYd(),null,1);H.Ii();var ja=this.Fi.Hca(H);ja=Id.a.Mj(ja,0);Wh.characterPropertiesEditor.replaceTextRange(ja,
"<<"+Eb.EmbeddedFileReader.USc(l)+">>");H.zc();H.zc();H.Pk(l);H.Oi();this.kth()}this.YSj&&this.mog(H,b)?(H.currentNode.S1a(null),ka.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.G1k(w,H,b,U,a),ka.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(fd.a.mark(5564),H.currentNode.S1a(null),a={},a[Wh.WCj]=f,rb.ListReader.KUa(c)&&this.Rf.enc&&(a[CI.a.ogg]=!0),c=new tz(H,b,c,U,a),f=new ii.a(w,Object(F.a)(this,this.p1b,"corePasteSetup"),
c),f.Pl("ExecuteCorePasteFromInternalClipboard"),f.Qi=!w||w.Qi,this.mLk(c),f.run())}Ong(a){if(a&&a.isValid){const b=ob.GraphIterator.nb(this.l2);return this.mog(b,a)}return!1}mog(a,b){if(Ie.isTableCellOrInside(b)&&1===a.A9a()){a.Bb(1);if(fe.OutlineElementReader.$g(a)){Pa.OutlineElementNavigator.oi(a);if(hd.TableReader.eq(a)){hd.TableReader.Lu(a.currentNode)&&ka.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.rc(14)&&!hd.TableReader.Lu(Rd.getContainingTable(b)))return ka.ULS.sendTraceTag(19269659,
307,50,"Target table is not a complex table."),!0;ka.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.Bab)return!0}Pa.OutlineElementNavigator.Re(a)}a.zc()}return!1}G1k(a,b,c,f,l){c.rc(14);const w=ok.c(c),H=xn.a(c);c.Jg(14);var U=hd.TableReader.tk(c.currentNode);const ja=hd.TableReader.Ci(c.currentNode),wa=hd.TableReader.tk(b.currentNode),Sa=hd.TableReader.Ci(b.currentNode);ka.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",
U,ja,wa,Sa);this.l3a=Ec.jxb;if(this.WWj(w+wa,H+Sa)){var eb=w+wa-U;0<eb&&(Rd.moveToLastRow(c),ka.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+eb),this.HD.wfe(c,!1,eb,this.l3a),ka.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Jg(14));eb=H+Sa-ja;if(0<eb){ka.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+eb);try{this.HD.Kfg(c,ja,!1,eb,this.l3a)}catch(ub){throw ka.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",ub.toString()),ub;}ka.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}U=this.W5i(U,ja,wa,Sa,w,H);ka.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new ii.a(this.Bab?a:null,Object(F.a)(this,this.gFk,"pasteTableOperationRun"),new vI(null,b,c,f,w,H,U,null,l));a.Pl("ExecuteCorePasteTableInTable");a.Qi=!1;a.run()}}WWj(a,b){if(!this.glg)return!0;const c={};a>Wh.cJc&&(c.rowCount=a,c.c_maxTableRowColCount=Wh.cJc);b>Wh.cJc&&(c.columnCount=b,c.c_maxTableRowColCount=Wh.cJc);const f=a*b;f>Wh.zCf&&(c.rowCount=a,c.columnCount=
b,c.cellsCount=f,c.c_maxTableCellCount=Wh.zCf);0<zq.a(c).length&&ka.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!zq.a(c).length}gFk(a,b){if(b.aOb){if(b.aOb.inProgress)return!0;Ie.isTableCell(b.source)||b.source.Jg(16);this.glg&&Ie.isFirstCellInTable(b.source)&&this.bZb(b.Hf,b.target.currentNode);if(Ie.isLastCellInTable(b.source))return this.Spk(Rd.getContainingTable(b.target)),ka.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;Ie.isTableCell(b.target)||
b.target.Jg(16);const c=!this.Bab;Ie.isLastCellInRow(b.source)?(Rd.moveToNextRow(b.target),Rd.moveToColumnByIndex(b.target,b.ija),ka.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):Rd.moveToNextOrPreviousCell(b.target,!1,c);Rd.moveToNextOrPreviousCell(b.source,!1,c)}else hd.TableReader.eq(b.target)||b.target.Jg(14),hd.TableReader.eq(b.source)||b.source.Jg(14),Rd.moveToCell(b.target,b.rowIndex,b.ija),Rd.moveToCell(b.source,0,0);for(;b.target.Ii();)b.target.Oi();b.aOb=
new ii.a(a,b.B$g?b.B$g:Object(F.a)(this,this.p1b,"corePasteSetup"),new tz(b.source,b.target,null,b.nhd));b.aOb.Pl("ExecuteCorePasteCellContentInCell");b.aOb.Qi=!1;b.aOb.run();return!0}Qpk(){if(this.Bab){for(var a=ob.GraphIterator.nb(this.p2e),b=a.currentNode;14!==a.vi;)if(b=a.Ii(),!b){ka.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.T0g(b)}}Spk(a){this.Bab&&this.T0g(a)}sxl(a){const b=ob.GraphIterator.nb(a);this.Ux.h9b(b,
null,!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}T0g(a){if(a&&14===a.type){ka.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=hd.TableReader.tk(a),f=hd.TableReader.Ci(a),l=ob.GraphIterator.nb(a);Rd.forEachCellInTable(l,(w,H,U)=>{const ja={};w=w.currentNode;if(16===w.type)if(w.isGhostCell)Wh.jIf(H,U)in b||(this.sxl(w),ja.IsGhostCell="->false");else{R.a.instance.ga(77);Wh.pUk(a,w,H,U,c,(Sa,eb,ub)=>{ja.rowSpan=String.format("{0}:{1}->{2}",Sa,eb,ub)});Wh.oUk(a,w,U,
H,f,(Sa,eb,ub)=>{ja.colSpan=String.format("{0}:{1}->{2}",Sa,eb,ub)});const wa=String.format("{0},{1}-{2},{3}",H,U,H+w.rowSpan,U+w.colSpan);for(let Sa=0;Sa<w.rowSpan;Sa++)for(let eb=0;eb<w.colSpan;eb++)if(Sa||eb)b[Wh.jIf(H+Sa,U+eb)]=wa}if(0<zq.a(ja).length){if(void 0===ja.IsGhostCell||null===ja.IsGhostCell){if(void 0===ja.rowSpan||null===ja.rowSpan)ja.rowSpan=w.rowSpan;if(void 0===ja.colSpan||null===ja.colSpan)ja.colSpan=w.colSpan}ka.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",
H,U,ja)}return!0});Wh.xQi(b)}}get glg(){return R.a.instance.ga(77)}get Bab(){return!!this.$a&&this.$a.ka("ComplexTableCellPasteWithFormattingIsEnabled")}bZb(a,b){a?(b=ob.GraphIterator.nb(b),b.aB(1)?(b=b.Bb(2))?(b=Od.SelectionFactory.Sg(b,0),a.Mb.setSelection(b)):ka.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):ka.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):ka.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}W5i(a,
b,c,f,l,w){const H=[];for(let U=0;U<Math.max(l+c,a);U++){let ja=0,wa=w+f;for(U<l?ja=b:U>=l&&U<Math.min(l+c,a)?ja=w:U>=l+c&&U<a?ja=b:wa=Math.max(w+f,b);ja<wa;ja++)Array.add(H,Array(2)),H[H.length-1][0]=U,H[H.length-1][1]=ja}return H}p1b(a,b){if(!b.source.Ii())return a.Yg(Object(F.a)(this,this.uZa,"pasteTeardown")),!0;a.Yg(Object(F.a)(this,this.OJf,"corePasteIteration"));return!0}P1k(a,b){if(this.Bab)if(!b||!a)ka.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});
else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.ykb!==a.ykb&&(b.ykb=a.ykb,c.ShouldRenderCell=b.ykb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",
b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);zq.a(c)}}OJf(a,b){const c=b.source,f=b.target,l=c.currentNode;if(!l.Dle||!l.btb)return a.Yg(Object(F.a)(this,this.DLc,"corePasteIncrement")),!0;if(this.fd.hg&&fe.OutlineElementReader.$g(c)){if(!Pa.OutlineElementNavigator.oi(c).btb)return Pa.OutlineElementNavigator.Re(c),a.Yg(Object(F.a)(this,this.DLc,"corePasteIncrement")),!0;Pa.OutlineElementNavigator.Re(c)}ka.ULS.shipAssertTag(6305608,307,!l.U3b());var w=f.currentNode.Oo().Bi;w=ym.a(l,w,!0);w.Rgb();this.P1k(c,
f);f.xL(w,b.insertAfter,c.role);f.Pk(w);b.insertAfter=w;R.a.instance.ga(50)&&Pc.App.Jh.vw&&Pc.App.Jh.aZ.mra(w);this.xTf(l,w);b=new ii.a(a,Object(F.a)(this,this.p1b,"corePasteSetup"),new tz(c,f,null,b.nhd,b.hL));b.Pl("RecursiveCorePasteOperation");b.run();a.Yg(Object(F.a)(this,this.yCi,"corePasteIterationPostProcessing"));return!0}WLk(a,b,c){b=oe.f(b);c=oe.f(c);for(let f=b.length-1;0<=f;f--)b[f].nHe(c[f],a,Object(F.a)(this,this.p1b,"corePasteSetup"))}H3d(a,b){a&&(ka.ULS.shipAssertTag(6305610,307,a.Sa(qi.a.plc)),
a.Sa(qi.a.plc)||a.setValue(qi.a.plc,a.sa(qi.a.F1g,"")),b=(b=sQ.SectionNavigator.U6f(b))?b.fileId:Pc.App.Kb.Ld.ica?Pc.App.Kb.Ld.ica.fileId:null,!a.Sa(qi.a.fileId)&&b&&a.setValue(qi.a.fileId,b))}I3d(a){a&&this.Cob.ldl()}yCi(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;zb.ParagraphReader.ae(f)&&(this.XLk(a,Object(F.a)(this,this.p1b,"corePasteSetup"),l,f,b),this.WLk(a,l,f));f.p2g();b.hL[CI.a.ogg]&&22===f.type&&f.setValue(Va.a.listID,Number.MAX_VALUE);if(R.a.instance.ga(11)&&zb.ParagraphReader.ae(f)){var w=
oe.j(f,5);if(0<w.length){for(var H of w)!H.properties.Sa(Va.a.Aah)&&H.properties.Sa(Va.a.yah)&&H.properties.setValue(Va.a.Aah,H.properties.eb(Va.a.yah)),nd.ImageReader.Wle(H.properties)||this.Cob.r7k();f.Oo().contentReplicator.forceOutbound(null,null,null)}}R.a.instance.ga(25)&&fe.OutlineElementReader.$g(c)&&this.Fi.Z4e(c.currentNode);R.a.instance.ga(10)&&jj.OutlineReader.H_c(f)&&(w=tq.b(f),b=b.nhd,tq.c(f,w.x+b.x,w.y+b.y));if(this.p8g(c)){b=c.currentNode.YG();w=nd.ImageReader.jUc(c.currentNode.properties,
b.Bi,!1);H=nd.ImageReader.jUc(c.currentNode.properties,b.Bi,!0);let U=null;Eb.EmbeddedFileReader.CZc(c)&&(U=Eb.EmbeddedFileReader.TSc(c.currentNode));this.I3d(w);this.I3d(H);this.I3d(U);if(w||H||U)b.jSj=!0,b.kSj=!0}R.a.instance.ga(24)&&Eb.EmbeddedFileReader.CZc(c)&&(b=c.currentNode,Eb.EmbeddedFileReader.EOj(c)?(c.zc(),w=this.Ux.AGi(),w.setValue(Za.a.gJ,Wh.Jk.isRtl(b)?11:9),H=tq.b(f),tq.c(w,H.x,H.y),c.xL(w,b,1),c.Pk(b),c.NPf(),this.Ux.iW(c,!1)):c.Oi(),w=this.Fi.Hca(c),w=Id.a.Mj(w,0),Wh.characterPropertiesEditor.replaceTextRange(w,
"<<"+Eb.EmbeddedFileReader.USc(b)+">>"));this.wTf(c);this.MHl(l,f);c.zc();a.Yg(Object(F.a)(this,this.DLc,"corePasteIncrement"));return!0}p8g(a){return R.a.instance.ga(1)&&nd.ImageReader.j$b(a)||R.a.instance.ga(24)&&Eb.EmbeddedFileReader.CZc(a)}MHl(a,b){if(this.fd.hg&&hd.TableReader.zbb(a)){let c=0;const f=hd.TableReader.tk(a);for(let l of hd.TableReader.xUc(a,0,f-1))l.duc&&c++;a=this.Bk.oe(4);a.kd(b);b.properties.setValue(Za.a.iza,f-c);a.dispose()}}DLc(a,b){if(!b.source.EEa())return a.Yg(Object(F.a)(this,
this.uZa,"pasteTeardown")),!0;a.Yg(Object(F.a)(this,this.OJf,"corePasteIteration"));return!0}uZa(){fd.a.mark(5565);return!1}wed(){return!ob.GraphIterator.nb(this.l2).Ii()}sYc(){return this.kXd?1===ob.GraphIterator.nb(this.l2).A9a():!1}DIj(){const a=ob.GraphIterator.nb(this.l2);this.sYc()&&a.Ii();return 1===a.A9a()&&(a.Ii(),fe.OutlineElementReader.$g(a)&&1===a.A9a()&&a.Bb(2))?zb.ParagraphReader.el(a)&&!Wh.UH.MIf(a):!1}u6i(){const a=ob.GraphIterator.nb(this.l2);this.sYc()&&a.Ii();a.Ii();a.Ii();ka.ULS.shipAssertTag(6305614,
307,zb.ParagraphReader.el(a));return zb.ParagraphReader.text(a.currentNode)}g1f(a){try{return this.R7i(a)}catch(b){return ka.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",b.message),0}}R7i(a){let b=0;if(a&&(b=this.Q7i(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.g1f(a.childNodes[c]),0===b);c++);return b}Q7i(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.B0h))return b.startsWith(this.RWb)?
this.Rr&&b===this.RWb+this.Rr?3:2:1}return 0}wLk(a,b,c,f,l){l.hL||(l.hL={});Wh.Pa.raiseEvent("OnParagraphCopy",new uz(a,b,c,f,l.hL))}QLk(a,b,c,f){f.hL||(f.hL={});Wh.Pa.raiseEvent("OnCopyComplete",new uz(a,null,b,c,f.hL))}mLk(a){a.hL||(a.hL={});Wh.Pa.raiseEvent("BeforePaste",new uI(a.hL))}XLk(a,b,c,f,l){Wh.Pa.raiseEvent("OnParagraphPaste",new uz(a,b,c,f,l.hL))}wTf(a){Ie.isTableCell(a)&&(a.Bb(1)||this.Ux.iW(a,!0),a.zc())}xTf(a,b){this.uMd.isTableCellNode(b)&&(b.width=a.width)}static get mh(){return Wh.Jf||
(Wh.Jf=Ab.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Wh.gh||(Wh.gh=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Wh.Yw||(Wh.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}static get $N(){const a=Ab.a.instance.rb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get UH(){return am.a.instance}static get Jk(){return Ww.PageReader.instance}static xQi(a){const b={};for(const c of zq.a(a)){const f=
a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=zq.a(b).length&&ka.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static oUk(a,b,c,f,l,w){b.colSpan>l-c&&(w&&w("A",b.colSpan,l-c),b.colSpan=l-c);a=Wh.Fol(a,b,f,c);b.colSpan!==a&&(w&&w("B",b.colSpan,a),b.colSpan=a)}static pUk(a,b,c,f,l,w){b.rowSpan>l-c&&(w&&w("A",b.rowSpan,l-c),b.rowSpan=l-c);a=Wh.Gol(a,b,c,f);b.rowSpan!==a&&(w&&w("B",b.rowSpan,a),b.rowSpan=a)}static Fol(a,b,c,f){return Wh.qxh(a,b.colSpan,(l,w)=>{Rd.moveToCell(l,
c,f+w)})}static Gol(a,b,c,f){return Wh.qxh(a,b.rowSpan,(l,w)=>{Rd.moveToCell(l,c+w,f)})}static qxh(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");for(let l=1;l<b;l++){var f=ob.GraphIterator.nb(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static jIf(a,b){return a+","+b}}Wh.Pa=new vc.a;Wh.Jf=null;Wh.gh=null;Wh.Yw=null;Wh.cJc=50;Wh.zCf=1225;Wh.WCj="PasteConstrainingWidth";Object(n.a)(Wh,"InternalClipboard",
null,[]);class EI extends Fj{constructor(a,b,c,f,l,w){super(a,b,c,l);this.es=f;this.VFd=w}get gjl(){return u.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get qh(){return this.VFd.value}get wed(){return this.es.wed()}get T$g(){const a=this.es;return a.kXd&&!a.sYc()}mUf(a,b){ka.ULS.shipAssertTag(6305616,307,jj.OutlineReader.au(a));const c=tq.b(a.currentNode);if(jj.OutlineReader.isEmpty(a)){var f=Id.a.create(a.currentNode);a.LB(8);u.AFrameworkApplication.Ta.pi(f,D.a.bL,2,!0,null,null)}else a.LB(8);
(f=a.aB(1))&&a.zc();this.es.w$g(this.Bg.Hf,a.currentNode,f,-1,c,b)}get gig(){return this.es.DIj()}get QIf(){return this.es.u6i()}lUf(a){const b=new ob.GraphIterator;this.Thb.restore(b);ka.ULS.shipAssertTag(6305618,307,fe.OutlineElementReader.$g(b));this.Bg.$0&&this.Bg.$0.THc("internal");let c=-1;if(this.Nuh&&Object(Ya.a)(10,this.Bg.rd))c=this.Bg.rd.sa(Qs.a.k3b,-1);else if(this.gjl){const f=this.H8i(b.currentNode);c=f?f.clientWidth:c}this.es.w$g(this.Bg.Hf,b.parentNode,b.currentNode,c,null,a);this.Ukg&&
(this.Thb.restore(b),fe.OutlineElementReader.$g(b)&&this.es.Ong(b)&&(a=Pa.OutlineElementNavigator.oi(b)))&&(this.Bg.Ysa=Od.SelectionFactory.Sg(a,0))}H8i(a){return a?(a=a?a.sc(this.qh.Ma):null)?a.htmlElement:null:null}Bvh(){const a=new ob.GraphIterator;this.Thb.restore(a);return this.es.Ong(a)}get $uh(){return rb.ListReader.qx}get Zuh(){return!this.es.Mja&&!this.es.kXd}}Object(n.a)(EI,"InternalPasteExecutionManager",Fj,[]);class FI{constructor(a,b){this.es=a;this.VFd=b}create(a,b,c){return new EI(a,
b,c,this.es,Pc.App.Kb.Ld,this.VFd)}}Object(n.a)(FI,"Factory",null,[1005]);var vz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(vz||(vz={}));Object(n.b)("CopySource",vz);class Zr{constructor(a,b,c){this.es=a;this.Ref=b;this.eSh=c}OEk(a,b,c){ka.ULS.shipAssertTag(6305620,307,!!a);ka.ULS.shipAssertTag(6305621,307,nb.SelectionEditor.Tg(b));ka.ULS.shipAssertTag(6305622,
307,!!c);ka.ULS.shipAssertTag(6305623,307,Object(Ya.a)($o,c.J5));const f=c.J5;f.RQa=this.es.g1f(a);this.p4j(a,f);const l=this.Pke(a,b,f);if(l||this.eYe(a,b,f)){var w=new qf.GraphTransaction(7);w.kd(b.node);b.node.YG().graphTransactionOperations.Ria(8);l?(ka.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.ks,f.browserName),a=this.Ref.create(b,f,w)):(ka.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.ks,f.RQa,f.browserName),Zr.i4j(a),
a=this.eSh.create(a,b,f,w));c=new ii.a(c,Object(F.a)(a,a.E$g,"pasteSetup"),null);c.Pl("Paste");c.run()}else f.Ysa=Od.SelectionFactory.Fu(b)}Pke(a,b,c){return!this.Plg(c)&&3===c.RQa}eYe(){return!0}Plg(a){return 1===(a.ks&8192?1:0)}qgg(a,b){ka.ULS.shipAssertTag(6305624,307,nb.SelectionEditor.Tg(a));ka.ULS.shipAssertTag(6305625,307,!!b);ka.ULS.shipAssertTag(6305626,307,Object(Ya.a)($o,b.J5));const c=new qf.GraphTransaction(7);c.kd(a.node);a=this.Ref.create(a,b.J5,c);b=new ii.a(b,Object(F.a)(a,a.E$g,
"pasteSetup"),null);b.Pl("InternalPasteAtIp");b.run()}p4j(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||f)u.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),ka.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",vz[b.RQa],c,f)}}static i4j(a){a&&Zr.y4h.test(a.innerText)&&
ka.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Zr.y4h=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(n.a)(Zr,"PasteCoordinator",null,[]);class AC{constructor(a,b){this.jk=a;this.b7=b}}Object(n.a)(AC,"PasteFloatieFeatureSetBuilder",null,[]);class ao{constructor(a,b){this.ORb=a;this.FPh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get PYf(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get RMc(){return CommonUIStrings.l_ClipboardCut}get aEe(){return CommonUIStrings.l_ClipboardCut_Mac}get BLc(){return CommonUIStrings.l_ClipboardCopy}get $De(){return CommonUIStrings.l_ClipboardCopy_Mac}get EJa(){return CommonUIStrings.l_ClipboardPaste}get bEe(){return CommonUIStrings.l_ClipboardPaste_Mac}get O5(){return CommonUIStrings.l_ClipboardPasteText}get cEe(){return CommonUIStrings.l_ClipboardPasteText_Mac}get cWd(){return this.FPh}get GGf(){return CommonUIStrings.l_ClipboardExtensionLink}get DQa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}PUf(){ka.ULS.sendTraceTag(8716421,
307,50,null);Kd.a.vn(this.cWd,"_blank",void 0,"ClipboardAccessExtensionLink")}q1(a,b){let c=B.a.wk;u.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=B.a.Pi||c);return c?String.format(b,"\u2318"):a}dispose(){this.ORb=null}VPe(a){this.HJf(a)}h0j(a){this.HJf(a)}HJf(a){this.ORb&&this.ORb(a)}}ao.id="CopyPasteShortcutDialog";ao.rCh="CopyPasteText";Object(n.a)(ao,"ACopyPasteShortcutDialog",null,[106]);class GI extends ao{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=ao.rCh;var f=document.createElement("span");f.innerText=this.PYf;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.q1(this.RMc,this.aEe);const w=document.createElement("span");w.className="UIFontBold";w.innerText=this.q1(this.BLc,this.$De);const H=document.createElement("span");H.className="UIFontBold";H.innerText=this.q1(this.EJa,this.bEe);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(w);b.appendChild(H);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(B.a.Vj||B.a.fg)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.q1(this.O5,this.cEe),b.appendChild(c));a.appendChild(b);this.cWd?(ka.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.GGf,Yc.a.addHandler(b,"click",Object(F.a)(this,this.PUf,"extensionLinkHandler")),c.appendChild(b),l=this.DQa.indexOf("{0}"),
-1!==l&&(f=this.DQa.substring(l+3,this.DQa.length),l=document.createTextNode(this.DQa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):ka.ULS.sendTraceTag(8716422,307,50,null);c=new Bi.StandardDialog;c.yd=0;c.ig=ao.id;c.Gx(this.titleText,null,0,Object(F.a)(this,this.h0j,"legacyCopyPasteShortcutDialogHandler"),a);c.f6(ao.rCh)}}Object(n.a)(GI,"CopyPasteShortcutDialog",ao,[]);class HI extends ao{constructor(a,
b){super(a,b);b={};a=this.zIj;b.extensionStartText=this.GVi;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.iil;b.cutText=this.q1(this.RMc,this.aEe);b.copyText=this.q1(this.BLc,this.$De);b.pasteText=this.q1(this.EJa,this.bEe);4!==u.AFrameworkApplication.Aa.hb.Uk&&(b.pasteTextOnly=this.q1(this.O5,this.cEe));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new ci.a(!1,!1,!0);c.ig="CopyPasteInstallDialog";c.yd=0;c.Xe(1,this.yIj);c.wya(1);c.aj(a,Object(F.a)(this,
this.VPe,"reactCopyPasteShortcutDialogHandler"),b)}get iil(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get yIj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get zIj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get GVi(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(n.a)(HI,"ReactCopyPasteInstallDialog",ao,[]);class II extends ao{constructor(a){super(a,null);this.bqg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.Dpk;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.mKi;b.copyText=this.jCi;b.pasteText=this.XEk;b.cutShortcutText=this.q1(this.nKi,this.Ekk);b.copyShortcutText=this.q1(this.rCi,this.Dkk);b.pasteShortcutText=this.q1(this.cFk,this.Gkk);b.imageSrc=vp.a.ZK("NoClipboardAccessDialogImage.svg");b.imageAltText=this.OEa;b.primaryButtonLabel=this.XIb;this.bqg&&(ka.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.uVa,["onExecute"]:()=>{this.e0j()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new ci.a(!1,!1,!0);c.yd=0;c.ig="CopyPasteNoClipboardAccessDialog";c.aj(a,Object(F.a)(this,this.VPe,"reactCopyPasteShortcutDialogHandler"),b)}get Dpk(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get uVa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get OEa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get XIb(){return CommonUIStrings.l_DialogOk}get mKi(){return CommonUIStrings.l_CutString}get nKi(){return CommonUIStrings.l_CutShortcut}get Ekk(){return CommonUIStrings.l_CutShortcut_Mac}get jCi(){return CommonUIStrings.l_CopyString}get rCi(){return CommonUIStrings.l_CopyShortcut}get Dkk(){return CommonUIStrings.l_CopyShortcut_Mac}get XEk(){return CommonUIStrings.l_PasteString}get cFk(){return CommonUIStrings.l_PasteShortcut}get Gkk(){return CommonUIStrings.l_PasteShortcut_Mac}e0j(){ka.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Kd.a.vn(this.bqg,"_blank",void 0,"learnMoreLink")}}Object(n.a)(II,"ReactCopyPasteNoClipboardAccessDialog",ao,[]);class JI extends ao{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.PYf;a.cutText=this.q1(this.RMc,this.aEe);a.copyText=this.q1(this.BLc,this.$De);a.pasteText=this.q1(this.EJa,this.bEe);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(B.a.Vj||B.a.fg)&&(a.pasteTextOnly=this.q1(this.O5,this.cEe));this.cWd?(ka.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.GGf,["onExecute"]:f=>{this.PUf(f)}},c=this.DQa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.DQa.substring(0,c),a.suggestionSuffixElement=this.DQa.substring(c+3,this.DQa.length))):ka.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:ao.id,["bodyControls"]:a};a=new ci.a(!1,!1,!0);a.yd=0;a.ig=ao.id;a.aj(this.titleText,Object(F.a)(this,this.VPe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(n.a)(JI,"ReactCopyPasteShortcutDialog",
ao,[]);class Aq{constructor(){this.nqa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.IC}fub(a,b,c=!1,f=!1){ka.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.nqa,c));f?new II(a):this.nqa?c?new HI(a,b):new JI(a,b,u.AFrameworkApplication.fa):new GI(a,b,u.AFrameworkApplication.fa)}static get instance(){return Aq.Ka||(Aq.Ka=new Aq)}}Aq.Ka=null;Object(n.a)(Aq,"CopyPasteShortcutDialogFactory",null,[1074]);class KI{constructor(a,b,c,f,
l,w,H){this.Off=this.WLd=!1;this.vXb=a;this.Kf=b;this.qia=c;this.Od=f;this.od=l;this.tf=w;this.zd=H}get NM(){return this.vXb}get rFa(){return this.Off}set rFa(a){this.Off=a;this.tf.bXc=a}Wca(a){this.NM.Wca(a);a||this.QLa(!0)}f7a(a){this.NM.f7a(a)}get HTi(){return this.NM.a6}get nTi(){return this.NM.ly}prepareForPaste(a){this.rFa=!0;this.NM.prepareForPaste(a,!1,this.z1e)}ida(a,b){this.NM.ida(a,!1,b)}reset(){this.rFa=!1}paste(){var a=this.Kf.Qd;a&&this.Od.rf(a.FI);var b=this.qia.PK;if(!b.Nh||!b.editingView.Wl)return null;
a=b.editingView;let c=this.od.om();this.rFa=!0;b.Kza();b=null;try{a.iKk(),b=c=this.NM.C8a(this.z1e,c)}catch(f){ka.ULS.shipAssertTag(6305672,307,!1),this.A7b(!0)}this.rFa=!1;return b}copy(){var a=this.Kf.Qd;a&&this.Od.rf(a.FI);a=this.qia.PK;if(!a.Nh||1!==a.editingView.mode)return!1;this.rFa=!0;let b;try{this.NM.xPc(this.z1e),b=!0}catch(c){ka.ULS.shipAssertTag(6305673,307,B.a.fg),ka.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",B.a.Wy),b=!1}this.rFa=
!1;return b?!0:!1}QLa(a){if(this.WLd)return!0;var b=this.qia.PK;if(!b.Nh||!b.editingView.Wl)return!1;const c=b.editingView;b=this.od.om();this.rFa=!0;const f=new Dg.a(b);let l=!1;try{l=this.NM.QLa(b,()=>{c.Nui()},()=>{c.NKa()})}catch(w){ka.ULS.shipAssertTag(6305674,307,!B.a.Gj)}f.restore();this.rFa=!1;l?this.WLd=!0:(ka.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",B.a.Wy),B.a.Gj||this.A7b(a));return l}A7b(){this.WLd=!1;if(u.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)Aq.instance.fub(null,
null);else{const a=new Bi.StandardDialog;a.yd=0;a.fP(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get z1e(){const a=this.od.cEa();return a?a.Tl:null}}Object(n.a)(KI,"SystemClipboard",null,[992]);class BC{constructor(a){this.Amb=2147483647;this.eRb=null;this.Pm=0;this.gEg=!0;this.Njf=window.navigator.clipboard;this.Ojf=window.navigator.permissions;this.vS=a}getData(a,b){ka.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.eRb){var c=this.v6i(this.eRb,
a);c?this.eRb[0].getType(c).then(f=>{"image/png"===c?this.vS.g1b([f],l=>{this.uIe(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.p_i(l):l;ka.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.qX(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.qX(!1,"getDataFailed");b(a,null)}):(this.qX(!1,"unSupportedType"),b(a,null))}else this.qX(!1,"invalidClipboardItems"),b(a,null)}catch(f){this.qX(!1,"getDataFailed"),b(a,null)}}v6i(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}uIe(a,b,c){a&&this.vS.xrc&&(a=String.format('<img src="{0}">',a));ka.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}p_i(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}c4e(a,b,c){this.eRb=b;a(c)}rud(a){try{this.eRb=null,this.Njf.read().then(b=>{let c;this.Pm&&(c=Date.now()-this.Pm,ka.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.qX(!0,"none");this.c4e(a,b,!0)},()=>{this.qX(!1,"clipboardReadFailed");this.c4e(a,null,!1)}).catch(()=>{this.qX(!1,"clipboardReadFailed");this.c4e(a,null,!1)})}catch(b){this.qX(!1,"clipboardReadNotSupported"),a(!1)}}pFf(a,
b){this.gEg=a?!0:!1;if(this.Njf)if(this.Ojf)try{this.Ojf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.Pm=Date.now(),this.rud(b)):"prompt"===c&&a?this.rud(b):(this.qX(!1,"permissionDenied"),b(!1))):(this.qX(!1,"invalidPermissionStatus"),b(!1))},()=>{this.qX(!1,"permissionQueryFailed");a?this.rud(b):b(!1)}).catch(()=>{this.qX(!1,"permissionQueryFailed");b(!1)})}catch(c){this.qX(!1,"permissionQueryNotSupported"),b(!1)}else this.qX(!1,"navigatorPermissionNotSupported"),a&&
this.rud(b);else this.qX(!1,"navigatorClipboardNotSupported"),b(!1)}qX(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.gEg;"none"!==b&&(c.AsyncAPIFailureReason=b);ka.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(n.a)(BC,"AsyncClipboardAPI",null,[]);class wz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(n.a)(wz,"ExtensionClipboardData",null,[]);class LI{constructor(a,b,c,f){this.C2=
this.Rz=this.Nhf=this.Qpa=null;this.Ywc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.rTh=a.Ga("ChromeClipboardAccessExtensionLink");this.wNa=b;this.jk=c;this.lYh=a.Ga("ChromeClipboardAccessExtensionId");this.vS=f;this.f2=new BC(this.vS);this.tSb=null;this.Kbf=a.ka("EnhancedTextCCPEnabled");this.cff=l=>!!l.tagName&&"a"===l.tagName.toLowerCase()}Wca(a){a?this.Rz=!0:(this.C2=
this.Rz=null,chrome.runtime&&chrome.runtime.sendMessage?(this.tSb=this.wNa.XSc(),this.wNa.Gya?this.eFf(!0,null):(this.Rz=!0,ka.ULS.sendTraceTag(19256732,307,50,ia.a.create().toString()))):this.f2?this.vtb(!0,null):(this.HLe(),this.Rz=!1))}f7a(a){this.C2=this.Rz=null;chrome.runtime&&chrome.runtime.sendMessage?(this.tSb=this.wNa.XSc(),this.wNa.Gya?this.eFf(!1,a):(this.Rz=!0,ka.ULS.sendTraceTag(19256732,307,50,ia.a.create().toString()),a(this.a6))):this.f2?this.vtb(!1,a):(this.Rz=!1,a(this.a6))}get a6(){return this.Rz}get ly(){return this.C2}QLa(){return!0}xPc(a){ka.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");Kd.a.B8a(a,"copy")||ka.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}C8a(a,b){this.Qpa&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Qpa,b=a.body,this.Qpa=null);return b}K8i(a){var b=this.jk.N6f(a.html);if(null!=b&&""!=b)return b;b=a.img;if(null!=b&&""!=b)return b;a=a.text;if(null!=a&&""!=a)return a}x1f(a,b){const c=ia.a.create();this.Nhf=c;this.wNa.Gya?
ka.ULS.sendTraceTag(7377737,307,50,c.toString()):ka.ULS.sendTraceTag(19256735,307,50,c.toString());const f={};f.command=b;chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.tSb,f,l=>{c.equals(this.Nhf)?this.Qpa=this.Kbf?this.K8i(l):l:ka.ULS.sendTraceTag(7385868,307,50,null);ka.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.tQi(),this.wNa.Gya?ka.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):ka.ULS.sendTraceTag(19256737,307,
10,chrome.runtime.lastError.message));a(l)}):(ka.ULS.sendTraceTag(509666774,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=()=>{a(!1)},f=(l,w)=>{this.Qpa=w;a(!0)};null!=this.ly&&this.ly?this.f2.getData(b?"image/png":null,f):this.x1f(c,this.Kbf?"getClipboardData":"paste")}ida(a,b,c){a=(f,l)=>{const w=new wz;"image/png"==f?w.img=l:w.html=l;c(w)};null!=this.ly&&this.ly?this.f2.getData(b?"image/png":null,a):this.x1f(c,"getClipboardData")}HLe(){ka.ULS.sendTraceTag(8716423,
307,50,null);Aq.instance.fub(Object(F.a)(this,this.PHk,"popupInstallDialogHandler"),this.Ywc?this.rTh+this.tSb:null)}PHk(a){1===a?ka.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Ywc)):0===a&&ka.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.Ywc))}MHk(){ka.ULS.sendTraceTag(509666773,307,50,null);Aq.instance.fub(Object(F.a)(this,this.NHk,"popupClipboardAccessDialogHandler"),null,!1,!0)}NHk(){ka.ULS.sendTraceTag(509666772,307,50,String.format("ClipboardAccessDialog OK Clicked",
this.Ywc))}tQi(){this.wNa.RSe();this.HLe()}Tph(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(ka.ULS.sendTraceTag(509666771,307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}vtb(a,b){ka.ULS.sendTraceTag(509666770,307,50,"CheckAsyncClipboardApiSupport");this.f2.pFf(a,c=>{this.C2=c;this.Rz=this.ly;a&&this.lml();b&&b(this.a6)})}lml(){null==this.ly||this.ly||this.MHk()}eFf(a,b){const c=ia.a.create();ka.ULS.sendTraceTag(7726105,
307,50,c.toString());this.Tph(this.tSb,f=>{ka.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.Rz=!0:(f?"ping"!==f&&ka.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):ka.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.f2?this.vtb(a,b):(a&&this.HLe(),this.Rz=!1));b&&b(this.a6)})}wrg(a,
b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;ka.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}E3j(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.wNa.Gya;this.Tph(this.lYh,b=>{this.wrg(a,!!b)})}else this.wrg(!1,!1)}}Object(n.a)(LI,"ChromeSystemClipboardAccessManager",null,[991]);class MI{constructor(a,b,c,f){this.C2=this.Rz=this.cFc=this.Qpa=this.f2=null;this.zd=a;this.$a=b;this.Z8e=!this.$a.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.$a.ka("BlockCopyCutOnFirefoxIsEnabled");this.vS=c;this.jk=f;this.AGd=b.Bc("ClipboardDataImageBlobLimitaton",10);B.a.M0e||(this.f2=new BC(this.vS))}Wca(a){this.Z8e&&a&&this.zd.fg?(Aq.instance.fub(null,null),this.Rz=!1):(this.Rz=!0,this.C2=!1,this.f2&&(this.C2=this.Rz=null,this.vtb(!0,null)))}f7a(a){this.Z8e&&this.zd.fg&&(this.Rz=!1,a(this.a6));this.Rz=!0;this.C2=!1;this.f2?(this.C2=this.Rz=null,this.vtb(!1,a)):a(this.a6)}vtb(a,b){ka.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");
this.f2.pFf(a,c=>{this.C2=c;this.Rz=this.ly;a&&this.Ill();b&&b(this.a6)})}Ill(){null==this.ly||this.ly||this.LHk()}LHk(){Aq.instance.fub(null,null)}get a6(){return this.Rz}get ly(){return this.C2}xPc(a){Kd.a.B8a(a,"copy")}C8a(a,b){if(this.Qpa&&null!=this.ly&&this.ly)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Qpa,b=a.body,this.Qpa=null,b;const c=Date.now(),f=Kd.a.B8a(a,"paste");b&&""===b.innerHTML&&(this.r6i(a),b.innerHTML=this.cFc?this.cFc:"",this.cFc="");ka.ULS.sendTraceTag(512356673,
307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,f);return b}r6i(a){const b=c=>{if(c){c=c.clipboardData;const f=this.jk.R5b(c);this.cFc=f&&""!==f?f:this.jk.M9d(c)}};window.addEventListener("paste",b,!1);Kd.a.B8a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(f,l)=>{this.Qpa=l;a(!0)};null!=this.ly&&this.ly?this.f2.getData(b?"image/png":null,c):a(!1)}ida(a,b,c){if(c){var f=(l,w)=>{const H=new wz;"image/png"==l?H.img=w:H.html=w;c(H)};null!=this.ly&&
this.ly?this.f2.getData(null,f):B.a.M0e&&this.s6i(a,b,c)}else ka.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}s6i(a,b,c){ka.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;za.a.Cu(a.body);try{const f=l=>{const w=new wz;l=l.clipboardData;if(b){var H=null;({L8b:H}=this.jk.kud(l,this.AGd,this.vS.ajc));H&&0<H.length&&(w.isImageAvailable=!0)}else H=this.jk.getData(l,"ppt/slides"),w.pptSlide=H,H&&""!==H||(l=(H=this.jk.R5b(l))&&
""!==H?H:this.jk.M9d(l),w.html=l);c(w)};a.addEventListener("paste",f,!1);Kd.a.B8a(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){ka.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",f)}}QLa(a,b,c){if(this.zd.zT&&!this.$a.ka("ElectronClipboardAccessFix"))return this.Rz=!1;b();c();a=this.C8a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=gh.a.create().toString();c();a=this.C8a(a.ownerDocument,a);a=b===a.innerHTML;
this.f2?a&&(this.Rz=!0):this.Rz=a;return a}}Object(n.a)(MI,"DefaultSystemClipboardAccessManager",null,[991]);class NI{constructor(a,b,c,f){this.C2=this.Rz=this.LV=this.Epb=this.y7=this.SAa=this.axc=null;this.jk=b;this.vS=c;this.AGd=a.Bc("ClipboardDataImageBlobLimitaton",10);this.PUh=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.ARh=f;this.g1h=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}Wca(a){this.g1h&&a&&(this.Rz=!0);this.C2=!1}f7a(a){a(!0)}get a6(){return this.Rz}get ly(){return this.C2}xPc(a){a&&
Kd.a.B8a(a,sa.a.copy)}C8a(a,b){this.SAa&&(b=this.SAa,this.SAa=null);return b}ida(a,b,c){c?c(null):ka.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c=null){if(a&&c){this.axc=a;this.Epb=c;$addHandler(this.Epb,sa.a.paste,Object(F.a)(this,this.U5g,"onPasteEvent"));this.LV=this.y7=null;this.PUh&&this.ARh.N3b();if(this.sud(this.Epb)){if(this.LV&&0<this.LV.length&&(!this.y7||this.jk.Kvd(this.y7))){this.vS.g1b(this.LV,Object(F.a)(this,this.uIe,"onImageConverted"));
this.SAa&&!this.SAa.hasChildNodes()&&ka.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.y7&&this.y7.innerHTML&&((this.SAa=this.zdg(this.y7.innerHTML))&&!this.SAa.hasChildNodes()&&ka.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),za.a.Cu(this.y7))}this.gXf()}else a&&a(!1)}QLa(a){return this.Rz=a=this.sud(a.ownerDocument)}U5g(a){try{a&&a.rawEvent&&((this.y7=a.rawEvent.target)&&this.y7.id&&-1<this.y7.id.indexOf("Paste")?(ka.ULS.sendTraceTag(40690080,
307,15,"The pasted target element of paste event: "+this.y7.id),this.y7=null):this.LV=this.ubj(a.rawEvent))}catch(b){ka.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}uIe(a){a&&(this.vS.xrc&&(a=String.format('<img src="{0}">',a)),this.SAa=this.zdg(a));this.gXf()}gXf(){this.Epb&&($removeHandler(this.Epb,sa.a.paste,Object(F.a)(this,this.U5g,"onPasteEvent")),this.Epb=null);this.axc&&(this.axc(!1),this.axc=null)}ubj(a){let b=null;(a=this.jk.E6d(a))&&
({L8b:b}=this.jk.kud(a,this.AGd,this.vS.ajc));return b}sud(a){return Kd.a.B8a(a,sa.a.paste)}zdg(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(n.a)(NI,"EdgeSystemClipboardAccessManager",null,[991]);class OI{constructor(a,b,c,f){this.$a=a;this.CPh=b;this.jk=c;this.zd=f}create(){var a=null;a=this.zd.zT&&this.$a.ka("ElectronClipboardAccessFix"),u.AFrameworkApplication.Vqd()&&this.zd.Vj&&window.chrome&&!a?(ka.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),
a=new LI(this.$a,this.CPh,this.jk,Ab.a.instance.resolve("Box4.IProcessImageStrategy")),this.$a.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.E3j()):this.$a.ka("EdgeContextMenuPasteFixIsEnabled")&&this.zd.vo?(ka.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new NI(this.$a,Ab.a.instance.resolve("Box4.IClipboardDataHelper"),Ab.a.instance.resolve("Box4.IProcessImageStrategy"),Ab.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(ka.ULS.sendTraceTag(7377744,
307,50,"DefaultSystemClipboardAccessManager"),a=new MI(this.zd,this.$a,Ab.a.instance.resolve("Box4.IProcessImageStrategy"),this.jk));return a}}Object(n.a)(OI,"SystemClipboardAccessManagerFactory",null,[990]);class PI{ZTf(a){return a}}Object(n.a)(PI,"DeleteTableSegmentStrategy",null,[994]);var vQ=d(1215),wQ=d(640);class Bq{constructor(a,b){this.Yk=new K.DictionaryPropertySet;this.fEd=!1;this.mia=this.Zha=this.F2a=null;this.JV=a;this.KSh=b}get g1a(){return this.mia||(this.mia=Ab.a.instance.rb("Box4.ITextFormattingCommands"))}get mh(){return Bq.Jf||
(Bq.Jf=Ab.a.instance.resolve("Box4.IFormattingEditor"))}w_a(){this.fEd||(this.Yk.cRe(),this.F2a=null,this.CYk())}qCi(a){a=Kb.a.xs(a);if(!a.cache.it){var b=a.Yz;if(b){var c=new K.DictionaryPropertySet;c.ay(b);c.ay(this.Yk);c.Sa(eh.a.a3)&&(this.F2a=a.paragraph.Gh);this.Yk=c}}}Sa(a){return this.Yk.Sa(a)}Ice(){return 0<this.Yk.j2}get xab(){return this.Yk}freeze(){this.fEd=!0}o2e(){this.fEd=!1}LI(a,b){return this.xab.sa(a,b)}Pq(a){this.Yk.setValue(Za.a.fontSize,this.mh.W0b(a));this.LR()}fontSize(){return this.Yk.sa(Za.a.fontSize,
We.Font.yI)}npd(a){this.Yk.setValue(Za.a.font,a);this.KSh.npd(this.Yk,a);this.JV&&this.JV.enabled&&(Ue.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.JV.UPl(this.Yk,a));this.LR()}jLa(a){this.Yk.setValue(Va.a.mV,a);this.JV&&this.JV.enabled&&(Ue.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.JV.YPl(this.Yk,a));this.LR()}Sr(a){a=wQ.a.instance.uWd(de.a.instance.Na.mb.Ua.node,a);this.Yk.setValue(Za.a.fontColor,a);this.LR()}sW(){this.Yk.setValue(Za.a.fontColor,
tc.a.auto);this.LR()}fontColor(){return this.Yk.sa(Za.a.fontColor,tc.a.nil)}Joa(a){this.Yk.setValue(Za.a.highlight,parseInt(a,16));this.LR()}i0b(){this.Yk.setValue(Za.a.highlight,tc.a.auto);this.LR()}isBold(){return this.Yk.sa(Za.a.bold,!1)}OH(a){this.Yk.setValue(Za.a.bold,a);this.LR()}isItalic(){return this.Yk.sa(Za.a.italic,!1)}setItalic(a){this.Yk.setValue(Za.a.italic,a);this.LR()}hE(){return this.Yk.sa(Za.a.underline,!1)}PY(a){this.Yk.setValue(Za.a.underline,a);this.Yk.setValue(Za.a.Rw,a?We.Font.Mud:
We.Font.tV);this.LR()}Rw(){return this.Yk.sa(Za.a.Rw,We.Font.tV)}Qoa(a){a<We.Font.Mud||a>We.Font.tV||(this.Yk.setValue(Za.a.underline,a!==We.Font.tV),this.Yk.setValue(Za.a.Rw,a),this.LR())}isSuperscript(){return this.Yk.sa(Za.a.superscript,!1)}OY(a){this.Yk.setValue(Za.a.superscript,a);a&&this.isSuperscript()&&this.Yk.setValue(Za.a.subscript,!1);this.LR()}QF(){return this.Yk.sa(Za.a.subscript,!1)}h6(a){this.Yk.setValue(Za.a.subscript,a);a&&this.QF()&&this.Yk.setValue(Za.a.superscript,!1);this.LR()}PF(){return this.Yk.sa(Za.a.strikethrough,
!1)}MY(a){this.Yk.setValue(Za.a.strikethrough,a);this.LR()}D_(){return this.Yk.sa(eh.a.Zs,!1)}Tjb(a){this.Yk.setValue(eh.a.Zs,a);this.LR()}t0f(){return this.Yk.sa(eh.a.a3,null)}hga(a,b){this.Yk.cRe();this.Yk.setValue(eh.a.a3,a.id);this.F2a=b.Gh;this.LR()}$U(a){let b=Za.a.kt;if(R.a.instance.ga(13)){const c=vQ.a.lbc(a);switch(c){case 1:b=Va.a.PAb;break;case 2:b=Va.a.QAb}this.Yk.setValue(Va.a.languageHint,c)}this.Yk.setValue(b,a);this.LR()}language(){let a=Za.a.kt;if(R.a.instance.ga(13))switch(this.Yk.sa(Va.a.languageHint,
0)){case 1:a=Va.a.PAb;break;case 2:a=Va.a.QAb}return this.Yk.sa(a,0)}odl(a){this.Yk.setValue(Bq.dGe,a);this.LR()}SUa(){return this.Yk.sa(Bq.dGe,!1)}TRj(){return this.Yk.Sa(Bq.dGe)}HQj(){return R.a.instance.ga(13)?this.Yk.Sa(Za.a.kt)||this.Yk.Sa(Va.a.PAb)||this.Yk.Sa(Va.a.QAb):this.Yk.Sa(Za.a.kt)}LR(){if(B.a.SNb){var a=de.a.instance.Na.mb.Ua,b=a.node;if(b===this.Zha)this.Zha.Cv(16,!0);else{this.Zha=b;b=this.Zha.Z0a();try{this.Zha.svb(a.Qa).i4=!0}finally{b&&b.dispose()}}}}CYk(){if(B.a.SNb&&this.Zha){var a=
0,b=this.Zha.Z0a();try{for(let c=this.Zha.Ra.length-1;0<=c;c--){const f=this.Zha.Ra.ga(c);f.i4&&(f.i4=!1,a++,f.isEmpty&&this.Zha.Ra.removeAt(c))}}finally{b&&b.dispose()}this.Zha=null}}ZAi(a){if(a.Qa!==a.Lb)return!1;a=a.node.Ra.iT(a.Qa);return!!a&&a.i4}Efi(a){if(this.g1a){this.freeze();var b=new qf.GraphTransaction(7);b.kd(a.node);this.g1a.WLb(a);this.o2e();this.w_a();b.dispose()}}y6b(a){const b=zb.ParagraphReader.text(a.node);return a.Qa&&a.Qa!==b.length&&!ha.a.iz(b.charCodeAt(a.Qa))&&tr.a.instance.hTc(b,
a.Qa-1)!==a.Qa&&nb.SelectionEditor.qAb(a)?(a=nb.SelectionEditor.XRa(a,!1))?1<a.length||nb.SelectionEditor.ik(a.Ua)?a:null:null:null}static get dGe(){return R.a.instance.ga(20)?Va.a.noProof:Yd.a.Twa}}Bq.Jf=null;Object(n.a)(Bq,"InsertionPointFormatting",null,[1039]);class QI{constructor(a){this.Ca=a}get An(){return this.Ca}Rmi(a){return 32===this.An.La(D.a.QM,2,a)}numbering(a){return 32===this.An.La(D.a.mP,2,a)}}Object(n.a)(QI,"ListCommands",null,[1006]);class CC{constructor(a){this.jf=a}e7a(a){a=Object(qa.a)(rC.a,
a);return!!a&&!!a.view&&a.view.Nh}bdh(){return!0}kNe(){return!0}cdh(){}Byh(a){if(a.fr)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}qhj(a){if(!a||!this.jf)return a;const b=new nn.a;b.set(a);if(this.jf.Gt(b)){for(;!b.fr;)b.zc();return b.currentNode}return a}}Object(n.a)(CC,"SimpleProofingWholeDocumentCallBacks",null,[1070]);class RI{constructor(a){this.value=a}}Object(n.a)(RI,"RefBool",null,[]);class xz{constructor(){this.rPc=this.RGb=null;this.kGh=new RI(!1)}}Object(n.a)(xz,"FindNextErrorOperationParam",
null,[]);class SI extends CC{constructor(a,b){super(b);this.Fm=a}bdh(a,b){return!this.Koe(a.node,a.Qa,b)}kNe(a,b){return!this.Koe(a,0,b)}cdh(a,b){this.Koe(a.node,0,b);Object(qa.a)(xz,b)}Koe(a,b,c){c=Object(qa.a)(xz,c);if(zb.ParagraphReader.ae(a)&&!a.YW)if(Kb.a.xs(Id.a.Mj(a,b)).cache.SUa)c.kGh.value=!0;else{const f=u.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),l=this.Fm.GF(a);for(let w=0;w<l.length;w++){const H=l[w],U=f&&H.Hh.Hke();if(H.begin>=b&&!U)return c.RGb=H,c.rPc=a,!0}}return!1}}
Object(n.a)(SI,"FindNextErrorCallbackSteps",CC,[]);class TI extends Ps.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){super();this.Lpb=this.Mi=this.hAa=null;this.init(a);this.Pl(Sa);this.QEa(U,b,f,l,w);this.uV=w;this.vu=c;this.Tc=ja;this.jf=wa;this.Dqa=H;this.lI=0}run(){this.e7a();0===this.lI&&this.BXe();1===this.lI&&this.uNe();2===this.lI&&this.E1e();3===this.lI&&this.s4d()}e7a(){this.Tc.Na&&this.Tc.Na.mb?1===this.behavior&&(this.Dqa.e7a(this.vu)?this.Gp=32:this.Gp=2,this.lI=3):(ka.ULS.sendTraceTag(20321351,
324,15,"No selection for ignore all"),this.Gp=2,this.lI=3)}BXe(){this.dmi();this.xli();this.lI=1}uNe(){this.ax||new ii.a(this,Object(F.a)(this,this.xLk,"processCurrentNodeAtBegin"),this.uV);do if(this.ax.run(),this.ax.inProgress&&!this.Qi)return;while(this.ax.inProgress);this.eKc();this.lI=2}E1e(){this.Gp=32;this.lI=3}s4d(){this.KY()}xLk(a,b){b=this.Dqa.bdh(this.hAa,b);a.Yg(Object(F.a)(this,this.J1i,"fromHereToEnd"));return b}J1i(a,b){if(this.Mi.moveNext())return a=this.Mi.currentNode,12!==a.type||
a===this.hAa.node?!0:this.Dqa.kNe(a,b);this.wmi();a.Yg(Object(F.a)(this,this.T1i,"fromStartToHere"));return!0}T1i(a,b){if(this.Mi.moveNext()){const c=this.Mi.currentNode;return 12!==c.type?!0:c===this.hAa.node?(a.Yg(Object(F.a)(this,this.yLk,"processCurrentNodeAtEnd")),!0):this.Dqa.kNe(c,b)}return!1}yLk(a,b){this.Dqa.cdh(this.hAa,b);return!1}dmi(){let a=this.Tc.Na.mb;if(a=this.jf.Sl(a,!0,!1))this.hAa=a.Ua;this.hAa&&this.hAa.node&&(this.Lpb=this.Dqa.qhj(this.hAa.node))}xli(){if(!this.Lpb)throw Error.argumentNull("_proofingWholeDocumentRootNode");
const a=new nn.a;a.set(this.hAa.node);a.rc(this.Lpb.type);this.Mi=xx.a.i3(a,this.Lpb);this.Mi.em(Object(F.a)(this.Dqa,this.Dqa.Byh,"spellErrorFilter"),null)}wmi(){if(!this.Lpb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new nn.a;a.set(this.Lpb);this.Mi=xx.a.rv(a);this.Mi.em(Object(F.a)(this.Dqa,this.Dqa.Byh,"spellErrorFilter"),null)}}Object(n.a)(TI,"ProofingWholeDocumentOperation",Ps.a,[]);class DC{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){this.Ca=b;this.Fm=a;this.nWh=
c;this.gh=f;this.Bk=l;this.Tc=w;this.Gm=H;this.jf=U;this.X4a=ja;this.DD=wa;this.nd=Sa;this.uAc=ub.Nle;this.qmf=Ub;this.rP=cc;this.Yvc=new Ib.a;this.Yvc.$(1,D.a.Cyh);this.Yvc.$(2,D.a.n$f);this.Yvc.$(3,D.a.Qzh);this.rDc=new Ib.a;this.rDc.$(1,D.a.Dyh);this.rDc.$(2,D.a.o$f);this.rDc.$(3,D.a.Rzh)}wb(){const a=this.Ca,b=Object(F.a)(this,this.ACi,"correctError"),c=Object(F.a)(this,this.nwi,"collapseIp");a.ra(D.a.sBk,Cb.a.view,Object(F.a)(this,this.tBk,"openLanguageDialogView"),1028);a.ya(D.a.bDa,Cb.a.Of,
Object(F.a)(this,this.bDa,"deleteRepeatedWord"));a.ya(D.a.Eka,Cb.a.Of,Object(F.a)(this,this.Eka,"ignoreSpellingError"));a.ya(D.a.kza,Cb.a.Of,b);a.ya(D.a.lza,Cb.a.Of,b);a.ya(D.a.mza,Cb.a.Of,b);a.ya(D.a.LLa,Cb.a.Of,b);a.ya(D.a.MLa,Cb.a.Of,b);a.ya(D.a.bDa,Cb.a.view,c);a.ya(D.a.Eka,Cb.a.view,c);a.ya(D.a.kza,Cb.a.view,c);a.ya(D.a.lza,Cb.a.view,c);a.ya(D.a.mza,Cb.a.view,c);a.ya(D.a.LLa,Cb.a.view,c);a.ya(D.a.MLa,Cb.a.view,c);a.le(D.a.bDa,1028);a.le(D.a.Eka,1028);a.le(D.a.kza,1028);a.le(D.a.lza,1028);a.le(D.a.mza,
1028);a.le(D.a.LLa,1028);a.le(D.a.MLa,1028);a.ya(D.a.Ssd,Xd.a.frame,ac.ActionManager.Ng);this.uAc&&a.ra(D.a.ELe,Cb.a.view,Object(F.a)(this,this.ELe,"populateProofingSecondaryMenu"),1124);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.ra(D.a.led,Cb.a.view,Object(F.a)(this,this.iZi,"findNextProofingError"),1028);this.iWk([D.a.Kql,D.a.Cyh,D.a.Dyh,D.a.Tqj,D.a.n$f,D.a.o$f,D.a.Xsl,D.a.Qzh,D.a.Rzh])}iWk(a){for(let b=0;b<a.length;b++)this.Ca.ra(a[b],
Cb.a.view,ac.ActionManager.vv,1028)}nwi(a,b,c,f,l){b=this.Tc.Na.mb;if(!b)return this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),2;b=this.jf.Sl(b,!0,!1);return this.Ca.pi(b.Ua,a,c,!1,f,l)}tBk(a,b,c){if(1===c)return this.Ca.processAction(D.a.$U,1);this.nWh().Prc();return 32}X3e(a){return a?a.Hh?!1:(ka.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.nd.Xb(Ld.a.P8a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),fd.a.mark(4671),!0):(ka.ULS.sendTraceTag(7660828,
324,10,"Ignore Spelling Error: No flagged word"),this.nd.Xb(Ld.a.P8a,{["Reason"]:"RequestedErrorRangeNotFound"}),fd.a.mark(4671),!0)}bDa(a,b,c){if(1===c)return 32;fd.a.mark(4670);c=this.Fm.PSa(b);if(this.X3e(c))return 8;b=b.node;const f=this.Bk.oe(15);let l=c.begin;" "===zb.ParagraphReader.text(b).charAt(l-1)&&l--;f.kd(b);const w=this.gh.replaceTextRange(Id.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Tc.setSelection(Od.SelectionFactory.Sg(b,w+l));f.dispose();c.Hh.dMa(a);fd.a.mark(4671);
return 32}h5j(a){let b;({value:b}=this.rDc.Tf(a.Hh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}Eka(a,b,c){if(1===c)return 32;ka.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");fd.a.mark(4670);c=this.Fm.PSa(b);if(this.X3e(c))return 8;b=b.node;const f=this.Bk.oe(15);f.kd(b);this.Fm.uKa(b,[c],!0);b.setValue(Za.a.GIf,!0);f.dispose();c.Hh.dMa(a,1);fd.a.mark(4671);ka.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.h5j(c);return 32}V7i(a){switch(a){case D.a.kza:return 0;
case D.a.lza:return 1;case D.a.mza:return 2;case D.a.LLa:return 3;case D.a.MLa:return 4;default:return-1}}B2j(a){let b;({value:b}=this.Yvc.Tf(a.Hh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}ACi(a,b,c){var f=!0;this.rP.ga(14)&&(f=!this.DD.uua(b));this.Gm&&this.Gm.instance&&this.Gm.instance.bX(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Ca.processAction(D.a.Ssd,2);fd.a.mark(4670);f=this.V7i(a);if(0>f)return 8;c=this.Fm.PSa(b);if(this.X3e(c))return 8;b=b.node;var l=c.Hh.suggestions;if(!l)return this.nd.Xb(Ld.a.P8a,
{["Reason"]:"NoSuggestionsFound"}),fd.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.nd.Xb(Ld.a.P8a,{["Reason"]:"RequestedSuggestionIsNull"}),fd.a.mark(4671),8;this.rP.ga(50)&&Pc.App.Jh.vw&&Pc.App.Jh.aZ.mra(b);f=f.replace("  "," \u00a0");l=this.Bk.oe(15);l.kd(b);const w=this.gh.replaceTextRange(Id.a.createTextRange(b,c.begin,c.end),f,!0,!1,D.a.Ssd);this.Tc.setSelection(Od.SelectionFactory.Sg(b,c.begin+f.length+w));l.dispose();c.Hh.dMa(a);fd.a.mark(4671);this.B2j(c);return 32}Y7k(a,b,c,f){a.mya();
(a=c.sc(a.Ma))?(f=P.a.Qt(a,u.AFrameworkApplication.isRtl?f.begin:f.end),this.X4a.Iaa(new Sys.UI.Point(f.x,f.y+f.height),b)):ka.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}iZi(a,b,c,f,l){if(!b.view.Nh)return 2;const w=b.view;if(!this.Tc.Na.mb)return this.nd.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),2;if(1===c)return 32;const H=new xz,U=new SI(this.Fm,this.jf);b=new TI(null,a,b,c,f,H,U,this.Ca,this.Tc,this.jf,null);b.Qi=!0;b.run();if(b.isCompleted&&H.RGb){if(b=Od.SelectionFactory.Sg(H.rPc,
H.RGb.begin),b=Od.SelectionFactory.GN(b,Id.a.Mj(H.rPc,H.RGb.end)),!this.qmf.instance||!this.qmf.instance.rPl(H.RGb,b,w)){this.Tc.setSelection(b);let ja=0;l&&(ja=l.Iu);w.Lqd=!1;fm.a.instance.Db(new Le.a(1,1,1,()=>{this.Y7k(w,ja,H.rPc,H.RGb)}))}}else{const ja=new Bi.StandardDialog;ja.yd=0;Pc.App.XR.Gme?ja.Ikb(CommonUIStrings.l_DefaultDialogTitle,H.kGh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(ja.Ikb(CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ProofingInProgress,null),Pc.App.XR.d8h(()=>{ja.LQ&&(ja.hide(),this.Ca.processAction(a,2))}))}return 32}ELe(){return 32}}Object(n.a)(DC,"ProofingActor",null,[]);var UI=d(723),xQ=d(1102);class uh{static kqj(){uh.MM||(uh.MM=Array(uh.atl),uh.MM[0]=Za.a.fontColor,uh.MM[1]=eh.a.NR,uh.MM[2]=Za.a.kt,uh.MM[3]=Za.a.underline,uh.MM[4]=Za.a.Rw,uh.MM[5]=eh.a.Zs,uh.MM[6]=Za.a.font,uh.MM[7]=Za.a.fontSize,uh.MM[8]=Za.a.superscript,uh.MM[9]=Za.a.subscript,uh.MM[10]=Za.a.jn,uh.MM[11]=Va.a.noProof,
uh.MM[12]=Yd.a.Twa,uh.MM[13]=eh.a.capitalization,uh.MM[14]=Za.a.bold,uh.MM[15]=Za.a.italic,uh.MM[16]=Za.a.underline);return uh.MM}static iqj(){uh.eD||(uh.eD=Array(uh.cDk),uh.eD[0]=Va.a.ho,uh.eD[1]=Va.a.zJa,uh.eD[2]=Va.a.$l,uh.eD[3]=Va.a.sxa,uh.eD[4]=Va.a.wY,uh.eD[5]=Va.a.shb,uh.eD[6]=Va.a.THb,uh.eD[7]=Va.a.rhb,uh.eD[8]=eh.a.cIb,uh.eD[9]=eh.a.bIb,uh.eD[10]=Va.a.ZHb,uh.eD[11]=Va.a.WHb,uh.eD[12]=Va.a.xVa,uh.eD[13]=Va.a.xx,uh.eD[14]=Va.a.vhb,uh.eD[15]=Va.a.uhb,uh.eD[16]=Va.a.Clc,uh.eD[17]=Va.a.Blc,uh.eD[18]=
Za.a.Jl,uh.eD[19]=Za.a.gJ,uh.eD[20]=eh.a.ild,uh.eD[21]=Za.a.vY);return uh.eD}}uh.atl=17;uh.cDk=22;uh.MM=null;uh.eD=null;Object(n.a)(uh,"StyleConstants",null,[]);class dr{static get PMk(){return dr.tP||(dr.tP=new xQ.a)}static jme(a,b){if(!a||!a.node||!b)return!1;const c=Kb.a.xs(a);if(dr.Kjg(c?c.Yz:null,b,uh.kqj()))return ka.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.K8();return dr.Kjg(a,b,uh.iqj())?(ka.ULS.sendTraceTag(51218399,
324,50,"Difference in paragraph attributes b/w text selection and style"),!0):!1}static Kjg(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Sa(l)?b.Sa(l)?!dr.PMk.compare(a,b,l):!0:!1)||f;return f}}dr.tP=null;Object(n.a)(dr,"StyleUtils",null,[]);class EC{constructor(a,b,c,f,l,w,H,U,ja,wa){this.K3a=this.KNb=null;this.gh=a;this.KK=b;this.LK=c;this.Jf=f;this.jha=l;this.Jt=w;this.DD=H;this.nd=U;this.lPa=ja;this.p4h=wa}get characterPropertiesEditor(){return this.gh}get jP(){return this.KK}get s6(){return this.LK}get jm(){return this.jha}get insertionPointFormatting(){return this.Jt}get mh(){return this.Jf}get ej(){return this.DD}get Wc(){return this.nd}get a2e(){return this.lPa}get svc(){return this.p4h}get EUa(){null==
this.K3a&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.K3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.K3a}wb(){const a=u.AFrameworkApplication.Ta,b=Pc.App.ULa.TLc(12);R.a.instance.ga(61)&&(a.ya(D.a.w6a,Cb.a.textRange,Object(F.a)(this,this.bgi,"applyStyleToTextRange")),a.ya(D.a.Snc,Cb.a.textRange,Object(F.a)(this,this.gOk,"queryStyleTextRange")),
a.ya(D.a.w6a,Cb.a.Of,Object(F.a)(this,this.$fi,"applyStyleToIp")),a.ya(D.a.Snc,Cb.a.Of,Object(F.a)(this,this.eOk,"queryStyleIp")));a.ya(D.a.w6a,Cb.a.paragraph,Object(F.a)(this,this.agi,"applyStyleToParagraph"));a.ya(D.a.w6a,Cb.a.view,Object(F.a)(this,this.cgi,"applyStyleView"));a.le(D.a.w6a,1036);a.ya(D.a.Snc,Cb.a.view,Object(F.a)(this,this.hOk,"queryStyleView"));a.ya(D.a.Snc,Cb.a.paragraph,Object(F.a)(this,this.fOk,"queryStyleParagraph"));a.le(D.a.Snc,99|(R.a.instance.ga(7)?0:4));a.ya(D.a.nmc,Cb.a.view,
b);a.ya(D.a.nmc,Cb.a.paragraph,Object(F.a)(this,this.nmc,"populateMenuMoreStyles"));a.le(D.a.nmc,1127);a.ra(D.a.GRd,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.HRd,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.IRd,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.JRd,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.KRd,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.LRd,Cb.a.view,Object(F.a)(this,
this.Gra,"applyStyleShortcut"),4);a.ra(D.a.MRd,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.qyf,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.ryf,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);a.ra(D.a.syf,Cb.a.view,Object(F.a)(this,this.Gra,"applyStyleShortcut"),4);this.KNb=Array(10);this.s6.WWe(this.KNb)}cmj(a){switch(a){case D.a.GRd:return 0;case D.a.HRd:return 1;case D.a.IRd:return 2;case D.a.JRd:return 3;case D.a.KRd:return 4;case D.a.LRd:return 5;
case D.a.MRd:return 6;case D.a.qyf:return 7;case D.a.ryf:return 8;case D.a.syf:return 9;default:return-1}}Gra(a,b,c,f){a=this.cmj(a);return 0>a||a>this.KNb.length?2:(a=this.KNb[a])?u.AFrameworkApplication.Ta.pi(b,D.a.w6a,c,!0,f,a):2}nmc(a,b,c,f,l){a=!0;b.contextId!==Cb.a.paragraph&&b.contextId!==Cb.a.textRange&&b.contextId!==Cb.a.Of&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.s6.sL(b.node);c=R.a.instance.ga(61);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp&&(l.MenuItems=
UI.StylePreviewGenerator.J4f(b,c));l.PopulationXML=UI.StylePreviewGenerator.$2i(b,c);return 32}fOk(a,b,c,f,l){a=!0;b.contextId!==Cb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.s6.aE(c);if(!a||!l)return ka.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.x0e.ay(a);this.EUa&&(l.Dke=dr.jme(b,a));return 32}agi(a,b,c,f,l){if(b.contextId!==Cb.a.paragraph)return 8;if(R.a.instance.ga(14)&&this.ej.CFa(b))return this.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),
8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.dae(l,a);if(!b)return this.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.h4b}),8;if(2!==this.s6.Ita(b))return 2;c=new qf.GraphTransaction(15);c.kd(a);this.insertionPointFormatting.w_a();this.jP.Eaa(b,a,!1);c.dispose();l=ha.a.sN(l);f.CN=l>>>16^l&65535;return 32}gOk(a,b,c,f,l){a=!0;b.contextId!==Cb.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=Kb.a.xs(b);a=Kb.a.Bwb(a);if(this.EUa){if(!l||!c)return ka.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
l,c),8;a=a||this.s6.aE(c);if(!a)return ka.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;l.Dke=dr.jme(b,a)}else{if(!a)return 2;if(!l)return 8}l.x0e.ay(a);return 32}bgi(a,b,c,f,l){if(b.contextId!==Cb.a.textRange||!R.a.instance.ga(61))return 8;if(this.ej.CFa(b))return this.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const w=this.dae(l,b.node);if(!w)return this.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.h4b}),8;if(1!==this.s6.Ita(w))return 2;
c=this.s6.sL(a);if(!c)return this.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.FVf}),8;if(!c.$G(this.s6.wQ(w)))return this.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.h4b}),8;const H=new qf.GraphTransaction(7);try{H.kd(a),this.jP.Puc(a,c),this.a2e.WHc(b,U=>{this.mh.pCa(U);this.mh.hga(U,w)})}finally{H&&H.dispose()}b=ha.a.sN(l);f.CN=b>>>16^b&65535;return 32}eOk(a,b,c,f,l){a=!0;b.contextId!==Cb.a.Of&&(a=!1);if(1===c&&!a)return 2;c=this.jP.aae(b);a=b.node;if(this.EUa){if(!l||!a)return ka.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
l,a),8;c=c||this.s6.aE(a);if(!c)return ka.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;l.Dke=dr.jme(b,c)}else{if(!c)return 2;if(!l)return 8}l.x0e.ay(c);return 32}$fi(a,b,c,f,l){if(b.contextId!==Cb.a.Of||!R.a.instance.ga(61))return 8;if(this.ej.CFa(b))return this.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const w=this.dae(l,b.node);if(!w)return this.Wc.Xb(Ld.a.R1,{["Reason"]:od.a.h4b}),8;const H=this.s6.Ita(w);if(1!==H&&2!==
H)return 2;(b=this.insertionPointFormatting.y6b(b))?(c=de.a.WQa(b),a=u.AFrameworkApplication.Ta.pi(c,a,2,!1,f,l)):(a=new qf.GraphTransaction(7),a.kd(c),this.jP.XWe(w,c),a.dispose(),a=32);l=ha.a.sN(l);f.CN=l>>>16^l&65535;return a}hOk(a,b,c,f,l){if(R.a.instance.ga(61)){const w=this.svc.P5(a,b,c,f,l,null,0);if(2!==w)return w}return this.svc.P5(a,b,c,f,l,null,12)}cgi(a,b,c,f,l){const w={};w[this.svc.xpa]=6168;w[this.svc.wpa]=6169;let H=12;if(R.a.instance.ga(61)){if(!b.view.Nh)return 2;var U=b.view.Mb,
ja=U?U.Qj:null;if(!ja)return this.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;if(R.a.instance.ga(11)&&this.jm.esa(nd.ImageReader.jzb,ja))return this.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Z0b}),8;if(R.a.instance.ga(14)&&this.ej.jZc(ja))return this.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),8;ja=this.s6.Lxb();if(l&&ja){var wa=ja.$G(l);wa&&(ja=this.s6.E8d(wa,ja),wa=this.s6.Ita(wa),ja&&(U=U.Na.ga(0),U.Cca&&U.Ua.contextId===Cb.a.textRange||2===U.length&&U.Ua.contextId===Cb.a.textRange&&U.Ye.contextId===Cb.a.endOfParagraph)&&
(wa=1,l=ja.eb(eh.a.dIb)),1===wa?H=0:3===wa&&(H=14))}}return this.svc.P5(a,b,c,f,l,w,H)}dae(a,b){if(a&&b&&zb.ParagraphReader.ae(b))b=this.s6.sL(b);else return null;return b.$G(a)}}Object(n.a)(EC,"StyleActor",null,[]);const VI=a=>a.contextId===Cb.a.H4d;class Ng{static get jm(){return vh.ContextSetEditor.instance}static get ej(){return Kh.a.instance}static get Wc(){return Nc.a.instance}static get ze(){return Ng.hd||(Ng.hd=Ab.a.instance.resolve("Box4.IFeatureHelper"))}static er(){return Ng.Gm||(Ng.Gm=
Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}static get wM(){return Ng.DG||(Ng.DG=Ab.a.instance.resolve("Box4.IParagraphIndentationReader"))}static R$b(a){return u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.WJa||a===D.a.C_a||a===D.a.S5||a===D.a.IKa)}static Y7(a,b,c,f,l){var w=!0;if(!b.view.Nh)return 2;var H=b.view,U=H.Mb;U&&U.Na.mb||(Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),w=!1);if(R.a.instance.ga(11)&&(Ng.jm.esa(nd.ImageReader.k$b,H.Mb.Qj)&&(Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.jXd}),
w=!1),Ng.jm.esa(nd.ImageReader.jzb,H.Mb.Qj)))return Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Z0b}),8;R.a.instance.ga(14)&&Ng.ej.jZc(H.Mb.Qj)&&(Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),w=!1);Ng.jm.esa(nd.ImageReader.pke,H.Mb.Qj)&&(Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.BIf}),w=!1);Ng.jm.esa(du.c,H.Mb.Qj)&&(Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.CIf}),w=!1);Ng.jm.esa(VI,H.Mb.Qj)&&(Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.AIf}),w=!1);Ng.er()&&Ng.er().instance&&Ng.er().instance.bX(H.Mb.Qj)&&(Ng.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.externalSelection}),
w=!1);a!==D.a.C1||R.a.instance.ga(54)||R.a.instance.ga(84)||(w=!1);var ja=null;U&&U.Na.mb&&(ja=U.Na.mb);a===D.a.Bql&&ja&&ja.Cca&&zb.ParagraphReader.cX(ja.Ua.node)&&!rb.ListReader.qx&&(w=!1);if(1===c||!w||!ja)return w?32:8;w=a===D.a.ula||a===D.a.bja||a===D.a.Aoa||a===D.a.RDa;H=a===D.a.xMk||a===D.a.aMi||a===D.a.rih;const wa=a===D.a.hkb||a===D.a.ikb||a===D.a.C1,Sa=new qf.GraphTransaction(15);Sa.kd(ja.Ua.node);ja=new Ka.a;let eb=!1;if(w||H||wa)fd.a.mark(7121),b=Ng.jm.o2i(b.CE);else{fd.a.mark(7119);b=
Fi.hta(U.Na,!0);if(!b)return Ng.Wc.Xb(Ld.a.Qja,{["Reason"]:od.a.RPc}),Sa.dispose(),8;U=a===D.a.JDj||a===D.a.KDj;b.lx&&U&&(eb=Ng.rzj(ja,b))}b.lx&&1<b.length&&Ng.szj(b)&&(l||(l={}),l.InContextSet=!0);u.AFrameworkApplication.Ta.pi(b,a,c,!0,f,l);eb&&Ng.Rpk(ja,b,l);Sa.dispose();Pc.App.Kb.updateCommandUI();w||H||wa?fd.a.mark(7122):fd.a.mark(7120);return 32}static rzj(a,b){if(!b.lx)return!1;let c=!1,f=!1;for(let w=0;w<b.length;w++)if(b.getContext(w).al){var l=b.getContext(w).node;if(l)if(l=Ng.wM.bxb(l),
2===l.specialIndentType)c=!0,a.add(w);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static Rpk(a,b,c){if(b.lx)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.al)continue;f=f.node;const w=Ng.wM.bxb(f);2!==w.specialIndentType||Cf.a.fz(c.value,w.VN)||f.setValue(Va.a.$l,w.VN-w.vNb)}}static Zil(a,b){let c=!0;b.contextId!==Cb.a.paragraph?c=!1:R.a.instance.ga(14)&&Ng.ej.CFa(b)?(Ng.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),c=!1):Ng.er()&&Ng.er().instance&&Ng.er().instance.bX(b)&&
(Ng.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,uF:c?32:8}}static Guh(a,b){let c=!0;b.contextId!==Cb.a.image&&b.contextId!==Cb.a.embeddedFile&&(c=!1);R.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,uF:c?32:8}}static szj(a){if(!a.lx)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).al){var c=a.getContext(f).node;if(c)if(c=zb.ParagraphReader.KN(c),!f)b=c;else if(c!==b)return!0}return!1}}Ng.hd=null;Ng.Gm=null;Ng.DG=null;Object(n.a)(Ng,"FormattingActionHelper",
null,[]);class Ss extends Ps.a{constructor(a,b,c,f,l,w,H,U){super();this.yof=this.bC=null;this.init(a);this.Pl("FormattingViewOperation");this.QEa(u.AFrameworkApplication.Ta,b,f,l,w);this.vu=c;this.IMa=0;this.ZB=!0;this.DSh=H;this.Gm=U}get Psa(){return this.Gm.instance}run(){const a=this.vu.view;var b=null;a.Nh&&(b=a.Mb);if(b){var c=b.Na.mb;!c||R.a.instance.ga(14)&&Ss.ej.ome(c)?(Ss.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),this.ZB=!1):this.Psa&&this.Psa.zzb(c)&&(Ss.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.externalSelection}),
this.ZB=!1)}else Ss.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),this.ZB=!1;1!==this.behavior&&this.ZB||(this.ZB&&(c=b.Na.mb,1===b.Na.length&&1===c.length&&nb.SelectionEditor.ik(c.Ua)&&oe.b(c.Ua)&&(Ss.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.jLc}),this.ZB=!1)),(c=this.ZB)&&this.actionId===D.a.$U&&((c=Ma.AT(b.Na.mb,Kb.a.DIf))||Ss.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.S0d})),this.Gp=c?32:8,this.IMa=3);0===this.IMa&&(fd.a.mark(5730),this.yof=fn.SelectionReferenceFactory.instance.ksa(),c=b.Na.mb.Ua,this.bC=new qf.GraphTransaction(15),
this.bC.kd(c.node),this.IMa=1);if(1===this.IMa){this.ax||this.Sjb(this.vu.CE);if(1===this.Yna())return;this.IMa=2}if(2===this.IMa){if(this.actionId===D.a.$U)if(b=b.Qj,b.lx)for(c=0;c<b.length;c++){let f=b.getContext(c);this.FFh(f)}else this.FFh(b);b=this.actionId===D.a.B1||this.actionId===D.a.fja||this.actionId===D.a.clearFormatting||this.actionId===D.a.sW;Ng.R$b(this.actionId)||this.yof.QU(b);(b=Object(qa.a)(1036,this.rd))&&!b.Haa||y.FocusManager.instance().rf(a.FI);this.bC.dispose();this.bC=null;
Ng.R$b(this.actionId)||Pc.App.Kb.updateCommandUI();fd.a.mark(5731);this.IMa=3;this.Gp=32}3===this.IMa&&(this.DSh.process(this.actionId,this.vu,this.behavior,this.response),this.KY())}FFh(a){(nb.SelectionEditor.$t(a)||nb.SelectionEditor.Xl(a))&&Pc.App.XR.TR(a.node)}static get ej(){return Kh.a.instance}static get Wc(){return Nc.a.instance}}Object(n.a)(Ss,"FormattingViewOperation",Ps.a,[]);var yQ=d(482),zQ=d(414);class Dd{constructor(a,b,c,f,l){this.DAa=new La.ScriptSharpLegacyMap;this.ngl=w=>{w=vb.HyperlinkReader.mbj(w,
this.BD);for(let H of w)(w=H.paragraph)&&w.Ra&&(w=w.Ra.iT(H.Qa))&&w.formatting&&Dd.mh.emh(w.formatting)};this.PSh=a;this.Nbf=b;this.ew=c;this.BD=f;if(!l)throw Error.argumentNull("interactiveViewManager");Dd.Kf=l;this.Kob=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("FontPreviewEnabled")}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.GNk,"queryNonParagraphFormatting");R.a.instance.ga(105)&&(Dd.ze?Dd.ze.lFa(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.ya(D.a.font,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Pq,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.bH,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.PH,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Sr,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.sW,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.B1,Cb.a.endOfParagraph,
Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.fja,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.bold,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.setItalic,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.underline,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Qoa,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.superscript,Cb.a.endOfParagraph,
Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.subscript,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.strikethrough,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Zs,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.$U,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.clearFormatting,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP"))):Pc.App.Sbb&&(a.ya(D.a.font,
Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.Pq,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.Sr,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.sW,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),rb.ListReader.qx&&(a.ya(D.a.bold,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.setItalic,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),
a.ya(D.a.superscript,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.subscript,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.strikethrough,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.Zs,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP"))),R.a.instance.ga(94)||R.a.instance.ga(96))&&(a.ya(D.a.bH,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.PH,
Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")));const c=Pc.App.ULa.wKf(f=>Fi.hta(f.Na,!0));a.ra(D.a.Gtd,Cb.a.textRange,Object(F.a)(this,this.Gtd,"toggleChangeCase"),1028);R.a.instance.ga(77)||a.ya(D.a.Kxa,Cb.a.table,Object(F.a)(this,this.nOk,"queryTableFormatting"));a.ya(D.a.mJb,Cb.a.view,Object(F.a)(this,this.Ydh,"queryCharacterFormatting"));a.ya(D.a.cOe,Cb.a.view,Object(F.a)(this,this.Ydh,"queryCharacterFormatting"));a.ya(D.a.Kxa,Cb.a.view,c);a.ya(D.a.Kxa,Cb.a.paragraph,
Object(F.a)(this,this.Kxa,"queryParagraphFormatting"));a.ya(D.a.Kxa,Cb.a.image,Object(F.a)(this,this.yNk,"queryImageFormatting"));a.ya(D.a.Kxa,Cb.a.unsupportedObject,b);a.le(D.a.mJb,99|(R.a.instance.ga(7)?0:1028));a.le(D.a.cOe,1127);a.le(D.a.Kxa,97|(R.a.instance.ga(7)?0:1028));u.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.ya(D.a.pJb,Cb.a.view,c),a.ya(D.a.pJb,Cb.a.paragraph,Object(F.a)(this,this.pJb,"queryParagraphIndentation")),a.le(D.a.pJb,97|(R.a.instance.ga(7)?0:1028)));this.eC(a,D.a.font);
this.eC(a,D.a.Pq);this.Kob&&(this.eC(a,D.a.WJa),this.eC(a,D.a.C_a),this.eC(a,D.a.S5),this.eC(a,D.a.IKa));if(R.a.instance.ga(94)||R.a.instance.ga(96))this.eC(a,D.a.bH),this.eC(a,D.a.PH);a.MBa(D.a.qYf,Cb.a.view,Object(F.a)(this,this.sRd,"applyCharacterFormattingViewAsync"));a.le(D.a.qYf,1092);this.eC(a,D.a.Sr);this.eC(a,D.a.sW);this.eC(a,D.a.B1);this.eC(a,D.a.K_b);this.eC(a,D.a.otb);this.eC(a,D.a.ptb);this.eC(a,D.a.$6a);this.eC(a,D.a.L_b);this.eC(a,D.a.fja);this.eC(a,D.a.bold);a.Kjb(D.a.bold,Object(F.a)(this,
this.n9a,"generateActionArguments"));this.eC(a,D.a.setItalic);a.Kjb(D.a.setItalic,Object(F.a)(this,this.n9a,"generateActionArguments"));this.eC(a,D.a.underline);a.Kjb(D.a.underline,Object(F.a)(this,this.n9a,"generateActionArguments"));this.eC(a,D.a.Qoa);this.eC(a,D.a.superscript);a.Kjb(D.a.superscript,Object(F.a)(this,this.n9a,"generateActionArguments"));this.eC(a,D.a.subscript);a.Kjb(D.a.subscript,Object(F.a)(this,this.n9a,"generateActionArguments"));this.eC(a,D.a.strikethrough);a.Kjb(D.a.strikethrough,
Object(F.a)(this,this.n9a,"generateActionArguments"));this.eC(a,D.a.Zs);a.Kjb(D.a.Zs,Object(F.a)(this,this.n9a,"generateActionArguments"));a.ra(D.a.xab,Cb.a.textRange,Object(F.a)(this,this.VHc,"applyCharacterFormatting"),96);a.MBa(D.a.$U,Cb.a.view,Object(F.a)(this,this.sRd,"applyCharacterFormattingViewAsync"));a.ya(D.a.$U,Cb.a.paragraph,Object(F.a)(this,this.zRd,"applyParagraphFormatting"));a.ya(D.a.$U,Cb.a.textRange,Object(F.a)(this,this.VHc,"applyCharacterFormatting"));a.ya(D.a.$U,Cb.a.Of,Object(F.a)(this,
this.tRd,"applyFormattingIp"));a.ya(D.a.clearFormatting,Cb.a.view,Object(F.a)(this,this.yui,"clearFormattingView"));a.ya(D.a.clearFormatting,Cb.a.paragraph,Object(F.a)(this,this.xui,"clearFormattingParagraph"));a.ya(D.a.clearFormatting,Cb.a.textRange,Object(F.a)(this,this.VHc,"applyCharacterFormatting"));a.ya(D.a.clearFormatting,Cb.a.Of,Object(F.a)(this,this.tRd,"applyFormattingIp"));a.le(D.a.clearFormatting,1028);a.ya(D.a.j7a,Cb.a.textRange,Object(F.a)(this,this.j7a,"clearFormattingParagraphLevel"));
a.ya(D.a.j7a,Cb.a.Of,Object(F.a)(this,this.j7a,"clearFormattingParagraphLevel"));a.ya(D.a.KVd,Cb.a.view,Object(F.a)(this,this.KVd,"clearFormattingMultiParagraphLevel"));a.ya(D.a.iLa,Cb.a.view,Ng.Y7);a.ya(D.a.iLa,Cb.a.paragraph,Object(F.a)(this,this.zRd,"applyParagraphFormatting"));a.ya(D.a.iLa,Cb.a.image,Object(F.a)(this,this.vyf,"applyTextDirectionToImage"));a.ya(D.a.iLa,Cb.a.unsupportedObject,Object(F.a)(this,this.wyf,"applyTextDirectionToNonParagraph"));a.le(D.a.iLa,1028);a.ya(D.a.r0a,Cb.a.view,
Ng.Y7);a.ya(D.a.r0a,Cb.a.paragraph,Object(F.a)(this,this.zRd,"applyParagraphFormatting"));a.ya(D.a.r0a,Cb.a.image,Object(F.a)(this,this.vyf,"applyTextDirectionToImage"));a.ya(D.a.r0a,Cb.a.unsupportedObject,Object(F.a)(this,this.wyf,"applyTextDirectionToNonParagraph"));a.le(D.a.r0a,1028)}eC(a,b){a.MBa(b,Cb.a.view,Object(F.a)(this,this.sRd,"applyCharacterFormattingViewAsync"));a.ya(b,Cb.a.textRange,Object(F.a)(this,this.VHc,"applyCharacterFormatting"));a.ya(b,Cb.a.Of,Object(F.a)(this,this.tRd,"applyFormattingIp"));
a.le(b,1028)}n9a(){return new V(2)}Gtd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Qa,b.Lb-b.Qa);return Dd.Mme(a,0,a.length)?this.LJc(b,D.a.otb):Dd.xWj(a)?this.LJc(b,D.a.$6a):this.LJc(b,D.a.ptb)}Ydh(a,b,c,f,l){f=!0;b.contextId!==Cb.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===D.a.cOe)a=l.formatting,l=l.fQl;else{if(!b.view||!b.view.Nh)return 2;b=b.view;if(!b.Mb||!b.Mb.Na.mb)return 8;a=l;l=b.Mb.Na}this.Qxi(l,a);return 32}Qxi(a,b){for(let l of a){a=l.Hl;for(let w of l){let H=null;if(w.contextId===
Cb.a.textRange){if(oe.b(w))continue;H=[];var c=w.node.Ra;if(c){var f=c.length-1;const U=w.Qa,ja=w.Lb;let wa=!1;for(let Sa=0;Sa<f;Sa++){const eb=c.ga(Sa).cp,ub=c.ga(Sa+1).cp;if(c.ga(Sa).formatting&&Math.max(eb,U)<Math.min(ub,ja))wa=!0,Array.add(H,c.ga(Sa).formatting);else if(wa)break}c.ga(f).formatting&&w.Lb>c.ga(f).cp&&Array.add(H,c.ga(f).formatting)}}else if(w.contextId===Cb.a.paragraph){if(H=[],c=w.node.Ra)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(H,c.ga(f).formatting)}else if(w.contextId===
Cb.a.endOfParagraph)H=[Kb.a.xs(w)];else if(w.contextId===Cb.a.Of){this.fNk(w,b);return}if(H&&0<H.length)for(const U of H)if(Kb.a.Yud(b,U.cache,w,a))return}}}fNk(a,b){var c=Kb.a.xs(a);if(c){c=c.cache;var f=Dd.insertionPointFormatting.LI(Za.a.bold,c.isBold);b.bold=f?1:0;f=Dd.insertionPointFormatting.LI(Za.a.italic,c.isItalic);b.italic=f?1:0;f=Dd.insertionPointFormatting.LI(Za.a.underline,c.hE);b.underline=f?1:0;b.Rw=Dd.insertionPointFormatting.LI(Za.a.Rw,c.Rw);f=Dd.insertionPointFormatting.LI(Za.a.superscript,
c.isSuperscript);b.superscript=f?1:0;f=Dd.insertionPointFormatting.LI(Za.a.subscript,c.QF);b.subscript=f?1:0;f=Dd.insertionPointFormatting.LI(Za.a.strikethrough,c.PF);b.strikethrough=f?1:0;f=Dd.insertionPointFormatting.LI(eh.a.Zs,c.D_);b.Zs=f?1:0;b.fontName=We.Font.eEa(Dd.insertionPointFormatting.LI(Za.a.font,c.JN));b.ipa=c.mV;b.fontSize=this.ew.M9a(Dd.insertionPointFormatting.LI(Za.a.fontSize,c.fontSize),a.node);b.fontColor=Dd.insertionPointFormatting.LI(Za.a.fontColor,c.fontColor);b.highlight=Dd.insertionPointFormatting.LI(Za.a.highlight,
c.highlight)}}sRd(a,b,c,f,l,w){return new Ss(a,b,c,f,l,w,this.PSh,Dd.er())}VHc(a,b,c,f,l){f=!0;let w=b;b.contextId!==Cb.a.textRange&&b.contextId!==Cb.a.Of?f=!1:(R.a.instance.ga(14)&&Dd.ej.uua(w)&&(Dd.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),f=!1),Dd.er()&&Dd.er().instance&&Dd.er().instance.bX(w)&&(f=!1),f&&nb.SelectionEditor.ik(b)&&oe.b(w)&&(Dd.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.jLc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===Cb.a.Of)return 2;this.ew.Mvh(a)&&(b=nb.SelectionEditor.UOb(w),nb.SelectionEditor.Tg(b)||
(w=b));b=w.node;Ng.R$b(a)&&(b.epa=!0);a==D.a.Sr&&R.a.instance.ga(119)&&u.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.ngl(w);Dd.a2e.WHc(w,H=>{this.Cqh(H,a,l,w.Lb)});Ng.R$b(a)&&(b.epa=!1);this.KLj(a)&&this.LJc(w,a);return 32}gUc(a){if(!this.Kob||!a||!a.paragraph)return null;const b=Dd.Kf.Qd;if(!b)return null;a=Object(qa.a)(494,a.paragraph.ng(b.Ma));return a?(a=Object(qa.a)(1035,a))?a:null:null}vWc(a){return this.Kob&&!!a&&!!a.Ji}Uqh(a,b,c){if(a&&a.rd){var f=
b.cache,l=a.rd,w=-1;if("string"===typeof l)this.Kob&&c===D.a.S5&&this.V6a(b,f.JN,Za.a.font),a=l;else if(this.Kob&&c===D.a.S5&&(this.V6a(b,f.JN,Za.a.font),this.V6a(b,f.mV,Va.a.mV)),a=l.fontName,w=l.ipa,We.Font.QUa()){this.Kob&&c===D.a.S5&&(this.V6a(b,f.isBold,Za.a.bold),this.V6a(b,f.isItalic,Za.a.italic));const H=1===l.bold;l=1===l.italic;if(H||l)Dd.mh.OH(b,H),Dd.mh.setItalic(b,l)}a=a.substr(0,31);Dd.mh.YU(b,a);R.a.instance.ga(53)&&(c===D.a.S5&&this.V6a(b,f.mV,Va.a.mV),Dd.mh.jLa(b,w))}}V6a(a,b,c){this.DAa.Gb(a.He.cp)||
this.DAa.$(a.He.cp,new La.ScriptSharpLegacyMap);this.DAa.ga(a.He.cp).Gb(c)||this.DAa.ga(a.He.cp).$(c,b)}t5b(a,b){if(!this.DAa.Gb(a.He.cp))return null;const c=this.DAa.ga(a.He.cp).ga(b);this.DAa.ga(a.He.cp).remove(b);this.DAa.ga(a.He.cp).count||this.DAa.remove(a.He.cp);return c}Cqh(a,b,c,f){var l=a.cache,w=Object(qa.a)(1036,c);switch(b){case D.a.bold:2===c.value&&(c.value=l.isBold?0:1);Dd.mh.OH(a,1===c.value);break;case D.a.setItalic:2===c.value&&(c.value=l.isItalic?0:1);Dd.mh.setItalic(a,1===c.value);
break;case D.a.underline:2===c.value&&(c.value=l.hE?0:1);Dd.mh.PY(a,1===c.value);break;case D.a.Qoa:Dd.mh.Qoa(a,c);break;case D.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);Dd.mh.OY(a,1===c.value);break;case D.a.subscript:2===c.value&&(c.value=l.QF?0:1);Dd.mh.h6(a,1===c.value);break;case D.a.strikethrough:2===c.value&&(c.value=l.PF?0:1);Dd.mh.MY(a,1===c.value);break;case D.a.Zs:2===c.value&&(c.value=l.D_?0:1);Dd.mh.Tjb(a,1===c.value);break;case D.a.font:this.Uqh(w,a,D.a.font);break;case D.a.S5:c=
this.gUc(a);this.vWc(c)&&(this.Uqh(w,a,D.a.S5),c.iK(null));break;case D.a.IKa:c=this.gUc(a);this.vWc(c)&&(w=this.t5b(a,Za.a.font))&&(l=this.t5b(a,Za.a.bold),f=this.t5b(a,Za.a.italic),l&&Dd.mh.OH(a,l),f&&Dd.mh.setItalic(a,f),w=w.substr(0,31),Dd.mh.YU(a,w),l=this.t5b(a,Va.a.mV),R.a.instance.ga(53)&&l&&Dd.mh.jLa(a,l),c.iK(null));break;case D.a.Sr:Dd.mh.Sr(a,c,null);break;case D.a.sW:Dd.mh.sW(a);break;case D.a.B1:Dd.mh.Joa(a,c);break;case D.a.fja:Dd.mh.i0b(a);break;case D.a.Pq:Dd.mh.Pq(a,w.rd);break;
case D.a.WJa:c=this.gUc(a);this.vWc(c)&&(this.V6a(a,l.fontSize,Za.a.fontSize),Dd.mh.Pq(a,w.rd),c.iK(null));break;case D.a.C_a:c=this.gUc(a);this.vWc(c)&&(l=this.t5b(a,Za.a.fontSize))&&(Dd.mh.Pq(a,l),c.iK(null));break;case D.a.bH:Dd.mh.RVc(a);break;case D.a.PH:Dd.mh.yrd(a);break;case D.a.$U:l=R.a.instance.ga(20)?Va.a.noProof:Yd.a.Twa;Dd.mh.vqc(a,c.eb(Za.a.kt),f,c.sa(l,!1));break;case D.a.xab:Dd.mh.WLb(a);break;case D.a.clearFormatting:Dd.mh.pCa(a);break;case D.a.otb:case D.a.ptb:case D.a.K_b:case D.a.$6a:case D.a.L_b:l.MTa&&
2===l.capitalization&&Dd.mh.FVd(a)}}j7a(a,b,c){a=!0;b.contextId!==Cb.a.textRange&&b.contextId!==Cb.a.Of?a=!1:(R.a.instance.ga(14)&&Dd.ej.uua(b)&&(Dd.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),a=!1),a&&nb.SelectionEditor.ik(b)&&oe.b(b)&&(Dd.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.jLc}),a=!1));if(1===c||!a)return a?32:8;Dd.paragraphEditor.l0b(b.node,!1);return 32}KVd(a,b,c,f,l){a={};a[ni.xpa]=6168;a[ni.wpa]=6169;const w=b.view;var H=null;w.pp&&(H=w);var U=!0;let ja=32;H&&(H=H.Mb.Na.mb)&&R.a.instance.ga(14)&&(Dd.ej.ome(H)?
(Dd.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),ja=8,U=!1):1===c&&(ja=32,U=!1));U&&R.a.instance.ga(54)&&(U=new qf.GraphTransaction(1===c?3:15),U.kd(w.root),ja=ni.P5(D.a.j7a,b,c,f,l,a,12),U.dispose());return ja}tRd(a,b,c,f,l){var w=!0,H=32;b.contextId!==Cb.a.Of?w=!1:R.a.instance.ga(14)&&Dd.ej.uua(b)&&(Dd.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),w=!1);if(1===c||!w)return w?32:8;c=b.node;w=null;if(R.a.instance.ga(54)&&R.a.instance.ga(61)&&a===D.a.clearFormatting){Dd.fq.Dtb(c);Dd.paragraphEditor.zGf(c);const U=mb.StyleReader.sL(c).$G(mb.StyleReader.CMa);
Dd.jP.Eaa(U,c,!0)}if(a!==D.a.clearFormatting||R.a.instance.ga(49))w=Dd.insertionPointFormatting.y6b(b);if(w)H=de.a.WQa(w),H=u.AFrameworkApplication.Ta.pi(H,a,2,!1,f,l);else switch(f=Object(qa.a)(1036,l),b=Kb.a.xs(b).cache,a){case D.a.font:f&&f.rd&&(l=f.rd,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.ipa),Dd.insertionPointFormatting.npd(b),R.a.instance.ga(53)&&Dd.insertionPointFormatting.jLa(f));break;case D.a.Sr:Dd.insertionPointFormatting.Sr(l);break;case D.a.sW:Dd.insertionPointFormatting.sW();
break;case D.a.B1:Dd.insertionPointFormatting.Joa(l);break;case D.a.fja:Dd.insertionPointFormatting.i0b();break;case D.a.Pq:Dd.insertionPointFormatting.Pq(f.rd);break;case D.a.bH:l=Dd.insertionPointFormatting.LI(Za.a.fontSize,b.fontSize);Dd.insertionPointFormatting.Pq(Dd.mh.bH(l));break;case D.a.PH:l=Dd.insertionPointFormatting.LI(Za.a.fontSize,b.fontSize);Dd.insertionPointFormatting.Pq(Dd.mh.PH(l));break;case D.a.bold:Dd.insertionPointFormatting.OH(!Dd.insertionPointFormatting.LI(Za.a.bold,b.isBold));
break;case D.a.setItalic:Dd.insertionPointFormatting.setItalic(!Dd.insertionPointFormatting.LI(Za.a.italic,b.isItalic));break;case D.a.underline:Dd.insertionPointFormatting.PY(!Dd.insertionPointFormatting.LI(Za.a.underline,b.hE));break;case D.a.Qoa:Dd.insertionPointFormatting.Qoa(l);break;case D.a.superscript:Dd.insertionPointFormatting.OY(!Dd.insertionPointFormatting.LI(Za.a.superscript,b.isSuperscript));break;case D.a.subscript:Dd.insertionPointFormatting.h6(!Dd.insertionPointFormatting.LI(Za.a.subscript,
b.QF));break;case D.a.strikethrough:Dd.insertionPointFormatting.MY(!Dd.insertionPointFormatting.LI(Za.a.strikethrough,b.PF));break;case D.a.Zs:Dd.insertionPointFormatting.Tjb(!Dd.insertionPointFormatting.LI(eh.a.Zs,b.D_));break;case D.a.clearFormatting:Dd.insertionPointFormatting.w_a();R.a.instance.ga(54)||(Dd.fq.Dtb(c),Dd.paragraphEditor.l0b(c,!0),R.a.instance.ga(71)&&Dd.jP.lKc(c));break;case D.a.$U:l.Sa(Za.a.kt)&&Dd.insertionPointFormatting.$U(l.eb(Za.a.kt)),b=R.a.instance.ga(20)?Va.a.noProof:Yd.a.Twa,
l.Sa(b)&&Dd.insertionPointFormatting.odl(l.eb(b))}Ng.R$b(a)||Pc.App.Kb.updateCommandUI();return H}$Yk(a,b){D.a.clearFormatting===b&&Pa.OutlineElementNavigator.WA(a).properties.removeProperty(Za.a.vY)}VP(a,b,c,f,l){f=Dd.Wc.Wp(D.a.xbl);var w=!0;b.contextId!==Cb.a.endOfParagraph&&(w=!1);if(1===c||!w)return w?32:8;c=b.node;b=ob.GraphIterator.nb(b.node);b.Ze();w=b.vka(4);if((b=!!w&&Dd.Rf.Rda(w))&&!Pc.App.Sbb)return 8;const H=!zb.ParagraphReader.textLength(c);f.properties.$("Action",a.toString());f.properties.$("ListContext",
b.toString());f.properties.$("IsEmptyParagraph",H.toString());ka.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,H);this.Nbf.tAh(b)?this.aIh(a,l,w):(b=c.Ra.last,this.$Yk(c,a),w=b.formatting,c=Dd.characterPropertiesEditor.e2d(c),this.Nbf.rlg(w)&&(c.ee(c.He),this.Cqh(c,a,l,b.cp)));f.end();return 32}aIh(a,b,c){const f=Object(qa.a)(1036,b);switch(a){case D.a.Sr:Dd.dea.Sr(c,b);break;case D.a.Pq:Dd.dea.Pq(c,f.rd);break;case D.a.sW:Dd.dea.sW(c);break;
case D.a.bH:Dd.dea.bH(c);break;case D.a.PH:Dd.dea.PH(c);break;case D.a.font:Dd.dea.Xbl(c,f.rd);break;case D.a.bold:a=this.MKb(b,Za.a.bold,c);Dd.dea.OH(c,a);break;case D.a.setItalic:a=this.MKb(b,Za.a.italic,c);Dd.dea.setItalic(c,a);break;case D.a.subscript:a=this.MKb(b,Za.a.subscript,c);Dd.dea.h6(c,a);break;case D.a.superscript:a=this.MKb(b,Za.a.superscript,c);Dd.dea.OY(c,a);break;case D.a.strikethrough:a=this.MKb(b,Za.a.strikethrough,c);Dd.dea.MY(c,a);break;case D.a.Zs:a=this.MKb(b,eh.a.Zs,c),Dd.dea.Tjb(c,
a)}}MKb(a,b,c){2===a.value&&(a.value=c?c.sa(b,!1)?0:1:0);return 1===a.value}oca(a,b,c,f,l){f=!0;const w=ob.GraphIterator.nb(b.node);w.Ze();b.contextId===Cb.a.endOfParagraph&&w.vka(4)||(Dd.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.xoe}),f=!1);b=w.currentNode;if(!Dd.Rf.Rda(b))return 8;if(1===c||!f)return f?32:8;this.aIh(a,l,b);return 32}Kxa(a,b,c,f,l){a=!0;b.contextId!==Cb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.Jl?l.Jl!==zb.ParagraphReader.KN(c)&&(l.Jl=0):l.Jl=zb.ParagraphReader.KN(c);R.a.instance.ga(54)&&
(R.a.instance.ga(59)||R.a.instance.ga(34))&&(a=Dd.wM.bxb(c),l.cB?(!l.IOl&&this.tzj(l.cB,a)&&2===l.cB.specialIndentType&&(l.cB.specialIndentType=0),l.cB.rXc===a.rXc&&Cf.a.fz(l.cB.VN,a.VN)||(l.cB.VN=Number.MAX_VALUE),l.cB.tXc===a.tXc&&Cf.a.fz(l.cB.Iyb,a.Iyb)||(l.cB.Iyb=Number.MAX_VALUE)):l.cB=a,b=Dd.jm.pzf(b.CE),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=yQ.WordSectionNavigator.instance.KFe(b),void 0!==b&&null!==b&&(b=Dd.Z6e.Bta(b)-(Dd.Z6e.X8d(b)+Dd.Z6e.Y8d(b)+Pc.App.VLl),a.sXc=b-a.VN,
a.qXc=b-a.Iyb,l.cB.qXc=Math.min(l.cB.qXc,a.qXc),l.cB.sXc=Math.min(l.cB.sXc,a.sXc)))));if(R.a.instance.ga(54)&&R.a.instance.ga(59)||R.a.instance.ga(84))b=Dd.y0j.QW(c),l.spacing?(l.spacing.beforeSpacing=Dd.awf(b.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=Dd.awf(b.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.unit===b.lineSpacing.unit&&Cf.a.fz(l.spacing.lineSpacing.value,b.lineSpacing.value)||(l.spacing.lineSpacing.unit=0,l.spacing.lineSpacing.value=0)):l.spacing=b;b=
new ob.GraphIterator;b.set(c);b.rc(11);if(c=b.Jg(11))l.isRtl=fe.OutlineElementReader.um(c);c=Dd.Rf.lw(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=Dd.q8i(l.listType,b);l.MT=16===l.listType?null:c;return 32}tzj(a,b){return this.Jyf(a,b)||this.Jyf(b,a)}Jyf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}GNk(a,b,c,f,l){a=Pa.OutlineElementNavigator.WA(b.node);l.isRtl=fe.OutlineElementReader.um(a);return 32}wyf(a,b,c){if(a===D.a.r0a)a=!0;else if(a===D.a.iLa)a=
!1;else return 2;a&&this.ipe(b);if(1===c)return 32;b=Pa.OutlineElementNavigator.WA(b.node);Dd.Qh.eLa(b,a);return 32}yNk(a,b,c,f,l){a=b.node;b=Pa.OutlineElementNavigator.WA(a);l.isRtl=fe.OutlineElementReader.isRtl(b);l.Jl=nd.ImageReader.KN(a);return 32}nOk(a,b,c,f,l){a=b.node;b=Pa.OutlineElementNavigator.WA(a);l.isRtl=fe.OutlineElementReader.isRtl(b);l.Jl=hd.TableReader.KN(a);if(-1===l.Jl||0===l.Jl)l.Jl=l.isRtl?3:1;return 32}vyf(a,b,c){if(!({uF:c}=Ng.Guh(c,b)).returnValue)return c;c=b.node;switch(a){case D.a.iLa:case D.a.r0a:c=
Pa.OutlineElementNavigator.WA(c);let f=!0;a===D.a.iLa&&(f=!1);Dd.Qh.eLa(c,f);f&&this.ipe(b)}return 32}zRd(a,b,c,f,l){let w;if(!({uF:w}=Ng.Zil(c,b)).returnValue)return w;const H=b.node;switch(a){case D.a.iLa:Dd.Qh.wMb(H,!1);break;case D.a.r0a:this.ipe(b);Dd.Qh.wMb(H,!0);break;case D.a.$U:w=u.AFrameworkApplication.Ta.pi(b.CE,a,c,!0,f,l),32===w&&zb.ParagraphReader.tm(b)&&Dd.anc&&Dd.anc.TR(H)}return 32}yui(a,b,c,f,l){const w={};w[ni.xpa]=6168;w[ni.wpa]=6169;var H=b.view;const U=new qf.GraphTransaction(1===
c?3:15);U.kd(H.root);let ja=ni.P5(a,b,c,f,l,w,0),wa=null;H.pp&&(wa=H);H=!0;let Sa=null;wa&&(Sa=wa.Mb.Na.mb)&&R.a.instance.ga(14)&&(Dd.ej.ome(Sa)?(Dd.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),ja=8,H=!1):1===c&&(ja=32,H=!1));H&&this.CWj(Sa)&&(ja=R.a.instance.ga(54)?ni.P5(D.a.j7a,b,c,f,l,w,12):ni.P5(a,b,c,f,l,w,12));U.dispose();return ja}xui(a,b,c){a=!0;b.contextId!==Cb.a.paragraph&&b.contextId!==Cb.a.Of?a=!1:R.a.instance.ga(14)&&Dd.ej.CFa(b)&&(Dd.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),a=!1);if(1===c||!a)return a?
32:8;b=b.node;c=new qf.GraphTransaction(15);c.kd(b);Dd.fq.Dtb(b);Dd.paragraphEditor.l0b(b,!0);Dd.jP.lKc(b);c.dispose();return 2}pJb(a,b,c,f,l){a=b.contextId===Cb.a.paragraph;if(1===c&&!a)return 8;l.cB||(b=b.node,c=Dd.wM.bxb(b),l.cB=c,c=new ob.GraphIterator,c.set(b),c.rc(11),b=c.Jg(11),l.isRtl=b?fe.OutlineElementReader.um(b):!1);return 32}CWj(a){return!a||nb.SelectionEditor.ox(a)||1===a.length&&nb.SelectionEditor.ik(a.Ua)&&!nb.SelectionEditor.xzb(a.Ua)?!1:!0}ipe(a){Dd.Tnf.Gb(a.contextId)||(ka.ULS.sendTraceTag(42276747,
340,50,"RTL Usage : {0}",a.contextId),Dd.Tnf.$(a.contextId,!0))}KLj(a){return a===D.a.K_b||a===D.a.otb||a===D.a.ptb||a===D.a.$6a||a===D.a.L_b}LJc(a,b){const c=a.node;b=Dd.gwl(c.characterData.substr(a.Qa,a.Lb-a.Qa),b);c.characterData=c.characterData.substr(0,a.Qa)+b+c.characterData.substr(a.Lb);return 32}static get mh(){return Dd.Jf||(Dd.Jf=Ab.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Dd.gh||(Dd.gh=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Dd.Yw||
(Dd.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}static get y0j(){return Dd.fOa||(Dd.fOa=Ab.a.instance.resolve("Box4.ILineSpacingHelper"))}static get jP(){return Dd.KK||(Dd.KK=Ab.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Qh(){return Dd.Fi||(Dd.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return Dd.Jt||(Dd.Jt=Ab.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get dea(){return Dd.gpb||(Dd.gpb=Ab.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get wM(){return Dd.DG||
(Dd.DG=Ab.a.instance.resolve("Box4.IParagraphIndentationReader"))}static er(){return Dd.Gm||(Dd.Gm=Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}static get jm(){return vh.ContextSetEditor.instance}static get ej(){return Kh.a.instance}static get Wc(){return Nc.a.instance}static get ze(){return Dd.hd||(Dd.hd=Ab.a.instance.rb("Box4.IFeatureHelper"))}static get anc(){return Pc.App.XR}static get Sf(){return Dd.fd||(Dd.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get F6(){return Dd.ap||
(Dd.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get a2e(){return Dd.lPa||(Dd.lPa=Ab.a.instance.resolve("Box4.TextFormattingHelper"))}static get Rf(){return Dd.Wg||(Dd.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}static get fq(){return Dd.Zo||(Dd.Zo=Ab.a.instance.resolve("Box4.List.IListEditor"))}static get Z6e(){return zQ.a.instance}static q8i(a,b){return 42===a?b:a!==b||16===a?16:a}static awf(a,b){a.iig||(b.iig?b=a:b.unit===a.unit&&Cf.a.fz(b.value,
a.value)||(b.value=-1));return b}static gwl(a,b){switch(b){case D.a.otb:return a.toLowerCase();case D.a.ptb:return a.toUpperCase();case D.a.K_b:case D.a.$6a:return Dd.Pri(a,b===D.a.$6a);case D.a.L_b:return Dd.Pxl(a);default:return a}}static Pxl(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static Pri(a,b){let c,f,l=!0,w=a.length,H=0,U=Dd.Mme(a,H,w);for(;0<w;){f=c=!1;var ja=w;let Sa;var wa=void 0;for(wa=
0;0<ja&&Dd.Ati(a.charAt(H+wa));wa++,ja--)f=Dd.v0c(a.charAt(H+wa));for(Sa=wa;0<ja&&!(c=Dd.v0c(a.charAt(H+wa)))&&" "!==a.charAt(H+wa)&&"/"!==a.charAt(H+wa);wa++,ja--);ja=wa-Sa;if(0>=ja)break;H+=Sa;wa=a.substr(H,ja);wa=wa===wa.toUpperCase();if(U||!wa)a=l||f||b?a.substr(0,H)+a.charAt(H).toUpperCase()+a.substr(H+1,ja-1).toLowerCase()+a.substr(H+ja):a.substr(0,H)+a.substr(H,ja).toLowerCase()+a.substr(H+ja);w-=ja+Sa;H+=ja;if(l=c)H++,w--,U=Dd.Mme(a,H,w)}return a}static Mme(a,b,c){for(;0<c&&!Dd.v0c(a.charAt(b));){if(a.charAt(b)!==
a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static xWj(a){for(var b=0;b<a.length&&!Dd.v0c(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static v0c(a){return"."===a||"!"===a||"?"===a?!0:!1}static Ati(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}Dd.Jf=null;Dd.Fi=null;Dd.Tnf=new Ci.a;Dd.Kf=null;Dd.fOa=null;Dd.gh=null;Dd.Yw=null;Dd.KK=null;Dd.Jt=null;Dd.gpb=null;Dd.DG=null;Dd.Gm=null;Dd.hd=null;Dd.fd=null;Dd.ap=null;Dd.lPa=null;Dd.Wg=
null;Dd.Zo=null;Object(n.a)(Dd,"TextFormattingActor",null,[]);class WI{constructor(a){this.Ca=a}get An(){return this.Ca}WLb(a,b=!1){this.An.pi(a,D.a.xab,2,!0,null,b)}$U(a){this.An.La(D.a.$U,2,a)}}Object(n.a)(WI,"TextFormattingCommands",null,[1009]);class eu{get xpa(){return ni.xpa}get wpa(){return ni.wpa}get SPb(){return ni.SPb}P5(a,b,c,f,l,w,H){return ni.P5(a,b,c,f,l,w,H)}Ahb(a,b,c,f,l,w){return ni.Ahb(a,b,c,f,l,w)}static get instance(){eu.Ka||(eu.Ka=new eu);return eu.Ka}}eu.Ka=null;Object(n.a)(eu,
"ViewActionHandlerProxy",null,[1034]);class XI{constructor(a){this.Ca=a}get An(){return this.Ca}kok(a){if(4===a)a=D.a.leftArrow;else if(2===a)a=D.a.rightArrow;else if(1===a)a=D.a.upArrow;else if(3===a)a=D.a.downArrow;else return;this.An.processAction(a,2)}Osa(){this.An.processAction(D.a.Osa,2)}}Object(n.a)(XI,"SelectionCommands",null,[1008]);class YI{Sg(a,b){return Od.SelectionFactory.Sg(a,b)}GN(a,b){return Od.SelectionFactory.GN(a,b)}Fu(a,b=!0){return Od.SelectionFactory.Fu(a,b)}k3(a,b,c){return Od.SelectionFactory.k3(a,
b,c)}wl(a){return Od.SelectionFactory.wl(a)}YOb(a,b,c=!1){return Od.SelectionFactory.YOb(a,b,c)}}Object(n.a)(YI,"SelectionFactoryProxy",null,[995]);var AQ=d(886),zx=d(251),yz=d(1010);class ZI extends yz.a{constructor(a,b,c,f,l,w,H=null,U=null){super(a,w,H,U);this.qo=this.Yw=this.z2=null;this.hqa=!1;this.f3a=u.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.k4a=0;this.AMd=new Ka.a;Ue.a(8128527,307,fe.OutlineElementReader.$g(a));this.rF=b;this.rF.wsb(this);this.rDd=c;this.Zo=
f;this.Wg=l;this.VFk=U;this.HId=rb.ListReader.vk(this.Ab)}get e9(){return this.z2||(this.z2=Ab.a.instance.rb("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.Yw||(this.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}get fRa(){return null}get D7a(){return this.HId&&!this.rF.Mca}get S7a(){return 0<this.k4a}get Bv(){return this.rDd}get fq(){return this.Zo}get Rf(){return this.Wg}get GIc(){return this.VFk}Y0(a,b){if(!this.lZ.W3e(b)){Ue.a(8701077,307,zb.ParagraphReader.el(this.Ab));var c=
this.Ab.currentNode,f=Id.a.VQa(c);this.f3a&&this.qo.j9a&&(c=c.Ra.last,this.hqa&&(c.formatting=this.qo.j9a.ee(c),this.hqa=!1),a=this.lZ.Ube(a,b),this.lZ.Moa(this.Ab.currentNode,this.qo.Hfa,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}Kna(){Ue.a(8701078,307,zb.ParagraphReader.el(this.Ab));const a=Id.a.VQa(this.Ab.currentNode);this.characterPropertiesEditor.IXc(a,b=>new yv.a(b,yv.a.$Mc),Sd.AParagraphNode.j_)}kZa(){}Ina(){this.f3a&&(this.hqa=!0)}Ywa(){Ue.a(8701079,307,zb.ParagraphReader.el(this.Ab))}Xwa(){Ue.a(8701080,
307,zb.ParagraphReader.el(this.Ab))}wA(a){this.rF.Mca||(this.f3a?(this.lRd(a),this.qo.dud(this.Ab.currentNode),a&&"P"===a.FU.y8b&&this.GIc.cLa(this.Ab.currentNode,this.qo.zhd),this.lZ.Moa(this.Ab.currentNode,this.qo.Hfa,a)):this.Pii(a))}vA(){this.rF.Mca||this.u3()}cxa(){}sJa(){}Nna(){Ue.a(8701081,307,fe.OutlineElementReader.$g(this.Ab)||jj.OutlineReader.au(this.Ab)||zb.ParagraphReader.el(this.Ab)&&this.rF.Mca);let a=!1;this.S7a||(a=this.D7a||!0);a||(this.yM+=1);this.k4a++}Lna(){this.k4a--;let a=!1;
this.S7a||(a=this.D7a||!0);a||--this.yM}bxa(a){Ue.a(8701082,307,fe.OutlineElementReader.$g(this.Ab)||jj.OutlineReader.au(this.Ab)||zb.ParagraphReader.el(this.Ab)&&this.rF.Mca);Ue.a(8701083,307,0!==a.listStyleType)}Mna(){Ue.a(8701084,307,fe.OutlineElementReader.$g(this.Ab)||zb.ParagraphReader.el(this.Ab)&&this.rF.Mca);this.rF.Mca||Ue.a(8701085,307,this.Ab.QI(2))}tY(a){this.rF.tY(a)}qY(){this.rF.qY()}Qtd(a){this.AMd.add(a)}sY(a){this.rF.sY(a)}rY(){this.rF.rY()}pY(a){this.rF.pY(a)}oY(){this.rF.oY()}Pii(a){this.BGb(!1);
(new ob.GraphIterator).Rc(this.Ab);a=yz.a.Qh.Hca(this.Ab,this.YSa(a));Ue.a(8128534,307,a===this.Ab.currentNode);Ue.a(8128535,307,zb.ParagraphReader.ae(a))}u3(){Ue.a(8128536,307,zb.ParagraphReader.el(this.Ab));Pa.OutlineElementNavigator.Re(this.Ab)}reset(){this.f3a&&(super.reset(),this.qo=this.g7d(!0))}lRd(a){this.BGb(!1);(new ob.GraphIterator).Rc(this.Ab);a=yz.a.Qh.Hca(this.Ab,this.YSa(a));Ue.a(36577367,307,a===this.Ab.currentNode);Ue.a(36577368,307,zb.ParagraphReader.ae(a));-1!==this.qo.iE&&this.paragraphEditor.$J(a,
this.qo.iE);this.qo.lineSpacing&&this.GIc.C1(a,this.qo.lineSpacing);this.qo.qga&&this.GIc.Esh(a,this.qo.qga);this.qo.e2c&&this.GIc.urh(a,this.qo.e2c);this.hqa=!0;this.qo.paragraph=a}static HXd(a,b){let c=0;switch(b){case 3:c=te.a.Wta(a);break;case 7:c=Of.a.Lfa(a,0);break;case 1:c=te.a.ZUd(a);break;case 5:c=te.a.Wta(te.a.Hid(a));break;default:ka.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(n.a)(ZI,"TextOnlyBox4PasteSteward",
yz.a,[]);class FC{constructor(a,b,c,f){this.zVb=a;this.Zo=b;this.Wg=c;this.lZ=f}create(a,b,c,f,l=null,w=null){return 1===a?new ZI(b,f,this.zVb,this.Zo,this.Wg,l,w,this.lZ):new zx.Box4PasteSteward(b,c,f,this.zVb,this.Zo,this.Wg,l,w,this.lZ)}}Object(n.a)(FC,"Box4PasteStewardFactory",null,[1033]);class ah{static get tBj(){return ah.NTh}static get zBj(){return ah.QTh}static get yBj(){return ah.PTh}static OLk(a,b){const c=a.currentNode;Rd.forEachCell(a,b.rowSpan,b.colSpan,(f,l,w)=>{const H=f.currentNode;
H!==c&&(H.isGhostCell=!0,ah.FOf(f),!w&&1<=b.colSpan&&(H.colSpan=b.colSpan),ah.$qh(f,b.v6,l,w,b.rowSpan,b.colSpan))})}static iMk(a,b){Rd.forEachCell(a,b.rowSpan,b.colSpan,c=>{ah.Yfi(c);ah.FOf(c)})}static Yfi(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.ykb=!0}static FOf(a){a&&(a.Bb(1),Object(Ya.a)(xI.a,a.currentNode)&&a.Oi())}static pgi(a,b,c){0<b&&(a=Object(qa.a)(yx.TableCellNode,a.currentNode))&&(a.width=c?b:Of.a.qf(b,0))}static Bfi(a,b,c){if(a=Object(qa.a)(Dy.a,a.currentNode))0<b&&(a.$l=
Of.a.Lfa(b,0)),0<c&&(a.wY=Of.a.Lfa(c,0))}static zyf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(Va.a.o1e,ah.zBj[b+""])}static myf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(Za.a.JJc,parseInt(zx.Box4PasteSteward.F7a(b),16))}static Joj(a){const b=new ob.GraphIterator;b.Rc(a);return(a=Xg.OutlineNavigator.Zmd(b))&&jj.OutlineReader.au(b)?a.Mh(Va.a.CR)-a.Mh(Va.a.marginLeft)-a.Mh(Va.a.marginRight):0}static yUj(a){return!(void 0===a||null===a||1===a)}static qal(a,
b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=te.a.Gid(.25);break;case "initial":case "medium":b=te.a.Gid(.5);break;case "thick":b=te.a.Gid(1);break;default:b=ah.Slj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static EVe(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,ah.yBj[b+""])}static pal(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(zx.Box4PasteSteward.F7a(b),16))}static Slj(a,b,c){let f=0;const l=({unit:a}=zx.Box4PasteSteward.Jhd(a)).returnValue;
switch(a){case 5:f=te.a.Gid(l);break;case 1:f=te.a.xri(l);break;case 3:f=te.a.yeg(l);break;case 7:f=Of.a.oGk(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static Tlj(a,b){let c=0;const f=({unit:a}=zx.Box4PasteSteward.Jhd(a)).returnValue;switch(a){case 5:c=te.a.GH(f);break;case 1:c=te.a.yri(f);break;case 3:c=te.a.UW(f);break;case 7:c=Of.a.qf(f,b)}return c}static Zod(a,b,c,f,l,w,H){if(l&&(!H||16===l.vi||H||14!==l.vi)&&12!==c){if(H)switch(f){case 7:f=Va.a.lBh;var U=Va.a.nBh;var ja=Va.a.mBh;
var wa=0;break;case 6:f=Va.a.iBh;U=Va.a.kBh;ja=Va.a.jBh;wa=1;break;case 0:f=Va.a.ZAh;U=Va.a.aBh;ja=Va.a.$Ah;wa=0;break;case 5:f=Va.a.fBh;U=Va.a.hBh;ja=Va.a.gBh;wa=1;break;default:return}else switch(f){case 7:f=Va.a.Kul;U=Va.a.Mul;ja=Va.a.Lul;wa=0;break;case 6:f=Va.a.Hul;U=Va.a.Jul;ja=Va.a.Iul;wa=1;break;case 0:f=Va.a.Bul;U=Va.a.Dul;ja=Va.a.Cul;wa=0;break;case 5:f=Va.a.Eul;U=Va.a.Gul;ja=Va.a.Ful;wa=1;break;default:return}void 0!==l.currentNode&&null!==l.currentNode&&(ah.yUj(c)?(ah.pal(f,a,l),ah.EVe(U,
c,l),ah.qal(ja,b,c,wa,l)):w||H||l.currentNode.properties.setValue(U,"nil"))}}static $qh(a,b,c,f,l,w){f||(ah.gyf(b,a,!1,!1),ah.CRd(b,a,!0,!1));f===w-1&&ah.CRd(b,a,!0,!1);c||ah.xyf(b,a,!0,!1);c===l-1&&ah.ayf(b,a,!0,!1)}static Zxf(a,b,c,f){a&&(ah.xyf(a,b,c,f),ah.CRd(a,b,c,f),ah.ayf(a,b,c,f),ah.gyf(a,b,c,f))}static xyf(a,b,c,f){ah.Zod(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static CRd(a,b,c,f){ah.Zod(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,f)}static ayf(a,b,
c,f){ah.Zod(a.borderBottomColor,a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static gyf(a,b,c,f){ah.Zod(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static $od(a,b,c){if(c&&16===c.vi&&""!==a){switch(b){case 3:b=Va.a.cOb;var f=0;break;case 2:b=Va.a.bOb;f=1;break;case 0:b=Va.a.ZNb;f=0;break;case 1:b=Va.a.$Nb;f=1;break;default:return}(a=ah.Tlj(a,f))&&c.currentNode.properties.setValue(b,a)}}static lfi(a,b){b&&(ah.kgi(b,a),ah.Sfi(b,a),ah.mfi(b,a),ah.Gfi(b,a))}static kgi(a,b){ah.$od(a.qri,
3,b)}static Sfi(a,b){ah.$od(a.pri,2,b)}static mfi(a,b){ah.$od(a.nri,0,b)}static Gfi(a,b){ah.$od(a.ori,1,b)}}ah.bpk=8;ah.nLi="Table Grid";ah.NTh=pa.a.SH("MsoNormalTable","Normal Table","MsoTableGrid",ah.nLi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1",
"MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4",
"Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1",
"Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4",
"Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5",
"MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6",
"MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2",
"List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6",
"List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2",
"MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4",
"List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5",
"List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");ah.QTh=pa.a.SH("0","center","1","top","2","center","3","bottom");ah.PTh=pa.a.SH("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(n.a)(ah,"Box4TableStewardHelper",null,[]);class Ax{constructor(a,b,c,f=!1,l=!1,w=!1){this.Xv=null;this.l4a=0;this.Ab=a;this.fq=b;this.Rq=c;this.Hqb=f;this.JVb=l;this.EId=
w}wsb(a){this.Xv=a}get Mca(){return 0<this.l4a}tY(a){Ue.a(7869459,307,!!this.Xv);Ue.a(7869460,307,fe.OutlineElementReader.$g(this.Ab)||jj.OutlineReader.au(this.Ab));Ue.c(38563978,307,50,"Table pasting started");this.Xv.BGb(!0);const b=new ob.GraphIterator;b.Rc(this.Ab);Object(qa.a)(String,ah.tBj[a.bAh]);const c=this.Rq.YTk(this.Ab,a.HY,a.$ra,this.Xv.YSa(a),a.Ehg);if(this.Hqb&&(Ue.c(23938568,307,50,a.HQa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.l1e&&ah.Zxf(a.l1e,this.Ab,
!1,!0),ah.Bfi(this.Ab,a.vee.vql,a.vee.uql),a.HQa)){var f=0;const U=Array(a.HQa.length);var l=0;a.HFa&&R.a.instance.ga(63)&&(l=(l=te.a.RFh(ah.Joj(this.Ab)))?l:1);for(var w=0;w<a.HQa.length;w++)U[w]=0<l?l/100*a.HQa[w]:Of.a.qf(a.HQa[w],0),f+=U[w];l=c.eb(Za.a.$u);var H=new ob.GraphIterator;H.Rc(this.Ab);a=0;if(Ie.isInTableCell(H)){if(l=Rd.returnToContainingCell(H))a=l.width;w=xn.a(H);H=Rd.returnToContainingTable(H);if(-1!==w&&w<=H.KQa.length){let ja=0;for(let wa=w;wa<w+l.colSpan&&wa<H.KQa.length;wa++)ja+=
H.KQa[wa];a=Math.min(a,ja);a===ja&&(a-=Of.a.qf(ah.bpk,0))}}else if(l)for(w=0;w<l.length;w++)a+=l[w];if(0<a&&f>a&&f)for(f=a/f,a=0;a<U.length;a++)U[a]*=f;c.setValue(Za.a.$u,U)}this.Xv.YHc(b,!1);this.l4a++;R.a.instance.ga(63)&&rb.ListReader.vk(b)&&this.Xv.Qtd(b.currentNode);Ue.a(7869461,307,hd.TableReader.eq(this.Ab))}qY(){Ue.a(7869462,307,!!this.Xv);Ue.a(7869463,307,ok.l(this.Ab));Ue.c(38563979,307,50,"Table pasting finished");Pa.OutlineElementNavigator.Re(this.Ab);this.l4a--}sY(a){Ue.a(7869464,307,
!!this.Xv);hd.TableReader.eq(this.Ab)?Rd.moveToFirstRow(this.Ab):ok.l(this.Ab)&&Rd.moveToNextRow(this.Ab);this.Hqb&&a.height&&this.Ab.currentNode.setValue(Va.a.tu,Of.a.qf(a.height,1));Ue.a(7869465,307,ok.l(this.Ab))}rY(){Ue.a(7869466,307,!!this.Xv);Ue.a(7869467,307,Ie.isTableCell(this.Ab));Rd.returnToContainingRow(this.Ab)}pY(a){Ue.a(7869468,307,!!this.Xv);Ue.a(7869469,307,!this.Xv.yM);ok.l(this.Ab)?Rd.moveToFirstColumn(this.Ab):Ie.isTableCell(this.Ab)?Rd.moveToNextColumn(this.Ab):Ue.a(7869471,307,
!1);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");if(this.JVb){if(!this.Ab.currentNode)return;var b=Object(qa.a)(yx.TableCellNode,this.Ab.currentNode);Ue.a(50689760,307,!b&&16!==this.Ab.currentNode.type||!!b&&16===this.Ab.currentNode.type);if(!b)return;let c=new ob.GraphIterator;c.Rc(this.Ab);if(!a.colSpan||!a.rowSpan)return;if(a.vAb){ah.iMk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=Rd.returnToContainingTable(c);if(!f)return;f.setValue(Va.a.complexTable,
!0);c.Rc(this.Ab);ah.OLk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.Hqb&&(ah.myf(this.Ab,a.Xqc),ah.zyf(this.Ab,a.verticalAlignment),this.EId&&ah.lfi(this.Ab,a.Hsd));this.JVb&&ah.Zxf(a.v6,this.Ab,!a.colSpan&&!a.rowSpan,!1);this.Hqb&&(this.JVb||(b=new ob.GraphIterator,b.Rc(this.Ab),Rd.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{ah.myf(c,a.Xqc);ah.zyf(c,a.verticalAlignment);ah.$qh(c,a.v6,f,l,a.rowSpan,a.colSpan)})),ah.pgi(this.Ab,a.width,a.HFa));Ue.a(7869472,307,jj.OutlineReader.au(this.Ab))}oY(){Ue.a(7869473,
307,!!this.Xv);Ue.a(7869474,307,fe.OutlineElementReader.$g(this.Ab)||Ie.isTableCell(this.Ab));Rd.returnToCell(this.Ab);Ue.a(7869475,307,0>=this.Xv.yM);this.Xv.NVd()}static get Qh(){return Ax.Fi||(Ax.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}}Ax.Fi=null;Object(n.a)(Ax,"Box4TableSteward",null,[1045,1046]);class fu{constructor(a,b,c){this.Xv=null;this.l4a=0;this.Ab=a;this.fq=b;this.Rq=c}wsb(a){this.Xv=a}get Mca(){return 0<this.l4a}tY(){this.Mca&&(Ue.a(8787101,307,zb.ParagraphReader.el(this.Ab)),
Pa.OutlineElementNavigator.Re(this.Ab));Ue.a(8701086,307,!!this.Xv);Ue.a(8701087,307,fe.OutlineElementReader.$g(this.Ab)||jj.OutlineReader.au(this.Ab));this.l4a++}qY(){Ue.a(8701088,307,!!this.Xv);Pa.OutlineElementNavigator.Re(this.Ab);this.l4a--;if(this.Mca){this.Xv.BGb(!0);const a=fu.Qh.Hca(this.Ab);Ue.a(8787102,307,a===this.Ab.currentNode);Ue.a(8787103,307,zb.ParagraphReader.el(this.Ab))}}sY(a){Ue.a(8701089,307,!!this.Xv);this.Xv.BGb(!0);const b=new ob.GraphIterator;b.Rc(this.Ab);this.Xv.YHc(b,
!1);R.a.instance.ga(63)&&rb.ListReader.vk(b)&&this.Xv.Qtd(b.currentNode);a=fu.Qh.Hca(this.Ab,this.Xv.YSa(a));Ue.a(8701090,307,a===this.Ab.currentNode);Ue.a(8701091,307,zb.ParagraphReader.el(this.Ab))}rY(){Ue.a(8701120,307,!!this.Xv);Ue.a(8701121,307,zb.ParagraphReader.el(this.Ab));Pa.OutlineElementNavigator.Re(this.Ab)}pY(){Ue.a(8701122,307,!!this.Xv);Ue.a(8701123,307,zb.ParagraphReader.el(this.Ab));Ue.a(8701124,307,!this.Xv.yM);var a=this.Ab.currentNode;zb.ParagraphReader.textLength(a)&&(a=Id.a.VQa(a),
this.Xv.characterPropertiesEditor.replaceTextRange(a,", "))}oY(){Ue.a(8701125,307,!!this.Xv);Ue.a(8701126,307,zb.ParagraphReader.el(this.Ab));Ue.a(8701127,307,0>=this.Xv.yM);this.Xv.NVd()}static get Qh(){return fu.Fi||(fu.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}}fu.Fi=null;Object(n.a)(fu,"TextOnlyBox4TableSteward",null,[1045,1046]);class GC{constructor(a,b,c=!1,f=!1,l=!1){this.Zo=a;this.HD=b;this.Hqb=c;this.JVb=f;this.EId=l}create(a,b){return 1===a?new fu(b,this.Zo,this.HD):new Ax(b,
this.Zo,this.HD,this.Hqb,this.JVb,this.EId)}}Object(n.a)(GC,"Box4TableStewardFactory",null,[1029]);class $I{create(){return new nn.a}}Object(n.a)($I,"Factory",null,[996]);var HC=d(1082);class aJ{constructor(){this.$hd=null;this.JKe=0}}Object(n.a)(aJ,"PasteFloatieAnchorData",null,[]);class bJ extends Es{constructor(a,b){super(a,b)}f5b(){return["PasteText"]}}Object(n.a)(bJ,"PasteTextFloatie",Es,[]);class cJ{constructor(a,b,c,f,l,w,H){this.GGg=0;this.jye=this.Ldb=this.Rbd=!1;this.w8j=100;this.Kni=61;
this.Goi="PasteTextControl";this.Fml=(U,ja)=>{this.showFloatie(ja)};this.kOi=(U,ja)=>{this.tC(ja)};this.mVi=()=>{this.AUf()};this.mFl=(U,ja)=>{(null===ja||void 0===ja?0:ja.LYe)&&this.GHh()};this.v3g=()=>{HC.a.instance.keyCode===A.a.cba&&this.AUf()};this.o1=()=>{!this.Ldb&&this.Aea&&this.Aea.isVisible&&this.vKi()};this.mY=()=>{this.C_()||this.tC(new mc(!0))};this.K=a;this.jA=b;this.ajk=c;this.G9c=f;this.pa=l;this.q$c=w;this.Vb=H}get S_(){return this.GGg}set S_(a){this.GGg=a}ZWk(){this.G9c.Yai(this.Fml);
this.G9c.eai(this.kOi);this.G9c.kai(this.mVi);this.G9c.Cai(this.mFl)}$Wk(){this.Rbd||(this.pa.KG(this.mY),this.Vb.wq.mca(this.o1),this.q$c.bQd(this.v3g),this.Rbd=!0)}pDl(){this.Rbd&&(this.pa.PRe(this.mY),this.Vb.wq.xKa(this.o1),this.q$c.v_k(this.v3g),this.Rbd=!1)}G5(a){2===a.behavior&&(a=a.actionId,a!==D.a.bold&&a!==D.a.centerJustify&&a!==D.a.Sr&&a!==D.a.B1&&a!==D.a.fja&&a!==D.a.setItalic&&a!==D.a.leftJustify&&a!==D.a.Pq&&a!==D.a.PH&&a!==D.a.bH&&a!==D.a.strikethrough&&a!==D.a.rightJustify&&a!==D.a.fullJustify&&
a!==D.a.underline&&a!==D.a.Ey&&a!==D.a.rC&&a!==D.a.QM&&a!==D.a.mP&&a!==D.a.subscript&&a!==D.a.superscript&&a!==D.a.font&&a!==D.a.paste&&a!==D.a.O5||this.tC(new mc(!0)))}F5(){}showFloatie(a){this.Aea||(this.Aea=new bJ(this.K.resolve("Common.IReactContextualUILauncher"),this.K.resolve("Common.IExternalUICommandDefinitionMapping")));if((this.Ldb||!this.Aea.isVisible)&&a){var b=a.location?a.location:this.Xwb();b&&(this.Aea.cZe(b,a.Iu),this.$Wk(),this.Ldb=!1)}}tC(a){this.Aea&&(!this.Ldb||this.Aea.isVisible)&&
a&&(this.Aea.tC(),this.Ldb=!0,a.Y3d&&(this.S_=null,this.pDl()))}Xwb(){var a=this.tgj();if(!a||!a.$hd)return null;const b=this.jA.Qd;if(!b)return null;a=this.obj(a,b);if(!a)return null;u.AFrameworkApplication.isRtl&&(a.x-=this.H2f().width);return new Sys.UI.Point(a.x+a.width,a.y+a.height)}tgj(){if(!this.pa||!this.pa.Na||!this.pa.Na.mb)return null;var a=this.pa.Na.mb.Ua;const b=!a.Qa&&!a.Lb;let c=a.node;if(c&&b){do c=this.hhj(c);while(c&&c instanceof Sd.AParagraphNode&&!c.characterData.trim().length)
}let f="";const l=c;l&&(f=l.characterData.length===a.Qa||b?l.characterData.trimEnd():l.characterData.substring(0,a.Qa).trimEnd());a=l?f.length:a.Qa;return Object.assign(new aJ,{$hd:l?l:c,JKe:a})}hhj(a){const b=new ob.GraphIterator;if(!a.anchor)return null;b.set(a);if(!b.Ze())return null;b.Jg(11);return b.Mta()?b.Bb(2):null}H2f(){const a=document.getElementById(this.Goi);if(!a)return null;const b=a.style.visibility,c=a.style.display;a.style.visibility="hidden";a.style.display="";const f=Kd.a.ai(a);
a.style.display=c;a.style.visibility=b;return f}obj(a,b){b=a.$hd.ng(b.Ma);if(!b)return null;let c=null;if(a.$hd instanceof Sd.AParagraphNode){if(!b)return null;try{c=this.ajk.oW(a.JKe,b,0<a.JKe,!1,!1,!1),c.height+=this.Kni}catch(f){c=null}}c||(c=b.getBounds());return c}AUf(){if(!this.Ldb&&this.Aea&&this.Aea.isVisible){var a=document.getElementById("PasteTextFloatie");a&&(a.getAttribute(Bc.a.y6a)||"")===Bc.a.Nia&&a.click()}}C_(){return this.Zz()&&(nb.SelectionEditor.$t(this.pa.Na.mb.Ua)||this.pa.Na.mb.Ua.contextId===
Cb.a.paragraph||this.pa.Na.mb.Ua.contextId===Cb.a.endOfParagraph)}Zz(){if(!this.pa.Na||!this.pa.Na.mb)return!1;const a=this.pa.Na.mb;return!!a&&a.Ua.contextId!==Cb.a.outline&&a.Ua.contextId!==Cb.a.notes}vKi(){if(!this.jye){const a=new Le.a(3,1,this.w8j,()=>{this.GHh();this.jye=!1},215);fm.a.instance.Db(a);this.jye=!0}}GHh(){!this.Ldb&&this.Aea&&this.Aea.isVisible&&(this.tC(new mc(!1)),this.showFloatie(new Vi(1,u.AFrameworkApplication.isRtl)))}}Object(n.a)(cJ,"TextPasteFloatieManager",null,[989,145]);
class dJ{Zb(a){a.register(FC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().oa(()=>new FC(mv.a.mxb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(gC,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().oa(()=>new gC(u.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(QH.ClipboardActor,"Box4.Actors.ClipboardActor").ma().oa(()=>
new QH.ClipboardActor(a.ke("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),Nc.a.instance,a.resolve("Box4.IClipboardDataHelper"),de.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.IUndoManager"),u.AFrameworkApplication.fa));u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&a.register(989,"Box4.ITextPasteFloatieManager").ma().oa(()=>new cJ(a,a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.ITextMetricsAdapter"),a.resolve("Box4.IPasteFloatieEventHandler"),
de.a.instance,a.resolve("Common.PressOnlyKeyEvent"),Pc.App.Kb.Ld));a.register(551,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().oa(()=>new fB(u.AFrameworkApplication.fa));a.register(990,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().oa(()=>new OI(u.AFrameworkApplication.fa,a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),id.a.instance));a.register(991,"Box4.Clipboard.ISystemClipboardAccessManager").ma().oa(()=>
a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(992,"Box4.Actors.ISystemClipboard").ma().oa(()=>new KI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),na.InteractiveViewManager.instance,Pc.App.Kb.Ld,y.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),id.a.instance));a.register(993,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new TH);a.register(994,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>
new PI);a.register(995,"Box4.ISelectionFactory").ma().oa(()=>new YI);a.register(996,"Box4.IRenderOrderGraphIteratorFactory").ma().oa(()=>new $I);a.register(997,"Common.IDomElementContentStateFactory").ma().oa(()=>new xH);a.register(998,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().oa(()=>new eI(de.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),R.a.instance.ga(71)));a.register(AC,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().oa(()=>new AC(a.resolve("Box4.IClipboardDataHelper"),
Pc.App.OD.VS));a.register(999,"Box4.Actors.IClipboardOperationPasteFactory").ma().oa(()=>new cI(Nc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),Lc.a.instance,de.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),a.ke("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(1E3,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new SH(u.AFrameworkApplication.Ta,Nc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),de.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),Ij.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper")));a.register(1001,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().oa(()=>new RH(Nc.a.instance,id.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),u.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(1002,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().oa(()=>new hI(u.AFrameworkApplication.fa));a.register(1003,"Box4.Actors.IClipboardOperationFactory").ma().oa(()=>
new aI(a.resolve("Box4.Actors.InternalClipboard"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.Vqd()&&!(B.a.zT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),Nc.a.instance,Ij.a.instance,id.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),
a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(1004,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().oa(()=>new sI(a.ke("Box4.Actors.IBox4PasteStewardFactory"),a.ke("Box4.Actors.IBox4ImageStewardFactory"),
a.ke("Box4.Actors.IBox4TableStewardFactory"),a.ke("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));a.register(Wh,"Box4.Actors.InternalClipboard").ma().oa(()=>new Wh(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),
Pc.App.lP,a.resolve("Box4.IParagraphIndentationReader"),u.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").Zph,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(1005,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().oa(()=>
new FI(a.resolve("Box4.Actors.InternalClipboard"),new kc.a(()=>Pc.App.Kb.Ld.Dn)));a.register(1006,"Box4.List.IListCommands").ma().oa(()=>new QI(u.AFrameworkApplication.Ta));a.register(Zr,"Box4.Actors.PasteCoordinator").ma().oa(()=>new Zr(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));R.a.instance.ga(78)||a.register(GC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>
new GC(Ab.a.instance.resolve("Box4.List.IListEditor"),Ab.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(sC,"Box4.Actors.ClipboardOperationWordStrategy").ma().oa(()=>new sC(Nc.a.instance,de.a.instance,Pc.App.Jh,Kh.a.instance,R.a.instance.ga(14),R.a.instance.ga(50)));
a.register(pC,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().oa(()=>new pC(u.AFrameworkApplication.fa));a.register(1007,"Box4.Actors.IExternalPasteCssConverter").ma().oa(()=>new iI(u.AFrameworkApplication.fa));a.register(1008,"Box4.ISelectionCommands").ma().oa(()=>new XI(u.AFrameworkApplication.Ta));a.register(1009,"Box4.ITextFormattingCommands").ma().oa(()=>new WI(u.AFrameworkApplication.Ta));a.register(eC,"Box4.Actors.AccessibilityActor").ma().oa(()=>new eC(a.Ja("Box4.Accessibility.IAccessibilityContextManager"),
a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(Bq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().oa(()=>new Bq(a.rb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy")));a.register(DC,"Box4.Actors.ProofingActor").ma().oa(()=>new DC(Ab.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.Ta,()=>Ab.a.instance.resolve("Box4.UI.ILanguageDialog"),Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ab.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
de.a.instance,Ab.a.instance.Ja("Box4.IExternalSelectionManager"),Ij.a.instance,Ab.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Kh.a.instance,Nc.a.instance,Ab.a.instance.resolve("Box4.IContextMenuController"),Ab.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ab.a.instance.Ja("Box4.Actors.IProofingErrorPresenter"),R.a.instance));a.register(EC,"Box4.Actors.StyleActor").ma().oa(()=>new EC(Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ab.a.instance.resolve("Box4.Styles.IStyleEditor"),
AQ.a.instance,Ab.a.instance.resolve("Box4.IFormattingEditor"),vh.ContextSetEditor.instance,Ab.a.instance.resolve("Box4.IInsertionPointFormatting"),Kh.a.instance,Nc.a.instance,Ab.a.instance.resolve("Box4.TextFormattingHelper"),eu.instance));a.register(Dd,"Box4.Actors.TextFormattingActor").ma().oa(()=>new Dd(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),
na.InteractiveViewManager.instance));a.register(fC,"Box4.Actors.AutoCorrectActor").ma().oa(()=>new fC(u.AFrameworkApplication.Ta,Nc.a.instance,()=>Ab.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(n.a)(dJ,"Box4ActorsComponentConfiguration",null,[3]);const CQ=(a,b,c)=>Pc.App.m0d?8:2===c?(a=new Bi.StandardDialog,a.yd=4,a.wya(1),a.Xe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Xe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.Mnl(BQ),32):2,BQ=a=>{1===a&&u.AFrameworkApplication.Ta.processAction(D.a.Y0d,
2)},eJ=(a,b,c)=>{if(Pc.App.m0d)return 8;if(1===c)return b.node.Sa(Za.a.embeddedFileContainer)?32:2;if(2===c&&(b.contextId===Cb.a.view&&b.view.Mb&&(b=b.view.Mb.Qj),Eb.EmbeddedFileReader.ONj(b))){a=Eb.EmbeddedFileReader.G7d(b.node);ui.a.Igl();try{DQ(a)}catch(f){ka.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},DQ=a=>{if(1!==Pc.App.mode||!u.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||u.AFrameworkApplication.fa.ka("IsTeamsSession")&&B.a.zT)window.open(a);
else{var b=(new ue.QueryStringBuilder(a)).fgj(),c=new XMLHttpRequest;c.onloadstart=()=>{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const H=c.response;let U=b;U||(U="GetImage",H.type&&-1!=H.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(ja=>{-1!=H.type.indexOf(ja)&&(U="GetImage."+ja)}));U=decodeURIComponent(escape(U));if(B.a.DT)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(H,U):window.open(a);else{var f=window.URL||window.webkitURL,
l=f.createObjectURL(H),w=document.createElement("a");w.href=l;w.download=U;document.body.appendChild(w);w.click();setTimeout(()=>{document.body.removeChild(w);f.revokeObjectURL(l)},0)}}catch(H){window.open(a)}};c.send()}};var EQ=d(557),Cq=d(1233),zv;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(zv||(zv={}));Object(n.b)("ColorMenuControls",zv);class Bx{constructor(a){this.ZUb=
this.$Ub=null;this.kxc={};this.E2=a}o9b(){this.ZUb=this.$Ub=null}CZf(a,b){if(this.ZUb)return this.ZUb;if(!a)return null;const c=Object.assign(new Tl.a,{Id:String.format("menu{0}Color",this.E2),ExternalId:String.format("{0}Color",this.E2)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.A5h());Array.add(c.MenuSectionList,this.J5h());Array.add(c.MenuSectionList,this.b9h(a,b));Array.add(c.MenuSectionList,this.K8h());return this.ZUb=c}EDi(a,b){if(this.$Ub)return this.$Ub;a=this.CZf(a,b);return this.$Ub=
tj.l(a)}yGc(a,b){zv[a]in this.kxc||(this.kxc[zv[a]]=b)}f9h(a){a.Ksf(Object(F.a)(this,this.o9b,"invalidateMenu"),1)}A5h(){if(!({actionId:b}=this.hud(1)).returnValue)return null;const a=Object.assign(new ek.a,{Id:String.format("{0}Color",this.E2),ControlsId:String.format("{0}.Color.Menu.Controls",this.E2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new kg.a,{Command:b.toString(),LabelText:ha.a.ue(Box4Intl.Box4Strings.L_Automatic),Image16by16:u.AFrameworkApplication.qm,Image16by16Class:wp.getImageClass("Automatic_16x16x32"),
Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});Array.add(a.ControlList,b);return a}J5h(){if(!({actionId:b}=this.hud(2)).returnValue)return null;const a=Object.assign(new ek.a,{Id:String.format("{0}Color",this.E2),ControlsId:String.format("{0}.Color.Menu.Controls",this.E2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new kg.a,{Command:b.toString(),LabelText:ha.a.ue(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:u.AFrameworkApplication.qm,Image16by16Class:wp.getImageClass("NoHighlight_16x16x32"),
Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});Array.add(a.ControlList,b);return a}b9h(a,b){if(!({actionId:f}=this.hud(3)).returnValue)return null;const c=Object.assign(new ek.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.E2),ControlList:[]});var f=Object.assign(new bz.a,{Id:String.format("Theme{0}ColorPicker",this.E2),ExternalId:String.format("Theme{0}ColorPicker",this.E2),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.E2),McuLayout:!0,Command:f.toString(),
Width:10});f.Colors=Bx.Dnj(a,b);Array.add(c.ControlList,f);return c}K8h(){if(!({actionId:b}=this.hud(4)).returnValue)return null;const a=Object.assign(new ek.a,{Id:String.format("{0}Colors",this.E2),ControlsId:String.format("{0}.Color.Menu.Controls",this.E2),Title:ha.a.ue(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new bz.a,{Id:String.format("Standard{0}ColorPicker",this.E2),ExternalId:String.format("Standard{0}ColorPicker",this.E2),Command:b.toString(),Width:10,
Colors:[]});b.Colors=Bx.Ilj();Array.add(a.ControlList,b);return a}hud(a){a=zv[a];return a in this.kxc?{returnValue:!0,actionId:this.kxc[a]}:{returnValue:!1,actionId:0}}static Ilj(){const a=[];a.push(Object.assign(new Cq.a,{Color:"0000C0",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new Cq.a,{Color:"0000FF",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new Cq.a,{Color:"00C0FF",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorOrange),
DisplayColor:"#FFC000"}));a.push(Object.assign(new Cq.a,{Color:"00FFFF",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new Cq.a,{Color:"50D092",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new Cq.a,{Color:"50B000",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new Cq.a,{Color:"F0B000",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorLightBlue),
DisplayColor:"#00B0F0"}));a.push(Object.assign(new Cq.a,{Color:"C07000",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new Cq.a,{Color:"602000",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new Cq.a,{Color:"A03070",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static Dnj(a,b){const c=a.properties.sa(Va.a.themeColors,null);a=a.properties.eb(Va.a.KCh).split(" ");
const f=Array(10);f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=Box4Intl.Box4Strings.l_ThemeLabel5;f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let U=0;6>U;U++)for(let ja=0;10>ja;ja++){var w=10*U+ja,H=c[w];w=w+1<<
24;H=H&4278190080|(H&255)<<16|H&65280|(H&16711680)>>>16;const wa=Bx.eyl(f,U,ja,b[a[ja]],c[ja]);l.push(Object.assign(new Cq.a,{Color:ha.a.jw(w,8),DisplayColor:"#"+ha.a.jw(H,6),Alt:ha.a.ue(wa)}))}return l}static eyl(a,b,c,f,l){if(b){var w=l&255,H=(l&65280)>>>8;l=(l&16711680)>>>16;w=Math.floor((Math.min(Math.min(w,H),l)+Math.max(Math.max(w,H),l))/2);--b;w?255===w?(w=!0,b=[242,217,191,166,127][b]):204<w?(w=!1,b=[229,191,127,64,25][b]):51>w?(w=!0,b=[25,64,127,191,229][b]):(H=[51,102,153],l=[191,127],b=
(w=b<H.length)?H[b]:l[b-H.length]):(w=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(w?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(n.a)(Bx,"ColorMenu",null,[1025]);class er{constructor(a){this.jxc=null;this.zXh=a}get pYf(){this.jxc||(this.jxc=new Bx(er.vwi),this.kGj(this.jxc));return this.jxc}kGj(a){a.yGc(1,D.a.sW);a.yGc(3,D.a.Sr);
a.yGc(4,D.a.Sr);a.yGc(5,D.a.Sr);a.f9h(this.zXh)}wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.pIb,Cb.a.view,Object(F.a)(this,this.pIb,"populateFontColor"));a.le(D.a.pIb,1127)}pIb(a,b,c,f,l){if(1===c)return 32;if(2===c&&!l)return 8;a=er.Jk.Tfj(b);if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp){b=this.pYf.CZf(a,Pc.App.oHf);if(!b)return 8;l.MenuItems=b}a=this.pYf.EDi(a,Pc.App.oHf);if(!a)return 8;l.PopulationXML=a;return 32}static raj(){return new er(EQ.a.instance)}static get instance(){return er.Nt||
(er.Nt=er.raj())}static get Jk(){return Ww.PageReader.instance}}er.vwi="Font";er.Nt=null;Object(n.a)(er,"FontColorActor",null,[]);class wf{constructor(a){this.vha=this.ap=this.z2=null;this.MTb=!1;this.Lg=na.InteractiveViewManager.instance.Qd;this.Sj=a;wf.GS&&nb.SelectionEditor.ik(a)&&(a=nb.SelectionEditor.iuc(this.Sj),nb.SelectionEditor.ik(a)?this.Sj=a:ka.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=nb.SelectionEditor.UOb(this.Sj);
nb.SelectionEditor.ik(a)&&(this.Sj=a)}get e9(){return this.z2||(this.z2=Ab.a.instance.rb("Box4.IInternalLinkManager"))}get F6(){return this.ap||(this.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get Hfg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}CUf(a,b,c){if(b!==this.Sj.Lb||a!==this.Sj.Qa)a=Od.SelectionFactory.k3(c,a,b),this.Lg.Mb.setSelection(a),this.Sj=nb.SelectionEditor.UOb(a.Ua.clone())}L1f(a){let b,
c,f,l;l=vb.HyperlinkReader.x6b(this.Sj);c=this.Sj.Qa;f=this.Sj.Lb;b="";if(!l.length)return this.vha=a.substring(this.Sj.Qa,this.Sj.Lb),{returnValue:!0,tod:b,BPc:c,CPc:f,ZWc:l};if(l[0].hyperlink){let w,H=0,U=Math.max(0,a.length-1),ja=0;for(let wa=0;wa<l.length;wa++)l[wa].Qa>=H&&({Qa:w,Lb:H}=wf.Yt.p_(this.Sj,l[wa]),U=Math.min(w,U),ja=Math.max(H,ja));c=Math.min(U,c);f=Math.max(ja,f);this.vha=a.substring(c,f);c===U&&(b=l[0].hyperlink.url);return{returnValue:!0,tod:b,BPc:c,CPc:f,ZWc:l}}return{returnValue:!1,
tod:b,BPc:c,CPc:f,ZWc:l}}OXc(a,b){if(this.Lg.uo){var c=wf.Uta?vb.HyperlinkReader.x6b(this.Sj):vb.HyperlinkReader.vC(this.Sj,!0);var f=this.Lg.Mb.Na.mb;if(f){f=f.Ua;zb.ParagraphReader.tm(f)&&(f=Id.a.createTextRange(f.node,0,zb.ParagraphReader.textLength(f.node)));if(wf.GS&&nb.SelectionEditor.ik(f)){var l=nb.SelectionEditor.iuc(f);nb.SelectionEditor.ik(l)?f=l:ka.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=nb.SelectionEditor.UOb(f);
nb.SelectionEditor.ik(l)&&(f=l);0===a||R.a.instance.ga(22)&&32!==u.AFrameworkApplication.Ta.pi(f,D.a.insertHyperlink,1,!0,null,null)||this.tQj(c)||!this.Sj.equals(f)?this.Lg.VR():(fd.a.mark(5562),R.a.instance.ga(50)&&Pc.App.Jh&&Pc.App.Jh.vw&&this.Lg.Mb.sYb(),a=new qf.GraphTransaction(15),a.kd(this.Sj.node),this.Sj.node.YG().graphTransactionOperations.Ria(4),f=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(f,b,c),a.dispose(),fd.a.mark(5563),this.b3())}else ka.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}tQj(a){return wf.Uta?
!1:1<a.length||1===a.length&&(a[0].Qa>this.Sj.Qa||a[0].Lb<this.Sj.Lb)}insertLink(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=vb.HyperlinkReader.qEa(b);var l="";this.e9&&({Whh:l}=this.e9.xEh(b,!1)).returnValue&&(b=l)}this.MTb||(a=wf.hyperlinkEditor.L1k(a));if((!c.length||wf.Uta)&&b)(f=0<c.length)&&wf.Yt.qKb(this.Sj,c),c=!0,wf.EQj&&(c=zb.ParagraphReader.text(this.Sj.node).substring(this.Sj.Qa,this.Sj.Lb)!==a),c&&wf.characterPropertiesEditor.replaceTextRange(this.Sj,a,!0),
c=Id.a.createTextRange(this.Sj.node,this.Sj.Qa,this.Sj.Qa+a.length),wf.hyperlinkEditor.tja(c,b,f,!1),f=Od.SelectionFactory.Sg(this.Sj.node,this.Sj.Qa+a.length);else if(0<c.length){l=c[0];let w;const H=({Qa:c,Lb:w}=wf.Yt.p_(this.Sj,l)).returnValue;if(b)if(l.hyperlink.QTa){if(b!==l.hyperlink.url)if(wf.Sf.KOb){let U=Id.a.createTextRange(this.Sj.node,c,c+a.length);wf.hyperlinkEditor.NQi(U,l.hyperlink,b)}else wf.Yt.PHh(b,H);a!==this.vha&&(wf.Yt.LFe()&&wf.Yt.qKb(this.Sj,H),wf.characterPropertiesEditor.replaceTextRange(Id.a.createTextRange(this.Sj.node,
c,w),a,!0),f=Id.a.createTextRange(this.Sj.node,c,c+a.length),wf.Yt.LFe()&&wf.hyperlinkEditor.tja(f,b,!1),f=Od.SelectionFactory.Sg(this.Sj.node,c+a.length))}else wf.Yt.qKb(this.Sj,H),wf.characterPropertiesEditor.replaceTextRange(Id.a.createTextRange(this.Sj.node,c,w),a,!0),f=Id.a.createTextRange(this.Sj.node,c,c+a.length),wf.hyperlinkEditor.tja(f,b,!1),f=Od.SelectionFactory.Sg(this.Sj.node,c+a.length);else wf.hyperlinkEditor.CM(l.paragraph,l.hyperlink)}f&&this.Lg.Mb.setSelection(f)}static get hyperlinkEditor(){return wf.zn||
(wf.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return wf.gh||(wf.gh=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Sf(){return wf.fd||(wf.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Yt(){return wf.BD||(wf.BD=Ab.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Uta(){null==wf.$1a&&(wf.$1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):
!1);return wf.$1a}static get EQj(){null==wf.nEd&&(wf.nEd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return wf.nEd}static get Wab(){null==wf.L3a&&(wf.L3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return wf.L3a}static get GS(){null==wf.ZM&&(wf.ZM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return wf.ZM}}wf.zn=null;wf.gh=null;wf.fd=
null;wf.BD=null;wf.$1a=null;wf.nEd=null;wf.L3a=null;wf.ZM=null;wf.source="Source";wf.EHf="CommandingInterface";wf.g8a="DisplayText";wf.url="Url";wf.id="InsertLinkDialog";Object(n.a)(wf,"AInsertLinkDialog",null,[106]);class Cx{static get eg(){return ci.a.VA(Cx.En,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Cx.En="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(n.a)(Cx,"InsertLinkDialogHtml",null,[]);class fJ extends wf{constructor(a,b){super(a,b);this.Af=new ci.a;this.Af.ig=wf.id;var c=this.vha="";const f=zb.ParagraphReader.text(this.Sj.node);let l=this.Sj.Qa,w=this.Sj.Lb,H;wf.Uta?{tod:c,BPc:l,CPc:w,ZWc:H}=this.L1f(f):(H=vb.HyperlinkReader.vC(this.Sj,!0),1===H.length&&H[0].Qa<=this.Sj.Qa&&H[0].Lb>=this.Sj.Lb&&H[0].hyperlink?(this.vha=wf.Yt.qTc(a,H[0],f),c=H[0].hyperlink.url):H.length||(this.vha=f.substring(this.Sj.Qa,this.Sj.Lb)));(b=Object(qa.a)(Object,
b))&&(b[wf.source]&&b[wf.source]===wf.EHf||b[wf.url]&&b[wf.g8a])?this.insertLink(b[wf.g8a],b[wf.url],H):(wf.Uta&&H[0]&&this.CUf(l,w,H[0].paragraph),this.Af.eg=Cx.eg,""===c.trim()&&this.Af.Xe(1,this.Hfg),c={["txtLink"]:c,["txtDisplay"]:this.vha},this.Af.ENc=Object(F.a)(this,this.DN,"dialogDefaultEnterKeyHandler"),this.Af.DNc=Object(F.a)(this,this.DN,"dialogDefaultEnterKeyHandler"),this.Af.aj(this.titleText,Object(F.a)(this,this.OXc,"insertLinkDialogHandler"),c),wf.Wab&&(c=document.getElementById("txtLink"),
Yc.a.addHandler(c,sa.a.input,Object(F.a)(this,this.rJa,"onLinkChanged")),Yc.a.addHandler(c,sa.a.change,Object(F.a)(this,this.rJa,"onLinkChanged"))),document.getElementById("txtLink").focus(),wf.GS?0<oe.h(Id.a.TQa(l,w,!1,this.Sj.node)).length&&(this.MTb=!0,document.getElementById("txtDisplay").disabled=!0):1>=H.length&&wf.Yt.hXd(a,H[0],1===H.length)&&(this.MTb=!0,document.getElementById("txtDisplay").disabled=!0))}rJa(){if(this.Af){const a=document.getElementById("txtLink");this.Af.jD(1,!a||!a.value.length||
vb.HyperlinkReader.lne(a.value))}}DN(a){return this.Af?wf.Wab?this.Af.U_f(this.Af.Onb)?this.Af.DN(a):!1:this.Af.DN(a):!1}b3(){if(wf.Wab){const a=document.getElementById("txtLink");a&&(Yc.a.removeHandler(a,sa.a.change,Object(F.a)(this,this.rJa,"onLinkChanged")),Yc.a.removeHandler(a,sa.a.input,Object(F.a)(this,this.rJa,"onLinkChanged")))}this.Af&&(this.Af=null)}}Object(n.a)(fJ,"InsertLinkDialog",wf,[]);class gJ extends wf{constructor(a,b,c){super(a,b);const f=new ci.a(!1,!1,!0),l={};l.displayTextLabel=
Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;l.textDisplayInitialFocus=c;c=this.vha="";const w=zb.ParagraphReader.text(this.Sj.node);let H=this.Sj.Qa,U=this.Sj.Lb,ja;wf.Uta?{tod:c,BPc:H,CPc:U,ZWc:ja}=this.L1f(w):(ja=vb.HyperlinkReader.vC(this.Sj,!0),1===ja.length&&ja[0].Qa<=this.Sj.Qa&&ja[0].Lb>=this.Sj.Lb&&ja[0].hyperlink?(this.vha=wf.Yt.qTc(a,ja[0],w),c=ja[0].hyperlink.url):ja.length||(this.vha=w.substring(this.Sj.Qa,this.Sj.Lb)));(b=Object(qa.a)(Object,
b))&&(b[wf.source]&&b[wf.source]===wf.EHf||b[wf.url]&&b[wf.g8a])?this.insertLink(b[wf.g8a],b[wf.url],ja):(wf.Uta&&ja[0]&&this.CUf(H,U,ja[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.Hfg),f.Xe(1,b),l.txtLink=c,l.txtDisplay=this.vha,wf.GS?0<oe.h(Id.a.TQa(H,U,!1,this.Sj.node)).length&&(this.MTb=!0,l.textDisplayDisabled=!0):1>=ja.length&&wf.Yt.hXd(a,ja[0],1===ja.length)&&(this.MTb=!0,l.textDisplayDisabled=!0),a={["id"]:wf.id,["bodyControls"]:l},f.aj(this.titleText,Object(F.a)(this,
this.OXc,"insertLinkDialogHandler"),a))}b3(){}}Object(n.a)(gJ,"ReactInsertLinkDialog",wf,[]);class gu{constructor(){this.nqa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.IC}UKf(a,b,c){this.nqa?new gJ(a,b,c):new fJ(a,b)}static get instance(){return gu.Ka||(gu.Ka=new gu)}}gu.Ka=null;Object(n.a)(gu,"InsertLinkDialogFactory",null,[421]);class Tk extends ci.a{constructor(a){super();this.JK=a;this.Lg=na.InteractiveViewManager.instance.Qd;this.XDc=this.Lg.Mb.Na.mb;this.u4d=a[0].Qa;this.Pne=
a[a.length-1].Lb;this.ig="InsertMultiParagraphLinkDialog";a=this.iFl();this.showDialog("",a)}showDialog(a,b){ka.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.eg=Cx.eg;""===b.trim()&&this.Xe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.aj(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(F.a)(this,this.OXc,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=
!0;Tk.Wab&&(a=document.getElementById("txtLink"),Yc.a.addHandler(a,sa.a.input,Object(F.a)(this,this.rJa,"onLinkChanged")),Yc.a.addHandler(a,sa.a.change,Object(F.a)(this,this.rJa,"onLinkChanged")))}hide(){if(Tk.Wab){const a=document.getElementById("txtLink");a&&(Yc.a.removeHandler(a,sa.a.change,Object(F.a)(this,this.rJa,"onLinkChanged")),Yc.a.removeHandler(a,sa.a.input,Object(F.a)(this,this.rJa,"onLinkChanged")))}super.hide()}rJa(){const a=document.getElementById("txtLink");this.jD(1,!a||!a.value.length||
vb.HyperlinkReader.lne(a.value))}DN(a){return Tk.Wab?this.U_f(this.Onb)?super.DN(a):!1:super.DN(a)}iFl(){let a;let b;a="";const c=this.JK.length,f=vb.HyperlinkReader.vC(this.JK[0],!1);0<f.length&&({Qa:l,Lb:b}=Tk.Yt.p_(this.JK[0],f[0]),l<=this.JK[0].Qa&&(a=f[0].hyperlink.url),this.u4d=Math.min(this.u4d,l));var l=vb.HyperlinkReader.vC(this.JK[c-1],!1);0<l.length&&({Qa:l,Lb:b}=Tk.Yt.p_(this.JK[c-1],l[l.length-1]),this.Pne=Math.max(this.Pne,b));this.tAl(this.u4d,this.Pne);return a}tAl(a,b){const c=this.JK.length;
if(a!==this.JK[0].Qa||b!==this.JK[c-1].Lb){a=Id.a.Mj(this.JK[0].node,a);a=Od.SelectionFactory.Fu(a);b=Id.a.Mj(this.JK[c-1].node,b);b=Od.SelectionFactory.GN(a,b);a=this.K8f(b.Ua.clone());const f=this.K8f(b.Ye.clone());a&&f&&(this.JK[0]=a,this.JK[c-1]=f,this.Lg.Mb.setSelection(b),this.XDc=b)}}OXc(a,b){if(this.Lg.uo){var c=this.Lg.Mb.Na.mb;if(c)if(c.equals(this.XDc)&&0!==a){a=new qf.GraphTransaction(15);a.kd(this.JK[0].node);for(c=0;c<this.JK.length;c++)this.JK[c].node.YG().graphTransactionOperations.Ria(4);
b=b.txtLink.trim();this.ILi();this.LHj(b);this.hide();a.dispose()}else this.Lg.VR()}}LHj(a){if(a){a=vb.HyperlinkReader.qEa(a);for(let c=0;c<this.JK.length;c++){var b=this.JK[c];if(Tk.GS&&nb.SelectionEditor.ik(b)&&(b=nb.SelectionEditor.iuc(b),!nb.SelectionEditor.ik(b)))continue;b=Id.a.createTextRange(this.JK[c].node,b.Qa,b.Lb);Tk.hyperlinkEditor.tja(b,a,!1)}}}K8f(a){return zb.ParagraphReader.tm(a)&&!nb.SelectionEditor.ZW(a)&&zb.ParagraphReader.textLength(a.node)?Id.a.createTextRange(a.node,0,zb.ParagraphReader.textLength(a.node)):
nb.SelectionEditor.ik(a)?a:null}ILi(){let a=!1;for(const b of this.JK){const c=vb.HyperlinkReader.vC(b,!1);c&&(a=Tk.Yt.qKb(b,c)||a)}}static get Yt(){return Tk.BD||(Tk.BD=Ab.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Sf(){return Tk.fd||(Tk.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Tk.zn||(Tk.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static get GS(){null==Tk.ZM&&(Tk.ZM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return Tk.ZM}static get Wab(){null==Tk.L3a&&(Tk.L3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Tk.L3a}}Tk.BD=null;Tk.fd=null;Tk.zn=null;Tk.ZM=null;Tk.L3a=null;Object(n.a)(Tk,"InsertMultiParagraphLinkDialog",ci.a,[]);class Je{static get ej(){return Kh.a.instance}static get hyperlinkEditor(){return Je.zn||(Je.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Yt(){return Je.BD||(Je.BD=Ab.a.instance.resolve("Box4.IHyperlinkStrategy"))}static er(){return Je.Gm||
(Je.Gm=Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}static get Sf(){return Je.fd||(Je.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get cuc(){return Je.JD||(Je.JD=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get TPb(){null==Je.Wwd&&(Je.Wwd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return Je.Wwd}static get Uta(){null==Je.$1a&&(Je.$1a=u.AFrameworkApplication.fa?
u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return Je.$1a}static get Gjc(){null==Je.a2a&&(Je.a2a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Je.a2a}static get GS(){null==Je.ZM&&(Je.ZM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Je.ZM}static wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.insertHyperlink,Cb.a.view,Je.uyb);a.ya(D.a.insertHyperlink,
Cb.a.Of,Je.insertLink);a.ya(D.a.insertHyperlink,Cb.a.textRange,Je.insertLink);a.le(D.a.insertHyperlink,1028);a.ya(D.a.CM,Cb.a.view,Je.uyb);a.ya(D.a.CM,Cb.a.Of,Je.Bih);a.ya(D.a.CM,Cb.a.textRange,Je.Bih);a.le(D.a.CM,1028);a.ya(D.a.Znd,Cb.a.view,Je.uyb);a.ya(D.a.Znd,Cb.a.Of,Je.nph);a.ya(D.a.Znd,Cb.a.textRange,Je.nph);a.ya(D.a.vJa,Cb.a.view,Je.uyb);a.ya(D.a.vJa,Cb.a.Of,Je.P8g);a.ya(D.a.vJa,Cb.a.textRange,Je.P8g);a.ya(D.a.vJa,Cb.a.image,Je.OJe);a.ya(D.a.vJa,Cb.a.J4b,Je.OJe);a.ya(D.a.D8b,Cb.a.view,Je.uyb);
a.ya(D.a.D8b,Cb.a.Of,Je.linkText);a.ya(D.a.D8b,Cb.a.textRange,Je.linkText);a.le(D.a.D8b,1028);Je.TPb&&a.ya(D.a.vJa,Cb.a.anchoredObject,Je.OJe);a.ya(D.a.yLc,Cb.a.view,Je.uyb)}static uyb(a,b,c,f,l){if(Je.Gjc)return Je.HBj(a,b,c,f,l);if(!b.view.Nh)return 2;var w=b.view.Mb;if(!w||!w.Na||!w.Na.length)return 8;var H=w.Na.mb;let U=H.Ua.clone();if(2===H.length){if(H=H.ga(1),!nb.SelectionEditor.ik(U)||!nb.SelectionEditor.Xl(H)||U.node!==H.node)return 8}else if(2<H.length)return 8;if(w.Na.jH)return 8;zb.ParagraphReader.tm(U)&&
!nb.SelectionEditor.ZW(U)&&(w=U.node,U=Id.a.createTextRange(w,0,zb.ParagraphReader.textLength(w)));return a===D.a.yLc?Je.FJf(b,U,c,f,l):u.AFrameworkApplication.Ta.pi(U,a,c,!0,f,l)}static HBj(a,b,c,f,l){if(!b.view.Nh)return 2;var w=b.view.Mb;if(!w||!w.Na||!w.Na.length||w.Na.jH)return 8;var H=w.Na.mb;if(w=Je.nac(H))H=Je.zae(H.Ua.clone(),!0);else{let U=H.ga(0).clone(),ja=1;for(;ja<H.length&&(!zb.ParagraphReader.textLength(U.node)||nb.SelectionEditor.Xl(U)||Je.GS&&oe.m(U));)U=H.ga(ja).clone(),ja++;H=
Je.zae(U,!1)}return Je.GS&&nb.SelectionEditor.ik(H)&&oe.m(H)||!nb.SelectionEditor.ik(H)&&!w?8:a===D.a.yLc?Je.FJf(b,H,c,f,l):u.AFrameworkApplication.Ta.pi(H,a,c,!0,f,l)}static nac(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua.clone();a=a.ga(1);return nb.SelectionEditor.ik(b)&&nb.SelectionEditor.Xl(a)&&b.node===a.node?!0:!1}return!1}static iIf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=Je.zae(a.ga(f).clone(),!1);if(nb.SelectionEditor.ik(l))Je.GS&&oe.m(l)||Array.add(c,
l);else if(!nb.SelectionEditor.Xl(l)&&!zb.ParagraphReader.tm(l))return{returnValue:!1,BXd:b}}b=Qa.a.wOb(c);return{returnValue:!Je.GS||0<b.length?!0:!1,BXd:b}}static Pfg(a,b,c,f){if(Je.Gjc)return Je.QHj(a,b,c,f);if(!Je.IUd()||!Je.yJc(a)||de.a.instance.Na.jH)return 8;if(Je.TPb&&nb.SelectionEditor.tFa(a))return 2;let l;if(!({hyperlink:l}=Je.oVa(a,!0)).returnValue||Je.iLc())return 8;if(1===b)return 32;if(!l&&nb.SelectionEditor.Tg(a)&&nb.SelectionEditor.qAb(a)&&(b=nb.SelectionEditor.XRa(a,!1))&&(de.a.instance.setSelection(b),
a=b.Ua,Je.iLc()))return 8;gu.instance.UKf(a,c,f);return 32}static QHj(a,b,c,f){var l=de.a.instance.Na.mb;const w=Je.nac(l);if(w)a=[a];else if(!({BXd:a}=Je.iIf(l)).returnValue)return 8;if(!Je.IUd())return 8;for(l=0;l<a.length;l++)if(!Je.yJc(a[l]))return 8;if(de.a.instance.Na.jH)return 8;l=Array(a.length);let H=null;for(let U=0;U<a.length;U++)if(l[U]=a[U],!({hyperlink:H}=Je.oVa(l[U],!0)).returnValue||Je.iLc())return 8;if(f&&!Je.DYj(l[0]))return 8;if(1===b)return 32;if(!H&&1===l.length&&w&&nb.SelectionEditor.Tg(l[0])&&
nb.SelectionEditor.qAb(l[0])&&(b=nb.SelectionEditor.XRa(l[0],!1))&&(de.a.instance.setSelection(b),l[0]=b.Ua,Je.iLc()))return 8;w?gu.instance.UKf(l[0],c,f):new Tk(l,c);return 32}static insertLink(a,b,c,f,l){return Je.Pfg(b,c,l,!1)}static linkText(a,b,c,f,l){return Je.Pfg(b,c,l,!0)}static Bih(a,b,c){if(Je.Gjc)return Je.IYk(a,b,c);if(!Je.yJc(b)||Je.TPb&&nb.SelectionEditor.tFa(b))return 2;let f;if(!({hyperlink:f}=Je.oVa(b,!1)).returnValue)return 2;if(2===c){c=new qf.GraphTransaction(15);try{c.jd=a,c.kd(f.paragraph),
Je.Uta?Je.Qih(b):Je.Yt.CM(b,f)}finally{c&&c.dispose()}}return 32}static IYk(a,b,c){var f=de.a.instance.Na.mb;if(Je.nac(f))b=[b];else if(!({BXd:b}=Je.iIf(f)).returnValue)return 8;if(!Je.IUd())return 8;for(f=0;f<b.length;f++)if(!Je.yJc(b[f]))return 8;if(1===c&&!Je.oVa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!Je.oVa(b[c],!0).returnValue)return 2;c=new qf.GraphTransaction(15);try{let l=b[0];c.jd=a;c.kd(l.node);for(a=0;a<b.length;a++)Je.Qih(b[a])}finally{c&&c.dispose()}}return 32}static Qih(a){const b=
vb.HyperlinkReader.x6b(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Qa>=c){const l=({Lb:c}=Je.Yt.p_(a,b[f])).returnValue;Je.Yt.qKb(a,l)}}static nph(a,b,c){if(Je.TPb&&nd.ImageReader.kzb(b)||!({hyperlink:a}=Je.oVa(b,!1)).returnValue)return 2;2===c&&({Qa:b,Lb:c}=Je.Yt.p_(b,a),de.a.instance.setSelection(Od.SelectionFactory.k3(a.paragraph,b,c)));return 32}static P8g(a,b,c){let f;if(Je.TPb&&({hyperlink:f}=Je.qYj(b)).returnValue)ka.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:f}=Je.oVa(b,!1)).returnValue)return 2;2===c&&Pc.App.R4b(f.hyperlink.url);return 32}static OJe(a,b,c){a=nd.ImageReader.p_(b.node);if(!a)return 2;2===c&&Pc.App.R4b(a);return 32}static FJf(a,b,c,f,l){if(Je.TPb&&nd.ImageReader.kzb(b))return 2;const w=na.InteractiveViewManager.instance.editingView;if(!w.Wl)return 2;let H;if(!({hyperlink:H}=Je.oVa(b,!1)).returnValue)return 2;if(1===c)return 32;({Qa:b,Lb:c}=Je.Yt.p_(b,H));de.a.instance.setSelection(Od.SelectionFactory.k3(H.paragraph,
b,c));var U=w.ownerDocument;c=w.Tn;b=new Dg.a(c);za.a.Cu(c);U=U.createElement("span");c.appendChild(U);U.innerText=H.hyperlink.url;w.NKa();w.Xel();a=u.AFrameworkApplication.Ta.pi(a,D.a.copy,2,!0,f,l);b.restore();return a}static oVa(a,b){let c;c=null;if(nb.SelectionEditor.ik(a)){var f=oe.h(a);const l=Qa.a.all(f,w=>6===w.Wq);if(0<f.length&&(!Je.GS||!l))return{returnValue:!1,hyperlink:c}}if(Je.Uta)return Je.mYj(a,b);f=vb.HyperlinkReader.vC(a,!0);return 1===f.length&&f[0].Qa<=a.Qa&&f[0].Lb>=a.Lb&&f[0].hyperlink?
(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static qYj(a){let b;b=null;return nd.ImageReader.kzb(a)&&(b=vb.HyperlinkReader.sTc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static mYj(a,b){let c;c=null;const f=vb.HyperlinkReader.x6b(a);return f.length?f[0].hyperlink?(c=f[0],a.Qa<f[0].Qa?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static DYj(a){if(nb.SelectionEditor.ik(a)){var b=
oe.h(a),c=Qa.a.all(b,f=>6===f.Wq);if(0<b.length&&!c)return!1}b=vb.HyperlinkReader.vC(a,!0);if(!(1===b.length&&b[0].Qa<=a.Qa&&b[0].Lb>=a.Lb&&b[0].hyperlink))return!1;c=zb.ParagraphReader.text(a.node);a=Je.Yt.qTc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static iLc(){if(Je.Sf.hg)for(let a=0;a<null.count;++a)if(2===null.ga(a).eOl.changeType)return!0;return!1}static IUd(){return Je.Sf.hg?!0:!R.a.instance.ga(45)||!Pc.App.OD.LOb}static yJc(a){return R.a.instance.ga(14)&&
Je.ej.C7a(a)||Je.er()&&Je.er().instance&&Je.er().instance.bX(a)?!1:!0}static zae(a,b){return zb.ParagraphReader.tm(a)&&!nb.SelectionEditor.ZW(a)&&(zb.ParagraphReader.textLength(a.node)||b)?Id.a.createTextRange(a.node,0,zb.ParagraphReader.textLength(a.node)):a}}Je.zn=null;Je.BD=null;Je.Gm=null;Je.fd=null;Je.JD=null;Je.Wwd=null;Je.$1a=null;Je.a2a=null;Je.ZM=null;Object(n.a)(Je,"HyperlinkActor",null,[]);class bh{static get Bv(){return mv.a.mxb}static get jm(){return vh.ContextSetEditor.instance}static get ej(){return Kh.a.instance}static get Wc(){return Nc.a.instance}static er(){return bh.Gm||
(bh.Gm=Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return bh.Yw||(bh.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}static get M5(){return bh.sr||(bh.sr=Ab.a.instance.resolve("Box4.IParagraphReader"))}static get wM(){return bh.DG||(bh.DG=Ab.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get dDk(){return bh.paragraphEditor.Bv}static get Rf(){return bh.Wg||(bh.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}static wb(){const a=u.AFrameworkApplication.Ta;
a.ya(D.a.Ey,Cb.a.view,bh.kyf);a.ya(D.a.Ey,Cb.a.outlineElement,bh.jyf);a.le(D.a.Ey,1028);a.ya(D.a.rC,Cb.a.view,bh.kyf);a.ya(D.a.rC,Cb.a.outlineElement,bh.jyf);a.le(D.a.rC,1028)}static kyf(a,b,c,f,l){var w=b.view;if(!w.Nh)return 2;const H=w.Mb;if(!H)return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.yna}),8;var U=H.Qj;if(!U)return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.noSelection}),8;if(R.a.instance.ga(62)&&1===c)return 32;if(R.a.instance.ga(11)&&bh.jm.esa(bh.YQd,U))return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Z0b}),
8;if(R.a.instance.ga(14)&&bh.ej.jZc(U))return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),8;if(bh.er()&&bh.er().instance&&bh.er().instance.bX(U))return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.externalSelection}),8;U={};U[ni.xpa]=5794;U[ni.wpa]=5795;let ja=2;if(u.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){w=bh.SDf(a===D.a.Ey,b,!0);if(1===c)return w?32:8;w&&(ja=ni.Ahb(a,b,c,f,l,U))}else ja=ni.Ahb(a,b,1,f,l,U),1!==c&&32===ja?(w.Mb.lJe(),w=new qf.GraphTransaction(15),w.kd(b.view.xg),ja=bh.SDf(a===
D.a.Ey,b,!1)?ni.Ahb(a,b,c,f,l,U):8,w.dispose()):1!==c&&8===ja&&(w.Mb.lJe(),bh.uxi(a,b,H));return ja}static SDf(a,b,c){b=b.view.Mb;if(!b||!b.Na.mb)return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.sed}),!1;if(b.Na.jH)return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.JIf}),!1;b=Fi.hta(b.Na,!1);if(!b)return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RPc}),!1;let f=!1;for(let l=0;l<b.length;l++){const w=b.getContext(l),H=new ob.GraphIterator;H.set(w.node);nb.SelectionEditor.Gt(H);if(!fe.OutlineElementReader.$g(H))if(c)continue;
else return bh.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Qca}),!1;if(a?!bh.Bv.dtb(H):!bh.Bv.vJc(H))if(c)continue;else return bh.Wc.Xb(Ld.a.Q2b,{["Reason"]:od.a.qEf}),!1;f=!0}return c?f:!0}static jyf(a,b,c,f,l){if(b.contextId!==Cb.a.outlineElement)return 2;if(R.a.instance.ga(14))if(f=b.clone().A_e(),hd.TableReader.Png(f)){if(bh.ej.Qng(f))return bh.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),8}else if(bh.ej.CFa(f))return bh.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),2;f=new ob.GraphIterator;f.set(b.node);nb.SelectionEditor.Gt(f);
if(!fe.OutlineElementReader.$g(f))return 2;switch(a){case D.a.Ey:b=bh.Bv.dtb(f);break;case D.a.rC:b=bh.Bv.vJc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===D.a.rC&&l&&l.sa(Yd.a.Hzf,!1)&&(c|=2);switch(a){case D.a.Ey:bh.Bv.dib(f,-1,c);break;case D.a.rC:bh.Bv.qNc(f,1)}return 32}static uxi(a,b,c){const f=new qf.GraphTransaction(15);try{f.kd(b.view.xg);b=!0;var l=Fi.hta(c.Na,!1);for(let w=0;w<l.length;w++){const H=l.getContext(w);let U=new ob.GraphIterator;U.set(H.node);nb.SelectionEditor.Gt(U);
if(!fe.OutlineElementReader.$g(U))b=!1;else if(a===D.a.Ey?bh.Bv.dtb(U):bh.Bv.vJc(U))switch(b=!1,a){case D.a.Ey:bh.Bv.dib(U,-1,0);break;case D.a.rC:bh.Bv.qNc(U,1)}}if(b){const w=c.Na.mb;for(c=0;c<w.length;c++){const H=w.ga(c);if(H.al){const U=bh.wM.bxb(H.node),ja=U.vNb;if(a===D.a.Ey?U.VN>ja:U.VN<18*ja){let wa=new ob.GraphIterator;wa.set(H.node);l=ja;l=a===D.a.Ey?U.VN>=2.5*ja?U.VN-2*ja:ja:U.VN<16*ja?U.VN+2*ja:18*ja;bh.dDk.Wjb(wa,1,l)}}}}}finally{f&&f.dispose()}}}bh.Gm=null;bh.Yw=null;bh.sr=null;bh.DG=
null;bh.Wg=null;bh.YQd=nd.ImageReader.jzb;Object(n.a)(bh,"IndentationActor",null,[]);class wg{static get Ude(){return wg.Cob||(wg.Cob=Ab.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return wg.Yw||(wg.Yw=Ab.a.instance.resolve("Box4.IParagraphEditor"))}static get Rq(){return wg.HD||(wg.HD=Ab.a.instance.resolve("Box4.ITableEditor"))}static get ej(){return Kh.a.instance}static get Wc(){return Nc.a.instance}static er(){return wg.Gm||(wg.Gm=Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}static wb(){const a=
u.AFrameworkApplication.Ta;R.a.instance.ga(77)||(a.ya(D.a.leftJustify,Cb.a.table,wg.NRd),a.ya(D.a.centerJustify,Cb.a.table,wg.NRd),a.ya(D.a.rightJustify,Cb.a.table,wg.NRd));a.ya(D.a.leftJustify,Cb.a.view,Ng.Y7);a.ya(D.a.leftJustify,Cb.a.paragraph,wg.Jia);a.ya(D.a.leftJustify,Cb.a.image,wg.$Ba);a.ya(D.a.leftJustify,Cb.a.embeddedFile,wg.$Ba);a.le(D.a.leftJustify,1028);a.ya(D.a.centerJustify,Cb.a.view,Ng.Y7);a.ya(D.a.centerJustify,Cb.a.paragraph,wg.Jia);a.ya(D.a.centerJustify,Cb.a.image,wg.$Ba);a.ya(D.a.centerJustify,
Cb.a.embeddedFile,wg.$Ba);a.le(D.a.centerJustify,1028);a.ya(D.a.rightJustify,Cb.a.view,Ng.Y7);a.ya(D.a.rightJustify,Cb.a.paragraph,wg.Jia);a.ya(D.a.rightJustify,Cb.a.image,wg.$Ba);a.ya(D.a.rightJustify,Cb.a.embeddedFile,wg.$Ba);a.le(D.a.rightJustify,1028);R.a.instance.ga(54)&&(a.ya(D.a.fullJustify,Cb.a.view,Ng.Y7),a.ya(D.a.fullJustify,Cb.a.paragraph,wg.Jia),a.le(D.a.fullJustify,1028),a.ya(D.a.M2b,Cb.a.view,Ng.Y7),a.ya(D.a.M2b,Cb.a.paragraph,wg.Jia),a.le(D.a.M2b,1028),a.ya(D.a.Xac,Cb.a.view,Ng.Y7),
a.ya(D.a.Xac,Cb.a.paragraph,wg.Jia),a.le(D.a.Xac,1028),a.ya(D.a.Rqc,Cb.a.view,Ng.Y7),a.ya(D.a.Rqc,Cb.a.paragraph,wg.Jia),a.le(D.a.Rqc,1028));a.ya(D.a.ula,Cb.a.view,Ng.Y7);a.ya(D.a.ula,Cb.a.paragraph,wg.Jia);a.ya(D.a.ula,Cb.a.image,wg.$Ba);a.le(D.a.ula,1028);a.ya(D.a.bja,Cb.a.view,Ng.Y7);a.ya(D.a.bja,Cb.a.paragraph,wg.Jia);a.ya(D.a.bja,Cb.a.image,wg.$Ba);a.le(D.a.bja,1028);a.ya(D.a.Aoa,Cb.a.view,Ng.Y7);a.ya(D.a.Aoa,Cb.a.paragraph,wg.Jia);a.ya(D.a.Aoa,Cb.a.image,wg.$Ba);a.le(D.a.Aoa,1028);R.a.instance.ga(54)&&
(a.ya(D.a.RDa,Cb.a.view,Ng.Y7),a.ya(D.a.RDa,Cb.a.paragraph,wg.Jia),a.le(D.a.RDa,1028))}static NRd(a,b,c){let f=!0;if(!b)return 8;hd.TableReader.Png(b)?R.a.instance.ga(14)&&wg.ej.Qng(b)?(wg.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),f=!1):wg.er()&&wg.er().instance&&wg.er().instance.bX(b)&&(wg.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.externalSelection}),f=!1):(wg.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.T0d}),f=!1);if(1===c||!f)return f?32:8;b=b.node;switch(a){case D.a.leftJustify:wg.Rq.$J(b,1);break;case D.a.centerJustify:wg.Rq.$J(b,
2);break;case D.a.rightJustify:wg.Rq.$J(b,3)}return 32}static $Ba(a,b,c){if(!({uF:c}=Ng.Guh(c,b)).returnValue)return c;b=b.node;switch(a){case D.a.leftJustify:case D.a.ula:wg.Ude.$J(b,1);break;case D.a.centerJustify:case D.a.bja:wg.Ude.$J(b,2);break;case D.a.rightJustify:case D.a.Aoa:wg.Ude.$J(b,3)}return 32}static Jia(a,b,c,f,l){f=!0;b.contextId!==Cb.a.paragraph?f=!1:R.a.instance.ga(14)&&wg.ej.CFa(b)?(wg.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),f=!1):wg.er()&&wg.er().instance&&wg.er().instance.bX(b)&&
(wg.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;b=b.node;c=zb.ParagraphReader.KN(b);switch(a){case D.a.leftJustify:case D.a.ula:wg.paragraphEditor.$J(b,1===c&&wg.S0c(l)?6:1);break;case D.a.centerJustify:case D.a.bja:wg.paragraphEditor.$J(b,2===c&&wg.S0c(l)?1:2);break;case D.a.rightJustify:case D.a.Aoa:wg.paragraphEditor.$J(b,3===c&&wg.S0c(l)?1:3);break;case D.a.fullJustify:case D.a.RDa:wg.paragraphEditor.$J(b,6===c&&wg.S0c(l)?1:6);break;case D.a.Xac:wg.paragraphEditor.$J(b,
11);break;case D.a.M2b:wg.paragraphEditor.$J(b,7);break;case D.a.Rqc:wg.paragraphEditor.$J(b,13)}return 32}static S0c(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&R.a.instance.ga(110)}}wg.Cob=null;wg.HD=null;wg.Yw=null;wg.Gm=null;Object(n.a)(wg,"JustificationActor",null,[]);class hu{wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.activateRibbonTab,Cb.a.view,Object(F.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.le(D.a.activateRibbonTab,
5);a.ya(D.a.Xog,Cb.a.view,Object(F.a)(this,this.C_j,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}C_j(){u.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Pc.App.OD.VS.Wog();return 32}static get instance(){return hu.Ka||(hu.Ka=hu.wC())}static wC(){return new hu}}hu.Ka=null;Object(n.a)(hu,"RibbonActor",null,[]);class zn{constructor(a,b,c){this.Fqf=!1;this.Ca=a;this.$a=b;this.qzc=c}wb(){this.Ca.ra(G.a.RM,Cb.a.view,Object(F.a)(this,this.qyl,
"touchStartHandler"),4);this.Ca&&this.$a&&(this.$a.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.ra(D.a.yDh,Cb.a.view,Object(F.a)(this,this.JLk,"processImageOnTouchSelection"),4),this.Ca.ra(D.a.zDh,Cb.a.view,Object(F.a)(this,this.ILk,"processImageOnClickSelection"),4)),this.$a.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.ra(G.a.Srl,Cb.a.application,Object(F.a)(this,this.kMk,"processStartPinchToZoom"),4),this.Ca.ra(G.a.pSi,Cb.a.application,Object(F.a)(this,this.BLk,"processEndPinchToZoom"),
4)))}qyl(a,b,c){if(2!==c)return 2;this.Fqf||(this.Fqf=!0);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");B.a.Vj&&u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}JLk(a,b,c,f,l){if(2!==c)return 2;this.idh(l,!0);return 32}ILk(a,b,c,f,l){if(2!==c)return 2;this.idh(l,!1);return 32}idh(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,zn.bDj)){for(a=a.firstChild;a;)this.kdi(a,b),a=a.nextSibling;break}a=a.nextSibling}}kdi(a,b){if(Sys.UI.DomElement.containsCssClass(a,zn.geg)){b&&!Sys.UI.DomElement.containsCssClass(a,zn.iXc)?Sys.UI.DomElement.addCssClass(a,zn.iXc):!b&&Sys.UI.DomElement.containsCssClass(a,zn.iXc)&&Sys.UI.DomElement.removeCssClass(a,zn.iXc);const c="WACImageResizeHandleTouch"+this.Uaj(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}nTc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==zn.geg)return c}return""}Uaj(a){a=this.nTc(a);return""!==a?ha.a.substring(a,20,a.length):""}kMk(a,b,c){if(2!==c)return 2;if(!this.qzc)return 8;this.qzc.GAj();return 32}BLk(a,b,c){if(2!==c)return 2;if(!this.qzc)return 8;this.qzc.u4k();return 32}static ioj(){return new zn(u.AFrameworkApplication.Ta,
u.AFrameworkApplication.fa,ph.GrippersManager.instance)}static get instance(){return zn.Nt||(zn.Nt=zn.ioj())}}zn.geg="WACImageResizeHandles";zn.iXc="WACImageResizeHandlesTouch";zn.bDj="WACImgSelection";zn.Nt=null;Object(n.a)(zn,"TouchInputActor",null,[]);class fr{constructor(a){this.Xs=null;this.HZ=a}get Mn(){return this.Xs||(this.Xs=this.HZ())}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.undoRedo,"undoRedo");a.ra(D.a.undo,Cb.a.view,b,1028);a.ra(D.a.redo,Cb.a.view,b,1028)}undoRedo(a,
b,c,f,l){b=b.view;if(!b.Nh)return fr.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.sed}),8;f=a===D.a.undo?this.Mn.SW:this.Mn.Bka;if(1===c)return f?32:8;if(!f)return ka.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===D.a.undo?"undo":"redo"),fr.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.DCl}),2;c=new qf.GraphTransaction(3);c.kd(b.xg);c.Mjb();a=a===D.a.undo?this.Mn.undo():this.Mn.redo();c.dispose();l&&ph.GrippersManager.instance.L1a(l.Iu);if(a)return 32;fr.Wc.Xb(Ld.a.Q2b,{["Reason"]:od.a.L0g});
return 8}static get instance(){return fr.Ka||(fr.Ka=fr.wC())}static wC(){const a=Ab.a.instance;return new fr(()=>a.resolve("Box4.IUndoManager"),a.ke("Box4.ICoauthCashTelemetry"))}static get Wc(){return Nc.a.instance}}fr.Ka=null;Object(n.a)(fr,"UndoActor",null,[]);class IC{constructor(){this.Da=null}get name(){return"Box4.Actors"}Zb(a){this.Da=a;(new dJ).Zb(a)}init(){this.Da.resolve("Box4.Actors.ClipboardActor").wb();u.AFrameworkApplication.Ta.ya(D.a.ZPi,Cb.a.embeddedFile,CQ);u.AFrameworkApplication.Ta.ya(D.a.Y0d,
Cb.a.embeddedFile,eJ);u.AFrameworkApplication.Ta.ya(D.a.Y0d,Cb.a.I4b,eJ);er.instance.wb();Je.wb();bh.wb();wg.wb();zn.instance.wb();this.Da.resolve("Box4.ISelectAllHandlers").wb();R.a.instance.ga(70)&&this.Da.resolve("Box4.Actors.ProofingActor").wb();hu.instance.wb();const a=this.Da.rb("Box4.IFeatureHelper");a?a.Wqj.continueWith(()=>{this.Ghh()}):this.Ghh();Ec.wb(Pc.App.ULa);this.Da.resolve("Box4.Actors.TextFormattingActor").wb();fr.instance.wb();this.Da.resolve("Box4.Actors.AccessibilityActor").IQe();
this.Da.resolve("Box4.IClipboardCommands");u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&this.Da.resolve("Box4.ITextPasteFloatieManager").ZWk();Pc.App.Kb.updateCommandUI()}Ghh(){R.a.instance.ga(71)&&this.Da.resolve("Box4.Actors.StyleActor").wb()}dispose(){}static main(){v.a.instance.Dc(new IC)}}Object(n.a)(IC,"Box4ActorsPackage",null,[2,3]);class Hm{constructor(a,b){this.s7=this.GWh=null;this.JWh=a;this.kob=b}get pjd(){return this.levelText}get nbc(){return this.GWh}get levelText(){return this.JWh}get listStyle(){return 6}get iE(){return"left"}get rna(){return this.s7}get font(){return this.kob}}
Object(n.a)(Hm,"ListMarkerBullet",null,[416]);class Rf{static get fq(){return Rf.Zo||(Rf.Zo=Ab.a.instance.resolve("Box4.List.IListEditor"))}static get Rf(){return Rf.Wg||(Rf.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return Rf.Jt||(Rf.Jt=Ab.a.instance.resolve("Box4.IInsertionPointFormatting"))}static er(){return Rf.Gm||(Rf.Gm=Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}static get jm(){return vh.ContextSetEditor.instance}static get ej(){return Kh.a.instance}static get Wc(){return Nc.a.instance}static get KL(){return Rf.CK||
(Rf.CK=Ab.a.instance.rb("Box4.List.ListSettings"))}static get $rc(){return Rf.hXb||(Rf.hXb=Ab.a.instance.rb("Box4.List.ISingleLevelListEditor"))}static wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.QM,Cb.a.view,Rf.xZb);a.ya(D.a.QM,Cb.a.outlineElement,Rf.Vrb);a.le(D.a.QM,1036);a.ya(D.a.mP,Cb.a.view,Rf.xZb);a.ya(D.a.mP,Cb.a.outlineElement,Rf.Vrb);a.le(D.a.mP,1036);Rf.Rf.Ubb&&(a.ya(D.a.NYa,Cb.a.view,Rf.xZb),a.ya(D.a.NYa,Cb.a.outlineElement,Rf.Vrb),a.le(D.a.NYa,1036));a.ya(D.a.hyf,Cb.a.view,ac.ActionManager.Ng);
a.ya(D.a.fGf,Cb.a.view,ac.ActionManager.Ng);a.ya(D.a.joinList,Cb.a.view,ac.ActionManager.Ng);a.ya(D.a.rRd,Cb.a.view,ac.ActionManager.Ng);a.ya(D.a.yRd,Cb.a.view,ac.ActionManager.Ng);a.ya(D.a.CAh,Cb.a.view,ac.ActionManager.Ng);a.ya(D.a.DAh,Cb.a.view,ac.ActionManager.Ng);a.ya(D.a.B4e,Cb.a.view,ac.ActionManager.Ng)}static xZb(a,b,c,f,l){if(!b.view.Nh)return 2;const w=Rf.Wc.Wp(D.a.xZb);f.CN=42;f.o3=42;const H={};H[ni.xpa]=5796;H[ni.wpa]=5797;var U=b.view;if(R.a.instance.ga(11)){if(Rf.jm.esa(Rf.ECj,U.Mb.Qj))return Rf.Wc.Xb(Ld.a.xh,
{["Reason"]:od.a.jXd}),w.end(),8;if(Rf.jm.esa(Rf.YQd,U.Mb.Qj))return Rf.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.Z0b}),w.end(),8}if(R.a.instance.ga(14)&&Rf.ej.jZc(U.Mb.Qj))return Rf.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.RD}),w.end(),8;if(Rf.er()&&Rf.er().instance&&Rf.er().instance.bX(b))return Rf.Wc.Xb(Ld.a.xh,{["Reason"]:od.a.externalSelection}),w.end(),8;if(1===c)return w.end(),32;l||(l=new K.DictionaryPropertySet);let ja=null;var wa=2;if(2===c){ja=new qf.GraphTransaction(15);ja.kd(b.view.xg);Rf.Cac=!1;const eb=
Fi.hta(U.Mb.Na,!1);if(!eb)return ja.dispose(),Rf.Wc.Xb(Ld.a.Qja,{["Reason"]:od.a.RPc}),w.end(),8;u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<eb.length&&l.setValue(Yd.a.e0g,null);const ub=l.sa(Yd.a.NT,-1),Ub=l.sa(Yd.a.jE,-1);Rf.KL.jac&&Rf.$rc&&Rf.$rc.fOl(eb);if(Rf.Rf.BAh){var Sa=Rf.vil(ub,Ub,eb);Sa&&(l.setValue(Yd.a.jE,16),l.setValue(Yd.a.eea,0));if(!nb.SelectionEditor.Tg(U.Mb.Qj)&&!Sa&&a!==D.a.NYa&&0<eb.length&&ub){U=new ob.GraphIterator;
Sa=Array(eb.length);for(let cc=0;cc<eb.length;cc++)U.set(eb.getContext(cc).node),Sa[cc]=Rf.Rf.lw(U);Rf.uil(Sa,l)&&(wa=new K.DictionaryPropertySet,wa.setValue(Yd.a.jE,16),wa.setValue(Yd.a.eea,0),wa=ni.P5(a,b,c,f,wa,H,11),u.AFrameworkApplication.Ta.processAction(D.a.DAh,2),ka.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Rf.Cac=!0)}}U=new ob.GraphIterator;U.set(eb.getContext(0).node);U=Rf.Rf.lw(U);Rf.y4j(ub,Ub,U,eb.length)}R.a.instance.ga(63)||R.a.instance.ga(77)?
wa=ni.P5(a,b,c,f,l,H,11):R.a.instance.ga(30)&&(wa=ni.Ahb(a,b,c,f,l,H));32===wa&&l.sa(Yd.a.Hzf,!1)&&(R.a.instance.ga(62)?wa=ni.P5(D.a.rC,b,c,f,l,H,11):R.a.instance.ga(29)?wa=ni.Ahb(D.a.rC,b,c,f,l,H):R.a.instance.ga(76));ja&&ja.dispose();w.end();return wa}static uil(a,b){let c=null;var f=!1;for(let l=a.length-1;0<=l&&(c?(f=a[l],f=-1!==b.sa(Yd.a.NT,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.sa(Yd.a.NT,-3),a=b.sa(Yd.a.jE,
42)!==c.listType||0<a),f||a)?!0:!1}static y4j(a,b,c,f){0>=f||Rf.Cac||(a?c?(c=c.listType,-1===a&&b===c?(u.AFrameworkApplication.Ta.processAction(D.a.B4e,2),ka.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(u.AFrameworkApplication.Ta.processAction(0===b?D.a.yRd:D.a.rRd,2),ka.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(u.AFrameworkApplication.Ta.processAction(0===b?D.a.yRd:D.a.rRd,2),ka.ULS.sendTraceTag(39715534,
393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet")):(u.AFrameworkApplication.Ta.processAction(D.a.B4e,2),ka.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static vil(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new ob.GraphIterator;let f=null;for(let l=c.length-1;0<=l&&!(a.set(c.getContext(l).node),f=Rf.Rf.lw(a));l--);return f&&b===f.listType?!0:!1}static Vrb(a,b,c,f,l){if(b.contextId!==Cb.a.outlineElement)return 2;if(R.a.instance.ga(14)){var w=
b.clone().A_e();if(Rf.ej.CFa(w))return Rf.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.RD}),2}const H=new ob.GraphIterator;H.set(b.node);nb.SelectionEditor.Gt(H);if(!fe.OutlineElementReader.$g(H))return 2;if(1===c)switch(a){case D.a.QM:return 32;case D.a.mP:return 32;case D.a.NYa:return 32;default:return 2}w=Rf.Rf.lw(H);let U=l;if(!U)return 8;!rb.ListReader.qx&&a===D.a.mP&&H.Mta()&&(H.QI(4)||U.setValue(Yd.a.CVa,1),H.lp());Rf.Rf.Ubb?(a===D.a.mP||a===D.a.QM?(U=Rf.fq.zTf(a,U),b=cf.a.yN(U.eb(Yd.a.jE),U.eb(Yd.a.eea))):
b=a===D.a.NYa?cf.a.yN(0,1):null,Rf.RQ(a,U),Rf.Wcl(b,U)):(U=Rf.fq.zTf(a,U),b=cf.a.yN(U.eb(Yd.a.jE),U.eb(Yd.a.eea)));rb.ListReader.qx||(b.yA=U.sa(Za.a.EVa,rk.a.Nw));Rf.cel(U,H);if(!({kab:b}=Rf.fq.Vrb(U,H,b,!1)).returnValue)return Rf.Wc.Xb(Ld.a.Wo,{["Reason"]:od.a.xoe}),2;2===c&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=l.sa(Yd.a.jE,-1),b&&-1!==a&&((l=l.sa(Va.a.X_,"Invalid MultiLevel Type"),w)?0!==b.listType&&1!==b.listType||
Rf.Cac||(u.AFrameworkApplication.Ta.processAction(D.a.CAh,2),ka.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",l)):16===b.listType?(u.AFrameworkApplication.Ta.processAction(D.a.fGf,2),ka.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||Rf.Cac||(u.AFrameworkApplication.Ta.processAction(D.a.hyf,2),ka.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",
a?"Bullet":"Numbering",l))),l=y.FocusManager.instance(),l.Ae.name===O.AppFrame.fnd&&l.iD(E.AFrame.EW));f.CN=b.listType;f.o3=b.listStyle;return 32}static cel(a,b){var c=new ob.GraphIterator;c.Rc(b);(b=c.Bb(2))&&zb.ParagraphReader.ae(b)&&(c=de.a.instance.Na.mb)&&c.Ua&&c.Ua.node===b&&nb.SelectionEditor.u0c(c)&&(Rf.Ybl(a),Rf.Wbl(a))}static Wcl(a,b){b.Sa(Va.a.X_)&&a.Vcl(b.eb(Va.a.X_));a.NT=b.sa(Yd.a.NT,-1);a.Jme?(b=Rf.fdj(a,b),Rf.$dl(a,b)):Rf.fbl(a)}static fbl(a){if(a.G_c)a.pWc&&-1===a.NT||(a.levelText=
"%1.",a.propertySet.Sa(Za.a.Ui)||a.zya(0,1));else if(1===a.listType)a.pWc&&-1===a.NT||(a.font=rk.a.MKi,a.levelText=rk.a.defaultBullet,a.propertySet.Sa(Za.a.Ui)||a.zya(1,6));else return;a.iE="left"}static $dl(a,b){1===a.X_?Rf.jdl(a,b):Rf.kcl(a,b)}static jdl(a,b){a.rna=b.rna}static kcl(a,b){a.levelText=b.levelText;a.G_c?a.zya(0,b.listStyle):(a.font=b.font,a.zya(1,1));a.iE=b.iE}static fdj(a,b){let c=null;2===a.X_?c=a.G_c?Ab.a.instance.rb("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ab.a.instance.rb("Box4.ListMarkerGallery.ListMarkerBulletLoader"):
1===a.X_&&(c=Ab.a.instance.rb("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.uqg.value;a=a.NT+"";a in f||(f=c.O0j);return a in f||!b.Sa(Za.a.font)?f[a]:new Hm(ha.a.fromCharCode(parseInt(a)),b.sa(Za.a.font,""))}static Wbl(a){Rf.insertionPointFormatting.Sa(Za.a.fontColor)&&a.setValue(Za.a.fontColor,Rf.insertionPointFormatting.fontColor())}static Ybl(a){Rf.insertionPointFormatting.Sa(Za.a.fontSize)&&a.setValue(Za.a.fontSize,Rf.insertionPointFormatting.fontSize())}static RQ(a,b){ka.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===D.a.QM?0:a===D.a.mP?1:a===D.a.NYa?2:-1,b.sa(Yd.a.NT,-1))}}Rf.ECj=nd.ImageReader.k$b;Rf.YQd=nd.ImageReader.jzb;Rf.Zo=null;Rf.Wg=null;Rf.Jt=null;Rf.Gm=null;Rf.CK=null;Rf.hXb=null;Rf.Cac=!1;Object(n.a)(Rf,"ListActor",null,[]);var hJ=d(1207);class iu{constructor(){this.KWh=new kc.a(Object(F.a)(this,this.FYd,"createListMarkerDictionary"));this.LWh={}}get uqg(){return this.KWh}get O0j(){return this.LWh}}Object(n.a)(iu,"AListMarkerGalleryLoader",null,[422]);var iJ=
d(1234);class zz extends fx.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(n.a)(zz,"ListGalleryButtonProps",fx.a,[]);class Ts{constructor(a,b,c,f){this.EUb=null;this.FBf="BulletLibraryGallery";this.crk="NumberingLibraryGallery";this.Jok="MultilevelGallery";this.$3a=a;this.MWh=b;switch(a){case 0:this.EUb="BulletStyle";break;case 1:this.EUb="NumberingStyle";break;case 2:this.EUb="MultilevelStyle";break;default:this.EUb="BulletStyle"}this.IVh=f}get P0j(){return this.MWh}Gtf(a){let b;
var c=1;switch(this.$3a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new ek.a,{Id:String.format("msListMarkersPosition{0}",b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var w=0===this.$3a?"Size40by40":"Size48by48";c=Object.assign(new yq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.Y7d(this.$3a),Type:c,Width:6,ElementDimensions:w,GalleryItems:[]});l=this.P0j.uqg.value;w=zq.a(l);const H=Math.min(18,w.length);for(let U=0;U<H;U++){const ja=l[w[U]];this.IVh&&a&&((1===this.$3a||2===this.$3a)&&!ja.nbc||0===this.$3a&&ja.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.X7d(this.EUb+
b+"_"+U,ja,this.$3a))}Array.add(f.ControlList,c);return f}Y7d(a){switch(a){case 0:return this.FBf;case 1:return this.crk;case 2:return this.Jok;default:return this.FBf}}Q2f(a){const b={},c=ea.FontUtils.oja(a.font);b.fontFamily=ea.FontUtils.trb(c,a.font,!0,!1,!1);return b}X7d(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=ha.a.jw(b.levelText.charCodeAt(0),4),f=Ts.KKj(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=b.font+f,l=!0);let w,H;switch(c){case 0:c=
D.a.QM;w=D.a.meh;H=Object.assign(new iJ.a,{Character:b.levelText,Style:this.Q2f(b)});break;case 1:c=D.a.mP;w=D.a.CNk;H=Object.assign(new zz,{LevelInfo:b.nbc});break;case 2:c=D.a.NYa;w=D.a.BNk;H=Object.assign(new zz,{LevelInfo:b.nbc});b.rna&&(f=b.rna.description,l=!0);break;default:c=D.a.QM,w=D.a.meh,H=Object.assign(new iJ.a,{Character:b.levelText,Style:this.Q2f(b)})}H.Id=a;H.Command=c.toString();H.QueryCommand=w.toString();H.Alt=f;H.InnerHTML=ha.a.ue(this.M0j(b));H.ShouldSetTitle=l.toString();return H}M0j(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.K8d(a),this.J8d(a))}K8d(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.pjd===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===Ts.ugg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=ea.FontUtils.oja(a.font);b.append(ea.FontUtils.trb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}J8d(a){return a.pjd}static KKj(a){for(let b=0;b<Ts.$yf.length;b++)if(a===Ts.$yf[b])return!0;return!1}}Ts.ugg="EXYdHRyjlYTe8nDSGfyW";
Ts.$yf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(n.a)(Ts,"ListMarkerGalleryUtility",null,[]);class JC extends iu{constructor(){super();new hJ.a(sB.a.Hn())}FYd(){const a={};a["0"]=new Hm(Box4Intl.Box4Strings.L_ListStyleNone,Ts.ugg);a["1"]=new Hm(String.fromCharCode(61623),"Symbol");a["2"]=new Hm(String.fromCharCode(111),"Courier New");a["3"]=new Hm(String.fromCharCode(61607),"Wingdings");a["4"]=new Hm(String.fromCharCode(9643),"Courier New");a["5"]=new Hm(String.fromCharCode(61611),
"Wingdings");a["6"]=new Hm(String.fromCharCode(61614),"Symbol");a["7"]=new Hm(String.fromCharCode(61483),"Symbol");a["8"]=new Hm(String.fromCharCode(61485),"Symbol");a["9"]=new Hm(String.fromCharCode(9830),"Courier New");a["10"]=new Hm(String.fromCharCode(61664),"Symbol");a["11"]=new Hm(String.fromCharCode(61558),"Wingdings");a["12"]=new Hm(String.fromCharCode(61656),"Wingdings");a["13"]=new Hm(String.fromCharCode(61514),"Wingdings");a["14"]=new Hm(String.fromCharCode(61516),"Wingdings");a["15"]=
new Hm(String.fromCharCode(61692),"Wingdings");a["16"]=new Hm(String.fromCharCode(61691),"Wingdings");a["17"]=new Hm(String.fromCharCode(61553),"Wingdings");return a}}Object(n.a)(JC,"ListMarkerBulletLoader",iu,[]);class Uk{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(n.a)(Uk,"InfoAtLevel",null,[]);class ju{constructor(a){this.s7=a}get font(){return"Calibri"}get listStyle(){return 42}get iE(){return"left"}get rna(){return this.s7}get pjd(){return this.s7?this.KKk():this.MKk()}get nbc(){return this.s7?
this.LKk():null}get levelText(){return""}faj(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}KKk(){let a="";for(let b=0;3>b;b++)a+=this.nEa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',ju.X6d(),a)}LKk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Uk,{textAtLevel:this.$5f(b),styleAtLevel:this.emj(b)}));return a}MKk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
ju.Y6d(),Box4Intl.Box4Strings.L_ListStyleNone)}$5f(a){a=this.s7.gqg[a];for(let b=0;9>b;b++)a=ha.a.replaceAll(a,"%"+(b+1),this.faj(this.s7.l2c[b]));return a}emj(a){const b={};b.fontFamily=6===this.s7.l2c[a]?this.s7.nYf[a]:this.font;return b}nEa(a){const b=this.$5f(a),c=new Sys.StringBuilder;6===this.s7.l2c[a]&&c.append(String.format("font-family:{0};",this.s7.nYf[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static X6d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static Y6d(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(n.a)(ju,"ListMarkerMultilevel",null,[416]);class Az{constructor(a,b,c,f,l){this.gqg=a;this.l2c=b;this.wZj=f;this.nYf=c;this.description=l}}Object(n.a)(Az,"MultilevelDefInfo",null,[]);class jJ{$Di(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),w=Array(9);for(let H=0;9>H;H++)b+="%"+(H+1)+".",c[H]=b,f[H]=1,l[H]="left";return new Az(c,f,w,l,a)}mGi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new Az("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}rDi(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let w=0;9>w;w++)l[w]=String.fromCharCode(a[w]),c[w]=6,f[w]="left";return new Az(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(n.a)(jJ,"MultilevelDefInfoAdaptor",null,[]);class KC extends iu{constructor(){super()}FYd(){const a=new jJ,b={};b["0"]=new ju(null);b["1"]=new ju(a.$Di());b["2"]=new ju(a.mGi());b["3"]=new ju(a.rDi());return b}}Object(n.a)(KC,"ListMarkerMultilevelLoader",iu,[]);
class Ym{constructor(a,b){this.s7=null;this.U3a=a;this.aBc=b}get font(){return"Calibri"}get listStyle(){return this.aBc}get iE(){switch(this.aBc){case 3:case 5:return"right";default:return"left"}}get rna(){return this.s7}get pjd(){switch(this.aBc){case 1:return this.XJa("1","2","3");case 2:return this.XJa("a","b","c");case 3:return this.XJa("i","ii","iii");case 4:return this.XJa("A","B","C");case 5:return this.XJa("I","II","III");case 0:return this.NKk();default:return this.XJa("1","2","3")}}get nbc(){const a=
[],b={};b.fontFamily=ea.FontUtils.oja(this.font);switch(this.aBc){case 1:return a.push(Object.assign(new Uk,{textAtLevel:this.LN("1"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("2"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Uk,{textAtLevel:this.LN("a"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("b"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Uk,{textAtLevel:this.LN("i"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("ii"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Uk,{textAtLevel:this.LN("A"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("B"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Uk,
{textAtLevel:this.LN("I"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("II"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Uk,{textAtLevel:this.LN("1"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("2"),styleAtLevel:b})),a.push(Object.assign(new Uk,{textAtLevel:this.LN("3"),styleAtLevel:b})),a}}get levelText(){return this.U3a}XJa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
Ym.X6d(),this.nEa(a),this.nEa(b),this.nEa(c))}NKk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Ym.Y6d(),Box4Intl.Box4Strings.L_ListStyleNone)}nEa(a){a=this.LN(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}LN(a){return ha.a.replaceAll(this.U3a,"%1",a)}static X6d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static Y6d(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(n.a)(Ym,"ListMarkerNumbering",null,[416]);class LC extends iu{constructor(){super();new hJ.a(sB.a.Hn())}FYd(){const a={};a["0"]=new Ym(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new Ym("%1.",5);a["2"]=new Ym("%1.",4);a["3"]=new Ym("%1.",1);a["4"]=new Ym("%1.",2);a["5"]=new Ym("%1.",3);a["6"]=new Ym("%1)",5);a["7"]=new Ym("%1)",4);a["8"]=new Ym("%1)",1);a["9"]=new Ym("%1)",
2);a["10"]=new Ym("%1)",3);a["11"]=new Ym("(%1)",5);a["12"]=new Ym("(%1)",4);a["13"]=new Ym("(%1)",1);a["14"]=new Ym("(%1)",2);a["15"]=new Ym("(%1)",3);return a}}Object(n.a)(LC,"ListMarkerNumberingLoader",iu,[]);class MC{constructor(){this.Da=null}get name(){return"Box4.ListMarker"}init(){Rf.wb()}dispose(){}Zb(a){this.Da=a;this.Da.register(JC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().oa(()=>new JC);this.Da.register(LC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().oa(()=>new LC);
this.Da.register(KC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().oa(()=>new KC)}static main(){v.a.instance.Dc(new MC)}}Object(n.a)(MC,"Box4ListMarkerPackage",null,[2,3]);class NC{constructor(a){this.Lxd=a}Lig(a){if(!this.Lxd)return!0;a=ig.a.oTc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.Lxd.length;b++)if(a.endsWith(this.Lxd[b]))return!0;return!1}}Object(n.a)(NC,"DomainAllowListManager",null,[]);class kJ{constructor(a,b){this.WZd=null;this.aNd=a;this.url=b}get c6e(){return ig.a.joa(this.url)}get QB(){return this.aNd}L2e(){const a=
{},b=this.QB;a.a=this.c6e;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.WZd;return a}round(a){return Math.round(1E3*a)/1E3}}Object(n.a)(kJ,"PerformanceTimingEntry",null,[]);const lJ=(a,b)=>{const c={};let f=null;switch(a){case 0:f="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:f="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=f;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var fi=d(288);class $r{constructor(a,b=null,c=null){this.yi=a;this.b6e=this;this.ZSh=b||(()=>window.location.href);this.KAd=new NC(c)}run(){if($r.mQa(window.performance))try{const l=
this.ZSh();if($r.o3h.exec(l)&&this.KAd.Lig(l)){var a=new kJ(window.performance.timing,l);gj.a.instance.ZSk(a.QB.fetchStart);gj.a.instance.aTk(a.QB.navigationStart);gj.a.instance.DYa(fi.a.l1i,"connectStart","requestStart");gj.a.instance.DYa(fi.a.r1i,"requestStart","responseStart");gj.a.instance.DYa(fi.a.t1i,"responseStart","responseEnd");this.b6e.Ybb(1,a.L2e());this.yi.jc(fi.a.ODa,a.QB.fetchStart);this.yi.jc(fi.a.p1i,a.QB.domainLookupStart);this.yi.jc(fi.a.WYf,a.QB.domainLookupEnd);this.yi.jc(fi.a.n1i,
a.QB.connectStart);this.yi.jc(fi.a.u1i,a.QB.secureConnectionStart);this.yi.jc(fi.a.m1i,a.QB.connectEnd);this.yi.jc(fi.a.YYf,a.QB.requestStart);this.yi.jc(fi.a.mRc,a.QB.responseStart);this.yi.jc(fi.a.XYf,a.QB.responseEnd-a.QB.responseStart);this.yi.jc(fi.a.s1i,a.QB.responseStart-a.QB.requestStart);var b=0,c=0,f=0;({transferSize:b,M1d:c,g_d:f}=this.oBl(l)).returnValue&&(this.yi.jc(fi.a.v1i,b),this.yi.jc(fi.a.o1i,f),this.yi.jc(fi.a.q1i,c));this.yi.jc(fi.a.$4b,a.QB.navigationStart)}}catch(l){ka.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}oBl(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,M1d:c,g_d:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,M1d:c,g_d:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,M1d:c,g_d:f}}Ybb(a,b){ka.ULS.sendTraceTag(4551815,306,50,lJ(a,b))}static get instance(){return $r.Ka||($r.Ka=new $r(Eg.a.instance,null,u.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?u.AFrameworkApplication.fa.YA("ResourceLoggerDomainAllowList"):null))}static mQa(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}$r.Ka=null;$r.o3h=RegExp("^https?://.*","i");Object(n.a)($r,"PerformanceTimingLogger",
null,[414]);class Us{constructor(a,b){this.WZd=null;this.aNd=a;this.behavior=b;this.url=this.QB.name}get c6e(){return 2===this.behavior?this.url:ig.a.joa(this.url)}get QB(){return this.aNd}L2e(){const a={},b=this.QB;a.a=this.c6e;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(Us.xxb(b,"decodedBodySize"));a.p=this.round(Us.xxb(b,"encodedBodySize"));a.q=this.round(Us.xxb(b,"transferSize"));a.n=this.WZd;return a}round(a){return Math.round(1E3*a)/1E3}static xxb(a,b){return a[b]}}Object(n.a)(Us,"ResourceTimingEntry",null,[450]);class mJ{constructor(a,b=null,c=100){this.y8e=a;this.yEc=b;this.Smb={};this.jPh=
c}fAl(a){var b=a.name.toLowerCase();const c=ig.a.eUc(b);this.g4k(c,b)&&(c in this.Smb?ka.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.xXj(a),b.encodedsize=Us.xxb(a,"encodedBodySize"),b.decodedsize=Us.xxb(a,"decodedBodySize"),this.Smb[c]=b))}g4k(a,b){if(this.y8e)return Array.contains(this.y8e,a);if(this.yEc)for(a=ig.a.YD(b),b=0;b<this.yEc.length;b++)if(this.yEc[b]&&a.endsWith(this.yEc[b]))return!0;
return!1}xXj(a){try{const b=Us.xxb(a,"transferSize");if(void 0!==b&&null!==b)return!b;ka.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.jPh}catch(b){ka.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}NTk(){if(pa.a.Wa(this.Smb))ka.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var a=u.AFrameworkApplication.gT?u.AFrameworkApplication.gT.split(";"):[],b=Object.assign(new Nj.a,{extendedProperties:Sn.a.Uz()});b.extendedProperties.set("Flights",Jc.c(a));this.v4j(b,this.Smb,dg.Health.instance)}}T5d(a){let b=0,c=0,f=0,l=0;const w=this.Smb;for(let U in w){var H=w[U];U.endsWith(".js")&&(H=Object(qa.a)(Object,H),H.responseend<a&&(b+=1,c+=H.decodedsize,l+=H.encodedsize,f+=H.iscached?0:H.encodedsize))}a={};a.filesLoaded=b;a.decodedBytes=c;a.transferredBytes=f;a.encodedBytes=l;
return a}v4j(a,b,c){if(b){var f=0,l=0,w=0,H=0,U=0,ja=0,wa=0,Sa=0,eb=0,ub=0,Ub=0;for(let Fc in b){var cc=b[Fc];try{const Ic=Object(qa.a)(Object,cc);if(!Ic)continue;const Cc=Ic.iscached?Boolean.parse(Ic.iscached.toString()):!1,Ud=Ic.fetchstart?this.parseFloat(Ic.fetchstart.toString()):0,je=(Ic.responseend?this.parseFloat(Ic.responseend.toString()):0)-Ud,Vd=Ic.encodedsize?this.parseFloat(Ic.encodedsize.toString()):0,Ve=Ic.decodedsize?this.parseFloat(Ic.decodedsize.toString()):0;f+=je;H+=Vd;wa+=Ve;ub++;
Cc?(w+=je,ja+=Vd,eb+=Ve,Ub++):(l+=je,U+=Vd,Sa+=Ve)}catch(Ic){ka.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Ic.message)}}a.extendedProperties.set("StaticResources",Jc.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",w.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
H.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",U.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ja.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",wa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Sa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",eb.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",ub.toString());
a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Ub.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(n.a)(mJ,"AppStaticResourceManager",null,[]);class nJ extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(n.a)(nJ,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Av{constructor(a,
b,c=null,f=null,l=100){this.cFd=!1;this.Xm=null;this.zRb=0;this.Pa=new vc.a;this.Zmb=null;this.Jha=!1;this.xqf=0;this.$d=a;this.$$e=0;this.b6e=this;this.KAd=new NC(c);this.FD=b;f&&(this.Zmb=new mJ(null,f,l))}get UAf(){try{return!(void 0===this.FD||null===this.FD)&&!(void 0===this.FD.getEntriesByType||null===this.FD.getEntriesByType)}catch(a){return ka.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get KKi(){return this.$$e}get isActive(){return this.Jha}get C2e(){return this.xqf}Kuf(a){this.Pa.addHandler(Av.t2d,
a)}djh(a){this.Pa.removeHandler(Av.t2d,a)}Zb(a,b){const c=this.C2e!==a;this.xqf=a;this.isActive&&this.$d&&c&&(this.Mg(),this.Db());this.$$e=b}activate(){!this.isActive&&this.UAf&&(this.Db(),this.Jha=!0)}deactivate(a){this.isActive&&(this.Mg(),a&&this.flush(),this.Jha=!1)}flush(){if(this.isActive&&this.UAf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.zRb&&ka.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
a.length-this.zRb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.zRb=0);const c=[];for(let f=this.zRb;f<a.length;f++)this.KAd.Lig(a[f].name)&&(this.Zmb&&this.Zmb.fAl(a[f]),c.push(new Us(a[f],this.KKi)));b||(this.zRb=a.length);this.Pa.raiseEvent(Av.t2d,new nJ(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.b6e.Ybb(0,c[a].L2e());0<c.length&&ka.ULS.sendTraceTag(19506834,
306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){ka.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}Ybb(a,b){ka.ULS.sendTraceTag(4310804,306,50,lJ(a,b))}USk(){this.Zmb.NTk()}T5d(a){return this.Zmb.T5d(a)}Db(){this.$d&&0<this.C2e&&(this.Xm=new Le.a(3,2,1E3*this.C2e,()=>{this.flush()},5),this.$d.Db(this.Xm),this.cFd=!0)}Mg(){this.cFd&&(this.$d.Mg(this.Xm),this.Xm=null,this.cFd=!1)}}Av.t2d="EntriesAvailable";
Object(n.a)(Av,"ResourceTimingLogger",null,[386,414]);class OC{constructor(){this.Da=null}get name(){return"Common.ResourceTiming"}init(){this.Da.resolve("Common.NetworkTiming.IResourceTimingLogger");$r.instance.run()}dispose(){}Zb(a){this.Da=a;let b=null;if(u.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=u.AFrameworkApplication.fa.YA("ResourceLoggerDomainAllowList")}catch(l){ka.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=
[];c.push(ig.a.YD(vp.a.iP).toLowerCase());c.push(ig.a.YD(vp.a.GMb).toLowerCase());const f=u.AFrameworkApplication.fa.Bc("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(386,"Common.NetworkTiming.IResourceTimingLogger").ma().oa(()=>new Av(u.AFrameworkApplication.ye,window.performance,b,c,f))}static main(){v.a.instance.Dc(new OC)}}Object(n.a)(OC,"ResourceTimingPackage",null,[2,3]);class Bv{}Bv.visible="visible";Bv.hidden="hidden";Object(n.a)(Bv,"PlatformVisibilityState",null,[]);var Bz=
d(199);class oJ extends Sys.EventArgs{constructor(a,b){super();this.yif={};this.oYh=a;this.XXh=b}get oldState(){return this.oYh}get newState(){return this.XXh}$ib(a,b){this.yif[a]=b}toString(){return Jc.c(this.yif)}}Object(n.a)(oJ,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class PC{constructor(a,b,c,f){this.vqf=this.sPa=null;this.Yof=!0;this.Pa=new vc.a;this.$d=a;this.fCd=b;this.gaf=c;this.u4h=f;this.ngf=!1;u.AFrameworkApplication.fa&&(this.ngf=u.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),
this.Yof=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.A8e=0;this.uqf=new Date;this.fCd()===Bv.hidden&&this.aKf();$addHandler(window,"focus",Object(F.a)(this,this.X5g,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(F.a)(this,this.rgd,"onPlatformBlurHandler"));$addHandler(document,"freeze",Object(F.a)(this,this.Y5g,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(F.a)(this,this.Z5g,"onPlatformVisibilityChangeHandler"));
this.Yof&&($addHandler(document,"pageshow",Object(F.a)(this,this.rgd,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(F.a)(this,this.rgd,"onPlatformBlurHandler")))}get s6a(){return this.A8e}get isVisible(){return 2!==this.s6a}eHc(a){this.Pa.addHandler("VST",a)}T_k(a){this.Pa.removeHandler("VST",a)}rgd(a){this.POb(a.type,this.Yae())}X5g(a){this.POb(a.type,0)}Y5g(a){3!==this.s6a&&(this.vGf(),this.POb(a.type,2),this.POb(a.type,3),u.AFrameworkApplication.Zg.Olk())}Yae(){return this.fCd()===
Bv.hidden?2:document.hasFocus()?0:1}POb(a,b){const c=this.s6a;this.A8e=b;if(c!==this.s6a){3===c&&this.ngf&&this.G7k();const f=new Date,l=new oJ(c,this.s6a);l.$ib("FromState",Cl[c]);l.$ib("ToState",Cl[b]);l.$ib("OriginatingEvent",a);l.$ib("TimeInState",(+f-+this.uqf).toString());this.uqf=f;this.u4h.Yrg(l);this.Pa.raiseEvent("VST",l)}}Z5g(a){this.fCd()===Bv.hidden?this.sPa?this.$d.Y5(this.sPa,this.gaf):this.aKf():(this.vGf(),this.POb(a?a.type:"",this.Yae()))}dispose(){$removeHandler(window,"focus",
Object(F.a)(this,this.X5g,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(F.a)(this,this.rgd,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(F.a)(this,this.Y5g,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(F.a)(this,this.Z5g,"onPlatformVisibilityChangeHandler"))}vGf(){this.sPa&&(this.$d.Mg(this.sPa),this.sPa=null)}aKf(){this.sPa=new Le.a(4,1,this.gaf,Object(F.a)(this,this.xyj,"handleVisibilityUpdate"),157);this.$d.Db(this.sPa)}xyj(){this.sPa=
null;this.POb("TaskItem",this.Yae())}R5j(a){ka.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.fsg,+new Date-+this.vqf,Bz.SessionStatusManager.instance.Aka)}G7k(){this.vqf=new Date;this.$d.Db(this.P1b(0,"Realtime"));this.$d.Db(this.P1b(1,"AboveNormal"));this.$d.Db(this.P1b(2,"Normal"));this.$d.Db(this.P1b(3,"Background"));this.$d.Db(this.P1b(4,"Low"))}P1b(a,b){return new Le.a(a,1,0,Object(F.a)(this,this.R5j,"logTimeToExecuteTask"),0,b)}}Object(n.a)(PC,
"VisibilityManager",null,[413,106]);class FQ{Yrg(){}}Object(n.a)(FQ,"NullVisibilityManagerTelemetry",null,[412]);class Cz{constructor(){this.Pa=new vc.a}Yrg(a){ka.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new Cz}}Object(n.a)(Cz,"VisibilityManagerTelemetry",null,[412]);class QC{constructor(){this.Da=null}get name(){return"Common.App.VisibilityManager"}init(){this.Da.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=this.Da.rb("Common.App.VisibilityManagement.VisibilityManager");
a&&a.dispose()}Zb(a){this.Da=a;this.Da.register(Cz,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").oa(()=>Cz.create()).ma();this.Da.register(PC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").oa(()=>new PC(u.AFrameworkApplication.ye,()=>window.document.visibilityState,6E4*u.AFrameworkApplication.fa.Bc("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Da.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){v.a.instance.Dc(new QC)}}
Object(n.a)(QC,"VisibilityManagerPackage",null,[2,3]);var GQ=d(1222);class pJ{constructor(a,b){this.S4c=new qd.a;this.V4c=new qd.a;this.WHa=b;this.oWa=a}Mp(a){!a||this.S4c.Gb(a.id)||this.V4c.Gb(a.id)||this.oWa.Mp(a)}shh(a){this.sVk(a)}thh(a){this.uVk(a)}sVk(a){var b=null;this.WHa&&a&&(this.Mp(a),b=b||Object(F.a)(this,this.XHe,"onDragOver"),this.S4c.$(a.id,b),this.oWa.pb(sa.a.drop,a,b))}uVk(a){var b=null;this.WHa&&a&&(this.Mp(a),b=b||Object(F.a)(this,this.YHe,"onDrop"),this.V4c.$(a.id,b),this.oWa.pb(sa.a.o8a,
a,b))}yb(a){this.WHa&&a&&(this.oWa.Zq(a),this.S4c.ga(a.id)&&this.oWa.yb(sa.a.o8a,a,this.S4c.ga(a.id)),this.V4c.ga(a.id)&&this.oWa.yb(sa.a.drop,a,this.V4c.ga(a.id)))}IBj(){this.oWa&&this.oWa.dispose()}YHe(a){a=a.qc;a.preventDefault();a.stopPropagation();return!0}XHe(a){a=a.qc;a.preventDefault();a.stopPropagation();return!0}}Object(n.a)(pJ,"PPTDragDropInputHelper",null,[354]);class RC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}Zb(a){if(!a)throw Error.argumentNull("container");
this.K=a;this.K.register(354,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().oa(()=>new pJ(GQ.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").mRd;a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").shh(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").thh(a)):(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").shh(this.K.resolve("PowerPointWebEditor.AppFrame").c2),
this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").thh(this.K.resolve("PowerPointWebEditor.AppFrame").c2))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").yb(this.K.resolve("PowerPointWebEditor.AppFrame").mRd);this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").IBj()}static main(){v.a.instance.Dc(new RC)}}Object(n.a)(RC,"PPTWebEditorDragDropPackage",null,[2,3]);class qJ{constructor(a){this.HZh=a}cYe(){return Math.random()<this.HZh}}
Object(n.a)(qJ,"RandomSampler",null,[1534]);class rJ{constructor(a){this.SSb=null;this.p1h=a}cZb(a,b){if("ForceSample"===b||this.p1h())this.SSb||(this.SSb=[]),Array.add(this.SSb,a)}getData(){return this.SSb}reset(){this.SSb=null}}Object(n.a)(rJ,"SampleDataAggregator",null,[1527]);var sJ=d(536);class tJ{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=0;this.isCoauth=null}}Object(n.a)(tJ,"PPTEventTimingData",null,[]);class Dq{constructor(){this.TAe=!1;this.i$={};this.fgk=a=>{window.requestAnimationFrame(a)};
this.sCb=[];this.i$.ArrowDown=!0;this.i$.ArrowLeft=!0;this.i$.ArrowRight=!0;this.i$.ArrowUp=!0;this.i$.Backspace=!0;this.i$.Delete=!0;this.i$.End=!0;this.i$.Enter=!0;this.i$.Home=!0;this.i$.PageDown=!0;this.i$.PageUp=!0;this.i$.Tab=!0}trc(a){return a.ctrlKey&&"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.i$}Mli(a){const b={};b.key=this.trc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();
return b}nzh(a){const b=new tJ;b.metadata=this.Mli(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=Dq.GQa?(!Dq.GQa.amIAlone).toString():"null";this.sCb.push(b);this.HWk()}Fzh(a){if(this.sCb.length)for(const b of this.sCb)if(b.timeStamp===a.timeStamp){b.duration=window.performance.now()-a.timeStamp-b.ths;break}}HWk(){this.TAe||(this.fgk(()=>{this.TAe=!1;window.dispatchEvent(sJ.a.instance.create(sa.a.OQd,this.sCb.slice(0,this.sCb.length)));this.sCb=[]}),this.TAe=!0)}keyPressedEventHandlerStart(a){Dq.HZc(a)&&
!this.trc(a)&&this.nzh(a)}keyPressedEventHandlerEnd(a){Dq.HZc(a)&&!this.trc(a)&&this.Fzh(a)}keyDownEventHandlerStart(a){Dq.HZc(a)&&this.trc(a)&&this.nzh(a)}keyDownEventHandlerEnd(a){Dq.HZc(a)&&this.trc(a)&&this.Fzh(a)}static get GQa(){return Dq.eHf||(Dq.eHf=Ab.a.instance.rb("PowerPointWebEditor.ICoauthStateGetter"))}static HZc(a){return!!a&&a.timeStamp<window.performance.now()}}Dq.eHf=null;Object(n.a)(Dq,"PPTEventTimingMeter",null,[352]);class as{constructor(){this.cec=[];this.WDb=this.n8c=this.BHa=
this.S$c=null;this.R$c=0;this.S7c=!1}start(a){if(!this.S7c){Array.clear(this.cec);for(let b=0;b<as.Z4b.length;++b)this.cec.push(0);this.S$c=window.setInterval(Object(F.a)(this,this.Qkh,"reportMeasuredFrames"),1E3*a);this.R$c=window.performance.now();this.D5e(null);$addHandler(window,"visibilitychange",Object(F.a)(this,this.D5e,"updateMeasureCurrentFrameLoop"));this.S7c=!0}}stop(){this.S7c&&($removeHandler(window,"visibilitychange",Object(F.a)(this,this.D5e,"updateMeasureCurrentFrameLoop")),null!=
this.S$c&&(window.clearInterval(this.S$c),this.S$c=null),null!=this.BHa&&(window.cancelAnimationFrame(this.BHa),this.BHa=null),this.Qkh(),this.S7c=!1)}Qkh(){if(null!=this.WDb){var a={};for(var b=0;b<as.Z4b.length;++b)a[as.Z4b[b].toString()]=this.cec[b],this.cec[b]=0;b=window.performance.now();var c={};c.intervalStart=this.R$c;c.duration=b-this.R$c;c.maxFrameLengthMs=this.WDb;c.frameData=a;window.dispatchEvent(sJ.a.instance.create(sa.a.zSe,c));this.WDb=null;this.R$c=b}}D5e(){as.JSj&&null==this.BHa?
(this.n8c=null,this.BHa=window.requestAnimationFrame(Object(F.a)(this,this.uZg,"measureCurrentFrame"))):null!=this.BHa&&(window.cancelAnimationFrame(this.BHa),this.BHa=null)}uZg(a){if(null!=this.n8c){const b=a-this.n8c;if(null==this.WDb||this.WDb<b)this.WDb=b;for(let c=0;c<as.Z4b.length;++c)if(b<as.Z4b[c]){++this.cec[c];break}}this.n8c=a;this.BHa=window.requestAnimationFrame(Object(F.a)(this,this.uZg,"measureCurrentFrame"))}static get JSj(){return"visible"===window.document.visibilityState}}as.Z4b=
[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(n.a)(as,"PPTFrameTimingMeter",null,[353]);class SC{constructor(){this.lhc=this.acc=null;this.TCg=this.ECg=!1}Zb(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&(u.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!B.a.Gj&&(a.register(352,"Common.IEventTimingMeter").ma().oa(()=>new Dq),this.ECg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&
(a.register(353,"Common.IFrameTimingMeter").ma().oa(()=>new as),this.TCg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.ECg){var a=new qJ(u.AFrameworkApplication.fa.Bc("PodEventTimingMeterEventSamplingPercent",0)/100);a=new rJ(Object(F.a)(a,a.cYe,"shouldBeInSample"));const b=Pq.a.LW(16,1,a);this.acc=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};Yc.a.addHandler(window.self,sa.a.OQd,this.acc)}this.TCg&&(this.lhc=b=>{b&&(b=b.rawEvent)&&va.a.J(39706653,
306,50,Jc.c(b.detail))},Yc.a.addHandler(window.self,sa.a.zSe,this.lhc))}dispose(){this.acc&&(Yc.a.removeHandler(window.self,sa.a.OQd,this.acc),this.acc=null);this.lhc&&(Yc.a.removeHandler(window.self,sa.a.zSe,this.lhc),this.lhc=null)}static main(){v.a.instance.Dc(new SC)}}Object(n.a)(SC,"PPTEventTimingMeterPackage",null,[2,3]);var TC=d(456);class uJ{constructor(a){this.gjf=new qd.a(null);this.ASh=a}ga(a){let b;({value:b}=this.gjf.Tf(a)).returnValue||(b=this.ASh(a),this.gjf.$(a,b));return b}}Object(n.a)(uJ,
"MemoizedLookup",null,[1559]);var HQ=d(845),IQ=d(715);class UC{constructor(a){this.GEk=0;this.QO=a}}Object(n.a)(UC,"GraphMergerResponse",null,[]);var JQ=d(322);class VC extends qh.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=this.Source=0}Zk(){return 33}static construct(a,b,c,f,l,w,H,U,ja){const wa=new VC;wa.BaseRevisions=a;wa.TheirRevisions=
b;wa.YourRevisions=c;wa.IgnoreConflictsInLastServerRevision=f;wa.MergeHint=l;wa.ObjectSpaceId=w?M.a(w):null;wa.RequestId=H?M.a(H):null;wa.Source=U;wa.Reason=ja;return wa}}Object(n.a)(VC,"CreateGraphMergeReplayRequest",qh.a,[]);d(838);class Dz{Sa(a){return a.Sa(void 0)}i6f(a,b){return a.sa(b,null)}qUc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new qj.a(a)}l6f(a,b){return a.sa(b,"")}ash(a,b,c){a.setValue(b,c)}}Object(n.a)(Dz,"MergeableObjectUtilities",null,[400]);class KQ{constructor(a,b=null,
c=null){this.HGd=b||new Dz;c||Object(F.a)(this,this.oPi,"doParagraphMergeNoOP")}oPi(a,b){return{LPl:a,KPl:b}}}Object(n.a)(KQ,"GraphMergeSelectionRecordUpdater",null,[]);class vJ{constructor(){this.source=0;this.Su=this.bQb=this.XLa=null;this.jjc=0;this.cXc=!1;this.a0e=0}}Object(n.a)(vJ,"InputState",null,[]);class wJ{constructor(){this.timeout=this.succeeded=this.crash=!1;this.QO=null}}Object(n.a)(wJ,"OutputState",null,[]);class xJ{constructor(){this.xRc=this.Rqd=this.Crc=!1;this.j1a=this.MCl=this.uXi=
this.LEe=this.sGh=this.RVf=this.Wzf=this.XKc=null}}Object(n.a)(xJ,"RuntimeState",null,[]);class yJ{constructor(){this.input=new vJ;this.runtime=new xJ;this.output=new wJ}}Object(n.a)(yJ,"MergeState",null,[]);var cd=d(1104);class Dx{constructor(a,b,c){this.ZZh=a;this.pYh=b;this.YXh=c;this.QDd=new kc.a(Object(F.a)(this,this.Asi,"checkIfDifferent"))}get gJb(){return this.ZZh}get oldValue(){return this.pYh}get newValue(){return this.YXh}get f9(){return!!this.newValue&&!this.oldValue}get isDeleted(){return!this.newValue&&
!!this.oldValue}get Hab(){return this.f9||this.isDeleted||this.QDd.value}Asi(){return this.f9||this.isDeleted?!0:!cd.a.Nyf(this.gJb,this.oldValue,this.newValue)}}Object(n.a)(Dx,"PropertyDiff",null,[]);class Ex{constructor(a,b){this.mYh=a;this.VXh=b;this.QDd=new kc.a(()=>this.vZc(null));this.a_h=new kc.a(Object(F.a)(this,this.zUi,"evaluatePropertyDiffs"))}get fHb(){return this.mYh}get B5(){return this.VXh}get f9(){return!!this.B5&&!this.fHb}get isDeleted(){return!this.B5&&!!this.fHb}get Hab(){return this.f9||
this.isDeleted||this.QDd.value}get KZa(){return this.a_h.value}vZc(a){let b=!1;this.KZa.forEach((c,f)=>{b=f.Hab&&(!a||7!==a.ga(c));return!b});return b}zUi(){const a=new qd.a;var b=this.B5,c=this.fHb;if(this.f9){c=b.bA();for(var f=0;f<c.length;f++){var l=c[f];a.$(cd.a.vb(l),new Dx(l,null,b.yta(l)))}}else if(this.isDeleted)for(b=c.bA(),f=0;f<b.length;f++)l=b[f],a.$(cd.a.vb(l),new Dx(l,c.yta(l),null));else{f=c.bA();for(l=0;l<f.length;l++){var w=f[l];a.$(cd.a.vb(w),new Dx(w,c.yta(w),b.Sa(w)?b.yta(w):
null))}f=b.bA();for(l=0;l<f.length;l++)w=f[l],c.Sa(w)||a.$(cd.a.vb(w),new Dx(w,null,b.yta(w)))}return a}}Object(n.a)(Ex,"MergeableObjectDiff",null,[]);class Fx{constructor(a,b){this.x5=b?a.p7a():a;this.nFc=new Ua.a}egl(a){this.nFc=a}NZg(a){(new Ex(this.x5,a)).KZa.forEach((b,c)=>{c.Hab&&!this.nFc.contains(b)&&(this.nFc.add(b),c.isDeleted?(c=this.x5,c.Sa(cd.a.fta(b))&&c.removeProperty(cd.a.fta(b))):this.x5.aLa(cd.a.fta(b),c.newValue));return!0})}}Object(n.a)(Fx,"PartialMergeResult",null,[]);class zJ extends qh.a{constructor(){super();
this.Location=null}Zk(){return 34}static construct(a){const b=new zJ;b.Location=a;return b}}Object(n.a)(zJ,"PlayGraphMergeReplayRequest",qh.a,[]);class Cv{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.Bqe=new HQ.a;this.Ngk=a;this.Vck=b;this.rXa=c(this.b6b());this.A$j=f;this.B$j=l;this.dad=w;this.V8c=H;this.Dzg=U;this.x$j=Sa;this.y$j=ja;this.z$j=wa}mL(){return(new Date).getTime()}blb(a,...b){return String.format.apply(null,[a].concat(b))}Rwl(a){throw Fa.a.invalidOperation(a);}E$i(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",
a.name,a.message,a.stack)}avj(a,b,c,f){f.$(a,new Fx(b,!1));ka.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",a,c.Ue);return!0}TGl(a,b){const c=new po.a;c.id=Mm.a.$fa;c.aLa(hb.a.cnd,5===b?2:4);a.Ztf(c);a.Ctd().Aya(c.id,4)}h9k(a){var b=!a.output.succeeded&&(this.y$j||a.output.crash),c=!!a.input.XLa&&0<a.input.XLa.length;if(c=this.z$j&&c&&(this.x$j||b)){b=c?ia.a.create():ia.a.nil;c=c?String.format(" [Merge Request Id: {0}]",
b):"";Cv.D4j(a,c);var f,l;({Cii:w,Lwl:f,OMl:l}=this.LHi(a,Object(F.a)(this,this.NLf,"createSerializedRevisionFrom")));c=Cv.Kaj(a);b=VC.construct(w._list,f._list,l._list,a.input.cXc,a.input.jjc,a.input.Su,b,a.input.source,c);var w=a.output.QO;3===c&&0<w.length&&(b.MergedRevision=this.NLf(a.output.QO.last()));a=new JQ.a;a.JH=b;a.status=1;b=this.Bqe.o5b(0,null);b.KZ(a);b.hDa()}}NLf(a){const b=a.nW,c=Pc.App.Kb.Ld.zi;return new IQ.a(a,b,c.Bi,null,c.Boc,c.contextId,b?b.id:ia.a.nil,this.dad,!1,!0)}ndd(a,
b,c,f,l,w,H){c=this.WFi(a,b,f,l,w,H);f=0;const U=c.runtime.Rqd;try{if(U){const ja=a.length?a.getItemAt(a.length-1):null,wa=b.length?b.getItemAt(b.length-1):null;ka.ULS.sendTraceTag(18641173,808,50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",a.length,ja?ja.id:ia.a.nil,ja?ja.nW?ja.nW.id:ia.a.nil:
ia.a.nil,b.length,wa?wa.id:ia.a.nil,wa?wa.nW?wa.nW.id:ia.a.nil:ia.a.nil,l,w,this.V8c,this.Dzg,H)}for(a=!0;f<this.rXa.length&&a;f++)a=(0,this.rXa[f])(c);return new UC(c.output.QO)}catch(ja){const wa=!c.output.timeout;c.output.crash=wa;const Sa=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",wa?"Crashed":"Timed Out",this.E$i(ja),!!c.output.QO);wa?ka.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Sa):ka.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",
Sa);if(c.output.QO)return new UC(c.output.QO);throw ja;}finally{c.output.succeeded?U&&ka.ULS.sendTraceTag(18613138,808,50,this.L5b(c,f,"Succeeded")):c.output.timeout?ka.ULS.sendTraceTag(18641178,808,15,this.L5b(c,f,"Timeout")):c.output.crash?c.output.QO?ka.ULS.sendTraceTag(18613142,808,15,this.L5b(c,f,"Crash - Rejection")):ka.ULS.sendTraceTag(18613144,808,15,this.L5b(c,f,"Crash - Failed")):U&&ka.ULS.sendTraceTag(18613140,808,50,this.L5b(c,f,"Rejection")),this.h9k(c)}}L5b(a,b,c){const f=a.output.QO,
l=f&&f.length?f.getItemAt(f.length-1):null;return this.blb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.mL()-a.input.a0e,b,f?f.length:0,l?l.id:ia.a.nil,l?l.nW?l.nW.id:ia.a.nil:ia.a.nil,a.input.source)}WFi(a,b,c,f,l,w){const H=new yJ,U=H.input;U.XLa=a;U.bQb=b;U.Su=c;U.jjc=f;U.cXc=l;U.a0e=this.mL();U.source=w;a=H.runtime;a.xRc=this.Dzg;a.Crc=!0;a.Rqd=!0;let ja="";a.j1a=wa=>{if(this.V8c){var Sa=this.mL()-U.a0e,eb=
Sa>this.V8c;ja+=this.blb(" ({0}: {1})",wa,Sa);eb&&(H.output.timeout=!0,wa=this.blb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.V8c,wa,Sa,ja),this.Rwl(wa))}};return H}b6b(){return[Object(F.a)(this,this.UBk,"otherAuthorsHaveChangesToMerge"),Object(F.a)(this,this.iQj,"isInputValid"),Object(F.a)(this,this.sGj,"initializeOutputMergeState"),Object(F.a)(this,this.MGj,"initializeRuntimeMergeState"),Object(F.a)(this,this.pBl,"tryObjectMerge"),Object(F.a)(this,
this.A7h,"addMergeResultsToOutput")]}UBk(a){const b=a.input.XLa;a=a.output;return b?b.length?!0:(ka.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),a.QO=b,a.succeeded=!0,!1):(ka.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.QO=b,a.succeeded=!0,!1)}iQj(a){var b=a.input;const c=b.XLa,f=b.bQb,l=b.Su,w=b.jjc;b=b.cXc;a=a.output;if(!f||!f.length)return a.QO=c,!1;let H=!0;if(2!==
w&&1!==w)return a.QO=c,!1;l&&l!==ia.a.nil||(H=!1);c.length<(b?2:1)&&(ka.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",b),H=!1);H||(a.QO=2===w?c:f);return H}MGj(a){var b=a.input,c=b.XLa,f=b.bQb;const l=b.jjc;let w,H;({Kwl:w,NMl:H,XKc:b}=this.Icj(a,c,f,b.cXc));if(!b)return ka.ULS.sendTraceTag(18613185,808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
w.id,H.id),this.Mrg(w,c.length,"TheirChanges"),this.Mrg(H,f.length,"YourChanges"),a.output.QO=2===l?c:f,!1;a.runtime.XKc=b;({KCl:c,sXi:f}=this.fNi(l,w,H));({LCl:b,tXi:c,Dii:f}=Cv.rej(a,c,f,b));a.runtime.Wzf=f;a.runtime.sGh=b;a.runtime.RVf=c;a.runtime.LEe=new qd.a;return!0}Mrg(a,b,c){const f=new qj.a;for(;a;)f.add(a),a=a.nW;const l=new Sys.StringBuilder;l.append(this.blb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",c,b,f.length));let w=f.length,H=0;f.forEach(U=>({Gdg:w,esg:H}=this.z8h(l,
U,f,w,H)).returnValue);ka.ULS.sendTraceTag(18613187,808,50,l.toString())}z8h(a,b,c,f,l){a.append(this.blb(" [{0} {1} {2}]",f,b.nla?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,Gdg:f,esg:l}):{returnValue:!0,Gdg:f,esg:l}}Icj(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.tSc(c);a.runtime.j1a("GetCommonBase");return{Kwl:b,NMl:c,XKc:f}}fNi(a,b,c){2===a?(a=b,b=c):a=c;return{KCl:b,sXi:a}}sGj(a){const b=a.input,c=b.XLa,f=b.bQb;a.output.QO=
(2===b.jjc?c:f).thl();a.runtime.j1a("InitializeOutputMergeState");return!0}A7h(a){var b=a.input.Su;const c=a.runtime.LEe,f=a.output.QO;b=this.XFi(a,f.getItemAt(f.length-1),b,ia.a.create());this.mYi(a,b,c);this.TGl(b,a.input.source);f.add(b);return a.output.succeeded=!0}XFi(a,b,c,f){a.runtime.Rqd&&ka.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",c,f);a=this.Ngk(f);a.Rii(b,c);return a}mYi(a,b,c){a.runtime.Rqd&&ka.ULS.sendTraceTag(18613191,
808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{Mm.a.$fa.equals(f)||b.Ztf(l.x5);return!0})}pBl(a){const b=a.runtime,c=b.Wzf,f=b.sGh,l=b.RVf,w=b.LEe;let H=!0;const U=a.runtime.Crc;let ja=0,wa=0,Sa=0;f.forEach((eb,ub)=>{U&&ka.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",eb,ub.Ue);wa++;50===wa&&(ja++,a.runtime.j1a(this.blb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",ja,Sa)),wa=0);if(Cv.Sol(ub.Ue))return!0;var Ub=l.get(eb);
if(!Ub)return w.Gb(eb)?w.ga(eb).NZg(ub):w.$(eb,new Fx(ub,!1)),!0;if(!c.ga(eb))return H=this.avj(eb,Ub,ub,w);const cc=w.YTc(eb,new Fx(c.ga(eb),!0));({X$:Ub,returnValue:H}=this.B$j.merge(a,this.A$j,this.Vck,cc,Ub,ub));Sa++;H&&(a.runtime.j1a(this.blb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",eb,ub.Ue,Sa,ja)),Ub&&(w.Gb(Ub.x5.id)?w.ga(Ub.x5.id).NZg(Ub.x5):w.$(Ub.x5.id,Ub)));return H});U&&ka.ULS.sendTraceTag(18613199,808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",
f.count,Sa);return H}LHi(a,b){const c=new qj.a,f=new qj.a,l=new qj.a;var w=a.runtime.XKc;const H=w?w.id:ia.a.nil;this.zoe(w).forEach(U=>{c.add(b(U));return!0});w=a.input.XLa.getItemAt(a.input.XLa.length-1);this.zoe(w,H).forEach(U=>{f.add(b(U));return!0});a=a.input.bQb.getItemAt(a.input.bQb.length-1);this.zoe(a,H).forEach(U=>{l.add(b(U));return!0});return{Cii:c,Lwl:f,OMl:l}}zoe(a,b=null){const c=new qj.a;b||(b=ia.a.nil);for(;a&&!b.equals(a.id);)c.add(a),a=a.nW;c.reverse();return c}wb(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static D4j(a,
b){ka.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static Kaj(a){return a.output.crash?2:a.output.succeeded?3:1}static rej(a,b,c,f){let l;({result:l}=b.qdd(f));a.runtime.j1a("GetUnfavoredChanges");let w;new qd.a;({result:w}=c.qdd(f));5===a.input.source&&(a.runtime.uXi=TC.a.u6f(c.Ctd()),a.runtime.MCl=TC.a.u6f(b.Ctd()));b=w;a.runtime.j1a("GetFavoredChanges");f=new uJ(Object(F.a)(f,f.hxb,"getMergeableObject"));a.runtime.j1a("GetModifiedObjects");
return{LCl:l,tXi:b,Dii:f}}static Sol(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(n.a)(Cv,"GraphMerger",null,[1021,351]);class AJ{get YCa(){return 8}get mKa(){return[]}get DMa(){return[cd.a.vb(hb.a.KM),cd.a.vb(hb.a.gtc)]}get uMa(){return[]}get BQa(){return[cd.a.vb(Za.a.TA)]}get lRa(){return[]}lG(a){return 1074135126===a.Ue}s1a(){return!0}get XCa(){return[cd.a.vb(hb.a.cid),cd.a.vb(hb.a.sid)]}get B0a(){return!0}}Object(n.a)(AJ,"CommentContentNodeComplexMerge",
null,[402]);class BJ{get YCa(){return 8}get mKa(){return[]}get DMa(){return[cd.a.vb(hb.a.Ntb),cd.a.vb(hb.a.KWd),cd.a.vb(hb.a.Ltb),cd.a.vb(hb.a.I0b),cd.a.vb(hb.a.AMe),cd.a.vb(hb.a.zMe),cd.a.vb(hb.a.KM),cd.a.vb(hb.a.gtc),cd.a.vb(hb.a.YVd)]}get uMa(){return[cd.a.vb(hb.a.Aca),cd.a.vb(hb.a.csa),cd.a.vb(hb.a.AWd),cd.a.vb(hb.a.J0b),cd.a.vb(hb.a.OKc),cd.a.vb(hb.a.reactions)]}get BQa(){return[]}get lRa(){return[]}lG(a){return 1074135127===a.Ue}s1a(){return!0}get XCa(){return[cd.a.vb(hb.a.cid),cd.a.vb(hb.a.sid),
cd.a.vb(hb.a.commentId),cd.a.vb(hb.a.uxa),cd.a.vb(Va.a.BWd),cd.a.vb(hb.a.CWd),cd.a.vb(hb.a.J0b),cd.a.vb(hb.a.OKc),cd.a.vb(hb.a.reactions)]}get B0a(){return!0}}Object(n.a)(BJ,"CommentNodeComplexMerge",null,[402]);class CJ{constructor(a){this.Oad=a}get YCa(){return 8}get mKa(){return[]}get DMa(){return this.Oad.DMa}get uMa(){return[]}get BQa(){return[cd.a.vb(Za.a.TA)]}get lRa(){return[]}lG(a){return 393326===a.Ue}s1a(){return!0}get XCa(){const a=new Ka.a;Pr.a(a,this.Oad.mKa);Pr.a(a,this.Oad.XCa);Pr.a(a,
this.Oad.uMa);Pr.a(a,[cd.a.vb(hb.a.Vzb),cd.a.vb(hb.a.ved)]);return a.toArray()}get B0a(){return!0}}Object(n.a)(CJ,"NotesContentNodeComplexMerge",null,[402]);class DJ{get YCa(){return 8}get mKa(){return[cd.a.vb(hb.a.EPi),cd.a.vb(hb.a.yPi),cd.a.vb(hb.a.R8b),cd.a.vb(hb.a.bil)]}get DMa(){return[cd.a.vb(hb.a.Frb),cd.a.vb(hb.a.Grb),cd.a.vb(hb.a.Trb),cd.a.vb(hb.a.Urb),cd.a.vb(hb.a.dDa),cd.a.vb(hb.a.FFe),cd.a.vb(hb.a.fFe),cd.a.vb(hb.a.GFe),cd.a.vb(hb.a.CKb),cd.a.vb(hb.a.EKb),cd.a.vb(hb.a.Byb),cd.a.vb(hb.a.Mub),
cd.a.vb(hb.a.nIb)]}get uMa(){return[]}get BQa(){return[cd.a.vb(Za.a.B7a),cd.a.vb(Va.a.appsNode)]}get lRa(){return[]}lG(a){return 393271===a.Ue}get XCa(){return[cd.a.vb(hb.a.presentationId),cd.a.vb(hb.a.slideWidth),cd.a.vb(hb.a.slideHeight),cd.a.vb(hb.a.DY),cd.a.vb(hb.a.raa),cd.a.vb(hb.a.M$a),cd.a.vb(hb.a.kGb),cd.a.vb(hb.a.Q0),cd.a.vb(hb.a.YGb),cd.a.vb(hb.a.ufa),cd.a.vb(hb.a.embeddedFonts),cd.a.vb(hb.a.VJa)]}get B0a(){return!0}s1a(){return!0}}Object(n.a)(DJ,"PresentationNodeComplexMerge",null,[402]);
class EJ{get YCa(){return 8}get mKa(){return[cd.a.vb(hb.a.lKa),cd.a.vb(hb.a.YKb)]}get DMa(){return[cd.a.vb(Za.a.font),cd.a.vb(hb.a.DC),cd.a.vb(hb.a.EJc),cd.a.vb(hb.a.Chb),cd.a.vb(hb.a.KM),cd.a.vb(hb.a.N0a),cd.a.vb(hb.a.Bm),cd.a.vb(hb.a.vZa),cd.a.vb(hb.a.Dyb),cd.a.vb(hb.a.Gka),cd.a.vb(hb.a.D0a),cd.a.vb(hb.a.p1),cd.a.vb(hb.a.vpa),cd.a.vb(hb.a.B2b),cd.a.vb(hb.a.bwb),cd.a.vb(hb.a.bya),cd.a.vb(hb.a.Sya),cd.a.vb(hb.a.Yoa),cd.a.vb(hb.a.Rya),cd.a.vb(hb.a.mediaType),cd.a.vb(hb.a.Chb),cd.a.vb(hb.a.GAb),cd.a.vb(hb.a.c9g),
cd.a.vb(hb.a.e9g),cd.a.vb(hb.a.Fya),cd.a.vb(hb.a.Soa),cd.a.vb(hb.a.Oth),cd.a.vb(hb.a.uqd),cd.a.vb(Za.a.Jl),cd.a.vb(Za.a.gJ),cd.a.vb(hb.a.oCh),cd.a.vb(hb.a.pCh),cd.a.vb(hb.a.jOb),cd.a.vb(hb.a.SLa),cd.a.vb(hb.a.Paa),cd.a.vb(hb.a.utc),cd.a.vb(hb.a.WO),cd.a.vb(hb.a.outlineWidth),cd.a.vb(qi.a.Lnd),cd.a.vb(hb.a.xjd),cd.a.vb(Xl.a.E9b),cd.a.vb(hb.a.vN),cd.a.vb(hb.a.aQ),cd.a.vb(hb.a.gtc),cd.a.vb(hb.a.rNb),cd.a.vb(hb.a.F0a),cd.a.vb(hb.a.ttb),cd.a.vb(hb.a.NAb),cd.a.vb(hb.a.qN),cd.a.vb(hb.a.eyh),cd.a.vb(hb.a.Eyb)]}get uMa(){return[cd.a.vb(hb.a.alt),
cd.a.vb(hb.a.Krb),cd.a.vb(hb.a.Z$),cd.a.vb(hb.a.Fke),cd.a.vb(hb.a.one),cd.a.vb(hb.a.Mka),cd.a.vb(hb.a.shapeType),cd.a.vb(hb.a.kOb),cd.a.vb(hb.a.rotation),cd.a.vb(hb.a.Gpc),cd.a.vb(hb.a.Sca),cd.a.vb(hb.a.Rca),cd.a.vb(Za.a.wx),cd.a.vb(Za.a.JC),cd.a.vb(Za.a.Ay),cd.a.vb(Za.a.By),cd.a.vb(hb.a.aQb),cd.a.vb(hb.a.kyb),cd.a.vb(hb.a.g7e),cd.a.vb(hb.a.h7e),cd.a.vb(hb.a.W2),cd.a.vb(hb.a.kP),cd.a.vb(hb.a.Tia),cd.a.vb(hb.a.Sia),cd.a.vb(hb.a.Via),cd.a.vb(hb.a.Uia),cd.a.vb(hb.a.k_e),cd.a.vb(hb.a.rqd),cd.a.vb(hb.a.aga),
cd.a.vb(hb.a.tqd),cd.a.vb(hb.a.Lua),cd.a.vb(hb.a.sHc)]}get BQa(){return[cd.a.vb(Za.a.TA)]}get lRa(){return[]}lG(a){return 1074135132===a.Ue}s1a(){return!0}get XCa(){return[cd.a.vb(hb.a.cid),cd.a.vb(hb.a.sid),cd.a.vb(hb.a.shapeId),cd.a.vb(hb.a.RUa),cd.a.vb(hb.a.oZa),cd.a.vb(hb.a.bJa),cd.a.vb(hb.a.TMj),cd.a.vb(hb.a.FL),cd.a.vb(hb.a.isResizable),cd.a.vb(hb.a.isEditable),cd.a.vb(hb.a.Eua),cd.a.vb(hb.a.VI),cd.a.vb(hb.a.Jj),cd.a.vb(hb.a.SU),cd.a.vb(hb.a.DRa),cd.a.vb(hb.a.ERa),cd.a.vb(hb.a.K$a),cd.a.vb(hb.a.oac),
cd.a.vb(hb.a.hasText),cd.a.vb(hb.a.wT),cd.a.vb(hb.a.hr),cd.a.vb(hb.a.isConnected),cd.a.vb(hb.a.If),cd.a.vb(hb.a.sFa),cd.a.vb(hb.a.Dq),cd.a.vb(hb.a.gz),cd.a.vb(hb.a.Op),cd.a.vb(hb.a.Tda),cd.a.vb(hb.a.fl),cd.a.vb(hb.a.GT),cd.a.vb(hb.a.Hj),cd.a.vb(hb.a.Qf),cd.a.vb(hb.a.Q_),cd.a.vb(hb.a.eq),cd.a.vb(hb.a.ux),cd.a.vb(hb.a.Nra),cd.a.vb(hb.a.DHc),cd.a.vb(hb.a.utb),cd.a.vb(Za.a.bO),cd.a.vb(Va.a.W_),cd.a.vb(hb.a.R8b),cd.a.vb(hb.a.vRf),cd.a.vb(hb.a.u1d),cd.a.vb(hb.a.r1k),cd.a.vb(hb.a.kmd),cd.a.vb(hb.a.jh),cd.a.vb(hb.a.ped),
cd.a.vb(hb.a.xce),cd.a.vb(hb.a.mce),cd.a.vb(hb.a.TK),cd.a.vb(hb.a.jua),cd.a.vb(hb.a.XZb),cd.a.vb(hb.a.MQ),cd.a.vb(hb.a.gPb),cd.a.vb(hb.a.embeddedFonts),cd.a.vb(hb.a.iFa),cd.a.vb(hb.a.ttc),cd.a.vb(hb.a.cLh),cd.a.vb(hb.a.Fdh),cd.a.vb(hb.a.a2c),cd.a.vb(hb.a.sqd),cd.a.vb(hb.a.tfa),cd.a.vb(hb.a.roa),cd.a.vb(hb.a.a4),cd.a.vb(hb.a.TGb),cd.a.vb(hb.a.UGb),cd.a.vb(hb.a.VGb),cd.a.vb(hb.a.xna),cd.a.vb(hb.a.d4)]}get B0a(){return!0}}Object(n.a)(EJ,"ShapeNodeComplexMerge",null,[402]);class Gx{constructor(a,b){this.Ahk=
a;this.mik=b}get YCa(){return this.mik}get mKa(){return[]}get DMa(){return[]}get uMa(){return[]}get BQa(){return[]}get lRa(){return[]}lG(a){return this.Ahk(a)}s1a(){return!1}get XCa(){return[]}get B0a(){return!1}}Object(n.a)(Gx,"SimpleStrategyComplexMerge",null,[402]);class FJ{get YCa(){return 8}get mKa(){return[]}get DMa(){return[cd.a.vb(hb.a.backgroundColor),cd.a.vb(hb.a.Gsa),cd.a.vb(hb.a.s2e),cd.a.vb(hb.a.eba),cd.a.vb(hb.a.Xna),cd.a.vb(hb.a.saa),cd.a.vb(hb.a.Fz),cd.a.vb(hb.a.Era),cd.a.vb(hb.a.vN),
cd.a.vb(hb.a.aQ),cd.a.vb(hb.a.KM),cd.a.vb(hb.a.Uya)]}get uMa(){return[cd.a.vb(hb.a.n1a),cd.a.vb(hb.a.ij),cd.a.vb(hb.a.Cn),cd.a.vb(hb.a.Jd),cd.a.vb(hb.a.hW),cd.a.vb(hb.a.vRc),cd.a.vb(hb.a.aRd)]}get BQa(){return[cd.a.vb(Za.a.TA),cd.a.vb(hb.a.notesContentNode),cd.a.vb(Va.a.commentContentNode)]}get lRa(){return[]}lG(a){return 393227===a.Ue}s1a(){return!0}get XCa(){return[cd.a.vb(hb.a.cid),cd.a.vb(hb.a.sid),cd.a.vb(hb.a.LS),cd.a.vb(hb.a.Hxh),cd.a.vb(Za.a.jn),cd.a.vb(hb.a.lVa),cd.a.vb(hb.a.zda),cd.a.vb(hb.a.GEa),
cd.a.vb(hb.a.W$a),cd.a.vb(hb.a.title),cd.a.vb(hb.a.DY),cd.a.vb(hb.a.raa),cd.a.vb(hb.a.R8b),cd.a.vb(hb.a.V$a),cd.a.vb(hb.a.N$a),cd.a.vb(hb.a.jh),cd.a.vb(hb.a.roa)]}get B0a(){return!0}}Object(n.a)(FJ,"SlideNodeComplexMerge",null,[402]);class GJ{constructor(a,b){this.Rxg=a;this.C8j=b}ga(a){return this.Rxg.YTc(a,this.C8j)}get B2d(){return this.Rxg}}Object(n.a)(GJ,"PropertyMergeStrategies",null,[]);const WC=(a,b,c,f,l)=>{if(b){f=f||new Dz;if(!a){a=b=b.p7a();const w=a.bA();for(let H=0;H<w.length;H++){const U=
w[H];if(I.a.eZf(U)===I.a.string){const ja=f.l6f(a,U);f.ash(a,U,ja?"Redacted: "+ja.length:"null")}}}ka.ULS.sendTraceTag(18613206,l,50,c,b.Btd())}else ka.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class HJ{constructor(a,b,c){this.Kug=new Ua.a;this.Y8c=a;this.Lva=b;this.rXa=c(this.b6b());this.Uck=new kc.a(Object(F.a)(this,this.B2d,"evalPropertyMergeStrategies"))}F3j(a){if(!a.DKh){a.DKh=!0;var b=a.rdd.runtime.xRc,c=a.snk;WC(b,a.G6a.value.fHb,"Base",c,808);WC(b,a.G6a.value.B5,"Favored",
c,808);WC(b,a.RZb.value.B5,"Conflict",c,808)}}kBl(a,b,c,f){this.iea(a,c);const l=a.X$;if(2===f||7===f||a.ljc.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){if(({value:w}=a.G6a.value.KZa.Tf(c)).returnValue&&w.Hab)return 4!==f;f=0}if(0===f){if(!b.isDeleted)return l.aLa(cd.a.fta(c),b.newValue),!0;f=6}if(8===f){let H=a.cLc.value;b=!0;if(({value:w}=H.KZa.Tf(c)).returnValue&&H.Hab){var w=this.Y8c.Wjj(a.rdd.input.source,w);void 0!==w&&null!==w?l.aLa(cd.a.fta(c),w):(b=!1,f=6)}if(b)return!0}return 9===
f&&(b=!0,({value:w}=a.cLc.value.KZa.Tf(c)).returnValue&&(w=this.Y8c.p9f(a.rdd.input.source,w),void 0!==w&&null!==w?l.aLa(cd.a.fta(c),w):(b=!1,f=6)),b)?!0:6===f?(l.removeProperty(cd.a.fta(c)),!0):1===f?this.Lva.s1a(a,c):!1}zYa(a){return a}b6b(){return[Object(F.a)(this,this.tBl,"tryPreProcessFavoredRevision"),Object(F.a)(this,this.tvi,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.jBl,"tryMergeNodeInternal")]}get Ajd(){return this.Uck.value}iBl(a){const b=a.G6a.value;ka.ULS.sendTraceTag(18659235,
808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.B5.id,b.B5.Ue);for(let c=0;c<this.rXa.length;c++)if(!(0,this.rXa[c])(a))return ka.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",b.B5.id,b.B5.Ue,c),this.F3j(a),a.X$=null,!1;ka.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.B5.id,b.B5.Ue);return!0}tBl(a){const b=a.G6a.value;if(!b.Hab)return!0;
const c=this.Ajd;let f=!0;b.KZa.forEach((l,w)=>{if(!w.Hab||a.ljc.contains(l))return!0;w=c.ga(l);if(5===w)return ka.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",b.fHb.Ue,l,w),f=!1;6===w&&a.KNe.add(l);return!0});return f}tvi(a){a.X$=a.G6a.value.B5.p7a();const b=a.KNe,c=a.X$;b&&b.forEach(f=>{c.removeProperty(cd.a.fta(f));return!0});return!0}jBl(a){const b=a.RZb.value,c=
b.fHb.Ue,f=this.Ajd;let l=!0;b.KZa.forEach((w,H)=>{if(this.Lva.B0a&&!this.Ajd.B2d.Gb(w)){var U=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",w,c);ka.ULS.sendTraceTag(18970259,808,50,U)}U=f.ga(w);l=this.kBl(a,H,w,U);l||(a.X$=null,ka.ULS.sendTraceTag(18659271,808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,w,U));return l});return l}sbj(){return[cd.a.vb(Za.a.ISf),cd.a.vb(Za.a.lastModifiedTime),cd.a.vb(Za.a.GE),cd.a.vb(Za.a.ojb),
cd.a.vb(Za.a.Hmh),cd.a.vb(eh.a.Tjc),cd.a.vb(Va.a.gyi),cd.a.vb(Va.a.uRf),cd.a.vb(Qs.a.Kw)]}B2d(){var a=this.sbj(),b=this.Lva.mKa,c=this.Lva.DMa,f=this.Lva.uMa,l=this.Lva.lRa,w=this.Lva.BQa;const H=this.Lva.XCa,U=new qd.a(0);for(let ja=0;ja<a.length;ja++)U.$(a[ja],this.zYa(7));for(a=0;a<b.length;a++)U.$(b[a],this.zYa(8));for(b=0;b<c.length;b++)U.$(c[b],this.zYa(7));for(c=0;c<f.length;c++)U.$(f[c],this.zYa(9));for(f=0;f<l.length;f++)U.$(l[f],this.zYa(1));for(l=0;l<w.length;l++)U.$(w[l],this.zYa(9)),
this.Kug.add(w[l]);for(w=0;w<H.length;w++)U.$(H[w],this.zYa(this.Lva.YCa));return new GJ(U,this.zYa(this.Lva.YCa))}iea(a,b){this.Kug.contains(b)&&(a=a.X$,ka.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Ue,b))}}Object(n.a)(HJ,"GraphNodeComplexMerge",null,[1027]);class IJ{constructor(a,b){this.Bl=a;this.q6c=b;this.b8j=this.XEi()}XEi(){const a=[];this.Bl.forEach(b=>{a.push(new HJ(this.q6c,b,c=>c))});return a}WEi(a){for(let b=0;b<
this.Bl.length;b++)if(this.Bl[b].lG(a))return this.b8j[b];return null}}Object(n.a)(IJ,"GraphNodeComplexMergeFactory",null,[349]);class JJ{Wjj(a,b){this.dKh(a);return 5===a?b.newValue:b.oldValue}p9f(a,b){this.dKh(a);return 5===a?b.oldValue:b.newValue}dKh(a){1!==a&&5!==a&&ka.ULS.sendTraceTag(18613264,808,15,"Unexpected merge source: {0}",a)}}Object(n.a)(JJ,"GraphNodeComplexMergeHelper",null,[401]);class KJ{constructor(a,b,c,f,l,w){this.KNe=this.ljc=null;this.Aac=this.DKh=!1;this.X$=null;this.Crc=a.runtime.Crc;
this.rdd=a;this.snk=b;this.G6a=c;this.RZb=f;this.cLc=l;this.u$f=w}}Object(n.a)(KJ,"GraphNodeComplexMergeState",null,[]);class LJ{constructor(a){this.rXa=a(this.b6b())}b6b(){return[Object(F.a)(this,this.Lol,"simpleMerge"),Object(F.a)(this,this.xxi,"complexMerge")]}ohl(a,b,c,f,l,w){a=new KJ(a,c,new kc.a(()=>new Ex(f.x5,l)),new kc.a(()=>new Ex(f.x5,w)),new kc.a(()=>new Ex(w,l)),b.WEi(l));a.ljc=f.nFc;a.KNe=new qj.a;return a}merge(a,b,c,f,l,w){a=this.ohl(a,b,c,f,l,w);b=!0;for(c=0;c<this.rXa.length&&b;c++)b=
(0,this.rXa[c])(a);(b=a.Aac&&a.X$?new Fx(a.X$,!1):null)&&b.egl(a.ljc);return{returnValue:a.Aac,X$:b}}Lol(a){var b=a.u$f.Ajd;return a.RZb.value.vZc(b)&&a.cLc.value.vZc(b)?a.G6a.value.vZc(b)?!0:(b=a.RZb.value.B5,a.Aac=!0,a.X$=b.p7a(),!1):(a.Aac=!0,!1)}xxi(a){const b=a.RZb.value.B5;a.Crc&&ka.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.Ue);const c=a.u$f.iBl(a);a.Aac=c;ka.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",
c?"Succeeded":"Failed",b.id,b.Ue,!!a.X$);return c}}Object(n.a)(LJ,"GraphNodeMerge",null,[350]);class ku{constructor(a){this.Y8c=a}gPi(a){const b=a.cLc.value,c=a.X$;a=a.rdd.input.source;for(const l of ku.Ind)if(({value:f}=b.KZa.Tf(l)).returnValue){var f=this.Y8c.p9f(a,f);void 0!==f&&null!==f?c.aLa(cd.a.fta(l),f):c.removeProperty(cd.a.fta(l))}}get mKa(){return[cd.a.vb(hb.a.GT),cd.a.vb(hb.a.Oje),cd.a.vb(hb.a.Pje),cd.a.vb(hb.a.pje)]}get DMa(){return[]}get uMa(){return[]}get BQa(){return[]}get lRa(){return ku.Ind}get XCa(){return[]}get B0a(){return!1}get YCa(){return 9}lG(a){return 393230===
a.Ue}s1a(a,b){return 0<=Array.indexOf(ku.Ind,b)?(this.gPi(a),ku.Ind.forEach(c=>{a.ljc.add(c)}),!0):!1}}ku.Ind=[cd.a.vb(Za.a.pq),cd.a.vb(Za.a.tlb),cd.a.vb(Za.a.wtc),cd.a.vb(Za.a.zLa),cd.a.vb(Za.a.Uwa),cd.a.vb(Va.a.JZa)];Object(n.a)(ku,"ParagraphNodeComplexMerge",null,[402]);class XC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}Zb(a){this.K=a;a.register(JJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();
const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(349,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().oa(()=>{const c=new EJ;return new IJ([new DJ,new FJ,c,new ku(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new AJ,new BJ,new CJ(c),new Gx(f=>Array.contains(b,f.Ue),9),new Gx(f=>131140===f.Ue,6),new Gx(f=>131164===f.Ue,8),new Gx(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(Dz,
"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(350,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().oa(()=>new LJ(c=>c));a.register(351,"Box4.IBrowserGraphMerger").ma().oa(()=>new Cv(c=>new TC.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new m.a(c,
f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").IVc,a.resolve("PowerPointWebEditor.IApplicationSettings").Njg,a.resolve("PowerPointWebEditor.IApplicationSettings").mPj,a.resolve("PowerPointWebEditor.IApplicationSettings").kPj,a.resolve("PowerPointWebEditor.IApplicationSettings").lPj))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");Pc.App.VLa.oji(a)}dispose(){}static main(){v.a.instance.Dc(new XC)}}Object(n.a)(XC,"PPTWebEditorGraphMergePackage",null,[2,3]);class MJ{constructor(a,
b){this.Bl=a;this.tR=b}S2i(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.Bl)if(f.UKj(a)){c=f;const l=this.tR.Ei("UserAction",f.name);b=f.P2i(a);l.stop();break}b||va.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}R2i(a){if(!a||1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.S2i(c))&&b.appendChild(a);return b}}Object(n.a)(MJ,"HtmlExportProcessor",null,[343]);class YC{constructor(){this.JDc=
null}get rootNode(){return this.JDc}clone(){return Object.assign(new YC,{JDc:this.rootNode})}}Object(n.a)(YC,"HtmlExportContext",null,[]);class NJ{Q2i(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new YC,{JDc:f}));return c}}Object(n.a)(NJ,"HtmlExportUtils",null,[345]);class OJ{constructor(a){this.Fse=null;this.Iq=a}get wQi(){return this.Fse=this.Fse||document.createElement("div")}T2i(a,b){if(!a||!a.rootNode||!b)return null;b.hCa(this.wQi);const c=this.Iq.oe(3);try{c.kd(a.rootNode),
c.kLa(b.Ma),b.$x(a.rootNode),b.Kza()}finally{c&&c.dispose()}a=b.HUf;b.detach();return a}}Object(n.a)(OJ,"HtmlGenerator",null,[344]);class ZC{constructor(a,b,c){this.T$j=a;this.U$j=b;this.Pb=c}get name(){return"PPTTableHtmlExportHandler"}UKj(a){return 14===a.rootNode.type?!0:10===a.rootNode.type?(a=Object(qa.a)(4,a.rootNode),!!a&&a.ud):!1}P2i(a){return this.U$j.T2i(this.Vmj(a),this.T$j)}Vmj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Pb.Mc(a.rootNode);a.Bb(1);b.JDc=a.Bb(2);return b}return a}}
Object(n.a)(ZC,"PPTTableHtmlExportHandler",null,[384]);class $C extends me.a{constructor(a,b){super(new vf.a,a,b)}get HUf(){return this.ECh}}Object(n.a)($C,"AHtmlExportView",me.a,[411,376,170,106]);class aD{}aD.zVi="ExportedPPTTable";Object(n.a)(aD,"HtmlExportConstants",null,[]);class bD extends $C{constructor(a,b){super(a,b)}get HUf(){const a=this.ECh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],aD.zVi),a[0]):null}get Wl(){return!0}get KF(){return 480}}Object(n.a)(bD,
"PPTTableHtmlExportView",$C,[]);class cD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}Zb(a){this.K=a;this.K.register(343,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().oa(()=>new MJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));this.K.register(344,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().oa(()=>new OJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));
this.K.register(345,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().oa(()=>new NJ);this.izi()}init(){}dispose(){}izi(){this.K.register(bD,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().oa(()=>new bD(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));this.K.register(ZC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().oa(()=>new ZC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){v.a.instance.Dc(new cD)}}Object(n.a)(cD,"HtmlExportPackage",null,[2,3]);class Ez extends ci.a{constructor(a,b){super();this.Lxc=0;this.tFd=null;this.En="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.mhf=a;this.lhf=b;this.ig="LanguageDialog"}Prc(){this.eg=this.D5d();this.Lxc=({Idh:a}=this.mhf.W6f()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.aj(Box4Intl.Box4Strings.l_Language,Object(F.a)(this,this.Lcl,"setLanguageHandler"),a);this.tFd=document.getElementById("LanguageList");this.lhf.rHk(this.tFd,this.Lxc)}D5d(){return ci.a.VA(this.En,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}Lcl(a,
b){if(R.a.instance.ga(70)){var c=Nc.a.instance.Wp(D.a.Kcl);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.tFd.value),this.mhf.vsh(b,a),c.properties.$("PreviousLCID",this.Lxc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.lhf.Jcl(b,this.Lxc)),Pc.App.Kb.updateCommandUI(!0));c.end()}}}Object(n.a)(Ez,"LanguageDialog",ci.a,[385]);class PJ{constructor(){this.iZj=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(F.a)(this,this.rZj,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){va.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}E6k(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}rZj(a,b){b=b.toLowerCase();for(const c of this.iZj)if(b===c)return;va.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(n.a)(PJ,"JSanityHelper",null,[341]);class dD extends Ez{constructor(a,
b,c){super(a,c);this.G9j=b}D5d(){return this.G9j.rUa?ci.a.VA(this.En,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.D5d()}}Object(n.a)(dD,"PPTLanguageDialog",Ez,[]);class QJ{constructor(a,b,c,f){this.mhk=a;this.B8j=b;this.bck=c;this.bG=f}getInstance(a){return new dD((a?this.mhk:this.B8j)(),this.bG,this.bck)}}Object(n.a)(QJ,"PPTLanguageDialogFactory",null,[339]);var Ik=d(116);class RJ{constructor(){this.X0e="rect,circle,ellipse,line,polyline,polygon,path";
this.xsd=[];this.yga=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.pLe=96}cCl(a,b=null){try{const c=this.q$d(a);if(!c)return null;const f=b?tc.a.xI(b.sD):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const w=c[b];w.setAttribute(Ik.a.U3d,f);w.setAttribute(Ik.a.lWf,l)}return a}catch(c){return va.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,
c.stack),null}}OFh(a,b=null){try{const c=this.q$d(a);if(!c)return null;const f=b?tc.a.xI(b.sD):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const w=c[b];w.setAttribute(Ik.a.gsd,f);w.setAttribute(Ik.a.Nzh,l)}return a}catch(c){return va.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}dCl(a,b){try{const f=this.q$d(a);if(!f)return null;var c=this.ajj(b);let l="";for(const w of c)l+=
w+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const w=f[c];w.setAttribute(Ik.a.Mzh,l);w.setAttribute(Ik.a.l0e,"miter");w.setAttribute(Ik.a.Wsl,"4");switch(b){case 8:w.setAttribute(Ik.a.k0e,"round");break;case 2:case 0:w.setAttribute(Ik.a.k0e,"butt");break;default:w.setAttribute(Ik.a.k0e,"round")}}return a}catch(f){return va.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),null}}PFh(a,b,c,f){try{if(!a)return null;
this.Jsh(c,b*this.pLe*f/te.a.tDa,a);return a}catch(l){return va.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}cjj(){if(!this.xsd||1>this.xsd.length)this.xsd=this.X0e.split(",");return this.xsd}q$d(a){if(!a)return null;a=a.querySelectorAll(this.X0e);return 1>a.length?null:a}Jsh(a,b,c){if(c){var f=c.getAttribute(Ik.a.NOb)?c.getAttribute(Ik.a.NOb).toString():"";1<f.length?(f=f.substring(f.indexOf("(")+
1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.cjj())if(l===a){c.setAttribute(Ik.a.m0e,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.Jsh(f,b,c.children[l])}}ajj(a){switch(a){case 0:return this.yga[0];case 1:return this.yga[1];case 2:return this.yga[2];case 3:return this.yga[3];case 4:return this.yga[4];
case 5:return this.yga[5];case 6:return this.yga[6];case 7:return this.yga[7];case 8:return this.yga[8];case 9:return this.yga[9];case 10:return this.yga[10];default:return va.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.yga[0]}}}Object(n.a)(RJ,"SVGIconLocalEditor",null,[342]);class SJ{constructor(a,b){this.RTg=b;this.Sd=a}OF(a,b){if(!a)return!1;const c=a.N3(f=>!f.fl).length;return!this.Hil(a.E2b,c+b)}mG(a){const b=a.me+1;this.Sd.cH(222,c=>{c.mC=1;c.$Ra=[b.toString(),
this.RTg.toString()];return!1})}Hil(a,b){if(!a&&b<this.RTg)return!1;va.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(n.a)(SJ,"ShapeCountValidator",null,[340]);class eD{constructor(a,b,c,f,l,w){this.ick=a;this.Fa=b;this.iWg=c;this.Jb=f;this.wJ=l;this.Ea=w}get Mb(){return this.ick.value}W6f(){let a,b=0;a=!0;const c=this.Mb.Xd();1===c.length&&c[0].d0c&&(b=this.Ea.WSa(c[0]),a=!this.Ea.n9d(c[0]));return{returnValue:b,Idh:a}}vsh(a,b){const c=this.Mb.Xd();if(1===c.length&&c[0].d0c&&
this.iWg){var f=new K.DictionaryPropertySet;f.setValue(Za.a.kt,a);f.setValue(Yd.a.Twa,b);a=this.Jb.Ad(15);try{a.nc(c[0]);c[0].dta();const l=Object(qa.a)(4,c[0]);l&&this.wJ&&this.wJ.HGl(l,b);this.iWg.$U(f);this.Fa.Ed()}finally{a&&a.dispose()}}}}Object(n.a)(eD,"ShapeLanguageEditor",null,[383]);class fD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}Zb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(Ez,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").oa(()=>
new dD(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(339,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().oa(()=>new QJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(eD,"PowerPointWebEditor.ShapeLanguageEditor").ma().oa(()=>
new eD(this.K.ke("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.rb("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(340,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().oa(()=>new SJ(Ab.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.qd.powerPointEditServerEditableShapeCountThreshold));
this.K.register(341,"PowerPointWebEditor.IJSanityHelper").ma().oa(()=>new PJ);this.K.register(342,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().oa(()=>new RJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){v.a.instance.Dc(new fD)}}Object(n.a)(fD,"PPTWebEditorShapeEditPackage",null,[2,3]);var gD=d(284);class Vs{static get n_(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?
"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():ka.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ka.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get a$b(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get m9(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(n.a)(Vs,
"FullscreenUtils",null,[]);class TJ{get n_(){return Vs.n_}requestFullscreen(a){Vs.requestFullscreen(a)}exitFullscreen(){Vs.exitFullscreen()}get a$b(){return Vs.a$b}get m9(){return Vs.m9}get LDf(){return this.a$b&&!B.a.px}}Object(n.a)(TJ,"FullscreenUtilsProxy",null,[331]);class UJ{Rbj(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(n.a)(UJ,"InkButtonHelper",null,[336]);class VJ{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=
!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(n.a)(VJ,"FlyoutMenuExtraProps",null,[]);class Hx{}Hx.yni="_136_16_N_20";Hx.zni="none";Object(n.a)(Hx,"InkButtonConstants",null,[]);class Fz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(n.a)(Fz,"InkButtonProps",null,[]);class hD{constructor(){this.onInkMenuActivity=null}}Object(n.a)(hD,"IInkButtonSettings",null,
[]);class WJ extends hD{constructor(){super()}}Object(n.a)(WJ,"InkButtonSettings",hD,[]);class XJ{constructor(){this.color=this.item=null}}Object(n.a)(XJ,"InkManagerActivity",null,[]);class Gz{constructor(){this.dye=!1;this.eCe=this.ECe=0;this.wse=""}get k4(){return this.dye}set k4(a){this.dye=a}get startingSlideIndex(){return this.ECe}set startingSlideIndex(a){this.ECe=a}get Qya(){return this.eCe}set Qya(a){this.eCe=a}get FPf(){return this.wse}set FPf(a){this.wse=a}get mXk(){const a={};a.IsStartRehearsal=
this.dye;a.StartingSlideIndex=this.ECe;a.SlideCount=this.eCe;a.DisabledRehearsalRealtimeFeaturesStr=this.wse;return JSON.stringify(a)}}Object(n.a)(Gz,"RehearsalContext",null,[334]);class Hz extends ci.a{constructor(a,b,c){super(!1,!0);this.Wze=50001;this.kb=a;this.qe=b;this.Uo=new Gz;this.Xa=c;this.kb.Fia(Object(F.a)(this,this.Dfa,"onSlideshowExitHandler"));this.kb.WYb(Object(F.a)(this,this.yfa,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.lHa=!1}dispose(){super.dispose();this.lHa||
this.kb.restoreFocus()}qu(){super.qu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Wze);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}BA(){super.BA();var a=document.getElementById(this.Oh("WACDialogPanel"));a.style.minWidth=gf.a.Pc(300);a.style.width=gf.a.Pc(300);a=document.getElementById(this.Oh("WACDialogButtonPanel"));var b=document.getElementById(this.Oh("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(a=document.getElementById(this.Oh("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.Oh("WACDialogPanel"))){b=gf.a.Ie();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=gf.a.Eca();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){va.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.qe.rk("SubtitleProactive_clearly.png");const b=this.qe.rk("SubtitleProactive_network.png"),c=this.qe.rk("SubtitleProactive_noNoise.png");this.eg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.aj("",Object(F.a)(this,this.xfa,"onClickHandler"),a);this.kb.setVisibility(!0)}b8(){super.b8()}xsa(){super.xsa()}Pib(){}yfa(){this.kb.Qib(Object(F.a)(this,this.yfa,"onGetCurrentPositionHandler"));this.open()}Dfa(){this.lHa=!0;this.kb.Wfa(Object(F.a)(this,
this.Dfa,"onSlideshowExitHandler"));this.kb.Qib(Object(F.a)(this,this.yfa,"onGetCurrentPositionHandler"));this.hide()}xfa(a){0===a&&(a=Date.now(),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,3,a,this.Uo))}static Ppg(a,b,c){new Hz(a,b,c)}}Object(n.a)(Hz,"SlideshowSubtitleProactiveDialog",ci.a,[]);var oh=d(679);class YJ{constructor(){this.buttonIdDictionary=null}}Object(n.a)(YJ,"SlideshowToolbarSettings",null,[]);class Ix extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(n.a)(Ix,"ReadOutEventArgs",Sys.EventArgs,[]);class iD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.UCb=this.Uo=this.Hc=this.oea=this.pe=this.R5c=this.uCe=this.xi=null;this.tU=this.VXa=this.XXa=this.ICb=this.EWa=this.ewe=0;this.$L=!1;this.Fve=!0;this.e7c=this.hR=this.kDe=this.Tqe=!1;this.kb=c;this.kf=H;this.hu=U;this.Xa=wa;this.ia=a;this.Ha=b;this.PDe=l;this.Ub=w;this.pak=Ab.a.instance.Ja("PowerPointWebEditor.IInkButtonHelper");this.qe=f;this.fu=Sa}init(a,b){var c;va.a.J(512495955,
830,50,"ReactSlideshowToolbar.Init");this.Fve=!0;this.Tqe=!1;var f={};f[oh.a.MicButton]=this.Ha.isMicButtonInSlideShowToolbarEnabled;f[oh.a.PrevButton]=!0;f[oh.a.NextButton]=!0;f[oh.a.GridButton]=!0;f[oh.a.InkButton]=!0;f[oh.a.SubtitlesButton]=!0;f[oh.a.LiveButton]=!0;f[oh.a.MoreButton]=!0;f[oh.a.CameraButton]=this.Ha.OOc;f[oh.a.ExitButton]=!0;f[oh.a.CoachButton]=this.Ha.isCoachButtonInSlideShowToolbarEnabled;this.uCe=new YJ;this.uCe.buttonIdDictionary=f;if(!document.getElementById("slideshow-toolbar")){this.pe=
document.createElement("div");this.pe.id="slideshow-toolbar";this.pe.className="ReactSlideshowToolbar";this.Ha.pptEditorVoiceUXEnabled&&(this.R5c=document.getElementById("slideshowfooterContainerElement"),this.pe.className="ReactSlideshowToolbarWithFooter");f=document.createElement("div");f.id="slideshow-toolbar-accessibility";f.style.position="absolute";f.style.left="0px";f.style.top="auto";f.style.width="0px";f.style.height="0px";f.style.overflow="hidden";f.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);
this.Ha.pptEditorVoiceUXEnabled?this.R5c.appendChild(this.pe):this.kf.appendChild(this.pe);this.xi=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.uCe,this.pe);if(!this.xi){va.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const l=pf.a.Vh(359);u.AFrameworkApplication.zp(l);dg.Health.instance.recordQosError(pf.a.qja(l),["SlideShowACE"],!1,!0,!0,!1,null)}this.xi.renderToolbar();this.pe.appendChild(f);this.pe.tabIndex=0}this.oea||(this.oea=document.createElement("div"),
this.oea.id="SlideshowToolbarCalloutMenuContainer",this.oea.className="SlideshowToolbarCalloutMenuContainer",this.hu()&&(this.oea.style.direction=nf.a.S0a),this.kf.appendChild(this.oea));this.Hc=a;this.Uo=b;this.xi.registerButtonCallback(oh.a.MicButton,()=>{this.Dwk()});this.xi.registerButtonCallback(oh.a.CoachButton,()=>{this.htk()});this.Ha.OOc&&(this.xi.registerButtonCallback(oh.a.CameraButton,()=>{this.Nsk()}),this.Jdb=null!==(c=this.Jdb)&&void 0!==c?c:!0,this.xi.setToolbarButtonToggleState(oh.a.CameraButton,
this.Jdb),this.kb.GVe(this.Jdb),this.xi.showToolbarButton(oh.a.CameraButton));this.Hc.Lh||this.Ub&&this.Ub.instance&&this.Ub.instance.dr?(this.hR=!0,this.xi.setToolbarButtonToggleState(oh.a.MicButton,this.hR),this.xi.showToolbarButton(oh.a.MicButton)):(this.hR=!1,this.xi.setToolbarButtonToggleState(oh.a.MicButton,this.hR),this.xi.hideToolbarButton(oh.a.MicButton));this.xi.registerButtonCallback(oh.a.PrevButton,l=>{this.zHb(l)});this.xi.registerButtonCallback(oh.a.NextButton,l=>{this.uHb(l)});this.xi.registerButtonCallback(oh.a.GridButton,
l=>{this.rHb(l)});this.xi.showToolbarButton(oh.a.GridButton);this.Hc.Fvb&&!this.Uo.k4&&(this.xi.registerButtonCallback(oh.a.SubtitlesButton,l=>{this.$gd(l)}),this.xi.setToolbarButtonToggleState(oh.a.SubtitlesButton,this.Hc.Lh),this.xi.showToolbarButton(oh.a.SubtitlesButton));this.xi.registerButtonCallback(oh.a.ExitButton,l=>{this.qHb(l)});this.Ha.isInkingInSlideShowEnabled&&this.Ha.isInkUIInSlideShowEnabled&&(a=Fz.create(),a.icon=Hx.yni,a.selectedColor=Hx.zni,this.xi.updateElementProps(oh.a.InkButton,
a),this.xi.registerButtonCallback(oh.a.InkButton,()=>{this.uEj()}),this.xi.showToolbarButton(oh.a.InkButton));this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&!this.Uo.k4&&(this.xi.registerButtonCallback(oh.a.LiveButton,()=>{this.lwk()}),this.xi.updateFlyoutButtonCallback(oh.a.LiveButton,this.Ub.instance.dr),this.xi.setToolbarButtonToggleState(oh.a.LiveButton,this.Ub.instance.dr),this.xi.showToolbarButton(oh.a.LiveButton),this.Ub.instance.mvf(Object(F.a)(this,this.Ckc,"onLiveSessionStarted")),this.Ub.instance.kvf(Object(F.a)(this,
this.Bkc,"onLiveSessionEnded")),this.Ub.instance.ivf(Object(F.a)(this,this.Akc,"onLiveRelaunchPausedSession")),this.Ub.instance.W$h(Object(F.a)(this,this.i5g,"onLiveCalloutMenuDefintionChanged")));this.lPb();this.$vb();this.kb.Fia(Object(F.a)(this,this.Gna,"onExitHandler"));this.kb.XPd(Object(F.a)(this,this.Sgb,"onBrowserEventHandler"));this.kb.XGc(Object(F.a)(this,this.$wa,"onGetCurrentSlideDimensionsHandler"));this.kb.bHc(Object(F.a)(this,this.jxa,"onSpecialKeyHandler"));this.kb.ZPd(Object(F.a)(this,
this.Tgb,"onContextMenuHandler"));this.kb.aQd(Object(F.a)(this,this.rfd,"onEnterEndOfShowHandler"));this.kb.cQd(Object(F.a)(this,this.Qfd,"onLeaveEndOfShowHandler"));Yc.a.addHandler(this.pe,sa.a.mq,Object(F.a)(this,this.ahb,"onMouseOverHandler"));Yc.a.addHandler(this.pe,sa.a.Ns,Object(F.a)(this,this.Ekc,"onMouseOutHandler"));Yc.a.addHandler(this.oea,sa.a.click,Object(F.a)(this,this.xfa,"onClickHandler"));Yc.a.addHandler(this.pe,sa.a.Xf,Object(F.a)(this,this.qJa,"onKeyDownHandler"))}pnl(){window.clearTimeout(this.ewe);
this.ewe=window.setTimeout(Object(F.a)(this,this.IAj,"hideMouse"),3E3);this.kb.mga(!0)}IAj(){this.$L||(window.clearTimeout(this.ewe),this.kb.mga(!1))}jD(a,b){b?this.xi.showToolbarButton(a):this.xi.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.xi.setToolbarButtonToggleState(a,b)}show(){if(this.hu()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.XXa+this.tU-16-this.xi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.xi.showToolbar();this.xi.enterFocusTrapZone();
window.clearTimeout(this.EWa);window.clearTimeout(this.ICb);this.Fve?(this.EWa=window.setTimeout(Object(F.a)(this,this.hide,"hide"),2E3),this.Fve=!1,this.Tqe=!0):this.EWa=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3);this.kb.mga(!0)}mxh(){if(this.hu()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.XXa+this.tU-16-this.xi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.xi.showToolbar();this.xi.enterFocusTrapZone();window.clearTimeout(this.EWa);window.clearTimeout(this.ICb);
this.ICb=window.setTimeout(Object(F.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.$L){const a=document.getElementById("slideshow-toolbar");a&&!this.xi.isAnyToolbarElementFocused()&&document.activeElement===a&&this.t1a(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.EWa);window.clearTimeout(this.ICb);this.xi.hideToolbar();this.kb.mga(!1);this.pe.style.display===nf.a.Ff&&this.kb.restoreFocus()}}$vb(){this.$L||(this.Tqe&&this.t1a(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.EWa),
window.clearTimeout(this.ICb),this.xi.forceHideToolbar(),this.kb.mga(!1),this.pe.style.display===nf.a.Ff&&this.kb.restoreFocus())}remove(){this.xi.closeToolbar();this.oea.style.visibility=nf.a.Qs;this.e7c=!1;this.kb.Wfa(Object(F.a)(this,this.Gna,"onExitHandler"));this.kb.DRe(Object(F.a)(this,this.Sgb,"onBrowserEventHandler"));this.kb.Yld(Object(F.a)(this,this.$wa,"onGetCurrentSlideDimensionsHandler"));this.kb.amd(Object(F.a)(this,this.jxa,"onSpecialKeyHandler"));this.kb.FRe(Object(F.a)(this,this.Tgb,
"onContextMenuHandler"));this.kb.GRe(Object(F.a)(this,this.rfd,"onEnterEndOfShowHandler"));this.kb.IRe(Object(F.a)(this,this.Qfd,"onLeaveEndOfShowHandler"));Yc.a.removeHandler(this.pe,sa.a.mq,Object(F.a)(this,this.ahb,"onMouseOverHandler"));Yc.a.removeHandler(this.pe,sa.a.Ns,Object(F.a)(this,this.Ekc,"onMouseOutHandler"));Yc.a.removeHandler(this.oea,sa.a.click,Object(F.a)(this,this.xfa,"onClickHandler"));Yc.a.removeHandler(this.pe,sa.a.Xf,Object(F.a)(this,this.qJa,"onKeyDownHandler"));this.pe&&(this.kf.contains(this.pe)||
this.R5c&&this.R5c.contains(this.pe))&&(this.$L=!1);this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&(this.Ub.instance.Bjh(Object(F.a)(this,this.Ckc,"onLiveSessionStarted")),this.Ub.instance.Ajh(Object(F.a)(this,this.Bkc,"onLiveSessionEnded")),this.Ub.instance.yjh(Object(F.a)(this,this.Akc,"onLiveRelaunchPausedSession")),this.Ub.instance.d_k(Object(F.a)(this,this.i5g,"onLiveCalloutMenuDefintionChanged")))}Gna(){this.remove()}t1a(a){ha.a.Wa(a)?va.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):
this.PDe.Kfh(new Ix(a))}$wa(a,b){try{this.XXa=b.Lxh;this.VXa=b.Ixh;this.tU=b.slideWidth;if("NaN"===this.XXa.toString()||"NaN"===this.VXa.toString()){va.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=pf.a.Vh(359);u.AFrameworkApplication.zp(c);dg.Health.instance.recordQosError(pf.a.qja(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Ub.instance&&this.Ub.instance.dr&&!this.e7c?26:0;if(this.Ha.pptEditorVoiceUXEnabled){const f=
document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.hu()?(this.XXa+this.tU-16-this.xi.getToolbarWidth()).toString()+"px":(this.XXa+2).toString()+"px";f.style.left=l;if(this.Hc.Lh&&"AboveSlide"===this.Hc.Vv)f.style.bottom="0px";else{const H=za.a.sVc();a=0;const U=document.getElementById("AppHeaderPanel");U&&(a=U.clientHeight);f.style.bottom=this.fu.m9?(H-this.VXa-c).toString()+"px":(H-this.VXa-a-c).toString()+"px"}f.style.top="auto";const w=document.getElementById("ReactToolbarInnerContainer");
w&&(w.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.hu()?(this.XXa+this.tU-16-this.xi.getToolbarWidth()).toString()+"px":(this.XXa+2).toString()+"px";f.style.left=l;const w=this.Ub.instance&&this.Ub.instance.dr?(this.VXa+c).toString()+"px":this.VXa.toString()+"px";"AboveSlide"===this.Hc.Vv?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=w,f.style.bottom="auto");f.style.top=w}}}this.show()}catch(c){va.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",
c)}}rfd(){this.e7c=!0}Qfd(){this.e7c=!1}qJa(a){this.xi.isAnyCalloutMenuOpen()||(this.$L=!1);try{this.pe.style.display===nf.a.Wk&&(a.keyCode===A.a.Fmb||a.keyCode===A.a.VB||a.keyCode===A.a.Y1?this.kb.prev():a.keyCode===A.a.Qza||a.keyCode===A.a.UB||a.keyCode===A.a.W1?this.kb.next():a.keyCode===A.a.ZR?this.hu()?this.kb.next():this.kb.prev():a.keyCode===A.a.oP?this.hu()?this.kb.prev():this.kb.next():a.keyCode===A.a.wMa?(this.kDe=!0,this.$vb()):a.shiftKey&&a.keyCode===A.a.Dpa||a.keyCode===A.a.iQb?this.$vb():
this.kb.lVe(a))}catch(b){va.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}jxa(a,b){this.xi.isAnyCalloutMenuOpen()||(this.$L=!1);if(b.key===A.a.iQb||b.shiftKey&&b.key===A.a.Dpa)a="off",this.pe.style.display===nf.a.Ff?(this.mxh(),a="on"):this.$vb(),va.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}Tgb(){if(this.kDe)this.kDe=!1;else{var a="off";this.pe.style.display===nf.a.Ff?(this.mxh(),
a="on"):this.xi.isAnyCalloutMenuOpen()||this.$vb();va.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}Sgb(a,b){this.pnl();b.clientY<this.VXa+8+20&&b.clientY>this.VXa-20-8&&this.show()}ahb(a){(a=a.target)&&this.pe.contains(a)&&(this.$L=!0)}Ekc(a){a.target&&(this.xi.isAnyCalloutMenuOpen()?this.oea.style.visibility=nf.a.Hz:(this.$L=!1,this.show()));this.xi.isAnyCalloutMenuOpen()||this.xi.enterFocusTrapZone()}xfa(a){this.$L=
!1;window.clearTimeout(this.EWa);window.clearTimeout(this.ICb);this.oea.style.visibility=nf.a.Qs;this.EWa=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.xi.enterFocusTrapZone()}zHb(){va.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.kb.prev()}uHb(){va.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.kb.next()}qHb(){va.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.xi.closeToolbar();
this.kb.exit()}S2e(a){const b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr;var c=this.Hc.dVf&&5!==a&&!b;5!==a&&(this.Hc.Lh&&(ui.a.aK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",ui.a.FJ)||va.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Hc.Lh=!this.Hc.Lh);this.xi.setToolbarButtonToggleState(oh.a.SubtitlesButton,this.Hc.Lh);va.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Hc.Lh);this.Hc.Lh&&c&&Hz.Ppg(this.kb,this.qe,this.Xa);c||(c=Date.now(),b?this.hR||this.Ub.instance.Jvb()?this.kb.toggleTranscriberUIVisibility(null):(this.Ub.instance.zag(),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,a,c,this.Uo)):this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,a,c,this.Uo));this.hR=this.Hc.Lh||b;this.kvd();this.lPb()}kvd(){this.xi.setToolbarButtonToggleState(oh.a.MicButton,
this.hR);this.hR?this.xi.showToolbarButton(oh.a.MicButton):this.xi.hideToolbarButton(oh.a.MicButton)}lPb(){const a=this.Hc.Lh,b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr,c=this.Uo.k4,f=32!==this.ia.processAction(L.a.Ufa,1);a||b||c||f?this.xi.hideToolbarButton(oh.a.CoachButton):this.xi.showToolbarButton(oh.a.CoachButton)}Dwk(){va.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.hR=!this.hR;this.xi.setToolbarButtonToggleState(oh.a.MicButton,this.hR);this.kb.setMicrophoneState(!this.hR);
if(this.Ub&&this.Ub.instance&&this.Ub.instance.dr&&this.hR&&!this.Ub.instance.Jvb()){this.Ub.instance.zag();const a=this.Hc.Lh;this.Ub.instance.$ca=!this.Hc.Lh;this.Hc.Lh=!0;this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,5,Date.now(),this.Uo);this.Hc.Lh=a}}Nsk(){va.a.J(509157450,830,50,"ReactSlideshowToolbar.OnCameraToggleHandler");this.Jdb=!this.Jdb;this.xi.setToolbarButtonToggleState(oh.a.CameraButton,this.Jdb);this.kb.GVe(this.Jdb)}htk(){va.a.J(512495941,
830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.La(L.a.Ufa,2,{entryPoint:2})?this.Ha.pptEditorRehearsalSpeechClientEnabled||(this.Uo.k4=!0):va.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}$gd(){va.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.S2e(3)}rHb(){va.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.La(L.a.XMb,2,null)}lwk(){this.Ub&&this.Ub.instance&&(va.a.J(512495937,
830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ub.instance.dr),this.Ub.instance.dr||(this.Ub.instance.qsc(3,u.AFrameworkApplication.userSessionId,this.Ha.podsWebServiceBase,this.Xa.podSessionId,u.AFrameworkApplication.hh),this.Ub.instance.$ca=!this.Hc.Lh,this.Hc.Fvb&&!this.Hc.Lh&&(va.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Lh=!0,this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,
5,Date.now(),this.Uo),this.Hc.Lh=!1,this.hR=!0,this.kvd()),this.$L=!1,this.xi.setToolbarButtonToggleState(oh.a.LiveButton,!0)));this.lPb()}Ckc(){this.xi.setToolbarButtonToggleState(oh.a.LiveButton,!0);this.jvd(!1,!1);this.hR=!0;this.kvd();this.lPb();this.f0g()}Bkc(){this.xi.setToolbarButtonToggleState(oh.a.LiveButton,!1);this.jvd(!1,!0);this.Ub&&this.Ub.instance&&this.Ub.instance.$ca&&!this.Hc.Lh&&(va.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(u.AFrameworkApplication.userSessionId,
this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,5,Date.now(),this.Uo));this.Ub.instance.$ca=!1;this.Hc.Lh||(this.hR=!1,this.kvd());this.lPb()}Akc(){this.Ub&&this.Ub.instance&&(this.$L=!0,this.show(),this.oea.style.visibility=nf.a.Hz,this.jvd(!0,!1),this.f0g());this.lPb()}f0g(){this.Ha.gjd&&!this.Ub.instance.Jvb()&&(this.hR=!1,this.xi.setToolbarButtonToggleState(oh.a.MicButton,this.hR),this.Hc.Lh=!1,this.xi.setToolbarButtonToggleState(oh.a.SubtitlesButton,this.Hc.Lh))}i5g(){this.jvd(!1,
!1)}jvd(a,b){if(this.Ub&&this.Ub.instance){const c=new VJ;c.menuDefinition=b?null:this.Ub.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.xi.updateElementProps(oh.a.LiveButton,c);this.xi.updateFlyoutButtonCallback(oh.a.LiveButton,!b)}}uEj(){this.pak.execute(Object(F.a)(this,this.tEj,"initInkButton"));const a=new XJ;a.item="Init";this.kb.OLe(a);this.xi.registerButtonCallback(oh.a.InkButton,()=>{})}tEj(a){const b=new WJ;b.onInkMenuActivity=c=>{this.Kvk(c)};this.UCb=a.Rbj(b);a=Fz.create();
a.icon=this.UCb.getIcon();a.menuDefinition=this.UCb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.xi.updateElementProps(oh.a.InkButton,a)}Kvk(a){this.kb.OLe(a);a=Fz.create();a.selectedColor=this.UCb.getSelectedColor();a.icon=this.UCb.getIcon();a.menuDefinition=this.UCb.getControlsInMenu();this.xi.updateElementProps(oh.a.InkButton,a);this.$vb()}}Object(n.a)(iD,"ReactSlideshowToolbar",null,[1023,1022]);class jD{constructor(a,b){this.ii=a;this.Zdc=document.createElement("div");
this.Zdc.id="slideshowfooterContainerElement";this.Zdc.className="slideshowFooterContainer";this.ia=b}init(){va.a.J(595198370,830,50,"SlideShowFooterContainer.Init");this.ii&&this.ii.appendChild(this.Zdc)}remove(){this.ii&&this.ii.contains(this.Zdc)&&this.ii.removeChild(this.Zdc)}wb(){this.ia.ya(L.a.twh,nc.a.application,Object(F.a)(this,this.Jml,"showFooterElements"));this.ia.ya(L.a.Rcg,nc.a.application,Object(F.a)(this,this.EAj,"hideFooterElements"))}Jml(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&
(a.style.display="flex");return 32}EAj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=nf.a.Ff);return 32}}Object(n.a)(jD,"SlideShowFooterContainer",null,[1024]);class ZJ{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(n.a)(ZJ,"IVoiceActorSettings",null,[]);class $J{constructor(){this.Mic=this.ii=this.igb=null}init(){va.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.igb=document.createElement("div");this.igb.id="voiceNotificationContainerElement";
this.igb.className="voiceNotificationContainer";(this.ii=document.getElementById("slideshowfooterContainerElement"))&&this.ii.insertBefore(this.igb,this.ii.firstChild);const a=new ZJ;a.baseZIndex=50002;a.hostElement=this.igb;this.Mic=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.ii&&this.ii.contains(this.igb)&&this.ii.removeChild(this.igb)}show(a,b){this.Mic&&this.Mic.showNotification(a,b)}hide(){this.Mic&&this.Mic.hideNotification()}}Object(n.a)($J,"SlideShowVoiceNotification",null,
[337]);class kD extends ci.a{constructor(a,b){super(!1,!0);this.Rhc=null;this.Scb=this.lWa=0;this.Wze=50001;this.BDb=null;this.kb=a;this.ydk=b;this.kb.Fia(Object(F.a)(this,this.Dfa,"onSlideshowExitHandler"));this.kb.WYb(Object(F.a)(this,this.yfa,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.lHa=!1}get Erd(){if(void 0===this.Rhc||null===this.Rhc)this.Rhc=document.getElementById("GotoDlgInput");return this.Rhc}GJl(){if(!RegExp("^[0-9]+$").test(this.Erd.value))return this.Erd.value=
this.lWa.toString(),!1;this.Scb=Number.parseInvariant(this.Erd.value);this.Scb=Math.min(this.Scb,this.ydk);this.Scb=Math.max(this.Scb,1);return!0}dispose(){super.dispose();this.Rhc=null;this.lHa||this.kb.restoreFocus()}qu(){super.qu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Wze);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}BA(){super.BA();const a=document.getElementById(this.Oh("WACDialogPanel"));
a.style.minWidth=gf.a.Pc(300);a.style.width=gf.a.Pc(300)}open(){va.a.J(24133980,830,50,"SlideshowGoToDialog: Open");this.eg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.lWa.toString()};this.aj(ResourceStrings.L_GoTo,Object(F.a)(this,this.xfa,"onClickHandler"),a);this.kb.setVisibility(!0);this.Erd.focus()}b8(){super.b8();this.BDb=Object(F.a)(this,this.qJa,
"onKeyDownHandler");u.AFrameworkApplication.Aa.pG.yld(sa.a.Xf,window.document,this.BDb,null)}xsa(){super.xsa();void 0!==this.BDb&&null!==this.BDb&&u.AFrameworkApplication.Aa.pG.N4e(sa.a.Xf,window.document,this.BDb);this.BDb=null}Pib(){}yfa(a,b){this.kb.Qib(Object(F.a)(this,this.yfa,"onGetCurrentPositionHandler"));this.lWa=b.slideIndex+1;this.open()}Dfa(){this.lHa=!0;this.kb.Wfa(Object(F.a)(this,this.Dfa,"onSlideshowExitHandler"));this.kb.Qib(Object(F.a)(this,this.yfa,"onGetCurrentPositionHandler"));
this.hide()}qJa(a){a=a.qc.keyCode;return a===A.a.tq?(this.GJl()&&(this.uTa(this.Scb),this.hide()),!0):a===A.a.jQb||a===A.a.xMa||a===A.a.QJh||a===A.a.Qvd?!0:!1}xfa(a){1===a&&this.uTa(this.Scb)}uTa(a){this.kb.uTa(a-1)}static F_j(a,b){1>=b||void 0!==Nl.a.gx&&null!==Nl.a.gx||new kD(a,b)}}Object(n.a)(kD,"SlideshowGoToDialog",ci.a,[]);class lD{constructor(a,b,c,f,l,w,H,U,ja){this.S4=this.K=null;this.YCb=!1;this.B4=[];this.pWa=this.oE=this.dec=null;this.kb=a;this.Tb=b;this.wva=c;this.ia=f;this.je=l;this.kf=
w;this.hu=H;this.fu=U;this.Ub=ja}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",this.K.className="SlideshowContextMenuContainer");this.S4=document.createElement("div");this.S4.className="SlideshowContextMenu cui-menu";this.S4.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.hu();let c=this.aL(ResourceStrings.L_Next,Object(F.a)(this,this.uHb,"onNextClickHandler"),b);Array.add(this.B4,
c);a.appendChild(c);c=this.aL(ResourceStrings.L_Previous,Object(F.a)(this,this.zHb,"onPrevClickHandler"),b);Array.add(this.B4,c);a.appendChild(c);c=this.aL(ResourceStrings.l_GotoCell,Object(F.a)(this,this.uvk,"onGoToClickHandler"),b);Array.add(this.B4,c);a.appendChild(c);c=this.aL(ResourceStrings.L_GridView_SeeAllSlides,Object(F.a)(this,this.rHb,"onGridViewClickHandler"),b);Array.add(this.B4,c);a.appendChild(c);this.fu.LDf&&(this.dec=this.aL(this.fu.m9?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,
Object(F.a)(this,this.pJa,"onFullscreenClickHandler"),b),Array.add(this.B4,this.dec),a.appendChild(this.dec),this.fu.n_&&!this.oE&&(this.oE=Object(F.a)(this,this.skc,"onFullscreenChangeHandler"),$addHandler(this.kf,this.fu.n_,this.oE)));c=this.aL(ResourceStrings.L_EndShow,Object(F.a)(this,this.qHb,"onExitClickHandler"),b);Array.add(this.B4,c);a.appendChild(c);this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&(this.pWa=this.aL(ResourceStrings.l_EndLivePresentation,Object(F.a)(this,this.tuk,"onEndLivePresentationClickHandler"),
b),Array.add(this.B4,this.pWa));this.S4.appendChild(a);this.K.appendChild(this.S4);this.kf.appendChild(this.K);this.wva.addHandler(this.K,sa.a.click,Object(F.a)(this,this.xfa,"onClickHandler"));this.wva.addHandler(this.K,sa.a.contextMenu,Object(F.a)(this,this.I4g,"onHostContextMenuHandler"));this.wva.addHandler(this.S4,sa.a.mq,Object(F.a)(this,this.ahb,"onMouseOverHandler"));this.kb.ZPd(Object(F.a)(this,this.Tgb,"onContextMenuHandler"));this.kb.Fia(Object(F.a)(this,this.Gna,"onExitHandler"))}show(){if(this.Ub&&
this.Ub.instance&&this.Ub.instance.dr&&this.pWa&&!this.pWa.parentNode){const a=this.S4.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.pWa)}this.YCb||(this.wva.addHandler(window.document,sa.a.Xf,Object(F.a)(this,this.qJa,"onKeyDownHandler")),this.wva.addHandler(window.document,sa.a.Il,Object(F.a)(this,this.zkc,"onKeyUpHandler")),this.YCb=!0);this.K.style.visibility=nf.a.Hz}hide(){this.wva.removeHandler(window.document,sa.a.Xf,Object(F.a)(this,
this.qJa,"onKeyDownHandler"));this.wva.removeHandler(window.document,sa.a.Il,Object(F.a)(this,this.zkc,"onKeyUpHandler"));this.YCb=!1;this.K.style.visibility=nf.a.Qs;if(this.pWa&&this.pWa.parentNode){const a=this.S4.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.pWa)}}remove(){this.K&&(this.wva.removeHandler(this.K,sa.a.click,Object(F.a)(this,this.xfa,"onClickHandler")),this.wva.removeHandler(this.K,sa.a.contextMenu,Object(F.a)(this,this.I4g,
"onHostContextMenuHandler")),this.kf.contains(this.K)&&this.kf.removeChild(this.K));this.K=null;Array.clear(this.B4)}Gna(){this.kb.Wfa(Object(F.a)(this,this.Gna,"onExitHandler"));this.kb.FRe(Object(F.a)(this,this.Tgb,"onContextMenuHandler"));this.dec&&($removeHandler(this.kf,this.fu.n_,this.oE),this.oE=null);this.remove()}xfa(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.kb.restoreFocus())}Tgb(a,b){this.u8g(b.clientX,b.clientY)}I4g(a){this.u8g(a.clientX,a.clientY)}ahb(a){(a=
a.target)&&"li"===a.tagName.toLowerCase()&&(this.hRe(document.activeElement),this.KR(a))}qJa(a){const b=a.keyCode,c=a.shiftKey;b===A.a.Sq||b===A.a.O6?this.h0g(!!(1^c)):b===A.a.fZ&&this.h0g(!!(0^c));a.preventDefault()}zkc(a){var b=a.keyCode;b===A.a.tq||b===A.a.pP?(b=document.activeElement,Array.contains(this.B4,b)&&b.click()):b===A.a.X1&&this.kb.exit();a.preventDefault()}u8g(a,b){this.setPosition(a,b);this.wui();this.show();this.S4.focus();this.je.Jfh(new Ix(ResourceStrings.L_ControlMenu))}setPosition(a,
b){if(this.S4){var c=this.S4.offsetWidth,f=this.S4.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&(a-=c);b+f>l&&(b-=f);this.S4.style.top=gf.a.Pc(b);this.S4.style.left=gf.a.Pc(a)}}aL(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.wva.addHandler(f,sa.a.click,b);return f}zHb(){va.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.kb.prev();this.hide();this.kb.restoreFocus()}uHb(){va.a.J(24133959,
830,50,"SlideshowContextMenu.OnNextClickHandler");this.kb.next();this.hide();this.kb.restoreFocus()}uvk(){va.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();kD.F_j(this.kb,this.Tb.qj())}rHb(){va.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.La(L.a.XMb,2,null)}pJa(){va.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.kb.P2e();this.hide();this.kb.restoreFocus()}skc(){this.dec.innerText=this.fu.m9?ResourceStrings.L_ExitFullscreen:
ResourceStrings.L_EnterFullscreen}qHb(){va.a.J(24133963,830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.kb.exit()}tuk(){va.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.kb.restoreFocus();this.Ub&&this.Ub.instance&&this.Ub.instance.dr&&this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.C3b(4)},()=>{})}h0g(a){const b=document.activeElement,c=Array.indexOf(this.B4,b);a=this.B4[((-1===c?a?0:-1:a?c+1:c-1)+this.B4.length)%this.B4.length];
void 0!==a&&null!==a&&(this.hRe(b),this.KR(a))}wui(){this.B4.forEach(a=>{this.hRe(a)})}KR(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.je.Jfh(new Ix(a.innerText)))}hRe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(n.a)(lD,"SlideshowContextMenu",null,[1022]);var LQ=d(1005),Jx=d(260);class aK{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je){this.va=new vc.a;this.oE=null;
this.sCe=this.tCe=this.kbd=this.Vhc=-1;this.jug=this.lug=this.kug=this.DDb=null;this.Wbc="";this.Bcd=this.qbd=-1;this.VGg=new Date(0);this.HGg="";this.dxg=null;this.lzg=this.wdb=this.ive=this.kxe=!1;this.YHa=this.Uo=this.Hc=null;this.Ycc=-1;this.xyg=this.Oyg=!1;this.fu=a;this.kb=b;this.Bea=c;this.Tb=ja;this.la=H;this.h8j=f;this.wi=l;this.Ds=w;this.ut=U;this.Xa=wa;this.sz=Sa;this.Sd=eb;this.swa=ub;this.Oc=Ub;this.Icd=cc;this.Ewa=Fc;this.mu=this.ut.FF();this.iVg=this.la.pptEditorHermesSlideShowStartTimeout;
this.TDe=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Oc.LA(Object(F.a)(this,this.GB,"onSessionEnd"));this.sz.hQd(Object(F.a)(this,this.yHb,"onPodSessionUnavailable"));this.Oc.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.sz.urb(Object(F.a)(this,this.zfa,"onPodSessionRefreshed")),this.sz.uvf(Object(F.a)(this,this.tgd,"onPodSessionRefreshedFromBrowser")));this.ia=Ic;this.Ub=Cc;this.ibd=Ud;this.Ll=je;a=document.createElement("div");
a.id="HiddenFocusTrapAnchor";u.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.mu.insertBefore(a,this.mu.firstChild)}dispose(){this.Oc.qaa(Object(F.a)(this,this.GB,"onSessionEnd"));this.sz.Y_k(Object(F.a)(this,this.yHb,"onPodSessionUnavailable"));
this.Oc.Xfa(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.sz.Tib(Object(F.a)(this,this.zfa,"onPodSessionRefreshed")),this.sz.Gjh(Object(F.a)(this,this.tgd,"onPodSessionRefreshedFromBrowser")))}WEj(a,b,c,f){this.dxg=b;"Legacy"==this.kb.Q8()&&this.kb.init(a,b,c,this.Xa.podSessionId);this.Hc=f;this.Uo=new Gz}Q8(){return this.kb.Q8()}tac(){return!ha.a.Wa(this.Wbc)}get jde(){return this.wdb}set jde(a){this.wdb=a}idl(){this.xyg=!0}Srd(a,b,
c,f,l,w,H,U,ja,wa,Sa,eb,ub){dg.Health.instance.addQosPillar("Present");this.tac()&&va.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.YHa=Ab.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.YHa.Zdb&&(this.Ycc=b,this.ia.processAction(L.a.rrd,2,null),this.YHa.Eai(Object(F.a)(this,this.Kxk,"onPresenterViewSyncMessageReceivedHandler")));const Ub=
c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.Vhc=wa;this.kbd=Date.now();const cc=document.createElement("div");cc.id="startingSlideshowHiddenDiv";cc.style.position="position: absolute";cc.style.left="-10000px";cc.style.top="auto";cc.style.width="1px";cc.style.height="1px";cc.style.overflow="hidden";cc.tabIndex=-1;cc.setAttribute("aria-live","assertive");this.mu.insertBefore(cc,this.mu.firstChild);cc.innerText=ResourceStrings.l_StartingSlideShow;const Fc=U+wa.toString();this.Wbc=Fc;
this.swa&&this.swa.Lqc(!0);this.la.ZVj&&this.Icd&&this.Icd.Lqc(!0);this.Uo&&(this.Uo.k4=c,this.Uo.startingSlideIndex=b,this.Uo.Qya=this.Tb.qj(),this.Uo.FPf=this.la.nXk);this.la.pptEditorVoiceUXEnabled&&this.ibd&&this.ibd.init();this.la.pptEditorVoiceUXEnabled&&this.Ll&&this.Ll.execute(Cc=>{Cc.init()});this.Bea.execute(Cc=>{Cc.init(this.Hc,this.Uo)});this.kug=this.mu.style.top;this.mu.style.top=gf.a.Pc(0);this.la.UUa&&(this.lug=this.mu.style.width,this.jug=this.mu.style.height,this.mu.style.width=
"100%",this.mu.style.height="100%");this.kb.show();this.Spg();this.la.Qxh&&Rr.a.XOb(!1);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.YHa&&this.YHa.Zdb&&this.kb.IPa(Object(F.a)(this,this.Jgd,"onSlideChangedHandler"));this.kb.Fia(Object(F.a)(this,this.Gna,"onExitHandler"));this.kb.evf(Object(F.a)(this,this.pJa,"onFullscreenClickHandler"));this.kb.aHc(Object(F.a)(this,this.u7g,"onSlideshowReadyHandler"));this.kb.bvf(Object(F.a)(this,this.tfd,"onErrorHandler"));this.kb.bHc(Object(F.a)(this,
this.jxa,"onSpecialKeyHandler"));this.kb.dQd(Object(F.a)(this,this.sgd,"onPodSessionExpiredHandler"));this.kb.hvf(Object(F.a)(this,this.Ufd,"onLogEndOfTranscriptionSessionHandler"));this.kb.gvf(Object(F.a)(this,this.Tfd,"onLiveSubtitlesDockedViewHandler"));this.kb.yvf(Object(F.a)(this,this.nld,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.sz.urb(Object(F.a)(this,this.zfa,"onPodSessionRefreshed")),this.sz.uvf(Object(F.a)(this,this.tgd,"onPodSessionRefreshedFromBrowser")));
this.xai(Object(F.a)(this,this.Ofd,"onKeydownHandler"));c=Date.now();let Ic=!this.la.Wlg||Sa;Ic||(Ic=this.wi.CSc().QN());this.Oyg=Ic;wa=Date.now();va.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",wa-c,Ic?"True":"False",Sa?"True":"False");this.tCe=Date.now();this.wi.CSc().forceOutbound(()=>{va.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.wi.flush(()=>{this.sCe=
Date.now();va.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.sCe-this.tCe);this.Wbc===Fc&&Ic&&(Sa&&eb&&(va.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=eb.qk,w=eb.podSessionId),this.$yh(a,b,f,l,w,H,U,ja,ub,Ub),va.a.J(512495811,830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},Cc=>{va.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",Cc.ServerError);return!1})},
(Cc,Ud)=>{va.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",Ud)},null);this.Wbc!==Fc||Ic||(this.$yh(a,b,f,l,w,H,U,ja,ub,Ub),va.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}$yh(a,b,c,f,l,w,H,U,ja,wa=!1){const Sa=gh.a.create().toString();this.la.Vjg&&this.xFk(c,l,H,Sa);const eb={};eb.SlideShowKind=this.kb.Q8();eb.IsFrameNull=this.kb?"false":"true";eb.slideshowClickTimeMs=this.Vhc;void 0!==window.performance.timing&&null!==window.performance.timing&&
(eb.slideshowClickTimePerformanceAPI=this.Vhc-window.performance.timing.navigationStart);va.a.J(590976135,830,15,JSON.stringify(eb));this.kb.Srd(a,b,f,l,w,H,U,Sa,this.Vhc);0<this.iVg&&(this.qbd=window.setTimeout(Object(F.a)(this,this.Pzk,"onStartSlideshowTimeoutHandler"),this.iVg));this.Ub&&this.Ub.instance&&this.Ub.instance.Mgd(a,b,c,f,l,w,H,u.AFrameworkApplication.hh,ja);this.Hc&&this.Hc.h7k();wa&&(this.Hc.Lh=!1);Pd.a("PresenterCoachTabFix")&&this.kb.Sph()}jxa(a,b){if(b.key===A.a.X1)va.a.J(512495779,
830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.Bea.execute(c=>{c.remove()}),this.kb.exit();else if(b.key===A.a.gQb)this.ia.La(L.a.Itd,2,null);else if(b.key===A.a.Rwd&&this.la.pla&&this.Hc&&this.Hc.DDa&&this.Uo&&this.Tb&&!this.Uo.k4&&this.la.JXj&&this.Hc.fVf)try{this.Hc.Lh&&(ui.a.aK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",ui.a.FJ)||va.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));this.Hc.Lh=!this.Hc.Lh;
va.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Hc.Lh);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Hc.Lh?"prt2_SubtitleSlideShowToggleHover_40x40x32":"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr;if(f)this.kb.toggleTranscriberUIVisibility(null);else{let l=Date.now();
this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,4,l,this.Uo)}this.Bea.execute(l=>{l.setToolbarButtonToggleState(oh.a.SubtitlesButton,this.Hc.Lh);l.jD(oh.a.CoachButton,!this.Hc.Lh&&!f)})}catch(c){va.a.J(512495776,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",c)}else if(b.key===A.a.Rvc&&this.Ub&&this.Ub.instance&&this.Ub.instance.DDa&&this.Ub.instance.iWi&&this.Uo&&!this.Uo.k4)try{if(this.Ub.instance.dr)this.Ub.instance.showWelcomeScreen();
else{this.Ub.instance.$ca=!this.Hc.Lh;if(this.Hc.Fvb&&!this.Hc.Lh){this.Hc.Lh=!0;let c=Date.now();this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,5,c,this.Uo);this.Hc.Lh=!1}this.Ub.instance.qsc(4,u.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,this.Xa.podSessionId,u.AFrameworkApplication.hh)}}catch(c){va.a.J(512495775,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",c)}}Kxk(a,
b){b&&(a=b.slideIndex,a!==this.Ycc&&(this.Ycc=a,this.kb.uTa(a)))}mZa(){va.a.J(512495774,830,50,"OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.kxe=!0}xFk(a,b,c,f){va.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.dxg;this.Ds.nj(a,2,null,b,
!1,2,()=>{va.a.J(512495772,830,50,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{va.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,Jx.a("14"))}Fia(a){this.va.addHandler("OnExitSlideshow",a)}Wfa(a){this.va.removeHandler("OnExitSlideshow",a)}IPa(a){this.va.addHandler("OnPositionChangeEventId",
a)}Rib(a){this.va.removeHandler("OnPositionChangeEventId",a)}xai(a){this.DDb||(this.DDb=a,Yc.a.addHandler(window.document.body,"keydown",this.DDb))}HRe(){this.DDb&&(Yc.a.removeHandler(window.document.body,"keydown",this.DDb),this.DDb=null)}skc(){if(this.fu.m9)va.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.RFf();this.kb.NRe(Object(F.a)(this,this.mZa,"onVisibilityChangeHandler"));va.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");
var a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.gK);a=!!a&&"teams"===a.toLowerCase();this.kxe||this.ive||!document.hasFocus()||a||(va.a.J(512495768,830,50,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.Bea.execute(b=>{b.remove()}),this.kb.exit());this.kxe=!1}this.ive=!1}Jgd(a,b){b&&this.Ycc!==b.slideIndex&&(this.Ycc=b.slideIndex,this.YHa.U9k(b))}Gna(a,b){va.a.J(512495767,830,50,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.tGf();var c=["WACInnerFrame",
"WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.Wbc="";this.swa&&this.swa.Lqc(!1);this.Icd&&this.Icd.Lqc(!1);this.Hc&&this.Hc.A4k();this.kb.Wfa(Object(F.a)(this,this.Gna,"onExitHandler"));this.kb.ujh(Object(F.a)(this,this.pJa,"onFullscreenClickHandler"));this.kb.$ld(Object(F.a)(this,this.u7g,"onSlideshowReadyHandler"));this.kb.rjh(Object(F.a)(this,
this.tfd,"onErrorHandler"));this.kb.amd(Object(F.a)(this,this.jxa,"onSpecialKeyHandler"));this.kb.NRe(Object(F.a)(this,this.mZa,"onVisibilityChangeHandler"));this.kb.JRe(Object(F.a)(this,this.sgd,"onPodSessionExpiredHandler"));this.kb.wjh(Object(F.a)(this,this.Ufd,"onLogEndOfTranscriptionSessionHandler"));this.kb.vjh(Object(F.a)(this,this.Tfd,"onLiveSubtitlesDockedViewHandler"));this.kb.Ljh(Object(F.a)(this,this.nld,"recordQosErrorHandler"));this.HRe(Object(F.a)(this,this.Ofd,"onKeydownHandler"));
(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.sz.Tib(Object(F.a)(this,this.zfa,"onPodSessionRefreshed")),this.sz.Gjh(Object(F.a)(this,this.tgd,"onPodSessionRefreshedFromBrowser")));this.la.Qxh&&(Rr.a.XOb(!0),this.fu.m9||yG.a.K_a(u.AFrameworkApplication.isRtl));this.RFf();Vs.exitFullscreen();this.mu.style.top=this.kug;this.la.UUa&&(this.mu.style.width=this.lug,this.mu.style.height=this.jug);this.ut.Oq();
this.va.raiseEvent("OnExitSlideshow",b,a);this.Ub&&this.Ub.instance&&this.Ub.instance.Azk();this.Uo&&this.Uo.k4&&b.summary&&this.ia.La(L.a.rLa,2,b.summary);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.YHa&&this.YHa.Zdb&&this.ia.processAction(L.a.xKc,2,null);this.Uo&&(this.Uo.k4=!1);this.la.pptEditorVoiceUXEnabled&&this.Ll&&this.Ll.instance&&this.Ll.instance.remove();this.la.pptEditorVoiceUXEnabled&&this.ibd&&this.ibd.remove();this.hzl()}hzl(){u.AFrameworkApplication.fa.ka("798")&&
Ab.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{va.a.J(512495766,830,15,"Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}pJa(){this.ive=!0;this.fu.m9?Vs.exitFullscreen():this.Spg()}Spg(){this.fu.a$b&&(this.fu.n_&&!this.oE&&(this.oE=Object(F.a)(this,this.skc,"onFullscreenChangeHandler"),$addHandler(this.mu,this.fu.n_,this.oE)),this.fu.requestFullscreen(this.mu),this.kb.rvf(Object(F.a)(this,this.mZa,"onVisibilityChangeHandler")))}u7g(){this.tGf();
var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1!==this.kbd){b=Date.now();va.a.J(23098073,830,15,"slideshow ready in {0} ms",b-this.kbd);a={};a.SlideshowClickTimeMs=this.Vhc;a.SlideshowStartTimeMs=this.kbd;a.SlideshowStartFlushTimeMs=this.tCe;a.SlideshowFinishFlushTimeMs=this.sCe;a.SlideShowFinishedTimeMs=b;
a.NoBlockingOutBoundSetting=this.la.Wlg;a.NoBlockingOutBound=!this.Oyg;va.a.J(512495765,830,50,JSON.stringify(a));this.Bea.execute(()=>{this.la.x$b&&this.kb.getCurrentSlideDimensions()});!this.la.vg||!this.la.Sbh&&this.la.x$b||this.h8j.init(this.Hc,this.Uo);b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.CDa;a=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.eSa||this.Ub.instance.dr);if((this.la.pla||this.la.Jac)&&this.Hc&&this.Uo&&this.Tb&&(this.Hc.Lh||this.Uo.k4||b||a)&&this.Hc.fVf){const c=
Date.now();let f=2;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp&&(f=1);const l=this.Hc.Lh;b||a?(this.Hc.Lh||(f=5),this.Ub.instance.$ca=!this.Hc.Lh,this.Hc.Lh=!0):this.Ub&&this.Ub.instance&&(this.Ub.instance.$ca=!1);this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,f,c,this.Uo);this.Hc.Lh=l}b&&(this.Ub.instance.CDa=!1);this.HRe(Object(F.a)(this,this.Ofd,"onKeydownHandler"));this.kb.mga(!1);this.kb.setOsfLocalStorage()}}Ofd(a){27===
a.keyCode&&(va.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.HRe(Object(F.a)(this,this.Ofd,"onKeydownHandler")),this.Bea.execute(b=>{b.remove()}),this.kb.exit())}Ufd(a,b){a={};try{const c=pa.a.nL(b.Mx);for(const f of c)try{a[f]=b.Mx[f]}catch(l){va.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",f,l)}}catch(c){va.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",
c)}va.a.J(512495761,830,15,JSON.stringify(a));try{!(this.Uo&&this.Uo.k4||!this.la.uJk||this.lzg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(va.a.J(512495760,830,50,"Floodgate survey triggered for transcription."),this.lzg=!0,this.Ewa.continueWith(()=>{this.Ewa.result.logActivity("TranscriptionUsed","PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){va.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
c)}}Tfd(a,b){this.la.x$b||((a=document.getElementById("slideshow-toolbar"))?b.xac?"BelowSlide"===b.Vv?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.Vv?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):va.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}sgd(a,b){va.a.J(512495757,830,50,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",
b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Xa.podSessionId)va.a.J(512495756,830,15,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",this.Xa.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.VGg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);
const f=new Date,l=f>c;va.a.J(512495755,830,50,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(va.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",b.code),this.Sd.zs(Object.assign(new oi.a,{Code:223,Source:4}),b.podSessionId),0<this.TDe)){va.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",
this.TDe);this.VGg=new Date;this.HGg=b.podSessionId;this.Bcd=window.setTimeout(Object(F.a)(this,this.rXk,"rehydrationTimeout"),this.TDe);return}}else if(this.HGg===b.podSessionId){va.a.J(512495752,830,50,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",b.podSessionId);return}}u.AFrameworkApplication.zp(pf.a.Vh(359));dg.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],
!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(va.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Bea.execute(f=>{f.remove()}),this.kb.exit())}}tfd(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,b.code,b.sessionId,b.correlationId,b.message,b.Zy,b.xKj.toString());va.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",
a);u.AFrameworkApplication.zp(pf.a.Vh(359));dg.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(va.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Bea.execute(c=>{c.remove()}),this.kb.exit())}RFf(){this.oE&&(va.a.J(512495748,830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(this.mu,this.fu.n_,this.oE),this.oE=null)}Pzk(){va.a.J(512495747,
830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");u.AFrameworkApplication.zp(pf.a.Vh(360));dg.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.Bea.execute(a=>{a.remove()});this.kb.exit()}rXk(){va.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");u.AFrameworkApplication.zp(pf.a.Vh(371));dg.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",["SlideShowACE"],!1,!0,!0,!0,null);this.Bea.execute(a=>{a.remove()});this.kb.exit()}nld(a,
b){a=0<b.durationMs?Object.assign(new Nj.a,{durationMs:b.durationMs}):null;dg.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}zfa(a,b){va.a.J(512495745,830,50,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);this.wdb=!1;this.yGf();this.tac()||"Legacy"!=this.kb.Q8()?(va.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",
b.kY,this.Xa.qk),this.kb.refreshPodSession(b.kY,this.Xa.qk)):va.a.J(512495744,830,50,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}tgd(a,b){va.a.J(512495714,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);this.wdb=!1;this.yGf();this.tac()||"Legacy"!=this.kb.Q8()?(va.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",
b.kY,this.Xa.qk),this.kb.refreshPodSession(b.kY,this.Xa.qk)):va.a.J(512495713,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}Eo(){this.wdb=!1;va.a.J(512495711,830,50,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}GB(){this.wdb=!0;va.a.J(512495710,830,50,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}yHb(){this.wdb=!0;va.a.J(512495709,830,50,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}tGf(){-1!==this.qbd&&(window.clearTimeout(this.qbd),this.qbd=-1)}yGf(){-1!==this.Bcd&&(window.clearTimeout(this.Bcd),this.Bcd=-1)}}Object(n.a)(aK,"SlideshowManager",null,[338]);class mD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.Iva=
this.hec=this.Kfb=this.tCb=this.ddb=this.qWa=this.dEb=this.JEb=this.Uo=this.Hc=this.pe=null;this.kec=0;this.$L=!1;this.oE=null;this.kb=c;this.qe=f;this.PDe=l;this.kf=H;this.hu=U;this.Xa=wa;this.fu=Sa;this.ia=a;this.Ha=b;this.Tye=null;this.vAe=ja;this.Ub=w}init(a,b){this.pe=document.createElement("div");this.pe.id="slideshow-toolbar";this.pe.className="SlideshowToolbar";this.kf.appendChild(this.pe);this.Hc=a;this.Uo=b;this.hu()?(this.JEb=this.isa("buttonPrevSlide","navigationButton navigationButtonRtl",
"SlideShowNextServer",ResourceStrings.L_Next),this.dEb=this.isa("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.JEb=this.isa("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),this.dEb=this.isa("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.pe.appendChild(this.JEb);this.pe.appendChild(this.dEb);Yc.a.addHandler(this.JEb,
sa.a.click,Object(F.a)(this,this.zHb,"onPrevClickHandler"));Yc.a.addHandler(this.dEb,sa.a.click,Object(F.a)(this,this.uHb,"onNextClickHandler"));this.hec=this.isa("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.pe.appendChild(this.hec);Yc.a.addHandler(this.hec,sa.a.click,Object(F.a)(this,this.rHb,"onGridViewClickHandler"));this.ddb=this.qWa=null;this.fu.LDf&&(this.qWa=this.isa("buttonEnterFullscreen","navigationButton navigationButtonLtr",
"SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.ddb=this.isa("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.fu.m9,this.qWa.style.display=a?nf.a.Ff:nf.a.Wk,this.ddb.style.display=a?nf.a.Wk:nf.a.Ff,this.pe.appendChild(this.qWa),this.pe.appendChild(this.ddb),Yc.a.addHandler(this.qWa,sa.a.click,Object(F.a)(this,this.pJa,"onFullscreenClickHandler")),Yc.a.addHandler(this.ddb,sa.a.click,Object(F.a)(this,this.pJa,
"onFullscreenClickHandler")),this.fu.n_&&!this.oE&&(this.oE=Object(F.a)(this,this.skc,"onFullscreenChangeHandler"),$addHandler(this.kf,this.fu.n_,this.oE)));this.Kfb=null;this.Hc.Fvb&&!this.Uo.k4&&(this.Kfb=this.isa("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),this.pe.appendChild(this.Kfb),Yc.a.addHandler(this.Kfb,sa.a.click,Object(F.a)(this,this.$gd,"onTranscribeHandler")));this.tCb=this.isa("buttonExitSlideShow","navigationButton navigationButtonLtr",
"ExitSlideShowServer",ResourceStrings.L_EndShow);this.pe.appendChild(this.tCb);Yc.a.addHandler(this.tCb,sa.a.click,Object(F.a)(this,this.qHb,"onExitClickHandler"));this.Iva=null;this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&!this.Uo.k4&&(this.Ub.instance.mvf(Object(F.a)(this,this.Ckc,"onLiveSessionStarted")),this.Ub.instance.kvf(Object(F.a)(this,this.Bkc,"onLiveSessionEnded")),this.Ub.instance.V$h(Object(F.a)(this,this.h5g,"onLiveCalloutDismissed")),this.Ub.instance.ivf(Object(F.a)(this,this.Akc,
"onLiveRelaunchPausedSession")),this.Ub.instance.M8a?this.aLf():this.Ub.instance.Oai(Object(F.a)(this,this.j5g,"onLivePresenterResourcesLoaded")));this.$L=!1;this.hide();this.kb.Fia(Object(F.a)(this,this.Gna,"onExitHandler"));this.kb.XPd(Object(F.a)(this,this.Sgb,"onBrowserEventHandler"));Yc.a.addHandler(this.pe,sa.a.mq,Object(F.a)(this,this.ahb,"onMouseOverHandler"));Yc.a.addHandler(this.pe,sa.a.Ns,Object(F.a)(this,this.Ekc,"onMouseOutHandler"))}show(){this.pe.style.display=nf.a.Wk;window.clearTimeout(this.kec);
this.kec=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3);this.kb.mga(!0)}hide(){this.$L||(window.clearTimeout(this.kec),this.pe.style.display=nf.a.Ff,this.kb.mga(!1))}remove(){this.pe&&this.kf.contains(this.pe)&&(this.kf.removeChild(this.pe),this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&(this.Ub.instance.Bjh(Object(F.a)(this,this.Ckc,"onLiveSessionStarted")),this.Ub.instance.Ajh(Object(F.a)(this,this.Bkc,"onLiveSessionEnded")),this.Ub.instance.c_k(Object(F.a)(this,this.h5g,"onLiveCalloutDismissed")),
this.Ub.instance.H_k(Object(F.a)(this,this.j5g,"onLivePresenterResourcesLoaded")),this.Ub.instance.yjh(Object(F.a)(this,this.Akc,"onLiveRelaunchPausedSession"))),this.$L=!1)}jD(){}setToolbarButtonToggleState(){}Gna(){this.kb.Wfa(Object(F.a)(this,this.Gna,"onExitHandler"));this.kb.DRe(Object(F.a)(this,this.Sgb,"onBrowserEventHandler"));Yc.a.removeHandler(this.pe,sa.a.mq,Object(F.a)(this,this.ahb,"onMouseOverHandler"));Yc.a.removeHandler(this.pe,sa.a.Ns,Object(F.a)(this,this.Ekc,"onMouseOutHandler"));
Yc.a.removeHandler(this.JEb,sa.a.click,Object(F.a)(this,this.zHb,"onPrevClickHandler"));Yc.a.removeHandler(this.dEb,sa.a.click,Object(F.a)(this,this.uHb,"onNextClickHandler"));Yc.a.removeHandler(this.tCb,sa.a.click,Object(F.a)(this,this.qHb,"onExitClickHandler"));this.Iva&&Yc.a.removeHandler(this.Iva,sa.a.click,Object(F.a)(this,this.g5g,"onLiveBroadcastHandler"));this.Kfb&&Yc.a.removeHandler(this.Kfb,sa.a.click,Object(F.a)(this,this.$gd,"onTranscribeHandler"));this.qWa&&(Yc.a.removeHandler(this.qWa,
sa.a.click,Object(F.a)(this,this.pJa,"onFullscreenClickHandler")),Yc.a.removeHandler(this.ddb,sa.a.click,Object(F.a)(this,this.pJa,"onFullscreenClickHandler")),$removeHandler(this.kf,this.fu.n_,this.oE),this.oE=null);this.hec&&Yc.a.removeHandler(this.hec,sa.a.click,Object(F.a)(this,this.rHb,"onGridViewClickHandler"));this.remove()}Sgb(){this.show()}skc(){const a=this.fu.m9;this.qWa.style.display=a?nf.a.Ff:nf.a.Wk;this.ddb.style.display=a?nf.a.Wk:nf.a.Ff}ahb(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?
a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.$L=!0}Ekc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Hc.Lh&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Ub&&!this.Ub.instance.dr&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.g3d()||(this.$L=!1);this.g3d()||this.kb.restoreFocus()}zHb(){va.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.t1a(this.JEb.title);
this.kb.prev();this.kb.restoreFocus()}uHb(){va.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.t1a(this.dEb.title);this.kb.next();this.kb.restoreFocus()}qHb(){va.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");this.t1a(this.tCb.title);this.kb.exit()}pJa(){va.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.kb.P2e()}g5g(){this.Ub&&this.Ub.instance&&(this.t1a(this.Iva.title),va.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ub.instance.dr),
this.Ub.instance.dr?(this.kb.pausePresentation(),this.Ub.instance.showCallout(this.Iva)):(this.Ub.instance.qsc(3,u.AFrameworkApplication.userSessionId,this.vAe,this.Xa.podSessionId,u.AFrameworkApplication.hh),this.Ub.instance.$ca=!this.Hc.Lh,this.Hc.Fvb&&!this.Hc.Lh&&(va.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Lh=!0,this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,5,Date.now(),
this.Uo),this.Hc.Lh=!1)),this.z5e())}S2e(a,b){this.t1a(this.Kfb.title);const c=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr,f=this.Hc.dVf&&5!==a&&!c;5!==a&&(this.Hc.Lh=!this.Hc.Lh);va.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",this.Hc.Lh);b&&(this.Hc.Lh?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&Hz.Ppg(this.kb,this.qe,this.Xa)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.kb.toggleTranscriberUIVisibility(null):
this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,a,b,this.Uo))}$gd(a){this.S2e(3,a.target)}rHb(){va.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.La(L.a.XMb,2,null)}aLf(){this.Iva||(this.Iva=this.isa("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.pe.insertBefore(this.Iva,this.tCb),Yc.a.addHandler(this.Iva,sa.a.click,
Object(F.a)(this,this.g5g,"onLiveBroadcastHandler")))}isa(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=wp.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Hc.Lh?"Hover_40x40x32":"Off_40x40x32"),"prt2",this.qe.rk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=wp.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Ub&&this.Ub.instance&&this.Ub.instance.dr?
"Hover_40x40x32":"_40x40x32"),"prt2",this.qe.rk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.Tye=a.children[0]),l;a=wp.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.qe.rk("prt2.png"),null,null,!0,null);l.appendChild(a);l.title=f;return l}t1a(a){ha.a.Wa(a)?va.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.PDe.Kfh(new Ix(a))}g3d(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.xWi}z5e(){this.Ub&&
this.Ub.instance&&this.Tye&&(this.Tye.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Ub.instance.dr?"Hover_40x40x32":"_40x40x32"))}j5g(){this.aLf()}Ckc(){this.z5e()}Bkc(){this.Ub&&this.Ub.instance&&this.Ub.instance.$ca&&!this.Hc.Lh&&(va.a.J(41682899,830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.qk,u.AFrameworkApplication.hh,5,Date.now(),this.Uo));this.Ub.instance.$ca=!1;this.z5e()}Akc(){this.Ub&&
this.Ub.instance&&(this.$L=!0,this.show(),this.kb.pausePresentation(),this.Ub.instance.showCallout(this.Iva))}h5g(){this.$L=this.g3d();this.$L||(window.clearTimeout(this.kec),this.kec=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3))}}Object(n.a)(mD,"SlideshowToolbar",null,[1023,1022]);class lu{constructor(a){this.KCb=this.N0=this.aGb=null;this.MCe="BelowSlide";this.fdb=this.myg=!1;this.Odc=!0;this.F5c=-1;this.Myg=this.Bdc=this.fve=!1;this.PAe=this.OCe=this.QCe=this.PCe=null;this.la=a;u.AFrameworkApplication.fa.ff(Object(F.a)(this,
this.Qm,"onFullAppSettingsReady"));a=Jc.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.Etg=a.Ring||"Unknown";this.aug=u.AFrameworkApplication.buildVersion||"Unknown";this.jHg=this.la.NJa||"Unknown";this.PXg=a.Host||"Unknown";this.OXg=a.WACDatacenter||"Unknown";this.bVg=this.a9i();this.wic=this.d9i();this.SWg=this.qVc();this.ACb=lu.i6e;switch(this.la.Kyl){case "ByUIHostName":a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.gK);this.fdb=!(!a||"teams"!==a.toLowerCase());
break;case "ByAppIsEmmbeded":this.fdb=u.AFrameworkApplication.isEmbedded;break;default:this.fdb=u.AFrameworkApplication.fa.ka("IsUIEmbedMode")}va.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",this.ACb,this.MCe)}Qm(){this.aGb=this.getUserId();this.N0=u.AFrameworkApplication.fa.Ga("TenantId");this.KCb=this.la.hostAuthType||u.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown"}getUserId(){let a=u.AFrameworkApplication.fa.Ga("PptEditingUserId");ha.a.Wa(a)&&
(a=u.AFrameworkApplication.fa.Ga("LoggableUserId"),va.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",ha.a.Wa(a)));return a}get b4b(){return this.myg}set b4b(a){va.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",a);this.myg=a}get Lh(){return this.la.pla&&this.b4b&&this.ACb&&!this.fdb}set Lh(a){this.ACb!==a&&(this.ACb=a,lu.i6e=this.ACb)}get a4b(){return this.la.pla&&this.Bdc}set a4b(a){this.Bdc!==a&&(this.Bdc=a)}get yVf(){return this.Myg}get fVf(){return!this.fdb}get Lvb(){return this.fve}set Lvb(a){this.fve!==
a&&(this.fve=a)}get Fvb(){return this.la.pla&&this.b4b&&this.la.GXj&&!this.fdb}get dVf(){const a=ui.a.get("PPTLiveSubtitleEnabled");return this.la.pla&&this.la.LXj&&ha.a.Wa(a)&&!this.fdb}get K0e(){if(!this.OCe){const b=new Ka.a;var a=this.la.Hbh;if(!ha.a.Wa(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.OCe=lu.Fwf(b)}return this.OCe}get J0e(){if(!this.PAe){const b=new Ka.a;var a=this.la.Hbh;if(!ha.a.Wa(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.PAe=
lu.Fwf(b)}return this.PAe}get ONb(){this.PCe||(this.PCe=ha.a.Wa(this.la.Ibh)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.Ibh,!0));return this.PCe}get t_e(){this.QCe||(this.QCe=lu.oei(this.ONb));return this.QCe}h7k(){this.F5c=this.ACb?1:0}A4k(){-1!==this.F5c&&(this.Lh=1===this.F5c?!0:!1,this.F5c=-1)}a9i(){try{const a=Xa.a.xe(u.AFrameworkApplication.lcid);if(!a)return va.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",
u.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.K0e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.J0e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;this.Bdc=!0;return"en-us"}catch(a){va.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}this.Bdc=!0;return"en-us"}d9i(){try{const a=Xa.a.xe(u.AFrameworkApplication.lcid);
if(!a||ha.a.Wa(a.name))return va.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en";const b=a.name.toLowerCase();if(!ha.a.Wa(b)&&this.ONb[b])return b;const c=Xa.a.xe(a.languageId);if(!c||ha.a.Wa(c.name))return va.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),
"en";let f=c.name.toLowerCase();this.ONb[f]||(va.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",b,f,u.AFrameworkApplication.lcid),f="en");return f}catch(a){va.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",
u.AFrameworkApplication.lcid,a)}return"en"}qVc(){try{if(ha.a.Wa(this.wic))return va.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",u.AFrameworkApplication.lcid),"en-us";const a=this.ONb[this.wic.toLowerCase()];if(!ha.a.Wa(a))return a}catch(a){va.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.wic,u.AFrameworkApplication.lcid,
a)}return"en-us"}y6i(a){if(ha.a.Wa(a))return va.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return va.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",a),null;b=b[0];const c=this.ONb;var f=this.t_e;for(let l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;va.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",
a);return null}get Zoa(){return this.bVg}set Zoa(a){this.bVg=a;this.Myg=!0}get userId(){return this.aGb}set userId(a){this.aGb=a}get locale(){return this.jHg}set locale(a){this.jHg=a}get audienceGroup(){return this.Etg}set audienceGroup(a){this.Etg=a}get buildVersion(){return this.aug}set buildVersion(a){this.aug=a}get identityProvider(){return this.KCb}set identityProvider(a){this.KCb=a}get wacHost(){return this.PXg}set wacHost(a){this.PXg=a}get wacDatacenter(){return this.OXg}set wacDatacenter(a){this.OXg=
a}get tenantId(){return this.N0}set tenantId(a){this.N0=a}get xza(){return this.wic}set xza(a){this.wic=a}get Nlb(){return this.SWg}set Nlb(a){this.SWg=a}get Vv(){return this.MCe}set Vv(a){this.MCe=a}get ntl(){const a={};a.UserId=this.userId;a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.Vv;a.SpeechLanguage=this.Zoa;
a.TranslationLanguages=this.Nlb;a.FUseSubtitles=this.Lh;return JSON.stringify(a)}get DDa(){return this.Odc}set DDa(a){this.Odc=a}get pWi(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.xza)}static get i6e(){const a=ui.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set i6e(a){ui.a.aK("PPTLiveSubtitleEnabled",a.toString(),ui.a.FJ)||va.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static Fwf(a){const b={},
c=new Ka.a;for(let f of a)try{const l=Xa.a.xe(f).displayName;c.add(l);b[l]=f}catch(l){va.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));a=new Ka.a;for(let f of c)f&&0<f.length&&a.add(b[f]);return a}static oei(a){const b=pa.a.nL(a);a={};const c=new Ka.a;for(var f of b)try{const l=Xa.a.xe(f).displayName;ha.a.Wa(l)?va.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",
f,u.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){va.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((l,w)=>l.localeCompare(w));f=new Ka.a;for(let l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(n.a)(lu,"SubtitleContext",null,[333]);const nD=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),
-1!==a.indexOf("windows")?(a=bK(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?(a=bK(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},bK=(a,b)=>
(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class cK{constructor(a){this.Qo=a}Bki(){return nD()}Aki(){let a=!1;const b=this.Bki();if(b&&!this.Qo.eO(1))try{const c=document.createElement("canvas"),f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}va.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.Qo.Wy,
["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(n.a)(cK,"WebGLHelperProxy",null,[332]);var dK=d(646),MQ=d(732);class oD{constructor(){this.la=this.qb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}Zb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.qb=b.FF();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(331,"PowerPointWebEditor.IFullscreenHelper").ma().oa(()=>new TJ);this.K.register(332,"PowerPointWebEditor.IWebGLHelper").ma().oa(()=>
new cK(this.K.resolve("Common.IBrowserUtils")));this.K.register(333,"PowerPointWebEditor.ISubtitleContext").ma().oa(()=>new lu(this.la));this.K.register(334,"PowerPointWebEditor.IRehearsalContext").ma().oa(()=>new Gz);this.Kbc({["Type"]:"CheckBrowserStart"});a={};var c=this.xLj(a);const f=nD()&&this.la.aVa&&c&&this.wLj(),l=this.la.aVa&&this.vLj(),w=!f&&l;this.Kbc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:f||l,["IsModernWebGLSupportedBrowser"]:f,["IsModernSupportedBrowser"]:l,["IsBrowserShapeBuilderCompatible"]:c,
["log"]:a,["useSvg"]:w});if(this.la.ka("DefaultToModernSlideShow")&&(f||l)){this.K.register(335,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>new MQ.SlideShowCoreFrame(this.qb,this.la,this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw,this.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Ja("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),
w,this.K.resolve("PowerPoint.IPathManager"),this.K.Ja("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,u.AFrameworkApplication.Ke));const wa={};wa.loadScriptStart=Date.now();a=gD.a.create(u.AFrameworkApplication.Bj("powerpoint-slideshow-strings",3));nl.a.fy(a);Promise.all([new Promise((Sa,eb)=>{const ub=document.createElement("script");ub.async=!1;ub.src=u.AFrameworkApplication.Bj(String.format("slideshowcore{0}.js",
".min"),5);ub.addEventListener("load",()=>{va.a.J(509636759,830,50,"Loaded slideshowcore");Sa(ub)});ub.addEventListener("error",()=>{va.a.J(509636758,830,50,"Failed to load slideshowcore");eb(ub)});document.head.appendChild(ub)}),new Promise((Sa,eb)=>{const ub=document.createElement("script");ub.async=!1;ub.src=u.AFrameworkApplication.Bj(String.format("podsproxy{0}.js",".min"),5);ub.addEventListener("load",()=>{va.a.J(509636757,830,50,"Loaded podsproxy");Sa(ub)});ub.addEventListener("error",()=>{va.a.J(509636756,
830,50,"Failed to load podsproxy");eb(ub)});document.head.appendChild(ub)}),new Promise((Sa,eb)=>{const ub=document.createElement("script");ub.async=!1;ub.src=u.AFrameworkApplication.Bj(String.format("pptspeechclient{0}.js",".min"),5);ub.addEventListener("load",()=>{va.a.J(509636755,830,50,"Loaded pptspeechclient");Sa(ub)});ub.addEventListener("error",()=>{va.a.J(509636754,830,50,"Failed to load pptspeechclient");eb(ub)});document.head.appendChild(ub)})]).then(()=>{wa.loadScriptEnd=Date.now();const Sa=
{Type:"LoadedJS"};pa.a.forEach(wa,(eb,ub)=>{Sa[eb]=ub},null);this.Kbc(Sa);this.K.resolve("PowerPointWebEditor.ISlideshowManager").xyg||(va.a.J(509636753,830,50,"Initializing SlideShowCoreFrame on package registration"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(u.AFrameworkApplication.buildVersion,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").qk,u.AFrameworkApplication.userSessionId,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),
this.K.resolve("PowerPointWebEditor.ISlideshowManager").idl());return null}).catch(Sa=>{this.Kbc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});va.a.J(512309318,830,10,"LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Sa)})}else this.la.ka("DefaultToModernSlideShow")?this.Kbc({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):va.a.J(512309319,830,50,"PptDefaultToModernSlideShow is disabled"),this.K.register(335,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>
new LQ.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.qb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Ja("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw));this.K.register(jD,"PowerPointWebEditor.SlideShowFooterContainer").oa(()=>new jD(this.qb,
u.AFrameworkApplication.Ta));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").wb();let H;if(!this.la.x$b||this.la.Sbh)this.K.register(mD,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>new mD(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ja("PowerPointLive.ILivePresenter"),this.qb,()=>
u.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=ix.a(this.K);c=new Ka.a;c.add(a("slideshowToolbar"));this.la.eJk&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Sa=>va.a.J(50907106,830,10,"Failed to load the resources for the slideshowToolbar feature: {0}",Sa)).then(()=>this.Izk()).catch(Sa=>va.a.J(50907136,
830,10,"Failed to load the React slideshowToolbar: {0}",Sa));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Sa=>va.a.J(51218050,830,10,"Failed to load the resources for the ink button feature: {0}",Sa)).then(()=>this.Lvk()).catch(Sa=>va.a.J(51218052,830,10,"Failed to load the React ink button: {0}",Sa)),this.K.register(336,"PowerPointWebEditor.IInkButtonHelper").ma().oa(()=>new UJ));if(this.la.pptEditorVoiceUXEnabled){const Sa=this;a("voiceUI").catch(eb=>va.a.J(595198419,830,10,"Failed to load the resources for the voice UI feature: {0}",
eb)).then(()=>Sa.Jzk()).catch(eb=>va.a.J(595198417,830,10,"Failed to load the voice UI script: {0}",eb));this.K.register(337,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().oa(()=>new $J)}const wa=this;this.K.register(iD,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>new iD(u.AFrameworkApplication.Ta,wa.la,wa.K.resolve("PowerPointWebEditor.ISlideshowFrame"),wa.K.resolve("PowerPoint.IPathManager"),wa.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
wa.K.Ja("PowerPointLive.ILivePresenter"),wa.qb,()=>u.AFrameworkApplication.isRtl,wa.la.podsWebServiceBase,wa.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),wa.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}H=this.K.Ja("PowerPointWebEditor.ISlideshowToolbar");const U=this;this.K.register(lD,"PowerPointWebEditor.SlideshowContextMenu").oa(()=>new lD(U.K.resolve("PowerPointWebEditor.ISlideshowFrame"),U.K.resolve("PowerPointWebEditor.IPresentationReader"),U.K.resolve("PowerPointWebEditor.IInputHandlerManager"),
u.AFrameworkApplication.Ta,U.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),U.qb,()=>u.AFrameworkApplication.isRtl,U.K.resolve("PowerPointWebEditor.IFullscreenHelper"),U.K.Ja("PowerPointLive.ILivePresenter")));const ja=this;this.K.register(338,"PowerPointWebEditor.ISlideshowManager").ma().oa(()=>new aK(ja.K.resolve("PowerPointWebEditor.IFullscreenHelper"),ja.K.resolve("PowerPointWebEditor.ISlideshowFrame"),H,ja.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),ja.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
u.AFrameworkApplication.Ke,ja.la,b,ja.K.resolve("PowerPointWebEditor.IPresentationReader"),ja.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ja.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ja.K.resolve("PowerPointWebEditor.IErrorHandler"),Ab.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),ja.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ja.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),Uq.a.av(Ab.a.instance.Ja("Common.ISystemInitiatedFeedback")),u.AFrameworkApplication.Ta,
Ab.a.instance.Ja("PowerPointLive.ILivePresenter"),ja.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),ja.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification")))}Kbc(a){va.a.J(594583632,830,15,JSON.stringify(a))}wLj(){const a=this.la.Ga("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ga("SessionStartInfoJson").toString());va.a.J(512309317,830,50,"IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===
(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return va.a.J(512309316,830,50,"IsBrowserModernWebGLCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}vLj(){const a=this.la.Ga("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ga("SessionStartInfoJson").toString());va.a.J(512309315,830,50,"IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===
(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return va.a.J(512309314,830,50,"IsBrowserModernCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}xLj(a){return dK.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(F.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){db.a.get_instance().Uj(10,null).continueWith(()=>{if(!this.la.GQ&&this.la.Obh&&this.la.xKk)try{Uq.a.av(Ab.a.instance.Ja("Common.ISystemInitiatedFeedback")).continueWith(a=>
{a.result.logActivity("HasPresentButtonSeen","PresentTeachingUIEnabled")}),va.a.J(512495957,830,50,"Present Teaching UI triggered")}catch(a){va.a.J(512495956,830,10,"Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}Izk(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}Lvk(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}Jzk(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");return null}dispose(){}static main(){v.a.instance.Dc(new oD)}}
Object(n.a)(oD,"PPTWebEditorSlideShowPackage",null,[2,3]);var NQ=d(782);class eK{constructor(){this.mdc=null}iml(a,b){sj.UISurfaces.oL().then(c=>{this.mdc=a.yOi(c,a.GGi(b),b,this.mdc)});va.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}cYk(a){sj.UISurfaces.oL().then(b=>{this.mdc=a.SXk(b,this.mdc)});va.a.J(523871965,843,50,"{0} Toast is removed",this.mdc)}}Object(n.a)(eK,"DeferredNotificationCalloutVisibilityManager",null,[]);var fK=d(1029);const OQ=a=>{const b={featureArea:"Partial Presentation"};
b.sourceContext=a;a={};a.telemetryGroup=b;return a},PQ=(a,b,c,f)=>{const l=new Bi.StandardDialog;l.yd=0;if(u.AFrameworkApplication.UE){const w=OQ(b);l.cPd(ResourceStrings.L_GiveFeedback,void 0,void 0,w)}l.Gx(c,f,0,a?w=>{1===w?(va.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):va.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class pD{constructor(a,b,c,f,l,w,H){this.L9={};this.uwa=new qd.a;this.s$c=this.QAe=null;this.T8c=this.eze=0;this.oyg=!1;this.Iad={};if(!H)throw Error.argumentNull("coreEventSource");
this.kM=a;this.Gq=c;this.kM.kk(Object(F.a)(this,this.S6g,"onShapeNodePropertyChanged"));this.kM.Gia(Object(F.a)(this,this.Skc,"onShapeNodeLoaded"));this.kM.Eia(Object(F.a)(this,this.R6g,"onShapeNodeConnected"));this.Mvg=new eK;this.Pg=l;b.NPd(Object(F.a)(this,this.DHe,"onClientError"));b.kQd(Object(F.a)(this,this.mJe,"onServerError"));u.AFrameworkApplication.RGc(Object(F.a)(this,this.aIe,"onErrorDialogDisplayed"));this.Ywg=f;this.bma=w;this.ei=H;this.ei.iC(Object(F.a)(this,this.G6g,"onSessionRehydratedHandler"))}uuf(a,
b){this.uwa.Gb(a)||this.uwa.$(a,new Ua.a);const c=this.uwa.ga(a);c.add(b);this.uwa.$(a,c)}sih(a,b){if(this.uwa.Gb(a)){var c=this.uwa.ga(a);c.remove(b);this.uwa.$(a,c);this.vce(a)||this.uwa.remove(a);zq.a(this.L9).length||va.a.J(509150993,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else va.a.J(509150994,843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",a,b)}vce(a){return this.uwa.Gb(a)&&
0<this.uwa.ga(a).count}cFf(a){if(a.slideId&&a.slideId.sid&&a.B2c){var b=a.B2c;a.d4?(this.oyg||(this.oyg=!0,va.a.J(509150992,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.bma)),b in this.L9||(this.L9[b]=new Date),this.uuf(a.slideId.sid.toString(),b)):b in this.L9&&(delete this.L9[b],this.sih(a.slideId.sid.toString(),b),va.a.J(509150991,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}Skc(a,b){(a=
Object(qa.a)(4,b.node))?this.cFf(a):va.a.J(509150990,843,10,"IDeferrable object is null")}R6g(a,b){(a=Object(qa.a)(4,b.node))?this.cFf(a):va.a.J(509150989,843,10,"IDeferrable object is null")}S6g(a,b){var c=Object(qa.a)(4,b.node);if(!c)va.a.J(509150988,843,10,"IDeferrable object is null");else if((b.property===hb.a.d4||this.bma&&c.B2c in this.L9&&!c.d4)&&c.slideId)if(b=c.B2c,a=c.slideId.sid.toString(),c.d4)b in this.L9?va.a.J(509150987,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",
b,this.bma):(va.a.J(509150986,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.bma),this.L9[b]=new Date,this.uuf(a,b));else{if(c=this.L9[b])c=(new Date).getTime()-c.getTime(),va.a.J(509150985,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.bma),delete this.L9[b],this.sih(a,b),this.T8c=c>this.T8c?c:this.T8c;this.Ywg&&!this.hasDeferredContent()&&(va.a.J(509150984,843,50,"All deferred blobs loaded"),this.wra("AllDeferredBlobsLoaded","true"),this.s$c&&
(va.a.J(509150983,843,50,"Previously called user requested actions triggered"),this.wra("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.s$c(),this.Mvg.cYk(this.QAe),this.QAe=this.s$c=null))}}G6g(){va.a.J(509150982,843,50,"Session rehydrated with {0} currently deferred blobs",zq.a(this.L9).length)}UYe(a,b,c){this.Ywg?(this.QAe=b,this.s$c=c,this.Mvg.iml(b,this.Pg)):(c=Object(Ya.a)(fK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,
b=Object(Ya.a)(fK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,PQ(null,a.toString(),c,b));va.a.J(509150979,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}wra(a,b){this.Iad[a]&&va.a.J(509150978,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",a,this.Iad[a]);this.Iad[a]=b}DHe(a,b){this.eoa("ClientError",b)}mJe(a,b){this.eoa("ServerError",b)}aIe(a,b){(a=Object(qa.a)(NQ.a,b))&&
this.eoa("Crash",a.errorCode)}eoa(a,b){this.hasDeferredContent()&&va.a.J(509150977,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.bma)}dispose(){this.kM.Rm(Object(F.a)(this,this.S6g,"onShapeNodePropertyChanged"));this.kM.m_a(Object(F.a)(this,this.Skc,"onShapeNodeLoaded"));this.kM.qoa(Object(F.a)(this,this.R6g,"onShapeNodeConnected"));this.ei.Xfa(Object(F.a)(this,this.G6g,"onSessionRehydratedHandler"));this.log()}hasDeferredContent(){const a=
zq.a(this.L9),b=this.bma&&0<a.length||0<this.Gq.Y7a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.Gq.Y7a.toString();c.FForceShowDeferralUI=this.bma.toString();va.a.J(509150976,843,50,JSON.stringify(c));this.eze=Math.max(this.Gq.Y7a,this.eze)}return b}Xyj(a){return Qa.a.any(a,b=>b.hasDeferredContent)?(va.a.J(509150947,843,50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.bma),!0):!1}uce(a,b){return Qa.a.any(a,c=>c.d4)?(va.a.J(509150946,
843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.bma),!0):!1}log(){const a=zq.a(this.L9),b={};b.MaxDeferredTime=this.T8c.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.eze.toString();b.FForceShowDeferralUI=this.bma.toString();va.a.J(509150945,843,15,"SessionLogs: {0}, PersistedLogs: {1}",JSON.stringify(b),JSON.stringify(this.Iad))}}Object(n.a)(pD,"DeferredContentManager",null,[382]);class qD{constructor(){this.Bw=this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}Zb(a){this.K=
a;this.K.register(pD,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().oa(()=>new pD(this.K.resolve("Box4.Graph.IGraphInstance").xd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),this.K.resolve("Common.IF6Manager"),0<this.K.resolve("Common.IAppSettingsManager").Bc("ForceShowDeferralUIMS",0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.Bw=
this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.Bw&&this.Bw.dispose()}static main(){v.a.instance.Dc(new qD)}}Object(n.a)(qD,"PPTWebEditorPartialDocPackage",null,[2,3]);class Dv{constructor(a,b){this.shapeNode=a;this.position=b}}Object(n.a)(Dv,"MoveShapeData",null,[]);class gK{constructor(a,b){this.EO=null;this.vp=a;this.ia=b}start(){this.EO=[];for(let a=0;a<this.vp.length;++a)Array.add(this.EO,new gd.a(this.vp[a].x,this.vp[a].y)),this.vp[a].SD(!1)}CUd(a,b){if(1!==a||this.vp.length!==
b.length)return!1;for(a=0;a<b.length;a++)if(!this.KNj(b[a]))return!1;return!0}KNj(a){for(let b=0;b<this.vp.length;b++)if(a.gb.equals(this.vp[b].gb))return!0;return!1}perform(a){for(let c=0;c<this.vp.length;c++){var b=new gd.a(this.vp[c].x,this.vp[c].y);b=gd.a.add(b,a);this.vp[c].setPosition(b.x,b.y,!0)}}end(){this.EO&&va.a.J(17597603,815,50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",this.vp.length,this.vp[0].x-this.EO[0].x,this.vp[0].y-this.EO[0].y);const a=[];
for(let b=0;b<this.vp.length;++b){const c=this.vp[b].hSc();Array.add(a,new Dv(this.vp[b].shapeNode,c));this.vp[b].Xz(!1)}this.ia.La(L.a.YIa,2,a)}}Object(n.a)(gK,"ShapeMoveAction",null,[1059]);class Iz{constructor(a,b,c=null,f=null){this.F1=a;this.p1=b;this.$2b=c;this.w_g=f}}Object(n.a)(Iz,"ResizeShapeData",null,[]);class hK{constructor(a,b){this.kGa=this.NBb=this.DCe=null;this.cG=a;this.ia=b}start(){this.DCe=[];this.NBb=[];this.kGa=[];for(const c of this.cG){c.EL=!0;c.SD(!1);Array.add(this.DCe,c.TYa);
Array.add(this.NBb,new Xi.a);var a=c.xwb(),b=gd.a.lm(a.sk(ne.a.Ru),a.sk(ne.a.DE));a=gd.a.lm(a.sk(ne.a.Ru),a.sk(ne.a.RH));Array.add(this.kGa,a?b/a:1);c.shapeNode.If&&c.shapeNode.isEditable&&(b=c,b.Ok&&(b.Ok.visible=!0))}}CUd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].Al||!b[a].gb.equals(this.cG[a].gb))return!1;return!0}perform(a,b){for(let f=0;f<this.cG.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.QEl(c,l,f));let w;(w=this.NBb[f]).right=w.right+c;let H;(H=this.NBb[f]).bottom=H.bottom+
l;this.cG[f].setOffsets(Xi.a.add(this.DCe[f],this.NBb[f]),!0);this.cG[f].shapeNode.If&&this.cG[f].shapeNode.isEditable&&(c=this.cG[f],c.$ce(),c.LWc())}}QEl(a,b,c){if(!this.cG[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.kGa[c]:b=a/this.kGa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.cG.length;b++)this.cG[b].Al||(this.cG[b].shapeNode.If&&this.cG[b].shapeNode.isEditable||(this.cG[b].EL=!1),this.cG[b].Xz(!1),Array.add(a,new Iz(this.cG[b].shapeNode,this.NBb[b])));
this.ia.La(L.a.fjb,2,a);this.cG=null}}Object(n.a)(hK,"ShapeResizeAction",null,[1059]);class ap{constructor(a,b){this.shapeNode=a;this.x_d=b%ap.ilc}}ap.ilc=360;Object(n.a)(ap,"ShapeRotateData",null,[]);class iK{constructor(a,b){this.Eug=null;this.Kpe=0;this.Zd=a;this.ia=b}start(){this.Zd.SD(!1);this.Eug=this.Zd.xwb().Vf()}CUd(a,b){return 3===a&&!this.Zd.Al&&this.Zd.gb.equals(b[0].gb)}perform(a){this.Kpe=(this.Zd.rotation+a)%ap.ilc;this.Zd.setRotation(this.Kpe,this.Eug)}end(){if(!this.Zd.Al){this.Zd.Xz(!1);
var a=new ap(this.Zd.shapeNode,this.Kpe);this.ia.La(L.a.Cpc,2,a)}}}Object(n.a)(iK,"ShapeRotateAction",null,[1059]);class Bp{constructor(a){this.KIa=this.TQ=null;this.ia=a}Ruc(){this.KIa&&Rc.a.Btb(this.KIa);this.KIa=Rc.a.Faa(Object(F.a)(this,this.pSf,"endAction"),Bp.Ioi)}W1d(a,b){this.TQ&&!this.TQ.CUd(a,b)&&(this.TQ.end(),this.TQ=null);if(!this.TQ){this.TQ=this.I3i(a,b);if(!this.TQ)throw Error.invalidOperation("Could not create keyboard action");this.TQ.start()}this.Ruc();return this.TQ}pSf(){this.TQ&&
(this.TQ.end(),this.TQ=null);this.KIa=null}move(a,b){a=this.W1d(1,a);b=this.sPf(b);a.perform(b)}resize(a,b){a=this.W1d(2,a);b=this.sPf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.W1d(3,a);c=c?Bp.yoi:Bp.xoi;a.perform(b?c:-1*c)}sPf(a){let b=0,c=0;a.equals(ne.a.north)?c=-1*Bp.dJc:a.equals(ne.a.east)?b=Bp.dJc:a.equals(ne.a.south)?c=Bp.dJc:a.equals(ne.a.west)&&(b=-1*Bp.dJc);return new gd.a(b,c)}I3i(a,b){return b?1===a?new gK(b,this.ia):2===a?new hK(b,this.ia):3===a&&(1<b.length&&va.a.J(17651872,815,15,
"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new iK(b[0],this.ia):null:null}}Bp.Ioi=1E3;Bp.dJc=1;Bp.xoi=15;Bp.yoi=1;Object(n.a)(Bp,"ShapeKeyboardDragManager",null,[1044]);var Pg=d(155),Ws=d(516);const on=a=>{a&&Rc.a.Ib&&(Rc.a.Ib.D$f=a.If,Rc.a.Ib.hAh=a.Og)};var Eq=d(248),jK=d(500),Kx=d(327);class rD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je){if(!Fc)throw Error.argumentNull("ISessionInfoOwner is null");
if(!Ic)throw Error.argumentNull("IPPTUnitConversion is null");if(!Cc)throw Error.argumentNull("IZoomContext is null");cc||va.a.J(509650844,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.gf=b;this.kq=c;this.Fa=f;this.ob=l;this.Nad=w;this.Jb=H;this.Fb=U;this.Ea=ja;this.je=wa;this.Es=ub;this.mA=Sa;this.nad=eb;this.Ha=Ub;this.zfc=new La.ScriptSharpLegacyMap;this.vYa=cc;this.Xa=Fc;this.Ri=Ic;this.gj=Cc;this.Di=Ud;this.sva=je}wb(){this.ia.ra(L.a.k7a,nc.a.application,
Object(F.a)(this,this.Vsj,"handleDeleteSelectedShapes"),4);this.ia.ra(L.a.w2b,nc.a.application,Object(F.a)(this,this.Wsj,"handleDeleteShapes"),4);this.ia.ra(L.a.YIa,nc.a.application,Object(F.a)(this,this.Ruj,"handleMoveShapes"),4);this.ia.ra(L.a.fjb,nc.a.application,Object(F.a)(this,this.axj,"handleResizeShapes"),4);this.ia.ra(L.a.Cpc,nc.a.application,Object(F.a)(this,this.bce,"handleRotateShape"),4);this.ia.ra(L.a.cnh,nc.a.application,Object(F.a)(this,this.cce,"handleRotateShapes"),4);this.ia.ra(L.a.anh,
nc.a.application,Object(F.a)(this,this.cbg,"handleRotateShapeAnchor"),4);this.ia.ra(L.a.bnh,nc.a.application,Object(F.a)(this,this.cbg,"handleRotateShapeAnchor"),4);this.ia.ra(L.a.yaa,nc.a.application,Object(F.a)(this,this.dbg,"handleRotateShapeByDirection"),4);this.ia.ra(L.a.HTe,nc.a.application,Object(F.a)(this,this.dbg,"handleRotateShapeByDirection"),4);Pd.a("FlipInMultiSelectEnabledV2")?(this.ia.ra(L.a.Epc,nc.a.application,Object(F.a)(this,this.gag,"handleFlipShape"),4),this.ia.ra(L.a.Dpc,nc.a.application,
Object(F.a)(this,this.gag,"handleFlipShape"),4)):(this.ia.ra(L.a.Epc,nc.a.application,Object(F.a)(this,this.hag,"handleFlipShapeForSingleSelection"),4),this.ia.ra(L.a.Dpc,nc.a.application,Object(F.a)(this,this.hag,"handleFlipShapeForSingleSelection"),4));this.ia.ra(L.a.v7a,nc.a.application,Object(F.a)(this,this.Csj,"handleCommitKeyboardShapeManipulation"),4);this.ia.ra(L.a.xjc,Cb.a.view,Object(F.a)(this,this.YVc,"handleMoveShapesKeyboard"),4);this.ia.ra(L.a.yjc,Cb.a.view,Object(F.a)(this,this.YVc,
"handleMoveShapesKeyboard"),4);this.ia.ra(L.a.zjc,Cb.a.view,Object(F.a)(this,this.YVc,"handleMoveShapesKeyboard"),4);this.ia.ra(L.a.Ajc,Cb.a.view,Object(F.a)(this,this.YVc,"handleMoveShapesKeyboard"),4);this.ia.ra(L.a.mpc,Cb.a.view,Object(F.a)(this,this.dWc,"handleResizeShapesKeyboard"),4);this.ia.ra(L.a.npc,Cb.a.view,Object(F.a)(this,this.dWc,"handleResizeShapesKeyboard"),4);this.ia.ra(L.a.opc,Cb.a.view,Object(F.a)(this,this.dWc,"handleResizeShapesKeyboard"),4);this.ia.ra(L.a.ppc,Cb.a.view,Object(F.a)(this,
this.dWc,"handleResizeShapesKeyboard"),4);this.ia.ra(L.a.FTe,Cb.a.view,Object(F.a)(this,this.eWc,"handleRotateShapeKeyboard"),4);this.ia.ra(L.a.ond,Cb.a.view,Object(F.a)(this,this.eWc,"handleRotateShapeKeyboard"),4);this.ia.ra(L.a.nnd,Cb.a.view,Object(F.a)(this,this.eWc,"handleRotateShapeKeyboard"),4);this.ia.ra(L.a.Fpc,Cb.a.view,Object(F.a)(this,this.eWc,"handleRotateShapeKeyboard"),4);this.ia.ra(L.a.GOe,nc.a.application,Object(F.a)(this,this.Pbe,"handleIsDirectManipulationEnabled"),97);this.ia.ra(L.a.GMe,
nc.a.application,Object(F.a)(this,this.Rag,"handlePreviewRotate"),4);this.ia.ra(L.a.HMe,nc.a.application,Object(F.a)(this,this.Rag,"handlePreviewRotate"),4);this.ia.ra(L.a.xTe,nc.a.application,Object(F.a)(this,this.dxj,"handleRevertPreviewRotate"),4)}Ee(){const a=this.Fa.Fc(Lb.a.sg);a.bindAction(x.KeyInputManager.Oa(A.a.O6,4),L.a.mpc);a.bindAction(x.KeyInputManager.Oa(A.a.dba,4),L.a.npc);a.bindAction(x.KeyInputManager.Oa(A.a.Rga,4),L.a.opc);a.bindAction(x.KeyInputManager.Oa(A.a.fZ,4),L.a.ppc);a.bindAction(x.KeyInputManager.Oa(A.a.dba,
5),L.a.nnd);a.bindAction(x.KeyInputManager.Oa(A.a.Rga,5),L.a.Fpc);a.bindAction(x.KeyInputManager.Oa(A.a.dba,1),L.a.FTe);a.bindAction(x.KeyInputManager.Oa(A.a.Rga,1),L.a.ond);a.bindAction(x.KeyInputManager.Oa(A.a.upa,0),L.a.k7a);a.bindAction(x.KeyInputManager.Oa(A.a.VH,0),L.a.k7a);this.Fa.Fc(Lb.a.hj).bindAction(x.KeyInputManager.Oa(A.a.dba,1),G.a.ve)}Ruj(a,b,c,f,l){if(!l||!Object(Ya.a)(Array,l)||1>l.length)return 8;for(const H of l)if(b=H.shapeNode,this.TRa(b),b.get_smartArtModelId()&&(b=this.Ea.yr(b)),
!this.ODf(b)||this.gf.$c(H.shapeNode))return 16;if(1===c)return 32;if(Rc.a.Ib){Rc.a.Ib.Oj=!0;for(var w of l)if((c=w.shapeNode)&&(c.If||c.Og)){on(c);break}}w=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{w.nc(l[0].shapeNode);w.jd=a;const H=this.Fb.Md;for(const U of l){const ja=new gd.a(H.qf(U.position.x,0),H.qf(U.position.y,1));tq.c(U.shapeNode.get_smartArtModelId()?this.Ea.yr(U.shapeNode):U.shapeNode,ja.x,ja.y)}}finally{w&&w.dispose()}return 32}axj(a,b,c,f,l){if(!l||!Object(Ya.a)(Array,
l)||1>l.length)return 8;for(b=0;b<l.length;b++){if(!this.G_b(l[b].F1))return va.a.J(509650842,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].F1.get_shapeId()),16;if(this.gf.$c(l[b].F1))return 16}if(1===c)return 32;if(Rc.a.Ib){Rc.a.Ib.Oj=!0;for(var w of l)if((c=w.F1)&&(c.If||c.Og)){on(c);break}}w=this.Jb.Ad(15,void 0,()=>{this.ob.jj();const H=this.Fa.Ae;!H||H.name!==Lb.a.sg&&H.name!==Lb.a.Ez||this.Fa.Ed()});try{for(w.nc(l[0].F1),
w.jd=a,a=0;a<l.length;a++)l[a].F1.Nth=l[a].p1}finally{w&&w.dispose()}if(this.ob.HL()&&(a=this.ob.tEa(),(a=this.$k(a))&&Object(Ya.a)(Ws.a,a.Ok)&&Object(qa.a)(Ws.a,a.Ok).clearChildSelection(),this.vYa&&this.Ha.Rpl))for(const H of l)this.Q9k(H);return 32}Q9k(a){const b=a.F1;if(b&&b.Qf&&!b.Og){var c=Rc.a.Ib?Rc.a.Ib.actionId:gh.a.create().toString(),f=u.AFrameworkApplication.userSessionId,l=this.Xa.podSessionId,w=this.Kpl,H=this.Kkb,U=H/w,ja=Of.a.xY(this.Ri.GM(a.p1.left,U),0),wa=Of.a.xY(this.Ri.GM(a.p1.top,
U),1),Sa=Of.a.xY(this.Ri.GM(a.p1.right,U),0);a=Of.a.xY(this.Ri.GM(a.p1.bottom,U),1);U=Math.abs(b.get_widthPersisted()+Sa-ja);var eb=Math.abs(b.get_heightPersisted()+a-wa);Sa=Ee.o(b.slideCid,b.slideSid);a=Ee.b(b.get_shapeId(),null);var ub=Ee.f(Sa,a);ja=Ee.m((b.get_xPersisted()+ja).toString(),(b.get_yPersisted()+wa).toString());ja=Ee.n(U,eb,ja);ja=Ee.c(ub,ja);wa=null;this.Di&&this.Di.highContrastColors&&(wa=Ee.k(Ee.j(this.Di.highContrastColors.foregroundTextColor),Ee.j(this.Di.highContrastColors.backgroundColor),
Ee.j(this.Di.highContrastColors.linkColor)));f=Ee.d(Sa,a,1,b.jh,0,0,c,f,this.Di.isInHighContrastMode,wa,this.Ha.Nph&&this.sva?this.sva.rcj():null);l=Ee.e(f,[],l);l.editOps.push(ja);l=Ee.q(null,l,null,null,this.Xa.qk);f=Rc.a.cZ();Rc.a.Ib&&f&&(Rc.a.Ib.Va("editOpCorrelationId",c),Rc.a.Ib.Va("editOpRequestStartTick",f.toString()));this.vYa.Lx(l);va.a.J(509650841,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",
c,b.slideSid,b.slideCid,b.get_shapeId(),w,H,this.Ha.Nph)}}get Kpl(){let a=this.gj.JG;this.kq&&this.kq.Ba&&this.kq.Ba.Uw&&null!=this.kq.Ba.Uw.Zr&&(a=this.kq.Ba.Uw.Zr);a||(va.a.J(509650840,815,15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get Kkb(){let a=1;if(this.kq&&this.kq.Ba){const b=Object(qa.a)(566,this.kq.Ba.ng(this.Fb.Ma));b?a=b.tT:va.a.J(509650839,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else va.a.J(509650838,
815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(va.a.J(509650837,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}dbg(a,b,c,f,l){return 1===c?32:Pg.a("Rotate",a,()=>{va.a.J(509650836,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const w=this.ob.tg();if(!w)return va.a.J(509650835,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.nad&&1===w.length&&
this.TRa(w[0]);switch(a){case L.a.yaa:va.a.J(509650834,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");if(Pd.a("FixUndoRotateMultipleShapes")){var H={};H.selectedNodes=w;H.rotateLeft=!0;this.cce(a,b,c,f,H)}else for(H of w)l=new ap(H,Math.round(H.get_shapeRotation()+270)),this.bce(a,b,c,f,l);break;case L.a.HTe:va.a.J(509650833,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");if(Pd.a("FixUndoRotateMultipleShapes"))H={},H.selectedNodes=w,H.rotateRight=!0,
this.cce(a,b,c,f,H);else for(const U of w)l=new ap(U,Math.round(U.get_shapeRotation()+90)),this.bce(a,b,c,f,l);break;default:return 8}return 32})}cce(a,b,c,f,l){if(!l)return 8;b=l.selectedNodes;f=l.rotateData?l.rotateData:[];for(const w of b){const H=this.etb(w);if(1===c)return H?32:8;if(!H||this.gf.$c(w))return 16}if(l.rotateLeft||l.rotateRight)for(const w of b)Rc.a.Ib&&(Rc.a.Ib.Oj=!0,w&&(w.If||w.Og)&&on(w)),c=new ap(w,Math.round(w.get_shapeRotation()+(l.rotateLeft?270:90))),f.push(c);l=this.Jb.Ad(15,
void 0,()=>{this.ob.jj();const w=this.Fa.Ae;!w||w.name!==Lb.a.sg&&w.name!==Lb.a.Ez||this.Fa.Ed()});try{for(l.nc(b[0]),l.jd=a,a=0;a<b.length;a++)b[a].set_shapeRotation(f[a].x_d)}finally{l&&l.dispose()}return 32}bce(a,b,c,f,l){if(!l||!Object(Ya.a)(ap,l))return 8;b=l.shapeNode;f=this.etb(b);if(1===c)return f?32:8;if(!f||this.gf.$c(b))return 16;Rc.a.Ib&&(Rc.a.Ib.Oj=!0,b&&(b.If||b.Og)&&on(b));c=this.Jb.Ad(15,void 0,()=>{this.ob.jj();const w=this.Fa.Ae;!w||w.name!==Lb.a.sg&&w.name!==Lb.a.Ez||this.Fa.Ed()});
try{c.nc(b),c.jd=a,b.set_shapeRotation(l.x_d)}finally{c&&c.dispose()}return 32}cbg(){const a=this.ob.tg();return 0<a.length&&this.PUj(a)?32:8}Rag(a,b,c){return this.Ha.Mmc?1===c?32:Pg.a("HandlePreviewRotate:",a,()=>{var f=this.ob.tg();for(const l of f){if(!l){va.a.J(509650831,822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.ud)continue;this.zfc.Gb(l.get_shapeId())?this.zfc.$(l.get_shapeId(),l.get_shapeRotation()):this.zfc.add(l.get_shapeId(),l.get_shapeRotation());
f=this.$k(l);if(!f){va.a.J(509650830,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const w=f.xwb().Vf();switch(a){case L.a.GMe:f.setRotation((l.get_shapeRotation()+270)%ap.ilc,w);break;case L.a.HMe:f.setRotation((l.get_shapeRotation()+90)%ap.ilc,w)}}return 32}):2}dxj(a,b,c){if(!this.Ha.Mmc)return 2;if(1===c)return 32;a=this.ob.tg();for(const f of a)if(!f)va.a.J(509650829,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());
else if(!f.ud)if(a=this.$k(f))if(b=a.xwb().Vf(),this.zfc.Gb(f.get_shapeId()))a.setRotation(this.zfc.ga(f.get_shapeId()),b);else return va.a.J(509650827,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",f.get_shapeId()),8;else va.a.J(509650828,822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}Vsj(a,b,c,f,l){b=this.ob.tg();if(1===b.length&&this.ob.Zz())return 16;f=1===b.length&&!!b[0]&&b[0].yab();
f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if(Rc.a.Ib){Rc.a.Ib.actionName="ClearPlaceholders";Rc.a.Ib.Oj=!0;for(const w of b)if(w.If||w.Og){on(w);break}}if(this.ob.HL()&&Pd.a("EnableSmartArtSubShapeDeletion")&&this.Lbe(b[0],a,l))return 32;c=null;if(l=this.Ea.K9a(b))Pd.a("SmartArtSubNodeEditing")?c=this.Ea.yr(l):(this.ob.umd(l),b=this.ob.tg());return this.w2b(a,b,this.ob.uk(),c)?32:16}Wsj(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.kq.presentation;if(!b)throw Error.argumentNull("Presentation is null");
l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;Rc.a.Ib&&(Rc.a.Ib.actionName="DeleteShapes",Rc.a.Ib.Oj=!0);return l.length&&this.w2b(a,l,Object(qa.a)(116,b.AC(l[0].slideId)))?32:16}w2b(a,b,c,f=null){if(!c||!b.length||this.gf.FC(b))return!1;let l=!1;for(var w of b)if(w.iFa){l=!0;break}w=this.Jb.Ad(15,void 0,()=>{this.ob.Rh()});try{f?w.kd(f):w.kd(c);w.jd=a;w.Zy[Eq.a.byb]=l;for(const H of b)if(H&&H.Og){const U=this.Ea.ys(H);if(U){const ja=Tj.c(U,this.Fb.Ma);
ja&&(ja.Ok.visible=!1)}}f?f.Vih(b):c.PU(b)}finally{w&&w.dispose()}for(const H of b)this.Es.Afh(new jK.a(H));return!0}hag(a,b,c){b=this.ob.tg();const f=0<b.length?b[0]:null,l=1===b.length&&this.GUd(f);if(1===c)return l?32:8;if(!l||this.gf.$c(f))return 16;this.TRa(f);for(const w of b)if(w.If||w.Og){on(w);break}return Pg.a("Rotate",a,()=>{let w,H;switch(a){case L.a.Dpc:H=f.get_isVerticallyFlipped();w=!f.get_isHorizontallyFlipped();break;case L.a.Epc:H=!f.get_isVerticallyFlipped();w=f.get_isHorizontallyFlipped();
break;default:return 8}const U=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{U.nc(f),U.jd=a,f.set_isVerticallyFlipped(H),f.set_isHorizontallyFlipped(w)}finally{U&&U.dispose()}return 32})}gag(a,b,c){const f=this.ob.tg();b=!0;if(!f||f&&!f.length)b=!1;for(const H of f)if(b=this.GUd(H),!b)break;if(1===c)return b?32:8;if(!b)return va.a.J(509650822,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const H of f){if(this.gf.$c(H))return 16;
this.TRa(H)}for(const H of f)if(H.If||H.Og){on(H);break}const l=a===L.a.Dpc,w=a===L.a.Epc;return l||w?Pg.a("Rotate",a,()=>{const H=Array(f.length),U=Array(f.length);for(var ja=0;ja<f.length;ja++)U[ja]=!!(w^f[ja].get_isVerticallyFlipped()),H[ja]=!!(l^f[ja].get_isHorizontallyFlipped());ja=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{ja.nc(f[0]);ja.jd=a;for(let wa=0;wa<f.length;wa++)f[wa].set_isVerticallyFlipped(U[wa]),f[wa].set_isHorizontallyFlipped(H[wa])}finally{ja&&ja.dispose()}return 32}):
(va.a.J(509650821,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}Csj(){this.Nad.pSf();return 32}YVc(a,b,c){const f=Tj.b(b);if(!f)return 16;b=this.ob.tg();if(!b.length)return 16;let l=!0;const w=[];for(const H of b)if(H.get_smartArtModelId()){w.push(this.Ea.yr(H));break}else w.push(H);for(const H of w)if(!this.ODf(H)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=Tj.d(w,f.Ma);if(this.gf.FC(b))return 16;switch(a){case L.a.xjc:a=ne.a.south;break;case L.a.yjc:a=ne.a.west;
break;case L.a.zjc:a=ne.a.east;break;case L.a.Ajc:a=ne.a.north;break;default:return 8}this.Nad.move(c,a);this.mA&&this.ob.HL()&&(a=this.ob.tEa(),this.je.xib(new Kx.a(a)));Rc.a.Ib&&(Rc.a.Ib.Oj=!0,Rc.a.Ib.tF=new Date);return 32}dWc(a,b,c){const f=Tj.b(b);b=this.ob.tg();const l=[];for(var w of b){if(w.get_smartArtModelId()){this.ob.umd(w);Array.add(l,this.Ea.yr(w));break}!w.isResizable||w.VI||w.ud||Array.add(l,w)}w=Tj.d(l,f.Ma);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.gf.FC(l))return 16;
switch(a){case L.a.mpc:a=ne.a.south;break;case L.a.npc:a=ne.a.west;break;case L.a.opc:a=ne.a.east;break;case L.a.ppc:a=ne.a.north;break;default:return 8}this.Nad.resize(w,a);this.mA&&this.ob.HL()&&(a=this.ob.tEa(),this.je.xib(new Kx.a(a)));Rc.a.Ib&&(Rc.a.Ib.Oj=!0,Rc.a.Ib.tF=new Date);return 32}eWc(a,b,c){var f=this.ob.tg();const l=0<f.length?f[0]:null,w=1===f.length&&this.etb(l);if(1===c)return w?32:8;if(!w||this.gf.$c(l))return 16;b=Tj.b(b);f=Tj.d(f,b.Ma);c=a===L.a.ond||a===L.a.Fpc;a=a===L.a.nnd||
a===L.a.Fpc;0<f.length&&f[0].shapeNode.If&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.ng(b.Ma))&&b.LWc();this.Nad.rotate(f,c,a);Rc.a.Ib&&(Rc.a.Ib.Oj=!0,Rc.a.Ib.tF=new Date);return 32}Pbe(a,b,c,f,l){return l&&Object(Ya.a)(9,l)?this.gf.$c(l)?16:32:8}PUj(a){for(const b of a)if(!this.etb(b)&&!this.GUd(b))return!1;return!0}ODf(a){return!!a&&a.YI&&a.hB&&!a.VI}G_b(a){return!!a&&a.isResizable&&a.hB&&!a.VI}etb(a){return!!a&&a.FL&&!a.VI}GUd(a){return!!a&&a.DOj&&!a.VI}$k(a){return a?Object(qa.a)(117,a.sc(this.Fb.Ma)):
null}TRa(a){a&&a.iy&&(a=this.$k(a))&&a.u1(!1)}Lbe(a,b,c){return(a=this.$k(a))&&Object(Ya.a)(Ws.a,a.Ok)&&(a=Object(qa.a)(Ws.a,a.Ok))?a.iid(L.a.mw(b),c):!1}}Object(n.a)(rD,"ShapeManipulationActor",null,[]);var Ev=d(423),$i=d(69);class sD extends Ev.DragSelectionDragAdapter{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){super(a,b,c);this.pa=f;this.Fa=l;this.la=U;this.Ea=w;this.lkk=H;this.ZC=ja;this.Pb=wa;this.gq=Sa;this.Zea=eb;this.yc=ub;this.Mwc=this.Nwc=null}get mJc(){return this.Nwc}get lJc(){return this.Mwc}Uu(a){for(var b=
this.V3e(),c=a.Ec,f=c,l=this.ZC.KI(f);!l&&f;){l=this.ZC.KI(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||va.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.gb;c=this.Pb.Mc(l);if(b===l||c.Ze()&&c.Q1a()===b){l=super.Uu(a);if(!l)return l;this.Ea.f4(b)&&(c=this.yc.NN(Object(qa.a)(4,b)))&&c.Np()&&(c=
this.Zea.g4d(a.clientPoint,c,null,null))&&(f=c.sc(this.Hf.Ma),this.Hf.H6(a.clientPoint,f,c,this.Hf,a.shiftKey));null!==this.gq&&(a=this.Ea.ud(b),this.gq.vya($i.a.Oaa),a&&(this.Nwc=this.Zea.Q8d(b),this.Mwc=this.Zea.q4f(b)));return l}return!1}pu(a){super.pu(a);this.cTf();null!==this.gq&&this.gq.Xxa();this.mJc&&(this.Nwc=null);this.lJc&&(this.Mwc=null)}fo(a){super.fo(a);this.cTf();null!==this.gq&&this.gq.Xxa();this.mJc&&(this.Nwc=null);this.lJc&&(this.Mwc=null)}WGb(a,b,c){({Yr:b,graphNode:c}=super.WGb(a,
b,c));if(this.la.Tmg&&(a=this.V3e())){const f=this.p7i(c);f&&f===a||(c=a,b=c.sc(this.Hf.Ma))}return{Yr:b,graphNode:c}}ruc(a){let b=super.ruc(a);if(!b&&this.la.Tmg){let c=this.V3e();if(c&&this.Ea.ud(c.node)){const f=this.pa.an();this.Zea.bZc(a.clientPoint,f)&&(c=this.Zea.g4d(a.clientPoint,f,this.mJc,this.lJc))}c&&(b=c.sc(this.Hf.Ma))}return b}p7i(a){return a?this.Ea.en(a):null}V3e(){const a=this.lkk.Z6f(this.Hf.Ma);return!a||a.jH?null:this.pa.kp()}cTf(){(this.pa.gH()||this.pa.Bs())&&this.Fa.Ed()}}
Object(n.a)(sD,"PPTDragSelectionDragAdapter",Ev.DragSelectionDragAdapter,[1043,244]);class kK{constructor(a,b,c){this.Te=a;this.N9=b;this.yc=c}bZc(a,b){if(!a||!b)return!1;b=b.sc(this.Te);return b?(b=Kd.a.ai(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}g4d(a,b,c=null,f=null){return(a=this.HWf(a,b,c,f))?a.az():null}HWf(a,b,c=null,f=null){if(!a||!b)return null;c&&f||(f=this.q4f(b),c=this.Q8d(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.sc(this.Te);
if(!l)return null;var w=Kd.a.ai(l.htmlElement);if(!w)return null;l=a.x-w.x;w=a.y-w.y;var H=0;for(a=0;a<c.length&&!(H+=c[a],H>=w);a++);for(H=w=0;H<f.length&&!(w+=f[H],w>=l);H++);a=Math.min(a,c.length-1);H=Math.min(H,f.length-1);return 0>a||a>=c.length||0>H||H>=f.length?null:b.nf(a,H)}Q8d(a){if(a){a=this.yc.tka(a);if(!a||!a.length)return null;const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].sc(this.Te);if(!b)return null;b=Kd.a.ai(b.htmlElement);f[l]=b.height}return f}return null}q4f(a){if(a){a=
xn.b(Object(qa.a)(yg.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.N9.Pe(a[f],0);return c}return null}}Object(n.a)(kK,"PptTableDragSelectionHelper",null,[330]);var bs=d(652),Jz=d(340);class lK{constructor(a,b,c,f,l,w,H){this.ta=this.Km=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");
if(!w)throw Error.argumentNull("insertShapeOverlayViewElement");if(!H)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Kc=b;this.Ri=c;this.Fb=f;this.OWa=l;this.Kea=w;this.ua=H}Dv(a){try{return a?a.uA===Sys.UI.MouseButton.rightButton?!1:2===this.OWa.Yfg?!0:!1:(va.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),!1)}catch(b){throw va.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}Uu(a){try{if(!a)return va.a.J(512336008,822,
10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.Dv(a))return!1;this.Kea.nl($i.a.CNb);this.Km=bs.a(a.clientPoint,this.Kc.Ic);const b=new Xi.a;b.left=this.Km.x;b.top=this.Km.y;b.bottom=this.Km.y+5;b.right=this.Km.x+5;a={};a.offsets=b;a.insertShapeActionId=this.Kea.Ryb;a.insertLocalShape=!0;if(32!=this.ia.La(L.a.aYc,2,a))return!1;this.ta=a.node;return!0}catch(b){throw va.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}Gw(a){try{if(!a)return va.a.J(512336006,
822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Fb.isActive)return!1;const b=bs.a(a.clientPoint,this.Kc.Ic),c=bs.b(this.Dtd(Math.min(this.Km.y,b.y)-this.Km.y),this.Dtd(Math.max(this.Km.y,b.y)-this.Km.y-5),this.Dtd(Math.min(this.Km.x,b.x)-this.Km.x),this.Dtd(Math.max(this.Km.x,b.x)-this.Km.x-5));Object(qa.a)(Jz.a,this.ta.sc(0)).setOffsets(c,!0);return!0}catch(b){throw va.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}fo(a){try{if(a)if(this.Km){var b=
bs.a(a.clientPoint,this.Kc.Ic),c=bs.b(Math.min(this.Km.y,b.y),Math.max(this.Km.y,b.y),Math.min(this.Km.x,b.x),Math.max(this.Km.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.Kea.Ryb;a.insertLocalShape=!1;this.dOf();this.ia.La(L.a.aYc,2,a);this.WK()}else va.a.J(512336003,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else va.a.J(512336004,822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw va.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",
f),f;}}pu(){this.WK()}dispose(){this.WK()}Dtd(a){return this.Ri.JM(a,this.Kc.Ic.tT)}WK(){this.Km=null;this.ta&&(this.dOf(),this.OWa.Q2e(0),this.ta=null)}dOf(){this.ua.Ba.PU([this.ta])}}Object(n.a)(lK,"ShapeDrawDragAdapter",null,[244,106]);class Lx{constructor(a,b){this.jxg=null;this.jCb=-1;this.gAe=a;this.t9j=b}Uu(a){return this.R3g(a)?(this.gAe.did(),!0):!1}Gw(a){if(!a)return!1;this.t9j?(this.jxg=a,this.C7k()):this.WHe(a);return!0}fo(a){this.vEh()&&this.WQf(0);this.O3g(a);this.gAe.tpc()}pu(){this.vEh();
this.M3g();this.gAe.tpc()}C7k(){-1===this.jCb&&(this.jCb=window.requestAnimationFrame(Object(F.a)(this,this.WQf,"dragMoveTask")))}vEh(){return-1!==this.jCb?(window.cancelAnimationFrame(this.jCb),this.jCb=-1,!0):!1}WQf(){this.WHe(this.jxg);this.jCb=-1}}Object(n.a)(Lx,"ShapeDragAdapter",null,[244]);class mK extends Lx{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){super(Ub,Fc);this.rdc=0;this.odc=this.vp=this.EO=this.gxg=null;this.kHa=!1;this.Fb=a;this.ia=b;this.f0=c;this.Mq=f;this.xt=l;
this.TC=w;this.ob=H;this.nE=U;this.ZC=ja;this.Ea=wa;this.yc=Sa;this.je=eb;this.Xhc=ub;this.gq=cc;this.mA=Ic;this.Tp=Cc}Dv(a){return this.WI(a).returnValue}WI(a){let b;var c=[];b=!1;if(!a||a.uA!==Sys.UI.MouseButton.leftButton||this.TC.O_)return{returnValue:!1,ujc:c,Yac:b};const f=Object(qa.a)(567,this.ZC.KI(a.Ec));if(!f||!f.Yje(a.Ec))return{returnValue:!1,ujc:c,Yac:b};if((b=f.isSelected)||f.shapeNode.Og){c=[];a=Object(qa.a)(117,this.ZC.KI(a.Ec));a.shapeNode.If&&this.ob.pOf(a.shapeNode);a=this.ob.tg();
for(const l of a)if(l.get_smartArtModelId()){c.push(this.Ea.yr(l));break}else c.push(l);c=Tj.d(c,this.Fb.Ma);for(const l of c)if(!this.Vig(l))return{returnValue:!1,ujc:c,Yac:b}}else{if(!this.Vig(f))return{returnValue:!1,ujc:c,Yac:b};Array.add(c,f)}return{returnValue:!0,ujc:c,Yac:b}}Vig(a){return a&&a.gb&&a.gb.YI&&a.gb.hB&&!a.shapeNode.VI&&32===this.ia.La(L.a.GOe,1,a.gb)?!0:!1}R3g(a){var b;let c;if(!({ujc:b,Yac:c}=this.WI(a)).returnValue)return!1;this.ia.processAction(L.a.v7a,2);this.gxg=gd.a.vSa(a.clientPoint);
this.odc=Object(qa.a)(567,this.ZC.KI(a.Ec));null!==this.f0&&this.f0.nl(3);if(!this.odc||!b||!b.length)return!1;null!==this.gq&&this.gq.vya($i.a.Zya);this.odc.shapeNode.iy||(this.ob.jj(),this.nE.Ed());for(a=0;a<b.length;++a)this.zGc(b[a]);c||(this.ob.setSelection(Od.SelectionFactory.wl(this.vp[0].gb)),this.xt.uw());for(b=0;b<this.vp.length;++b)this.vp[b].SD(!0);this.kHa=1<this.vp.length?!1:!0;this.rdc=Date.now();this.mA&&this.ob.HL()&&this.je.PPe();this.Tp&&this.ia.processAction(D.a.Xja,2);return!0}zGc(a){this.vp||
(this.vp=[]);this.EO||(this.EO=[]);Array.add(this.vp,a);Array.add(this.EO,new gd.a(a.x,a.y))}WHe(a){if(a){var b=this.QTc(gd.a.vSa(a.clientPoint),this.gxg);a=null;var c=this.kHa&&!this.odc.shapeNode.iy;for(let f=0;f<this.vp.length;++f)a=gd.a.add(this.EO[f],b),this.vp[f].setPosition(a.x,a.y,!c);b=this.Xhc.L6g(!1,this.kHa,this.vp[0],null);c&&!b&&a&&this.vp[0].setPosition(a.x,a.y,!0)}}QTc(a,b){a=gd.a.fV(a,b);return new gd.a(this.Mq.Sm(a.x),this.Mq.Sm(a.y))}O3g(a){const b=[];for(var c=0;c<this.vp.length;++c){var f=
this.vp[c].hSc();Array.add(b,new Dv(this.vp[c].shapeNode,f));this.vp[c].Xz(!1);if(f=this.yc.NN(this.vp[c].shapeNode))f=f.Np(),va.a.J(512497684,815,50,"Drag to move table, isComplexTable:{0}",f)}this.odc.shapeNode.iy||(c={},a&&a.qc&&a.qc.rawEvent&&(c[Bh.a.BDa]=a.qc.rawEvent.timeStamp),this.ia.La(L.a.YIa,2,b,c));1===b.length&&(va.a.J(512497683,815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.vp[0].shapeNode?this.vp[0].shapeNode.Er:"",(Date.now()-this.rdc).toString()),this.mA&&
this.ob.HL()&&(a=this.ob.tEa(),this.je.xib(new Kx.a(a))));this.q3()}M3g(){if(this.vp){for(let a=0;a<this.vp.length;++a)this.vp[a].setPosition(this.EO[a].x,this.EO[a].y,!0),this.vp[a].Xz(!0);this.q3()}}q3(){this.Xhc.P6g(this.kHa);null!==this.f0&&this.f0.m1();this.Fb.VR();this.EO=this.vp=null;null!==this.gq&&this.gq.Xxa()}}Object(n.a)(mK,"ShapeMoveDragAdapter",Lx,[]);class tD{constructor(a){this.K4c=this.p0=this.P0=this.kgc=this.z0=null;this.Zd=a}ydl(a,b,c,f,l){this.z0=a;this.kgc=b;this.P0=c;this.p0=
f;this.K4c=l}}Object(n.a)(tD,"ResizeShapesCalculationData",null,[]);var uD=d(628);class Vk{static oUd(a,b,c,f,l){return f?Vk.iDf(a,c):Vk.vpi(a,b,c,l)}static iDf(a,b){const c=new Xi.a;if(a.equals(ne.a.Ru)||a.Rzb(ne.a.Ru))c.left=b.x,c.top=b.y;else if(a.equals(ne.a.WE)||a.Rzb(ne.a.WE))c.right=b.x,c.bottom=b.y;return c}static vpi(a,b,c,f){b=a.K9b()?Vk.lpi(a,b,c,f):Vk.xpi(a,b,c);c=new Xi.a;if(a.Rzb(ne.a.north)||a.equals(ne.a.north))c.top=-1*b.y;if(a.Rzb(ne.a.east)||a.equals(ne.a.east))c.right=b.x;if(a.Rzb(ne.a.south)||
a.equals(ne.a.south))c.bottom=b.y;if(a.Rzb(ne.a.west)||a.equals(ne.a.west))c.left=-1*b.x;return c}static lpi(a,b,c,f){var l=b.sk(a),w=b.sk(a.$8a()),H=b.sk(a.T_i());a=b.sk(a.U_i());var U=new gd.a(l._x+c.x,l._y+c.y);const ja=uD.b(w,H,U);b=uD.b(w,a,U);c=Vk.vVd(w,H,ja);l=Vk.vVd(w,a,b);b=gd.a.lm(b,U);U=gd.a.lm(ja,U);H=gd.a.lm(w,H);w=gd.a.lm(w,a);f?(w||(va.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),w=1),H||(va.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),H=1),f=H/w,!U||b/U>f?(b<Vk.Z2&&
(b=Vk.Z2),U=b/f,U<Vk.Z2&&(U=Vk.Z2,b=U*f)):(U<Vk.Z2&&(U=Vk.Z2),b=U*f,b<Vk.Z2&&(b=Vk.Z2,U=b/f))):(b<Vk.Z2&&(b=Vk.Z2),U<Vk.Z2&&(U=Vk.Z2));return new gd.a(b*c-H,U*l-w)}static xpi(a,b,c){var f=a.STc();a=a.ixb();f=b.sk(f);var l=b.sk(a);b=b.sk(a.$8a());a=gd.a.$9a(f,l);a.pM(c.x,c.y);c=uD.b(b,f,a);a=gd.a.lm(b,c);l=gd.a.lm(f,b);a<Vk.Z2&&(a=Vk.Z2);f=a*Vk.vVd(b,f,c)-l;return new gd.a(f,f)}static vVd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}Vk.Z2=6;Object(n.a)(Vk,
"ResizeHelper",null,[]);class Xs extends Lx{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){super(Sa,Ub);this.Ila=this.w0=this.rHa=this.zqe=this.Aqe=this.Zd=this.cG=null;this.kHa=!1;this.oR=this.bR=null;this.Fb=a;this.ia=b;this.TC=c;this.OXa=f;this.nE=l;this.ZC=w;this.Ri=H;this.je=U;this.Ea=ja;this.Xhc=wa;this.mA=cc;this.gq=eb;this.Le=ub;this.Tp=Fc}Dv(a){if(!a||a.uA===Sys.UI.MouseButton.rightButton)return!1;this.oR=[];this.Zd=Object(qa.a)(117,this.ZC.KI(a.Ec));if(!this.Zd||!this.Zd.bE(a.Ec))return!1;
a=this.Zd.shapeNode;if(!a||!a.isResizable||this.TC.O_)return!1;this.cG=[];if(a.gz)Array.add(this.cG,this.Zd);else{var b=this.OXa.Xd();(b=this.Ea.K9a(b))&&this.OXa.umd(b);a.If&&this.OXa.pOf(a);b=this.OXa.tg();this.cG=Tj.d(b,this.Fb.Ma)}if(this.Ea.f4(this.Zd.shapeNode))Array.add(this.oR,new tD(this.Zd));else for(const c of this.cG){if(!this.GVj(c))return this.oR=null,!1;c.shapeNode.isResizable&&!c.shapeNode.ud&&Array.add(this.oR,new tD(c))}return!0}GVj(a){return 32!==this.ia.La(L.a.GOe,1,a.gb)||this.TC.O_||
!a.BQ?!1:!0}R3g(a){if(!a||!this.Dv(a))return!1;this.OXa.jj();this.nE.Ed();this.ia.processAction(L.a.v7a,2);this.Ila=this.Zd.q5b();if(!this.Zd.bE(a.Ec))return!1;null!==this.gq&&this.gq.vya($i.a.CNb);this.bR=this.g6f(this.Zd.bE(a.Ec),this.Zd,this.Ila,!1);this.rHa=this.hsa(a.clientPoint);({width:this.Aqe,height:this.zqe}=this.sDf(this.Ila,this.Zd.shapeNode.Q_));this.w0=new gd.a(0,0);for(const c of this.oR){var b=c.Zd.q5b();a=c.Zd;let f,l;({width:f,height:l}=this.sDf(b,this.Zd.shapeNode.Q_));const w=
this.g6f(this.bR,a,b,!0);c.ydl(b,a.TYa,f,l,w);a.EL=!0;a.SD(!0);b=Tj.c(a.shapeNode,this.Fb.Ma);a.shapeNode.If&&b.Ok&&(b.Ok.visible=!0)}this.kHa=this.Ea.f4(this.Zd.shapeNode)?!0:1<this.cG.length?!1:!0;this.mA&&this.OXa.HL()&&this.je.PPe();this.Tp&&this.ia.processAction(D.a.Xja,2);return!0}WHe(a){if(a){var b=this.hsa(a.clientPoint),c=gd.a.fV(b,this.rHa);this.w0=gd.a.add(this.w0,this.h6f(c,this.Ila,!1));var f=null;c=this.kHa&&!this.Zd.shapeNode.iy;for(const l of this.oR){let w=new gd.a(l.P0/this.Aqe*
this.w0.x,l.p0/this.zqe*this.w0.y);new Xi.a;if(l.Zd.shapeNode.gz){this.Zd.shapeNode.gz&&(w=this.w0);if(!l.K4c)continue;f=Vk.iDf(l.K4c,w)}else f=Vk.oUd(l.K4c,l.z0,this.h6f(w,l.z0,!0),l.Zd.shapeNode.gz,l.Zd.shapeNode.isAspectRatioLocked||a.shiftKey);f=Xi.a.add(l.kgc,this.PXf(f,l.z0));l.Zd.setOffsets(f,!c);l.Zd.shapeNode.If&&l.Zd.shapeNode.isEditable&&l.Zd.$ce()}this.rHa=b;a=this.Xhc.L6g(!0,this.kHa,this.Zd,this.bR);c&&!a&&f&&this.Zd.setOffsets(f,!0)}}PXf(a,b){if(this.Ea.f4(this.Zd.shapeNode))return a;
const c=new Xi.a;c.left=b.NZc?a.right:a.left;c.right=b.NZc?a.left:a.right;c.top=b.Qab?a.bottom:a.top;c.bottom=b.Qab?a.top:a.bottom;return c}O3g(a){const b=[];for(var c=0;c<this.oR.length;c++){let f=Xi.a.fV(this.oR[c].Zd.TYa,this.oR[c].kgc);f=this.PXf(f,this.oR[c].z0);Array.add(b,new Iz(this.oR[c].Zd.shapeNode,f,this.bR,this.w0));this.oR[c].Zd.shapeNode.If&&this.oR[c].Zd.shapeNode.isEditable||(this.oR[c].Zd.EL=!1);this.oR[c].Zd.Xz(!1)}this.Zd.shapeNode.iy?Pc.App.Kb.updateCommandUI():(c={},a&&a.qc&&
a.qc.rawEvent&&(c[Bh.a.BDa]=a.qc.rawEvent.timeStamp),this.Ea.f4(this.Zd.shapeNode)?(this.Zd.yDa(),this.ia.La(L.a.cmh,2,b,c)):this.ia.La(L.a.fjb,2,b,c));this.mA&&this.OXa.HL()&&(a=this.OXa.tEa(),this.je.xib(new Kx.a(a)));this.WK()}M3g(){if(this.oR){for(const a of this.oR)a.Zd.setOffsets(a.kgc,!0),a.Zd.EL=!1,a.Zd.Xz(!0);this.WK()}}WK(){this.Xhc.P6g(this.kHa);this.Ila=this.zqe=this.Aqe=this.Zd=this.cG=this.oR=this.bR=this.w0=this.rHa=null;null!==this.gq&&this.gq.Xxa()}sDf(a,b){let c;var f=b?this.r6d(a):
a;c=gd.a.lm(f.ga(0),f.ga(1));f=gd.a.lm(f.ga(0),f.ga(3));b||(a=te.a.YO(gd.a.MG(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(va.a.J(17622149,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Zd.shapeNode.Er),c=1),f||(va.a.J(17622151,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Zd.shapeNode.Er),f=1));return{width:c,height:f}}g6f(a,b,c,f){if(b.shapeNode.gz){if(this.Zd.shapeNode.gz)return a;if(a.equals(ne.a.DE)||a.equals(ne.a.RH))return null;if(a.equals(ne.a.Ru)||
a.equals(ne.a.WE))return c.ga(0).x>c.ga(1).x?a.$8a():a;if(b.shapeNode.Q_){f=te.a.YO(gd.a.MG(c.ga(0),c.ga(1)));if(a.equals(ne.a.north)||a.equals(ne.a.south))return Math.abs(f-90)<Xs.Sfc||Math.abs(f-270)<Xs.Sfc?c.ga(0).y<c.ga(1).y?a:a.$8a():null;if(a.equals(ne.a.east)||a.equals(ne.a.west))if(Math.abs(f-180)<Xs.Sfc||360-f<Xs.Sfc||f<Xs.Sfc)return c.ga(0).x<c.ga(1).x?a:a.$8a()}return null}c=gd.a.MG(c.ga(0),c.ga(1));c=Math.floor((c+Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=f?a.STc().STc():a.ixb().ixb();
return a}h6f(a,b,c){if(this.Zd.shapeNode.gz||this.Ea.f4(this.Zd.shapeNode))return a;var f=gd.a.MG(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=gd.a.MG(f,b);return c?new gd.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new gd.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*a.x)}hsa(a){var b=this.Zd.c3(this.Ri.Sm(a.x)),c=this.Zd.c3(this.Ri.Sm(a.y));if(this.Ea.f4(this.Zd.shapeNode)){c=this.bR;this.bR.K9b()||(c=c.ixb());
b=this.Le.ai(this.Zd.cQa);b.x+=Pf.a.mqd;b.y+=Pf.a.mqd;b.width-=2*Pf.a.mqd;b.height-=2*Pf.a.mqd;var f=cj.a.fda(b);b=f.sk(c);f=f.sk(c.$8a());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Zd.c3(this.Ri.Sm(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Zd.c3(this.Ri.Sm(c))}return new gd.a(b,c)}r6d(a){const b=gd.a.$9a(a.ga(0),a.ga(3));a=gd.a.$9a(a.ga(1),a.ga(2));return new cj.a(new gd.a(b.x,b.y),new gd.a(a.x,b.y),new gd.a(a.x,a.y),new gd.a(b.x,a.y))}}Xs.Sfc=3;Object(n.a)(Xs,"ShapeResizeDragAdapter",
Lx,[]);var nK=d(194);class Kz{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.xye=this.Tze=null;this.jgc=0;this.zBe=this.Ghc=null;this.E4c=0;this.oIg=8;this.HRg=4;this.X6j="AngleUIRendered";this.sE=this.Zd=null;this.Fb=a;this.ia=b;this.TC=f;this.f0=c;this.pa=l;this.nE=w;this.ZC=H;this.Ri=U;this.ic=ja;this.qe=wa;this.gq=Sa;this.Tp=eb;this.VGa=ub}Dv(a){if(!a||a.uA!==Sys.UI.MouseButton.leftButton||this.TC.O_)return!1;this.Zd=Object(qa.a)(117,this.ZC.KI(a.Ec));return this.Zd&&this.Zd.bme(a.Ec)?(this.sE=
this.Zd.shapeNode)&&this.sE.FL&&this.Zd.BQ?!0:!1:!1}Uu(a){if(!a||!this.Dv(a))return!1;this.pa.jj();this.nE.Ed();this.ia.processAction(L.a.v7a,2);null!==this.gq&&this.gq.vya(gf.a.fQ(this.qe.rk("rotatehandlecursor.cur"),$i.a.Szh));this.jgc=this.sE.get_shapeRotation();this.Ghc=this.Zd.q5b().Vf();this.zBe=this.Zd.xwb().Vf();this.Tze=this.hsa(a.clientPoint);this.Zd.lla=!0;this.VGa&&this.KWe(!0);this.Zd.SD(!0);this.Tp&&this.ia.processAction(D.a.Xja,2);return!0}Gw(a){if(!a)return!1;this.xye=this.hsa(a.clientPoint);
if(!this.xye)return!1;this.E4c=te.a.YO(gd.a.MG(this.xye,this.Ghc))-te.a.YO(gd.a.MG(this.Tze,this.Ghc));let b=this.jgc+this.E4c;this.VGa&&(b=this.oyh(b));this.Zd.setRotation(Math.round(b),this.zBe);this.VGa&&(a=this.hsa(a.clientPoint,!1),this.VGl(a,Math.round(b)));return!0}oyh(a){return this.Zii(a)?10*Math.round(a/10):a}Zii(a){0>a&&(a=(a+360)%360);return(a+this.HRg/2)%90<=this.HRg?!0:!1}VGl(a,b){var c=this.ic.jg(this.Zd.gb);c=Tj.e(c,this.Fb.Ma);c.Hpc.OB(2);c.Hpc.setPosition(a.x+this.oIg,a.y+this.oIg);
c.Hpc.xa.style.position="absolute";0>b&&(b+=360);c.Hpc.xa.innerText=(b%360).toString()+"\u00b0"}KWe(a){const b=this.ic.jg(this.Zd.gb);Tj.e(b,this.Fb.Ma).Hpc.Rd(a)}fo(a){this.VGa&&this.KWe(!1);this.Zd.lla=!1;this.Zd.Xz(!1);var b=this.jgc+this.E4c;this.VGa&&(b=this.oyh(b));b=new ap(this.sE,Math.round(b));const c={};a&&a.qc&&a.qc.rawEvent&&(c[Bh.a.BDa]=a.qc.rawEvent.timeStamp);this.VGa&&(c[this.X6j]=1);this.ia.La(L.a.Cpc,2,b,c);this.q3()}pu(){this.Ghc&&(this.Zd.setRotation(this.jgc,this.zBe),this.VGa&&
this.KWe(!1),this.Zd.lla=!1,this.Zd.Xz(!0),this.q3())}hsa(a,b=!0){var c=this.ic.jg(this.Zd.gb);return(c=Tj.e(c,this.Fb.Ma).MB)?(a=gd.a.vSa(nK.a.MSa(a,c)),b?new gd.a(this.Zd.c3(this.Ri.Sm(a.x)),this.Zd.c3(this.Ri.Sm(a.y))):a):null}q3(){null!==this.f0&&this.f0.m1();null!==this.gq&&this.gq.Xxa();this.Fb.VR();this.Tze=null;this.jgc=0;this.Ghc=null;this.E4c=0;this.Zd=this.sE=null}static getInstance(a){return Kz.wC(a)}static wC(a){return new Kz(a,Ab.a.instance.resolve("Common.IActionManagerExtended"),Ab.a.instance.resolve("Common.ICursorPinningTool"),
Ab.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),Ab.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),Ab.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),Ab.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Ab.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Ab.a.instance.resolve("PowerPoint.IPathManager"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?
Ab.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").nMe)}}Object(n.a)(Kz,"ShapeRotateDragAdapter",null,[244]);var vD=d(330);class oK{constructor(a,b,c,f,l){this.Km=this.Mr=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");
if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Kc=b;this.Fb=c;this.OWa=f}ATi(){if(this.Mr)return this.Mr;this.Mr=new lo.a;this.Mr.ur("MarqueeDiv");this.Mr.$j(0);this.Mr.xa.style.borderStyle="solid";this.Mr.xa.style.borderWidth="thin";this.Mr.xa.style.borderColor="black";this.Mr.xa.style.opacity="0.5";this.Mr.Rd(!1);return this.Mr}LFh(a,b){this.Mr&&this.Mr.lh(a,b)}KFh(a,b){this.Mr&&this.Mr.setPosition(a,
b)}WK(){this.Km=null;this.Mr&&(this.Mr.Rd(!1),this.Mr.zq())}qSd(a){const b=this.Kc.Ic;if(!b||!b.te||!b.te.xa)return va.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),!1;b.te.xa.appendChild(a.xa);a.OB(2+vD.a.jba);a.Rd(!0);return!0}Dv(a){try{return a?a.uA===Sys.UI.MouseButton.rightButton?!1:1===this.OWa.Yfg?!0:!1:(va.a.J(512497681,822,10,"Event argument is null in isDragPossible"),!1)}catch(b){throw va.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",
b),b;}}Uu(a){try{if(!a)return va.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.Dv(a))return!1;this.Km=bs.a(a.clientPoint,this.Kc.Ic);const b=this.ATi();if(!this.qSd(b))return!1;this.KFh(this.Km.x,this.Km.y);this.LFh(0,0);return!0}catch(b){throw va.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}Gw(a){try{if(!a)return va.a.J(512497677,822,10,"Event argument is null in OnDragMove"),!1;if(!this.Fb.isActive)return!1;const b=bs.a(a.clientPoint,this.Kc.Ic),
c=Math.min(this.Km.x,b.x),f=Math.min(this.Km.y,b.y),l=Math.max(this.Km.x,b.x),w=Math.max(this.Km.y,b.y);this.KFh(c,f);this.LFh(l-c,w-f);return!0}catch(b){throw va.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",b),b;}}fo(a){try{if(a)if(this.Km){var b=bs.a(a.clientPoint,this.Kc.Ic),c=bs.b(Math.min(this.Km.y,b.y),Math.max(this.Km.y,b.y),Math.min(this.Km.x,b.x),Math.max(this.Km.x,b.x));this.ia.La(L.a.kYc,2,c);Pd.a("TelemetryForClickAndDragOperation")&&va.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");
this.WK()}else va.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else va.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(f){throw va.a.J(512497672,822,10,"Exception {0} occured in OnDragEnd",f),f;}}pu(){this.WK()}dispose(){this.WK();this.Mr=null}}Object(n.a)(oK,"TextboxDrawDragAdapter",null,[244,106]);class Ys{constructor(a,b,c){this.A9c=0;this.EO=null;this.Qbc=!1;this.Mze=this.T4c=null;this.iEb=new gd.a(0,0);this.Rma=1;this.gj=a;this.Kc=b;this.m9j=c;
this.m9j.eW(Object(F.a)(this,this.iZa,"onSlideNavigation"))}ctb(a){return a?!0:!1}iZa(){this.Rma=1;this.iEb=new gd.a(0,0);this.setTransform(new gd.a(0,0))}Qzb(a){if(!a)return!1;a=this.e9f(a.qc);return!!a&&1<a.length}AJe(a){if(!a)return!1;this.A9c=this.gj.TU;if(!this.Qzb(a))return!1;this.EO=this.kUc(a.qc);return!1}dlc(a){if(!a)return!1;this.Qzb(a)?(a=this.kUc(a.qc),this.EO||(this.EO=a),this.Ewd(this.Lpi(this.EO,a))):this.lAk(a);return!0}lAk(a){a&&(a=this.kUc(a.qc),this.Qbc?(a=this.bDf(this.T4c,a),
this.setTransform(a)):(this.Qbc=!0,this.T4c=a))}fo(a){if(this.Qbc&&a){a=this.kUc(a.qc);var b=this.bDf(this.T4c,a);a=b.x+this.iEb.x;b=b.y+this.iEb.y;this.Qbc=!1;this.iEb=new gd.a(a,b)}}bDf(a,b){return!a||1>a.length||!b||1>b.length?new gd.a(0,0):new gd.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Kc&&this.Kc.Ic&&this.Kc.Ic.GU){var b=this.Kc.Ic.GU;this.Mze||(this.Mze=b.style.cssText);b.style.cssText=this.Mze+"  width:100%;height:100%; transform:translate("+(a.x+this.iEb.x+"px,"+(a.y+this.iEb.y)+
"px) scale("+this.Rma+","+this.Rma+")")}}Hel(){this.setTransform(new gd.a(0,0))}HHb(a){if(!a)return!1;this.fo(a);this.myl();return!1}Ewd(a){this.A9c&&(a*=this.A9c,a<Ys.VZg?a=Ys.VZg:a>Ys.mZg&&(a=Ys.mZg),this.gj.Yka=!1,this.Rma=this.gj.TU=a,this.Hel())}aDf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}Lpi(a,b){a=this.aDf(a);b=this.aDf(b);return-1!==a&&-1!==b&&a?b/a:0}e9f(a){let b=null;if(!a)return null;a=a.rawEvent?a.rawEvent:
a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}kUc(a){let b=null;a=this.e9f(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new gd.a(c.screenX,c.screenY));return b}myl(){this.A9c=0;this.EO=null;this.Qbc=!1;this.T4c=null}}Ys.VZg=1;Ys.mZg=5;Object(n.a)(Ys,"ZoomSettingTouchAdapter",null,[1026]);var QQ=d(424);class pK{constructor(a,b,c,f,l,w){this.cze=!1;this.Km=null;this.Zxe=!1;this.Fb=a;this.EJ=b;this.ob=c;this.Kc=f;this.Fa=l;this.ua=w;this.Mr=new lo.a;this.Mr.ur("Marquee");
this.Mr.$j(0);this.Mr.xa.style.backgroundColor="darkgrey";this.Mr.xa.style.opacity="0.5";this.Mr.Rd(!1)}qSd(){this.Mr&&(this.Kc.Ic.te.xa.appendChild(this.Mr.xa),this.cze=!0)}WK(){this.Km=null;this.Mr&&(this.Mr.Rd(!1),this.Mr.zq(),this.cze=!1);this.Zxe=!1}Dv(a){if(!a||a.uA===Sys.UI.MouseButton.rightButton)return!1;a=new QQ.a(a,this.Fb);return this.Fb.sac(a)}Uu(a){if(!a||!this.Fb.isActive||!this.Dv(a))return!1;this.EJ.Gfh(new Lp(!0));a.ctrlKey||a.shiftKey?va.a.J(8959586,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",
a.ctrlKey,a.shiftKey):this.ob.Rh();this.Fa.Ed();this.Zxe=a.shiftKey?!0:!1;this.Km=this.hsa(a.clientPoint);this.cze||this.qSd();this.Mr.setPosition(this.Km.x,this.Km.y);this.Mr.lh(0,0);this.Mr.OB(1+vD.a.jba);this.Mr.Rd(!0);return!0}Gw(a){if(!a||!this.Fb.isActive)return!1;var b=this.hsa(a.clientPoint);a=Math.min(this.Km.x,b.x);const c=Math.min(this.Km.y,b.y),f=Math.max(this.Km.x,b.x);b=Math.max(this.Km.y,b.y);this.Mr.setPosition(a,c);this.Mr.lh(f-a,b-c);return!0}fo(a){if(a){var b=this.hsa(a.clientPoint);
a=Math.min(this.Km.x,b.x);var c=Math.min(this.Km.y,b.y),f=Math.max(this.Km.x,b.x);b=Math.max(this.Km.y,b.y);var l=this.ua.Ba,w=l?l.gk():[];l=[];var H=[],U=this.ob.Xd();for(const ja of w)(w=Object(qa.a)(117,ja.sc(this.Fb.Ma)))&&w.BQ&&(w.aq?w.ord():(w=w.Zae(!1),w.hc>=a&&w.kc>=c&&w.$b<=f&&w.Yb<=b&&(this.Zxe?Array.contains(U,ja)?H.push(ja):l.push(ja):Array.contains(U,ja)||l.push(ja))));0<l.length&&this.ob.R_a(l,!1);0<H.length&&this.ob.tsa(H);this.WK()}}pu(){this.Km&&this.WK()}hsa(a){const b=this.Kc.Ic.MB;
return b?gd.a.vSa(nK.a.MSa(a,b)):gd.a.vSa(a)}dispose(){this.Km&&this.WK();this.Mr=null}}Object(n.a)(pK,"MarqueeSelectDragAdapter",null,[244,106]);class qK{constructor(a){this.BX=null;this.eli(a);this.tce=!1}eli(a){null!==a&&(this.BX=gf.a.Ie(),this.BX.style.position=$i.a.absolute,this.BX.style.top="0px",this.BX.style.left="0px",a.appendChild(this.BX))}vya(a){null!==a&&null!==this.BX&&null!==this.BX.parentNode&&(this.BX.style.cursor=a,this.BX.style.zIndex=String($i.a.PMl),this.BX.style.height="100%",
this.BX.style.width="100%",this.tce=!0)}Xxa(){if(null!==this.BX||this.tce)this.BX.style.height="0px",this.BX.style.width="0px",this.BX.style.cursor=$i.a.Szh,this.BX.style.zIndex="-1",this.tce=!1}}Object(n.a)(qK,"CursorContainerManager",null,[329]);class wD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}Zb(a){this.K=a;a.register(329,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().oa(()=>new qK(a.resolve("PowerPointWebEditor.AppFrame").c2));
a.register(rD,"PowerPointWebEditor.ShapeManipulationActor").ma().oa(()=>new rD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new Bp(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").GTe,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(sD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().oa(()=>new sD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),na.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),
a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(330,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().oa(()=>new kK(a.resolve("Box4.IPageView").Ma,a.resolve("Box4.IPageView").Md,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||this.lEj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&
this.cFj();this.ZDj()}cFj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").rVk(new Ys(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}lEj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");
const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),w=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),H=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),U=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja=this.K.resolve("PowerPointWebEditor.ISlideReader"),wa=this.K.resolve("PowerPointWebEditor.IShapeReader"),
Sa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),eb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),ub=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),Ub=this.K.resolve("PowerPoint.IPathManager"),cc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Fc=!!window.requestAnimationFrame&&!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").iKb(2,
this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").iKb(1,new mK(a,b,l,U,this.K.resolve("Box4.IUndoManager"),c,f,w,H,wa,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Sa,eb,ub,cc,Fc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new Xs(a,b,c,f,w,H,U,
Sa,wa,eb,ub,cc,this.K.resolve("PowerPoint.IBrowserHelperManager"),Fc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new Kz(a,b,l,c,f,w,H,U,ja,Ub,cc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").nMe),new pK(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));c=new lK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"));
this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").vhh(c);this.K.resolve("PowerPointWebEditor.IApplicationSettings").Syb&&(a=new oK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").vhh(a));va.a.J(509691227,813,50,"Shape manipulation drag adapter init complete")}ZDj(){const a=
this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.Ee();a.wb()}dispose(){}static main(){v.a.instance.Dc(new wD)}}Object(n.a)(wD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var RQ=d(1153),Mx=d(1209),gr=d(115);class Nx{constructor(a,b,c,f,l,w,H,U){this.Fye=null;this.tye=new Date;this.TQ=a;this.Yck=b;this.sjk=c;this.I7j=f;this.Hck=l;this.FHa=w;H.Db(new Le.a(U,2,this.I7j,Object(F.a)(this,this.tFf,"checkTask"),90,"61"))}tFf(){this.wBl()}wBl(){var a=new Date;const b=+new Date-+this.Fye>
this.sjk;if(!(this.tye<this.Fye)||b){if(+a-+this.tye<this.Yck)return;this.TQ()}a=+new Date-+a;a>this.Hck&&va.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.FHa)}Ysd(){this.Fye=new Date}Usd(){this.tye=new Date}}Object(n.a)(Nx,"PrefetchThrottler",null,[]);class Up{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic){this.Jnd=250;this.rec=this.Occ=null;this.Uec=this.Dec=!1;this.TEb=[];this.aoi=5;this.xCf=10;
this.UEb=[];this.boi=5;this.zXa=!1;this.pXg=this.iJ=this.g3c=null;this.a8c=!1;this.JAe=[];this.Vb=a;this.ua=b;this.sH=c;this.xj=f;this.Bcb=l;this.oz=Ic;this.dna=w;this.Ha=H;this.zb=U;this.ic=ja;this.Iv=wa;this.lM=Sa;this.ld=eb;this.Mhk=ub;this.Oc=Ub;this.Qk=cc;this.ny=Fc;this.Chk=this.Ha.NTj;this.Kfk=u.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.Jfk=u.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");!B.a.Pi||this.Ha.OTj?this.setEnabled(this.Ha.AMj,this.Ha.UPj):
this.setEnabled(!1,!1);this.k$c=this.Ha.prefetchSlideForwardMax;this.j$c=this.Ha.prefetchSlideBackwardMax;this.M8j=u.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.s6k=u.AFrameworkApplication.fa.Bc("SlidePrefetchLookaheadCount",0);this.xH=!1;this.Oc.LA(Object(F.a)(this,this.tM,"onSessionClosed"));this.Oc.MPa(Object(F.a)(this,this.W0,"onSessionRehydrating"));this.Oc.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"));u.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&
(this.Jnd=125);this.ny&&this.ny.dFa(()=>{this.Vrl()})}Vrl(){this.pXg=new Le.a(2,1,this.Jnd,Object(F.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.a8c=!1;const a=this.Kfk?2:3;this.Occ=new Nx(Object(F.a)(this,this.uBl,"tryPrefetchContentModel"),this.Jnd,Up.t6k,Up.boh,Up.Wnh,"content model",this.zb,a);this.ld.wrb(Object(F.a)(this,this.nZa,"onVisibleThumbnailsChanged"));this.Qk.tI(Object(F.a)(this,this.DB,"onActiveSlideChanged"));this.rec=new Nx(Object(F.a)(this,this.xBl,
"tryPrefetchImages"),this.Jnd,Up.r6k,Up.boh,Up.Wnh,"image",this.zb,3);this.lM&&(this.lM.Gia(Object(F.a)(this,this.Qqg,"loadedHandler")),this.lM.kk(Object(F.a)(this,this.Kdh,"propertyChangedHandler")))}get xf(){this.g3c&&this.g3c.isConnected||(this.g3c=this.Vb.xf);return this.g3c}get Ba(){this.iJ||(this.iJ=this.ua.Ba);return this.iJ}setEnabled(a,b){this.Dec=a;this.Uec=b}Med(){this.TEb=[];this.UEb=[];this.zXa=!1}dispose(){this.ld.Zjh(Object(F.a)(this,this.nZa,"onVisibleThumbnailsChanged"));this.Qk.X5(Object(F.a)(this,
this.DB,"onActiveSlideChanged"));this.Oc.qaa(Object(F.a)(this,this.tM,"onSessionClosed"));this.Oc.emd(Object(F.a)(this,this.W0,"onSessionRehydrating"));this.Oc.Xfa(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.lM&&(this.lM.m_a(Object(F.a)(this,this.Qqg,"loadedHandler")),this.lM.Rm(Object(F.a)(this,this.Kdh,"propertyChangedHandler")))}tM(){this.xH=!0}W0(){this.Med()}Eo(){this.xH=!1}uBl(){this.Dec&&this.hvh()&&this.SJk()}SJk(){var a=this.Uae();const b=this.zXa?null:Pr.b(a,c=>c?c.Cb:null);(a=
this.qah(0,a))?(a=a.Cb,this.Occ&&this.Occ.Ysd(),this.Iv.prefetchSlide(a,b,()=>{this.zXa=!0}),this.YMk(a)):this.zXa||this.Iv.prefetchSlide(N.a.empty,b,()=>{this.zXa=!0})}DB(){this.iJ=null;this.zXa=!1}nZa(){this.Nzl();this.zXa=!1}Qqg(a,b){(a=Object(qa.a)(116,b.node))&&a.eE&&this.mkc(a)}Kdh(a,b){a=b.property;b.node&&a===hb.a.cid&&(this.zXa=!1)}mkc(a){if(a.isConnected){var b=Object(qa.a)(116,a);b&&(b.EFa=!0,this.zb.Db(new Le.a(2,1,0,Object(F.a)(this.rec,this.rec.tFf,"checkTask"),90,"60")),u.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&
(Array.clear(this.JAe),this.EPd(b.uXf),this.EPd(b.MCh),this.EPd(b.vGh),b=new Le.a(3,1,0,Object(F.a)(this,this.vBl,"tryPrefetchFonts"),90,"114"),b.customData=this.JAe,this.zb.Db(b)))}this.Occ&&(this.Occ.Usd(),this.TEb=[]);a.sza=!0;this.dna.p1a()}YMk(a){this.TEb.length>=this.xCf&&(this.TEb=[]);Array.add(this.TEb,a)}EPd(a){if(!ha.a.Wa(a)){a=a.split(",");for(const b of a)this.JAe.push(b)}}qah(a,b=null){const c=this.Ba;if(!c||!c.isConnected)return null;b||(b=this.Uae());return this.Xej(c,a,b)}Xej(a,b,
c){for(const f of c)if(f)if(c=f.Cb,this.Pzj(c))va.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.Tjl(f,b)){const l=a.Cb;a=this.ic.G6b(a);const w=this.ic.G6b(f);va.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",c,w,w-a,l,a,b);return f}return null}Pzj(a){let b=0;for(const c of this.TEb)a.equals(c)&&(b+=1);
if(b>=this.aoi)return!0;b=0;for(const c of this.UEb)a.equals(c)&&(b+=1);return b>=this.boi}Tjl(a,b){if(!a)return!1;const c=a.Cb;if(N.a.mx(c))return!1;const f=!!a&&a.eE;if(0===b)return!f;if(!f||!a.EFa)return!1;b=a.cUa(new gr.a(a.oq,a.Vk));if(null===b)return va.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if(!this.sH.gXc.Umd(l).data)return!0;return a.EFa=!1}xBl(){if(this.Uec&&this.hvh()){const b=this.qah(1);if(b){var a=b.Cb;this.rec.Ysd();
this.MXi(b);this.ZMk(a)}}}vBl(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.oz.aQi(b)}hvh(){return this.xH||!this.Chk&&2===this.xj.Kca||!this.xf||this.Bcb.i9(this.xf)||!this.Ba||this.Ba.CL?!1:!0}ZMk(a){this.UEb.length>=this.xCf&&(this.UEb=[]);Array.add(this.UEb,a)}MXi(a){if(a){var b=a.cUa(new gr.a(a.oq,a.Vk));b&&0<b.length?this.sH.Pvb(b,!0,()=>{this.rec.Usd();this.UEb=[];a.EFa=!1},u.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):a.EFa=!1}}Nzl(){this.a8c||
(this.zb.Db(this.pXg),this.a8c=!0)}updateSlidePrefetchRange(){this.a8c=!1;this.Iv.syncCurrentSlideIdAndPrefetchRange(this.Ba,null,this.dna.ypa,null)}cpj(){return Pr.b(this.Uae(),a=>a?a.Cb:null)}Uae(){var a=this.Ba;if(!a||!a.isConnected)return[];a=this.ic.G6b(a);var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,f=[],l=[];if(!this.M8j)for(var w of this.dna.ypa.Y3)w!==a&&w<c&&(Array.add(l,b[w]),f[w]=!0);if(this.Jfk&&!f.length)for(w=1;w<=
this.s6k;w++){const H=this.dna.ypa.lastIndex+w;H!==a&&H<c&&(Array.add(l,b[H]),f[H]=!0)}if(0<=a){a=this.Mhk.u7f(a,b.length,this.k$c,this.j$c);for(const H of a)if(void 0===f[H]||null===f[H])f[H]=!0,Array.add(l,b[H])}return l}}Up.boh=1E3;Up.t6k=2E3;Up.r6k=6E4;Up.Wnh=500;Object(n.a)(Up,"PrefetchManager",null,[328,106]);class xD{constructor(a,b,c,f){this.wi=b;this.uE=c;this.pa=f;this.Oc=a;this.Oc.LPa(Object(F.a)(this,this.ghb,"onSessionEnding"))}ghb(a,b){if(this.pa.Zz()){a=this.pa.Xd();if(!a.length){const c=
this.pa.X6f();c&&a.push(c)}for(const c of a)this.wi.q7a(c)}this.uE.W0i(b.NE)}dispose(){this.Oc.QRe(Object(F.a)(this,this.ghb,"onSessionEnding"))}}Object(n.a)(xD,"SessionCleanupHandler",null,[106]);var rK=d(436),SQ=d(957);class yD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.TEd=this.yAc=this.aCe=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ha=a;this.zhc=a.sessionTimeoutInMs;this.zb=b;this.mE=c;this.pa=f;this.zWa=l;this.MC=w;this.Sd=H;this.ua=
U;this.fc=ja;this.Mm=wa;this.PTg=Sa;this.To=eb;this.cvg=ub;this.yhc=0}get jda(){return this.zWa.instance}get N_(){return u.AFrameworkApplication.Ug}get dng(){return 1===this.yhc}get rAb(){return this.yAc}get z0c(){return this.TEd}get NE(){return this.yhc}set NE(a){this.yhc=a}get UDf(){return this.Ha.podsSeamlessFailoverEnabled&&!!this.To.instance}start(){if(!this.N_){var a=new Le.a(4,2,3E4,Object(F.a)(this,this.yYg,"manageLifetime$p"),90,"56");this.zb.Db(a)}}elk(){this.yYg(null)}yYg(){if(!this.aCe){var a=
+new Date-+Rc.a.gbc;a>this.zhc&&this.wVi(a);u.AFrameworkApplication.$z&&u.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ha.wopiTokenRefreshMaxDurationInMs&&this.MC.BRk()}}wVi(a){this.N_||(this.TGf(2),this.UDf?this.cvg.instance&&this.cvg.instance.J$a&&(va.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),dg.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),
this.PTg.qol()):this.PTg.pol(),this.MC.DQk(),va.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.zhc,this.UDf,!!this.To.instance,this.Ha.podsSeamlessFailoverEnabled))}closeSession(a=1){this.TGf(a)}TGf(a){0===a&&va.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.N_)try{this.yAc=!0,va.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",
rK.a[a]),this.yhc=a,this.pa.setSelection(null),u.AFrameworkApplication.Ug=!0,this.mE.c$a().sfd=!0,this.Sd.disabled=!0,Nl.a.gx&&4!==a&&Nl.a.gx.hide(),this.MC.BPe(new SQ.a(a)),this.jda&&0<this.jda.HDa.count&&this.jda.Coc(this.mE.gTa().presentationId,"instanceId",!0,!1),this.Ha.podsSeamlessFailoverEnabled&&this.To.instance&&(1===a?this.To.instance.rOd("abortedOnExitApp"):this.To.instance.rOd("SessionClose_"+a)),this.zb.stop(),this.Mm.isPaused||this.Mm.pause(),4!==a&&2!==a&&this.fc.blockContent(this.ua.presentation,
"CloseSession",!0),this.MC.Ykd(new un.a(a))}finally{this.TEd=this.yAc=!1}}Yol(){this.aCe=!0}K4k(){this.aCe=!1}markSessionClosingAtForceSave(a){va.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",rK.a[a]);this.TEd=this.yAc=!0;this.yhc=a}}Object(n.a)(yD,"SessionLifetimeManager",null,[1100]);var tg=d(426);class sK{constructor(){this.trigger=null;this.Taa=this.Vkb=this.W0a=0;this.SXd={}}}Object(n.a)(sK,"SuggestionsInfo",null,[]);class tK{constructor(){this.SessionID=
this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(n.a)(tK,"StartRtcConnectionRequest",null,[]);class uK{constructor(){this.SessionID=null}}Object(n.a)(uK,"StopRtcConnectionRequest",null,[]);var TQ=d(286);class vK{constructor(a,b){this.slideId=a;this.imageId=TQ.a.dMc(b)}}Object(n.a)(vK,"ThumbnailImageId",null,[]);var Zs=d(297);const wK=a=>{let b,c,f;var l;let w,H;b=null;f=c=0;w=l=null;H=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&
8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new Zs.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new N.a(l),w=a[6],H=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,gV:c,Taa:f,slideID:l,trigger:w,Vkb:H}):{returnValue:!1,correlationID:b,gV:c,Taa:f,slideID:l,trigger:w,Vkb:H}},UQ=a=>{const b=new Ka.a;try{const c=Jc.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){va.a.J(42342594,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};
var Lz;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(Lz||(Lz={}));Object(n.b)("CoauthorStatus",Lz);class xK extends Sys.EventArgs{constructor(a){super();this.Iia=a}}Object(n.a)(xK,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class yK extends Sys.EventArgs{constructor(a){super();this.gQc=a}}Object(n.a)(yK,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class zK extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.KVc=a;this.VPc=b;this.iPj=c;this.confidence=
f;this.imageDescription=l}}Object(n.a)(zK,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class AK extends Sys.EventArgs{constructor(a){super();this.s$b=a}}Object(n.a)(AK,"IsManuallyAppliedEventArgs",Sys.EventArgs,[]);class BK extends Sys.EventArgs{constructor(){super()}}Object(n.a)(BK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class CK extends Sys.EventArgs{constructor(a){super();this.p4d=a}}Object(n.a)(CK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class DK extends Sys.EventArgs{constructor(){super()}}
Object(n.a)(DK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class EK extends Sys.EventArgs{constructor(){super()}}Object(n.a)(EK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class zD extends Sys.EventArgs{constructor(a,b=null){super();this.tik=a;this.p9j=b}get QAh(){return this.tik}get MVi(){return this.p9j}}Object(n.a)(zD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class FK extends Sys.EventArgs{constructor(a){super();this.BKk=a}}Object(n.a)(FK,"PresentationLastModifiedTimeReceivedEventArgs",
Sys.EventArgs,[]);var VQ=d(883);class GK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(n.a)(GK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class Mz extends Sys.EventArgs{constructor(a,b,c,f,l,w,H){super();this.lee=!1;this.Esc=null;this.correlationId=a;this.W0a=b;this.Taa=c;this.trigger=l;this.slideId=w;this.lDa=H;this.BLa=f}}Object(n.a)(Mz,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class Ox extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=
a;this.slideId=b;this.lDa=c}}Object(n.a)(Ox,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class HK extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.WY=c;this.shapeId=b;this.lDa=f}}Object(n.a)(HK,"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class IK extends Sys.EventArgs{constructor(a,b,c,f,l,w){super();this.correlationId=a;this.Yda=b;this.slideId=c;this.shapeId=f;this.zKa=l;this.lDa=w}}Object(n.a)(IK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class Nz extends Sys.EventArgs{constructor(a){super();
this.ame=!1;this.ame=a}}Object(n.a)(Nz,"ToggleChatPPTPaneEventArgs",Sys.EventArgs,[]);class JK extends Sys.EventArgs{constructor(a){super();this.hTj=a}}Object(n.a)(JK,"PictureRenderSuccessEventArgs",Sys.EventArgs,[]);var WQ=d(381);class AD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg){this.aue=this.Ute=!1;this.yGg=null;this.bIg={};this.dna=b;this.gl=lg;this.Gq=l;this.i4c=w;this.Vb=U;this.ua=ja;this.Iv=wa;this.i$c=Sa;this.Sd=eb;this.MC=ub;this.je=Ub;this.m4c=cc;this.Mu=
Fc;this.Xa=a;this.lR=Ic;this.yEb=Cc;this.Oc=Ud;this.O4c=c;this.Ha=je;this.eu=Vd;this.zb=Ve;this.Mv=af;this.mc=Zf;this.JDg=this.Ha.vg&&this.Ha.pptNoRtcConnectWhenReadOnlyEnabled;this.Oc.LPa(Object(F.a)(this,this.GB,"onSessionEnd"));this.Oc.LA(Object(F.a)(this,this.J4d,"flushOnSessionEnd"));this.O4c.fvf(Object(F.a)(this,this.z5g,"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.fvf(Object(F.a)(this,this.z5g,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ha.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
this.Oc.iC(Object(F.a)(this,this.gaa,"onPodSessionRehydrated"));this.JDg&&this.Oc.S7(Object(F.a)(this,this.Hw,"onUnifiedAppStateChanged"))}z5g(a,b){this.huk(b,this.i4c)}huk(a,b){let c=!1;const f=[],l=[],w=new sK;for(const Cc of a.items){const Ud=new Date,je=this.eu.qFa;var H=void 0,U=void 0,ja=void 0,wa=void 0,Sa=void 0,eb=void 0;if(Cc.Key===tg.a.qch)b.x8d(tg.a.qch)>Cc.TimeStamp||(va.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else{var ub=void 0;ub=null;(U=Cc.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&
5===U.length?(ub=new Zs.a,ub.Sid=Number.parseInvariant(U[3]),ub.Cid=Number.parseInvariant(U[4]),ub=new N.a(ub),U={returnValue:!0,slideId:ub}):U={returnValue:!1,slideId:ub};if(({slideId:U}=U).returnValue)U=tg.a.Eae(U.sid,U.cid),b.x8d(U)>=Cc.TimeStamp||(U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),Array.add(f,new VQ.a(U,0<U.SnapshotTimeStamp?U.SnapshotTimeStamp:Cc.TimeStamp)));else if(Cc.Key.startsWith(tg.a.CRf))U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),this.Gq.gIh(U),
va.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",U);else if(Cc.Key===tg.a.pRi)U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),va.a.J(512497795,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",Cc.LastRequestCorrelationID,Cc.TimeStamp,U.length),this.Gq.zHh(U);else if(Cc.Key===tg.a.Xvi)U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),
va.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",Cc.LastRequestCorrelationID,Cc.TimeStamp,Lz[U]),this.Gq.Guc(U);else if(Cc.Key===tg.a.YAi)va.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",Cc.LastEditorID,Cc.LastRequestCorrelationID,Cc.TimeStamp,
Cc.Value,!1),this.MC.dPk(),this.Iv.DF(this.Vb.zi),(this.Ha.eB||this.Ha.$W)&&Object(Pd.a)("showChatPPTPane")&&this.je.SPe(new Nz(!1));else{if(ub=Cc.Key.startsWith(tg.a.tOf)){a:{ub=void 0;U=Cc.Value;try{const Vd=U?U.split(","):[];if(3!==Vd.length){ub=N.a.VE(0,0);va.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",U);var Ub={returnValue:!1,slideId:ub};break a}const Ve=Number.parseInvariant(Vd[0]),af=Number.parseInvariant(Vd[1]),
Zf=Vd[2];ub=N.a.VE(Number.parseInvariant(Vd[0]),Number.parseInvariant(Vd[1]));va.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",Ve,af,Zf)}catch(Vd){va.a.J(23089481,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",U,Vd.toString());ub=N.a.VE(0,0);Ub={returnValue:!1,slideId:ub};break a}Ub={returnValue:!0,slideId:ub}}ub=({slideId:U}=
Ub).returnValue}if(ub)va.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",Cc.Value),this.je.hPk(new GK(U));else{if(ub=Cc.Key.startsWith(tg.a.kAh)){{var cc=void 0;let Vd;U=null;H=0;cc=Vd=null;(ub=Cc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===ub.length?(U=ub[1],H=Number.parseInvariant(ub[2]),cc=Object.assign(new Zs.a,{Sid:Number.parseInvariant(ub[3]),Cid:Number.parseInvariant(ub[4])}),
Vd=new N.a(cc),cc=ub[6],H={returnValue:!0,correlationID:U,gV:H,slideID:Vd,trigger:cc}):H={returnValue:!1,correlationID:U,gV:H,slideID:Vd,trigger:cc}}ub=({correlationID:H,gV:w.W0a,slideID:U,trigger:w.trigger}=H).returnValue}if(ub)va.a.J(512497792,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",H),U=new Mz(H,w.W0a,w.W0a,0,w.trigger,U,Cc.Value),U.Esc=new Ka.a,this.vNe(U);else if(this.Ha.designerIncrementalRenderEnabled&&Cc.Key.startsWith(tg.a.nee)&&
({correlationID:H,gV:w.W0a,Taa:w.Taa,slideID:U,trigger:w.trigger,Vkb:w.Vkb}=wK(Cc.Key)).returnValue)va.a.J(512497763,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",H,w.Vkb,w.W0a,w.Taa),U=new Mz(H,w.W0a,w.Taa,w.Vkb,w.trigger,U,Cc.Value),H in w.SXd||(w.SXd[H]=this.xmj(H,a.items)),U.Esc=w.SXd[H],U.lee=!0,this.vNe(U);else{if(ub=Cc.Key.startsWith(tg.a.EXf))U=
H=null,(ub=Cc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===ub.length?(H=ub[1],U=Object.assign(new Zs.a,{Sid:Number.parseInvariant(ub[2]),Cid:Number.parseInvariant(ub[3])}),U=new N.a(U),H={returnValue:!0,correlationID:H,slideID:U}):H={returnValue:!1,correlationID:H,slideID:U},ub=({correlationID:H,slideID:U}=H).returnValue;if(ub)va.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",
H),this.vNe(new Ox(H,U,Cc.Value));else{if(ub=Cc.Key.startsWith(tg.a.fgg))eb=null,ja=0,ub=null,H=U=0,(wa=Cc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===wa.length?(eb=wa[1],ja=Number.parseInvariant(wa[2]),H=Object.assign(new Zs.a,{Sid:Number.parseInvariant(wa[3]),Cid:Number.parseInvariant(wa[4])}),ub=new N.a(H),U=Number.parseInvariant(wa[5]),H=Number.parseInvariant(wa[6]),ja={returnValue:!0,correlationID:eb,Yda:ja,slideID:ub,shapeId:U,zKa:H}):ja={returnValue:!1,
correlationID:eb,Yda:ja,slideID:ub,shapeId:U,zKa:H},ub=({correlationID:H,Yda:ja,slideID:U,shapeId:wa,zKa:eb}=ja).returnValue;if(ub)va.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",H),this.je.uQk(new IK(H,ja,U,wa,eb,Cc.Value));else if(Cc.Key===tg.a.GMl)this.Byj();else if(Cc.Key===tg.a.KVf&&this.yGg!==Cc.Value)this.ytj(Cc);else if(Cc.Key===tg.a.RAh)!ha.a.Wa(Cc.Value)&&ha.a.Wzb(Cc.Value)?(U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),
va.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",U,this.Xa.Kk,this.Xa.podSessionId),240===U?this.lR.Vfa(1):(432!==U||this.aue||this.bQf(),this.yEb.Lfh(new zD(U)))):(U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),va.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",
U.Code,!!U.ExtraErrorParam,this.Xa.Kk,this.Xa.podSessionId),240===U.Code?this.lR.Vfa(1):(432!==U.Code||this.aue||this.bQf(),this.yEb.Lfh(new zD(U.Code,U.ExtraErrorParam))));else if(Cc.Key===tg.a.Mpg)this.tuj(Cc);else if(Cc.Key===tg.a.pBj)va.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",this.Xa.Kk),this.lR.Vfa(1);else if(Cc.Key===tg.a.CKk)U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),this.Vb.xf.yMe=
U,this.Mu.nQk(new FK(U));else if(Cc.Key.startsWith(tg.a.VHf)){va.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",Cc.Key);a:{U=Cc.Key;try{const Vd=U.match(RegExp("\\d+","g"));if(Vd&&0<Vd.length&&!(Vd.length%2)){ub=[];for(cc=0;cc<Vd.length;cc+=2)ub.push(Object.assign(new Zs.a,{Sid:Number.parseInvariant(Vd[cc]),Cid:Number.parseInvariant(Vd[cc+1])}));var Fc=ub;break a}}catch(Vd){va.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",
U,Vd)}Fc=null}(U=Fc)&&0<U.length&&this.MC.ZOk(new BK(U))}else if(Cc.Key.startsWith(tg.a.feg))this.Vtj(Cc);else if(Cc.Key===tg.a.jWf)this.m4c.qPk(new yK(Cc.Value));else{if(ub=Cc.Key.startsWith(tg.a.Idg)){a:{Sa=Cc.Key;ub=null;U=0;wa="";try{const Vd=Sa.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));if(Vd&&5===Vd.length){const Ve=Object.assign(new Zs.a,{Sid:Number.parseInvariant(Vd[1]),Cid:Number.parseInvariant(Vd[2])});ub=new N.a(Ve);U=Number.parseInvariant(Vd[3]);wa=Vd[4];var Ic={returnValue:!0,
slideID:ub,shapeId:U,nodeId:wa};break a}}catch(Vd){va.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",Sa,Vd.toString())}Ic={returnValue:!1,slideID:ub,shapeId:U,nodeId:wa}}ub=({slideID:U,shapeId:wa,nodeId:Sa}=Ic).returnValue}if(ub)va.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.je.BPk(new HK(U,wa,Sa,Cc.Value));else if(Cc.Key===
tg.a.uZi)this.yEb.rPk(new CK(Cc.Value));else{if(ub=Cc.Key.startsWith(tg.a.RCh))ub=null,(U=Cc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===U.length?(ub=new Zs.a,ub.Sid=Number.parseInvariant(U[1]),ub.Cid=Number.parseInvariant(U[2]),ub=new N.a(ub),U={returnValue:!0,slideId:ub}):U={returnValue:!1,slideId:ub},ub=({slideId:U}=U).returnValue;if(ub)U=new vK(U,Cc.Value),U.imageId&&l.push(U);else if(Cc.Key===tg.a.APi)this.Mv.l5e(parseInt(Cc.Value));else if(Cc.Key===tg.a.Xxf)this.m4c.QOk(new xK(Cc.Value));
else if(Cc.Key===tg.a.Rkg)this.m4c.JPk(new AK("true"===Cc.Value.toLowerCase()));else if(Cc.Key===tg.a.D5k)this.Gq.knh=Cc.Value,this.Gq.d6g();else if(Cc.Key===tg.a.B5k)try{this.Gq.Dqd=Boolean.parse(Cc.Value)}catch(Vd){va.a.J(512497755,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Vd)}else if(Cc.Key===tg.a.Dpg)U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),va.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",
U.toString()),this.MC.OPk(new DK(U));else if(Cc.Key===tg.a.pgh)U=Sys.Serialization.JavaScriptSerializer.deserialize(Cc.Value),va.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",U.toString()),this.MC.pQk(new EK(U));else if(Cc.Key===tg.a.tDj)try{this.Gq.Dje=Boolean.parse(Cc.Value),va.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.Gq.Dje)}catch(Vd){va.a.J(512497751,
817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Vd)}else if(Cc.Key===tg.a.nBj)this.Gq.imc=Cc.Value,va.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.Gq.imc);else if(Cc.Key===tg.a.QMl)va.a.J(512497749,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.Gq.qLh=!0;else if(Cc.Key===tg.a.y2j)va.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",
Cc.Value),this.Gq.n4=Cc.Value;else if(Cc.Key===tg.a.z2j)va.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",Cc.Value),this.Gq.Wqg=Boolean.parse(Cc.Value);else if(Cc.Key===tg.a.MNf)try{this.Gq.Y7a=Number.parseInvariant(Cc.Value),va.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.Gq.Y7a)}catch(Vd){va.a.J(512497745,843,15,"Can't parse the notification message: {0}",Vd)}else if(Cc.Key===
tg.a.Dwf){let Vd;try{Vd=Boolean.parse(Cc.Value),this.Gq.minorVersionLimitReached=Vd}catch(Ve){Vd=this.Gq.minorVersionLimitReached=!1}Vd&&!this.Ute&&(this.IOi(),this.Ute=!0);va.a.J(512497744,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",Cc.Value,this.Ute)}else va.a.J(512497743,817,50,"Notification key ignored {0}",Cc.Key)}}}}}}}va.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",
Cc.Key,Rc.a.mf(Ud),(+new Date-+Ud).toString());je&&!this.eu.qFa&&va.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",Cc.Key);w.trigger===WQ.a.insertPicture&&this.YLk(new JK(!0))}this.FEl(c,f,b,l)}xmj(a,b){const c=new Ka.a;b=dk.e(b,f=>f.Key.startsWith(tg.a.nee));for(const f of b)b=wK(f.Key),b.returnValue&&b.correlationID===a&&(1===b.gV?c.add(b.Vkb):1<b.gV&&c.addRange(UQ(f.Value)));return c}IOi(){this.gl.dL(24);va.a.J(512497740,
809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}bQf(){this.aue=!0;this.gl.dL(25);va.a.J(512497739,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}YLk(a){this.je.jQk(a)}vNe(a){let b;b=Object(Ya.a)(Ox,a)?()=>{this.je.raiseFixItSuggestionUpdatedEvent(Object(qa.a)(Ox,a))}:()=>{this.je.raiseDesignerSuggestionsUpdatedEvent(Object(qa.a)(Mz,a))};if(this.eu.qFa&&
this.Ha.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new Le.a(2,1,0,()=>{b()},90,Object(Ya.a)(Ox,a)?"114":"92");this.zb.Db(c)}else b()}FEl(a,b,c,f){a&&(this.dna.vrj(),this.i$c.instance&&this.i$c.instance.Med());b.forEach(l=>{const w=l.l3b.Id;c.DEl(tg.a.Eae(w.Sid,w.Cid),l.gga)});this.dna.ztj(b,f)}Byj(){va.a.J(512497738,817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Vb.zi&&this.Vb.zi.contentReplicator&&(this.Vb.zi.contentReplicator.enabled=
0);this.Sd.cH(158,a=>{a.mC=1;return!1})}ytj(a){va.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");this.MC.pPk(new jk(!1,!0));let b=null;this.i$c.instance&&(b=this.i$c.instance.cpj());this.Iv.syncCurrentSlideIdAndPrefetchRange(this.ua.Ba,b,null,null);this.yGg=a.Value}tuj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Xa.podSessionId!==a)if(this.Ha.ignorePodSessionRefreshedFromPops)va.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");
else{const b=this.Xa.podSessionId;this.Xa.podSessionId=a;this.yEb.ifh(new Nm.a(b,a))}else va.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}Vtj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)va.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=ia.a.Gf(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);
this.m4c.CPk(new zK(c,f,l,parseFloat(b[4]),b[5]))}}else va.a.J(512497734,817,15,"Response data is null")}catch(b){va.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}g0i(){let a=0;const b=[],c=(new Date).getTime(),f=this.bIg;for(let w in f){var l=w;0<c-f[w]&&(a++,delete this.bIg[l])}(0<a||0<b.length)&&va.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,Qa.a.join(b,","))}J4d(){this.g0i()}jzh(){if(this.JDg&&!this.mc.BL)va.a.J(512497730,
801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");else{var a=Ab.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=gh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",this.Ha.podsWebServiceBase),f=Object.assign(new tK,{BaseDocQueryStringWithoutVersion:u.AFrameworkApplication.hh,SerializedUser:this.Ha.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;
l["X-CorrelationID"]=b;a=Jc.c(f);u.AFrameworkApplication.Ke.cW(c,2,a,l,[be.a.N5],0,w=>{this.Rrg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",w.data.AI,w.data.Zt,w.data.qv,w.data.Wd))},w=>{const H=Ab.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");this.Rrg(10,H.hka(w))},null,void 0,void 0,void 0,void 0,Jx.a("3"))}}Dzh(){var a=Ab.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=gh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",
this.Ha.podsWebServiceBase),f={};f.PodSID=a;f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new uK,{SessionID:a});a=Jc.c(a);u.AFrameworkApplication.Ke.cW(c,2,a,f,[be.a.N5],0,()=>{va.a.J(38904456,801,50,"StopServerRtcConnection - request succeeded")},l=>{const w=Ab.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");va.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",w.hka(l))},null,void 0,void 0,void 0,void 0,
Jx.a("9"))}Rrg(a,b){va.a.J(512497729,801,a,"StartServerRtcResult: {0}",b)}gaa(){this.jzh()}Hw(a,b){b.Lke&&!this.mc.BL&&(va.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.Dzh())}GB(){this.Dzh()}}Object(n.a)(AD,"CoauthNotificationManager",null,[]);class KK{constructor(a,b){this.PPh=a;this.k$e=b}get coauthoringStartTime(){return this.PPh}get fHf(){return this.k$e}Kal(a){this.k$e=a}}Object(n.a)(KK,"CoauthoringDurationRecord",null,[]);var XQ=d(955);class LK extends Sys.EventArgs{constructor(a,
b,c=!1){super();this.Zyf=a;this.cqg=b;this.xOj=c}}Object(n.a)(LK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class Oz{constructor(a,b,c){this.fna=this.oeb=null;this.zcb=[];this.Wug=new fk.a;this.SHg=new fk.a;this.uze=null;this.hyg=!1;this.mze=0;this.wyg=this.r5c=!1;this.Y9c="";this.knh=null;this.minorVersionLimitReached=this.qLh=this.Ylg=this.Dqd=this.xVf=!1;this.Wye=null;this.Wqg=!1;this.Y7a=0;this.c0c=!1;this.sGa=a;this.Oc=b;this.s4c=0;this.Zcb=[];this.Oc.iQd(Object(F.a)(this,this.chb,"onPopSessionClosed"));
this.hck=c}get bD(){return this.oeb}set bD(a){this.oeb!==a&&(this.oeb&&0<this.oeb.length&&2===this.s4c&&va.a.J(509670560,804,10,String.format("MyEditorID is changed from {0} to {1}",this.oeb,a)),this.oeb=a)}get userName(){return this.fna}get Dje(){return this.r5c}set Dje(a){(this.r5c=a)&&!this.wyg&&dg.Health.instance&&(this.wyg=!0,dg.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.r5c.toString()))}get imc(){return this.Y9c}set imc(a){a!==this.Y9c&&(this.Y9c=a,va.a.J(509670558,804,50,
"CoauthStateCache - PopsHostProtocol:{0}",this.Y9c))}get n4(){return this.Wye}set n4(a){this.Wye=a;(a=this.hck.value.instance)?(a.qWd=this.Wye,va.a.J(509670557,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",a.qWd)):va.a.J(509670556,804,50,"CoauthStateCache::LockId - renameProps == null");this.sGa.QPk()}get i_(){const a=[];Array.addRange(a,this.Zcb);return a}get XIl(){return this.i_.length?this.i_.length:1}get amIAlone(){return 2!==this.Kca}get vw(){return this.Wqg}get Kca(){return this.s4c}set Kca(a){this.s4c!==
a&&(va.a.J(509670554,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.s4c=a)}get yCa(){return this.Wug.task}get Idd(){return this.SHg.task}get DQc(){return this.uze}set DQc(a){this.uze||(this.uze=a,this.SHg.Kg(a.getTime()))}zHh(a){let b;({lSd:a,leaving:b}=this.cFl(a)).returnValue&&(a=new LK(a,b,!this.c0c),this.lTk(),this.sGa.lPk(a))}lTk(){const a=[],b=this.i_;for(const c of b)Array.add(a,c.ID)}Guc(a){const b=this.Kca;2===a&&(this.DQc=new Date);0!==b||this.hyg||(va.a.J(509670553,
804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.hyg=!0,this.Wug.Kg(1===a?1:0));this.Kca=a;b!==this.Kca&&(this.sGa.XOk(new XQ.a(this.Kca)),this.qEl(this.Kca))}qEl(a){var b=new Date;2===a?(b=new KK(b,new Date(9999,12,31)),Array.add(this.zcb,b)):(a=this.zcb.length,0<a&&this.zcb[a-1].Kal(b))}gIh(a){this.bD=a;va.a.J(509670552,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.bD,this.i_.length);this.sGa.WOk()}Wlb(a){let b;a&&(a=a.toLowerCase());b=null;
for(let c=0;c<this.Zcb.length;c++){const f=this.Zcb[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}cFl(a){let b,c;const f=[];b=[];c=[];let l=!1;const w=a?a.length:0;for(let H=0;H<w;H++){const U=a[H];U&&U.ID&&(U.ID=U.ID.toLowerCase());let ja;({editor:ja}=this.Wlb(U.ID)).returnValue?(l=l||!Oz.sRi(U,ja),Array.remove(this.Zcb,ja)):(U.ID!==this.oeb?Array.add(b,U):this.fna=U.Name,l=!0);Array.add(f,U)}Array.addRange(c,this.Zcb);l=l||0<c.length;this.Zcb=f;this.mze=Math.max(this.mze,this.Zcb.length);
dg.Health.instance&&dg.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.mze.toString());return{returnValue:l,lSd:b,leaving:c}}jSc(a,b){let c=0;const f=this.zcb.length;if(0<f&&a<this.zcb[f-1].fHf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const w=Math.max(this.zcb[l].coauthoringStartTime.getTime(),a),H=Math.min(this.zcb[l].fHf.getTime(),b);w<H&&(c+=H-w)}}return c}d6g(){this.Ylg=!0;this.sGa.mQk()}chb(){this.imc=""}static sRi(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===
b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(n.a)(Oz,"CoauthStateCache",null,[1098,1099]);var mu=d(377);class vl{constructor(){this.KeyRoot=null;this.TimeStamp=0}}Object(n.a)(vl,"KeyRootSubscription",null,[]);class Fv{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.pic=mu.a.empty;this.Js=[];this.TGa=[];this.zyg=this.Hte=!1;this.O4c=a;this.hwe=b;this.Fg=c;this.G3c=wa.nki;this.dna=f;this.i4c=l;this.xj=w;this.rkk=H.tYd(1E3,Object(F.a)(this,this.fUi,"ensureVisibleThumbnailsSubscriptionImpl"));
this.Oc=U;this.ld=ja;this.Xa=wa;Sa.LOd(this);this.E$c=eb;this.kfc=ub;this.xH=!1;this.E$c&&this.Oc.O$h(Object(F.a)(this,this.tsk,"onBackendChanged"));this.Oc.LA(Object(F.a)(this,this.tM,"onSessionClosed"));this.Oc.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"))}gxa(){this.xH=!1;this.i4c.reset();this.rfg()}rfg(){Array.clear(this.Js);this.pic=mu.a.empty;this.qtd=this.dna.ypa;this.ld.wrb(()=>{this.qtd=this.dna.ypa});const a=new vl;a.KeyRoot=tg.a.P_f(this.G3c);a.TimeStamp=0;this.Js.push(a);var b=new vl;
b.KeyRoot=tg.a.pch;b.TimeStamp=0;this.Js.push(b);b=new vl;b.KeyRoot=tg.a.Wvi;this.Js.push(b);var c=new vl;c.KeyRoot=tg.a.kAh;this.Js.push(c);c=new vl;c.KeyRoot=tg.a.nee;this.Js.push(c);c=new vl;c.KeyRoot=tg.a.fgg;this.Js.push(c);c=new vl;c.KeyRoot=tg.a.tOf;this.Js.push(c);c=new vl;c.KeyRoot=tg.a.KVf;this.Js.push(c);c=new vl;c.KeyRoot=tg.a.RAh;this.Js.push(c);const f=new vl;f.KeyRoot=tg.a.Mpg;this.Js.push(f);const l=new vl;l.KeyRoot=tg.a.rBj;this.Js.push(l);var w=new vl;w.KeyRoot=tg.a.VHf;this.Js.push(w);
w=new vl;w.KeyRoot=tg.a.feg;this.Js.push(w);w=Object.assign(new vl,{KeyRoot:tg.a.jWf,TimeStamp:0});this.Js.push(w);w=new vl;w.KeyRoot=tg.a.Idg;this.Js.push(w);this.kfc&&(w=new vl,w.KeyRoot=tg.a.RCh,this.Js.push(w));w=new vl;w.KeyRoot=tg.a.Xxf;this.Js.push(w);w=new vl;w.KeyRoot=tg.a.Rkg;this.Js.push(w);w=new vl;w.KeyRoot=tg.a.Dpg;this.Js.push(w);w=new vl;w.KeyRoot=tg.a.pgh;this.Js.push(w);w=new vl;w.KeyRoot=tg.a.EXf;this.Js.push(w);w=new vl;w.KeyRoot=tg.a.Dwf;this.Js.push(w);const H=new vl;H.KeyRoot=
tg.a.MNf;this.Js.push(H);this.O4c.Upd(this.Js);this.hwe&&(Array.clear(this.TGa),this.TGa.push(b),this.TGa.push(a),this.TGa.push(c),this.TGa.push(f),this.TGa.push(l),this.TGa.push(w),this.Fg.fG?(this.hwe.Upd(this.TGa),this.Hte=!0):(this.Oc.jQd(Object(F.a)(this,this.cZa,"onPopSessionInitialized")),this.zyg=!0))}cZa(){this.Hte||(this.hwe.Upd(this.TGa),this.Hte=!0)}get qtd(){return this.pic}set qtd(a){mu.a.equals(this.pic,a)||(mu.a.equals(a,mu.a.empty)?this.pic=mu.a.empty:this.pic=mu.a.gwb(a.IW,a.lastIndex),
this.rkk.perform())}tsk(a,b){this.xH||(a=b.OBk)&&0<a.length&&(va.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",a,this.Xa.sIc),this.gxa())}tM(){this.xH=!0}Eo(){this.gxa()}fUi(){const a=this.Js;var b=this.i4c;const c=[];var f=null;for(const w of this.qtd.Y3){var l=tg.a.Onj(w);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new vl,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);if(l=this.dna.m$a(w))l=b.x8d(tg.a.Eae(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=
l)}f&&c.push(f);dk.d(a,Object(F.a)(this,this.OWi,"fNeedResetBrowserKeySubscription"),w=>{w.TimeStamp=0},1);b=dk.e(a,w=>w.KeyRoot.startsWith(tg.a.SCh));f=dk.a(c,b,Fv.Gne);dk.a(b,f,Fv.Gne);if(b.length||c.length)dk.a(a,b,Fv.Gne),Array.addRange(a,c),this.O4c.Upd(a)}OWi(a){return a.KeyRoot.startsWith(tg.a.P_f(this.G3c))&&!this.xj.bD?(va.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),!0):!1}dispose(){this.Oc.qaa(Object(F.a)(this,
this.tM,"onSessionClosed"));this.Oc.Xfa(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.zyg&&this.Oc.ORe(Object(F.a)(this,this.cZa,"onPopSessionInitialized"))}static Gne(a,b){return a.KeyRoot===b.KeyRoot}}Object(n.a)(Fv,"CoauthSubscriptionManager",null,[1097,106,1096]);class MK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(n.a)(MK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class NK{constructor(a,b,c,f,l,w){this.id=gh.a.create();this.T3c=a;this.Pf=b;this.Xa=c;this.Ha=l;
this.Sd=f;this.$X=w}Vwj(a,b){this.$X&&!this.T3c.L_&&this.$X.xNc(a.EY);a&&a.telemetry&&0<a.telemetry.length&&this.Pf.FYa(a.telemetry);Rc.a.AF(this.Pf,()=>{this.T3c.w6g(this.id,a.result,a.EY,b)})}Uwj(a,b,c){if(!this.T3c.L_&&(this.$X&&this.$X.xNc(a.EY),a&&a.error&&this.Ha.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Im===pf.a.Vh(223))){va.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",this.Xa.podSessionId||"NULL");
this.Sd.zs(Object.assign(new oi.a,{Code:223,Source:6}),c);return}Rc.a.AF(this.Pf,()=>{this.T3c.w6g(this.id,null,a.EY,b)})}}Object(n.a)(NK,"LongPollingResponseHandler",null,[]);var YQ=d(882);class BD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.tHa=this.pHa=null;this.LGg=gh.a.nil;this.DFb=this.vWa=0;this.Rvg=[10,100,1E3,1E4];this.lXa=null;this.PX=[];this.y4=Sa?"GetPopWacUpdates":"GetUpdates";this.g5=a;this.Xa=c;this.Fg=f;this.Oc=l;this.wea=w;this.Sd=H;this.mc=U;this.$X=ja;this.Oc.LA(Object(F.a)(this,
this.tM,"onSessionClosed"));this.Oc.MPa(Object(F.a)(this,this.W0,"onSessionRehydrating"));this.Oc.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"));Sa&&(this.Oc.jQd(Object(F.a)(this,this.cZa,"onPopSessionInitialized")),this.Oc.iQd(Object(F.a)(this,this.chb,"onPopSessionClosed")));this.gDe=a.dxl;this.D7c=a.BSj;this.AEb=a.Rah;this.CDb=[];b.c$a().LOd(this);this.Ijk=wa;this.yVh=Sa;this.Pla=!1;this.vEb=Sa?3E4:6E4}tM(){this.close("SessionClosed")}W0(){this.lXa&&this.lXa.eud()}Eo(){this.yib("SessionRehydrated")}w6g(a,
b,c,f){this.pHa=null;const l=+new Date-+this.tHa;if(this.Pla)va.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",this.y4);else if(a.equals(this.LGg))if(this.g5.clientIgnoreClosePopsErrorCodeEnable&&this.L_&&this.Pla)va.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.y4);else if(a=this.Fg.Zda,f&&f.length&&a!==f)va.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",
this.y4,b?"Success":"Failure",this.Xa.Kk,this.Fg.Zda,f,this.DFb,this.gDe),this.DFb++,this.qVf(l,this.DFb)||this.Upc(this.gDe);else if(this.DFb=0,b){this.tHa=new Date;this.vWa=0;this.Fg.Yne=this.tHa;this.Fg.Xne=f;va.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",this.y4,l,Rc.a.mf(new Date),this.L_?this.Xa.Kk:"Not Applicable");c=0;f={};for(const w of b.Items)w.TimeStamp>c&&(c=w.TimeStamp),f[w.LastRequestCorrelationID]=
w.LastRequestCorrelationID in f?String.format("{0},{1}",f[w.LastRequestCorrelationID].toString(),w.Key):w.Key,dk.d(this.CDb,H=>w.Key.startsWith(H.KeyRoot),H=>{w.TimeStamp>H.TimeStamp&&(H.TimeStamp=w.TimeStamp)},1);this.Upc(this.gDe);0<Object.keys(f).length&&Rc.a.Ak("RequestCorrelationIDsAndKeyRoots",Dl.c(f));c=new Date;Rc.a.AF(Rc.a.Ib,()=>{const w=Object.assign(new MK,{items:b.Items});for(const H of this.PX)try{H(this,w)}catch(U){va.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",
this.y4,U.toString(),U.stack)}});Rc.a.Ak("ProcessItemStartTime",Rc.a.mf(c));Rc.a.Ak("ProcessItemDurationInMS",(+new Date-+c).toString());Rc.a.Ib.finish()}else va.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",this.y4,l,c?c.status:3,c?c.ie:-1,this.Xa.podSessionId,this.L_?this.Xa.Kk:"Not Applicable"),this.qVf(l,this.vWa)||(f=3<=this.vWa?this.Rvg[3]:this.Rvg[this.vWa],
this.vWa++,this.Upc(f),Rc.a.Ak("FailureCountSinceLastSuccess",this.vWa.toString()),Rc.a.Ak("NextDelayInMS",f.toString()),c&&(Rc.a.Ak("RequestStatus",ck.a[c.status]),Rc.a.Ak("HttpStatus",c.ie.toString()),Rc.a.Ak("Duration",(+c.qv-+c.Zt).toString())),Rc.a.Ib.finish());else va.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",this.y4)}qVf(a,b){return this.L_&&(a>=this.AEb||b>this.g5.getHostSessionInfoMaxRetryCount)?(va.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",
this.y4,b,this.Xa.Kk,this.Fg.fG),!0):!1}close(a){va.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.y4,a);this.Pla=!0;this.lXa&&this.lXa.eud()}Upc(a){const b=Rc.a.zk(this.y4,2);b.Va("DelayInMS",a.toString());this.D7c?Rc.a.Faa(()=>{Rc.a.AF(b,Object(F.a)(this,this.iah,"performCall"))},a,0):window.setTimeout(()=>{Rc.a.AF(b,Object(F.a)(this,this.iah,"performCall"))},a)}iah(){if(!this.enabled||u.AFrameworkApplication.Ug||this.pHa&&+new Date-+this.pHa<this.vEb||this.L_&&!this.mc.BL||
this.wea.A_c)va.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",this.y4,this.enabled,u.AFrameworkApplication.Ug,this.pHa?Rc.a.mf(this.pHa):"null",Rc.a.mf(new Date),this.vEb,this.wea.A_c,!this.mc.In,!this.mc.BL);else{var a=gh.a.create().toString();va.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",
this.y4,this.pHa?Rc.a.mf(this.pHa):"null",Rc.a.mf(new Date),this.vEb,this.L_?this.Xa.Kk:"Not Applicable",a);if(!this.L_){var b=dk.e(this.CDb,w=>w.KeyRoot===tg.a.pch);b&&b.length&&va.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.pHa=new Date;b=Rc.a.Ib;var c=new NK(this,b,this.Xa,this.Sd,this.g5,this.L_?null:this.$X);this.LGg=c.id;this.lXa=new YQ.a;var f=this.L_?this.Xa.Kk:"",l=this.L_?"":this.Xa.podSessionId;b.Va(Bh.a.cub,a);this.Ijk(f,this.Xa.presentationId.string,this.CDb,
w=>{c.Vwj(w,f)},w=>{c.Uwj(w,f,l)},this.lXa,{["X-CorrelationId"]:a},null,this.vEb)}}get enabled(){return 0<this.CDb.length&&!this.Pla}get L_(){return this.yVh}cZa(){this.yib("PopSessionInitialized")}chb(){this.close("PopsUninitialized")}Upd(a){a||(a=[]);va.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.y4,a.length);for(const b of a);this.CDb=a;this.tHa=new Date;this.DFb=this.vWa=0;this.Upc(0)}fvf(a){Array.add(this.PX,a)}gxa(){this.yib("AppListener:OnReboot")}yib(a){va.a.J(512360718,
801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.y4,a,this.L_?this.Xa.Kk:"Not Applicable");this.L_&&"PopSessionInitialized"===a&&this.x3k();this.Pla=!1;this.pHa=null;this.tHa=new Date;this.DFb=this.vWa=0;this.lXa&&this.lXa.eud();this.Upc(0)}x3k(){for(const a of this.CDb)a.TimeStamp=0}dispose(){this.Oc.qaa(Object(F.a)(this,this.tM,"onSessionClosed"));this.Oc.emd(Object(F.a)(this,this.W0,"onSessionRehydrating"));this.Oc.Xfa(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.L_&&
(this.Oc.Hjh(Object(F.a)(this,this.chb,"onPopSessionClosed")),this.Oc.ORe(Object(F.a)(this,this.cZa,"onPopSessionInitialized")))}}Object(n.a)(BD,"DocNotifyClient",null,[313,106,314,1096]);class CD{constructor(){this.R1c=0}}Object(n.a)(CD,"TimeStampData",null,[]);class OK{constructor(){this.xGa={}}reset(){this.xGa={}}copy(a){this.reset();a=a.xGa;for(let f in a){var b=f,c=a[f];const l=new CD;l.R1c=c.R1c;this.xGa[b]=l}}DEl(a,b){var c=a in this.xGa?this.xGa[a]:new CD;this.xGa[a]=c;c=this.xGa;for(let l in c){var f=
c[l];l.startsWith(a)&&(f.R1c=b)}}x8d(a){return a in this.xGa?this.xGa[a].R1c:0}}Object(n.a)(OK,"HermesContentTimeStampManager",null,[315]);var Px=d(303);class Qx{constructor(a,b,c,f=null){this.Uke=a;this.ofa=b;this.vjc=c;this.Ba=f}}Object(n.a)(Qx,"SlideMoveData",null,[]);var ZQ=d(649),Oj=d(301);class PK{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){this.pdc=this.ova=null;this.$T=0;this.WF=null;this.Uve=0;this.U3c=null;this.Cwe=this.i8c=this.xBg=this.zBg=0;this.iJ=this.qIa=this.DX=null;this.Sma=this.q8c=
0;this.lq=a;this.Fa=b;this.ia=c;this.Vb=f;this.ua=l;this.eu=w;this.oc=H;this.mc=U;this.hu=ja;this.A0=this.lq.IU;this.Dva=wa;this.pa=Sa;this.Iq=eb;this.nn=ub;this.Rua=Ub}oFj(){this.$T=-1;this.ova=document.createElement("div");this.ova.style.visibility=nf.a.Qs;this.ova.className=Oj.a.lQi;this.A0.appendChild(this.ova);this.Uve=this.Sma=this.q8c=0;if(this.Rua){this.pdc=document.createElement("div");this.pdc.className=Oj.a.wqj;const a=document.createElement("span");a.className=Oj.a.xqj;this.pdc.appendChild(a)}}dispose(){this.A0.removeChild(this.ova);
this.eu.aF(this.A0,this);this.ova=this.WF=null}Dv(a){return a?this.WI(a).returnValue:!1}WI(a){var b=null;if(3===a.Wf||a.uA!==Sys.UI.MouseButton.leftButton||!this.A0.contains(a.Ec)||!this.mc.In)return{returnValue:!1,dvb:b,X3:null};var c=a.clientPoint.y-this.Y2e+this.A0.scrollTop;b=a.clientPoint.x-this.A0.offsetLeft;this.hu&&(b-=this.A0.offsetWidth-this.A0.clientWidth);b=this.Mnj(b,c);if(!b||!b.ZN)return{returnValue:!1,dvb:b,X3:null};if(this.Rua){a=this.pa.Qe();if(1>a.length)return{returnValue:!1,dvb:b,
X3:null};for(var f of a)if(f.XN||32!==this.ia.La(L.a.JOe,1,f.Cb))return{returnValue:!1,dvb:b,X3:null};f=this.lq.bZ-this.pa.Qe().length+1;this.xBg=Math.min(this.d0f(c),f);this.zBg=Math.min(b.slideIndex,f-1)}else if(c=b.slideId,N.a.mx(c)||32!==this.ia.La(L.a.JOe,1,c))return{returnValue:!1,dvb:b,X3:null};return{returnValue:!0,dvb:b,X3:null}}Uu(a){if(!a)return!1;this.ova||this.oFj();this.U3c=ZQ.a(0,0);if(!({dvb:this.DX,X3:H}=this.WI(a)).returnValue)return!1;if(this.nn){var b=!1,c=this.DX.slideId,f=this.pa.Qe();
for(var l of f)if(l.Cb.equals(c)){b=!0;break}if(b){if(this.iJ=this.ua.Ba,1<f.length&&!this.Rua)return!1}else this.pa.Rh(),this.iJ=this.DX.Fd,this.pa.MR(this.DX.Fd)}if(this.Rua){this.$Ih();var w=this.DX.zyb;var H=w.cloneNode(!0);b=H.getElementsByTagName("img")[0];this.brh(b,Oj.a.lbe,Oj.a.kbe,Oj.a.sXf,Oj.a.sXf);H.className=Oj.a.U9f;c=this.pa.Qe();f=1;if(1<c.length){for(l=0;l<c.length;l++)if(this.DX.slideIndex!==c[l].slideIndex){f++;w=this.lq.mT(c[l].slideIndex).zyb;w=(w=w.getElementsByTagName("img"))&&
0<w.length?w[0].cloneNode(!0):b.cloneNode(!0);const U=Oj.a.kbe*f;this.brh(w,Oj.a.lbe-f,Oj.a.kbe-1,U,U);H.appendChild(w);if(3===f)break}H.appendChild(this.pdc);this.pdc.firstChild.innerText=this.pa.Qe().length.toString()}this.WF?this.lq.IU.replaceChild(H,this.WF):this.lq.IU.appendChild(H);this.WF=H}else b=this.DX.zyb,this.WF?(b=this.WF.getElementsByTagName("img"),H=H.cloneNode(!0),H.style.zIndex=String(Oj.a.lbe),this.WF.replaceChild(H,b[0]),this.WF.style.zIndex=String(Oj.a.uqj)):(this.WF=b.cloneNode(!0),
this.lq.IU.appendChild(this.WF),this.WF.className=Oj.a.U9f);this.Uve=parseInt(Jf.a.Xt(this.WF).height);gf.a.Ioa(this.WF,Oj.a.E9g+Oj.a.$8g+Oj.a.Dfg,this.hu);this.WF.style.visibility=nf.a.Hz;this.WF.style.cursor=nf.a.ysc;u.AFrameworkApplication.Wj("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");va.a.J(512497671,819,50,"PPT drag slide start.");this.Gw(a);return!0}$Ih(){this.i8c=this.xBg;this.Cwe=this.zBg;let a=0;for(let b=0;b<this.lq.bZ;b++){const c=this.lq.mT(b);c.isSelected?
c.Quc(-2):(a===this.DX.slideIndex&&(a+=1),c.Quc(a),a++)}}brh(a,b,c,f,l){a.className=Oj.a.tqj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}Gw(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.Y2e+this.A0.scrollTop,f=this.Uve/2;if(this.Dva){if(B.a.DT&&!a.qc.rawEvent.buttons)return va.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),!1;this.WF.style.top=Math.min(c-
f,this.Rua?Px.a.pV+(this.lq.bZ-this.pa.Qe().length)*this.lq.Dsa:Px.a.pV+this.lq.bZ*this.lq.Dsa)+"px"}else{a=this.k7b(this.lq.bZ)+this.lq.Dsa/2;if(this.QWi(b.x)||c>a)return this.Grh(),!0;this.WF.style.top=c-f+"px"}this.arh(!0);this.dsi(b.y);this.lbl(Math.min(this.d0f(c),this.Rua?this.lq.bZ-this.pa.Qe().length+1:this.lq.bZ));this.ova.style.visibility=this.Y_c(b)&&!this.Rua?nf.a.Hz:nf.a.Qs;if(this.Rua&&0<=this.$T)if(this.Y_c(b)){this.WF.style.visibility=nf.a.Hz;if(this.i8c===this.$T)return!0;b=this.i8c<
this.$T?0>this.$T-1?0:this.$T-1:0>this.$T?0:this.$T;c=0;for(f=0;f<this.lq.bZ;f++)a=this.lq.mT(f),a.isSelected||(c<b?a.Quc(c):a.Quc(c+1),c++);this.i8c=this.$T;this.Cwe=b}else this.$Ih(),this.WF.style.visibility=nf.a.Qs;return!0}fo(a){if(!this.ua.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;if(this.Rua){if(a=this.pa.Qe(),0<a.length&&0<=this.$T&&this.Y_c(b)){b=[];for(const c of a)c&&b.push(Object(qa.a)(115,c));this.Ywl(b,this.hlj(this.Cwe));va.a.J(512497669,819,50,
"PPT drag slide succeed.")}}else 0<=this.$T&&this.DX&&this.Y_c(b)&&this.DX.slideIndex!==this.$T&&this.DX.slideIndex+1!==this.$T&&(this.Twl(this.DX.slideIndex,this.$T),va.a.J(512497668,819,50,"PPT drag slide succeed."));this.WK()}hlj(a){let b=0;for(let c=0;c<this.lq.bZ;c++)if(!this.lq.mT(c).isSelected&&(b++,a===b))return c+1;return 0}Y_c(a){a=a.x>=this.A0.offsetLeft&&a.x<=this.A0.offsetLeft+this.A0.offsetWidth;return!this.Dva||a}pu(){this.WK()}Mnj(a,b){if(!this.lq.Dsa)return null;var c=Math.floor((b-
Px.a.pV)/this.lq.Dsa);if(0<=c&&c<=this.lq.bZ-1){c=this.lq.mT(c);if(!c)return null;const f=c.zlb;a=this.hu?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}QWi(a){return this.hu?this.U3c.width-Oj.a.XQf>a||this.U3c.width<a:0>a||Oj.a.XQf<a}dsi(a){const b=a-this.Y2e,c=this.U3c.height;if(Oj.a.Kzf>b)this.Sma=-Oj.a.Jzf;else if(Oj.a.Mzf>b)this.Sma=-Oj.a.Lzf;
else if(Oj.a.Ozf>b)this.Sma=-Oj.a.Nzf;else if(c-Oj.a.Kzf<a)this.Sma=Oj.a.Jzf;else if(c-Oj.a.Mzf<a)this.Sma=Oj.a.Lzf;else if(c-Oj.a.Ozf<a)this.Sma=Oj.a.Nzf;else{this.Sma=0;return}this.hah()}hah(){if(0!==this.Sma){const a=this.q8c,b=(new Date).getTime();0<a&&(this.A0.scrollTop=Math.max(0,this.A0.scrollTop+Math.floor((b-a)*this.Sma/1E3)));this.q8c=b;window.setTimeout(Object(F.a)(this,this.hah,"performAutoScrolling"),Oj.a.jii)}else this.q8c=0}k7b(a){return this.lq.Dsa*a+Px.a.pV*(this.Dva?.75:1)}d0f(a){a+=
this.lq.Dsa/2;a-=Px.a.pV;a=Math.floor(a/this.lq.Dsa);return this.Dva?Math.max(0,a):a}lbl(a){this.$T!==a&&(this.$T=a,0>this.$T||(this.ova.style.top=gf.a.Pc(this.k7b(a))))}Grh(){this.arh(!1)}arh(a){this.WF.style.cursor=a?nf.a.ysc:nf.a.Zsl}Twl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if((this.qIa=Qa.a.clone(this.ua.presentation.cK))&&!(b>this.qIa.length||a>=this.qIa.length)){var f=null;a=c.P$d(a);b&&(f=c.P$d(b-1));b=new Qx(!1,[a],f);this.ia.La(L.a.Bjc,
2,b)}}Ywl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.qIa=Qa.a.clone(this.ua.presentation.cK))||b>this.qIa.length||!this.vRj(a,b)||(b=b?c.P$d(b-1):null,a=new Qx(!1,a,b,this.iJ),this.ia.La(L.a.Bjc,2,a))}vRj(a,b){const c=Object.assign(new Ka.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);c.Sc((l,w)=>l-w);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}WK(){this.HDl();this.Grh();this.WF.style.visibility=
nf.a.Qs;this.WF.style.top="0px";this.WF.style.cursor=nf.a.EA;this.ova.style.visibility=nf.a.Qs;if(this.Rua){const a=this.Iq.oe(3);try{const b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.kd(b);a.kLa(this.lq.Ma);const c=b.slides||[];for(const f of c){const l=Object(qa.a)(116,f);l&&l.anchor.hk(this.lq.Ma,16)}}finally{a&&a.dispose()}this.lq.M_a()}this.Sma=0;this.DX&&(this.DX=null);this.Fa.Ae&&this.Fa.Ae.name===Lb.a.YE||this.Fa.rf(Lb.a.YE)}HDl(){this.nn?this.iJ&&(this.Vb.Ba=
this.oc.zl(this.iJ.Cb)):this.DX&&(this.Vb.Ba=this.DX.Fd)}get Y2e(){let a=this.A0,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(n.a)(PK,"ThumbnailNavPaneDragAdapter",null,[323,244,106]);class DD{}DD.b5h=[L.a.print,L.a.find,L.a.l1,L.a.p8a,L.a.djd,L.a.cjd,L.a.bringForward,L.a.bringToFront,L.a.sendBackward,L.a.sendToBack,L.a.kja,L.a.rtd,L.a.std,L.a.l1a,L.a.k1a,L.a.Blb,L.a.Alb,L.a.G0a,L.a.nNb,L.a.fPb,L.a.Ypc,L.a.n6,L.a.VY,L.a.mUa,L.a.Lkb,L.a.Mkb,L.a.Nkb,L.a.Okb,L.a.mpc,L.a.npc,L.a.opc,L.a.ppc,
L.a.nnd,L.a.Fpc,L.a.FTe,L.a.ond,L.a.k7a,L.a.rSa,L.a.Wja,L.a.n0a,L.a.o0a,L.a.p0a,L.a.grc,L.a.FMb,L.a.kMb,L.a.CMb,L.a.gkb,L.a.tkb,L.a.zI,L.a.iQ,L.a.C5,L.a.Agb,L.a.xgb,L.a.zgb,L.a.ygb,L.a.GZa,L.a.FZa,L.a.wpk,L.a.PKk,L.a.kwi,L.a.lwi,L.a.kFe,L.a.lFe,L.a.mFe,L.a.nFe,L.a.bBk,L.a.Rwi,L.a.deleteComment,L.a.jUa,L.a.MXc,L.a.U1k,L.a.xpk,L.a.QKk,L.a.Itc,L.a.Btc,L.a.Dtc,L.a.Ctc,L.a.Gtc,L.a.Ftc];Object(n.a)(DD,"ActionHandledList",null,[]);class $s{constructor(a,b,c,f){this.J0=new Ci.a;this.QBe=new Ci.a;this.ia=
a;this.Ha=b;this.pa=c;this.Pg=f;this.REj();this.SEj()}cuj(a,b,c=null){this.Ha.remapShapeEditCommandEnabled&&((this.pa.gH()||this.pa.Bs())&&this.J0.Gb(a)?a=this.J0.ga(a):this.pa.Zz()&&this.QBe.Gb(a)&&(a=this.QBe.ga(a)));if(this.Ha.podsTableRTTEnabled&&this.Ha.podsTableCellLockEnabled&&Array.contains($s.e6k,a)&&(this.pa.o9()||this.pa.eRj()))return 32;if(!Array.contains(DD.b5h,a))return this.ia.La(a,2,b,c);const f=this.ia.xq,l=this.ia.vT;let w=this.ia.La(a,1,b);32===w&&(this.Ha.pptDragCancelFix&&(this.ia.xq=
f,this.ia.vT=l),w=this.ia.La(a,2,b,c));return w}$il(a){return this.Pg.Bvb!==a&&this.Pg.Cvb!==a}Tvb(a,b,c){return b&&b.name===Lb.a.sg&&!this.pa.Bs()&&1===this.pa.Xd().length&&this.pa.Zz()&&this.$il(c)?a.Tvb(a.Fc(b.parent),c):a.Tvb(b,c)}REj(){this.J0.$(D.a.upArrow,L.a.Okb);this.J0.$(D.a.downArrow,L.a.Lkb);this.J0.$(D.a.leftArrow,L.a.Mkb);this.J0.$(D.a.rightArrow,L.a.Nkb);this.J0.$(D.a.HMb,L.a.ppc);this.J0.$(D.a.ukb,L.a.mpc);this.J0.$(D.a.w0a,L.a.npc);this.J0.$(D.a.x0a,L.a.opc);this.J0.$(D.a.Osa,L.a.Ypc);
this.J0.$(D.a.KYa,L.a.Blb);this.J0.$(D.a.JYa,L.a.Alb);this.J0.$(L.a.kja,L.a.H6a);for(const a of $s.w6k)this.J0.$(a,G.a.ve)}SEj(){for(const a of $s.x6k)this.QBe.$(a,G.a.ve)}}$s.w6k=[D.a.QCa,D.a.RCa,D.a.a2b,D.a.uub,D.a.cRa,D.a.dRa,D.a.N7a,D.a.bRa,D.a.wgb,D.a.ZRa,D.a.H8a,D.a.vgb,D.a.YRa,D.a.G8a];$s.x6k=[L.a.p8a,L.a.rSa,L.a.Wja,L.a.fPb];$s.e6k=[D.a.backspace,D.a.bL,L.a.k7a];Object(n.a)($s,"ProcessInputStrategy",null,[320]);class QK{get KKc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,
8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(n.a)(QK,"PPTColorTable",null,[312]);var $Q=d(956);class RK{constructor(){this.pad={}}m7d(a){return a&&a in this.pad?this.pad[a]:null}rBf(a,b){a&&b&&a!==b&&(a in this.pad||(this.pad[a]=b))}}Object(n.a)(RK,"PresenceEmailConverter",null,[1095]);var SK=d(901),Rx;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=
3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";
a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";
a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=
30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=
39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Rx||(Rx={}));Object(n.b)("EntryName",Rx);class TK{constructor(a,b,c,f){this.To=null;this.LAe=this.N9c=0;this.eye=this.mCg=this.xxe=this.M7c=!1;this.dqe=this.eqe=this.dwe=this.wqe=this.Dve=0;this.X3c=this.Gte=null;this.o$c=new fk.a;this.KRg=new fk.a;this.tJg=new fk.a;this.yue=this.Due=!1;this.qgc=a;this.pBe=b;this.xj=c;f.execute(l=>{this.To=l});this.YX={};el.Task.WAA(this.xj.yCa,this.o$c.task,this.KRg.task).continueWith(()=>
{try{this.Eqh(),this.bPc(this.YX),0<pa.a.count(this.YX)&&ka.ULS.sendTraceTag(51242144,814,15,pa.a.toJSON(this.YX)),this.Due=!0}catch(l){ka.ULS.sendTraceTag(51242145,814,10,l.toString())}});el.Task.WAA(this.xj.yCa,this.tJg.task).continueWith(()=>{try{this.Eqh(),this.bPc(this.YX),0<pa.a.count(this.YX)&&ka.ULS.sendTraceTag(594879178,814,15,pa.a.toJSON(this.YX)),this.yue=!0}catch(l){ka.ULS.sendTraceTag(594879177,814,10,l.toString())}});this.J4c={};this.Jve={}}oTi(a){this.wGc(a,8,"g_hermesPresenceJS");
this.wGc(a,20,"g_hermesPresence1JS");this.wGc(a,18,"g_JquerySignalRMergeJS");this.wGc(a,19,"g_JquerySignalRMergeJSEnd")}wGc(a,b,c){b=Rx[b];b in a||(c=this.icj(c),0<c&&this.xia(a,b,c))}icj(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.WXf();this.j0i();this.hGh();this.YX=this.Jve=this.J4c=null}yTi(){this.rra(25)}xTi(){this.rra(12)}W4j(){this.rra(15);0<this.appInitChromeReady&&this.rra(16)}sTi(a){try{this.N9c||(this.N9c=a,this.$h(17,this.N9c),this.$h(13,this.k3f(this.B2I,this.N9c)),
this.tJg.eK(!0))}catch(b){ka.ULS.sendTraceTag(594879176,814,10,b.toString())}}x3j(a,b){this.$h(6,a);this.$h(5,b)}tTi(){this.LAe||(this.LAe=Date.now(),this.$h(31,this.LAe),this.WXf())}uTi(){this.rra(28)}vTi(){this.rra(27)}wTi(){this.rra(40)}QDk(a){const b=[];for(let f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}zTi(a){a&&(a=this.QDk(a),this.$h(38,a.length),this.$h(37,0<a.length),this.rra(39));this.KRg.Kg(!0)}P3j(a){try{this.o$c.task.isCompleted||pa.a.Wa(a)||(this.rra(34),this.o$c.eK(!0))}catch(b){ka.ULS.sendTraceTag(51242146,
814,10,b.toString())}}Q3j(a){if(!(pa.a.Wa(a)||"presenceUpdateNotificationReceived"in this.YX)){var b=Date.now();this.$h(33,b);this.dwe=this.k3f(this.B2I,b);this.$h(32,this.dwe);this.$h(30,pa.a.count(a));this.To&&this.$h(29,this.To.JVf)}}WWi(){return!this.o$c.task.isCompleted&&(!this.To||!this.To.JVf)&&!this.dwe}O3j(){this.rra(35);this.xj.DQc&&this.$h(36,this.xj.DQc.getTime())}NTi(){this.pBe&&!this.M7c&&(this.M7c=!0,this.pBe.Kuf(Object(F.a)(this,this.Nkc,"onResourceTimingEntriesAvailable")))}Nkc(a,
b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=ig.a.joa(f.url);!this.xxe&&l.endsWith("rtc2/signalr/negotiate")?(this.xxe=!0,this.MGc(a,"Negotiate",f.QB)):l.endsWith("rtc2/signalr/connect")?(this.mCg=!0,this.MGc(a,"Connect",f.QB)):!this.eye&&l.endsWith("rtc2/signalr/start")?(this.eye=!0,this.MGc(a,"Start",f.QB)):l.endsWith("rtc2/findsession")&&(this.MGc(a,this.Dve.toString()+"_FindSession",f.QB),this.Dve++)}if(this.xxe||this.mCg||this.eye||0<this.Dve)this.hGh(),this.VXf(a)}catch(c){ka.ULS.sendTraceTag(51242147,
814,10,c.toString())}}MGc(a,b,c){this.xia(a,b+"FS",c.fetchStart);this.xia(a,b+"RS",c.responseStart);this.xia(a,b+"RE",c.responseEnd)}hGh(){this.M7c&&(this.M7c=!1,this.pBe.djh(Object(F.a)(this,this.Nkc,"onResourceTimingEntriesAvailable")))}rra(a){this.$h(a,Date.now())}$h(a,b){this.B6h(Rx[a],b)}B6h(a,b){this.xia(this.J4c,a,b);this.xia(this.YX,a,b)}xia(a,b,c){b in a||(a[b]=c)}bPc(a){this.oTi(a);this.xia(a,"B2I",this.B2I);null!=this.fHasTabSwitch&&this.xia(a,"fHasTabSwitch",this.fHasTabSwitch);null!=
this.X3c&&this.xia(a,"firstCoauthoringStatus",this.X3c);this.appInitInteractivityReady&&this.xia(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.xia(a,"appInitChromeReady",this.appInitChromeReady)}Eqh(){null==this.X3c&&(this.X3c=this.xj.yCa.result)}WXf(){this.VXf({})}VXf(a){try{this.bPc(this.J4c),pa.a.forEach(this.J4c,(b,c)=>{b in this.Jve||(this.Jve[b]=c,a[b]=c)},null),0<pa.a.count(a)&&ka.ULS.sendTraceTag(41239941,828,50,pa.a.toJSON(a))}catch(b){ka.ULS.sendTraceTag(51242176,
814,10,b.toString())}}j0i(){ka.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.Due,this.yue);if(!this.Due||!this.yue)try{this.bPc(this.YX),0<pa.a.count(this.YX)&&ka.ULS.sendTraceTag(51242178,814,50,pa.a.toJSON(this.YX))}catch(a){ka.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.wqe&&Eg.a.instance.hp(fi.a.contentEditable)&&(this.wqe=Eg.a.instance.ih(fi.a.contentEditable));return this.wqe}get appInitInteractivityReady(){!this.eqe&&
Eg.a.instance.hp("AppInitStatus_interactivityReady")&&(this.eqe=Eg.a.instance.ih("AppInitStatus_interactivityReady"));return this.eqe}get appInitChromeReady(){!this.dqe&&Eg.a.instance.hp("AppInitStatus_chromeReady")&&(this.dqe=Eg.a.instance.ih("AppInitStatus_chromeReady"));return this.dqe}get fHasTabSwitch(){null==this.Gte&&Eg.a.instance.hp(fi.a.iwd)&&(this.Gte=Eg.a.instance.ih(fi.a.iwd));return this.Gte}k3f(a,b){return this.qgc?this.qgc.z5f(new Date(a),new Date(b)):-1}}Object(n.a)(TK,"PresencePerfLogger",
null,[317,106]);class UK{constructor(a,b,c){this.cTg=this.vdc=this.b5c=this.fna=null;this.ate=!1;this.EBe=null;this.li=a;this.g5=b;this.Gq=c}oVc(){this.tvb();return this.fna}Z9i(){this.tvb();return this.b5c}getFindSessionResponse(){return this.li?this.li.FindSessionResponse:null}e2f(){this.tvb();return this.vdc}Uij(){this.tvb();return this.cTg}Sij(){this.tvb();return this.EBe}Dqd(){this.tvb();return this.ate}U4j(){if(this.li){const a=!!this.li.PresenceException,b=!isNaN(this.li.PresenceDownloadEditorTableHttpStatus)&&
200!==this.li.PresenceDownloadEditorTableHttpStatus||!isNaN(this.li.PresenceFindSessionHttpStatus)&&200!==this.li.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.g5.presenceEarlyFindSessionEnabled;c.EditorCount=this.b5c?this.b5c.length:0;c.ShouldConnectToRtcByDefault=this.ate;c.EditorTableHttpStatus=this.li.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.li.PresenceFindSessionHttpStatus;c.CachedException=this.li.PresenceException;c.IsFindSessionResponseEmpty=!this.li.FindSessionResponse;
c.IsEditorTableResponseEmpty=!this.li.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.EBe;va.a.J(41501202,804,a||b?15:50,pa.a.toJSON(c))}}tvb(){if(this.li&&!this.fna)try{if(this.li.CoauthHandlerResponse){const a=Sys.Serialization.JavaScriptSerializer.deserialize(this.li.CoauthHandlerResponse);this.b5c=a.EditorTable;this.fna=a.UserName;this.vdc=a.Email;this.cTg=a.RtcEndpointUrl;this.ate=a.FConnectByDefault;this.EBe=a.RtcBootToken;this.Gq.d6g()}}catch(a){va.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+
a)}}}Object(n.a)(UK,"PresencePrepCacheParser",null,[326]);class ED{constructor(a,b,c,f=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=u.AFrameworkApplication.userSessionId;this.vnd=u.AFrameworkApplication.vnd;this.yca=u.AFrameworkApplication.Ke;this.Ow=b;this.fqh=c;this.jnh=f}}Object(n.a)(ED,"RtcParams",null,[]);class VK{constructor(a,b,c){this.A6j=a;this.BBe=b;this.P2c=c}uui(a,b,c){za.a.Cu(a);za.a.Cu(b);za.a.Cu(c)}HQd(a,b,c,f){return f=!a&&0>b?f+
Math.abs(b):this.A6j?(c-b)/4:(c-b)/2}IQd(a,b,c){if(!this.P2c||!b)return c;if(0<=b.className.indexOf(Gc.a.FN))if(b.previousSibling)b=b.previousSibling;else return c;const f=this.RUc(b,da.a.j2c),l=this.RUc(b,da.a.UQc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const w=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,w.y+=c,w.height-=2*c,w;a=this.Skj(b,a);if(isNaN(a)||!a)return c;c=(a-f)/2;w.y+=c;w.height-=2*c;return w}zlj(a,b){if(!this.P2c)return 0;a=this.RUc(a,da.a.j2c);b=
Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}Skj(a,b){let c=Object(qa.a)(1091,b);b||(c=Object(qa.a)(1091,this.BBe.u6b(a)));if(c&&this.BBe.gMj(c))return this.RUc(a,da.a.UQc);b=0;const f=a.getClientRects();f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.BBe.Iga(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}RUc(a,b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=T.a.Be(c,b),c=0<=c.className.indexOf(Gc.a.obc)?
c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(n.a)(VK,"PptMeasureBoundsUsingSpansStrategy",null,[321]);class FD{constructor(){this.xIa=null}get ajc(){return this.xIa?this.xIa.ajc:0}get xrc(){return this.xIa?this.xIa.xrc:!1}get Hqd(){return this.xIa?this.xIa.Hqd:!1}g1b(a,b){b&&(this.xIa?this.xIa.g1b(a,b):b(null))}lji(a){this.xIa=a}}Object(n.a)(FD,"PPTProcessImageStrategyProxy",null,[1089,1090]);class GD{constructor(a,b){this.VYh=a;this.plf=b}get ICk(){return this.VYh}get iKe(){return this.plf}Fdl(a){this.plf=
a}}Object(n.a)(GD,"PageHiddenRecord",null,[]);class WK{constructor(){this.Bma=[];va.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.Fxe=window.document.hidden){const a=new GD(new Date,new Date(9999,12,31));this.Bma.push(a)}Ab.a.instance.rb("Common.ITaskManager").Db(new Le.a(4,2,9E5,Object(F.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,"2"));$addHandler(window,"visibilitychange",Object(F.a)(this,this.onVisibilityChange,"onVisibilityChange"))}z5f(a,b){const c=this.Bma.length;
let f=0;if(0<c&&a<this.Bma[c-1].iKe){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const w=Math.max(this.Bma[l].ICk.getTime(),a),H=Math.min(this.Bma[l].iKe.getTime(),b);w<H&&(f+=H-w)}}return f}onVisibilityChange(){va.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.DTk()}DTk(){var a=window.document.hidden,b=new Date;this.Fxe!==a&&((this.Fxe=a)?(b=new GD(b,new Date(9999,12,31)),this.Bma.push(b)):(a=this.Bma.length,0<a&&this.Bma[a-1].Fdl(b)))}maintainPageHiddenRecords(){const a=
new Date;for(;0<this.Bma.length&&9E5<+a-+this.Bma[0].iKe;)Array.removeAt(this.Bma,0)}}Object(n.a)(WK,"PageHiddenMeter",null,[311]);class HD{Z5(a){let b=L.a.mw(a);return b||(b=D.a.mw(a))?b:(b=G.a.mw(a))?b:""}}Object(n.a)(HD,"ActionNameResolver",null,[1087]);class ID{constructor(){this.va=new vc.a}WOk(){this.va.raiseEvent("CIU",Sys.EventArgs.Empty)}XOk(a){this.va.raiseEvent("CSC",a)}lPk(a){this.va.raiseEvent("ETC",a)}Qfh(a){this.va.raiseEvent("TLSC",a)}lRk(a){this.va.raiseEvent("TCVEL",a)}mQk(){this.va.raiseEvent("PRTCC",
null)}QPk(){this.va.raiseEvent("LCK",null)}OPd(a){this.va.addHandler("CSC",a)}zRe(a){this.va.removeHandler("CSC",a)}PPd(a){this.va.addHandler("ETC",a)}cjh(a){this.va.removeHandler("ETC",a)}wci(a){this.va.addHandler("TLSC",a)}H0k(a){this.va.removeHandler("TLSC",a)}oci(a){this.va.addHandler("TCVEL",a)}nbi(a){this.va.addHandler("PRTCC",a)}Ijh(a){this.va.removeHandler("PRTCC",a)}B$h(a){this.va.addHandler("LCK",a)}}Object(n.a)(ID,"CoauthEventSource",null,[1084,1085,1086]);class JD{constructor(){this.va=
new vc.a}bRk(){var a=new Sys.EventArgs;this.va.raiseEvent("OnShowHideAltTextPane",a)}CPk(a){this.va.raiseEvent("OnImageDescriptionReady",a)}qPk(a){this.va.raiseEvent("FRHRE",a)}QOk(a){this.va.raiseEvent("APIRE",a)}JPk(a){this.va.raiseEvent("IMARE",a)}Xai(a){this.va.addHandler("OnShowHideAltTextPane",a)}M_k(a){this.va.removeHandler("OnShowHideAltTextPane",a)}tai(a){this.va.addHandler("OnImageDescriptionReady",a)}s_k(a){this.va.removeHandler("OnImageDescriptionReady",a)}mai(a){this.va.addHandler("FRHRE",
a)}n_k(a){this.va.removeHandler("FRHRE",a)}M$h(a){this.va.addHandler("APIRE",a)}YZk(a){this.va.removeHandler("APIRE",a)}wai(a){this.va.addHandler("IMARE",a)}u_k(a){this.va.removeHandler("IMARE",a)}}Object(n.a)(JD,"CoreExtEventSource",null,[1081,1082,1083]);var XK=d(1034);class KD extends XK.a{constructor(a,b,c,f,l,w,H){super(f,c,a,w,H);this.I3c=new qd.a(0);this.$Va=b;this.Xye=l}HEj(a,b){let c;(c=this.I3c).$(b,c.ga(b)+1);this.KSf(a.name,Object(F.a)(this,this.Ueg,"initPackageCallback"),a)}IEj(a,b){let c;
(c=this.I3c).$(b,c.ga(b)+1);this.LSf(a.name,Object(F.a)(this,this.Ueg,"initPackageCallback"),1,a)}Ueg(a){a.GEj()}Zvh(a,b){return!!a&&!!b&&a.context.KBf!==b.context.KBf}fIe(a,b){if(b>=this.Xye){const c=new Sys.StringBuilder;for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,Cf.a.GY(a[f].duration,0)));ka.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),Cf.a.GY(b,0))}}onIdle(a){const b=[];this.I3c.forEach((c,f)=>{0<f&&(b.push(c),this.I3c.$(c,
0),this.$Va.H2c(c));return!0});ka.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),Cf.a.GY(a,0))}}Object(n.a)(KD,"DelayLoadedPackageInitializer",XK.a,[]);class Sx{constructor(a,b,c,f,l,w,H,U,ja){this.$Be=this.ZBe=null;this.Ha=a;this.mJ=b;this.Gq=c;this.xj=f;this.ia=l;this.lH=w;this.Rb=H;this.qe=ja;this.Ghk=U;this.mJ.PPd(Object(F.a)(this,this.MRf,"editorTableUpdate"))}dispose(){this.mJ.cjh(Object(F.a)(this,this.MRf,"editorTableUpdate"))}MRf(){const a=this.xj.i_;this.mTf();this.Gq.c0c&&(va.a.J(512496593,
814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.xj.bD,a.length),this.ia.processAction(G.a.r7a,2))}mTf(){if(!this.Gq.c0c&&this.xj.bD){va.a.J(23437903,814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Rb)throw Error.create("Presence is being loaded before the app frame");this.rzl()}catch(a){va.a.J(512496591,814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}rzl(){va.a.J(512496590,
814,50,"App::EnsurePresence: trigger download js");if(this.Ha.Buc)Ab.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.presence",null,()=>d.e(11).then(d.bind(null,1248)));else{const a=Mx.a.create("pptedit.presence",this.YGi(),()=>d.e(11).then(d.bind(null,1248)));nl.a.fy(a)}}YGi(){this.vxh.HS((a,b)=>{this.Ghk.tme=b.succeeded});return[this.vxh]}get Jol(){this.$Be||(this.$Be=this.B4f());return this.$Be}get vxh(){this.ZBe||(this.ZBe=this.VHi());return this.ZBe}VHi(){return this.Xdj()}Xdj(){return gD.a.create(this.B4f(),
null,null,Pc.App.kng)}B4f(){return this.Ha.podsUseVersionLessJqueryAndSignalR?this.qe.mpj("jquery.signalr.merge.1.1"+Sx.$Td):u.AFrameworkApplication.Bj("jquery.signalr.merge.1.1",2)}}Sx.$Td=".min.js";Object(n.a)(Sx,"PresenceLoader",null,[]);class YK{constructor(a,b,c,f,l,w,H,U,ja){this.ZGa=this.$Ga=!1;this.Xla=this.Qla=null;this.Ha=a;this.ny=b;this.EX=c;this.Ea=f;this.mdb=l;this.Pve=w;this.zb=H;this.py=U;this.mz=ja;this.L4=this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.mdb.Eng}Ald(a){if(this.L4&&
a&&!a.Al&&a.eAb)if(a.bne)a.bne=!1;else if(this.Ea.DZc(a.shapeNode)){var b=this.Ea.kVc(a.shapeNode);b.length&&(this.mz&&this.mz.isEnabled||this.mz&&this.mz.isEnabled?(this.Qla=this.Xla=null,this.ZGa=this.$Ga=!1,this.mz&&this.mz.isEnabled&&this.mz.$S&&(this.mz.vab(c=>{va.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");this.Xla=c;this.eOc(a,b)}),this.mz.$S.wab(()=>{va.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.$Ga=!0;this.eOc(a,b)})),this.py&&this.py.isEnabled&&this.py.$S&&
(this.py.vab(c=>{va.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.Qla=c;this.eOc(a,b)}),this.py.$S.wab(()=>{va.a.J(41494535,801,15,"CloudFontWebRequestFailed");this.ZGa=!0;this.eOc(a,b)}))):this.tFh(a,b,null,null))}}jFa(a){return a?!0:!1}eOc(a,b){(this.jFa(this.Qla)&&this.jFa(this.Xla)||this.jFa(this.Qla)&&this.$Ga||this.ZGa&&this.jFa(this.Xla)||this.ZGa&&this.$Ga)&&this.tFh(a,b,this.Qla,this.Xla)}tFh(a,b,c,f){a&&!a.Al&&b&&b.length&&(va.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),
Promise.all(this.Pve.HKh(b,c,Object(F.a)(this.py,this.py.createFontUrl,"createFontUrl"),f,Object(F.a)(this.mz,this.mz.createFontUrl,"createFontUrl"),this.EX.SJh,Object(F.a)(this.EX,this.EX.createFontUrl,"createFontUrl"))).then(()=>{va.a.J(41521288,801,50,"WebFontsLoadCompleted");this.ny.dFa(()=>{this.zb.Db(new Le.a(2,1,0,()=>{a&&!a.Al&&(va.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.yDa(),a.bne=!0,a.GA())},90,"109"))})},l=>{va.a.J(41494541,801,10,"WebFontsLoad failed: {0}",
l.toString());a&&!a.Al&&a.shapeNode&&(a.shapeNode.TTa=!0)}))}}Object(n.a)(YK,"RemoveShapeFidelityViewForEmbeddedFontController",null,[325]);class ZK{constructor(a,b,c,f,l,w,H,U,ja){this.ZGa=this.$Ga=!1;this.Xla=this.Qla=null;this.Cma=new Ka.a;this.Vua=a;this.ln=b;this.EX=c;this.Ea=f;this.mdb=l;this.Pve=w;this.zb=H;this.py=U;this.mz=ja}kYk(a){window.self.Promise&&this.mdb.Eng?this.zb.Db(new Le.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){va.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",
b),this.TOb(a)}},90,"102")):this.TOb(a)}TOb(a){if(a&&a.length){for(var b of a)b.Al||(b.eAb=!0,b.GA()),this.ln.Rrh();b=0;Eg.a.instance.hp(fi.a.cQ)&&(b=(new Date).getTime()-Eg.a.instance.ih(fi.a.cQ));va.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",this.Cma.count,b);if(0<this.Cma.count){const c=new Map;c.set("PendingFontsCount",this.Cma.count.toString());c.set("FidelityViewDuration",b.toString());dg.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",
["MissingFont"],!1,!1,!0,!1,Object.assign(new Nj.a,{extendedProperties:c}))}a.length=0;va.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){va.a.J(40429067,801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.Al&&b.fB&&b.yDa();b=new Date;for(const c of a)if(!c.Al){const f=this.Ea.v$a(c.shapeNode);for(const l of f)this.Cma.contains(l)||this.Cma.add(l)}va.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.Cma.count){if(!this.mz||
!this.mz.isEnabled)if(!Pd.a("EnableRemoveFidelityCloudServiceCheck")||!this.py||!this.py.isEnabled){this.qih(a,this.Cma,null,null);return}this.Qla=this.Xla=null;this.ZGa=this.$Ga=!1;this.mz&&this.mz.isEnabled&&(this.mz.vab(c=>{va.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");this.Xla=c;this.fOc(a,this.Cma)}),this.mz.$S&&this.mz.$S.wab(()=>{va.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.$Ga=!0;this.fOc(a,this.Cma)}));this.py&&this.py.isEnabled&&(this.py.vab(c=>{va.a.J(40429075,
801,50,"CloudFontListDownloadAndParseCompleted");this.Qla=c;this.fOc(a,this.Cma)}),this.py.$S&&this.py.$S.wab(()=>{va.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.ZGa=!0;this.fOc(a,this.Cma)}))}else va.a.J(40429071,801,50,"No unsupported fonts"),this.TOb(a)}jFa(a){return a?!0:!1}fOc(a,b){(this.jFa(this.Qla)&&this.jFa(this.Xla)||this.jFa(this.Qla)&&(this.$Ga||Pd.a("FidelityCustomServiceDisableCheck")&&!this.mz.isEnabled)||this.ZGa&&this.jFa(this.Xla)||this.ZGa&&this.$Ga)&&this.qih(a,b,this.Qla,
this.Xla)}qih(a,b,c,f){b&&b.count?(va.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.Pve.HKh(b.toArray(),c,Object(F.a)(this.py,this.py.createFontUrl,"createFontUrl"),f,Object(F.a)(this.mz,this.mz.createFontUrl,"createFontUrl"),this.EX.SJh,Object(F.a)(this.EX,this.EX.createFontUrl,"createFontUrl"))).then(l=>{va.a.J(40429079,801,50,"WebFontsLoadCompleted");if(l)for(let w=0;w<l.length;w++)if(l[w])for(let H=0;H<l[w].length;H++)if(l[w][H]){va.a.J(40429081,801,50,"Status {0}",
l[w][H].status);const U=l[w][H].family;ha.a.Wa(U)||l[w][H].status!==Bg.loaded||-1===U.lastIndexOf("_")||b.remove(U.substring(0,U.lastIndexOf("_")))}this.TOb(a)},l=>{va.a.J(41521304,801,10,"WebFontsLoad failed: {0}",l.toString());this.zb.Db(new Le.a(2,1,this.Vua.pptWaitForWebFontsLoadingTimeoutMs,()=>{va.a.J(40429073,801,50,"Check removing Fidelity View");this.TOb(a)},90,"103"))})):this.TOb(a)}}Object(n.a)(ZK,"RemoveShapeFidelityViewOnBootController",null,[324]);class $K{constructor(a){this.ia=a}pol(){this.kxh(ResourceStrings.l_SessionTimeoutErrorMessage)}qol(){this.kxh(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}kxh(a){const b=
new Bi.StandardDialog;b.yd=4;b.ig="PPTTimeoutDialog";b.Xe(1,ResourceStrings.L_Refresh);b.Xe(2,ResourceStrings.L_Close);b.fP(ResourceStrings.l_GenericDialogTitle,a,Object(F.a)(this,this.G$k,"sessionTimeoutDialogHandler"))}G$k(a,b){1===a?(va.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.$jl()?(va.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(L.a.refreshPage,2)):this.ia.La(L.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):
(va.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(L.a.Zvb,2))}$jl(){const a=u.AFrameworkApplication.hm,b=u.AFrameworkApplication.sia;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(n.a)($K,"SessionTimeoutIndicator",null,[318]);class aL{constructor(){this.R7c=!1;this.qJg=[]}get tme(){return this.R7c}set tme(a){if(!this.R7c&&(this.R7c=a)){for(const b of this.qJg)b();Array.clear(this.qJg)}}}Object(n.a)(aL,"SignalRLoadCompletedListener",null,[319]);class Pz{constructor(a,
b,c,f,l,w,H){this.NUg=this.rFg=!1;this.hfa=this.lCe=null;this.rIg=this.cye=!1;this.OUg=this.PUg=this.UIg=this.VIg=0;this.ia=a;this.D8j=b;this.Sp=f;this.yCe=w;this.Lc=l;this.Yj=H;this.Lc.Ouf(Object(F.a)(this,this.iwk,"onLazySorterViewActorActionRegistrationHandler"))}wb(){this.Yj||(this.ia.ya(L.a.oga,Cb.a.application,Object(F.a)(this,this.fol,"showStatusBarSorterView")),this.ia.ya(L.a.Htb,Cb.a.application,Object(F.a)(this,this.Pvi,"closeStatusBarSorterView")))}fol(a,b,c,f,l){if(2!==c)return 32;if(this.cye)return this.yCe.instance.oga(a,
b,c,f,l);this.Lc.Ouf(Object(F.a)(this,this.tyh,"sorterViewEventHandler"));this.S1j();this.rFg||(this.Foe(),this.rIg=!0);return 32}Pvi(a,b,c,f,l){if(2!==c)return 32;this.Lc.RZk(Object(F.a)(this,this.tyh,"sorterViewEventHandler"));(this.hfa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.hfa);return this.cye?this.yCe.instance.Htb(a,b,c,f,l):32}Foe(){this.NUg||(this.NUg=!0,this.lCe=this.R1j(),this.lCe.HS(Object(F.a)(this,this.Czk,
"onSlideSorterGridLoaded")),nl.a.fy(this.lCe),this.VIg=Date.now())}Czk(){this.rFg=!0;this.Sp&&this.Sp.U5("SlideSoterGridDownloadFinished");this.UIg=Date.now();const a=Eg.a.instance;a&&(a.jc("SlideSorterOnDemandLoad",this.rIg),a.jc("SlideSorterPkgST",this.VIg),a.jc("SlideSorterPkgET",this.UIg))}S1j(){this.ia.processAction(L.a.w0b,2);this.hfa=gf.a.Ie();this.hfa.id="SlideSorterViewLoadingElementId";this.hfa.className="sorterview-ui-loading-element-class";const a=gf.a.Ie();a.className="sorterview-ui-loading-textmessage-class";
a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;const b=gf.a.Ie();b.className="sorterview-ui-loading-spinner-class";const c=gf.a.Ie();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.hfa.appendChild(b);this.hfa.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.hfa);this.PUg=Date.now()}tyh(){(this.hfa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.hfa);this.OUg=
Date.now();this.yCe.instance.oga(L.a.oga,null,2,null,null);const a=Eg.a.instance;a&&(a.jc("SlideSorterLoadingExpST",this.PUg),a.jc("SlideSorterLoadingExpET",this.OUg))}iwk(){this.cye=!0}R1j(){var a=u.AFrameworkApplication.Bj("slidegrid"+Pz.$Td,5);a=this.D8j.mub(a);return Mx.a.create("pptedit.sorterGrid",this.Yj?null:[a],()=>d.e(16).then(d.bind(null,1253)))}dispose(){}}Pz.$Td=".min.js";Object(n.a)(Pz,"SorterViewActorMain",null,[106,327]);class Gv{constructor(a){this.Yjf=a}onBlur(a,b){this.$oe("OnBlur",
a,b);(a=na.InteractiveViewManager.instance.Qd)&&y.FocusManager.UM()&&a.endEditing(!1,20)}setFocus(a,b){this.$oe("SetFocus",a,b);const c=this.Yjf();c&&!c.isActive&&(a.name!==O.AppFrame.nAj&&a.name!==O.AppFrame.J0i||b.name!==E.AFrame.EW||(c.Lqd=!1),c.eUi())}onFocus(a,b){this.$oe("OnFocus",a,b);if(y.FocusManager.UM()&&(b=this.Yjf())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";B.a.Pi&&(a.startsWith(Nl.a.C2b)&&(ph.GrippersManager.instance.n8b=!0),a.startsWith(Nl.a.C2b)||a===E.AFrame.tgb||a===E.AFrame.MAh)&&
(c=!1);c&&this.dUi(b,a)}}dUi(a,b){const c=a.editingView,f=y.FocusManager.instance();f.gee=!0;a.VR();1===c.mode&&3!==u.AFrameworkApplication.Ta.mode&&b===E.AFrame.tgb&&(a.Mb.hpa.g5d(),c.Djb());f.gee=!1}$oe(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);fm.a.instance.ww&&ka.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static uIf(a){const b=
new Gv(()=>a),c=a.FI,f=y.FocusManager.instance();f.Fc(c).OBa(Object(F.a)(b,b.onBlur,"onBlur"));f.Fc(c).Q7(Object(F.a)(b,b.setFocus,"setFocus"));f.Fc(c).kca(Object(F.a)(b,b.onFocus,"onFocus"))}}Object(n.a)(Gv,"InteractiveViewFocusScopeActions",null,[]);class LD extends Gv{constructor(a){super(()=>a);this.Fb=a}OCk(){this.Fb.isActive||this.Fb.JTi()}static Rzi(a,b){const c=new LD(a);a=a.FI;b.Fc(a).OBa(Object(F.a)(c,c.onBlur,"onBlur"));b.Fc(a).Q7(Object(F.a)(c,c.OCk,"pageViewSetFocus"));b.Fc(a).kca(Object(F.a)(c,
c.onFocus,"onFocus"))}}Object(n.a)(LD,"PageViewInteractiveViewFocusScopeActions",Gv,[]);class Qz{constructor(){this.Ha=this.K=null;this.YEg=!1}get name(){return"PowerPointWebEditor.CoreExt"}Zb(a){this.K=a;this.Ha=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ha.ahg&&a.register(311,"PowerPointWebEditor.IPageHiddenMeter").ma().oa(()=>new WK);Qz.nzi(this.K);a.register(ID,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().oa(()=>
new ID);a.register(JD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().oa(()=>new JD);a.register(312,"Common.IColorTable").ma().oa(()=>new QK);a.register(Oz,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().oa(()=>new Oz(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new kc.a(()=>Ab.a.instance.Ja("Common.IRenameProps"))));a.register(313,"PowerPointWebEditor.IDocNotifyClient").ma().oa(()=>new BD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ha.vg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,w,H)=>{a.resolve("PowerPointWebEditor.IPPTWebService").Pae(c,f,l,w,H)},!1));a.register(314,"PowerPointWebEditor.IPodsDocNotifyClient").ma().oa(()=>new BD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,w,H,U,ja,wa)=>{a.resolve("PowerPointWebEditor.IPopWebService").nUc(b,c,f,l,w,H,U,ja,wa)},!0));a.register(315,"PowerPointWebEditor.IContentTimeStampManager").ma().oa(()=>new OK);a.register(Fv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().oa(()=>new Fv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ha.vg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ha.tQe,this.Ha.podsPushThumbnailImageIds));a.register(AD,"PowerPointWebEditor.CoauthNotificationManager").ma().oa(()=>new AD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ha.vg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Ja("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ha,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Sx,"PowerPointWebEditor.PresenceLoader").ma().oa(()=>new Sx(this.Ha,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(RK,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();
a.register(316,"PowerpointPresence.IPresenceColorProvider").ma().oa(()=>new $Q.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").mmg,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(317,"PowerpointPresence.IPresencePerfLogger").ma().oa(()=>new TK(a.rb("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(ED,"PowerpointPresence.RtcParams").ma().oa(()=>new ED(a.resolve("PowerPointWebEditor.ICoauthStateGetter").bD,a.resolve("PowerPointWebEditor.IApplicationContext").$7f(),a.Ja("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").Bc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(318,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().oa(()=>
new $K(a.resolve("Common.IActionManager")));a.register(319,"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().oa(()=>new aL);a.register(yD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().oa(()=>new yD(this.Ha,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ja("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Ja("PowerPointWebEditor.ICommentSessionManager")));a.register(xD,"PowerPointWebEditor.SessionCleanupHandler").ma().oa(()=>new xD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(320,"Common.IProcessInputStrategy").ma().oa(()=>new $s(a.resolve("Common.IActionManager"),this.Ha,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));this.Ha.Ln||a.register(SK.a,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().oa(()=>
new SK.a);a.register(321,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().oa(()=>new VK(this.Ha.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ha.amg));a.register(322,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new fa);a.register(323,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().oa(()=>new PK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),u.AFrameworkApplication.isRtl,this.Ha.kmg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ha.HC,this.Ha.Lle));a.register(324,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().oa(()=>
new ZK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(325,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().oa(()=>
new YK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(HD,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().oa(()=>
new HD);a.register(FD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().oa(()=>new FD);a.register(KD,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().oa(()=>{let b=2;const c=Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:va.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new KD(Ab.a.instance.resolve("Common.ITaskManager"),
Ab.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),Ab.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(326,"PowerpointPresence.IPresencePrepCacheParser").ma().oa(()=>new UK(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(327,"PowerPointWebEditor.ISorterViewActorMain").oa(()=>new Pz(u.AFrameworkApplication.Ta,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").xne,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ja("PowerPointWebEditor.ISorterViewActorLazy"),a.resolve("PowerPointWebEditor.IApplicationSettings").Ln)).ma();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&Eg.a.instance.jc("FirstExtJsExecTime",a);a=new DB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Qka&&this.X2g();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").dFa(()=>{this.K.resolve("Common.ITaskManager").Db(new Le.a(0,1,0,Object(F.a)(this,this.Hsk,"onBootComplete_DelayExecuted"),90,"21"))});this.Ha.ahg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");LD.Rzi(b,this.K.resolve("Common.IFocusManager"));b.qEi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").Htk()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}X2g(){const a=new DB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.YEg=!0;Pd.a("FixBootRequestForDeepLink")||this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").N_a(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)}AAj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}ufi(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.kRd("WACDocumentPanelContent","Horizontal"),this.kRd("EditingThumbnailsPanel","Horizontal"),this.kRd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}kRd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}zie(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){const b=new qf.GraphTransaction(2);
try{b.kd(a),a.Hda(16)}finally{b&&b.dispose()}}}wbc(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");a.HS(()=>{c&&c.U5(b+"DownloadFinished")});nl.a.fy(a)}h1j(){if(this.Ha.Buc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1244)));else{const a=Mx.a.create("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1244)));this.wbc(a,"comment")}}g1j(){if(this.Ha.Buc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1241)));else{const a=Mx.a.create("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1241)));this.wbc(a,"chronosslim")}}Hsk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.YEg||this.X2g();this.AAj();this.ufi();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Ha.separateDownloadSignalREnabled&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca(this.K.resolve("PowerPointWebEditor.PresenceLoader").Jol,(f,l)=>{Pc.App.kng()&&
(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").tme=l.succeeded)},null);const b=()=>{va.a.J(512360582,809,50,"Start to download chronos.js file");this.h1j();this.g1j();this.Ha.Txh||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Foe()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Pgg(()=>{b()})};(new ls.a(this.Ha.Mfa)).TUj?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").Mqg().continueWith(()=>{this.zie()}).continueWith(()=>
{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").B3e();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.U5("ChronosStartDownloadTime");try{if(this.Ha.wacAirSpaceResourceLink){const f=vp.a.L0b("wacairspaceanimationlibrary.js"),l=gD.a.create(f,null,null);nl.a.fy(l)}}catch(f){va.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Ha.vg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").WFj();
u.AFrameworkApplication.fa.ff(()=>{RQ.a.instance.tti()});MSOJS.ClientUtils.InitUrls(u.AFrameworkApplication.j5k,u.AFrameworkApplication.h5k,u.AFrameworkApplication.i5k)}static main(){u.AFrameworkApplication.Ug&&B.a.fg?va.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):v.a.instance.Dc(new Qz)}static nzi(a){a.register(328,"PowerPointWebEditor.IPrefetchManager").ma().oa(()=>new Up(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").xd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(n.a)(Qz,"CoreExtPackage",null,[2,3]);class bL{constructor(){this.C4c=this.kf=this.Zc=this.qb=null;this.va=new vc.a;this.Eb=!1}init(a,b){this.kf=a;this.Zc=b;this.NA()}dispose(){this.qb&&(this.visible=!1,this.Zc.yb(sa.a.click,
this.qb,Object(F.a)(this,this.kJa,"onBackgroundClick")),this.kf&&this.qb&&(this.kf.removeChild(this.qb),this.qb=null),this.va&&(this.va.dispose(),this.va=null))}NA(){this.qb=document.createElement("div");this.qb.className="EditingNotesDefaultView";u.AFrameworkApplication.isRtl&&(this.qb.style.direction=nf.a.S0a);this.kf.appendChild(this.qb);this.C4c=document.createElement("p");this.C4c.className="EditingNotesDefaultViewContent";this.C4c.innerText=ResourceStrings.l_ClickToAddNotes;this.qb.appendChild(this.C4c);
this.Zc.pb(sa.a.click,this.qb,Object(F.a)(this,this.kJa,"onBackgroundClick"))}kJa(a){this.va.raiseEvent("OnBackgroundClick",a);return!0}Vuf(a){this.va.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Eb}set visible(a){this.Eb=a;this.qb.style.display=a?$i.a.block:$i.a.none}get xa(){return this.qb}}Object(n.a)(bL,"NotesPromptView",null,[1104,1105,106]);class cL{constructor(a){this.C$c=this.kf=this.qb=null;this.C6c=this.Eb=!1;this.zbk=a}init(a,b){b.Uzb&&(this.kf=a,this.qb=document.createElement("div"),
this.qb.className="EditingNotesReadOnlyView",this.zbk&&(this.qb.style.direction=nf.a.S0a),this.kf.appendChild(this.qb),this.C$c=document.createElement("div"),this.C$c.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.ved,b=jSanity.sanitize(a),this.C$c.appendChild(b),this.qb.appendChild(this.C$c),this.C6c=!0)}dispose(){this.C6c&&(this.visible=!1,this.kf&&this.qb&&(this.kf.removeChild(this.qb),this.qb=null),this.C6c=!1)}get visible(){return this.Eb}set visible(a){this.C6c&&(this.Eb=a,
this.qb.style.display=a?$i.a.block:$i.a.none)}get xa(){return this.qb}}Object(n.a)(cL,"NotesReadOnlyView",null,[1103,106]);var Rz=d(492),MD=d(645);class hr extends Rz.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je){super(a,b);this.eEb=this.kg=this.uh=this.peb=null;this.UWa=!1;this.Fva=Pc.App.Ym;this.GHa=Object(qa.a)(1101,b);this.qb=this.Nd.container;this.nc(this.qb);this.Zc=c;this.Fa=f;this.efb=l;this.QEb=wa;this.Yl=w;this.wi=H;this.xt=U;this.wJ=ja;this.ob=Sa;this.ccb=eb;this.b$=
Object(qa.a)(372,a);this.gec=ub;this.mc=Ub;this.BAe=cc;this.Zva=Fc;this.DJ=Ic;this.qe=Cc;this.a$c=Ud;this.Tp=je;this.V5c=this.qe.rk("formatpaintertext.cur");this.Tp&&this.DJ.rQd(Object(F.a)(this,this.clc,"onTextFPActiveChanged"));this.uh||this.NA()}dispose(){this.Zc.yb(sa.a.click,this.qb.parentNode,Object(F.a)(this,this.kJa,"onBackgroundClick"));this.Tp&&this.DJ.URe(Object(F.a)(this,this.clc,"onTextFPActiveChanged"));this.efb&&(this.efb.dispose(),this.efb=null);this.QEb&&(this.QEb.dispose(),this.QEb=
null);super.dispose()}Ny(a){super.Ny(a);this.Iuc()}Yaa(a){this.UD(this.kg,a,-1)}L6(){this.prd()}NA(){this.a$c&&(this.eEb=this.Nd.createElement("div"),this.eEb.className="NotesResizeHandle",Hf.c(this.eEb,!0),Sys.UI.DomElement.addCssClass(this.eEb,"NotesResizeHandle"),this.htmlElement.appendChild(this.eEb),this.Xo(this.eEb));this.peb=this.Nd.createElement("div");this.peb.className="NotesContentContainer";this.peb.id="NotesContentContainer";this.Xo(this.peb);this.htmlElement.appendChild(this.peb);this.uh=
this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.uh,"NotesView");Sys.UI.DomElement.addCssClass(this.uh,"NotesEditViewVisible");this.peb.appendChild(this.uh);this.Xo(this.uh);this.kg=this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.kg,"NotesViewContent");this.uh.appendChild(this.kg);this.Xo(this.kg);u.AFrameworkApplication.isRtl&&(this.uh.style.direction=nf.a.S0a);this.Zc.pb(sa.a.click,this.qb.parentNode,Object(F.a)(this,this.kJa,"onBackgroundClick"));this.efb.init(this.qb.parentNode,
this.Zc);this.QEb.init(this.qb.parentNode,this.GHa);this.prd();this.efb.Vuf(Object(F.a)(this,this.Ltk,"onDefaultViewClick"))}prd(){if(this.GHa.Uzb)this.oLa(!1),this.zZe(!1),this.Nnl();else{var a=this.Yl.kle(this.GHa);a=this.UWa||!a;this.oLa(a);this.zZe(!a);this.Tp&&this.lD(hr.yea)}}clc(a,b){hr.yea=b.lRc;this.lD(hr.yea)}lD(a){const b=this.qb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.qb.style.cursor=gf.a.fQ(this.V5c,$i.a.EA),this.kg.style.cursor=gf.a.fQ(this.V5c,$i.a.EA),
a=0;a<b.length;a++)if(b[a].style.cursor!==gf.a.fQ(this.V5c,$i.a.EA))b[a].style.cursor=gf.a.fQ(this.V5c,$i.a.Oaa);else break;else for(this.qb.style.cursor=$i.a.EA,this.kg.style.cursor=$i.a.EA,a=0;a<b.length;a++)b[a].style.cursor=$i.a.Oaa}Iuc(){this.htmlElement.style.zIndex="0";const a=this.Yl.cTa(this.GHa,this.Nd.Md),b=this.Yl.V5b(this.GHa,this.Nd.Md);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);hr.BWe(this.uh,b);hr.BWe(this.efb.xa,b);hr.BWe(this.QEb.xa,
b);this.Zva.ckb(new gd.a(a.x,a.y),u.AFrameworkApplication.isRtl,this.uh,!0)}nhb(){this.UWa=!0;this.AU();this.startEditing()}ohb(){this.UWa=!1;this.AU();this.endEditing()}uL(){return this.UWa}startEditing(){this.Vwa.Uzb?this.ob.jj():(this.prd(),this.klg()||(this.Fva=this.Vwa.TFa,this.wJ.Orh(this.GHa,!1),this.wJ.zMk(this.GHa)))}endEditing(){if(!this.Vwa.Uzb&&(this.ccb.setVisibility(!1),this.prd(),!this.klg())){this.a1g.endEditing(!0,14);this.gec.f2d(this.b$);var a=this.BAe.oua(this.Vwa,this.Fva),b=
!!this.Vwa&&this.Vwa.isConnected;a&&(b&&this.Vwa.Ppd(),this.wi.q7a(this.Vwa),this.xt.EVd());this.wJ.Orh(this.GHa,b&&this.Vwa.IZc)}}Ltk(a,b){this.kJa(b)}kJa(){this.Fa.Ej(Zi.a.Y2,!0);this.oLa(!0);this.zZe(!1);this.a1g.VR();this.NZe();this.Fva=this.Vwa.TFa;return!0}klg(){return!this.mc.In}get xa(){return this.htmlElement}get Vwa(){return this.GHa}get a1g(){return this.Qc}NZe(){this.$aa(!0)}Nnl(){this.QEb.visible=!0}zZe(a){this.efb.visible=a}oLa(a){MD.b(a,this.peb,"NotesContentContainerHidden","NotesContentContainerVisible")}$aa(a){MD.b(a,
this.uh,"NotesEditViewHidden","NotesEditViewVisible")}static BWe(a,b){a&&(a.style.paddingTop=gf.a.Pc(b[0]),a.style.paddingRight=gf.a.Pc(b[1]),a.style.paddingBottom=gf.a.Pc(b[2]),a.style.paddingLeft=gf.a.Pc(b[3]))}static XRj(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}hr.yea=0;Object(n.a)(hr,"NotesViewElement",Rz.a,[1102,374]);var cs=d(385),aR=d(615),bR=d(841),dL=d(490),Sz=d(489);class eL extends Sz.a{constructor(a,b){super(a,b);this.vea=[];this.qdc=0}iKb(a,...b){Array.addRange(this.vea,
b);this.qdc=a}voc(){if(this.vea)for(const a of this.vea)this.Ut.uoc(this.container,a,this.qdc);this.Ut.PJ(this.container,this.r3)}Duc(){this.Ut.aF(this.container,this.r3);for(const a of this.vea)this.Ut.aF(this.container,a)}}Object(n.a)(eL,"NotesViewDomManager",Sz.a,[]);var Tz=d(555);class fL extends Tz.ViewSelectionChangedHandler{constructor(a,b){super(a);this.pa=b}oub(){return[Object(F.a)(this,this.Qkc,"onSetup"),Object(F.a)(this,this.nkc,"onEnsurePageViewElementsCreated"),Object(F.a)(this,this.okc,
"onEnsureSelectedContentViewElementsCreated"),Object(F.a)(this,this.Dkc,"onMainLoop"),Object(F.a)(this,this.Swk,"onNotesContentSelect"),Object(F.a)(this,this.jkc,"onCommit"),Object(F.a)(this,this.blc,"onTearDown")]}Swk(a,b){this.iga(b);a=Object(qa.a)(1101,this.Ah.xg);if(!a)return!0;a=Object(qa.a)(1102,a.sc(this.Ah.Ma));if(!a)return!0;this.pa.fla()?a.uL()||a.nhb():a.uL()&&a.ohb();return!0}}Object(n.a)(fL,"NotesViewSelectionChangedHandler",Tz.ViewSelectionChangedHandler,[]);class ND extends Ev.DragSelectionDragAdapter{constructor(a,
b,c,f,l,w){super(a,b,c);this.gq=f;this.Epe=w;this.Yl=l}Uu(a){if(this.Epe){var b=this.ruc(a);const c=b?b.gb:null;if(c){const f=this.Yl.yFa(c)?Object(qa.a)(1101,c):this.Yl.rxb(c);if(f&&this.Yl.kle(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.Hf.u1a(a.clientPoint,b,c,this.Hf,!1))&&vb.HyperlinkReader.bla(b,!0))return!1}a=super.Uu(a);null!==this.gq&&a&&this.gq.vya($i.a.Oaa);return a}pu(a){super.pu(a);null!==this.gq&&this.gq.Xxa()}fo(a){super.fo(a);null!==this.gq&&this.gq.Xxa()}WI(a){return this.Hf.isActive?
super.WI(a):!1}static W5b(a){return new ND(a,Ab.a.instance.resolve("Common.IActionManagerExtended"),Ab.a.instance.resolve("Common.IActivityManager"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Ab.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Ab.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(n.a)(ND,
"NotesDragSelectionDragAdapter",Ev.DragSelectionDragAdapter,[]);var Uz=d(235);class OD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.KIg=this.dgc=this.bxg=this.Lze=this.sHa=0;this.F$=this.ldc=this.o9c=null;this.ucc=this.oug=this.W8c=0;this.Ase=!1;this.b$=a;this.f0=b;this.Ri=c;this.Rb=f;this.oA=l;this.Gg=w;this.oc=H;this.Kc=U;this.Jb=ja;wa.GPa(Object(F.a)(this,this.Ikc,"onOutboundReplication"));this.ia=Sa}Dv(a){return a&&a.uA!==Sys.UI.MouseButton.rightButton?hr.XRj(a.Ec):!1}Uu(a){if(!this.Dv(a))return!1;
this.Ase=!0;this.o9c=this.oA.xa;if(!this.o9c)return!1;this.F$=this.Kc.Ic;if(this.F$&&(this.ldc=this.Gg.xa))this.bxg=this.ldc.clientHeight;else return!1;this.W8c=Math.floor(.75*(this.o9c.clientHeight+this.ldc.clientHeight));this.Lze=this.o9c.clientHeight;this.dgc=this.sHa=a.clientPoint.y;this.KIg=this.F$.tT;this.f0.nl(7);this.b$.endEditing(!0,14);return!0}Gw(a){if(!a)return!1;this.sHa=a.clientPoint.y;a=this.kDf(this.sHa);this.oA.ufa=a;this.Rb.Oq();a=this.bxg+this.Lze-a;this.ldc.style.height=a+"px";
this.F$.Edl(a-1);this.F$.Ofl(this.KIg);return!0}fo(a){this.f0.m1();this.b$.VR();this.ucc=this.kDf(a?a.clientPoint.y:this.sHa);this.ia.La(L.a.wWe,2,this.ucc)}pu(){this.Ase&&(this.Ase=!1,this.fo(null))}Ikc(){this.ucc!==this.oug&&2===Pc.App.Kb.mode&&(this.oug=this.ucc,this.bCk(this.ucc))}bCk(a){const b=this.oc.$m,c=this.Jb.Ad(4);try{c.nc(b),b.YGb=4320,b.ufa=this.rpi(a)}finally{c&&c.dispose()}}kDf(a){a=this.Lze+this.Ri.Sm(this.dgc-a);0<this.W8c&&a>this.W8c?a=this.W8c:a<Uz.a.FRa&&a>Pf.a.xOc?a=Uz.a.FRa:
a<Pf.a.xOc&&(a=Pf.a.pRf);return a}rpi(a){return this.Ri.qLe(a,1)}static W5b(a){return new OD(a,Ab.a.instance.resolve("Common.CursorManager"),Ab.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Ab.a.instance.resolve("Box4.IAppFrame"),Ab.a.instance.resolve("PowerPointWebEditor.INotesPane"),Ab.a.instance.resolve("PowerPointWebEditor.ISlidePane"),Ab.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Ab.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Ab.a.instance.resolve("Common.Transaction.ITransactionFactory"),
Ab.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Ab.a.instance.resolve("Common.IActionManagerExtended"))}}Object(n.a)(OD,"NotesResizeDragAdapter",null,[244]);class gL extends cs.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){super(Zi.a.Y2,a,b,c,f,l,H,U,eb);this.Cxe=!1;this.NIa=w;this.mc=ja;this.Zf=wa;this.sO=Sa;this.Epe=ub;this.Tp=Ub}get iRd(){return u.AFrameworkApplication.fa}$x(a,b=null){this.Tp&&this.Zf.pb(sa.a.GJ,this.container,Object(F.a)(this,this.Kdd,"mouseUpHandlerFilter"));
super.$x(a,b);(a=Object(qa.a)(1101,a))&&a.Uzb&&this.zg&&this.zg.Tn&&this.zg.Tn.setAttribute("aria-readonly","true")}detach(){this.Tp&&this.uo&&this.Zf.yb(sa.a.GJ,this.container,Object(F.a)(this,this.Kdd,"mouseUpHandlerFilter"));super.detach()}e_b(a,b){return new eL(a,b)}Eda(a){a=super.Eda(a);a.r3=ND.W5b(this);a.iKb(1,OD.W5b(this));return a}dxa(a){this.QAc=a.Wf;if(!this.ioc||this.isActive||!this.Epe||(a.qc.type===sa.a.mouseDown||a.qc.type===sa.a.lQa)&&a.uA!==Sys.UI.MouseButton.leftButton)return!1;
var b=a.Ec;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;cs.a.j8&&(c=cs.a.j8.Bsa());Pc.App.OD.VS&&Pc.App.OD.VS.ATe(f=>{f&&(c=!0)});b=!Pd.a("DeprecateIE.NotesView")&&c&&B.a.eX;a=new aR.a(a,this,!0,b);this.ZLk(a);return!1}ZLk(a){this.uMe();this.g6(B.a.fg||B.a.IUa);this.Lp.raiseEvent(cs.a.rYc,new bR.a(a.graphNode));this.ZQc(a.graphNode);this.z6e();const b=[Object(F.a)(this,this.iGe,"noneClickHandler"),Object(F.a)(this,this.oqk,"notesSnapToContentClickHandler"),Object(F.a)(this,
this.jqk,"notesDefaultClickHandler")];for(const c of b)if(c(a).U3){this.Cxe=!0;break}}Kdd(){return this.Cxe&&this.sO.kVa?(this.Ca.processAction(D.a.Wja,2),!0):this.Cxe=!1}jqk(a){const b=cs.a.Wc.Wp(D.a.Etb);b.properties.$(Xc.a.source,"DefaultClickHandler");this.H6(a.iV,a.Yr,a.graphNode,a.Qc,a.Zi.shiftKey,a.Zi.ctrlKey,a.Zi.Wf);b.end();a.awb&&this.g6(!0);this.editingView.Obb(a.Zi.shiftKey,a.iV,a.Zi.Wf);return ri.a.Vl(!0)}oqk(a){if(!a.Yr){const b=a.Yr,c=a.graphNode,f=cs.a.Wc.Wp(D.a.Etb);f.properties.$(Xc.a.source,
"SnapToContentClickHandler");this.H6(a.iV,b,c,this,a.Zi.shiftKey,a.Zi.ctrlKey,a.Zi.Wf);f.end();a.awb&&this.g6(!0);this.editingView.Obb(a.Zi.shiftKey,a.iV,a.Zi.Wf);return ri.a.Vl(!0)}return ri.a.notHandled}Dna(){super.Dna();this.zg&&this.zg.Tn&&(this.iRd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.zg.qqc(Bc.a.hIc):this.zg.xVe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Bc.a.hIc),this.zg.Tn.setAttribute(Bc.a.ns,ResourceStrings.l_NotesPane))}wsd(){this.kF.Qd===this&&
this.suspend()}Rmd(){this.kF.Qd===this&&this.resume()}FUc(){return new fL(this,Ab.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}gSc(){return[Object(F.a)(this,this.iGe,"noneClickHandler"),Object(F.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(F.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(F.a)(this,this.defaultClickHandler,"defaultClickHandler")]}OSc(){return[Object(F.a)(this,this.iGe,"noneClickHandler"),Object(F.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}iGe(a){return this.Vzb(a)||this.YRj()?ri.a.Vl(!0):ri.a.notHandled}BSc(){return[Object(F.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(F.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(F.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}Lya(a){this.Vzb(a)||super.Lya(a)}noContextMenuHandler(a){return this.Vzb(a)?to.a.Vl(null):to.a.notHandled}Vzb(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.Uzb}YRj(){return!this.mc.In}k$a(){return dL.a.REe}get KF(){return super.KF|96}get MMb(){return!0}P6(a,b,c=null){this.NIa.iY(this)&&super.P6(a,b,c)}}Object(n.a)(gL,"NotesView",cs.a,[310,375,376,170,106,372,377,378,379,380]);var hL=d(491),Vz=d(211);class PD{constructor(a,b,c,f){this.fIg=null;this.Nva=a;this.ua=b;this.Nq=c;this.Wve=f}mGj(){this.fIg=new hL.a(Vz.App.Y5a.mqk,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.Nva.hCa(this.fIg.Nza);Gv.uIf(this.Nva);
this.jzf(this.ua.Ba);this.Nq.O9h(Object(F.a)(this,this.G2g,"onAttachNotesView"))}G2g(a,b){this.GTi();this.jzf(b.Fd)}jzf(a){this.ua.presentation&&a&&a.isConnected&&(a=this.Wve.y2f(a,27),this.Nva.$x(a))}GTi(){this.Nva.uo&&(this.Nva.editingView.disable(!0,14),this.Nva.detach())}dispose(){this.Nq.uZk(Object(F.a)(this,this.G2g,"onAttachNotesView"))}}Object(n.a)(PD,"NotesViewHelper",null,[106]);class QD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}Zb(a){this.K=a;this.K.register(310,
"PowerPointWebEditor.INotesView").ma().oa(()=>new gL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ja("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(PD,"PowerPointWebEditor.Notes.NotesViewHelper").ma().oa(()=>new PD(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new Ri.a((a,b)=>Object(Ya.a)(310,a)?new hr(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new bL,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new cL(u.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ubh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").mGj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){v.a.instance.Dc(new QD)}}Object(n.a)(QD,"PPTWebEditorNotesPackage",null,[2,3]);class RD extends Ev.DragSelectionDragAdapter{constructor(a,
b,c,f){super(a,b,c);this.gq=f}Uu(a){a=super.Uu(a);null!==this.gq&&a&&this.gq.vya($i.a.Oaa);return a}pu(a){super.pu(a);null!==this.gq&&this.gq.Xxa()}fo(a){super.fo(a);null!==this.gq&&this.gq.Xxa()}WI(a){return this.Hf.isActive?super.WI(a):!1}static W5b(a){return new RD(a,Ab.a.instance.resolve("Common.IActionManagerExtended"),Ab.a.instance.resolve("Common.IActivityManager"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Ab.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(n.a)(RD,"SmartArtTextViewDragSelectionDragAdapter",Ev.DragSelectionDragAdapter,[]);class iL extends Sz.a{constructor(a,b){super(a,b);this.vea=[];this.qdc=0}iKb(a,...b){Array.addRange(this.vea,b);this.qdc=a}voc(){if(this.vea)for(const a of this.vea)this.Ut.uoc(this.container,a,this.qdc);this.Ut.PJ(this.container,this.r3)}Duc(){this.Ut.aF(this.container,this.r3);for(const a of this.vea)this.Ut.aF(this.container,a)}}Object(n.a)(iL,"SmartArtTextViewDomManager",Sz.a,[]);class jL extends Tz.ViewSelectionChangedHandler{constructor(a,
b,c,f){super(a);this.pa=b;this.Te=c;this.KO=f}oub(){return[Object(F.a)(this,this.Qkc,"onSetup"),Object(F.a)(this,this.nkc,"onEnsurePageViewElementsCreated"),Object(F.a)(this,this.okc,"onEnsureSelectedContentViewElementsCreated"),Object(F.a)(this,this.Dkc,"onMainLoop"),Object(F.a)(this,this.Lzk,"onSmartArtContentSelect"),Object(F.a)(this,this.jkc,"onCommit"),Object(F.a)(this,this.blc,"onTearDown")]}Lzk(a,b){this.iga(b);b=Object(qa.a)(4,this.Ah.xg);if(!b)return!1;a=Object(qa.a)(373,b.sc(this.Ah.Ma));
b=Object(qa.a)(117,b.sc(this.Te));if(!a)return!1;this.pa.eVa()?a.uL()||(a.nhb(),this.KO.Ap(!0),b&&b.nhb()):a.uL()&&(a.ohb(),this.KO.Ap(!1),b&&b.ohb());return!0}}Object(n.a)(jL,"SmartArtTextViewSelectionChangedHandler",Tz.ViewSelectionChangedHandler,[]);class kL extends cs.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){super(Lb.a.QR,a,c,f,l,H,ja,wa,Sa);this.NIa=U;this.pa=b;this.Iq=w;this.Te=eb;this.KO=ub;this.Fa=Ub;this.Md.j6e=!0;this.Md.k5d=!1}get iRd(){return u.AFrameworkApplication.fa}e_b(a,b){return new iL(a,
b)}Eda(a){a=super.Eda(a);a.r3=RD.W5b(this);return a}Dna(){super.Dna();this.zg&&this.zg.Tn&&(this.iRd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.zg.qqc(Bc.a.hIc):this.zg.xVe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,Bc.a.hIc),this.zg.Tn.setAttribute(Bc.a.ns,ResourceStrings.l_SmartArtTextPane))}wsd(){this.kF.Qd===this&&this.suspend()}Rmd(){this.kF.Qd===this&&this.resume()}FUc(){return new jL(this,
Ab.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Te,this.KO)}wtb(){this.kF.Qd===this&&this.pa.sVd();return!1}gSc(){return[Object(F.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(F.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(F.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(F.a)(this,this.defaultClickHandler,"defaultClickHandler")]}OSc(){return[Object(F.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}BSc(){return[Object(F.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(F.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Fa.Ej(Lb.a.QR,!0);return a}k$a(){return dL.a.REe}get KF(){let a=super.KF;return a=Pd.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get MMb(){return!0}P6(a,b,c=null){this.NIa.iY(this)&&super.P6(a,b,c)}Wel(a){const b=this.Iq.oe(2);try{b.kd(a);let c=null;c=Od.SelectionFactory.uj(a,!0);
this.setSelection(c)}finally{b&&b.dispose()}}}Object(n.a)(kL,"SmartArtTextView",cs.a,[308,375,376,170,106,372,377,378,379,380]);class lL extends Rz.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){super(a,b);this.kg=this.uh=null;this.UWa=!1;this.Fva=Pc.App.Ym;this.lbd=b;this.qb=this.Nd.container;this.nc(this.qb);this.Zc=c;this.Fa=f;this.ia=l;this.wi=w;this.xt=H;this.wJ=U;this.ccb=ja;this.b$=a;this.gec=wa;this.ld=Sa;this.NA()}dispose(){this.Zc.yb(sa.a.click,this.qb.parentNode,Object(F.a)(this,this.kJa,"onBackgroundClick"));
this.ld.z0k(Object(F.a)(this,this.y7g,"onSmartArtTextPaneWidthChanged"));super.dispose()}Ny(a){super.Ny(a)}Yaa(a){this.UD(this.kg,a,-1)}L6(){this.oLa(!0)}NA(){this.uh=this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.uh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.uh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.uh);this.Xo(this.uh);this.kg=this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.kg,"SmartArtTextViewContent");this.kg.style.width=gf.a.Pc(Pf.a.fsc-
2*Pf.a.pNb-2*Pf.a.m_e-Pf.a.fyh);this.uh.appendChild(this.kg);this.Xo(this.kg);u.AFrameworkApplication.isRtl&&(this.uh.style.direction=nf.a.S0a);this.oLa(!0);this.Zc.pb(sa.a.click,this.qb.parentNode,Object(F.a)(this,this.kJa,"onBackgroundClick"));this.ld.ici(Object(F.a)(this,this.y7g,"onSmartArtTextPaneWidthChanged"))}nhb(){this.UWa=!0;this.AU();this.startEditing()}ohb(){this.UWa=!1;this.AU();this.endEditing()}uL(){return this.UWa}startEditing(){this.oLa(!0);this.Fva=this.I0a.TFa;this.wJ.zqc(this.lbd,
!1);this.wJ.wjd(this.lbd)}endEditing(){this.ccb.setVisibility(!1);this.oLa(!0);this.hyh.endEditing(!0,14);this.gec.f2d(this.b$);const a=new mw.a(this.I0a,this.Fva);this.ia.La(L.a.iib,2,a);const b=!!this.I0a&&this.I0a.isConnected;a.oua&&(b&&this.I0a.Ppd(),this.wi.q7a(this.I0a),this.xt.EVd());this.wJ.zqc(this.lbd,b&&this.I0a.IZc)}kJa(){this.Fa.Ej(Lb.a.QR,!0);this.hyh.VR();this.oLa(!0);this.Fva=this.I0a.TFa;return!0}get xa(){return this.htmlElement}get I0a(){return this.lbd}get hyh(){return this.Qc}oLa(a){MD.b(a,
this.uh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}y7g(a,b){this.kg.style.width=gf.a.Pc(gf.a.Gn(b.width))}}Object(n.a)(lL,"SmartArtTextViewElement",Rz.a,[373,374]);class mL{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.XUg=this.ocb=null;this.KO=a;this.uIa=b;this.ld=c;this.Fa=f;this.xt=l;this.kM=w;this.pa=H;this.Fb=Object(qa.a)(372,U);this.Nq=ja;this.Pg=wa;this.mc=Sa;this.t0=eb}QGj(){this.XUg=new hL.a(this.KO.rRf,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.uIa.hCa(this.XUg.Nza);Gv.uIf(this.uIa);this.ld.$bi(Object(F.a)(this,this.f7g,"onSingleSmartArtShapeViewElementSelected"));this.ld.aci(Object(F.a)(this,this.g7g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.ld.hci(Object(F.a)(this,this.x7g,"onSmartArtShapeViewElementDeselected"));this.ld.ZYb(Object(F.a)(this,this.Kgd,"onSlideHtmlUpdated"));this.ld.W9h(Object(F.a)(this,this.w7g,"onSmartArtCommentsVisibilityChanged"));this.kM.R7(Object(F.a)(this,this.Rkc,"onShapeDisconneted"));
this.Nq.ZGc(Object(F.a)(this,this.EU,"onFocusChanged"));this.Nq.SGc(Object(F.a)(this,this.EU,"onFocusChanged"));this.Fb.KPa((a,b)=>{this.Kgd(a,b)})}Dua(){return!this.mc.In}IZe(a){if(this.t0){if(this.Dua()||a.xna)return}else if(this.Dua())return;a&&a.Qf&&!a.get_smartArtModelId()&&a.isConnected?(va.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.j_e||(this.ocb!==a&&(this.ocb=a,this.n2d(),this.kzf(a)),this.KO.L5e(a),this.KO.Ap(!0))):va.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}aol(a){this.Dua()||(a&&a.Qf&&!a.get_smartArtModelId()&&a.isConnected?(va.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.j_e||(this.ocb!==a&&(this.ocb=a,this.n2d(),this.kzf(a)),this.Fa.Ej(Lb.a.QR,!0),this.xt.uw(),this.uIa.Wel(a),this.KO.L5e(a),this.KO.Ap(!0))):va.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}UPf(){this.KO.isVisible&&
(va.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.KO.Ap(!1))}f7g(a,b){this.Dua()||this.IZe(b.shapeNode)}g7g(a,b){this.Dua()||this.aol(b.shapeNode)}x7g(){this.Dua()||this.UPf()}Kgd(){if(!this.Dua()&&this.pa.HL()){const a=this.pa.tEa();va.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.KO.L5e(a)}}EU(a,b){this.Dua()||(a=b.Hgb,a===Lb.a.QR?this.Pg.rI(Lb.a.QR):this.Pg.Y9b(a)&&this.Pg.Lo(Lb.a.QR))}kzf(a){a&&a.isConnected&&this.uIa.$x(a)}n2d(){this.uIa.uo&&
(this.uIa.editingView.disable(!0,14),this.uIa.detach())}Rkc(a,b){this.Dua()||b.node!==this.ocb||(this.ocb=null,this.n2d(),this.KO.Ap(!1))}w7g(a,b){this.Dua()||((a=b.zhl)?a.Qf&&this.IZe(a):(a=this.pa.tEa())?this.ocb!==a&&this.IZe(a):this.UPf())}dispose(){this.ld.r0k(Object(F.a)(this,this.f7g,"onSingleSmartArtShapeViewElementSelected"));this.ld.s0k(Object(F.a)(this,this.g7g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.ld.y0k(Object(F.a)(this,this.x7g,"onSmartArtShapeViewElementDeselected"));
this.ld.zZk(Object(F.a)(this,this.w7g,"onSmartArtCommentsVisibilityChanged"));this.kM.wKa(Object(F.a)(this,this.Rkc,"onShapeDisconneted"));this.Nq.KRe(Object(F.a)(this,this.EU,"onFocusChanged"));this.Nq.Vld(Object(F.a)(this,this.EU,"onFocusChanged"));this.ld.Yjh(Object(F.a)(this,this.Kgd,"onSlideHtmlUpdated"));this.Fb.Roc((a,b)=>{this.Kgd(a,b)})}}Object(n.a)(mL,"SmartArtTextViewHelper",null,[309,106]);class SD{constructor(){this.K=null;this.mA=!1}get name(){return"PowerPointWebEditor.SmartArt"}Zb(a){this.K=
a;this.K.register(308,"PowerPointWebEditor.ISmartArtTextView").ma().oa(()=>new kL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.Ja("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(309,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().oa(()=>new mL(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").xd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").yka))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.ff(()=>{if(this.mA=a.ka("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new Ri.a((b,c)=>Object(Ya.a)(308,b)?(c=Object(qa.a)(4,c))&&c.Qf?new lL(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").QGj()})}dispose(){this.mA&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){v.a.instance.Dc(new SD)}}Object(n.a)(SD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class nL{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(n.a)(nL,"CT_WebTextListStyle",null,[]);var bp=d(343);class oL{constructor(a){this.Lla=a}PZ(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,w=!!(f&64)&&!!c.lastRowField,H=!!(f&128)&&!!c.firstColField,U=!!(f&256)&&
!!c.lastColField,ja=l&&H&&!!c.nwCellField,wa=l&&U&&!!c.neCellField,Sa=w&&H&&!!c.swCellField,eb=w&&U&&!!c.seCellField,ub=!!(f&512)&&!!c.band1HField,Ub=!!(f&512)&&!!c.band2HField,cc=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var Fc=!b.re,Ic=b.$f===a.HY,Cc=!b.he;a=b.Nf===a.$ra;var Ud=1===b.re%2===l;b=1===b.he%2===H;var je=!(l&&Fc)&&!(w&&Ic),Vd=!(H&&Cc)&&!(U&&a);c.wholeTblField&&this.apply(c.wholeTblField);je&&(ub&&Ud||Ub&&!Ud)&&(Ud?this.apply(c.band1HField):this.apply(c.band2HField));
Vd&&(cc&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&U&&this.apply(c.lastColField);Cc&&H&&this.apply(c.firstColField);Ic&&w&&(this.apply(c.lastRowField),a&&eb&&this.apply(c.seCellField),Cc&&Sa&&this.apply(c.swCellField));Fc&&l&&(this.apply(c.firstRowField),a&&wa&&this.apply(c.neCellField),Cc&&ja&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=Dl.a(b);ie.Box4ColorHelper.Aab(a)||(bp.g(this.Lla),this.Lla.solidFillField=new Wu.a,ie.Box4ColorHelper.zfi(this.Lla.solidFillField,
a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.Lla;0===b||1===b?(f.latinField=Ze.qub(b,0),f.eaField=Ze.qub(b,1),f.csField=Ze.qub(b,2)):va.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.Lla.latinField=b.latinField),null!==b.eaField&&(this.Lla.eaField=b.eaField),null!==b.csField&&(this.Lla.csField=b.csField));if(0===a||1===a)this.Lla.bFieldSpecified=
!0,this.Lla.bField=0===a;if(0===c||1===c)this.Lla.iFieldSpecified=!0,this.Lla.iField=0===c}}}Object(n.a)(oL,"CellTextStylePartApplier",null,[]);class at{constructor(a){this.wWg=a}get value(){return this.wWg.valField/1E5}set value(a){this.wWg.valField=Math.floor(1E5*a)}get type(){return at.y_b}}at.y_b="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(n.a)(at,"LineSpacingPercent",null,[1181,1182]);class ir{constructor(a){this.xWg=a}get value(){return this.xWg.valField/
100}set value(a){this.xWg.valField=Math.floor(100*a)}get type(){return ir.y_b}}ir.y_b="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(n.a)(ir,"LineSpacingPoint",null,[1181,1182]);class cR{constructor(){this.valField=0}}Object(n.a)(cR,"CT_TextSpacingPoint",null,[]);class bt{constructor(a){this.are=a}get lineSpacing(){return this.are}get value(){return this.are.value}set value(a){this.are.value=a}static E1b(a){if(a.__type===at.y_b)return new bt(new at(a));if(a.__type===
ir.y_b)return new bt(new ir(a));va.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(n.a)(bt,"LineSpacingWrapper",null,[]);const pL=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},qL=
(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},dR=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class Tx{constructor(){this.stb=Array(Tx.uDh);this.oKe=Array(Tx.uDh)}}Tx.uDh=9;Object(n.a)(Tx,"TextListStyleCache",null,[]);class rL{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(n.a)(rL,"NumberingData",null,[]);class Hv{}Hv.FTd="\u2022";Hv.Nmi="p";Hv.Omi="n";Object(n.a)(Hv,"ListFormats",null,[]);class sL{constructor(a,b,c,f){this.BXg=this.CXg=Pc.App.Ym;this.nug=null;this.ic=a;this.Yl=b;this.fM=c;this.nA=f}get caches(){return this.nug||
(this.nug={})}j0f(a,b,c){const f=c-1;let l=a.W_;var w;const H=!!l&&!ia.a.nil.equals(l[f]);if(H&&(w=this.caches[l[f].toString()]))return w=w.clone(),b=ia.a.create(),a.Gh.HE(w,b),w;if(!H)if(l)l=Array.clone(l);else for(l=Array(9),w=0;w<l.length;w++)l[w]=ia.a.nil;const U=H?l[f]:ia.a.create();w=this.zxi(a,b,c);l[f]=U;this.caches[U.toString()]=w;H||(a.W_=l);a.Gh.HE(w,U);H&&(w=w.clone(),a.Gh.HE(w,ia.a.create()));return w}zxi(a,b,c){const f=ro.a.instance.createInstance(131073);if(b){var l=b.Z_f(a.rowIndex,
a.ui,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?pL(b,c):null)||new At;if(l){var w=c-1;c=l.stb[w];w=l.oKe[w];if(c||w){l=b.defRPrField||new rp;if(w){const H=Jc.a(Jc.c(w));w=H;b.algnFieldSpecified&&(w.algnFieldSpecified=!0,w.algnField=b.algnField);b.indentFieldSpecified&&(w.indentFieldSpecified=!0,w.indentField=b.indentField);b.lvlFieldSpecified&&(w.lvlFieldSpecified=!0,w.lvlField=b.lvlField);b.marLFieldSpecified&&(w.marLFieldSpecified=!0,w.marLField=b.marLField);b.marRFieldSpecified&&(w.marRFieldSpecified=
!0,w.marRField=b.marRField);b.rtlFieldSpecified&&(w.rtlFieldSpecified=!0,w.rtlField=b.rtlField);b.buAutoNumField&&(w.buAutoNumField=b.buAutoNumField);b.buCharField&&(w.buCharField=b.buCharField);b.buClrField&&(w.buClrField=b.buClrField);b.buClrTxField&&(w.buClrTxField=b.buClrTxField);b.buFontField&&(w.buFontField=b.buFontField);b.buFontTxField&&(w.buFontTxField=b.buFontTxField);b.buNoneField&&(w.buNoneField=b.buNoneField);b.buSzPctField&&(w.buSzPctField=b.buSzPctField);b.buSzPtsField&&(w.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(w.buSzTxField=b.buSzTxField);b.defRPrField&&(w.defRPrField=b.defRPrField);b.lnSpcField&&(w.lnSpcField=b.lnSpcField);b.spcAftField&&(w.spcAftField=b.spcAftField);b.spcBefField&&(w.spcBefField=b.spcBefField);b=H}c&&(c=Jc.a(Jc.c(c)),qL(c,l),b.defRPrField=c)}}a=Object(qa.a)(115,this.ic.jg(a));this.Hxi(f,b,a?a.Jd:null)}f.we(hb.a.S8b,!0);return f}Hxi(a,b,c){this.Gxi(a,b);if(b){if(b.algnFieldSpecified){var f=dR(b.algnField);a.setValue(Za.a.Jl,f);a.setValue(Za.a.gJ,f)}b.marLFieldSpecified&&
a.we(Va.a.$l,te.a.nvb(b.marLField));b.marRFieldSpecified&&a.we(Va.a.wY,te.a.nvb(b.marRField));b.indentFieldSpecified&&a.we(Va.a.ho,te.a.nvb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(Va.a.Gub,te.a.nvb(b.defTabSzField));b.spcAftField&&(f=bt.E1b(b.spcAftField.itemField),Object(Ya.a)(at,f.lineSpacing)?a.setValue(hb.a.wla,2):Object(Ya.a)(ir,f.lineSpacing)&&a.setValue(hb.a.wla,4),a.setValue(hb.a.aea,f.value));b.spcBefField&&(f=bt.E1b(b.spcBefField.itemField),Object(Ya.a)(at,f.lineSpacing)?a.setValue(hb.a.xla,
2):Object(Ya.a)(ir,f.lineSpacing)&&a.setValue(hb.a.xla,4),a.setValue(hb.a.cea,f.value));b.lnSpcField&&(f=bt.E1b(b.lnSpcField.itemField),Object(Ya.a)(at,f.lineSpacing)?a.setValue(hb.a.nX,2):Object(Ya.a)(ir,f.lineSpacing)&&a.setValue(hb.a.nX,4),a.setValue(hb.a.xx,f.value))}else va.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&hj.Axi(a,b.defRPrField,c)}V2k(a){if(a=a.W_)for(let b=0;b<a.length;b++){const c=a[b];c&&!ia.a.nil.equals(c)&&
delete this.caches[c.toString()]}}Gxi(a,b){var c=this.lw(b);a.ay(c.propertySet);b.marLFieldSpecified&&a.setValue(Va.a.$l,te.a.nvb(b.marLField));b.indentFieldSpecified&&a.setValue(Va.a.ho,te.a.nvb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue(Za.a.fontSize,hj.nJf(b.defRPrField.szField));b.spcAftField&&(c=bt.E1b(b.spcAftField.itemField),Object(Ya.a)(ir,c.lineSpacing)&&(a.setValue(hb.a.wla,4),a.setValue(hb.a.aea,c.value)));b.spcBefField&&(b=bt.E1b(b.spcBefField.itemField),
Object(Ya.a)(ir,b.lineSpacing)&&(a.setValue(hb.a.xla,4),a.setValue(hb.a.cea,b.value)))}lw(a){let b;({tpe:b,s6j:c}=this.N8d(a));var c=cf.a.yN(b,c);0===b&&(c.yA=c.lX=a.buAutoNumField.startAtField);return c}N8d(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case Hv.Nmi:case Hv.Omi:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=
4;break;case 15:case 11:case 13:c=5}return{tpe:b,s6j:c}}validate(a){if(Object(qa.a)(yg.a,a)&&(this.Yl.yFa(a)||jj.OutlineReader.gX(a))&&a.isConnected){this.CXg=new Date;var b=Array(Wo.a.e8);for(var c=0;c<Wo.a.e8;++c)b[c]=new rL;c=-1;var f=0,l=!1;a=Vl.a.Vz(a);for(a.em(Object(F.a)(this,this.R0j,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.wYc(b,0),this.xie(b,0,0));if(11!==a.iterator.currentNode.type)continue;const w=a.iterator,H=this.nda(w);let U=b[H].nextListId,
ja=null;if(rb.ListReader.vk(w)){this.nA.qna(w);ja=this.nA.G8d(w);const wa=this.V4i(w);w.zc();if(!ja){Nc.a.instance.Xb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===ja.listType){if(ja.yA!==rk.a.Nw&&b[H].restartInfo!==ja.yA||ja.listStyle!==b[H].listStyle||wa!==b[H].autonumberBulletType)l=!0,b[H].restartInfo=b[H].nextNumber=ja.yA===rk.a.Nw?1:ja.yA,U=b[H].nextListId=0,b[H].listStyle=ja.listStyle,b[H].autonumberBulletType=wa;ja.lX=b[H].nextNumber;c!==H||l?(ja.Jja=b[H].nextNumber,
l=!1):ja.Jja=rk.a.Nw;this.fM.isEmpty(w,!1)?l=!0:b[H].nextNumber++}else 1!==ja.listType&&Nc.a.instance.Xb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});U||(U=b[H].nextListId=++f);w.currentNode.listID=U}c=H;ja?(0===ja.listType?this.wYc(b,H+1):this.wYc(b,H),this.xie(b,H+1,U)):(this.wYc(b,H),this.xie(b,H,0))}this.BXg=new Date;va.a.J(22344988,820,50,"ListCore::Validate {0}",+this.BXg-+this.CXg)}}nda(a){this.fM.$g(a)||Nc.a.instance.Xb("PossibleListLevelIncorrect",{["Reason"]:od.a.Qca});
return a.currentNode.sa(Va.a.listLevel,Jg.a.PEa)}$cj(a){this.fM.$g(a)||Nc.a.instance.Xb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:od.a.Qca});return a.currentNode.listID}R0j(a){return this.fM.$g(a)||hd.TableReader.eq(a)||ok.l(a)||Ie.isTableCell(a)}wYc(a,b){for(;b<Wo.a.e8;++b)a[b].nextNumber=a[b].restartInfo=1}xie(a,b,c){for(;b<Wo.a.e8;++b)a[b].nextListId=c}V4i(a){return a.currentNode.sa(hb.a.autonumberBulletType,8)}}Object(n.a)(sL,"ListCore",null,[304]);class Vp{constructor(a,b,c=null){this.Rf=
a;this.Fi=b;this.Lt=null;this.gpb=c}get ckl(){return!1}zSk(a){return a}aMb(a){let b,c,f;b=rb.ListReader.K8a;c=a.propertySet.sa(Va.a.listID,0);f=a.propertySet.sa(Va.a.listLevel,-1);if(R.a.instance.ga(85)||b&&0<c&&0<=f)this.Lt=a;else{let l=1;const w=a.listStyle;b&&42!==w&&0<w&&(l=w);this.Lt=cf.a.yN(a.listType,l,null,c,f,void 0,"")}}Ndl(a){a&&(this.Lt=a)}j1d(){}createList(a){const b=Nc.a.instance.Wp(D.a.createList);fe.OutlineElementReader.$g(a)||Nc.a.instance.Xb("PossiblyIncorrectListCreation",{["Reason"]:od.a.Qca});
rb.ListReader.vk(a)&&Nc.a.instance.Xb("PossiblyIncorrectListCreation",{["Reason"]:od.a.yAi});const c=this.GFi();a.Cl(c,4);a.Pk(c);b.end();return c}GFi(){return Fs.a.instance.createInstance(393234)}moa(a){const b=Nc.a.instance.Wp(D.a.moa);fe.OutlineElementReader.$g(a)||Nc.a.instance.Xb("PossiblyIncorrectListRemoval",{["Reason"]:od.a.Qca});rb.ListReader.vk(a)&&this.OYk(a);b.end()}OYk(a){this.Rf.qna(a);a.Oi()}Vrb(a,b,c,f=!1){const l=Nc.a.instance.Wp(D.a.nfi);if(!this.GDf(b,c))return{returnValue:!1,kab:c};
this.lsh(a,c,f);f=a.Sa(Yd.a.e0g);var w=a.sa(Yd.a.Lhg,!1);let H=!1;1===c.X_&&c.Jme&&!c.NT&&(H=!0);const U=c.propertySet.sa(Va.a.rbc,null);U&&U===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?H=c.Jme&&!c.NT:0===c.listType&&(H=0===c.listStyle));w?H&&(c.zya(16,0),a.setValue(Yd.a.jE,16),a.setValue(Yd.a.eea,0)):(w=this.Rf.lw(b),this.Ivh(c,w,f,H,a)&&(l.properties.$("ToggledOff","true"),c.zya(16,0),this.Ycl(a)),0===c.listType&&a.Sa(Yd.a.CVa)&&(c.yA=a.eb(Yd.a.CVa),a.removeProperty(Yd.a.CVa)));if(f&&
(l.properties.$("MultipleOESelection","true"),({kab:c}=this.zvh(b,c)).returnValue))return l.end(),{returnValue:!1,kab:c};this.Wci(b,c,a);a.setValue(Yd.a.Lhg,!0);l.end();return{returnValue:!0,kab:c}}Ivh(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&a.yA===rk.a.Nw;a=a.listStyle===b.listStyle&&a.yA===b.yA;this.Rf.Ubb&&(a=a&&!c);return f&&(l||a)}return!1}Ycl(a){a.setValue(Yd.a.jE,16);a.setValue(Yd.a.eea,0)}lsh(){}GDf(){return!0}zvh(a,b){return{returnValue:16!==b.listType&&
fe.OutlineElementReader.isEmpty(a,!0),kab:b}}Dtb(a){const b=Nc.a.instance.Wp(D.a.Dtb);zb.ParagraphReader.ae(a)||Nc.a.instance.Xb("ClearingListFromNonParagraph",{["Reason"]:od.a.S0d});const c=new ob.GraphIterator;c.set(a);c.Ze();c.LB(12);Pa.OutlineElementNavigator.Re(c);this.SPa(c,null);b.end()}wRd(){}merge(a,b,c){const f=Nc.a.instance.Wp(D.a.Q0j);fe.OutlineElementReader.$g(b)||Nc.a.instance.Xb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});fe.OutlineElementReader.$g(a)||Nc.a.instance.Xb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});if(rb.ListReader.vk(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=rb.ListReader.K8a;c&&this.ckl&&rb.ListReader.vk(a)&&this.moa(a);if(!rb.ListReader.vk(a)||c&&l)c&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.F8d(b),this.Rf.BAh&&c.propertySet.we(Za.a.EVa,rk.a.Nw),1===c.X_&&c.uFf(),this.SPa(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true")),u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
Vp.KL.e0c&&this.$qi(b,a);this.moa(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}$qi(a,b){a=zb.ParagraphReader.Vwb(a.currentNode);b=this.Rf.m4f(b);this.wpd(b,a,null)}F8d(a){return this.Rf.lw(a)}wpd(a,b,c){if(a){b=Id.a.create(b);b=Kb.a.xs(b);this.j0a(a,Za.a.fontColor,c,b);this.j0a(a,Za.a.fontSize,c,b);if(this.gpb){let f,l;({value:f}=this.getPropertyValue(Za.a.font,c,b,"")).returnValue&&this.gpb.YU(a,f);({value:l}=this.getPropertyValue(Va.a.mV,c,b,-1)).returnValue&&this.gpb.jLa(a,
l)}else this.j0a(a,Za.a.font,c,b),this.j0a(a,Va.a.mV,c,b);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");Vp.KL.e0c&&(this.j0a(a,Za.a.bold,c,b),this.j0a(a,Za.a.italic,c,b),this.j0a(a,Za.a.superscript,c,b),this.j0a(a,Za.a.subscript,c,b))}}Zrh(){}j0a(a,b,c,f){c&&c.Sa(b)?a.setValue(b,c.eb(b)):f&&f.cache&&(c=f.cache,c.Sa(b)&&a.setValue(b,c.eb(b)))}getPropertyValue(a,b,c,f){if(b&&b.Sa(a))return f=b.eb(a),{returnValue:!0,value:f};if(!c||
!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Sa(a)?(f=b.eb(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}zTf(a,b){b.Sa(Yd.a.jE)||(a===D.a.QM?b.setValue(Yd.a.jE,1):a===D.a.mP&&b.setValue(Yd.a.jE,0));b.Sa(Yd.a.eea)||b.setValue(Yd.a.eea,0);return b}aQa(a,b,c,f,l,w,H){a=Nc.a.instance.Wp(D.a.aQa);const U=this.Rf.lw(b);c=cf.a.yN(0,c);c.yA=f;c.Ora=w;U&&c.Ace(U)&&c.yA===U.lX||(f=new qf.GraphTransaction(15),f.Iy(b),b=this.tfj(c),null!=b&&H.numbering(b)&&(ka.ULS.sendTraceTag(509747284,
393,50,"Found list insert matching string "+w),Vp.characterPropertiesEditor.replaceTextRange(l,"")),f.dispose());a.end()}tfj(a){var b;let c=null===(b=null===pv||void 0===pv?void 0:pv[a.listType])||void 0===b?void 0:b[a.Ora];if(null==c)return null;b=new K.DictionaryPropertySet;b.setValue(Yd.a.jE,a.listType);b.setValue(Yd.a.eea,a.listStyle);b.setValue(Yd.a.CVa,a.yA);b.setValue(Za.a.Ui,c.Ui);this.ial(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return Vp.gh||(Vp.gh=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get KL(){return Vp.CK||
(Vp.CK=Ab.a.instance.rb("Box4.List.ListSettings"))}}Vp.gh=null;Vp.CK=null;Object(n.a)(Vp,"ListEditor",null,[303]);class An{}An.jEe=80640;An.kEe=0;An.qee=80640;An.ree=-80640;Object(n.a)(An,"ParagraphConstants",null,[]);var Zl=d(186);class tL extends Vp{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){super(a,b);this.H3c=[Za.a.Ui,Za.a.font];this.L8c=[Za.a.Ui,Za.a.font,Za.a.fontColor,hb.a.autonumberBulletType,hb.a.Yvb];this.MHa=c;this.Ffc=f;this.mDb=l.Clg;this.fM=w;this.Yl=H;this.uH=ja;this.sA=wa;this.mi=
Sa;this.Qva=eb;this.cfc=l.xle;this.Rdb=l.Elg;this.XL=ub;this.Pb=Ub;this.Ea=cc;this.Cva=l.pptCopyPasteListMarkerEnabled;this.bfc=l.pptCopyPasteMarginAndIndentationEnabled;this.sEg=l.pptCopyPasteTextWithSpacingFromExternal}aMb(a){super.aMb(a);this.Rdb&&this.zLc(a.propertySet,this.Lt.propertySet)}nWe(a){if(this.mDb&&this.Lt&&this.Lt.propertySet){const b=this.Lt.propertySet.sa(Va.a.listLevel,-1);-1!==b&&this.oWe(a,b)}this.Cva&&this.Lt&&(this.Lt.fwb=!0);this.sEg&&this.Mrh(a);this.xRd(a,this.Lt);this.Lt=
null}yrh(a,b,c){b=this.Fi.i9b(a);this.Fi.wNb(a,b,c,!1,!0)}GDf(a,b){if(!a||!b)return!1;if(a.Bb(4)){var c=this.Rf.G8d(a);this.MHa.Re(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.Bb(2);const f=c.sa(Va.a.ho,Jg.a.indent),l=c.sa(Va.a.$l,Jg.a.leftMargin);this.MHa.Re(a);a=f;let w=l;({indent:a,margin:w}=this.lUd(hj.AAf(zb.ParagraphReader.Rja(c,Za.a.fontSize,0)),b.listType,f,l,a,w));return!!(this.hRj(w)&this.cQj(a))}y3f(a,b,c,f){if(!a)return va.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),
{loe:c,pee:f};b&&(c=b.sa(hb.a.r2b,Jg.a.leftMargin),f=b.sa(hb.a.q_d,Jg.a.indent),(a=this.Ea.en(a))&&a.ud&&(c=b.sa(Va.a.$l,Jg.a.leftMargin),f=b.sa(Va.a.ho,Jg.a.indent)));return{loe:c,pee:f}}ZCf(a,b,c,f){if(!a||!this.fM.$g(b))return va.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{$3d:c,Z3d:f};var l=this.qQ(b,this.uH.nda(b));if(l){const w=a.sa(Va.a.$l,Jg.a.leftMargin),H=a.sa(Va.a.ho,Jg.a.indent);c=w;f=H;let U=Jg.a.leftMargin,
ja=Jg.a.indent;({loe:U,pee:ja}=this.y3f(a,l,U,ja));l=cf.a.NCa(l,null).listType;const wa=w+(0<=H?0:H),Sa=U+(0<=ja?0:ja),eb=b.Bb(4);let ub=16;eb&&(ub=this.Ffc.gxb(eb),b.zc());ja&&wa===Sa&&l===ub?(c=U,f=ja):({indent:f,margin:c}=this.lUd(this.M9a(a),ub,H,w,f,c),c=Math.max(Math.min(c,An.jEe),An.kEe),f=Math.max(Math.min(f,An.qee),An.ree))}return{$3d:c,Z3d:f}}Y8i(a,b){if(!a||!this.fM.$g(b))return va.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),
Jg.a.leftMargin;let c=Jg.a.leftMargin,f=Jg.a.indent;({$3d:c,Z3d:f}=this.ZCf(a,b,c,f));0<c&&va.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}V8i(a,b){if(!a||!this.fM.$g(b))return va.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),Jg.a.indent;let c=Jg.a.leftMargin,f=Jg.a.indent;({$3d:c,Z3d:f}=this.ZCf(a,b,c,f));0<f&&va.a.J(512496321,820,50,"Get defaultIndent from liststyle");return f}zvh(a,b){return{returnValue:!1,
kab:b}}Ivh(a,b,c,f,l){return f?!0:!b||l&&l.Sa(Za.a.Ui)?!1:a.listType===b.listType}hRj(a){return a<An.jEe&&a>=An.kEe}cQj(a){return a<An.qee&&a>=An.ree}ial(a,b){a.setValue(hb.a.autonumberBulletType,b)}fll(a){return a}j1d(a,b){a.Sa(Va.a.listLevel)&&b.we(Va.a.listLevel,a.Mh(Va.a.listLevel))}mdj(a,b){return Object(Ya.a)(Zl.TableCellNode,a)?this.uH.j0f(a,this.sA.$Uc(a),b):this.efj(a,b)}efj(a,b){--b;const c=a.sa(Va.a.W_,[]);return 0>b||b>=c.length?(va.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",
b),Nc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Gh.Be(c[b])}wpd(){}oWe(a,b){if(this.fM.$g(a)&&0<=b&&b<Wo.a.e8){const c=a.currentNode,f=a.Bb(2);c&&c.setValue(Va.a.listLevel,b);f&&(f.setValue(Va.a.listLevel,b),a.zc())}}pdl(a,b){if(this.fM.$g(a)&&b&&b.propertySet){var c=a.Bb(4);c&&(b.dyb&&b.z9&&(this.Rdb?(this.zLc(b.propertySet,c),this.Cva&&b.propertySet.Sa(hb.a.autonumberBulletType)&&c.setValue(hb.a.autonumberBulletType,b.propertySet.eb(hb.a.autonumberBulletType))):
c.setValue(Za.a.Ui,b.z9)),a.zc())}}Zrh(a){if(this.fM.$g(a)){if(this.mDb&&this.Lt&&this.Lt.propertySet){const b=this.Lt.propertySet.sa(Va.a.listLevel,-1);-1!==b&&this.oWe(a,b);this.pdl(a,this.Lt)}this.bfc&&this.Pcl(a);this.Cva&&(this.Lt&&this.Lt.propertySet?this.dPj(this.Lt)||(va.a.J(512496285,820,50,"Copied from external, such as website."),this.pWe(a)):(va.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.pWe(a)));this.sEg&&this.Mrh(a);this.Lt=null}else va.a.J(512496288,820,10,
"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}Mrh(a){const b=this.uH.nda(a),c=this.qQ(a,b),f=a.Bb(2);c&&f&&0<=b&&b<Wo.a.e8&&(this.Lt&&this.Lt.propertySet&&this.Lt.propertySet.Sa(hb.a.xx)||(va.a.J(512496284,820,50,"Get master defined line-spacing "),f.setValue(hb.a.xx,c.sa(hb.a.WKi,Jg.a.lineSpacing)),f.setValue(hb.a.nX,c.sa(hb.a.XKi,2))),this.Lt&&this.Lt.propertySet&&this.Lt.propertySet.Sa(hb.a.cea)||(va.a.J(512496283,820,50,"Get master defined line-spacing before"),
f.setValue(hb.a.cea,c.sa(hb.a.kLi,Jg.a.jqg)),f.setValue(hb.a.xla,c.sa(hb.a.lLi,4))),this.Lt&&this.Lt.propertySet&&this.Lt.propertySet.Sa(hb.a.aea)||(va.a.J(512496282,820,50,"Get master defined line-spacing after"),f.setValue(hb.a.aea,c.sa(hb.a.iLi,Jg.a.iqg)),f.setValue(hb.a.wla,c.sa(hb.a.jLi,4))));a.zc()}dPj(a){if(a.propertySet.Sa(Za.a.Ui)){const b=a.propertySet.eb(Za.a.Ui).length;if(1===b&&a.propertySet.Sa(Za.a.font)||3===b&&a.propertySet.Sa(hb.a.autonumberBulletType))return!0}return!1}Pcl(a){var b=
this.uH.nda(a);const c=this.qQ(a,b),f=a.Bb(2);c&&f&&0<=b&&b<Wo.a.e8&&(this.Lt&&this.Lt.propertySet&&this.Lt.propertySet.Sa(Va.a.$l)||(va.a.J(512496281,820,50,"Get master defined indent-left."),c.Sa(hb.a.r2b)&&f.setValue(Va.a.$l,c.eb(hb.a.r2b)),(b=this.Ea.en(f))&&b.ud&&f.setValue(Va.a.$l,c.sa(Va.a.$l,Jg.a.leftMargin))),this.Lt&&this.Lt.propertySet&&this.Lt.propertySet.Sa(Va.a.ho)||(va.a.J(512496280,820,50,"Get master defined firstline indent."),c.Sa(hb.a.q_d)&&f.setValue(Va.a.ho,c.eb(hb.a.q_d)),(b=
this.Ea.en(f))&&b.ud&&f.setValue(Va.a.ho,c.sa(Va.a.ho,Jg.a.leftMargin))));a.zc()}pWe(a){const b=this.uH.nda(a),c=this.qQ(a,b),f=a.Bb(4);c&&f&&0<=b&&b<Wo.a.e8&&(va.a.J(512496279,820,50,"Get master defined list marker"),c.Sa(Za.a.Ui)?(f.setValue(Za.a.Ui,c.eb(Za.a.Ui)),c.Sa(Za.a.font)?f.setValue(Za.a.font,c.eb(Za.a.font)):c.Sa(hb.a.autonumberBulletType)&&f.setValue(hb.a.autonumberBulletType,c.eb(hb.a.autonumberBulletType))):(f.setValue(Za.a.font,Pl.EBf),f.setValue(Za.a.Ui,[Pl.FTd])));a.zc()}n_c(a){return a?
16!==this.uH.N8d(a).tpe:!1}Dtb(){va.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");Nc.a.instance.Xb("FormattingNotCleared",{["Reason"]:od.a.sgg})}OXk(a){if(this.fM.$g(a)){var b=a.Bb(4);b&&(1===this.Ffc.gxb(b)&&b.removeProperty(hb.a.autonumberBulletType),a.zc())}}Ldl(a){this.fM.$g(a)&&(a=a.currentNode)&&a.setValue(hb.a.sSj,!0)}merge(a,b,c,f){const l=this.uH.nda(b),w=this.qQ(a,this.uH.nda(a)),H=this.qQ(b,l);w&&a&&(a.Bb(2),a.currentNode&&(a.currentNode.Sa(Va.a.$l)&&
w.Sa(Va.a.$l)&&!YA.APropertySet.MZa(Va.a.$l.type,a.currentNode.Mh(Va.a.$l),w.Mh(Va.a.$l))&&w.we(Va.a.$l,a.currentNode.Mh(Va.a.$l)),a.currentNode.Sa(Va.a.ho)&&w.Sa(Va.a.ho)&&!YA.APropertySet.MZa(Va.a.ho.type,a.currentNode.Mh(Va.a.ho),w.Mh(Va.a.ho))&&w.we(Va.a.ho,a.currentNode.Mh(Va.a.ho))),a.zc());super.merge(a,b,c);c&&this.mDb&&(this.oWe(a,l),this.Ldl(a),this.OXk(a));this.hdi(b,H,w);if(f&&(a.Bb(2),c=a.currentNode.sa(hb.a.lKa,""),a.zc(),c.length))for(a=this.Pb.a8d(b);a.Cf(1)&&a.currentNode!==f.currentNode;)a.Bb(2),
a.currentNode.setValue(hb.a.lKa,c),a.zc();return!0}Wci(a,b,c){const f=Rc.a.Ib;f&&(f.Oj=!0);this.xRd(a,b,c)}Ryl(a,b){var c=ob.GraphIterator.nb(b);this.Rf.qna(c);b=c.currentNode;c.zc();c=this.createList(a);a.zc();c.G7a(b,hb.a.shapeId,hb.a.txa)}SPa(a,b){this.xRd(a,b)}fwf(a,b,c){this.fM.$g(a)||Nc.a.instance.Xb("PossibleIndentNotAdjusted",{["Reason"]:od.a.Qca});const f=a.Bb(2),l=f.sa(Va.a.ho,Jg.a.indent),w=f.sa(Va.a.$l,Jg.a.leftMargin);this.MHa.Re(a);if(16===b)this.Qva.Bv.Vjb(f,0),0>l&&(Nc.a.instance.Xb("UnexpectedlyChangingLeftIdent",
{["Reason"]:"NegativeLeftIndent"}),this.Fi.Wjb(a,1,Math.max(w+l,0)));else{var H=this.qQ(a,this.uH.nda(a));H||(H=new K.DictionaryPropertySet,va.a.J(512496273,820,50,"listStyle is null"));var U=Jg.a.indent;let ja=Jg.a.leftMargin;c?{loe:ja,pee:U}=this.y3f(f,H,ja,U):(U=H.sa(Va.a.ho,Jg.a.indent),ja=H.sa(Va.a.$l,Jg.a.leftMargin));H=cf.a.NCa(H,null).listType;const wa=ja+(0<=U?0:U);U&&w+(0<=l?0:l)===wa&&H===b?(this.Qva.Bv.Vjb(f,U),this.Fi.Wjb(a,1,ja)):(U=l,H=w,{indent:U,margin:H}=this.lUd(this.M9a(f),b,l,
w,U,H),0<this.uH.nda(a)&&c&&(H+=ja),H=Math.max(Math.min(H,An.jEe),An.kEe),U=Math.max(Math.min(U,An.qee),An.ree),this.Qva.Bv.Vjb(f,U),this.Fi.Wjb(a,1,H))}}M9a(a){if(!a)return 0;a=this.Yl.Tka(a)?this.Yl.onj(this.Yl.rxb(a)):zb.ParagraphReader.Rja(a,Za.a.fontSize,0);return hj.AAf(a)}lUd(a,b,c,f,l,w){let H=(b=1===b)?.3125:.375;0<a&&(H=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);
a=-1*te.a.Wta(H);0>=c&&a<c?(w=a-c,l=c+w,w=f-w):0<c&&(l=a,w=f-a);return{indent:l,margin:w}}hdi(a,b,c){if(b&&c){Pa.OutlineElementNavigator.oi(a);var f=a.yq;if(zb.ParagraphReader.el(a)){b=b.sa(Za.a.fontSize,Or.fontSize);c=c.sa(Za.a.fontSize,Or.fontSize);for(let l=0;l<f.Ra.length;++l){const w=f.Ra.ga(l);w&&w.formatting&&w.formatting.Yz&&w.formatting.Yz.Sa(Za.a.fontSize)&&w.formatting.Yz.eb(Za.a.fontSize)===b&&this.mi.Pq(w.formatting,c)}}Pa.OutlineElementNavigator.Re(a)}}F8d(a){if(this.Cva){if(a=this.Rf.lw(a))a.fwb=
!0;return a}return super.F8d(a)}xRd(a,b,c=null){if(this.fM.$g(a)){this.odi(b,c,a);var f=a.Bb(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?cf.a.NCa(f,f).k0b():f=this.createList(a);a.zc();const l=a.Bb(2);a.zc();this.cfc&&l.sa(Yd.a.J$b,!1)||this.Cva&&b.fwb?f.G7a(b.propertySet,hb.a.shapeId,hb.a.txa,Va.a.listLevel,Za.a.Ui,Yd.a.jE):f.G7a(b.propertySet,hb.a.shapeId,hb.a.txa,Va.a.listLevel,hb.a.xFa);c&&c.Sa(hb.a.autonumberBulletType)&&f.setValue(hb.a.autonumberBulletType,c.eb(hb.a.autonumberBulletType));
this.Cva&&b.fwb&&b.dyb&&(3===b.z9.length&&b.propertySet.Sa(hb.a.autonumberBulletType)?(f.setValue(Za.a.Ui,b.z9),f.setValue(hb.a.autonumberBulletType,b.propertySet.eb(hb.a.autonumberBulletType)),va.a.J(512496267,826,50,"Support CCP customized number list")):1===b.z9.length&&b.P$a?(f.setValue(Za.a.Ui,b.z9),f.setValue(Za.a.font,b.font),va.a.J(512496266,826,50,"Support CCP customized bullet")):(va.a.J(512496265,826,50,"Set list use dst master liststyle."),this.pWe(a)))}else return;else a.Oi();b&&b.aZf||
(this.cfc?(c=this.Rf.lw(a),this.fwf(a,c?c.listType:16,b?b.fwb:!1)):this.fwf(a,b?b.listType:16,b?b.fwb:!1))}else va.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),Nc.a.instance.Xb("FailedToApplyListProperties",{["Reason"]:od.a.Qca})}odi(a,b,c){b&&a&&(1===a.listType||0===a.listType)&&(this.XL.ay(b,a.propertySet,this.H3c),c=this.qQ(c,this.uH.nda(c))||new K.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(Yd.a.eea,6),b.Sa(Za.a.Ui)||(a.propertySet.setValue(Za.a.font,
Pl.EBf),a.propertySet.setValue(Za.a.Ui,[Pl.FTd]),c.Sa(Za.a.Ui)&&(b=c.eb(Za.a.Ui)[0],b!==Pl.VZd&&b!==Pl.fJa&&this.XL.ay(c,a.propertySet,this.H3c)))))}qQ(a,b){this.fM.$g(a)||Nc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:od.a.Qca});a=this.mnj(a);return a?this.mdj(a,1+b):(va.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),Nc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:od.a.zIf}),null)}mnj(a){a=ob.GraphIterator.UG(a);a.G6(jj.OutlineReader.F$b);const b=a.Sw(16);
return b?b:a.Q1a()}gxb(a){return this.uH.N8d(a).tpe}lsh(a,b,c){c||0!==b.listType||(b.yA=a.sa(Za.a.EVa,rk.a.Nw))}zLc(a,b){this.XL.oCi(a,b,this.L8c)}}Object(n.a)(tL,"ListEditor",Vp,[302,303]);class ct{constructor(a,b){this.j_b=a;this.Jsb=b}}Object(n.a)(ct,"BulletMarker",null,[]);class dt{constructor(a,b){this.HBf=a;this.E1g=b}}Object(n.a)(dt,"ListMarkerPreview",null,[]);class et{constructor(a,b,c){this.u1g=a;this.A1g=b;this.JSd=c}}Object(n.a)(et,"NumberingMarker",null,[]);class uL{constructor(a,b){this.Pb=
a;this.PFb=b;this.ock=new kc.a(Object(F.a)(this,this.AFi,"createListBulletDictionary"));this.tck=new kc.a(Object(F.a)(this,this.HFi,"createListNumberingDictionary"));this.sck=new kc.a(Object(F.a)(this,this.FFi,"createListMarkerPreviewDictionary"));this.qck=new kc.a(Object(F.a)(this,this.EFi,"createListMarkerAltTextDictionary"))}AFi(){const a=new qd.a;a.$(3,new ct(8226,"Arial"));a.$(4,new ct(111,"Courier New"));a.$(5,new ct(167,"Wingdings"));a.$(6,new ct(113,"Wingdings"));a.$(7,new ct(118,"Wingdings"));
a.$(8,new ct(216,"Wingdings"));a.$(9,new ct(252,"Wingdings"));return a}HFi(){const a=new qd.a;a.$(11,new et(0,".",8));a.$(12,new et(0,")",7));a.$(13,new et(1,".",15));a.$(14,new et(3,".",5));a.$(15,new et(4,")",2));a.$(16,new et(4,".",4));a.$(17,new et(2,".",14));return a}FFi(){const a=new qd.a;a.$(1,new dt("\u2022",["1.","2.","3."]));a.$(2,new dt("o",["1)","2)","3)"]));a.$(3,new dt("\uf0a7",["I.","II.","III."]));a.$(4,new dt("\uf071",["A.","B.","C."]));a.$(5,new dt("\uf076",["a)","b)","c)"]));a.$(6,
new dt("\uf0d8",["a.","b.","c."]));a.$(7,new dt("\uf0fc",["i.","ii.","iii."]));return a}EFi(){const a=new qd.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);
a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);return a}get AVa(){return this.ock.value}get Eed(){return this.tck.value}get k2c(){return this.sck.value}get rqg(){return this.qck.value}Cyf(a,b){const c=this.Pb.Mc(a);c.set(a);
for(a=c.Bb(1);a;){var f=c.Bb(4);if(f){if(1===b){if(1!==f.sa(Yd.a.jE,16))return!1}else if(2===b){if(0!==f.sa(Yd.a.jE,16))return!1}else if(a=f.sa(Za.a.Ui,null),this.PFb.RYc(b)){f=f.sa(Za.a.font,"");const l=this.AVa.ga(b);if(!a||1!==a.length||l.j_b!==a[0]||l.Jsb!==f)return!1}else if(this.PFb.SYc(b)){if(f=this.Eed.ga(b),!a||3!==a.length||f.u1g!==a[1]||f.A1g!==ha.a.fromCharCode(a[2]))return!1}else return!1;c.zc()}else if(0!==b)return!1;a=c.Cf(1)}return!0}RYc(a){return this.PFb.RYc(a)}SYc(a){return this.PFb.SYc(a)}$6b(a){return this.PFb.$6b(a)}cVc(a){return this.PFb.cVc(a)}}
Object(n.a)(uL,"PptListMarkersLoader",null,[306,305]);class vL{KIl(a,b){if(!a)return!1;b.Bb(2);a=b.currentNode.sa(Yd.a.J$b,!1);b.zc();return!a}}Object(n.a)(vL,"PptMergeListEditorInOutlineElementStrategy",null,[307]);class Wz{constructor(){this.Mmi=[0,3,4,5,6,7,8,9];this.brk=[0,11,12,13,14,15,16,17]}RYc(a){return 3<=a&&9>=a}SYc(a){return 11<=a&&17>=a}$6b(a){return Wz.H8f(a,this.Mmi,1)}cVc(a){return Wz.H8f(a,this.brk,2)}static H8f(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(n.a)(Wz,"TextBulletTypeHelper",
null,[305]);class TD{get name(){return"PowerPointWebEditor.ListEditor"}Zb(a){a.register(302,"PowerPointWebEditor.IPptListEditor").ma().oa(()=>new tL(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),
a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(303,"Box4.List.IListEditor").ma().oa(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(304,"PowerPointWebEditor.IPptListCore").ma().oa(()=>new sL(a.resolve("PowerPointWebEditor.ISlideReader"),
a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(305,"PowerPointWebEditor.ITextBulletTypeHelper").ma().oa(()=>new Wz);a.register(306,"PowerPointWebEditor.IPptListMarkersLoader").ma().oa(()=>new uL(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(307,"Box4.IMergeListEditorInOutlineElementStrategy").ma().oa(()=>new vL)}init(){}dispose(){}static main(){v.a.instance.Dc(new TD)}}
Object(n.a)(TD,"PPTWebEditorListEditorPackage",null,[2,3]);var eR=d(888);class wL{tk(a){return hd.TableReader.tk(a)}Ci(a){return hd.TableReader.Ci(a)}xUc(a,b,c){return hd.TableReader.xUc(a,b,c)}Lu(a){return hd.TableReader.Lu(a)}zbb(a){return hd.TableReader.zbb(a)}Cs(a){return hd.TableReader.Cs(a)}KN(a){return hd.TableReader.KN(a)}}Object(n.a)(wL,"TableReaderProxy",null,[1132]);class xL{Akg(){return ok.j(void 0)}Nij(a){return ok.c(a)}}Object(n.a)(xL,"TableRowReaderProxy",null,[1131]);class yL extends dh.a{constructor(a,
b,c,f,l){super(a,b);this.dWh=l;this.LK=f;a=l&&this.gb.sa(Va.a.skippedCell,!1);b=this.Nd.jp(Ga.a.td);this.nc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.LK.nr?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText="\u00a0";this.GPf()}NU(){return Kj.a.Rjc}Ny(){this.dWh&&this.gb.sa(Va.a.skippedCell,!1)&&this.hfl()}hfl(){this.LK.nr&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft=
"",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(n.a)(yL,"GhostTableCellViewElement",dh.a,[1189,494,346,106]);class zL{constructor(a,b,c){this.uMd=a;this.LK=b;this.Pnb=c}create(a,b){return Ie.isGhostCellNode(b.node)?Ie.shouldRenderGhostCellNode(b.node)?new yL(a,b,this.uMd,this.LK,R.a.instance.ga(63),R.a.instance.ga(77)):null:this.Pnb.create(a,b)}}Object(n.a)(zL,"GhostTableCellViewElementFactory",null,[381]);class AL{constructor(a,b,c){this.yc=a;this.Zea=b;this.kNg=
c;this.VF=null;this.FCb=this.GCb=-1}Ifl(a,b=null){this.Kfl(a);this.VF&&this.ccl(b)}Oui(){this.VF=null;this.FCb=this.GCb=-1}A0f(a,b,c){if(!a||!this.VF)return{row:b,column:c};var f=this.Zea.HWf(a,this.VF,this.kNg.mJc,this.kNg.lJc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.ui;l===b||this.Zea.bZc(a,this.VF)||(l=b);var w=0,H=this.yc.Ci(this.VF)-1;let U=0,ja=this.yc.tk(this.VF)-1;this.Zea.bZc(a,this.VF)&&b>=U&&b<=ja&&c>=w&&c<=H&&(a=(w=(w=this.VF.nf(b,c))?w.az():null)?w.rowSpan:0,H=w?w.colSpan:0,
w=c,H=c+H-1,U=b,ja=b+a-1);l>=U&&l<=ja&&f>=w&&f<=H&&(b=l,c=f);return{row:b,column:c}}Yok(a){a=this.t8f(a);return!!a&&14===a.type&&a.Np()}udi(a,b,c,f,l,w){if(!this.VF||!a||14!==a.type||this.VF!==a||!b)return{jZf:c,ZYf:f,dDh:l,aDh:w};this.VF.nf(c,f).isControllingCell&&({rowIndex:c,ija:f}=this.zaj(c,f));if(this.VF.nf(l,w).isControllingCell||!this.Zea.bZc(b,this.VF))({row:l,column:w}=this.A0f(b,l,w));va.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{jZf:c,ZYf:f,dDh:l,aDh:w}}Kfl(a){(a=
this.t8f(a))&&14===a.type&&(this.VF=a)}t8f(a){return 1074135132===a.Ue&&a.ud?this.yc.NN(a):this.yc.V6b(a)}ccl(a){this.VF&&a&&({row:this.GCb,column:this.FCb}=this.A0f(a,this.GCb,this.FCb))}zaj(a,b){if(!this.VF)return{rowIndex:a,ija:b};let c=null;0<=a&&a<this.yc.tk(this.VF)&&0<=b&&b<this.yc.Ci(this.VF)&&(c=this.VF.nf(a,b));this.bPj(c)&&(a=this.GCb,b=this.FCb);return{rowIndex:a,ija:b}}bPj(a){if(!this.VF)return!1;let b=0;var c=this.yc.Ci(this.VF)-1;let f=0;var l=this.yc.tk(this.VF)-1;if(a){l=a.rowIndex;
c=a.ui;const w=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+w-1}return this.GCb>=f&&this.GCb<=l&&this.FCb>=b&&this.FCb<=c}}Object(n.a)(AL,"PptTableDragSelectionCellExtendStrategy",null,[289]);var BL=d(836),Zm=d(243);class CL{constructor(){this.BWc=this.colSpan=this.snd=0}}Object(n.a)(CL,"HeightInfo",null,[]);class DL{constructor(){this.xQa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.Lbg=this.ocg=this.ekg=this.gkg=this.fkg=!1}}Object(n.a)(DL,"TableCellInfo",null,
[]);class EL{constructor(){this.tPh=[]}get cells(){return this.tPh}OOd(a){this.cells.push(a)}}Object(n.a)(EL,"TableRowInfo",null,[]);class FL{constructor(){this.xQa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.tjg=this.zkg=this.yjg=!1}}Object(n.a)(FL,"UpdateInfo",null,[]);var fR=d(1073),GL=d(559);class Iv extends GL.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){super(a,b,eb);this.YNa=!1;this.E3a=this.Nnf=this.pKd=this.D3a=this.uGa=null;this.OGd=0;this.wri=1;this.sri=16;
this.jri=256;this.mri=4096;this.vri=65536;this.Vzc=this.nAc=this.xAc=this.GAc=!1;this.b9e=this.Bqf=this.HDc=this.ZAc=this.dha=0;this.pse=this.qse=null;this.r2h=Object(qa.a)(126,b);this.Kba=c;this.$ba=Ub;this.hd=Sa;this.WV=ub;this.LK=wa;this.OEc=U;this.Wha=ja;this.Vha=H;this.sr=w;this.b7c=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Nd.jp(Ga.a.td);this.nc(a);this.pZ=this.Nd.jp(Ga.a.div);a.appendChild(this.pZ);this.pZ.className="TableCellContent";
this.Xo(this.pZ)}v5b(){return this.pZ.offsetHeight+this.pZ.offsetTop}Muc(a,b,c,f){a=this.YNa?a:a+c;this.uGa||(this.uGa=this.QLc());this.uGa.style.left=a-2.5+"px";this.uGa.style.top=b+"px";this.uGa.style.height=f+"px"}FLf(){const a=this.Nd.jp(Ga.a.div);Hf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);return a}QLc(){const a=this.FLf();a.className="TableColumnResizeHandle";return a}XYd(){const a=this.Nd.jp(Ga.a.div);Hf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
a.className=ng.a.vXk;return a}sEl(a,b,c,f){f?(a=this.YNa?a:a+b,this.D3a||(this.D3a=this.FDi()),b=this.D3a.style,b.top=c+"px",b.left=a+"px"):this.D3a&&(this.TFf(this.D3a,!1),this.D3a=null);return this.D3a}FDi(){const a=this.XYd(),b=this.Nd.jp(Ga.a.div);Hf.c(b,!0);b.className=ng.a.efe;a.appendChild(b);return a}XGl(a,b,c,f){this.PTi();const l=this.pKd.style;l.top=c+"px";l.left=f+"px";c=this.Nnf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}PTi(){if(!this.pKd){const a=this.XYd(),b=this.Nd.jp(Ga.a.div);
Hf.c(b,!0);b.className=ng.a.Afg;a.appendChild(b);this.pKd=a;this.Nnf=b}}aHl(a,b,c){c?(this.E3a||(this.E3a=this.yHi()),c=this.E3a.style,c.top=a+b-10+"px",this.YNa?c.right="-15px":c.left="-15px"):this.E3a&&(this.TFf(this.E3a,!0),this.E3a=null);return this.E3a}yHi(){const a=this.XYd(),b=this.Nd.jp(Ga.a.div);Hf.c(b,!0);b.className=ng.a.ffe;a.appendChild(b);return a}kih(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}TFf(a,b){b?Zm.a.bui(a):Zm.a.Yti(a);this.htmlElement.removeChild(a)}lkg(a){a=
a?D.a.eua:u.AFrameworkApplication.isRtl?D.a.pab:D.a.iUa;return 8!==u.AFrameworkApplication.Ta.pi(Id.a.create(this.gb),a,1,!0,new fR.a,null)}NU(a){super.NU(a);const b=super.NU(a);this.OGd=this.Pmj(a);if(this.$ba.qx&&!this.Qc.Wl){var c=Ke.a.nb(a.b2,a.currentNode);c.Ze();this.Vha.Re(c);a=this.OEc.getContainingTable(a);this.Wha.$g(c)&&a&&!this.sr.CCa(a)&&(c=c.Xq)&&c.htmlElement&&this.Kba.dKf(c.htmlElement,a,this.Ma)}return new Kj.a(b.mna+this.ZAc+yn.a.mlb,Math.max(b.minWidth,this.OGd),b.nna+this.HDc+
yn.a.mlb)}Pmj(a){return hd.TableReader.Ezb(a)?(a=this.$ba.ule?this.gb.sa(eh.a.WUd,1):1,a*yn.a.n1e+(a-1)*(this.ZAc+this.HDc+yn.a.mlb)):yn.a.n1e}L6(a){this.pZ.style.paddingLeft=a.mna-yn.a.mlb+"px";this.pZ.style.paddingRight=a.nna-yn.a.mlb+"px";this.$ba.E_c&&this.$ba.ule&&(this.pZ.style.minWidth=this.OGd+"px")}Yaa(a){this.UD(this.pZ,a,1)}Ny(){this.iHh();this.Bqh();var a=ob.GraphIterator.nb(this.gb);a.rc(14);const b=Rd.getContainingTable(a),c=Ie.isFirstCellInColumn(a);a=Ie.isFirstCellInRow(a);let f="";
c&&Iv.Sng(b,32)&&(f="columnheader");a&&!c&&Iv.Sng(b,128)&&(f="rowheader");""!==f?Fb.d(this.htmlElement,ua.a.role,f):this.htmlElement.removeAttribute(Bc.a.af);this.hd&&this.hd.lFa(65)&&(this.gb.b1b?Sys.UI.DomElement.addCssClass(this.htmlElement,jc.Z3):Sys.UI.DomElement.removeCssClass(this.htmlElement,jc.Z3));this.LK.nr&&(this.htmlElement.style.border="",this.U2k(),this.Bal(b),this.htmlElement.style.verticalAlign=this.LK.nr.T5i(this.gb));this.Cel();this.$ba.E_c&&this.$ba.ule&&(this.gb.Sa(eh.a.GEf)?
this.qsh():this.htmlElement.removeAttribute("rowspan"),this.gb.Sa(eh.a.WUd)?this.Gqh():this.htmlElement.removeAttribute("colspan"));this.Qc.Wl&&this.$ba.UWj&&(this.htmlElement.style.width=this.Nd.Md.Pe(this.r2h.width,0)+"px")}Cel(){if(this.$ba.zTj||this.$ba.cZj)this.gb.Jce?this.qsh():this.htmlElement.removeAttribute("rowspan"),this.gb.L$a?this.Gqh():this.htmlElement.removeAttribute("colspan")}iHh(){let a=null;if(this.hd&&this.hd.lFa(65)){var b=ob.GraphIterator.nb(this.gb);b.rc(15);b=b.Sw(15);if(b.duc){Sys.UI.DomElement.addCssClass(this.htmlElement,
jc.EBh);return}if(b.Rtd){Sys.UI.DomElement.addCssClass(this.htmlElement,jc.HBh);return}}this.gb.Sa(Za.a.JJc)?(a=tc.a.xI(this.gb.sa(Za.a.JJc,tc.a.nil)),this.dha|=this.vri):this.$ba.wWj&&this.LK.nr&&(a=this.LK.nr.o0f(this.gb));a=a||"transparent";this.htmlElement.style.backgroundColor=a;"transparent"!==a&&4.5>tc.a.L6i(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.hd&&this.hd.lFa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,
jc.EBh),Sys.UI.DomElement.removeCssClass(this.htmlElement,jc.HBh))}qsh(){Fb.d(this.htmlElement,ua.a.rowSpan,this.$ba.E_c?this.gb.sa(eh.a.GEf,1):this.gb.rowSpan)}Gqh(){Fb.d(this.htmlElement,ua.a.colSpan,this.$ba.E_c?this.gb.sa(eh.a.WUd,1):this.gb.colSpan)}U2k(){this.Vzc=this.xAc=this.nAc=this.GAc=!1}Bal(a){this.LK.nr&&(this.Fcl(),this.htmlElement.style.border="0px none",this.NLb(this.gb,a,7),this.NLb(this.gb,a,5),this.NLb(this.gb,a,0),this.NLb(this.gb,a,6),this.b7c&&(this.NLb(this.gb,a,2),this.NLb(this.gb,
a,1)),Fb.d(this.htmlElement,ua.a.c_d,this.dha),this.$0k())}Bqh(){var a=new ob.GraphIterator;a.set(this.gb);a.rc(14);a.Jg(14);a=a.currentNode;this.ZAc=yn.a.ZUc(this.gb,a,Va.a.$Nb,this.LK.nr,Va.a.kvl,0);this.HDc=yn.a.ZUc(this.gb,a,Va.a.bOb,this.LK.nr,Va.a.mvl,0);this.Bqf=yn.a.ZUc(this.gb,a,Va.a.cOb,this.LK.nr,Va.a.nvl,1);this.b9e=yn.a.ZUc(this.gb,a,Va.a.ZNb,this.LK.nr,Va.a.gvl,1);this.pZ.style.paddingLeft=this.ZAc+"px";this.pZ.style.paddingRight=this.HDc+"px";this.pZ.style.paddingTop=this.Bqf+"px";
this.pZ.style.paddingBottom=this.b9e+"px"}Fcl(){var a=ob.GraphIterator.nb(this.gb);a.rc(14);a=this.OEc.getContainingTable(a);this.YNa=hd.TableReader.um(a)}NLb(a,b,c){this.WV&&this.WV.JLj(b);a=this.LK.nr.d$i(a,c);b=a.Tji;const f=a.frj;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,f),c){case 7:this.htmlElement.style.borderTop=b;this.b_c(b)&&(this.GAc=!0);a.KNc&&(this.dha|=this.wri);break;case 5:this.wqh(5,b);this.b_c(b)&&(this.nAc=!0);a.KNc&&(this.dha|=this.mri);break;case 0:this.htmlElement.style.borderBottom=
b;this.b_c(b)&&(this.Vzc=!0);a.KNc&&(this.dha|=this.jri);break;case 6:this.wqh(6,b);this.b_c(b)&&(this.xAc=!0);a.KNc&&(this.dha|=this.sri);break;case 2:this.qse=b;break;case 1:this.pse=b}}b_c(a){return!a||a.startsWith("0px none")?!1:!0}wqh(a,b){if(5===a&&!this.YNa||6===a&&this.YNa)this.htmlElement.style.borderLeft=b;if(5===a&&this.YNa||6===a&&!this.YNa)this.htmlElement.style.borderRight=b}$0k(){if(this.Dkl()){var a=ob.GraphIterator.nb(this.gb);if(a.rc(14)){var b=Ie.isFirstCellInRow(a),c=Ie.isLastCellInRow(a);
this.GAc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.GAc=!0);this.Vzc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.Vzc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.Sw(14);a=!hd.TableReader.um(a);this.nAc||(this.htmlElement.style.borderLeft=a?b:c,this.nAc=!0);this.xAc||(this.htmlElement.style.borderRight=a?c:b,this.xAc=!0)}}}Dkl(){const a=this.Qc;return a.Nh&&a.features.Lkl?!0:!1}get mja(){return this.pZ}iK(a){super.iK(a);
this.AU()}AU(){if(!this.Nd.Wl&&this.hB){const a=Object(qa.a)(1119,this.IR);a&&a.LYg(this.pZ)}}get Ktb(){return this.uGa}static Sng(a,b){return null!==a&&a.Sa(Va.a.tableLook)?!!(a.properties.eb(Va.a.tableLook)&b):!1}}Object(n.a)(Iv,"TableCellViewElement",GL.a,[1183,494,346,106]);class im extends dh.a{constructor(a,b,c,f=null){super(a,b);this.dS=null;this.Dwc=!0;this.Dm=[];this.jv=[];this.AFc=this.zG=null;this.m$e=this.Mnf=0;im.DVa=c;this.WV=f;b=this.Nd.jp(Ga.a.div);b.className="TableContainer";this.ek=
this.Nd.jp(Ga.a.table);b.appendChild(this.ek);this.ek.className="Table";Sys.UI.DomElement.addCssClass(this.ek,im.Fsd);this.vrf=a;this.uBa=this.Nd.jp(Ga.a.div);this.uBa.id=ia.a.create().toString();this.uBa.className=im.Qul;this.uBa.setAttribute(Bc.a.SK,Bc.a.jC);b.insertBefore(this.uBa,this.ek);Hf.c(this.uBa,!0);a.Wl&&Fb.d(this.ek,ua.a.border,this.gb.sa(Za.a.llb,!0)?"1":"0");this.nc(b);a.Wl||(this.dS=this.Nd.jp(Ga.a.ewi),this.ek.appendChild(this.dS));this.BS=this.Nd.jp(Ga.a.XBh);this.ek.appendChild(this.BS);
this.Xo(this.ek)}get L1(){return this.BS}get table(){return this.ek}get MKc(){return this.dS}Ny(a){this.ek.style.borderCollapse="collapse";if(mb.StyleReader.nr)Sys.UI.DomElement.removeCssClass(this.ek,im.Fsd),Sys.UI.DomElement.removeCssClass(this.ek,im.q1e);else{var b=this.gb.sa(Za.a.llb,!0);b&&!this.Dwc?(Sys.UI.DomElement.removeCssClass(this.ek,im.q1e),Sys.UI.DomElement.addCssClass(this.ek,im.Fsd),this.Dwc=!0):!b&&this.Dwc&&(Sys.UI.DomElement.removeCssClass(this.ek,im.Fsd),Sys.UI.DomElement.addCssClass(this.ek,
im.q1e),this.Dwc=!1)}R.a.instance.ga(71)&&mb.StyleReader.nr&&(Fb.d(this.ek,ua.a.e_d,"Custom"),Fb.d(this.ek,ua.a.d_d,0));var c=this.dS?hd.TableReader.Ci(this.gb):0;b=this.dS?c-this.dS.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Nd.jp(Ga.a.col);this.dS.appendChild(l)}for(f=0;f>b;--f)this.dS.removeChild(this.dS.firstChild);f=xn.b(this.gb);var w=0;this.WV&&(w=this.WV.f$d(this.gb));l=Array(c);var H=!0;b=0;for(var U=0;U<c;++U){let ja=this.O8(U);0<=f[U]?(l[U]=Math.max(ja,this.Nd.Md.Pe(f[U],0)-w),
this.dS.childNodes[U].style.width=l[U]+"px",b+=l[U]):(l[U]=-1,H=!1,this.dS.childNodes[U].style.width="",b+=ja)}if(R.a.instance.ga(63)||R.a.instance.ga(77))H?Sys.UI.DomElement.addCssClass(this.ek,im.$Kh):Sys.UI.DomElement.removeCssClass(this.ek,im.$Kh);if(this.Dm.length===c)for(w=this.dSc(),H=0;H<c;++H)U=this.O8(H),this.Dm[H].childNodes[w].style.width=0<=f[H]?Math.max(U,l[H])+"px":U+"px";c=hd.TableReader.um(this.gb);if(this.gb.Sa(Za.a.Jl))switch(hd.TableReader.KN(this.gb)){case 1:this.ek.style.marginLeft=
"";this.ek.style.marginRight="auto";break;case 2:this.ek.style.marginLeft="auto";this.ek.style.marginRight="auto";break;case 3:this.ek.style.marginLeft="auto";this.ek.style.marginRight="";break;case 14:this.ek.style.marginLeft=c?"auto":"";this.ek.style.marginRight=c?"":"auto";break;case 15:this.ek.style.marginLeft=c?"":"auto";this.ek.style.marginRight=c?"auto":"";break;default:this.ek.style.marginLeft="",this.ek.style.marginRight=""}else this.ek.style.marginLeft="",this.ek.style.marginRight="",R.a.instance.ga(63)&&
this.gb.Sa(Va.a.$l)&&(f=({unit:a}=hd.TableReader.gka(a)).returnValue,a=(new nv.a(a,f)).OPb+"px",c?this.ek.style.marginRight=a:this.ek.style.marginLeft=a);(R.a.instance.ga(71)||R.a.instance.ga(77))&&this.Gfl(mb.StyleReader.nr,this.gb,this.ek);this.gb.properties.sa(Za.a.Zhg,!1)?(Sys.UI.DomElement.addCssClass(this.ek,im.sIf),Fb.d(this.ek,ua.a.Xgi,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.ek,im.sIf),this.ek.removeAttribute(Bc.a.Jra));(a=hd.TableReader.oae(this.gb))&&this.ek.setAttribute("title",
a);(a=hd.TableReader.nae(this.gb))?this.vrf.Wl&&1===this.vrf.mode?this.ek.removeAttribute(Bc.a.Jra):(this.uBa.innerText=a,this.ek.setAttribute(Bc.a.Jra,this.uBa.id)):(this.uBa.innerText="",this.ek.removeAttribute(Bc.a.Jra));id.a.instance.Vj&&!R.a.instance.ga(30)&&(this.ek.style.width="0px");R.a.instance.ga(30)&&(this.ek.style.minWidth=b+"px");this.Fal();this.Lfl()}Fal(){if(this.WV){const a=this.WV.tPl(this.gb);""!==a&&(this.ek.style["border-spacing"]=a);this.sje&&(this.ek.style.borderCollapse="separate")}}get sje(){return!!this.WV&&
this.WV.JLj(this.gb)}y6d(a){return this.WV?this.WV.FOl(this.gb,a):0}Lfl(){this.ek.style.borderTop="";this.ek.style.borderBottom="";this.ek.style.borderLeft="";this.ek.style.borderRight=""}O8(a){return(mb.StyleReader.nr?mb.StyleReader.nr.O8(this.gb,a):yn.a.Isd)+(this.WV?this.WV.f$d(this.gb):0)}Gfl(a,b,c){a&&(c.style.background=a.Wmj(b))}Yaa(a){this.UD(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.ek&&(this.Foc(this.htmlElement,this.ek),this.htmlElement.appendChild(this.ek));
this.UD(this.BS,a,1);let b=!1;this.BS.firstChild!==this.zG&&(this.zG=this.BS.firstChild,b=!0);R.a.instance.ga(30)&&hd.TableReader.Lu(a.currentNode)||!this.dS||(u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?(a=!1,(this.Dm&&this.Dm.length?this.Dm[0].parentNode:null)!==(this.zG?this.zG.firstChild:null)&&(a=!0),this.hkh(b||a)):this.R0k(b),Zm.a.Ev||this.bSe(b))}dSc(){let a=1;(R.a.instance.ga(63)||R.a.instance.ga(30))&&hd.TableReader.Lu(this.gb)&&(a=0);return a}dispose(){R.a.instance.ga(50)&&
Pc.App.Jh&&Pc.App.Jh.vw&&this.gih();this.jv=this.Dm=this.ek=this.BS=this.dS=this.uBa=this.zG=null;super.dispose()}NU(a){var b=xn.b(this.gb),c=null;if(a.Bb(1)){do{var f=a.Xq.sLa;c=c?xv.Bwi(c,f):f.copy()}while(a.Fj(1))}c||(c=new xv(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.Fqh(f,Math.max(c.U6i(f),this.Nd.Md.Pe(b[f],0)));b=yn.a.mlb;c=new Kj.a(b,Math.max(0,c.Zmk()-2*b),b);b=new ob.GraphIterator;b.set(this.gb);f=!1;b.rc(16)&&(f=!0);c=f?new Kj.a(0,c.total,0):new Kj.a(c.mna,c.minWidth,c.nna);a.Bb(88)&&
(c=Kj.a.max(c,a.Xq.sLa),a.zc());return c}WIj(){this.gih();this.Dm=[];this.jv=[]}gih(){if(this.jv)for(var a=0;a<this.jv.length;++a)T.a.rKa(this.jv[a]),za.a.$O(this.jv[a]);if(this.Dm)for(a=0;a<this.Dm.length;++a)T.a.rKa(this.Dm[a]),this.jv&&this.jv[a]&&this.jv[a].parentNode&&za.a.$O(this.Dm[a])}hkh(a){if(this.Dm&&this.zG&&this.zG.firstChild){var b=B.a.px||B.a.vo?"":" 16 20",c=String.format("url('{0}'){1}, pointer",Ey.a.box4Image("ColumnSelect.cur"),b);b=xn.b(this.gb);var f=b.length,l=this.zG.firstChild;
if(a){a=Math.min(f,this.Dm.length);for(var w=0;w<a;w++)l.insertBefore(this.Dm[w],l.firstChild)}if(f>this.Dm.length)for(a=this.Dm.length;a<f;a++){w=this.Nd.createElement("div");w.className="TableColumnHandleAnchor";Hf.c(w,!0);Array.add(this.Dm,w);var H=this.Nd.createElement("div");H.className=Zm.a.p1e;H.style.cursor=c;w.appendChild(H);H=this.Nd.createElement("div");H.className="TableColumnWidthSpacer";w.appendChild(H);l.insertBefore(this.Dm[a],l.firstChild)}if(f<this.Dm.length){for(c=f;c<this.Dm.length;c++)T.a.rKa(this.Dm[c]),
za.a.$O(this.Dm[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.Dm[l]);this.Dm=c}c=this.dSc();l=0;for(a=0;a<f;a++)w=this.O8(a),w=Math.max(w,this.Nd.Md.Pe(b[a],0)),this.Dm[a].childNodes[c].style.width=w+"px",this.Dm[a].style.left=l+"px",this.Dm[a].setAttribute("ColumnIndex",a.toString()),l+=w}}R0k(a){var b=B.a.px||B.a.vo?"":" 16 20";b=String.format("url('{0}'){1}, pointer",Ey.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.zG.firstChild;var c=Math.min(this.zG.childNodes.length,this.Dm.length);for(var f=
0;f<c;++f)a.insertBefore(this.Dm[f],a.firstChild),a=a.nextSibling}a=this.zG.childNodes.length;if(a>this.Dm.length){c=this.zG.firstChild;for(f=0;f<this.Dm.length;++f)c.insertBefore(this.Dm[f],c.firstChild),c=c.nextSibling;for(f=this.Dm.length;f<a;++f){const w=this.Nd.createElement("div");w.className="TableColumnHandleAnchor";Hf.c(w,!0);Array.add(this.Dm,w);var l=this.Nd.createElement("div");l.className=Zm.a.p1e;l.style.cursor=b;w.appendChild(l);l=this.Nd.createElement("div");l.className="TableColumnWidthSpacer";
w.appendChild(l);c.insertBefore(w,c.firstChild);c=c.nextSibling}}else if(a<this.Dm.length){for(b=a;b<this.Dm.length;++b)T.a.rKa(this.Dm[b]),za.a.$O(this.Dm[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.Dm[c]);this.Dm=b;b=this.zG.firstChild;for(a=0;a<this.Dm.length;++a)b.insertBefore(this.Dm[a],b.firstChild),b=b.nextSibling}b=this.dSc();a=xn.b(this.gb);for(c=0;c<this.Dm.length;++c)f=this.O8(c),this.Dm[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Nd.Md.Pe(a[c],0))+"px":f+"px"}bSe(a){if(!this.jv.length){a=
this.Nd.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Nd.createElement("div");b.className=Zm.a.Msd+" Last";a.appendChild(b);Array.add(this.jv,a);Hf.c(a,!0);a=!0}if(a){a=Math.min(this.jv.length,this.zG.childNodes.length);for(b=1;b<a;++b){var c=this.zG.childNodes[b];c.insertBefore(this.jv[b],c.firstChild)}(a=this.zG.lastChild)?a.insertBefore(this.jv[0],a.firstChild):ka.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.zG.childNodes.length;
if(a>this.jv.length){for(b=1;b<this.jv.length;++b)c=this.zG.childNodes[b],c.insertBefore(this.jv[b],c.firstChild);for(b=this.jv.length;b<a;++b){c=this.Nd.createElement("div");c.className=Zm.a.Msd;Hf.c(c,!0);Array.add(this.jv,c);let f=this.zG.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.zG.lastChild;a.insertBefore(this.jv[0],a.firstChild)}else if(a<this.jv.length){for(b=a;b<this.jv.length;++b)T.a.rKa(this.jv[b]),za.a.$O(this.jv[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.jv[c]);this.jv=b;for(a=
1;a<this.jv.length;++a)b=this.zG.childNodes[a],b.insertBefore(this.jv[a],b.firstChild);(a=this.zG.lastChild)?a.insertBefore(this.jv[0],a.firstChild):ka.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}MUe(a,b){let c=-1;if(hd.TableReader.um(this.gb))if(b<=Sys.UI.DomElement.getLocation(this.BS.firstChild.lastChild).x)c=this.BS.firstChild.childNodes.length-1;else for(var f=0;f<this.BS.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.BS.firstChild.childNodes[f]);
if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.BS.firstChild.firstChild).x)c=0;else for(f=this.BS.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.BS.firstChild.childNodes[f]),b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=ob.GraphIterator.nb(this.gb);const w=new ob.GraphIterator;b=new qf.GraphTransaction(2);b.Iy(l);Rd.moveToFirstRow(l);Rd.moveToColumnByIndex(l,a);w.Rc(l);Rd.moveToColumnByIndex(w,c);do(a=Od.SelectionFactory.rMc(l,w))&&Array.add(f,a),
Rd.moveToNextRow(w);while(Rd.moveToNextRow(l));a=new wc.SelectionCollection(f,f.length-1,0);this.Qc.Mb.RE(a);b.dispose()}Pqc(a,b){const c=this.dSc();this.Dm&&a<this.Dm.length&&this.Dm[a]&&(this.Dm[a].childNodes[c].style.width=Math.max(this.O8(a),b)+"px");this.dS.childNodes[a].style.width=Math.max(1,b)+"px"}t8i(a){return this.BS.firstChild.childNodes[a]?this.BS.firstChild.childNodes[a].offsetWidth:(ka.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",
a,this.BS.childNodes.length,this.BS.firstChild.childNodes.length),0)}kSc(a){a=parseInt(this.dS.childNodes[a].style.width);return isNaN(a)?yn.a.n1e:a}L6(a){super.L6(a);R.a.instance.ga(63)&&this.ZGl();this.Y5e()}Y5e(){this.AFc||(this.AFc=new Le.a(3,1,0,Object(F.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),u.AFrameworkApplication.ye.Db(this.AFc))}updateTableDOMElements(){this.AFc=null;this.L1&&(R.a.instance.ga(63)?this.sMk(this.uSk()):Zm.a.Ev&&this.rNe(this.i$d()),u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&
this.hkh(!1))}evd(){this.j1k()}U5i(a){return a.offsetWidth+this.y6d(0)/2}i$d(){const a=this.jTa(),b=a.length,c=[];let f=0,l=!1;const w=hd.TableReader.Lu(this.gb);for(let U=0;U<b;U++){const ja=a[U];if(w){let Sa;({und:Sa}=this.lud(ja)).returnValue&&(l=ok.f(Sa.gb))}const wa=ja.childNodes;for(let Sa=0;Sa<wa.length;Sa++){var H=wa[Sa];if(void 0!==H.colSpan&&null!==H.colSpan&&void 0!==H.rowSpan&&null!==H.rowSpan){let eb;({YUd:eb}=this.N3e(H)).returnValue&&(H=Object.assign(new FL,{xQa:eb,left:H.offsetLeft,
top:this.sje?ja.offsetTop:f,width:this.U5i(H),height:H.offsetHeight,yjg:!U,zkg:U+H.rowSpan===b,tjg:!l&&!Sa}),c.push(H))}}f+=ja.offsetHeight}return c}ZGl(){if(this.L1){var a=new ob.GraphIterator;a.set(this.gb);if(hd.TableReader.NIf(a)&&this.dS){a=this.dS.childNodes.length;var b=Array(a),c=[],f=this.jTa(),l=f.length,w=0;for(let H=0;H<l;H++){let U=0;const ja=f[H],wa=ja.childNodes;let Sa=0;for(let eb=0;eb<a;eb++){let ub;if(b[eb]){let Ub;(Ub=b[eb]).BWc=Ub.BWc-w;let cc;(cc=b[eb]).snd=cc.snd-1;ub=b[eb].colSpan;
1===b[eb].snd&&(U=Math.max(U,b[eb].BWc),b[eb]=null)}else{const Ub=wa[Sa];Sa++;if(!Ub)continue;let cc=0,Fc;({YUd:Fc}=this.N3e(Ub)).returnValue&&(cc=Fc.v5b());ub=Ub.colSpan;1<Ub.rowSpan?b[eb]=Object.assign(new CL,{colSpan:Ub.colSpan,BWc:cc,snd:Ub.rowSpan}):U=Math.max(U,cc)}eb+=ub-1}({und:w}=this.lud(ja)).returnValue?(w.Dal(U)&&c.push(w),w=w.gnh):w=0}for(const H of c)H.YGl()}}}j1k(){const a=this.jTa();if(Pc.App.instance.zZc&&a.length&&!(a.length<=this.Mnf&&a[0].childNodes.length===this.m$e)){this.Mnf=
a.length;this.m$e=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!za.a.gda(a[c].firstChild,"DragHandle")&&({und:b}=this.lud(a[c])).returnValue&&b.T0k()}}Phg(a,b){b=a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}rNe(a){if(a)for(const b of a)b.xQa.Muc(b.left,b.top,b.width,b.height,b.yjg,b.zkg,b.tjg)}jTa(){return this.L1.children}N3e(a){let b;b=null;a&&(a=Hf.a(a),b=Object(qa.a)(Iv,a));return{returnValue:!!b,YUd:b}}lud(a){let b;b=null;a&&(a=Hf.a(a),b=Object(qa.a)(cu,a));return{returnValue:!!b,
und:b}}uSk(){let a=0;const b=hd.TableReader.Lu(this.gb),c=this.sje,f=this.jTa(),l=[];let w=!1;for(let U=0,ja=f.length;U<ja;U++){const wa=f[U];if(!wa)continue;if(b){let Ub;({und:Ub}=this.lud(wa)).returnValue&&(w=ok.f(Ub.gb))}const Sa=new EL,eb=!U,ub=wa.childNodes;for(let Ub=0,cc=ub.length;Ub<cc;Ub++){var H=ub[Ub];let Fc;if(({YUd:Fc}=this.N3e(H)).returnValue){const Ic=H.offsetTop,Cc=H.rowSpan,Ud=!Ub;H=Object.assign(new DL,{xQa:Fc,left:H.offsetLeft,offsetTop:Ic,top:c?Ic:a,width:H.offsetWidth,height:H.offsetHeight,
rowSpan:Cc,fkg:eb,gkg:U+Cc===ja,ekg:!w&&Ud,ocg:!Ud&&this.Phg(H,ng.a.ffe),Lbg:!eb&&this.Phg(H,ng.a.efe)});Sa.OOd(H)}}a+=wa.offsetHeight;l.push(Sa)}return l}sMk(a){if(a.length){var b=this.y6d(1)/2,c=this.y6d(0)/2,f=a[0].cells[0].xQa,l=f.lkg(!1);f=f.lkg(!0);var w=[];for(var H of a[0].cells){var U=H.xQa.sEl(H.left,H.width+c,H.offsetTop,l);U&&w.push(U)}Zm.a.aVk(w);l=[];for(H=0;H<a.length;H++)w=a[H].cells[0],(U=w.xQa.aHl(w.height+b,w.offsetTop,f))&&l.push(U),1<w.rowSpan&&(H+=w.rowSpan-1);Zm.a.QWk(l);for(const ja of a)for(const wa of ja.cells)a=
wa.xQa,f=wa.width,l=wa.height,a.XGl(f,l+b,wa.offsetTop,wa.left),a.Muc(wa.left,wa.top,f+c,l,wa.fkg,wa.gkg,wa.ekg),wa.ocg&&a.kih(ng.a.ffe),wa.Lbg&&a.kih(ng.a.efe)}}}im.Fsd="Border";im.q1e="NoBorder";im.sIf="Conflict";im.$Kh="TableWordWrap";im.Qul="WACAltTextDescribedBy";im.DVa=null;Object(n.a)(im,"TableViewElement",dh.a,[1112,494,346,106]);class Jv extends cu{constructor(a,b,c){super(a,b,c,null,null)}vMb(a){this.htmlElement.style.height=a+"px"}get fnh(){return this.Nd.Md.Pe(this.gb.sa(hb.a.tu,0),1)+
"px"}static y9f(a){a=Hf.a(a);let b=null;a&&(b=Object(qa.a)(Jv,a));return b}}Object(n.a)(Jv,"TableRowViewElement",cu,[]);class Ux{constructor(a,b,c=!1){this.Tji=a;this.frj=b;this.KNc=c}}Object(n.a)(Ux,"TableBorderProperty",null,[]);var wl=d(502);class Wp{constructor(a,b,c,f,l){this.N9=a;this.ic=c;this.Pb=b;this.MFb=f;this.hbk=l}Ugj(a){switch(a){case 0:a=Va.a.ZNb;break;case 1:a=Va.a.$Nb;break;case 2:a=Va.a.bOb;break;case 3:a=Va.a.cOb;break;default:a=null}return{returnValue:!!a,plk:a}}nta(a,b){let c=
0;if(!a)return c;let f;({plk:f}=this.Ugj(b)).returnValue&&(c=3===b||0===b?a.sa(f,.1):a.sa(f,Wp.FIk));return c}gDf(a){return.0555555555555556+this.nta(a,1)+this.nta(a,2)}mUd(a,b){const c=hd.TableReader.tk(a);if(0>b||b>=c)return.0555555555555556;a=this.Pb.Mc(a).$p(b,1);return this.oJc(a)}oJc(a){let b=.0555555555555556;a=this.Pb.Mc(a);a.Bb(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.nta(c,0)+this.nta(c,3))}while(a.Cf(1));return b}Usb(a,b){var c=hd.TableReader.Ci(a);if(0>b||b>=c)return.0555555555555556;
c=.0555555555555556;a=this.Pb.Mc(a);a.Bb(1);do{const f=a.$p(b,1);c=Math.max(c,this.gDf(f));a.zc()}while(a.Cf(1));return c}H7d(a){return a&&a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:wl.a.Fub}pae(a,b){let c=b;if(this.hbk&&b&&b.cellShading){let f;({vla:f}=this.S3e(a,b.cellShading)).returnValue&&(b=Object(qa.a)(115,this.ic.jg(b)),c=this.MFb.imh(a,b?b.Jd:null,f))}return c}p5b(a,b){let c=wl.a.Eub;const f=Wp.fTa(b);
f.returnValue&&(a=this.pae(b,a),a.Sa(f.iQa)&&(c=a.eb(f.iQa)));return c}C5d(a,b,c){if(c&&c.sD===tc.a.auto)return Ik.a.none;a=this.I8i(a);b=this.q6d(b);c=c.oV();return String.format("{0} {1}px {2}",a,b,c)}q6d(a){a=this.N9.Pe(a,0);B.a.Kua&&0<a&&1>a&&(a=1);return a}psb(a,b,c=!1){let f=tc.a.nRa.oV();if(a.solidFillField){var l=ie.Box4ColorHelper.KH(ie.Box4ColorHelper.pga(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.oV()}else if(a.gradFillField){a=bp.f(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=
l.color.g=l.color.b=255;f=a.oV()}return f}Gqj(a){const b=a.currentNode.ui;a.zc();const c=a.JF(1);a.$p(b,1);return c?a.currentNode:null}Lqj(a){return a.JF(1)}S3e(a,b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,vla:a}}I8i(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static fTa(a){let b,c;switch(a){case 7:a=
hb.a.fza;b=hb.a.GLa;c=hb.a.uul;break;case 0:a=hb.a.Bga;b=hb.a.zga;c=hb.a.pul;break;case 5:a=hb.a.eza;b=hb.a.FLa;c=hb.a.sul;break;case 6:a=hb.a.Cga;b=hb.a.Aga;c=hb.a.tul;break;case 2:a=hb.a.klb;b=hb.a.ilb;c=hb.a.rul;break;case 1:a=hb.a.jlb;b=hb.a.hlb;c=hb.a.qul;break;default:c=b=a=null}return{returnValue:!!a,iQa:a,M6a:b,ysb:c}}}Wp.FIk=.2;Object(n.a)(Wp,"TableStyleReaderHelper",null,[294]);class UD{constructor(a,b,c=-1){this.dY=a;this.Aug=b;this.uBg=c}}Object(n.a)(UD,"TableStyle",null,[]);var jr=d(331);
class Xz{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve){this.dY=new qd.a;this.Jbd=new qd.a;this.Ibd=new qd.a;this.Ebd=new qd.a;this.w1e=[];this.Pb=a;this.uH=c;this.ic=b;this.Tk=f;this.N9=l;this.M0=w;this.DIa=H;this.oc=U;this.SCe=ja;this.Mik=wa;this.Hik=Sa;this.yik=eb;this.yc=ub;this.jYa=Ub;this.AJ=cc;this.Qo=Fc;this.Nq=Ic;this.Hdb=Cc;this.U7c=Ud;this.pDb=je;this.iHa=Vd;this.gXa=Ve;this.DIa.Eia(Object(F.a)(this,this.Wgd,"onTableConnectedOrDisconnected"));this.DIa.R7(Object(F.a)(this,
this.Wgd,"onTableConnectedOrDisconnected"));this.DIa.kk(Object(F.a)(this,this.O7g,"onTablePropertyChanged"));this.Nq.Bai(Object(F.a)(this,this.N5g,"onPageViewBeforeValidate"))}dispose(){this.DIa.qoa(Object(F.a)(this,this.Wgd,"onTableConnectedOrDisconnected"));this.DIa.wKa(Object(F.a)(this,this.Wgd,"onTableConnectedOrDisconnected"));this.DIa.Rm(Object(F.a)(this,this.O7g,"onTablePropertyChanged"));this.Nq.z_k(Object(F.a)(this,this.N5g,"onPageViewBeforeValidate"))}n0f(a){if(!a||!a.length)return null;
const b=this.bSc(Object(qa.a)(yg.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.bSc(Object(qa.a)(yg.a,a[c]));if(!f||f.sD!==b.sD)return null}return b}bae(a){let b=null;if(a=this.W6b(a))b=new sq.a,b.we(hb.a.tableStyle,new UD(a,Number.MAX_VALUE));return b}$Uc(a){if(14!==a.type){a=this.Pb.Mc(a);a.rc(14);var b=a.Jg(14)}else b=a;a=b.id;this.Ibd.Gb(a)||(b=this.cae(b),this.Ibd.$(a,this.Hik(b)));return this.Ibd.ga(a)}ndj(a){return(a=this.oc.I6b(Object(qa.a)(115,this.ic.jg(a))))?a.TableListStyle:
null}cae(a){const b=Object(qa.a)(115,this.ic.jg(a));return this.SCe(()=>a.HY,()=>a.h8,()=>a.tableLook,()=>this.ndj(a),()=>b?b.Jd:null,()=>this.W6b(a))}Wgd(a,b){this.Ggg(b.node)}O7g(a,b){a=b.property;b=b.node;if(a===hb.a.jza||a===hb.a.Xsc||a===Za.a.iza||a===Za.a.Dga||a===Za.a.TA){if(a===Za.a.iza||a===Za.a.TA)b.Ysc=!1;a!==hb.a.jza&&a!==hb.a.Xsc||this.Ggg(b);this.n9b(b)}}Qlk(a){Array.contains(this.w1e,a)||(this.n9b(a),this.w1e.push(a))}N5g(){Array.clear(this.w1e)}jJj(a){this.Ebd.remove(a.id)}Ggg(a){a=
a.id;this.dY.remove(a);this.Jbd.remove(a);this.Ibd.remove(a)}YUc(a){const b=a.id;this.Ebd.Gb(b)||this.Ebd.$(b,this.yik(this.cae(a)));return this.Ebd.ga(b)}W6b(a){const b=a.id;if(this.dY.Gb(b))return this.dY.ga(b);var c=a.sa(hb.a.jza,null);if(!c)return null;let f=null;const l=Yq.LUf(c);l&&a.Gh&&(f=a.Gh.Be(l));a=null;if(f)a=ki.a.ISa(f,hb.a.tableStyle);else if(c=this.M0.v8f("{"+c.toString()+"}"))a=c.dY;a&&this.dY.$(b,a);return a}V8d(a){return a.tableLook}O8(a,b){a=this.Tk.Usb(a,b);return this.N9.Pe(a,
0)}T5i(a){if(a.Sa(hb.a.kP))switch(a.sa(hb.a.kP,0)){case 2:return"bottom";case 1:return"middle"}return"top"}o0f(a){var b=null;if(!a)return null;if(a.cellShading){var c=bp.a(a.cellShading);bp.e(c)||(b=c)}b||(b=this.uka(a,hb.a.cellShading,wl.a.Fub));c=Object(qa.a)(115,this.ic.jg(a));b=this.Tk.psb(b,c?c.Jd:null,this.Hdb);a.rowIndex||1!==a.ui||va.a.J(509137695,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}bSc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=bp.a(a.cellShading);
bp.e(f)||(b=f)}b||(b=this.uka(a,hb.a.cellShading,wl.a.Fub));a=(a=Object(qa.a)(115,this.ic.jg(a)))?a.Jd:null;(b=b.solidFillField)&&(c=ie.Box4ColorHelper.WDa(b,a));return c}r$a(a){var b=null;var c=Object(qa.a)(5,a);c&&(a=c.sa(Va.a.listLevel,Jg.a.PEa),c=this.Pb.Mc(c),c.rc(7)&&hd.TableReader.Cs(c)&&(c=Object(qa.a)(Zl.TableCellNode,c.Jg(16))))&&(this.jch(c),b=1+a,b=this.uH.j0f(c,this.$Uc(c),b));return{tableStyle:b,x7a:null}}Wmj(a){let b=ki.a.ki(a,hb.a.cellShading,wl.a.Fub);if(bp.e(b)){const c=this.W6b(a);
c&&(b=this.Tk.H7d(c))}a=Object(qa.a)(115,this.ic.jg(a));return this.Tk.psb(b,a?a.Jd:null)}O8i(a){return!Pd.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?wl.a.Eub:wl.a.PKi}d$i(a,b){if(this.U7c&&this.Qo.DT&&!this.mLj(a,b))return new Ux("","");var c=Object(qa.a)(125,a);if(({iQa:w,M6a:H,ysb:U}=Wp.fTa(b)).returnValue)if(this.gXa&&Pd.a("TableBordersLocalRenderingFix")){var f=this.uka(c,w,this.O8i(b),!0);var l=this.uka(c,U,wl.a.Dub,!0);var w=c.sa(w,f);f={};if(Pd.a("FixClearTableBorder")){let ja=this.Pb.Mc(c);
ja.rc(14);if(ja.Jg(14).Sa(hb.a.jza)){f.Color="##T,0,0,0";f=ie.Box4ColorHelper.YR(f);f=this.uka(c,H,f,!0);var H=ki.a.ki(c,H,f);H=ie.Box4ColorHelper.pga(H);a=this.ic.jg(a);a=(a=ie.Box4ColorHelper.KH(H,a?a.Jd:null))?ie.Box4ColorHelper.Jga(a):null}else Pd.a("FixTableBorderColor")?(f.Color="##T,1,0,0",f=ie.Box4ColorHelper.YR(f),f=this.uka(c,H,f,!0),H=ki.a.ki(c,H,f),H=ie.Box4ColorHelper.pga(H),a=this.ic.jg(a),a=(a=ie.Box4ColorHelper.KH(H,a?a.Jd:null))?ie.Box4ColorHelper.Jga(a):null):(f.Color="#000000",
a=ie.Box4ColorHelper.YR(f),a=ie.Box4ColorHelper.gta(a))}else f.Color="##T,0,0,0",f=ie.Box4ColorHelper.YR(f),f=this.uka(c,H,f,!0),H=ki.a.ki(c,H,f),H=ie.Box4ColorHelper.pga(H),a=this.ic.jg(a),a=(a=ie.Box4ColorHelper.KH(H,a?a.Jd:null))?ie.Box4ColorHelper.Jga(a):null;l=c.sa(U,l)}else l=this.Tk.pae(b,c),w=l.Sa(w)?l.eb(w):this.uka(c,w,wl.a.Eub,!0),a=this.g0f(l,c,H),l=l.Sa(U)?l.eb(U):this.uka(c,U,wl.a.Dub,!0);else w=wl.a.Eub,a=wl.a.YMc,l=wl.a.Dub;5!==b||a.sD===tc.a.auto||c.rowIndex||1!==c.ui||va.a.J(509137694,
822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.sD,a.alpha);var U=!1;a.sD!==tc.a.auto||7!==b&&5!==b||(f=this.Pb.Mc(c),f.rc(14),7===b?(H=hb.a.zga,f=this.Tk.Gqj(f)):(H=hb.a.Aga,f=this.Tk.Lqj(f)),f&&(c=this.Tk.pae(b,c),this.g0f(c,f,H).sD===tc.a.auto&&(l=wl.a.Dub,w=wl.a.erj,a=wl.a.drj,U=!0)));c=this.Tk.C5d(l,w,a);return U&&7===b?new Ux(c,"Top"):U&&5===b?new Ux(c,"Left"):new Ux(c,"")}RSc(a,b){switch(b){case 7:b=hb.a.fza;break;case 6:b=hb.a.Cga;break;case 0:b=hb.a.Bga;break;case 5:b=hb.a.eza;break;
default:b=null}const c=this.uka(a,b,wl.a.Eub,!0);return a.sa(b,c)}mLj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Pb.Mc(a);if(!c.rc(14))return!0;var f=c.Sw(14);if(!f.Np())return!0;const l=a.rowSpan,w=a.colSpan;if(1===l&&1===w)return!0;f=this.yc.Tmj(f);const H=new jr.a;H.re=this.jYa.Nij(c);H.$f=H.re+l;H.he=this.AJ.lSc(Object(qa.a)(125,a));H.Nf=H.he+w;switch(b){default:va.a.J(509137693,822,15," Unknown position type: {0} ",b);break;case 5:if(!H.he||1===l)break;if(4!==(f.vs(H.re,H.he-
1)&4)||8!==(f.vs(H.$f-1,H.he-1)&8))break;for(a=H.re+1;a<H.$f;++a)if(4===(f.vs(a,H.he-1)&4))return!1;break;case 6:if(H.Nf===f.AR||1===l)break;if(4!==(f.vs(H.re,H.Nf)&4)||8!==(f.vs(H.$f-1,H.Nf)&8))break;for(a=H.re+1;a<H.$f;++a)if(4===(f.vs(a,H.Nf)&4))return!1;break;case 7:if(!H.re||1===w)break;if(1!==(f.vs(H.re-1,H.he)&1)||2!==(f.vs(H.re-1,H.Nf-1)&2))break;for(a=H.he+1;a<H.Nf;++a)if(1===(f.vs(H.re-1,a)&1))return!1;break;case 0:if(H.$f!==f.UO&&1!==w&&1===(f.vs(H.$f,H.he)&1)&&2===(f.vs(H.$f,H.Nf-1)&2))for(a=
H.he+1;a<H.Nf;++a)if(1===(f.vs(H.$f,a)&1))return!1}return!0}g0f(a,b,c){if(this.gXa){const f=ie.Box4ColorHelper.YR({Color:"##T,0,0,0"});a=ki.a.ki(a,c,f);a=ie.Box4ColorHelper.pga(a);b=this.ic.jg(b);b=(b=ie.Box4ColorHelper.KH(a,b?b.Jd:null))?ie.Box4ColorHelper.Jga(b):null}else a.Sa(c)?(b=a.Mh(c),b=Object(Ya.a)(tc.a,b)?b:new tc.a(a.eb(c))):b=this.uka(b,c,wl.a.YMc,!0);this.Hdb&&(b=new tc.a(0,b.alpha));return b}n9b(a){const b=this.iHa?this.Pb.P8d(a):this.Pb.Mc(a);let c=Object(qa.a)(155,b.Ii());for(a=Object(qa.a)(158,
a);c;)c.pnd=!1,c=Object(qa.a)(155,b.lp());this.jJj(a);this.iHa?this.TIj(a):a.Hda(4)}TIj(a){if(a&&a.isConnected)for(a=this.Pb.P8d(a),a=Vl.a.rv(a);a.moveNext();)a.currentNode.anchor.Dr(4)}pLl(a){a&&(this.$Uc(a),this.W6b(a),this.YUc(a))}uka(a,b,c,f=!1){if(!a)return c;var l=this.Pb.Mc(a);l.rc(14);l=l.Jg(14);var w=l.id;if(this.pDb&&f){if(!l.Sa(hb.a.jza))return c;w=a.rowIndex;a=a.ui;return(a=this.YUc(l).p5i(l,w,a))&&a.Sa(b)?a.Mh(b):c}this.jch(a);f=a.eV;if(!f){if(!l.Sa(hb.a.jza))return c;f=a.rowIndex;let H=
a.ui;const U=a.rowSpan,ja=a.colSpan;this.Jbd.Gb(w)||this.Jbd.$(w,this.Mik(this.cae(l)));f=this.Jbd.ga(w).v6d(f,H,U,ja);a.eV=f}return f&&f.Sa(b)?f.Mh(b):c}bpi(a){const b=this.Pb.TSa();b.set(a);let c=0,f=Object(qa.a)(155,b.Bb(1));for(;f;)f.rowIndex=c,c++,f=Object(qa.a)(155,b.lp());a.Ysc=!0}rKk(a){let b=0;const c=a.rowIndex,f=this.Pb.TSa();f.set(a);let l=Object(qa.a)(125,f.Bb(1));for(;l;)l.rowIndex=c,l.ui=b,l.eV=null,this.uH.V2k(l),l.TSf(),l=Object(qa.a)(125,f.lp()),b++;a.pnd=!0}jch(a){var b=this.Pb.Mc(a);
b.rc(14);a=Object(qa.a)(155,b.Jg(15));(b=Object(qa.a)(158,b.Jg(14)))&&!b.Ysc&&this.bpi(b);a&&!a.pnd&&this.rKk(a)}}Object(n.a)(Xz,"TableStyleReader",null,[1113,1114,1115]);class Ll extends im{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){super(a,b,c);this.h8c=this.Nv=this.jFb=this.gva=this.mH=null;this.dic=l;this.Tk=w;this.Qo=H;this.Le=U;this.G0=[];this.oc=f;this.Seb=eb;this.mc=ub;this.ic=Ub;this.gj=cc;this.uDb=wa.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.Zwe=wa.pptComplexTableLayoutSyncEnabled;
this.t0=wa.yka;this.gQg=Sa;this.yc=Fc;this.Pb=Ic;this.gye=wa.laa;this.W7c=wa.DBh;if(Cc)this.Nv=Cc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Qc.pp){if(this.mH=ja?ja(a):null)this.mH.fGh(),this.Ek&&this.Ek.WU&&(this.mH.pji(this,this.Ek.WU,this.table),this.mH.Ox(!this.mc.In));Pd.a("DeprecateIE.TableViewElement.ctor")||!this.Qo.abb&&!this.Qo.cbb||(this.htmlElement.style.backgroundColor="rgba(0,0,0,0)")}this.Ek&&(this.Ek.hai(Object(F.a)(this,this.N6g,"onShapeEnterTextEditing")),this.Ek.Dvf(Object(F.a)(this,
this.W6g,"onShapeSelectionChanged")),this.Ek.jai(Object(F.a)(this,this.O6g,"onShapeExitTextEditing")),this.Ek.K$h(Object(F.a)(this,this.l2g,"onAfterDraw")),this.Ek.ubi(Object(F.a)(this,this.h6g,"onReadModeChanged")),this.Ek.fai(Object(F.a)(this,this.J3g,"onDisplayOnActiveSlide")))}get Dti(){return this.mH}J3g(){this.i1e()}get Ek(){if(this.gva)return this.gva;if(this.Qc.pp){const a=Ke.a.nb(this.Qc.Ma,this.gb);a.Ze();a.B_a();this.gva=Object(qa.a)(117,a.jRa)}return this.gva}N9d(){if(!this.W7c)return 1;
var a=this.ic.jg(this.gb);if(!a)return 1;var b=a.sc(this.Ma);if(!b)return 1;b=b.Bca?b.Bca.xa.style.visibility===$i.a.visible:!1;var c=new gr.a(a.oq,a.Vk);if(!this.Nv)return 1;b=this.Nv.F6b(c,b).dP;c=this.gj.JG;a=this.oc.MUc(a)*c;return b/a}Ioh(a){if(1!==a&&this.W7c){var b=this.yc.tka(this.gb);for(var c of b)b=this.Nd.Md.Pe(c.sa(hb.a.tu,0),1)*a,c.sc(this.Ma).htmlElement.style.height=b+"px";c=xn.b(this.gb);for(b=0;b<c.length;b++){const f=this.Nd.Md.Pe(c[b],0)*a;this.MKc.childNodes[b].style.width=f+
"px"}}}Ny(a){super.Ny(a);this.Ioh(this.N9d());this.lDh(this.Seb.szb?!!this.Ek&&this.Ek.uL()&&(this.Ek.fB||this.Ek.Wn):!!this.Ek&&this.Ek.Wn)}NU(){const a=this.dic,b=xn.b(this.gb),c=hd.TableReader.Ci(this.gb);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.O8(this.gb,l),this.Nd.Md.Pe(b[l],0));return new Kj.a(0,f,0)}L6(a){super.L6(a);if(this.Qc.pp&&(a=this.gQg.HUc(this.gb,this.Ma))&&0!==a.yYc){const b=this.gb;if(b.cO)return;this.Zwe?a.ZHh(b):a.yYc&2?a.ZHh(b):a.TFl(b,c=>{c&&this.i1e()})}this.i1e()}i1e(){this.mH&&
this.Ek&&this.Ek.Wn&&this.h1e()}Qsh(a,b){Object(qa.a)(Xz,mb.StyleReader.nr);if(1!==b)for(var c=0;c<this.L1.childNodes.length;c++){var f=this.L1.childNodes[c];if(!f||"TR"!==f.tagName.toUpperCase())continue;const w=f.offsetHeight*b;var l=this.Tk.mUd(this.gb,c);l=this.Nd.Md.Pe(l,1);f.style.height=(w<l?0:w)+"px"}if(1!==a)for(b=0;b<this.MKc.childNodes.length;b++)c=gf.a.Gn(this.MKc.childNodes[b].style.width),f=this.Tk.Usb(this.gb,b),f=this.Nd.Md.Pe(f,0),this.Pqc(b,Math.max(c*a,f))}Fij(a){a>this.L1.childNodes.length&&
Error.argumentOutOfRange("rowIdx");const b=this.L1.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",a));return gf.a.Gn(b.style.height)}T6b(){return cj.a.fda(this.Le.ai(this.table))}get MQj(){const a=this.gQg.HUc(this.gb,this.Ma);return!a||0===a.yYc}L6f(){const a=[0];for(let b=1;b<=this.L1.childNodes.length;++b)a[b]=a[b-1]+this.L1.childNodes[b-1].offsetHeight;return a}G0f(){const a=[0];for(let b=1;b<=this.MKc.childNodes.length;++b)a[b]=
a[b-1]+this.kSc(b-1);return a}bSe(a){if(14!==this.gb.type)va.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.gb.type);else if(this.gb.sa(hb.a.complexTable,!0))va.a.J(512497118,808,50,"Disable column resizing for table with merged cells");else{super.bSe(a);a=new ob.GraphIterator;a.set(this.gb);Rd.moveToFirstRow(a);Rd.moveToFirstColumn(a);let b=1;const c=this.Nd.Md.Pe(this.Tk.p5b(a.currentNode,6),0);for(;!Ie.isLastCellInRow(a);){Rd.moveToNextColumn(a);
const f=this.jv[b++],l=gf.a.Pc(-1*c);hd.TableReader.um(this.gb)?f.style.marginRight=l:f.style.marginLeft=l}this.jv.length!==b&&va.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",this.jv.length,b)}}Yaa(a){super.Yaa(a);this.Qc.Wl||this.l1k();this.gb.sa(hb.a.complexTable,!0)||Zm.a.Ev||this.k1k()}dispose(){super.dispose();this.mH&&(this.mH.dispose(),this.mH=null);this.Ek&&(this.Ek.l_k(Object(F.a)(this,this.N6g,"onShapeEnterTextEditing")),this.Ek.Ojh(Object(F.a)(this,
this.W6g,"onShapeSelectionChanged")),this.Ek.m_k(Object(F.a)(this,this.O6g,"onShapeExitTextEditing")),this.Ek.WZk(Object(F.a)(this,this.l2g,"onAfterDraw")),this.Ek.a0k(Object(F.a)(this,this.h6g,"onReadModeChanged")),this.Ek.j_k(Object(F.a)(this,this.J3g,"onDisplayOnActiveSlide")));this.gva=null}l2g(){this.Ek.fO&&this.h1e(!0)}Bri(){if(this.gye){var a=this.gb,b=a.q$a();if(a.Ysc)for(const c of b){a=c;if(!a)continue;a=a.sc(this.Ma);if(!a)continue;b=this.dic.RSc(c,7);const f=this.dic.RSc(c,6),l=this.dic.RSc(c,
0),w=this.dic.RSc(c,5);0===b&&a.uld("Top");0===f&&a.uld("Right");0===l&&a.uld("Bottom");0===w&&a.uld("Left")}}}W6g(a,b){this.lDh(b.isSelected);a=this.table;this.Bri();b.isSelected?Sys.UI.DomElement.containsCssClass(a,"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}h6g(a,b){this.mH&&this.mH.Ox(b.kUj)}lDh(a){if(this.mH)if(this.t0){const b=this.Pb.Mc(this.gb);b.Ze();b.B_a().eb(hb.a.isResizable)?
this.mH.visible=a:this.mH.visible=!1}else this.mH.visible=a;this.Ek&&this.Ek.Qd&&this.Ek.shapeNode&&this.Ek.shapeNode.MQ&&(this.Ek.Qd.visible=a)}k1k(){if(!this.G0.length){var a=this.ZQa();Sys.UI.DomElement.addCssClass(a,"First");this.G0.push(a);a=this.AHi();Sys.UI.DomElement.addCssClass(Ll.f3f(a),"Last");this.G0.push(a)}var b=this.jTa();a=b.length;var c=a+1-this.G0.length;if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){let l=this.ZQa();this.G0.splice(this.G0.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.pKb(this.G0[f+
1]);this.G0.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.G0[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.G0[a],b.firstChild);this.jdi()}}jdi(){const a=new ob.GraphIterator;a.set(this.gb);Rd.moveToFirstRow(a);Rd.moveToFirstColumn(a);let b=1;for(;b<this.G0.length;){var c=this.Nd.Md.Pe(this.Tk.p5b(a.currentNode,5),0),f=this.Nd.Md.Pe(this.Tk.p5b(a.currentNode,0),1);let l=this.G0[b];Ll.dXj(l)&&(l=Ll.f3f(l));c=gf.a.Pc(-1*c);f=gf.a.Pc(-1*f-(b===this.G0.length-1?4:0));hd.TableReader.um(this.gb)?
l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;Rd.moveToNextRow(a);b++}}l1k(){if(!this.jFb){const a=String.format("url('{0}'), pointer",Ey.a.box4Image("RowSelect.cur"));this.jFb=this.Nd.createElement("div");this.jFb.className=Ck.a.evl;Hf.c(this.jFb,!0);const b=this.Nd.createElement("div");b.className=Ck.a.r1e;b.style.cursor=a;this.jFb.appendChild(b);this.table.appendChild(this.jFb)}}Hij(){return this.jTa()}ZQa(){const a=this.Nd.createElement("div");a.className="TableRowResizeHandle";
a.style.width="100%";Hf.c(a,!0);return a}AHi(){const a=this.Nd.createElement("div");a.className="TableRowResizeAnchor";const b=this.ZQa();a.appendChild(b);Hf.c(a,!0);return a}pKb(a){T.a.rKa(a);za.a.$O(a)}Lmj(a){var b=this.ic.jg(this.gb);let c=this.gj.JG;b&&b.Uw&&null!=b.Uw.Zr&&(c=b.Uw.Zr);b=this.oc.MUc(this.ic.jg(this.gb))*c;a=a.copy();a.move(-a.hc,-a.kc);a.scale(1/b,1/b);return a}N6g(){this.table.clientWidth&&this.h1e(!0);!this.Seb.szb&&this.mH&&(this.mH.visible=!0,this.Ek&&this.Ek.Qd&&(this.Ek.Qd.visible=
!0));this.Ek&&this.Ek.uL()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}O6g(){this.mH&&(this.mH.visible=!1);this.Ek&&this.Ek.Qd&&(this.Ek.Qd.visible=!1)}h1e(a=!1){var b=this.T6b();let c=Xi.a.Dwd;this.h8c&&(c=cj.a.e6b(b,this.h8c));const f=gd.a.i7e;a=!!this.Ek&&(!this.h8c||!f.equals(gd.a.i7e)||!c.equals(Xi.a.Dwd)||a);this.h8c=b;if(a&&(a=this.Ek.T4e,b=cj.a.e6b(this.Lmj(b),a),this.Ek.setOffsets(b,!0),!Pd.a("DeprecateIE.TableViewElement.SynchronizeViews")&&
this.Qo.abb&&0<this.L1.childNodes.length))for(b=this.L1.childNodes[0].offsetWidth,a=0;a<this.G0.length;a++)this.G0[a].style.width=b+"px";this.mH&&this.mH.Rl();this.uDb||this.Y5e()}i$d(){return this.uDb?null:super.i$d()}rNe(a){if(this.uDb){var b=this.yc.tk(this.gb);a=Object(qa.a)(ob.GraphIterator,this.Pb.Mc(this.gb));Rd.forEachCellInTable(a,(c,f,l)=>{c=c.currentNode;const w=c.sc(this.Ma);w&&w.Muc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.rNe(a)}Lej(a){let b=-1;var c=hd.TableReader.Ci(this.gb),
f=xn.b(this.gb);const l=Array(c);for(let w=0;w<c;w++)l[w]=Math.floor(this.Nd.Md.Pe(f[w],0));if(hd.TableReader.um(this.gb))if(a<=Sys.UI.DomElement.getLocation(this.L1.firstChild.lastChild).x)b=c-1;else{a-=Sys.UI.DomElement.getLocation(this.L1.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=Sys.UI.DomElement.getLocation(this.L1.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.L1.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=
l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}rph(a,b,c=!0){const f=ob.GraphIterator.nb(this.gb),l=new ob.GraphIterator,w=new qf.GraphTransaction(2);w.Iy(f);Rd.moveToFirstRow(f);c?(Rd.moveToRowByIndex(f,a),Rd.moveToFirstColumn(f)):Rd.moveToColumnByIndex(f,a);l.Rc(f);c?(Rd.moveToRowByIndex(l,b),Rd.moveToLastColumn(l)):(Rd.moveToColumnByIndex(l,b),Rd.moveToLastRow(l));a=Od.SelectionFactory.O1b(f,l);this.Qc.Mb.RE(a);w.dispose()}static Jij(a){return Ll.Kij(a,Zm.a.Ev)}static Kij(a,b){return b?Ll.Iij(a):
Ll.Lij(a)}static Lij(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Ll.kke(a)||Ll.Wke(a)||(b=b.previousSibling);break}b=b.parentNode}return Jv.y9f(b)}static Iij(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Ll.Wke(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Ll.kke(a)||(b=b.previousSibling);break}b=b.parentNode}return b?Jv.y9f(b):null}static l4(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static gVa(a){return Sys.UI.DomElement.containsCssClass(a,
"TableRowResizeHandle")}static dXj(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static Gua(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static Eac(a){return Sys.UI.DomElement.containsCssClass(a,Ck.a.r1e)}static Smj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;a=a.parentNode}return null}static kke(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static Wke(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static ujg(a){return Sys.UI.DomElement.containsCssClass(a,
"FirstLeft")}static f3f(a){return a.firstChild}}Object(n.a)(Ll,"TableViewElement",im,[1110,1111,1112,494,346,106]);class HL extends BL.a{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){super(a,b);this.dCf="ShowDashedLine";this.zma=this.fe=this.Zd=this.GIg=this.AIg=this.OIg=this.Beb=this.Sze=this.Rze=this.pe=this.IIg=null;this.xSg=this.wSg=this.d5=this.c5=this.hfb=this.bfa=0;this.J$=c;this.Sdb=f;this.Ks=l;this.yc=w;this.pa=H;this.sA=U;this.ia=ja;this.Tp=Sa;this.Wec=this.dxe=!1;this.Obk=wa}get bTe(){this.oFf();
return this.pe.offsetLeft}set bTe(a){this.oFf();this.pe.style.left=gf.a.Pc(a)}get zoom(){return 1}Uu(a){const b=super.Uu(a);if(b&&this.kN){this.hUd(a.Ec);Sys.UI.DomElement.addCssClass(this.pe,this.dCf);if(this.Eba=Ll.ujg(a.Ec))this.ri=0,this.oF=this.ul.kSc(this.ri);this.Zd=this.ul.Ek;this.fe=this.yc.V6b(this.Zd.gb);this.Wec=!1;this.$Xe()&&this.T6i(a)}else b&&!this.kN&&(a=a.Ec,Ll.Gua(a)&&(va.a.J(512497184,816,50,"Drag from table column handle"),this.ri=parseInt(a.parentNode.getAttribute("columnindex").toString())));
b&&this.Tp&&this.ia.processAction(D.a.Xja,2);return b}Gw(a){this.kN?(a=this.hDf(a.clientPoint.x),this.bTe=this.IIg+(a-this.oF)*(this.Eba?-1:1)):(a=this.ul.Lej(a.clientPoint.x),this.ul.rph(this.ri,a,!1));return!0}fo(a){if(this.kN){const f=this.J$.Ei("UserAction","PPTColumnResize");a&&va.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.ul.gb.sa(hb.a.vGb,""),this.ul.gb.Np()));const l=new qf.GraphTransaction(15);l.kd(this.ul.gb);const w=this.ul.gb.sa(Za.a.$u,
null);var b=this.hDf(a.clientPoint.x),c=this.ul.Nd.Md;const H=c.qf(b,0);(this.Eba||this.ri===this.wG-1)&&this.Ks.d0a(this.ul.gb,this.ri,H);if(this.Eba&&b!==this.oF&&(b=this.oF-b)){this.Zd.setPosition(this.Zd.x+b,this.Zd.y,!0);b=c.qf(this.Zd.x,0);c=c.qf(this.Zd.y,1);const U=this.ul.Ek.shapeNode;U.Ay=b;U.By=c}!this.Eba&&this.ri<this.wG-1&&this.YWe(H,w);this.$tc();l.dispose();Pc.App.Kb.updateCommandUI();this.end();this.fe?this.Ks.e_a(this.fe):va.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");
f&&f.stop();a&&va.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.ul.gb.sa(hb.a.vGb,""),this.ul.gb.Np(),this.Eba))}else a&&Pc.App.Kb.l6(a.clientPoint,a.Wf),super.fo(a)}pu(a){super.pu(a);this.kN&&this.$tc()}q8f(){return null}oFf(){if(!this.pe)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!Zm.a.l4(this.pe))throw Error.invalidOperation("Element is not the table column resize handle");
}hUd(a){this.pe=a;this.IIg=this.bTe;this.Rze=this.pe.style.marginLeft;this.Sze=this.pe.style.marginRight;this.Beb=this.pe.style.height;this.OIg=this.pe.style.top;this.AIg=this.pe.style.bottom;this.GIg=this.pe.style.left;this.pe.style.marginLeft=this.pe.style.marginRight="auto";this.pe.style.top="0";this.pe.style.height="auto";this.pe.style.bottom="0";this.Sdb&&(a=Zm.a.X6b(a))&&(this.pe.style.top=-a.offsetTop+"px",this.pe.style.bottom=-(this.ul.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}$tc(){this.pe&&
(Sys.UI.DomElement.removeCssClass(this.pe,this.dCf),this.pe.style.marginLeft=this.Rze,this.pe.style.marginRight=this.Sze,this.Rze=this.Sze="auto",this.pe.style.left=this.Obk?this.GIg:"auto",this.pe.style.top=this.OIg,this.pe.style.height=this.Beb,this.pe.style.bottom=this.AIg,this.pe=null)}T6i(a){this.Wec=this.dxe=!1;a=a.Ec;if(Zm.a.l4(a)){var b=null,c=null;({Qbb:b,pjb:c}=this.S6i(a,b,c)).returnValue&&this.E7i(b,c)&&this.h$d()&&this.fe&&(a=this.yc.Ci(this.fe),b=this.yc.tk(this.fe),0<=this.bfa&&this.bfa<
b&&0<=this.hfb&&this.hfb<b&&0<=this.c5&&this.c5<a&&0<=this.d5&&this.d5<a&&(this.Wec=!0))}}S6i(a,b,c){if(!Zm.a.l4(a)||!this.fe)return{returnValue:!1,Qbb:b,pjb:c};var f=Zm.a.X6b(a);f=Hf.a(f);this.zma=Object(qa.a)(Zl.TableCellNode,f.gb);if(!this.zma)return{returnValue:!1,Qbb:b,pjb:c};f=this.ETc(this.zma);if(0>f||f>=this.yc.Ci(this.fe))return{returnValue:!1,Qbb:b,pjb:c};const l=this.zma.rowIndex;if(0>l||l>=this.yc.tk(this.fe))return{returnValue:!1,Qbb:b,pjb:c};if(Ll.ujg(a))return{returnValue:!1,Qbb:null,
pjb:c};b=this.fe.nf(l,f);if(f===this.yc.Ci(this.fe)-1)return{returnValue:!1,Qbb:b,pjb:null};c=this.fe.nf(l,f+1);return{returnValue:!0,Qbb:b,pjb:c}}E7i(a,b){if(!this.fe||!a||!b)return!1;this.bfa=a.rowIndex;if(0>this.bfa||this.bfa>=this.yc.tk(this.fe))return!1;this.hfb=this.bfa;this.c5=this.F5b(a);if(0>this.c5||this.c5>=this.yc.Ci(this.fe))return!1;this.d5=this.ETc(b);if(0>this.d5||this.d5>=this.yc.Ci(this.fe))return!1;var c=this.C3i(a,b);a=c?this.e5i(a,b):!1;if(c=c&&a)this.dxe=this.vNj(b.ui);return c}vNj(a){let b=
!0;if(0<this.bfa)for(var c=this.bfa-1;0<=c;){var f=this.fe.nf(c,a);if(f&&!f.isGhostCell){b=!1;break}--c}if(this.hfb<this.fe.HY-1)for(c=this.bfa+1;c<=this.fe.HY-1;){if((f=this.fe.nf(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}h$d(){if(!this.fe)return!1;const a=this.yc.Ci(this.fe);if(0>this.c5||this.c5>=a||0>this.d5||this.d5>=a||0>this.ri||this.ri>=a||0>this.ri+1||this.ri+1>=a)return!1;this.wSg=this.bbe(this.fe,this.c5,this.ri)-this.g9d(this.fe,this.c5);this.xSg=this.bbe(this.fe,this.d5,this.ri+
1)-this.g9d(this.fe,this.d5);return!0}bbe(a,b,c){if(b>c)return this.bbe(a,c,b);if(!a||0>b||b>=this.yc.Ci(a)||0>c||c>=this.yc.Ci(a))return-1;a=a.H6d;let f=0;for(;b<=c;b++)f+=a[b];return Math.floor(this.ul.Nd.Md.Pe(f,0))}g9d(a,b){return mb.StyleReader.nr?mb.StyleReader.nr.O8(a,b):yn.a.Isd}jEa(a,b){return this.ul.Nd.Md.qf(this.g9d(a,b),0)}C3i(a,b){if(!a||!b)return!1;a=a.x5b();const c=b.ui;for(b=b.x5b();b&&(!b.isGhostCell||this.F5b(b)===c);)this.bfa--,this.c5=Math.max(this.c5,this.F5b(a)),this.d5=Math.min(this.d5,
this.ETc(b)),a=a.x5b(),b=b.x5b();return!0}e5i(a,b){if(!a||!b)return!1;a=a.$Rc();const c=b.ui;for(b=b.$Rc();b&&(!a.isGhostCell||this.F5b(b)===c);)this.hfb++,this.c5=Math.max(this.c5,this.F5b(a)),this.d5=Math.min(this.d5,this.ETc(b)),a=a.$Rc(),b=b.$Rc();return!0}F5b(a){return a?(a=a.az())?a.ui:-1:-1}ETc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.az());a=null;b&&(a=b.u8d(2));return a?a.ui:-1}hDf(a){this.$Xe()&&this.Wec?(a=this.ul.gb.RUj?Math.floor((this.v7-a)/this.zoom)+this.oF:Math.floor((a-this.v7)/
this.zoom)+this.oF,a=Math.min(a,this.oF+this.xSg),a=Math.max(a,this.oF-this.wSg)):a=this.nUd(a);return a}YWe(a,b){if(this.$Xe()&&this.Wec){if(!this.pa.gH()){var c=Od.SelectionFactory.Sg(Object(qa.a)(yg.a,this.zma.B4b),0);this.pa.setSelection(c)}let f=c=-1,l=-1;({SQf:c,kQf:f,lQf:l}=this.O9i(a-b[this.ri],b,c,f,l));this.dxe&&(c===this.ri&&Math.abs(f)>=this.jEa(this.fe,c)||c===this.ri+1&&c<this.yc.Ci(this.fe)-1&&Math.abs(l)>=this.jEa(this.fe,c+1)||c===this.ri+1&&c===this.yc.Ci(this.fe)-1)?(va.a.J(512497182,
815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ri.toString(),c.toString(),f.toString(),l.toString()),a=b[this.ri]+b[this.ri+1],c===this.ri?(f=Math.max(f,this.jEa(this.fe,c)),l=a-f):c===this.ri+1&&(l=Math.max(l,this.jEa(this.fe,c)),f=a-l),this.Ks.d0a(this.fe,this.ri,f),this.Ks.d0a(this.fe,this.ri+1,l)):(c>this.c5&&Math.abs(f)<this.jEa(this.fe,c)?(va.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.ri.toString(),c.toString(),f.toString(),l.toString()),this.rgb(c,this.ri+1)):c<this.d5&&Math.abs(l)<this.jEa(this.fe,c+1)?(va.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ri.toString(),c.toString(),f.toString(),l.toString()),this.rgb(c+1,this.ri+1)):(va.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.ri.toString(),c.toString(),f.toString(),l.toString()),this.Rql(c,f,l)),this.Ks.wRe(this.fe),a=ob.GraphIterator.nb(this.fe),this.Ks.b5e(a),this.fe.Hda(511),this.sA.n9b(this.fe))}else this.Ks.d0a(this.fe,this.ri,a),this.Ks.d0a(this.fe,this.ri+1,b[this.ri]+b[this.ri+1]-a)}O9i(a,b,c,f,l){if(!a)return c=this.ri,f=b[this.ri],{SQf:c,kQf:f,lQf:0};f=0;if(0<a){for(c=this.ri;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.ri+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{SQf:c,kQf:f,lQf:l}}rgb(a,b){if(b!==a){var c=
this.G7i(b-1);for(let f=this.bfa;f<=this.hfb;f++){const l=this.fe.nf(f,b),w=this.fe.nf(f,a);this.jFe(c[f],l,w)}}}jFe(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.ui-b.ui,w=a.colSpan+b.colSpan-l;ym.c(Object(qa.a)(yg.a,b),Object(qa.a)(yg.a,c),this.Ks.XUd);ym.c(Object(qa.a)(yg.a,b),Object(qa.a)(yg.a,c),[hb.a.lKa]);var H=ob.GraphIterator.nb(c);H.Ze();var U=new ob.GraphIterator;U.set(Object(qa.a)(yg.a,b));U.Bb(1)&&ym.h(H,null,1,1,U,-1);c.isGhostCell=b.isGhostCell;this.A4d(H);b.io(hb.a.rowSpan,
hb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=w,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}A4d(a){const b=a.currentNode.eb(hb.a.rowId),c=a.currentNode.eb(hb.a.cellId);for(a=Vl.a.rv(a);a.moveNext();){const f=a.currentNode.sa(hb.a.cellId,null);a.currentNode.sa(hb.a.rowId,null)&&a.currentNode.setValue(hb.a.rowId,b);f&&a.currentNode.setValue(hb.a.cellId,c)}}Rql(a,b,c){var f=ob.GraphIterator.nb(this.fe);Rd.moveToFirstRow(f);f.$p(a,1);this.Ks.kfe(f);if(f=this.fe.sa(Za.a.$u,null))f=
Qa.a.clone(f),b<this.jEa(this.fe,a)?(b=this.jEa(this.fe,a),c=f[a]-b):(c=Math.max(c,this.jEa(this.fe,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.fe.setValue(Za.a.$u,f);b=this.ri+1;a+=1;a<=b&&(b+=1);this.rgb(a,b)}G7i(a){const b=Array(this.yc.tk(this.fe));for(let c=this.bfa;c<=this.hfb;c++){const f=this.fe.nf(c,a);b[c]=f.az()}return b}$Xe(){return!!this.fe&&this.fe.Np()&&!this.Eba&&this.ri<this.wG-1}}Object(n.a)(HL,"PowerPointColumnDragAdapter",BL.a,[]);class VD{constructor(a,b){this.Fx=this.p5=null;this.dgc=
this.veb=0;this.ZEb=!1;this.b$=a;this.f0=b}Dv(a){if(3===a.Wf)return!1;a=a.Ec;return Ll.gVa(a)||Ll.Eac(a)}pu(){if(this.ZEb){const a=new qf.GraphTransaction(3);a.kd(this.p5.gb);this.p5.source.Cv(4,!0);a.dispose()}this.end()}end(){this.b$.VR()}dispose(){this.p5=null}}Object(n.a)(VD,"CommonRowHandleDragAdapter",null,[244,106]);class IL extends VD{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){super(a,b);this.txe=this.eDb=!1;this.DIg=this.sHa=0;this.zma=this.fe=this.Zd=this.iwa=this.HIg=this.FIg=this.BIg=
this.EIg=this.CIg=null;this.NIg=this.Te=this.vSg=this.uSg=this.b5=this.a5=this.bIa=this.E0=this.pA=0;this.J$=f;this.Mq=c;this.Tk=l;this.Sdb=w;this.Ks=H;this.yc=U;this.pa=ja;this.sA=wa;this.Dik=Sa;this.ia=ub;this.Tp=Ub;this.hYa=null;this.Xec=this.c7c=this.N6c=!1;this.lr=eb}Uu(a){if(!this.Dv(a))return!1;const b=a.Ec;if(Ll.Eac(b)){va.a.J(512497178,816,50,"drag from table row handle");this.ZEb=!1;var c=Ll.Smj(b);if(!c)return!1;this.fe=Hf.a(c).gb;this.Fx=this.fe.sc(this.Te);if(!this.Fx)return va.a.J(512497177,
816,10,"OnDragStart : m_tableViewElement is null"),!1;this.NIg=this.lr.k9d(this.Fx,a.clientPoint);this.f0.vid(b);return!0}this.p5=Ll.Jij(b);if(!this.p5)return!1;c=Object(qa.a)(155,this.p5.gb);this.Te=this.p5.Ma;this.fe=c?c.getContainingTable():null;if(!this.fe)return!1;this.Fx=this.fe.sc(this.Te);this.hYa=this.Dik.Q8d(this.fe);if(!this.Fx||!this.hYa)return!1;this.eDb=Ll.kke(b);this.txe=Ll.Wke(b);this.veb=this.p5.htmlElement.offsetHeight;this.dgc=this.sHa=a.clientPoint.y;this.f0.nl(21);this.b$.endEditing(!0,
14);this.Zd=this.Fx.Ek;this.c7c=this.N6c=this.Xec=!1;this.ZEb=!0;this.aYe()&&this.Rij(b);this.hUd(b);this.Tp&&this.ia.processAction(D.a.Xja,2);return!0}Gw(a){this.ZEb?(this.sHa=a.clientPoint.y,a=(this.lDf(this.sHa)-this.veb)*(this.eDb?-1:1)+this.DIg,this.iwa.style.top=a+"px"):(a=this.lr.k9d(this.Fx,a.clientPoint),this.Fx.rph(this.NIg,a));return!0}fo(a){let b=null;a&&(b=this.J$.Ei("UserAction","PPTRowResize"),va.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",this.Fx.gb.sa(hb.a.vGb,
""),this.Fx.gb.Np())));if(this.ZEb){var c=this.lDf(a?a.clientPoint.y:this.sHa),f=new qf.GraphTransaction(15);if(this.aYe()&&this.Xec&&this.c7c)fd.a.mark(11077),f.kd(this.fe),this.YWe(c);else{this.p5.vMb(c);var l=this.p5.htmlElement.offsetHeight;fd.a.mark(11077);var w=this.p5.gb;f.kd(w);c=this.b$.Md;w.setValue(hb.a.tu,c.qf(l,1));this.eDb&&l!==this.veb&&(l=this.veb-l)&&(this.Zd.setPosition(this.Zd.x,this.Zd.y+l,!0),l=c.qf(this.Zd.x,0),c=c.qf(this.Zd.y,1),w=this.Fx.Ek.shapeNode,w.Ay=l,w.By=c)}this.$tc();
f.dispose();Pc.App.Kb.updateCommandUI();fd.a.mark(11078);this.end();this.fe?this.Ks.e_a(this.fe):va.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&va.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",this.Fx.gb.sa(hb.a.vGb,""),this.Fx.gb.Np()))}else a&&Pc.App.Kb.l6(a.clientPoint,a.Wf),this.f0.m1()}pu(a){a.C3e?(super.pu(a),this.ZEb&&this.$tc()):this.fo(null)}end(){this.f0.m1();super.end()}lDf(a){a=this.veb+
this.Mq.Sm(a-this.dgc)*(this.eDb?-1:1);if(this.aYe()&&this.Xec&&this.c7c)a=Math.min(a,this.veb+this.vSg),a=Math.max(a,this.veb-this.uSg);else{var b=this.Tk.oJc(this.p5.gb);b=this.p5.Nd.Md.Pe(b,1);a=Math.max(b,a)}return a}hUd(a){this.iwa=a;Sys.UI.DomElement.addCssClass(this.iwa,"ShowDashedLine");this.DIg=a.offsetTop;this.HIg=a.style.marginTop;this.FIg=a.style.width;this.CIg=a.style.left;this.EIg=a.style.top;this.BIg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=a.style.left=
"0";a.style.bottom="auto";if(this.Sdb){const b=Zm.a.X6b(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.p5.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}$tc(){Sys.UI.DomElement.removeCssClass(this.iwa,"ShowDashedLine");this.iwa.style.marginTop=this.HIg;this.iwa.style.width=this.FIg;this.iwa.style.left=this.CIg;this.iwa.style.right="auto";this.iwa.style.top=this.EIg;this.iwa.style.bottom=this.BIg}Rij(a){this.Xec=this.N6c=!1;if(this.fe&&Ll.gVa(a)){var b=null,c=null;({V5a:b,L6a:c}=
this.Qij(a,b,c)).returnValue&&this.F7i(b,c)&&this.h$d()&&(a=this.yc.Ci(this.fe),b=this.yc.tk(this.fe),0<=this.E0&&this.E0<a&&0<=this.bIa&&this.bIa<a&&0<=this.a5&&this.a5<b&&0<=this.b5&&this.b5<b&&(this.Xec=!0),this.c7c=0<this.E0||this.bIa<a-1?!0:!1)}}Qij(a,b,c){if(!Ll.gVa(a)||!this.fe)return{returnValue:!1,V5a:b,L6a:c};a=Zm.a.X6b(a);a=Hf.a(a);this.zma=Object(qa.a)(Zl.TableCellNode,a.gb);if(!this.zma)return{returnValue:!1,V5a:b,L6a:c};a=this.pA=this.zma.rowIndex-1;if(0>a||a>=this.yc.tk(this.fe))return{returnValue:!1,
V5a:b,L6a:c};const f=this.zma.ui;if(0>f||f>=this.yc.Ci(this.fe))return{returnValue:!1,V5a:b,L6a:c};if(this.eDb)return{returnValue:!1,V5a:null,L6a:c};b=this.fe.nf(a,f);if(this.txe)return{returnValue:!1,V5a:b,L6a:null};c=this.fe.nf(a+1,f);return{returnValue:!0,V5a:b,L6a:c}}F7i(a,b){if(!this.fe||!a||!b)return!1;this.E0=a.ui;if(0>this.E0||this.E0>=this.yc.Ci(this.fe))return!1;this.bIa=this.E0;var c=a.az();this.a5=c?c.rowIndex:-1;if(0>this.a5||this.a5>=this.yc.tk(this.fe))return!1;this.b5=this.v8d(b);
if(0>this.b5||this.b5>=this.yc.tk(this.fe))return!1;a=(c=this.Mcj(a,b))?this.yij(a,b):!1;if(a=c&&a)this.N6c=this.wNj(b.rowIndex);return a}h$d(){if(!this.fe)return!1;const a=this.yc.tk(this.fe);if(0>this.a5||this.a5>=a||0>this.b5||this.b5>=a)return!1;this.uSg=this.e8d(this.fe,this.a5,this.pA)-this.XSa(this.fe,this.a5);this.vSg=this.e8d(this.fe,this.b5,this.pA+1)-this.XSa(this.fe,this.b5);return!0}Mcj(a,b){if(!a||!b)return!1;a=a.z9a();const c=b.rowIndex;for(b=b.z9a();b&&a;){var f=b.az();if(b.isGhostCell&&
f&&f.rowIndex!==c)break;this.E0--;if(f=a.az())this.a5=Math.max(this.a5,f.rowIndex);this.b5=Math.min(this.b5,this.v8d(b));a=a.z9a();b=b.z9a()}return!0}yij(a,b){if(!a||!b)return!1;a=a.o_();const c=b.rowIndex;for(b=b.o_();b&&(!b.isGhostCell||b.az().rowIndex===c);)this.bIa++,this.a5=Math.max(this.a5,a.az().rowIndex),this.b5=Math.min(this.b5,this.v8d(b)),a=a.o_(),b=b.o_();return!0}wNj(a){let b=!0,c;if(0<this.E0)for((c=this.fe.nf(a,this.E0))&&(c=c.z9a());c;){if(!c.isGhostCell){b=!1;break}c=c.z9a()}if(this.bIa<
this.fe.h8-1)for((c=this.fe.nf(a,this.bIa))&&(c=c.o_());c;){if(!c.isGhostCell){b=!1;break}c=c.o_()}return b}v8d(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.az());return b&&(b=b.u8d(1))?b.rowIndex:-1}e8d(a,b,c){if(b>c)return this.e8d(a,c,b);if(!a||0>b||b>=this.yc.tk(a)||0>c||c>=this.yc.tk(a))return-1;for(a=0;b<=c;b++)a+=this.hYa[b];return Math.floor(a)}XSa(a,b){a=this.Tk.mUd(a,b);return Math.floor(this.b$.Md.Pe(a,1))}YWe(a){if(!this.pa.gH()){var b=this.zma.x5b().az().B4b;b=Od.SelectionFactory.Sg(Object(qa.a)(yg.a,
b),0);this.pa.setSelection(b)}let c=b=-1;var f=-1;({TQf:b,iQf:c,jQf:f}=this.P9i(a-this.hYa[this.pA],this.hYa,b,c,f));if(this.N6c&&(b===this.pA&&Math.abs(c)>=this.XSa(this.fe,this.pA)||b===this.pA+1&&b<this.yc.tk(this.fe)&&Math.abs(f)>=this.XSa(this.fe,this.pA+1)||b===this.pA+1&&b===this.yc.tk(this.fe)-1)){va.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.pA.toString(),b.toString(),c.toString(),
f.toString());f=ob.GraphIterator.nb(this.fe);this.Fjc(f,this.pA);a=f.currentNode;var l=this.hYa[this.pA];const H=a.sc(this.Te);Rd.moveToNextRow(f);f=f.currentNode;var w=this.hYa[this.pA+1];const U=f.sc(this.Te);w=l+w;l=this.b$.Md;b===this.pA+1&&(c+=this.hYa[this.pA]);H.vMb(Math.floor(c));b=H.htmlElement.offsetHeight;a.setValue(hb.a.tu,l.qf(b,1));b=w-b;b=Math.max(b,this.XSa(this.fe,this.pA+1));U.vMb(Math.floor(b));f.setValue(hb.a.tu,l.qf(U.htmlElement.offsetHeight,1))}else b>this.a5&&Math.abs(c)<this.XSa(this.fe,
b)?(va.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.pA.toString(),b.toString(),c.toString(),f.toString()),this.rgb(b,this.pA+1)):b<this.b5&&Math.abs(f)<this.XSa(this.fe,b+1)?(va.a.J(512497170,815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.pA.toString(),b.toString(),c.toString(),f.toString()),
this.rgb(b+1,this.pA+1)):(va.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.pA.toString(),b.toString(),c.toString(),f.toString()),this.Sql(b,c,f)),this.Ks.wRe(this.fe),b=ob.GraphIterator.nb(this.fe),this.Ks.b5e(b),this.fe.Hda(511),this.sA.n9b(this.fe)}P9i(a,b,c,f,l){if(!a)return c=this.pA,f=b[this.pA],{TQf:c,iQf:f,jQf:0};f=0;if(0<a){for(c=this.pA;f<a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=
this.pA+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{TQf:c,iQf:f,jQf:l}}rgb(a,b){if(b!==a){var c=this.H7i(b-1);b=this.fe.nf(b,this.E0);a=this.fe.nf(a,this.E0);for(let f=this.E0;f<=this.bIa;f++)this.jFe(c[f],b,a),b=b.o_(),a=a.o_()}}jFe(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,w=a.rowSpan+b.rowSpan-l;ym.c(Object(qa.a)(yg.a,b),Object(qa.a)(yg.a,c),this.Ks.XUd);ym.c(Object(qa.a)(yg.a,b),Object(qa.a)(yg.a,c),[hb.a.lKa]);var H=ob.GraphIterator.nb(c);H.Ze();var U=new ob.GraphIterator;
U.set(Object(qa.a)(yg.a,b));U.Bb(1)&&ym.h(H,null,1,1,U,-1);c.isGhostCell=b.isGhostCell;this.A4d(H);b.io(hb.a.rowSpan,hb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=w);a.ui===H.yq.ui&&(a.rowSpan=l)}}A4d(a){const b=a.currentNode.eb(hb.a.rowId),c=a.currentNode.eb(hb.a.cellId);for(a=Vl.a.rv(a);a.moveNext();){const f=a.currentNode.sa(hb.a.cellId,null);a.currentNode.sa(hb.a.rowId,null)&&a.currentNode.setValue(hb.a.rowId,b);f&&a.currentNode.setValue(hb.a.cellId,c)}}Sql(a,b,c){var f=
ob.GraphIterator.nb(this.fe);this.Fjc(f,a);const l=f.currentNode;f=this.Ks.lfe(f);const w=this.b$.Md,H=l.sc(this.Te);H.vMb(Math.floor(b));l.setValue(hb.a.tu,w.qf(H.htmlElement.offsetHeight,1));c=Math.max(c,this.XSa(this.fe,a+1));f.setValue(hb.a.tu,w.qf(Math.floor(c),1));b=this.pA+1;a+=1;a<=b&&(b+=1);this.rgb(a,b)}Fjc(a,b){if(!(14!==a.vi||0>b||b>=this.yc.tk(a.currentNode)))for(Rd.moveToFirstRow(a);0<b--;)Rd.moveToNextRow(a)}H7i(a){a=this.fe.nf(a,this.E0);const b=Array(this.yc.Ci(this.fe));for(let c=
this.E0;c<=this.bIa;c++)b[c]=a.az(),a=a.o_();return b}aYe(){return!!this.fe&&this.fe.Np()&&!this.eDb&&!this.txe}}Object(n.a)(IL,"PowerpointRowHandleDragAdapter",VD,[]);class WD{constructor(a,b,c,f){this.sA=f;this.SGa=a;this.SGa.kk(Object(F.a)(this,this.ph,"onPropertyChanged"))}ph(a,b){a=b.property;(b=Object(qa.a)(125,b.node))&&(a===hb.a.colSpan||a===hb.a.rowSpan)&&(b=b.getContainingTable())&&(this.sA.Qlk(b),b.ZY=null)}dispose(){this.SGa.Rm(Object(F.a)(this,this.ph,"onPropertyChanged"))}}Object(n.a)(WD,
"TableCellNodeBehavior",null,[106]);class JL extends Xb.a{constructor(a,b){super(a,b,"TableCellSelected")}LYg(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.S_a)?Sys.UI.DomElement.addCssClass(a,this.S_a):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.S_a)&&Sys.UI.DomElement.removeCssClass(a,this.S_a)}}Object(n.a)(JL,"TableCellSelectionBehavior",Xb.a,[1119,513]);class KL extends Sys.EventArgs{constructor(a){super();this.t2h=a}get tableCellNode(){return this.Oul.tableCellNode}get Oul(){return this.t2h}}
Object(n.a)(KL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class XD extends Sys.EventArgs{constructor(a){super();this.$Ji=a}}Object(n.a)(XD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var Xp=d(189);class ft extends Iv{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){super(a,b,f,l,Ab.a.instance.resolve("Box4.ITableCellReader"),Ab.a.instance.resolve("Box4.IParagraphReader"),Ab.a.instance.resolve("Box4.IOutlineElementNavigator"),Ab.a.instance.resolve("Box4.ITableNavigator"),Ab.a.instance.resolve("Box4.IOutlineElementReader"),
Ab.a.instance.resolve("Box4.Styles.IStyleReader"),Ab.a.instance.rb("Box4.IFeatureHelper"),new JL(a,b),Ab.a.instance.rb("Box4.Styles.ITableCellspacingReader"),Ab.a.instance.resolve("Box4.TableCellViewElementSettings"));this.Pye=this.Qye=this.zbd=this.Fbd=this.KFb=this.Ch=this.Ofb=this.qO=this.zO=this.F0=null;this.oma=!1;this.Ula=null;this.oj=Object(qa.a)(125,b);this.Ea=c;this.sA=w;this.Tk=H;this.Lc=U;this.sGa=ja;this.yc=wa;this.Sdb=Sa;this.uDb=eb;this.t0=ub;this.V7c=Ub;this.Jec=Pd.a("PPTOEnableTableDiagonalBorders");
this.pa=cc;this.gva=this.$0f();(this.Sdb||this.uDb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}L6(){}Ny(a){super.Ny(a);this.Sdb&&!this.Nd.Wl&&this.Cal()}VDa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}Nlg(){const a=this.pa.m4i(),b=this.oj.getContainingTable();return b?Array.contains(a,b):!1}CUk(a){switch(a){case "Top":this.Ch.style.top="-0.5px";this.Ch.style.borderTopWidth="1px";break;case "Right":this.Ch.style.right=
"-0.5px";this.Ch.style.borderRightWidth="1px";break;case "Bottom":this.Ch.style.bottom="-0.5px";this.Ch.style.borderBottomWidth="1px";break;case "Left":this.Ch.style.left="-0.5px",this.Ch.style.borderLeftWidth="1px"}}BUk(a){switch(a){case "Top":this.Ch.style.top="0px";this.Ch.style.borderTopWidth="0px";break;case "Right":this.Ch.style.right="0px";this.Ch.style.borderRightWidth="0px";break;case "Bottom":this.Ch.style.bottom="0px";this.Ch.style.borderBottomWidth="0px";break;case "Left":this.Ch.style.left=
"0px",this.Ch.style.borderLeftWidth="0px"}}uld(a){this.Ch&&(this.Nlg()?this.CUk(a):this.BUk(a))}Aal(a,b,c){const f=!Pd.a("TableBorderOutsideBorderHalfClippingDisabled");this.o2d();var l=ob.GraphIterator.nb(this.gb);l.rc(14);var w=l.Jg(14);l=this.yc.tk(w);w=this.yc.Ci(w);c=c?c.oV():"";switch(a){case "Top":b=this.Nd.Md.Pe(b,1);!this.oj.rowIndex&&f?(this.Ch.style.top="0px",this.Ch.style.borderTopWidth=b/2+"px"):(this.Ch.style.top=-b/2+"px",this.Ch.style.borderTopWidth=b+"px");this.Ch.style.borderTopColor=
c;break;case "Bottom":b=this.Nd.Md.Pe(b,1);this.oj.rowIndex+this.oj.rowSpan===l&&f?(this.Ch.style.bottom="0px",this.Ch.style.borderBottomWidth=b/2+"px"):(this.Ch.style.bottom=-b/2+"px",this.Ch.style.borderBottomWidth=b+"px");this.Ch.style.borderBottomColor=c;break;case "Left":b=this.Nd.Md.Pe(b,0);!this.oj.ui&&f?(this.Ch.style.left="0px",this.Ch.style.borderLeftWidth=b/2+"px"):(this.Ch.style.left=-b/2+"px",this.Ch.style.borderLeftWidth=b+"px");this.Ch.style.borderLeftColor=c;break;case "Right":b=this.Nd.Md.Pe(b,
0);this.oj.ui+this.oj.colSpan===w&&f?(this.Ch.style.right="0px",this.Ch.style.borderRightWidth=b/2+"px"):(this.Ch.style.right=-b/2+"px",this.Ch.style.borderRightWidth=b+"px");this.Ch.style.borderRightColor=c;break;case "DiagonalUp":this.Jec&&(b=this.Nd.Md.Pe(b,0),this.bRf(a,b,c));break;case "DiagonalDown":this.Jec&&(b=this.Nd.Md.Pe(b,0),this.aRf(a,b,c))}this.hth()}bRf(a,b,c){this.VSf();this.Qye||(this.Qye=this.AKf());this.Oqh(this.Qye,a,b,c)}aRf(a,b,c){this.VSf();this.Pye||(this.Pye=this.AKf());this.Oqh(this.Pye,
a,b,c)}AKf(){const a=new qm.a;this.Fbd.appendChild(a.xa);this.Xo(a.xa);return a}Oqh(a,b,c,f){b=this.YDi(b);a.v1(b);a.Zu(f);a.mr(c)}YDi(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.x6d(),this.z6d());case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.z6d(),this.x6d())}va.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}VSf(){this.o2d();this.KFb||(this.KFb=this.Nd.jp(Ga.a.div),this.KFb.className="PPTTableDiagonalBorder",this.Ofb.appendChild(this.KFb),
this.Xo(this.KFb));this.zbd||(this.zbd=new rm.a,this.Fbd=this.zbd.xa,this.KFb.appendChild(this.Fbd),this.Xo(this.Fbd));this.zbd.Dya(String.format("0 0 {0} {1}",this.z6d(),this.x6d()))}o2d(){this.Ofb||(this.Ofb=this.Nd.jp(Ga.a.div),this.Ofb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.Ofb,this.htmlElement.firstChild),this.Xo(this.Ofb));this.Ch||(this.Ch=this.Nd.jp(Ga.a.div),this.Ch.className="PPTTableBorder",this.Ofb.appendChild(this.Ch),this.Xo(this.Ch))}hth(){this.V7c&&
Pd.a("MergeDifferentBordersFixEnabled")?this.Ch.style.zIndex=this.DAb(this.oj)?"1":(this.wUa(this.oj.fza)||this.wUa(this.oj.Bga))&&(this.wUa(this.oj.eza)||this.wUa(this.oj.Cga))?"3":"2":this.Ch.style.zIndex=(this.wUa(this.oj.fza)||this.wUa(this.oj.Bga))&&(this.wUa(this.oj.eza)||this.wUa(this.oj.Cga))?"1":"0"}DAb(a){return 1<a.rowSpan||1<a.colSpan}jNj(a){return"DiagonalUp"===a||"DiagonalDown"===a}VKa(a,b,c,f){const l=this.V7c&&Pd.a("MergeDifferentBordersFixEnabled")&&this.DAb(this.oj);this.V7c&&!this.jNj(a)&&
this.Nlg()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":l&&!this.wKj()&&(b=0);this.Ch.style.borderTopWidth=b+"px";this.Ch.style.borderTopColor=c;this.Ch.style.borderTopStyle=f;this.Ch.style.top=-b/2+"px";break;case "Right":l&&!this.vKj()&&(b=0);this.Ch.style.borderRightWidth=b+"px";this.Ch.style.borderRightColor=c;this.Ch.style.borderRightStyle=f;this.Ch.style.right=-b/2+"px";break;case "Bottom":l&&!this.pKj()&&(b=0);this.Ch.style.borderBottomWidth=b+"px";this.Ch.style.borderBottomColor=
c;this.Ch.style.borderBottomStyle=f;this.Ch.style.bottom=-b/2+"px";break;case "Left":l&&!this.rKj()&&(b=0);this.Ch.style.borderLeftWidth=b+"px";this.Ch.style.borderLeftColor=c;this.Ch.style.borderLeftStyle=f;this.Ch.style.left=-b/2+"px";break;case "DiagonalUp":this.Jec&&this.bRf(a,b,c);break;case "DiagonalDown":this.Jec&&this.aRf(a,b,c)}}z6d(){var a=0;for(let b=0;b<this.oj.colSpan;b++)a+=this.oj.getContainingTable().H6d[this.oj.ui+b];a=this.Nd.Md.Pe(a,0);return Math.round(100*a)/100}x6d(){var a=this.yc.xUc(this.oj.getContainingTable(),
this.oj.rowIndex,this.oj.rowIndex+this.oj.rowSpan-1);let b=0;for(let c of a)Object(Ya.a)(155,c)?b+=c.sa(hb.a.tu,0):va.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",c));this.oj.marginTop+this.oj.marginBottom>b&&va.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.oj.marginTop,this.oj.marginBottom));b=Math.max(b,this.oj.marginTop+this.oj.marginBottom);
a=this.Nd.Md.Pe(b,1);return Math.round(100*a)/100}wKj(){if(!this.oj.rowIndex)return!0;const a=this.oj.getContainingTable();if(!a)return!0;const b=this.oj.rowIndex-1;var c=this.oj.ui;const f=c+this.oj.colSpan-1;for(;c<=f;c++){const l=a.nf(b,c);if(l&&(l.isGhostCell||this.DAb(l)))return!0}return!1}rKj(){if(!this.oj.ui)return!0;const a=this.oj.getContainingTable();if(!a)return!0;const b=this.oj.ui-1;var c=this.oj.rowIndex;const f=c+this.oj.rowSpan-1;for(;c<=f;c++){const l=a.nf(c,b);if(l&&(l.isGhostCell||
this.DAb(l)))return!0}return!1}vKj(){const a=this.oj.getContainingTable();if(!a||this.oj.ui+this.oj.colSpan===this.yc.Ci(a))return!0;const b=this.oj.ui+this.oj.colSpan;var c=this.oj.rowIndex;const f=c+this.oj.rowSpan-1;for(;c<=f;c++){const l=a.nf(c,b);if(l&&(l.isGhostCell||this.DAb(l)))return!0}return!1}pKj(){const a=this.oj.getContainingTable();if(!a||this.oj.rowIndex+this.oj.rowSpan===this.yc.tk(a))return!0;const b=this.oj.rowIndex+this.oj.rowSpan;var c=this.oj.ui;const f=c+this.oj.colSpan-1;for(;c<=
f;c++){const l=a.nf(b,c);if(l&&(l.isGhostCell||this.DAb(l)))return!0}return!1}Cal(){var a=!Pd.a("TableBorderOutsideBorderHalfClippingDisabled");this.o2d();if(a){a=ob.GraphIterator.nb(this.gb);a.rc(14);var b=a.Jg(14);a=this.yc.tk(b);b=this.yc.Ci(b);var c=this.VDa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.VKa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.oj.ui?this.Ch.style.left=-c/2+"px":(this.Ch.style.left="0px",this.Ch.style.borderLeftWidth=
c/2+"px");c=this.VDa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.VKa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);this.oj.ui+this.oj.colSpan===b?(this.Ch.style.right="0px",this.Ch.style.borderRightWidth=c/2+"px"):this.Ch.style.right=-c/2+"px";b=this.VDa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.VKa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);
this.oj.rowIndex?this.Ch.style.top=-b/2+"px":(this.Ch.style.top="0px",this.Ch.style.borderTopWidth=b/2+"px");b=this.VDa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);this.VKa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.oj.rowIndex+this.oj.rowSpan===a?(this.Ch.style.bottom="0px",this.Ch.style.borderBottomWidth=b/2+"px"):this.Ch.style.bottom=-b/2+"px"}else a=this.VDa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),
this.VKa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.VDa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),this.VKa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.VDa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.VKa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.VDa(this.htmlElement.style.borderBottom,
this.htmlElement.style.borderBottomWidth),this.VKa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.$Qf();this.V7c&&this.hth();this.htmlElement.style.border=""}$Qf(){this.Jec&&(this.qse&&this.Nqh("DiagonalUp",this.qse),this.pse&&this.Nqh("DiagonalDown",this.pse))}wUa(a){return!!a}Nqh(a,b){const c=b.split(" ");if(3!==c.length)va.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",
b));else{var f=c[0];b=this.VDa(b,c[1]);this.VKa(a,b,c[2],f)}}Muc(a,b,c,f,l,w,H){if(!this.t0||this.Ea.en(this.oj).eb(hb.a.isResizable))this.uDb?this.RGl(l,w,H):this.QGl(a,b,c,f,l,w,H)}RGl(a,b,c){this.uGa||(this.uGa=this.QLc(),this.Xo(this.uGa));this.F0||(this.F0=this.ZQa(),this.Xo(this.F0));a?Sys.UI.DomElement.addCssClass(this.F0,"First"):Sys.UI.DomElement.removeCssClass(this.F0,"First");b^!!this.zO&&(b?(this.zO=this.ZQa(),this.Xo(this.zO)):(this.pKb(this.zO),this.zO=null));this.zO&&Sys.UI.DomElement.addCssClass(this.zO,
"Last");c^!!this.qO&&(c?(this.qO=this.QLc(),this.Xo(this.qO)):(this.pKb(this.qO),this.qO=null));this.qO&&Sys.UI.DomElement.addCssClass(this.qO,"FirstLeft")}QGl(a,b,c,f,l,w,H){super.Muc(a,b,c,f,l,w,H);this.Ktb&&this.Xo(this.Ktb);this.F0||(this.F0=this.ZQa(),this.Xo(this.F0));this.F0.style.left=a+"px";this.F0.style.top=b+"px";this.F0.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.F0,"First"):Sys.UI.DomElement.removeCssClass(this.F0,"First");w^!!this.zO&&(w?(this.zO=this.ZQa(),this.Xo(this.zO)):
(this.pKb(this.zO),this.zO=null));this.zO&&(this.zO.style.bottom="0",this.zO.style.left=a+"px",this.zO.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.zO,"Last"));H^!!this.qO&&(H?(this.qO=this.QLc(),this.Xo(this.qO)):(this.pKb(this.qO),this.qO=null));this.qO&&(this.qO.style.left="0",this.qO.style.top=b+"px",this.qO.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.qO,"FirstLeft"));this.Sdb&&(this.F0.style.left="0",this.F0.style.top="0",this.Ktb&&(this.Ktb.style.left=c+"px",this.Ktb.style.top=
"0",this.Ktb.style.height=f+"px"),this.zO&&(this.zO.style.left="0"),this.qO&&(this.qO.style.top="0"))}Bqh(){var a=this.Nd.Md,b=a.Pe(this.Tk.nta(this.gb,3),1);this.mja.style.paddingTop=b+"px";b=a.Pe(this.Tk.nta(this.gb,0),1);this.mja.style.paddingBottom=b+"px";b=a.Pe(this.Tk.nta(this.gb,1),0);this.mja.style.paddingLeft=b+"px";a=a.Pe(this.Tk.nta(this.gb,2),0);this.mja.style.paddingRight=a+"px"}Eal(a,b){const c=this.Nd.Md;switch(b){case L.a.Vsc:a=c.y_(a.marginTop,1);this.mja.style.paddingTop=a+"px";
break;case L.a.Psc:a=c.y_(a.marginBottom,1);this.mja.style.paddingBottom=a+"px";break;case L.a.Qsc:a=c.y_(a.marginLeft,0);this.mja.style.paddingLeft=a+"px";break;case L.a.Usc:a=c.y_(a.marginRight,0),this.mja.style.paddingRight=a+"px"}}NU(){var a=this.Tk.nta(this.gb,1),b=this.Tk.nta(this.gb,2);const c=this.Tk.p5b(this.gb,5),f=this.Tk.p5b(this.gb,6);var l=this.Nd.Md;a=l.Pe(a+c,0);b=l.Pe(b+f,0);l=l.Pe(this.Tk.gDf(this.gb),0);return new Kj.a(a,l,b)}iHh(){this.htmlElement.style.background=this.sA.o0f(this.gb)}AU(){if(!this.Ch)super.AU();
else if(!this.Nd.Wl&&this.hB){const a=Object(qa.a)(1119,this.IR);a&&a.LYg(this.Ch)}}ZQa(){const a=this.FLf();a.className="TableRowResizeHandle";return a}pKb(a){T.a.rKa(a);za.a.$O(a)}get tableCellNode(){return this.oj}get t2c(){return this.Ula}get Ek(){this.gva||(this.gva=this.$0f());return this.gva}set Ek(a){this.gva=a}get aq(){return this.oma}zMb(a){this.oma=a;this.tableCellNode.nzb=a}lock(a){this.aq&&this.Ula===a||(this.Ek.ysd(),this.Ula=a,this.zMb(!0),this.Lc.Gy(new Xp.a(7)),this.sGa.Qfh(new XD(a)),
this.sGa.lRk(new KL(this)))}unlock(){this.aq&&(this.Ula=null,this.zMb(!1),this.Lc.Gy(new Xp.a(7)),this.sGa.Qfh(new XD(null)))}$0f(){let a=null;const b=this.Ea.en(this.oj);b&&(a=Object(qa.a)(117,b.ng(this.Ma)));return a}}Object(n.a)(ft,"TableCellViewElement",Iv,[1120,494,346,106]);var Yz=d(300),gR=d(504);class jm extends Sh{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){super(a,b);Sh.j3a=()=>Yq.LUf(gh.a.create());this.Tk=c;this.Ml=f;this.AJ=w;this.jYa=l;this.yc=H;this.o5=U;this.gYa=ja;this.pDb=wa;this.Te=Sa;
this.b7c=Pd.a("PPTOEnableTableDiagonalBorders")}aGf(a,b){Sh.lui(a,b,hd.TableReader.Ci(a))}ILf(a,b,c,f=null,l=!1){const w=a.parentNode.eb(hb.a.shapeId);a.currentNode.setValue(hb.a.shapeId,w);for(var H=0;H<b;++H){var U=new gR.a;a.Cl(U,1);U.setValue(hb.a.shapeId,w);U.setValue(hb.a.rowId,gh.a.create())}b=null;H=!0;a.Bb(1);do{U=a.currentNode.eb(hb.a.rowId);for(let ja=0;ja<c;++ja){const wa=this.osa();a.Cl(wa,1);wa.setValue(hb.a.shapeId,w);wa.setValue(hb.a.rowId,U);wa.setValue(hb.a.cellId,gh.a.create());
({bph:b,isFirst:H}=this.cXf(a,wa,l,f,b,H));Rd.returnToContainingRow(a)}}while(a.Fj(1))}e_a(a){if(this.b7c&&a&&(a=this.yc.HF(a)))for(const b of a)b&&!b.isGhostCell&&(a=Object(qa.a)(ft,b.sc(this.Te)))&&a.$Qf()}cTe(a,b,c,f,l){var w=this.AJ.mSc(a);for(var H=0;H<w.length;H++){const U=this.Tk.Usb(a,H);w[H]=Math.max(U,w[H]*b)}a.setValue(Za.a.$u,w);if(1!==c)for((new ob.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){w=l.qf(f.Fij(c),1);H=this.Tk.mUd(a,c);w<=H&&(w=0);b.setValue(hb.a.tu,w);if(b.Akg())break;
else b=b.aJa;c++}this.e_a(a)}zal(a,b){a=this.yc.HF(a);for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].gpa=b}}yal(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let w=0;w<l.length;w++){var c=l.ga(w).iterator;c.rc(16);c.Jg(16);c=c.yq;const H=c.cellShading;H.anchorField=b;c.cellShading=H;c.gpa=b}}}j9b(a,b,c,f,l){super.j9b(a,b,c,f,l);c=[];Array.add(c,hb.a.tu);ym.b(f,b,c);c=a.currentNode.eb(hb.a.shapeId);const w=a.yq.eb(hb.a.sid);a=a.yq.eb(hb.a.cid);const H=
Yq.zJf(gh.a.create());b.setValue(hb.a.sid,w);b.setValue(hb.a.cid,a);b.setValue(hb.a.shapeId,c);b.setValue(hb.a.rowId,H);this.$Gl(f,b,l)}Z8b(a,b,c,f,l){super.Z8b(a,b,c,f,l);return this.Xed(a.currentNode,b,c,f,!1,!1)}DYb(a,b,c,f,l){super.DYb(a,b,c,f,l);return this.Xed(a.currentNode,b,c,f,l,!1)}get XUd(){if(!jm.Aaa){jm.Aaa=[];let a,b,c;for(const f of jm.D3c)if(this.b7c||2!==f&&1!==f)({iQa:b,M6a:a,ysb:c}=Wp.fTa(f)),Array.add(jm.Aaa,b),Array.add(jm.Aaa,a),Array.add(jm.Aaa,c);Array.add(jm.Aaa,Za.a.GE);
Array.add(jm.Aaa,hb.a.cellShading);Array.add(jm.Aaa,Va.a.$Nb);Array.add(jm.Aaa,Va.a.bOb);Array.add(jm.Aaa,Va.a.cOb);Array.add(jm.Aaa,Va.a.ZNb);Array.add(jm.Aaa,hb.a.kP)}return jm.Aaa}Xed(a,b,c,f,l,w){c=w?this.euj(b,c,l):this.fuj(b,c,f,l);ym.c(c,b,this.XUd);f=a.eb(hb.a.cid);w=a.eb(hb.a.shapeId);const H=c.eb(hb.a.cellId),U=a.eb(hb.a.rowId);b.setValue(hb.a.sid,a.eb(hb.a.sid));b.setValue(hb.a.cid,f);b.setValue(hb.a.shapeId,w);b.setValue(hb.a.rowId,U);l?b.setValue(hb.a.cellId,H):b.setValue(hb.a.cellId,
b.id.Bq);return c}zwf(a,b,c,f,l,w){a=a.currentNode;const H=Array(c);let U=0,ja=0,wa=0;for(;U<f;U++)H[U]=b[U],ja+=H[U];for(l=l?b[f]:b[f-1];U<f+w;U++)H[U]=l,wa+=H[U];for(;U<c;U++)H[U]=b[U-w],ja+=H[U];b=ja/(wa+ja);for(U=0;U<c;U++)H[U]=Math.max(H[U]*b,this.Tk.Usb(a,U));return H}wkc(a,b,c,f,l){super.wkc(a,b,c,f,l);var w=a.eb(hb.a.nlb);l=Array(w.length+f);let H=0;for(;H<b;H++)l[H]=w[H];for(;H<b+f;H++)l[H]=jm.eGi();for(;H<l.length;H++)l[H]=w[H-f];a.setValue(hb.a.nlb,l);w=c?l[b+f]:l[b-1];a=Object(qa.a)(Yz.TableNode,
a);this.rEl(a,w,l.slice(b,f+b),b,c);if(this.pDb)for(l=this.gYa.create(a),f=b+f,w=(!c||!b)&&b<this.yc.Ci(a)-1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.o5.D4d(a,l,c,0,this.yc.tk(a),w)}xIe(a,b,c,f){super.xIe(a,b,c,f);if(this.pDb){a=Object(qa.a)(158,a);const l=this.gYa.create(a);f=c+f;const w=(!b||!c)&&c<this.yc.tk(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.o5.B4d(a,l,b,0,this.yc.Ci(a),w)}}RHe(a,b,c){super.RHe(a,b,c);this.sPb(a,hb.a.complexTable);this.pDb&&(a=Object(qa.a)(158,a.currentNode),c=this.gYa.create(a),
this.o5.B4d(a,c,b,0,this.yc.Ci(a),!0))}QHe(a,b,c){super.QHe(a,b,c);const f=a.currentNode.eb(hb.a.nlb),l=Array(f.length-c);let w=0;for(;w<b;w++)l[w]=f[w];for(;w<l.length;w++)l[w]=f[w+c];a.currentNode.setValue(hb.a.nlb,l);this.sPb(a,hb.a.complexTable);this.pDb&&(a=Object(qa.a)(158,a.currentNode),c=this.gYa.create(a),this.o5.D4d(a,c,b,0,this.yc.tk(a),!0))}$Gl(a,b,c){b.setValue(hb.a.gUk,a.eb(hb.a.rowId));b.setValue(hb.a.insertBefore,c)}rEl(a,b,c,f,l){a=a.firstRow;do for(let w=0;w<c.length;++w){const H=
ob.GraphIterator.nb(a),U=H.$p(f+w,1);U.setValue(hb.a.fUk,b);U.setValue(hb.a.insertBefore,l);U.setValue(hb.a.cellId,c[w]);jm.bsh(H,hb.a.cellId,c[w])}while(a=a.aJa)}osa(){const a=super.osa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}wHe(a,b){this.Qsj(a,b,c=>{c.currentNode.isGhostCell=!1;Sh.Ux.h9b(c,null,!0);const f=c.currentNode.eb(hb.a.rowId),l=c.currentNode.eb(hb.a.cellId);for(c=Vl.a.rv(c);c.moveNext();){const w=c.currentNode.sa(hb.a.cellId,null);c.currentNode.sa(hb.a.rowId,null)&&c.currentNode.setValue(hb.a.rowId,
f);w&&c.currentNode.setValue(hb.a.cellId,l)}})}Mld(a){hd.TableReader.Lu(a.currentNode)&&this.iih(a,b=>b.Mh(hb.a.tu),(b,c)=>{b.we(hb.a.tu,c)},hb.a.complexTable)}wRe(a){a&&(a=ob.GraphIterator.nb(a),this.Mld(a,0))}Ooa(a,b){if(a)for(a=this.Ml.jsa(a),a.em(c=>15===c.vi,null);a.moveNext();){const c=Object(qa.a)(155,a.iterator.currentNode),f=this.jYa.P9a(c);c.setValue(hb.a.tu,f*b)}}hLa(a,b){if(a&&14===a.type){const c=this.AJ.mSc(a);for(let f=0;f<c.length;f++){const l=this.Tk.Usb(a,f);c[f]=Math.max(l,c[f]*
b)}a.setValue(Za.a.$u,c)}}Nsh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(hb.a.tu,te.a.UW(b))}Msh(a,b,c){if(a&&b&&0<b.length){const f=this.AJ.mSc(a);for(let l=0;l<b.length;l++)f[b[l]]=te.a.UW(c);a.setValue(Za.a.$u,f)}}lfe(a){const b=new ob.GraphIterator;b.Rc(a);var c=b.currentNode;b.Bb(1);const f=a.zc();this.Fza(a);const l=Fs.a.instance.createInstance(393251);this.j9b(a,l,c,c,!1);a.Pk(l);c=this.yc.Ci(f);for(let w=0;w<c;++w){const H=this.osa();super.DYb(a,H,b.currentNode,!1,!0);this.Xed(l,H,
b.currentNode,!1,!0,!0);b.Cf(1)}this.gMb(f,this.yc.tk(f)+1);return a.currentNode}kfe(a){const b=ob.GraphIterator.nb(a.vJh());let c=this.yc.Ci(b.currentNode);var f=this.AJ.lSc(Object(qa.a)(125,a.currentNode));a=f+1;this.Fza(b);b.Bb(1);do{const l=b.$p(f,1);b.zc();const w=this.osa();super.Z8b(b,w,l,!1,!1);this.Xed(b.currentNode,w,l,!1,!1,!0)}while(b.Fj(1));(f=b.currentNode.sa(Za.a.$u,null))&&(f=Qa.a.clone(f));this.QLb(b.currentNode,++c);f&&(Array.insert(f,a,0),b.currentNode.setValue(Za.a.$u,f));this.wkc(b.currentNode,
a,!1,1,null)}b5e(a){this.sPb(a,hb.a.complexTable)}euj(a,b,c){let f=b;const l=b.WIa;if(l)if(b.isGhostCell)Sh.WTc(l,!c)||Sh.Pjb(l.controlCell,c,Sh.Awb(l.controlCell,c)+1);else{let w=Sh.Awb(b,c);1<w&&(f=Sh.baj(l,!c));Sh.Pjb(b,c,w+1)}else Sh.Pjb(b,c,2);a.isGhostCell=!0;return f}static bsh(a,b,c){a.currentNode.we(b,c);let f=a.Ii();if(f){for(;f;)jm.bsh(a,b,c),f=a.lp();a.zc()}}static eGi(){return Yq.zJf(gh.a.create())}}jm.Aaa=null;jm.D3c=[5,6,7,0,2,1];Object(n.a)(jm,"TableEditor",Sh,[1118]);const LL=(a,
b,c,f,l)=>{const w=l.HY,H=l.$ra;var U=l.tableLook;const ja=0<(U&32);l=0<(U&128);const wa=0<(U&64),Sa=0<(U&256),eb=ja?1:0,ub=l?1:0;U=a?a===w-c?wa?3:(a-eb)%2+eb:(a-eb)%2+eb:0;w-c||(U=ja?0:wa?3:(a-eb)%2+eb);a=b?b===H-f?Sa?3:(b-ub)%2+ub:(b-ub)%2+ub:0;H-f||(a=l?0:Sa?3:(b-ub)%2+ub);return{VCf:U,TCf:a}};class YD{constructor(a){this.L0=a;this.M8c=Array(4);for(a=0;4>a;a++)this.M8c[a]=Array(4)}Z_f(a,b,c,f){let l,w;({VCf:l,TCf:w}=LL(a,b,c,f,this.L0));if(!this.M8c[l][w]){c=Object.assign(new jr.a,{he:b,Nf:b+f,
re:a,$f:a+c});a=this.M8c[l];b=w;f=this.L0;var H=f.tableStyle,U=new rp;U.latinField=Ze.qub(1,0);U.eaField=Ze.qub(1,1);U.csField=Ze.qub(1,2);U.solidFillField=Object.assign(new Wu.a,{schemeClrField:Object.assign(new rh.a,{valField:1})});H&&(new oL(U)).PZ(f,c);c=U;H=f.V0j;f=new Tx;H=H||new nL;for(U=1;9>=U;U++){var ja=pL(H,U);const wa=U-1;f.oKe[wa]=ja?Jc.a(Jc.c(ja)):new At;ja=f.oKe[wa].defRPrField;f.stb[wa]=ja?Jc.a(Jc.c(ja)):new rp}for(H=1;9>=H;H++)qL(f.stb[H-1],c);a[b]=f}return this.M8c[l][w]}B1f(a,b,
c,f,l){let w=tc.a.nRa;a&&(b=this.Z_f(b,c,f,l))&&b.stb&&0<b.stb.length&&(b=b.stb[0])&&(w=ie.Box4ColorHelper.LKb(b,a));return w}}Object(n.a)(YD,"TableListStyleCache",null,[1117]);class ZD{constructor(a,b,c,f){this.SGa=a;this.JVg=b;this.SGa.kk(Object(F.a)(this,this.ph,"onPropertyChanged"));this.SGa.Eia(Object(F.a)(this,this.onConnected,"onConnected"));this.Te=c;this.lxe=f}onConnected(a,b){a=Object(qa.a)(158,b.node);this.JVg.iJh(a)}ph(a,b){a=b.property;b=Object(qa.a)(158,b.node);a===Za.a.$u?this.JVg.iJh(b):
a===Za.a.iza||a===Za.a.Dga||a===Za.a.TA?b.ZY=null:!this.lxe||a!==hb.a.RUa&&a!==hb.a.isResizable&&a!==hb.a.FL||b.sc(this.Te).Y5e()}dispose(){this.SGa.Rm(Object(F.a)(this,this.ph,"onPropertyChanged"));this.SGa.qoa(Object(F.a)(this,this.onConnected,"onConnected"))}}Object(n.a)(ZD,"TableNodeBehavior",null,[106]);var hR=d(187);class Kv{constructor(a,b,c,f,l,w,H,U){this.z0=this.bR=this.Kn=this.rHa=this.w0=this.Hbd=this.KGa=null;this.Beb=this.z9c=0;this.JIg=this.kgc=this.Zd=this.Fx=null;this.sO=a;this.ia=
c;this.Mq=f;this.Ks=l;this.ZC=w;this.J$=b;this.gq=H;this.Tp=U}WK(){this.z0=this.bR=this.Kn=this.w0=this.rHa=null;null!==this.gq&&this.gq.Xxa()}Dv(a){if(!a||a.uA===Sys.UI.MouseButton.rightButton||this.sO.O_)return!1;this.Zd=(this.Fx=Object(qa.a)(1111,this.ZC.KI(a.Ec)))?this.Fx.Ek:null;if(!this.Zd)return!1;this.KGa=this.Fx.Dti;if(!this.KGa)return!1;this.bR=this.KGa.Rdg(a.Ec);if(!this.bR)return!1;this.Tp&&this.ia.processAction(D.a.Xja,2);return!0}Uu(a){if(!a||!this.Dv(a))return!1;this.Hbd=this.Fx=this.ZC.KI(this.KGa.xa);
if(!this.Fx)return va.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),!1;this.ia.processAction(L.a.v7a,2);this.KGa.SD(!0);this.Zd.SD(!0);null!==this.gq&&this.gq.vya($i.a.CNb);this.z0=this.Hbd.T6b();this.z9c=this.Mq.Sm(gd.a.lm(this.z0.ga(0),this.z0.ga(1)));this.Beb=this.Mq.Sm(gd.a.lm(this.z0.ga(0),this.z0.ga(3)));this.rHa=this.xJf(a.clientPoint);this.w0=new gd.a(0,0);this.Kn=new Xi.a;this.JIg=new gd.a(this.Zd.x+this.z9c,this.Zd.y+this.Beb);return!0}Gw(a){if(!a)return!1;
a=this.xJf(a.clientPoint);var b=gd.a.fV(a,this.rHa);this.w0=gd.a.add(this.w0,b);b=Vk.oUd(this.bR,this.z0,this.w0,!1,!1);this.Kn=Object.assign(new Xi.a,{bottom:this.Mq.Sm(b.bottom),left:this.Mq.Sm(b.left),right:this.Mq.Sm(b.right),top:this.Mq.Sm(b.top)});let c;({kLh:b,oLh:c}=this.mDf());const f=new hR.a;f.lca(b,c);f.hC(this.Kn.left,this.Kn.top);this.KGa.Qq(f);this.rHa=a;return!0}fo(a){let b=null;a&&(b=this.J$.Ei("UserAction","PPTTableResize"),va.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",
this.Fx.gb.sa(hb.a.vGb,""),hd.TableReader.Lu(this.Fx.gb))));this.KGa.Xz(!1);({kLh:l,oLh:w}=this.mDf());this.Fx.Qsh(l,w);this.g1e();const c=new qf.GraphTransaction(15);c.kd(this.Fx.gb);var f=this.Fx.Nd.Md;this.Ks.cTe(Object(qa.a)(Yz.TableNode,this.Fx.gb),l,w,this.Hbd,f);if(Kv.eFa(this.bR)||Kv.eFa(this.bR,!0)){var l=this.Fx.Ek.shapeNode;var w=f.qf(this.Zd.x,0);f=f.qf(this.Zd.y,1);l.Ay=w;l.By=f}this.Zd.Xz(!1);c.dispose();this.WK();Pc.App.Kb.updateCommandUI();b&&b.stop();a&&va.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",
this.Fx.gb.sa(hb.a.vGb,""),hd.TableReader.Lu(this.Fx.gb)))}g1e(){var a=Kv.eFa(this.bR),b=Kv.eFa(this.bR,!0);if(a||b){b=this.Hbd.T6b();a=this.Mq.Sm(b.$b-b.hc);b=this.Mq.Sm(b.Yb-b.kc);const c=this.JIg;c._x+=this.Kn.right;c._y+=this.Kn.bottom;this.Zd.setPosition(c.x-a,c.y-b,!0)}}pu(){this.w0&&(this.KGa.Xz(!0),this.KGa.Qq(null),this.Zd.Xz(!0),this.WK())}mDf(){return{kLh:this.z9c?1+(this.Kn.right-this.Kn.left)/this.z9c:1,oLh:this.Beb?1+(this.Kn.bottom-this.Kn.top)/this.Beb:1}}xJf(a){a=gd.a.vSa(a);var b=
this.bR;this.bR.K9b()||(b=b.ixb());const c=this.z0.sk(b);b=this.z0.sk(b.$8a());return a=new gd.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static eFa(a,b=!1){return a.equals(ne.a.Ru)?!0:b?a.equals(ne.a.north)||a.equals(ne.a.DE):a.equals(ne.a.west)||a.equals(ne.a.RH)}}Object(n.a)(Kv,"TableResizeDragAdapter",null,[244]);class $D{constructor(a,b){this.L0=a;this.MFb=b;this.li=Array(4);for(a=0;4>a;a++)this.li[a]=Array(4);this.WDe=Array(16)}v6d(a,b,c,f){let l,
w;({VCf:l,TCf:w}=LL(a,b,c,f,this.L0));this.li[l][w]||(this.li[l][w]=this.MFb.H3k(this.L0,a,b,c,f));c=this.li[l][w].clone();if(a=this.Dpj(a,b))for(const H of a.bA())c.Sa(H)||c.we(H,a.Mh(H));return c}clear(){for(let a=0;4>a;a++)this.li[a]=Array(4);this.WDe=Array(16)}Dpj(a,b){var c=a===this.L0.HY-1;const f=b===this.L0.$ra-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.WDe[l])||(this.WDe[l]=c=this.MFb.b4k(this.L0,a,b));return c}}Object(n.a)($D,"TableStyleCache",null,[1116]);class ML{constructor(a){this.gXa=
a}H3k(a,b,c,f,l){const w=a.HY;var H=a.$ra,U=a.tableLook;const ja=a.tableStyle;a=a.Jd;const wa=new sq.a,Sa=0<(U&32),eb=0<(U&128),ub=!b&&Sa,Ub=!c&&eb;f=b===w-f&&0<(U&64);l=c===H-l&&0<(U&256);H=!(U&512)&&!ub&&!f;U=!(U&1024)&&!Ub&&!l;this.c4k(ja.wholeTblField,wa);H&&this.dya((Sa?1!==(b&1):b&1)?ja.band2HField:ja.band1HField,a,wa);U&&this.dya((eb?1!==(c&1):c&1)?ja.band2VField:ja.band1VField,a,wa);l&&this.dya(ja.lastColField,a,wa);Ub&&this.dya(ja.firstColField,a,wa);f&&(this.dya(ja.lastRowField,a,wa),l&&
this.dya(ja.seCellField,a,wa),Ub&&this.dya(ja.swCellField,a,wa));ub&&(this.dya(ja.firstRowField,a,wa),l&&this.dya(ja.neCellField,a,wa),Ub&&this.dya(ja.nwCellField,a,wa));return wa}b4k(a,b,c){var f=a.HY;const l=a.$ra;var w=a.tableStyle;a=a.Jd;const H=new sq.a;if(w&&0<=b&&b<f&&0<=c&&c<l){const U=!c;f=b===f-1;c=c===l-1;(w=w.wholeTblField)&&w.tcStyleField&&(w=w.tcStyleField.tcBdrField)&&(this.x_a(7,b?w.insideHField:w.topField,a,H),this.x_a(0,f?w.bottomField:w.insideHField,a,H),this.x_a(5,U?w.leftField:
w.insideVField,a,H),this.x_a(6,c?w.rightField:w.insideVField,a,H))}return H}imh(a,b,c){const f=new sq.a;this.fmh(a,c,b,f);return f}c4k(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.we(hb.a.cellShading,a.tcStyleField.fillField)}dya(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.we(hb.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.x_a(7,a.topField,b,c),this.x_a(0,a.bottomField,b,c),this.x_a(5,a.leftField,b,c),this.x_a(6,a.rightField,b,c))}x_a(a,b,c,f){b&&b.itemField&&
this.fmh(a,b.itemField,c,f)}fmh(a,b,c,f){let l;({iQa:l,M6a:a}=Wp.fTa(a));b.wFieldSpecified&&f.we(l,te.a.F1d(b.wField));if(b.solidFillField)if(this.gXa)f.we(a,b.solidFillField);else{if(b=ie.Box4ColorHelper.gjb(b.solidFillField,c))b=ie.Box4ColorHelper.Jga(b),f.we(a,b)}else b.noFillField&&(this.gXa&&Pd.a("TableBordersLocalRenderingFix")?(b=ie.Box4ColorHelper.YR({Color:"##T,0,0,0"}),f.we(a,b),f.we(l,0)):f.we(a,tc.a.nRa))}}Object(n.a)(ML,"TableStyleResolver",null,[295]);var NL=d(329),aE=d(188);class Vx{constructor(a,
b,c,f=null){this.Mwa=!1;this.lB=this.ao=this.qb=this.Nug=this.IXg=null;this.WC=[];this.Hk=this.kA=!1;this.H0=null;this.So=this.Idb=!1;this.Fa=b;this.fJg=a;this.Zc=f;this.cU=(this.T6c=c)?10:6;this.KBe=c?2:Pf.a.TE}get visible(){return this.Mwa}set visible(a){this.Mwa!==a&&(this.Mwa=a,this.msh())}get xa(){return this.qb.viewport.xa}pji(a,b,c){this.IXg=a;this.Nug=c;this.Jm();this.Zc.pb(sa.a.click,this.xa,Object(F.a)(this,this.o1g,"notifySelectShapeByClick"));b.appendChild(this.qb.viewport);this.IXg.PM(this.xa,
!0);this.Idb=!0;this.setZIndex(2+vD.a.jba+1)}fGh(){this.Idb&&this.qb&&this.Zc.yb(sa.a.click,this.xa,Object(F.a)(this,this.o1g,"notifySelectShapeByClick"));this.Idb=!1}setZIndex(a){this.Idb&&this.qb.OB(a)}Jm(){this.qb||(this.qb=new aE.a,this.ao=new qm.a,this.ao.PE(Ik.a.none),this.ao.Zu(Pf.a.E1),this.ao.mr(Pf.a.TE),this.qb.nl($i.a.EA),this.qb.appendChild(this.ao),this.lB=new pm.a,this.L1b(this.lB),this.qb.appendChild(this.lB),this.qb.Rd(!1),this.qb.viewport.xa.setAttribute(Ik.a.lIb,Ik.a.none))}Rl(){if(this.Idb){var a=
this.Qjj(this.Nug);this.kA?(this.H0&&this.H0.El(a),this.ao.Et(a.points)):(a=a.points,this.ao.Et(a),a=new cj.a(a[0],a[1],a[2],a[3]));this.yY(a);this.qb.Rl()}}L1b(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new pm.a;l.xa.id=b;if(B.a.ELa){var c=new NL.a;c.xa.id=b;c.xa.setAttribute("class",Ck.a.Osd);c.setVisibility(!1);c.setPosition(-10,-10);c.lh(20,20);l.appendChild(c)}c=new NL.a;c.xa.id=b;c.xa.setAttribute("class",Ck.a.Osd);b=this.cU/2*-1;c.setPosition(b,b);c.lh(this.cU,this.cU);this.T6c&&
c.psh(this.cU/2,this.cU/2);c.PE("white");c.Zu(Pf.a.E1);c.mr(this.KBe);c.Ish();l.appendChild(c);l.$j(1);this.WC[f]=l;a.appendChild(l)}}yY(a){for(let b=0;8>b;++b){const c=this.WC[b];c.nl(Vx.Npc[b]);this.ZKa(c,a.sk(new ne.a(b)))}}Qjj(a){return new cj.a(new gd.a(0,0),new gd.a(a.offsetWidth,0),new gd.a(a.offsetWidth,a.offsetHeight),new gd.a(0,a.offsetHeight))}OE(a){this.So||((this.kA=a)?(this.ao.PE(Pf.a.YQf),this.ao.Zu(Pf.a.E1),this.ao.mr(Pf.a.TE),this.lB.Rd(!1),this.fJg.endEditing(!0,14)):(this.ao.PE(Ik.a.none),
this.ao.Zu(Pf.a.E1),this.ao.mr(Pf.a.TE),this.lB.Rd(!0),this.Fa.rf(Lb.a.sg),this.fJg.VR()))}dispose(){this.Hk||(this.fGh(),this.ao=this.qb=null,Array.clear(this.WC),this.lB=null,this.Idb=!1,this.Hk=!0)}Rdg(a){if(!this.Idb)return null;for(let b=0;8>b;++b)if(this.WC[b].xa.id===a.id)return new ne.a(b);return null}ZKa(a,b){a.setPosition(b.x,b.y)}o1g(a){return this.Rdg(a.Ec)?!0:!1}SD(a){this.OE(!0,a)}Xz(){this.OE(!1)}Qq(a){this.H0&&this.H0.clear();this.H0=a;this.Rl()}Ox(a){this.So=a;this.msh()}msh(){this.qb&&
this.qb.Rd(!this.So&&this.Mwa)}static w1b(a){return new Vx(a,Ab.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,u.AFrameworkApplication.Aa.Ly)}}Vx.Npc=[$i.a.r0e,$i.a.q0e,$i.a.p0e,$i.a.o0e,$i.a.s0e,$i.a.t0e,$i.a.u0e,$i.a.v0e];Object(n.a)(Vx,"DraggablePandoraChromeView",null,[1121]);class OL{}Object(n.a)(OL,"TableStyleCategoryInfo",null,[]);class Nf{static UTi(){if(Nf.fh)return Nf.fh;Nf.fh=new Vc.a;
Nf.fh.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);Nf.fh.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));Nf.fh.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));Nf.fh.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,3));Nf.fh.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,4));Nf.fh.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));Nf.fh.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));Nf.fh.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);Nf.fh.$("Themed Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));Nf.fh.$("Themed Style 2 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));Nf.fh.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));Nf.fh.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));Nf.fh.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,5));Nf.fh.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,6));Nf.fh.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));Nf.fh.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));Nf.fh.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,2));Nf.fh.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,3));Nf.fh.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));Nf.fh.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));Nf.fh.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));Nf.fh.$("Light Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));Nf.fh.$("Light Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));Nf.fh.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));Nf.fh.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));Nf.fh.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,4));Nf.fh.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,5));Nf.fh.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));Nf.fh.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));Nf.fh.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,1));Nf.fh.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,2));Nf.fh.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));Nf.fh.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));Nf.fh.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));Nf.fh.$("Light Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));Nf.fh.$("Medium Style 1",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));Nf.fh.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));Nf.fh.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));Nf.fh.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,3));Nf.fh.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,4));Nf.fh.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));Nf.fh.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));Nf.fh.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,2));Nf.fh.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
2,1));Nf.fh.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));Nf.fh.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));Nf.fh.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));Nf.fh.$("Medium Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));
Nf.fh.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));Nf.fh.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));Nf.fh.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));Nf.fh.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,2));Nf.fh.$("Medium Style 3 - Accent 3",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));Nf.fh.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));Nf.fh.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));Nf.fh.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,6));Nf.fh.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,
ResourceStrings.l_TableStyleMedium,4));Nf.fh.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));Nf.fh.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));Nf.fh.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));Nf.fh.$("Medium Style 4 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
4,4));Nf.fh.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));Nf.fh.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));Nf.fh.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Nf.fh.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,1));Nf.fh.$("Dark Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));Nf.fh.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));Nf.fh.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));Nf.fh.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,5));Nf.fh.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,6));Nf.fh.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Nf.fh.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));Nf.fh.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,2,3));Nf.fh.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,
ResourceStrings.l_TableStyleDark,2,4,5));return Nf.fh}static w8f(a){const b=Nf.UTi();return b.Gb(a)?b.ga(a):a}}Nf.fh=null;Object(n.a)(Nf,"TableStyleNameReader",null,[]);class PL{constructor(a){this.gyg=!1;this.MBb=[];this.mwe=new qd.a(0);this.Qqe=[];this.zSg=a}Z1d(){this.gyg||(this.gyg=this.UGk())}UGk(){const a=this.zSg.instance?this.zSg.instance.ivl:null;if(a&&a.tblStyleCategoriesField){let b=0;this.MBb=[];this.mwe=new qd.a(0);this.Qqe=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=
a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.Qqe,Object.assign(new OL,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const w=f.tblStylesField[l],H=new K.DictionaryPropertySet,U=new UD(w,f.idField,l);H.we(hb.a.tableStyle,U);this.MBb.push(H);this.mwe.$(w.styleIdField.toLowerCase(),b++)}}}return!0}return!1}IRc(){return this.MBb}Kxb(a){return 0<=a&&a<this.MBb.length?this.MBb[a]:null}Zlj(a,b){let c=null;
for(const f of this.Qqe)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.Kxb(a):null}imj(a){return this.P6b(a).dY.styleIdField}jmj(a){return(a=this.P6b(a).dY.styleNameField)?Pd.a("TableStyleNameLocalization")?Nf.w8f(a):a:""}bmj(a){return this.P6b(a).Aug}P6b(a){return a.Mh(hb.a.tableStyle)}v8f(a){return(a=this.$mj(a))?a.Mh(hb.a.tableStyle):null}$mj(a){this.Z1d();return this.MBb[this.mwe.ga(a.toLowerCase())]}}Object(n.a)(PL,"TableStyleGalleryManager",null,[296]);class QL{constructor(a,b,
c,f,l){this.OL=0;f||(f=Object.assign(new jr.a,{re:0,$f:c.UO,he:0,Nf:c.AR}));this.Zqe=a;this.xik=b;this.Zma=c;this.rE=f;this.fA=new jr.a;this.IO=this.OL=-1;this.K5c=l}get Dmg(){return-1===this.IO||-1===this.OL}moveNext(){this.Dmg&&(this.IO=this.rE.re,this.fA.Nf=this.rE.he);for(;;){this.OL=this.fA.Nf;if(this.OL>=this.rE.Nf&&(this.OL=this.rE.he,++this.IO>=this.rE.$f))return this.reset(),!1;this.fA=this.Zqe.EI(this.Zma,this.IO,this.OL);if(this.IO===this.rE.re||this.IO===this.fA.re)if(!this.K5c||this.K5c.sOd(this))return!0}}tok(){this.Dmg&&
(this.OL=this.rE.he,this.fA.$f=this.rE.re);for(;;){this.IO=this.fA.$f;if(this.IO>=this.rE.$f&&(this.IO=this.rE.re,++this.OL>=this.rE.Nf)){this.reset();break}this.fA=this.Zqe.EI(this.Zma,this.IO,this.OL);if(this.OL===this.rE.he||this.OL===this.fA.he)if(!this.K5c||this.K5c.sOd(this))break}}moveTo(a,b){this.fA=this.Zqe.EI(this.Zma,a,b);if(!this.fA.uWi(this.rE))return this.reset(),!1;this.IO=Math.min(Math.max(a,this.rE.re),this.rE.$f-1);this.OL=Math.min(Math.max(b,this.rE.he),this.rE.Nf-1);return!0}reset(){this.IO=
this.OL=-1}u5b(){return this.xik.nf(this.fA.re,this.fA.he)}}Object(n.a)(QL,"CellIterator",null,[1180]);class RL{constructor(a){this.Kq=a}zDa(a,b,c,f=null){return new QL(this.Kq,a,b,c,f)}}Object(n.a)(RL,"CellIteratorFactory",null,[290]);class bE{constructor(a,b,c){this.Kq=b;this.Zma=c;this.QC=this.Kq.DPc(this.Zma,a.rE);this.C9=Array(this.QC.AR*(this.QC.UO+1));this.IO=this.QC.re;this.Acb=this.QC.he;this.RBb=this.QC.he-1;this.Lq=0;this.Mee(a)}Mee(a){const b=a.rE;for(;a.moveNext();){const f=a.fA;for(let l=
f.he;l<f.Nf;l++){var c=this.UDa(f.re,l);this.C9[c]=0!==this.C9[c]?2:l<b.he&&f.re>b.re?16:l>=b.Nf&&f.re>b.re?64:1;c=this.UDa(f.$f,l);this.C9[c]=0!==this.C9[c]?2:l<b.he&&f.$f<b.$f?16:l>=b.Nf&&f.$f<b.$f?64:4}}}UDa(a,b){return this.QC.AR*(a-this.QC.re)+(b-this.QC.he)}moveNext(){this.Acb=this.RBb;do{this.Acb++;this.Acb>=this.QC.Nf&&(this.IO++,this.Acb=this.QC.he);if(this.IO>this.QC.$f)return!1;this.Lq=this.C9[this.UDa(this.IO,this.Acb)]}while(0===this.Lq);for(this.RBb=this.Acb;this.RBb+1<this.QC.Nf&&this.C9[this.UDa(this.IO,
this.RBb+1)]===this.Lq;)this.RBb++;return!0}J6i(){return this.RBb+1}y9a(){return this.Lq}static zje(a){return!!(a&87)}}Object(n.a)(bE,"HorizontalTableBorderIterator",null,[1178,409]);class SL{constructor(a){this.Kq=a}bFi(a,b){return new bE(a,this.Kq,b)}}Object(n.a)(SL,"HorizontalTableBorderIteratorFactory",null,[291]);var Zz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=
4]="rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Zz||(Zz={}));Object(n.b)("LayoutInvalidateTrigger",Zz);class TL{constructor(){this.ija=this.hTd=this.Ztc=
this.sXd=0}get rowSpan(){return this.hTd-this.Ztc}toString(){return String.format("C[{0}][{1}]",this.Ztc,this.ija)}}Object(n.a)(TL,"CellInfo",null,[]);class kr{constructor(){this.TYc=!1;this.Uc=this.HEf=this.telemetry=null;this.Pbb=this.zrc=!1;this.Qsd=null;this.qZg=0;this.tableNode=this.hoe=this.Wya=null;this.m3d=!1}}Object(n.a)(kr,"LayoutContext",null,[]);class UL{constructor(){this.Fxh=this.jwd=0}}Object(n.a)(UL,"LayoutTelemtry",null,[]);class cE{constructor(){this.offset=this.ojc=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",
this.index,this.ojc,this.offset)}}Object(n.a)(cE,"RowSeamInfo",null,[]);class Lh{constructor(a,b,c,f,l,w,H){this.VC=null;this.XCb=[];this.hIa=[];this.KX=0;this.Hk=this.z8c=!1;this.Oeb=null;this.v7c=!1;this.D8c=0;this.Pf=null;this.zz=a;this.zb=f;this.Tk=w;this.Pb=c;this.bY=H;this.m9b(1)}UIj(a,b){if(!this.z8c&&!this.v7c)try{2!==this.KX&&(1===this.KX?this.XCb[0]!==a&&this.m9b(b):(this.XCb[this.XCb.length]=a,this.KX=1,this.D8c=b))}catch(c){this.m9b(0),va.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",
c.toString())}}m9b(a){this.v7c||2===this.KX||this.z8c||(this.KX=2,this.XCb=[],this.D8c=a)}Gce(){return 0!==this.KX&&!this.z8c}get yYc(){return this.KX}ZHh(a){this.Gce()&&(a=Object.assign(new kr,{tableNode:a}),this.layout(a))}TFl(a,b){this.Gce()?this.Oeb||(this.Oeb=new Le.a(3,1,0,Object(F.a)(this,this.MFk,"performLayout"),90,"9"),this.Oeb.customData=Object.assign(new kr,{tableNode:a,TYc:!0,hoe:b}),this.zb.Db(this.Oeb)):b&&b(!1)}MFk(a){this.layout(Object(qa.a)(kr,a.customData))}layout(a){this.v7c=!0;
const b=new ii.a(null,Object(F.a)(this,this.gGj,"initializeLayoutState"),a);b.Qi=!a.TYc;b.run()}gGj(a,b){b=Object(qa.a)(kr,b);try{this.qTi();b.Uc=this.Pf;b.telemetry=new UL;this.VJl();if(!this.Gce())return a.Yg(Object(F.a)(this,this.oza,"tearDownLayout")),!0;this.KX=0;if(!b.tableNode.isConnected)return a.Yg(Object(F.a)(this,this.oza,"tearDownLayout")),!0;const c=Object(qa.a)(1111,b.tableNode.sc(this.zz));if(!c)return a.Yg(Object(F.a)(this,this.oza,"tearDownLayout")),!0;b.Qsd=c;b.Uc.Va(Lh.shi,b.TYc.toString());
b.tableNode.Np()?(b.Uc.Va(Lh.$pg,Zz[this.D8c]),a.Yg(Object(F.a)(this,this.qKk,"prepareTableMetrics"))):(b.Uc.Va(Lh.$pg,"tableComplexityChange"),b.zrc=!0,b.Pbb=!0,a.Yg(Object(F.a)(this,this.oza,"tearDownLayout")))}catch(c){b.Uc.Va(Lh.kbc,c.message),a.Yg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}qKk(a,b){b=Object(qa.a)(kr,b);try{b.Wya=new Date,this.bY.mch(b.tableNode,this.zz),b.Uc.Va(Lh.lKk,(+new Date-+b.Wya).toString()),b.Uc.Va(Lh.znk,this.bY.cNj.toString()),a.Yg(Object(F.a)(this,this.N_j,
"layoutBaselineTable"))}catch(c){b.Uc.Va(Lh.kbc,c.message),a.Yg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}N_j(a,b){b=Object(qa.a)(kr,b);try{b.Wya=new Date;b.m3d=!0;b.qZg=Lh.Gmk;this.VC=[];this.VC[this.VC.length]=Object.assign(new cE,{index:0,ojc:0,offset:0});const c=new Ke.a(this.zz);c.set(b.tableNode);if(!c.Bb(1))throw Error.invalidOperation(Lh.LVf);const f=b.tableNode;let l=c.currentNode,w=l,H=0,U=0,ja=0;for(;l;){15===l.type&&(w=l,ja=H=0,l=c.Bb(1));const wa=l;if(!wa)throw va.a.J(512495690,
808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===wa.rowSpan){const Sa=Object(qa.a)(ft,l.sc(this.zz));H=Math.max(H,this.bY.v5b(f,Sa.mja,U,ja))}l=c.Fj(1);ja++;if(!l){const Sa=Object.assign(new cE,{index:this.VC.length});let eb=w.sa(hb.a.tu,0);eb=Math.max(eb,this.Tk.oJc(w));let ub=b.Qsd.Nd.Md.Pe(eb,1);ub=Math.max(ub,H);Sa.offset=ub+this.VC[Sa.index-1].offset;Sa.ojc=ub;this.VC[this.VC.length]=Sa;l=c.Cf(1);U++}}a.Yg(Object(F.a)(this,
this.S_j,"layoutRowSeams"));b.Uc.Va(Lh.Q_j,(+new Date-+b.Wya).toString())}catch(c){b.Uc.Va(Lh.kbc,c.message),b.zrc=!0,a.Yg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}S_j(a,b){b=Object(qa.a)(kr,b);try{if(1===this.VC.length)throw Error.create(Lh.iXi);let c=b.HEf;if(!c){b.Wya=new Date;c=new Ke.a(this.zz);c.set(b.tableNode);if(!c.Bb(1))throw Error.invalidOperation(Lh.LVf);b.HEf=c}const f=b.tableNode;let l=c.currentNode,w=0,H=0,U=0;for(;l&&w<b.qZg;){15===l.type&&(l=c.Bb(1),H=0);const ja=l;if(!ja)throw va.a.J(512495687,
808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");w++;b.telemetry.jwd++;1===ja.rowSpan||jj.OutlineReader.isEmpty(c)?b.telemetry.Fxh++:this.U_j(this.vDi(f,ja,U,H),b.Uc);l=c.Fj(1);H++;l||(l=c.Cf(1),U++)}l||(this.eul(),a.Yg(Object(F.a)(this,this.N_i,"fixupTableMinRowHeight")),b.Uc.Va(Lh.T_j,(+new Date-+b.Wya).toString()))}catch(c){b.Uc.Va(Lh.kbc,c.message),b.zrc=!0,a.Yg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}N_i(a,b){b=
Object(qa.a)(kr,b);try{const l=b.Qsd;b.Wya=new Date;const w=[];var c=new Ke.a(this.zz);c.set(b.tableNode);for(var f=c.Bb(1);f;)w[w.length]=c.Xq,f=c.Fj(1);if(this.hIa.length===w.length){c=[];for(f=0;f<w.length;++f)c[f]=0,1<Math.abs(this.hIa[f]-w[f].htmlElement.offsetHeight)&&(c[f]=this.hIa[f]);for(f=0;f<c.length;++f)0<c[f]&&w[f].vMb(c[f]*l.N9d())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.hIa.length,w.length));a.Yg(Object(F.a)(this,this.oza,"tearDownLayout"));b.Uc.Va(Lh.J_i,
(+new Date-+b.Wya).toString());b.Pbb=!0}catch(l){b.Uc.Va(Lh.kbc,l.message),b.zrc=!0,a.Yg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}oza(a,b){a=Object(qa.a)(kr,b);a.Wya=new Date;a.zrc?(this.x4k(a.Uc,a.tableNode,a.Qsd),a.m3d=!0):a.Uc&&(a.Uc.Va(Lh.W_j,a.telemetry.jwd.toString()),a.Uc.Va(Lh.V_j,a.telemetry.Fxh.toString()));this.Oeb&&!a.TYc&&this.zb.Mg(this.Oeb);this.v7c=!1;this.Oeb=null;this.D8c=0;a.Uc&&(a.Uc.Va(Lh.Pbb,a.Pbb.toString()),!a.Pbb&&a.Uc&&a.Uc.Va(Lh.tableLayout,this.bY.i1d(a.tableNode)),
a.Uc.Va(Lh.Hvl,(+new Date-+a.Wya).toString()),a.Uc.finish());a.Pbb||(this.z8c=!0);this.VC=null;this.XCb=[];this.Pf=null;this.bY.reset();a.hoe&&a.hoe(a.m3d);return!1}x4k(a,b,c){if(b.isConnected)try{const f=new Ke.a(this.zz);f.set(b);let l=f.Bb(1);for(;l;){const w=Object(qa.a)(Jv,f.jRa);if(!w)throw Error.argument("tableRowViewElement");let H=c.Nd.Md.Pe(l.sa(hb.a.tu,0),1);const U=c.N9d();H*=U;w.vMb(H);l=f.Fj(1)}}catch(f){a&&a.Va(Lh.w4k,f.message)}}U_j(a,b){if(!a)throw Error.create(Lh.hXi);var c=this.VC[a.Ztc];
const f=this.VC[a.hTd];c=Math.max(this.fej(c,f),a.sXd)-(f.offset-c.offset);if(!(0>=c)&&(this.wdi(f.index,c),f.offset<=this.VC[f.index-1].offset)){b.Va(Lh.lri,a.toString());for(a=0;a<=f.index;++a)b.Va(Lh.Z7k,this.VC[a].toString());throw Error.create(Lh.jXi);}}eul(){if(this.VC){this.hIa=[];for(let a=1;a<this.VC.length;++a)this.hIa[this.hIa.length]=this.VC[a].offset-this.VC[a-1].offset}else this.hIa=null}wdi(a,b){if(b)for(var c=a,f=0;c<this.VC.length;){b=c===a?b:b+this.VC[c].ojc-this.VC[c].offset+f;
if(0>=b)break;f=this.VC[c].offset;this.VC[c].offset+=b;c++}}fej(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.VC[a+1].ojc,a++;return c}vDi(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(qa.a)(ft,b.sc(this.zz)),w=this.Pb.Mc(b);w.rc(14);a=Object.assign(new TL,{sXd:this.bY.v5b(a,l.mja,c,f),Ztc:ok.c(w),ija:f});a.hTd=a.Ztc+b.rowSpan;return a}dispose(){this.Hk||(this.XCb=this.VC=this.hIa=null,this.KX=0,this.Hk=!0)}VJl(){if(this.Hk)throw Error.invalidOperation("table layout service is already disposed");
}qTi(){this.Pf||(this.Pf=Rc.a.zk("TableLayout"))}get Ma(){return this.zz}}Lh.Gmk=25;Lh.kbc="FailureReason";Lh.w4k="RestoreFailureReason";Lh.tableLayout="Layout";Lh.Z7k="SI";Lh.lri="CI";Lh.shi="FAsync";Lh.W_j="CellVisited";Lh.V_j="CellSkipped";Lh.Pbb="Succeeded";Lh.Q_j="LETD";Lh.T_j="LRST";Lh.J_i="FMTR";Lh.Hvl="TDLD";Lh.lKk="PM";Lh.$pg="Trigger";Lh.znk="MC";Lh.hXi="CellDisconnected";Lh.iXi="ChildOfTableNotLoaded";Lh.jXi="SeamPositionInvariant";Lh.LVf="NoRowViewElement";Object(n.a)(Lh,"PPTTableLayoutService",
null,[1179,106]);class VL{constructor(a,b,c,f,l){this.Pb=a;this.zb=b;this.Bik=c;this.Tk=f;this.bY=l}create(a,b){return new Lh(a,b,this.Pb,this.zb,this.Bik,this.Tk,this.bY)}}Object(n.a)(VL,"PPTTableLayoutServiceFactory",null,[298]);class XL{constructor(a,b,c,f,l,w,H,U,ja){this.Dfk=a;this.Qo=b;this.Pb=c;this.iYa=f;this.NVg=l;this.Pfb=w;this.ugc=H;this.yt=U;this.Q6c=!0;this.Zwe=ja;this.Hva=new Vc.a;this.Qo.RF&&!this.Qo.Vj&&(this.Q6c=!1);this.Q6c&&(this.iYa.WPd(Object(F.a)(this,this.S2g,"onBeforeTableViewElementDisconnected")),
this.iYa.Eia(Object(F.a)(this,this.L7g,"onTableNodeConnected")),this.iYa.kk(Object(F.a)(this,this.N7g,"onTableNodePropertyChanged")),this.iYa.R7(Object(F.a)(this,this.M7g,"onTableNodeDisconnected")),this.NVg.kk(Object(F.a)(this,this.P7g,"onTableRowNodePropertyChanged")),this.Pfb.kk(Object(F.a)(this,this.Ugd,"onTableCellNodePropertyChanged")),this.Pfb.wF(Object(F.a)(this,this.K7g,"onTableCellNodeChildTopoChanged")),this.ugc.kk(Object(F.a)(this,this.Q5g,"onParagraphNodePropertyChanged")),this.yt.eci(Object(F.a)(this,
this.j7g,"onSlideInvalidateRenderSize")))}HUc(a,b){if(!this.Q6c)return null;var c=a.id.toString();this.Hva.Gb(c)||this.Hva.$(c,new Gr.a);c=this.Hva.ga(c);var f=a.Np();f=this.Zwe?f&&hd.TableReader.NIf(Object(qa.a)(ob.GraphIterator,this.Pb.Mc(a))):f;if(c.Gb(b))return b=c.ga(b),f||0!==b.yYc||(this.Aih(a),b=null),b;if(f)c.$(b,this.Dfk.create(b,a.id));else return null;return c.ga(b)}Yyb(a,b,c){a.Np()?this.vgg(a.id.toString(),b,c):10===c&&this.vgg(a.id.toString(),b,c)}vgg(a,b,c){if(this.Hva.Gb(a))for(let f of this.Hva.ga(a).values)b?
f.UIj(b,c):f.m9b(c)}sie(a,b,c){a.isConnected&&(a=this.Pb.Mc(a),a.rc(14)&&this.Yyb(a.Sw(14),b,c))}MIj(a){a.isConnected&&(a=this.Pb.Mc(a),a.rc(14)&&this.Yyb(a.Sw(14),a.Sw(16),2))}S2g(a,b){b.Yr.Qc.pp&&this.Yyb(b.Yr.gb,null,9)}L7g(a,b){this.Yyb(b.node,null,8);a=Object(qa.a)(Yz.TableNode,b.node);a=!!a&&a.Np();va.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}M7g(a,b){this.Aih(b.node)}Aih(a){a=a.id.toString();if(this.Hva.Gb(a)){const b=this.Hva.ga(a);for(let c of b.values)c&&c.dispose();this.Hva.remove(a)}}N7g(a,
b){a=b.property;b.node.isConnected&&(a===Za.a.$u||a===Za.a.Dga||a===Za.a.TA||a===hb.a.nlb||a===hb.a.cid||a===hb.a.jza||a===hb.a.Xsc?this.Yyb(b.node,null,7):a===hb.a.complexTable&&this.Yyb(b.node,null,10))}P7g(a,b){a=b.property;b.node.isConnected&&a===hb.a.tu&&this.sie(b.node,null,4)}Ugd(a,b){a=b.property;!b.node.isConnected||a!==hb.a.rowSpan&&a!==hb.a.colSpan||this.sie(b.node,null,5)}K7g(a,b){b.node.isConnected&&1===b.VZ&&this.sie(b.node,b.node,3)}Q5g(a,b){a=Object(qa.a)(5,b.node);b=b.property;a&&
a.isConnected&&a.Sa(hb.a.cellId)&&!a.bnc&&(b===Za.a.pq||b===Za.a.tlb)&&this.MIj(a)}j7g(){for(let a of this.Hva.keys)for(let b of this.Hva.ga(a).values)b.m9b(11)}dispose(){this.Q6c&&(this.iYa.CRe(Object(F.a)(this,this.S2g,"onBeforeTableViewElementDisconnected")),this.iYa.qoa(Object(F.a)(this,this.L7g,"onTableNodeConnected")),this.iYa.Rm(Object(F.a)(this,this.N7g,"onTableNodePropertyChanged")),this.iYa.wKa(Object(F.a)(this,this.M7g,"onTableNodeDisconnected")),this.NVg.Rm(Object(F.a)(this,this.P7g,"onTableRowNodePropertyChanged")),
this.Pfb.Rm(Object(F.a)(this,this.Ugd,"onTableCellNodePropertyChanged")),this.Pfb.bP(Object(F.a)(this,this.K7g,"onTableCellNodeChildTopoChanged")),this.ugc.Rm(Object(F.a)(this,this.Q5g,"onParagraphNodePropertyChanged")),this.yt.v0k(Object(F.a)(this,this.j7g,"onSlideInvalidateRenderSize")))}}Object(n.a)(XL,"PPTTableLayoutServiceManager",null,[299,106]);class dE{constructor(a,b,c){this.Kq=b;this.Zma=c;this.QC=this.Kq.DPc(this.Zma,a.rE);this.C9=Array(this.QC.UO*(this.QC.AR+1));this.OL=this.QC.he;this.pfb=
this.QC.re;this.iFb=this.QC.re-1;this.Lq=0;this.Mee(a)}Mee(a){const b=a.rE;for(;a.moveNext();){const f=a.fA;for(let l=f.re;l<f.$f;l++){var c=this.UDa(l,f.he);this.C9[c]=0!==this.C9[c]?32:l<b.re&&f.he>b.he?1:l>=b.$f&&f.he>b.he?4:16;c=this.UDa(l,f.Nf);this.C9[c]=0!==this.C9[c]?32:l<b.re&&f.Nf<b.Nf?1:l>=b.$f&&f.Nf<b.Nf?4:64}}}UDa(a,b){return this.QC.UO*(b-this.QC.he)+(a-this.QC.re)}moveNext(){this.pfb=this.iFb;do{this.pfb++;this.pfb>=this.QC.$f&&(this.OL++,this.pfb=this.QC.re);if(this.OL>this.QC.Nf)return!1;
this.Lq=this.C9[this.UDa(this.pfb,this.OL)]}while(0===this.Lq);for(this.iFb=this.pfb;this.iFb+1<this.QC.$f&&this.C9[this.UDa(this.iFb+1,this.OL)]===this.Lq;)this.iFb++;return!0}Oij(){return this.iFb+1}y9a(){return this.Lq}static zje(a){return!!(a&117)}}Object(n.a)(dE,"VerticalTableBorderIterator",null,[408,409]);class xl{constructor(a,b,c,f,l,w,H){this.Tk=a;this.Kq=b;this.Pb=c;this.sA=f;this.qea=l;this.O$j=w;this.akk=H}nEl(a,b,c){const f=b.getContainingTable();f&&(this.pAl(b,f,a,c.Nf,c.re),this.oAl(b,
f,a,c.$f,c.he))}B4d(a,b,c,f,l,w){if(c&&c!==b.UO)for(;f<l;f++)if(9===(b.vs(c-1,f)&9)&&5===(b.vs(c,f)&5)){var H=this.Kq.EI(b,c-1,f),U=this.Kq.EI(b,c,f);H=a.nf(H.re,H.he);U=a.nf(U.re,U.he);w?this.aub(U,H,7,0):this.aub(H,U,0,7)}}EVe(a,b,c,f,l){l=this.qea.zDa(a,b,c,l);c=f.q5i();if(dE.zje(c)){let w=this.akk.dJi(l,b);for(;w.moveNext();)0!==(c&w.y9a())&&this.mXe(a,b,w.OL,w.pfb,w.Oij(),f.Kxb(w.y9a()),!0)}if(bE.zje(c))for(l=this.O$j.bFi(l,b);l.moveNext();)0!==(c&l.y9a())&&this.gWe(a,b,l.IO,l.Acb,l.J6i(),f.Kxb(l.y9a()),
!0)}mXe(a,b,c,f,l,w,H=!1){let U=this.sA.YUc(a),ja=null;0<c&&(ja=a.nf(f,c-1));let wa=null;for(c<b.AR&&(wa=a.nf(f,c));f<l;){if(ja){if(6===(b.vs(f,c-1)&6)){var Sa=this.Kq.EI(b,f,c-1),eb=a.nf(Sa.re,Sa.he);H&&U?U=this.OLb(U,eb,Sa.re,Sa.he,6,w):xl.Oqc(6,eb,w)}f+1<l&&(ja=a.nf(f+1,c-1))}wa&&(5===(b.vs(f,c)&5)&&(Sa=this.Kq.EI(b,f,c),eb=a.nf(Sa.re,Sa.he),H&&U?U=this.OLb(U,eb,Sa.re,Sa.he,5,w):xl.Oqc(5,eb,w)),f+1<l&&(wa=a.nf(f+1,c)));f+=1}}D4d(a,b,c,f,l,w){if(c&&c!==b.AR)for(;f<l;f++)if(6===(b.vs(f,c-1)&6)&&
5===(b.vs(f,c)&5)){var H=this.Kq.EI(b,f,c-1),U=this.Kq.EI(b,f,c);H=a.nf(H.re,H.he);U=a.nf(U.re,U.he);w?this.aub(U,H,5,6):this.aub(H,U,6,5)}}gWe(a,b,c,f,l,w,H=!1){let U=this.sA.YUc(a),ja=null;0<c&&(ja=a.nf(c-1,f));let wa=null;for(c<b.UO&&(wa=a.nf(c,f));f<l;){if(ja){if(9===(b.vs(c-1,f)&9)){var Sa=this.Kq.EI(b,c-1,f),eb=a.nf(Sa.re,Sa.he);H&&U?U=this.OLb(U,eb,Sa.re,Sa.he,0,w):xl.Oqc(0,eb,w)}f+1<l&&(ja=a.nf(c-1,f))}wa&&(5===(b.vs(c,f)&5)&&(Sa=this.Kq.EI(b,c,f),eb=a.nf(Sa.re,Sa.he),H&&U?U=this.OLb(U,eb,
Sa.re,Sa.he,7,w):xl.Oqc(7,eb,w)),f+1<l&&(wa=a.nf(c,f)));f+=1}}GEh(a,b,c,f){var l=null;if(!({re:f}=xl.UEh(b,c,f)).returnValue)return{returnValue:!1,vla:l};l=6;0<c&&xl.Czb(b,f,c-1)?(b=this.Kq.EI(b,f,c-1),a=this.Pb.Mc(a.nf(b.re,b.he))):(l=5,b=this.Kq.EI(b,f,c),a=this.Pb.Mc(a.nf(b.re,b.he)));l=this.d4f(a,l);return{returnValue:!0,vla:l}}CEh(a,b,c,f){const l=xl.NEh(b,c,f);if(!l.returnValue)return{returnValue:!1,vla:null};f=0;0<c&&xl.Fbb(b,l.he,c-1)?(b=this.Kq.EI(b,c-1,l.he),a=this.Pb.Mc(a.nf(b.re,b.he))):
(f=7,b=this.Kq.EI(b,c,l.he),a=this.Pb.Mc(a.nf(b.re,b.he)));return{returnValue:!0,vla:this.d4f(a,f)}}OLb(a,b,c,f,l,w){const H=b.rowSpan;b=b.colSpan;for(let U=c;U<c+H;U++)for(let ja=f;ja<f+b;ja++)a.OLb(U,ja,l,w);return a}d4f(a,b){a=a.yq;if(!a||!a.cellShading)return null;let c=null;({vla:c}=this.Tk.S3e(b,a.cellShading));return c}aub(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=ki.a.ISa(b,hb.a.cellShading));l&&({vla:b}=this.Tk.S3e(f,l),xl.Oqc(c,a,b))}}pAl(a,b,c,f,l){let w;({re:w}=
xl.UEh(c,f,l)).returnValue&&(l=6,0<f&&xl.Czb(c,w,f-1)?c=this.Kq.EI(c,w,f-1):(l=5,c=this.Kq.EI(c,w,f)),b=b.nf(c.re,c.he),this.aub(a,b,6,l))}oAl(a,b,c,f,l){let w;({he:w}=xl.NEh(c,f,l)).returnValue&&(l=0,0<f&&xl.Fbb(c,w,f-1)?c=this.Kq.EI(c,f-1,w):(l=7,c=this.Kq.EI(c,f,w)),b=b.nf(c.re,c.he),this.aub(a,b,0,l))}static Oqc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static UEh(a,
b,c){let f,l;f=c;l=c+1;if(!xl.Fbb(a,b,c))return{returnValue:!1,re:f,$f:l};for(;0<f&&!(0<b&&xl.Czb(a,f,b-1))&&!(b<a.AR&&xl.Czb(a,f,b));f--);for(;l<a.UO&&!(0<b&&xl.Czb(a,l,b-1))&&!(b<a.AR&&xl.Czb(a,l,b));l++);return{returnValue:!0,re:f,$f:l}}static NEh(a,b,c){let f;f=c;for(c+=1;0<f&&!(0<b&&xl.Fbb(a,f,b-1))&&!(b<a.UO&&xl.Fbb(a,f,b));f--);for(;c<a.AR&&!(0<b&&xl.Fbb(a,c,b-1))&&!(b<a.UO&&xl.Fbb(a,c,b));c++);return{returnValue:!0,he:f,Nf:c}}static Fbb(a,b,c){return 0<b&&!(a.vs(c,b-1)&2)||b<a.AR&&!(a.vs(c,
b)&1)?!1:!0}static Czb(a,b,c){return 0<b&&!(a.vs(b-1,c)&8)||b<a.UO&&!(a.vs(b,c)&4)?!1:!0}}Object(n.a)(xl,"TableBorderEditor",null,[1108,1109]);class YL{constructor(a,b,c,f){this.Pqe=!1;this.L0=a;this.zik=b;this.MFb=c;this.gye=f;this.li=Array(this.L0.HY);for(a=0;a<this.L0.HY;a++)for(this.li[a]=Array(this.L0.$ra),b=0;b<this.L0.$ra;b++)this.li[a][b]=new sq.a}p5i(a,b,c){this.Pqe||(this.zik.T3k(a,this.L0),this.Pqe=!0);if(Pd.a("BugFixCacheInvalidIndex")){if(this.li&&0<=b&&b<this.li.length&&this.li[b]&&
0<=c&&c<this.li[b].length)return this.li[b][c];a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.li,b,c);this.li&&(a+=String.format(" m_cache.Length : {0} ",this.li.length),a=this.li[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.li[b].length):a+" m_cache[ row ] is null ");va.a.J(559724692,822,15,a);return null}return this.li[b][c]}OLb(a,b,c,f){var l=this.MFb.imh(c,this.L0.Jd,f);a=this.li[a][b];for(var w of l.bA())a.we(w,l.Mh(w));
this.gye&&Pd.a("TableBordersLocalRenderingFix")&&({iQa:l,M6a:c,ysb:w}=Wp.fTa(c),f.wFieldSpecified&&(f.noFillField?a.we(l,0):a.we(l,te.a.F1d(f.wField))),f.solidFillField&&a.we(c,f.solidFillField),f.prstDashField&&a.we(w,f.prstDashField))}dispose(){this.li=null;this.Pqe=!1}}Object(n.a)(YL,"TableBorderStyleCache",null,[1107,106]);class eE{constructor(a){this.dAe=a?1:0}sOd(a){const b=a.fA;a=a.rE;return b.he%2===this.dAe&&a.Evb(b)}}Object(n.a)(eE,"BandedColumnFilter",null,[1177]);class fE{constructor(a){this.dAe=
a?1:0}sOd(a){const b=a.fA;a=a.rE;return b.re%2===this.dAe&&a.Evb(b)}}Object(n.a)(fE,"BandedRowFilter",null,[1177]);class ZL{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}q5i(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}Kxb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;
case 4:return this.bottom;case 8:return this.diagTL2BR;case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(n.a)(ZL,"TableBorderSet",null,[]);class $L{constructor(a,b){this.o5=a;this.Fik=b}T3k(a,b){const c=b.HY,f=b.$ra;var l=b.tableLook;b=b.tableStyle;const w=this.Fik.create(a),H=!!(l&32)&&!!b.firstRowField,U=!!(l&64)&&!!b.lastRowField,ja=!!(l&128)&&!!b.firstColField,wa=!!(l&256)&&!!b.lastColField,Sa=H&&ja&&!!b.nwCellField,
eb=H&&wa&&!!b.neCellField,ub=U&&ja&&!!b.swCellField,Ub=U&&wa&&!!b.seCellField;var cc=!(l&512)&&!!b.band1HField,Fc=!(l&512)&&!!b.band2HField,Ic=!(l&1024)&&!!b.band1VField;const Cc=!(l&1024)&&!!b.band2VField;l=new jr.a;b.wholeTblField&&(l.re=0,l.$f=c,l.he=0,l.Nf=f,this.apply(a,w,b.wholeTblField,l));l.re=H?1:0;l.$f=c-(U?1:0);l.he=0;l.Nf=f;cc&&(cc=new fE(H),this.apply(a,w,b.band1HField,l,cc));Fc&&(Fc=new fE(!H),this.apply(a,w,b.band2HField,l,Fc));l.re=0;l.$f=c;l.he=ja?1:0;l.Nf=f-(wa?1:0);Ic&&(Ic=new eE(ja),
this.apply(a,w,b.band1VField,l,Ic));Cc&&(Ic=new eE(!Cc),this.apply(a,w,b.band2VField,l,Ic));wa&&(l.re=0,l.$f=c,l.he=f-1,l.Nf=f,this.apply(a,w,b.lastColField,l));ja&&(l.re=0,l.$f=c,l.he=0,l.Nf=1,this.apply(a,w,b.firstColField,l));U&&(l.re=c-1,l.$f=c,l.he=0,l.Nf=f,this.apply(a,w,b.lastRowField,l),Ub&&(l.he=f-1,l.Nf=f,this.apply(a,w,b.seCellField,l)),ub&&(l.he=0,l.Nf=1,this.apply(a,w,b.swCellField,l)));H&&(l.re=0,l.$f=1,l.he=0,l.Nf=f,this.apply(a,w,b.firstRowField,l),eb&&(l.he=f-1,l.Nf=f,this.apply(a,
w,b.neCellField,l)),Sa&&(l.he=0,l.Nf=1,this.apply(a,w,b.nwCellField,l)))}apply(a,b,c,f,l=null){if(!f.cSa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const w=new ZL;c.topField&&c.topField.itemField&&(w.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(w.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(w.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(w.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(w.right=
c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&(w.insideVer=c.insideVField.itemField);this.o5.EVe(a,b,f,w,l)}}}Object(n.a)($L,"TableBorderStyleResolver",null,[293]);class Lv{constructor(){}Sqi(a,b){const c=new jr.a;if(a.cSa())return c;const f=Lv.SWf(b,a,a.re,!0),l=Lv.SWf(b,a,a.$f-1,!1),w=Lv.tWf(b,a,a.he,!0);a=Lv.tWf(b,a,a.Nf-1,!1);c.re=f;c.$f=l+1;c.he=w;c.Nf=a+1;return c}ILj(a,b){for(var c=a.re;c<a.$f;++c)if(!(b.vs(c,a.he)&1&&b.vs(c,a.Nf-1)&2))return!1;for(c=a.he;c<a.Nf;++c)if(!(b.vs(a.re,
c)&4&&b.vs(a.$f-1,c)&8))return!1;return!0}l0f(a){let b;b=null;const c=new jr.a;if(!(a&&a.Hl&&a.mb&&a.w6))return{returnValue:c,tableNode:b};var f=a.ga(0).mg.Ua,l=Object(qa.a)(Zl.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,tableNode:b};f=l.rowIndex;l=l.ui;var w=Object(qa.a)(Zl.TableCellNode,a.ga(0).mg.Ye.node);var H=0;w&&(H=w.ui+1);if(b.Np()&&1!==a.length){H=Object(qa.a)(Zl.TableCellNode,a.O0a.currentNode);f=Object(qa.a)(Zl.TableCellNode,a.Lja.currentNode);if(!H||
!f)return{returnValue:c,tableNode:b};l=H.rowIndex;a=H.ui;w=f.rowIndex;H=f.ui;f=Math.min(l,w);w=Math.max(l,w)+1;l=Math.min(a,H);H=Math.max(H,a)+1}else w=f+a.length;c.re=f;c.$f=w;c.he=l;c.Nf=H;return{returnValue:c,tableNode:b}}EI(a,b,c){b=Object.assign(new jr.a,{re:b,$f:b+1,he:c,Nf:c+1});return this.DPc(a,b)}DPc(a,b){const c=new jr.a;let f=b.re,l=b.$f-1;for(var w=b.he;w<b.Nf;w++){for(var H=b.re;0<H&&!(a.vs(H,w)&4);H--);H<f&&(f=H);H=b.$f-1;for(var U=a.UO-1;H<U&&!(a.vs(H,w)&8);H++);H>l&&(l=H)}w=b.he;
H=b.Nf-1;for(U=b.re;U<b.$f;U++){let ja=b.he;for(;0<ja&&!(a.vs(U,ja)&1);ja--);ja<w&&(w=ja);ja=b.Nf-1;for(const wa=a.AR-1;ja<wa&&!(a.vs(U,ja)&2);ja++);ja>H&&(H=ja)}c.re=f;c.he=w;c.Nf=H+1;c.$f=l+1;return c}static SWf(a,b,c,f){if(f)for(;0<c;c--)for(f=b.he;f<b.Nf;++f){if(a.vs(c,f)&4)return c}else for(f=a.UO-1;c<f;c++)for(let l=b.he;l<b.Nf;++l)if(a.vs(c,l)&8)return c;return c}static tWf(a,b,c,f){if(f)for(;0<c;c--)for(f=b.re;f<b.$f;++f){if(a.vs(f,c)&1)return c}else for(f=a.AR-1;c<f;++c)for(let l=b.re;l<
b.$f;++l)if(a.vs(l,c)&2)return c;return c}}Object(n.a)(Lv,"TableCellSelectionHelper",null,[288]);class aM{constructor(a,b,c){this.XQ=null;this.x4=!1;if(!a||!a.isConnected||14!==a.type)throw Error.argument("tableNode");this.fe=a;this.yc=b;this.bY=c;this.KX=3}x6e(){try{var a=ob.GraphIterator.nb(this.fe);Rd.forEachCellInTable(a,(b,c,f)=>{var l=Object(qa.a)(125,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let w=c;w<b;++w)for(let H=f;H<l;++H)w===c&&(this.XQ[w][H]|=4),w===b-1&&(this.XQ[w][H]|=
8),H===f&&(this.XQ[w][H]|=1),H===l-1&&(this.XQ[w][H]|=2)}return!0})}catch(b){a=this.bY.i1d(this.fe),va.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",a,b.message)}}validate(){if(this.x4)throw Error.invalidOperation("cache disposed");if(0!==this.KX){if(3===(this.KX&3)){const a=this.yc.tk(this.fe),b=this.yc.Ci(this.fe);this.XQ=Array(a);for(let c=0;c<a;++c){this.XQ[c]=Array(b);for(let f=0;f<b;++f)this.XQ[c][f]=0}}1===(this.KX&1)&&this.x6e();this.KX=0}}vs(a,b){try{this.validate();var c=this.XQ[a][b]}catch(f){c=
this.bY.i1d(this.fe),va.a.J(38043911,822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.UO,this.AR,a,b,c,f.message),c=0}return c}qUa(a){this.KX|=a}dispose(){this.x4=!0;this.XQ=null}get UO(){this.validate();return this.XQ?this.XQ.length:0}get AR(){this.validate();return this.XQ&&this.XQ.length?this.XQ[0].length:0}}Object(n.a)(aM,"TableInfoCache",null,[1176,106]);class bM{constructor(a,b){this.yc=a;this.bY=b}create(a){return new aM(a,this.yc,this.bY)}}Object(n.a)(bM,
"TableInfoCacheFactory",null,[300]);class $z{constructor(a,b,c,f,l,w){this.Vgk=a;this.U7j=b;this.Iik=c;this.uck=f;this.gjk=l;this.Nik=w}get HY(){return this.Vgk()}get $ra(){return this.U7j()}get tableLook(){return this.Iik()}get V0j(){return this.uck()}get Jd(){return this.gjk()}get tableStyle(){return this.Nik()}static bMf(a,b,c,f,l,w){return new $z(a,b,c,f,l,w)}}Object(n.a)($z,"TableListStyleParams",null,[1106]);class cM{constructor(a){this.ina=null;this.o7c=!1;this.RCe=this.QBb=null;this.Pb=a}get cNj(){return!!this.QBb}mch(a,
b){this.RCe=a.id.toString();this.o7c=!this.Pb.Jaj(a).currentNode.sc(b).K_c();this.QBb=null;this.o7c&&(a=a.sc(b),this.ETi(),za.a.j1b(a.htmlElement,this.ina),this.QBb=this.GZi(this.ina))}v5b(a,b,c,f){if(a.id.toString()!==this.RCe)throw Error.argument("table","Wrong table metrics");if(this.o7c){if(!this.QBb)throw Error.invalidOperation("m_clonedTableNode is null");a=this.QBb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(ka.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",
c.className),c=za.a.gda(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){za.a.GUa(this.ina)&&this.ina.parentNode.removeChild(this.ina);this.QBb=this.ina=null;this.o7c=!1;this.RCe=null}i1d(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.sa(Za.a.iza,0),a.properties.sa(Za.a.Dga,0)));const c=this.Pb.Mc(a);Rd.forEachCellInTable(c,(f,l,w)=>{var H=f.currentNode;f=H.rowSpan;H=H.colSpan;(1<f||1<H)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",
l,w,f,H));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}ETi(){this.ina||(this.ina=document.createElement("div"),this.ina.className="TableMetricsWorkingDiv",document.body.appendChild(this.ina));za.a.qCa(this.ina)}GZi(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;a=a.nextSibling}return null}}Object(n.a)(cM,"TableMetrics",null,[297]);class dM{constructor(a){this.sA=a}U3k(a,b,c){return b&&a&&c&&(a=this.sA.$Uc(a).B1f(c,b.rowIndex,b.ui,b.rowSpan,
b.colSpan))&&a!==tc.a.auto?a.sD:-1}}Object(n.a)(dM,"TableThemeColorHelper",null,[301]);class eM{constructor(a){this.Kq=a}dJi(a,b){return new dE(a,this.Kq,b)}}Object(n.a)(eM,"VerticalTableBorderIteratorFactory",null,[292]);class gE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}Zb(a){this.K=a;this.K.register(288,"PowerPointWebEditor.ITableCellSelectionHelper").ma().oa(()=>new Lv);a.register(289,"Box4.ITableDragSelectionCellExtendStrategy").ma().oa(()=>new AL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(xl,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().oa(()=>new xl(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(290,"PowerPointWebEditor.ICellIteratorFactory").ma().oa(()=>new RL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(291,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().oa(()=>new SL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));
this.K.register(292,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().oa(()=>new eM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(293,"PowerPointWebEditor.ITableBorderStyleResolver").ma().oa(()=>new $L(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(jm,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().oa(()=>
new jm(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Ma));this.K.register(ZD,"PowerPointWebEditor.TableNodeBehavior").ma().oa(()=>new ZD(this.K.resolve("Box4.Graph.IGraphInstance").xd(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ybe));this.K.register(294,"PowerPointWebEditor.ITableStyleReaderHelper").ma().oa(()=>new Wp(this.K.resolve("Box4.IPageView").Md,
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").K0c));this.K.register(Xz,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().oa(()=>new Xz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Md,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").xd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),$z.bMf,b=>new $D(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),b=>new YD(b),b=>new YL(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),
a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").laa),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Dhg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").SWj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").laa));this.K.register(295,"PowerPointWebEditor.ITableStyleResolver").ma().oa(()=>new ML(this.K.resolve("PowerPointWebEditor.IApplicationSettings").laa));this.K.register(296,"PowerPointWebEditor.ITableStyleGalleryManager").ma().oa(()=>new PL(this.K.Ja("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(297,"PowerPointWebEditor.ITableMetrics").ma().oa(()=>
new cM(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(298,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().oa(()=>new VL(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(299,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().oa(()=>new XL(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),
this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").xd(14),this.K.resolve("Box4.Graph.IGraphInstance").xd(15),this.K.resolve("Box4.Graph.IGraphInstance").xd(16),this.K.resolve("Box4.Graph.IGraphInstance").xd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(WD,"PowerPointWebEditor.TableCellNodeBehavior").ma().oa(()=>
new WD(this.K.resolve("Box4.Graph.IGraphInstance").xd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(wL,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(xL,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();this.K.register(eR.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(300,"PowerPointWebEditor.ITableInfoCacheFactory").ma().oa(()=>
new bM(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(301,"PowerPointWebEditor.ITableThemeColorHelper").ma().oa(()=>new dM(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").iKb(1,
new Kv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a),new IL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new HL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,new Ri.a((c,f)=>new Ll(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>Vx.w1b(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new Ri.a((c,f)=>new Jv(c,f,new Xb.a(c,f,Xb.a.dvl))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,new zL(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),
new Ri.a((c,f)=>new ft(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").yka,this.K.resolve("PowerPointWebEditor.IApplicationSettings").laa,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));mb.StyleReader.nr=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){v.a.instance.Dc(new gE)}}
Object(n.a)(gE,"PPTWebEditorTablePackage",null,[2,3]);var iR=d(1235),Xh=d(111);class fM{constructor(){this.podsUrl=this.fileUrl=null}}Object(n.a)(fM,"IFileInfo",null,[]);class gM extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}Object(n.a)(gM,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class hM{constructor(){this.messageType=0;this.data=this.sender=null}}Object(n.a)(hM,"IPresentationMessage",null,[]);class iM{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=
!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(n.a)(iM,"IPresenterViewSettings",null,[]);class jM{constructor(){this.uiHost=this.userSessionId=null}}Object(n.a)(jM,"ISessionInfo",null,[]);var jR=d(537);class kM{constructor(a,b,c){this.aR="";this.Q9=null;this.Zdb=!1;this.IEb=null;this.va=new vc.a;this.ia=a;this.la=b;this.Lc=c;this.hKk()}wb(){this.ia.ra(L.a.WJb,nc.a.application,Object(F.a)(this,this.WJb,"queryUsePresenterView"),96);this.ia.ya(L.a.k6e,nc.a.application,Object(F.a)(this,
this.Sxl,"toggleUsePresenterView"));this.ia.ya(L.a.rrd,Cb.a.application,Object(F.a)(this,this.rrd,"showPresenterView"));this.ia.ya(L.a.xKc,nc.a.application,Object(F.a)(this,this.xKc,"closePresenterView"));this.Zdb=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}WJb(a,b,c,f,l){(a=Object(qa.a)(Xh.a,l))&&a.Lf(this.Zdb);return 32}Sxl(a,b,c){if(1===c&&!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return va.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),
8;2===c&&(this.Zdb=!this.Zdb,this.Lc.Gy(new Xp.a(1)));return 32}rrd(a,b,c){try{if(!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return va.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),2;if(2===c&&0<this.aR.length){if(!this.IEb){const f=this.la.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),w=new fM;w.fileUrl=this.aR;w.podsUrl=f;const H=new jM;H.userSessionId=u.AFrameworkApplication.userSessionId;H.uiHost="UnifiedApp";
const U=new iM;U.presenterWindowWidth=1024;U.presenterWindowHeight=576;this.IEb=new PresenterView.PresentationProxy(2,l,w,H,U)}this.IEb.startPresentation();this.IEb.subscribe(Object(F.a)(this,this.Hxk,"onPresentationChannelMessageHandler"))}return 32}catch(f){return va.a.J(512496090,822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}xKc(a,b,c){2===c&&(va.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.IEb.terminatePresentation());return 32}Eai(a){this.va.addHandler("OnPresenterViewSyncMessageReceived",
a)}U9k(a){a=this.jhi(a);this.IEb.sendMessage(a)}jhi(a){const b=new hM;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.Ptc});return b}Hxk(a){try{if(!a||0>=a.length)va.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||va.a.J(512496087,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=
JSON.parse(l).slideLocation.slideIndex;this.va.raiseEvent("OnPresenterViewSyncMessageReceived",new gM({["SlideIndex"]:f}))}}}}catch(l){va.a.J(512496086,830,10,"Exception: {0}",l)}}hKk(){var a=Ab.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new iR.a(u.AFrameworkApplication.Ke);this.Q9=jR.b(b.kVe(a));this.Q9.then(c=>
{try{const f=JSON.parse(c),l=f.downloadUrl;ha.a.Wa(l)?va.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.aR=l}catch(f){va.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",f)}return null})}}Object(n.a)(kM,"PresenterViewManager",null,[287]);class hE{constructor(){this.qb=this.la=this.K=null;this.MEg=!1}get name(){return"PowerPointWebEditor.PresenterView"}Zb(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.qb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").FF()}init(){u.AFrameworkApplication.fa.ff(Object(F.a)(this,this.Qm,"onFullAppSettingsReady"))}Qm(){try{(this.MEg=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw.loadScript("presenterView").catch(a=>va.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.Jxk()).catch(a=>va.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){ka.ULS.sendTraceTag(594031830,
811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}Jxk(){this.x1b();return null}x1b(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",u.AFrameworkApplication.fa.Ga("PPTPresenterViewCssUrl"));this.qb.appendChild(a);this.K.register(287,"PowerPointWebEditor.PresenterView.IPresenterViewManager").oa(()=>new kM(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();
this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").wb()}dispose(){}static main(){v.a.instance.Dc(new hE)}}Object(n.a)(hE,"PPTWebEditorPresenterViewPackage",null,[2,3]);class lM{constructor(a){this.qea=a}FIi(a,b,c){if(c.cSa())return null;a=this.qea.zDa(a,b,c);for(b=Array(b.UO);a.moveNext();){c=a.u5b();var f=a.fA;b[f.re]||(b[f.re]=[]);f=b[f.re];f[f.length]=br.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new gb.Selection(b[c],!0));return new wc.SelectionCollection(a,
a.length-1,0)}}Object(n.a)(lM,"PPTSelectionFactory",null,[284]);class mM{constructor(a,b,c,f){this.Oxe=this.Zma=this.Uqe=null;this.w2h=a;this.sPh=b;this.Kq=c;this.gYa=f}get rri(){return this.sPh}get jtb(){this.Uqe||(this.Uqe=this.Kq.Sqi(this.rri,this.ZY));return this.Uqe}get tableNode(){return this.w2h}get ZY(){this.Zma||(this.Zma=this.gYa.create(this.tableNode));return this.Zma}get uUj(){this.Oxe||(this.Oxe=this.Kq.ILj(this.jtb,this.ZY));return this.Oxe}}Object(n.a)(mM,"TableCellSelectionInfo",null,
[]);class nM{constructor(a,b){this.gYa=a;this.Kq=b}create(a,b){return new mM(b,a,this.Kq,this.gYa)}}Object(n.a)(nM,"TableCellSelectionInfoFactory",null,[282]);var kR=d(1013);class oM{constructor(a,b,c){this.DVg=a;this.Kq=b;this.yGa=c}U6b(a){let b=null;const c=new Date,f=({tableNode:a}=this.Kq.l0f(a)).returnValue,l=!f.cSa();l&&(b=this.DVg.create(f,a),Rc.a.Ib&&Rc.a.Ib.Va("CellRange",f.toString()));va.a.J(512495623,808,l?50:10,"Table cell selection range {0}, took {1}",f.toString(),+new Date-+c);return b}Rkj(a){if(!a)return null;
var b=this.yGa.MA(a);let c=a=null;for(let l=0;l<b.length;++l)if(b[l].al){var f=Object(qa.a)(5,b[l].node);if(f){f=f.lL();if(!f)return null;if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new jr.a,{re:a.rowIndex,he:a.ui});b.$f=b.re+1;b.Nf=b.he+1;return this.DVg.create(b,a.getContainingTable())}}Object(n.a)(oM,"TableSelectionAdapter",null,[283]);class iE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}Zb(a){this.K=
a;this.K.register(282,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().oa(()=>new nM(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(283,"PowerPointWebEditor.ITableSelectionAdapter").ma().oa(()=>new oM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));this.K.register(284,"PowerPointWebEditor.ISelectionFactory").ma().oa(()=>new lM(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(285,"PowerPointWebEditor.ITableMergeSplitEditor").ma().oa(()=>new kR.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){v.a.instance.Dc(new iE)}}Object(n.a)(iE,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class kl{constructor(a,b,c,f,l,w,H,U){this.Jqb=a;this.zMd=b;this.Ca=c;this.xMd=f;this.Bk=l;this.Jt=w;this.fd=H;this.QVh=U}wb(){this.vld(Pc.App.ULa.xKf())}vld(a){this.Ca.ya(D.a.QJb,Cb.a.view,a);this.Ca.ya(D.a.QJb,Cb.a.table,Object(F.a)(this,this.QJb,"queryTableStyle"));this.Ca.le(D.a.QJb,
103);this.Ca.ya(D.a.PZ,Cb.a.view,Object(F.a)(this,this.t1e,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.PZ,Cb.a.table,Object(F.a)(this,this.PZ,"applyTableStyle"));this.Ca.le(D.a.PZ,6);this.Ca.ya(D.a.w6a,Cb.a.table,Object(F.a)(this,this.PZ,"applyTableStyle"));this.Ca.ya(D.a.QZ,Cb.a.view,Object(F.a)(this,this.t1e,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.QZ,Cb.a.table,Object(F.a)(this,this.QZ,"applyTableStyleOption"));this.Ca.le(D.a.QZ,14);this.Ca.ya(D.a.boa,Cb.a.view,a);this.Ca.ya(D.a.boa,
Cb.a.table,Object(F.a)(this,this.boa,"queryTableStyleOption"));this.Ca.le(D.a.boa,103);this.Ca.ya(D.a.rIb,Cb.a.view,a);this.Ca.ya(D.a.rIb,Cb.a.table,Object(F.a)(this,this.rIb,"populateMenuMoreTableStyles"));this.Ca.le(D.a.rIb,102);this.Ca.ya(D.a.l7a,Cb.a.view,Object(F.a)(this,this.t1e,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.l7a,Cb.a.table,Object(F.a)(this,this.l7a,"clearTableFormatting"));this.Ca.le(D.a.l7a,4)}QJb(a,b,c,f,l){if(!({uF:a}=this.orc(b,c,l,!0,!0)).returnValue)return a;this.zMd.OEi(l,
b.node);return 32}boa(a,b,c,f,l){return this.vbg(b,c,f,l,!0)}rIb(a,b,c,f,l){if(!({uF:a}=this.orc(b,c,l,!1,!0)).returnValue)return a;this.zMd.TFi(l,b.node);ka.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}PZ(a,b,c,f,l){if(!({uF:c}=this.orc(b,c,l,!1,!0)).returnValue)return c;const w=b.node;let H=null;(H=a===D.a.PZ?this.zMd.Psd(l[Vh.a.SourceControlId],w):null)?(this.WKe(w,()=>{this.xMd.yfl(H,w)}),c=32):c=8;a===D.a.PZ&&32===c&&ka.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");
ka.ULS.shipAssertTag(541172699,324,32===c);return c}QZ(a,b,c,f,l){return this.vbg(b,c,f,l,!1)}vbg(a,b,c,f,l){if(!({uF:b}=this.orc(a,b,f,l,!0)).returnValue)return b;a=a.node;b=this.Jqb.V8d(a);const w=f[Vh.a.On],H=kl.Umj(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp?f.MenuItemId:f[Vh.a.SourceControlId]);l?f[Vh.a.On]=kl.tkl(b,H):(this.fgi(b,H,w,a),c.CN=H,c.o3=w?0:1,ka.ULS.shipAssertTag(541172700,324,0!==H));return 32}t1e(a,b,c,f,l){return ni.P5(a,b,c,f,l,{},14)}WKe(a,b){const c=this.Bk.oe(15);
try{c.kd(a),this.Jt.w_a(),b()}finally{c&&c.dispose()}}orc(a,b,c,f,l){return this.eXj(a,b,c,f,l)?{returnValue:f||2===b,uF:32}:{returnValue:!1,uF:8}}eXj(a,b,c,f,l){if(a.contextId!==Cb.a.table)return!1;if(f||2===b)if(l&&!c||!Object(Ya.a)(Dy.a,a.node)||this.QVh(a.node))return!1;return!0}fgi(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.WKe(f,()=>{this.xMd.Zcl(l,f)})}l7a(a,b,c,f,l){if(!({uF:a}=this.orc(b,c,l,!1,!1)).returnValue)return a;const w=b.node;this.WKe(w,()=>{this.xMd.Qui(w)});
return 32}static qr(){kl.hPa[kl.g_i]=32;kl.hPa[kl.b_i]=128;kl.hPa[kl.l_j]=64;kl.hPa[kl.d_j]=256;kl.hPa[kl.Aii]=512;kl.hPa[kl.zii]=1024}static tkl(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static Umj(a){let b=0;a in kl.hPa&&(b=kl.hPa[a]);return b}}kl.g_i="buttonFirstRow";kl.b_i="buttonFirstColumn";kl.l_j="buttonLastRow";kl.d_j="buttonLastColumn";kl.Aii="buttonBandedRow";kl.zii="buttonBandedColumn";kl.hPa={};Object(n.a)(kl,"TableStyleActor",null,[]);kl.qr();class Cp{constructor(a){this.M0=a}yfl(a,
b){a=this.M0.P6b(a);Cp.bGf(b);b.setValue(hb.a.jza,gh.a.Gf(a.dY.styleIdField))}Zcl(a,b){b.setValue(hb.a.Xsc,a)}Qui(a){Cp.bGf(a);a.removeProperty(hb.a.jza)}static bGf(a){if(a=Object(qa.a)(Yz.TableNode,a)){a=a.q$a();for(const b of a){b.cellShading&&((a=bp.d(b.cellShading))?(bp.c(a),b.cellShading=a):va.a.J(22078240,822,15,"Encountered null cell shading."));for(const c of Cp.Sji){let f,l;({iQa:f,M6a:a,ysb:l}=Wp.fTa(c));b.removeProperty(a);b.removeProperty(f);b.removeProperty(l)}Cp.qui(Object(qa.a)(yg.a,
b))}}else va.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static qui(a){const b=new QF.a;b.set(a);for(a=b.Bb(1);a;){for(a=b.Bb(2);a;)12===a.type&&Cp.rui(a),a=b.Fj(2);a=b.Fj(1)}}static rui(a){if(a.Ra&&0<a.Ra.length)for(let b=0;b<a.Ra.length;b++)a.Ra.ga(b)&&Cp.tui(a.Ra.ga(b))}static tui(a){if(a=a.formatting){const f=a.paragraph.Gh;if(f){var b=a.Yz,c=!1;if(b){for(let l=0;l<Cp.fUe.length;l++)b.Sa(Cp.fUe[l])&&(c||(c=!0,b=b.clone()),b.removeProperty(Cp.fUe[l]));c&&(b=f.qKa(b),a.nm=
b.id)}}}}}Cp.fUe=[Za.a.font,hb.a.latinFont,hb.a.eastAsianFont,hb.a.complexScriptFont,hb.a.YNb,Za.a.fontColor,Za.a.bold,Za.a.italic,hb.a.schemeColor];Cp.Sji=[5,6,7,0];Object(n.a)(Cp,"PPTTableStyleEditor",null,[368]);class jE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}Zb(a){this.K=a}init(){(new kl(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),this.K.resolve("Common.IActionManagerExtended"),new Cp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).wb()}dispose(){}static main(){v.a.instance.Dc(new jE)}}Object(n.a)(jE,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class kE{constructor(a,b,c){this.tDe=0;this.awe=!1;this.Qk=a;this.Gv=b;this.pa=c;this.Qk.Muf(Object(F.a)(this,this.$zf,"beforeForceOutboundGraphTransactionInitialize"));this.Qk.SBa(Object(F.a)(this,
this.B$f,"graphTransactionDisposed"));this.Gv.Dia(Object(F.a)(this,this.XYa,"onBeforeValidatePersistence"))}dispose(){this.Qk.ejh(Object(F.a)(this,this.$zf,"beforeForceOutboundGraphTransactionInitialize"));this.Qk.l_a(Object(F.a)(this,this.B$f,"graphTransactionDisposed"));this.Gv.zKb(Object(F.a)(this,this.XYa,"onBeforeValidatePersistence"))}$zf(){this.tDe++}XYa(){0<this.tDe&&(this.awe=!0)}B$f(){if(!(0<--this.tDe)&&this.awe){this.awe=!1;var a=Rc.a.Ib;if(a){const b=this.pa.Xd();let c=0;for(const f of b)f.GL&&
c++;a.Va("ShapeCount",b.length.toString());a.Va("SupportSVGCount",c.toString())}}}}Object(n.a)(kE,"SVGShapeTelemetry",null,[106]);class lE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}Zb(a){this.K=a;this.K.register(kE,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().oa(()=>new kE(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").xd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){v.a.instance.Dc(new lE)}}
Object(n.a)(lE,"PPTWebEditorTelemetryPackage",null,[2,3]);class aA{}aA.Jdh="faProofing";Object(n.a)(aA,"ContextMenuControlId",null,[]);class mE{constructor(a,b,c,f,l,w,H){this.jN=b;this.oWb=a;this.aAc=b.pNj;this.uAc=b.Nle;this.bVh=w;this.Lzc=f;this.Mzc=l;this.PNa=c;this.yP=H;this.LNa=new Ib.a;this.LNa.$(1,"SpellingIssue_16x16x32");this.LNa.$(2,"GrammarIssue_16x16x32");this.LNa.$(3,"WritingIssue_16x16x32");this.LNa.$(4,null);this.LNa.$(0,null)}create(a,b,c){b=Object(qa.a)(Uo.a,b);if(!b)return ka.ULS.sendTraceTag(25007833,
375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.T3f(a);this.M1b(f,b,c,a);this.AYd(f,b);this.aHi(f,b,a);return f.toString()}Rt(a,b,c){b=Object(qa.a)(Uo.a,b);if(!b)return ka.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.T3f(a);this.gZd(f,b,c,a);this.BYd(f,b);this.bHi(f,b,a);return f}M1b(a,b,c,f=null){0===b.errorType?a.append(this.oWb.build()):1===b.errorType&&(this.VRa(b)||a.append(this.wTd(b,c,f)))}gZd(a,b,c,f=null){0===
b.errorType?a.push(this.oWb.tBf()):1===b.errorType&&(this.VRa(b)||a.push(this.bli(b,c,f)))}AYd(a,b){if(!R.a.instance.ga(92)){const c=new Sys.StringBuilder;this.$wh(b)?c.append(tj.a("btnIgnoreAllSpellingError",(2===b.errorType?D.a.Sud:D.a.Lde).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.VRa(b)||c.append(tj.a("btnIgrnoreSpellingError",this.t3f(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.dxh(b)&&(this.jN.Uje&&c.append(tj.a("btnDoNotCheckForThisIssue",
"2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append(tj.a("btnGrammarOptions","3380187414",ha.a.ue(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(c.toString()),a.append("</Controls></MenuSection>"))}}BYd(a,b){if(!R.a.instance.ga(92)){const f=Object.assign(new ek.a,{ControlList:[]});if(this.$wh(b)){var c=Object.assign(new kg.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":
"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.VRa(b)||(c=Object.assign(new kg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.t3f(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,c));this.dxh(b)&&(this.jN.Uje&&(b=Object.assign(new kg.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new kg.a,{ExternalId:"GrammerSettingsContext",
Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}T3f(a){if(!this.yP)return null;a=this.yP.language(this.yP.xs(a.Ua));return Xa.a.xe(a).name}t3f(a){return 2===a?D.a.Sud:this.jN.Yjg?D.a.eXc:D.a.Eka}aHi(a,b,c=null){if(this.gYe(b)){var f=ha.a.ue(b.zN.CategoryTitle);f=tj.j(aA.Jdh,G.a.X7,this.LNa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.Lzc,this.Mzc);f=tj.c("cgProofingOuter",[f]);
a.clear();a.append(tj.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));ka.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}bHi(a,b,c=null){if(this.gYe(b)){var f=ha.a.ue(b.zN.CategoryTitle);c=Object.assign(new jp.a,{ExternalId:String.format("{0}_{1}",aA.Jdh,b.proofingType),Command:"798637440",Image16by16Class:this.LNa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,
Menu:Object.assign(new Tl.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.N4i(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,a);Array.clear(a);f=Object.assign(new ek.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);ka.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}wTd(a,b,c=null){const f=this.r$i(a);
var l=[];let w=!1;var H=a.zN.Suggestions;if(H)if(H=H.slice(0,Math.min(3,H.length)),this.aAc&&(w=!Qa.a.any(H,U=>!U||!U.Description)),1===H.length&&0===H[0].Action)b=ha.a.ue(H[0].Text),l.push(tj.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let U=0,ja=null;w&&(ja="font-weight: bold;");for(const wa of H){if(!wa)continue;H=null;let Sa="",eb=ha.a.ue(wa.Text);w&&(H=this.T_f(wa.Description),
Sa=this.S_f(wa.Description));l.push(tj.a("btnCorrectWord"+U,b[U].toString(),eb,null,null,null,null,null,ja,null,H,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,f,eb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.vJf(a.token)),"ariaDescribedById",Sa));U++}}b="Menu16";0<l.length?w&&(b="Menu16DescriptionEnabled"):l=[tj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,
null)];return tj.e("msUnknownWord",tj.c(null,l),b,f,this.Rdj(a),c,"ariaLabelledById")}bli(a,b,c=null){var f=1!==a.proofingType&&0!==a.proofingType?a.zN.ExplanationTitle:"";f=Object.assign(new ek.a,{Title:f,Lang:c,ControlList:[]});let l=!1;var w=a.zN.Suggestions;if(w)if(w=w.slice(0,Math.min(3,w.length)),this.aAc&&(l=!Qa.a.any(w,H=>!H||!H.Description)),1===w.length&&0===w[0].Action)a=w[0],a=Object.assign(new kg.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,
a);else{let H=0;for(const U of w){if(!U)continue;w=null;let ja="";l&&(w=this.T_f(U.Description),ja=this.S_f(U.Description));if(H>=b.length)break;w?(w=Object.assign(new xB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",H,a.proofingType),Command:b[H].toString(),LabelText:U.Text,Description:w,Lang:c,AriaDescription:ja}),Array.add(f.ControlList,w)):(w=Object.assign(new kg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",H,a.proofingType),Command:b[H].toString(),
LabelText:U.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,w));H++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new kg.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return f}r$i(a){return ha.a.ue(1!==a.proofingType&&0!==a.proofingType?a.zN.ExplanationTitle:"")}Rdj(a){return this.gYe(a)?null:this.LNa.ga(a.proofingType)}gYe(a){return this.uAc&&2!==a.errorType&&(1!==a.errorType||!this.VRa(a))}$wh(a){return this.bVh&&
0!==a.errorType&&1===a.proofingType&&!this.VRa(a)}N4i(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.vJf(a.token)):""}dxh(a){return this.jN.WUa&&this.uAc&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}VRa(a){return 0!==a.errorType&&!!this.PNa&&this.PNa.contains(a.token,a.lcid)}T_f(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}S_f(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,
a):""}vJf(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(n.a)(mE,"EditorServiceProofingContextMenuCreator",null,[]);class Fq{Iaa(a,b){this.Bqi&&this.dml(a,b,Fq.DZg,Fq.mb)}dml(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:Fq.SQi.show(f,a,b)}}BZg(){switch(Fq.DZg){case 5:case 1:return!0;default:return!1}}get Bqi(){return 1!==Pc.App.Kb.state}static get SQi(){return Fq.pbf||(Fq.pbf=Ab.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static Sdj(a){if(!a)return 0;
if(2===Pc.App.Kb.mode)if(R.a.instance.ga(17)&&1===a.length&&jj.OutlineReader.D$b(a.Ua)&&Pc.App.Kb.Ld.Dn&&Pc.App.Kb.Ld.Dn.pp){if(a=ob.GraphIterator.nb(a.Ua.node),a.fv(),!xf.b(a))return 5}else{const b=a.Ua.node;let c=ob.GraphIterator.nb(b);c.fv();return du.e(c.currentNode)?2:u.AFrameworkApplication.kmb||!Eb.EmbeddedFileReader.Lab(b)||Eb.EmbeddedFileReader.aO(b)?a.Ua.contextId===Cb.a.iFrame||VI(a.Ua)?6:1:3}else return 4;return 0}static get mb(){return de.a.instance.Na.mb}static get DZg(){return Fq.Sdj(Fq.mb)}}
Fq.pbf=null;Object(n.a)(Fq,"SelectionContextMenuProvider",null,[273]);class pM{constructor(a){this.la=a}L4d(a,b,c,f,l){const w=c?u.AFrameworkApplication.qm:"";c=c?wp.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',a,b,w,c,ha.a.ue(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',
a,b)}mIi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new mx.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=ha.a.rx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,b));return a}Jsi(){var a=(new mx.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}CIi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;
var b=(new mx.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=ha.a.rx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(n.a)(pM,"ContextMenuHelper",null,[279]);class Wx extends Es{constructor(a,b,c,f){super(a,c);this.$ug=b;this.gWa=f}f5b(a){let b=null,c=!1;var f=de.a.instance.Na.mb;f=Ab.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").rce(f,
a);switch(this.gWa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const l=!!this.$ug&&this.$ug.Fmg("1898844988"),w=Ab.a.instance.resolve("Box4.ISelectionContextMenuProvider").BZg(),H=u.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");l?b=H?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting",
"Table","TableStyle","Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:w&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static KFj(a,b,c,f){a.kji(()=>Wx.dAi(b,c,f))}static dAi(a,b,c){return new Wx(a,b,c,0)}}Object(n.a)(Wx,"PowerPointReactFloatie",Es,[]);class qM{constructor(a,b){this.mxg=b;this.Jre=a}dispose(){}HH(){}oOi(){this.Jre.Bsa()}k6(a,
b,c,f){this.mxg.Jqh(f);this.Jre.k6(a,b,c)}eml(a,b,c,f){14===f?this.k6(a,b,c,f):(this.mxg.Jqh(f),a=new Wx(Ab.a.instance.rb("Common.IReactContextualUILauncher"),Pc.App.OD.VS,Ab.a.instance.rb("Common.IExternalUICommandDefinitionMapping"),f),this.Jre.$qd(b,c,a,Ab.a.instance.rb("Box4.ISelectionContextMenuProvider")))}}Object(n.a)(qM,"ReactContextMenuUser",null,[277]);class rM{constructor(){this.whitelistedControlIds=this.Uaa=this.rG=null;this.OYj=!1;this.Nbl=this.uga=this.vzh=null}}Object(n.a)(rM,"ReactStatusBarInitOptions",
null,[]);class sM{constructor(){this.whitelistedControlIds=null}}Object(n.a)(sM,"StatusBarProps",null,[]);class Xx{constructor(a,b,c=!0){this.yJd=!1;this.Fmf=null;this.L5a=b.rG;this.Ipf=b.vzh;c?db.a.get_instance().Uj(7,()=>{this.QIc(a,b)}):this.QIc(a,b)}QIc(a,b){window.setTimeout(()=>{Ad.a.instance.hG(()=>{sj.UISurfaces.Olj().then(c=>{const f=Object.assign(new sM,{whitelistedControlIds:b.whitelistedControlIds});c.initializeNewStatusBar(a,f,this.Ipf);this.Fmf=c;this.yJd=!0;window.setTimeout(()=>{Ad.a.instance.hG(()=>
{const l=[];if(b.Uaa){const w=b.Uaa;for(let H in w)l.push(appChrome.actions.updateControlHiddenState(H,w[H]));appChrome.api.dispatch(l)}this.HH()},"RSB:I2")},0);return null}).catch(()=>{ka.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(b.uga&&a){Xx.Cdf||(u.AFrameworkApplication.Ta.ya(G.a.xzh,Xd.a.frame,Object(F.a)(this,this.yzh,"statusBarTabAction")),u.AFrameworkApplication.Ta.ya(G.a.wzh,Xd.a.frame,Object(F.a)(this,this.yzh,"statusBarTabAction")),
Xx.Cdf=!0);const c=Rr.a.Oee(b.uga,b.Nbl,a,!1);c.dJ=!0;this.ZJb(c,G.a.xzh,G.a.wzh)}},0)}HH(){this.yJd&&this.L5a&&window.setTimeout(()=>{this.L5a(this.Fmf.selectors.getStatusBarControlsMap(this.Ipf),7)},0)}e6(a,b){this.yJd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,b))},0)}ZJb(a,b,c){const f=x.KeyInputManager.Oa(A.a.Sq,0),l=x.KeyInputManager.Oa(A.a.Sq,4);a.Dp(f);a.Dp(l);a.bindAction(f,b);a.bindAction(l,c)}yzh(){return 4}}Xx.Cdf=!1;Object(n.a)(Xx,"ReactStatusBar",
null,[]);class nE{constructor(a,b,c,f,l,w,H){this.ahc=null;this.Qb=H;this.bic=a;this.Ik=f;this.igk=l;this.hik=w;this.$Va=c||new hH.a;this.nh=this.$Va.PYd(3,"StatusBarUser");a=()=>{this.QIc();this.$Va.H2c(3)};Pd.a("StatusBarTTVRImprovementEnabled")&&Object(Ya.a)(108,this.Qb)?this.Qb.bzb(a):this.Qb.ff(a);this.aJg=b;this.aJg.wF(Object(F.a)(this,this.Zkc,"onSlidesTopologyChanged"))}dispose(){this.aJg.bP(Object(F.a)(this,this.Zkc,"onSlidesTopologyChanged"))}QIc(){const a=this.nh.Bu("createStatusBar"),
b=new rM;b.Uaa=this.Qhj();b.OYj=!1;b.rG=Object(F.a)(this,this.GHl,"updateStatusBarControls");b.vzh="PptEditingStatusBar";Pd.a("ReactStatusBarRTLSupport")&&u.AFrameworkApplication.isRtl&&this.bic&&(this.bic.style.direction="rtl");this.ahc=new Xx(this.bic,b,!1);this.nh.Gu(a)}HH(){this.ahc&&this.ahc.HH()}e6(a,b){this.ahc&&this.ahc.e6(this.yxb(a),!b)}yxb(a){const b=this.igk.v7d(a);return b&&0<b.count?b.ga(0):a}Zkc(a,b){2===b.VZ&&this.HH()}GHl(a){Pc.App.Kb&&Pc.App.Kb.rG(a)}Qhj(){const a=this.hik.poj(),
b={};for(const c of Object.keys(a))b[this.yxb(c)]=a[c];u.AFrameworkApplication.fa.ka("FeedbackPaneExperienceIsEnabled")&&u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(b[this.yxb("PptEditingStatusBar.GiveFeedbackPane")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.yxb("PptEditingStatusBar.GiveFeedback")]=!0):(b[this.yxb("PptEditingStatusBar.GiveFeedback")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.yxb("PptEditingStatusBar.GiveFeedbackPane")]=!0);return b}}nE.jzc=null;Object(n.a)(nE,
"ReactStatusBarUser",null,[550,276]);class tM{constructor(a){this.la=a}poj(){const a={};this.la.vzb||(a["PptEditingStatusBar.ZoomScale"]=!0,a["PptEditingStatusBar.FitToWindow"]=!0);this.la.eJb||(a["PptEditingStatusBar.LanguageButton"]=!0);this.la.fua||(a["PptEditingStatusBar.AddInCommandsLoadStatus"]=!0);this.la.officeOnlineInGallatinTextVisible||(a["PptEditingStatusBar.MiddleStatus"]=!0);this.la.cwh||(a["PptEditingStatusBar.PerfStats"]=!0);this.la.vg&&(a["PptEditingStatusBar.Reading"]=!0);u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")||
(a["PptEditingStatusBar-SlideSorterView"]=!0);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")||(a["PptEditingStatusBar-PresenterView"]=!0);return a}}Object(n.a)(tM,"StatusBarUserHelper",null,[275]);class oE{constructor(){this.Knf=null}get Ymh(){return this.Knf||(this.Knf=Ab.a.instance.rb("Common.IRootManager"))}wb(){}Ee(){}Wog(){}q5k(){this.Ymh&&this.Ymh.VKc()}}Object(n.a)(oE,"ABox4BridgeCommandUi",null,[278,106]);class uM extends oE{constructor(a,b,c,f){super();this.uvg=a;this.tB=b;this.ia=
c;this.jad=f}rG(a){Object(qa.a)(370,this.tB).nPb(a)}T1(a){return 32===this.ia.La(L.a.T1,2,a)}MGk(){this.uvg.clearCache();this.tB.HH()}uPb(){this.tB.uPb()}ATe(a){a?a(this.jad.Bsa()):this.jad.Bsa()}Fmg(a){return this.uvg.aac(a)}Wog(){const a=Object(qa.a)(370,this.tB);a&&a.B_j()}dispose(){}}Object(n.a)(uM,"Box4BridgeCommandUi",oE,[]);var pE=d(1131);class lr{static get j8(){return lr.c7||(lr.c7=Ab.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){lr.j8.showContextMenu(a,b)}static k6(a,
b,c){lr.j8.k6(a,b,c)}static Zqd(a,b,c,f=null){lr.j8.Zqd(a,b,c,f)}}lr.c7=null;Object(n.a)(lr,"BaseContextMenu",null,[]);class Dp extends dx{constructor(){super();this.QOd();this.CPd()}QOd(){this.addCommandToMaps(Object.assign(new Ra.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignLeft","2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignRight",
"393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",
queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableCenterRight","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));
this.addCommandToMaps(Object.assign(new Ra.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableTopLeft_MLR",
"428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",
queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableBottomLeft_MLR","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));
this.addCommandToMaps(Object.assign(new Ra.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Ra.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Ra.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",populationProps:new jh("681481568",!1),previewControlIds:["buttonStyle0",
"buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Ra.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new Ra.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Ra.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));this.addCommandToMaps(Object.assign(new Ra.a("BulletLibrary","3552651681"),
{queryCommandId:"3827179399",populationProps:new jh("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Ra.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new Ra.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new jh("462656847",!1)}));this.addCommandToMaps(Object.assign(new Ra.a("ClearFormatting","2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Ra.a("ClearShadingColor",
"3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Ra.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Ra.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Ra.a(Dp.fCi,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new Ra.a(Dp.lKi,"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Ra.a("DecreaseIndent","3376107472"),
{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Ra.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Ra.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Ra.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Ra.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",
populationProps:new jh("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Ra.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Ra.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new jh("3836866597",!0)}));this.addCommandToMaps(new Ra.a("DictationSettingsHelp","3819824931"));this.addCommandToMaps(new Ra.a("DictationSettingsHelpShowCommands","2729830074"));
this.addCommandToMaps(Object.assign(new Ra.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Ra.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Ra.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));this.addCommandToMaps(Object.assign(new Ra.a("EditTableAltText","868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new Ra.a("FlipHorizontal",
"2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Ra.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Ra.a("FontColor","1970784898"),{legacyControlId:"fontColor",populationProps:new jh("2077552168",!1)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Ra.a("FontName","3430668515"),
{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new jh("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new Ra.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):(this.addCommandToMaps(Object.assign(new Ra.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new jh("179506844",
!1)})),this.addCommandToMaps(Object.assign(new Ra.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Ra.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Ra.a("GrammarSettings","3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Ra.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));
this.addCommandToMaps(Object.assign(new Ra.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Ra.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Ra.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Ra.a("IncreaseIndent","4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Ra.a("IndentFirstLine","682091331"),
{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Ra.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Ra.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));this.addCommandToMaps(Object.assign(new Ra.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));
this.addCommandToMaps(Object.assign(new Ra.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertEmoji",
"2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new jh("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Ra.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertPicture",
"2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Ra.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Ra.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new jh("1256496096",
!0),a));let b;this.addCommandToMaps((b=new Ra.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Ra.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=new Ra.a("Justify","1733835213"),f.legacyControlId="FullJustify",f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new Ra.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",
l));let w;this.addCommandToMaps((w=new Ra.a("LineSpacing","2222099814"),w.legacyControlId="flyLineSpacing",w.populationProps=new jh("2818132660",!0),w));let H;this.addCommandToMaps((H=new Ra.a("LineSpacingOptions","2465215107"),H.legacyControlId="grpParagraphDialogLauncherButton",H));let U;this.addCommandToMaps((U=new Ra.a("LockAspectRatio","3369422509"),U.legacyControlId="toggleBtnLockAspectRatio",U.queryCommandId="4201275867",U));let ja;this.addCommandToMaps((ja=new Ra.a("Margins","1451516907"),
ja.legacyControlId="flyMargins",ja));let wa;this.addCommandToMaps((wa=new Ra.a("MergeCells","4127468093"),wa.legacyControlId="btnMergeTableCells",wa));this.addCommandToMaps(new Ra.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Ra.a("MoreStyles","3340688468"));let Sa;this.addCommandToMaps((Sa=new Ra.a("MoreSymbols","3574218963"),Sa.legacyControlId="btnMoreSymbols",Sa));let eb;this.addCommandToMaps((eb=new Ra.a("MultilevelStyle1","3062940477"),eb.queryCommandId="1240192421",eb.menuItemId="MultilevelStyleMultilevelLibrary_1",
eb));let ub;this.addCommandToMaps((ub=new Ra.a("MultilevelStyle2","3062940477"),ub.queryCommandId="1240192421",ub.menuItemId="MultilevelStyleMultilevelLibrary_2",ub));let Ub;this.addCommandToMaps((Ub=new Ra.a("MultilevelStyle3","3062940477"),Ub.queryCommandId="1240192421",Ub.menuItemId="MultilevelStyleMultilevelLibrary_3",Ub));let cc;this.addCommandToMaps((cc=new Ra.a("NoHighlight","562361573"),cc.legacyControlId="noFontBackgroundColor",cc));let Fc;this.addCommandToMaps((Fc=new Ra.a("NumberingLibrary",
"2213049770"),Fc.queryCommandId="3488367157",Fc.populationProps=new jh("3149136033",!1),Fc));let Ic;this.addCommandToMaps((Ic=new Ra.a("Orientation","1451516907"),Ic.legacyControlId="flyOrientation",Ic));let Cc;this.addCommandToMaps((Cc=new Ra.a("ParagraphOptions","2465215107"),Cc.legacyControlId="grpLayoutParagraphDialogLauncherButton",Cc));this.addCommandToMaps(new Ra.a(Dp.SEk,"237279923"));let Ud;this.addCommandToMaps((Ud=new Ra.a(Dp.NEk,"1656143904"),Ud.legacyControlId="fseaNewPaste",Ud));this.addCommandToMaps(new Ra.a(Dp.MEk,
"1656143904"));let je;this.addCommandToMaps((je=new Ra.a("PageSize","1451516907"),je.legacyControlId="flySize",je));this.addCommandToMaps(new Ra.a("Photos","2670646631"));let Vd;this.addCommandToMaps((Vd=new Ra.a("PictureAbsoluteHeight","2808088361"),Vd.legacyControlId="spnAbsoluteHeight",Vd.queryCommandId="2181343285",Vd));let Ve;this.addCommandToMaps((Ve=new Ra.a("PictureAbsoluteWidth","3108736954"),Ve.legacyControlId="spnAbsoluteWidth",Ve.queryCommandId="1960824158",Ve));this.addCommandToMaps(new Ra.a("Print",
"1588554917"));let af;this.addCommandToMaps((af=new Ra.a("PrintToWeb","1997662572"),af.legacyControlId="jbtnDigitalPrint",af));let Zf;this.addCommandToMaps((Zf=new Ra.a("ReadingView","3849298593"),Zf.legacyControlId="btnReadingMode",Zf));let lg;this.addCommandToMaps((lg=new Ra.a("Redo","4183277502"),lg.legacyControlId="btnRedo",lg));let Tg;this.addCommandToMaps((Tg=new Ra.a("ResetPicture","2916220093"),Tg.legacyControlId="btnResetPicture",Tg));let Ug;this.addCommandToMaps((Ug=new Ra.a("RightToLeftTextDirection",
"2632572640"),Ug.legacyControlId="TextDirRTL",Ug.queryCommandId="1154760330",Ug));let ag;this.addCommandToMaps((ag=new Ra.a("RotatePictureMenu","2545543284"),ag.legacyControlId="flyRotate",ag));let ih;this.addCommandToMaps((ih=new Ra.a("RotateLeft90","2545543284"),ih.legacyControlId="buttonRotateLeft90",ih.menuItemId="buttonRotateLeft90",ih));let Vg;this.addCommandToMaps((Vg=new Ra.a("RotateRight90","2545543284"),Vg.legacyControlId="buttonRotateRight90",Vg.menuItemId="buttonRotateRight90",Vg));let di;
this.addCommandToMaps((di=new Ra.a("SelectCell","111222446"),di.legacyControlId="btnSelectCell",di));let Si;this.addCommandToMaps((Si=new Ra.a("SelectColumn","2341852628"),Si.legacyControlId="btnSelectColumn",Si));let rj;this.addCommandToMaps((rj=new Ra.a("SelectRow","3508003794"),rj.legacyControlId="btnSelectRow",rj));let sg;this.addCommandToMaps((sg=new Ra.a("SelectTable","2306914518"),sg.legacyControlId="btnSelectTable",sg));let Cg;this.addCommandToMaps((Cg=new Ra.a("ShrinkFontSize","3575191971"),
Cg.legacyControlId="fseaShrinkFontSize",Cg));let sh;this.addCommandToMaps((sh=new Ra.a("SetProofingLanguage","510284732"),sh.legacyControlId="fseaOpenLanguageDialog",sh));let vk;this.addCommandToMaps((vk=new Ra.a("SpacingAfter","2322582597"),vk.legacyControlId="spnSpacingAfter",vk.queryCommandId="2340669283",vk));let Ni;this.addCommandToMaps((Ni=new Ra.a("SpacingBefore","1804274502"),Ni.legacyControlId="spnSpacingBefore",Ni.queryCommandId="26138520",Ni));let wk;this.addCommandToMaps((wk=new Ra.a("SpecialIndent",
"2798144440"),wk.legacyControlId="flySpecialIndent",wk));let Jl;this.addCommandToMaps((Jl=new Ra.a("Spelling","2646312425"),Jl.legacyControlId="fseaNextSpellingError",Jl));let hk;this.addCommandToMaps((hk=new Ra.a("StandardShadingColorPicker","2765388691"),hk.legacyControlId="cellShadingColorTable",hk));this.addCommandToMaps(new Ra.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Ra.a("RecentFontColorPicker","1970784898"));let Kl;this.addCommandToMaps((Kl=new Ra.a("Strikethrough",
"4169095173"),Kl.legacyControlId="fsbcStrikethrough",Kl.queryCommandId="2742230607",Kl));let Vj;this.addCommandToMaps((Vj=new Ra.a("StyleOptionsBandedColumns","1583455318"),Vj.legacyControlId="buttonBandedColumn",Vj.queryCommandId="1762426222",Vj.menuItemId="buttonBandedColumn",Vj));let Wj;this.addCommandToMaps((Wj=new Ra.a("StyleOptionsBandedRows","1583455318"),Wj.legacyControlId="buttonBandedRow",Wj.queryCommandId="1762426222",Wj.menuItemId="buttonBandedRow",Wj));let nk;this.addCommandToMaps((nk=
new Ra.a("StyleOptionsFirstColumn","1583455318"),nk.legacyControlId="buttonFirstColumn",nk.queryCommandId="1762426222",nk.menuItemId="buttonFirstColumn",nk));let gl;this.addCommandToMaps((gl=new Ra.a("StyleOptionsHeaderRow","1583455318"),gl.legacyControlId="buttonFirstRow",gl.queryCommandId="1762426222",gl.menuItemId="buttonFirstRow",gl));let yj;this.addCommandToMaps((yj=new Ra.a("StyleOptionsLastColumn","1583455318"),yj.legacyControlId="buttonLastColumn",yj.queryCommandId="1762426222",yj.menuItemId=
"buttonLastColumn",yj));let wh;this.addCommandToMaps((wh=new Ra.a("StyleOptionsTotalRow","1583455318"),wh.legacyControlId="buttonLastRow",wh.queryCommandId="1762426222",wh.menuItemId="buttonLastRow",wh));let hl;this.addCommandToMaps((hl=new Ra.a("Subscript","1455408143"),hl.legacyControlId="fsbcSubscript",hl.queryCommandId="3960255053",hl));let Yl;this.addCommandToMaps((Yl=new Ra.a("Superscript","1107614"),Yl.legacyControlId="fsbcSuperscript",Yl.queryCommandId="692901994",Yl));let wm;this.addCommandToMaps((wm=
new Ra.a("Table","28738965"),wm.legacyControlId="flyInsertTable",wm));let Fk;this.addCommandToMaps((Fk=new Ra.a("TableStyles","4171428777"),Fk.queryCommandId="2135594455",Fk.populationProps=new jh("3359297384",!1),Fk.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),Fk));this.addCommandToMaps(Object.assign(new Ra.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));
this.addCommandToMaps(Object.assign(new Ra.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Ra.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Ra.a("TextAlignmentLeftJustify","2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));
this.addCommandToMaps(Object.assign(new Ra.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Ra.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Ra.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Ra.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Ra.a("ThemeFontColorPickerMCU","1970784898"));this.addCommandToMaps(new Ra.a("ToggleChangeCase",
"1208649786"));this.addCommandToMaps(Object.assign(new Ra.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Ra.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Ra.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Ra.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Ra.a("EditInClient","3588168074"),{legacyControlId:"btnjEditInClient"}));
this.addCommandToMaps(Object.assign(new Ra.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let Gk;this.addCommandToMaps((Gk=new Ra.a("PrintDocument","1588554917"),Gk.legacyControlId="jbtnDirectPrint",Gk));let Di;this.addCommandToMaps((Di=new Ra.a("PrintToPdf","1588554917"),Di.legacyControlId="jbtnPrintToPdf",Di));let Mg;this.addCommandToMaps((Mg=new Ra.a("ProtectDocument","1642700244"),Mg.legacyControlId="btnProtectDocument",Mg.queryCommandId="3993403020",Mg));let Ei;this.addCommandToMaps((Ei=
new Ra.a("TransformToWebPage","1997662572"),Ei.legacyControlId="jbtnTransformToWeb",Ei));let mg;this.addCommandToMaps((mg=new Ra.a("OpenInClientWithIcon","3588168074"),mg.legacyControlId="btnOpenInClient",mg));let Md;this.addCommandToMaps((Md=new Ra.a("BulletLibrary_MLR","3552651681"),Md.queryCommandId="3827179399",Md.populationProps=new jh("2466004410",!1),Md));let Pe;this.addCommandToMaps((Pe=new Ra.a("InsertPicture_MLR","2670646631"),Pe.legacyControlId="fseaInsertPicture",Pe));let zf;this.addCommandToMaps((zf=
new Ra.a("NumberingLibrary_MLR","2213049770"),zf.queryCommandId="3488367157",zf.populationProps=new jh("3149136033",!1),zf));let ge;this.addCommandToMaps((ge=new Ra.a("PasteStandalone","237279923"),ge.legacyControlId="fseaPaste",ge));let Lg;this.addCommandToMaps((Lg=new Ra.a("Clipboard_MLR","237279923"),Lg.legacyControlId="fseaNewPaste",Lg));let ei;this.addCommandToMaps((ei=new Ra.a("InsertOnlinePictureStandalone","1685987254"),ei.legacyControlId="fseaInsertOnlinePicture",ei));let ti;this.addCommandToMaps((ti=
new Ra.a("InsertPictureFromHostStandalone","720118144"),ti.legacyControlId="fseaInsertOnlinePictureFromHost",ti.queryCommandId="3612507612",ti))}CPd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}Dp.lKi="Cut";Dp.fCi="Copy";Dp.SEk="Paste";Dp.NEk="PasteAsTextOnly";Dp.MEk="PasteAsTextOnlyContextMenu";Object(n.a)(Dp,"Box4ReactCommandDefinitionMapping",dx,[]);class Gj extends lr{constructor(a,b,c){super();this.pmf=b;this.Fm=c;this.wb(a)}wb(a){a.ra(D.a.Nid,Cb.a.application,
Object(F.a)(this,this.Tah,"populateContextMenu"),96);a.ra(D.a.Yah,Cb.a.application,Object(F.a)(this,this.Tah,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const w=this.phj(a);if(w&&(a=a.Ua.node)&&(a=a.sc(na.InteractiveViewManager.instance.Qd.Ma))){l=P.a.Qt(a,w.end);if(u.AFrameworkApplication.isRtl&&l.x>b.x||!u.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=P.a.Qt(a,w.end-1);b.x=l.x+(u.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}lr.Zqd("mnuSpellingError",
new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}Tah(a,b,c,f,l){if(1===c)return 32;a=l.Iu;l=l.rd;b=Object.assign(new Tl.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.UFi(b,a);l.MenuItems=b;return 32}rce(a,b){return this.fxh(a)||Gj.XEf(D.a.mergeCells)||Gj.XEf(D.a.splitCells)||this.kol(a,b)||this.Vll(a,b)||Gj.hnl()||Gj.Jwh(a).returnValue}fxh(a){return 2===Pc.App.Kb.mode&&this.v_c(a)}M1b(a,b,c,f=null){if(this.fxh(a)){c=this.ohj(a);var l=Xa.a.xe(c.lcid);l=l?l.name:"UNKNOWN";
var w=Object(Ya.a)(Uo.a,c)?c.typeId:"";ka.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,w,l);f?(a=this.pmf.I1b(a,c))&&f.push.apply(f,a):b.append(this.pmf.create(a,c))}}ohj(a){return this.Fm.PSa(a.Ua).Hh}v_c(a){return this.Fm.bqc(a)}O1f(){return null}phj(a){return this.v_c(a)?this.Fm.PSa(a.Ua):(a=this.O1f(a))?new Dk.a(a.xN,a.Lb):null}kol(a,b){if(2!==Pc.App.Kb.mode||!a||!Gj.hSj&&this.lol(a,b))return!1;a=Wa.a.$Qa(a.toArray());
return!!Gj.jm.V2(a,14)}lol(a,b){return 2===b||3===b&&!this.v_c(a)}Vll(a,b){return 3!==b||this.v_c(a)}static get Rf(){return Gj.Wg||(Gj.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}static get jm(){return vh.ContextSetEditor.instance}static get hSj(){return 1===Pc.App.mode}static get MPj(){null==Gj.hEd&&(Gj.hEd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Gj.hEd}static get Gjc(){null==Gj.a2a&&(Gj.a2a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):
!1);return Gj.a2a}static get GS(){null==Gj.ZM&&(Gj.ZM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Gj.ZM}static XEf(a){return 32===u.AFrameworkApplication.Ta.processAction(a,1)}static hnl(){return 2===Pc.App.Kb.mode&&!!Pc.App.OD.VS&&Pc.App.OD.VS.Fmg("510284732")}static Jwh(a){let b,c;b=c=!1;if(!a)return{returnValue:!1,STa:b,A8b:c};if(Gj.Gjc)return Gj.Wml(a);if(!(a.Cca||Gj.MPj&&2===a.length&&a.Ye.contextId===Cb.a.endOfParagraph))return{returnValue:!1,
STa:b,A8b:c};a=a.Ua.clone();b=32===u.AFrameworkApplication.Ta.pi(a,D.a.vJa,1,!0,null,null);c=32===u.AFrameworkApplication.Ta.pi(a,D.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,STa:b,A8b:c}}static Wml(a){let b;let c;var f=a.Ua.clone();c=Gj.GS&&oe.m(f);b=!c&&32===u.AFrameworkApplication.Ta.pi(f,D.a.vJa,1,!0,null,null);if(a.Cca||2===a.length&&a.Ye.contextId===Cb.a.endOfParagraph)f=!c&&32===u.AFrameworkApplication.Ta.pi(f,D.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let w=
0;w<l;w++){const H=a.ga(w).clone();if(H.contextId===Cb.a.paragraph||H.contextId===Cb.a.textRange)(c=Gj.GS&&oe.m(H))||(f=32===u.AFrameworkApplication.Ta.pi(H,D.a.insertHyperlink,1,!0,null,null)&&f);else if(H.contextId!==Cb.a.endOfParagraph)return f=b=!1,{returnValue:!1,STa:b,A8b:f}}}return{returnValue:b||f,STa:b,A8b:f}}static hFi(a,b){let c=!1,f=!1;({STa:c,A8b:f}=Gj.Jwh(a)).returnValue&&(c?f?b.push(Gj.c9d(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(Gj.c9d(["OpenHyperlink"])):
f&&b.push(Gj.c9d(["InsertLink"])))}static c9d(a){const b=Object.assign(new ek.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:c}));return b}}Gj.hEd=null;Gj.Wg=null;Gj.a2a=null;Gj.ZM=null;Object(n.a)(Gj,"AEditSurfaceContextMenu",lr,[]);class bA extends Gj{constructor(a,b,c,f,l,w,H,U,ja,wa){super(a,c,b,void 0,wa);this.gWa=0;this.Kre=f;this.yGa=l;this.la=w;this.z$c=this.la.eJb;this.sec=this.la.O8b;this.HVg=this.la.K0c;this.OVg=this.la.Ume;this.KXa=this.la.sjb;
this.P8j=this.la.Lmc;this.lPg=wa;this.PC=b;this.lRg=H;this.tE=U;this.Tb=ja;this.S9c=this.la.kGk}UFi(a,b){const c=[];switch(this.gWa){case 4:this.qra(c,!0);this.Etf(c);this.N6h(c);this.e7h(c);this.KXa&&this.n8h(c);this.IYb(c);this.DPa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.qra(c,!1);this.zPd(c,this.gWa);this.IYb(c);this.DPa(c);this.lub(c);break;case 6:case 5:this.qra(c,!1);this.zPd(c,this.gWa);this.la.eJb&&this.la.Mth&&this.Btf(c);this.DPa(c);this.lub(c);break;case 2:this.qra(c,
!0);this.IGc(c,!0);this.la.Ln&&this.HGc(c);break;case 1:this.qra(c,!1);this.IGc(c,!1);this.la.lAh&&this.O8h(c);this.Etf(c);this.ttf(c);jx.Euh&&this.luf(c);this.la.Ln&&this.HGc(c);this.IYb(c);this.DPa(c);this.lub(c);break;case 3:this.C5h(c);this.lub(c);break;case 19:this.G8h(c);this.IGc(c,!1);this.ttf(c);jx.Euh&&this.luf(c);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.HGc(c);this.IYb(c);break;case 21:this.u9h(c);break;case 20:this.qra(c,!0);this.IGc(c,!0);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&
this.HGc(c);this.IYb(c);break;case 9:this.qra(c,!1);this.DPa(c);break;case 22:this.qra(c,!1);this.zPd(c,this.gWa);this.DPa(c);break;case 10:this.qra(c,!1);this.D7h(c);this.DPa(c);this.lub(c);break;case 17:this.y7h(c);break;case 18:this.z7h(c);break;case 0:if(this.Tb.qj()){var f=na.InteractiveViewManager.instance.Qd.Mb.Na.mb;this.M1b(f,null,b,c);this.qra(c,!1);this.la.powerPointSmartLookupIsEnabled&&(this.F8h(c),this.T8h(c));3===b&&this.qRj(f)&&this.q6h(c);this.S7h(c);Gj.hFi(f,c);this.HIi(f,c);this.GIi(f,
c);this.z$c&&this.Btf(c);this.ODi(c);this.DPa(c);this.lub(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.gWa=0}Jqh(a){this.gWa=a}Rt(){return Object.assign(new ek.a,{ControlList:[]})}jol(a){if(!this.HVg&&!this.OVg||2!==Pc.App.Kb.mode)return!1;a=Wa.a.$Qa(a.toArray());return!!this.yGa.V2(a,14)}iol(a){if(!a||!this.P8j||2!==Pc.App.Kb.mode)return!1;a=Wa.a.$Qa(a.toArray());return!!this.yGa.V2(a,14)}qra(a,b){const c=this.Rt();b||(Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"Cut"})),
Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"Copy"})));this.Ptf(a,c)}Ptf(a,b){const c=Object.assign(new ek.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),f=Object.assign(new yq.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);
for(let l=1;5>=l;l++)f.GalleryItems.push(this.qwb(l));a.push(b);a.push(c)}qwb(a){const b={root:{width:"24px",height:"24px"}};let c,f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;
break;case 4:l="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new pE.a,{Id:l,Icon:a,Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}u9h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"CopyInVersionHistory"}));
a.push(b)}G8h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"Copy"}));this.Ptf(a,b)}IGc(a,b){const c=this.Rt();Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"DeleteSlide"})));a.push(c)}N6h(a){if(this.S9c){const b=this.Rt();
b.ControlList.push(Object.assign(new kg.a,{ExternalId:"FormatBackgroundFromCanvas"}));a.push(b)}}C5h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}ttf(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"HideSlide"}));this.la.ide&&Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"UnhideSlide"}));a.push(b)}luf(a){const b=
this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"ShareSlide"}));a.push(b)}z7h(a){const b=this.U0f();a.push(b)}HGc(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"AddSection"}));a.push(b)}zPd(a,b){const c=this.Rt();7===b?(this.la.UJa?Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"ChangePicture"})),this.la.NYf&&this.O6h(c),this.la.FUa&&Array.add(c.ControlList,
Object.assign(new kg.a,{ExternalId:"AlternativeText"}))):13===b?this.la.UJa&&Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"SmartArtEditText"})):14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.rtf(c),this.la.HQc&&this.jtf(c));this.Xsf(c);this.LAf(c);this.Vph(c);a.push(c)}Etf(a){const b=this.Rt();Array.add(b.ControlList,
Object.assign(new kg.a,{ExternalId:this.la.b_a?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}Btf(a){const b=this.Rt();this.sec&&Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}IYb(a){if(this.sec){var b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}Vph(a){Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"SendToBackFlyout"}))}LAf(a){Array.add(a.ControlList,
Object.assign(new kg.a,{ExternalId:"BringToFrontFlyout"}))}rtf(a){Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"GroupAnchor"}))}Xsf(a){Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"ShowHideFormatShapePane"}))}O6h(a){Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"FormatPicture"}))}jtf(a){Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"FixIt"}))}D7h(a){const b=this.Rt();this.rtf(b);this.la.HQc&&this.jtf(b);this.Xsf(b);this.LAf(b);this.Vph(b);a.push(b)}DPa(a){const b=
this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"InsertComment"}));a.push(b)}e7h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"DesignerHome"}));a.push(b)}n8h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"ShowHideRuler"}));a.push(b)}pFi(){const a=this.Kre.mIi();return Object.assign(new kg.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}F8h(a){const b=this.Rt();Array.add(b.ControlList,this.pFi());a.push(b)}T8h(a){if(!this.Kre.Jsi()){var b=
this.Kre.CIi();if(b){var c=this.Rt();Array.add(c.ControlList,Object.assign(new kg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}S7h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"ParagraphOptions"}));a.push(b)}q6h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"Delete"}));a.push(b)}O8h(a){const b=this.Rt();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"SummarizeSlides"}));a.push(b)}ODi(a){var b=Ab.a.instance.rb("PowerPointWebEditor.IContextMenuExtensibilityHandler");
b&&(b=b.F2i())&&a.push(b)}HIi(a,b){a&&this.jol(a)&&(a=this.Rt(),this.HVg&&Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"MergeTableCells"})),this.OVg&&Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"SplitTableCells"})),b.push(a))}GIi(a,b){this.iol(a)&&(a=this.Rt(),Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"TableDistribute"})),b.push(a))}qRj(a){return this.PC.bqc(a)}y7h(a){const b=
this.U0f();Array.add(b.ControlList,Object.assign(new kg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}U0f(){const a=this.Rt();Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"MoveSectionUp"}));Array.add(a.ControlList,Object.assign(new kg.a,{ExternalId:"MoveSectionDown"}));return a}lub(a){this.lRg&&this.lRg.I1b(this.i5b(),a)}i5b(){return this.tE.instance?
this.tE.instance.i5b():[]}}Object(n.a)(bA,"EditSurfaceContextMenu",Gj,[]);class vM{constructor(a,b,c,f,l,w,H,U,ja,wa){this.Ahc=null;this.hFb=0;this.LO=b;this.tB=c;this.Sla=f;this.zb=w;this.p8j=H;this.ia=ja;this.Lc=U;this.Lc.Y9h(Object(F.a)(this,this.a3g,"onCUIStatusChanged"));this.Lc.SGc(Object(F.a)(this,this.EU,"onFocusChanged"));this.Lc.ZGc(Object(F.a)(this,this.hhb,"onSetFocus"));this.jad=wa}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Lc.AZk(Object(F.a)(this,this.a3g,
"onCUIStatusChanged"));this.Lc.Vld(Object(F.a)(this,this.EU,"onFocusChanged"));this.Lc.KRe(Object(F.a)(this,this.hhb,"onSetFocus"))}initialize(){this.wb();this.HH()}EU(){}hhb(a,b){b.Hgb!==Lb.a.waa||b.UIb===E.AFrame.tgb||b.UIb.endsWith("/modal")||appChrome.api.enterKeytipMode()}Ezl(a){this.hFb|=a;this.Ahc||(this.Ahc=new Le.a(0,1,0,Object(F.a)(this,this.Xfl,"setTimeOutWithCurrentActionContext"),90,"11"),this.Ahc.customData=new Date,this.zb.Db(this.Ahc))}wb(){this.ia.ra(L.a.T1,nc.a.application,Object(F.a)(this,
this.dvj,"handleOpenMenu"),64)}dvj(a,b,c,f,l){return this.T1(l)?32:8}Xfl(a){Rc.a.IUi(Object(F.a)(this,this.HH,"poll"),Object(qa.a)(Date,a.customData));this.Ahc=null}a3g(a,b){this.Ezl(b.qsl)}HH(){this.p8j.clearCache();0!==(this.hFb&1)&&this.tB.HH();0!==(this.hFb&2)&&this.LO.HH();0!==(this.hFb&4)&&this.Sla.HH();this.hFb=0}T1(a){return this.jad.T1(a)}}Object(n.a)(vM,"CUIManager",null,[274,106]);var qE=d(1236),rE=d(1208),lR=d(1074),sE=d(1095);class gt{constructor(){this.italic=0;this.k1c=!1;this.underline=
0;this.tV=this.Jud=!1;this.superscript=0;this.rsd=!1;this.subscript=0;this.nsd=!1;this.strikethrough=0;this.fsd=!1;this.Zs=0;this.qOc=!1;this.fontName=null;this.S4b=this.otd=this.TQc=this.SQc=!1;this.highlight=0;this.PWc=!1;this.bold=this.italic=this.underline=this.strikethrough=this.Zs=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.Rw=We.Font.RIj;this.ipa=-1;this.eTd=this.k1c=this.Jud=this.tV=this.rsd=this.nsd=this.fsd=this.qOc=this.SQc=this.TQc=this.otd=this.S4b=
this.PWc=!1}}Object(n.a)(gt,"FormattingData",null,[]);var tE=d(832),mR=d(798);class Wk{constructor(){this.Hm=this.mhb=0;this.rd=null;this.BE=!1;this.fL=null}}Object(n.a)(Wk,"CuiEnabledInfo",null,[]);class kh{constructor(){this.Hm=this.mhb=0;this.rd=null;this.BE=this.Ole=this.Ple=this.hX=this.$q=this.Tce=!1;this.fL=null}}Object(n.a)(kh,"CuiExecuteInfo",null,[]);class nR{constructor(){this.x0e=new sq.a;this.Dke=!1}}Object(n.a)(nR,"TextRangeStyleData",null,[]);class Fg{constructor(){this.jb=new qd.a;
this.Xc=new qd.a;this.Vcf=new gt;this.tlf=new tE.a;this.zCd=this.yCd=!1}initialize(){Fg.NAh=Fg.hZd();this.jb.$(D.a.undo,Fg.Y8b);this.jb.$(D.a.redo,Fg.Y8b);this.jb.$(D.a.led,Fg.Y8b);this.jb.$(D.a.Yah,Fg.oyl);this.jb.$(D.a.openInClient,Fg.lBk);this.jb.$(G.a.close,Fg.Hvi);this.jb.$(D.a.bL,Fg.INi);this.jb.$(D.a.font,Fg.W4d);this.jb.$(D.a.Pq,Object(F.a)(this,this.L5d,"genericFontSizeExecuteBridge"));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.jb.$(D.a.S5,Fg.W4d),this.jb.$(D.a.IKa,Fg.W4d),
this.jb.$(D.a.WJa,Object(F.a)(this,this.L5d,"genericFontSizeExecuteBridge")),this.jb.$(D.a.C_a,Object(F.a)(this,this.V4k,"revertPreviewFontSizeExecuteBridge")));this.jb.$(D.a.bold,Fg.cwb);this.jb.$(D.a.setItalic,Fg.cwb);this.jb.$(D.a.underline,Fg.cwb);this.jb.$(D.a.strikethrough,Fg.cwb);this.jb.$(D.a.superscript,Fg.cwb);this.jb.$(D.a.subscript,Fg.cwb);this.jb.$(D.a.hnc,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.qnc,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));
this.jb.$(D.a.aoc,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Rnc,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Tnc,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.NOe,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Unc,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Ijd,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.lnc,Object(F.a)(this,this.Jxa,
"queryFormattingExecuteBridge"));this.jb.$(D.a.Jjd,Object(F.a)(this,this.Jxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.bOe,Object(F.a)(this,this.vNk,"queryFormatPainterExecuteBridge"));this.jb.$(D.a.rnc,Object(F.a)(this,this.Tjd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.Dnc,Object(F.a)(this,this.Tjd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.knc,Object(F.a)(this,this.Tjd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.mnc,Object(F.a)(this,this.Tjd,"queryParaFormattingExecuteBridge"));
this.jb.$(D.a.rC,Fg.aUf);this.jb.$(D.a.Ey,Fg.aUf);this.jb.$(G.a.tWd,Fg.jnc);this.jb.$(D.a.$Ab,Fg.Y8b);this.Xc.$(D.a.pIb,Fg.INc);this.Xc.$(D.a.qIb,Fg.INc);this.Xc.$(D.a.lmc,Fg.INc);this.Xc.$(D.a.kmc,Fg.INc);this.Xc.$(D.a.hnc,Fg.Vxa);this.Xc.$(D.a.qnc,Fg.Vxa);this.Xc.$(D.a.aoc,Fg.Vxa);this.Xc.$(D.a.Rnc,Fg.Vxa);this.Xc.$(D.a.Tnc,Fg.Vxa);this.Xc.$(D.a.NOe,Fg.Vxa);this.Xc.$(D.a.Unc,Fg.Vxa);this.Xc.$(D.a.Ijd,Fg.Vxa);this.Xc.$(D.a.lnc,Fg.Vxa);this.Xc.$(D.a.Jjd,Fg.Vxa);this.Xc.$(D.a.rnc,Fg.Hld);this.Xc.$(D.a.knc,
Fg.Hld);this.Xc.$(D.a.Dnc,Fg.Hld);this.Xc.$(D.a.mnc,Fg.Hld);this.jb.$(D.a.zHf,Object(F.a)(this,this.JHj,"insertHyperLinkBridge"));this.jb.$(D.a.yWd,Object(F.a)(this,this.yHf,"commandingInputMethodExecuteBridge"));this.jb.$(D.a.DHf,Object(F.a)(this,this.yHf,"commandingInputMethodExecuteBridge"));this.jb.$(D.a.AHf,Object(F.a)(this,this.SHj,"insertOnLinePictureExecuteBridge"));this.jb.$(D.a.BHf,Object(F.a)(this,this.hIj,"insertSymbolBridge"));this.jb.$(D.a.CHf,Object(F.a)(this,this.Pwi,"commandingInsertTableExecuteBridge"));
this.jb.$(D.a.Qwi,Object(F.a)(this,this.Ook,"navToPageExecuteBridge"));this.jb.$(D.a.xHf,Fg.wHf);this.jb.$(D.a.xWd,Fg.wHf);u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Xc.$(G.a.jLb,Fg.d8k)}clearCache(){this.Vcf=new gt;this.tlf=new tE.a;this.zCd=this.yCd=!1}j2f(a,b,c){const f=this.jb.ga(a);f?c=f(a,b,c):(c=new kh,c.rd=b);c.mhb=a;c.Hm||(c.Hm=Fg.ilk(a));Sg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&
this.Iwi(a,b)&&(c.rd||(c.rd={}),"object"===typeof c.rd&&(c.rd.MappedCommand=!0));return c}WSc(a,b=null){const c=this.Xc.ga(a);b=c?c(a,b):new Wk;b.mhb=a;b.Hm||(b.Hm=a);return b}Jxa(){const a=new kh;a.Tce=this.zCd;this.zCd=!0;a.Hm=D.a.mJb;a.rd=this.Vcf;a.hX=!0;return a}Tjd(){const a=new kh;a.Tce=this.yCd;this.yCd=!0;a.Hm=D.a.Kxa;a.rd=this.tlf;a.Ole=!0;a.hX=!0;return a}L5d(a,b){const c=new kh;c.$q=!0;let f=0;({number:f}=ha.a.nEk(b.CommandValueId||b.Value,u.AFrameworkApplication.numberFormat));if(isNaN(f))return Pc.App.Kb.updateCommandUI(),
c.fL=!1,c;a===D.a.WJa&&(b[Vm.a.Haa]=!1);c.rd=Fg.YXd(Math.floor(2*f),b);return c}V4k(a,b){a=new kh;a.$q=!0;b[Vm.a.Haa]=!1;a.rd=Fg.YXd(0,b);return a}yHf(a){var b={Visible:!0};a===D.a.yWd?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new rE.a(b,2);b=new kh;b.rd=a;return b}SHj(a,b){a=new kh;const c=new K.DictionaryPropertySet;b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(Yd.a.JU,b);a.rd=c;return a}JHj(a,
b){a=new kh;b.Source="CommandingInterface";a.rd=b;return a}Pwi(a,b){a=new kh;a.$q=!0;const c=new AI;c.rows=b.Row;c.columns=b.Col;a.rd=c;return a}hIj(a,b){a=new kh;a.$q=!0;b=b.Value;a.rd=new K.DictionaryPropertySet;const c=this.WUc(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',c);a.rd=f;return a}Ook(a,b){a=new kh;a.rd=b.Value?b.Value:"";return a}vNk(){const a=new kh;a.rd=Ab.a.instance.rb("Box4.IFormatPainter");
a.hX=!0;return a}WUc(a){return Fg.NAh[a.toString()]}Iwi(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Xc.ga(a)||!!this.jb.ga(a);return!u.AFrameworkApplication.Ta.hT(a)&&b}static hZd(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static zZb(a,
b){var c=Object(qa.a)(gt,a.rd),f=Object(qa.a)(tE.a,a.rd);let l=!0;switch(a.mhb){default:l=!1;break;case D.a.Xdh:b[Vh.a.On]=!0;break;case D.a.hnc:b[Vh.a.On]=1===c.bold;break;case D.a.qnc:b[Vh.a.On]=1===c.italic;break;case D.a.aoc:b[Vh.a.On]=1===c.underline;break;case D.a.NOe:b[TG.a.On]=1===c.subscript;break;case D.a.Tnc:b[Vh.a.On]=1===c.subscript;break;case D.a.Unc:b[Vh.a.On]=1===c.superscript;break;case D.a.Rnc:b[Vh.a.On]=1===c.strikethrough||1===c.Zs;break;case D.a.Ijd:b[Zn.a.IsFreeForm]=!0;b[Zn.a.Value]=
void 0!==c.fontName&&null!==c.fontName?Kb.a.Q1f(c.fontName,c.ipa):"";break;case D.a.lnc:a="";-1!==c.fontSize&&(a=ha.a.gRc(c.fontSize/2,0,u.AFrameworkApplication.numberFormat));b[Zn.a.IsFreeForm]=!0;b[Zn.a.Value]=a;break;case D.a.Jjd:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,f=1===c.italic,a=ea.FontUtils.wNk(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===
c.fontName)a=Kb.a.Q1f(c.fontName,c.ipa),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=ea.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[$n.SelectedFont]=a;break;case D.a.rnc:b[Vh.a.On]=1===f.Jl;break;case D.a.knc:b[Vh.a.On]=2===f.Jl;break;case D.a.Dnc:b[Vh.a.On]=3===f.Jl;break;case D.a.mnc:b[Vh.a.On]=6===f.Jl;break;case D.a.bOe:if(c=
Object(qa.a)(518,a.rd))b[Vh.a.On]=c.yL;case G.a.tWd:}return l}static aUf(){return new kh}static jnc(a,b){a=new kh;a.rd=b;a.hX=!0;return a}static Y8b(a,b,c){a=new rE.a(b,c.InvocationMethod);b=new kh;b.rd=a;return b}static oyl(a,b){a=new rE.a(b,3);b=new kh;b.rd=a;return b}static lBk(a,b,c){a=new kh;lR.a.Vqg(c.CommandLocation)||26===c.CommandLocation||(a.rd=!1);return a}static UNe(){const a=new kh;a.rd=new K.DictionaryPropertySet;a.hX=!0;return a}static INi(){const a=new kh;a.rd=new K.DictionaryPropertySet;
return a}static Hvi(){const a=new kh;a.rd=Dj.b;return a}static INc(){const a=new Wk;a.rd=new K.DictionaryPropertySet;return a}static d8k(a,b=null){a=new Wk;a.rd=b;return a}static cwb(){const a=new kh;a.rd=new V(2);a.$q=!0;return a}static Hld(){const a=new Wk;a.Hm=D.a.Kxa;return a}static Vxa(){const a=new Wk;a.Hm=D.a.mJb;return a}static W4d(a,b){const c=new kh;c.$q=!0;var f=b.CommandValueId?b.CommandValueId:b.Value;c.rd=f;if(We.Font.QUa()){const w=new gt;var l=b.MenuItemId;l&&(w.ipa=We.Font.Enj(l));
(l=Object(qa.a)(mR.a,b[$n.Formatting]))&&(l.isBold||l.isItalic)&&(w.bold=l.isBold?1:0,w.italic=l.isItalic?1:0);w.fontName=f;c.rd=w}Fg.U3j(b);(a=u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.S5||a===D.a.IKa))&&(b[Vm.a.Haa]=!1);c.rd=Fg.YXd(c.rd,b);a||(ea.FontUtils.AGc(f),f=b[$n.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,f)));return c}static U3j(a){void 0!==a[Zn.a.IsFreeForm]&&null!==a[Zn.a.IsFreeForm]&&a[Zn.a.IsFreeForm]?
ka.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&ka.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static wHf(a,b){a=new kh;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.rd=Fg.F7a(b);a.$q=!0;return a}static F7a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,4)+a.substring(0,2)}static ilk(a){switch(a){case D.a.yWd:return D.a.undo;case D.a.DHf:return D.a.redo;
case D.a.CHf:return D.a.insertTable;case D.a.AHf:return D.a.d8;case D.a.BHf:return D.a.nUa;case D.a.zHf:return D.a.insertHyperlink;case D.a.xHf:return D.a.Sr;case D.a.xWd:return D.a.B1;default:return a}}static YXd(a,b){const c=new sE.a(a);return u.AFrameworkApplication.Aa.hb.Pp?new sE.a(a,b[Vm.a.Haa]):c}}Fg.NAh={};Object(n.a)(Fg,"CuiActionBridge",null,[]);class wM{constructor(){this.FRd=this.zZb=this.LLe=this.oMe=null}}Object(n.a)(wM,"GeneralCuiUserHooks",null,[]);var oR=d(501);class Mv{constructor(){this.aV=
this.WZa=null;this.menuItemId=0}}Object(n.a)(Mv,"QueryData",null,[]);let uf;class Fd extends Fg{constructor(a,b,c,f,l,w,H,U,ja){super();this.Yhh=wa=>{let Sa=new kh;({jY:wa}=this.EBl(wa)).returnValue&&(Sa.BE=!0,Sa.Hm=wa);return Sa};this.la=a;this.pa=b;this.D6j=c;this.EEb=f;this.yc=l;this.Tb=w;this.Fb=H;this.KWa=U;if(this.la.ka("IsPasteTextFloatieEnabled")&&!ja)throw Error.argumentNull("textPasteFloatieManager");this.FIa=ja}initialize(){super.initialize();this.LGj();this.cHj();this.dGj();this.PGj();
this.tFj();this.$Gj();this.vGj();this.wFj();this.VFj();this.EFj()}WSc(a,b=null){if(u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=this.Xc.ga(a);b=c?c(a,b):new Wk;b.mhb=a;b.Hm||(b.Hm=a);b&&this.Fb&&1===this.Fb.Fl&&!Fd.xje(a)&&(b.fL=!1);return b}(b=super.WSc(a))&&this.Fb&&1===this.Fb.Fl&&!Fd.xje(a)&&(b.fL=!1);return b}LGj(){this.la.tjb&&(this.Xc.$(L.a.Yhb,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge")),this.Xc.$(L.a.TIb,Object(F.a)(this,this.ioa,
"remapRumTrackerEnabledBridge")),this.Xc.$(G.a.yOb,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge")),this.Xc.$(L.a.Mrc,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge")),this.Xc.$(D.a.Glb,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge")),this.Xc.$(G.a.Xsa,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge")));this.Xc.$(L.a.pLa,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge"));this.Xc.$(L.a.nLa,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge"));this.Xc.$(L.a.oga,
Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge"));this.Xc.$(L.a.Vya,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge"));this.Xc.$(L.a.Fvc,Object(F.a)(this,this.ioa,"remapRumTrackerEnabledBridge"))}cHj(){this.jb.$(L.a.uJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.yJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.BJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.bKa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.cKa,
Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.eKa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.lib,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.hKa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.gKa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.fKa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.jib,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.kib,Object(F.a)(this,this.JE,
"remapTextQueryExecute"));this.jb.$(L.a.vJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.zJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.dKa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.mib,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.xJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.wJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.yOe,Fd.hf);this.jb.$(L.a.AJb,Object(F.a)(this,this.JE,
"remapTextQueryExecute"));this.jb.$(L.a.Mxa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.BOe,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.Yjd,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.UZa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(L.a.VZa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.Xc.$(L.a.uJb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.yJb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));
this.Xc.$(L.a.BJb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.bKa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.cKa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.eKa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.lib,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.hKa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.gKa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.fKa,
Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.jib,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.kib,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.vJb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.zJb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.dKa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.mib,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.xJb,Object(F.a)(this,this.Iw,
"remapTextQueryEnabled"));this.Xc.$(L.a.wJb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.AJb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.Mxa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.BOe,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.Yjd,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.UZa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.VZa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));
this.jb.$(L.a.vIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.BIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.NIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.Bxa,Object(F.a)(this,this.r1c,"justifyExecuteBridge"));this.jb.$(L.a.Dxa,Object(F.a)(this,this.r1c,"justifyExecuteBridge"));this.jb.$(L.a.Fxa,Object(F.a)(this,this.r1c,"justifyExecuteBridge"));this.jb.$(L.a.AZa,Object(F.a)(this,this.r1c,"justifyExecuteBridge"));this.jb.$(L.a.yZa,Object(F.a)(this,
this.At,"remapTextExecute"));this.jb.$(L.a.EIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.HIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.zZa,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.FIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.IIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.Qhb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.Mhb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.d1,Object(F.a)(this,
this.At,"remapTextExecute"));this.jb.$(L.a.c1,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.b1,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.KIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.CIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.Phb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.zmc,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.DIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.Amc,Fd.sqg);
this.jb.$(L.a.Bmc,Fd.sqg);this.jb.$(L.a.Wna,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.RJa,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.BMb,Object(F.a)(this,this.tqg,"listMarkerGalleryShapeExecuteBridge"));this.jb.$(L.a.lMb,Object(F.a)(this,this.tqg,"listMarkerGalleryShapeExecuteBridge"));this.jb.$(L.a.tmc,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.umc,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.Cxa,Object(F.a)(this,this.At,"remapTextExecute"));
this.jb.$(L.a.AIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.vmc,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.zIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.GIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.Emc,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.JIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.insertHyperlink,Object(F.a)(this,this.BXk,"remapInsertHyperlinkExecute"));this.jb.$(L.a.Exa,Object(F.a)(this,
this.At,"remapTextExecute"));this.jb.$(L.a.Nhb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.LIb,Object(F.a)(this,this.At,"remapTextExecute"));this.jb.$(L.a.MIb,Object(F.a)(this,this.At,"remapTextExecute"));this.Xc.$(L.a.vIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.BIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.NIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Bxa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Dxa,Object(F.a)(this,
this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Fxa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.AZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.yZa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.EIb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.HIb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.zZa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.FIb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));
this.Xc.$(L.a.IIb,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.Xc.$(L.a.Qhb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Mhb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.d1,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.c1,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.b1,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.KIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.CIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));
this.Xc.$(L.a.Phb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.zmc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.DIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Wna,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.RJa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.tmc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.umc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Cxa,Object(F.a)(this,this.Ps,"remapTextEnabled"));
this.Xc.$(L.a.AIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.vmc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.zIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.GIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Emc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.JIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Exa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.Nhb,Object(F.a)(this,this.Ps,"remapTextEnabled"));
this.Xc.$(L.a.insertHyperlink,Object(F.a)(this,this.AXk,"remapInsertHyperlinkEnabled"));this.Xc.$(L.a.UZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.VZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.LIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.MIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.UZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(L.a.VZa,Object(F.a)(this,this.Ps,"remapTextEnabled"))}dGj(){this.jb.$(L.a.jOe,Object(F.a)(this,
this.hib,"queryInkControlToggledExecuteBridge"));this.jb.$(L.a.dOe,Object(F.a)(this,this.hib,"queryInkControlToggledExecuteBridge"));this.jb.$(L.a.gOe,Object(F.a)(this,this.hib,"queryInkControlToggledExecuteBridge"));this.jb.$(L.a.eOe,Object(F.a)(this,this.hib,"queryInkControlToggledExecuteBridge"));this.jb.$(L.a.hOe,Object(F.a)(this,this.hib,"queryInkControlToggledExecuteBridge"));this.jb.$(L.a.iOe,Object(F.a)(this,this.hib,"queryInkControlToggledExecuteBridge"));this.jb.$(L.a.fOe,Object(F.a)(this,
this.hib,"queryInkControlToggledExecuteBridge"))}PGj(){this.jb.$(L.a.Jnc,Fd.hf);this.jb.$(L.a.Knc,Fd.hf);this.jb.$(L.a.Mnc,Fd.hf);this.jb.$(L.a.fkd,Fd.hf);this.jb.$(L.a.ekd,Fd.hf);this.jb.$(L.a.gkd,Fd.hf);this.jb.$(L.a.hkd,Fd.hf);this.jb.$(L.a.jkd,Fd.hf);this.jb.$(L.a.dkd,Fd.hf);this.jb.$(L.a.lkd,Fd.hf);this.jb.$(L.a.ikd,Fd.hf);this.jb.$(L.a.rkd,Fd.hf);this.jb.$(L.a.qkd,Fd.hf);this.jb.$(L.a.pkd,Fd.hf);this.jb.$(L.a.pib,Fd.hf);this.jb.$(L.a.qib,Fd.hf);this.jb.$(L.a.SZa,Object(F.a)(this,this.Njd,"queryListMarkerQueryDataExecuteBridge"));
this.jb.$(L.a.TZa,Object(F.a)(this,this.Njd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(L.a.IJb,Fd.hf);this.jb.$(L.a.HJb,Fd.hf);this.jb.$(L.a.Lnc,Fd.hf);this.jb.$(L.a.nkd,Fd.hf);this.jb.$(L.a.okd,Fd.hf);this.Xc.$(L.a.ekb,Fd.Fy);this.Xc.$(L.a.fkb,Fd.Fy);this.Xc.$(L.a.jMb,Fd.Fy);this.Xc.$(L.a.rkb,Fd.Fy);this.Xc.$(L.a.DMb,Fd.Fy);this.Xc.$(L.a.FXe,Fd.Fy);this.jb.$(L.a.ekb,Object(F.a)(this,this.w0i,"fontNameExecuteBridge"));this.jb.$(L.a.fkb,Object(F.a)(this,this.L5d,"genericFontSizeExecuteBridge"));
this.jb.$(L.a.jMb,Fd.c1e);this.jb.$(L.a.rkb,Fd.c1e);this.jb.$(L.a.DMb,Fd.c1e);this.Xc.$(L.a.nyf,Fd.u0a);this.Xc.$(L.a.oyf,Fd.u0a);this.Xc.$(L.a.dIc,Fd.u0a);this.Xc.$(L.a.aIc,Fd.u0a);this.Xc.$(L.a.cIc,Fd.u0a);this.Xc.$(L.a.bIc,Fd.u0a);this.Xc.$(L.a.ERd,Fd.u0a);this.Xc.$(L.a.uRd,Fd.u0a);this.jb.$(L.a.Lpd,Fd.kqg);this.jb.$(L.a.RZa,Fd.keh);this.jb.$(L.a.kkd,Fd.keh);this.jb.$(L.a.Sna,Fd.kqg)}tFj(){this.jb.$(L.a.Aj,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.coa,
Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.Pxa,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.VJb,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.wib,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.Dkd,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.Oxa,Fd.MU);this.jb.$(L.a.Rj,Object(F.a)(this,this.Ztd,"transitionExecuteBridge"));
this.jb.$(L.a.kkb,Object(F.a)(this,this.Ztd,"transitionExecuteBridge"));this.Xc.$(L.a.Rj,Fd.Fy);this.Xc.$(L.a.Poa,Fd.Fy);this.Xc.$(L.a.Cya,Fd.Fy);this.Xc.$(L.a.Sqc,Fd.Fy);this.Xc.$(L.a.lkb,Fd.Fy);this.jb.$(L.a.$na,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.NZa,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.OZa,Object(F.a)(this,this.Nxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.aoa,Object(F.a)(this,this.Nxa,
"queryQueryTransitionResultExecuteBridge"));this.jb.$(L.a.Fz,Object(F.a)(this,this.Ztd,"transitionExecuteBridge"));this.jb.$(L.a.KLb,Object(F.a)(this,this.Ztd,"transitionExecuteBridge"));this.Xc.$(L.a.Fz,Fd.Fy);this.Xc.$(L.a.uya,Fd.Fy);this.Xc.$(L.a.KLb,Fd.Fy);this.Xc.$(L.a.LLb,Fd.Fy);this.Xc.$(L.a.b0a,Fd.Fy);this.jb.$(L.a.$Ja,Fd.MU);this.Xc.$(L.a.Sod,Fd.Fy);this.Xc.$(L.a.$_a,Fd.Fy);this.jb.$(L.a.aKa,Fd.MU);this.Xc.$(L.a.Tod,Fd.Fy);this.Xc.$(L.a.a0a,Fd.Fy);this.Xc.$(L.a.FHc,Fd.Fy);this.jb.$(L.a.jJb,
Fd.hf);this.Xc.$(L.a.Uod,Fd.Fy);this.Xc.$(L.a.Vod,Fd.Fy);this.Xc.$(L.a.Wod,Fd.Fy);this.Xc.$(L.a.Xod,Fd.Fy)}$Gj(){this.jb.$(D.a.RJb,Fg.UNe);this.jb.$(L.a.COe,Fg.UNe);this.jb.$(L.a.OJb,Fd.MU);this.jb.$(L.a.PJb,Fd.MU);this.jb.$(L.a.Znc,Fd.MU);this.jb.$(L.a.Ckd,Fd.MU);this.jb.$(L.a.Wnc,Fd.MU);this.jb.$(L.a.Xnc,Fd.MU);this.jb.$(L.a.Ync,Fd.MU);this.jb.$(L.a.Vnc,Fd.MU);this.jb.$(L.a.wmc,Object(F.a)(this,this.Gld,"remapTableExecute"));this.jb.$(D.a.r8,Object(F.a)(this,this.Gld,"remapTableExecute"));this.jb.$(D.a.rLb,
Object(F.a)(this,this.Gld,"remapTableExecute"));this.jb.$(D.a.insertTable,Object(F.a)(this,this.Gld,"remapTableExecute"));this.Xc.$(D.a.insertTable,Object(F.a)(this,this.Msi,"checkInsertTableRibbonEnabledBridge"));this.Xc.$(D.a.r8,Object(F.a)(this,this.ytb,"checkWholeTableLockEnabledBridge"));this.Xc.$(D.a.PZ,Object(F.a)(this,this.ytb,"checkWholeTableLockEnabledBridge"));this.Xc.$(D.a.QZ,Object(F.a)(this,this.ytb,"checkWholeTableLockEnabledBridge"));this.Xc.$(L.a.tbh,Object(F.a)(this,this.ytb,"checkWholeTableLockEnabledBridge"));
this.Xc.$(L.a.Q5,Object(F.a)(this,this.ytb,"checkWholeTableLockEnabledBridge"));this.Xc.$(L.a.TJa,Object(F.a)(this,this.ytb,"checkWholeTableLockEnabledBridge"));this.jb.$(D.a.PZ,Object(F.a)(this,this.AQa,"checkSelectionBeforeExecute"));this.jb.$(D.a.QZ,Object(F.a)(this,this.AQa,"checkSelectionBeforeExecute"));this.jb.$(D.a.l7a,Object(F.a)(this,this.AQa,"checkSelectionBeforeExecute"));this.jb.$(L.a.Hmc,Object(F.a)(this,this.AQa,"checkSelectionBeforeExecute"));this.jb.$(L.a.Gmc,Object(F.a)(this,this.AQa,
"checkSelectionBeforeExecute"));this.jb.$(L.a.Fmc,Object(F.a)(this,this.AQa,"checkSelectionBeforeExecute"));this.jb.$(L.a.Q5,Object(F.a)(this,this.AQa,"checkSelectionBeforeExecute"));this.jb.$(L.a.TJa,Object(F.a)(this,this.AQa,"checkSelectionBeforeExecute"));this.jb.$(L.a.cPe,Fd.hf);this.jb.$(L.a.dPe,Fd.hf);this.jb.$(L.a.ePe,Fd.hf);this.jb.$(L.a.fPe,Fd.hf);this.jb.$(L.a.gPe,Fd.hf);this.jb.$(L.a.hPe,Fd.hf);this.jb.$(L.a.iPe,Fd.hf);this.jb.$(L.a.jPe,Fd.hf);this.jb.$(L.a.kPe,Fd.hf);this.jb.$(L.a.ROe,
Fd.hf);this.jb.$(L.a.SOe,Fd.hf);this.jb.$(L.a.TOe,Fd.hf);this.jb.$(L.a.UOe,Fd.hf);this.jb.$(L.a.VOe,Fd.hf);this.jb.$(L.a.WOe,Fd.hf);this.jb.$(L.a.XOe,Fd.hf);this.jb.$(L.a.YOe,Fd.hf);this.jb.$(L.a.ZOe,Fd.hf);this.jb.$(L.a.$Oe,Fd.hf);this.jb.$(L.a.aPe,Fd.hf);this.jb.$(L.a.bPe,Fd.hf);this.jb.$(L.a.Akd,Fd.hf);this.jb.$(L.a.zkd,Fd.hf);this.jb.$(L.a.ykd,Fd.hf);this.jb.$(L.a.Bkd,Fd.hf)}vGj(){this.Xc.$(L.a.akd,Fd.Fy);this.jb.$(L.a.akd,Fd.hf);this.Xc.$(L.a.mie,Fd.zXk);this.jb.$(L.a.$Ea,Object(F.a)(this,this.Nhd,
"parseSmartArtParametersBridge"));this.jb.$(L.a.U_b,Object(F.a)(this,this.Nhd,"parseSmartArtParametersBridge"));this.jb.$(L.a.V_b,Object(F.a)(this,this.Nhd,"parseSmartArtParametersBridge"));this.jb.$(L.a.UK,Object(F.a)(this,this.Nhd,"parseSmartArtParametersBridge"));this.Xc.$(L.a.Gjd,Fd.Fy);this.jb.$(L.a.Gjd,Fd.hf);this.jb.$(L.a.Tra,Object(F.a)(this,this.Lri,"changePictureStyleExecuteBridge"));this.jb.$(L.a.LJb,Fd.hf);this.jb.$(L.a.qJb,Fd.MU);this.jb.$(L.a.sJb,Fd.MU);this.jb.$(L.a.rJb,Fd.MU);this.jb.$(L.a.wnc,
Fd.MU)}wFj(){this.jb.$(L.a.seh,Fg.UNe);this.jb.$(L.a.gnc,Fd.hf);this.jb.$(L.a.ync,Fd.hf);this.jb.$(L.a.unc,Fd.hf);this.jb.$(L.a.Gnc,Fd.hf);this.jb.$(L.a.Hnc,Fd.hf);this.jb.$(L.a.Fnc,Fd.hf);this.jb.$(L.a.Inc,Fd.hf);this.jb.$(L.a.Qnc,Fd.hf);this.jb.$(L.a.xnc,Fd.hf);this.jb.$(L.a.tnc,Fd.hf);this.jb.$(L.a.onc,Fd.hf);this.jb.$(L.a.Cnc,Fd.hf)}VFj(){this.jb.$(L.a.Ejd,Fd.hf);this.jb.$(L.a.Sjd,Fd.hf);this.jb.$(L.a.Anc,Object(F.a)(this,this.Njd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(L.a.Bnc,Object(F.a)(this,
this.Njd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(L.a.UJb,Fd.hf);this.jb.$(L.a.TJb,Fd.hf);this.jb.$(L.a.SJb,Fd.hf);this.jb.$(L.a.ukd,Fd.hf);this.jb.$(L.a.lOk,Fd.hf);this.jb.$(L.a.Dz,Fd.Zjd);this.jb.$(L.a.$nc,Fd.Zjd);this.jb.$(L.a.mkd,Fd.Zjd);this.jb.$(L.a.Kjd,Fd.Zjd);this.jb.$(L.a.MJb,Object(F.a)(this,this.CXk,"remapRumTrackerExecuteQueryBridge"));this.jb.$(L.a.oJb,Fd.hf);this.jb.$(L.a.ckd,Fg.jnc);this.jb.$(L.a.Rjd,Fd.hf);this.jb.$(L.a.vnc,Fd.hf);this.jb.$(L.a.kJb,Fd.hf);this.jb.$(L.a.FJb,
Fd.hf);this.jb.$(L.a.NJb,Fd.hf);this.jb.$(L.a.sPe,Fg.jnc);this.jb.$(L.a.wkd,Fd.hf);this.jb.$(L.a.vkd,Fd.hf);this.jb.$(L.a.LOe,Fd.hf);this.jb.$(L.a.YZa,Fd.hf);this.jb.$(L.a.uib,Fd.hf);this.jb.$(L.a.vib,Fd.hf);this.jb.$(L.a.tib,Fd.hf);this.jb.$(L.a.rib,Fd.hf);this.jb.$(L.a.CJb,Fd.hf);this.jb.$(L.a.JJb,Fd.hf);this.jb.$(L.a.DJb,Fd.hf);this.jb.$(G.a.iJb,Fg.jnc);this.Xc.$(L.a.nKe,Fd.Fy);this.jb.$(L.a.iw,Fd.Ird);this.jb.$(L.a.nCa,Fd.Ird);this.jb.$(L.a.asb,Fd.Ird);this.jb.$(L.a.yZb,Fd.Ird);this.Xc.$(L.a.LYf,
Fd.X0i);this.jb.$(L.a.wc,Fd.FNk);this.Xc.$(L.a.Xjd,Fd.Fy);this.jb.$(L.a.Xjd,Fd.hf);this.Xc.$(L.a.rSa,Object(F.a)(this,this.Iw,"remapTextQueryEnabled"));this.jb.$(L.a.iKa,Fg.jnc);this.jb.$(L.a.IOe,Fd.hf);this.jb.$(L.a.Onc,Fd.hf);this.jb.$(L.a.zOe,Fd.hf);this.jb.$(L.a.AOe,Fd.hf);this.jb.$(L.a.WJb,Fd.hf);this.jb.$(L.a.aOe,Fd.hf);this.jb.$(D.a.Nid,Fg.Y8b);this.jb.$(D.a.cut,Object(F.a)(this,this.QMc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.copy,Object(F.a)(this,this.QMc,"cutCopyPasteExecuteBridge"));
this.jb.$(D.a.paste,Object(F.a)(this,this.QMc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.O5,Object(F.a)(this,this.QMc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.openInClient,Object(F.a)(this,this.rBk,"openInPowerPointExecuteBridge"));this.jb.$(D.a.Mjd,Fd.hf);this.jb.$(L.a.snc,Fd.hf);this.jb.$(L.a.Imc,Object(F.a)(this,this.$hh,"remapUndoRedoExecute"));this.jb.$(L.a.Cmc,Object(F.a)(this,this.$hh,"remapUndoRedoExecute"));this.jb.$(L.a.xIb,Object(F.a)(this,this.Fld,"remapCutCopyPasteExecute"));this.jb.$(L.a.wIb,
Object(F.a)(this,this.Fld,"remapCutCopyPasteExecute"));this.jb.$(L.a.SJa,Object(F.a)(this,this.Fld,"remapCutCopyPasteExecute"));this.jb.$(L.a.Ohb,Object(F.a)(this,this.Fld,"remapCutCopyPasteExecute"));this.la.ka("IsPasteTextFloatieEnabled")&&(this.jb.$(L.a.Yhd,this.Yhh),this.jb.$(L.a.Zhd,this.Yhh));this.Xc.$(L.a.Imc,Object(F.a)(this,this.Zhh,"remapUndoRedoEnabled"));this.Xc.$(L.a.Cmc,Object(F.a)(this,this.Zhh,"remapUndoRedoEnabled"));this.Xc.$(L.a.xIb,Object(F.a)(this,this.Jib,"remapCutCopyPasteEnabled"));
this.Xc.$(L.a.wIb,Object(F.a)(this,this.Jib,"remapCutCopyPasteEnabled"));this.Xc.$(L.a.SJa,Object(F.a)(this,this.Jib,"remapCutCopyPasteEnabled"));this.Xc.$(L.a.Ohb,Object(F.a)(this,this.Jib,"remapCutCopyPasteEnabled"));this.Xc.$(D.a.cut,Object(F.a)(this,this.Jib,"remapCutCopyPasteEnabled"));this.Xc.$(D.a.paste,Object(F.a)(this,this.Jib,"remapCutCopyPasteEnabled"));this.Xc.$(D.a.O5,Object(F.a)(this,this.Jib,"remapCutCopyPasteEnabled"));this.jb.$(D.a.B1,Fd.ezf);this.jb.$(D.a.Sr,Fd.ezf);this.jb.$(D.a.QM,
Object(F.a)(this,this.Bqg,"listsExecuteBridge"));this.jb.$(D.a.mP,Object(F.a)(this,this.Bqg,"listsExecuteBridge"));this.jb.$(L.a.Gkb,Fd.Qml);this.jb.$(L.a.eib,Fd.MU);this.jb.$(L.a.fib,Fd.MU);this.jb.$(L.a.GJb,Fd.hf);this.jb.$(L.a.lJb,Fd.hf);this.jb.$(L.a.nnc,Fd.hf);this.jb.$(L.a.EJb,Fd.hf);this.la.Nrb&&this.jb.$(L.a.fnc,Fd.hf);(this.la.eB||this.la.$W)&&Pd.a("ShowEnabledStateOfChatPPT")&&this.jb.$(L.a.Nnc,Fd.hf)}EFj(){this.Xc.$(L.a.Vfg,Object(F.a)(this,this.R2b,"doPresentationCheckEnableRemap"));this.Xc.$(L.a.fVd,
Object(F.a)(this,this.R2b,"doPresentationCheckEnableRemap"));this.Xc.$(L.a.aVd,Object(F.a)(this,this.R2b,"doPresentationCheckEnableRemap"));this.Xc.$(L.a.Xfg,Object(F.a)(this,this.R2b,"doPresentationCheckEnableRemap"));this.Xc.$(L.a.$fg,Object(F.a)(this,this.R2b,"doPresentationCheckEnableRemap"))}R2b(a){const b=new Wk;this.Fb&&1===this.Fb.Fl&&!Fd.xje(a)?b.fL=!1:(b.BE=!0,b.Hm=L.a.i8a);return b}n8i(){const a=new wM;a.zZb=Fd.eIk;a.FRd=Fd.fIk;a.oMe=Object(F.a)(this,this.DIk,"powerPointPreExecCommand");
a.LLe=null;return a}DIk(a,b){var c=this.pa.Xd();c=1===c.length&&c[0].ud&&this.pa.gH()&&!c[0].MQ;switch(a.Hm){case D.a.font:case D.a.S5:case D.a.IKa:case D.a.bold:case D.a.setItalic:case D.a.underline:case D.a.strikethrough:case D.a.Sr:case D.a.B1:case D.a.fja:case D.a.bH:case D.a.PH:case D.a.WJa:case D.a.C_a:case D.a.rC:case D.a.Ey:case D.a.QM:case D.a.mP:case D.a.bja:case D.a.ula:case D.a.Aoa:case D.a.RDa:case L.a.Sna:case L.a.d1:case L.a.c1:case L.a.b1:case D.a.bDa:case D.a.Eka:case D.a.kza:case D.a.lza:case D.a.mza:case D.a.LLa:case D.a.MLa:case D.a.QZ:case D.a.PZ:case L.a.Q5:case L.a.TJa:case L.a.q0a:case L.a.gLa:case L.a.Ooa:case L.a.hLa:case L.a.Lrd:case L.a.Krd:b||
(b={}),b[Bh.a.fGc]=!(this.pa.eVa()||c),b[Bh.a.lsf]=!!this.pa.ska()}return null}tqg(a,b,c){const f=new kh;b=b.MenuItemId;f.rd=this.iEe(b,a);b&&va.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}iEe(a,b){a=a?parseInt(a):-1;switch(b){case L.a.BMb:case D.a.QM:case L.a.Anc:case L.a.SZa:return this.EEb.$6b(a);case L.a.lMb:case D.a.mP:case L.a.Bnc:case L.a.TZa:return this.EEb.cVc(a);default:return 18}}w0i(a,b){a=new kh;a.rd=b.CommandValueId;return a}Njd(a,b){const c=
new kh,f=new Mv;f.WZa=new Xh.a;f.menuItemId=this.iEe(b.MenuItemId,a);c.rd=f;c.hX=!0;return c}Nxa(a,b){a=new kh;const c={};c.queryResult=new Xh.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.rd=c;a.hX=!0;return a}Ztd(a,b){a=new kh;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.rd=c;return a}Lri(a,b){a=new kh;a.rd=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}hib(a){const b=new kh,c={},f=new Xh.a;switch(a){case L.a.jOe:f.Lf(this.KWa.isEnabled(ce.VEa));break;case L.a.dOe:f.Lf(this.KWa.isEnabled(ce.UEa));break;case L.a.gOe:f.Lf(this.KWa.isEnabled(ce.c9));break;case L.a.eOe:f.Lf(this.KWa.isEnabled(ce.b9));break;case L.a.hOe:f.Lf(this.KWa.isEnabled(ce.dB));break;case L.a.iOe:f.Lf(this.KWa.isEnabled(ce.dE));break;case L.a.fOe:f.Lf(this.KWa.isEnabled(ce.cE));break;case L.a.geh:f.Lf(this.KWa.isEnabled(ce.Zta))}c.queryResult=
f;b.rd=c;b.hX=!0;return b}Bqg(a,b,c){const f=new kh;f.rd=new K.DictionaryPropertySet;b=b.MenuItemId;this.XFl(f.rd,a,this.iEe(b,a));b&&va.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}Msi(){return Object.assign(new Wk,{rd:new Xh.a,fL:!!this.D6j.Ba})}ytb(){const a=new Wk,b=this.pa.an();if(!b)return a;this.yc.aje(b)&&(a.BE=!1,a.fL=!1,a.Hm=ac.ActionManager.w3b);return a}XFl(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===D.a.QM?(l=f=1,this.EEb.RYc(c)&&(b=this.EEb.AVa.ga(c),
a.setValue(Za.a.Ui,[b.j_b]),a.setValue(Za.a.font,b.Jsb))):b===D.a.mP&&(f=0,l=1,a.setValue(Za.a.EVa,1),a.setValue(hb.a.autonumberBulletType,8),this.EEb.SYc(c)&&(b=this.EEb.Eed.ga(c),a.setValue(hb.a.autonumberBulletType,b.JSd),a.setValue(Za.a.Ui,[65533,b.u1g,ha.a.charCodeAt(b.A1g,0)])));a.setValue(Yd.a.jE,f);a.setValue(Yd.a.eea,l)}vud(a){let b;if(this.Yuh()||this.pa.ska()){if(({De:b}=Fd.pud(a,this.pa.Zz())).returnValue)return{returnValue:!0,jY:b}}else if(this.Fjl()&&({De:b}=Fd.dFh(a)).returnValue)return{returnValue:!0,
jY:b};return{returnValue:!1,jY:0}}j4e(a){let b;b=0;a===L.a.Imc?b=L.a.GZa:a===L.a.Cmc&&(b=L.a.FZa);return{returnValue:!!b,jY:b}}i4e(a){let b;b=0;this.Yuh()?a===L.a.xIb?b=D.a.cut:a===L.a.wIb?b=D.a.copy:a===L.a.SJa?b=D.a.paste:a===L.a.Ohb&&(b=D.a.O5):(a===L.a.xIb&&(b=L.a.Bub),a===L.a.wIb?b=L.a.n1b:a===L.a.SJa?b=L.a.wxa:u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&a===L.a.Ohb&&(b=L.a.pasteAsPlainText));return{returnValue:!!b,jY:b}}rFh(a){switch(a){case D.a.r8:return a=L.a.yIb,{returnValue:!0,
De:a};case D.a.rLb:return a=L.a.aMe,{returnValue:!0,De:a};case D.a.insertTable:return a=L.a.xbh,{returnValue:!0,De:a}}a=ac.ActionManager.E5;return{returnValue:!1,De:a}}At(a){let b=new kh;if(({result:b}=this.hzb(a)).returnValue)return b;({jY:a}=this.vud(a)).returnValue&&(b.BE=!0,b.Hm=a);return b}tuh(a){switch(a){case L.a.zZa:case L.a.FIb:case L.a.IIb:case L.a.Mhb:case L.a.Qhb:case L.a.Nhb:if(this.pa.fla()||this.pa.HL())return Object.assign(new Wk,{BE:!1,fL:!1});break;case L.a.xJb:case L.a.wJb:case L.a.EIb:case L.a.HIb:case L.a.yZa:if(this.pa.fla())return Object.assign(new Wk,
{BE:!1,fL:!1});break;case L.a.RJa:case L.a.Wna:case L.a.ejd:case L.a.Bxa:case L.a.Dxa:case L.a.Fxa:case L.a.AZa:case L.a.GIb:case L.a.zIb:if(this.pa.HL())return Object.assign(new Wk,{BE:!1,fL:!1});break;case L.a.JIb:case L.a.Emc:if(this.pa.HL()){var b=this.pa.Na.mb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.sa(Va.a.listLevel,0),a===L.a.JIb&&!b||Wo.a.wjg(c.node)))return Object.assign(new Wk,{BE:!1,fL:!1})}}return null}Ps(a){let b;new Wk;if(({result:b}=this.Sie(a)).returnValue)return this.xpd(b,a);
b=this.tuh(a);if(!b){let c;b=new Wk;({jY:c}=this.vud(a)).returnValue&&(b.BE=!0,b.Hm=c)}return this.xpd(b,a)}ioa(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Wk,{mhb:a,Hm:L.a.OTe,rd:c})}CXk(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new kh,{Hm:L.a.OTe,rd:c,hX:!0})}JE(a){let b=new kh;if(({result:b}=this.hzb(a)).returnValue)return b;({jY:a}=this.vud(a)).returnValue?(b.BE=!0,b.Hm=a):(b.rd=new Xh.a,b.hX=!0);return b}Iw(a){let b;new Wk;
if(({result:b}=this.Sie(a)).returnValue)return this.xpd(b,a);b=this.tuh(a);if(!b){let c;b=new Wk;({jY:c}=this.vud(a)).returnValue?(b.BE=!0,b.Hm=c):b.rd=new Xh.a}return this.xpd(b,a)}$hh(a){const b=new kh;({jY:a}=this.j4e(a)).returnValue&&(b.BE=!0,b.Hm=a);return b}Zhh(a){const b=new Wk;({jY:a}=this.j4e(a)).returnValue&&(b.BE=!0,b.Hm=a);return b}AXk(){const a=new Wk;a.BE=!0;a.Hm=L.a.VLe;return a}BXk(){const a=new kh;a.BE=!0;a.Hm=L.a.VLe;return a}EBl(a){let b;b=0;const c=this.FIa.S_;if(c===L.a.wxa||
c===L.a.pasteAsPlainText)a==L.a.Yhd?b=L.a.qoc:a==L.a.Zhd&&(b=L.a.poc);return{returnValue:!!b,jY:b}}Fld(a){let b=new kh;if(({result:b}=this.hzb(a)).returnValue)return b;({jY:a}=this.i4e(a)).returnValue&&(b.BE=!0,b.Hm=a);return b}Gld(a){let b=new kh;if(({result:b}=this.hzb(a)).returnValue)return b;({De:a}=this.rFh(a)).returnValue&&(b.BE=!0,b.Hm=a);return b}AQa(a,b){let c=new kh;if(({result:c}=this.hzb(a)).returnValue)return c;if(this.pa.Bs())return c.BE=!0,c.Hm=ac.ActionManager.w3b,c;c.Hm=a;c.rd=b;
return c}Jib(a){let b=new Wk;if(!this.Tb.qj())return b.fL=!1,b;if(({result:b}=this.Sie(a)).returnValue)return b;({jY:a}=this.i4e(a)).returnValue&&(b.BE=!0,b.Hm=a);return b}Yuh(){return this.pa.Zz()}Fjl(){return this.pa.gH()}Nhd(a,b){const c=new kh;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new oR.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==L.a.$Ea&&a!==L.a.V_b||va.a.J(512493024,801,50,(a===L.a.$Ea?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+
"{0}",f);c.rd=b;return c}r1c(a,b,c){return this.At(a,b,c)}QMc(a){let b=new kh;if(({result:b}=this.hzb(a)).returnValue)return b;b.$q=this.la.$Yc||this.la.Rig&&this.la.ANj&&B.a.vo;return b}rBk(a,b,c){a=new kh;va.a.J(512493023,801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}hzb(a){let b;b=new kh;return this.Vgg(a)?(b.BE=!1,b.fL=!1,b.Hm=ac.ActionManager.w3b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Sie(a){let b;b=new Wk;return this.Vgg(a)?
(b.BE=!1,b.fL=!1,b.Hm=ac.ActionManager.w3b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Vgg(a){return this.KJj(a)}KJj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&Fd.uni.contains(a)?this.pa.o9()?!0:!1:!1}xpd(a,b){if(Pd.a("SetMappedCommandActionData")){let c=0;if(({De:c}=Fd.pud(b,this.pa.Zz())).returnValue||({De:c}=Fd.dFh(b)).returnValue||({jY:c}=this.j4e(b)).returnValue||({jY:c}=this.i4e(b)).returnValue||({De:c}=this.rFh(b)).returnValue)a.rd||(a.rd={}),a.rd.MappedCommand=
c}return a}static xje(a){const b=Fd.xlj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static xlj(){Fd.Yhc||(Fd.Yhc=[L.a.Imc,L.a.Cmc,L.a.SJa,L.a.CJa,L.a.DJa,L.a.wIb,L.a.deleteObject,L.a.k1d,L.a.i8a,L.a.vna,L.a.o8b,L.a.H4e,L.a.iQ,L.a.print,L.a.WKk,L.a.MMe,L.a.OMe,L.a.Dmc,L.a.ZLe,L.a.$Le,L.a.downloadACopy,L.a.X2b,L.a.Y2b,L.a.Z2b,L.a.iw,L.a.Pjd,L.a.nCa,L.a.Spd,L.a.Rpd,L.a.QJe,L.a.tIb,L.a.VJb,L.a.Oxa,L.a.wib,L.a.Aj,L.a.coa,L.a.Rj,L.a.kkb,L.a.Sqc,L.a.lkb,L.a.Poa,L.a.yNb,L.a.Vya,L.a.bMa,L.a.YZa,
L.a.Zhb,L.a.DZa,L.a.Smc,L.a.DJb,L.a.EZa,L.a.CJb,L.a.JJb,L.a.xkd,L.a.Jhb,L.a.Khb,L.a.COb,L.a.uib,L.a.DOb,L.a.vib,L.a.BOb,L.a.tib,L.a.AOb,L.a.rib,L.a.zOb,L.a.FJb,L.a.Ufa,L.a.yoc,L.a.WJb,L.a.k6e,L.a.$de,G.a.X7,G.a.Djd,L.a.openInClient,G.a.Vrc,G.a.NHb,G.a.YIb,G.a.gNb,G.a.hNb,L.a.nLa,L.a.oga,L.a.ihd,L.a.oJb,L.a.Ksc,L.a.Lsc,D.a.Nid,L.a.$Gk,L.a.C5,L.a.LYf,L.a.iQ,L.a.zI,L.a.jmd,L.a.tRe,L.a.xFe,L.a.wFe,L.a.R5e,L.a.i6a,L.a.immersiveReader,D.a.copy,D.a.paste,L.a.Bub,L.a.n1b,L.a.wxa,L.a.GZa,L.a.FZa,L.a.vqd,G.a.Xsa,
G.a.renameFile,G.a.WKc,G.a.AZe,L.a.Yhb,L.a.DMe,L.a.$lc,L.a.Tmc,L.a.zoc,L.a.X0a]);Fd.Yhc.push(L.a.Mqc);if(u.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=[L.a.sIb,L.a.Qjd,L.a.lYc];let b;(b=Fd.Yhc).push.apply(b,a)}return Fd.Yhc}static fIk(a,b){const c=a.mhb;let f=!0,l=null;if(null===a||null===a.rd)return!1;a=a.rd;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.Kaa)switch(c){case L.a.Oxa:case L.a.OJb:case L.a.PJb:case L.a.Znc:case L.a.Ckd:case L.a.Wnc:case L.a.Xnc:case L.a.Ync:case L.a.Vnc:case L.a.qJb:case L.a.sJb:case L.a.rJb:case L.a.wnc:case L.a.eib:case L.a.fib:case L.a.$Ja:case L.a.aKa:a=
parseFloat(l.Kaa);0<a||c===L.a.Oxa||c===L.a.qJb||c===L.a.sJb||c===L.a.rJb||c===L.a.wnc||c===L.a.eib||c===L.a.fib||c===L.a.$Ja||c===L.a.aKa||0<=a&&(c===L.a.Wnc||c===L.a.Xnc||c===L.a.Ync||c===L.a.Vnc)?(b[Wm.Text]=l.Kaa,b[Wm.Number]=a):(b[Wm.Text]="",b[Wm.Number]=Number.NaN);b[Wm.UnitType]=c===L.a.Oxa||c===L.a.$Ja||c===L.a.aKa?8:3;break;default:f=!1}return f}static eIk(a,b){if(Fg.zZb(a,b))return!0;if(!a||!a.rd)return!1;var c=null;Object(Ya.a)(Xh.a,a.rd)?c=a.rd:Object(Ya.a)(Mv,a.rd)?(c=a.rd,b.SourceControlId=
c.aV,c=c.WZa):Object(Ya.a)(Object,a.rd)&&(a=a.rd,a.queryResult&&(c=a.queryResult));c&&(b[Vh.a.On]=c.Ftd?c.Ftd.value:!1,c.NKc&&(b[Zn.a.IsFreeForm]=c.NKc.value),c.SDa&&(b[gm.a.InnerHTML]=c.SDa),c.mwb&&(b[gm.a.Alt]=c.mwb),c.ARc&&(b[gm.a.On]=c.ARc.value),void 0!==c.$Z&&null!==c.$Z&&(b[Zn.a.Value]=c.$Z),void 0!==c.TIc&&null!==c.TIc&&(b[qE.a.LabelText]=c.TIc),c.E3&&(b[gm.a.GalleryButtonProps]=c.E3),c.QBf&&(b[qE.a.Image32by32Class]=c.QBf),void 0!==c.m9a&&null!==c.m9a&&(b[hm.a.labelText]=c.m9a));return!0}static Fy(){const a=
new Wk;a.rd=new Xh.a;return a}static hf(){const a=new kh;a.rd=new Xh.a;a.hX=!0;return a}static sqg(a,b,c){va.a.J(512493021,820,50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new kh;a.rd=b;return a}static c1e(a,b){a=new kh;a.rd=b.Color;return a}static ezf(a,b){a=new kh;a.rd=b.Color;a.$q=!0;return a}static Qml(){const a=new kh;a.rd={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static Zjd(a,b){a=new kh;const c=new Mv;c.WZa=new Xh.a;c.aV=b.SourceControlId;a.rd=c;a.hX=!0;return a}static Ird(a,
b){a=new kh;a.rd=b.SourceControlId;return a}static MU(){const a=new kh,b={},c=new Xh.a;b.queryResult=c;a.rd=b;a.Ple=!0;return a}static u0a(a){const b=new Wk;switch(a){case L.a.nyf:b.Hm=L.a.aCa;break;case L.a.oyf:b.Hm=L.a.Kia;break;case L.a.dIc:b.Hm=L.a.UPa;break;case L.a.aIc:b.Hm=L.a.u6a;break;case L.a.cIc:b.Hm=L.a.v6a;break;case L.a.bIc:b.Hm=L.a.Lia;break;case L.a.ERd:b.Hm=L.a.asb;break;case L.a.uRd:b.Hm=L.a.yZb}return b}static X0i(){const a=new Wk;a.Hm=L.a.eta;return a}static FNk(){const a=new kh,
b={},c=new Xh.a;c.Lf(!1);b.queryResult=c;a.rd=b;a.hX=!0;return a}static pud(a,b){switch(a){case L.a.vIb:return a=D.a.bold,{returnValue:!0,De:a};case L.a.Bxa:return a=D.a.bja,{returnValue:!0,De:a};case L.a.yZa:return a=D.a.font,{returnValue:!0,De:a};case L.a.EIb:return a=D.a.S5,{returnValue:!0,De:a};case L.a.HIb:return a=D.a.IKa,{returnValue:!0,De:a};case L.a.Cxa:return a=D.a.Sr,{returnValue:!0,De:a};case L.a.AIb:return a=D.a.B1,{returnValue:!0,De:a};case L.a.vmc:return a=D.a.fja,{returnValue:!0,De:a};
case L.a.BIb:return a=D.a.setItalic,{returnValue:!0,De:a};case L.a.Dxa:return a=D.a.ula,{returnValue:!0,De:a};case L.a.CIb:return a=L.a.nKe,{returnValue:!0,De:a};case L.a.Phb:return a=D.a.qIb,{returnValue:!0,De:a};case L.a.zZa:return a=D.a.Pq,{returnValue:!0,De:a};case L.a.FIb:return a=D.a.WJa,{returnValue:!0,De:a};case L.a.IIb:return a=D.a.C_a,{returnValue:!0,De:a};case L.a.Qhb:return a=D.a.PH,{returnValue:!0,De:a};case L.a.Mhb:return a=D.a.bH,{returnValue:!0,De:a};case L.a.KIb:return a=D.a.strikethrough,
{returnValue:!0,De:a};case L.a.zmc:return a=L.a.D9g,{returnValue:!0,De:a};case L.a.DIb:return a=L.a.OJa,{returnValue:!0,De:a};case L.a.Fxa:return a=D.a.Aoa,{returnValue:!0,De:a};case L.a.AZa:return a=D.a.RDa,{returnValue:!0,De:a};case L.a.NIb:return a=D.a.underline,{returnValue:!0,De:a};case L.a.GIb:return a=D.a.Ey,{returnValue:!0,De:a};case L.a.zIb:return a=D.a.rC,{returnValue:!0,De:a};case L.a.JIb:return a=D.a.Ey,{returnValue:!0,De:a};case L.a.Emc:return a=D.a.rC,{returnValue:!0,De:a};case L.a.Wna:return a=
D.a.QM,{returnValue:!0,De:a};case L.a.RJa:return a=D.a.mP,{returnValue:!0,De:a};case L.a.Exa:return a=L.a.Sna,{returnValue:!0,De:a};case L.a.Nhb:return a=L.a.poe,{returnValue:!0,De:a};case L.a.rSa:return a=D.a.hRc,{returnValue:!0,De:a};case L.a.LIb:return a=D.a.subscript,{returnValue:!0,De:a};case L.a.MIb:return a=D.a.superscript,{returnValue:!0,De:a}}return b?Fd.hBl(a):Fd.cFh(a)}static dFh(a){switch(a){case L.a.vIb:return a=L.a.n0a,{returnValue:!0,De:a};case L.a.Bxa:return a=L.a.CMb,{returnValue:!0,
De:a};case L.a.yZa:return a=L.a.ekb,{returnValue:!0,De:a};case L.a.zZa:return a=L.a.fkb,{returnValue:!0,De:a};case L.a.BIb:return a=L.a.o0a,{returnValue:!0,De:a};case L.a.Dxa:return a=L.a.gkb,{returnValue:!0,De:a};case L.a.Fxa:return a=L.a.tkb,{returnValue:!0,De:a};case L.a.AZa:return a=L.a.kMb,{returnValue:!0,De:a};case L.a.NIb:return a=L.a.p0a,{returnValue:!0,De:a};case L.a.Wna:return a=L.a.BMb,{returnValue:!0,De:a};case L.a.tmc:return a=L.a.frc,{returnValue:!0,De:a};case L.a.umc:return a=L.a.qqd,
{returnValue:!0,De:a};case L.a.Cxa:return a=L.a.jMb,{returnValue:!0,De:a};case L.a.AIb:return a=L.a.rkb,{returnValue:!0,De:a};case L.a.vmc:return a=L.a.DMb,{returnValue:!0,De:a};case L.a.RJa:return a=L.a.lMb,{returnValue:!0,De:a};case L.a.Phb:return a=L.a.FXe,{returnValue:!0,De:a};case L.a.Qhb:return a=L.a.FMb,{returnValue:!0,De:a};case L.a.Mhb:return a=L.a.grc,{returnValue:!0,De:a};case L.a.KIb:return a=L.a.mMb,{returnValue:!0,De:a};case L.a.d1:return a=L.a.Opd,{returnValue:!0,De:a};case L.a.c1:return a=
L.a.Npd,{returnValue:!0,De:a};case L.a.b1:return a=L.a.Mpd,{returnValue:!0,De:a};case L.a.zmc:case L.a.CIb:return Fd.pud(a,!0);case L.a.DIb:return Fd.pud(a,!0);case L.a.Exa:return a=L.a.Lpd,{returnValue:!0,De:a};case L.a.Nhb:return a=L.a.DXe,{returnValue:!0,De:a};case L.a.LIb:return a=L.a.jrc,{returnValue:!0,De:a};case L.a.MIb:return a=L.a.krc,{returnValue:!0,De:a}}return Fd.cFh(a)}static hBl(a){switch(a){case L.a.uJb:return a=D.a.hnc,{returnValue:!0,De:a};case L.a.bKa:return a=D.a.knc,{returnValue:!0,
De:a};case L.a.yJb:return a=D.a.qnc,{returnValue:!0,De:a};case L.a.xJb:return a=G.a.X7,{returnValue:!0,De:a};case L.a.wJb:return a=G.a.X7,{returnValue:!0,De:a};case L.a.jib:return a=D.a.Ijd,{returnValue:!0,De:a};case L.a.kib:return a=D.a.lnc,{returnValue:!0,De:a};case L.a.cKa:return a=D.a.rnc,{returnValue:!0,De:a};case L.a.eKa:return a=D.a.Dnc,{returnValue:!0,De:a};case L.a.lib:return a=D.a.mnc,{returnValue:!0,De:a};case L.a.hKa:return a=L.a.UJb,{returnValue:!0,De:a};case L.a.gKa:return a=L.a.TJb,
{returnValue:!0,De:a};case L.a.fKa:return a=L.a.SJb,{returnValue:!0,De:a};case L.a.BJb:return a=D.a.aoc,{returnValue:!0,De:a};case L.a.vJb:return a=L.a.Ejd,{returnValue:!0,De:a};case L.a.zJb:return a=L.a.Sjd,{returnValue:!0,De:a};case L.a.dKa:return a=L.a.Anc,{returnValue:!0,De:a};case L.a.mib:return a=L.a.Bnc,{returnValue:!0,De:a};case L.a.AJb:return a=D.a.Rnc,{returnValue:!0,De:a};case L.a.Mxa:return a=L.a.RZa,{returnValue:!0,De:a};case L.a.UZa:return a=D.a.Tnc,{returnValue:!0,De:a};case L.a.VZa:return a=
D.a.Unc,{returnValue:!0,De:a}}a=ac.ActionManager.E5;return{returnValue:!1,De:a}}static cFh(a){switch(a){case L.a.uJb:return a=L.a.Jnc,{returnValue:!0,De:a};case L.a.bKa:return a=L.a.dkd,{returnValue:!0,De:a};case L.a.yJb:return a=L.a.Knc,{returnValue:!0,De:a};case L.a.jib:return a=L.a.gkd,{returnValue:!0,De:a};case L.a.kib:return a=L.a.hkd,{returnValue:!0,De:a};case L.a.cKa:return a=L.a.jkd,{returnValue:!0,De:a};case L.a.eKa:return a=L.a.lkd,{returnValue:!0,De:a};case L.a.lib:return a=L.a.ikd,{returnValue:!0,
De:a};case L.a.hKa:return a=L.a.rkd,{returnValue:!0,De:a};case L.a.gKa:return a=L.a.qkd,{returnValue:!0,De:a};case L.a.fKa:return a=L.a.pkd,{returnValue:!0,De:a};case L.a.BJb:return a=L.a.Mnc,{returnValue:!0,De:a};case L.a.vJb:return a=L.a.pib,{returnValue:!0,De:a};case L.a.xJb:return a=L.a.fkd,{returnValue:!0,De:a};case L.a.wJb:return a=L.a.ekd,{returnValue:!0,De:a};case L.a.zJb:return a=L.a.qib,{returnValue:!0,De:a};case L.a.dKa:return a=L.a.SZa,{returnValue:!0,De:a};case L.a.mib:return a=L.a.TZa,
{returnValue:!0,De:a};case L.a.AJb:return a=L.a.Lnc,{returnValue:!0,De:a};case L.a.Mxa:return a=L.a.kkd,{returnValue:!0,De:a};case L.a.UZa:return a=L.a.nkd,{returnValue:!0,De:a};case L.a.VZa:return a=L.a.okd,{returnValue:!0,De:a}}a=ac.ActionManager.E5;return{returnValue:!1,De:a}}static zXk(a){const b=new Wk;switch(a){case L.a.mie:b.Hm=L.a.$Ea}return b}static kqg(a,b){a=new kh;if(!b)throw Error.argumentNull();a.rd=Fd.e4f(b.MenuItemId);return a}static keh(a,b){a=new kh;const c={},f=new Xh.a;f.Lf(!1);
c.queryResult=f;c.MenuItemId=Fd.e4f(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.rd=c;a.hX=!0;a.Ole=!0;return a}static e4f(a){return parseFloat(a)}}Fd.Yhc=null;Fd.uni=(uf=new Ka.a,uf.add(D.a.cut),uf.add(D.a.paste),uf.add(D.a.O5),uf.add(D.a.r8),uf.add(D.a.B1),uf.add(D.a.xWd),uf.add(D.a.fja),uf.add(D.a.S5),uf.add(D.a.IKa),uf.add(D.a.WJa),uf.add(D.a.C_a),uf.add(L.a.uJb),uf.add(L.a.yJb),uf.add(L.a.BJb),uf.add(L.a.bKa),uf.add(L.a.cKa),uf.add(L.a.eKa),uf.add(L.a.lib),uf.add(L.a.hKa),uf.add(L.a.gKa),
uf.add(L.a.fKa),uf.add(L.a.jib),uf.add(L.a.kib),uf.add(L.a.vJb),uf.add(L.a.zJb),uf.add(L.a.dKa),uf.add(L.a.mib),uf.add(L.a.xJb),uf.add(L.a.wJb),uf.add(L.a.AJb),uf.add(L.a.Mxa),uf.add(L.a.UZa),uf.add(L.a.VZa),uf.add(L.a.teh),uf.add(L.a.veh),uf.add(L.a.ueh),uf.add(L.a.BOe),uf.add(L.a.Yjd),uf.add(L.a.vIb),uf.add(L.a.BIb),uf.add(L.a.NIb),uf.add(L.a.Bxa),uf.add(L.a.Dxa),uf.add(L.a.Fxa),uf.add(L.a.AZa),uf.add(L.a.AIb),uf.add(L.a.vmc),uf.add(L.a.yZa),uf.add(L.a.EIb),uf.add(L.a.HIb),uf.add(L.a.zZa),uf.add(L.a.FIb),
uf.add(L.a.IIb),uf.add(L.a.Qhb),uf.add(L.a.Mhb),uf.add(L.a.d1),uf.add(L.a.c1),uf.add(L.a.b1),uf.add(L.a.KIb),uf.add(L.a.CIb),uf.add(L.a.Phb),uf.add(L.a.zmc),uf.add(L.a.DIb),uf.add(L.a.Amc),uf.add(L.a.Bmc),uf.add(L.a.Wna),uf.add(L.a.RJa),uf.add(L.a.BMb),uf.add(L.a.rkb),uf.add(L.a.DMb),uf.add(L.a.lMb),uf.add(L.a.tmc),uf.add(L.a.umc),uf.add(L.a.Cxa),uf.add(L.a.zIb),uf.add(L.a.GIb),uf.add(L.a.insertHyperlink),uf.add(L.a.Exa),uf.add(L.a.Nhb),uf.add(L.a.LIb),uf.add(L.a.MIb),uf.add(L.a.xIb),uf.add(L.a.SJa),
uf.add(L.a.Ohb),uf.add(L.a.yIb),uf.add(L.a.Zid),uf.add(L.a.wmc),uf.add(L.a.Hmc),uf.add(L.a.Gmc),uf.add(L.a.Fmc),uf);Object(n.a)(Fd,"CuiActionBridge",Fg,[]);class uE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}Zb(a){this.K=a;this.K.register(273,"Box4.ISelectionContextMenuProvider").ma().oa(()=>new Fq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Yzb;B.a.Vj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").Gya);this.K.register(bA,
"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().oa(()=>new bA(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.Ja("PowerpointPresence.IPresenceManager"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(274,"PowerPointWebEditor.ICUIManager").ma().oa(()=>new vM(a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(Fd,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().oa(()=>new Fd(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager"),u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.ITextPasteFloatieManager"):null));this.K.register(275,"PowerPointWebEditor.IStatusBarUserHelper").ma().oa(()=>new tM(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(276,"PowerPointWebEditor.IStatusBarUser").ma().oa(()=>new nE(a.resolve("PowerPointWebEditor.IStatusBarPane").xa,a.resolve("Box4.Graph.IGraphInstance").xd(7),
a.rb("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager")));a.register(hx,"CommandUI.ReactRibbonRoot").ma().oa(()=>new hx(Tr.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Box4.IGeneralCuiUser")));a.register(277,"PowerPointWebEditor.IContextMenuUser").ma().oa(()=>new qM(a.resolve("Box4.IContextMenuController"),
Object(qa.a)(bA,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(278,"Box4.IBox4BridgeCommandUi").ma().oa(()=>new uM(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),a.resolve("Common.IRibbonExternal")));this.K.register(279,"PowerPointWebEditor.IContextMenuHelper").ma().oa(()=>new pM(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(mE,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().oa(()=>new mE(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),
a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.rb("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").rk("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").hji(this.K.resolve("Box4.IBox4BridgeCommandUi"))}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();
this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){v.a.instance.Dc(new uE)}}Object(n.a)(uE,"PPTWebEditorUIPackage",null,[2,3]);class xM{constructor(a){this.UPh="FontPicker";this.oEd=null;this.e2=a;this.Jyc=this.e2.Gib(Sr.a.vVa,Object(F.a)(this,this.Nvb,"featureStateChangeCallback"));this.e2.isFeatureEnabled(Sr.a.vVa,!1).then(b=>{this.oEd=b})}get isLicensed(){return this.oEd}Nvb(a){this.oEd=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.UPh,
a.isEnabled);appChrome.api.dispatch(a)}dispose(){this.e2.oKb(Sr.a.vVa,this.Jyc)}}Object(n.a)(xM,"ModernFontPickerFeatureHelper",null,[269,106]);class cA{constructor(a){this.UHa=null;a?Object.getType(a)===String?this.UHa=cA.deserialize(a):this.UHa=a:(ka.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.UHa=[]);this.bHa=!1}get isDirty(){return this.bHa}get wid(){return Array.clone(this.UHa)}J6h(a){Array.contains(this.UHa,a)||(Array.add(this.UHa,a),this.bHa=!0)}oYk(a){Array.contains(this.UHa,
a)&&(Array.remove(this.UHa,a),this.bHa=!0)}serialize(){return JSON.stringify(this.UHa)}$2k(){this.bHa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return ka.ULS.sendTraceTag(543475147,3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(n.a)(cA,"PinnedFontStore",null,[]);class yM{constructor(a,b,c,f){this.ia=a;this.la=c;this.YSg=b;this.zb=f;this.W4=null}initialize(){this.ia.ya(G.a.Zlc,Xd.a.frame,Object(F.a)(this,this.Zlc,"pinOrUnpinFont"));this.ia.ra(G.a.sYf,Xd.a.frame,Object(F.a)(this,
this.A4g,"onFontPickerMenuClose"),96);this.YSg.Tae("getPPTPinnedFontsSettings").continueWith(Object(F.a)(this,this.wyk,"onRoamingSettingLoaded"))}MUj(a){return a.Vn?!1:a.rm?(ka.ULS.sendTraceTag(543273993,3021,10,"Load setting failed with exception {0}",a.$i),!1):!0}wyk(a){this.MUj(a)?this.W4=new cA(a.result||this.X5f()):this.W4=new cA(this.X5f());this.Udh()}Udh(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.wid))}get wid(){return this.W4?this.W4.wid:[]}X5f(){return this.la.Ga("RecommendedFonts")}Zlc(a,
b,c,f,l){if(!this.W4)return ka.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.W4.J6h(a):this.W4.oYk(a));return 32}A4g(){if(!this.W4||!this.W4.isDirty)return 32;const a=Le.a.mMc(10,Object(F.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.zb.Db(a);return 32}updatePinnedFonts(){this.W4&&(this.Udh(),this.xoh(),this.W4.$2k())}xoh(){if(this.W4&&this.W4.isDirty){var a=this.W4.serialize();this.YSg.vgl(a)}}dispose(){this.xoh();
this.ia.RJ(G.a.Zlc,Xd.a.frame,Object(F.a)(this,this.Zlc,"pinOrUnpinFont"));this.ia.RJ(G.a.sYf,Xd.a.frame,Object(F.a)(this,this.A4g,"onFontPickerMenuClose"))}}Object(n.a)(yM,"FontPinningHandler",null,[270,106]);class Gq{static get whd(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}Gq.MDa="fontInfoTaskPane";Gq.uVi="modernfontpicker";Object(n.a)(Gq,"FontInfoPaneConstants",null,[]);class zM{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=
!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(n.a)(zM,"FontInfoTaskPaneProps",null,[]);var nu=d(651);class dA{constructor(a,b,c,f=null){this.G5a=this.HV=this.Jyc=null;this._state=this.bpb=0;this.rWh=a;this.e2=b;this.OOh=c;this.Od=f}get An(){return this.rWh.value}initialize(){this.An.ya(G.a.GSe,Xd.a.frame,Object(F.a)(this,this.GSe,"requestFontInfo"));this.Jyc=this.e2.Gib(Sr.a.vVa,Object(F.a)(this,this.Nvb,"featureStateChangeCallback"));this.pkb()}Ql(a=!1){const b=sj.UISurfaces.zr(),
c=this.e2.isFeatureEnabled(Sr.a.vVa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(Gq.MDa,this.Jca(l[1]));a&&this.Wr()})}tIh(a){sj.UISurfaces.zr().then(b=>{b.updateTaskPane(Gq.MDa,this.Jca(a));return null})}Nvb(a){this.tIh(a.isEnabled)}GSe(a,b,c,f,l){this.HV=l.CommandValueId;this.G5a=l.Trigger;this.bpb=l.InputMethod;this.Ql(2===this._state&&1===this.bpb);return 32}Jca(a){const b=new zM;b.onUpsellButtonClicked=Object(F.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");
b.fontName=this.HV;b.isLicensed=a;b.trigger=this.G5a;b.helpArticleUrl=this.gAi();b.paneId=Gq.MDa;a=this.aFj();a.contentProps=b;return a}aFj(){return Object.assign(new nu.a,{title:Gq.whd,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(F.a)(this,this.onOpen,"onOpen"),onClose:Object(F.a)(this,this.onClose,"onClose"),onShow:Object(F.a)(this,this.onShow,"onShow"),onHide:Object(F.a)(this,this.onHide,"onHide")})}pkb(){if(this.Od){var a=
this.Od.Fc(Gq.MDa);a.parent=E.AFrame.hj;a.dJ=!0}}onOpen(){this._state=2;this.Wr()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.bpb=a),this.Wr())}onClose(){this.bpb=this._state=0;this.blur()}onHide(){this._state=1;this.bpb=0}Wr(){this.Od&&1===this.bpb&&this.Od.rf(Gq.MDa)}blur(){this.Od&&this.Od.Ae&&this.Od.Ae.name===Gq.MDa&&this.Od.rf(this.Od.q8)}onUpsellButtonClicked(){this.e2.launchUpsellExperience(Gq.uVi)}dispose(){this.e2.oKb(Sr.a.vVa,this.Jyc)}gAi(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",
this.OOh,this.$aj(),"PPWAENDUSER",u.AFrameworkApplication.lcid)}$aj(){switch(this.G5a){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return dA.Nki(this.HV)}static Nki(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const f=ha.a.charAt(a,c);if(255<a.charCodeAt(c)||ha.a.fhg(f))b+=f}return b}}Object(n.a)(dA,"FontInfoPane",null,[271,106]);class AM extends dA{constructor(a,
b,c,f){super(a,b,c.Ga("FontInfoHelpBaseUrl"),f)}Nvb(a){this.tIh(a.isEnabled)}}Object(n.a)(AM,"PPTFontInfoPane",dA,[]);class vE{constructor(){this.d9c=this.Xdc=this.Ydc=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}Zb(a){this.K=a;this.K.register(269,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().oa(()=>new xM(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(270,"Box4.IFontPinningStore").ma().oa(()=>new yM(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.ITaskManager")));this.K.register(271,"Common.ModernFontPicker.IFontInfoPane").ma().oa(()=>new AM(new kc.a(()=>u.AFrameworkApplication.Ta),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>
{a.ka("PPTOModernFontPickerIsEnabled")&&(this.d9c=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.Xdc=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.Xdc.initialize(),b.isFeatureEnabled(Sr.a.vVa,!1).then(c=>{!u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&c&&(this.Ydc=this.K.resolve("Box4.IFontPinningStore"),this.Ydc.initialize())}),Pc.App.Kb.updateCommandUI())})})}dispose(){this.Xdc&&(this.Xdc.dispose(),this.Xdc=null);this.Ydc&&(this.Ydc.dispose(),this.Ydc=
null);this.d9c&&(this.d9c.dispose(),this.d9c=null)}static main(){v.a.instance.Dc(new vE)}}Object(n.a)(vE,"PPTModernFontPickerPackage",null,[2,3]);var wE=d(1083);class BM{constructor(a){this.J$=a;this.Jfb=this.J$.nGb("UserAction","ImageProcessor");this.u7j=67}Gqg(a,b){if(b)if(a&&this.SXj){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}pxh(a,b,c){c-=this.u7j;if(0>=c||!a)return null;let f=a.width,l=a.height;if(0>=f||0>=l)return null;
let w=null,H=1,U=0;try{const ja=Math.ceil(1.37*b);if(c<=ja){const wa=Math.sqrt(c/(1.3*ja));f=Math.floor(a.width*wa);l=Math.floor(a.height*wa)}if(w=this.wQf(a,f,l))if(U=w.length,w.length>=c){const wa=this.t7f(a.width,a.height);wa*Math.floor(a.width)*wa*Math.floor(a.height)>=f*l?w=null:(H++,(w=this.Eol(a))&&w.length>=c&&(w=null))}}catch(ja){w=null,ka.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+ja.message+", Call stack: "+ja.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",
b,H,U,w?w.length:0);ka.ULS.sendTraceTag(20841026,826,50,a);return w}Eol(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.t7f(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.wQf(a,c,f)}catch(w){ka.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+w.message+", Call stack: "+w.stack)}}return b}wQf(a,b,c){if(0>=b||0>=c)return null;let f;this.Jfb.start();var l=document.createElement("canvas");l.width=b;l.height=c;var w=l.getContext("2d");f=this.Jfb.Vq;
w.drawImage(a,0,0,b,c);w=this.Jfb.Vq-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,w,this.Jfb.Vq-(f+w));ka.ULS.sendTraceTag(20841028,813,50,a);return l}t7f(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get SXj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(n.a)(BM,"ImageProcessor",null,
[1162]);class xE{constructor(a,b,c,f,l){this.Ca=a;this.ZOh=b;this.YOh=c;this.h9e=f;this.eZh=l}get An(){return this.Ca}jki(a){this.An.sjd(a,this.ZOh,null,null)}hki(a){this.An.sjd(a,this.YOh,null,null)}d8(a,b,c){c?this.An.sjd(a,this.h9e,b,null):this.An.La(this.h9e,2,b)}y$g(a,b=!1){const c=new K.DictionaryPropertySet;c.setValue(Yd.a.JU,a);c.setValue(Yd.a.bid,!0);c.setValue(Yd.a.Mab,b);this.An.La(this.eZh,2,c)}}Object(n.a)(xE,"ClipboardCommands",null,[1139]);class yE{N3b(){}}Object(n.a)(yE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[1255]);class Hq{constructor(a,b,c,f,l,w){this.DD=a;this.gh=b;this.hv=c;this.Gm=f;this.ap=l;this.fd=w}PHj(a,b){a=b.view;b=b.CE;if(!b||R.a.instance.ga(14)&&!this.DD.Xig(b,!0)||this.Gm&&this.Gm.instance&&this.Gm.instance.bX(b))return 2;var c=Hq.bV?!Hq.Yt.bla(b):!0;this.hv&&c&&this.hv.puc(b.node,A.a.tq,b.Qa);this.gh.IXc(b,l=>new yv.a(l,yv.a.$Mc),Sd.AParagraphNode.j_);if(this.fd.hg&&this.fd.Yy){c=new qf.GraphTransaction(15);try{c.kd(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Lb+1;" "===zb.ParagraphReader.text(f).charAt(c)&&
(f=Id.a.createTextRange(f,c,c+1),this.gh.replaceTextRange(f,"\u00a0"));b=Id.a.Mj(b.node,c);a.Mb.setSelection(Od.SelectionFactory.Fu(b));return 32}static get Yt(){return Hq.BD||(Hq.BD=Ab.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get bV(){null==Hq.pI&&(Hq.pI=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Hq.pI}}Hq.BD=null;Hq.pI=null;Object(n.a)(Hq,"InsertLineBreakStrategy",null,[]);class Bn{static get Qh(){return Bn.Fi||(Bn.Fi=
Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get jm(){return vh.ContextSetEditor.instance}static get F6(){return Bn.ap||(Bn.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Sf(){return Bn.fd||(Bn.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static XHj(a,b,c,f,l){if(l&&l.Sa(Yd.a.targetObject)){var w=b.view.xg.Gh.Be(l.eb(Yd.a.targetObject));w=Id.a.create(w)}else w=Bn.jm.V2(b.CE,11);if(!w)return 8;a=u.AFrameworkApplication.Ta.pi(w,
a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Nh)return 2;b=b.view;f=b.Mb.Qj;if(f=Bn.jm.V2(f,11)){c=new nn.a;c.set(f.node);c.Ze();if(l&&l.Sa(Yd.a.targetObject))for(l=l.Mh(Yd.a.targetObject);!c.currentNode.id.equals(l)&&c.zc()&&(Pa.OutlineElementNavigator.Re(c),11===c.vi););Pa.OutlineElementNavigator.Rwa(c,!1,!1);l=nb.SelectionEditor.Sja(c,!0);l=zb.ParagraphReader.ps(l)?Od.SelectionFactory.Sg(l,0):Od.SelectionFactory.wl(l);b.Mb.setSelection(l)}}return a}static rfe(a,b,c,f,l){a=a===D.a.f9b;b=b.node;if(l&&
l.Sa(Yd.a.targetObject)&&!b.id.equals(l.Mh(Yd.a.targetObject)))return 2;if(1===c)return 32;c=new ob.GraphIterator;c.set(b);c.rc(10);Bn.Qh.Gda(c,a,!0);Bn.Sf.hg&&Bn.Sf.Yy&&Pa.OutlineElementNavigator.oi(c);return 32}}Bn.Fi=null;Bn.ap=null;Bn.fd=null;Object(n.a)(Bn,"InsertOutlineElementStrategy",null,[]);var pR=d(416);class eA{constructor(a,b,c,f,l,w,H,U){this.hv=b;this.VRh=a;this.Jt=l;this.Zo=f;this.Fi=c;this.DD=w;this.Tc=H;this.Y4a=U}npk(a,b,c,f,l){if(!b.view.Nh)return 2;b=b.view;let w=null;b.pp&&(w=
b);const H=b.Mb.Qj;let U=!0,ja=!1,wa=null;if(!H)return 2;const Sa=new qf.GraphTransaction(15);Sa.kd(b.xg);let eb=null;2===c&&(eb=new nn.a,eb.set(H.node),eb.Ze(),wa=new ux(eb),2===Pc.App.mode&&nb.SelectionEditor.Tg(H)&&(eb.LB(11)&&rb.ListReader.vk(eb)&&fe.OutlineElementReader.isEmpty(eb,!1)&&(U=!1),U&&Pc.App.Jh.vw&&fe.OutlineElementReader.GC(eb,H,!1)&&!fe.OutlineElementReader.GC(eb,H,!0)&&(U=!1)),Pa.OutlineElementNavigator.Re(eb),fe.OutlineElementReader.isEmpty(eb,!1)&&(pR.a.uSj(eb)&&(U=!1),1===Pc.App.mode&&
rb.ListReader.vk(eb)&&(ja=!0)));a=u.AFrameworkApplication.Ta.pi(H,a,c,!1,f,l);U&&32===a&&2===c&&(ja||Pa.OutlineElementNavigator.ZIa(eb,!1,!nb.SelectionEditor.Tg(H),!1),ja&&wa&&wa.restore(eb),R.a.instance.ga(101)&&this.Jt.freeze(),b.Mb.setSelection(Od.SelectionFactory.uj(eb.currentNode,!0)),R.a.instance.ga(101)&&this.Jt.o2e(),this.VRh.Mn.uw());w&&(U||w.mya());ph.GrippersManager.instance.L1a(1);Sa.dispose();return a}CB(a,b,c){a=!1;if(nd.ImageReader.tFa(b)||nd.ImageReader.jzb(b))b=this.BBi(b),a=!0;const f=
b;b=nb.SelectionEditor.Tg(b);if(1===c)return 32;const l=f.node,w=new ob.GraphIterator;w.set(l);w.Ze();Pa.OutlineElementNavigator.Re(w);c=new qf.GraphTransaction(15);c.Iy(w);b?(b=!0,R.a.instance.ga(101)&&zb.ParagraphReader.ae(l)&&f.Qa===zb.ParagraphReader.textLength(l)&&oe.n(f)&&9===zb.ParagraphReader.bUc(l)&&this.Jt.qCi(f),1===Pc.App.mode&&fe.OutlineElementReader.isEmpty(w,!1)&&rb.ListReader.vk(w)&&(b=!1),this.Zo.yrh(w,b,f,l),this.hv&&this.hv.puc(l,A.a.tq,f.Qa),a&&(Pa.OutlineElementNavigator.HJ(w,
!1,!1),a=w.Bb(2),(a=this.Y4a.Sg(a,0))&&this.Tc.setSelection(a))):this.Fi.Gda(w,!0,!0);c.dispose();Pc.App.Kb&&Pc.App.Kb.updateCommandUI();return 32}BBi(a){if(nd.ImageReader.tFa(a))var b=Id.a.Mj(a.node,a.Qa);else b=zb.ParagraphReader.CCa(a.node),a=eA.b8i(a.node.properties.eb(Va.a.runId),b.properties.Mh(Va.a.IY),b.Ra),b=Id.a.Mj(b,a);return b}static vZi(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static b8i(a,b,c){let f=0;a=eA.vZi(a,b);let l=0;if(a===b.length)l=c.length-1;else for(;l<c.length;){b=
c.ga(l);if(b.formatting&&b.formatting.qg===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(n.a)(eA,"NewLineStrategy",null,[]);class ou{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.Xs=null;this.HZ=a;this.Byc=w;this.JBc=new eA(this,b,c,f,l,H,wa,Sa);this.Oef=new Hq(H,U,b,ja,eb,ub)}get Mn(){return this.Xs||(this.Xs=this.HZ())}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this.JBc,this.JBc.CB,"newLine");a.ra(D.a.enter,Cb.a.view,Object(F.a)(this.Byc.value,this.Byc.value.jUi,"enterView"),
1124);a.ra(D.a.yqd,Cb.a.view,Object(F.a)(this.Byc.value,this.Byc.value.gil,"shiftEnterView"),1124);a.ya(D.a.CB,Cb.a.view,Object(F.a)(this.JBc,this.JBc.npk,"newLineView"));a.ya(D.a.CB,Cb.a.Of,b);a.ya(D.a.CB,Cb.a.image,b);a.ya(D.a.CB,Cb.a.textRange,b);a.ya(D.a.CB,Cb.a.anchoredObject,b);a.ya(D.a.CB,Cb.a.embeddedFile,b);a.ya(D.a.CB,Cb.a.ink,b);a.ya(D.a.CB,Cb.a.paragraph,b);a.ya(D.a.CB,Cb.a.iFrame,b);a.ya(D.a.CB,Cb.a.unsupportedObject,b);a.le(D.a.CB,1124);a.ra(D.a.d9b,Cb.a.view,Object(F.a)(this.Oef,this.Oef.PHj,
"insertLineBreakView"),1028);a.ya(D.a.f9b,Cb.a.view,Bn.XHj);a.ya(D.a.f9b,Cb.a.outlineElement,Bn.rfe);a.le(D.a.f9b,1092)}static get instance(){return ou.Ka||(ou.Ka=ou.wC())}static wC(){return new ou(()=>Ab.a.instance.resolve("Box4.IUndoManager"),Ab.a.instance.rb("Box4.IAutoCorrectScheduler"),Ab.a.instance.resolve("Box4.IOutlineElementEditor"),Ab.a.instance.resolve("Box4.List.IListEditor"),Ab.a.instance.resolve("Box4.IInsertionPointFormatting"),Ab.a.instance.ke("Box4.Actors.IEnterViewStrategy"),Kh.a.instance,
Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ab.a.instance.Ja("Box4.IExternalSelectionManager"),de.a.instance,Ab.a.instance.resolve("Box4.ISelectionFactory"),Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}ou.Ka=null;Object(n.a)(ou,"EnterActor",null,[]);class CM{tAh(a){return a}rlg(){return!0}}Object(n.a)(CM,"EopFormattingStrategy",null,[1142]);var DM=d(152);class zE{constructor(a,
b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.GOa=this.IVb=this.qnb=null;this.JLd=0;this.FDd=!1;this.Pa=new vc.a;this.OSb=null;this.KK=a;this.Jt=b;this.Jf=c;this.Yw=f;this.sr=l;this.Zo=w;this.Wg=H;this.gh=U;this.DD=ja;this.hd=wa;this.fd=Sa;this.ap=eb;this.lPa=ub}get nSi(){return R.a.instance.ga(105)?this.hd?this.hd.isFeatureEnabled(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get eda(){return this.OSb||(this.OSb=Ab.a.instance.resolve("Box4.IFormatPainterStrategy"))}get yL(){return this.FDd}set yL(a){this.FDd!==
a&&(this.FDd=a,this.Pa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}T9h(a){this.Pa.addHandler("FormatPainterBrushActiveStatusChanged",a)}sah(a){const b=a.Ua;ka.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.Ykg(a);if(this.eda.fvh(b.contextId,a))try{this.GOa=this.sr.Cta(c)}catch(f){throw ka.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",f.message),f;}this.IVb=mb.StyleReader.aE(c);c=Kb.a.xs(b);c.Yz&&(this.qnb=
Object(qa.a)(sq.a,c.Yz.clone()));this.JLd=a?Cb.a.paragraph:b.contextId;this.eda.ewf(b.node,this.GOa,this.qnb)}eyf(a){const b=R.a.instance.ga(14),c=this.Ykg(a);for(let U=0;U<a.length;U++){var f=a.ga(U);if(f.al){var l=void 0;if(f.contextId===Cb.a.Of||f.contextId===Cb.a.textRange)l=b&&this.DD.uua(f);else if(f.contextId===Cb.a.paragraph)l=b&&this.DD.M_c(f);else if(f.contextId===Cb.a.endOfParagraph)l=b&&this.DD.FZc(f);else{ka.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",f.contextId);
continue}ka.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)ka.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(qa.a)(Sd.AParagraphNode,f.node);var w=!1;l&&(w=f.contextId===Cb.a.textRange&&!!l&&!f.Qa&&f.Lb===this.sr.textLength(l));if(w=this.eda.wuh(this.JLd,f.contextId,c,w))try{zb.ParagraphReader.ae(l)?(this.IVb&&this.KK.Eaa(this.IVb,l,!0),this.Yw.iyf(l,this.GOa)):ka.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
f.node.type)}catch(ja){throw ka.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",ja.message),ja;}var H=f;f.contextId===Cb.a.paragraph?H=Id.a.createTextRange(l,0,zb.ParagraphReader.textLength(l)):f.contextId===Cb.a.Of&&(H=this.Jt.y6b(f),H=de.a.WQa(H));if(H&&H.contextId===Cb.a.textRange)try{this.yfi(H,this.qnb,w?null:this.IVb)}catch(ja){throw ka.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ja.message),ja;}if(f.contextId===Cb.a.paragraph||f.contextId===
Cb.a.endOfParagraph){w=new ob.GraphIterator;w.set(l);w.Ze();w.Jg(11);H=rb.ListReader.vk(w);const ja=!zb.ParagraphReader.textLength(l);ka.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",H,ja);H?(this.Wg.qna(w),f=w.currentNode,this.Wg.Rda(f)&&this.Zo.wpd(f,l,this.qnb)):this.nSi&&this.xfi(f,this.qnb)}}}else ka.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",f.contextId)}}xfi(a,b){b&&(a=this.gh.e2d(a.node),a.ee(a.He),this.fyf(a,
b,null))}yfi(a,b,c){if(b||c)0<oe.h(a).length&&ka.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.lPa.WHc(a,f=>{this.fyf(f,b,c)})}fyf(a,b,c){this.Jf.pCa(a);a.Yz&&a.Yz.removeProperty(Za.a.highlight);this.Jf.dKc(a);this.ay(a,c);this.ay(a,b)}ay(a,b){if(b){var c=a.paragraph.Gh;if(c){var f=a.Yz;f=f?Object(qa.a)(DM.a,f.clone()):sq.a.ACa(1179725);for(const w of b.bA())if(w!==Va.a.NG&&w!==Va.a.fieldInstruction&&w!==Za.a.it&&w!==Za.a.G_&&w!==Va.a.Eab&&w!==Za.a.kt&&w!==Va.a.languageHint&&
w!==Va.a.noProof){if(w===eh.a.a3){var l=b.sa(eh.a.a3,ia.a.nil);if(l!==ia.a.nil&&(l=Object(qa.a)(sq.a,c.Be(l)),l=mb.StyleReader.VUc(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=mb.StyleReader.sL(a.paragraph).amj(l);f.ay(l);continue}}f.setValue(w,b.Mh(w))}f.tbb?b=c.qKa(f):(c.HE(f),b=f);a.nm=b.id}}}Ykg(a){return!a.Cca&&a.Ye.contextId!==Cb.a.endOfParagraph}reset(){this.GOa=this.IVb=this.qnb=null;this.JLd=Cb.a.none}}Object(n.a)(zE,"FormatPainter",null,[518]);class fA{constructor(a){this.ll=this.transaction=
null;this.Hf=a;this.Xtb=this.rq=0}}Object(n.a)(fA,"SelectAllArguments",null,[]);class ds{constructor(a,b,c,f,l){this.UYh=a;this.Mha=b;this.Bk=c;this.VDd=f;this.gUb=l}get gKe(){return this.UYh}get Mn(){return this.Mha.value}get p8k(){return this.VDd?this.gUb?Object(F.a)(this,this.qVi,"expandSelectionOneNote"):Object(F.a)(this,this.rVi,"expandSelectionWord"):Object(F.a)(this,this.iph,"selectAllInOutline")}get jph(){return this.gUb?Object(F.a)(this,this.Wnd,"selectAllOutlines"):null}wb(){const a=u.AFrameworkApplication.Ta;
this.jph&&a.ra(D.a.Wnd,Cb.a.view,this.jph,2);a.ya(D.a.Iaa,Xd.a.frame,ds.fwh);a.ya(D.a.zqd,Xd.a.frame,ds.fwh);a.ra(D.a.Osa,Cb.a.view,this.p8k,2);a.ra(D.a.Jwf,Cb.a.view,E.AFrame.ve,100);a.ra(D.a.sFe,Cb.a.view,ds.sFe,4)}qVi(a,b,c){return this.Osa(b,c,null)}Osa(a,b,c){if(1===b)return 32;if(!a.view.Nh)return 2;b=a.view;if(!b.Mb)return 8;const f=b.Mb.Na;if(!f||!f.length)return 8;fd.a.mark(5798);Pc.App.Kb.Ld.isEditingAllowed||Pc.App.Kb.Ld.hz?a=nb.SelectionEditor.m9d(f):(y.FocusManager.instance().iD(E.AFrame.EW),
a=Od.SelectionFactory.KUe(b.xg));if(!a)return 8;this.VDd&&!f.psa&&ka.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.gKe.jbb(nb.SelectionEditor.r1f(a))?c=c(b):(c=new fA(b),c.ll=a,c=new ii.a(null,Object(F.a)(this,this.aJb,"processSetSelection"),c),c.Pl("ExpandSelection"),c.run());return c.inProgress?1:32}rVi(a,b,c,f,l){return b.view.pp?this.Osa(b,c,Object(F.a)(this,this.ezh,"startOperationOfSelectAllInOutline")):this.iph(a,b,c,f,l)}aJb(a,b){return 0===b.rq?(b.transaction=this.Bk.oe(2),
b.transaction.kd(b.Hf.xg),b.rq=1,!0):1===b.rq?(b.Hf.Mb.iMb(b.ll,a),b.rq=2,!0):2===b.rq?(b.Hf.Mb.Na.psa=b.ll.psa,this.Mn.uw(),b.transaction.XU(a),b.rq=3,b.transaction.dispose(),fd.a.mark(5799),!0):!1}iph(a,b,c){if(1===c)return 32;if(!b.view.Nh)return 2;a=b.view;return a.Mb&&a.Mb.Na&&a.Mb.Na.mb?this.ezh(a).inProgress?1:32:8}ezh(a){u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.VDd&&a.pp&&ka.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");
a=new ii.a(null,Object(F.a)(this,this.eMk,"processSelectAllInOutline"),new fA(a));a.Pl("SelectAllInOutline");a.run();return a}eMk(a,b){if(0===b.rq)return b.ll=Od.SelectionFactory.q8k(b.Hf.Mb.Na.mb),b.transaction=this.Bk.oe(2),b.transaction.kd(b.Hf.xg),b.rq=1,!0;if(1===b.rq){if(!b.Xtb)return R.a.instance.ga(77)&&R.a.instance.ga(104)&&b.ll.Hl?(b.Hf.Mb.iMb(b.ll,a),b.Xtb=b.ll.length):(b.Hf.Mb.setSelection(b.ll.ga(0),a),++b.Xtb),!0;if(b.Xtb<b.ll.length)return b.Hf.Mb.fuf(b.ll.ga(b.Xtb),a),++b.Xtb,!0;b.rq=
2}return 2===b.rq?(b.Hf.Mb.Na.psa=b.ll.psa,this.Mn.uw(),b.transaction.XU(a),b.rq=3,b.transaction.dispose(),!0):!1}Wnd(a,b,c){if(1===c)return 32;if(!b.view.Nh)return 2;b=b.view;a=Od.SelectionFactory.KUe(b.xg);if(!a)return 8;b=new fA(b);b.ll=a;a=new ii.a(null,Object(F.a)(this,this.aJb,"processSetSelection"),b);a.Pl("ExpandSelection");a.run();return a.inProgress?1:32}static get Gjb(){return ds.X4a||(ds.X4a=Ab.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static sFe(a,b,c){if(1===c)return 32;
if(!b.view.Nh)return 8;a=b.view;b=Od.SelectionFactory.uj(a.root.graphNode,!0);if(!b)return 8;a.Mb.setSelection(b);return 32}static fwh(){if(!R.a.instance.ga(75))return 2;var a=Pc.App.Kb.Ld.PK;if(!a.Nh)return 2;if(a.Nh&&1!==Pc.App.Kb.state){fd.a.mark(4668);var b=a.Mb.Na.mb;if(!b&&u.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=nb.SelectionEditor.Wia(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||
b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;ds.Gjb.Iaa(new Sys.UI.Point(c,f),1);fd.a.mark(4669)}return 32}}ds.X4a=null;Object(n.a)(ds,"SelectAllHandlers",null,[1143]);class EM extends Bi.StandardDialog{constructor(a,b,c=null){super();this.yd=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.cPd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.pGb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(n.a)(EM,"ToggleRibbonUXDialog",
Bi.StandardDialog,[]);const sR=()=>{const a=u.AFrameworkApplication.Ta;a.ra(G.a.VNk,Xd.a.frame,qR,101);a.ya(G.a.Lxl,Xd.a.frame,rR)},rR=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==Xd.a.frame)return 2;ka.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",u.AFrameworkApplication.Aa.hb.Pp?"Single Line Ribbon":"Classic Ribbon");new EM(f=>{1===f&&u.AFrameworkApplication.Ta.processAction(G.a.pDh,2)},u.AFrameworkApplication.Aa.hb.Pp);return 32},qR=(a,b,c,f,l)=>{l[Vh.a.On]=
u.AFrameworkApplication.Aa.hb.Pp;return 32};class AE{constructor(a){this.Jf=a}dWe(a,b){this.Jf.YU(a,b.cache.JN);this.Jf.Pq(a,b.cache.fontSize)}PVe(){}C8d(){return null}QW(){return null}nTa(){return null}N8(){return null}Avh(){return!1}}Object(n.a)(AE,"FormattingStewardBridge",null,[1136]);var FM=d(736),tR=d(688);class GM{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){if(a)if(b)if(c)if(f)if(l)if(w)if(H){if(!U)throw Error.argumentNull("errorHandler");if(!ja)throw Error.argumentNull("sessionInfo");}else throw Error.argumentNull("graphActionBlockingManager");
else throw Error.argumentNull("graphTopologyManager");else throw Error.argumentNull("graphOperationEventSource");else throw Error.argumentNull("pptWorkspace");else throw Error.argumentNull("transactionFactory");else throw Error.argumentNull("pptSelectionManager");else throw Error.argumentNull("actionManager");this.ia=a;this.ob=b;this.Jb=c;this.WX=f;this.Es=l;this.ua=w;this.fc=H;this.Sd=U;this.Fe=ja;this.X2c=wa;this.Iic=Sa;this.neb=eb}wb(){this.ia.ra(L.a.Zsf,nc.a.application,Object(F.a)(this,this.nrj,
"handleAddEditOrSetAsSlideTitle"),4);this.ia.ra(L.a.editSlideTitle,nc.a.application,Object(F.a)(this,this.$$f,"handleEditSlideTitle"),4);this.ia.ra(L.a.addSlideTitle,nc.a.application,Object(F.a)(this,this.G$f,"handleAddSlideTitle"),4);this.ia.ra(L.a.stf,nc.a.application,Object(F.a)(this,this.prj,"handleAddHiddenSlideTitle"),4);this.ia.ra(L.a.setAsSlideTitle,nc.a.application,Object(F.a)(this,this.hbg,"handleSetAsSlideTitle"),4);this.ia.ra(L.a.wbh,nc.a.application,Object(F.a)(this,this.Rtj,"handleHyperlinkText"),
4);this.ia.ya(L.a.fsf,nc.a.application,Object(F.a)(this,this.krj,"handleAccessibleAuthoringHelp"));this.ia.ra(L.a.Ifg,Cb.a.application,Object(F.a)(this,this.ybg,"handleUploadCaptionsDialog"),4);this.ia.ra(L.a.Jfg,Cb.a.application,Object(F.a)(this,this.ybg,"handleUploadCaptionsDialog"),4);this.ia.ra(L.a.cih,nc.a.application,Object(F.a)(this,this.Mwj,"handleRemoveAllCaptions"),4)}Ee(){}xEa(){const a=this.ob.uk();return a?a.xEa():null}onShapeSelected(a,b){this.Es.Tjh(Object(F.a)(this,this.onShapeSelected,
"onShapeSelected"));b.shapeNode.m4?32!==this.ia.processAction(L.a.H6a,2)&&va.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):va.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")}kph(){const a=this.xEa();return a?(this.Es.Hvf(Object(F.a)(this,this.onShapeSelected,"onShapeSelected")),this.ob.selectShape(a,!0),!0):!1}Tig(){const a=this.ob.Qe();return!!a&&1===a.length&&!!this.xEa()}$gg(){for(const a of this.ob.Qe())if(a&&
!a.xEa())return!0;return!1}eng(){var a=this.ob.Xd();if(1!==a.length)return!1;a=a[0];return!a.m4&&!a.If&&!a.Og&&!a.Qf&&a.hasText&&0<a.textLength()}nrj(a,b,c,f,l){if(1===c)return 32;var w=this.xEa();const H=this.ob.Xd(),U=1===H.length?H[0]:null;0<H.length&&U!==w?this.eng()?(w=3,a=this.hbg(a,b,c,f,l)):(w=4,a=32):this.Tig()?(w=1,a=this.$$f(a,b,c,f,l)):this.$gg()?(w=2,a=this.G$f(a,b,c,f,l)):(va.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),w=5,a=8);wo.a("AddEditOrSetAsSlideTitle",
32===a,void 0,[Object.assign(new $c.a,{name:"SubAction",int64:w})]);return a}$$f(a,b,c){return 1===c?this.Tig()?32:2:this.kph()?32:8}H$f(a,b,c){if(1===b)return this.$gg()?32:2;b=new Date;const f=this.Jb.Ad(15,void 0,void 0,()=>{const l=this.ob.Qe();if(l&&1===l.length){const w=new Date;let H=0;H=window.setInterval(()=>{this.kph()?window.clearInterval(H):2E3<+new Date-+w&&(va.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(H))},
100)}});try{va.a.J(509724643,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",c);f.nc(this.WX.xf);f.jd=a;for(const l of this.ob.Qe())l&&!l.xEa()&&(l.zFa=c)}finally{f&&f.dispose()}a=new Date;va.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",c);if(c=Rc.a.Ib)c.Zm("AddSlideTitleStart",b),c.Zm("AddSlideTitleEnd",a),c.Oj=!1,c.Ur=!0,Rc.a.Tfa(c);return 32}G$f(a,b,c){return this.H$f(a,c,!1)}prj(a,b,c){return this.H$f(a,c,!0)}hbg(a,b,c){if(1===c)return this.eng()?
32:2;c=this.ob.uk();const f=this.ob.Xd();if(1!==f.length)return va.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;b=new Date;const l=this.Jb.Ad(15);try{va.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,f[0].get_shapeId()),l.nc(c),l.jd=a,c.lLa=f[0].get_shapeId()}finally{l&&l.dispose()}a=new Date;va.a.J(509724639,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,f[0].get_shapeId());
if(c=Rc.a.Ib)c.Zm("SetAsSlideTitleStart",b),c.Zm("SetAsSlideTitleEnd",a),c.Oj=!1,c.Ur=!0,Rc.a.Tfa(c);32!==this.ia.processAction(L.a.H6a,2)&&va.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32}Rtj(a,b,c){return this.ob.C_()?this.ia.processAction(D.a.D8b,c):this.ia.processAction(L.a.Lrb,c)}krj(a,b,c){if(1===c)return 32;a={};this.X2c&&(a.query="AssetID="+this.X2c);b={};b.XE=ResourceStrings.L_Help;b.assetId="FA000000012";b.nonPersistedSettings=a;return this.ia.La(L.a.lga,
2,b)}lQj(){if(!this.Iic)return!1;const a=this.ob.Xd();return 1!==a.length?!1:a[0].OQ}ybg(a,b,c){const f=this.ua.Ba;if(!f||this.fc.$c(f))return 8;if(1===c)return this.lQj()?32:2;b=Rc.a.zk("Captions::Insert");try{return tR.a.OZe(".vtt",FM.e,()=>FM.d(a,Object(F.a)(this,this.DHj,"insertCaptionsSuccessAfterUpload"),"captions",this.Fe,f),"captions",f,this.ua.presentation,this.fc,this.Sd,b,!1,this.neb,50,10,3),b&&b.Va("CaptionsDialogInitialized","true"),32}catch(l){va.a.J(509724637,818,10,"Error while rendering new captions selection dialog.")}b&&
(b.Va("CaptionsDialogInitialized","false"),b.finish(),b=null);return 8}DHj(a,b,c,f,l,w,H){f.YN(c)&&va.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+c.lja);f.hK(c);l&&l.Va("CaptionsUploadToRC","true");Object(Pd.a)("FixForInsertMediaSlideNavigationIssue")||(H=this.ua.Ba);if(H&&H.isConnected){w=w.files[0].name;f=c="";var U=w.split(".");2<=U.length&&(f=U[U.length-2]);Xa.a.xe(f)||(c=w.lastIndexOf("."),c=0<=c?w.substring(0,
c):w,f="");w=this.ob.Xd();if(1===w.length){w=w[0];U=this.Jb.Ad(15);try{U.nc(H),U.jd=a,l&&l.Va("InsertCaptionsInProgress","true"),w.mtb=b,w.ktb=c,w.ltb=f}finally{U&&U.dispose()}l&&(l.Va("InsertCaptionsSuccessful","true"),l.finish())}}}vUj(){if(!this.Iic)return!1;const a=this.ob.Xd();return 1!==a.length?!1:a[0].OQ}Mwj(a,b,c){if(1===c)return this.vUj()?32:2;b=this.ob.Xd();if(1!==b.length)return 16;c=b[0];b=new Date;const f=this.Jb.Ad(15);try{va.a.J(509724635,822,50,"RemoveAllCaptions started"),f.nc(this.WX.xf),
f.jd=a,c.gAb=!0}finally{f&&f.dispose()}a=new Date;va.a.J(509724634,822,50,"RemoveAllCaptions completed");if(c=Rc.a.Ib)c.Zm("RemoveAllCaptionsStart",b),c.Zm("RemoveAllCaptionsEnd",a),c.Oj=!1,c.Ur=!0,Rc.a.Tfa(c);return 32}}Object(n.a)(GM,"AccessibleAuthoringActor",null,[365]);var uR=d(142),vR=d(172),wR=d(181);class HM{constructor(a,b,c,f){this.M6c=!1;this.K9="";this.bDb=!1;this.TXa=null;this.j4c=-1;this.iDb=!1;this.Ala=[];this.Qb=b;this.la=c;this.ncd=f;a&&this.Qb.ff(()=>{a.KG(Object(F.a)(this,this.Ryk,
"onSelectionChangeFinished"))})}wb(){}Ee(){}v6b(a,b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:l},c));return f}pUc(a){const b=[];for(let c=0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}R6f(a){const b=[];let c=!1;if(a){switch(this.K9){case "FormatPicture":Array.addRange(b,
this.pUc("PictureStyles"));c=!0;break;case "Table":this.iDb||Array.addRange(b,this.pUc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,this.pUc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.pUc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.v6b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.v6b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",
0)),Array.addRange(b,this.v6b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.iDb&&(a=0),Array.addRange(b,this.v6b(this.TXa,"DropLabel",a)),a=this.TXa.slice(0,this.TXa.length).reverse(),Array.addRange(b,this.v6b(a,"MoveToOverflow",null)))}else for(const f of this.TXa)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}T6d(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.cGa("Error","GetModelType failed for "+
c),null}return b}f7d(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}mPb(a){this.ncd&&(a=this.T6d(a))&&this.ncd(a)}LDl(a){if(a.length){if(this.ncd){var b=this.T6d(a);if(!b)return;var c=this.f7d(this.K9);if(0<c.length&&!this.bDb){for(var f of c)this.Ala.push(appChrome.actions.updateGroupHiddenState(f,!0));this.bDb=!0}else if(this.bDb&&!c.length){c=[];f=this.f7d("FormatPicture");for(var l of f)this.Ala.push(appChrome.actions.updateGroupHiddenState(l,
!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.T6d(c))for(let w in l)b[w]=l[w];this.bDb=!1}this.ncd(b)}this.TXa=a;b=[];for(const w of a)appChrome.selectors.isControlDisabled(w)&&b.push(w);0<b.length&&this.cGa("Disabled",b.join(","));0<this.TXa.length&&(this.Ala.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.Ala.push(appChrome.actions.updateControlsInGroup("Adaptive",this.TXa)),Array.addRange(this.Ala,this.R6f(!0)),this.M6c=!0)}}Llh(a){""!==this.K9&&
this.K9!==a&&Array.addRange(this.Ala,this.R6f(!1))}W4e(a,b){if(a||this.M6c)if(this.Ala.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a)),this.M6c=a,b=this.f7d(b),a&&0<b.length||this.bDb){for(var c of b)this.Ala.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.mPb(c));this.bDb=a}}WPf(){0<this.Ala.length&&(appChrome.api.dispatch(this.Ala),this.Ala=
[])}ati(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.mPb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;a=!1;if("Table"===b&&nj.a.instance.mb){const c=!nj.a.instance.mb.Hl&&!nj.a.instance.mb.M0c;if(a=(""===this.K9||this.K9===b)&&c!==this.iDb)this.iDb=c}a?this.Llh("TableCellEdit"):this.Llh(b);this.K9=b;return!0}x8k(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();
for(const f of a)if(this.ati(c,f)){b=!0;break}return b?this.K9:""}M4i(){switch(this.K9){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Table":return this.iDb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");
case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}Ryk(a,b){if(!this.la.Voa&&"Home"===appChrome.selectors.getSelectedTabId()&&b.ll&&b.ll.mb&&b.ll.length){var c=()=>{const f=this.K9;""===this.x8k()?this.W4e(!1,f):this.iDb||""===f||f!==this.K9?this.LDl(this.M4i()):this.M6c||(this.mPb(this.TXa),this.W4e(!0,this.K9));this.WPf()};-1!==this.j4c&&window.clearTimeout(this.j4c);this.j4c=window.setTimeout(()=>
{this.j4c=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.W4e(!1,this.K9),this.WPf()}cGa(a,b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};uR.a.sendActivityEvent(Object.assign(new wR.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:vR.a.sC(a),durationMs:window.performance.now()}))}}Object(n.a)(HM,"AdaptiveTabGroupUpdaterActor",null,[365]);class IM extends Mt{constructor(a,
b){super(a);this.m3h=b;this.vu=a}getAltText(a){return(a=this.vQ(a))?a.get_altTitle():""}H1f(a){return(a=this.vQ(a))?a.get_alt():""}UQd(a,b){if(1===a)if(this.hide(),a=this.vQ(this.vu)){const c=this.m3h.oe(15);c.nc(a);a.F0a=!1;a.set_altTitle(b[rq.WQd]);a.set_alt(b[rq.TQd]);c.dispose()}else va.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}vQ(a){let b;return(a=(a=Tj.b(a))?a.Mb:null)&&(b=a.Xd())&&1===b.length?b[0]:null}}Object(n.a)(IM,"ShapeAltTextDialog",Mt,[]);class JM{constructor(a,
b,c,f,l,w){this.Jb=l;this.ia=a;this.la=b;this.ob=f;this.Hcb=c;this.fc=w}wb(){this.la.ghg&&this.ia.ra(L.a.Lrb,Cb.a.view,Object(F.a)(this,this.pei,"altTextDispatcher"),4)}Ee(){}t4i(a){new IM(a,this.Jb)}pei(a,b,c){if(a!==L.a.Lrb)return 16;a=this.ob.Xd();if(!a||1!==a.length||this.fc.$c(a[0]))return va.a.J(17876881,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===c)return 32;va.a.J(17876883,822,50,"Begin setting the alternative text for shape.");
a[0].Hj&&!a[0].get_isSVGBlipFilled()&&this.la.FUa?this.Hcb.bRk():this.t4i(b);return 32}}Object(n.a)(JM,"AltTextActor",null,[365]);class KM{constructor(a,b,c,f,l,w,H,U){this.kE=null;this.ia=a;this.ob=b;this.Fa=c;this.Jb=f;this.pcb=l;this.yva=w;this.mc=U;this.pcb&&this.pcb.execute(ja=>{this.kE=ja})}wb(){this.ia.ra(L.a.mIc,nc.a.application,Object(F.a)(this,this.Vrj,"handleAudioPlay"),96);this.ia.ra(L.a.KZb,nc.a.application,Object(F.a)(this,this.Urj,"handleAudioPause"),96);this.ia.ra(L.a.vzf,nc.a.application,
Object(F.a)(this,this.Thi,"audioPlayPauseCommandHandler"),96);this.ia.ra(L.a.uqh,nc.a.application,Object(F.a)(this,this.K7b,"handleSetAudioOptions"),96);this.ia.ra(L.a.gnc,nc.a.application,Object(F.a)(this,this.gnc,"queryAudioOptions"),96);this.ia.ra(L.a.playAcrossSlides,nc.a.application,Object(F.a)(this,this.K7b,"handleSetAudioOptions"),96);this.ia.ra(L.a.xnc,nc.a.application,Object(F.a)(this,this.xnc,"queryPlayAcrossSlides"),96);this.ia.ra(L.a.loopUntilStopped,nc.a.application,Object(F.a)(this,
this.K7b,"handleSetAudioOptions"),96);this.ia.ra(L.a.tnc,nc.a.application,Object(F.a)(this,this.tnc,"queryLoopUntilStopped"),96);this.ia.ra(L.a.hideDuringShow,nc.a.application,Object(F.a)(this,this.K7b,"handleSetAudioOptions"),96);this.ia.ra(L.a.onc,nc.a.application,Object(F.a)(this,this.onc,"queryHideDuringShow"),96);this.ia.ra(L.a.rewindAfterPlaying,nc.a.application,Object(F.a)(this,this.K7b,"handleSetAudioOptions"),96);this.ia.ra(L.a.Cnc,nc.a.application,Object(F.a)(this,this.Cnc,"queryRewindAfterPlaying"),
96);this.ia.ya(L.a.playInBackground,nc.a.application,Object(F.a)(this,this.ibg,"handleSetAudioStyles"));this.ia.ya(L.a.noAudioStyle,nc.a.application,Object(F.a)(this,this.ibg,"handleSetAudioStyles"));this.ia.ra(L.a.ync,nc.a.application,Object(F.a)(this,this.ync,"queryPlayInBackground"),96);this.ia.ra(L.a.unc,nc.a.application,Object(F.a)(this,this.unc,"queryNoAudioStyle"),96);this.ia.ra(L.a.setVolume,nc.a.application,Object(F.a)(this,this.L7b,"handleSetVolume"),96);this.ia.ra(L.a.fqd,nc.a.application,
Object(F.a)(this,this.L7b,"handleSetVolume"),96);this.ia.ra(L.a.Gnc,nc.a.application,Object(F.a)(this,this.Gnc,"querySetVolumeLow"),96);this.ia.ra(L.a.gqd,nc.a.application,Object(F.a)(this,this.L7b,"handleSetVolume"),96);this.ia.ra(L.a.Hnc,nc.a.application,Object(F.a)(this,this.Hnc,"querySetVolumeMedium"),96);this.ia.ra(L.a.eqd,nc.a.application,Object(F.a)(this,this.L7b,"handleSetVolume"),96);this.ia.ra(L.a.Fnc,nc.a.application,Object(F.a)(this,this.Fnc,"querySetVolumeHigh"),96);this.ia.ra(L.a.hqd,
nc.a.application,Object(F.a)(this,this.L7b,"handleSetVolume"),96);this.ia.ra(L.a.Inc,nc.a.application,Object(F.a)(this,this.Inc,"querySetVolumeMute"),96);this.ia.ra(L.a.Pyh,nc.a.application,Object(F.a)(this,this.Rxj,"handleStartAudio"),96);this.ia.ra(L.a.Qnc,nc.a.application,Object(F.a)(this,this.Qnc,"queryStartAudio"),96)}Ee(){}Vrj(a,b,c,f,l){b=this.ob.Xd();if(1<b.length||!this.kE)return 16;const w=this.kE.jL(b[0]);if(!w||!w.isPlayerReady())return 16;if(1===c)return 32;let H=!1;l&&(H=!!l.ActionFromPlayer);
return Pg.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",H.toString(),a,()=>{w&&!H&&w.startPlaying();const U=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(U);return 32})}Urj(a,b,c,f,l){const w=this.ob.Xd();if(1<w.length||!this.kE)return 16;if(1===c)return 32;let H=!1;l&&(H=!!l.ActionFromPlayer);return Pg.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",
H.toString(),a,()=>{var U=this.kE.jL(w[0]);U&&!H&&U.pause();U=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(U);return 32})}Thi(){var a=this.ob.LUc();if(!a||!this.kE)return 2;(a=this.kE.jL(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?this.ia.processAction(L.a.KZb,2):this.ia.processAction(L.a.mIc,2));return 32}K7b(a,b,c,f,l){if(1===c)return 32;
if(!l)return va.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const w=l.On;return Pg.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const H=this.ob.tg();if(H&&0<H.length){const U=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{U.nc(H[0]);for(const ja of H){if(!ja||!ja.media)continue;const wa=ja.media;switch(a){case L.a.playAcrossSlides:wa.plyAcrssSldsField=w;break;case L.a.loopUntilStopped:wa.repeatField=
w;break;case L.a.hideDuringShow:wa.hideDrngShwField=w;break;case L.a.rewindAfterPlaying:wa.rewindField=w}ja.media=wa;if(this.yva&&this.kE&&(a===L.a.loopUntilStopped||a===L.a.rewindAfterPlaying)){const Sa=this.kE.jL(ja);Sa&&(a===L.a.loopUntilStopped?Sa.setRepeat(wa.repeatField):a===L.a.rewindAfterPlaying&&Sa.setRewind(wa.rewindField))}}}finally{U&&U.dispose()}}return 32})}ibg(a,b,c,f,l){return 1===c?32:l?Pg.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",l.SourceControlId,a,()=>{const w=this.ob.tg();
if(w&&0<w.length){const H=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{H.nc(w[0]);for(const U of w){if(!U||!U.media||U.Og)continue;const ja=U.media;switch(a){case L.a.playInBackground:ja.plyAcrssSldsField=!0;ja.repeatField=!0;ja.hideDrngShwField=!0;ja.strtField=0;break;case L.a.noAudioStyle:ja.plyAcrssSldsField=!1,ja.repeatField=!1,ja.hideDrngShwField=!1,ja.strtField=2}U.media=ja}}finally{H&&H.dispose()}}return 32}):(va.a.J(512500761,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),
8)}Rxj(a,b,c,f,l){if(1===c)return 32;if(!l)return va.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),8;const w=l.CommandValueId;return Pg.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",w,a,()=>{if(!w||""===w.trim())return 32;const H=this.ob.tg();if(H&&0<H.length){const U=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{U.nc(H[0]);for(const ja of H){if(!ja||!ja.media||ja.Og)continue;const wa=ja.media;wa.strtField="Automatically"===w?0:
2;ja.media=wa}}finally{U&&U.dispose()}}return 32})}ync(a,b,c,f,l){return this.Lxa(l,1)}unc(a,b,c,f,l){return this.Lxa(l,0)}L7b(a,b,c,f,l){return 1===c?32:l?Pg.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const w=this.ob.tg();if(w&&0<w.length){const H=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{H.nc(w[0]);for(const U of w){if(!U||!U.media)continue;const ja=U.media;switch(a){case L.a.hqd:ja.mteField=!0;break;case L.a.fqd:ja.vlmField=.2;ja.mteField=!1;
break;case L.a.gqd:ja.vlmField=.5;ja.mteField=!1;break;case L.a.eqd:ja.vlmField=.8,ja.mteField=!1}this.mc.BL&&(U.media=ja);const wa=l.ActionFromPlayer;if(this.yva&&this.kE&&!wa){const Sa=this.kE.jL(U);Sa&&(Sa.setMute(ja.mteField),Sa.setVolume(ja.vlmField))}}}finally{H&&H.dispose()}}return 32}):(va.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}Gnc(a,b,c,f,l){return this.Lxa(l,2)}Hnc(a,b,c,f,l){return this.Lxa(l,3)}Fnc(a,b,c,f,l){return this.Lxa(l,4)}Inc(a,
b,c,f,l){return this.Lxa(l,5)}Qnc(a,b,c,f,l){if(a=Object(qa.a)(Xh.a,l))c=this.ob.tg(),b=this.Ulg(c,2),c=this.Ulg(c,0),b?(a.$Z=ResourceStrings.L_AudioStartWhenClickedOn,a.mqc()):c&&(a.$Z=ResourceStrings.L_AudioStartAutomatically,a.mqc());return 32}gnc(){this.iac()&&Pc.App.Kb.rG({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}xnc(a,b,c,f,l){return this.Lxa(l,6)}tnc(a,b,c,f,l){return this.Lxa(l,7)}onc(a,
b,c,f,l){return this.Lxa(l,9)}Cnc(a,b,c,f,l){return this.Lxa(l,8)}TRi(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}SRi(a){return!a.media.plyAcrssSldsField&&!a.media.repeatField&&!!a.media.strtField}Ulg(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}Lxa(a,b){if(a=Object(qa.a)(Xh.a,a)){const c=this.ob.tg();if(c&&0<c.length){let f=!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=this.SRi(l);break;case 1:f=
this.TRi(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.Lf(f)}}return 32}iac(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp}}
Object(n.a)(KM,"AudioPlaybackOptionsActor",null,[365]);class LM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(n.a)(LM,"AudioSettingsTaskPaneProps",null,[]);class pu{constructor(){this.text=
this.key=null;this.itemType=0;this.selected=!1}}Object(n.a)(pu,"DropdownOption",null,[]);class MM{constructor(a,b,c,f,l){this.jM=null;this.fHa=this.Eb=!1;a.loadScript("audio-settings-strings").then(()=>{this.fHa=!0;va.a.J(592447300,833,50,"audio-settings-strings loaded successfully")}).catch(w=>{va.a.J(592447298,833,10,"Failed to load audio-settings-strings "+w.toString())});this.ia=b;this.nE=f;this.Hc=c;this.lO=l}wb(){this.ia.ya(L.a.drd,nc.a.application,Object(F.a)(this,this.drd,"showHideAudioSettingsPane"));
this.ia.ra(L.a.JJb,nc.a.application,Object(F.a)(this,this.JJb,"queryShowHideAudioSettingsPane"),96)}Ee(){}drd(a,b,c){return b.contextId===nc.a.application&&this.fHa?1===c?32:Pg.a("AudioSettingsPaneToggle",a,()=>{(this.Eb=!this.Eb)?(this.Ql(),this.lO.P9h(Object(F.a)(this,this.H2g,"onAudioDevicesChanged")),va.a.J(592447296,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.lO.vZk(Object(F.a)(this,this.H2g,"onAudioDevicesChanged")),this.YK(),va.a.J(592447266,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));
return 32}):2}JJb(a,b,c,f,l){if(!Object(Ya.a)(Xh.a,l))return 8;l.Lf(this.Eb);return 32}Ql(a=!1){a||this.yC();const b=Object.assign(new nu.a,{title:ResourceStrings.L_AudioSettings,hideHeader:!1,width:320,location:2,contentProps:this.jM,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.nE.a9(Lb.a.dCa,Lb.a.hj,c,()=>{this.zA(!0)},()=>{this.zA(!1)});sj.UISurfaces.zr().then(f=>{a?this.Eb&&f.updateTaskPane(Lb.a.dCa,b):f.showTaskPane(Lb.a.dCa,
b);return null}).catch(f=>{va.a.J(592447264,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}YK(){sj.UISurfaces.zr().then(a=>{a.hideTaskPane(Lb.a.dCa,2);return null}).catch(a=>{va.a.J(592447262,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}yC(){this.jM=Object.assign(new LM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.Flj(),availableSubtitleLanguages:this.rmj(),onMicrophoneUpdated:Object(F.a)(this,this.fGl,"updateMicrophone"),
onSpeakersUpdated:Object(F.a)(this,this.zHl,"updateSpeaker"),onSpokenLanguageUpdated:Object(F.a)(this,this.CHl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(F.a)(this,this.IHl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.lO.enumerateDevices(Object(F.a)(this,this.pkc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.aZa,"onDevicesFailure"),Object(F.a)(this,this.lZa,"onUnsupported"))}zA(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");
a&&b&&b.focus()}pkc(a){if(0!==a.length)if(ha.a.Wa(a[0].label))this.lO.requestPermission(Object(F.a)(this,this.pyk,"onRequestPermissionSuccess"),Object(F.a)(this,this.aZa,"onDevicesFailure"),Object(F.a)(this,this.lZa,"onUnsupported")),va.a.J(592447260,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Ka.a,c=new Ka.a;for(const f of a)ha.a.Wa(f.deviceId)||(a=Object.assign(new pu,{key:f.deviceId,text:ha.a.Wa(f.label)?f.deviceId:f.label}),"audiooutput"===
f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.jM.deviceMicrophones=b.toArray();this.jM.deviceSpeakers=c.toArray();this.jM.disableDeviceDropdown=!1;this.jM.showDeviceErrorMessage=!1;this.Ql(!0)}}pyk(){this.lO.enumerateDevices(Object(F.a)(this,this.pkc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.aZa,"onDevicesFailure"),Object(F.a)(this,this.lZa,"onUnsupported"));va.a.J(592447258,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}aZa(a){this.jM.disableDeviceDropdown=
!0;this.jM.showDeviceErrorMessage=!0;this.Ql(!0);va.a.J(592447256,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}lZa(){this.jM.disableDeviceDropdown=!0;this.Ql(!0);va.a.J(592447254,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",B.a.Wy)}fGl(a){this.lO.microphoneDeviceId=a.key;va.a.J(592447252,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}zHl(){va.a.J(592447250,833,
50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}H2g(a,b){b.Lmk&&this.lO.enumerateDevices(Object(F.a)(this,this.pkc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.aZa,"onDevicesFailure"),Object(F.a)(this,this.lZa,"onUnsupported"))}Flj(){const a=new Ka.a;for(let b of this.Hc.K0e)a.add(Object.assign(new pu,{key:b,text:Xa.a.xe(b).displayName,selected:this.Hc.Zoa.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new pu,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new pu,
{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,itemType:2}));for(let b of this.Hc.J0e)a.add(Object.assign(new pu,{key:b,text:Xa.a.xe(b).displayName,selected:this.Hc.Zoa.toLowerCase()===b.toLowerCase()}));return a.toArray()}rmj(){const a=new Ka.a;for(let b of this.Hc.t_e)a.add(Object.assign(new pu,{key:b,text:Xa.a.xe(b).displayName,selected:this.Hc.xza.toLowerCase()===b.toLowerCase()}));return a.toArray()}CHl(a){this.Hc.Zoa=a.key;va.a.J(592447248,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}IHl(a){this.Hc.xza=
a.key;this.Hc.Nlb=this.Hc.qVc();va.a.J(592447246,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(n.a)(MM,"AudioSettingsPaneActor",null,[365]);class NM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(n.a)(NM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Nv{constructor(a,b,
c,f,l,w,H,U,ja,wa){this.xFg=!1;a.loadScript("powerpoint-discoverability-strings").then(()=>{this.xFg=!0;va.a.J(591971352,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Sa=>{va.a.J(591971350,801,10,"Failed to load powerpoint-discoverability-strings "+Sa.toString())});this.ia=b;this.Lc=c;this.oc=f;this.qe=l;this.nE=w;this.Hc=H;this.lO=U;this.dck=wa;this.Zhk=ja;this.gUg=ui.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.Nec=!1;this.Lc.m6a(Object(F.a)(this,this.Cfa,
"onRibbonTabSwitched"))}dispose(){this.Lc.Qoc(Object(F.a)(this,this.Cfa,"onRibbonTabSwitched"))}wb(){this.ia.ya(L.a.Grc,nc.a.application,Object(F.a)(this,this.Grc,"showCaptionDiscoverabilityPane"))}Ee(){}Grc(a,b,c){if(b.contextId!==nc.a.application||!this.xFg)return 2;if(1===c)return 32;if(Nv.Kke||Nv.J0d||!this.MWi()||!this.LWi())return 8;this.Nec||this.csi(a);return 32}csi(a){Pg.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.Nec=!0;this.lO.enumerateDevices(Object(F.a)(this,
this.qsk,"onAudioInputAvailable"),Object(F.a)(this,this.aZa,"onDevicesFailure"),Object(F.a)(this,this.lZa,"onUnsupported"));return 32})}qsk(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.Zhk.vbb()){Nv.Kke=!0;this.Ql();break}this.Nec=!1}}aZa(a){this.Nec=!1;va.a.J(591538019,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}lZa(){this.Nec=!1;va.a.J(591538017,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",
B.a.Wy)}Ql(){const a=this.yC(),b=Object.assign(new nu.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{va.a.J(591538015,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{va.a.J(591738121,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.nE.a9(Lb.a.tQa,Lb.a.hj,null,()=>{},()=>{});sj.UISurfaces.zr().then(c=>{c.showTaskPane(Lb.a.tQa,b);return null}).catch(c=>{va.a.J(591971348,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",
c.toString())})}Cr(){sj.UISurfaces.zr().then(a=>{a.hideTaskPane(Lb.a.tQa,2);return null}).catch(a=>{va.a.J(591971346,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}yC(){return Object.assign(new NM,{podiumPresentationImageUrl:this.qe.rk("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.gUg,onTurnOnButtonClicked:Object(F.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(F.a)(this,this.onDismissButtonClicked,
"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(F.a)(this,this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){Pg.a("CaptionDiscoverabilityPaneTurnOn",L.a.bMa,()=>{let a=8;this.Hc.Lh||(a=this.ia.La(L.a.bMa,2,{}));this.dck&&8!==a||this.Cr();return a})}onDismissButtonClicked(){this.gUg&&(Nv.J0d=!0,va.a.J(591738117,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Cr()}onLaunchSlideShowButtonClicked(){Pg.a("CaptionDiscoverabilityPaneLaunchSlideshow",
L.a.yNb,()=>{this.Cr();return this.ia.processAction(L.a.yNb,2)})}Cfa(a,b){2!==b.Iu&&3!==b.Iu&&4!==b.Iu||!b.qfa||"SlideShow"!==b.qfa||Pg.a("OnRibbonTabSwitched",L.a.Grc,()=>this.ia.processAction(L.a.Grc,2))}LWi(){let a=0,b=!1,c=!1;for(var f of this.oc.twb()){if(f.jn){b=!0;break}if(f.GEa&&(a+=f.jQ.length,4<=a))break;if(f.W$a){c=!0;break}}f=c||b||4<=a;va.a.J(591738113,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",
f.toString(),a.toString(),b.toString(),c.toString());return f}MWi(){return!this.Hc.Lh&&this.tWi()}tWi(){const a=Xa.a.xe(u.AFrameworkApplication.lcid);return!a||ha.a.Wa(a.name)?!1:a.name.toLowerCase()===this.Hc.Zoa}static get Kke(){var a=ui.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));return 14>(+b-+a)/864E5}static set Kke(a){ui.a.aK("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),ui.a.FJ)||va.a.J(591971344,822,
10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get J0d(){const a=ui.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set J0d(a){ui.a.aK("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),ui.a.FJ)||va.a.J(591971342,822,10,"Failed to set cookie for discoverability opt out to {0}",a.toString())}}Object(n.a)(Nv,"CaptionDiscoverabilityPaneActor",null,[365]);var OM=d(734);class ht{constructor(a,b){this.id=a;this.version=
b}}Object(n.a)(ht,"PackageAccessKey",null,[]);const Ov=a=>a?Jc.c({["I"]:a.id,["V"]:a.version}):null;var Ep=d(332),PM=d(961);class Yx extends PM.a{constructor(a,b,c){super(a,b);this.Gaa=c}}Object(n.a)(Yx,"ClipServiceShapeCopyParams",PM.a,[]);var BE=d(682),CE=d(716),DE=d(446);class Zx{constructor(a,b,c){this.ia=a;this.Fa=b;this.PHa=c}mQ(a){a=Zx.N5b(a);return this.PHa.z9b(this.Fa)&&!!a&&!!a.src}paste(a){u.AFrameworkApplication.PQ?DE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,
null):this.ia.La(L.a.Qlc,2,a)}static N5b(a){if(!a||!a.Bm)return va.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),null;a=a.Bm.getElementsByTagName(gf.a.Z8);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(n.a)(Zx,"ImagePasteHandler",null,[1207]);var zm=d(434);class EE{constructor(){this.Ach=this.U0d=null}}Object(n.a)(EE,"PasteSlideAsImageData",null,[]);class FE{constructor(){this.pastedContent=this.yxa=null}}Object(n.a)(FE,"PasteSlideAsImageFromRibbonData",
null,[]);var GE=d(686);class HE extends Sys.EventArgs{constructor(a,b,c){super();this.Jp=a;this.fri=b;this.gri=c}}Object(n.a)(HE,"UpdateCcpInfoEventArgs",Sys.EventArgs,[]);class QM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(n.a)(QM,"CopiedShape",null,[]);class RM{constructor(){this.Cid=this.Sid=0}}Object(n.a)(RM,"CopiedSlide",null,[]);class IE extends qh.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=
null}Zk(){return 65}}Object(n.a)(IE,"CopyRequest",qh.a,[]);class $x{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag){this.yye=this.Mva=null;this.ia=a;this.mO=f;this.Fa=l;this.fc=w;this.ua=H;this.Jb=U;this.WL=Cc;this.wi=ja;this.Vb=wa;this.zx=Sa;this.zGa=eb;this.Fb=ub;this.Zj=Ub;this.la=b;this.pa=cc;this.Cug=Fc;this.fek=Ud;this.Ge=Ic;this.Tb=je;this.gek=Vd;this.Nr=Ve;this.fAe=this.la.lmg;this.wBe=this.la.Rmh;this.Es=af;this.Cc=Zf;this.pB=lg;this.Lv=Tg;this.nJg=
Ug;this.NL=ag;if(!this.pB)throw va.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");}wb(){this.ia.ra(L.a.PXd,nc.a.application,Object(F.a)(this,this.Ksj,"handleCopySlidesToClipService"),0);this.ia.ra(L.a.Xhd,nc.a.application,Object(F.a)(this,this.Xbe,"handlePasteSlidesFromClipService"),4);this.ia.ra(L.a.Rlc,nc.a.application,Object(F.a)(this,this.uvj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.ra(L.a.hIb,nc.a.application,
Object(F.a)(this,this.vvj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.ra(L.a.xOe,nc.a.application,Object(F.a)(this,this.Vjd,"queryPasteOptions"),97);this.ia.ra(L.a.KJf,nc.a.application,Object(F.a)(this,this.Jsj,"handleCopyShapesToClipService"),0);this.ia.ra(L.a.G$g,nc.a.application,Object(F.a)(this,this.rvj,"handlePasteShapesFromClipService"),4);this.ia.ra(L.a.I$g,nc.a.application,Object(F.a)(this,this.Wbe,"handlePasteSlideFromDesktop"),4);this.ia.ra(L.a.Whd,nc.a.application,
Object(F.a)(this,this.svj,"handlePasteSlideAsImage"),4);this.ia.ra(L.a.H$g,nc.a.application,Object(F.a)(this,this.tvj,"handlePasteSlideAsImageFromRibbon"),4);this.ia.ra(L.a.UMf,nc.a.application,Object(F.a)(this,this.Lsj,"handleCutShapes"),4);this.ia.ra(L.a.P2d,nc.a.application,Object(F.a)(this,this.P2d,"expandPasteFloatieMenu"),96);this.ia.ra(L.a.VMf,Cb.a.application,Object(F.a)(this,this.Msj,"handleCutSlides"),4);this.ia.ra(L.a.L$g,Cb.a.application,Object(F.a)(this,this.kvj,"handlePasteCancelledByUser"),
2048)}Ee(){}tvj(a,b,c,f,l){va.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(qa.a)(FE,l);if(!a||!a.yxa)return va.a.J(512356639,826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===c)return 32;c=a.yxa.Wb;b=this.Cc.hP(2,1,"HandlePasteSlideAsImageFromRibbon");this.Cc.$h("PasteSlideAsImageFromRibbon",c,b);a.yxa.Wb=b;this.pB.paste(a.yxa,a.pastedContent,!0);return 32}svj(a,b,c,f,l){a=Object(qa.a)(EE,l);if(!a||!a.U0d)return va.a.J(512356638,
826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.pB.Whd(a.U0d,a.Ach);return 32}P2d(a,b,c){if(1===c)return 32;this.fek.oPk();return 32}Vjd(a,b,c,f,l){if(!this.Nr||!this.Nr.whb)return 8;a=this.Nr.whb.AA;l.SourceControlId&&("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[Vh.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[Vh.a.On]=null!=a&&a));return 32}vvj(a,b,c,f){if(1===c)return 32;const l=this.Nr.whb;if(!l)return 8;
const w=l.Du,H=l.zM;if(!w&&!H)return 8;if(null!=l.AA&&l.AA)return 32;l.Wb=this.Cc.hP(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");l.AA=!0;const U=this.Tb.ZA(this.Nr.DKe);va.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");if(H)return H.skipUndo=!0,H.selectionSlide=U,this.Wbe(a,b,c,f,l);w.skipUndo=!0;w.selectionSlide=U;return this.Xbe(a,b,c,f,l)}uvj(a,b,c,f){if(1===c)return 32;const l=this.Nr.whb;if(!l)return 8;const w=l.Du,H=l.zM;if(!w&&
!H)return 8;if(null!=l.AA&&!l.AA)return 32;l.Wb=this.Cc.hP(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.AA=!1;const U=this.Tb.ZA(this.Nr.DKe);va.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(H)return H.skipUndo=!0,H.selectionSlide=U,this.Wbe(a,b,c,f,l);w.skipUndo=!0;w.selectionSlide=U;return this.Xbe(a,b,c,f,l)}Jsj(a,b,c,f,l){a=Object(qa.a)(Yx,l);if(!a)return va.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.Du;
c=a.Gaa;if(!b||!c||!c.length)return va.a.J(512356634,307,50,"Copied shapes are empty."),this.Cc.Hg(!1,a.Wb,23),8;if(this.fc.zUa())return this.Cc.Hg(!1,a.Wb,2),16;if(Qa.a.any(c,H=>H.d4))return va.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];for(var w of c)f.push(Object.assign(new QM,{Sid:w.slideSid,Cid:w.slideCid,ShapeId:w.get_shapeId()}));w=Object.assign(new IE,{CcpId:b.Jp,Location:b.location,Shapes:f,CcpCorrelation:a.Wb,PackageAccessKey:Ov(new ht(a.Du.Cy,
b.version))});this.wPc(w,2,a.Wb);return 32}rvj(a,b,c,f,l){b=Object(qa.a)(zm.a,l);if(!b)return 8;3!==b.Du.dataType?this.Cc.NB(2,b.Wb):(this.Cc.NB(7,b.Wb),this.Cc.Lw(5,b.Wb));c=b.Du;if(!c)return this.Cc.Hg(!1,b.Wb,16),va.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),8;3!==b.Du.dataType&&this.Cc.Lw(CE.ClipboardHelper.Shg(c)?2:3,b.Wb);f=this.ua.Ba;if(!f||!f.isConnected)return this.Cc.Hg(!1,b.Wb,3),va.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",
f?"not null":"null"),16;if(this.fc.$c(f))return this.Cc.Hg(!1,b.Wb,3),va.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),2;if(!this.Zj.OF(f,c.objectCount))return this.Cc.Hg(!1,b.Wb,8),va.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),this.Zj.mG(f),16;this.NOd(c.Jp,b.Wb);Rc.a.Cza("PasteShapesFromClipService",!0);Rc.a.nP(!1,!1);this.yye&&this.yye===c.Jp||(this.Mva=new qd.a(0));f.vN=
c.Jp;f.aQ=c.location;f.d3=c.tD;f.WZ=$x.F2e(c.Qsa);f.Cy=Ov(new ht(c.Cy,c.version));l=null;this.Cc.$$b(b.Wb)&&(l=Zx.N5b(b));if(this.wBe&&3===b.Du.dataType)try{let w=0;this.Mva&&this.Mva.Gb(f.Cb)&&(w=this.Mva.ga(f.Cb));this.fc.XSd(f,a,w);va.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(w){va.a.J(512356627,307,10,"HandlePasteShapesFromClipService: failed to show shimmer view")}this.zGa.sJi(f,c,this.Mva,a,b.Wb,l);this.yye=c.Jp;this.Cc.Hg(!0,b.Wb);return 32}Lsj(a,
b,c,f,l){if(this.fc.zUa())return 16;if(1===c)return 32;Rc.a.nP(!0,!0);const w=this.pa.tg();b=this.pa.uk();var H=f=c=null;let U=[];l=Object(qa.a)(Yx,l);if(!l)return 8;if(l.Du){var ja=l.Du;U=l.Gaa;if(!U||!U.length)return 8;c=ja.Jp;H=ja.version;f=ja.location;H=Ov(new ht(ja.Cy,H))}else for(ja of w)ja.I0c&&U.push(ja);for(var wa of U)if(wa.If||wa.Og){on(wa);break}wa=this.Jb.Ad(15,void 0,()=>{this.pa.Rh()});try{wa.nc(b),wa.jd=a,this.Cug.Sfh(new HE(c,f,H)),b.Wb=l.Wb,b.PU(U)}finally{wa&&wa.dispose()}for(const Sa of U)this.Es.Afh(new jK.a(Sa));
this.mO.One=c;return 32}Msj(a,b,c,f,l){b=this.pa.Qe();if(!b||!b.length||!this.ua.Ba)return 16;for(var w of b)if(!w||this.fc.$c(w)||!w.isConnected)return 16;if(1===c)return 32;Rc.a.Ib&&(Rc.a.Ib.actionName="CutSlide",Rc.a.Ib.Ur=!1,Rc.a.Ib.Oj=!0,Rc.a.Ib.tF=new Date,Rc.a.Ib.Va("SlideCount",b.length.toString()));f=w=c=null;var H=[];l=Object(qa.a)(BE.a,l);if(!l)return 8;if(l.Du){f=l.Du;H=l.Nxh;if(!H||!H.length)return 8;c=f.Jp;H=f.version;w=f.location;f=Ov(new ht(f.Cy,H))}H=this.Vb.xf;if(!H)return 16;const U=
this.Jb.Ad(15,void 0,()=>{this.pa.Rh()});try{this.Cug.Sfh(new HE(c,w,f));U.nc(H);for(const ja of b)ja&&!ja.Cb.equals(this.ua.Ba.Cb)&&H.zI(ja);H.zI(this.ua.Ba);U.jd=a;H.Wb=l.Wb}finally{U&&U.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.fc.hw(H,a);this.Es?this.Es.$kd(new GE.a(b)):va.a.J(512356626,826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.mO.One=c;return 32}wPc(a,b){this.mO.xsk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",
Ep.a.type,OM.a(b))];Rc.a.Ak("CcpId",a.CcpId);c=new hg.a(a,()=>{this.Gtk(a)},f=>this.Ftk(f,a,b),f=>0===f.StatusCode,void 0,c);va.a.J(512356625,307,50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.wi.Db(c)}Gtk(a){this.mO.k2g(!0,a)}Ftk(a,b,c){va.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",OM.a(c),b.CcpId,a.StatusCode));this.mO.k2g(!1,b);return!0}NOd(a,b){const c=Rc.a.Ib;c&&(c.Va("CcpId",a),this.Cc.$h("CcpId",a,b))}Ksj(a,b,c,f,l){a=
Object(qa.a)(BE.a,l);if(!a||!a.Du)return va.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",a?"not null":"null"),8;va.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.Du.Jp);b=a.Nxh;if(!b||!b.length||0>=dk.e(b,w=>Object(Ya.a)(116,w)).length)return va.a.J(512356621,307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(Qa.a.any(b,w=>w.hasDeferredContent))return va.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),
8;b=Object.assign(new IE,{CcpId:a.Du.Jp,Location:a.Du.location,MultiSlideCopy:!0,Slides:dk.c(b,w=>Object.assign(new RM,{Sid:w.sid,Cid:w.cid})),CcpCorrelation:a.Wb,PackageAccessKey:Ov(new ht(a.Du.Cy,a.Du.version))});this.wPc(b,1,a.Wb);return 32}Wbe(a,b,c,f,l){if(1===c)return 32;b=Object(qa.a)(zm.a,l);if(!b)return va.a.J(512356619,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.zM;if(!c||ha.a.Wa(c.ccpid)||ha.a.Wa(c.data))return va.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",
c?c.ccpid:"null")),this.Cc.Hg(!1,b.Wb,28),8;Rc.a.Cza("PasteSlideFromDesktop",!0);this.NOd(c.ccpid,b.Wb);this.Cc.Lw(12,b.Wb);f={};f.CcpCorrId=b.Wb;return this.Nag(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.AA?b.AA:!0,c.ccpid,null,null,u.AFrameworkApplication.userSessionId,0,f,c.data,c.isDataCompressed)}Xbe(a,b,c,f,l){if(1===c)return 32;b=Object(qa.a)(zm.a,l);if(!b)return va.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Rc.a.Cza("PasteSlidesFromClipService",
!0);c=b.Du;if(!c)return this.Cc.Hg(!1,b.Wb,16),va.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.Cc.Lw(CE.ClipboardHelper.Shg(c)?2:3,b.Wb);this.NOd(c.Jp,b.Wb);f=this.zx.Lje(c);return!this.la.fmg&&f?(this.Cc.Hg(!1,b.Wb,17),va.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.Nag(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.AA?b.AA:!0,c.Jp,c.location,c.tD,c.Cy,c.version,c.Qsa,
null,!1)}Nag(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){this.Cc.NB(19,a.Wb);const cc=this.ua.presentation;if(!cc)return this.Cc.Hg(!1,a.Wb,3),va.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.fc.$c(cc))return this.Cc.Hg(!1,a.Wb,3),va.a.J(512356615,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var Fc=this.ua.Ba;if(Fc&&!Fc.isConnected)return this.Cc.Hg(!1,a.Wb,3),va.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),
16;va.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),w.toString()));this.fAe&&!this.zx.Bhg(a)&&this.gek.u8h();this.Nr.J1c=Date.now();this.WL.aX(this.Tb.$m)&&va.a.J(512356612,307,50,"cross session paste slide happened before last action server result is not returned");Rc.a.nP(!1,!1);let Ic;var Cc=null;Fc=this.la.Frd&&!ha.a.Wa(ub)&&1!==this.Fb.Fl;if(c)Cc=f,Ic=null;else{Cc=this.ua.presentation;if(!Cc)throw Error.argumentNull("Presentation is null");
Ic=Array.isArray(Cc.ULf(l,a.Wb,Fc))?Cc.ULf(l,a.Wb,Fc):null;f=Cc=this.sgj();this.Nr.position=null;this.Nr.DKe=Cc?Cc.slideIndex:0}l=null;c||(l=()=>{let Ud;(Ud=this.pa).MR.apply(Ud,Ic)});l=this.Jb.Ad(15,void 0,()=>{this.Fa.rf(Lb.a.YE)},l);try{if(l.nc(cc),l.jd=c?cc.Hbb?L.a.hIb:L.a.Rlc:b,Fc?(cc.mua=!0,this.Lv.init(H)):(cc.vN=H,cc.Hbb=w,cc.BKe=Cc?Cc.Cb:null,cc.aQ=U,cc.d3=ja,cc.WZ=$x.F2e(eb),cc.skipUndo=c,cc.Cy=Ov(new ht(wa,Sa)),cc.$zb=null==Ub?!1:Ub,cc.Slc=ub,cc.Wb=a.Wb),!c){U=Cc;for(ja=0;ja<Ic.length;ja++)this.la.Ln?
cc.uab(Ic[ja],U,null,!0):cc.uab(Ic[ja],U,null),U=Ic[ja],Fc&&(Ic[ja].mua=!0,this.Lv.wka.add(Ic[ja].id));this.Vb.Ba=Ic[Ic.length-1];this.Ge.x8a=!0}}finally{l&&l.dispose()}Fc?(this.Lv.Tud(!0),this.fc.blockContent(cc,b)):this.fc.hw(cc,b);this.Nr.whb=a;this.Nr.Ckb=!0;this.Nr.GJa=null;this.Ge.x8a=!0;this.Nr.e2b=this.Tb.$m.cK;Fc&&(this.Cc.$h("DisplayNewPasteProgressUX","true",a.Wb),this.tKi(ub,u.AFrameworkApplication.userSessionId,Cc,c,w,H,eb,Ub,a.Wb));this.Cc.Hg(!0,a.Wb);return 32}tKi(a,b,c,f,l,w,H,U,ja){const wa=
this.Cc.hP(2,0,"DataUploadInit");this.Cc.Lw(13,wa);this.Cc.NB(19,wa);this.Cc.$h("DataUploadInitOldCcpCorrId",ja,wa);this.Lv.mEl(wa);const Sa=(new Date).getTime();this.nJg.gsl(a,b,w,()=>{const eb=(new Date).getTime()-Sa;va.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",w,eb);this.Cc.$h("DataUploadTime",eb.toString(),wa);this.sKi(wa,b,c,f,l,w,H,U)},eb=>{va.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",
w,Ne.a[eb.error.Code],(new Date).getTime()-Sa);this.Nsj();this.Cc.Hg(!1,wa,30)})}sKi(a,b,c,f,l,w,H,U){const ja=this.ua.presentation;if(ja){this.Lv.yqk();Rc.a.nP(!1,!1);va.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Lv.wka.toArray().join(",").toString());var wa=this.Jb.Ad(15);try{wa.nc(ja),wa.jd=L.a.hIb,ja.BKe=c?c.Cb:null,ja.e0b=b,ja.Tlc=this.Lv.wka.toArray().join(",").toString(),ja.vN=w,ja.WZ=$x.F2e(H),ja.skipUndo=f,ja.$zb=null==U?!1:U,ja.Hbb=l,ja.Wb=a}finally{wa&&wa.dispose()}this.Cc.Hg(!0,
a)}else va.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}kvj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return va.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;va.a.J(512356578,307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.nJg.Qqi(a);this.Cc.Hg(!1,l,31);return 32}Nsj(){this.Lv.hEf(!0);this.NL.kga(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,20)}oql(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}sgj(){const a=this.pa.Qe();return 0<a.length&&(this.oql(a),a[0])?a[0]:this.ua.Ba}static F2e(a){return JSON.stringify(a)}}Object(n.a)($x,"ClipServiceActor",null,[365]);class JE{constructor(){this.actionId=0;this.context=null;this.behavior=0;this.rd=this.UJ=null}}Object(n.a)(JE,"AActionArgs",null,[]);class KE extends JE{constructor(){super()}}Object(n.a)(KE,"ActionArgs$2",JE,[]);class LE extends KE{constructor(){super()}}
Object(n.a)(LE,"ActionArgs$1",KE,[]);var Iq=d(393),qu=d(386);class it{constructor(a,b=!1){this.jig=!0;this.Wb=null;this.dataType=0;this.JWi=a;this.Lda=b}}Object(n.a)(it,"CutCopyParams",null,[]);var Pv=d(445),SM=d(444);class gA{constructor(a,b,c,f){this.ia=a;this.mck=f;this.PHa=c;this.Fa=b}mQ(a){return this.PHa.z9b(this.Fa)&&!!gA.D2f(a)}paste(a){this.mck?DE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(va.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),
this.ia.La(L.a.zxa,2,a))}static D2f(a){return a&&a.Bm?(a=a.Bm.getElementsByTagName(gf.a.fOb))&&a.length?a[0]:null:null}}Object(n.a)(gA,"TablePasteHandler",null,[1207]);class Xk{static get FA(){return Ab.a.instance.rb("PowerPointWebEditor.ISystemClipboard")}}Object(n.a)(Xk,"SystemClipboardFactory",null,[]);class TM{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di,Si,rj){this.Mva=this.j8c=null;this.Kxg=0;this.Y7c=!1;this.Gwj=(sg,Cg,sh,vk,Ni)=>{if(1===
sh)return 32;sg=this.FIa.S_;Ni&&Ni.SourceControlId&&("PasteAsPlainText"==Ni.SourceControlId?Ni[Vh.a.On]=sg===D.a.O5||sg===D.a.f_a||sg===L.a.pasteAsPlainText:"PasteTextKeepingSourceFormatting"==Ni.SourceControlId&&(Ni[Vh.a.On]=sg===D.a.d8||sg===D.a.paste||sg===D.a.reformatPastedContent||sg===L.a.wxa));return 32};this.Avj=(sg,Cg,sh)=>{if(2==sh){sg=this.FIa.S_;if(sg===D.a.O5||sg===D.a.f_a)return 32;this.ia.processAction(D.a.f_a,sh)}return 32};this.zvj=(sg,Cg,sh)=>{if(2==sh){sg=this.FIa.S_;if(sg===D.a.d8||
sg===D.a.paste||sg===D.a.reformatPastedContent)return 32;this.ia.processAction(D.a.reformatPastedContent,sh)}return 32};this.Jwj=(sg,Cg,sh)=>{if(1==sh)return 32;if(2==sh){if(this.FIa.S_===L.a.pasteAsPlainText)return 32;this.zuf(sg);this.xt.undo()}return 32};this.Kwj=(sg,Cg,sh)=>{if(1==sh)return 32;if(2==sh){if(this.FIa.S_===L.a.wxa)return 32;this.zuf(sg);this.xt.undo()}return 32};this.voh=(sg,Cg)=>{sg=Cg.node;null!=sg&&sg==this.IDb&&(this.IDb=sg,this.DGg=Cg.revisionId.toString())};this.Foh=(sg,Cg)=>
{Cg&&Cg.revisionId&&(this.t8c=Cg.revisionId.toString())};this.eEh=(sg,Cg)=>{Cg.MH&&Cg.MH.Id&&Cg.MH.Id==this.t8c&&(this.Bcb.i9(this.Vb.xf)||setTimeout(()=>{this.ia.processAction(L.a.pasteAsPlainText,2);this.Wih(L.a.poc);this.t8c=null},0))};this.fEh=(sg,Cg)=>{Cg.MH&&Cg.MH.Id&&Cg.MH.Id==this.t8c&&(this.Bcb.i9(this.Vb.xf)||setTimeout(()=>{this.ia.processAction(L.a.wxa,2);this.Wih(L.a.qoc);this.t8c=null},0))};this.z_g=(sg,Cg)=>{Cg.MH&&Cg.MH.Id&&this.DGg==Cg.MH.Id&&(null==this.IDb||this.Bcb.i9(this.IDb)||
setTimeout(()=>{this.ia.processAction(L.a.H6a,2);this.xgc.MPe(new Vi(1,u.AFrameworkApplication.isRtl));this.DYk();this.DGg=this.IDb=null},0))};if(!Ug)throw Error.argumentNull("DeferredContentManager");if(U.ka("IsPasteTextFloatieEnabled")){if(!ih)throw Error.argumentNull("pasteFloatieEventSource");if(!Vg)throw Error.argumentNull("coldHotManager");if(!di)throw Error.argumentNull("shapeGraphNodeEventHandlers");if(!Si)throw Error.argumentNull("graphOperationEventHandler");if(!rj)throw Error.argumentNull("undoManager");
}this.ia=a;this.Fa=b;this.pa=c;this.Vg=ub;this.fc=wa;this.Yla=Sa;this.pB=eb;this.Vb=f;this.kq=l;this.Bw=Ug;this.Jb=w;this.hA=H;this.Jq=ja;this.zGa=Ub;this.Tb=cc;this.Sk=Fc;this.Fb=Ic;this.Iwg=Cc;this.xcb=Ud;this.Zj=je;this.WT=Vd;this.MWa=af;this.zb=Zf;this.a$=lg;this.Cc=Tg;this.la=U;this.FIa=ag;this.xgc=ih;this.Bcb=Vg;this.Ihc=di;this.Yf=Si;this.xt=rj}wb(){this.la.$Yc?(this.ia.ra(L.a.Bub,nc.a.application,Object(F.a)(this,this.W$f,"handleCutCopyToSystemClipboardAsync"),4),this.ia.ra(L.a.n1b,nc.a.application,
Object(F.a)(this,this.W$f,"handleCutCopyToSystemClipboardAsync"),0),this.ia.ra(L.a.wxa,nc.a.application,Object(F.a)(this,this.H7b,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(L.a.CJa,nc.a.application,Object(F.a)(this,this.H7b,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(L.a.DJa,nc.a.application,Object(F.a)(this,this.H7b,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(L.a.sZa,nc.a.application,Object(F.a)(this,this.H7b,"handlePasteFromSystemClipboardAsync"),4),this.la.ka("IsPasteTextFloatieEnabled")&&
this.ia.ra(L.a.pasteAsPlainText,nc.a.application,Object(F.a)(this,this.H7b,"handlePasteFromSystemClipboardAsync"),4)):(this.ia.ra(L.a.Bub,nc.a.application,Object(F.a)(this,this.V$f,"handleCutCopyToSystemClipboard"),4),this.ia.ra(L.a.n1b,nc.a.application,Object(F.a)(this,this.V$f,"handleCutCopyToSystemClipboard"),0),this.ia.ra(L.a.wxa,nc.a.application,Object(F.a)(this,this.G7b,"handlePasteFromSystemClipboard"),4),this.ia.ra(L.a.CJa,nc.a.application,Object(F.a)(this,this.G7b,"handlePasteFromSystemClipboard"),
4),this.ia.ra(L.a.DJa,nc.a.application,Object(F.a)(this,this.G7b,"handlePasteFromSystemClipboard"),4),this.ia.ra(L.a.sZa,nc.a.application,Object(F.a)(this,this.G7b,"handlePasteFromSystemClipboard"),4),this.la.ka("IsPasteTextFloatieEnabled")&&this.ia.ra(L.a.pasteAsPlainText,nc.a.application,Object(F.a)(this,this.G7b,"handlePasteFromSystemClipboard"),4));this.ia.ra(L.a.JJf,nc.a.application,Object(F.a)(this,this.Isj,"handleCopyShapes"),0);this.ia.ra(L.a.Uhd,Cb.a.application,Object(F.a)(this,this.qvj,
"handlePasteShapes"),4);this.ia.ra(L.a.Qlc,nc.a.application,Object(F.a)(this,this.pvj,"handlePastePicture"),4);this.ia.ra(L.a.zxa,Cb.a.application,Object(F.a)(this,this.xvj,"handlePasteTable"),4);this.ia.ra(L.a.Vhd,nc.a.application,Object(F.a)(this,this.wvj,"handlePasteSlides"),4);this.ia.ra(L.a.GKe,nc.a.application,Object(F.a)(this,this.yvj,"handlePasteTextIntoNewShape"),4);this.ia.aW(L.a.rbh,nc.a.application,Object(F.a)(this,this.esj,"handleBrowserCut"),4);this.ia.aW(L.a.Wid,nc.a.application,Object(F.a)(this,
this.dsj,"handleBrowserCopy"),0);this.ia.aW(L.a.Xid,nc.a.application,Object(F.a)(this,this.fsj,"handleBrowserPaste"),4);this.ia.aW(L.a.Bbh,nc.a.application,Object(F.a)(this,this.nvj,"handlePasteGivenText"),4);this.ia.ra(L.a.t$g,nc.a.application,Object(F.a)(this,this.mvj,"handlePasteContentFromPandora"),4);this.ia.ra(L.a.xxa,Cb.a.application,Object(F.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.ra(L.a.Shd,Cb.a.application,Object(F.a)(this,this.ovj,"handlePasteHtmlAsync"),4);this.ia.ra(L.a.NXd,
Xd.a.frame,Object(F.a)(this,this.lvj,"handlePasteChartAsImage"),4);this.ia.ya(L.a.$Zd,Xd.a.frame,Object(F.a)(this,this.U$f,"handleCutCopyThroughShortcuts"));this.ia.ya(L.a.MJf,Xd.a.frame,Object(F.a)(this,this.U$f,"handleCutCopyThroughShortcuts"));this.ia.ra(L.a.K$g,Xd.a.frame,Object(F.a)(this,this.Bvj,"handlePasteThroughShortcuts"),4);this.la.ka("IsPasteTextFloatieEnabled")&&(this.ia.ra(L.a.Yhd,Xd.a.frame,this.zvj,4),this.ia.ra(L.a.Zhd,Xd.a.frame,this.Avj,4),this.ia.ra(L.a.nPe,Xd.a.frame,this.Gwj,
4),this.ia.ra(L.a.poc,nc.a.application,this.Jwj,4),this.ia.ra(L.a.qoc,nc.a.application,this.Kwj,4))}Ee(){if(Pd.a("ShortcutsFixInMac")&&B.a.eac){const a=[this.Fa.Fc(Zi.a.PD),this.Fa.Fc(Lb.a.sg)];for(const b of a)b.bindAction(x.KeyInputManager.Oa(A.a.Oza,x.KeyInputManager.Oe),L.a.MJf),b.bindAction(x.KeyInputManager.Oa(A.a.X1a,x.KeyInputManager.Oe),L.a.K$g)}}U$f(a){a=L.a.$Zd===a;const b=this.Cc.hP(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.Yla.Fsa(Object.assign(new it(!1,a),{Wb:b}));return 32}Bvj(){const a=
this.Cc.hP(2,0,"OnBrowserPaste");this.pB.paste(Object.assign(new zm.a(!0),{Wb:a}),null,!1);return 32}W$f(a,b,c,f){let l,w;if(!({uF:l,PMc:w}=this.dJf(c,a)).returnValue)return l;if(!Xk.FA)return this.Cc.Hg(!1,w.Wb,1),8;this.Wca(a,b,c,f,!0,w.Wb);return 32}H7b(a,b,c,f){if(1===c)return this.pa.uUa()?2:a===L.a.CJa?2:a===L.a.DJa?this.vkb(!1):a===L.a.sZa?this.vkb(!0):a===L.a.pasteAsPlainText?this.vkb(!1,!0):32;const l=this.Cc.hP(2,1,"HandlePasteFromSystemClipboardAsync");if(this.pa.o9())return this.Cc.Hg(!1,
l,3),16;if(!Xk.FA)return this.Cc.Hg(!1,l,1),8;this.Wca(a,b,c,f,!1,l);Rc.a.nP(!0,!1);return 32}vkb(a,b=!1){va.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.pa.C_()?(va.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.pB.Zri(a,b)?32:2}pQf(a,b){a===L.a.Bub?this.Yla.Fsa(Object.assign(new it(!1,!0),{Wb:b})):a===L.a.n1b?this.Yla.Fsa(Object.assign(new it(!1),{Wb:b})):a===L.a.wxa?this.pB.paste(Object.assign(new zm.a(!1),{Wb:b}),null,!1):a===
L.a.CJa?this.pB.paste(Object.assign(new zm.a(!1),{Wb:b,AA:!1}),null,!1):a===L.a.DJa?this.pB.paste(Object.assign(new zm.a(!1),{Wb:b,AA:!0}),null,!1):a===L.a.sZa?this.pB.paste(Object.assign(new zm.a(!1),{Wb:b,N8a:!0}),null,!1):a===L.a.pasteAsPlainText?this.pB.paste(Object.assign(new zm.a(!1),{Wb:b,d4b:!0}),null,!1):(va.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),this.Cc.Hg(!1,b,5))}Wca(a,b,c,f,l,w){Xk.FA.Wca(l);l=Xk.FA.a6;null!=l&&l?this.pQf(a,w):(a=new ii.a(null,Object(F.a)(this,
this.Q6e,"waitingForEnsureAccessOperationResult"),Object.assign(new LE,{actionId:a,context:b,behavior:c,UJ:f,rd:w})),a.Pl("ClipboardPreProcess"),this.Kxg=Date.now(),a.run())}Q6e(a,b){a=!0;let c=!1;const f=b.rd.toString(),l=Xk.FA.a6,w=Xk.FA.ly;null!=l?(a=!1,l?this.pQf(b.actionId,f):c=!0):Date.now()-this.Kxg>this.la.EFf&&null!=w&&(va.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),a=!1,c=!0);c&&this.Cc.Hg(!1,f,29);return a}V$f(a,
b,c){if(!({uF:a,PMc:b}=this.dJf(c,a)).returnValue)return a;this.Yla.Fsa(b);return 32}dJf(a,b){let c;c=32;const f=L.a.Bub===b;b=new it(!1,f);const l=!!this.Yla&&this.Yla.mQ(b);if(1===a)return c=this.pa.uUa()?2:l?32:16,{returnValue:!1,uF:c,PMc:b};a=this.Cc.hP(f?1:0,1,"HandleCutCopyToSystemClipboard");this.Cc.Lw(1,a);b.Wb=a;return!l||this.fc.zUa()?(this.Cc.Hg(!1,a,2),{returnValue:!1,uF:16,PMc:b}):{returnValue:!0,uF:c,PMc:b}}G7b(a,b,c){if(1===c)return this.pa.uUa()?2:a===L.a.CJa?this.vkb(!1):a===L.a.DJa?
this.vkb(!1):a===L.a.sZa?this.vkb(!0):a===L.a.pasteAsPlainText?this.vkb(!1,!0):32;b=this.Cc.hP(2,1,"HandlePasteFromSystemClipboard");c=this.kq.Ba;if(!c||this.fc.$c(c)||this.pa.o9())return this.Cc.Hg(!1,b,3),16;c=null;let f=!1,l=!1;a===L.a.CJa?c=!1:a===L.a.DJa?c=!0:a===L.a.sZa?f=!0:a===L.a.pasteAsPlainText&&(l=!0);this.pB.paste(Object.assign(new zm.a(!1),{Wb:b,AA:c,N8a:f,d4b:l}),null,!1);return 32}Isj(a,b,c){if(this.fc.zUa())return 16;if(1===c)return 32;a=this.pa.tg();for(const f of a)if(f.If||f.Og){on(f);
break}this.QFl(a);return 32}QFl(a){if(!a||!a.length)this.Mva=this.j8c=null;else if(!this.j8c||!this.Kgi(this.j8c,a)){const b=[];for(const c of a)b.push(c);this.Mva=new qd.a(0);this.Mva.$(b[0].slideId,1);this.j8c=b}}Kgi(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}qkj(a,b,c,f){let l;l=b?b.kxb(110,75):this.Tb.Eta(c.clientWidth,c.clientHeight);a=this.Sk.QYd(a.Cb.cid,a.Cb.sid,!0,l._x,l._y,c.width,c.height,a.Wt()+1,c.src,c.alt&&c.alt.length?c.alt:"image",
f);b&&(a.vca=b.id);return a}pvj(a,b,c,f,l){b=this.kq.Ba;if(!b)return va.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.fc.$c(b)?16:32;if(!l)return 16;this.Cc.NB(5,l.Wb);if(!this.Zj.OF(b,1))return this.Cc.Hg(!1,l.Wb,8),this.Zj.mG(b),16;Rc.a.Cza("PastePicture",!1);f=Zx.N5b(l);if(!f||!f.src)return this.Cc.Hg(!1,l.Wb,10),8;if((c=b.G3(this.pa.Xd()))&&this.fc.$c(c))return this.Cc.Hg(!1,l.Wb,3),16;const w=this.qkj(b,c,f,l.Wb);f=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.Fa.Ed()},()=>
{this.pa.selectShape(w,!0)});try{f.nc(b),f.jd=a,f.Zy[Eq.a.Z7b]=!0,c&&b.PU([c]),b.gC(w)}finally{f&&f.dispose()}this.Cc.Hg(!0,l.Wb);return 32}j5i(){if(!this.kq.Ba)return null;const a=this.kq.Ba.gk();for(const b of a)if(b.xJc)return b;return null}xvj(a,b,c,f,l){b=this.kq.Ba;if(!b)return va.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.fc.$c(b)?32:16;if(!l)return 8;this.Cc.NB(6,l.Wb);if(!this.Zj.OF(b,1))return this.Zj.mG(b),this.Cc.Hg(!1,l.Wb,8),16;const w=this.j5i();if(w){if(this.fc.$c(w))return this.Cc.Hg(!1,
l.Wb,3),16;if(w.VI)return va.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",w.id),this.Cc.Hg(!1,l.Wb,3),32}f=gA.D2f(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&f.getElementsByTagName(gf.a.Jsd).length))return this.Cc.Hg(!1,l.Wb,24),8;c=document.createElement("div");if(!c)return this.Cc.Hg(!1,l.Wb,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.Cc.Hg(!1,l.Wb,24),8;va.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",
f.rows.length,c.length);var H=this.J3f();f=H.x-55;H=H.y-37.5;if(w){b=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()},()=>{this.pa.selectShape(w,!0)});try{b.nc(w),b.jd=a,b.Zy[Eq.a.$7b]=!0,w.Wb=l.Wb,w.vZa=c}finally{b&&b.dispose()}this.fc.hw(w,a)}else c=b.HGi(f,H,b.Wt()+1,c,l.Wb),c.Wb=l.Wb,this.hA.HW([Object(qa.a)(4,c)],Object(qa.a)(116,b),a);this.Cc.Hg(!0,l.Wb);return 32}ovj(a,b,c,f,l){if(1===c)return 32;b=l?Object(qa.a)(SM.a,l):null;if(!b)return va.a.J(512356569,826,50,"Html paste context should not be null."),
8;c=this.kq.Ba;if(!c)return va.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.fc.$c(c))return this.Cc.Hg(!1,b.Wb,3),16;Rc.a.Cza("PasteHtmlAsync",!0);va.a.J(512356567,826,50,"Paste html start");return this.uQf(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.pa.uUa()?2:32;const w=l?Object(qa.a)(SM.a,l):null;if(!w)return va.a.J(512356566,826,50,"Html paste context should not be null"),8;b=this.kq.Ba;if(!b)return va.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.fc.$c(b))return this.Cc.Hg(!1,
w.Wb,3),16;va.a.J(512356564,826,50,"Paste html start");Rc.a.nP(!1,!1);Rc.a.Cza("PasteHtml",!0);Rc.a.Ak(Bh.a.YEk,"Image:"+w.Bda.length.toString()+",Table:"+w.d1a.length.toString()+",Text:"+(w.jV?w.jV.length.toString():"0"));f=this.pa.Xd();a=Iq.a.Jlh(0<w.Bda.length?!0:!1,!1,0<w.d1a.length?!0:!1,!1,this.la.zza,a);if(w.TMb)return va.a.J(512356563,826,50,"Will replace text"),this.Cc.NB(1,w.Wb),a=this.rPi(w,f[0],a),16!==a?this.Cc.Hg(!0,w.Wb):this.Cc.Hg(!1,w.Wb,15),a;va.a.J(512356562,826,50,"Will paste html into new shapes");
if(w.T_c){if(this.la.dmg){const H=Rc.a.Ib;this.zb.Db(new Le.a(2,1,0,()=>{Rc.a.AF(H,()=>{this.ia.La(L.a.Shd,c,w)})},90,"66"));return 64}return this.uQf(w,b,a)}return this.pPi(w,b,f,a)}rPi(a,b,c){if(this.fc.$c(b))return 16;if(a.jV&&0<a.jV.length){va.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.zGa.pUd([b])));if(this.gog(a.jV))return 16;this.fc.hw(b,c);const f=this.Jb.Ad(15);try{b.Wb=a.Wb,f.nc(b),f.jd=c,b.apc=a.jV,Object(Ya.a)(1238,f)&&b.id&&(Object(qa.a)(1238,f).Zy[Eq.a.S$g]=b.id.toString())}finally{f&&
f.dispose()}}return 32}pPi(a,b,c,f){const l=[],w=b.Wt();var H=this.J3f(),U=H.x,ja=H.y;H=0;for(var wa=0;wa<a.d1a.length;++wa)H=this.Sk.RYd(!0,b.cid,b.sid,!1,U,ja,110,75,w+1,a.d1a[wa],a.Wb),l.push(H),H=6;U=a.Bda;ja=1===U.length?0:Iq.a.RS;for(wa=0;wa<U.length;wa++){const Sa=this.Sk.QYd(b.cid,b.sid,!1,ja,ja,U[wa].width,U[wa].height,w+1,U[wa].src,U[wa].alt,a.Wb);l.push(Sa);ja+=Iq.a.RS;H=0===H?5:20}if(a.jV&&0<a.jV.length)if(va.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.zGa.pUd(c))),
!this.gog(a.jV))c=this.Sk.SYd(b.cid,b.sid,w+1,a.jV,a.Wb),l.push(c),H=0===H?1:20;else if(!l.length)return this.Cc.NB(1,a.Wb),this.Cc.Hg(!1,a.Wb,7),16;this.Cc.NB(H,a.Wb);if(0<l.length){if(!this.Zj.OF(b,l.length))return this.Zj.mG(b),this.Cc.Hg(!1,a.Wb,8),16;1===l.length&&a&&this.la.insertVideoWithPasteEnabled?(c=a.jV,this.a$.Iog(c)?(this.Cc.NB(8,a.Wb),va.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.hA.HW(l,b,f),this.a$.eBl(c,Object(F.a)(this,this.zKl,
"videoInsertionFail"))):(this.la.ka("IsPasteTextFloatieEnabled")&&1===H&&(this.Ctf(),this.IDb=l[0],a.oje&&!a.K$b&&(this.FIa.S_=f)),this.hA.HW(l,b,f),this.fc.hw(b,f))):(this.la.ka("IsPasteTextFloatieEnabled")&&1===H&&1===l.length&&a&&(this.Ctf(),this.IDb=l[0],this.FIa.S_=a.K$b?L.a.pasteAsPlainText:L.a.wxa),this.hA.HW(l,b,f),this.fc.hw(b,f));this.Cc.Hg(!0,a.Wb)}else this.Cc.Hg(!1,a.Wb,9);return 32}Ctf(){this.rxe||(this.Ihc.Dia(this.voh),this.Yf.l6a(this.z_g),this.rxe=!0)}zuf(a){this.Y7c||(this.Yf.Mvf(this.Foh),
a===L.a.poc?this.Yf.l6a(this.eEh):a===L.a.qoc&&this.Yf.l6a(this.fEh),this.Y7c=!0)}Wih(a){this.Y7c&&(this.Yf.$jh(this.Foh),a===L.a.poc?this.Yf.Poc(this.eEh):a===L.a.qoc&&this.Yf.Poc(this.fEh),this.Y7c=!1)}DYk(){this.rxe&&(this.Ihc.zKb(this.voh),this.Yf.Poc(this.z_g),this.rxe=!1)}zKl(){va.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}uQf(a,b,c){this.Cc.NB(5,a.Wb);if(Qa.a.Wa(a.Bda))return this.Cc.Hg(!1,a.Wb,10),16;if(!b)return 16;var f=Object(qa.a)(566,
b.sc(this.Fb.Ma));if(!f)return this.Cc.Hg(!1,a.Wb,3),8;var l=Rc.a.Ib;l&&(l.actionName="SinglePicturePaste",l.Ur=!0,l.Oj=!0,l.Va("PreloadImageDuration",a.FKe.toString()));l=a.Bda[0];const w=b.G3(this.pa.Xd());var H=b.Wt();let U,ja;({E3d:ja,mD:U}=this.MWa.ZWd(w,l.width,l.height));H=this.Sk.QYd(b.cid,b.sid,!1,U.x,U.y,ja.width,ja.height,H+1,l.src,l.alt,a.Wb);Rc.a.Ak("ImageSrcSize",l.src.length.toString());f=this.MWa.iTd(this.Fb.Md,ja,U,f.tT);H.SU=f;w&&(H.vca=w.id);H.isResizable=!0;H.v$b=!0;H.FL=!0;H.bJa=
!0;H.hea=l.src;this.hA.HW([H],b,c,null,w);this.Cc.Hg(!0,a.Wb);return 32}gog(a){return 65535<a.length?(va.a.J(512356556,826,50,"Exceed text size limit: {0}",a.length),!0):!1}qvj(a,b,c,f,l){b=this.kq.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(qa.a)(zm.a,l);if(!c)return 8;f=c.WW;if(Qa.a.Wa(f))return this.Cc.Hg(!1,c.Wb,11),8;this.Cc.NB(2,c.Wb);this.Cc.Lw(2,c.Wb);l=this.kq.Ba;if(!l||this.fc.$c(l))return this.Cc.Hg(!1,c.Wb,3),16;Rc.a.Cza("PasteShape",
!1);if(!this.Zj.OF(l,f.length))return this.Zj.mG(l),this.Cc.Hg(!1,c.Wb,8),16;va.a.J(512356555,826,50,"Start Handle paste shapes");var w=Pr.b(f,ja=>ja.shapeNode);this.Bw.uce(w,"HandlePasteShapes");for(var H of f){if(!H||!H.shapeNode.isConnected)return va.a.J(512356554,826,50,"Paste deleted shapes"),this.Iwg.Xrc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.Cc.Hg(!1,c.Wb,12),16;if(this.fc.YN(H.shapeNode))return this.Cc.Hg(!1,
c.Wb,3),16;if(!H.shapeNode.get_shapeId())return this.Cc.Hg(!1,c.Wb,12),16}H=[];for(w=0;w<f.length;w++)H.push(f[w].shapeNode);for(var U of H)if(U.If||U.Og){on(U);break}U=Object(qa.a)(116,b.AC(f[0].shapeNode.slideId));this.zGa.F$g(U,l,H,this.Mva,a,c.Wb);va.a.J(512356553,826,50,({contentType:a}=this.zGa.qUd(H)).returnValue);this.Cc.NB(a,c.Wb);Rc.a.nP(!0,!0);this.Cc.Hg(!0,c.Wb);return 32}lvj(a,b,c,f,l){(a=Object(qa.a)(zm.a,l))&&this.pB.PEk(a.Wb);return 32}wvj(a,b,c,f,l){if(1===c)return 32;b=Object(qa.a)(zm.a,
l);if(!b)return 8;this.Cc.NB(19,b.Wb);this.Cc.Lw(2,b.Wb);if(Qa.a.Wa(b.WW))return this.Cc.Hg(!1,b.Wb,11),8;Rc.a.Cza("PasteSlide",!0);if(c=Array.isArray(b.WW)?b.WW:null){let H=0;c.forEach(U=>{U.Fd&&U.Fd.hasDeferredContent&&H++});0<H&&va.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,H)}c=[];for(var w of b.WW){f=Object(qa.a)(Pv.a,w);if(!f)return this.Cc.Hg(!1,b.Wb,11),8;f=f.Fd;if(!f||!f.isConnected)return va.a.J(512356551,826,50,"Paste deleted slide"),this.Iwg.Xrc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,
String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),b.t8g&&(this.Jq.Yq=null),this.Cc.Hg(!1,b.Wb,13),16;if(this.fc.$c(f))return this.Cc.Hg(!1,b.Wb,3),16;Array.add(c,f)}w=Array.clone(this.pa.Qe());w.sort((H,U)=>H.me-U.me);w=w[w.length-1];if(!w)return va.a.J(512356550,826,50,"Paste slides with no slide selected"),this.Cc.Hg(!1,b.Wb,13),8;Rc.a.Ak("SlideCount",c.length.toString());w=this.hA.fUf(c,a,w,b.Wb,!1);c=!0;for(const H of w)if(!H.KQ){c=!1;break}c||this.fc.hw(this.Vb.xf,a);Rc.a.nP(!0,
!0);this.Cc.Hg(!0,b.Wb);return 32}rYe(){return this.pa.Bs()||this.pa.gH()}Gjl(){if(this.pa.Bs())return!0;if(this.pa.gH()){const a=this.pa.Xd();return 1!==a.length||!a[0].isEditable}return!1}esj(a,b,c,f,l,w){const H=this.Cc.hP(1,0,"HandleBrowserCut");this.Cc.NB(1,H);this.rYe()?(a=this.xcb(a,this.ia,b,c,f,l,w,this.Cc,H),a.w7a(16)):(Rc.a.nP(!0,!0),this.Cc.Xic(H),a=this.xcb(a,this.ia,D.a.b_b,c,f,l,w,this.Cc,H),a.wXc());return a}dsj(a,b,c,f,l,w){const H=this.Cc.hP(0,0,"HandleBrowserCopy");this.Cc.NB(1,
H);this.rYe()?(a=this.xcb(a,this.ia,b,c,f,l,w,this.Cc,H),2===f&&this.Yla.Fsa(Object.assign(new it(!0),{jig:!1,Wb:H})),a.w7a(32)):(this.Cc.Xic(H),a=this.xcb(a,this.ia,D.a.HIc,c,f,l,w,this.Cc,H),a.wXc());return a}fsj(a,b,c,f,l,w){const H=this.Cc.hP(2,0,"HandleBrowserPaste"),U=this.rYe();a=this.xcb(a,this.ia,U?b:D.a.d8,c,f,l,w,this.Cc,H);w=Object(qa.a)(10,w);Rc.a.nP(!0,!1);if(this.pa.o9())return a.w7a(16),this.Cc.Hg(!1,H,3),a;w&&w.Sa(Yd.a.JU)?2===f&&this.sud(w,H)?a.w7a(32):U?(2===f&&this.pB.paste(Object.assign(new zm.a(!0),
{Olg:!1}),w.eb(Yd.a.JU),!1),a.w7a(32)):a.wXc():(va.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),a.w7a(16),this.Cc.Hg(!1,H,14));return a}nvj(a,b,c,f,l,w){Rc.a.Cza("PasteGivenText",!1);this.Gjl()?(a=this.xcb(a,this.ia,b,c,f,l,w,this.Cc,""),a.w7a(16)):(Rc.a.nP(!0,!0),a=this.xcb(a,this.ia,D.a.Rhd,c,f,l,w,this.Cc,""),a.wXc());return a}yvj(a,b,c,f,l){if(1===c)return 32;if((b=this.pa.Xd())&&0<b.length)return va.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",
this.zGa.pUd(b)),16;va.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");if(!(l&&l.Bm&&l.Bm.innerHTML&&l.Bm.innerHTML.length))return va.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;Rc.a.Cza("PasteTextIntoNewShape",!0);b=this.kq.Ba;if(!b)return va.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.Zj.OF(b,1))return this.Zj.mG(b),16;l=this.Sk.SYd(b.cid,b.sid,b.Wt()+1,l.Bm.innerHTML,l.Wb);this.hA.HW([l],
b,a);return 32}J3f(){const a=this.Tb.Hu();return new gd.a(Math.floor(a.width/2),Math.floor(a.height/2))}mvj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(qu.a.CEf).toString());this.Cc.HAb(a)||(a=this.Cc.hP(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(L.a.kja,2);if(32!==b)return this.Cc.Hg(!1,a,15),va.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new zm.a(!0),{Wb:a});this.WT.jPj(l)?a.Bm=l:(gf.a.j0b(this.Vg),this.Vg.contentWindow.document.body.appendChild(l));
this.pB.paste(a,null,!1);va.a.J(512356515,826,50,null);return 32}sud(a,b){if(a){if(this.la.nje){const c=a.sa(Yd.a.hXc,"");if(c.startsWith("data:image/"))return this.Cc.NB(5,b),this.pB.EKe(c,b)}a=a.eb(Yd.a.JU);ha.a.Wa(a)||(a=this.WT.rZa(a),this.Cc.Nfl(a,b))}return!1}}Object(n.a)(TM,"ClipboardActor",null,[365]);var Fp=d(1136);class UM{constructor(a,b){this.ia=a;this.Gq=b;this.wb()}wb(){this.ia.ra(L.a.Zdh,Xd.a.frame,Object(F.a)(this,this.Guc,"updateCoauthStatus"),96)}Ee(){}Guc(a,b,c,f,l){if(1===c)return 32;
a=this.Gq.imc;ha.a.Wa(a)&&(a="NotConnected");this.Gq.Y7a&&(a=String.format("{0} ~:{1}",a,this.Gq.Y7a));l[Fp.a.Value]=a;l[hm.a.labelText]=a;l[Fp.a.Visible]=!0;return 32}}Object(n.a)(UM,"CoauthActor",null,[365]);var ru=d(231),Yk=d(350);class VM{constructor(a,b,c,f){this.eHa=!1;a("powerpoint-editor-intl").then(()=>{va.a.J(51519637,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{va.a.J(51519639,801,50,"Color Picker Manager script is loaded successfully");this.eHa=
!0}).catch(l=>{va.a.J(51519641,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>{va.a.J(51519643,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Fa=c;this.Vb=f}wb(){this.ia.ya(L.a.renderColorPicker,nc.a.application,Object(F.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.ya(L.a.QBa,nc.a.application,Object(F.a)(this,this.QBa,"addRecentColor"))}Ee(){}renderColorPicker(a,b,c,f,l){if(1===c)return this.eHa?32:8;a=!1;b=l.currentColor;c=l.handleCommand;
l.hideAlphaSlider&&(a=!0);this.Q0k(b,c,a);return 32}QBa(a,b,c,f,l){if(a=ru.a.parse(l.Color)){b=this.Vb.xf;if(!b)return va.a.J(595186576,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.we(hb.a.eKi,a.RGBColor);b.we(hb.a.g8,JSON.stringify(Yk.g(b.g8,a.RGBColor)))}else return va.a.J(595186574,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}Q0k(a,b,c){let f="#000000",l=100;a&&(f=tc.a.xI(a.sD),l=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),
a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),this.Fa.AXc(Lb.a.B0b,Lb.a.hj,a));const w=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(w)if(w.addEventListener("onColorChange",ja=>{const wa={};wa.Color=ja;wa.sourceControlId="CustomColors";let Sa=8;Pg.a("ColorPicker_ColorApplied",b,()=>Sa=this.ia.La(b,2,wa));32===Sa?va.a.J(595186570,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):va.a.J(595186568,
822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",b);this.Fa.Ej(Lb.a.B0b,!1)}),w.addEventListener("onCancel",()=>{this.Fa.Ej(Lb.a.B0b,!1)}),Pg.a("ColorPicker_DialogInvocation",b,()=>{w.render("colorPickerDiv",f,l,c);return 32}),va.a.J(595186566,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Fa.Ej(Lb.a.B0b,!0),a=this.Fa.Fc(Lb.a.B0b)){a.dJ=!0;var H=x.KeyInputManager.Oa(A.a.Sq,0),U=x.KeyInputManager.Oa(A.a.Sq,
4);a.Dp(H);a.Dp(U);a.bindAction(H,G.a.Esa);a.bindAction(U,G.a.Esa)}else va.a.J(595186564,822,10,"RenderColorPickerDialog: colorPickerScope is null");else va.a.J(595186572,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(n.a)(VM,"ColorPickerActor",null,[365]);var xR=d(1048);class WM{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb=!1,ub=!1){this.ia=a;this.ddc=b;this.$Q=c;this.cna=l.Etc;this.Sla=f;this.ua=w;this.Ea=H;this.pa=U;this.Fa=ja;this.y0=wa;this.Tak=eb;this.Fb=Sa;this.Yj=
ub}wb(){this.ia.ya(L.a.pLc,nc.a.application,Object(F.a)(this,this.fyj,"handleThumbnailPanelContextMenu"));this.ia.ya(L.a.AXd,nc.a.application,Object(F.a)(this,this.Mxj,"handleSorterViewThumbnailContextMenu"));this.ia.ya(L.a.ZIf,nc.a.application,Object(F.a)(this,this.Lxj,"handleSorterViewBlankSpaceMenu"));this.ia.ya(L.a.xXd,nc.a.application,Object(F.a)(this,this.jxj,"handleSectionContextMenu"));this.ia.ya(L.a.zXd,Cb.a.view,Object(F.a)(this,this.Gxj,"handleSlidePanelContextMenu"));this.ia.ya(L.a.yXd,
Cb.a.view,Object(F.a)(this,this.Uuj,"handleMultiSelectShapeContextMenu"));this.ia.ya(L.a.bJf,nc.a.application,Object(F.a)(this,this.wyj,"handleVersionHistoryThumbnailContextMenu"));this.ia.le(L.a.pLc,2048)}Ee(){this.Tak&&B.a.Vj&&(this.Fa.Fc(O.AppFrame.FW).bindAction(x.KeyInputManager.Oa(A.a.wMa,0),D.a.Iaa),this.Fa.Fc(O.AppFrame.YPe).bindAction(x.KeyInputManager.Oa(A.a.wMa,0),D.a.Iaa))}fyj(a,b,c,f,l){if(1===c)return 32;if(this.ia.fX)return this.y0.show(1,-1),32;this.ddc.g9a();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,
Wd.a.YBa))return 16;if(this.$Q.A_||!l.Ec)return 32;2===l.Wf||3===l.Wf?(a=l.clientPoint.y-nf.a.Cfj(this.cna.IU)+this.cna.IU.scrollTop,a=this.cna.q3d(a),b=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y)):(a=0>this.cna.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.cna.IU),b=new Sys.UI.Point(b.x+Pf.a.gsa,b.y+Pf.a.gsa));this.Sla.value.k6(Pf.a.Hsa,b,l.Wf,a);return 32}wyj(a,b,c,f,l){if(1===c)return 32;if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Wd.a.YBa))return 16;if(!l.Ec)return 32;a=new Sys.UI.Point(l.clientPoint.x,
l.clientPoint.y);this.Sla.value.k6(Pf.a.Hsa,a,l.Wf,21);return 32}Lxj(a,b,c,f,l){if(1===c)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);b=20;this.Yj&&0===this.Fb.Fl&&(b=2);this.Sla.value.k6(Pf.a.Hsa,a,l.Wf,b);return 32}Mxj(a,b,c,f,l){if(1===c)return 32;if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Wd.a.YBa))return 16;if(this.$Q.A_||!l.Ec)return 32;if(2===l.Wf||3===l.Wf||1===l.Wf)b=19,this.Yj&&0===this.Fb.Fl&&(b=1),a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.Sla.value.k6(Pf.a.Hsa,
a,l.Wf,b);return 32}jxj(a,b,c,f,l){if(1===c)return 32;u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&(a=l.contextMenuArgs,b=new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),l.isEmptySection?this.Sla.value.k6(Pf.a.Hsa,b,a.Wf,17):this.Sla.value.k6(Pf.a.Hsa,b,a.Wf,18));return 32}Gxj(a,b,c,f,l){if(1===c)return 32;this.ddc.g9a();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Wd.a.YBa))return 16;if(this.$Q.A_||!l.Ec)return 32;if(2===l.Wf||3===l.Wf)a=new Sys.UI.Point(l.clientPoint.x,
l.clientPoint.y);else{a=Tj.b(b);a=Tj.e(this.ua.Ba,a.Ma);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.MB);a=new Sys.UI.Point(a.x+Pf.a.gsa,a.y+Pf.a.gsa)}this.Sla.value.k6(Pf.a.Hsa,a,l.Wf,4);return 32}Uuj(a,b,c,f,l){if(1===c||l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Pf.a.zei))return 32;this.ddc.g9a();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Wd.a.YBa))return 16;if(this.$Q.A_||!l.Ec)return 32;b=Tj.b(b);var w;if(!(b&&b.Mb&&(w=this.pa.tg())&&w.length))return 16;a=this.dfj(w);if(2===l.Wf||
3===l.Wf)w=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{w=Tj.c(w[0],b.Ma);if(!w||!w.xa)return 16;w=Kd.a.ai(w.xa.xa);b=Kd.a.ai(b.container);c=w.x+Pf.a.gsa<b.x?b.x:w.x+Pf.a.gsa;w=w.y+Pf.a.gsa<b.y?b.y:w.y+Pf.a.gsa;c=c>b.x+b.width?b.x+b.width:c;w=w>b.y+b.height?b.y+b.height:w;w=new Sys.UI.Point(c,w)}1===l.Wf||4===a?this.Sla.value.k6(Pf.a.Hsa,w,l.Wf,a):this.Sla.value.eml(Pf.a.Hsa,w,l.Wf,a);return 32}dfj(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Ea.yr(b));return 1<a.length?this.Ea.zHc(a)?
11:10:b.gz||!b.Eua||b.If?5:b.get_isSVGBlipFilled()?13:b.Hj||1===b.mediaType?7:b.Qf?8:b.ux?6:b.Dq?22:b.hr?9:b.ud?14:b.Op?15:b.a4?16:0}}Object(n.a)(WM,"ContextMenuActor",null,[365]);class XM{constructor(a,b,c,f,l,w,H){this.ia=a;this.pa=b;this.Ea=c;this.dcb=f;this.rbk=l;this.Rwe=w;this.fU=H}wb(){this.ia.ra(L.a.zah,nc.a.application,Object(F.a)(this,this.gGk,"pictureToolsTabViewHandler"),4);this.ia.ra(L.a.dRf,nc.a.application,Object(F.a)(this,this.rQi,"drawingToolsTabViewHandler"),4);this.ia.ra(L.a.wzf,
nc.a.application,Object(F.a)(this,this.Uhi,"audioPlaybackToolsTabViewHandler"),4);this.ia.ra(L.a.uzf,nc.a.application,Object(F.a)(this,this.Shi,"audioFormatToolsTabViewHandler"),4);this.ia.ra(L.a.xzf,nc.a.application,Object(F.a)(this,this.Vhi,"audioSettingsTabViewHandler"),4);this.ia.ra(L.a.deh,nc.a.application,Object(F.a)(this,this.crj,"graphicsTabViewHandler"),100);this.ia.ra(L.a.COe,nc.a.application,Object(F.a)(this,this.pvl,"tableTabViewHandler"),100);this.ia.ra(L.a.seh,nc.a.application,Object(F.a)(this,
this.Rhi,"audioContextualGroupHandler"),100);this.ia.ra(L.a.vOd,nc.a.application,Object(F.a)(this,this.V4h,"accessibleAuthoringViewHandler"),4)}Ee(){}gGk(){return this.pPj()?32:this.Tlg(this.pa.tg())?32:8}rQi(){const a=this.pa.tg();return a&&a.length?1===a.length?this.Jjg(a)?32:16:this.hei(a)||this.OKj(a)&&this.Jjg(a)?32:this.Hrb(a)||this.mRj(a)?16:32:16}Uhi(){return this.Rwe?this.YZc()?32:this.Hrb(this.pa.tg())?32:8:2}Shi(){return this.fU?this.YZc()?32:this.Hrb(this.pa.tg())?32:8:2}Vhi(){return this.fU&&
this.Rwe?this.YZc()?32:this.Hrb(this.pa.tg())?32:8:2}crj(){return this.rbk?this.qPj()?32:this.Ea.Jsc(this.pa.tg())?32:16:2}pvl(){const a=this.pa.Xd();return a&&1===a.length&&a[0].ud?32:8}Rhi(){return this.fU||this.Rwe?this.YZc()?32:this.Hrb(this.pa.tg())?32:8:2}V4h(){return this.dcb&&this.dcb.isVisible?32:2}mRj(a){if(!a)return!1;let b=!0;for(const c of a){if(c.Op||1===c.mediaType)return!0;c.Hj||(b=!1)}return b}hei(a){if(!a)return!1;for(const b of a)if(!b.Op)return!1;return!0}Tlg(a){if(!a)return!1;
let b=!1;for(const c of a)if(c)if(c.Hj&&!c.get_isSVGBlipFilled())b=!0;else if(c.Op)return!1;return b}Hrb(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1!==b.mediaType)return!1;return!0}OKj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}Jjg(a){if(!a)return!1;for(const b of a)if(b&&(b.rua||b.a4))return!0;return!1}pPj(){return this.Cke(this.pa.tg())&&this.Tlg(this.pa.aP(this.pa.Xd()))}qPj(){return this.Cke(this.pa.tg())&&this.UUj(this.pa.aP(this.pa.Xd()))}YZc(){return this.Cke(this.pa.tg())&&
this.Hrb(this.pa.aP(this.pa.Xd()))}UUj(a){if(!a)return!1;for(const b of a)if(b&&b.Og&&b.get_isSVGBlipFilled())return!0;return!1}Cke(a){if(!a)return!1;for(const b of a)if(b&&b.If)return!0;return!1}}Object(n.a)(XM,"ContextualTabsActor",null,[365]);class YM{constructor(a,b,c,f){this.vBe=null;this.ia=a;this.ua=b;this.Jb=c;this.cyg=f;this.cyg.kk(Object(F.a)(this,this.A6g,"onRichApiResponseReceived"))}wb(){this.ia.ra(L.a.I2d,Cb.a.application,Object(F.a)(this,this.utj,"handleExecuteAddinBatchOperation"),
4)}Ee(){}dispose(){this.cyg.Rm(Object(F.a)(this,this.A6g,"onRichApiResponseReceived"))}A6g(a,b){this.vBe&&(a=Object(qa.a)(1237,b.node))&&a.fTe&&this.vBe(a.fTe)}utj(a,b,c,f,l){b=this.ua.presentation;if(1===c)return b?32:8;if(!b)return va.a.J(509364444,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!l)return va.a.J(509364443,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.vBe=l.promiseToResolve;c=this.Jb.Ad(15,void 0,void 0,void 0,!0);try{c.nc(b),
c.jd=a,b.qPd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(n.a)(YM,"ExtensibilityActor",null,[365]);var ay;(function(a){a[a.height=0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(ay||(ay={}));Object(n.b)("FormatPaneProperty",ay);class hA{constructor(a,b){this.F1=a;this.W$=b}}Object(n.a)(hA,"MarginShapeData",null,[]);class ME{constructor(){this.type=
"FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0}}Object(n.a)(ME,"FormatShapeTaskPaneProps",null,[]);class ZM{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic){this.KIa=this.JXa=this.QX=this.hwa=null;
this.OGg=0;this.Eb=!1;this.iIa=null;this.WGa=this.xva=!1;this.jbk=!0;this.ob=b;this.Rb=c;this.ia=f;this.Fa=l;this.Yf=H;this.ld=U;this.Lc=ja;this.Fb=wa;this.eGa=Sa;this.Vb=eb;this.Yf.tI(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.Yf.SBa(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.Lc.JPa(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.ld.VBa(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.Rb.RK(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"));
this.cCg=Ub;this.h5c=cc;this.Ea=ub;this.t0=Fc;this.ln=Ic;Pd.a("FixHeightAndWidthButtonValues")&&this.ln&&this.ln.QPd(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"))}dispose(){this.Yf.X5(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.Yf.l_a(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.Lc.Sib(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.ld.Uib(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"));this.Rb.CY(Object(F.a)(this,
this.Tu,"onAppFrameModeSwitched"));Pd.a("FixHeightAndWidthButtonValues")&&this.ln.Wld(Object(F.a)(this,this.Zwa,"onChangeRenderFormatShapePane"))}wb(){this.ia.ra(L.a.Lrc,nc.a.application,Object(F.a)(this,this.Lrc,"showHideFormatShapePane"),4);this.ia.ra(L.a.Nod,nc.a.application,Object(F.a)(this,this.Nod,"setAbsoluteHeight"),4);this.ia.ra(L.a.D_e,nc.a.application,Object(F.a)(this,this.D_e,"spinAbsoluteHeight"),4);this.ia.ra(L.a.eib,nc.a.application,Object(F.a)(this,this.eib,"queryAbsoluteHeight"),
100);this.ia.ra(L.a.Ood,nc.a.application,Object(F.a)(this,this.Ood,"setAbsoluteWidth"),4);this.ia.ra(L.a.E_e,nc.a.application,Object(F.a)(this,this.E_e,"spinAbsoluteWidth"),4);this.ia.ra(L.a.fib,nc.a.application,Object(F.a)(this,this.fib,"queryAbsoluteWidth"),100);this.ia.ra(L.a.lJb,nc.a.application,Object(F.a)(this,this.lJb,"queryFormatShapePane"),96)}Ee(){}Zwa(){this.Eb&&this.Ql(!0)}Tu(a){1===a.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Fa.Ej(Lb.a.KW,this.Eb))}XOj(a){return this.Vb.isEditingAllowed&&
this.jbk&&!this.uYe(a)}lJb(a,b,c,f,l){(a=Object(qa.a)(Xh.a,l))&&a.Lf(this.Eb);return 32}Lrc(a,b,c){b=this.ob.tg();return 1===c?b.length&&this.XOj(b)?32:8:Pg.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",this.Eb.toString(),a,()=>{(this.Eb=!this.Eb)?this.Ql():this.Cr();return 32})}Nod(a,b,c,f,l){b=this.ob.tg();return 1===c?this.Cuh(b)?8:32:Pg.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!l)return va.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),
8;const w=l.Number;void 0===w||null===w||isNaN(w)||this.fxa(w,0);return 32})}D_e(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.fxa(0,0),this.t6a());return 32}eib(a,b,c,f,l){if(!l)return va.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),8;if(a=l.queryResult)b=this.yC(),a.Kaa=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.Kaa="");return 32}Ood(a,b,c,f,l){b=this.ob.tg();return 1===c?this.Cuh(b)?8:32:Pg.a("FormatShapePaneActor::SetAbsoluteWidth",
a,()=>{if(!l)return va.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const w=l.Number;void 0===w||null===w||isNaN(w)||this.fxa(w,1);return 32})}E_e(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.fxa(0,1),this.t6a());return 32}fib(a,b,c,f,l){if(!l)return va.a.J(512500577,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=l.queryResult)b=this.yC(),a.Kaa=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.Kaa="");return 32}Ql(a=
!1){const b=this.yC(),c=Object.assign(new nu.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0});sj.UISurfaces.zr().then(f=>{a?f.updateTaskPane(Lb.a.KW,c):f.showTaskPane(Lb.a.KW,c);return null})}Cr(){sj.UISurfaces.zr().then(a=>{a.hideTaskPane(Lb.a.KW,2);return null})}yC(){const a=this.ob.tg();var b=[];for(var c of a)c.If?b=Array.isArray(b.concat.apply(b,this.Ea.ix(c)))?b.concat.apply(b,this.Ea.ix(c)):null:
b.push(c);if(!(c=this.$k(a[0]))||this.uYe(a))return this.WGa=!0,this.Xqh(0,0,0,0,0,0,0,127,127);var f=this.getBounds(a[0]),l=c.vd;c=this.f8d(f);c=this.tLc(c,1,l);f=this.cbe(f);f=this.tLc(f,0,l);this.WGa=0===c||0===f?!0:!1;l=Math.round(a[0].get_shapeRotation());l=0>l&&Pd.a("fixBugOfNegativeAngle")?l+360:l;b=this.$k(b[0]);let w=0,H=0,U=0,ja=0;b&&(w=b.eUa[0],H=b.eUa[1],U=b.eUa[2],ja=b.eUa[3]);c=this.Xqh(c,f,l,w,H,U,ja,this.D9i(a),0);this.KGl(a,c);return c}D9i(a){let b=[];for(var c of a)c.If?b=Array.isArray(b.concat.apply(b,
this.Ea.ix(c)))?b.concat.apply(b,this.Ea.ix(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.etb(a[f])||(c|=4),this.t0&&!this.G_b(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].FAb){c|=120;break}return c}etb(a){return!!a&&a.FL&&!a.VI}G_b(a){return!!a&&a.isResizable&&!a.VI}Cuh(a){if(0>=a.length)return!0;let b=!1;if(this.t0){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.G_b(a[c])){b=!1;break}}return b||this.uYe(a)}uYe(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].ud){b=
!0;break}return b}KGl(a,b){if(this.h5c){var c=[];for(var f of a)f.If?c=Array.isArray(c.concat.apply(c,this.Ea.ix(f)))?c.concat.apply(c,this.Ea.ix(f)):null:c.push(f);var l=f=!0,w=!0,H=!0;if(2<=c.length)for(var U=1;U<c.length;U++){var ja=c[U];if(!ja)continue;if(!this.getBounds(ja))continue;ja=this.$k(ja);let wa=0,Sa=0,eb=0,ub=0;ja&&(wa=ja.eUa[0],Sa=ja.eUa[1],eb=ja.eUa[2],ub=ja.eUa[3]);f&&b.leftMargin!==wa&&(b.leftMargin=0,b.emptyValueFields|=8,f=!1);l&&b.rightMargin!==Sa&&(b.rightMargin=0,b.emptyValueFields|=
16,l=!1);w&&b.topMargin!==eb&&(b.topMargin=0,b.emptyValueFields|=32,w=!1);H&&b.bottomMargin!==ub&&(b.bottomMargin=0,b.emptyValueFields|=64,H=!1);if(!(f||l||w||H))break}}if(!(2>a.length))for(l=f=c=!0,w=1;w<a.length;w++)if(H=a[w])if(U=this.getBounds(H))if(ja=this.$k(H).vd,H=this.f8d(U),H=this.tLc(H,1,ja),U=this.cbe(U),U=this.tLc(U,0,ja),ja=a[w].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(H.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),f&&b.width.toFixed(2).localeCompare(U.toFixed(2))&&
(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==ja&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}$bl(a,b,c,f,l,w,H,U,ja){const wa=new ME,Sa=Object(qa.a)(Object,Sg.e().numberFormatInfo);wa.numberFormatInfo=Sa;wa.height=a;wa.width=b;wa.rotation=c;wa.leftMargin=f;wa.rightMargin=l;wa.topMargin=w;wa.bottomMargin=H;wa.disabled=U;wa.onChange=Object(F.a)(this,this.fxa,"onPropertyChange");wa.emptyValueFields=ja;wa.isAspectRatioLocked=this.xva;wa.isAspectRatioDisabled=this.WGa;wa.onToggleAspectRatio=
Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");wa.isAspectRatioFeatureEnabled=this.cCg;wa.isMarginFieldEnabled=this.h5c;return wa}acl(a,b,c,f,l){const w=new ME,H=Object(qa.a)(Object,Sg.e().numberFormatInfo);w.numberFormatInfo=H;w.height=a;w.width=b;w.rotation=c;w.disabled=f;w.onChange=Object(F.a)(this,this.fxa,"onPropertyChange");w.emptyValueFields=l;w.isAspectRatioLocked=this.xva;w.isAspectRatioDisabled=this.WGa;w.onToggleAspectRatio=Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");
w.isAspectRatioFeatureEnabled=this.cCg;return w}Xqh(a,b,c,f,l,w,H,U,ja){return this.h5c?this.$bl(a,b,c,f,l,w,H,U,ja):this.acl(a,b,c,U,ja)}fxa(a,b){const c=this.ob.tg();this.OGg!==b&&(this.t6a(),this.OGg=b);switch(b){case 0:case 1:this.resize(a,c,b);break;case 3:case 4:case 5:case 6:this.Fri(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.xva=a}$Cf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*a)}Fri(a,b,c){let f=[];for(const w of b)w.If?f=Array.isArray(f.concat.apply(f,this.Ea.ix(w)))?
f.concat.apply(f,this.Ea.ix(w)):null:f.push(w);this.iIa=b=f;let l=!0;this.QX||(this.QX=[],l=!1);Pg.b("FormatShapePaneActor::ChangeMargin Property:",ay[c]+"; AspectRatioLocked: "+(!this.WGa&&this.xva),L.a.Qqc,()=>{for(let w=0;w<b.length;w++){const H=b[w],U=this.$k(H);if(!U)continue;l||this.QX.push(new hA(H,new Xi.a));this.QX.length===w&&this.QX.push(new hA(H,new Xi.a));this.QX[w]||(this.QX[w]=new hA(H,new Xi.a));const ja=this.QX[w];ja.W$.left=H.Tia;ja.W$.right=H.Uia;ja.W$.top=H.Via;ja.W$.bottom=H.Sia;
3===c&&(this.QX[w].W$.left=a);4===c&&(this.QX[w].W$.right=a);5===c&&(this.QX[w].W$.top=a);6===c&&(this.QX[w].W$.bottom=a);U.Gza(this.QX[w].W$)}return 32});this.Ruc()}resize(a,b,c){this.iIa=b;let f=!0;const l=[],w=[];this.hwa||(this.hwa=[],f=!1);0===a&&(this.WGa=!0);Pg.b("FormatShapePaneActor::Resize Property:",ay[c]+"; AspectRatioLocked: "+(!this.WGa&&this.xva),L.a.fjb,()=>{for(let wa=0;wa<b.length;wa++){var H=b[wa];const Sa=this.$k(H);if(this.t0){if(!Sa||!this.G_b(H))continue}else if(!Sa)continue;
var U=this.getBounds(H),ja=this.f8d(U);U=this.cbe(U);f||(Array.add(this.hwa,new Iz(H,new Xi.a)),Sa.EL=!0,Sa.SD(!1));Array.add(l,Sa.TYa);Array.add(w,new Xi.a);Sa.shapeNode.If&&Sa.shapeNode.isEditable&&Sa.Ok&&(Sa.Ok.visible=!0);H=Sa.vd;if(0===c){H=this.qJf(a,1,H);H=Math.round(H-ja);w[wa].bottom=H;let eb;(eb=this.hwa[wa].p1).bottom=eb.bottom+H;if(!this.WGa&&this.xva){ja=this.$Cf(U,ja,0,H);w[wa].right=ja;let ub;(ub=this.hwa[wa].p1).right=ub.right+ja}}else{H=this.qJf(a,0,H);H=Math.round(H-U);w[wa].right=
H;let eb;(eb=this.hwa[wa].p1).right=eb.right+H;if(!this.WGa&&this.xva){ja=this.$Cf(U,ja,H,0);w[wa].bottom=ja;let ub;(ub=this.hwa[wa].p1).bottom=ub.bottom+ja}}Sa.setOffsets(Xi.a.add(l[wa],w[wa]),!0);Sa.shapeNode.If&&Sa.shapeNode.isEditable&&(Sa.$ce(),Sa.LWc())}return 32});this.Ruc()}rotate(a,b){this.iIa=b;let c=!0;a=Math.round(a);this.JXa||(this.JXa=[],c=!1);Pg.a("FormatShapePaneActor::Rotate",L.a.Cpc,()=>{for(let f=0;f<b.length;f++){const l=b[f],w=this.$k(l);if(!w)continue;const H=w.xwb().Vf(),U=
a%ap.ilc;c||(w.SD(!1),Array.add(this.JXa,new ap(l,U)));this.JXa[f].x_d=U;w.setRotation(U,H)}return 32});this.Ruc()}$k(a){return a?Object(qa.a)(Jz.a,a.ng(this.Fb.Ma)):(va.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.$k(a);if(!b)return va.a.J(512500575,822,10,"shapeViewElement == null"),null;b=b.q5b();a.Q_&&(b=this.r6d(b));return b}qJf(a,b,c){return this.eGa.JM(this.Fb.Md.y_(a,b),c)}tLc(a,b,c){a=this.Fb.Md.qf(this.eGa.GM(a,c),b);return te.a.Qv(a)}f8d(a){a=gd.a.lm(a.sk(ne.a.Ru),
a.sk(ne.a.RH));return 1>=a?0:a}cbe(a){a=gd.a.lm(a.sk(ne.a.Ru),a.sk(ne.a.DE));return 1>=a?0:a}t6a(){this.h5c&&this.QX&&(this.ia.La(L.a.Qqc,2,this.QX),this.QX=null);if(this.hwa){for(var a=0;a<this.iIa.length;a++){var b=this.$k(this.iIa[a]);b&&!b.Al&&(b.shapeNode.If&&b.shapeNode.isEditable||(b.EL=!1),b.Xz(!1))}this.ia.La(L.a.fjb,2,this.hwa);this.hwa=null}if(this.JXa){a=[];for(b=0;b<this.iIa.length;b++){let c=this.$k(this.iIa[b]);c&&!c.Al&&(c.Xz(!1),Pd.a("FixUndoRotateMultipleShapes")?a.push(this.iIa[b]):
this.ia.La(L.a.Cpc,2,this.JXa[b]))}Pd.a("FixUndoRotateMultipleShapes")&&(b={},b.selectedNodes=a,b.rotateData=this.JXa,this.ia.La(L.a.cnh,2,b));this.JXa=null}this.KIa=this.iIa=null}Ruc(){this.KIa&&Rc.a.Btb(this.KIa);this.KIa=Rc.a.Faa(Object(F.a)(this,this.t6a,"applyPendingChangesToServerIfRequired"),1E3)}r6d(a){const b=gd.a.$9a(a.ga(0),a.ga(3));a=gd.a.$9a(a.ga(1),a.ga(2));return new cj.a(new gd.a(b.x,b.y),new gd.a(a.x,b.y),new gd.a(a.x,a.y),new gd.a(b.x,a.y))}}Object(n.a)(ZM,"FormatShapePaneActor",
null,[106,365]);class iA{constructor(a,b,c,f,l,w,H){this.type="FormatTableTaskPaneProps";this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const U=Object(qa.a)(Object,Sg.e().numberFormatInfo);if(!U)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=U;this.cellHeight=
b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=w;this.emptyValueFields=H}}Object(n.a)(iA,"FormatTableTaskPaneProps",null,[]);class $M{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.tch=this.wch=this.vch=this.uch=-1}}Object(n.a)($M,"Margins",null,[]);class aN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc){this.xva=
this.Eb=!1;this.Mni=320;this.MXa=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");if(!w)throw Error.argumentNull("graphOperationEventHandler");if(!H)throw Error.argumentNull("viewElementEventHandlers");if(!U)throw Error.argumentNull("viewEventSource");if(!ja)throw Error.argumentNull("pageView");if(!wa)throw Error.argumentNull("unitConversion");
if(!Sa)throw Error.argumentNull("workspace");if(!ub)throw Error.argumentNull("tableReader");if(!Ub)throw Error.argumentNull("rowReader");if(!cc)throw Error.argumentNull("columnReader");if(!eb)throw Error.argumentNull("dynamicScriptLoader");eb.loadScript("powerpoint-editor-intl").then(()=>{this.MXa=!0}).catch(Fc=>{va.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+Fc.toString())});this.ob=a;this.Rb=b;this.ia=c;this.Fa=f;this.Yf=w;this.ld=H;this.Lc=U;this.Yf.tI(Object(F.a)(this,this.YYa,
"onChangeRenderFormatTablePane"));this.Yf.SBa(Object(F.a)(this,this.YYa,"onChangeRenderFormatTablePane"));this.Lc.JPa(Object(F.a)(this,this.YYa,"onChangeRenderFormatTablePane"));this.ld.VBa(Object(F.a)(this,this.YYa,"onChangeRenderFormatTablePane"));this.Rb.RK(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"));this.AJ=cc;this.jYa=Ub;this.yc=ub}dispose(){this.Yf.X5(Object(F.a)(this,this.YYa,"onChangeRenderFormatTablePane"));this.Yf.l_a(Object(F.a)(this,this.YYa,"onChangeRenderFormatTablePane"));this.Lc.Sib(Object(F.a)(this,
this.YYa,"onChangeRenderFormatTablePane"));this.ld.Uib(Object(F.a)(this,this.YYa,"onChangeRenderFormatTablePane"));this.Rb.CY(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"))}wb(){this.ia.ra(L.a.Nrc,nc.a.application,Object(F.a)(this,this.Nrc,"showHideReactFormatTablePane"),4);this.ia.ra(L.a.EJb,nc.a.application,Object(F.a)(this,this.EJb,"queryReactFormatTablePane"),96)}Ee(){}YYa(){this.Eb&&this.Ql(!0)}Tu(a){1===a.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Fa.Ej(Lb.a.hza,this.Eb))}EJb(a,b,c,f,l){(a=
Object(qa.a)(Xh.a,l))&&a.Lf(this.Eb);return 32}Nrc(a,b,c){if(!this.MXa)return 8;b=this.ob.tg();if(1===c)return b.length?32:8;this.Eb=!this.Eb;return Pg.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Eb.toString(),a,()=>{this.Eb?this.Ql():this.Cr();return 32})}Ql(a=!1){const b=this.yC(),c=Object.assign(new nu.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.Mni,location:2,contentProps:b,onOpen:()=>{va.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},
onClose:()=>{this.Eb=!1;va.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});sj.UISurfaces.zr().then(f=>{a?f.updateTaskPane(Lb.a.hza,c):f.showTaskPane(Lb.a.hza,c);return null}).catch(f=>{va.a.J(512500571,822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+f.toString())})}Cr(){sj.UISurfaces.zr().then(a=>{a.hideTaskPane(Lb.a.hza,2);return null}).catch(a=>{va.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+
a.toString())})}yC(){var a=this.ob.an();const b=new $M;if(!a)return a=new iA(b,0,0,0,0,!0,255),this.bWe(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.whj(a,c,f));const l=te.a.Qv(this.yc.tae(a)),w=te.a.Qv(this.yc.vae(a));let H=this.ob.yv();H&&H.length||(H=this.yc.HF(a));if(!H||!H.length)return a=new iA(b,c,f,l,w,!0,255),this.bWe(a);this.vhj(H,b);a=new iA(b,c,f,l,w,!1,0);this.bWe(a);this.JGl(a);return a}bWe(a){a.onChange=Object(F.a)(this,this.fxa,"onPropertyChange");a.isAspectRatioLocked=this.xva;
a.onToggleAspectRatio=Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}whj(a,b,c){let f=this.ob.DUc(),l=this.ob.Fxb();f&&f.length||(f=this.yc.tka(a));l&&l.length||(l=this.Mxb(a));f.length&&(b=te.a.Qv(this.jYa.T0f(f)));l.length&&(c=te.a.Qv(this.AJ.V0f(a,l)));return{cellHeight:b,cellWidth:c}}vhj(a,b){let c=!0,f=!0,l=!0,w=!0;for(const H of a)H&&!H.isGhostCell&&({XYc:c,cellMargin:b.leftMargin,ojd:b.uch}=this.Vud(c,b.leftMargin,H.marginLeft,b.uch),{XYc:f,cellMargin:b.rightMargin,
ojd:b.vch}=this.Vud(f,b.rightMargin,H.marginRight,b.vch),{XYc:l,cellMargin:b.topMargin,ojd:b.wch}=this.Vud(l,b.topMargin,H.marginTop,b.wch),{XYc:w,cellMargin:b.bottomMargin,ojd:b.tch}=this.Vud(w,b.bottomMargin,H.marginBottom,b.tch))}Vud(a,b,c,f){a&&(b=te.a.Qv(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{XYc:a,cellMargin:b,ojd:f}}JGl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&
(a.emptyValueFields|=64);0>a.bottomMargin&&(a.emptyValueFields|=128)}fxa(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.La(L.a.q0a,2,c);break;case 1:this.ia.La(L.a.gLa,2,c);break;case 2:this.ia.La(L.a.Ooa,2,c);break;case 3:this.ia.La(L.a.hLa,2,c);break;case 4:this.ia.La(L.a.Qsc,2,c);break;case 5:this.ia.La(L.a.Usc,2,c);break;case 6:this.ia.La(L.a.Vsc,2,c);break;case 7:this.ia.La(L.a.Psc,2,c)}}onToggleAspectRatio(a){this.xva=a;this.ia.La(L.a.wqc,2,null)}Mxb(a){let b=null;a&&14===a.type&&(b=this.yc.rae(a.firstRow));
return b}}Object(n.a)(aN,"FormatTablePaneActor",null,[106,365]);class jA{constructor(a,b,c){this.pa=a;this.Fb=b;this.Ea=c}process(a,b,c,f){2===c&&32===f&&b.contextId===Cb.a.view&&Array.contains(jA.m6k,a)&&(a=this.pa.Xd(),0<a.length&&0<this.Ea.textLength(a[0])&&this.esi(a[0]))}esi(a){if(!a.Z$){var b=Od.SelectionFactory.wl(a);b=nb.SelectionEditor.u4b(b);var c=nb.SelectionEditor.t4b(b,!1);b=Od.SelectionFactory.GN(b,c.Ua,!1);if((c=this.pa.Na)&&c.mb&&c.mb.contains(b)&&2===a.Gz){var f=Object(qa.a)(117,
a.sc(this.Fb.Ma));if(f){b=a.Gz;c=a.G1;var l=a.I1;a.Gz=1;a.G1=1;a.I1=0;f=f.OSf();f.iAf();f.lzf();f.Kza();f.bVf()&&(a.Gz=b,a.G1=c,a.I1=l);f.detach();f.F4e()}}}}}jA.m6k=[D.a.Pq,D.a.bH,D.a.PH];Object(n.a)(jA,"FormattingViewOperationFinishedStageProcessor",null,[1164]);var yR=d(622);class bN extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(n.a)(bN,"SectionNodeChangedArgs",Sys.EventArgs,[]);class cN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.YQ=null;this.wt=a;this.Jb=b;this.Vb=
c;this.pa=f;this.Fa=l;this.la=U;this.nn=this.la.HC;this.Ge=H;this.Qea=this.la.Lle;this.Tb=w;this.$7c=this.la.Mac;this.fc=ja;this.Mu=wa;this.ua=Sa;this.Fb=eb;ub.execute(Ub=>{this.YQ=Ub})}ZUi(a,b,c){if(a&&a.length){for(var f of a)if(!f||N.a.mx(f.Cb))return;f=this.la.Ln?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;var l=this.Jb.Ad(15,void 0,()=>{this.Fa.rf(Zi.a.PD);this.pa.Rh()});try{l.nc(this.wt),this.Qea?this.wt.AFe(a,b,c,f):this.wt.zFe(a[0],b,c,f)}finally{l&&
l.dispose()}}}jUf(a,b){var c=this.Tb.$m;if(c&&c.Up)if(b&&!a||!b&&a===c.Up.length-1)va.a.J(509364431,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=Pd.a("FixSectionMoveBug")?c.i8k:c.Up;var l=Date.now(),w=this.Jb.Ad(15,void 0,()=>{},()=>{});try{w.nc(this.wt);const H=f[a],U=b?f[a-1]:f[a+1];c.setValue(hb.a.Bok,H);c.setValue(hb.a.gok,U);if(H&&U){let ja=-1,wa=-1;for(let Sa=0;Sa<f.length&&!(H===f[Sa]&&(ja=Sa),U===f[Sa]&&(wa=Sa),0<=ja&&0<=wa);Sa++);
Array.removeAt(f,ja);Array.insert(f,wa,H);c.anchor?c.anchor.glb(f,34,!1):va.a.J(509364430,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{w&&w.dispose()}this.ua.Wz=b?0<=a-1?a-1:0:a+1;c=Date.now();va.a.J(509364429,822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,l,c,c-l,b);this.Mu?this.Mu.KPe():va.a.J(509364428,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else va.a.J(509364432,
808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}GUi(a,b){if(a){var c=this.Tb.$m;if(c){var f=c.Up;f&&f.length||va.a.J(509364425,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var l=this.Jb.Ad(15,void 0,()=>{},()=>{});try{l.nc(this.wt);l.jd=b;const w=f&&f.length?this.Ge.RW(a.Cb):0;this.wt.i6a(a,w)}finally{l&&l.dispose()}this.fc.hw(this.wt,b);b=Date.now();va.a.J(509364424,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",
a.slideIndex,c,b,b-c);this.Mu?this.Mu.KPe():va.a.J(509364423,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else va.a.J(509364426,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else va.a.J(509364427,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}kVi(a){var b=this.Tb.$m;if(b&&b.Up){var c=b.Up;if(!a||a.sectionIndex>=c.length)va.a.J(509364421,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=
b.V6f(a.sectionIndex);c=null;f&&(c=Object(qa.a)(yR.a,b.pjj(f.LE)));b=Date.now();f=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},()=>{});try{f.nc(c),c.title=a.qIl}finally{f&&f.dispose()}c=Date.now();va.a.J(509364420,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",a.sectionIndex,b,c,c-b)}}else va.a.J(509364422,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}dVi(a,
b){const c=this.Tb.$m;if(c&&c.Up){var f=c.Up,l=this.ua.ica,w=Date.now(),H=f.length,U=this.Jb.Ad(15,void 0,()=>{},()=>{});try{U.nc(this.wt);U.jd=b;if(a){const ja=this.Tb.Dxb(a-1);let wa=l.DA;if(ja&&wa){const Sa=ja.DA?ja.DA:[];for(let eb=0;eb<wa.length;eb++)Array.insert(Sa,Sa.length,wa[eb]);wa=[];ja.DA=Sa}}Array.removeAt(f,a);c.hOf(l)}finally{U&&U.dispose()}this.ua.Wz=0<=a-1?a-1:0;this.fc.hw(this.wt,b);b=Date.now();va.a.J(509364418,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",
a,w,b,b-w,H,f.length);this.Mu?this.Mu.AQk(new bN(l)):va.a.J(509364417,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else va.a.J(509364419,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}APc(a,b,c,f){if(!b||!this.$7c&&!c)return null;let l=null;const w=this.Jb.Ad(15,void 0,()=>{Pd.a("FixDocumentFocusIssue")||this.Fa.Ed();this.pa.Rh()},()=>{1!==this.Fb.Fl&&(Pd.a("FixDocumentFocusIssue")?this.Fa.rf(this.Fa.Ae.name):
this.Fa.rf(Zi.a.PD))});try{let H;H=this.la.Ln?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;let U;U=Pd.a("SlideSorterInsertionAfterFirstSlide")?!!this.Fb&&1===this.Fb.Fl&&-1===this.Vb.Axa:!!this.Fb&&1===this.Fb.Fl&&!this.Vb.Axa;const ja=this.ua.ica;if(H&&ja&&(!ja.cK||!ja.cK.length)||U)U&&(this.Vb.Axa=-1),a=null;w.nc(this.Vb.xf);w.jd=f;l=Object(qa.a)(116,this.wt.KYb(a,ja,b,c,H));this.nn&&this.pa.MR(l);this.Vb.Ba=l;this.Vb.xf.removeProperty(hb.a.CKe)}finally{w&&
w.dispose()}return l}YUi(a,b,c,f,l,w){if(5!==f)throw Error.invalidOperation();const H=Object(qa.a)(116,this.wt.eZd(a,b,c));if(!H)return va.a.J(509364416,822,10,"CreateSlideNodeForInsertion returned null"),null;b=this.la.Ln?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;c=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},()=>{this.nn&&this.pa.MR(H);this.Fa.rf(Zi.a.PD)});try{c.nc(this.Vb.xf),c.jd=w,this.wt.uab(H,a,null,b),l&&(this.Vb.Ba=H)}finally{c&&c.dispose()}return H}SUi(a,
b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");c||(c=a);let f;f=this.la.Ln?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;let l=null;const w=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},()=>{1!==this.Fb.Fl&&(this.la.Ln?this.Fa.rf(Lb.a.PB):this.Fa.rf(Zi.a.PD))});try{w.nc(this.Vb.xf),w.jd=b,l=Object(qa.a)(116,this.wt.iQ(Object(qa.a)(115,a),Object(qa.a)(115,c),f,!0)),this.YQ&&this.YQ.POf([l]),this.nn&&this.pa.MR(l),this.Vb.Ba=l}finally{w&&w.dispose()}return l}fUf(a,
b,c,f,l){if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");const w=[];a=Array.clone(a);a.sort((ja,wa)=>wa.me-ja.me);c||(c=a[0]);let H;H=this.la.Ln?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;const U=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},()=>{1!==this.Fb.Fl&&(this.la.Ln?this.Fa.rf(Lb.a.PB):this.Fa.rf(Zi.a.PD))});try{U.nc(this.Vb.xf);U.jd=b;for(b=0;b<a.length;b++){if(!a[b])continue;const wa=Object(qa.a)(116,this.wt.iQ(Object(qa.a)(115,
a[b]),Object(qa.a)(115,c),H,l));ha.a.Wa(f)||(wa.Wb=f);Array.add(w,wa)}0<w.length&&this.YQ&&this.YQ.POf(w);let ja;(ja=this.pa).MR.apply(ja,w);this.Vb.Ba=w[w.length-1];this.Ge.x8a=!0}finally{U&&U.dispose()}return w}HW(a,b,c,f=null,l=null,w=!0){if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(f&&a.length!==f.length)throw Error.invalidOperation();let H=null;w&&1!==this.Fb.Fl&&(H=()=>{this.pa.R_a(a,
!0)});w=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()},H);try{w.nc(b);w.jd=c;this.m9h(w,a);const U=new Sys.StringBuilder;for(c=0;c<a.length;c++){const ja=f?f[c]:null;a[c]&&(b.gC(a[c],ja),a[c].id&&U.append(a[c].id.toString()+";"))}w.Zy[Eq.a.S$g]=U.toString();l&&b.PU([l])}finally{w&&w.dispose()}}m9h(a,b){if(1!==b.length||!b[0].ud&&ha.a.Wa(b[0].vZa))for(const c of b){if(c.lbb||c.Hj)a.Zy[Eq.a.Z7b]=!0;if(c.Op||2===c.mediaType||1===c.mediaType)a.Zy[Eq.a.sWc]=!0;c.hr&&(a.Zy[Eq.a.rWc]=
!0)}else a.Zy[Eq.a.$7b]=!0}E8a(a,b){if(!(1>b.length)){var c=this.Jb.Ad(15);try{c.nc(b[0]);const f=this.pa.aP(Array.isArray(b)?b:null);for(const l of f)a(l)}finally{c&&c.dispose()}}}Nja(a,b){this.E8a(c=>{(c=Object(qa.a)(4,c))&&a(c)},b)}}Object(n.a)(cN,"GraphTransactionHelperProxy",null,[1137]);var NE=d(298),Yp=d(299);class dN{constructor(a,b,c,f){this.Kpc=a;this.Lpc=b;this.C1c=c;this.D1c=f}H5e(a,b,c,f){a<this.Kpc&&(this.Kpc=a);b<this.Lpc&&(this.Lpc=b);a+c>this.C1c&&(this.C1c=a+c);b+f>this.D1c&&(this.D1c=
b+f)}}Object(n.a)(dN,"GroupShapeOffset",null,[]);class eN{constructor(a,b,c,f,l,w,H,U,ja,wa){this.ia=a;this.Jb=b;this.pa=c;this.Ea=f;this.ua=l;this.Sk=w;this.Fb=H;this.Ri=U;this.nJ=ja;this.la=wa}wb(){this.ia.ra(L.a.ULe,nc.a.application,Object(F.a)(this,this.Ntj,"handleGroupShapes"),4);this.ia.ra(L.a.bMe,nc.a.application,Object(F.a)(this,this.kyj,"handleUngroupShapes"),4);this.ia.ra(L.a.TLe,nc.a.application,Object(F.a)(this,this.Mtj,"handleGroupFlyoutAnchor"),4)}Ee(){const a=this.nJ.No.Fc(Lb.a.sg);
a.bindAction(x.KeyInputManager.Oa(A.a.gQb,x.KeyInputManager.Oe),L.a.ULe);a.bindAction(x.KeyInputManager.Oa(A.a.gQb,x.KeyInputManager.Oe|4),L.a.bMe)}KDf(a){let b=1<a.length&&!a[0].Og&&!a[1].Og;if(b)for(const c of a)if(this.la.yka){if(c.UGb||c.fl||c.ud){b=!1;break}}else if(c.fl||c.ud){b=!1;break}return b}lfj(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}Ntj(a,b,c){const f=this.pa.Xd();return this.KDf(f)?1===c?32:Pg.a("GroupOperations_GroupShapes",a,()=>
{const l=[];for(var w of f)l.push(w.id);w=Object(qa.a)(116,this.ua.Ba);if(!w)throw Error.argumentNull("ActiveSlide is null");const H=w.Wt(),U=new dN(w.oq,w.Vk,0,0);var ja=0;let wa=ja=0;for(var Sa of f)(ja=this.lfj(Sa),Sa.gz)?(ja=Sa.Ay,wa=Sa.By,U.H5e(ja,wa,Sa.Sca,Sa.Rca)):ja?90===ja&&(ja=Sa.Ay+Sa.wx/2-Sa.JC/2,wa=Sa.By+Sa.JC/2-Sa.wx/2,U.H5e(ja,wa,Sa.JC,Sa.wx)):(ja=Sa.Ay,wa=Sa.By,U.H5e(ja,wa,Sa.wx,Sa.JC));const eb=this.Sk.aRa(!1,w.Cb.cid,w.Cb.sid,0,10,U.Kpc,U.Lpc,U.C1c-U.Kpc,U.D1c-U.Lpc,H+1);va.a.J(595359714,
822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",f.length);this.aIj(eb,w.Cb,U.C1c-U.Kpc,U.D1c-U.Lpc);w.gC(eb);Sa=this.Jb.Ad(15,void 0,void 0,()=>{this.pa.selectShape(eb,!0)});try{Sa.nc(w),Sa.jd=a,1<l.length&&(w.V8=l)}finally{Sa&&Sa.dispose()}return 32}):8}$Df(a){for(const b of a)if(this.la.yka){if(b.If&&!b.VGb)return!0}else if(b.If)return!0;return!1}kyj(a,b,c){const f=this.pa.Xd();return this.$Df(f)?1===c?32:Pg.a("GroupOperations_UngroupShapes",a,()=>{const l=[];
var w=[];for(const U of f)if(U.If){l.push(U.id);const ja=this.Ea.ix(U);for(const wa of ja)w.push(wa);this.pa.s8(U)}for(var H of w)w=Tj.c(H,this.Fb.Ma),this.pa.s8(H),w.Cka(),w.pLb=!0;H=this.ua.Ba;va.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",f.length);w=this.Jb.Ad(15);try{w.nc(H),w.jd=a,H.opa=l}finally{w&&w.dispose()}return 32}):8}Mtj(a,b,c){b=this.pa.Xd();a=this.KDf(b);b=this.$Df(b);return 1===c?a||b?32:8:32}aIj(a,b,c,f){var l=Object(qa.a)(566,
Object(qa.a)(116,this.ua.Ba).ng(this.Fb.Ma));const w=this.Fb.Md,H=Math.round(this.Ri.JM(w.Pe(c,0),l.tT));l=Math.round(this.Ri.JM(w.Pe(f,1),l.tT));a.setValue(Za.a.wx,c);a.setValue(Za.a.JC,f);a.setValue(hb.a.aQb,c);a.setValue(hb.a.kyb,f);a.isEditable=!0;a.If=!0;a.setValue(hb.a.TK,4);a.setValue(hb.a.kmd,!0);a.Sca=Of.a.LJa(H,0);a.Rca=Of.a.LJa(l,1);a.setValue(hb.a.DRa,0);a.setValue(hb.a.ERa,0);a.setValue(hb.a.RUa,!0);a.setValue(hb.a.isResizable,!0);a.setValue(hb.a.FL,!0);a.bO=!0;a.LUa=!0;a.FL=!0;a.isResizable=
!0;a.oG=N.a.VE(b.sid,b.cid);a.Skb=a.get_shapeId();a.setValue(hb.a.jua,!0);b=Object.assign(new NE.a,{TopLeft:Object.assign(new Yp.a,{X:0,Y:0}),TopRight:Object.assign(new Yp.a,{X:H,Y:0}),BottomLeft:Object.assign(new Yp.a,{X:0,Y:l}),BottomRight:Object.assign(new Yp.a,{X:H,Y:l})});a.SU=b;this.Ea.GL(a)&&Rc.a.Ib&&(Rc.a.Ib.Oj=!0)}}Object(n.a)(eN,"GroupUngroupShapesActor",null,[365]);class fN{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=
!1}}Object(n.a)(fN,"FooterPaneInfo",null,[]);var gN=d(620);class OE{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(n.a)(OE,"PresFooterInfo",null,[]);var hN=d(647);class iN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.hma=null;a("powerpoint-editor-intl").then(()=>{va.a.J(594321887,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{va.a.J(594321885,
801,50,"Header Footer Pane Manager script is loaded successfully");this.hma=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();this.UVk()}).catch(Ub=>{va.a.J(594321883,801,10,"Failed to load headerfooter pane manager "+Ub.toString())})}).catch(Ub=>{va.a.J(594321881,801,10,"Failed to load powerpoint-editor-intl "+Ub.toString())});this.ob=b;this.Rb=c;this.ia=f;this.Vb=l;this.ua=w;this.Fa=H;this.Hv=U;this.Yf=ja;this.ld=wa;this.Lc=Sa;this.Jb=eb;this.Yf.tI(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));
this.Yf.vrb(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Yf.SBa(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Lc.JPa(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.ld.VBa(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Rb.RK(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"));this.pz=null;this.$Db=!1;this.vFb=ub}dispose(){this.Yf.X5(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Yf.hmd(Object(F.a)(this,this.JJ,
"onChangeRenderHeaderFooterPane"));this.Yf.l_a(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Lc.Sib(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.ld.Uib(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Rb.CY(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"))}Ee(){}wb(){this.ia.ra(L.a.qab,nc.a.application,Object(F.a)(this,this.qab,"insertFooterFlyoutMenu"),4);this.ia.ra(L.a.VY,nc.a.application,Object(F.a)(this,this.VY,"showHideHeaderFooterPane"),
4);this.ia.ra(L.a.mUa,nc.a.application,Object(F.a)(this,this.mUa,"insertSlideNumber"),4);this.ia.ra(L.a.nnc,nc.a.application,Object(F.a)(this,this.nnc,"queryHeaderFooterPane"),96)}nnc(a,b,c,f,l){(a=Object(qa.a)(Xh.a,l))&&a.Lf(this.Hv.isVisible);return 32}qab(){return this.hma&&this.Vb&&this.ua.Ba&&this.Vb.isEditingAllowed?32:8}VY(a,b,c){if(1===c)return this.Hv&&this.ua.Ba?32:8;if(!this.Hv)return 8;this.pz=null;this.Hv.isVisible=!this.Hv.isVisible;this.Hv.isVisible?(Pg.a("FooterPaneOpen",a,()=>{this.Uoc();
return 32}),this.vFb||(this.Fa.Ej(Lb.a.SI,!0),this.hma.focus())):this.Fa.Ej(Lb.a.SI,!1);return 32}mUa(a,b,c,f,l){return 1===c?this.ua.Ba?32:8:Pg.a("FooterPaneInsertSldNumber",a,()=>{const w=this.mmc();this.Nuc(w.OmitOnTitlePh,w.IsFooterInsert,w.SFooterName,!0);return this.VY(a,b,c,f,l)})}Tu(a){1===a.mode&&this.Hv&&this.Hv.isVisible&&(this.pz=null,this.Hv.isVisible=!1,this.Fa.Ej(Lb.a.SI,!1))}I9d(a){const b=new Ka.a;a=a.xC();for(const c of a)(a=zb.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}mmc(){const a=
new gN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.gk(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.fl&&(5===c.Jj?a.IsSlideNumInsert=!0:6===c.Jj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.gB?this.I9d(c):"",0<b.length?a.SFooterName=b:va.a.J(594321879,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Vb.xf.jJa;return a}isMultipleSlidesSelected(){const a=this.ob.Qe();return a&&1<a.length?!0:!1}Uoc(){if(this.Hv.isVisible)if(this.ua.Ba){var a=
this.mmc(),b=this.isMultipleSlidesSelected();if(!this.pz||a.IsFooterInsert!==this.pz.IsFooterInsert||a.IsSlideNumInsert!==this.pz.IsSlideNumInsert||a.OmitOnTitlePh!==this.pz.OmitOnTitlePh||a.SFooterName.localeCompare(this.pz.SFooterName)||b!==this.$Db){this.pz=a;this.$Db=b;var c=new fN;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.hma.renderHeaderFooterTaskPane(hN.a.Gde,c)}}else this.Hv.isVisible=
!1,this.pz=null}JJ(){this.Uoc()}UVk(){this.hma.addCloseHeaderFooterPaneEventListener(()=>{this.Hv.isVisible=!1;this.pz=null});this.hma.addFocusHeaderFooterPaneListener(()=>{this.Fa.Ej(Lb.a.SI,!0)});this.hma.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.s5e(a,b,c,f,l)});this.hma.addUpdateMultiSlideHeaderFooterListener((a,b,c,f)=>{this.E5e(a,b,c,f)})}s5e(a,b,c,f,l){this.ua.Ba&&(l?this.M5e(a,b,c,f):this.Nuc(a,b,c,f))}E5e(a,b,c,f){this.ua.Ba&&Pg.a("FooterPaneMultiSlide",L.a.VY,()=>{const l=this.Jb.Ad(15,
void 0,()=>{this.ob.jj()});try{l.nc(this.ua.Ba);const w=this.ob.Qe();if(w&&1<w.length){for(const H of w){const U=H.C8;U.IsSlideNumInsert=f;U.IsFooterInsert=b;U.OmitOnTitlePh=a;U.SFooterName=c;U.IsToggled=!U.IsToggled;H.C8=U}this.Vb.xf.jJa=a}}finally{l&&l.dispose()}return 32})}Nuc(a,b,c,f){let l="FooterPaneSingleSlide";const w=this.ua.Ba,H=w.C8;if(a||b||f)H.OmitOnTitlePh!==a?l+="_OPH":H.IsSlideNumInsert!==f?l+="_ISN":H.IsFooterInsert!==b&&(l+="_IFT");Pg.a(l,L.a.VY,()=>{const U=this.Jb.Ad(15,void 0,
()=>{this.ob.jj()});try{U.nc(this.ua.Ba),H.IsSlideNumInsert=f,H.IsFooterInsert=b,H.OmitOnTitlePh=a,H.SFooterName=c,H.IsToggled=!H.IsToggled,this.Vb.xf.jJa=a,w.C8=H}finally{U&&U.dispose()}return 32})}M5e(a,b,c,f){Pg.a("FooterPaneAllSlides",L.a.VY,()=>{const l=this.Jb.Ad(15,void 0,()=>{this.ob.jj()});try{const w=this.Vb.xf;l.nc(w);let H=w.VJa;H||(H=new OE);const U=this.ua.Ba;H.ActiveSlideCid=U.cid;H.ActiveSlideSid=U.sid;H.IsSlideNumInsert=f;H.IsFooterInsert=b;H.IsOmitOnTitlePh=a;H.SFooterName=c;H.IsToggled=
!H.IsToggled;w.jJa=a;w.VJa=H}finally{l&&l.dispose()}return 32})}}Object(n.a)(iN,"HeaderFooterPaneActor",null,[365]);class jN{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(n.a)(jN,"FooterPaneInfo",null,[]);class kN{constructor(){this.type="HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(n.a)(kN,"HeaderFooterContentProps",
null,[]);class lN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.p6c=!1;ub?this.p6c=!0:a("powerpoint-editor-intl").then(()=>{va.a.J(590210325,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{va.a.J(590210323,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>{va.a.J(590210321,801,50,"Header Footer Pane script is loaded successfully");this.p6c=!0}).catch(()=>{va.a.J(590210319,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>
{va.a.J(590210317,801,10,"Failed to load Ribbon script")})}).catch(Ub=>{va.a.J(590210315,801,10,"Failed to load powerpoint-editor-intl "+Ub.toString())});this.ob=b;this.Rb=c;this.ia=f;this.Vb=l;this.ua=w;this.Hv=U;this.Yf=ja;this.ld=wa;this.Lc=Sa;this.Jb=eb;this.Yf.tI(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Yf.vrb(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Yf.SBa(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Lc.JPa(Object(F.a)(this,
this.JJ,"onChangeRenderHeaderFooterPane"));this.ld.VBa(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Rb.RK(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"));this.pz=null;this.$Db=!1;this.vFb=ub}dispose(){this.Yf.X5(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Yf.hmd(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Yf.l_a(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Lc.Sib(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));
this.ld.Uib(Object(F.a)(this,this.JJ,"onChangeRenderHeaderFooterPane"));this.Rb.CY(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"))}Ee(){}wb(){this.ia.ra(L.a.qab,nc.a.application,Object(F.a)(this,this.qab,"insertFooterFlyoutMenu"),4);this.ia.ra(L.a.VY,nc.a.application,Object(F.a)(this,this.VY,"showHideHeaderFooterPane"),4);this.ia.ra(L.a.mUa,nc.a.application,Object(F.a)(this,this.mUa,"insertSlideNumber"),4)}qab(){return this.Vb&&this.ua.Ba&&this.Vb.isEditingAllowed?32:8}VY(a,b,c){if(1===c)return this.p6c?
32:8;if(!this.Hv)return 8;this.pz=null;this.Hv.isVisible=!this.Hv.isVisible;this.Hv.isVisible?Pg.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.vFb.toString(),a,()=>{this.Uoc();return 32}):this.Cr();return 32}Tu(a){1===a.mode&&this.Hv&&this.Hv.isVisible&&(this.pz=null,this.Hv.isVisible=!1,this.Cr())}Ql(a=!1){const b=this.yC(),c=Object.assign(new nu.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Hv.isVisible=!1},isModernPane:!0});
this.vFb?sj.UISurfaces.zr().then(f=>{a?f.updateTaskPane(Lb.a.SI,c):f.showTaskPane(Lb.a.SI,c);return null}):(this.Hv.isVisible=!0,taskPanes.taskPane.renderTaskPane(hN.a.Gde,c))}Cr(){this.vFb&&sj.UISurfaces.zr().then(a=>{a.hideTaskPane(Lb.a.SI,2);return null})}yC(){const a=new jN;a.isFooterInsert=this.pz.IsFooterInsert;a.sFooterName=this.pz.SFooterName;a.isSlideNumInsert=this.pz.IsSlideNumInsert;a.omitOnTitle=this.pz.OmitOnTitlePh;a.isMultipleSlidesSelected=this.$Db;const b=new kN;b.activeSlideFooterInfo=
a;b.onUpdateHeaderFooter=Object(F.a)(this,this.s5e,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(F.a)(this,this.E5e,"updateMultiSlidesFooterInfo");return b}mUa(a,b,c,f,l){return 1===c?this.p6c?32:8:Pg.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.vFb.toString(),a,()=>{const w=this.mmc();this.Nuc(w.OmitOnTitlePh,w.IsFooterInsert,w.SFooterName,!0);return this.VY(a,b,c,f,l)})}I9d(a){const b=new Ka.a;a=a.xC();for(const c of a)(a=zb.ParagraphReader.text(c))&&0<a.length&&b.add(a);
return b.toArray().join(" ")}mmc(){const a=new gN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.gk(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.fl&&(5===c.Jj?a.IsSlideNumInsert=!0:6===c.Jj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.gB?this.I9d(c):"",0<b.length?a.SFooterName=b:va.a.J(590210313,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Vb.xf.jJa;return a}isMultipleSlidesSelected(){const a=this.ob.Qe();return a&&1<a.length?!0:!1}Uoc(a=
!1){if(this.Hv.isVisible)if(this.ua.Ba){var b=this.mmc(),c=this.isMultipleSlidesSelected();if(!this.pz||b.IsFooterInsert!==this.pz.IsFooterInsert||b.IsSlideNumInsert!==this.pz.IsSlideNumInsert||b.OmitOnTitlePh!==this.pz.OmitOnTitlePh||b.SFooterName.localeCompare(this.pz.SFooterName)||c!==this.$Db)this.pz=b,this.$Db=c,this.Ql(a)}else this.Hv.isVisible=!1,this.pz=null}JJ(){this.Uoc(!0)}s5e(a,b,c,f,l){this.ua.Ba&&(f?this.M5e(a,b,l,c):this.Nuc(a,b,l,c))}E5e(a,b,c,f){this.ua.Ba&&Pg.a("FooterPaneMultiSlide",
L.a.VY,()=>{const l=this.Jb.Ad(15,void 0,()=>{this.ob.jj()});try{l.nc(this.ua.Ba);const w=this.ob.Qe();if(w&&1<w.length){for(const H of w){const U=H.C8;U.IsSlideNumInsert=c;U.IsFooterInsert=b;U.OmitOnTitlePh=a;U.SFooterName=f;U.IsToggled=!U.IsToggled;H.C8=U}this.Vb.xf.jJa=a}}finally{l&&l.dispose()}return 32})}Nuc(a,b,c,f){let l="FooterPaneSingleSlide";const w=this.ua.Ba,H=w.C8;if(a||b||f)H.OmitOnTitlePh!==a?l+="_OPH":H.IsSlideNumInsert!==f?l+="_ISN":H.IsFooterInsert!==b&&(l+="_IFT");Pg.a(l,L.a.VY,
()=>{const U=this.Jb.Ad(15,void 0,()=>{this.ob.jj()});try{U.nc(this.ua.Ba),H.IsSlideNumInsert=f,H.IsFooterInsert=b,H.OmitOnTitlePh=a,H.SFooterName=c,H.IsToggled=!H.IsToggled,this.Vb.xf.jJa=a,w.C8=H}finally{U&&U.dispose()}return 32})}M5e(a,b,c,f){Pg.a("FooterPaneAllSlides",L.a.VY,()=>{const l=this.Jb.Ad(15,void 0,()=>{this.ob.jj()});try{const w=this.Vb.xf;l.nc(w);let H=w.VJa;H||(H=new OE);const U=this.ua.Ba;H.ActiveSlideCid=U.cid;H.ActiveSlideSid=U.sid;H.IsSlideNumInsert=f;H.IsFooterInsert=b;H.IsOmitOnTitlePh=
a;H.SFooterName=c;H.IsToggled=!H.IsToggled;w.jJa=a;w.VJa=H}finally{l&&l.dispose()}return 32})}}Object(n.a)(lN,"HeaderFooterPaneWacActor",null,[365]);class mN{constructor(a,b,c,f,l){this.Ms=a;this.ia=b;this.Vb=c;this.ua=f;this.fc=l}wb(){this.ia.ra(L.a.MXc,Cb.a.application,Object(F.a)(this,this.guj,"handleInsertContentFromStream"),4)}Ee(){}guj(a,b,c,f,l){b=this.ua.Ba;if(this.fc.$c(b))return 16;if(1===c)return 32;Rc.a.Ak("SlideCount","1");c=this.Ms.YUi(b,l.streamUrl,l.formatType,l.objectType,l.renderAfterInsert,
a);l.renderAfterInsert&&c&&!c.KQ&&this.fc.hw(this.Vb.xf,a);return 32}}Object(n.a)(mN,"InsertContentFromStreamActor",null,[365]);class nN{constructor(a,b){this.Ri=a;this.Tb=b}iTd(a,b,c,f){const l=H=>this.Ri.JM(a.Pe(Of.a.qf(H,0),0),f),w=Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));return Object.assign(new NE.a,{TopLeft:Object.assign(new Yp.a,{X:0,Y:0}),TopRight:Object.assign(new Yp.a,{X:w,Y:0}),BottomLeft:Object.assign(new Yp.a,{X:0,Y:b}),BottomRight:Object.assign(new Yp.a,
{X:w,Y:b})})}ZWd(a,b,c){var f=a?a.Wce:9;const l=Of.a.Pe(a?a.U6e:6,0,!1);f=Of.a.Pe(f,1,!1);b=this.ayi(l,f,b,c);a=a?a.kxb(b.width,b.height,!0):this.Tb.Eta(b.width,b.height);return{E3d:b,mD:a}}ayi(a,b,c,f){let l=0,w=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),w=Math.max(f*a,1));return new gr.a(l,w)}}Object(n.a)(nN,"InsertImageHelper",null,[1168]);var Zd=d(685),kA=d(684);class oN{j7f(a,b,c,f){b=a.right-a.left;let l=a.bottom-a.top;b=Math.max(b,1);l=Math.max(l,1);Pd.a("FixInkDotInsertionAtHighZooms")?
(a=f.JM(b,c),c=f.JM(l,c)):(a=Math.round(f.JM(b,c)),c=Math.round(f.JM(l,c)));return{Qth:a,Ith:c}}kKf(a,b,c){return Object.assign(new NE.a,{TopLeft:Object.assign(new Yp.a,{X:0,Y:0}),TopRight:Object.assign(new Yp.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new Yp.a,{X:0,Y:b*c}),BottomRight:Object.assign(new Yp.a,{X:a*c,Y:b*c})})}wrh(){}Hrh(){}}Object(n.a)(oN,"InsertInkActorHelper",null,[746]);var zR=d(505);class lA{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.Z9=ub;this.Ms=a;this.ia=b;this.ua=c;this.fc=
f;this.Fb=l;this.Ou=U;this.Sk=ja;this.Zj=wa;this.Ea=Sa;this.Ri=eb}dispose(){}wb(){this.ia.ra(L.a.Ofg,Cb.a.application,Object(F.a)(this,this.huj,"handleInsertInk"),4)}Ee(){}huj(a,b,c,f,l){if(!l)return 16;b=l.Fd;if(!b)return va.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;f=b.Cb;if(N.a.mx(f)||this.fc.$c(b))return 16;if(1===c)return 32;c=this.x9a(a);if(!c)return 8;if(!this.Zj.OF(b,1))return this.Zj.mG(b),16;var w=l.OHj;if(!w)return va.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),
8;if(!w.count)return va.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new Ka.a;for(let Sa of w){w=Sa.Wji;if(!w)return 16;var H=b.Uw;H=H&&null!=H.Zr?H.Zr:1;w.right=w.left+(w.right-w.left)/(1/H);w.bottom=w.top+(w.bottom-w.top)/(1/H);var U=w.right-w.left,ja=w.bottom-w.top;U=Math.max(U,1);ja=Math.max(ja,1);var wa=this.Fb.Md;U=Of.a.qf(U,0);ja=Of.a.qf(ja,1);const eb=wa.qf(w.left,0);wa=wa.qf(w.top,1);const ub=b.Wt();w=kA.a.sMc(f,c,H,w,new oN,eb,wa,U,ja,ub,this.Ea,this.Sk,this.Fb,
this.ua,this.Ri);w.setValue(hb.a.Mka,Sa.json);w.setValue(hb.a.sFa,!0);Rc.a.Ib&&(Rc.a.Ib.actionName=lA.QVc);w.uI=new zR.a([Sa.stroke],Sa.json,!1);l.add(w)}this.Ms.HW(l.toArray(),b,a,void 0,void 0,!1);for(let Sa of l)this.Z9.registerInkWithStrokeCollection(Sa.uI.Xya,Sa.id);this.Ou.SF=l.ga(l.count-1);return 32}x9a(){return new Zd.a(4,10,1,1)}}lA.QVc="InsertInk";Object(n.a)(lA,"InsertInkActor",null,[365,106]);class pN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa){this.Dj=null;this.Y6c=!1;this.Fb=a;this.Sk=b;
this.Fa=c;this.ua=f;this.Tb=l;this.pa=H;this.Ou=U;this.Zj=ja;this.Jb=wa;this.fc=Sa;this.la=w;this.yIl=w.insertOnlineVideoUrlPatterns;this.ylh=w.insertOnlineVideoEndpoint;this.Ds=u.AFrameworkApplication.Ke;this.nxl=3E4}get startTime(){return this.Dj}cWi(a){if(!a)return null;const b=a.trim();this.PPj(b)&&(va.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.dWi(b));return a}Iog(a){if(!a)return!1;a=a.trim();for(const b of this.yIl)if((new RegExp(b)).test(a))return!0;return!1}JYj(a){if(!a)return!1;
a=a.trim();a=ig.a.YD(a).toLowerCase();return!this.la.Pab&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===a||!this.la.CAb&&("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}eBl(a,b){this.requestVideoData(a,c=>{this.agg(c)},b)}requestVideoData(a,b,c){this.Y6c?va.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):(this.Y6c=!0,c=c||Object(F.a)(this,this.nPi,"doNothingCallback"),this.Dj=new Date,a=ha.a.Ne(a),a=this.ylh+(0<this.ylh.indexOf("?")?
"&":"?")+"url="+a,this.Ds.nj(a,1,null,null,!1,2,f=>{b(f);this.Y6c=!1},f=>{c(f);this.Y6c=!1},null,void 0,void 0,void 0,this.nxl,Jx.a("1")))}agg(a){var b=+new Date-+this.startTime;va.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);Rc.a.Ak("HubbleCallDuration",b.toString());if((b=this.ua.Ba)&&!this.fc.$c(b)&&this.Zj.OF(b,1))try{const U=b.G3(this.pa.Xd());if(!U||!this.fc.$c(U)){var c=this.l$a(b,U),f=JSON.parse(a.data.Wd),l=f.width,w=f.height;c.zWe(f.embed_url,
f.thumbnail_url,f.title,f.description,0<l?l:0,0<w?w:0);var H=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()},()=>{this.pa.selectShape(c,!0)});try{H.kd(b),this.la.mzl&&(H.jd=L.a.dua,H.Zy[Eq.a.rDa]=Eq.a.online),U&&b.PU([U]),b.gC(c)}finally{H&&H.dispose()}this.fc.hw(b,"InsertOnlineVideo");this.Ou.SF=c;va.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(U){va.a.J(38322706,352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",
U.message,U.stack)}else this.Zj.mG(b)}nPi(){}l$a(a,b){if(!a)return null;var c=a.Cb;a=a.Wt();let f;const l=Pf.a.hY,w=Pf.a.y5;f=b?b.kxb(Pf.a.hY,Pf.a.y5):this.Tb.Eta(Pf.a.hY,Pf.a.y5);const H=b?0:0*Iq.a.RS;c=this.Sk.nsa(!0,c.cid,c.sid,0,f.x+H,f.y+H,l,w,a+1,!0);b&&(c.vca=b.id);return c}dWi(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return va.a.J(38322708,352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=
a.substr(b+1)}PPj(a){return a?RegExp(".*iframe.*").test(a):!1}Y1f(a){if(!a)return"NA";let b=a.indexOf(".com/");if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(n.a)(pN,"InsertOnlineVideoDialogHelper",null,[1138]);var qN=d(1030);class Pj{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg){this.YDb=this.AHa=0;if(!Cc)throw Error.argumentNull("insertShapeOverlayViewStateManager");
if(!Ve)throw Error.argumentNull("appFrame");if(!af)throw Error.argumentNull("viewEventNotifier");this.Ms=a;this.ia=b;this.Fa=c;this.pa=f;this.oO=0;this.ua=ja;this.fc=l;this.Fb=w;this.zGa=H;this.Ou=Sa;this.iRg=U;this.Yf=wa;this.wt=ja.presentation;this.Sk=eb;this.Zj=ub;this.r7c=Ub;this.QXa=cc;this.Ea=Fc;this.Ri=Ic;this.OWa=Cc;this.Kea=Ud;this.Vec=je;this.G6c=Vd;this.Rb=Ve;this.je=af;this.Bcb=Zf;this.Ihc=lg;this.Yf.tI(Object(F.a)(this,this.iZa,"onSlideNavigation"));this.iRg.kk(Object(F.a)(this,this.ehb,
"onPresentationPropertyChanged"));this.Vec&&(this.Rb.RK(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched")),this.je.m6a(Object(F.a)(this,this.Cfa,"onRibbonTabSwitched")),this.je.e$h(Object(F.a)(this,this.a4g,"onEscapeKeyPressed")));Pj.ued.push(L.a.hYc);Pj.ued.push(L.a.fYc);this.eDf()}dispose(){this.iRg.Rm(Object(F.a)(this,this.ehb,"onPresentationPropertyChanged"));this.Yf.X5(Object(F.a)(this,this.iZa,"onSlideNavigation"));this.Vec&&(this.Rb.CY(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched")),this.je.Qoc(Object(F.a)(this,
this.Cfa,"onRibbonTabSwitched")),this.je.DZk(Object(F.a)(this,this.a4g,"onEscapeKeyPressed")))}wb(){for(const a of Pj.iwl)this.ia.ra(a,Cb.a.application,Object(F.a)(this,this.vag,"handleInsertShape"),4);for(const a of Pj.ted)this.ia.ra(a,Cb.a.application,Object(F.a)(this,this.vag,"handleInsertShape"),4);this.ia.ra(L.a.aYc,Cb.a.application,Object(F.a)(this,this.juj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.ra(L.a.kYc,Cb.a.application,Object(F.a)(this,this.kuj,"handleInsertShapeTextBoxAtSpecifiedLocation"),
4);this.ia.ra(L.a.Mqi,Cb.a.application,Object(F.a)(this,this.O$f,"handleCancelInsertShape"),4);this.ia.ra(L.a.gEf,Cb.a.application,Object(F.a)(this,this.O$f,"handleCancelInsertShape"),4);this.ia.ra(L.a.p8a,Cb.a.application,Object(F.a)(this,this.htj,"handleDuplicateShape"),4)}Ee(){this.Fa.Fc(Lb.a.sg).bindAction(x.KeyInputManager.Oa(A.a.HMa,x.KeyInputManager.Oe),L.a.p8a);this.Fa.Fc(Lb.a.kQ).bindAction(x.KeyInputManager.Oa(A.a.HMa,x.KeyInputManager.Oe),L.a.p8a)}eDf(){if(this.wt){var a=Math.min(this.wt.Jpl,
this.wt.npl);a=Math.max(a-50,0);this.AHa=Math.floor(a/(2*Iq.a.RS))-1;this.AHa=Math.max(this.AHa,0);this.YDb=-1*this.AHa}else this.AHa=1,this.YDb=-1}ehb(a,b){b.property!==hb.a.slideWidth&&b.property!==hb.a.slideHeight||this.eDf()}iZa(){this.oO=0;this.Vec&&this.Kga(0)}Tu(a){1===a.mode&&this.Kga(0)}Cfa(){this.Kga(0)}a4g(){this.Kga(0)}Kga(a){1===a&&this.Fa.Ed();this.OWa.Q2e(a)}vag(a,b,c,f,l){b=this.ua.Ba;if(!b)return 16;f=b.Cb;if(N.a.mx(f)||this.fc.$c(b))return 16;if(1===c)return 32;c=this.x9a(a);if(!c)return 8;
if(!this.Zj.OF(b,1))return this.Zj.mG(b),16;const w=this.r7c&&this.QXa.XI;var H=b.Jd.HasDefaultShape,U=b.Jd.HasDefaultLine,ja=95===c.sga||97===c.sga||Array.contains(kA.a.ooe,c.sga);U=U&&ja;H=H&&!ja;ja=!1;l&&(Vm.a.Iu in l?l=l[Vm.a.Iu]:(va.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",l),l=0),ja=!Array.contains(Pj.dqk,l));if(ja){if(a===L.a.ZEa)return this.Kga(1),this.Kea.instance.Ryb=-1,32;if(w&&!Array.contains(Pj.ued,a)&&!H&&!U){this.Kga(2);if(null==this.Kea.instance)throw Error.argumentNull("insertShapeOverlayViewElement");
this.Kea.instance.Ryb=a;return 32}}this.Kga(0);let wa,Sa;var eb=this.wt.slideWidth,ub=this.wt.slideHeight;ja=new gd.a((eb-c.width*te.a.aD)/2,(ub-c.height*te.a.aD)/2);l=ja.x+Of.a.qf(this.oO*Iq.a.RS,0);Sa=ja.y+Of.a.qf(this.oO*Iq.a.RS,1);w?(ja=c.width*te.a.aD,wa=c.height*te.a.aD):(ja=Of.a.qf(Pj.w_b,0),wa=Of.a.qf(Pj.v_b,1),l=eb/2-Of.a.qf(Pj.w_b/2-this.oO*Iq.a.RS,0),Sa=ub/2-Of.a.qf(Pj.v_b/2-this.oO*Iq.a.RS,1));this.oO++;this.oO>this.AHa&&(this.oO=this.YDb);eb=b.Wt();ub=Object(qa.a)(566,this.ua.Ba.ng(this.Fb.Ma));
Rc.a.Ib&&(U||H)&&Rc.a.Ib.Va(Bh.a.x3d,U?"HasDefaultLine":"HasDefaultShape");!w||a===L.a.ZEa||Array.contains(Pj.ued,a)||H||U?f=this.Sk.aRa(!1,f.cid,f.sid,0,c.shapeType,l,Sa,ja,wa,eb+1):(f=kA.a.sMc(f,c,ub.tT,null,new qN.a,l,Sa,ja,wa,eb,this.Ea,this.Sk,this.Fb,this.ua,this.Ri),Rc.a.Ib&&(Rc.a.Ib.actionName=Pj.QVc));Pd.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===L.a.ZEa&&(this.Dtf(),this.deb=f);f.isEditable=!Array.contains(Pj.ted,a);this.Ms.HW([f],b,a);this.Ou.SF=f;this.guc();return 32}Dtf(){this.sxe||
(this.Ihc.Dia(this.woh.bind(this)),this.Yf.l6a(this.y_g.bind(this)),this.sxe=!0)}EYk(){this.sxe&&(this.Ihc.zKb(this.woh.bind(this)),this.Yf.Poc(this.y_g.bind(this)),this.sxe=!1)}woh(a,b){a=b.node;null!=a&&a==this.deb&&(this.deb=a,this.EGg=b.revisionId.toString())}y_g(a,b){b.MH&&b.MH.Id&&this.EGg==b.MH.Id&&(null==this.deb||this.Bcb.i9(this.deb)||setTimeout(()=>{this.ia.La(L.a.fQa,2,new uo.a(this.deb,!0,null));this.EYk();this.EGg=this.deb=null},0))}kuj(a,b,c,f,l){if(1===c)return 2;this.Kga(0);b=this.ua.Ba;
if(!b)return 16;f=b.Cb;if(N.a.mx(f)||this.fc.$c(b))return 16;c=this.x9a(a);if(!c)return 16;if(!this.Zj.OF(b,1))return this.Zj.mG(b),16;this.oO++;this.oO>this.AHa&&(this.oO=this.YDb);if(!Pd.a("IsAnyOffsetZeroForTextbox")){if(!(l&&l.left&&l.right&&l.bottom&&l.top))return va.a.J(512349791,829,10,"Invalid offsets : {0}",l),16}else if(!l)return va.a.J(512336011,829,10,"Invalid offsets"),16;const w=this.ua.Ba.Uw.Zr;let H=Of.a.qf(this.Ri.JM(l.right-l.left,w),0),U=Of.a.qf(this.Ri.JM(l.bottom-l.top,w),1);
U||H||(this.G6c?(H=c.width*te.a.aD,U=c.height*te.a.aD):(H=Of.a.qf(Pj.Bni,0),U=Of.a.qf(Pj.Ani,1)));H=H?H:Of.a.qf(Pj.eoi,0);U=U?U:Of.a.qf(Pj.doi,1);const ja=Of.a.qf(this.Ri.JM(l.left,w),0);l=Of.a.qf(this.Ri.JM(l.top,w),1);l=this.Sk.aRa(!1,f.cid,f.sid,0,c.shapeType,ja,l,H,U,b.Wt()+1);if(!l)return va.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;Pd.a("FixNarratorTextBoxBug")&&(l.setValue(hb.a.TK,c.sga),l.setValue(hb.a.ux,!0));Pd.a("MoveCursorToTextboxAfterInsert")&&
this.Dtf();l.isEditable=!Array.contains(Pj.ted,a);this.deb=l;this.Ms.HW([l],b,a);this.Ou.SF=l;this.guc();va.a.J(512349789,829,50,"Successfully inserted the textbox at specified location");return 32}juj(a,b,c,f,l){if(1===c)return va.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.Kga(0);b=this.ua.Ba;if(!b)return va.a.J(512349510,829,10,"slideNode is null"),16;c=b.Cb;if(N.a.mx(c))return va.a.J(512349509,829,10,"slideNode is fake"),16;if(this.fc.$c(b))return va.a.J(512349508,829,
10,"GraphNodeAndParent is blocked"),16;f=this.x9a(l.insertShapeActionId);if(!f)return va.a.J(512349507,829,10,"autoShapeProps is null"),16;if(!this.Zj.OF(b,1))return this.Zj.mG(b),16;var w=l.offsets;if(!w)return va.a.J(512349788,829,10,"Invalid offsets"),16;const H=this.ua.Ba.ng(this.Fb.Ma);let U=this.Fb.Md.qf(w.right-w.left,0),ja=this.Fb.Md.qf(w.bottom-w.top,1);ja||U||(U=f.width*te.a.aD,ja=f.height*te.a.aD);const wa=this.Fb.Md.qf(w.left,0);w=this.Fb.Md.qf(w.top,1);f.height=ja/te.a.aD;f.width=U/te.a.aD;
const Sa=b.Wt();c=kA.a.sMc(c,f,H.tT,null,new qN.a,wa,w,U,ja,Sa,this.Ea,this.Sk,this.Fb,this.ua,this.Ri);Rc.a.Ib&&(Rc.a.Ib.actionName=Pj.QVc);if(!c)return va.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=!Array.contains(Pj.ted,a);l.insertLocalShape?b.gC(c,null):(this.Ms.HW([c],b,a),this.Kea.instance.Ryb=-1,this.Ou.SF=c,this.guc());l.node=c;va.a.J(512349786,829,50,"Successfully inserted the shape at specified location");return 32}O$f(a,b,c){if(1===
c)return 32;this.Kga(0);return 32}x9a(a){switch(a){case L.a.ZEa:return new Zd.a(4,16,.5,3);case L.a.kYc:return new Zd.a(4,16,.5,3);case L.a.kge:return new Zd.a(34,9,1,1);case L.a.eie:return new Zd.a(2,17,1,1.16);case L.a.Ahe:return new Zd.a(3,55,1,1);case L.a.khe:return new Zd.a(6,56,1,1.33);case L.a.die:return new Zd.a(7,57,1.33,1);case L.a.Zfe:return new Zd.a(5,58,1,1);case L.a.Ghe:return new Zd.a(9,59,1,1.05);case L.a.tge:return new Zd.a(10,60,1,1.16);case L.a.sge:return new Zd.a(11,61,1,1);case L.a.ghe:return new Zd.a(12,
62,1,1);case L.a.Vfe:return new Zd.a(13,63,1,1);case L.a.cge:return new Zd.a(14,64,1,1);case L.a.mhe:return new Zd.a(39,65,1,1);case L.a.Gfe:return new Zd.a(87,66,1,1);case L.a.bie:return new Zd.a(35,67,1,1);case L.a.pge:return new Zd.a(83,68,1,1);case L.a.qge:return new Zd.a(84,69,1,1);case L.a.wge:return new Zd.a(85,70,1,1);case L.a.Yfe:return new Zd.a(86,71,1,1);case L.a.Mfe:return new Zd.a(130,72,1,1);case L.a.nhe:return new Zd.a(33,73,1,1);case L.a.Dfe:return new Zd.a(73,7,1.33,1);case L.a.Nfe:return new Zd.a(72,
8,1.33,1.33);case L.a.Bfe:return new Zd.a(82,74,1.14,1.14);case L.a.dge:return new Zd.a(41,75,1,1);case L.a.ehe:return new Zd.a(42,76,1,1);case L.a.Cfe:return new Zd.a(40,77,1,1);case L.a.oge:return new Zd.a(81,78,1,1);case L.a.Ihe:return new Zd.a(78,79,1,1);case L.a.rge:return new Zd.a(75,18,1,1);case L.a.Gge:return new Zd.a(74,80,1,1);case L.a.aie:return new Zd.a(76,81,1,1);case L.a.che:return new Zd.a(77,82,1,.5);case L.a.Ife:return new Zd.a(120,83,1,1);case L.a.yfe:return new Zd.a(88,84,1,1);
case L.a.fge:return new Zd.a(93,85,1,1);case L.a.ege:return new Zd.a(94,86,1,1.17);case L.a.Bge:return new Zd.a(89,87,1,.08);case L.a.zhe:return new Zd.a(90,88,1,.08);case L.a.zge:return new Zd.a(91,89,1,.17);case L.a.yhe:return new Zd.a(92,90,1,.17);case L.a.ahe:return new Zd.a(175,19,1,1);case L.a.Yge:return new Zd.a(176,20,1,1);case L.a.Zge:return new Zd.a(177,21,1,1);case L.a.Wge:return new Zd.a(178,22,1,1);case L.a.Xge:return new Zd.a(179,23,1,1);case L.a.$ge:return new Zd.a(180,24,1,1);case L.a.hYc:return new Zd.a(95,
12,1,1);case L.a.iYc:return new Zd.a(95,13,1,1);case L.a.jYc:return new Zd.a(95,14,1,1);case L.a.fYc:return new Zd.a(97,26,1,1);case L.a.eYc:return new Zd.a(97,155,1,1);case L.a.gYc:return new Zd.a(97,156,1,1);case L.a.cYc:return new Zd.a(101,25,1,1);case L.a.bYc:return new Zd.a(101,153,1,1);case L.a.dYc:return new Zd.a(101,154,1,1);case L.a.hge:return new Zd.a(46,0,1.07,.53);case L.a.xge:return new Zd.a(44,1,.53,1.07);case L.a.Cge:return new Zd.a(50,2,.53,1.33);case L.a.whe:return new Zd.a(43,3,
.53,1.07);case L.a.gie:return new Zd.a(45,4,1.07,.53);case L.a.iie:return new Zd.a(51,5,1.33,.53);case L.a.Ege:return new Zd.a(53,27,.93,1.33);case L.a.zfe:return new Zd.a(62,28,.95,.89);case L.a.fie:return new Zd.a(63,29,.96,.97);case L.a.Fge:return new Zd.a(52,30,.93,.93);case L.a.Afe:return new Zd.a(49,31,.8,.93);case L.a.Rfe:return new Zd.a(67,32,1.33,.8);case L.a.Qfe:return new Zd.a(68,33,1.33,.8);case L.a.Sfe:return new Zd.a(69,34,.8,1.33);case L.a.Ofe:return new Zd.a(70,46,.8,1.33);case L.a.Zhe:return new Zd.a(47,
35,.53,1.07);case L.a.fhe:return new Zd.a(48,36,.53,1.07);case L.a.lhe:return new Zd.a(36,37,.53,1.07);case L.a.Ffe:return new Zd.a(37,38,.53,.53);case L.a.xhe:return new Zd.a(56,39,1,1);case L.a.ige:return new Zd.a(58,40,1,1);case L.a.yge:return new Zd.a(55,41,1,1);case L.a.hie:return new Zd.a(57,42,1,1);case L.a.Dge:return new Zd.a(59,43,.63,1.33);case L.a.the:return new Zd.a(61,44,1.33,1.33);case L.a.Hfe:return new Zd.a(64,45,1.07,1.07);case L.a.she:return new Zd.a(54,47,1.33,1.33);case L.a.uhe:return new Zd.a(4,
10,1,1);case L.a.Ehe:return new Zd.a(25,11,1,1);case L.a.Bhe:return new Zd.a(28,48,1,1);case L.a.Che:return new Zd.a(27,49,1,1);case L.a.Dhe:return new Zd.a(26,50,1,1);case L.a.Khe:return new Zd.a(29,51,1,1);case L.a.Jhe:return new Zd.a(32,52,1,1);case L.a.Lhe:return new Zd.a(31,53,1,1);case L.a.Mhe:return new Zd.a(30,54,1,1);case L.a.vhe:return new Zd.a(116,91,.67,1);case L.a.Fhe:return new Zd.a(117,6,.67,1);case L.a.jhe:return new Zd.a(118,92,.67,1);case L.a.Jfe:return new Zd.a(119,93,.67,1);case L.a.Hge:return new Zd.a(104,
94,.67,1);case L.a.Lge:return new Zd.a(105,95,.67,1);case L.a.Pge:return new Zd.a(106,96,.67,1);case L.a.Ige:return new Zd.a(107,97,.67,1);case L.a.Mge:return new Zd.a(108,98,.67,1);case L.a.Qge:return new Zd.a(109,99,.67,1);case L.a.Jge:return new Zd.a(110,100,.67,1);case L.a.Nge:return new Zd.a(111,101,.67,1);case L.a.Rge:return new Zd.a(112,102,.67,1);case L.a.Kge:return new Zd.a(113,103,.67,1);case L.a.Oge:return new Zd.a(114,104,.67,1);case L.a.Sge:return new Zd.a(115,105,.67,1);case L.a.lge:return new Zd.a(79,
106,1,1);case L.a.mge:return new Zd.a(80,107,1,1);case L.a.The:return new Zd.a(15,108,1,1);case L.a.Uhe:return new Zd.a(16,15,1,1);case L.a.Vhe:return new Zd.a(17,109,1,1);case L.a.Whe:return new Zd.a(18,110,1,1);case L.a.Xhe:return new Zd.a(19,111,1,1);case L.a.Ohe:return new Zd.a(20,112,1,1);case L.a.Phe:return new Zd.a(21,113,1,1);case L.a.Qhe:return new Zd.a(22,114,1,1);case L.a.Rhe:return new Zd.a(23,115,1,1);case L.a.She:return new Zd.a(24,116,1,1);case L.a.jie:return new Zd.a(122,117,.67,1.33);
case L.a.jge:return new Zd.a(121,118,.67,1.33);case L.a.Tfe:return new Zd.a(124,119,.83,1.33);case L.a.Pfe:return new Zd.a(123,120,.83,1.33);case L.a.kie:return new Zd.a(126,121,1.25,1.13);case L.a.uge:return new Zd.a(127,122,1.13,1.25);case L.a.lie:return new Zd.a(128,123,1,1);case L.a.gge:return new Zd.a(129,124,1,1);case L.a.qhe:return new Zd.a(131,125,.67,1);case L.a.xfe:return new Zd.a(158,126,.67,1);case L.a.Wfe:return new Zd.a(132,127,.67,1);case L.a.Ufe:return new Zd.a(133,128,.67,1);case L.a.ohe:return new Zd.a(134,
129,.67,1);case L.a.vge:return new Zd.a(135,130,.67,.67);case L.a.bge:return new Zd.a(136,131,.67,1);case L.a.dhe:return new Zd.a(137,132,.83,1.16);case L.a.cie:return new Zd.a(138,133,.33,1);case L.a.phe:return new Zd.a(139,134,.67,1.16);case L.a.Uge:return new Zd.a(140,135,.5,1);case L.a.Vge:return new Zd.a(141,136,.67,1);case L.a.Lfe:return new Zd.a(142,137,.5,.5);case L.a.hhe:return new Zd.a(159,138,.67,.67);case L.a.Efe:return new Zd.a(143,139,.88,1);case L.a.rhe:return new Zd.a(144,140,.88,
1);case L.a.$he:return new Zd.a(145,141,.67,.67);case L.a.ihe:return new Zd.a(146,142,.67,.67);case L.a.Kfe:return new Zd.a(147,143,1,.5);case L.a.Nhe:return new Zd.a(148,144,1,.5);case L.a.nge:return new Zd.a(149,145,.75,.75);case L.a.bhe:return new Zd.a(150,146,.75,.75);case L.a.Yhe:return new Zd.a(152,147,.67,1);case L.a.Xfe:return new Zd.a(157,148,.67,.67);case L.a.Hhe:return new Zd.a(153,149,.67,.67);case L.a.Tge:return new Zd.a(154,150,.67,1);case L.a.$fe:return new Zd.a(155,151,.75,1);case L.a.age:return new Zd.a(156,
152,.67,1);default:return null}}htj(a,b,c){b=this.pa.tg();if(!(b&&0<b.length&&Iq.a.M8k(b)))return 16;if(1===c)return 32;c=this.ua.Ba;if(!c)return 16;if(!this.Zj.OF(c,b.length))return this.Zj.mG(c),16;if(this.fc.$c(c))return 16;this.zGa.F$g(c,c,b,null,a);return 32}guc(){try{const a=Ab.a.instance.Ja("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){va.a.J(512349783,829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}
Pj.w_b=110;Pj.v_b=75;Pj.Bni=19;Pj.Ani=38;Pj.eoi=4;Pj.doi=4;Pj.QVc="InsertShape";Pj.iwl=[L.a.ahe,L.a.Yge,L.a.Zge,L.a.Wge,L.a.Xge,L.a.$ge,L.a.ZEa,L.a.kge,L.a.eie,L.a.Ahe,L.a.khe,L.a.die,L.a.Zfe,L.a.Ghe,L.a.tge,L.a.sge,L.a.ghe,L.a.Vfe,L.a.cge,L.a.mhe,L.a.Gfe,L.a.bie,L.a.pge,L.a.qge,L.a.wge,L.a.Yfe,L.a.Mfe,L.a.nhe,L.a.Dfe,L.a.Nfe,L.a.Bfe,L.a.dge,L.a.ehe,L.a.Cfe,L.a.oge,L.a.Ihe,L.a.rge,L.a.Gge,L.a.aie,L.a.che,L.a.Ife,L.a.yfe,L.a.fge,L.a.ege,L.a.Bge,L.a.zhe,L.a.zge,L.a.yhe,L.a.uhe,L.a.Ehe,L.a.Bhe,L.a.Che,
L.a.Dhe,L.a.Khe,L.a.Jhe,L.a.Lhe,L.a.Mhe,L.a.vhe,L.a.Fhe,L.a.jhe,L.a.Jfe,L.a.Hge,L.a.Lge,L.a.Pge,L.a.Ige,L.a.Mge,L.a.Qge,L.a.Kge,L.a.Oge,L.a.Sge,L.a.Jge,L.a.Nge,L.a.Rge,L.a.lge,L.a.mge,L.a.The,L.a.Uhe,L.a.Vhe,L.a.Whe,L.a.Xhe,L.a.Ohe,L.a.Phe,L.a.Qhe,L.a.Rhe,L.a.She,L.a.jie,L.a.jge,L.a.Tfe,L.a.Pfe,L.a.kie,L.a.uge,L.a.lie,L.a.gge,L.a.qhe,L.a.xfe,L.a.Wfe,L.a.Ufe,L.a.ohe,L.a.vge,L.a.bge,L.a.dhe,L.a.cie,L.a.phe,L.a.Uge,L.a.Vge,L.a.Lfe,L.a.hhe,L.a.Efe,L.a.rhe,L.a.$he,L.a.ihe,L.a.Kfe,L.a.Nhe,L.a.nge,L.a.bhe,
L.a.Yhe,L.a.Xfe,L.a.Hhe,L.a.Tge,L.a.$fe,L.a.age,L.a.whe,L.a.hge,L.a.xge,L.a.gie,L.a.iie,L.a.Cge,L.a.Ege,L.a.zfe,L.a.fie,L.a.Fge,L.a.Afe,L.a.Rfe,L.a.Qfe,L.a.Ofe,L.a.Sfe,L.a.Zhe,L.a.fhe,L.a.lhe,L.a.Ffe,L.a.xhe,L.a.ige,L.a.yge,L.a.hie,L.a.Dge,L.a.the,L.a.Hfe,L.a.she];Pj.ted=[L.a.hYc,L.a.iYc,L.a.jYc,L.a.cYc,L.a.bYc,L.a.dYc,L.a.fYc,L.a.eYc,L.a.gYc];Pj.ued=[L.a.iYc,L.a.jYc,L.a.cYc,L.a.bYc,L.a.dYc,L.a.eYc,L.a.gYc];Pj.dqk=[1,5];Object(n.a)(Pj,"InsertShapeActor",null,[365,106]);class rN{constructor(){this.type=
"LivePollTaskPaneProps";this.formsUrl=this.onCloseButtonClicked=null}}Object(n.a)(rN,"LivePollTaskPaneProps",null,[]);class sN{constructor(a,b,c,f,l,w,H,U){this.jM=null;this.fHa=this.Eb=!1;a.loadScript("powerpoint-live-strings").then(()=>{this.fHa=!0;va.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(ja=>{va.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+ja.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");
if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!w)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!H)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!U)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");this.e$j=b;this.f$j=c;this.ia=f;this.ua=w;this.gf=l;this.pa=H;this.Zj=U;this.cJg=Object(F.a)(this,
this.zvl,"taskPaneMessageHandler")}wb(){this.ia.ya(L.a.frd,nc.a.application,Object(F.a)(this,this.frd,"showHideLivePollPane"))}Ee(){}frd(a,b,c){return b.contextId===nc.a.application&&this.fHa?1===c?32:Pg.a("LivePollPaneToggle",a,()=>{(this.Eb=!this.Eb)?(this.Ql(),va.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.YK(),va.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}Ql(){this.yC();const a=Object.assign(new nu.a,{title:ResourceStrings.L_LivePollTaskPane,
hideHeader:!1,width:320,location:2,contentProps:this.jM,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0});sj.UISurfaces.zr().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.cJg,!1);return null}).catch(b=>{va.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}YK(){sj.UISurfaces.zr().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.cJg);return null}).catch(a=>{va.a.J(512500511,
833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}yC(){this.jM=Object.assign(new rN,{onCloseButtonClicked:Object(F.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.waj()})}waj(){return String.format("{0}{1}{2}",this.e$j,"&auth_upn=",u.AFrameworkApplication.fa.Ga("UserPrincipalName"))}onCloseButtonClicked(){this.YK()}zvl(a){if("data"in a){var b;({sv:b}=Jc.d(a.data)).returnValue&&b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&
(a=String.format("{0}{1}{2}{3}{4}",this.f$j,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",u.AFrameworkApplication.fa.Ga("UserPrincipalName")),this.iuj(a)))}}iuj(a){const b=this.ua.Ba;if(b&&!this.gf.$c(b))if(this.Zj.OF(b,1)){var c=b.Cb;b.nGi(c.sid,c.cid,a,b.Wt());b.G3(this.pa.Xd())}else this.Zj.mG(b)}}Object(n.a)(sN,"LivePollPaneActor",null,[365]);var AR=d(966);class by{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.oA=f;this.Nva=l;this.ia=a;this.fc=b;this.Fa=c;this.nJ=U;this.Vb=w;this.ua=H;this.Kc=ja;
this.Rb=wa;this.swa=Sa;this.Fb=eb}wb(){this.ia.ya(L.a.pLa,nc.a.application,Object(F.a)(this,this.pLa,"showHideNotes"));this.ia.ra(L.a.Rjd,nc.a.application,Object(F.a)(this,this.HNk,"queryNotesPaneState"),96);this.ia.ra(L.a.djd,nc.a.application,Object(F.a)(this,this.x9g,"pageScrollNotesPane"),64);this.ia.ra(L.a.cjd,nc.a.application,Object(F.a)(this,this.x9g,"pageScrollNotesPane"),64);this.ia.ya(L.a.wWe,nc.a.application,Object(F.a)(this,this.nqk,"notesResize"))}Ee(){const a=this.Fa.Fc(Zi.a.Y2);a.bindAction(x.KeyInputManager.Oa(A.a.VB,
0),L.a.djd);a.bindAction(x.KeyInputManager.Oa(A.a.UB,0),L.a.cjd)}pLa(a,b,c,f,l){if(this.Fb&&0!==this.Fb.Fl)return 2;a=this.Vb.xf;if(!this.ua.Ba||!a||this.fc.YN(a))return 16;if(1===c)return 32;l&&Object(Ya.a)(AR.a,l)?l.Arc?this.oA.uZe():this.oA.JAj():(this.oA.iAk(),this.oA.BZb()&&this.Nva.uo?this.Fa.Ej(Zi.a.Y2,!0):this.Fa.Ej(Zi.a.Y2,!1));this.nJ.zTa();return 32}HNk(a,b,c,f,l){if(!l||!Object(Ya.a)(Xh.a,l))return 8;l.Lf(this.oA.BZb());return 32}x9g(a,b,c){return 1===c?32:this.oA?(a===L.a.cjd?this.oA.xa.scrollTop+=
by.KCf:a===L.a.djd&&(this.oA.xa.scrollTop-=by.KCf),32):8}nqk(a,b,c,f,l){va.a.J(37524685,822,50,"Notes Resize Begin");if(!this.oA||!l||"number"!==typeof l)return va.a.J(37524687,822,50,"Notes Resize Fail"),8;this.oA.ufa=l;this.Kc.Ic.Bsh(1);this.Rb.Oq();this.swa.bKl();va.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.oA.lqk?"On":"Off",this.oA.ufa);return 32}}by.KCf=80;Object(n.a)(by,"NotesActor",null,[365]);class tN{constructor(a,b,c,f){this.ia=a;this.cgc=b;this.la=
c;this.TGg=0;this.LO=f}Ee(){}wb(){this.ia.ra(L.a.neh,Xd.a.frame,Object(F.a)(this,this.INk,"queryOfflineStatusHandler"),2144)}INk(a,b,c,f,l){if(1===c)return 32;switch(this.cgc.status){case 0:1===this.TGg&&(l[Fp.a.Value]=CommonUIStrings.L_Connected,l[hm.a.labelText]=CommonUIStrings.L_Connected,l[Fp.a.Visible]=!0,this.hideIcon(),fm.a.instance.Db(new Le.a(2,1,this.la.offlineLabelTimeoutInMs,()=>{this.Yml();this.LO.e6("GetOfflineStatus",!1);this.LO.HH()},90,"108")));break;case 2:l[Fp.a.Value]=CommonUIStrings.L_Disconnected;
l[hm.a.labelText]=CommonUIStrings.L_Disconnected;l[Fp.a.Visible]=!0;break;case 1:l[Fp.a.Value]=CommonUIStrings.L_Reconnecting,l[hm.a.labelText]=CommonUIStrings.L_Reconnecting,l[Fp.a.Visible]=!0}this.TGg=this.cgc.status;return 32}hideIcon(){this.irh($i.a.hidden)}Yml(){this.irh($i.a.visible)}irh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");b&&(b.style.visibility=a)}}Object(n.a)(tN,"OfflineStatusLabelActor",null,[365]);class uN{constructor(a,b,c,f,l,w,H,U){this.eFg=!1;this.gse=
null;this.ia=a;this.gf=b;this.nJ=c;this.Fa=c.No;this.Jb=f;this.pa=l;this.Ea=w;this.kq=H;this.n0=U}wb(){this.ia.ra(L.a.bringForward,nc.a.application,Object(F.a)(this,this.ZVc,"handleOrganizeAction"),4);this.ia.ra(L.a.bringToFront,nc.a.application,Object(F.a)(this,this.ZVc,"handleOrganizeAction"),4);this.ia.ra(L.a.sendBackward,nc.a.application,Object(F.a)(this,this.ZVc,"handleOrganizeAction"),4);this.ia.ra(L.a.sendToBack,nc.a.application,Object(F.a)(this,this.ZVc,"handleOrganizeAction"),4);this.ia.ra(L.a.JAf,
nc.a.application,Object(F.a)(this,this.iag,"handleFrontBackFlyout"),4);this.ia.ra(L.a.Uph,nc.a.application,Object(F.a)(this,this.iag,"handleFrontBackFlyout"),4);u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Pd.a("DelayRegisterArrangeShapesAction")?this.gse=()=>{this.ia.ra(L.a.fsb,nc.a.application,Object(F.a)(this,this.Kag,"handleOrganizeShapeAnchor"),4)}:this.ia.ra(L.a.fsb,nc.a.application,Object(F.a)(this,this.Kag,"handleOrganizeShapeAnchor"),
4)}Ee(){const a=this.nJ.No.Fc(Lb.a.sg);a.bindAction(x.KeyInputManager.Oa(A.a.kvc,x.KeyInputManager.Oe),L.a.bringForward);a.bindAction(x.KeyInputManager.Oa(A.a.kvc,x.KeyInputManager.Oe|4),L.a.bringToFront);a.bindAction(x.KeyInputManager.Oa(A.a.ivc,x.KeyInputManager.Oe),L.a.sendBackward);a.bindAction(x.KeyInputManager.Oa(A.a.ivc,x.KeyInputManager.Oe|4),L.a.sendToBack)}iag(a,b,c){return 1===c?this.pa.b4()?32:8:32}Kag(){return this.eFg?32:this.pa.b4()?32:16}ZVc(a,b,c){b=this.kq.presentation;if(!b)throw Error.argumentNull("Presentation is null");
let f=this.pa.tg();var l=this.Ea.K9a(f);l&&(this.pa.umd(l),f=this.pa.tg());if(!this.pa.b4()||this.gf.FC(f))return 16;if(1===c)return 32;switch(a){case L.a.bringForward:c=1;break;case L.a.bringToFront:c=0;break;case L.a.sendBackward:c=3;break;case L.a.sendToBack:c=2;break;default:return 8}Rc.a.Ib&&(Rc.a.Ib.Ur=!1,Rc.a.Ib.Oj=!0);1===f.length?va.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&va.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",
f.length);l=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{l.nc(f[0]);l.jd=a;const w=Object(qa.a)(116,b.AC(f[0].slideId));this.NBk(w,f,c)}finally{l&&l.dispose()}return 32}uok(a,b){const c=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{const f=this.kq.Ba,l=f.zC(a),w=f.zC(b);c.nc(l);this.vok(f,l.id,w.id)}finally{c&&c.dispose()}}Vel(){this.eFg=!0;Pd.a("DelayRegisterArrangeShapesAction")&&this.gse&&this.gse()}NBk(a,b,c){a&&b&&0<b.length&&va.a.J(51164099,815,50,"OrganizeShapes has invalid params");
let f=Qa.a.clone(a.eb(Za.a.TA));const l=[];let w=null;Qa.a.zpa(b,H=>!H.Og).length||(w=this.Ea.ys(b[0]))&&(f=Qa.a.clone(w.eb(Za.a.TA)));for(const H of b)l.push(H.id);a.c4b(c,f,l)&&(w&&w.anchor?w.anchor.glb(f,1,!1):a.anchor?a.anchor.glb(f,1,!1):va.a.J(51164101,815,50,"slideNode/groupNode should have valid anchor"))}MBk(a,b,c){var f=this.pa.Xd(),l=this.f$i(f,b);a.reverse();b=new Ka.a;f=[];let w=-1,H=!1;for(let ja=0;ja<a.length;ja++){let wa=!1;for(var U of l)if(U.equals(a[ja])){b.add(U);wa=H=!0;break}wa||
f.push(a[ja]);c.equals(a[ja])&&(w=ja)}if(H)if(-1===w)va.a.J(593514880,815,10,"Invalid param endShapeId"),H=!1;else{c=0;U=a.length;for(l=0;c<w;)a[c++]=f[l++];for(let ja of b)a[c++]=ja;for(;c<U;)a[c++]=f[l++]}a.reverse();return H}f$i(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&(f=!0),c.push(l.id);f||(c=[],c.push(b));return c}vok(a,b,c){if(a){var f=Qa.a.clone(a.eb(Za.a.TA));var l=this.n0.qda(b);var w=this.n0.qda(c);l=this.Ea.ys(l);w=this.Ea.ys(w);l?w===l&&(f=Qa.a.clone(l.eb(Za.a.TA))):w&&(c=
w.id);this.MBk(f,b,c)&&(va.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.glb(f,1,!1):va.a.J(594023564,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.glb(f,1,!1):va.a.J(51385987,815,10,"slideNode should have valid anchor"))}else va.a.J(51385955,815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(n.a)(uN,"OrganizeShapesActor",null,[365]);class vN extends Ps.a{constructor(a,b,c,f,l,w,H,U,ja){super();this.nbd=0;this.Pf=f;this.Cc=U;this.Bug=
ja;this.init(a);this.Pl("PPTClipboardActionOperation");(a=Object(qa.a)(10,H))||(a=new K.DictionaryPropertySet);a.setValue(Xl.a.Wb,ja);this.QEa(b,c,l,w,a)}wXc(){this.Sjb(this.Pf)}w7a(a){this.Gp=a;this.nbd=1}run(){if(0===this.nbd){if(1===this.Yna())return;this.nbd=1}1===this.nbd&&this.KY();this.Cc.rLj(this.Bug)&&this.Cc.Hg(!0,this.Bug)}}Object(n.a)(vN,"PPTClipboardActionOperation",Ps.a,[1236,347,348]);var wN=d(372),PE=d(538);class su{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,
Ve,af,Zf,lg,Tg,Ug,ag,ih){this.ia=a;this.pa=b;this.Fa=c;this.nA=f;this.ieb=l;this.Jb=w;this.kAg=H;this.Pb=U;this.Wea=ja;this.lEb=wa;this.Ea=Sa;this.yGa=eb;this.aM=ub;this.G7c=Ub;this.cXa=cc;this.W7j=Fc;this.jfc=Ic;this.yc=Cc;this.Tp=Ud;this.Ks=je;this.WQ=Vd;this.Rb=Ve;this.Vb=af;this.sO=Zf;this.PWa=lg;this.qU=Tg;if(Pd.a("RulerIndentBugFix")){if(!Ug)throw Error.argumentNull("paragraphIndentationReader");if(!ag)throw Error.argumentNull("paragraphEditor");}this.p$=Ug;this.Qva=ag;this.KXa=ih}wb(){this.ia.ra(L.a.nKe,
nc.a.application,Object(F.a)(this,this.Jvj,"handlePopulateFontColorDropdown"),101);this.ia.ra(L.a.D9g,nc.a.application,Object(F.a)(this,this.Lvj,"handlePopulateFontSizeDropdown"),100);this.ia.ra(L.a.kja,nc.a.application,Object(F.a)(this,this.Esj,"handleCommitShapeText"),4);this.ia.ra(L.a.Ejd,nc.a.application,Object(F.a)(this,this.leh,"queryListCommonLevel"),96);this.ia.ra(L.a.Sjd,nc.a.application,Object(F.a)(this,this.leh,"queryListCommonLevel"),96);this.ia.ra(L.a.Anc,nc.a.application,Object(F.a)(this,
this.Feh,"queryTextListMarkerGallery"),96);this.ia.ra(L.a.Bnc,nc.a.application,Object(F.a)(this,this.Feh,"queryTextListMarkerGallery"),96);this.ia.ra(L.a.Amc,nc.a.application,Object(F.a)(this,this.Qag,"handlePopulateListMarkerDropdown"),100);this.ia.ra(L.a.Bmc,nc.a.application,Object(F.a)(this,this.Qag,"handlePopulateListMarkerDropdown"),100);this.ia.ra(L.a.poe,Cb.a.view,Object(F.a)(this,this.Auj,"handleLineSpacingMenuOpen"),68);this.ia.ra(L.a.t_g,nc.a.application,Object(F.a)(this,this.Juj,"handleMoreFontColors"),
96);this.ia.ra(L.a.ymc,nc.a.application,Object(F.a)(this,this.Kuj,"handleMoreFontColorsResponse"),96);this.ia.ya(L.a.RZa,Cb.a.paragraph,Object(F.a)(this,this.RZa,"queryLineSpacing"));this.ia.ya(L.a.RZa,Cb.a.view,this.Wea);this.ia.le(L.a.RZa,96);this.ia.ya(L.a.Sna,Cb.a.paragraph,Object(F.a)(this,this.C1,"setLineSpacing"));this.ia.ya(L.a.Sna,Cb.a.view,this.Wea);this.ia.le(L.a.Sna,68);this.ia.ya(L.a.OJa,nc.a.application,Object(F.a)(this,this.OJa,"populateLineSpacingFlyout"));this.ia.ya(L.a.C9g,nc.a.application,
Object(F.a)(this,this.hvj,"handlePandoraEscapeKeyPressed"));this.ia.ya(L.a.ikb,Cb.a.paragraph,Object(F.a)(this,this.pyf,"applySpacingToParagraph"));this.ia.ya(L.a.ikb,Cb.a.view,this.Wea);this.ia.le(L.a.ikb,4);this.ia.ya(L.a.hkb,Cb.a.paragraph,Object(F.a)(this,this.pyf,"applySpacingToParagraph"));this.ia.ya(L.a.hkb,Cb.a.view,this.Wea);this.ia.le(L.a.hkb,4);this.ia.ya(L.a.Ika,Cb.a.paragraph,Object(F.a)(this,this.$rb,"applyIndentationToParagraph"));this.ia.ya(L.a.Ika,Cb.a.view,this.Wea);this.ia.le(L.a.Ika,
4);this.ia.ya(L.a.oMb,Cb.a.paragraph,Object(F.a)(this,this.$rb,"applyIndentationToParagraph"));this.ia.ya(L.a.oMb,Cb.a.view,this.Wea);this.ia.le(L.a.oMb,4);this.ia.ya(L.a.qMb,Cb.a.paragraph,Object(F.a)(this,this.$rb,"applyIndentationToParagraph"));this.ia.ya(L.a.qMb,Cb.a.view,this.Wea);this.ia.le(L.a.qMb,4);this.ia.ya(L.a.sMb,Cb.a.paragraph,Object(F.a)(this,this.$rb,"applyIndentationToParagraph"));this.ia.ya(L.a.sMb,Cb.a.view,this.Wea);this.ia.le(L.a.sMb,4);this.KXa&&(this.ia.ya(L.a.pMb,Cb.a.paragraph,
Object(F.a)(this,this.$rb,"applyIndentationToParagraph")),this.ia.ya(L.a.pMb,Cb.a.view,this.Wea),this.ia.le(L.a.pMb,4),this.ia.ya(L.a.rMb,Cb.a.paragraph,Object(F.a)(this,this.$rb,"applyIndentationToParagraph")),this.ia.ya(L.a.rMb,Cb.a.view,this.Wea),this.ia.le(L.a.rMb,4));this.ia.ra(L.a.pbh,nc.a.application,Object(F.a)(this,this.Svj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.ra(L.a.ejd,nc.a.application,Object(F.a)(this,this.Tvj,"handlePowerPointTextAnchoringAnchor"),4);this.ia.ya(L.a.d1,Cb.a.view,
this.lEb);this.ia.ya(L.a.c1,Cb.a.view,this.lEb);this.ia.ya(L.a.b1,Cb.a.view,this.lEb);this.ia.ya(L.a.d1,Cb.a.outline,Object(F.a)(this,this.Zbe,"handlePowerPointTextAnchoring"));this.ia.ya(L.a.c1,Cb.a.outline,Object(F.a)(this,this.Zbe,"handlePowerPointTextAnchoring"));this.ia.ya(L.a.b1,Cb.a.outline,Object(F.a)(this,this.Zbe,"handlePowerPointTextAnchoring"));this.ia.le(L.a.d1,4);this.ia.le(L.a.c1,4);this.ia.le(L.a.b1,4);this.ia.ya(L.a.UJb,Cb.a.view,this.lEb);this.ia.ya(L.a.UJb,Cb.a.outline,Object(F.a)(this,
this.mPe,"queryTextAnchoring"));this.ia.le(L.a.UJb,96);this.ia.ya(L.a.TJb,Cb.a.view,this.lEb);this.ia.ya(L.a.TJb,Cb.a.outline,Object(F.a)(this,this.mPe,"queryTextAnchoring"));this.ia.le(L.a.TJb,96);this.ia.ya(L.a.SJb,Cb.a.view,this.lEb);this.ia.ya(L.a.SJb,Cb.a.outline,Object(F.a)(this,this.mPe,"queryTextAnchoring"));this.ia.le(L.a.SJb,96);this.Tp&&(this.ia.ra(D.a.hRc,Cb.a.view,Object(F.a)(this,this.Gtj,"handleFormatPainterPick"),4),this.ia.ra(L.a.o5d,Cb.a.view,Object(F.a)(this,this.Frj,"handleApplyFormatToText"),
4),this.ia.ra(D.a.Xja,Cb.a.view,Object(F.a)(this,this.Ftj,"handleFormatPainterCancel"),4),this.WQ.T9h(()=>{this.sO.kVa=this.WQ.yL;this.Rb.updateCommandUI()}))}Ee(){var a=this.Fa.Fc(Lb.a.kQ);const b=this.Fa.Fc(Zi.a.Y2),c=this.Fa.Fc(Lb.a.QR),f=x.KeyInputManager.Oa(A.a.X1,0);a.bindAction(x.KeyInputManager.Oa(A.a.Mvc,0),L.a.kja);a.bindAction(f,L.a.C9g);c.bindAction(f,L.a.kja);b.bindAction(x.KeyInputManager.Oa(A.a.Tvc,2),G.a.ve);a.bindAction(x.KeyInputManager.Oa(A.a.Tvc,2),G.a.ve);this.cXa&&(a.bindAction(x.KeyInputManager.Oa(A.a.Rga,
5),L.a.rC),a.bindAction(x.KeyInputManager.Oa(A.a.dba,5),L.a.Ey));this.Tp&&(a=this.Fa.Fc(Zi.a.PD),a.Dp(f),a.bindAction(f,D.a.Xja))}Gtj(a,b,c){a=this.pa.kp();b=!1;let f=null,l=this.pa.Na.mb;const w=!!this.pa.Na&&this.pa.Na.Hl;w&&(l=this.pa.Na.ga(0));l&&(f=l.Ua);if(f){switch(f.contextId){case Cb.a.textRange:case Cb.a.paragraph:case Cb.a.endOfParagraph:case Cb.a.Of:b=!0}b&&nb.SelectionEditor.ik(f)&&oe.b(f)&&(b=!1);f.contextId===Cb.a.outline&&a.ud&&(b=!0);a&&!a.rAh&&(b=!1)}if(1===c||!b)return b?32:8;6!==
this.ia.xq?(this.WQ.yL?va.a.J(40703699,820,50,"User deactivated the Format Painter button"):(va.a.J(40703697,820,50,"User activated the Format Painter button"),this.rah(l,w,a)),this.WQ.yL=!this.WQ.yL):(va.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.rah(l,w,a));return 32}rah(a,b,c){this.WQ.sah(a);var f=a.Ua;const l=Object(qa.a)(Sd.AParagraphNode,f.node);var w=Object(qa.a)(733,this.Rb.Ld);let H=null;if(l&&w&&(H=w.zi)){w=this.Jb.oe(4);const ja=H.Bi;w.nc(H);var U=this.Pb.Mc(l);
U.rc(8);const wa=this.yc.Cs(U);let Sa=f.Qa,eb=f.Lb-f.Qa;a=!a.Cca&&a.Ye.contextId!==Cb.a.endOfParagraph;b?(Sa=0,eb=zb.ParagraphReader.textLength(l)+1):({selectionStart:Sa,zph:eb}=this.nDf(f,l,U,Sa,eb,null,!1),a&&f.contextId===Cb.a.textRange&&eb++);b=this.qU.pEa(ja);f=null;wa&&(U.Jg(16),f=Object(qa.a)(125,U.currentNode));U.LB(8);U=Object(qa.a)(116,U.currentNode);this.qU.Q5e(b,!0,l.sa(hb.a.xFa,!1),U,c,f,null,Sa,eb);(c=ja.dnc(b))&&H.hBb(c);w.dispose()}}nDf(a,b,c,f,l,w,H){switch(a.contextId){case Cb.a.Of:l=
null;H&&(l=this.PWa.y6b(a))?(l=l.Ua,f=l.Qa,l=l.Lb-l.Qa):(f=0<f?f-1:0,l=1);break;case Cb.a.paragraph:f=0;l=zb.ParagraphReader.textLength(b)+1;break;case Cb.a.endOfParagraph:f=zb.ParagraphReader.textLength(b),l=1}for(c.LB(11);c.Mta();)c.Bb(2),(a=Object(qa.a)(Sd.AParagraphNode,c.currentNode))&&(f+=zb.ParagraphReader.textLength(a)+1),c.LB(11);if(H)for(c=1;c<w.length;c++)if((H=Object(qa.a)(Id.a,w.ga(c)))&&zb.ParagraphReader.ae(H.node))switch(H.contextId){case Cb.a.textRange:l+=H.Lb-H.Qa;break;case Cb.a.Of:l+=
1;break;case Cb.a.paragraph:l+=zb.ParagraphReader.textLength(H.node)+1;break;case Cb.a.endOfParagraph:l+=1}return{selectionStart:f,zph:l}}Frj(a){if(6===this.ia.xq||this.WQ.yL){va.a.J(40703703,820,50,"User applied the Format Painter from command location: {0}",this.ia.xq);const H=this.pa.kp();if(H&&!su.KVj(H))return 2;var b=this.pa.Na.mb;if(b&&b.Ua){var c=b.Ua;const U=Object(qa.a)(Sd.AParagraphNode,c.node);var f=Object(qa.a)(733,this.Rb.Ld),l=null;if(U&&f&&(l=f.zi)){f=this.Jb.oe(15);f.nc(l);f.jd=a;
const ja=this.pa.Na.Hl;a=U.sa(hb.a.xFa,!1);if(ja)for(var w of this.pa.Na)this.WQ.eyf(w);else this.WQ.eyf(b);Rc.a.Ib&&(Rc.a.Ib.Oj=!1,Rc.a.Ib.actionName="FormatPainterApplyToText",Rc.a.Ib.tF=new Date);const wa=this.Pb.Mc(U);wa.rc(8);w=c.Qa;let Sa=c.Lb-c.Qa;ja?w=Sa=-1:{selectionStart:w,zph:Sa}=this.nDf(c,U,wa,w,Sa,b,!0);wa.Jg(8);b=Object(qa.a)(116,wa.currentNode);c=this.pa.yv();l=this.qU.pEa(l.Bi);this.qU.Q5e(l,!1,a,b,H,null,c,w,Sa);6!==this.ia.xq&&(this.WQ.yL=!1);f.dispose()}}}return 32}hvj(a,b,c,f,
l){this.Tp&&this.ia.La(D.a.Xja,c,l);Pd.a("PandoraEscapeKeyPressed")&&this.ia.La(L.a.kja,c,l);return 32}Ftj(){this.sO.kVa&&(this.WQ.yL=!1);return 32}Svj(){return this.iSf()}Tvj(){return this.iSf()}Zbe(a,b,c){let f=!1;b=this.kAg.rkj(b);var l=this.pa.an();if(b&&b.FAb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case L.a.d1:c=0;break;case L.a.c1:c=1;break;case L.a.b1:c=2;break;default:return 8}if(l)this.pa.gH()?this.Ks.zal(l,c):(b=this.Jb.oe(15),b.nc(l),b.jd=a,this.Ks.yal(this.pa.Na,c),b.dispose());
else{l=this.Jb.oe(15);try{l.nc(b),l.jd=a,b.setValue(hb.a.kP,c)}finally{l&&l.dispose()}}return 32}mPe(a,b,c,f,l){c=!1;b=this.kAg.b3f(b);f=this.pa.Na;let w=0;const H=this.pa.an();if(b.Sa(hb.a.kP)||H){switch(a){case L.a.UJb:c=H?({pxa:w}=this.yc.jud(f)).returnValue&&0===w:0===b.eb(hb.a.kP);break;case L.a.TJb:c=H?({pxa:w}=this.yc.jud(f)).returnValue&&1===w:1===b.eb(hb.a.kP);break;case L.a.SJb:c=H?({pxa:w}=this.yc.jud(f)).returnValue&&2===w:2===b.eb(hb.a.kP)}l.Lf(c);return 32}return 8}leh(a,b,c,f,l){if(this.pa.Bs())return l.Lf(!1),
32;b=this.yGa.MA(this.pa.Qj);c=!0;for(const w of b)if((b=w.al?w.node:null)?(c=this.Pb.Mc(b),c.set(b),c.rc(11),c.Jg(11),c=(b=this.nA.lw(c))?a===L.a.Ejd?1===b.listType:a===L.a.Sjd?0===b.listType:!1:!1):c=!1,!c)break;l.Lf(c);return 32}Feh(a,b,c,f,l){b=l.WZa;l=l.menuItemId;if(this.pa.Bs())return b.Lf(!1),32;f=this.yGa.MA(this.pa.Qj);c=!0;for(const H of f){if(f=H.al?H.node:null){var w=this.Pb.Mc(f);w.set(f);w.rc(11);w.Jg(11);if(f=this.nA.lw(w)){if(0===l){c=!1;break}a===L.a.Anc?(c=this.aM.AVa.ga(l).j_b,
w=this.aM.AVa.ga(l).Jsb,c=f.dyb&&0<f.z9.length&&f.z9[0]===c&&f.P$a&&f.font===w):a===L.a.Bnc?(c=this.aM.Eed.ga(l).JSd,c=!!f.propertySet&&f.propertySet.Sa(hb.a.autonumberBulletType)&&f.propertySet.eb(hb.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.Lf(c);return 32}Lvj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}Juj(a,b,c,f,l){if(1===c)return this.ia.La(L.a.renderColorPicker,1,l);u.AFrameworkApplication.Ta.La(D.a.mJb,2,l);a=new tc.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=L.a.ymc;b.hideAlphaSlider=!0;return this.ia.La(L.a.renderColorPicker,2,b)}Kuj(a,b,c,f,l){if(1===c)return this.ia.La(L.a.Sr,c,l);if(!l)return va.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=ru.a.parse(l.Color))return a=this.ia.La(L.a.Sr,
c,"@"+a.RGBColor),32===a&&this.ia.La(L.a.QBa,c,l),a;va.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}Jvj(a,b,c,f,l){if(1===c)return 32;a=(a=this.pa.uk())?a.Jd:null;b=L.a.Cxa;var w=L.a.ymc;c=this.Vb.xf.g8;if(!l.MenuId||0>ha.a.rg(l.MenuId).indexOf("floatie")){f=b.toString();w=w.toString();b=Object.assign(new Tl.a,{Id:"menuFontColor",MenuSectionList:[]});const H=Pd.a("ColorPickerHighlighterFix")?PE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
Yk.e(a,H,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.jfc));Array.add(b.MenuSectionList,Yk.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,Yk.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",w,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,Yk.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(Pd.a("ColorPickerHighlighterFix")&&(c=new gt,32===u.AFrameworkApplication.Ta.La(D.a.mJb,2,c)&&c&&!c.S4b))if(c=c.fontColor,-1===c)Yk.h(b,null,a);else if(c=Bl.i(c)||"",c=ru.a.parse(c))c=ie.Box4ColorHelper.WDa(c.aMa(),a),Yk.h(b,c,a);l.MenuItems=b}else a=
this.W7j.K0f(a,!this.jfc),l.PopulationXML=a.Lmi(b,c,L.a.ymc);return 32}Esj(a,b,c){if(!this.pa.Zz())return 16;if(1===c)return 32;a=this.pa.Xd();if(!a||1!==a.length)return 16;this.pa.selectShape(a[0],!0);this.Fa.Ed();return 32}Auj(){return 32}OJa(a,b,c,f,l){if(1===c)return 32;a=new Tl.a;a.MenuSectionList=[];b=Object.assign(new ek.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new dz.a,{Id:"buttonLineSpacing"+su.qoe[c].replace(".","_"),LabelText:su.qoe[c].substring(0,3),ExternalId:"LineSpacingButton"+
su.qoe[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}Qag(a,b,c,f,l){if(1===c)return 32;a=a===L.a.Amc?1:a===L.a.Bmc?0:14;Rc.a.Ib&&(1===a?Rc.a.Ib.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Rc.a.Ib.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>ha.a.rg(l.MenuId).indexOf("floatie")?l.MenuItems=this.Bxi(a):l.PopulationXML=this.Cxi(a);return 32}RZa(a,b,c,f,l){var w=l.MenuItemId;a=l.queryResult;c=
l.LineSpacingValue;f=l.LineSpacingUnit;let H=!1;b=this.ieb.QW(b.node);w=Cf.a.fz(b.lineSpacing.value,w)&&2===b.lineSpacing.unit;if(-1===c)f=b.lineSpacing.unit,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.unit)c=f=0;0!==f&&(H=w);a.Lf(H);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}C1(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return va.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Jb.oe(15);b=b.node;c.nc(b);c.jd=
a;b.setValue(hb.a.nX,2);a=l;this.G7c&&(a+=this.Ea.f6d(this.Ea.en(b)));b.setValue(hb.a.xx,a);c.dispose();return 32}pyf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new wN.a(l.unit,l.value);l=c.unit;c=c.value;switch(a){case L.a.ikb:b.setValue(hb.a.cea,c);b.setValue(hb.a.xla,l);break;case L.a.hkb:b.setValue(hb.a.aea,c),b.setValue(hb.a.wla,l)}return 32}$rb(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new nv.a(l.unit,l.value)).WM;c=this.p$.N8(b).WM;f=this.p$.nTa(b);switch(a){case L.a.Ika:b.setValue(Va.a.$l,
l);break;case L.a.oMb:b.setValue(Va.a.ho,l);break;case L.a.qMb:b.setValue(Va.a.ho,-l);break;case L.a.sMb:b.setValue(Va.a.ho,0);break;case L.a.pMb:this.KXa&&b.setValue(Va.a.ho,l-c);break;case L.a.rMb:this.KXa&&(this.Qva.Bv.Vjb(b,(1===f.specialIndentType?c+f.WM:c-f.WM)-l),this.Qva.Bv.rpd(b,1,l))}return 32}Cxi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');
let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=L.a.Wna;l=L.a.dKa;break;case 0:c="NumberingLibrary_";f=L.a.RJa;l=L.a.mib;break;default:c="BulletsLibrary_",f=L.a.Wna,l=L.a.dKa}for(let w=0;8>w;++w)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+w,f,l,ha.a.ue(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.K8d(a,w),this.J8d(a,w))),this.i4f(a,w),w));b.append("</Gallery>");
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}Bxi(a){const b=Object.assign(new Tl.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.Gtf(a));return b}Gtf(a){var b="",c="";let f="",l=L.a.Wna,w=L.a.dKa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=L.a.Wna;w=L.a.dKa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=L.a.RJa,w=L.a.mib,c="NumberingLibrarySection"}b=Object.assign(new ek.a,{Id:"msListMarkersPosition",
Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new yq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.Y7d(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let H=0;8>H;++H)c.GalleryItems.push(this.X7d(a,H,f+H,l.toString(),w.toString(),this.i4f(a,H)));Array.add(b.ControlList,c);return b}Y7d(a){switch(a){case 1:return"BulletLibraryGallery";case 0:return"NumberingLibraryGallery";default:return""}}X7d(a,b,c,f,l,w){a=
Object.assign(new zz,{LevelInfo:this.Pcj(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=w;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}Pcj(a,b){const c=[],f={};f.fontFamily=ea.FontUtils.oja("Calibri");if(!b)return Object.assign(new Uk,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=ea.FontUtils.oja(this.k4f(a,b));1===a?(a=this.aM.k2c.ga(b).HBf,c.push(Object.assign(new Uk,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new Uk,{textAtLevel:a,styleAtLevel:f})),
c.push(Object.assign(new Uk,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.aM.k2c.ga(b).E1g,c.push(Object.assign(new Uk,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new Uk,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new Uk,{textAtLevel:a[2],styleAtLevel:f})));return c}i4f(a,b){return 1===a?this.aM.rqg.ga(this.aM.$6b(b)):0===a?this.aM.rqg.ga(this.aM.cVc(b)):""}J8d(a,b){return b?1===a?(a=this.aM.k2c.ga(b).HBf,this.XJa([a,a,a])):0===a?(a=this.aM.k2c.ga(b).E1g,this.XJa(a)):
"":Box4Intl.Box4Strings.L_ListStyleNone}XJa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.nEa(a[0]),this.nEa(a[1]),this.nEa(a[2])):""}nEa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}K8d(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?(c.append("font-family: "),c.append(ea.FontUtils.oja(this.k4f(a,
b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}k4f(a,b){return 1===a?this.aM.AVa.ga(this.aM.$6b(b)).Jsb:0===a?"Calibri":""}iSf(){let a=16;if(this.pa.o9())return 16;const b=this.pa.kp(),c=this.pa.an();if(b&&b.FAb||c)a=32;return a}static KVj(a){return!!a&&(a.qAh||a.ud)}}su.qoe=["1.00","1.50","2.00","2.50","3.00"];Object(n.a)(su,"PandoraActor",null,[365]);const xN=a=>{const b=new Sys.StringBuilder;
for(let c of a.keys)b.append(String.format('"{0}": "{1}"',c,a.ga(c)));return"{"+b.toString(",")+"}"};var BR=d(754);class es{constructor(a,b){this.VCd=this.s3a=null;this.Ca=a;this.yAa=b;if(this.Xve=u.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.VCd=BR.a.create();this.zS=Ab.a.instance.Ja("Common.ISystemInitiatedFeedback")}get DQ(){return this.s3a}wb(){this.Ca.ra(G.a.close,Xd.a.frame,Object(F.a)(this,this.closeDocument,"closeDocument"),2176);this.Ca.ra(G.a.l4b,Xd.a.frame,
Object(F.a)(this,this.l4b,"fileProperties"),128);this.Ca.ya(G.a.Xsa,Xd.a.frame,Object(F.a)(this,this.Xsa,"fileSharing"));this.Ca.ya(G.a.oWd,Xd.a.frame,Object(F.a)(this,this.oWd,"coEditInTeams"));this.Ca.ra(G.a.copyAndEdit,Xd.a.frame,Object(F.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Ca.ra(G.a.HKb,Xd.a.frame,Object(F.a)(this,this.HKb,"replyWithChanges"),128);this.Ca.ra(G.a.Jrc,Xd.a.frame,Object(F.a)(this,this.jYi,"fileVersion"),128);this.Ca.ya(G.a.downloadACopy,Xd.a.frame,Object(F.a)(this,
this.downloadACopy,"downloadACopy"));this.Ca.ya(G.a.WPi,Xd.a.frame,ac.ActionManager.Ng);this.Ca.ra(G.a.wSe,Xd.a.frame,Object(F.a)(this,this.wSe,"reportAbuseLink"),128);this.Ca.ra(G.a.Ard,Xd.a.frame,Object(F.a)(this,this.Yrc,"signInInternal"),128);this.Ca.ya(G.a.workflow,Xd.a.frame,Object(F.a)(this,this.workflow,"workflow"));u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.ra(G.a.Djd,Xd.a.frame,Object(F.a)(this,this.Djd,"queryBreadcrumbDocName"),96);this.Ca.ra(G.a.SNe,
Xd.a.frame,Object(F.a)(this,this.SNe,"queryCopyAndEditButton"),96);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.ra(G.a.PNe,Xd.a.frame,Object(F.a)(this,this.PNe,"queryBuildVersion"),2144),this.Ca.ra(G.a.FOe,Xd.a.frame,Object(F.a)(this,this.FOe,"querySessionId"),2144));this.Ca.ya(G.a.e1b,Xd.a.frame,Object(F.a)(this,this.e1b,"conversation"));this.yAa.execute(Object(F.a)(this,this.ukc,"onHostPostmessengerCreated"));ka.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}ukc(a){this.s3a=
a;this.Xve&&(this.VCd.instance=a);ka.ULS.sendTraceTag(536987589,306,this.DQ?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.DQ))}closeDocument(a,b,c,f,l){a=2===c;c=Dj.h;l&&(c=l);return b&&a&&!this.yIc(c)?8:this.Gvi(a,c)}yIc(){return!0}Gvi(a,b){if(u.AFrameworkApplication.Aa.hb.dYe("3033402446"))return ka.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),
this.Foa(a,Ce.a.cWf,!0,{});if(u.AFrameworkApplication.cpc&&b&&b===Dj.f)return ka.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),u.AFrameworkApplication.Aa.rM(a,u.AFrameworkApplication.cpc);if(u.AFrameworkApplication.isEmbedded)return a&&ka.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(u.AFrameworkApplication.XGf){if(!a)return 32;ka.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");
try{return window.top.close(),32}catch(l){return ka.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=u.AFrameworkApplication.yKc;if(!c)return a&&ka.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=Dj.h);if(b===Dj.c||b===Dj.h)return u.AFrameworkApplication.Aa.rM(a,c);let f;if(u.AFrameworkApplication.o_a)return a&&ka.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),
f=b===Dj.d||b===Dj.b?this.Foa(a,Ce.a.HKb,u.AFrameworkApplication.avc,{["event_source"]:b}):2,32!==f?(c=b?ig.a.Ni(u.AFrameworkApplication.o_a,Dj.e,b):u.AFrameworkApplication.o_a,u.AFrameworkApplication.Aa.rM(a,c)):f;a&&ka.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===Dj.b?this.Foa(a,Ce.a.cWf,u.AFrameworkApplication.e6e,null):2;return 32!==f?u.AFrameworkApplication.Aa.rM(a,c):f}Yrc(a,b,c,f,l){a=this.Foa(2===c,Ce.a.Ard,!0,l);8===a&&(window.top.location=
u.AFrameworkApplication.signInUrl,a=32);return a}l4b(a,b,c){a=this.Foa(2===c,Ce.a.l4b,u.AFrameworkApplication.uJh,null);return 32!==a?u.AFrameworkApplication.Aa.rM(2===c,u.AFrameworkApplication.hWf):a}Xsa(a,b,c,f,l){if(1===c)return Bz.SessionStatusManager.instance.Aka?8:32;a=G.a.Qhl;b=gh.a.create().toString();f={};f.event_source=l;f[Mi.a.lrc]=b;var w=l?l.nav:null;w&&(f[Mi.a.Thl]=w);(w=l?l.scenarioId:null)&&(f[Mi.a.Uhl]=w);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=G.a.Phl);l&&"ManageAccess"===
l.SourceControlId&&(l.mode="manageAccess",a=G.a.Rhl);l&&"ShareTopBar"===l.SourceControlId&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1)&&es.Lp.raiseEvent(es.msi);(w=l?l.mode:null)&&(f[Mi.a.Shl]=w);if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",!1)){var H=l?l.additionalData:null;H&&(f[Mi.a.Sci]=H)}2===c&&(H={},H[Mi.a.lrc]=b,w&&(H.mode=w),ka.ULS.sendTraceTag(38278995,306,50,Jc.c(H)));
b=this.Foa(2===c,Ce.a.dil,u.AFrameworkApplication.g6e,f);if(32!==b){if(u.AFrameworkApplication.m4b)return l=l?ig.a.Ni(u.AFrameworkApplication.m4b,Dj.e,l):u.AFrameworkApplication.m4b,u.AFrameworkApplication.Aa.rM(2===c,l,!0);ka.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}c=ui.a.I3("PPTIsSimplifiedRibbonOn",!1);ka.ULS.sendTraceTag(509441175,306,15,"ActionName=FileSharing;SimplifiedRibbonMode={0}",c);wo.c(a);return b}oWd(a,
b,c){ka.ULS.sendTraceTag(509613976,230,50,"Attempting to Launch the currently active document in the browser tab in a Word Live Teams Meeting");try{var f=gh.a.create().toString(),l=es.ULl,w=u.AFrameworkApplication.fa.Ga("LiveInTeamsWordAppSharingUrl");const cc=new ue.QueryStringBuilder("https://teams.microsoft.com/l/meeting-share");cc.Xg("deeplinkId",f);cc.Xg("lm","deeplink");a=cc;var H=a.Xg;const Fc=new Vc.a;var U=Fc.$;const Ic=new ue.QueryStringBuilder(w);Ic.Xg("auth","2");Ic.Xg("flight","officeunihost");
Ic.Xg("source","TEAMS-ELECTRON.meetingStage.deeplink");const Cc=new Vc.a;Cc.$("fileType",ha.a.pQ(u.AFrameworkApplication.fileName).substring(1,u.AFrameworkApplication.fileName.length));Cc.$("objectUrl",u.AFrameworkApplication.fa.Ga("EditDocInClientUrl"));Cc.$("baseUrl",u.AFrameworkApplication.St.breadcrumbBrandUrl);w=Cc;var ja=w.$;{let je=u.AFrameworkApplication.fa.Ga("RootFileId"),Vd=decodeURIComponent(je);for(;je!==Vd;)je=Vd,Vd=decodeURIComponent(je);if(32>je.length){ka.ULS.sendTraceTag(509440723,
230,15,"Decoded fileId does not match expected format. Decoded id: ${fullyDecodedId}");var wa=""}else{var Sa=je.substring(je.length-32,je.length),eb=Sa.substring(0,8)+"-"+Sa.substring(8,12)+"-"+Sa.substring(12,16)+"-"+Sa.substring(16,20)+"-"+Sa.substring(20,32);RegExp("^(\\{){0,1}[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}(\\}){0,1}$").test(eb)?wa=eb:(ka.ULS.sendTraceTag(509203084,230,15,"Unable to parse the fileId from the WOPISrc ParsedFileId: ${fileIdGuid}"),
wa="")}}ja.call(w,"fileId",wa);const Ud=Jc.c(xN(Cc));Ic.Xg("subEntityId",Ud.substring(1,Ud.length-1));U.call(Fc,"appSharingUrl",Ic.toString());Fc.$("appId",l);var ub=xN(Fc);H.call(a,"appContext",ub);var Ub=cc.toString();ka.ULS.sendTraceTag(509138050,230,50,"Launched the currently active document in the browser tab in a Word Live Teams Meeting");return u.AFrameworkApplication.Aa.rM(2===c,Ub)}catch(cc){return ka.ULS.sendTraceTag(509138049,230,10,"Failed to launch the currently active document in a Word Live Teams Meeting {0}",
cc),8}}e1b(a,b,c){return this.Foa(2===c,Ce.a.e1b,!0,{})}workflow(a,b,c){a=this.Foa(2===c,Ce.a.workflow,u.AFrameworkApplication.n6e,{["WorkflowType"]:u.AFrameworkApplication.Cvc});if(32!==a){if(u.AFrameworkApplication.ywd)return u.AFrameworkApplication.Aa.rM(2===c,u.AFrameworkApplication.ywd,!0);ka.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{["Result"]:a})}return a}wSe(a,b,c){a=2===c;return b&&a&&!this.yIc(Dj.f)?8:u.AFrameworkApplication.Aa.rM(a,u.AFrameworkApplication.cpc)}copyAndEdit(a,
b,c){a={};2===c&&(a=u.AFrameworkApplication.Aa.hb.f1f());a=this.Foa(2===c,Ce.a.copyAndEdit,u.AFrameworkApplication.tJh,a);return 32!==a?u.AFrameworkApplication.Aa.rM(2===c,u.AFrameworkApplication.LXd,u.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?u.AFrameworkApplication.iG||u.AFrameworkApplication.JQ||Bz.SessionStatusManager.instance.Aka?8:32:u.AFrameworkApplication.Aa.rM(2===c,u.AFrameworkApplication.zRa,!0)}HKb(a,b,c){a=2===c;if(b&&a&&!this.yIc(Dj.d))return 8;b=this.Foa(a,
Ce.a.HKb,u.AFrameworkApplication.avc,{["event_source"]:Dj.d});return 32!==b?(b=ig.a.Ni(u.AFrameworkApplication.o_a,Dj.e,Dj.d),u.AFrameworkApplication.Aa.rM(a,b)):b}jYi(a,b,c){a=this.Foa(2===c,Ce.a.kYi,u.AFrameworkApplication.h6e,null);return 32!==a?u.AFrameworkApplication.Aa.rM(2===c,u.AFrameworkApplication.T3d):a}Djd(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=ha.a.XG(u.AFrameworkApplication.St.$w)}return 32}PNe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.hNi}return 32}FOe(a,
b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.iNi}return 32}Foa(a,b,c,f){return this.Xve?this.J9k(a,b,c,f):c?a?this.DQ.sendMessage(b,f)?32:8:32:2}J9k(a,b,c,f){return c?a?this.DQ?this.DQ.sendMessage(b,f)?32:8:(ka.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),this.VCd.execute(()=>{ka.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.DQ.sendMessage(b,
f)}),32):32:2}SNe(a,b,c,f,l){if(2===c){if(!l)return 8;u.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}es.Lp=new vc.a;es.msi="CheckEditorSuggestions";es.ULl="d7958adf-f419-46fa-941b-1b946497ef84";Object(n.a)(es,"WebAppFrameCommandUIActor",null,[]);class yN extends es{constructor(a,b,c,f,l,w,H){super(a,b);this.Pu=c;this.uE=f;this.pa=l;this.Ha=w;this.Xa=H}wb(){super.wb();this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.ya(L.a.Dbh,
Xd.a.frame,Object(F.a)(this,this.jMe,"pptoShowFileVersion"))}jMe(a,b,c){return 1===c&&this.Xa.Pda?2:this.Ca.processAction(G.a.Jrc,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.pa.Rh();this.Pu.RZe(!0,ResourceStrings.l_Loading,a);va.a.J(20187205,801,50,"PPT save and launch workflow");this.uE.C3(!1,!0,()=>{this.Wpi(l)},Object(F.a)(this,this.jya,"saveFailureCallback"));return 32}yIc(a){return a!==Dj.a||u.AFrameworkApplication.isEmbedded||u.AFrameworkApplication.XGf||u.AFrameworkApplication.yKc||this.bSj()?
!0:(va.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.La(L.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}bSj(){var a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.gK);a=u.AFrameworkApplication.Dbb&&!!a&&"teams"===a.toLowerCase();return Pd.a("ReactDialogsProtocolLaunchingTeamsFix")&&this.Ha.I1d&&a&&u.AFrameworkApplication.Aa.hb.dYe("3033402446")}Wpi(a){this.Pu.hide();super.workflow(0,
null,2,null,a)}jya(){this.Pu.hide();return!1}}Object(n.a)(yN,"PptWebAppFrameCommandUIActor",es,[]);class zN{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Fa=b;this.oc=c}wb(){this.ia.ra(L.a.qmd,nc.a.application,Object(F.a)(this,this.qmd,"replaceFonts"),4)}Ee(){const a=[this.Fa.Fc(Zi.a.PD),this.Fa.Fc(Zi.a.Y2),this.Fa.Fc(Lb.a.sg),this.Fa.Fc(Lb.a.kQ)];for(const b of a)b.bindAction(x.KeyInputManager.Oa(A.a.hQb,
x.KeyInputManager.Oe),L.a.qmd)}qmd(a,b,c){return b.contextId!==nc.a.application?2:1===c?this.oc.qj()?32:8:32}}Object(n.a)(zN,"ReplaceFontsActor",null,[]);class AN extends Sys.EventArgs{constructor(a,b,c){super();this.Y1g=a;this.qfa=b;this.Iu=c}}Object(n.a)(AN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class BN{constructor(a,b,c,f,l,w,H,U,ja){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("frameContext");if(!c)throw Error.argumentNull("ribbonUser");if(!f)throw Error.argumentNull("focusManager");
if(!H)throw Error.argumentNull("ribbonExternal");this.Fa=f;this.ia=a;this.nJ=b;this.tB=c;this.tvg=l;this.je=w;this.W6j=U;this.YGa=ja}wb(){this.ia.ya(G.a.BTe,Xd.a.frame,Object(F.a)(this,this.uyk,"onRibbonFocus"));this.ia.ra(G.a.d5k,Xd.a.frame,Object(F.a)(this,this.fxj,"handleRibbonStateChanged"),64);this.ia.ya(G.a.Ktd,nc.a.application,Object(F.a)(this,this.Ktd,"toggleRibbonState"));this.ia.ya(G.a.Qmh,Cb.a.view,Object(F.a)(this,this.gxj,"handleRibbonTabSwitched"));this.ia.ya(G.a.gnd,Cb.a.view,Object(F.a)(this,
this.gnd,"ribbonModeToggledToMLR"));this.ia.ya(G.a.hnd,Cb.a.view,Object(F.a)(this,this.hnd,"ribbonModeToggledToSLR"));db.a.get_instance().Uj(7,Object(F.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}Ee(){const a=y.FocusManager.instance().Fc(Zi.a.$Bf);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Nvc,x.KeyInputManager.Oe),G.a.Ktd);E.AFrame.lk(a,x.KeyInputManager.Oa(B.a.wk?A.a.cba:A.a.Xvd,1),G.a.BTe);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.xMa,B.a.wk?2:1),G.a.BTe);this.W6j&&
(this.nJ.Ibb.yld(sa.a.Il,window.document,Object(F.a)(this,this.wCj,"ignoreAltKeyUpOnDocument")),wE.a.instance().bQd(Object(F.a)(this,this.Ywk,"onOnlyAltKeyPressed")))}gnd(a,b,c){try{if(1===c)return 32;Pd.a("ReactMLRReuseSLRCookieForMLR")?this.ssh(!1):this.Dqc(!0);va.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.YGa&&(this.tB.aSi(),Pd.a("toggleChatPPTPane")&&(this.je.SPe(new Nz(!0)),this.vuf("ChatPPT-Exit")));this.nJ.zTa()}catch(f){va.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",
f)}return 32}hnd(a,b,c){try{if(1===c)return 32;Pd.a("ReactMLRReuseSLRCookieForMLR")||this.Dqc(!1);this.ssh(!0);va.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.YGa&&(this.tB.DPf(),Pd.a("toggleChatPPTPane")&&(this.je.SPe(new Nz(!0)),this.vuf("ChatPPT-Entry")));this.nJ.zTa()}catch(f){va.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",f)}return 32}ssh(a){ui.a.aK(u.AFrameworkApplication.fa.Ga("IsSimplifiedRibbonOnCookieName"),a.toString(),ui.a.FJ)}Dqc(a){ui.a.aK(u.AFrameworkApplication.fa.Ga("ReactRibbonMLRPreferenceCookieName"),
a.toString(),ui.a.FJ)}vuf(a){va.a.J(509616535,811,15,a)}fxj(a,b,c){if(1===c)return 32;this.nJ.zTa();return 32}Ktd(){return 32}gxj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[Vm.a.Iu]&&(a=l[Vm.a.Iu]),this.je.yQk(new AN(l.OldContextId,l.NewContextId,a)));this.Fa.Ae&&2===l[Vm.a.Iu]&&this.Fa.Ae.name===Lb.a.waa&&(b=b.view)&&!ha.a.Wa(b.FI)&&this.Fa.rf(b.FI);return 32}Ywk(){HC.a.instance.keyCode===A.a.vMa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),
this.bbg())}wCj(a){return a.qc.keyCode===A.a.vMa}bbg(){if(document.activeElement&&document.activeElement.id!==Pf.a.t0b)return this.Fa.nDh(!this.tvg.inKeytipMode,!1),32;this.Fa.Ae&&this.Fa.nDh(this.Fa.Ae.name===Lb.a.waa||this.tvg.inKeytipMode,!0);return 32}uyk(a,b,c){return 1===c?32:this.bbg()}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Po&&Sg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===
a&&3===b)va.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),this.nJ.zTa()})}}Object(n.a)(BN,"RibbonStateActor",null,[365]);class mA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(n.a)(mA,"SelectSectionAndSlidesData",null,[]);class CN{constructor(a,b,c,f,l,w,H,U,ja,wa){this.NXa=null;if(ja){if(!w)throw Error.argumentNull("SectionActor.workspace");if(!H)throw Error.argumentNull("SectionActor.presentationReader");if(!U)throw Error.argumentNull("SectionActor.selectionManager");
}this.ia=a;this.hA=b;this.ua=c;this.Sgc=f;this.Mu=l;this.Vb=w;this.oc=H;this.pa=U;this.h5=ja;this.nn=wa;this.Sgc.wF(Object(F.a)(this,this.FB,"onChildTopologyChanged"));this.ua.presentation&&(this.NXa=this.ua.presentation.Up)}wb(){this.ia.ra(L.a.tRe,Cb.a.application,Object(F.a)(this,this.Owj,"handleRemoveSection"),4);this.ia.ra(L.a.xFe,Cb.a.application,Object(F.a)(this,this.Puj,"handleMoveSectionUp"),4);this.ia.ra(L.a.wFe,Cb.a.application,Object(F.a)(this,this.Ouj,"handleMoveSectionDown"),4);this.ia.ra(L.a.R5e,
Cb.a.application,Object(F.a)(this,this.qyj,"handleUpdateSectionTitle"),4);this.ia.ra(L.a.i6a,Cb.a.application,Object(F.a)(this,this.rrj,"handleAddSection"),4)}Ee(){}qyj(a,b,c,f,l){if(1===c)return(a=this.ua.presentation)&&a.Up&&a.Up.length?32:8;if(!l)return va.a.J(509368192,822,10,"HandleUpdateSectionTitle with null action data."),8;this.hA.kVi(l);return 32}Owj(a,b,c){b=this.ua.Wz;const f=this.ua.ica;if(1===c){const l=this.ua.presentation;if(!l||!l.Up||!l.Up.length)return 8;if(!b&&1<l.Up.length)return f&&
!f.cK.length?32:8}if(2===c){va.a.J(509368163,822,50,"HandleRemoveSection called.");try{f&&this.hA.dVi(b,a),this.NXa=this.ua.presentation.Up,this.ia.La(L.a.nod,2,new mA(this.ua.Wz,this.ua.Ba.slideIndex))}catch(l){va.a.J(509368162,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}Puj(a,b,c){a=this.ua.Wz;if(1===c)return c=this.ua.presentation,!c||!c.Up||!c.Up.length||0>=a?8:32;if(2===c){va.a.J(509368161,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.hA.jUf(a,!0),this.ia.La(L.a.nod,
2,new mA(this.ua.Wz,this.ua.Ba.slideIndex)))}catch(f){va.a.J(509368160,822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}Ouj(a,b,c){a=this.ua.Wz;if(1===c)return(c=this.ua.presentation)&&c.Up&&c.Up.length&&a!==c.Up.length-1&&-1!==a?32:8;if(2===c){va.a.J(509368159,822,50,"HandleMoveSectionDown called.");try{-1!==a&&(this.hA.jUf(a,!1),this.ia.La(L.a.nod,2,new mA(this.ua.Wz,this.ua.Ba.slideIndex)))}catch(f){va.a.J(509368158,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",
f)}}return 32}rrj(a,b,c){if(2===c){b=-1;c=this.ua.Wz;va.a.J(509368157,822,50,"HandleAddSection called.");try{let f;f=this.h5&&0<=this.Vb.Axa?this.oc.ZA(this.Vb.Axa+1):this.ua.Ba;this.hA.GUi(f,a);b=this.ua.Wz;if(this.h5&&(-1!==this.Vb.Axa&&(this.Vb.Axa=-1,this.Vb.Ba=f),this.nn)){const l=this.oc.ASa(b).map(H=>this.oc.ZA(H));let w;(w=this.pa).MR.apply(w,l)}}catch(f){va.a.J(509368156,822,10,"SectionActor: Exception in HandleAddSection: {0}.",f)}-1!==b&&b!==c&&this.ia.processAction(L.a.z3e,2)}return 32}FB(a,
b){try{if(34===b.VZ&&!b.node.isDirty){const c=this.NXa?Array.clone(this.NXa):null;this.NXa=Array.clone(this.ua.presentation.Up);if(!c&&this.NXa||c.length<this.NXa.length)2===this.NXa.length&&-1===this.ua.Wz&&(this.ua.Wz=1),this.Mu?this.Mu.KPe():va.a.J(509368155,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(L.a.z3e,2)}}catch(c){va.a.J(509368154,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.Sgc.bP(Object(F.a)(this,
this.FB,"onChildTopologyChanged"))}}Object(n.a)(CN,"SectionActor",null,[365]);var DN=d(633);class EN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud){if(!Cc)throw Error.argumentNull("viewEventNotifier");this.ia=a;this.gf=b;this.Fa=c;this.$Q=f;this.Vb=l;this.ua=w;this.ob=H;this.TC=U;this.Tb=ja;this.VVa=wa;this.Ge=Sa;this.nn=eb;this.EJ=ub;this.Ea=Ub;this.Cw=cc;this.S$=Fc;this.yva=Ic;this.je=Cc;this.Oak=Ud}wb(){this.ia.ya(L.a.rtd,nc.a.application,Object(F.a)(this,this.oLb,"selectNextSlideHandler"));
this.ia.ya(L.a.std,nc.a.application,Object(F.a)(this,this.oLb,"selectNextSlideHandler"));this.ia.ya(L.a.l1a,nc.a.application,Object(F.a)(this,this.oLb,"selectNextSlideHandler"));this.ia.ya(L.a.k1a,nc.a.application,Object(F.a)(this,this.oLb,"selectNextSlideHandler"));this.ia.ya(L.a.Blb,nc.a.application,Object(F.a)(this,this.oLb,"selectNextSlideHandler"));this.ia.ya(L.a.Alb,nc.a.application,Object(F.a)(this,this.oLb,"selectNextSlideHandler"));this.nn&&(this.ia.ya(L.a.Itc,nc.a.application,Object(F.a)(this,
this.Xxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(L.a.Btc,nc.a.application,Object(F.a)(this,this.Xxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(L.a.Dtc,nc.a.application,Object(F.a)(this,this.Xxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(L.a.Ctc,nc.a.application,Object(F.a)(this,this.Xxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(L.a.Gtc,nc.a.application,Object(F.a)(this,this.Xxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(L.a.Ftc,nc.a.application,Object(F.a)(this,this.Xxb,"handleKeyboardMultiSelectSlides")),
this.ia.ya(L.a.Xnd,nc.a.application,Object(F.a)(this,this.s8k,"selectAllSlidesHandler")),this.ia.ya(L.a.M_a,nc.a.application,Object(F.a)(this,this.ixj,"handleScrollSelectedThumbnailsIntoView")));this.ia.ya(L.a.zjb,nc.a.application,Object(F.a)(this,this.hxj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.ya(L.a.G0a,nc.a.application,Object(F.a)(this,this.oph,"selectNextShapeHandler"));this.ia.ya(L.a.nNb,nc.a.application,Object(F.a)(this,this.oph,"selectNextShapeHandler"));this.ia.ya(L.a.fPb,nc.a.application,
Object(F.a)(this,this.yDl,"unselectShapesHandler"));this.ia.ya(L.a.Ypc,nc.a.application,Object(F.a)(this,this.r8k,"selectAllShapesHandler"));this.ia.ya(L.a.Hth,nc.a.application,Object(F.a)(this,this.xhl,"shapeEscapeKeyPressedHandler"));this.ia.ya(L.a.Lkb,nc.a.application,Object(F.a)(this,this.gWc,"handleSlideScopeArrowKeyboard"));this.ia.ya(L.a.Mkb,nc.a.application,Object(F.a)(this,this.gWc,"handleSlideScopeArrowKeyboard"));this.ia.ya(L.a.Nkb,nc.a.application,Object(F.a)(this,this.gWc,"handleSlideScopeArrowKeyboard"));
this.ia.ya(L.a.Okb,nc.a.application,Object(F.a)(this,this.gWc,"handleSlideScopeArrowKeyboard"));this.ia.ya(L.a.xyh,nc.a.application,Object(F.a)(this,this.Nxj,"handleSpaceKeyPressed"));this.ia.ya(L.a.Cah,nc.a.application,Object(F.a)(this,this.tGk,"playVideoCommandHandler"))}Ee(){var a=this.Fa.Fc(Zi.a.PD);const b=this.Fa.Fc(Lb.a.sg),c=this.Fa.Fc(Lb.a.kQ);a.bindAction(x.KeyInputManager.Oa(A.a.Sq,0),L.a.rtd);a.bindAction(x.KeyInputManager.Oa(A.a.Sq,4),L.a.std);a.bindAction(x.KeyInputManager.Oa(A.a.VB,
0),L.a.l1a);a.bindAction(x.KeyInputManager.Oa(A.a.Y1,0),L.a.l1a);a.bindAction(x.KeyInputManager.Oa(A.a.UB,0),L.a.k1a);a.bindAction(x.KeyInputManager.Oa(A.a.W1,0),L.a.k1a);a.bindAction(x.KeyInputManager.Oa(A.a.bF,0),L.a.Blb);a.bindAction(x.KeyInputManager.Oa(A.a.Tw,0),L.a.Alb);this.nn&&(a.bindAction(x.KeyInputManager.Oa(A.a.Y1,4),L.a.Itc),a.bindAction(x.KeyInputManager.Oa(A.a.W1,4),L.a.Btc),a.bindAction(x.KeyInputManager.Oa(A.a.bF,4),L.a.Dtc),a.bindAction(x.KeyInputManager.Oa(A.a.Tw,4),L.a.Ctc),a.bindAction(x.KeyInputManager.Oa(A.a.VB,
4),L.a.Gtc),a.bindAction(x.KeyInputManager.Oa(A.a.UB,4),L.a.Ftc),a.bindAction(x.KeyInputManager.Oa(A.a.GMa,2),L.a.Xnd));b.bindAction(x.KeyInputManager.Oa(A.a.VB,0),L.a.l1a);b.bindAction(x.KeyInputManager.Oa(A.a.UB,0),L.a.k1a);b.bindAction(x.KeyInputManager.Oa(A.a.bF,0),L.a.Blb);b.bindAction(x.KeyInputManager.Oa(A.a.Tw,0),L.a.Alb);b.bindAction(x.KeyInputManager.Oa(A.a.Sq,0),L.a.G0a);b.bindAction(x.KeyInputManager.Oa(A.a.Sq,4),L.a.nNb);b.bindAction(x.KeyInputManager.Oa(A.a.X1,0),L.a.Hth);b.bindAction(x.KeyInputManager.Oa(A.a.GMa,
2),L.a.Ypc);b.bindAction(x.KeyInputManager.Oa(A.a.O6,0),L.a.Lkb);b.bindAction(x.KeyInputManager.Oa(A.a.dba,0),L.a.Mkb);b.bindAction(x.KeyInputManager.Oa(A.a.Rga,0),L.a.Nkb);b.bindAction(x.KeyInputManager.Oa(A.a.fZ,0),L.a.Okb);a=x.KeyInputManager.Oa(A.a.VB,0);c.Dp(a);c.bindAction(a,L.a.l1a);a=x.KeyInputManager.Oa(A.a.UB,0);c.Dp(a);c.bindAction(a,L.a.k1a);b.bindAction(x.KeyInputManager.Oa(A.a.pP,0),L.a.xyh)}oLb(a,b,c){if(this.$Q.A_||this.gf.$c(this.Vb.xf))return 16;if(1===c)return 32;if(!this.Vb.xf||
!this.ua.Ba)return 16;32===this.ia.processAction(L.a.Djc,1)&&this.ia.processAction(L.a.Cjc,2);b=this.cfj(this.ua.Ba,a);if(b===this.ua.Ba.me)return 32;if(this.Cw&&a!==L.a.Blb&&a!==L.a.Alb&&(a=this.Ge.mT(b),!a||!a.ZN))return 16;this.Fa.m8===Lb.a.sg&&this.Fa.Ed();return this.Ge.IJ(b)}cfj(a,b){a=a.me;const c=this.Tb.qj();switch(b){case L.a.k1a:a=Math.min(a+1,c-1);break;case L.a.rtd:a=a+1>c-1?0:a+1;break;case L.a.l1a:a=Math.max(a-1,0);break;case L.a.std:a=0>a-1?c-1:a-1;break;case L.a.Blb:a=0;break;case L.a.Alb:a=
c-1}return a}Xxb(a,b,c){if(this.$Q.A_||this.gf.$c(this.Vb.xf)||!this.Vb.xf||!this.ua.Ba)return 16;if(1===c)return 32;32===this.ia.processAction(L.a.Djc,1)&&this.ia.processAction(L.a.Cjc,2);if(1>=this.Tb.qj())return 32;va.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");switch(a){case L.a.Itc:case L.a.Btc:case L.a.Dtc:case L.a.Ctc:this.oyj(a);break;case L.a.Gtc:case L.a.Ftc:this.gvj(a);break;default:return va.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),
8}return 32}klj(a,b){const c=[];var f=this.Tb.qj();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Tb.ZA(a))&&c.push(f);return c}oyj(a){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const b=this.ob.Qe();b.sort((Sa,eb)=>Sa.me-eb.me);const c=b[0].me,f=b[b.length-1].me,l=this.ua.Ba.me,w=this.Tb.qj();var H=[];let U=l,ja=l,wa=l;H=!0;switch(a){case L.a.Itc:1===b.length?wa=U=0<=l-1?l-1:l:l===c?ja=0<=f-1?f-1:f:c?wa=U=c-1:H=!1;break;case L.a.Btc:1===b.length?wa=ja=l<w-1?l+1:l:l===c&&f<w-1?wa=ja=f+1:l===
c&&f===w-1?H=!1:U=c+1;break;case L.a.Dtc:U=0;break;case L.a.Ctc:ja=w-1}if(this.Cw&&wa!==l&&(a=this.Ge.mT(wa),!a||!a.ZN))return;if(H){H=this.klj(U,ja);let Sa;(Sa=this.ob).MR.apply(Sa,H);this.Ge.nya(U===l?ja:U)}}gvj(a){const b=this.ob.Qe();b.sort((ja,wa)=>ja.me-wa.me);const c=b[0].me,f=b[b.length-1].me,l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");const w=l.me,H=this.Tb.qj();let U=null;if(!(1>=H)){switch(a){case L.a.Gtc:if(!w)break;(U=this.Tb.ZA(w-1))&&1<b.length&&w===f&&this.csb(b)&&
this.ob.Moc(l);break;case L.a.Ftc:w!==H-1&&(U=this.Tb.ZA(w+1))&&1<b.length&&w===c&&this.csb(b)&&this.ob.Moc(l)}if(U){if(this.Cw&&(a=U.ng(this.Ge.Ma),!a||!a.ZN))return;this.Vb.Ba=U;this.ob.j6a(U);this.Ge.nya(U.me)}}}csb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].me-a[b].me)return!1;return!0}ixj(a,b,c){if(!this.Vb.xf||!this.ua.Ba||this.gf.$c(this.Vb.xf))return 16;2===c&&this.Ge.M_a();return 32}hxj(a,b,c){if(!this.Vb.xf||!this.ua.Ba||this.gf.$c(this.Vb.xf))return 16;
2===c&&this.Ge.Snd();return 32}gWc(a,b,c){return this.ob.b4()?this.Quj(a,c):this.oxj(a,c)}oxj(a,b){if(this.nn&&1!==this.ob.Qe().length)return 8;let c;switch(a){case L.a.Lkb:case L.a.Nkb:a=L.a.k1a;c="ThumbnailPageDownNavigation";break;case L.a.Okb:case L.a.Mkb:a=L.a.l1a;c="ThumbnailPageUpNavigation";break;default:return va.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),8}Rc.a.Ib&&(Rc.a.Ib.actionName=c,Rc.a.Ib.Oj=!1,Rc.a.Ib.Ur=!0);return this.ia.processAction(a,
b)}Quj(a,b){switch(a){case L.a.Lkb:a=L.a.xjc;break;case L.a.Mkb:a=L.a.yjc;break;case L.a.Nkb:a=L.a.zjc;break;case L.a.Okb:a=L.a.Ajc;break;default:return va.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,b)}oph(a,b,c,f,l){if(this.$Q.A_)return 16;if(1===c)return 32;b=this.ua.Ba;if(!b)return 16;c=b.gk();if(!c||!c.length)return 16;this.Ed();f=this.ob.tg();if(this.ob.uLb){if(c=this.ob.uLb.ng(this.Vb.PK.Ma))c.fde(),c.lqh(!1);
f.length||f.push(this.ob.uLb);this.ob.uLb=null}f&&this.qLa(f,!1);c=null;a===L.a.G0a?c=l?l:b.b$a(f,!1,0):a===L.a.nNb&&(c=b.b$a(f,!0,0));if(!c)return ka.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.Oak){l=Object(qa.a)(Jz.a,c.ng(this.Vb.PK.Ma));if(c.uFa&&l&&a===L.a.nNb){const w=document.getElementById(DN.a.aKe+l.rT);if(w&&document.activeElement!==w)return l.qLa(),w.focus(),32}if(f.length&&(l=f[0],f=Object(qa.a)(Jz.a,l.ng(this.Vb.PK.Ma)),
l.uFa&&f&&a===L.a.G0a&&(a=document.getElementById(DN.a.aKe+f.rT))&&document.activeElement!==a))return a.focus(),32}return this.vdh(c,b)}r8k(a,b,c){if(this.$Q.A_)return 16;if(1===c)return 32;a=this.ua.Ba;if(!a)return 16;b=a.gk();if(!b.length)return 16;a=[];for(const f of b)(b=Object(qa.a)(117,f.ng(this.Vb.PK.Ma)))&&b.aq?b.qLa():(b&&b.shapeNode&&b.shapeNode.iy&&b.u1(!1),a.push(f));this.ob.R_a(a,!0);this.EJ.aRk();this.qLa(a,!0);this.Ed();return 32}s8k(a,b,c){if(1===c)return 32;a=this.ua.presentation;
if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;va.a.J(34358608,816,50,"Selected All Slides");let f;(f=this.ob).MR.apply(f,a);this.Ge.nya(this.Tb.qj()-1);return 32}xhl(a,b,c){if(1===c)return 32;this.ia.processAction(L.a.dfe,2);this.ia.processAction(L.a.fPb,2);Pd.a("RaiseEscapeKeyPressedEvent")&&this.je.mPk();return 32}yDl(a,b,c){if(!this.ob.gH())return 16;if(1===c)return 32;this.TC.sQa();a=this.ob.Xd();if(b=this.Ea.K9a(a))return a=this.Ea.yr(b),this.vdh(a,
this.ua.Ba);this.qLa(a,!1);this.ob.Rh();this.Ed();return 32}Nxj(){this.ia.processAction(L.a.Cah,2);this.yva&&this.ia.processAction(L.a.vzf,2);return 32}tGk(){if(!this.ob.vgi()&&!this.ob.wgi())return 2;const a=this.ob.Xd();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.S$.tTa(a[b]);c&&c.startPlaying()}return 32}vdh(a,b){const c=a.ng(this.Vb.PK.Ma);if(c){if(c.aq)return this.ob.Rh(),c.qLa(),c.lqh(!0),c.KR(),b=null,c.t2c?b=String.format(ResourceStrings.L_CannotEditHint,c.t2c.userName):
va.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.VVa.ogh(a,b),this.ob.uLb=a,32}else return ka.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),8;this.ob.selectShape(a,!0);(a=b.ng(this.Vb.PK.Ma))&&a.mya();c&&(c.qLa(),c.KR());return 32}Ed(){this.Vb.PK.pp||this.Fa.Ed()}qLa(a,b){for(const c of a)(a=c.ng(this.Vb.PK.Ma))&&(b?a.qLa():a.fde())}}Object(n.a)(EN,
"SelectionActor",null,[365]);class nA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(n.a)(nA,"SelectionPaneShapeNode",null,[]);var CR=d(895);class FN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic){this.Vfc=this.rR=null;a("powerpoint-editor-intl").then(()=>{va.a.J(512500438,801,50,"Icons and strings script is loaded successfully");a("selectionPaneManager").then(()=>{va.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");
this.rR=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.SWk();ja.Vel()}).catch(Cc=>{va.a.J(512500436,801,10,"Failed to load selectionPaneManager "+Cc.toString())})}).catch(Cc=>{va.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+Cc.toString())});this.ob=b;this.Rb=c;this.ia=f;this.ua=l;this.Fa=w;this.rA=H;this.aUg=U;this.Rdk=ja;this.Yf=wa;this.ld=Sa;this.Lc=eb;this.J$=ub;this.nJ=Ub;this.Ea=cc;this.zz=Fc;this.Jb=Ic;this.osg=!1;this.Yf.tI(Object(F.a)(this,this.ZYa,
"onChangeRenderSelectionPane"));this.Yf.SBa(Object(F.a)(this,this.ZYa,"onChangeRenderSelectionPane"));this.Lc.JPa(Object(F.a)(this,this.ZYa,"onChangeRenderSelectionPane"));this.ld.VBa(Object(F.a)(this,this.ZYa,"onChangeRenderSelectionPane"));this.Rb.RK(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"));this.MVa=!1;this.wRg=null}dispose(){this.Yf.X5(Object(F.a)(this,this.ZYa,"onChangeRenderSelectionPane"));this.Yf.l_a(Object(F.a)(this,this.ZYa,"onChangeRenderSelectionPane"));this.Lc.Sib(Object(F.a)(this,
this.ZYa,"onChangeRenderSelectionPane"));this.ld.Uib(Object(F.a)(this,this.ZYa,"onChangeRenderSelectionPane"));this.Rb.CY(Object(F.a)(this,this.Tu,"onAppFrameModeSwitched"))}Ee(){const a=this.Fa.Fc(Lb.a.ME);a.bindAction(x.KeyInputManager.Oa(A.a.W1a,6),L.a.dqc);a.bindAction(x.KeyInputManager.Oa(A.a.Cpa,6),L.a.$Zb)}dqc(a){return Pg.a("SelectionPaneBringBackward",a,()=>{this.MVa=!0;this.ia.processAction(L.a.sendBackward,2);va.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");
return 32})}$Zb(a){return Pg.a("SelectionPaneBringForward",a,()=>{this.MVa=!0;this.ia.processAction(L.a.bringForward,2);va.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}wb(){this.ia.ra(L.a.n6,nc.a.application,Object(F.a)(this,this.n6,"showHideSelectionPane"),4);this.ia.ra(L.a.GJb,nc.a.application,Object(F.a)(this,this.GJb,"querySelectionPane"),96);this.ia.ya(L.a.dqc,nc.a.application,Object(F.a)(this,this.dqc,"sendBackwardSelectionPane"));this.ia.ya(L.a.$Zb,
nc.a.application,Object(F.a)(this,this.$Zb,"bringForwardSelectionPane"))}GJb(a,b,c,f,l){(a=Object(qa.a)(Xh.a,l))&&a.Lf(this.rA.isVisible);return 32}n6(a,b,c){return 1===c?this.rR&&this.ua.Ba?32:8:Pg.a("SelectionPaneOpen",a,()=>{this.rA.isVisible=!this.rA.isVisible;this.tkh();this.rA.isVisible?(this.nJ.notesPane&&this.nJ.notesPane.BZb()&&this.Fa.Ed(),this.Fa.Ej(Lb.a.ME,!0),this.rR.focusShowAllButton()):this.Fa.Ej(Lb.a.ME,!1);return 32})}Tu(a){1===a.mode&&this.rA&&this.rA.isVisible&&(this.rA.isVisible=
!1,this.Fa.Ej(Lb.a.ME,!1))}nAi(){const a={};this.Vfc=new La.ScriptSharpLegacyMap;var b=this.ua.Ba,c=b?b.gk(!0):null;b=this.ob.tg();const f=new Ka.a;let l=0;if(c){c.reverse();for(const H of c)if(!H.isLocal)if(c=this.a7f(H,b),H.If){if(l++,c=this.Ea.ix(H)){c.reverse();for(const U of c){c=this.a7f(U,b);let ja=null;for(const wa of U.bB){var w=void 0;wa.ShapeId.toString()in a?(w=Object(qa.a)(nA,a[wa.ShapeId.toString()]),this.Vfc.ga(wa.ShapeId).push(U.get_shapeId())):(w=[U.get_shapeId()],this.Vfc.add(wa.ShapeId,
w),w=this.Pjj(wa,b),a[wa.ShapeId.toString()]=w,ja?ja.children.push(w):f.add(w));ja=w}ja.children.push(c)}}}else f.add(c)}0<l&&!this.osg&&(va.a.J(512500432,822,50,"SelectionPane Group count:{0}",l),this.osg=!0);return f}a7f(a,b){const c=new nA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}Pjj(a,b){const c=new nA;c.shapeId=a.ShapeId;c.shapeName=a.ShapeName;c.isHiddenShape=
a.IsHidden;c.isFocussedShape=!1;const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.zC(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}tkh(){if(!this.ua.Ba)this.rA.isVisible=!1;else if(this.rA.isVisible){var a=this.nAi();if(this.Kyf(a?a.toArray():null,this.wRg)){this.wRg=a?a.toArray():null;var b=this.J$.Ei("UserAction","SelectionPane Rendering started");this.rR.renderSelectionPane(CR.a.Aph,
a.toArray());a=b.Vq.toString();b.stop();va.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else va.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}Kyf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=a[c],l=b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||f.isFocussedShape!==l.isFocussedShape||
this.Kyf(f.children,l.children))return!0}return!1}ZYa(){this.tkh();this.MVa&&(this.rA.isVisible?this.Fa.Ej(Lb.a.ME,!0):this.Fa.Ej(Lb.a.ME,!1));this.MVa=!1}gZe(a,b,c){let f;const l=c.bB.length,w=[];f=!1;for(let H=0;H<l;H++){const U=c.bB[H];U.ShapeId===a&&(2===b?(U.IsHidden=!U.IsHidden,f=U.IsHidden):0===b?f=U.IsHidden=!0:1===b&&(f=U.IsHidden=!1));w.push(U)}return{returnValue:w,ERj:f}}Gri(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=this.Vfc.ga(a);if(!c||1>=c.length)va.a.J(512500429,
801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.zC(c[0]);if(f){var l=!1;a=({ERj:l}=this.gZe(a,2,f)).returnValue;for(const w of c){const H=(c=b.zC(w))?Object(qa.a)(117,c.sc(this.zz)):null;H&&(l?(H.Cka(),this.ob.jX(c)&&this.ob.s8(c)):!l&&H.jMa())}b=this.Jb.Ad(15);try{b.nc(f),f.bB=a}finally{b&&b.dispose()}}else va.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}zwh(a){const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");
var c=b.gk(!0),f=[];for(const l of c)if(l.If){const w=this.Ea.ix(l);f=f.concat.apply(f,w)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.ob.jj(),this.ob.tsa(c));for(const l of c)!a&&l.isHiddenShape?Object(qa.a)(117,l.sc(this.zz)).jMa():a&&!l.isHiddenShape&&Object(qa.a)(117,l.sc(this.zz)).Cka();f=this.Jb.Ad(15);try{f.nc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(let l of this.Vfc)if(!b.zC(l.key)){const w=l.value;if(!w||1>=w.length){va.a.J(512500427,
801,10,"There should be atleast 2 child shapes in the nested group");continue}const H=b.zC(w[0]);H?(c=[],c=a?this.gZe(l.key,0,H).returnValue:this.gZe(l.key,1,H).returnValue,H.bB=c):va.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&f.dispose()}}}SWk(){this.rR.addCloseSelectionPaneEventListener(()=>{va.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.rA.isVisible=!1});this.rR.addFocusSelectionPaneListener(()=>
{va.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Fa.Ej(Lb.a.ME,!0)});this.rR.addSelectShapeEventListener(a=>{va.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");(a=b.zC(a))&&(a.isHiddenShape||this.ob.selectShape(a,!0))});this.rR.addSelectMultipleShapesEventListener(a=>{va.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");
const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");Pg.a("SelectionPaneMultiSelect",L.a.n6,()=>{if(!a.length){var c=this.ob.Xd();this.ob.tsa(c)}c=0;for(const f of a){const l=b.zC(f);l&&!l.isHiddenShape&&(c?this.ob.selectShape(l,!1):(this.ob.selectShape(l,!0),c++))}return 32})});this.rR.addToggleVisibilityListener(a=>{va.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=
b.zC(a);b="";if(!c||c.Og||c.If)b="Group";Pg.b("SelectionPaneToggleVisibilty",b,L.a.n6,()=>{c?this.aUg.Nxl(a):this.Gri(a);return 32})});this.rR.addShapeRenameListener((a,b)=>{va.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");c=c.zC(a);let f="";if(!c||c.Og||c.If)f="Group";Pg.b("SelectionPaneRename",f,L.a.n6,()=>{this.aUg.bfl(a,b);return 32})});this.rR.addShapeReorderListener((a,b)=>{va.a.J(512500419,
822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.zC(a);let l="";if(!f||f.Og||f.If)l="Group";else if(c=c.zC(b),!c||c.Og||c.If)l="Group";Pg.b("SelectionPaneReorder",l,L.a.n6,()=>{this.Rdk.uok(a,b);return 32})});this.rR.addShowAllButtonEventListener(()=>{this.MVa=!0;va.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");Pg.a("SelectionPaneShowAll",L.a.n6,()=>{this.zwh(!1);return 32})});
this.rR.addHideAllButtonEventListener(()=>{this.MVa=!0;va.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");Pg.a("SelectionPaneHideAll",L.a.n6,()=>{this.zwh(!0);return 32})});this.rR.addBringForwardButtonEventListener(()=>{this.MVa=!0;va.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");Pg.a("SelectionPaneBringForward",L.a.n6,()=>{this.ia.processAction(L.a.bringForward,2);return 32})});this.rR.addBringBackwardButtonEventListener(()=>
{this.MVa=!0;va.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");Pg.a("SelectionPaneBringBackward",L.a.n6,()=>{this.ia.processAction(L.a.sendBackward,2);return 32})});va.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(n.a)(FN,"SelectionPaneActor",null,[365]);class GN{constructor(a,b,c,f){this.mea=!1;this.Efc="ShapeAlignToSelectedObjects";this.ia=a;this.Fb=c;this.ob=b;this.t0=f}wb(){va.a.J(50630811,822,50,"ShapeAlignmentActor::RegisterActions() - OptIn: True");
this.ia.ra(L.a.Awf,nc.a.application,Object(F.a)(this,this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.Dth,nc.a.application,Object(F.a)(this,this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.kqd,nc.a.application,Object(F.a)(this,this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.crc,nc.a.application,Object(F.a)(this,this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.lqd,nc.a.application,Object(F.a)(this,this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.Zqc,nc.a.application,Object(F.a)(this,
this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.$qc,nc.a.application,Object(F.a)(this,this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.brc,nc.a.application,Object(F.a)(this,this.ITa,"handleShapesAlignment"),4);this.ia.ra(L.a.kDa,nc.a.application,Object(F.a)(this,this.kbg,"handleShapesDistribution"),4);this.ia.ra(L.a.L2b,nc.a.application,Object(F.a)(this,this.kbg,"handleShapesDistribution"),4);this.ia.ra(L.a.IJb,nc.a.application,Object(F.a)(this,this.IJb,"queryShapeAlignToSlide"),96);this.ia.ya(L.a.Vtc,
nc.a.application,Object(F.a)(this,this.Vtc,"toggleShapeAlignToSlide"));this.ia.ra(L.a.HJb,nc.a.application,Object(F.a)(this,this.HJb,"queryShapeAlignToSelectedObjects"),96);this.ia.ya(L.a.Utc,nc.a.application,Object(F.a)(this,this.Utc,"toggleShapeAlignToSelectedObjects"))}Ee(){}iac(){return u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp?!0:!1}ITa(a,b,c){if(this.t0){b=this.ob.Xd();for(const l of b)if(!l.eb(hb.a.RUa))return 16}const f=this.ob.tg();return f?1===c?f.length?32:8:Pg.a("Align",
a,()=>{va.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],w=1===f.length||this.mea?this.QWf(a):this.PWf(a,f);if(null===w)return va.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const H of f)l.push(new Dv(H,this.zej(a,H,w)));if(!l[0].shapeNode.Og)for(const H of l)this.$k(H.shapeNode).setPosition(H.position.x,H.position.y,!0);this.ia.La(L.a.YIa,2,l);return 32}):(va.a.J(50598726,822,10,
"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}IJb(a,b,c,f,l){if(!l||!Object(Ya.a)(Xh.a,l))return va.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.Lf(this.mea);va.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");return 32}Vtc(a,b,c,f,l){a=this.ob.tg();if(1===c)return 2>a.length&&(this.mea=!0,this.Efc="ShapeAlignToSlide",va.a.J(50598736,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),
32;if(!l||"object"!==typeof l)return va.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.WGh(l)&&(this.mea=!0,va.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}HJb(a,b,c,f,l){if(!l||!Object(Ya.a)(Xh.a,l))return va.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),8;l.Lf(!this.mea);va.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");
return 32}Utc(a,b,c,f,l){a=this.ob.tg();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return va.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.WGh(l)&&(this.mea=!1,va.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}zej(a,b,c){let f=null;var l=this.$k(b);b=l.hSc();l=l.us();switch(a){case L.a.kqd:va.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");
f=new gd.a(b.x-l.hc+c,b.y);break;case L.a.crc:va.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new gd.a(b.x+(c-l.$b),b.y);break;case L.a.lqd:va.a.J(50598754,822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new gd.a(b.x,b.y-l.kc+c);break;case L.a.Zqc:va.a.J(50598784,822,50,"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new gd.a(b.x,b.y+(c-l.Yb));break;case L.a.$qc:va.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");
f=new gd.a(b.x+(c-l.Vf().x),b.y);break;case L.a.brc:va.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new gd.a(b.x,b.y+(c-l.Vf().y))}return f}kbg(a,b,c){const f=this.ob.tg();return f?1===c?!f.length||2===f.length&&!this.mea?8:32:Pg.a("Align",a,()=>{va.a.J(50902275,822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.s_e(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.mea?this.QWf(a):this.PWf(a,f);if(null===
l)return va.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var w=l-this.Fpi(a,f);l=this.ppi(f,w);w=this.tpi(a,f,w,l);this.aPi(a,f,f.length-1,l,w);return 32}):(va.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),16)}Fpi(a,b){return a===L.a.kDa?this.Gpi(b):this.Hpi(b)}Gpi(a){let b=0;for(const c of a)a=this.$k(c),b+=a.us().Yb-a.us().kc;return b}Hpi(a){let b=0;for(const c of a)a=this.$k(c),b+=a.us().$b-
a.us().hc;return b}tpi(a,b,c,f){if(1===b.length||this.mea)return 0<c?f:0;b=this.$k(b[0]);return a===L.a.kDa?b.us().Yb+f:b.us().$b+f}ppi(a,b){return(1===a.length||this.mea)&&0<b?1*b/(a.length+1):1*b/(a.length-1)}aPi(a,b,c,f,l){var w=0;const H=[];1<b.length&&!this.mea?(va.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),w++,c--):va.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===L.a.kDa?va.a.J(50902281,
822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):va.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");w<=c;w++){const ja=b[w];if(!ja)continue;let wa=this.$k(ja);if(wa){var U=wa.hSc();a===L.a.kDa?(U=new gd.a(U.x,l),H.push(new Dv(ja,U)),l+=wa.us().Yb-wa.us().kc+f):(U=new gd.a(l,U.y),H.push(new Dv(ja,U)),l+=wa.us().$b-wa.us().hc+f)}}if(H[0]&&!H[0].shapeNode.Og)for(const ja of H)this.$k(ja.shapeNode).setPosition(ja.position.x,ja.position.y,!0);
this.ia.La(L.a.YIa,2,H)}QWf(a){const b=Object(qa.a)(566,this.ob.uk().sc(this.Fb.Ma));if(!b)return va.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",a),null;switch(a){case L.a.crc:case L.a.L2b:return b.MB.clientWidth;case L.a.Zqc:case L.a.kDa:return b.MB.clientHeight;case L.a.$qc:return b.MB.clientWidth/2;case L.a.brc:return b.MB.clientHeight/2;default:return va.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",
a),0}}PWf(a,b){switch(a){case L.a.kqd:var c=Number.MAX_VALUE;for(const w of b)b=this.$k(w),c=Math.min(b.us().hc,c);return c;case L.a.crc:c=-Number.MAX_VALUE;for(const w of b)b=this.$k(w),c=Math.max(b.us().$b,c);return c;case L.a.lqd:c=Number.MAX_VALUE;for(const w of b)b=this.$k(w),c=Math.min(b.us().kc,c);return c;case L.a.Zqc:c=-Number.MAX_VALUE;for(const w of b)b=this.$k(w),c=Math.max(b.us().Yb,c);return c;case L.a.$qc:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.$k(c),f=Math.min(b.us().hc,
f),l=Math.max(b.us().$b,l);return f+(l-f)/2;case L.a.brc:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.$k(f),c=Math.min(b.us().kc,c),l=Math.max(b.us().Yb,l);return c+(l-c)/2;case L.a.kDa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.$k(l),c=Math.min(c,b.us().kc),f=Math.max(b.us().Yb,f);return f-c;case L.a.L2b:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const w of b)b=this.$k(w),c=Math.min(c,b.us().hc),f=Math.max(b.us().$b,f);return f-c;default:return va.a.J(51500960,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",
a,b.length),null}}s_e(a,b,c,f){if(!(c>=f)){var l=this.IEk(a,b,c,f);this.s_e(a,b,c,l-1);this.s_e(a,b,l+1,f)}}IEk(a,b,c,f){if(b===L.a.kDa)return this.KEk(a,c,f);if(b===L.a.L2b)return this.JEk(a,c,f);va.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}KEk(a,b,c){var f=this.$k(a[c]).us().Vf().y;let l=b-1;for(;b<=c-1;b++)if(this.$k(a[b]).us().Vf().y<f){l++;const w=a[l];a[l]=a[b];a[b]=w}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}JEk(a,
b,c){var f=this.$k(a[c]).us().Vf().x;let l=b-1;for(;b<=c-1;b++)if(this.$k(a[b]).us().Vf().x<f){l++;const w=a[l];a[l]=a[b];a[b]=w}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}WGh(a){const b=a.SourceControlId;return a[Vh.a.On]&&this.Efc!==b?(this.mea="ShapeAlignToSelectedObjects"===this.Efc,this.iac()&&(a={},a[b]="ToggleButtonModel",a[this.Efc]="ToggleButtonModel",Pc.App.Kb.rG(a)),this.Efc=b,!0):!1}$k(a){return a?Object(qa.a)(117,a.sc(this.Fb.Ma)):null}}Object(n.a)(GN,"ShapeAlignmentActor",null,[365]);var HN=
d(503),DR=d(964);class cy{}Object(n.a)(cy,"CT_NoFillProperties",null,[]);var ER=d(965);class oA{constructor(a,b){this.Wvl=a;this.ftc=b}}Object(n.a)(oA,"FormatPainterData",null,[]);var IN=d(735);class vi{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve){this.Stl="data:image/svg+xml;charset=utf8,";this.pLe=96;this.ia=a;this.pa=H;this.qe=f;this.Jb=c;this.Fa=b;this.TC=l;this.fc=w;this.fwe=ja;this.kJ=U;this.oye=Sa;this.yFg=(a=!Cc||!Cc.isInHighContrastMode)&&Ic.ije;this.LX=Ic.powerPointGraphicToolTabIsEnabled;
this.Uxe=a&&Ic.svgIconLocalEditingIsEnabled;this.Mfb=wa;this.zz=Ve;this.Ea=eb;this.WQ=ub;this.qU=Ub;this.Vb=cc;this.ua=Fc;this.yc=Ud;this.Tp=Ic.pptTextFormatPainterIsEnabled;this.uzg=Ic.formatPainterApplyRemappedIsEnabled;this.lFg=Ic.B0c;this.Ydb=Ic.HJk;this.fU=Ic.OIb;this.la=Ic;this.gj=je;this.yfc=new La.ScriptSharpLegacyMap;this.sA=Vd}wb(){this.ia.ra(L.a.FLe,nc.a.application,Object(F.a)(this,this.Nvj,"handlePopulateShapeFillMenu"),96);this.ia.ra(L.a.YEe,nc.a.application,Object(F.a)(this,this.Iuj,
"handleMoreFillColors"),96);this.ia.ra(L.a.$Ee,nc.a.application,Object(F.a)(this,this.Nuj,"handleMoreOutlineColors"),96);this.ia.ra(L.a.aCa,nc.a.application,Object(F.a)(this,this.L$f,"handleApplyShapeFillColor"),4);this.ia.ra(L.a.ZHc,nc.a.application,Object(F.a)(this,this.Mrj,"handleApplyShapeFillCustomColor"),4);this.ia.ra(L.a.Yrb,nc.a.application,Object(F.a)(this,this.L$f,"handleApplyShapeFillColor"),4);this.ia.ra(L.a.Qld,nc.a.application,Object(F.a)(this,this.Vag,"handleRemoveShapeFill"),4);this.ia.ra(L.a.iRe,
nc.a.application,Object(F.a)(this,this.Vag,"handleRemoveShapeFill"),4);this.ia.ra(L.a.Rid,nc.a.application,Object(F.a)(this,this.Ovj,"handlePopulateShapeOutlineMenu"),96);this.ia.ra(L.a.Kia,nc.a.application,Object(F.a)(this,this.M$f,"handleApplyShapeOutlineColor"),4);this.ia.ra(L.a.$Hc,nc.a.application,Object(F.a)(this,this.Nrj,"handleApplyShapeOutlineCustomColor"),4);this.ia.ra(L.a.Zrb,nc.a.application,Object(F.a)(this,this.M$f,"handleApplyShapeOutlineColor"),4);this.ia.ra(L.a.UPa,nc.a.application,
Object(F.a)(this,this.Rrj,"handleApplyShapeOutlineWidth"),4);this.ia.ra(L.a.u6a,nc.a.application,Object(F.a)(this,this.Orj,"handleApplyShapeOutlineDashStyle"),4);this.lFg&&this.ia.ra(L.a.v6a,nc.a.application,Object(F.a)(this,this.Qrj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.ra(L.a.Lia,nc.a.application,Object(F.a)(this,this.Prj,"handleApplyShapeOutlineEndStyle"),4);this.ia.ra(L.a.Rld,nc.a.application,Object(F.a)(this,this.Wag,"handleRemoveShapeOutline"),4);this.ia.ra(L.a.jRe,nc.a.application,
Object(F.a)(this,this.Wag,"handleRemoveShapeOutline"),4);this.ia.ra(L.a.rSa,nc.a.application,Object(F.a)(this,this.gyj,"handleToggleFormatPainterActive"),4);this.ia.ra(L.a.Wja,nc.a.application,Object(F.a)(this,this.Drj,"handleApplyFormat"),4);this.ia.ra(L.a.n5d,nc.a.application,Object(F.a)(this,this.Erj,"handleApplyFormatToShape"),5);this.ia.ra(L.a.Xjd,nc.a.application,Object(F.a)(this,this.ewj,"handleQueryFormatPainter"),97);this.ia.ra(L.a.VIb,nc.a.application,Object(F.a)(this,this.Uvj,"handlePreviewShapeFillColor"),
4);this.ia.ra(L.a.XKb,nc.a.application,Object(F.a)(this,this.exj,"handleRevertPreviewShapeFillColor"),4)}Ee(){const a=this.Fa.Fc(Lb.a.sg);a.bindAction(x.KeyInputManager.Oa(A.a.Oza,6),L.a.rSa);const b=this.Fa.Fc(Lb.a.kQ);let c=x.KeyInputManager.Oa(A.a.Oza,6);b.Dp(c);this.Tp?b.bindAction(c,D.a.hRc):b.bindAction(c,L.a.rSa);va.a.J(512500379,815,50,"formatPainterApplyRemapped: {0}",this.uzg);this.uzg||(c=x.KeyInputManager.Oa(A.a.X1a,6),a.bindAction(c,L.a.Wja),b.Dp(c),this.Tp?b.bindAction(c,L.a.o5d):b.bindAction(c,
L.a.Wja))}Ywb(a,b){const c=[];if(a)for(const f of a)(f.rua||b&&f.get_isSVGBlipFilled()||f.Hj||this.fU&&1===f.mediaType)&&Array.add(c,f);return c}N9a(a,b){const c=[];if(a)for(const f of a)(f.rua&&!f.gz||b&&f.get_isSVGBlipFilled()||this.Ydb&&f.ud)&&Array.add(c,f);return c}Nvj(a,b,c,f,l){if(!this.pa.b4()||this.fc.FC(this.pa.Xd()))return 16;if(1===c)return 32;if(!l)return 8;b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.g8;b=(c=this.pa.kp())?b.AC(c.slideId):null;if(!b)return 16;
var w=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");c=w?L.a.Yrb:L.a.aCa;f=w?L.a.iRe:L.a.Qld;const H=L.a.YEe;if(l.MenuId&&"fill"===l.MenuId){var U=new IN.a(b.Jd);w=new Sys.StringBuilder;w.append(String.format(vi.BCf,"PptRibbon.Drawing.ShapeFill"));if(!b.Jd)return 8;w.append(U.fbe(c,a,L.a.ZHc));w.append(vi.HCf);w.append(String.format(vi.FCf,f,u.AFrameworkApplication.qm,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));w.append(vi.GCf);w.append(vi.hoi);w.append(String.format(vi.foi,
H,u.AFrameworkApplication.qm,ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));w.append(vi.goi);w.append(vi.ACf);l.PopulationXML=w.toString()}else{U=Object.assign(new Tl.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const ja=w?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",wa=w?"GraphicNoFill":"ShapeNoFill";Array.add(U.MenuSectionList,Yk.f(b.Jd,PE.a.themeColors,"Color.Menu.Controls","themeColor",w?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",
c.toString(),1));Array.add(U.MenuSectionList,Yk.d("Standard Colors","Color.Menu.Controls","standardColor",ja,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(U.MenuSectionList,Yk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors","3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(U.MenuSectionList,Yk.b("Remove Color",
"Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",wa,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(U.MenuSectionList,Yk.a("More Fill Color","Color.Menu.Controls",H.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreFillColorsKeytip));Pd.a("ColorPickerHighlighterFix")&&(a=this.Ajj(b.Jd),Yk.h(U,a,b.Jd));l.MenuItems=U}return 32}Ovj(a,
b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.pa.b4()||this.fc.FC(this.pa.Xd()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.pa.kp())?a.AC(c.slideId):null;if(!c||!c.Jd)return 8;a=a.g8;var w=this.qe.rk("pegal.png"),H=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=H?L.a.Zrb:L.a.Kia;f=H?L.a.jRe:L.a.Rld;const U=L.a.$Ee;if(l.MenuId&&"outline"===l.MenuId){var ja=new Sys.StringBuilder;ja.append(String.format(vi.BCf,"PptRibbon.Drawing.ShapeOutline"));
c=new IN.a(c.Jd);ja.append(c.fbe(b,a,L.a.$Hc));ja.append(vi.HCf);ja.append(String.format(vi.FCf,f,u.AFrameworkApplication.qm,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));ja.append(vi.GCf);ja.append(vi.koi);ja.append(String.format(vi.ioi,U,u.AFrameworkApplication.qm,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));ja.append(vi.joi);c=this.pa.Xd();a=vi.bjj(c,this.LX);if(!a||!a.length||c&&c.length!==a.length)ja.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),
ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
L.a.dIc,L.a.UPa,u.AFrameworkApplication.qm,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,w,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
L.a.aIc,L.a.u6a,u.AFrameworkApplication.qm,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,w,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.lFg&&ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
L.a.cIc,L.a.v6a,u.AFrameworkApplication.qm,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,w,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
L.a.bIc,L.a.Lia,u.AFrameworkApplication.qm,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,w,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),ja.append("</Controls></MenuSection>");
ja.append(vi.ACf);l.PopulationXML=ja.toString()}else{w=H?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";ja=H?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const wa=H?"GraphicNoOutline":"ShapeNoOutline";H=Object.assign(new Tl.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(H.MenuSectionList,Yk.f(c.Jd,"Theme Colors","Color.Menu.Controls","themeColor",w,b.toString(),1));Array.add(H.MenuSectionList,Yk.d("Standard Colors","standardColor","Standard Colors",
ja,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(H.MenuSectionList,Yk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(H.MenuSectionList,Yk.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
wa,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(H.MenuSectionList,Yk.a("More Outline Color","Color.Menu.Controls",U.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));Pd.a("ColorPickerHighlighterFix")&&(a=this.zjj(c.Jd),Yk.h(H,a,c.Jd));l.MenuItems=H}return 32}Uvj(a,b,c,f,l){if(!l)return va.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.Kmc)return 2;b=this.pa.tg();const w=this.N9a(b,this.LX);return w&&w.length?this.Ydb&&1===w.length&&w[0].ud?(va.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):Pg.a("HandlePreviewShapeFillColor:",a,()=>{const H=this.pa.aP(w),U=this.kJ.YR(l),ja=Object.assign(new HN.a,{});ja.solidFillField=U;for(const wa of H)wa?wa.ud||(this.yfc.Gb(wa.get_shapeId())?this.yfc.$(wa.get_shapeId(),wa.fill):this.yfc.add(wa.get_shapeId(),wa.fill),wa.fill=
ja,wa.aga=null):va.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",wa.get_shapeId());return 32}):(va.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}exj(a,b,c,f,l){if(!l)return va.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.Kmc)return 2;a=this.pa.tg();a=this.N9a(a,this.LX);if(!a||!a.length)return va.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.Ydb&&1===a.length&&a[0].ud)return va.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.pa.aP(a);for(const w of a)if(!w)va.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",w.get_shapeId());else if(!w.ud)if(this.yfc.Gb(w.get_shapeId()))w.fill=this.yfc.ga(w.get_shapeId()),w.aga=null;else return va.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}L$f(a,b,c,f,l){var w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");f=this.pa.tg();b=this.N9a(f,this.LX);const H={type:"ColorPickerPayload",color:""};l&&(H.color=l.Color);if(!(b&&0<b.length||this.pa.HL()&&this.qng(f[0],a,H))||this.fc.FC(b))return 16;const U=this.pa.kp();w=U?w.AC(U.slideId):null;if(!w||!w.Jd||!w.Jd.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.Ydb&&1===b.length&&b[0].ud)return va.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.La(L.a.Q5,c,l);c=vi.Hhd(l);if(!c)return 8;1<f.length?va.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):va.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var ja of f)if(ja.If||ja.Og){on(ja);break}if(this.pa.HL()&&this.qng(f[0],a,H)&&this.Lbe(f[0],a,H))return 32;ja=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{ja.nc(b[0]);ja.jd=a;const wa=this.kJ.YR(l),Sa=this.pa.aP(b);
for(const eb of Sa)if(eb.ud){if(!this.Ydb)continue;va.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const ub=this.yc.NN(eb);if(!ub){va.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const Ub=ub.q$a();for(const cc of Ub){const Fc=cc.cellShading;bp.b(Fc);Fc.solidFillField=wa;cc.cellShading=Fc}}else{const ub=this.tTf(eb);ub&&(this.kJ.NRa(ub),ub.solidFillField=wa,eb.fill=ub,eb.aga=null,this.IIh(eb,ub));eb.Soa=JSON.stringify(c);this.HLb(eb)}}finally{ja&&
ja.dispose()}return 32}Iuj(a,b,c,f,l){if(1===c)return this.ia.La(L.a.renderColorPicker,1,l);a=this.yjj();b={};b.currentColor=a;b.handleCommand=L.a.ZHc;return this.ia.La(L.a.renderColorPicker,2,b)}Mrj(a,b,c,f,l){if(1===c)return this.ia.La(L.a.aCa,c,l);if(!l)return va.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.La(L.a.aCa,c,l);32===a&&this.ia.La(L.a.QBa,c,l);return a}Nuj(a,b,c,f,l){a=this.pa.tg();a=Pd.a("FixColorPickerPictureBorderColor")?this.Ywb(a,this.LX):
this.N9a(a,this.LX);a=this.pa.aP(a);if(1===c)return this.ia.La(L.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].Lua&&(c=ie.Box4ColorHelper.gta(a[0].Lua));l={};l.currentColor=c;l.handleCommand=L.a.$Hc;return this.ia.La(L.a.renderColorPicker,2,l)}Vag(a,b,c,f,l){f=this.pa.tg();b=this.N9a(f,this.LX);const w=!!b&&0<b.length;if(this.fc.FC(b))return 16;if(1===c)return w?32:8;if(!w)return 16;1<f.length?va.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",f.length):
va.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.Ydb&&1===b.length&&b[0].ud)return va.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.La(L.a.TJa,c,l);c=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{c.nc(b[0]);c.jd=a;const H=this.pa.aP(b);for(const U of H)if(U.ud){if(!this.Ydb)continue;va.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const ja=this.yc.NN(U);if(!ja){va.a.J(512500353,815,
10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const wa=ja.q$a();for(const Sa of wa){const eb=Sa.cellShading;bp.b(eb);eb.noFillField=new cy;Sa.cellShading=eb}}else{const ja=this.tTf(U);ja&&(this.kJ.NRa(ja),ja.noFillField=new cy,U.fill=ja,U.aga=null,this.IIh(U,ja));U.lYk();this.HLb(U)}}finally{c&&c.dispose()}return 32}M$f(a,b,c,f,l){var w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");f=this.pa.tg();b=this.Ywb(f,this.LX);if(!(b&&0<b.length)||this.fc.FC(b))return 16;
const H=this.pa.kp();w=H?w.AC(H.slideId):null;if(!w||!w.Jd||!w.Jd.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=vi.Hhd(l);if(!c)return 8;1<f.length?va.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):va.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var U of f)if(U.If||U.Og){on(U);break}U=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{U.nc(b[0]);
U.jd=a;const ja=this.pa.aP(b);for(const wa of ja){const Sa=this.m2d(wa);if(Sa){this.kJ.NRa(Sa);const eb=this.kJ.YR(l);Sa.solidFillField=eb;wa.lineStyle=Sa;wa.Lua=null;this.vvd(wa,Sa)}wa.Fya=JSON.stringify(c);this.HLb(wa)}}finally{U&&U.dispose()}return 32}Nrj(a,b,c,f,l){if(1===c)return this.ia.La(L.a.Kia,c,l);if(!l)return va.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.La(L.a.Kia,c,l);32===a&&this.ia.La(L.a.QBa,c,l);return a}Rrj(a,b,c,f,l){f=this.pa.tg();
b=this.Ywb(f,this.LX);if(!(b&&0<b.length)||this.fc.FC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.jVc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=vi.eoh.length||0>c)return 8;1<f.length?va.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):va.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{l.nc(b[0]);
l.jd=a;const w=this.pa.aP(b);for(const H of w){const U=this.m2d(H);U&&(U.wField=vi.D6k[c],U.wFieldSpecified=!0,this.vvd(H,U),this.kTf(U),H.lineStyle=U);H.outlineWidth=vi.eoh[c];this.HLb(H)}}finally{l&&l.dispose()}return 32}HLb(a){this.Ea.GL(a)&&Rc.a.Ib&&(Rc.a.Ib.Oj=!0)}tTf(a){if(!this.yFg)return null;let b=a.fill;b||!a.GL&&!a.get_isSVGBlipFilled()||(b=new HN.a);return b}m2d(a){var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.yFg)return null;let c=a.lineStyle;
if(this.Uxe&&a.l0c()&&c&&c.wFieldSpecified){b=Object(qa.a)(116,b.AC(a.slideId));var f=this.gj.JG;b&&b.Uw&&null!=b.Uw.Zr&&(f=b.Uw.Zr);b=c.wField/f;f=this.B6b(a);if(!f||!f.cQa||!f.rIc)return c.wField=b,c;var l;(l=f.Ok&&f.Ok.kH&&f.Ok.kH.AL()&&1===f.Ok.kH.xa.childNodes.length?f.Ok.kH.xa.childNodes[0].getAttribute("width"):f.cQa.getAttribute("width"))&&!ha.a.Wa(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.nii*f.rIc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.GL&&!a.get_isSVGBlipFilled()||
(c=new DR.a);return c}kTf(a){if(a.noFillField||bp.e(a))a.noFillField=null,a.solidFillField=Object.assign(new Wu.a,{schemeClrField:Object.assign(new rh.a,{valField:1})})}Orj(a,b,c,f,l){f=this.pa.tg();b=this.Ywb(f,this.LX);if(!(b&&0<b.length)||this.fc.FC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.jVc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?va.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):va.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{l.nc(b[0]);l.jd=a;const w=this.pa.aP(b);for(const H of w){const U=this.m2d(H);U&&(U.prstDashField=U.prstDashField||new ER.a,U.prstDashField.valField=this.ehj(c),U.prstDashField.valFieldSpecified=!0,U.custDashField=null,this.vvd(H,U),this.kTf(U),H.lineStyle=U);H.WO=c;this.HLb(H)}}finally{l&&l.dispose()}return 32}ehj(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}Prj(a,b,c,f,l){f=this.pa.tg();b=vi.Wcj(f);if(!(b&&0<b.length)||this.fc.FC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.jVc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=vi.Snh.length)return 8;c=vi.Snh[l];l=vi.z6k[l];1<f.length?va.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):va.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{f.nc(b[0]);f.jd=a;const w=this.pa.aP(Array.isArray(b)?b:null);for(const H of w)H.cfl(c,l)}finally{f&&f.dispose()}return 32}Wag(a,b,c){const f=this.pa.tg();b=this.Ywb(f,this.LX);if(!(b&&0<b.length)||this.fc.FC(b))return 16;if(1===c)return 32;1<f.length?va.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):va.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{c.nc(b[0]);c.jd=a;const l=this.pa.aP(b);for(const w of l){const H=w.lineStyle;H&&(this.kJ.NRa(H),H.noFillField=new cy,w.lineStyle=H,w.Lua=null,this.vvd(w,H));w.SYk();this.HLb(w)}}finally{c&&c.dispose()}return 32}Qrj(a,b,c,f,l){f=this.pa.tg();b=this.Ywb(f,this.LX);if(!(b&&0<b.length)||vi.N8k(f))return 8;if(this.fc.FC(b))return 16;if(1===c)return 32;if(!l)return va.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.jVc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return va.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<f.length?va.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):va.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{l.nc(b[0]);l.jd=a;for(const w of b)w.slc=c,
w.setValue(hb.a.oac,!0)}finally{l&&l.dispose()}return 32}gyj(a,b,c){b=this.pa.tg();a=this.pa.kp();if(!(this.TC.isActive||1===b.length&&a&&a.rAh||this.Tp&&this.pa.fla()))return 16;if(1===c)return 32;if(this.fc.$c(a))return 16;c=32;if(this.TC.isActive)this.TC.sQa();else if(this.Tp)if(this.WQ.yL)this.WQ.yL=!1;else{b=this.pa.Na.mb;var f=null;if(b&&(f=b.Ua)&&(f.contextId===Cb.a.Of||f.contextId===Cb.a.textRange||f.contextId===Cb.a.endOfParagraph||f.contextId===Cb.a.paragraph))c=this.ia.processAction(D.a.hRc,
2);else if(a.ud&&this.pa.P_(this.pa.Na)){if(b=a.XUc())if(b=b.nf(0,0)){b.Zbl(this.WQ);var l=b.B4b;f=-1;l&&(f=zb.ParagraphReader.textLength(Object(qa.a)(yg.a,l))+1);if(l=this.Vb.zi){const w=this.Jb.oe(4),H=l.Bi;w.nc(l);const U=this.qU.pEa(H),ja=Object(qa.a)(116,this.fwe.B7f(b));this.qU.Q5e(U,!0,!1,ja,a,b,null,0,f);(a=H.dnc(U))&&l.hBb(a);w.dispose()}}}else this.TC.vah(a)}else this.TC.vah(a);Pc.App.Kb.updateCommandUI();return c}Drj(a,b,c){return this.Tp&&(a=this.pa.Na.mb)&&(a=a.Ua)&&(a.contextId===Cb.a.Of||
a.contextId===Cb.a.textRange||a.contextId===Cb.a.endOfParagraph||a.contextId===Cb.a.paragraph)?(this.TC.sQa(),this.ia.processAction(L.a.o5d,2)):(a=this.pa.kp())?this.ia.La(L.a.n5d,c,new oA(this.TC.Vvl,a)):16}Erj(a,b,c,f,l){if(!l||!Object(Ya.a)(oA,l))return va.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.Tp&&this.WQ.yL)return this.WQ.yL=!1,16;b=l.ftc;if(!(this.TC.isActive&&b&&b.qAh))return this.TC.sQa(),16;if(this.fc.$c(b))return 16;if(1===c)return 32;
Rc.a.Ib&&(Rc.a.Ib.Oj=!1,Rc.a.Ib.actionName="FormatPainterApplyToShape",Rc.a.Ib.Ur=!0);c=this.Jb.Ad(15,void 0,()=>{this.pa.jj();this.Fa.Ed()});try{c.nc(l.ftc),c.jd=a,l.ftc.bwb=l.Wvl.id}finally{c&&c.dispose()}this.TC.sQa();return 32}ewj(a,b,c,f,l){if(!l||!Object(Ya.a)(Xh.a,l))return 8;l.Lf(this.TC.isActive||(this.Tp?this.WQ.yL:!1));return 32}xNk(a,b,c){return(a=this.B6b(a))&&Object(Ya.a)(Ws.a,a.Ok)&&(a=Object(qa.a)(Ws.a,a.Ok))?a.RNe(L.a.mw(b),c):!1}Lbe(a,b,c){return(a=this.B6b(a))&&Object(Ya.a)(Ws.a,
a.Ok)&&(a=Object(qa.a)(Ws.a,a.Ok))?a.iid(L.a.mw(b),c):!1}jVc(a){return a.split(",")[1]}IIh(a,b){if(this.Uxe&&a.l0c()){var c=this.B6b(a),f=this.uJf(c,a);a=b.noFillField?null:this.KH(b,a);f=this.Mfb.cCl(f,a);this.mxf(c,f)}}vvd(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.Uxe&&a.l0c()){var f=this.B6b(a),l=this.uJf(f,a);if(null!==l){if(b.noFillField)l=this.Mfb.OFh(l);else{if(b.wFieldSpecified){var w=Object(qa.a)(116,c.AC(a.slideId)),H=this.gj.JG;w&&w.Uw&&
null!=w.Uw.Zr&&(H=w.Uw.Zr);l=this.Mfb.PFh(l,b.wField,f.vd,H)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.Mfb.dCl(l,b.prstDashField.valField));if(b.solidFillField){b=this.KH(b,a);l=this.Mfb.OFh(l,b);if(!l)return;b=l.querySelectorAll(this.Mfb.X0e);w=!0;for(H=0;H<b.length;++H){const U=b[H].getAttribute("stroke-width");if(U&&!ha.a.Wa(U.toString())){w=!1;break}}w&&(a=Object(qa.a)(116,c.AC(a.slideId)),c=this.gj.JG,a&&a.Uw&&null!=a.Uw.Zr&&(c=a.Uw.Zr),l=this.Mfb.PFh(l,te.a.wLe/this.pLe,f.vd,
c))}}this.mxf(f,l)}}}KH(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.AC(b.slideId);return this.kJ.LKb(a,b.Jd)}mxf(a,b){if(b&&a&&a.Ok){a.Ok.SZ.Rd(!1);var c=a.Ok.kH.xa.childNodes;for(let f=0;f<c.length;++f)a.Ok.kH.xa.removeChild(c[f]);a.Ok.kH.xa.appendChild(b);(b=a.cQa.getAttribute("transform"))&&a.Ok.kH.xa.setAttribute("transform",b.toString());a.Ok.kH.Rd(!0);Rc.a.Ib&&(Rc.a.Ib.Oj=!0,Rc.a.Ib.tF=new Date)}}qng(a,b,c){return Pd.a("EnableSmartArtFillColor")&&
this.xNk(a,b,c)}yjj(){var a=this.pa.tg();a=this.N9a(a,this.LX);var b=this.pa.aP(a),c=null;a=null;Pd.a("FixColorPickerSelectedColor")&&(a=this.ua.Ba);if(1===b.length){if(b[0].aga)c=ie.Box4ColorHelper.gta(b[0].aga);else if(b[0].ud&&Pd.a("FixColorPickerSelectedColor")){const f=this.pa.yv();if(!f||!f.length){if(b=this.pa.an())b=b.nf(0,0),c=ie.Box4ColorHelper.WDa(b.cellShading.solidFillField,a.Jd);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?ie.Box4ColorHelper.WDa(c.cellShading.solidFillField,
a.Jd):this.sA.bSc(Object(qa.a)(yg.a,c))}!c&&Pd.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=ie.Box4ColorHelper.WDa(b[0].fill.solidFillField,a.Jd))}return c}Nxl(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.zC(a).isHiddenShape;this.efl(a,b)}Mxl(a,b){a.isHiddenShape=!b;const c=Object(qa.a)(117,a.sc(this.zz));b?c.jMa():(c.Cka(),this.pa.jX(a)&&this.pa.s8(a))}efl(a,b){const c=this.Jb.Ad(15,void 0,()=>{this.pa.jj()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.zC(a);c.nc(l);this.Mxl(l,b)}finally{c&&c.dispose()}}bfl(a,b){const c=this.Jb.Ad(15,void 0,()=>{this.pa.jj()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.zC(a);c.nc(l);l.shapeName=b}finally{c&&c.dispose()}}wjj(){var a=this.pa.tg();a=this.N9a(a,this.LX);return this.pa.aP(a)}Ajj(a){const b=this.wjj();return b&&1===b.length?b[0].ud?this.sA.n0f(this.pa.yv()):b[0].fill&&b[0].fill.solidFillField?ie.Box4ColorHelper.WDa(b[0].fill.solidFillField,a):null:
null}zjj(a){const b=this.pa.tg();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?ie.Box4ColorHelper.WDa(b[0].lineStyle.solidFillField,a):null}B6b(a){return a?Object(qa.a)(117,a.sc(this.zz)):null}uJf(a,b){try{if(!(a&&a.cQa&&a.Ok&&a.Ok.kH))return null;if(a.Ok.kH.AL()){if(!a.Ok.kH.xa)return null;const l=a.Ok.kH.xa.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.cQa.getAttribute(Ik.a.jXc))return null;let c=a.cQa.getAttribute(Ik.a.jXc).toString();
if(!c.toLowerCase().startsWith(this.Stl))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.oye.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.VTa=!0,null)}catch(c){return va.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static bjj(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static Wcj(a){if(!a)return null;const b=[];for(const c of a)c.gz&&
Array.add(b,c);return b}static N8k(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static Hhd(a){return ru.a.parse(a.Color)}}vi.eoh=[.5,1,2.25,4.5];vi.D6k=[6350,12700,28575,57150];vi.Snh=[0,0,2,2,0,1,1];vi.z6k=[0,2,0,2,1,0,1];vi.BCf='<Menu Id="{0}">';vi.HCf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';vi.FCf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
vi.GCf="</Controls> </MenuSection>";vi.hoi='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';vi.foi='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';vi.goi="</Controls> </MenuSection>";vi.koi='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';vi.ioi='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
vi.joi="</Controls> </MenuSection>";vi.ACf="</Menu>";Object(n.a)(vi,"ShapesFormatActor",null,[365]);var kj=d(230);class Gi{constructor(a,b,c){this.Mad=Array(Gi.qW);this.J8c=Array(Gi.qW);this.Gpe=Array(Gi.qW);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.qJ=a;this.Am=b;this.wcd=c;this.dwa={}}dispose(){Array.clear(this.Mad);Array.clear(this.J8c);this.Am=this.qJ=null;const a=pa.a.nL(this.dwa);
a.length&&appChrome.api.unregisterIcons(a);this.dwa=null}get ij(){return this.qJ.MasterId}o6b(a,b,c){const f=Object.assign(new Tl.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new ek.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var w=c?"GraphicsStyleSection":"ApplyShapeStyleSection",H=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";w=
Object.assign(new yq.a,{Id:"ControlsShapeStyles",ExternalId:w,ExternalGalleryId:H,Type:4,Width:Gi.qW,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,w);l=Gi.qW*(a?Gi.ZBf:Gi.cCf);c&&(l=Gi.qW*Gi.bCf);for(H=0;H<l;++H){const U=c?"ApplyGraphicsStyle"+H:"ApplyShapeStyle"+H;Array.add(w.GalleryItems,c?this.J5d(U,H,a,b,!0):this.J5d(U,H,a,b,!1))}return f}J5d(a,b,c,f,l){if(l){var w=this.qJ?this.qJ.SVGStyles[b]:null;c="SVGStyle";w=w?w.ToolTip:""}else w=this.qJ?this.qJ.ShapeStyles[b]:
null,c=c?"LineStyle":"ShapeStyle",w=w?this.K$d(w.StyleId):"";return Object.assign(new pE.a,{Id:a,ExternalId:a,Icon:Gi.p6b(c,f,b),PreviewIconStyle:Gi.ghj(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:w})}zld(a){this.addIconToMap(this.qJ.ShapeStyles,"ShapeStyle");this.addIconToMap(this.qJ.LineStyles,"LineStyle");a&&this.addIconToMap(this.qJ.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.dwa)}hkj(a){if(a<Gi.qW&&this.Mad[a])return this.Mad[a];if(a>=
this.qJ.ShapeStyles.length)return"";var b=this.qJ.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.K$d(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.p7d(this.wcd.resolve(be.a.fvb,
b.Icon.ImgId,"StyleGallery")),l,f);a<Gi.qW&&(this.Mad[a]=b);return b}$ij(a){if(a<Gi.qW&&this.Gpe[a])return this.Gpe[a];if(a>=this.qJ.SVGStyles.length)return"";var b=this.qJ.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),
l=this.M6f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.p7d(this.wcd.resolve(be.a.fvb,b.Icon.ImgId,"StyleGallery")),l,f);a<Gi.qW&&(this.Gpe[a]=b);return b}Ucj(a){if(a<Gi.qW&&this.J8c[a])return this.J8c[a];if(a>=this.qJ.LineStyles.length)return"";var b=this.qJ.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-
b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.f4f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.p7d(this.wcd.resolve(be.a.fvb,b.Icon.ImgId,"StyleGallery")),l,f);a<Gi.qW&&(this.J8c[a]=b);return b}K$d(a){let b=null;switch(parseInt(String(a/Gi.qW))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;
break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,HCh:c}=this.I0f(a));return String.format(b,a.toString(),c)}M6f(a){return(a=this.qJ?this.qJ.SVGStyles[a]:null)?a.ToolTip:""}f4f(a){let b=null;switch(parseInt(String(a/Gi.qW))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;
break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,HCh:c}=this.I0f(a));return String.format(b,a.toString(),c)}p7d(a){return null===a?"":ha.a.x8b(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=Gi.p6b(b,this.ij,f),w={},H={};H.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);H.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);H.position="absolute";w.root=H;c=appChrome.buildImageIconFromUrl(this.wcd.resolve(be.a.fvb,c.Icon.ImgId,"StyleGallery"),w);this.dwa[l]=
c}}I0f(a){let b,c;c=b=null;a%=Gi.qW;switch(a){case 0:b=kj.Color.Vi(this.Am.Dark1);c=String.format(ResourceStrings.l_DarkFormat,1);break;case 1:b=kj.Color.Vi(this.Am.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=kj.Color.Vi(this.Am.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=kj.Color.Vi(this.Am.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=kj.Color.Vi(this.Am.Accent4);c=String.format(ResourceStrings.L_AccentFormat,
a);break;case 5:b=kj.Color.Vi(this.Am.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=kj.Color.Vi(this.Am.Accent6),c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,HCh:c}}static get sji(){return Gi.c6k}static get qji(){return Gi.a6k}static get rji(){return Gi.b6k}static ghj(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;
return a}static n6d(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');a*=Gi.qW;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?L.a.yZb:L.a.asb,b?L.a.Kjd:L.a.mkd));c.append("</Gallery> </MenuSection>");c.append("</Menu>");
return c.toString()}static p6b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}Gi.qW=7;Gi.cCf=6;Gi.bCf=4;Gi.ZBf=3;Gi.c6k=Gi.n6d(Gi.cCf,!1);Gi.b6k=Gi.n6d(Gi.ZBf,!1);Gi.a6k=Gi.n6d(Gi.bCf,!0);Object(n.a)(Gi,"StyleGalleryBuilder",null,[106]);class JN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.GFb="";this.HCb=[];this.ia=a;this.kq=b;this.gf=c;this.Fa=l;this.Jb=f;this.Nu=w;this.$Eb=H;this.pa=U;this.Ea=ja;this.Xa=wa;this.LX=Sa;eb.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.Xa.lvf(Object(F.a)(this,
this.Ggd,"onSessionInfoChanged"))}wb(){this.ia.ra(L.a.mkd,nc.a.application,Object(F.a)(this,this.hwj,"handleQueryShapesStyle"),97);this.ia.ra(L.a.GLe,nc.a.application,Object(F.a)(this,this.Pvj,"handlePopulateShapesStyles"),96);this.ia.ra(L.a.asb,nc.a.application,Object(F.a)(this,this.Srj,"handleApplyShapesStyle"),4);this.ia.ra(L.a.Kjd,nc.a.application,Object(F.a)(this,this.fwj,"handleQueryGraphicsStyle"),97);this.ia.ra(L.a.DLe,nc.a.application,Object(F.a)(this,this.Mvj,"handlePopulateGraphicsStyles"),
96);this.ia.ra(L.a.yZb,nc.a.application,Object(F.a)(this,this.Grj,"handleApplyGraphicsStyle"),4)}Ee(){}fwj(a,b,c,f,l){return this.pUf(l,!0)}hwj(a,b,c,f,l){return this.pUf(l,!1)}pUf(a,b){var c=this.kq.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(!a||!Object(Ya.a)(Mv,a))return 8;var f=a.aV.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.aV.substr(f.length));if(isNaN(f)||0>f)return va.a.J(509678939,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",
b?"Graphics":"Shapes"),8;var l=this.pa.tg();if(!l||!l.length)return 16;const w=a.WZa;if(!w)return 8;var H=c.AC(l[0].slideId);if(!H)return 16;c=H.ij;H=this.$2f(H);a.aV.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.GFb=(l=this.eZb(l))?"SGT_Line":"SGT_Shape",w.E3=H?H.J5d(a.aV,f,l,c,b?!0:!1):null):H?(this.eZb(l)?(this.GFb="SGT_Line",w.SDa=H.Ucj(f),w.mwb=H.f4f(f)):b?(this.GFb="SGT_SVG",w.SDa=H.$ij(f),w.mwb=H.M6f(f)):(this.GFb="SGT_Shape",w.SDa=H.hkj(f),w.mwb=H.K$d(f)),w.ZU(!1)):(w.SDa="",
w.mwb="");return 32}Mvj(a,b,c,f,l){return this.nUf(c,l,!0)}Pvj(a,b,c,f,l){return this.pa.uUa()?8:this.nUf(c,l,!1)}nUf(a,b,c){var f=this.kq.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return va.a.J(509678937,822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.pa.tg();f=a[0]?f.AC(a[0].slideId):null;const l=this.$2f(f);if(b.MenuId&&"style"===b.MenuId)this.eZb(a)?b.PopulationXML=Gi.rji:b.PopulationXML=c?Gi.qji:Gi.sji;
else{this.GFb=(a=this.eZb(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.o6b(a,f.ij,c?!0:!1):null}return 32}Grj(a,b,c,f,l){if(Pd.a("FixForPictureAndGraphicsStyleForGrpShapes")){if(0>=this.Bjj().length)return 8}else if(!this.Ea.Jsc(this.pa.tg()))return 16;return this.N$f(a,c,l,!0)}Bjj(){var a=this.pa.Xd();const b=[];let c=!1;for(const f of a){if(!f)return b.length=0,b;f.Og&&(c=!0)}if(c)for(const f of a)f.Og&&this.Ea.Jsc([f])&&b.push(f);else for(const f of a)if(this.Ea.Jsc([f]))b.push(f);
else if(f.If){a=this.Ea.ix(f);for(const l of a)this.Ea.Jsc([l])&&b.push(l)}return b}Srj(a,b,c,f,l){return this.Chl(this.pa.tg())?this.N$f(a,c,l,!1):16}N$f(a,b,c,f){var l=this.kq.presentation;if(!l)throw Error.argumentNull("Presentation is null");const w=this.pa.tg();if(!w||!w.length||this.gf.FC(w))return 16;l=l.AC(w[0].slideId);var H=this.Nu.w4f(l);if(!H)return this.Nu.Lrl(l),va.a.J(509678936,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;
if(!c)return va.a.J(509678935,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.eZb(w)?H.LineStyles.length:H.ShapeStyles.length;H=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(H.length));if(isNaN(c)||0>c||c>=b)return va.a.J(509678934,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===w.length?va.a.J(509678933,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",
f?"Graphics":"Shapes",f?"SVG":"Shape"):1<w.length&&va.a.J(509678932,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":"Shapes",w.length,f?"SVGs":"Shapes");f=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.jj()});try{f.nc(Object(qa.a)(116,l));f.jd=a;const U=this.pa.aP(Array.isArray(w)?w:null);for(const ja of U)ja&&ja.dfl(c,this.GFb)}finally{f&&f.dispose()}return 32}Ggd(){for(const a of this.HCb)a.dispose();Array.clear(this.HCb)}$2f(a){const b=this.Nu.w4f(a);if(!b||
!a)return va.a.J(509678931,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.HCb)if(c.ij===a.ij)return c;a=new Gi(b,a.Jd,this.$Eb);Array.add(this.HCb,a);a.zld(this.LX);return a}Chl(a){if(!a||!a.length||this.Ea.zHc(a))return!1;for(const b of a)if(b.rua)return!0;return!1}eZb(a){if(!a)return!1;for(const b of a)if(!b.gz)return!1;return!0}Eo(){this.gxa()}gxa(){this.Nu.clearCache();for(const a of this.HCb)a.dispose();Array.clear(this.HCb)}}
Object(n.a)(JN,"ShapesStyleActor",null,[365,1096]);class Qv{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.Ax=this.Pm=-1;this.Ms=a;this.ia=b;this.Fa=c;this.gf=f;this.oz=l;this.pa=w;this.mi=H;this.Ea=U;this.Qak=ja;this.Vak=wa;this.nma=Sa;this.yc=eb}get Mb(){return this.pa}wb(){this.ia.ra(L.a.n0a,nc.a.application,Object(F.a)(this,this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.o0a,nc.a.application,Object(F.a)(this,this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.p0a,nc.a.application,Object(F.a)(this,
this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.grc,nc.a.application,Object(F.a)(this,this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.FMb,nc.a.application,Object(F.a)(this,this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.mMb,nc.a.application,Object(F.a)(this,this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.jMb,nc.a.application,Object(F.a)(this,this.C7b,"handleFont"),5);this.ia.ra(L.a.ekb,nc.a.application,Object(F.a)(this,this.C7b,"handleFont"),5);this.ia.ra(L.a.fkb,nc.a.application,
Object(F.a)(this,this.C7b,"handleFont"),5);this.ia.ra(L.a.FXe,nc.a.application,Object(F.a)(this,this.Kvj,"handlePopulateFontNameDropdown"),97);this.ia.ra(L.a.rkb,nc.a.application,Object(F.a)(this,this.C7b,"handleFont"),4);this.ia.ra(L.a.DMb,nc.a.application,Object(F.a)(this,this.C7b,"handleFont"),4);this.ia.ra(L.a.krc,nc.a.application,Object(F.a)(this,this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.jrc,nc.a.application,Object(F.a)(this,this.yTa,"handleFontFormatAction"),4);this.ia.ra(L.a.Jnc,
nc.a.application,Object(F.a)(this,this.Zxb,"handleQueryFontToggleButton"),97);this.ia.ra(L.a.Knc,nc.a.application,Object(F.a)(this,this.Zxb,"handleQueryFontToggleButton"),97);this.ia.ra(L.a.Mnc,nc.a.application,Object(F.a)(this,this.Zxb,"handleQueryFontToggleButton"),97);this.ia.ra(L.a.Lnc,nc.a.application,Object(F.a)(this,this.Zxb,"handleQueryFontToggleButton"),97);this.ia.ra(L.a.fkd,nc.a.application,Object(F.a)(this,this.$Vc,"handleQueryFont"),100);this.ia.ra(L.a.ekd,nc.a.application,Object(F.a)(this,
this.$Vc,"handleQueryFont"),100);this.ia.ra(L.a.gkd,nc.a.application,Object(F.a)(this,this.$Vc,"handleQueryFont"),97);this.ia.ra(L.a.hkd,nc.a.application,Object(F.a)(this,this.$Vc,"handleQueryFont"),97);this.ia.ra(L.a.okd,nc.a.application,Object(F.a)(this,this.Zxb,"handleQueryFontToggleButton"),97);this.ia.ra(L.a.nkd,nc.a.application,Object(F.a)(this,this.Zxb,"handleQueryFontToggleButton"),97)}Ee(){const a=this.Fa.Fc(Lb.a.sg);a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_Bold),L.a.n0a);a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_Italic),
L.a.o0a);a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_Underline),L.a.p0a);a.bindAction(x.KeyInputManager.Oa(A.a.xMa,x.KeyInputManager.Oe|4),L.a.grc);a.bindAction(x.KeyInputManager.Oa(A.a.Qvd,x.KeyInputManager.Oe|4),L.a.FMb)}$Vc(a,b,c,f,l){c=this.Mb.tg();if(!c||1>c.length)return 16;f=this.Ea.r_(c);var w=this.Mb.ska();if(1>f.length&&!w)return 16;b=null;this.Pm=Date.now();w&&(b=this.yc.Z0f(w,new gt),this.Ax=Date.now(),va.a.J(512500294,815,50,"Query table shape font timespan by {0}",(this.Ax-
this.Pm).toString()));c=w?[c[0]]:f;for(const H of c){switch(a){case L.a.fkd:case L.a.ekd:break;case L.a.gkd:c=this.oz.Z5b(H.ud&&b?b.fontName:H.lOb);if(l.$Z&&l.$Z!==c){l.$Z="";break}l.$Z=c;l.mqc();break;case L.a.hkd:c="";H.ud&&b?-1!==b.fontSize&&(c=ha.a.gRc(b.fontSize/2,0,u.AFrameworkApplication.numberFormat)):c=H.Paa?Qv.X0f(H).toString():"";f=parseFloat(c);if(!isNaN(f)&&(w=l.$Z)&&w!==c){w=Math.min(f,parseFloat(w)).toString()+"+";l.$Z=w;break}l.$Z=c;l.mqc();break;default:return va.a.J(512500293,820,
10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.$Z&&!l.$Z.length)break}return 32}Zxb(a,b,c,f,l){b=this.Mb.tg();if(!b||1>b.length)return 16;b=this.Ea.r_(b);c=this.Mb.ska();if(1>b.length&&!c)return 16;a=c?this.pOk(c,a,new gt):this.weh(b,a);l.Lf("select"===a);return"disable"!==a?32:8}C7b(a,b,c,f,l){b=this.Mb.tg();if(!b||1>b.length)return 16;const w=this.Mb.ska();f=this.Ea.r_(b);if(1>f.length&&!w||this.gf.FC(f)||this.gf.FC([w]))return 16;if(1===c)return 32;this.Mb.jj();this.Fa.Ed();switch(a){case L.a.jMb:const U=
this.Gta(l,!0);if(!U)return 8;1<b.length?va.a.J(512500292,815,50,"Set {0} shapes font color.",b.length):va.a.J(512500291,815,50,"Set one shape font color.");for(const eb of b)if(eb.If||eb.Og){on(eb);break}this.Ms.Nja(eb=>{eb.SLa=U},f);break;case L.a.rkb:case L.a.DMb:let ja;if(a===L.a.rkb){if(ja=this.Gta(l,!1),!ja)return 8}else ja="";1<b.length?va.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):va.a.J(512500289,815,50,"Set one shape highlight.");this.Ms.Nja(eb=>{eb.highlight=ja},f);break;
case L.a.ekb:if(!l)return 8;const wa=this.oz.Z5b(l);if(wa.length){1<b.length?va.a.J(512500288,815,50,"Set {0} shapes font name.",b.length):va.a.J(512500259,815,50,"Set one shape font name.");var H=null;for(const eb of b)if(eb.If||eb.Og)on(eb),eb.If&&(H=eb);if(1>this.I4f(f,a,wa).length)return 16;this.Ms.Nja(eb=>{eb.lOb=wa},f);H&&(H.lOb=wa);this.oz.AGc(l)}break;case L.a.fkb:l=Object(qa.a)(sE.a,l);if(!l||!l.rd)return 8;const Sa=this.mi.W0b(l.rd);if(isNaN(Sa))return 8;1<b.length?va.a.J(512500258,815,
50,"Set {0} shapes font size.",b.length):va.a.J(512500257,815,50,"Set one shape font size.");l=null;for(H of b)if(H.If||H.Og)on(H),H.If&&(l=H);if(1>this.I4f(f,a,Sa*Ef.a.$$a).length)return 16;this.Ms.Nja(eb=>{eb.Ssh(Sa)},f);l&&l.Ssh(Sa);break;default:return va.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}yTa(a,b,c){b=this.Mb.tg();if(!b||1>b.length)return 16;const f=this.Mb.ska(),l=this.Ea.r_(b);if(1>l.length&&!f||this.gf.FC(l)||this.gf.FC([f]))return 16;if(1===c)return 32;
const w="select"!==this.weh(this.Ea.r_(b),a);this.Mb.jj();this.Fa.Ed();switch(a){case L.a.n0a:1<b.length?va.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):va.a.J(512500254,815,50,"Set one shape bold.");f&&Object(Pd.a)("FixTableModifyFontShortcut")&&this.ia.processAction(L.a.bold,2);this.Ms.Nja(U=>{U.isBold=w},l);break;case L.a.o0a:1<b.length?va.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):va.a.J(512500252,815,50,"Set one shape italic.");f&&Object(Pd.a)("FixTableModifyFontShortcut")&&
this.ia.processAction(L.a.setItalic,2);this.Ms.Nja(U=>{U.isItalic=w},l);break;case L.a.p0a:1<b.length?va.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):va.a.J(512500250,815,50,"Set one shape underline.");f&&Object(Pd.a)("FixTableModifyFontShortcut")&&this.ia.processAction(L.a.underline,2);this.Ms.Nja(U=>{U.hE=w},l);break;case L.a.mMb:1<b.length?va.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):va.a.J(512500248,815,50,"Set one shape strikethrough.");this.Ms.Nja(U=>{U.PF=
w},l);break;case L.a.grc:case L.a.FMb:const H=a===L.a.FMb?!1:!0;1<b.length?va.a.J(512500247,815,50,"Step {0} shapes font size.",b.length):va.a.J(512500246,815,50,"Step one shape font size.");this.Ms.Nja(U=>{U.GAb=H},l);break;case L.a.krc:1<b.length?va.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):va.a.J(512500244,815,50,"Step one shape superscript.");this.Ms.Nja(U=>{U.qN=w?3E4:0},l);break;case L.a.jrc:1<b.length?va.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):va.a.J(512500242,
815,50,"Step one shape subscript.");this.Ms.Nja(U=>{U.qN=w?-25E3:0},l);break;default:return 8}return 32}Kvj(a,b,c,f,l){if(1===c)return 32;We.Font.Tee(b);l.MenuItems=ea.FontUtils.HZf(Qv.Qqd,Qv.jRc,this.Qak,this.nma,this.Vak);return 32}weh(a,b){let c="select";for(const f of a){switch(b){case L.a.Jnc:case L.a.n0a:c=f.isBold?"select":"normal";break;case L.a.Knc:case L.a.o0a:c=f.isItalic?"select":"normal";break;case L.a.Mnc:case L.a.p0a:c=f.hE?"select":"normal";break;case L.a.Lnc:case L.a.mMb:c=f.PF?"select":
"normal";break;case L.a.okd:case L.a.krc:c=0<f.qN?"select":"normal";break;case L.a.nkd:case L.a.jrc:c=0>f.qN?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}pOk(a,b,c){this.Pm=Date.now();c=this.yc.Z0f(a,c);switch(b){case L.a.Jnc:a=1===c.bold?"select":"normal";break;case L.a.Knc:a=1===c.italic?"select":"normal";break;case L.a.Mnc:a=1===c.underline?"select":"normal";break;case L.a.Lnc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.Ax=Date.now();
va.a.J(512500241,815,50,"Query table shape font state timespan by {0}",(this.Ax-this.Pm).toString());return a}I4f(a,b,c){const f=[];for(const l of a)switch(b){case L.a.n0a:l.isBold!==c&&Array.add(f,l);break;case L.a.o0a:l.isItalic!==c&&Array.add(f,l);break;case L.a.p0a:l.hE!==c&&Array.add(f,l);break;case L.a.mMb:l.PF!==c&&Array.add(f,l);break;case L.a.ekb:l.lOb!==c&&Array.add(f,l);break;case L.a.fkb:Qv.X0f(l)!==c&&Array.add(f,l);break;case L.a.krc:0<l.qN!==c&&Array.add(f,l);break;case L.a.jrc:0>l.qN!==
c&&Array.add(f,l);break;default:va.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",b)}return f}Gta(a,b){if(b)return b=jo.SchemeColor.parse(a),b&&b.Nta?Bl.i(Bl.g(b.ZP)):(va.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=ru.a.parse(a);return b&&b.RGBColor?b.RGBColor:(va.a.J(512500238,820,10,"Color '{0}' is incorrect",a),null)}static jRc(a,b){return b}static Qqd(){return!1}static X0f(a){const b=a.W2;return Cf.a.fz(b,1)?a.Paa:Math.round(a.Paa)*
b}}Object(n.a)(Qv,"ShapesTextFontActor",null,[365]);class KN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.Ax=this.Pm=-1;this.Ms=a;this.ia=b;this.Fa=c;this.gf=f;this.pa=l;this.Ea=w;this.ieb=H;this.aM=U;this.Pb=ja;this.Jb=wa;this.Q2c=Sa;this.yc=eb;this.nA=ub}get Mb(){return this.pa}wb(){this.ia.ra(L.a.BMb,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.lMb,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.gkb,nc.a.application,Object(F.a)(this,
this.W8,"handleFormatAction"),4);this.ia.ra(L.a.CMb,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.tkb,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.kMb,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.frc,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.qqd,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.Opd,nc.a.application,Object(F.a)(this,
this.W8,"handleFormatAction"),4);this.ia.ra(L.a.Npd,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.Mpd,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.Lpd,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.DXe,nc.a.application,Object(F.a)(this,this.Sag,"handleQueryLineSpacing"),4);this.ia.ra(L.a.Qqc,nc.a.application,Object(F.a)(this,this.W8,"handleFormatAction"),4);this.ia.ra(L.a.pib,nc.a.application,
Object(F.a)(this,this.ATa,"handleQueryToggleButton"),97);this.ia.ra(L.a.qib,nc.a.application,Object(F.a)(this,this.ATa,"handleQueryToggleButton"),97);this.ia.ra(L.a.SZa,nc.a.application,Object(F.a)(this,this.ATa,"handleQueryToggleButton"),97);this.ia.ra(L.a.TZa,nc.a.application,Object(F.a)(this,this.ATa,"handleQueryToggleButton"),97);this.ia.ra(L.a.jkd,nc.a.application,Object(F.a)(this,this.ATa,"handleQueryToggleButton"),97);this.ia.ra(L.a.dkd,nc.a.application,Object(F.a)(this,this.ATa,"handleQueryToggleButton"),
97);this.ia.ra(L.a.lkd,nc.a.application,Object(F.a)(this,this.ATa,"handleQueryToggleButton"),97);this.ia.ra(L.a.ikd,nc.a.application,Object(F.a)(this,this.ATa,"handleQueryToggleButton"),97);this.ia.ra(L.a.rkd,nc.a.application,Object(F.a)(this,this.$be,"handleQueryTextAnchoring"),97);this.ia.ra(L.a.qkd,nc.a.application,Object(F.a)(this,this.$be,"handleQueryTextAnchoring"),97);this.ia.ra(L.a.pkd,nc.a.application,Object(F.a)(this,this.$be,"handleQueryTextAnchoring"),97);this.ia.ra(L.a.kkd,nc.a.application,
Object(F.a)(this,this.Sag,"handleQueryLineSpacing"),97)}Ee(){const a=this.Fa.Fc(Lb.a.sg);a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_FullJustify),L.a.kMb);a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_CenterJustify),L.a.CMb);B.a.wk?(a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_LeftJustify_Mac),L.a.gkb),a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_RightJustify_Mac),L.a.tkb)):(a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_LeftJustify),L.a.gkb),a.bindAction(x.KeyInputManager.qw(ResourceStrings.l_HK_RightJustify),
L.a.tkb))}ATa(a,b,c,f,l){const w=this.Mb.tg();if(!w||1>w.length)return 16;b=this.Mb.ska();const H=this.Ea.r_(w);if(1>H.length&&!b)return 16;f=c=null;let U=a===L.a.pib?1:a===L.a.qib?2:18;Object(Ya.a)(Xh.a,l)?f=l:Object(Ya.a)(Mv,l)&&(f=l.WZa,U=l.menuItemId);l=b?[w[0]]:H;this.Pm=Date.now();for(const ja of l){switch(a){case L.a.pib:c=ja.ud?this.uae(U,a):this.G$d(U,ja,a);break;case L.a.qib:c=ja.ud?this.uae(U,a):this.G$d(U,ja,a);break;case L.a.SZa:case L.a.TZa:c=ja.ud?this.uae(U,a):this.G$d(U,ja,a);break;
case L.a.jkd:c=ja.ud?1===this.yc.uSc(b)?"select":"normal":1===ja.Jl?"select":"normal";break;case L.a.dkd:c=ja.ud?2===this.yc.uSc(b)?"select":"normal":2===ja.Jl?"select":"normal";break;case L.a.lkd:c=ja.ud?3===this.yc.uSc(b)?"select":"normal":3===ja.Jl?"select":"normal";break;case L.a.ikd:c=ja.ud?6===this.yc.uSc(b)?"select":"normal":4===ja.Jl?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.Lf("select"===c);this.Ax=Date.now();b&&va.a.J(512500237,815,50,"Query table shape timespan by {0}",
(this.Ax-this.Pm).toString());return"disable"!==c?32:8}G$d(a,b,c){return c===L.a.SZa||c===L.a.pib||c===L.a.TZa||c===L.a.qib?this.aM.Cyf(b,a)?"select":"normal":"normal"}uae(a,b){var c=!0,f=this.Mb.ska();f=Od.SelectionFactory.aMc(Object(qa.a)(yg.a,f));for(const l of f){if(c=l.al?l.node:null)if(f=this.Pb.Mc(c),f.set(c),f.rc(11),f.Jg(11),c=this.nA.lw(f)){if(0===a){c=!1;break}if(b===L.a.pib)c=1===c.listType;else if(b===L.a.qib)c=0===c.listType;else if(b===L.a.SZa){f=this.aM.AVa.ga(a).j_b;const w=this.aM.AVa.ga(a).Jsb;
c=c.dyb&&0<c.z9.length&&c.z9[0]===f&&c.P$a&&c.font===w}else b===L.a.TZa?(f=this.aM.Eed.ga(a).JSd,c=!!c.propertySet&&c.propertySet.Sa(hb.a.autonumberBulletType)&&c.propertySet.eb(hb.a.autonumberBulletType)===f):c=!1}else c=0===a?b===L.a.SZa||b===L.a.TZa?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}W8(a,b,c,f,l){f=this.Mb.tg();if(!f||1>f.length)return 16;b=this.Ea.r_(f);const w=this.Mb.ska(),H=!!w&&(a===L.a.frc||a===L.a.qqd);if(!b.length&&!w||H||this.gf.FC(b)||this.gf.FC([w]))return 16;
if(1===c)return 32;this.Mb.jj();a!==L.a.Qqc&&this.Fa.Ed();switch(a){case L.a.BMb:case L.a.lMb:if(Object.getType(l)!==Number)return 8;this.afl(f,b,l);break;case L.a.gkb:case L.a.CMb:case L.a.tkb:case L.a.kMb:var U=this.oOf(b);this.Zel(b,a,l);U&&this.pa.selectShape(U,!1);Rc.a.nP(!0,!1);break;case L.a.frc:case L.a.qqd:l=[];const ja=a===L.a.frc?1:2;for(U of b)Array.add(l,U);1<f.length?va.a.J(512500236,815,50,"Set {0} shapes text direction.",f.length):va.a.J(512500235,815,50,"Set one shape text direction.");
this.Ms.E8a(Sa=>{if(Sa=Object(qa.a)(4,Sa))Sa.kOb=ja},l);break;case L.a.Qqc:if(!l||!Object(Ya.a)(Array,l)||1>l.length)return 8;Rc.a.Ib&&(Rc.a.Ib.Oj=!0);b=this.Jb.Ad(15);try{for(b.nc(l[0].F1),b.jd=a,a=0;a<l.length;a++)l[a].F1.Tia=l[a].W$.left,l[a].F1.Uia=l[a].W$.right,l[a].F1.Via=l[a].W$.top,l[a].F1.Sia=l[a].W$.bottom}finally{b&&b.dispose()}Rc.a.nP(!0,!1);break;case L.a.Opd:case L.a.Npd:case L.a.Mpd:l=[];let wa=1;switch(a){case L.a.Opd:wa=0;break;case L.a.Npd:wa=1;break;case L.a.Mpd:wa=2}for(const Sa of b)Array.add(l,
Sa);va.a.J(512500234,815,50,"Set text anchoring, shape count: {0}.",f.length);this.Ms.E8a(Sa=>{if(Sa=Object(qa.a)(4,Sa))Sa.gpa=wa},l);Rc.a.nP(!0,!1);break;case L.a.Lpd:if(!l||Object.getType(l)!==Number)return 8;U=this.oOf(b);this.$el(b,l,a);U&&this.pa.selectShape(U,!1);Rc.a.nP(!0,!1);break;default:return 8}return 32}$be(a,b,c,f,l){b=this.Mb.tg();if(!b||1>b.length)return 16;b=this.Mb.N7d(b);f=b.FAb;c=0;const w=this.Mb.ska();if(!f&&!w)return 16;switch(a){case L.a.rkd:a=w?({pxa:c}=this.yc.O3e(w)).returnValue&&
0===c?"select":"normal":0===b.gpa?"select":"normal";break;case L.a.qkd:a=w?({pxa:c}=this.yc.O3e(w)).returnValue&&1===c?"select":"normal":1===b.gpa?"select":"normal";break;case L.a.pkd:a=w?({pxa:c}=this.yc.O3e(w)).returnValue&&2===c?"select":"normal":2===b.gpa?"select":"normal";break;default:a="disable"}l.Lf("select"===a);return"disable"!==a?32:8}Sag(a,b,c,f,l){c=this.Mb.tg();if(!c||1>c.length)return 16;b=this.Mb.ska();c=this.Ea.r_(c);if(!c.length&&!b)return 16;this.Pm=Date.now();switch(a){case L.a.DXe:break;
case L.a.kkd:a=new wN.a;a.unit=2;a.value=l.MenuItemId;f=!0;b&&(f=this.ell(b,l),this.Ax=Date.now(),va.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.Ax-this.Pm).toString()));for(const w of c){b=this.Ea.F$d(w);if(!b||!this.ieb.Iyf(b,a)){f=!1;break}this.Q2c&&2===b.unit&&(b.value=Math.max(0,b.value-this.Ea.f6d(w)))}l.queryResult.Lf(f);break;default:return 8}return 32}$el(a,b,c){const f=this.Jb.Ad(15);try{f.nc(a[0]);f.jd=c;for(const l of a)l.dta();this.ia.La(L.a.Sna,2,b)}finally{f&&f.dispose()}}Zel(a,
b,c){const f=[];let l=0,w=0;switch(b){case L.a.gkb:l=1;w=D.a.ula;break;case L.a.CMb:l=2;w=D.a.bja;break;case L.a.tkb:l=3;w=D.a.Aoa;break;case L.a.kMb:l=4,w=D.a.RDa}a=this.pa.aP(a);for(const H of a)H.Jl!==l&&Array.add(f,H);if(w&&f.length){for(const H of a)if(H.If||H.Og){on(H);break}a=this.Jb.Ad(15);try{a.nc(f[0]);for(const H of f)H.dta(),H.Pfl(l);this.ia.La(w,2,c)}finally{a&&a.dispose()}}}afl(a,b,c){const f=[];let l=1===c||2===c;for(const H of b)this.aM.Cyf(H,c)||(l=!1,Array.add(f,H));1<a.length?va.a.J(512500231,
815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):va.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const H of a)if(H.If||H.Og){on(H);break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const w=this.aM.AVa.ga(c);0<a.length&&this.Ms.E8a(H=>{H.setValue(hb.a.jOb,c);w&&(H.setValue(hb.a.pCh,w.Jsb),H.setValue(hb.a.oCh,w.j_b))},a)}ell(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=Od.SelectionFactory.aMc(Object(qa.a)(yg.a,a));for(const w of a){if(a=
w.al?w.node:null){a=this.ieb.QW(a);const H=Cf.a.fz(a.lineSpacing.value,f)&&2===a.lineSpacing.unit;if(-1===l)b=a.lineSpacing.unit,l=a.lineSpacing.value;else if(l!==a.lineSpacing.value||b!==a.lineSpacing.unit)l=b=0,c=!1;0!==b&&(c=H)}if(!c)break}return c}oOf(a){return 0<a.length&&a[0].Og&&(a=this.Ea.ys(a[0]))?(this.pa.s8(a),a):null}}Object(n.a)(KN,"ShapesTextParagraphActor",null,[365]);var FR=d(687);class LN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.ia=a;this.gf=b;this.Jb=c;this.hA=f;this.Fa=
l;this.pa=w;this.Vb=H;this.ua=U;this.Tb=ja;this.Ha=wa;this.Mu=Sa;this.Fb=eb;if(!ub)throw Error.argumentNull("GraphOperationEventHandler is null");this.Yf=ub}wb(){this.ia.ra(L.a.deleteObject,Cb.a.application,Object(F.a)(this,this.Osj,"handleDelete"),4);this.Ha.podsEnableSlideScoreCard&&this.ia.ra(L.a.yeh,Xd.a.frame,Object(F.a)(this,this.uHl,"updateSlideScore"),96);this.ia.ra(L.a.k1d,nc.a.application,Object(F.a)(this,this.gtj,"handleDuplicate"),4);this.ia.ra(L.a.htf,nc.a.application,Object(F.a)(this,
this.orj,"handleAddFirstSlide"),4);this.Ha.ITj?(this.ia.ra(L.a.zI,Cb.a.application,Object(F.a)(this,this.Ysj,"handleDeleteSlides"),4),this.ia.ra(L.a.iQ,nc.a.application,Object(F.a)(this,this.jtj,"handleDuplicateSlides"),4),this.Ha.ide?(this.ia.ra(L.a.o8b,nc.a.application,Object(F.a)(this,this.Qtj,"handleHideSlides"),4),this.ia.ra(L.a.H4e,nc.a.application,Object(F.a)(this,this.lyj,"handleUnhideSlides"),4),this.Yf.vrb(Object(F.a)(this,this.Mpl,"slidesSelectionChangedHandler"))):this.ia.ra(L.a.o8b,nc.a.application,
Object(F.a)(this,this.Mbe,"handleHideSlidesOld"),4),this.ia.ra(L.a.ukd,Cb.a.application,Object(F.a)(this,this.kwj,"handleQuerySlidesHidden"),96)):(this.ia.ra(L.a.zI,Cb.a.application,Object(F.a)(this,this.Xsj,"handleDeleteSlide"),4),this.ia.ra(L.a.iQ,nc.a.application,Object(F.a)(this,this.itj,"handleDuplicateSlide"),4),this.ia.ra(L.a.o8b,nc.a.application,Object(F.a)(this,this.Ptj,"handleHideSlide"),4),this.ia.ra(L.a.ukd,Cb.a.application,Object(F.a)(this,this.jwj,"handleQuerySlideHidden"),96));this.ia.ra(L.a.F_d,
Cb.a.application,Object(F.a)(this,this.Rsj,"handleDeleteFakeSlides"),2048);this.ia.ra(L.a.XFf,Cb.a.application,Object(F.a)(this,this.vsj,"handleClearAndResizeSlideCanvas"),2048);this.ia.ya(L.a.vqd,nc.a.application,Object(F.a)(this,this.Bxj,"handleShareSlide"));this.ia.ra(L.a.JOe,Cb.a.application,Object(F.a)(this,this.Pbe,"handleIsDirectManipulationEnabled"),97)}Ee(){const a=this.Fa.Fc(Zi.a.PD);a.bindAction(x.KeyInputManager.Oa(A.a.upa,0),L.a.zI);a.bindAction(x.KeyInputManager.Oa(A.a.VH,0),L.a.zI);
a.bindAction(x.KeyInputManager.Oa(A.a.HMa,x.KeyInputManager.Oe),L.a.iQ)}Osj(a,b,c,f,l){if(this.Fa.Ae)if(this.Fa.m8===Zi.a.PD||1===this.Fb.Fl||this.Ha.Ln&&this.Fa.m8===Lb.a.PB)a=L.a.zI;else if(this.Fa.m8===Lb.a.sg)a=L.a.k7a;else return 8;else return 8;return this.ia.La(a,c,l)}Xsj(a,b,c){b=this.ua.Ba;if(!b||this.gf.$c(b)||this.Ha.HC&&1!==this.pa.Qe().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Rc.a.Ib&&(Rc.a.Ib.actionName="DeleteSlide",Rc.a.Ib.Ur=!1,Rc.a.Ib.Oj=!0,Rc.a.Ib.Va("SlideCount",
"1"));c=this.Vb.xf;if(!c)return 16;const f=this.Jb.Ad(15,void 0,()=>{this.pa.Rh()});try{f.nc(c),f.jd=a,c.zI(b)}finally{f&&f.dispose()}this.gf.hw(c,a);a=[];a.push(b);this.Mu?this.Mu.$kd(new GE.a(a)):va.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}vsj(a,b,c){a=this.Tb.ZA(this.ua.I1c?this.ua.I1c.slideIndex:0);if(!a)return va.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(qa.a)(566,a.sc(this.Fb.Ma));if(!a)return va.a.J(512313373,
822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;va.a.J(512313372,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");a.CWe(!1);a.updateOffSlideView(0,!0);return 32}Rsj(a,b,c){b=[];for(const f of this.Tb.twb())f.XN&&Array.add(b,f);if(!b.length||!this.ua.Ba)return va.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;va.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");return this.kOf(b,"DeleteFakeSlide",
a)}Ysj(a,b,c){b=this.pa.Qe();if(!b||!b.length||!this.ua.Ba)return 16;for(const f of b)if(!f||this.gf.$c(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;return this.kOf(b,"DeleteSlide",a)}kOf(a,b,c){Rc.a.Ib&&(Rc.a.Ib.actionName=b,Rc.a.Ib.Ur=!1,Rc.a.Ib.Oj=!0,Rc.a.Ib.Va("SlideCount",a.length.toString()));1<a.length?va.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):va.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");b=this.Vb.xf;
if(!b)return 16;this.WLi(b,a,c,()=>{this.pa.Rh()});return 32}WLi(a,b,c,f){f=this.Jb.Ad(15,void 0,f);try{f.nc(a);for(const l of b)l&&!l.Cb.equals(this.ua.Ba.Cb)&&a.zI(l);a.zI(this.ua.Ba);f.jd=c}finally{f&&f.dispose()}this.Ha.unblockContentWhenDeletingSlideEnabled||this.gf.hw(a,c);this.Mu?this.Mu.$kd(new GE.a(b)):va.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}jwj(a,b,c,f,l){a=this.ua.Ba;if(!a)return 16;l.Lf(a.jn);return 32}kwj(a,b,c,f,l){a=this.pa.Qe();
if(!a||!a.length)return 16;a=this.WRd(a);l.Lf(a);return 32}Bxj(a,b,c,f,l){a=this.ua.Ba;if(!a||this.gf.$c(a)||1!==this.pa.Qe().length)return 16;if(1===c)return 32;Rc.a.Ib&&(Rc.a.Ib.Ur=!1,Rc.a.Ib.Va("SlideCount","1"));c=a.Cb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=FR.a(c);l.mode="copy";va.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.La(G.a.Xsa,2,l);return 32}Ptj(a,b,c){b=this.ua.Ba;if(!b||this.gf.$c(b)||this.Ha.HC&&1!==this.pa.Qe().length)return 16;if(1===
c)return 32;Rc.a.Ib&&(Rc.a.Ib.Ur=!1,Rc.a.Ib.Va("SlideCount","1"));c=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},()=>{1!==this.Fb.Fl&&(this.Ha.Ln?this.Fa.rf(Lb.a.PB):this.Fa.rf(Zi.a.PD))});try{c.nc(b),c.jd=a,b.jn=!b.jn}finally{c&&c.dispose()}return 32}Mbe(a,b,c){b=this.pa.Qe();if(!b||!b.length)return 16;for(var f of b)if(!f||this.gf.$c(f))return 8;if(1===c)return 32;va.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Rc.a.Ib&&(Rc.a.Ib.Ur=!1,Rc.a.Ib.Va("SlideCount",
b.length.toString()));c=!this.WRd(b);f=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},()=>{1!==this.Fb.Fl&&(this.Ha.Ln?this.Fa.rf(Lb.a.PB):this.Fa.rf(Zi.a.PD))});try{f.nc(this.Vb.xf);f.jd=a;for(const l of b)l.jn=c}finally{f&&f.dispose()}return 32}Qtj(a,b,c,f,l){const w=this.pa.Qe();if(!w||!w.length)return 16;for(const H of w)if(!H||this.gf.$c(H))return 8;if(this.WRd(w))return this.jWc(),32;this.Mbe(a,b,c,f,l);this.jWc();return 32}lyj(a,b,c,f,l){const w=this.pa.Qe();if(!w||!w.length)return 16;
for(const H of w)if(!H||this.gf.$c(H))return 8;if(1===c)return 32;this.Mbe(a,b,c,f,l);this.jWc();return 32}jWc(){var a=this.pa.Qe();if(a&&a.length){for(var b of a)if(!b||this.gf.$c(b))return;if(Sg.c()){b=!0;for(const c of a)if(!c.jn){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else va.a.J(512313362,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}Mpl(){this.jWc()}uHl(a,
b,c,f,l){if(1===c)return 32;this.ua.Ba&&(a="Slide Complex: "+this.ua.Ba.sa(hb.a.roa,0).toString(),l[Fp.a.Value]=a,l[hm.a.labelText]=a,l[Fp.a.Visible]=!0);return 32}gtj(a,b,c,f,l){if(this.Fa.Ae)if(this.Fa.m8===Zi.a.PD)a=L.a.iQ;else if(this.Fa.m8===Lb.a.sg)a=L.a.p8a;else return 8;else return 8;return this.ia.La(a,c,l)}itj(a,b,c){b=this.ua.Ba;if(!b||this.gf.$c(b)||this.Ha.HC&&1!==this.pa.Qe().length)return 16;if(1===c)return 32;Rc.a.Ak("SlideCount","1");this.hA.SUi(b,a).KQ||this.gf.hw(this.Vb.xf,a);
return 32}jtj(a,b,c){b=this.pa.Qe();if(!b||!b.length)return 16;for(var f of b)if(!f||this.gf.$c(f))return 16;if(1===c)return 32;1<b.length?va.a.J(512313361,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):va.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");Rc.a.Ak("SlideCount",b.length.toString());c=this.hA.fUf(b,a,null,null,!0);f=!0;for(const l of c)if(!l.KQ){f=!1;break}f||this.gf.hw(this.Vb.xf,a);return 32}orj(){try{va.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");
const a=this.Tb.HI();a&&0<a.length&&this.hA.APc(null,a[0].Id,this.Ha.Mac?0:a[0].ContentMasters[0].Id,L.a.PGb);return 32}catch(a){return va.a.J(512313358,801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}Pbe(a,b,c,f,l){return l&&Object(Ya.a)(N.a,l)?this.gf.$c(this.Tb.zl(l))?16:32:8}WRd(a){for(const b of a)if(!b.jn)return!1;return!0}}Object(n.a)(LN,"SlideActor",null,[365]);var GR=d(1135);const QE=()=>{appChrome.PRIToastManager.dismissToast()};class RE{constructor(a,b,c){this.slideId=a;this.Jkk=
b;this.RAi=c}}Object(n.a)(RE,"NewSlideWithLayoutData",null,[]);class dj{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){this.Gva=0;this.w6c={};this.yTg=this.zTg=0;this.ia=a;this.fc=b;this.Fa=c;this.Yak=dj.zNj(f);this.pa=l;this.Jb=w;this.hA=H;this.Vb=U;this.ua=ja;this.Tb=wa;this.rse=Sa;this.Nu=eb;this.Nu.YGc(Object(F.a)(this,this.z8g,"openIgnoredDialog"));this.Ha=ub;this.$Eb=Ub;this.dwa={}}wb(){this.Ha.HTj?this.ia.ra(L.a.cja,nc.a.application,Object(F.a)(this,this.pbg,"handleSlidesChangeLayout"),4):
this.ia.ra(L.a.cja,nc.a.application,Object(F.a)(this,this.nsj,"handleChangeLayout"),4);this.ia.ra(L.a.vna,nc.a.application,Object(F.a)(this,this.Fag,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(L.a.C5,nc.a.application,Object(F.a)(this,this.Eag,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(L.a.PGb,nc.a.application,Object(F.a)(this,this.Eag,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(L.a.fed,nc.a.application,Object(F.a)(this,this.Zuj,"handleNewSlideWithLayout"),4);this.ia.ra(L.a.sIb,nc.a.application,
Object(F.a)(this,this.Fag,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(L.a.lYc,nc.a.application,Object(F.a)(this,this.Iwj,"handleReactInsertSlideWithLayout"),4);this.ia.ra(L.a.zLe,nc.a.application,Object(F.a)(this,this.pbg,"handleSlidesChangeLayout"),4);this.ia.ra(L.a.gVd,nc.a.application,Object(F.a)(this,this.Hwj,"handleReactChangeSlideLayout"),4);this.ia.ra(L.a.Qjd,nc.a.application,Object(F.a)(this,this.Qjd,"queryNewSlideLayout"),4);this.ia.ra(L.a.QNe,nc.a.application,Object(F.a)(this,this.QNe,
"queryChangeSlideLayout"),4)}Ee(){const a=this.Fa.Fc(Zi.a.PD),b=this.Fa.Fc(Zi.a.Y2),c=this.Fa.Fc(Lb.a.sg),f=this.Fa.Fc(Lb.a.kQ);a.bindAction(x.KeyInputManager.Oa(A.a.tq,0),L.a.C5);a.bindAction(x.KeyInputManager.Oa(A.a.Vga,x.KeyInputManager.Oe),L.a.C5);c.bindAction(x.KeyInputManager.Oa(A.a.Vga,x.KeyInputManager.Oe),L.a.C5);b.bindAction(x.KeyInputManager.Oa(A.a.Vga,x.KeyInputManager.Oe),L.a.C5);f.bindAction(x.KeyInputManager.Oa(A.a.Vga,x.KeyInputManager.Oe),L.a.C5)}Brc(){return this.Yak||this.Tb.wce()}nsj(a,
b,c){const f=this.ua.Ba;if(!f||this.fc.$c(f)||this.Ha.HC&&1!==this.pa.Qe().length)return 16;a=f.ij;if(!a)return 8;b=this.Tb.HI();if(!this.Ha.dVa){if(!b)return va.a.J(512500229,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),8;if(!this.nmb(b,a))return 8}if(1===c)return 32;if((!this.Ha.dVa||b&&this.nmb(b,a))&&this.Nu.PO.Gb(a)&&this.ioe()){this.Gva=0;c=f.Cn;if(!c)return va.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.rse.nYd(0,
this.Tb.Hu(),b,this.Nu.PO,a,Object(F.a)(this,this.gVd,"changeSlideLayout"),this.Brc(),u.AFrameworkApplication.isRtl).nrd(c)}else va.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.Nu.R_e(a),this.Gva=L.a.cja;return 32}pbg(a,b,c,f,l){b=this.pa.Qe();if(!b||!b.length)return 8;f=0;const w=[],H=this.Tb.HI();if(!H)return va.a.J(512500226,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var U of b){if(this.fc.$c(U)||
!U)return 16;f=U.ij;if(!f)return va.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;w.push(f);if(!this.Ha.dVa&&!this.nmb(H,f))return va.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),8}if(1===c&&!this.Ha.b_a)return 32;for(const ja of w)if(this.Ha.dVa&&!this.nmb(H,f)||!this.Nu.PO.Gb(ja)){va.a.J(512500195,822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.Nu.R_e(f);
if(this.Ha.b_a)return this.ice(a,c,()=>{this.Nu.YGc(QE)},l);this.Gva=L.a.cja;return 32}U=this.Gva=0;for(const ja of b)if(U=ja.Cn,!U)return va.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?va.a.J(512500193,822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):va.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");1<b.length&&(U=0);if(!this.ioe())return va.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),
Pd.a("RaiseFirstMasterRetrievedEvent")?this.ice(a,c,()=>{this.Nu.nai(QE)},l):8;if(this.Ha.b_a){if(1===c)return 32;if(!l)return 8;this.yTg=U;this.Oid(l,H,f,!0)}else this.rse.nYd(0,this.Tb.Hu(),H,this.Nu.PO,f,Object(F.a)(this,this.OEf,"changeSlidesLayout"),this.Brc(),u.AFrameworkApplication.isRtl).nrd(U);return 32}gVd(a,b){const c=this.ua.Ba;if(c){var f=()=>{this.Fa.Ed();this.pa.Rh()},l=()=>{this.Fa.rf(Zi.a.PD)};a=parseInt(a);b=parseInt(b);if(a!==c.ij||b!==c.Cn){const w=Rc.a.Ib;Rc.a.yud("ChangeSlideLayout");
Rc.a.Ib&&(Rc.a.Ib.Ur=!0,Rc.a.Ib.Va("SlideCount","1"));f=this.Jb.Ad(15,void 0,f,l);try{f.nc(c),f.jd=L.a.cja,c.ij=a,c.Cn=b}finally{f&&f.dispose()}this.fc.hw(c,"ChangeSlideLayout");Rc.a.Ib=w}}}OEf(a,b){const c=this.pa.Qe();if(c&&c.length){a=parseInt(a);b=parseInt(b);var f=Rc.a.Ib;Rc.a.yud("ChangeSlidesLayout");Rc.a.Ib.Ur=!0;var l=[];for(var w of c)a===w.ij&&b===w.Cn||l.push(w);if(l.length){Rc.a.Ak("SlideCount",l.length.toString());w=this.Jb.Ad(15,void 0,()=>{this.Fa.Ed();this.pa.Rh()},()=>{this.Fa.rf(Zi.a.PD)});
try{w.nc(this.ua.Ba);w.jd=L.a.cja;for(const H of l)H.ij=a,H.Cn=b}finally{w&&w.dispose()}for(const H of c)this.fc.hw(H,"ChangeSlidesLayout");Rc.a.Ib=f}}}Hwj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{let w,H;if(!({masterId:w,layoutId:H}=this.f4e(l.SourceControlId)).returnValue)return 8;va.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");this.OEf(w,H)}catch(w){return va.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",
w),8}return 32}Fag(a,b,c,f,l){f=this.Vb.xf;if((b=this.ua.Ba)&&this.fc.$c(b)||this.fc.$c(f))return va.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),16;f=this.Tb.HI();if(!f||!f.length)return va.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let w=0;if(b){if(w=b.ij,!w)return va.a.J(512500185,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else w=f[0].Id;let H=0;({ij:w,Cn:H}=
this.GSc(f,b));if(!this.Ha.dVa&&!this.nmb(f,w))return va.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Tb.qj())return 8;if(!this.Ha.b_a)return 32}if(this.Ha.dVa&&!this.nmb(f,w)||!this.Nu.PO.Gb(w)||!this.ioe()){va.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");this.Nu.R_e(w);if(this.Ha.b_a)return this.ice(a,c,()=>{this.Nu.YGc(QE)},l);this.Gva=L.a.vna}else if(this.Gva=
0,this.Ha.b_a){if(1===c)return 32;if(!l)return 8;this.zTg=H;this.Oid(l,f,w,!1)}else this.rse.nYd(1,this.Tb.Hu(),f,this.Nu.PO,w,Object(F.a)(this,this.lYc,"insertSlideWithLayout"),this.Brc(),u.AFrameworkApplication.isRtl).nrd(H);return 32}Oid(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=Pd.a("ReactSlideLayoutSectionsAPIEnabled")?this.o6b(b,c,f):this.Mhj(b,c,f));va.a.J(512500182,822,50,"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}s$d(){const a=this.Tb.Hu();
if(!a||!a.width||!a.height)return va.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new gr.a(dj.vCf,dj.Uni);const b=dj.vCf;return new gr.a(b,a.height/a.width*b)}iTc(){const a={},b={},c=this.s$d();b.root=this.ZYd(c.width+dj.DCf,c.height+dj.DCf+dj.Lni+dj.$ni);b.flexContainer={flexDirection:"column"};b.label=dj.EYd();a.galleryButtonInExpanded=b;return a}ZYd(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}Mhj(a,b,c){this.zld();const f=Object.assign(new Tl.a,
{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,w=!1;const H=a.length;if(!H||1===H&&a&&a[0]&&!a[0].InContent)return f;for(var U=0;U<H;U++)a[U].Id===b&&(l=U,w=!0);w&&(b=this.A4f(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<H;b++)w&&b===l||(U=this.A4f(a[b],a[b].Id,c,b),Array.add(f.MenuSectionList,U));return f}A4f(a,b,c,f){const l=Object.assign(new ek.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.Nu.PO&&this.Nu.PO.Gb(a.Id)))return l;
var w=this.iTc(),H=c?"ChangeLayout":"NewSlide",U=c?"ChangeLayoutControls":"NewSlideLayoutControls";dj.kcd++;f=Pd.a("ReactSlideLayoutUniqueIdFix")?f.toString():b.toString()+"_"+dj.kcd.toString();w=Object.assign(new yq.a,{Id:U,ExternalId:H+"_"+f,Type:4,Title:a.Name,GalleryStyle:w,Width:3,GalleryItems:[]});a=a.ContentMasters;if(!a)return l;H=a.length;for(U=0;U<H;U++)f=a[U],!f||!this.Brc()&&this.Tb.Iab(f)||Array.add(w.GalleryItems,this.qwb(f,b,c));Array.add(l.ControlList,w);return l}Aui(){try{const a=
[],b=this.dwa;for(let c in b)a.push(c);this.dwa={};this.w6c={};appChrome.api.unregisterIcons(a)}catch(a){va.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",a)}}zld(){this.Aui();try{const a=this.Tb.HI();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.Nu.PO&&this.Nu.PO.count&&this.Nu.PO.Gb(c.Id)&&this.addIconToMap(this.Nu.PO.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.dwa)}}catch(a){va.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",
a)}}p6b(a,b){a=String.format("{0}_{1}_{2}",dj.OBj,a,b);a in this.w6c||(dj.kcd++,this.w6c[a]=a+"_"+dj.kcd.toString());return this.w6c[a]}addIconToMap(a,b){if(this.ua.Ba&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.p6b(b,c.LayoutId),w={},H={};c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(H.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),u.AFrameworkApplication.isRtl&&Pd.a("ReactSlideLayoutRTLFix")?H.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):H.left=String.format("-{0}px",
c.Icon.Clip.Bounds.Left));H.position="absolute";const U={},ja={},wa=this.s$d();ja.height=wa.height.toString()+"px";ja.width=wa.width.toString()+"px";ja.position="relative";ja.overflow="hidden";ja.display="inline-block";U.root=ja;w.root=H;this.$Eb&&c.Icon&&(c=appChrome.buildLayoutImageIconFromUrlWithStyles(this.$Eb.resolve(be.a.fvb,c.Icon.ImgId,dj.Doi),w,U),this.dwa[l]=c)}}o6b(a,b,c){this.zld();const f=Object.assign(new Tl.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],
UpdateDynamically:!0});var l=Object.assign(new ek.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var w=this.iTc();w=Object.assign(new yq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:w,Width:3,Type:4,GallerySections:[]});
Array.add(l.ControlList,w);l=0;let H=!1;const U=a.length;va.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",U);if(!U||1===U&&a&&a[0]&&!a[0].InContent)return va.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",c,U,1===U&&!!a&&!!a[0]&&a[0].InContent),f;for(var ja=0;ja<U;ja++)a[ja].Id===b&&(l=ja,H=!0);H&&(b=this.$ah(a[l],b,c),w.GallerySections.push(b));for(b=0;b<U;b++)H&&b===l||(ja=this.$ah(a[b],
a[b].Id,c),w.GallerySections.push(ja));return f}$ah(a,b,c){const f=Object.assign(new GR.a,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});if(!(a.InContent&&this.Nu.PO&&this.Nu.PO.Gb(a.Id)))return va.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",c,a.InContent,!!this.Nu.PO&&this.Nu.PO.Gb(a.Id)),f;a=a.ContentMasters;if(!a)return va.a.J(512500175,
822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;for(let w=0;w<l;w++){const H=a[w];!H||!this.Brc()&&this.Tb.Iab(H)||Array.add(f.GalleryButtons,this.qwb(H,b,c))}return f}$Da(a,b,c){return Pd.a(dj.LEf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}qwb(a,b,c){const f=a.Id,l=this.$Da(b.toString(),f.toString(),c),w={},H={},U=this.s$d();H.width=U.width.toString()+"px";H.height=U.height.toString()+"px";
Pd.a("ReactNewSlideLayoutIconBorderFix")||(H.border="#858585 1px solid");w.root=H;return Object.assign(new pE.a,{Id:l,ExternalId:l,Icon:this.p6b(b,f),Command:c?"3430900587":"1579226270",QueryCommand:Pd.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:w,Alt:a.Name})}Eag(a,b,c){if(this.fc.YN(this.Vb.xf))return 16;b=this.Tb.HI();if(!b)return 8;let f=null;if(this.Ha.HC){var l=this.pa.Qe();1<=l.length&&(l.sort((H,U)=>H.me-U.me),a!==L.a.PGb&&(f=l[l.length-
1]))}else a!==L.a.PGb&&(f=this.ua.Ba);if(this.fc.$c(f))return 16;let w;({ij:l,Cn:w}=this.GSc(b,this.ua.Ba));if(!this.nmb(b,l))return 8;if(1===c)return 32;c=this.hA.APc(Object(qa.a)(116,f),l,w,a);this.ytf(l,w);c.KQ||this.fc.hw(c,a);return 32}Zuj(a,b,c,f,l){if(this.fc.YN(this.Vb.xf))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.Jkk;l=l.RAi;f=null;this.Ha.HC?(c=this.pa.Qe(),1<=c.length&&(c.sort((w,H)=>w.me-H.me),f=c[c.length-1])):f=this.Tb.zl(c);c=this.hA.APc(f,b,l,a);this.ytf(b,l);c.KQ||
this.fc.hw(c,a);return 32}dispose(){this.Nu.x_k(Object(F.a)(this,this.z8g,"openIgnoredDialog"));this.dwa=null}lYc(a,b){const c=this.ua.Ba;let f=N.a.empty;c&&(f=c.Cb);const l=this.Tb.HI();l&&("0"===a||"0"===b?{ij:a,Cn:b}=this.GSc(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.La(L.a.fed,2,new RE(f,a,b)))}Iwj(a,b,c,f,l){if(1===c)return 32;if(!l||!({masterId:c,layoutId:b}=this.f4e(l.SourceControlId)).returnValue)return 8;f=this.ua.Ba;a=N.a.empty;f&&(a=f.Cb);l=this.Tb.HI();if(!l)return 8;"0"===c||"0"===b?
{ij:c,Cn:b}=this.GSc(l,f):(c=parseInt(c),b=parseInt(b));va.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");return this.ia.La(L.a.fed,2,new RE(a,c,b))}GSc(a,b){let c,f;f=c=0;if(!this.nWi(a))return{ij:c,Cn:f};if(b){c=b.ij;if(!c)return{ij:c,Cn:f};if(!this.Ha.Mac||this.KWi(c)){f=b.Cn;if(!f)return{ij:c,Cn:f};if(b.lVa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Ha.Mac?
0:a[0].ContentMasters[0].Id;return{ij:c,Cn:f}}oUf(a,b,c){if(1===a)return 32;a=this.f4e(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&(b[gm.a.On]=a.layoutId===(c?this.yTg.toString():this.zTg.toString()));return 32}Qjd(a,b,c,f,l){return this.oUf(c,l,!1)}QNe(a,b,c,f,l){return this.oUf(c,l,!0)}f4e(a){let b,c;c=b=null;if(!a)return va.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");
const f=Pd.a(dj.LEf),l=f?1:0,w=f?2:1;if(!a||a.length!==(f?3:2))return va.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};b=a[l];c=a[w];return{returnValue:!0,masterId:b,layoutId:c}}nWi(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}z8g(){this.Gva&&(va.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",this.Gva===L.a.cja?
"ChangeLayout":"NewSlide"),this.ia.processAction(this.Gva,2));this.Gva=0}nmb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}ytf(a,b){Rc.a.Ak("MainMasterId",a.toString());Rc.a.Ak("ContentMasterId",b.toString());const c=this.Tb.HI(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[l].Id,c[l].ContentMasters.length));va.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",
c.length,f,a,b)}}ioe(){return this.Nu.hzf()}KWi(a){if(0===a)return!1;const b=this.Tb.swb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&0<c.layoutCountField)return!0;return!1}ice(a,b,c,f){this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},u.AFrameworkApplication.kIb.handleCommand(ac.ActionManager.W5a(a),b),f||c(),a=2):a=8:a=8;return a}static zNj(a){return a===dj.Xni||a===
dj.Yni||a===dj.Vni||a===dj.Zni||a===dj.Wni}static EYd(){return{"margin-top":"5px","max-width":"100px","font-size":"10px"}}}dj.Xni=1041;dj.Yni=1042;dj.Vni=2052;dj.Zni=1028;dj.Wni=3076;dj.OBj="LayoutIcon";dj.LEf="ReactSlideLayoutButtonIdChange";dj.Doi="SlideLayoutActor";dj.vCf=145;dj.Uni=82;dj.DCf=24;dj.Lni=14;dj.$ni=5;dj.kcd=1;Object(n.a)(dj,"SlideLayoutActor",null,[365,106]);class MN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.aG=this.r$=this.Peb=this.s$=null;this.ia=a;this.$Q=b;this.Fa=c;this.fc=
f;this.hA=l;this.Vb=w;this.ua=H;this.oc=U;this.Ge=ja;this.hse=wa(500,Object(F.a)(this,this.jid,"performKeyboardThumbnailReorder"));this.pa=Sa;this.nn=eb;this.Qea=ub}wb(){this.ia.ra(L.a.Bjc,Cb.a.application,Object(F.a)(this,this.Suj,"handleMoveSlide"),4);this.ia.ra(L.a.E_g,Cb.a.application,Object(F.a)(this,this.Tuj,"handleMoveSlideById"),4);this.ia.ra(L.a.Agb,nc.a.application,Object(F.a)(this,this.cWc,"handleReorderSlide"),4);this.ia.ra(L.a.xgb,nc.a.application,Object(F.a)(this,this.cWc,"handleReorderSlide"),
4);this.ia.ra(L.a.zgb,nc.a.application,Object(F.a)(this,this.cWc,"handleReorderSlide"),4);this.ia.ra(L.a.ygb,nc.a.application,Object(F.a)(this,this.cWc,"handleReorderSlide"),4);this.ia.ra(L.a.Cjc,nc.a.application,Object(F.a)(this,this.Dsj,"handleCommitPendingMoveSlideData"),4);this.ia.ra(L.a.Djc,nc.a.application,Object(F.a)(this,this.bwj,"handleQueryCommitMoveSlideDataEnabled"),100)}Ee(){const a=this.Fa.Fc(Zi.a.PD);a.bindAction(x.KeyInputManager.Oa(A.a.Y1,x.KeyInputManager.Oe),L.a.Agb);a.bindAction(x.KeyInputManager.Oa(A.a.W1,
x.KeyInputManager.Oe),L.a.xgb);a.bindAction(x.KeyInputManager.Oa(A.a.Y1,x.KeyInputManager.Oe|4),L.a.zgb);a.bindAction(x.KeyInputManager.Oa(A.a.W1,x.KeyInputManager.Oe|4),L.a.ygb)}Tuj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.Qea&&(this.nn&&1<this.pa.Qe().length||this.fc.zUa()))return 16;if(1===c)return 32;if(!l)return va.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=l.ofa;c=[];for(var w of b)(b=a.AC(w))?c.push(b):va.a.J(50348435,
822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",w.sid,w.cid);w=l.Ba?a.AC(l.Ba):null;b=a.AC(l.vjc);f=null;0<=l.sectionIndex&&(f=a.V6f(l.sectionIndex));return this.Cag(c,b,w,f,l.Uke)}Suj(a,b,c,f,l){return!this.Qea&&(this.nn&&1<this.pa.Qe().length||this.fc.zUa())?16:1===c?32:l?this.Cag(l.ofa,l.vjc,l.Ba,null,l.Uke):8}Cag(a,b,c,f,l){if(this.Qea)for(var w of a)if(!w||this.fc.$c(this.oc.zl(w.Cb)))return 16;w=[];for(var H of a){if(!H)continue;const U=this.oc.zl(H.Cb);U?w.push(U):
va.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",H.Cb.sid,H.Cb.cid)}if(H=Rc.a.Ib)H.Oj=!0,H.tF||(H.tF=new Date),w&&H.Va("SlideCount",a.length.toString());H=null;l||(this.Qea?c&&(H=c):a&&0<a.length&&(H=a[0]),H&&!this.Vb.Ba.Cb.equals(H.Cb)&&(this.Vb.Ba=this.oc.zl(H.Cb)));a=b?this.oc.zl(b.Cb):null;this.hA.ZUi(w,a,f);return 32}cWc(a,b,c){if(this.$Q.A_||!this.ua.Ba||this.fc.$c(this.Vb.xf)||!this.Qea&&this.nn&&1<this.pa.Qe().length)return 16;if(1===c)return 32;
if(this.Qea){b=this.pa.Qe();if(!b||!b.length)return 16;this.Zwl(b,a)}else this.Uwl(this.ua.Ba,a);return 32}Dsj(a,b,c){if(this.fc.$c(this.Vb.xf)||!this.lFf())return 16;if(1===c)return 32;this.jid();return 32}bwj(){return this.s$?32:16}csb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}Uwl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Ge.bZ;if(!(1>=f)){var l=!1;this.Peb||
(this.Peb=a,this.aG=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.aG[c]&&this.Peb.Cb.equals(this.aG[c].Cb)){a=c;break}if((b!==L.a.Agb&&b!==L.a.zgb||a)&&(b!==L.a.xgb&&b!==L.a.ygb||a!==f-1)){switch(b){case L.a.Agb:b=a-1;break;case L.a.xgb:b=a+1;break;case L.a.zgb:b=0;break;case L.a.ygb:b=f-1;break;default:return}Array.removeAt(this.aG,a);Array.insert(this.aG,b,this.Peb);for(l=0;l<f;l++)this.aG[l]?this.aG[l].me=l:va.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",
l,f);this.Ge.nya(b);f=new Qx(!0,[this.Peb],0<b?this.aG[b-1]:null);this.nzf(f)}else l&&(this.aG=this.Peb=null)}}Zwl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Ge.bZ;if(!(1>=f)&&(a.sort((w,H)=>w.slideIndex-H.slideIndex),this.csb(a))){var l=!1;this.r$||(this.r$=a,this.aG=c.slides||[],l=!0);a=this.NUc(this.r$[0],this.aG);c=this.NUc(this.r$[this.r$.length-1],this.aG);if((b!==L.a.Agb&&b!==L.a.zgb||a)&&(b!==L.a.xgb&&b!==L.a.ygb||c!==f-1)){l=null;switch(b){case L.a.Agb:l=
0<=a-2?this.aG[a-2]:null;b=a-1;break;case L.a.xgb:b=a+this.r$.length<f?a+this.r$.length:f-1;l=this.aG[b];break;case L.a.zgb:l=null;b=0;break;case L.a.ygb:l=this.aG[f-1];b=f-1;break;default:return}for(a=this.r$.length-1;0<=a;a--)this.Cdi(this.r$[a],l);for(a=0;a<f;a++)this.aG[a]?this.aG[a].me=a:va.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.Ge.nya(b);f=new Qx(!0,this.r$,l);this.nzf(f)}else l&&(this.aG=this.r$=null)}}Cdi(a,b){const c=
this.NUc(a,this.aG);Array.removeAt(this.aG,c);b=this.NUc(b,this.aG)+1;Array.insert(this.aG,b,a)}NUc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Cb.equals(b[c].Cb))return c;return-1}Ngi(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Cb.equals(f.Cb)){a=!0;break}if(!a)return!1}return!0}nzf(a){if(!a)throw Error.argumentNull("moveData");this.Qea?this.Ngi(this.r$,a.ofa)||this.jid():this.s$&&this.s$.ofa&&a.ofa&&this.s$.ofa[0]&&a.ofa[0]&&
!this.s$.ofa[0].Cb.equals(a.ofa[0].Cb)&&this.jid();this.s$=a;this.hse.perform()}jid(){if(this.lFf()){var a=this.s$;this.r$=this.Peb=this.s$=null;Array.clear(this.aG);this.ia.La(L.a.Bjc,2,a)}}lFf(){const a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.s$)return!1;let b=!0,c=!this.s$.vjc;for(let f=0;f<this.s$.ofa.length;f++)b=!!a.AC(this.s$.ofa[f].Cb)&&b;c||(c=!!a.AC(this.s$.vjc.Cb));return b&&c}}Object(n.a)(MN,"SlideMoveActor",null,[365]);class dy extends fx.a{constructor(){super();
this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(n.a)(dy,"TableGalleryButtonProps",fx.a,[]);class NN extends dy{constructor(){super()}get Type(){return 8}}Object(n.a)(NN,"ChangeColorsGalleryButtonProps",dy,[]);class ON{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(n.a)(ON,"SmartArtInfo",null,[]);var jt=d(494);class Ti{constructor(a,b,c){this.YF=a;this.dek=b;this.Igk=c}get id(){return this.YF}get parameter(){return this.dek}get mmh(){return this.Igk}}
Object(n.a)(Ti,"SmartArtColorInfo",null,[]);class PN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){this.jq=[];this.ia=a;this.fc=b;this.ob=c;this.Jb=f;this.Fa=l;this.ua=w;this.Ou=H;this.Tb=U;this.Fb=wa;this.Zj=Sa;this.Ea=eb;this.GHk()}wb(){this.ia.ra(L.a.$Ea,Cb.a.view,Object(F.a)(this,this.luj,"handleInsertSmartArt"),4);this.ia.ra(L.a.iyh,Cb.a.application,Object(F.a)(this,this.Kxj,"handleSmartArtToolsTabViewHandler"),4);this.ia.ra(L.a.V_b,Cb.a.application,Object(F.a)(this,this.ssj,"handleChangeSmartArtLayout"),
4);this.ia.ra(L.a.cbh,Cb.a.application,Object(F.a)(this,this.Qvj,"handlePopulateSmartArtColorStyles"),96);this.ia.ra(L.a.U_b,Cb.a.application,Object(F.a)(this,this.qsj,"handleChangeSmartArtColor"),4);this.ia.ra(L.a.PEf,Cb.a.application,Object(F.a)(this,this.rsj,"handleChangeSmartArtColorAnchor"),4);this.ia.ra(L.a.UK,Cb.a.application,Object(F.a)(this,this.tsj,"handleChangeSmartArtStyle"),4);this.ia.ra(L.a.bya,Cb.a.application,Object(F.a)(this,this.Zwj,"handleResetSmartArt"),4);this.ia.ra(L.a.vTe,Cb.a.application,
Object(F.a)(this,this.cxj,"handleReverseSmartArt"),4);this.ia.ra(L.a.akd,Cb.a.application,Object(F.a)(this,this.gwj,"handleQueryReverseSmartArt"),97);this.ia.ra(L.a.sRf,Cb.a.application,Object(F.a)(this,this.ktj,"handleEditSmartArtText"),4);this.ia.ra(L.a.Gjd,Cb.a.application,Object(F.a)(this,this.cwj,"handleQueryEditSmartArtText"),96)}Ee(){}luj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.fc.$c(b))return 16;if(1===c)return 32;this.Mhd(l,a);if(!l)return 8;if((c=b.G3(this.ob.Xd()))&&this.fc.$c(c))return 16;
if(!this.Zj.OF(b,1))return this.Zj.mG(b),16;const w=this.plj(b,c,l);l=this.Jb.Ad(15,void 0,()=>{this.ob.ey();this.ob.Rh();this.Fa.Ed()},()=>{this.ob.selectShape(Object(qa.a)(4,w),!0)});try{l.nc(b),l.jd=a,c&&b.PU([c]),b.gC(Object(qa.a)(4,w))}finally{l&&l.dispose()}this.Ou.SF=Object(qa.a)(4,w);return 32}Kxj(){return Object(qa.a)(749,this.Bza())?32:16}ssj(a,b,c,f,l){b=this.Bza();if(!b||this.fc.$c(b))return 16;if(1===c)return 32;c=this.ob.Xd();for(var w of c){if(w.Qf){b=w;break}if(w.get_smartArtModelId()){b=
this.Ea.yr(w);this.ob.s8(w);this.ob.selectShape(b,!1);break}}this.Mhd(l,a);w=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{w.nc(b),w.jd=a,Object(qa.a)(749,b).ensureModelData().get_elementCollection().documentElement.Yoa=l}finally{w&&w.dispose()}return 32}Qvj(a,b,c,f,l){if(!this.Bza())return 16;a=this.ob.uk();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=this.umi(a):l.MenuItems=this.imi(a);return 32}qsj(a,b,c,f,l){b=this.Bza();if(!b||this.fc.$c(b))return 16;
if(1===c)return 32;this.Mhd(l,a);c=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{c.nc(b),c.jd=a,Object(qa.a)(749,b).ensureModelData().get_elementCollection().documentElement.Rya=l}finally{c&&c.dispose()}return 32}rsj(){return this.Bza()?32:16}tsj(a,b,c,f,l){b=this.Bza();if(!b||this.fc.$c(b))return 16;if(1===c)return 32;this.Mhd(l,a);c=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{c.nc(b),c.jd=a,Object(qa.a)(749,b).ensureModelData().get_elementCollection().documentElement.Sya=
l}finally{c&&c.dispose()}return 32}Zwj(a,b,c){b=Object(qa.a)(749,this.Bza());if(!b||this.fc.$c(Object(qa.a)(4,b)))return 16;if(1===c)return 32;c=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{c.nc(b),c.jd=a,b.bya=!0}finally{c&&c.dispose()}return 32}cxj(a,b,c){b=this.Bza();if(!b||!b.Cme||this.fc.$c(b))return 16;if(1===c)return 32;c=new ON;c.fReverseEnabled=b.Cme;c.fReverseChecked=!b.Bme;const f=this.Jb.Ad(15,void 0,()=>{this.ob.jj();this.Fa.Ed()});try{f.nc(b),f.jd=a,Object(qa.a)(749,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=
c}finally{f&&f.dispose()}return 32}gwj(a,b,c,f,l){a=this.Bza();a=!!a&&a.Bme;if(!Object(Ya.a)(Xh.a,l))return 8;l.Lf(a);return 32}ktj(a,b,c){a=this.Bza();if(!a||this.fc.$c(a))return 16;if(1===c)return 32;this.ia.La(L.a.fQa,2,new uo.a(a,!0,null));return 32}cwj(a,b,c,f,l){a=this.ob.Zz();if(!Object(Ya.a)(Xh.a,l))return 8;l.Lf(a);return 32}plj(a,b,c){if(!a)return null;const f=a.Wt();let l;l=b?b.kxb(Pf.a.hY,Pf.a.y5):this.Tb.Eta(Pf.a.hY,Pf.a.y5);return a.fZd(!0,0,b,c,l.x,l.y,Pf.a.hY,Pf.a.y5,f+1)}Bza(){const a=
this.ob.Xd();for(const b of a){if(b.Qf)return b;if(b.get_smartArtModelId())return this.Ea.yr(b)}return null}GHk(){Array.add(this.jq,new Ti(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.jq,new Ti(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.jq,new Ti(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.jq,new Ti(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.jq,new Ti(4,"colorful2,colorful",
ResourceStrings.L_SmartArtColorful2));Array.add(this.jq,new Ti(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.jq,new Ti(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.jq,new Ti(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.jq,new Ti(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.jq,new Ti(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.jq,new Ti(10,
"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.jq,new Ti(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.jq,new Ti(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.jq,new Ti(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.jq,new Ti(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.jq,new Ti(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));
Array.add(this.jq,new Ti(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.jq,new Ti(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.jq,new Ti(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.jq,new Ti(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.jq,new Ti(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.jq,new Ti(21,"accent3_4,accent3",
ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.jq,new Ti(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.jq,new Ti(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.jq,new Ti(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.jq,new Ti(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.jq,new Ti(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));
Array.add(this.jq,new Ti(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.jq,new Ti(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.jq,new Ti(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.jq,new Ti(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.jq,new Ti(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.jq,new Ti(32,"accent5_5,accent5",
ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.jq,new Ti(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.jq,new Ti(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.jq,new Ti(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.jq,new Ti(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.jq,new Ti(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}imi(a){const b=
Object.assign(new Tl.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new ek.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=kj.Color.Vi(a.Jd.Light1),l=kj.Color.Vi(a.Jd.Dark1),w=kj.Color.Vi(a.Jd.Light2),H=kj.Color.Vi(a.Jd.Dark2),U=Array(6);U[0]=kj.Color.Vi(a.Jd.Accent1);U[1]=kj.Color.Vi(a.Jd.Accent2);U[2]=kj.Color.Vi(a.Jd.Accent3);U[3]=kj.Color.Vi(a.Jd.Accent4);U[4]=kj.Color.Vi(a.Jd.Accent5);U[5]=kj.Color.Vi(a.Jd.Accent6);a=0;
Array.add(c.ControlList,({H8b:a}=this.cmi(a,f,l,w,H)).returnValue);Array.add(c.ControlList,({H8b:a}=this.Wki(a,f,U)).returnValue);Array.addRange(c.ControlList,({H8b:a}=this.Gki(a,f,U)).returnValue);return b}cmi(a,b,c,f,l){const w=Object.assign(new yq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(w.GalleryItems,
this.Vic(b,c,a++));Array.add(w.GalleryItems,this.Vic(b,l,a++));Array.add(w.GalleryItems,this.Vic(l,f,a++));return{returnValue:w,H8b:a}}Wki(a,b,c){const f=Object.assign(new yq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.Tcd(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,
this.hEe(c[l],c[l+1],b,a++));return{returnValue:f,H8b:a}}Gki(a,b,c){const f=[];for(let H=0;6>H;H++){const U=Object.assign(new yq.a,{Id:"ColorfulGallery"+(H+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(H+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,H+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new kj.Color;l.r=l.g=l.b=255;var w=new kj.Color;l=kj.Color.UZ(c[H],l,.5);w=kj.Color.UZ(c[H],w,.25);Array.add(U.GalleryItems,
this.Vic(b,c[H],a++));Array.add(U.GalleryItems,this.Vic(c[H],b,a++));Array.add(U.GalleryItems,this.hEe(c[H],l,b,a++));Array.add(U.GalleryItems,this.Xkk(w,c[H],l,b,a++));Array.add(U.GalleryItems,this.hEe(c[H],l,b,a++));Array.add(f,U)}return{returnValue:f,H8b:a}}Vic(a,b,c){return this.Tcd(a,a,a,a,a,a,b,c)}hEe(a,b,c,f){const l=jt.a.UZ(a,b,2/6),w=jt.a.UZ(a,b,.5),H=jt.a.UZ(a,b,4/6),U=jt.a.UZ(a,b,5/6);return this.Tcd(a,l,w,H,U,b,c,f)}Xkk(a,b,c,f,l){const w=kj.Color.UZ(b,c,.5);return this.Tcd(a,b,w,c,w,
b,f,l)}Tcd(a,b,c,f,l,w,H,U){U=this.H7f(U);const ja="ChangeSmartArtColor__"+U.parameter.replace(",","__");return Object.assign(new NN,{Id:ja,ExternalId:ja,MenuItemId:U.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:U.mmh,TableCellStyles:[this.lGb(a,H),this.lGb(b,H),this.lGb(c,H),this.lGb(f,H),this.lGb(l,H),this.lGb(w,H)]})}lGb(a,b){const c={};c.backgroundColor=this.rHf(a);c.border=String.format("1px solid {0}",this.rHf(b));return c}rHf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",
a.r,a.g,a.b)}umi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new kj.Color;c.r=c.g=c.b=255;const f=new kj.Color,l=kj.Color.Vi(a.Jd.Light1);var w=kj.Color.Vi(a.Jd.Dark1),H=kj.Color.Vi(a.Jd.Light2),U=kj.Color.Vi(a.Jd.Dark2);const ja=Array(6);ja[0]=kj.Color.Vi(a.Jd.Accent1);ja[1]=kj.Color.Vi(a.Jd.Accent2);ja[2]=kj.Color.Vi(a.Jd.Accent3);ja[3]=kj.Color.Vi(a.Jd.Accent4);ja[4]=kj.Color.Vi(a.Jd.Accent5);ja[5]=kj.Color.Vi(a.Jd.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',
ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.Uic(b,l,w,a++);this.Uic(b,l,U,a++);this.Uic(b,U,H,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.Pcd(b,ja[1],ja[2],ja[3],ja[4],ja[5],ja[1],l,a++);for(w=1;5>w;w++)this.dEe(b,
ja[w],ja[w+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(w=0;6>w;w++)H=String.format(ResourceStrings.L_AccentFormat,w+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',w+1,H)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',w+1)),H=kj.Color.UZ(ja[w],c,.5),U=kj.Color.UZ(ja[w],f,.25),this.Uic(b,l,ja[w],a++),this.Uic(b,ja[w],l,a++),this.dEe(b,ja[w],H,l,a++),this.Skk(b,U,ja[w],H,l,a++),this.dEe(b,ja[w],H,l,a++),b.append("</Gallery>"),
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}Uic(a,b,c,f){this.Pcd(a,b,b,b,b,b,b,c,f)}dEe(a,b,c,f,l){const w=jt.a.UZ(b,c,2/6),H=jt.a.UZ(b,c,.5),U=jt.a.UZ(b,c,4/6),ja=jt.a.UZ(b,c,5/6);this.Pcd(a,b,w,H,U,ja,c,f,l)}Skk(a,b,c,f,l,w){const H=kj.Color.UZ(c,f,.5);this.Pcd(a,b,c,H,f,H,c,l,w)}Pcd(a,b,c,f,l,w,H,U,ja){ja=this.H7f(ja);a.append('<GalleryButton Id="');a.append(ja.parameter);a.append('" Command="');a.append(L.a.U_b.toString());a.append('" QueryCommand="');a.append(L.a.wc.toString());
a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.mGb(a,b,U,8,-1);this.mGb(a,c,U,34,-1);this.mGb(a,f,U,8,16);this.mGb(a,l,U,34,16);this.mGb(a,w,U,8,33);this.mGb(a,H,U,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');a.append(ja.mmh);a.append('"/>')}Mhd(a,b){a.Uri=b===L.a.U_b?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===L.a.UK?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+
a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}H7f(a){let b;for(let c=0;c<this.jq.length;c++)if(b=this.jq[c],b.id===a)return b;return new Ti(-1,"","")}mGb(a,b,c,f,l){a.append("&lt;div style=&quot;");b.k3d()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",
b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.k3d()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(n.a)(PN,"SmartArtActor",null,[365]);class ey{constructor(a,b,c,f){this.vCe="BottomOverlaid";this.ia=a;this.Hc=f;this.oc=b;this.Lc=
c;this.wCe="productionSpokenLanguages_"+this.Hc.Zoa;this.xCe="productionSubtitleLanguages_"+this.Hc.xza}wb(){va.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Hc.Lh);this.ia.ra(L.a.YZa,nc.a.application,Object(F.a)(this,this.YZa,"querySubtitleIsEnabled"),96);this.ia.ya(L.a.bMa,nc.a.application,Object(F.a)(this,this.bMa,"toggleUseSubtitles"));this.ia.ra(L.a.xkd,nc.a.application,Object(F.a)(this,this.iOk,"querySubtitleSettingsIsEnabled"),96);this.ia.ra(L.a.Khb,
nc.a.application,Object(F.a)(this,this.Khb,"populateTranscriptionSubtitleLanguage"),96);this.ia.ra(L.a.Jhb,nc.a.application,Object(F.a)(this,this.Jhb,"populateTranscriptionSpokenLanguage"),96);this.ia.ya(L.a.Qxl,nc.a.application,Object(F.a)(this,this.hyj,"handleToggleTranscriptionSpokenLanguage"));this.ia.ya(L.a.Rxl,nc.a.application,Object(F.a)(this,this.iyj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.ra(L.a.qPe,nc.a.application,Object(F.a)(this,this.qPe,"queryToggleTranscriptionSpokenLanguage"),
96);this.ia.ra(L.a.rPe,nc.a.application,Object(F.a)(this,this.rPe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.ra(L.a.uib,nc.a.application,Object(F.a)(this,this.uib,"querySubtitlesBottomOverlay"),96);this.ia.ya(L.a.COb,nc.a.application,Object(F.a)(this,this.COb,"toggleSubtitlesBottomOverlay"));this.ia.ra(L.a.vib,nc.a.application,Object(F.a)(this,this.vib,"querySubtitlesTopOverlay"),96);this.ia.ya(L.a.DOb,nc.a.application,Object(F.a)(this,this.DOb,"toggleSubtitlesTopOverlay"));this.ia.ra(L.a.tib,
nc.a.application,Object(F.a)(this,this.tib,"querySubtitlesBelowSlide"),96);this.ia.ya(L.a.BOb,nc.a.application,Object(F.a)(this,this.BOb,"toggleSubtitlesBelowSlide"));this.ia.ra(L.a.rib,nc.a.application,Object(F.a)(this,this.rib,"querySubtitlesAboveSlide"),96);this.ia.ya(L.a.AOb,nc.a.application,Object(F.a)(this,this.AOb,"toggleSubtitlesAboveSlide"))}Ee(){}YZa(a,b,c,f,l){if(!l||!Object(Ya.a)(Xh.a,l))return 8;l.Lf(this.Hc.Lh);return 32}iOk(a,b,c,f,l){return 1===c?this.oc.qj()?32:8:l&&"object"===typeof l?
this.Hc&&this.Hc.b4b?32:(va.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(va.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}uib(a,b,c,f,l){if(!l||!Object(Ya.a)(Xh.a,l))return va.a.J(512500163,822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.Lf("BottomOverlay"===this.Hc.Vv);va.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.Hc.Vv);return 32}vib(a,
b,c,f,l){if(!l||!Object(Ya.a)(Xh.a,l))return 8;l.Lf("TopOverlay"===this.Hc.Vv);va.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Hc.Vv);return 32}tib(a,b,c,f,l){try{l&&l.Lf("BelowSlide"===this.Hc.Vv)}catch(w){va.a.J(512500131,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",w)}return 32}rib(a,b,c,f,l){try{l&&l.Lf("AboveSlide"===this.Hc.Vv)}catch(w){va.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",w)}return 32}bMa(a,b,c,f,l){if(1===
c)return this.oc.qj()?32:8;if(!l||"object"!==typeof l)return 8;this.Hc.Lh&&(ui.a.aK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",ui.a.FJ)||va.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Hc.Lh=!this.Hc.Lh;va.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Hc.Lh);Pc.App.Kb.rG({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}Khb(a,b,
c,f,l){try{if(1===c)return 32;if(!l)return va.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.abh(l,!1)}catch(w){va.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",w)}return 32}Jhb(a,b,c,f,l){try{if(1===c)return 32;if(!l)return va.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.abh(l,!0)}catch(w){va.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",w)}return 32}iyj(a,
b,c,f,l){try{if(l){this.Hc.xza=l.MenuItemId;this.Hc.Nlb=this.Hc.qVc();const w=l.SourceControlId;this.xCe!==w&&(a={},a[w]="ToggleButtonModel",a[this.xCe]="ToggleButtonModel",Pc.App.Kb.rG(a),this.xCe=w)}}catch(w){va.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",w)}return 32}rPe(a,b,c,f,l){try{l&&(l[Vh.a.On]=l.MenuItemId.toLowerCase()===this.Hc.xza.toLowerCase())}catch(w){va.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",w)}return 32}hyj(a,
b,c,f,l){try{if(l){this.Hc.Zoa=l.MenuItemId;const w=l.SourceControlId;this.wCe!==w&&(a={},a[w]="ToggleButtonModel",a[this.wCe]="ToggleButtonModel",Pc.App.Kb.rG(a),this.wCe=w)}}catch(w){va.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",w)}return 32}qPe(a,b,c,f,l){try{l&&(l[Vh.a.On]=l.MenuItemId.toLowerCase()===this.Hc.Zoa.toLowerCase())}catch(w){va.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",w)}return 32}COb(a,b,c,f,l){if(1===
c)return 32;if(!l||"object"!==typeof l)return va.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[Vh.a.On]&&(this.Hc.Vv="BottomOverlay",va.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.xvd(l.SourceControlId);return 32}DOb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return va.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;l[Vh.a.On]&&(this.Hc.Vv="TopOverlay",
va.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.xvd(l.SourceControlId);return 32}BOb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return va.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[Vh.a.On]&&(this.Hc.Vv="BelowSlide",va.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.xvd(l.SourceControlId);return 32}AOb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==
typeof l)return va.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[Vh.a.On]&&(this.Hc.Vv="AboveSlide",va.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.xvd(l.SourceControlId);return 32}abh(a,b){a.MenuItems=Object.assign(new Tl.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Hc.K0e)&&0<b.count&&(b=ey.WLf(b,"productionSpokenLanguages",""),Array.add(a.MenuItems.MenuSectionList,
b)),(b=this.Hc.J0e)&&0<b.count&&(b=ey.WLf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Hc.ONb)&&0<pa.a.count(b)&&(b=ey.xIi(this.Hc.t_e),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=tj.l(a.MenuItems)}xvd(a){if(this.vCe!==a){const b={};b[a]="ToggleButtonModel";b[this.vCe]="ToggleButtonModel";Pc.App.Kb.rG(b);this.vCe=a;this.Lc.Gy(new Xp.a(1))}}static WLf(a,b,c){c=Object.assign(new ek.a,{DisplayMode:"Menu",
Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let f of a)try{const l=f.toLowerCase(),w=Object.assign(new dz.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:Xa.a.xe(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:Bc.a.esb});Array.add(c.ControlList,w)}catch(l){va.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static xIi(a){const b=Object.assign(new ek.a,{DisplayMode:"Menu",
Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const f=Object.assign(new dz.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:Xa.a.xe(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:Bc.a.esb});Array.add(b.ControlList,f)}catch(f){va.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",
c,f)}return b}}Object(n.a)(ey,"SubtitleActor",null,[365]);var HR=d(407);class bo{constructor(a){this.Ux=this.Xs=this.hv=this.oK=this.mI=null;this.HZ=a}get QZb(){return this.oK||(this.oK=Ab.a.instance.rb("Box4.IAutoCorrectRules"))}get qca(){return this.hv||(this.hv=Ab.a.instance.rb("Box4.IAutoCorrectScheduler"))}get LJ(){return this.mI||(this.mI=Ab.a.instance.rb("Box4.Pages.IPageContentEditor"))}get HB(){return this.Ux||(this.Ux=Ab.a.instance.rb("Box4.IOutlineEditor"))}get Mn(){return this.Xs||(this.Xs=
this.HZ())}bBb(a,b,c){if(this.HB&&bo.mh){var f=vh.ContextSetEditor.t8d(b);a=f.node;nb.SelectionEditor.Xl(f)&&(f=Id.a.Mj(a,zb.ParagraphReader.textLength(a)));var l=Kb.a.language(Kb.a.xs(f));f=ob.GraphIterator.nb(c.xg);bo.Zl.HKa(f);var w=a=null;if(f)for(let H=f.Bb(1);H&&!w;H=f.Fj(1))jj.OutlineReader.gX(H)&&(w=H);if(f&&!w){if(!this.LJ||!this.HB)return;a=new qf.GraphTransaction(7);a.Iy(f);w=this.LJ.F1b(f);this.HB.zpd(w,c.j7b());this.HB.iW(f,!0);l&&(Pa.OutlineElementNavigator.oi(f),f=Id.a.Mj(f.currentNode,
0),bo.mh.h0a(Kb.a.xs(f),l))}l=Od.SelectionFactory.uj(w,!0);c.Mb.setSelection(l);nb.SelectionEditor.Tg(b)&&(c=ob.GraphIterator.nb(b.node),c.fv(),Xg.OutlineNavigator.Zmd(c),this.QZb&&this.qca&&jj.OutlineReader.GC(c,b,!0)&&(b=this.QZb.f4d(b,-1,!1,A.a.Sq))&&this.qca.Ooh(b));this.Mn&&this.Mn.uw();a&&a.dispose()}}s2d(a,b,c){a=ob.GraphIterator.nb(c.xg);a=HR.a(a);a=Od.SelectionFactory.uj(a,!1);c.Mb.setSelection(a)}static get mh(){return bo.Jf||(bo.Jf=Ab.a.instance.rb("Box4.IFormattingEditor"))}static get instance(){return bo.Ka||
(bo.Ka=bo.wC())}static wC(){return new bo(()=>Ab.a.instance.rb("Box4.IUndoManager"))}static get Zl(){return Gy.PageNavigator.instance}}bo.Ka=null;bo.Jf=null;Object(n.a)(bo,"TitleViewEditor",null,[]);class tu{constructor(a,b,c,f=null,l=null,w,H,U=null,ja=null){this.Xs=null;this.mrf=!1;this.HZ=a;this.sMd=b;this.Gm=c;this.oK=f;this.hv=l;this.hd=U;this.Bk=ja}get Mn(){return this.Xs||(this.Xs=this.HZ())}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.mul,"tabView");a.ra(D.a.tab,Cb.a.view,
b,1124);a.ra(D.a.nrc,Cb.a.view,b,1124);a.ya(D.a.Cfg,Cb.a.view,ac.ActionManager.Ng)}mul(a,b,c,f,l){if(1===c)return 32;const w=a===D.a.nrc;if(!b.view.Nh)return 2;const H=b.view,U=H.Mb;var ja=U.Qj;if(!ja||R.a.instance.ga(14)&&tu.ej.C7a(ja))return 2;if(this.Gm&&this.Gm.instance&&this.Gm.instance.bX(ja))return 4;var wa=null,Sa=ac.ActionManager.E5,eb=!1,ub=nb.SelectionEditor.Tg(ja);if(ja.lx){if(U.Na.jH&&(Sa=ja.getContext(0),wa=new ob.GraphIterator,wa.set(Sa.node),wa.fv(),Sa=w?D.a.WUe:D.a.mod),Sa=this.sMd.$Kk(Sa,
w?D.a.Ey:D.a.rC),Sa===ac.ActionManager.E5){var Ub=tu.jm.V2(ja,16);if(Ub)w&&(Sa=D.a.$dd),wa=new ob.GraphIterator,wa.set(Ub.node),wa.Ze();else{if(R.a.instance.ga(77))return 2;if(tu.IMj(ja)){if(w)return 2;Sa=D.a.bBb}else Sa=w?D.a.Ey:D.a.rC}}}else if(ja.al)wa=new ob.GraphIterator,wa.set(ja.node),nb.SelectionEditor.Gt(wa),jj.OutlineReader.gla(ja)?Sa=w?D.a.WUe:D.a.mod:(Sa=w?this.sMd.Zqj(wa,ja,Sa):this.sMd.Yqj(wa,ja,Sa),fe.OutlineElementReader.$g(wa)&&ja.contextId===Cb.a.Of&&(eb=fe.OutlineElementReader.GC(wa,
ja,!1)),(Ub=rb.ListReader.vk(wa)&&eb)&&ka.ULS.sendTraceTag(509659340,383,50,"Tab pressed at starting of list item IsLevelIncreased:{0}",Sa===D.a.rC),Sa!==ac.ActionManager.E5||Ie.isTableCellOrInside(wa)||Ub||(this.mrf||(ka.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.mrf=!0),u.AFrameworkApplication.Ta.processAction(D.a.Cfg,2),u.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this.hd&&this.hd.isFeatureEnabled(84)&&
this.hd.isFeatureEnabled(83)));else return 2;if(!w&&Sa===ac.ActionManager.E5&&Ie.isTableCellOrInside(wa))if(Rd.returnToCell(wa),Ie.isLastCellInTable(wa)||hd.TableReader.Ezb(wa)&&Ie.isLastCellInTableIgnoringGhostCells(wa)){if(Sa=this.AOd(wa,ja),!Sa)return 2}else Sa=D.a.i0g;if(Sa===ac.ActionManager.E5)return 2;switch(Sa){case D.a.bBb:bo.instance.bBb(a,ja,b.view);ja=32;break;case D.a.s2d:bo.instance.s2d(a,ja,b.view);ja=32;break;case D.a.i0g:case D.a.$dd:eb=Sa===D.a.$dd;ub&&this.oK&&this.hv&&(ub=this.oK.f4d(ja,
-1,!0,A.a.Sq))&&this.hv.Ooh(ub);ja=32;Rd.returnToCell(wa);Rd.moveToNextOrPreviousCell(wa,eb)&&(ub=!0,eb=!1,jj.OutlineReader.qWc(wa)||(Xg.OutlineNavigator.CFe(wa,!1),Pa.OutlineElementNavigator.oi(wa),zb.ParagraphReader.ps(wa.currentNode)&&(ub=!1,zb.ParagraphReader.textLength(wa.currentNode)||(eb=!0)),eb||Rd.returnToCell(wa)),eb?wa=Od.SelectionFactory.Sg(wa.currentNode,0):(wa=Od.SelectionFactory.wl(wa.currentNode),!ub&&nb.SelectionEditor.Xl(wa.Ye)&&(ub=wa.toArray(),Array.removeAt(ub,ub.length-1),wa=
new gb.Selection(ub,wa.yf))),U.setSelection(wa));break;case D.a.WUe:case D.a.mod:Sa===D.a.mod?Xg.OutlineNavigator.M_g(wa,!1):Xg.OutlineNavigator.M_g(wa,!0);U.setSelection(Od.SelectionFactory.wl(wa.currentNode));ja=32;break;case D.a.J0a:ja=u.AFrameworkApplication.Ta.pi(b,Sa,c,!0,f,l);1===Pc.App.mode&&Rd.moveToNextOrPreviousCell(wa,!1)&&(Rd.returnToCell(wa),wa=Od.SelectionFactory.uj(wa.currentNode,!0),nb.SelectionEditor.Xl(wa.Ye)&&(ub=wa.toArray(),Array.removeAt(ub,ub.length-1),wa=new gb.Selection(ub,
wa.yf)),U.setSelection(wa));break;default:if(ja=u.AFrameworkApplication.Ta.pi(b,Sa,c,!0,f,l),!eb&&ub&&(Sa===D.a.Ey||Sa===D.a.rC)){const cc=nb.SelectionEditor.Wia(U.Na.mb).y;Pc.App.NUk(()=>{this.sok(U,H,cc)})}}32===ja&&b.view.Nh&&this.Mn.uw();return ja}sok(a,b,c){if(a&&b){var f=a.Na.mb;nb.SelectionEditor.Wia(f).y<c?(b=nb.SelectionEditor.q4b(b,f,!1),b=nb.SelectionEditor.Zsa(b,!1,!1,!1,!0)):b=nb.SelectionEditor.tQc(b,f,!1);a.setSelection(b)}}AOd(){return D.a.eua}B_g(a,b,c){if(a&&b){var f=a.Na.mb;nb.SelectionEditor.Wia(f).y<
c?(b=nb.SelectionEditor.q4b(b,f,!1),b=nb.SelectionEditor.Zsa(b,!1,!1,!1,!0)):b=nb.SelectionEditor.Zsa(f,!1,!1,!1,!0);a.setSelection(b)}}static get ej(){return Kh.a.instance}static get jm(){return vh.ContextSetEditor.instance}static IMj(a){a=tu.jm.V2(a,10);return!!a&&xf.a(a)}}Object(n.a)(tu,"TabActor",null,[]);class QN extends tu{constructor(a,b,c,f){super(a,b,c);this.la=f}AOd(a,b){return this.la.EAb?super.AOd(a,b):0}}Object(n.a)(QN,"Box4TabActor",tu,[]);class RN{constructor(a,b,c,f){this.wik=new QN(a,
b,c,f)}wb(){this.wik.wb()}Ee(){}}Object(n.a)(RN,"TabActor",null,[365]);class SN{constructor(a,b,c){this.tBg=b;this.pa=a;this.yGa=c}$Kk(a,b){const c=this.pa.Qj;return c&&this.yGa.V2(c,16)?a:this.jYe(b)?b:G.a.ve}Zqj(a,b,c){(c=Object(qa.a)(5,b.node))&&c.Cs()?c=D.a.$dd:(Pa.OutlineElementNavigator.Re(a),c=(nb.SelectionEditor.ik(b)||nb.SelectionEditor.Tg(b)&&fe.OutlineElementReader.GC(a,b,!1))&&this.tBg.dtb(a)&&this.jYe(D.a.Ey)?D.a.Ey:G.a.ve,va.a.J(8955994,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",
c===D.a.Ey?"Promote":"DoNothing"));return c}Yqj(a,b,c){const f=Object(qa.a)(5,a.yq);if(f&&f.Cs())return c;Pa.OutlineElementNavigator.Re(a);c=(nb.SelectionEditor.ik(b)||nb.SelectionEditor.Tg(b)&&fe.OutlineElementReader.GC(a,b,!1))&&this.tBg.vJc(a)&&this.jYe(D.a.rC)?D.a.rC:G.a.ve;va.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===D.a.Ey?"Demote":"DoNothing");return c}jYe(a){var b=this.pa.Na.mb;let c=!1;if(b)for(let f of b)if(f&&f.node)if(zb.ParagraphReader.cX(f.node)){if(b=
f.node.sa(Va.a.listLevel,0),a===D.a.rC&&b>=Wo.a.e8-1||a===D.a.Ey&&!b||this.pa.HL()&&Wo.a.wjg(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(n.a)(SN,"TabActorPromoteDemoteStrategy",null,[1235]);var TN=d(399),IR=d(863),UN=d(968);class Rv extends ci.a{constructor(a,b,c,f,l,w,H,U,ja){super(void 0,void 0,!0);this.nva=null;this.L8j=b;this.LHg=f;this.JHg=l;this.EHg=w;this.yHg=H;this.Ivg=U;this.Hvg=ja;this.Hwa=a;this.ucb=c}brd(){this.ig=this.L8j;const a={};a.bodyControls=this.o6d();this.aj(this.Hwa,
Object(F.a)(this,this.f0d,"dialogResultHandler"),a)}f0d(a,b){1===a&&this.ucb(parseInt(this.jTa(b)),parseInt(this.W6i(b)));this.dispose()}o6d(){this.nva=Rv.i7d();const a={};this.uzi(a);this.yyi(a);return a}uzi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.LHg,this.EHg),c=[UN.a("None",0,this.LHg,this.EHg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,
["unitType"]:"None",["value"]:this.Ivg,["validUnits"]:c,["numberFormatInfo"]:this.nva,["validReservedValues"]:[""]}}yyi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.JHg,this.yHg),c=[UN.a("None",0,this.JHg,this.yHg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.Hvg,["validUnits"]:c,["numberFormatInfo"]:this.nva,
["validReservedValues"]:[""]}}jTa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.Ivg.toString()}W6i(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.Hvg.toString()}static i7d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(n.a)(Rv,"AReactTableSizeDialog",ci.a,[]);class VN extends Rv{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,
"InsertTableDialog",a,1,1,35,35,2,5)}}Object(n.a)(VN,"ReactInsertTableDialog",Rv,[]);class WN extends Rv{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(n.a)(WN,"ReactSplitTableCellsDialog",Rv,[]);var Sv=d(623),XN=d(959);class zF{constructor(a){this.gGa=a;if(!a)throw Error.argumentNull("m_actionData");}Bs(){return!1}an(){return this.gGa.TableNode}yv(){var a;return null!==(a=this.gGa.CellNodes)&&void 0!==a?a:this.an().q$a()}SY(a){return a&&
!!a.Ba}}Object(n.a)(zF,"TableActionDataContextHelper",null,[1259]);class AF{constructor(a){this.pa=a;if(!a)throw Error.argumentNull("m_selectionManager");}Bs(){return this.pa.Bs()}an(){return this.pa.an()}yv(){return this.pa.yv()}SY(a){let b=!1;a&&a.Ba&&(a=this.pa.kp(),b=!!a&&a.ud);return b}}Object(n.a)(AF,"TableSelectionManagerContextHelper",null,[1259]);class uu{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug){this.QVa={};this.Jfc=!1;this.h$c=null;this.Tz=[0,
.25,.5,.75,1,1.5,2.25,3,4.5,6];this.LF=new La.ScriptSharpLegacyMap;this.Vb=Ub;this.ua=cc;this.Pb=b;this.ia=a;this.gf=c;this.pa=Fc;this.Fa=f;this.nA=l;this.Ea=w;this.Ks=Sa;this.Sk=wa;this.Ha=eb;this.Jb=ub;this.AJ=ja;this.jYa=U;this.yc=H;this.Zj=Ic;this.LFb=Cc;this.IVg=Ud;this.qea=je;this.Fb=Vd;this.eGa=Ve;this.Ou=af;this.bY=Zf;this.tDg=lg;this.yH=1;this.Ex=ie.Box4ColorHelper.YR({Color:"##T,1,0,0"});this.tB=Tg;this.sA=Ug}wb(){this.QVa["465284484"]=0;this.QVa["212166888"]=1;this.QVa["530759702"]=2;this.QVa["1915511548"]=
0;this.QVa["2003354004"]=1;this.QVa["2257534378"]=2;Ec.n$d=Object(F.a)(this,this.m$d,"getRowOrColumnsForDelete");Ec.b$d=Object(F.a)(this,this.bij,"getRefRowWhenInsertRow");Ec.Z9d=Object(F.a)(this,this.Whj,"getRefCellWhenInsertColumn");Ec.$9d=Object(F.a)(this,this.Yhj,"getRefColumnFromRefCell");Ec.a$d=Object(F.a)(this,this.$hj,"getRefColumnsWhenSelectColumn");Ec.c$d=Object(F.a)(this,this.dij,"getRefRowsWhenSelectRow");Ec.qbe=Object(F.a)(this,this.Qqj,"gotoFocusCellAfterInsertColumn");Ec.jxb=Object(F.a)(this,
this.P4f,"getNewOutlineElementInfoFromCell");Ec.kAb=a=>this.Ha.Ev||!hd.TableReader.Ezb(a);this.ia.ra(L.a.yIb,nc.a.application,Object(F.a)(this,this.Zsj,"handleDeleteTable"),4);this.ia.ra(L.a.wmc,Cb.a.view,Object(F.a)(this,this.atj,"handleDeleteTableRow"),4);this.ia.ra(L.a.Zid,Cb.a.view,Object(F.a)(this,this.$sj,"handleDeleteTableColumn"),4);this.ia.ra(L.a.aMe,nc.a.application,Object(F.a)(this,this.pxj,"handleSelectTable"),4);this.ia.ra(L.a.$id,nc.a.application,Object(F.a)(this,this.muj,"handleInsertTable"),
4);this.ia.ra(L.a.WLe,nc.a.application,Object(F.a)(this,this.nuj,"handleInsertTableDialog"),4);this.ia.ra(L.a.xbh,nc.a.application,Object(F.a)(this,this.ouj,"handleInsertTableFromRibbon"),4);this.ia.ra(L.a.GIk,nc.a.application,Jr.a.dH,4);this.ia.ra(L.a.HIk,nc.a.application,Jr.a.dH,4);this.ia.ra(L.a.MNk,nc.a.application,Jr.a.h1,96);this.ia.ra(L.a.NNk,nc.a.application,Jr.a.h1,96);this.ia.ra(L.a.veh,Cb.a.view,Object(F.a)(this,this.lPe,"queryTableCellAnchoring"),96);this.ia.ra(L.a.ueh,Cb.a.view,Object(F.a)(this,
this.lPe,"queryTableCellAnchoring"),96);this.ia.ra(L.a.teh,Cb.a.view,Object(F.a)(this,this.lPe,"queryTableCellAnchoring"),96);this.ia.ya(L.a.Hmc,Cb.a.view,Ec.aka);this.ia.ya(L.a.Gmc,Cb.a.view,Ec.aka);this.ia.ya(L.a.Fmc,Cb.a.view,Ec.aka);this.ia.ya(L.a.Hmc,Cb.a.tableCell,Object(F.a)(this,this.gce,"handleTableCellAnchoring"));this.ia.ya(L.a.Gmc,Cb.a.tableCell,Object(F.a)(this,this.gce,"handleTableCellAnchoring"));this.ia.ya(L.a.Fmc,Cb.a.tableCell,Object(F.a)(this,this.gce,"handleTableCellAnchoring"));
this.ia.le(L.a.Hmc,4);this.ia.le(L.a.Gmc,4);this.ia.le(L.a.Fmc,4);this.ia.ya(L.a.tbh,Cb.a.view,Object(F.a)(this,this.jsj,"handleCellShadingMenuOpen"));this.ia.ra(L.a.Cbh,Cb.a.view,Object(F.a)(this,this.Gvj,"handlePopulateCellShadingColor"),96);this.ia.ya(L.a.Q5,Cb.a.view,Ec.aka);this.ia.ya(L.a.Q5,Cb.a.tableCell,Object(F.a)(this,this.hsj,"handleCellShadingColor"));this.ia.ya(L.a.zbh,Cb.a.view,Object(F.a)(this,this.Huj,"handleMoreCellShadingColor"));this.ia.ya(L.a.Yid,Cb.a.view,Ec.aka);this.ia.ya(L.a.Yid,
Cb.a.tableCell,Object(F.a)(this,this.isj,"handleCellShadingCustomColor"));this.ia.ya(L.a.TJa,Cb.a.view,Ec.aka);this.ia.ya(L.a.TJa,Cb.a.tableCell,Object(F.a)(this,this.Nwj,"handleRemoveCellShading"));this.ia.le(L.a.Q5,4);this.ia.le(L.a.TJa,4);this.ia.ra(L.a.snc,Cb.a.application,Object(F.a)(this,this.snc,"queryLockAspectRatio"),96);this.ia.ra(L.a.wqc,Cb.a.application,Object(F.a)(this,this.wqc,"setLockAspectRatio"),4);this.ia.ra(L.a.PJb,Cb.a.view,Object(F.a)(this,this.PJb,"queryTableRowHeight"),96);
this.ia.ra(L.a.OJb,Cb.a.view,Object(F.a)(this,this.OJb,"queryTableColumnWidth"),96);this.ia.ra(L.a.q0a,Cb.a.view,Object(F.a)(this,this.q0a,"setTableRowHeight"),4);this.ia.ra(L.a.gLa,Cb.a.view,Object(F.a)(this,this.gLa,"setTableColumnWidth"),4);this.ia.ra(L.a.Lrd,Cb.a.view,Object(F.a)(this,this.q0a,"setTableRowHeight"),4);this.ia.ra(L.a.Krd,Cb.a.view,Object(F.a)(this,this.gLa,"setTableColumnWidth"),4);this.ia.ra(L.a.cmh,nc.a.application,Object(F.a)(this,this.$wj,"handleResizeFallbackTable"),4);this.ia.ra(L.a.Znc,
Cb.a.view,Object(F.a)(this,this.Eeh,"queryTableSize"),96);this.ia.ra(L.a.Ckd,Cb.a.view,Object(F.a)(this,this.Eeh,"queryTableSize"),96);this.ia.ra(L.a.Ooa,Cb.a.view,Object(F.a)(this,this.Osh,"setTableSize"),4);this.ia.ra(L.a.hLa,Cb.a.view,Object(F.a)(this,this.Osh,"setTableSize"),4);this.ia.ra(L.a.mergeTableCells,Cb.a.view,Object(F.a)(this,this.Euj,"handleMergeTableCells"),4);this.ia.ra(L.a.splitTableCells,Cb.a.view,Object(F.a)(this,this.Qxj,"handleSplitTableCells"),4);this.ia.ra(L.a.nQf,Cb.a.view,
Object(F.a)(this,this.Y$f,"handleDistributeRows"),4);this.ia.ra(L.a.mQf,Cb.a.view,Object(F.a)(this,this.ctj,"handleDistributeColumns"),4);this.ia.ra(L.a.zBh,Cb.a.view,Object(F.a)(this,this.Y$f,"handleDistributeRows"),4);this.ia.ra(L.a.Sah,Cb.a.view,Object(F.a)(this,this.Fvj,"handlePopulateCellBorderColorMenu"),96);this.ia.ra(L.a.sbh,Cb.a.view,Object(F.a)(this,this.gsj,"handleCellBorderRecentColor"),96);this.ia.ra(L.a.s_g,Cb.a.view,Object(F.a)(this,this.Guj,"handleMoreCellBorderColors"),96);this.ia.ra(L.a.pBh,
Cb.a.view,Object(F.a)(this,this.ayj,"handleTableBorderWidthAnchor"),4);this.ia.ra(L.a.dza,Cb.a.view,Object(F.a)(this,this.rxj,"handleSelectTableBorderWidth"),4);this.ia.ra(L.a.bBh,Cb.a.view,Object(F.a)(this,this.Zxj,"handleTableBorderColorAnchor"),4);this.ia.ra(L.a.b1a,Cb.a.view,Object(F.a)(this,this.qxj,"handleSelectTableBorderColor"),4);this.ia.ra(L.a.oBh,Cb.a.view,Object(F.a)(this,this.$xj,"handleTableBorderTypeAnchor"),4);this.ia.ra(L.a.fpa,Cb.a.view,Object(F.a)(this,this.fWc,"handleSelectTableBorderType"),
4);this.ia.ra(L.a.dBh,Cb.a.view,Object(F.a)(this,this.mxj,"handleSelectInsideTableBorderType"),4);this.ia.ra(L.a.cBh,Cb.a.view,Object(F.a)(this,this.fbg,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.ra(L.a.eBh,Cb.a.view,Object(F.a)(this,this.gbg,"handleSelectInsideVerticalTableBorderType"),4);this.ia.ra(L.a.cPe,Cb.a.view,Object(F.a)(this,this.xwj,"handleQueryTableBorderWidth_1"),96);this.ia.ra(L.a.dPe,Cb.a.view,Object(F.a)(this,this.ywj,"handleQueryTableBorderWidth_2"),96);this.ia.ra(L.a.ePe,
Cb.a.view,Object(F.a)(this,this.zwj,"handleQueryTableBorderWidth_3"),96);this.ia.ra(L.a.fPe,Cb.a.view,Object(F.a)(this,this.Awj,"handleQueryTableBorderWidth_4"),96);this.ia.ra(L.a.gPe,Cb.a.view,Object(F.a)(this,this.Bwj,"handleQueryTableBorderWidth_5"),96);this.ia.ra(L.a.hPe,Cb.a.view,Object(F.a)(this,this.Cwj,"handleQueryTableBorderWidth_6"),96);this.ia.ra(L.a.iPe,Cb.a.view,Object(F.a)(this,this.Dwj,"handleQueryTableBorderWidth_7"),96);this.ia.ra(L.a.jPe,Cb.a.view,Object(F.a)(this,this.Ewj,"handleQueryTableBorderWidth_8"),
96);this.ia.ra(L.a.kPe,Cb.a.view,Object(F.a)(this,this.Fwj,"handleQueryTableBorderWidth_9"),96);this.ia.ra(L.a.YOe,Cb.a.view,Object(F.a)(this,this.swj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.ra(L.a.aPe,Cb.a.view,Object(F.a)(this,this.vwj,"handleQueryTableBorderType_RightBorder"),96);this.ia.ra(L.a.bPe,Cb.a.view,Object(F.a)(this,this.wwj,"handleQueryTableBorderType_TopBorder"),96);this.ia.ra(L.a.SOe,Cb.a.view,Object(F.a)(this,this.mwj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.ra(L.a.UOe,
Cb.a.view,Object(F.a)(this,this.owj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.ra(L.a.TOe,Cb.a.view,Object(F.a)(this,this.nwj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.ra(L.a.WOe,Cb.a.view,Object(F.a)(this,this.qwj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.ra(L.a.XOe,Cb.a.view,Object(F.a)(this,this.rwj,"handleQueryTableBorderType_InsideVerticalBorder"),96);this.ia.ra(L.a.VOe,Cb.a.view,Object(F.a)(this,this.pwj,"handleQueryTableBorderType_InsideBorder"),
96);this.ia.ra(L.a.$Oe,Cb.a.view,Object(F.a)(this,this.uwj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.ra(L.a.ROe,Cb.a.view,Object(F.a)(this,this.lwj,"handleQueryTableBorderType_AllBorder"),96);this.ia.ra(L.a.ZOe,Cb.a.view,Object(F.a)(this,this.twj,"handleQueryTableBorderType_NoBorder"),96)}Ee(){}Ira(a){return a.Np()?Pd.a("TableBordersComplexTableFixEnabled"):!0}SY(){var a=!1;this.ua.Ba&&(a=this.pa.kp(),a=!!a&&a.ud);return a}jsj(){return this.SY()?32:8}Gvj(a,b,c,f,l){if(!this.SY())return 16;
if(1===c)return 32;if(!l)return 8;a=this.ua.Ba;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Vb.xf.g8;b=Object.assign(new Tl.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});Array.add(b.MenuSectionList,Yk.f(a.Jd,PE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,Yk.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,
Yk.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,Yk.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors","4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",
!0));Pd.a("ColorPickerHighlighterFix")&&(c=this.sA.n0f(this.pa.yv()),Yk.h(b,c,a.Jd));l.MenuItems=b;return 32}Huj(a,b,c,f,l){if(!this.SY())return va.a.J(512500107,822,10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(L.a.renderColorPicker,1,l);a=this.ujj();b={};b.currentColor=a;b.handleCommand=L.a.Yid;return this.ia.La(L.a.renderColorPicker,2,b)}isj(a,b,c,f,l){if(1===c)return this.ia.La(L.a.Q5,c,l);if(!l)return va.a.J(512500106,822,10,"HandleCellShadingCustomColor: actionData is null"),
16;a=this.ia.La(L.a.Q5,c,l);32===a&&this.ia.La(L.a.QBa,c,l);return a}hsj(a,b,c,f,l){if(!this.SY())return 16;if(1===c)return 32;if(!l)return 8;b=b.node;l=ie.Box4ColorHelper.YR(l);if(!l)return 8;c=this.Jb.oe(15);c.nc(b);c.jd=a;a=b.cellShading;bp.b(a);a.solidFillField=l;b.cellShading=a;c.dispose();va.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",TN.a[this.ia.xq]));return 32}Nwj(a,b,c){if(!this.SY())return 16;if(1===c)return 32;b=b.node;c=this.Jb.oe(15);c.nc(b);c.jd=a;a=
ki.a.ki(b,hb.a.cellShading,new IR.a);bp.b(a);a.noFillField=new cy;b.cellShading=a;c.dispose();return 32}ayj(){const a=this.pa.an();return a&&this.SY()&&this.Ha.QIb&&this.Ira(a)?32:8}rxj(a,b,c,f,l){a=this.pa.an();if(!(a&&this.SY()&&this.Ira(a)&&this.Ha.QIb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.yH=this.Tz[1];break;case "TableBorderWidth_2":this.yH=this.Tz[2];break;case "TableBorderWidth_3":this.yH=this.Tz[3];break;case "TableBorderWidth_4":this.yH=
this.Tz[4];break;case "TableBorderWidth_5":this.yH=this.Tz[5];break;case "TableBorderWidth_6":this.yH=this.Tz[6];break;case "TableBorderWidth_7":this.yH=this.Tz[7];break;case "TableBorderWidth_8":this.yH=this.Tz[8];break;case "TableBorderWidth_9":this.yH=this.Tz[9]}this.tB.HH();return 32}ZJa(a,b){return(a=Object(qa.a)(Xh.a,a))?(this.yH===b?a.Lf(!0):a.Lf(!1),32):8}xwj(a,b,c,f,l){return this.ZJa(l,this.Tz[1])}ywj(a,b,c,f,l){return this.ZJa(l,this.Tz[2])}zwj(a,b,c,f,l){return this.ZJa(l,this.Tz[3])}Awj(a,
b,c,f,l){return this.ZJa(l,this.Tz[4])}Bwj(a,b,c,f,l){return this.ZJa(l,this.Tz[5])}Cwj(a,b,c,f,l){return this.ZJa(l,this.Tz[6])}Dwj(a,b,c,f,l){return this.ZJa(l,this.Tz[7])}Ewj(a,b,c,f,l){return this.ZJa(l,this.Tz[8])}Fwj(a,b,c,f,l){return this.ZJa(l,this.Tz[9])}Zxj(){const a=this.pa.an();return a&&this.SY()&&this.Ha.Shb&&this.Ira(a)?32:8}qxj(a,b,c,f,l){a=e(this.pa,l);b=a.an();if(!(b&&a.SY(this.ua)&&this.Ira(b)&&this.Ha.Shb))return 16;if(1===c)return 32;if(!l)return 8;this.Ex=ie.Box4ColorHelper.YR(l);
this.tB.HH();return 32}Fvj(a,b,c,f,l){a=this.pa.an();if(!(a&&this.SY()&&this.Ira(a)))return 16;if(1===c)return 32;if(!l)return 8;c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Vb.xf.g8;b=Object.assign(new Tl.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,Yk.f(c.Jd,"Theme Colors","Color.Menu.Controls","themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,Yk.d("Standard Colors","Color.Menu.Controls",
"standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!1)),Array.add(b.MenuSectionList,Yk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!0));l.MenuItems=b;return 32}gsj(a,b,c,f,l){if(1===c)return this.ia.La(L.a.b1a,c,l);if(!l)return va.a.J(512500100,
822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.La(L.a.b1a,c,l);32===a&&this.ia.La(L.a.QBa,c,l);return a}Guj(a,b,c,f,l){a=this.pa.an();if(!(a&&this.SY()&&this.Ha.Shb&&this.Ira(a)))return va.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(L.a.renderColorPicker,1,l);c=null;b.al&&(b=b.node)&&b.cellShading&&b.cellShading.solidFillField&&(c=ie.Box4ColorHelper.gta(b.cellShading.solidFillField));b={};b.currentColor=
c;b.handleCommand=L.a.b1a;return this.ia.La(L.a.renderColorPicker,2,b)}$xj(){const a=this.pa.an();return a&&this.SY()&&this.Ha.laa&&this.Ira(a)?32:8}mxj(a,b,c,f,l){if(2===c)return this.fWc(a,b,c,f,l);const w=this.fbg(a,b,c,f,l);a=this.gbg(a,b,c,f,l);return 32===w||32===a?32:8}fbg(a,b,c,f,l){if(2===c)return this.fWc(a,b,c,f,l);c=this.pa.an();a=!!c&&this.SY()&&this.Ha.laa&&this.Ira(c);if(!a)return 8;if(this.pa.Bs())return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.yc.HF(c));if(!b||!b.length)return 16;
a=!1;c=b[0].rowIndex;for(const w of b)if(c!==w.rowIndex){a=!0;break}return a?32:8}gbg(a,b,c,f,l){if(2===c)return this.fWc(a,b,c,f,l);c=this.pa.an();a=!!c&&this.SY()&&this.Ha.laa&&this.Ira(c);if(!a)return 8;if(this.pa.Bs())return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.yc.HF(c));if(!b||!b.length)return 16;a=!1;c=b[0].ui;for(const w of b)if(c!==w.ui){a=!0;break}return a?32:8}fWc(a,b,c,f,l){var w;b=e(this.pa,l);if(b.Bs())return 16;const H=b.an();if(!H)return 16;if(1===c)return this.Ira(H)?
32:8;if(!l)return va.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),16;let U=b.yv();if(!U)return 16;U.length||(U=this.IDa(this.yc.HF(H)));if(!U||!U.length)return va.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;c=this.yH;let ja=te.a.GH(c),wa=null!==(w=l.BorderColor)&&void 0!==w?w:this.Ex;const Sa=l.SourceControlId,eb=!!l.DoNotCreateTransaction;if(!Sa||!wa)return va.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),
8;this.LF.Gb(Sa)&&this.LF.ga(Sa)&&(ja=c=0,wa=ru.a.parse("000000").aMa());return uu.XUi(a,Sa,c.toString(),this.RBi(wa),TN.a[this.ia.xq],()=>{let ub;eb||(ub=this.Jb.oe(15),ub.nc(H),ub.jd=a);this.KHl(a,Sa,H,U,ja,wa);ub&&ub.dispose();return 32})}KHl(a,b,c,f,l,w){switch(b){case "TableBordersTopBorder":this.HTa(c,f,l,w,!1,!1);break;case "TableBordersBottomBorder":this.CTa(c,f,l,w,!1,!1);break;case "TableBordersLeftBorder":this.FTa(c,f,l,w,!1,!1);break;case "TableBordersRightBorder":this.GTa(c,f,l,w,!1,
!1);break;case "TableBordersInsideHorizontalBorder":this.DTa(c,f,l,w,!1,!1,!1);break;case "TableBordersInsideVerticalBorder":this.ETa(c,f,l,w,!1,!1,!1);break;case "TableBordersInsideBorders":this.DTa(c,f,l,w,!1,!1,!1);this.ETa(c,f,l,w,!1,!1,!1);break;case "TableBordersOutsideBorders":this.HTa(c,f,l,w,!1,!1);this.CTa(c,f,l,w,!1,!1);this.FTa(c,f,l,w,!1,!1);this.GTa(c,f,l,w,!1,!1);break;case "TableBordersNoBorder":l=0;w=ru.a.parse("000000").aMa();this.HTa(c,f,l,w,!1,!1);this.CTa(c,f,l,w,!1,!1);this.FTa(c,
f,l,w,!1,!1);this.GTa(c,f,l,w,!1,!1);this.DTa(c,f,l,w,!1,!1,!1);this.ETa(c,f,l,w,!1,!1,!1);this.Ha.lMe&&(this.K$f(f,l,w),this.J$f(f,l,w));break;case "TableBordersAllBorders":this.HTa(c,f,l,w,!1,!1);this.CTa(c,f,l,w,!1,!1);this.FTa(c,f,l,w,!1,!1);this.GTa(c,f,l,w,!1,!1);this.DTa(c,f,l,w,!1,!1,!1);this.ETa(c,f,l,w,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.K$f(f,l,w);break;case "TableBordersDiagonalDownBorder":this.J$f(f,l,w);break;default:va.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",
b,a))}}IDa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}swj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.IDa(this.yc.HF(a)));if(!b||!b.length)return va.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.FTa(a,b,c,this.Ex,!0,!1)?(this.LF.$("TableBordersLeftBorder",!0),l.Lf(!0)):(this.LF.$("TableBordersLeftBorder",!1),l.Lf(!1)),32):8}vwj(a,
b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.IDa(this.yc.HF(a)));if(!b||!b.length)return va.a.J(512500065,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.GTa(a,b,c,this.Ex,!0,!1)?(this.LF.$("TableBordersRightBorder",!0),l.Lf(!0)):(this.LF.$("TableBordersRightBorder",!1),l.Lf(!1)),32):8}wwj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||
(b=this.IDa(this.yc.HF(a)));if(!b||!b.length)return va.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.HTa(a,b,c,this.Ex,!0,!1)?(this.LF.$("TableBordersTopBorder",!0),l.Lf(!0)):(this.LF.$("TableBordersTopBorder",!1),l.Lf(!1)),32):8}mwj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.IDa(this.yc.HF(a)));if(!b||!b.length)return va.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),
16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.CTa(a,b,c,this.Ex,!0,!1)?(this.LF.$("TableBordersBottomBorder",!0),l.Lf(!0)):(this.LF.$("TableBordersBottomBorder",!1),l.Lf(!1)),32):8}qwj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.yc.HF(a));if(!b||!b.length)return va.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.DTa(a,b,c,
this.Ex,!0,!1,!1)?(this.LF.$("TableBordersInsideHorizontalBorder",!0),l.Lf(!0)):(this.LF.$("TableBordersInsideHorizontalBorder",!1),l.Lf(!1)),32):8}rwj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.yc.HF(a));if(!b||!b.length)return va.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.ETa(a,b,c,this.Ex,!0,!1,!1)?(this.LF.$("TableBordersInsideVerticalBorder",
!0),l.Lf(!0)):(this.LF.$("TableBordersInsideVerticalBorder",!1),l.Lf(!1)),32):8}owj(a,b,c,f,l){return this.Uag(l,"TableBordersDiagonalUpBorder")}nwj(a,b,c,f,l){return this.Uag(l,"TableBordersDiagonalDownBorder")}Uag(a,b){if(!this.Ha.lMe)return 8;const c=this.pa.an();if(!c||!a)return 16;var f=this.pa.yv();if(!f)return 16;f.length||(f=this.IDa(this.yc.HF(c)));if(!f||!f.length)return va.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",
b)),16;a=Object(qa.a)(Xh.a,a);if(null===a)return 8;f=this.kLj(b,f,te.a.GH(this.yH));this.LF.$(b,f);a.Lf(f);return 32}kLj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.Hig(b,c,this.Ex,!1);case "TableBordersDiagonalDownBorder":return this.Gig(b,c,this.Ex,!1);default:return va.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}pwj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.yc.HF(a));if(!b||!b.length)return va.a.J(512500058,
822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(1<b.length&&this.ETa(a,b,c,this.Ex,!0,!1,!0)&&this.DTa(a,b,c,this.Ex,!0,!1,!0)?(this.LF.$("TableBordersInsideBorders",!0),l.Lf(!0)):(this.LF.$("TableBordersInsideBorders",!1),l.Lf(!1)),32):8}uwj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.IDa(this.yc.HF(a)));if(!b||!b.length)return va.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),
16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.HTa(a,b,c,this.Ex,!0,!1)&&this.GTa(a,b,c,this.Ex,!0,!1)&&this.CTa(a,b,c,this.Ex,!0,!1)&&this.FTa(a,b,c,this.Ex,!0,!1)?(this.LF.$("TableBordersOutsideBorders",!0),l.Lf(!0)):(this.LF.$("TableBordersOutsideBorders",!1),l.Lf(!1)),32):8}lwj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.IDa(this.yc.HF(a)));if(!b||!b.length)return va.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),
16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(this.HTa(a,b,c,this.Ex,!0,!1)&&this.GTa(a,b,c,this.Ex,!0,!1)&&this.CTa(a,b,c,this.Ex,!0,!1)&&this.FTa(a,b,c,this.Ex,!0,!1)&&this.DTa(a,b,c,this.Ex,!0,!1,!0)&&this.ETa(a,b,c,this.Ex,!0,!1,!0)?(this.LF.$("TableBordersAllBorders",!0),l.Lf(!0)):(this.LF.$("TableBordersAllBorders",!1),l.Lf(!1)),32):8}twj(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.yv();if(!b)return 16;b.length||(b=this.IDa(this.yc.HF(a)));if(!b||!b.length)return va.a.J(512500055,
822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Xh.a,l);c=te.a.GH(this.yH);return l?(f=!0,this.Ha.lMe&&(f=this.Hig(b,c,this.Ex,!0)&&this.Gig(b,c,this.Ex,!0)),f&&this.HTa(a,b,c,this.Ex,!0,!0)&&this.GTa(a,b,c,this.Ex,!0,!0)&&this.CTa(a,b,c,this.Ex,!0,!0)&&this.FTa(a,b,c,this.Ex,!0,!0)&&this.DTa(a,b,c,this.Ex,!0,!0,!0)&&this.ETa(a,b,c,this.Ex,!0,!0,!0)?(this.LF.$("TableBordersNoBorder",!0),l.Lf(!0)):(this.LF.$("TableBordersNoBorder",!1),l.Lf(!1)),32):8}IEa(a,
b){if(!a)return!1;const c=ie.Box4ColorHelper.pga(a),f=ie.Box4ColorHelper.pga(b);a=ie.Box4ColorHelper.gta(a);b=ie.Box4ColorHelper.gta(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.sD===b.sD:!1}RBi(a){a=ie.Box4ColorHelper.pga(a);const b=this.ua.Ba;return(a=ie.Box4ColorHelper.KH(a,b?b.Jd:null))&&ie.Box4ColorHelper.Jga(a)?ie.Box4ColorHelper.Jga(a).oV():null}evb(a,b,c,f){if(a=Object(qa.a)(ft,a.sc(this.Fb.Ma))){f=
ie.Box4ColorHelper.pga(f);var l=this.ua.Ba;f=(f=ie.Box4ColorHelper.KH(f,l?l.Jd:null))?ie.Box4ColorHelper.Jga(f):null;a.Aal(b,c,f)}}pv(a,b,c,f){if(a)switch(b){case "Top":a.fza=c;a.GLa=f;this.evb(a,"Top",c,f);break;case "Right":a.Cga=c;a.Aga=f;this.evb(a,"Right",c,f);break;case "Bottom":a.Bga=c;a.zga=f;this.evb(a,"Bottom",c,f);break;case "Left":a.eza=c;a.FLa=f;this.evb(a,"Left",c,f);break;case "DiagonalUp":a.klb=c;a.ilb=f;this.evb(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.jlb=c,a.hlb=f,this.evb(a,
"DiagonalDown",c,f)}}HTa(a,b,c,f,l,w){const H=new La.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const wa of b)b=wa.ui,U=Math.min(U,b),ja=Math.max(ja,b),H.Gb(b)?H.$(b,Math.min(H.ga(b),wa.rowIndex)):H.$(b,wa.rowIndex);if(l)return this.EXj(a,c,f,U,ja,H,w);this.Trj(a,c,f,U,ja,H);return!0}Trj(a,b,c,f,l,w){if(Pd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=a.nf(w.ga(f),f);this.pv(U,"Top",b,c);let ja=f;const wa=f+U.colSpan;for(;ja<wa;){var H=a.nf(w.ga(f)-1,ja);H?H.isGhostCell?(H=
H.az(),H.ui<f?ja+=1:(this.pv(H,"Bottom",b,c),ja+=H.colSpan)):(this.pv(H,"Bottom",b,c),ja+=H.colSpan):ja+=1}f+=U.colSpan}else for(;f<=l;++f)this.pv(a.nf(w.ga(f),f),"Top",b,c),this.pv(a.nf(w.ga(f)-1,f),"Bottom",b,c)}EXj(a,b,c,f,l,w,H){for(;f<=l;){const U=a.nf(w.ga(f),f),ja=U.GLa,wa=te.a.qM(U.fza),Sa=te.a.qM(b);if(H){if(wa!==this.Tz[0])return!1}else if(wa!==Sa||!this.IEa(ja,c))return!1;f+=U.colSpan}return!0}CTa(a,b,c,f,l,w){const H=new La.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const wa of b)b=
wa.ui,U=Math.min(U,b),ja=Math.max(ja,b),H.Gb(b)?H.$(b,Math.max(H.ga(b),wa.rowIndex)):H.$(b,wa.rowIndex);if(l)return this.nLj(a,c,f,U,ja,H,w);this.Crj(a,c,f,U,ja,H);return!0}Crj(a,b,c,f,l,w){if(Pd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=a.nf(w.ga(f),f);this.pv(U,"Bottom",b,c);let ja=f;const wa=f+U.colSpan;for(;ja<wa;){var H=a.nf(w.ga(f)+U.rowSpan,ja);H?H.isGhostCell?(H=H.az(),H.ui<f?ja+=1:(this.pv(H,"Top",b,c),ja+=H.colSpan)):(this.pv(H,"Top",b,c),ja+=H.colSpan):ja+=1}f+=U.colSpan}else for(;f<=
l;++f)this.pv(a.nf(w.ga(f),f),"Bottom",b,c),this.pv(a.nf(w.ga(f)+1,f),"Top",b,c)}nLj(a,b,c,f,l,w,H){for(;f<=l;){const U=a.nf(w.ga(f),f),ja=U.zga,wa=te.a.qM(U.Bga),Sa=te.a.qM(b);if(H){if(wa!==this.Tz[0])return!1}else if(wa!==Sa||!this.IEa(ja,c))return!1;f+=U.colSpan}return!0}FTa(a,b,c,f,l,w){const H=new La.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const wa of b)b=wa.rowIndex,U=Math.min(U,b),ja=Math.max(ja,b),H.Gb(b)?H.$(b,Math.min(H.ga(b),wa.ui)):H.$(b,wa.ui);if(l)return this.OQj(a,c,f,
U,ja,H,w);this.Jrj(a,c,f,U,ja,H);return!0}Jrj(a,b,c,f,l,w){if(Pd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=a.nf(f,w.ga(f));this.pv(U,"Left",b,c);let ja=f;const wa=f+U.rowSpan;for(;ja<wa;){var H=a.nf(ja,w.ga(f)-1);H?H.isGhostCell?(H=H.az(),H.rowIndex<f?ja+=1:(this.pv(H,"Right",b,c),ja+=H.rowSpan)):(this.pv(H,"Right",b,c),ja+=H.rowSpan):ja+=1}f+=U.rowSpan}else for(;f<=l;++f)this.pv(a.nf(f,w.ga(f)),"Left",b,c),this.pv(a.nf(f,w.ga(f)-1),"Right",b,c)}OQj(a,b,c,f,l,w,H){for(;f<=l;){const U=
a.nf(f,w.ga(f)),ja=U.FLa,wa=te.a.qM(U.eza),Sa=te.a.qM(b);if(H){if(wa!==this.Tz[0])return!1}else if(wa!==Sa||!this.IEa(ja,c))return!1;f+=U.rowSpan}return!0}GTa(a,b,c,f,l,w){const H=new La.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const wa of b)b=wa.rowIndex,U=Math.min(U,b),ja=Math.max(ja,b),H.Gb(b)?H.$(b,Math.max(H.ga(b),wa.ui)):H.$(b,wa.ui);if(l)return this.LUj(a,c,f,U,ja,H,w);this.Krj(a,c,f,U,ja,H);return!0}Krj(a,b,c,f,l,w){if(Pd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=
a.nf(f,w.ga(f));this.pv(U,"Right",b,c);let ja=f;const wa=f+U.rowSpan;for(;ja<wa;){var H=a.nf(ja,w.ga(f)+U.colSpan);H?H.isGhostCell?(H=H.az(),H.rowIndex<f?ja+=1:(this.pv(H,"Left",b,c),ja+=H.rowSpan)):(this.pv(H,"Left",b,c),ja+=H.rowSpan):ja+=1}f+=U.rowSpan}else for(;f<=l;++f)this.pv(a.nf(f,w.ga(f)),"Right",b,c),this.pv(a.nf(f,w.ga(f)+1),"Left",b,c)}LUj(a,b,c,f,l,w,H){for(;f<=l;){const U=a.nf(f,w.ga(f)),ja=U.Aga,wa=te.a.qM(U.Cga),Sa=te.a.qM(b);if(H){if(wa!==this.Tz[0])return!1}else if(wa!==Sa||!this.IEa(ja,
c))return!1;f+=U.rowSpan}return!0}ETa(a,b,c,f,l,w,H){b=this.pa.Fxb();if(!b)return!1;b.length||(b=this.yc.HF(a));if(!b||!b.length)return va.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const U=new La.ScriptSharpLegacyMap,ja=new La.ScriptSharpLegacyMap;let wa=Number.MAX_VALUE,Sa=-1;for(const eb of b)b=eb.rowIndex,wa=Math.min(wa,b),Sa=Math.max(Sa,b),U.Gb(b)?U.$(b,Math.min(U.ga(b),eb.ui)):U.$(b,eb.ui),ja.Gb(b)?ja.$(b,Math.max(ja.ga(b),eb.ui)):ja.$(b,eb.ui);
if(l)return this.oQj(a,c,f,wa,Sa,U,ja,w,H);this.Irj(a,c,f,wa,Sa,U,ja);return!0}Irj(a,b,c,f,l,w,H){if(Pd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(w.Gb(f)&&H.Gb(f))for(var U=w.ga(f),ja=H.ga(f);U<ja;){const Sa=a.nf(f,U);if(!Sa.isGhostCell&&Sa.ui+Sa.colSpan<=ja){this.pv(Sa,"Right",b,c);let eb=f;const ub=f+Sa.rowSpan;for(;eb<ub;){var wa=a.nf(eb,U+Sa.colSpan);wa?wa.isGhostCell?(wa=wa.az(),wa.rowIndex<f?eb+=1:(this.pv(wa,"Left",b,c),eb+=wa.rowSpan)):(this.pv(wa,"Left",b,c),eb+=wa.rowSpan):
eb+=1}}U+=Sa.colSpan}}else for(;f<=l;++f)for(U=w.ga(f),ja=H.ga(f);U<ja;++U)this.pv(a.nf(f,U),"Right",b,c),this.pv(a.nf(f,U+1),"Left",b,c)}oQj(a,b,c,f,l,w,H,U,ja){if(Pd.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(w.Gb(f)&&H.Gb(f))for(var Sa=w.ga(f),eb=H.ga(f);Sa<eb;){var ub=a.nf(f,Sa);if(!ub.isGhostCell&&ub.ui+ub.colSpan<=eb){var Ub=ub.Aga;let cc=te.a.qM(ub.Cga),Fc=te.a.qM(b);wa=!0;if(U){if(cc!==this.Tz[0])return!1}else if(cc!==Fc||!this.IEa(Ub,c))return!1}Sa+=ub.colSpan}return wa?
!0:ja}for(wa=f;wa<=l;++wa){eb=w.ga(wa);f=H.ga(wa);if(eb===f)return ja?!0:!1;for(;eb<f;++eb)if(ub=a.nf(wa,eb),Sa=ub.Aga,ub=te.a.qM(ub.Cga),Ub=te.a.qM(b),U){if(ub!==this.Tz[0])return!1}else if(ub!==Ub||!this.IEa(Sa,c))return!1}return!0}DTa(a,b,c,f,l,w,H){b=this.pa.Fxb();if(!b)return!1;b.length||(b=this.yc.HF(a));if(!b||!b.length)return va.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const U=new La.ScriptSharpLegacyMap,ja=new La.ScriptSharpLegacyMap;
let wa=Number.MAX_VALUE,Sa=-1;for(const eb of b)b=eb.ui,wa=Math.min(wa,b),Sa=Math.max(Sa,b),U.Gb(b)?U.$(b,Math.min(U.ga(b),eb.rowIndex)):U.$(b,eb.rowIndex),ja.Gb(b)?ja.$(b,Math.max(ja.ga(b),eb.rowIndex)):ja.$(b,eb.rowIndex);if(l)return this.nQj(a,c,f,wa,Sa,U,ja,w,H);this.Hrj(a,c,f,wa,Sa,U,ja);return!0}Hrj(a,b,c,f,l,w,H){if(Pd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(w.Gb(f)&&H.Gb(f))for(var U=w.ga(f),ja=H.ga(f);U<ja;){const Sa=a.nf(U,f);if(!Sa.isGhostCell&&Sa.rowIndex+Sa.rowSpan<=
ja){this.pv(Sa,"Bottom",b,c);let eb=f;const ub=f+Sa.colSpan;for(;eb<ub;){var wa=a.nf(U+Sa.rowSpan,eb);wa?wa.isGhostCell?(wa=wa.az(),wa.ui<f?eb+=1:(this.pv(wa,"Top",b,c),eb+=wa.colSpan)):(this.pv(wa,"Top",b,c),eb+=wa.colSpan):eb+=1}}U+=Sa.rowSpan}}else for(;f<=l;++f)for(U=w.ga(f),ja=H.ga(f);U<ja;++U)this.pv(a.nf(U,f),"Bottom",b,c),this.pv(a.nf(U+1,f),"Top",b,c)}nQj(a,b,c,f,l,w,H,U,ja){if(Pd.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(w.Gb(f)&&H.Gb(f))for(var Sa=w.ga(f),eb=H.ga(f);Sa<
eb;){var ub=a.nf(Sa,f);if(!ub.isGhostCell&&ub.rowIndex+ub.rowSpan<=eb){var Ub=ub.zga;let cc=te.a.qM(ub.Bga),Fc=te.a.qM(b);wa=!0;if(U){if(cc!==this.Tz[0])return!1}else if(cc!==Fc||!this.IEa(Ub,c))return!1}Sa+=ub.rowSpan}return wa?!0:ja}for(wa=f;wa<=l;++wa){eb=w.ga(wa);f=H.ga(wa);if(eb===f)return ja?!0:!1;for(;eb<f;++eb)if(ub=a.nf(eb,wa),Sa=ub.zga,ub=te.a.qM(ub.Bga),Ub=te.a.qM(b),U){if(ub!==this.Tz[0])return!1}else if(ub!==Ub||!this.IEa(Sa,c))return!1}return!0}K$f(a,b,c){for(const f of a)this.pv(f,
"DiagonalUp",b,c)}Hig(a,b,c,f){for(const l of a)if(!this.Omg(te.a.qM(l.klb),te.a.qM(b),l.ilb,c,f))return!1;return!0}J$f(a,b,c){for(const f of a)this.pv(f,"DiagonalDown",b,c)}Gig(a,b,c,f){for(const l of a)if(!this.Omg(te.a.qM(l.jlb),te.a.qM(b),l.hlb,c,f))return!1;return!0}Omg(a,b,c,f,l){if(l){if(a!==this.Tz[0])return!1}else if(a!==b||!this.IEa(c,f))return!1;return!0}lPe(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[Vh.a.On]=!1;a=this.QVa[a.toString()];if(!this.pa||!this.pa.Na.mb||this.pa.o9())return 16;
b=0;({pxa:b}=this.yc.jud(this.pa.Na)).returnValue&&b===a&&(l[Vh.a.On]=!0);return 32}Bqc(a,b){a=a.queryResult;null!==a&&(a.Kaa=parseFloat(b.toFixed(2)).toString())}snc(a,b,c,f,l){if(!l)return 16;l.Lf(this.Jfc);return 32}wqc(a,b,c){if(1===c)return 32;2===c&&(this.Jfc=!this.Jfc);Pc.App.Kb.rG({SetLockAspectRatio:"CheckboxModel"});return 32}Eeh(a,b,c,f,l){if(!l)return 16;b=this.pa.an();if(!b)return 8;a=a===L.a.Znc?this.yc.tae(b):this.yc.vae(b);this.Bqc(l,te.a.Qv(a));return 32}Osh(a,b,c,f,l){const w=this.pa.an();
return a!==L.a.Ooa&&a!==L.a.hLa||!w?16:1===c?32:Pg.a(String.format("{0}::Entry point:{1}",L.a.mw(a),this.ia.xq),a,()=>{if(!l)return va.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var H=te.a.UW(l.Number);var U=a===L.a.Ooa?this.yc.tae(w):this.yc.vae(w);if(H<Sv.a.ydd||U<Sv.a.ydd)return 16;H/=U;U=this.Jb.oe(15);try{U.nc(w),U.jd=a,a===L.a.Ooa?(this.Ks.Ooa(w,H),this.Jfc&&this.Ks.hLa(w,H)):(this.Ks.hLa(w,H),this.Jfc&&this.Ks.Ooa(w,H)),this.Ks.e_a(w)}finally{U&&U.dispose()}return 32})}PJb(a,
b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.DUc();if(!b)return 16;b.length||(b=this.yc.tka(a));if(!b.length)return 16;a=this.jYa.T0f(b);this.Bqc(l,te.a.Qv(a));return 32}q0a(a,b,c,f,l){const w=this.pa.an();return w?1===c?32:Pg.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.xq),a,()=>{if(null===l)return va.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let H=this.pa.DUc();if(!H)return va.a.J(512500050,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),
16;H.length||(H=this.yc.tka(w));if(!H.length)return 16;let U=Sv.a.b_g;a!==L.a.Lrd&&(U=l.Number);const ja=this.Jb.oe(15);try{ja.nc(w),ja.jd=a,this.Ks.Nsh(H,U)}finally{ja&&ja.dispose()}this.Ks.e_a(w);return 32}):16}OJb(a,b,c,f,l){a=this.pa.an();if(!a)return 16;b=this.pa.Fxb();if(!b)return 16;b.length||(b=this.Mxb(a));if(!b.length)return 16;a=this.AJ.V0f(a,b);this.Bqc(l,te.a.Qv(a));return 32}gLa(a,b,c,f,l){const w=this.pa.an();return w?1===c?32:Pg.a(String.format("SetTableColumnWidth::Entry point:{0}",
this.ia.xq),a,()=>{if(null===l)return va.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var H=this.pa.Fxb();if(!H)return va.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;H.length||(H=this.Mxb(w));if(!H.length)return 16;let U=Sv.a.a_g;a!==L.a.Krd&&(U=l.Number);H=this.AJ.M6d(H);const ja=this.Jb.oe(15);try{ja.nc(w),ja.jd=a,this.Ks.Msh(w,H,U)}finally{ja&&ja.dispose()}this.Ks.e_a(w);return 32}):16}Y$f(a,b,c,f,l){const w=this.pa.an();
return w?1===c?Pd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:w.Np()?8:32:Pg.a("HandleDistributeRows:Entry point:"+this.ia.xq,a,()=>{if(2===c){if(null===l)return 16;let ja=this.pa.DUc();if(!ja)return 16;var H=this.pa.yv();if(!H)return 16;ja.length&&1!==H.length||(ja=this.yc.tka(w));if(!ja)return 16;if(!ja.length)return va.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;H=0;for(var U of ja)U&&(H+=this.jYa.P9a(U));U=this.dej(ja,w);const wa=ja.length;H=H<
wa*U?U:H/wa;U=this.Jb.oe(15);try{U.nc(w),U.jd=a,this.Ks.Nsh(ja,te.a.Qv(H))}finally{U&&U.dispose()}va.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",te.a.Qv(H),this.ia.xq);this.Ks.e_a(w)}return 32}):16}dej(a,b){let c=te.a.UW(Sv.a.b_g);for(const l of a){a=this.yc.p$a(l);for(const w of a)if(w&&(a=w.B4b)&&(a=zb.ParagraphReader.text(a))&&0<a.length){var f=w.rowIndex;const H=w.ui;if(a=Object(qa.a)(ft,w.sc(this.Fb.Ma)))this.bY.mch(b,this.Fb.Ma),
f=this.bY.v5b(b,a.mja,f,H),a=a.Nd.Md.qf(f,1),Pd.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<w.rowSpan&&(a/=w.rowSpan),c=Math.max(c,a)}}return c}ctj(a,b,c,f,l){const w=this.pa.an();return w?1===c?Pd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:w.Np()?8:32:Pg.a("HandleDistributeColumns:Entry point:"+this.ia.xq,a,()=>{if(2===c){if(null===l)return 16;var H=this.pa.Fxb();H.length||(H=this.Mxb(w));if(!H)return 16;var U=this.pa.yv();if(!U)return 16;H.length&&1!==U.length||(H=this.Mxb(w));
if(!H.length)return va.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;U=0;H=this.AJ.M6d(H);if(!H)return va.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var ja=w.H6d;if(!ja)return va.a.J(512500043,822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let wa=0;wa<H.length;wa++)U+=ja[H[wa]];U/=H.length;if(te.a.Qv(U)<Sv.a.a_g)return 16;ja=this.Jb.oe(15);try{ja.nc(w),ja.jd=a,this.Ks.Msh(w,H,te.a.Qv(U))}finally{ja&&
ja.dispose()}va.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",te.a.Qv(U),this.ia.xq);this.Ks.e_a(w)}return 32}):16}gce(a,b,c,f,l){if(!this.Ha.Pme||this.pa.o9())return 16;if(1===c)return 32;if(!l)return 8;c=this.QVa[a.toString()];b=b.node;f=this.Jb.oe(15);f.nc(b);f.jd=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.gpa=c;f.dispose();return 32}muj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.gf.$c(b))return 16;if(!this.Zj.OF(b,1))return this.Zj.mG(b),
16;c=l.Rows;f=l.Columns;l=l.From;var w=b.Cb;w=b.j3(w.sid,w.cid,0,c,f,b.Wt());var H=b.G3(this.pa.Xd());if(H){if(this.gf.$c(H)||this.Ea.VI(H))return 16;this.Sk.xal(w,H.id);this.gf.hw(H,a)}H=this.Jb.Ad(15,void 0,()=>{this.pa.ey();this.pa.Rh();this.Fa.Ed()});try{H.nc(b),H.jd=a,b.gC(w)}finally{H&&H.dispose()}this.pa.selectShape(w,!0);va.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Ou.SF=w;return 32}nuj(){(new VN((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.La(L.a.$id,
2,c)})).brd();return 32}ouj(a,b,c,f,l){l.From="Ribbon";return this.ia.La(L.a.$id,c,l)}Zsj(a,b,c){b=this.ua.Ba;if(!b||this.pa.o9())return 16;const f=this.pa.kp();if(!f||!f.ud||this.gf.$c(f))return 16;if(1===c)return 32;Rc.a.nP(!0,!0);c=this.Jb.Ad(15,void 0,()=>{this.pa.setSelection(null);this.Fa.Ed()});try{c.nc(b),c.jd=a,this.Sk.QNc(f)}finally{c&&c.dispose()}this.gf.hw(b,a);return 32}atj(a,b,c,f,l){if(this.pa.Bs())return 16;a=this.m$d(this.pa.Qj,!0,this.pa);return this.tKj(a)?16:32!==a.response?8:
a.fD&&a.fD.length===hd.TableReader.tk(a.gp)?this.ia.processAction(L.a.yIb,c):this.ia.pi(b,D.a.deleteRow,c,!1,f,l)}$sj(a,b,c,f,l){if(this.pa.Bs())return 16;a=this.m$d(this.pa.Qj,!1,this.pa);return this.sKj(a)?16:32!==a.response?8:a.fD&&a.fD.length===hd.TableReader.Ci(a.gp)?this.ia.processAction(L.a.yIb,c):this.ia.pi(b,D.a.ZCa,c,!1,f,l)}pxj(a,b,c,f,l){return 1===c?32:this.ia.pi(b,L.a.kja,c,!1,f,l)}Euj(a,b,c){if(this.pa.Bs()||this.pa.o9()||!this.Ha.K0c)return 16;b=this.pa.Na;if(!b||!b.Hl||1===b.length&&
1===b.ga(0).length)return 16;b=this.LFb.U6b(b);if(!b)return va.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.uUj)return 16;if(1===c)return 32;Rc.a.Ib&&(Rc.a.Ib.Oj=!0,Rc.a.Ib.tF=new Date);va.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;c=this.Jb.oe(15);c.nc(f);c.jd=a;a=this.IVg.merge(f,b.jtb,b.ZY);a=br.TableNodeContext.create(a);a=Od.SelectionFactory.K1b(Od.SelectionFactory.Fu(a));this.pa.RE(a);c.dispose();va.a.J(36721630,822,50,"Table merge cells succeeded");
return 32}Qxj(a,b,c,f,l){if(this.pa.Bs()||this.pa.o9()||!this.Ha.Ume)return 16;f=null;f=this.pa.Na.Hl?this.LFb.U6b(this.pa.Na):this.LFb.Rkj(b.view.Mb.Qj);if(!f)return 16;const w=f.tableNode.ng(this.Fb.Ma);if(w&&!w.MQj)return va.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),16;const H=Object(qa.a)(158,f.tableNode);if(this.yc.aje(H))return 16;const U=f.jtb;if(!({rows:b,cols:a}=this.QAl(H,U)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const ja=f.ZY,wa=new Date;
({rows:c,cols:f}=this.o6i(H,ja,U,w));const Sa=Rc.a.Ib;Sa&&(Sa.Va("GetClientSplitLimit",(+new Date-+wa).toString()),Sa.Ur=!1);const eb=(ub,Ub)=>{this.IVg.Uql(H,U,ub,Ub,ja,w,this.Fb.Md,Object(F.a)(this,this.P4f,"getNewOutlineElementInfoFromCell"),()=>{})};l&&l.rows&&l.columns&&!Number.isNaN(l.rows)&&!Number.isNaN(l.columns)?(b=Number.parseInt(l.rows),l=Number.parseInt(l.columns),l>f&&(l=f),b>c&&(b=c),eb(b,l)):(new WN((ub,Ub)=>{eb(ub,Ub)},Math.min(b,c),Math.min(a,f))).brd();return 32}$wj(a,b,c,f,l){if(!l||
!Object(Ya.a)(Array,l))return 8;if(1!==l.length)return va.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.gf.$c(l[0].F1))return 16;b=l[0].F1;if(!(b&&b.isConnected&&b.isResizable&&b.ud)||b.VI)return va.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;f=Object(qa.a)(117,b.sc(this.Fb.Ma));if(!f)return va.a.J(512500034,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",
b.get_shapeId()),8;const w=this.yc.NN(b);if(!w)return va.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const H=w.sc(this.Fb.Ma);if(!H)return va.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].$2b)return f&&f.setOffsets(new Xi.a,!0),va.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let U=c=1;try{f.Ok.Koh.Stb.length||
(this.h$c=new Xi.a);f.setOffsets(new Xi.a,!0);var ja=H.T6b();const wa=this.eGa.Sm(ja.$b-ja.hc),Sa=this.eGa.Sm(ja.Yb-ja.kc),eb=new gd.a(f.x+wa,f.y+Sa),ub=new gd.a(f.fga(l[0].w_g.x),f.fga(l[0].w_g.y)),Ub=Vk.oUd(l[0].$2b,ja,ub,!1,!1);c=wa?1+(Ub.right-Ub.left)/wa:1;U=Sa?1+(Ub.bottom-Ub.top)/Sa:1;H.Qsh(c,U);const cc=H.T6b();let Fc=cj.a.e6b(cc,ja);Fc.Kj(1/f.vd);this.h$c&&(Fc=Xi.a.add(Fc,this.h$c));f.setOffsets(Fc,!0);this.h$c=Fc;l[0].p1.Kj(f.vd);this.g1e(l[0].$2b,f,cc,eb,l[0].p1)}catch(wa){return va.a.J(512500002,
822,50,"Fallback table resize fail: ",wa.toString()),8}ja=this.Jb.oe(15);ja.nc(w);ja.jd=a;a=H.Nd.Md;this.Ks.cTe(w,c,U,H,a);if(uu.eFa(l[0].$2b)||uu.eFa(l[0].$2b,!0))l=a.qf(f.x,0),a=a.qf(f.y,1),b.Ay=l,b.By=a;ja.dispose();return 32}QAl(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.yc.tk(a))/b.UO)+1),f=Math.max(1,Math.floor((35-this.yc.Ci(a))/b.AR)+1),{returnValue:!0,rows:c,cols:f}}catch(l){va.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",l.toString())}return{returnValue:!1,
rows:c,cols:f}}o6i(a,b,c,f){a=this.qea.zDa(a,b,c);b=f.L6f();f=f.G0f();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const w=a.fA;l=Math.min(l,b[w.$f]-b[w.re]);c=Math.min(c,f[w.Nf]-f[w.he])}return{rows:Math.max(1,Math.floor(l/XN.a)),cols:Math.max(1,Math.floor(c/XN.a))}}P4f(a){const b=Sh.t5f(a,!1);b.style||(b.style=new sq.a);a=Object(qa.a)(ob.GraphIterator,this.Pb.Mc(a));a.fv();if(a.aB(1)){if(rb.ListReader.vk(a)){const f=this.nA.lw(a),l=cf.a.yN(f.listType,f.listStyle);0===l.listType&&(l.yA=l.lX=f.yA);
f.propertySet.Sa(Za.a.Ui)&&l.propertySet.setValue(Za.a.Ui,f.propertySet.eb(Za.a.Ui));f.propertySet.Sa(Za.a.font)&&l.propertySet.setValue(Za.a.font,f.propertySet.eb(Za.a.font));f.propertySet.Sa(hb.a.autonumberBulletType)&&l.propertySet.setValue(hb.a.autonumberBulletType,f.propertySet.eb(hb.a.autonumberBulletType));b.style.ay(l.propertySet)}var c;(c=b.style).G7a.apply(c,[a.currentNode].concat(Yq.jbe()));if(c=a.aB(2)){let f;(f=b.style).G7a.apply(f,[c].concat(Yq.jbe()));a.zc()}}return b}bij(a,b){const c=
new bu;c.response=8;if(!a)return c;let f=null;var l=null,w=!1;const H=vh.ContextSetEditor.instance.MA(a);a=[];for(var U=0;U<H.length;++U)if(H[U].al){var ja=Object(qa.a)(5,H[U].node);if(!ja||!ja.Cs())return c;ja=ja.lL();f||(f=ja.wSc());l?l!==ja&&(w=!0):l=ja}if(!f)return c;U=f.getContainingTable();if(!U)return c;if(w){b=new Ka.a;if(this.tDg){l=this.LFb.U6b(this.pa.Na).jtb;if(l.cSa())return c;for(w=l.re;w<l.$f;w++)b.add(w);va.a.J(5125E5,822,50,"Insert {0} rows",b.count)}else if(b=this.j7i(H),1!==b.count)return c;
l=U.Gij(b.ga(0));for(w=0;w<b.count;w++)Array.add(a,Id.a.create(Object(qa.a)(yg.a,l))),l=l.aJa}else{if(!b)for(b=l.rowSpan;0<--b;)f=f.aJa;Array.add(a,Id.a.create(Object(qa.a)(yg.a,f)))}c.fD=a;c.kNb=Object(qa.a)(yg.a,f);c.gp=Object(qa.a)(yg.a,U);c.Mgb=a.length;if(this.Ha.Ev||!hd.TableReader.Lu(c.gp))c.response=32;return c}Whj(a,b){const c=new bu;c.response=8;if(!a)return c;var f=null,l=null,w=vh.ContextSetEditor.instance.MA(a);let H=!1;a=[];for(let ja=0;ja<w.length;++ja)if(w[ja].al){var U=Object(qa.a)(5,
w[ja].node);if(!U||!U.Cs())return c;U=U.lL();f||(f=U.a1f());l?l!==U&&(H=!0):l=U}if(!l)return c;f=f.getContainingTable();if(!f)return c;if(H){b=new Ka.a;if(this.tDg){l=this.LFb.U6b(this.pa.Na).jtb;if(l.cSa())return c;for(w=l.he;w<l.Nf;w++)b.add(w);va.a.J(512499998,822,50,"Insert {0} columns",b.count)}else if(b=this.h7i(w),1!==b.count)return c;l=f.nf(0,b.ga(0));for(w=0;w<b.count;w++)Array.add(a,Id.a.create(Object(qa.a)(yg.a,l))),l=l.o_()}else b&&(l=f.nf(0,l.ui+l.colSpan-1)),Array.add(a,Id.a.create(Object(qa.a)(yg.a,
l)));c.fD=a;c.kNb=Object(qa.a)(yg.a,l);c.gp=Object(qa.a)(yg.a,f);c.Mgb=a.length;if(this.Ha.Ev||!f.Np())c.response=32;return c}j7i(a){const b=new Ka.a,c=new La.ScriptSharpLegacyMap;let f=0;for(let H=0;H<a.length;++H)if(a[H].al){var l=Object(qa.a)(5,a[H].node);if(l&&l.Cs()){f++;var w=l.lL();l=w.rowIndex;for(w=l+w.rowSpan;l<w;l++)if(c.Gb(l)){let U;c.$(U=l,c.ga(U)+1)}else c.add(l,1)}}for(let H of c.keys)c.ga(H)===f&&b.add(H);return b}h7i(a){const b=new Ka.a,c=new La.ScriptSharpLegacyMap;let f=0;for(let H=
0;H<a.length;++H)if(a[H].al){var l=Object(qa.a)(5,a[H].node);if(l&&l.Cs()){f++;var w=l.lL();l=w.ui;for(w=l+w.colSpan;l<w;l++)if(c.Gb(l)){let U;c.$(U=l,c.ga(U)+1)}else c.add(l,1)}}for(let H of c.keys)c.ga(H)===f&&b.add(H);return b}Yhj(a){return xn.a(a)}$hj(a){const b=new bu;b.response=8;if(!a)return b;if(a.Hl){var c=a.O0a;a=a.Lja;if(!c||!a)return b;c=Object(qa.a)(125,c.currentNode);a=Object(qa.a)(125,a.currentNode);if(!c||!a)return b;var f=c.ui;a=a.ui;if(f>a){var l=f;f=a;a=l}}else{c=de.a.Isb(a);c=
vh.ContextSetEditor.instance.MA(c);if(!c||1>c.length||!c[0].al)return b;c=Object(qa.a)(5,c[0].node);if(!c||!c.Cs())return b;c=c.lL();a=f=c.ui}l=this.yc.V6b(c);if(!l||14!==l.type||0>f||0>a)return b;const w=[];let H=l.nf(0,f);if(!H)return b;for(;f<=a;)Array.add(w,Id.a.create(Object(qa.a)(yg.a,H))),H=H.o_(),f++;b.fD=w;b.kNb=Object(qa.a)(yg.a,c);b.gp=Object(qa.a)(yg.a,l);b.Mgb=w.length;if(this.Ha.Ev||!l.Np())b.response=32;return b}dij(a){const b=new bu;b.response=8;if(!a)return b;if(a.Hl){var c=a.O0a;
a=a.Lja;if(!c||!a)return b;var f=ok.c(c);a=ok.c(a);c=Object(qa.a)(Zl.TableCellNode,c.currentNode);if(f>a){var l=f;f=a;a=l}}else{a=de.a.Isb(a);a=vh.ContextSetEditor.instance.MA(a);if(!a||1>a.length||!a[0].al)return b;a=Object(qa.a)(5,a[0].node);if(!a||!a.Cs())return b;c=a.lL();a=f=c.rowIndex}if(!c)throw va.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const w=[];
let H=l.nf(f,0).wSc();for(;f<=a;)Array.add(w,Id.a.create(Object(qa.a)(yg.a,H))),H=H.aJa,f++;b.fD=w;b.kNb=Object(qa.a)(yg.a,c);b.gp=Object(qa.a)(yg.a,l);b.Mgb=w.length;if(this.Ha.Ev||!hd.TableReader.Lu(b.gp))b.response=32;return b}Qqj(a,b){if(a=Object(qa.a)(Zl.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.o_();else a=a.z9a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().nf(b.rowIndex,a.ui),a=a.az(),ob.GraphIterator.nb(Object(qa.a)(yg.a,a)))}}m$d(a,b,c){const f=new bu;
f.response=8;if(!a||!c||!c.Na)return f;const l=[],w=[];c=c.Na;if(c.Hl){if(c=this.LFb.U6b(c))if(a=c.jtb,c=c.tableNode.firstRow,b)for(b=0;b<=a.Vne;b++){var H=c.rowIndex;H>=a.vXf&&H<=a.Vne&&l.push(c);c=c.aJa}else for(b=c.nXf,c=0;c<=a.Nne;c++)H=b.ui,H>=a.oXf&&H<=a.Nne&&w.push(b),b=b.o_()}else for(a=vh.ContextSetEditor.instance.MA(a),c=0;c<a.length;++c)if(a[c].al){H=Object(qa.a)(5,a[c].node);if(!H||!H.Cs())return f;var U=H.lL();if(b)for(H=U.rowSpan,U=U.wSc();0<H--;)Array.contains(l,U)||l.push(U),U=U.aJa;
else for(H=U.colSpan,U=U.a1f();0<H--;)Array.contains(w,U)||w.push(U),U=U.o_()}if(!l.length&&!w.length)return f;b=[];for(a=0;a<l.length;a++)Array.add(b,Id.a.create(Object(qa.a)(yg.a,l[a])));for(a=0;a<w.length;a++)Array.add(b,Id.a.create(Object(qa.a)(yg.a,w[a])));f.fD=b;f.kNb=0<l.length?Object(qa.a)(yg.a,l[0]):Object(qa.a)(yg.a,w[0]);f.gp=0<l.length?Object(qa.a)(yg.a,l[0].getContainingTable()):Object(qa.a)(yg.a,w[0].getContainingTable());if(this.Ha.Ev||!Object(qa.a)(158,f.gp).Np())f.response=32;return f}tKj(a){if(!a.fD)return!1;
for(let c=0;c<a.fD.length;c++){var b=Object(qa.a)(Id.a,a.fD[c]);if(b&&(b=Object(qa.a)(155,b.node))){b=this.yc.p$a(b);for(const f of b)if(f&&f.nzb)return!0}}return!1}sKj(a){if(!a.fD)return!1;var b=Object(qa.a)(158,a.gp);if(!b)return!1;var c=Object(qa.a)(Id.a,a.fD[0]);if(!c)return!1;c=Object(qa.a)(125,c.node);if(!c)return!1;c=Object(qa.a)(ob.GraphIterator,this.Pb.Mc(c));c.rc(14);b=this.yc.tk(b);a=a.fD.length;const f=new ob.GraphIterator;f.Rc(c);for(let l=0;l<b;l++){for(let w=0;w<a;w++){const H=Object(qa.a)(125,
c.currentNode);if(H&&H.nzb)return!0;c.Cf(1)}Rd.moveToNextRow(f);c.Rc(f)}return!1}Mxb(a){let b=null;a&&14===a.type&&(b=this.yc.rae(a.firstRow));return b}g1e(a,b,c,f,l){var w=uu.eFa(a);a=uu.eFa(a,!0);if(w||a)w=this.eGa.Sm(c.$b-c.hc),c=this.eGa.Sm(c.Yb-c.kc),f._x+=this.eGa.Sm(l.right),f._y+=this.eGa.Sm(l.bottom),b.setPosition(f.x-w,f.y-c,!0)}ujj(){var a=null;const b=this.ua.Ba;var c=this.pa.yv();if(Pd.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.pa.an())a=c.nf(0,0),a=ie.Box4ColorHelper.WDa(a.cellShading.solidFillField,
b.Jd);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?ie.Box4ColorHelper.WDa(c.cellShading.solidFillField,b.Jd):this.sA.bSc(Object(qa.a)(yg.a,c)))}return a}static XUi(a,b,c,f,l,w){const H=Rc.a.zk("HandleSelectTableBorderType");H.Va("CommandId",a.toString());H.Va("BorderType",b);H.Va("BorderWidth",c);H.Va("BorderColor",f);H.Va("CommandLocation",l);try{return w()}finally{H.finish(!0)}}static eFa(a,b=!1){return a.equals(ne.a.Ru)?!0:b?a.equals(ne.a.north)||a.equals(ne.a.DE):a.equals(ne.a.west)||
a.equals(ne.a.RH)}}Object(n.a)(uu,"TableActor",null,[365]);class Tv{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0}}Object(n.a)(Tv,"TableCellMargin",null,[]);class Uv{constructor(a,b,c,f,l,w,H,U){this.CIa=null;this.g8c=0;this.RMl=te.a.Hid(2);this.zNf=Object.assign(new Tv,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.yNf=Object.assign(new Tv,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.xNf=Object.assign(new Tv,{marginTop:.05,
marginBottom:.05,marginLeft:.05,marginRight:.05});this.JNf=Object.assign(new Tv,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.BGh=Object.assign(new Tv,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(w){if(!H)throw va.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!U)throw va.a.J(512499989,
822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");}else throw va.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw va.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");
else throw va.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw va.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw va.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");else throw va.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ha=b;this.Jb=c;this.ua=f;this.pa=l;this.yc=w;this.r8j=H.tYd(50,Object(F.a)(this,this.t6a,"applyPendingChangesToServerIfRequired"));this.Fb=U}wb(){this.ia.ra(L.a.m1e,Cb.a.view,Object(F.a)(this,
this.M7b,"handleTableCellMargins"),4);this.ia.ra(L.a.Tsc,Cb.a.tableCell,Object(F.a)(this,this.M7b,"handleTableCellMargins"),4);this.ia.ra(L.a.Akd,nc.a.application,Object(F.a)(this,this.bWc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(L.a.Ssc,Cb.a.tableCell,Object(F.a)(this,this.M7b,"handleTableCellMargins"),4);this.ia.ra(L.a.zkd,nc.a.application,Object(F.a)(this,this.bWc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(L.a.Rsc,Cb.a.tableCell,Object(F.a)(this,this.M7b,"handleTableCellMargins"),
4);this.ia.ra(L.a.ykd,nc.a.application,Object(F.a)(this,this.bWc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(L.a.Wsc,Cb.a.tableCell,Object(F.a)(this,this.M7b,"handleTableCellMargins"),4);this.ia.ra(L.a.Bkd,nc.a.application,Object(F.a)(this,this.bWc,"handleQueryTableCellDefaultMargins"),96);this.ia.ya(L.a.Tsc,Cb.a.view,Ec.aka);this.ia.ya(L.a.Ssc,Cb.a.view,Ec.aka);this.ia.ya(L.a.Rsc,Cb.a.view,Ec.aka);this.ia.ya(L.a.Wsc,Cb.a.view,Ec.aka);this.ia.ra(L.a.Qsc,Cb.a.view,Object(F.a)(this,this.iWc,
"handleTableCellCustomMargins"),4);this.ia.ra(L.a.Wnc,Cb.a.view,Object(F.a)(this,this.aWc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(L.a.Usc,Cb.a.view,Object(F.a)(this,this.iWc,"handleTableCellCustomMargins"),4);this.ia.ra(L.a.Xnc,Cb.a.view,Object(F.a)(this,this.aWc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(L.a.Vsc,Cb.a.view,Object(F.a)(this,this.iWc,"handleTableCellCustomMargins"),4);this.ia.ra(L.a.Ync,Cb.a.view,Object(F.a)(this,this.aWc,"handleQueryTableCellCustomMargins"),96);
this.ia.ra(L.a.Psc,Cb.a.view,Object(F.a)(this,this.iWc,"handleTableCellCustomMargins"),4);this.ia.ra(L.a.Vnc,Cb.a.view,Object(F.a)(this,this.aWc,"handleQueryTableCellCustomMargins"),96)}Ee(){}M7b(a,b,c,f,l){return this.Huh(a)?1===c?32:Pg.a("HandleTableCellMargins:Entry point:"+this.ia.xq,a,()=>{if(!l)return va.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return va.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),
16;const w=b.node,H=this.QVi(a);if(!H)return va.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),16;const U=this.Jb.oe(15);U.nc(w);U.jd=a;this.dyf(w,H);U.dispose();va.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.xq,a);return 32}):(va.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}bWc(a,b,c,f,l){if(!this.Ha.dOb)return 8;b=Object(qa.a)(Xh.a,l);if(!b)return 16;f=this.pa.an();if(!f)return va.a.J(512499983,
822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.pa.yv();if(!c)return 16;c.length||(c=this.yc.HF(f));if(!c||!c.length)return va.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case L.a.Akd:f=this.sSc(c,this.zNf);break;case L.a.zkd:f=this.sSc(c,this.yNf);break;case L.a.ykd:f=this.sSc(c,this.xNf);break;case L.a.Bkd:f=this.sSc(c,this.JNf)}b.Lf(f);return 32}sSc(a,b){for(const c of a)if(c&&!c.isGhostCell&&
(te.a.Qv(c.marginTop)!==b.marginTop||te.a.Qv(c.marginBottom)!==b.marginBottom||te.a.Qv(c.marginLeft)!==b.marginLeft||te.a.Qv(c.marginRight)!==b.marginRight))return!1;return!0}QVi(a){let b=Dl.b(this.BGh);switch(a){case L.a.Tsc:b=this.zNf;break;case L.a.Ssc:b=this.yNf;break;case L.a.Rsc:b=this.xNf;break;case L.a.Wsc:b=this.JNf}return b}dyf(a,b){0<=b.marginLeft&&(a.marginLeft=te.a.UW(b.marginLeft));0<=b.marginRight&&(a.marginRight=te.a.UW(b.marginRight));0<=b.marginTop&&(a.marginTop=te.a.UW(b.marginTop));
0<=b.marginBottom&&(a.marginBottom=te.a.UW(b.marginBottom))}Bdi(a,b){b=Math.max(te.a.UW(this.RMl+b.marginLeft+b.marginRight),a);Cf.a.fz(b,a)||(a={},a.Number=te.a.Qv(b),this.ia.La(L.a.gLa,2,a))}Huh(a){if(!this.ua.Ba)return!1;const b=this.pa.kp();return!!b&&b.ud&&(this.Ha.dOb&&Array.contains(Uv.Y5k,a)||this.Ha.olb&&Array.contains(Uv.i6k,a))}aWc(a,b,c,f,l){if(!this.Ha.olb)return 8;b=this.pa.an();if(!b)return va.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),
16;c=this.pa.yv();if(!c)return va.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),16;c.length||(c=this.yc.HF(b));if(!c||!c.length)return va.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.Gjj(c,a);this.Bqc(l,te.a.Qv(b));va.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.xq,a);return 32}Gjj(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case L.a.Wnc:c=
l.marginLeft;break;case L.a.Xnc:c=l.marginRight;break;case L.a.Ync:c=l.marginTop;break;case L.a.Vnc:c=l.marginBottom}if(0<=f&&f!==c)return-1;f=c}return c}Bqc(a,b){a=a.queryResult;null!==a&&(a.Kaa=parseFloat(b.toFixed(2)).toString())}iWc(a,b,c,f,l){return this.Huh(a)?1===c?32:Pg.a("HandleTableCellCustomMargins:Entry point:"+this.ia.xq,a,()=>{if(!l)return va.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const w=this.pa.an();if(!w)return va.a.J(512499975,822,50,"HandleTableCellCustomMargins: unable to get valid tableNode"),
16;let H=this.pa.yv();if(!H)return va.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),16;H.length||(H=this.yc.HF(w));this.Itk(a,H,l);va.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.xq,a);return 32}):(va.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}Itk(a,b,c){this.g8c!==a&&(this.t6a(),this.g8c=a);this.CIa||(this.CIa=[]);Pg.a("OnCustomMarginChange:Entry point:"+
this.ia.xq,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const w=Object(qa.a)(ft,f.sc(this.Fb.Ma));if(w){this.CIa[l]||(this.CIa[l]=new bx.a(f,this.Nmj(f)));f=this.CIa[l];switch(a){case L.a.Qsc:f.second.marginLeft=c.Number;break;case L.a.Usc:f.second.marginRight=c.Number;break;case L.a.Vsc:f.second.marginTop=c.Number;break;case L.a.Psc:f.second.marginBottom=c.Number}w.Eal(f.second,a)}}return 32});this.r8j.perform()}t6a(){this.Ha.olb&&this.CIa&&this.CIa.length&&(Pg.a("ApplyPendingChangesToServerIfRequired:Entry point:"+
this.ia.xq,this.g8c,()=>{const a=this.Jb.oe(15);try{a.jd=this.g8c;let b=null;for(const c of this.CIa)b||(b=c.first.getContainingTable(),a.nc(b)),this.dyf(c.first,c.second),this.Bdi(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.CIa=null)}Nmj(a){const b=Dl.b(this.BGh);b.marginLeft=te.a.Qv(a.marginLeft);b.marginRight=te.a.Qv(a.marginRight);b.marginTop=te.a.Qv(a.marginTop);b.marginBottom=te.a.Qv(a.marginBottom);return b}}Uv.Y5k=[L.a.m1e,L.a.Tsc,L.a.Ssc,L.a.Rsc,L.a.Wsc];Uv.i6k=
[L.a.Qsc,L.a.Usc,L.a.Vsc,L.a.Psc];Object(n.a)(Uv,"TableCellMarginActor",null,[365]);class Jq{constructor(a,b,c,f,l,w,H,U){this.Am=this.cic=null;this.GVg=0;this.l6c=!1;this.Sye=this.KCe=this.fWg=this.Mtg=this.eWg=this.Ltg=null;this.sA=a;this.Tk=b;this.fwe=c;this.M0=f;this.SCe=l;this.Lik=w;this.Gik=H;this.gXa=U}jvl(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');this.Vee(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',
this.Tk.psb(this.Tk.H7d(this.cic),this.Am)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.KCe.v6d(a,b,1,1),l=this.K2f(this.Sye,this.Am,a,b),w=this.Tk.psb(f.Sa(hb.a.cellShading)?f.Mh(hb.a.cellShading):wl.a.Fub,this.Am),H=new Sys.StringBuilder;for(let U=0;U<Jq.mcc.length;U++){const ja=Wp.fTa(Jq.D3c[U]),wa=f.sa(ja.M6a,wl.a.YMc),Sa=f.sa(ja.ysb,wl.a.Dub);H.append(Jq.mcc[U]);if(wa.sD===tc.a.auto){const eb=this.Tk.q6d(.0277777777777778);H.append(String.format("inset {0}px transparent",
eb))}else H.append(this.Tk.C5d(Sa,.0277777777777778,wa));H.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,w,H));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.l6c&&this.smh()}return c.toString()}S5i(a,b){const c=[];this.Vee(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.KCe.v6d(a,b,1,1),w=this.K2f(this.Sye,this.Am,a,b);f.color=w;const H=this.Tk.psb(l.Sa(hb.a.cellShading)?l.Mh(hb.a.cellShading):
wl.a.Fub,this.Am);f["background-color"]=H;f.overflow="visible";for(let U=0;U<Jq.mcc.length;U++){let ja=null,wa=null,Sa=null;({iQa:ja,M6a:wa,ysb:Sa}=Wp.fTa(Jq.D3c[U]));let eb;if(this.gXa){const Ic=ie.Box4ColorHelper.YR({Color:"##T,0,0,0"}),Cc=ki.a.ki(l,wa,Ic),Ud=ie.Box4ColorHelper.pga(Cc),je=ie.Box4ColorHelper.KH(Ud,this.Am);eb=je?ie.Box4ColorHelper.Jga(je):null}else eb=l.sa(wa,wl.a.YMc);const ub=l.sa(Sa,wl.a.Dub),Ub=Jq.mcc[U].substring(0,Jq.mcc[U].length-1),cc=l.sa(ja,wl.a.Eub),Fc=this.gXa&&Pd.a("TableBordersLocalRenderingFix");
if(Fc&&!cc||!Fc&&eb.sD===tc.a.auto){const Ic=this.Tk.q6d(.0277777777777778);f[Ub]=String.format("inset {0}px transparent",Ic)}else f[Ub]=this.Tk.C5d(ub,.0277777777777778,eb)}c.push(f)}}finally{this.l6c&&this.smh()}return c}aVc(a,b){this.Vee(a,b);a={};a.background=this.Tk.psb(this.Tk.H7d(this.cic),this.Am);return a}Vee(a,b){this.cic=this.M0.P6b(a).dY;this.GVg=this.sA.V8d(b);this.Am=this.fwe.B7f(b).Jd;this.l6c=this.Vzj(this.cic);this.Ltg=this.Am.PresetSchemeColorMapping.Background1;this.eWg=this.Am.PresetSchemeColorMapping.Text1;
this.Mtg=this.Am.PresetSchemeColorMapping.Background2;this.fWg=this.Am.PresetSchemeColorMapping.Text2;this.l6c&&(this.Am.PresetSchemeColorMapping.Background1=this.Am.PresetSchemeColorMapping.Light1,this.Am.PresetSchemeColorMapping.Text1=this.Am.PresetSchemeColorMapping.Dark1,this.Am.PresetSchemeColorMapping.Background2=this.Am.PresetSchemeColorMapping.Light2,this.Am.PresetSchemeColorMapping.Text2=this.Am.PresetSchemeColorMapping.Dark2);a=this.SCe(()=>5,()=>5,()=>this.GVg,()=>null,()=>this.Am,()=>
this.cic);this.KCe=this.Lik(a);this.Sye=this.Gik(a)}smh(){this.Am.PresetSchemeColorMapping.Background1=this.Ltg;this.Am.PresetSchemeColorMapping.Text1=this.eWg;this.Am.PresetSchemeColorMapping.Background2=this.Mtg;this.Am.PresetSchemeColorMapping.Text2=this.fWg}Vzj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}K2f(a,b,c,f){let l="black";a&&(l=a.B1f(b,c,f,1,1).oV());
return l}}Jq.mcc=["border-top:","border-left:","border-bottom:","border-right:"];Jq.D3c=[7,5,0,6];Object(n.a)(Jq,"TableStylePreviewGenerator",null,[1160]);class SE extends dy{constructor(){super()}get Type(){return 6}}Object(n.a)(SE,"TableStyleGalleryButtonProps",dy,[]);class TE{}TE.Zpk=2147483647;Object(n.a)(TE,"TableStyleUtil",null,[]);class cp{constructor(a,b,c,f,l){this.SVd="Clear";this.J8a=null;this.Jqb=a;this.jdf=c;this.kdf=f;this.jTh=l;this.yMd=b;this.UN=u.AFrameworkApplication.UN;this.qm=
u.AFrameworkApplication.qm}I3b(){}R6h(a,b){this.I3b();const c=this.IRc(),f=c.length;if(!(0>=f)){var l=TE.Zpk,w=null;for(let wa=0;wa<f;wa++){var H=c[wa],U=this.jTh(H);l!==U&&(l=Object.assign(new ek.a,{Id:"msMoreTableStyles"+U,Title:this.Zmj(U),ControlList:[]}),w=Object.assign(new yq.a,{Type:6,Id:"galleryMoreTableStyles"+U,ExternalGalleryId:"TableStylesGallery",Width:cp.fAh,ElementDimensions:"Size64by48",GalleryItems:[]}),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp&&this.J8a&&(w.ExternalId=
this.J8a[U.toString()]),Array.add(l.ControlList,w),Array.add(b.MenuSectionList,l),l=U);var ja=this.kdf(H);H=cp.s1e+wa;U=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp;ja=Object.assign(new SE,{Id:H,ExternalId:H,Command:"4171428777",QueryCommand:"2135594455",LabelText:ja?ha.a.ue(ja):"",Alt:U?ja:null,VerticalCenterAlign:"true"});U&&(ja.TableCellStyles=this.s8f(H,a),ja.TableStyles=this.aVc(H,a));w&&w.GalleryItems.push(ja)}}}P6h(a){const b=Object.assign(new ek.a,{Id:"msMoreTableStyleCommands",
DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),c=Object.assign(new kg.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:ha.a.ue(this.SVd),Alt:ha.a.ue(this.SVd),Image16by16:this.qm,Image16by16Class:wp.getImageClassWithCluster(this.UN,cp.Pui),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}OEi(a,b){this.I3b();const c=a[Vh.a.SourceControlId],f=this.Psd(c,b);if(f){var l=this.Jqb.bae(b);l=l?this.jdf(l):
null;var w=this.kdf(f),H=this.jdf(f);a[gm.a.Alt]=w;a[gm.a.On]=H===l;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp?(b=Object.assign(new SE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.s8f(c,b),TableStyles:this.aVc(c,b),Alt:w}),a[gm.a.GalleryButtonProps]=b):(b=this.yMd.jvl(f,b),a[gm.a.InnerHTML]=b)}else a[gm.a.InnerHTML]=null,a[gm.a.Alt]=null,a[gm.a.On]=!1,a[gm.a.GalleryButtonProps]=null}s8f(a,b){this.I3b();return(a=this.Psd(a,b))?this.yMd.S5i(a,
b):null}aVc(a,b){this.I3b();return(a=this.Psd(a,b))?this.yMd.aVc(a,b):null}TFi(a,b){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Pp?a.MenuItems=this.K4f(b):a.PopulationXML=tj.l(this.K4f(b))}K4f(a){const b=Object.assign(new Tl.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.R6h(a,b);this.P6h(b);return b}Psd(a,b){return a?a.startsWith(cp.s1e)?this.kmj(parseInt(a.substr(cp.s1e.length))):this.Q3k(parseInt(a.substr(cp.hvl.length)),b):null}}cp.s1e="buttonTableStyleMenu";cp.hvl="buttonTableStyleRibbon";
cp.fAh=7;cp.Pui="ClearTableStyle_16x16x32";Object(n.a)(cp,"ATableStyleRibbonControl",null,[1161]);class YN extends cp{constructor(a,b,c,f,l){super(a,l,Object(F.a)(f,f.imj,"getStyleIdFromStyleContainer"),Object(F.a)(f,f.jmj,"getStyleNameFromStyleContainer"),Object(F.a)(f,f.bmj,"getStyleCatogeryFromStyleContainer"));this.sA=a;this.M0=f;this.SVd=ResourceStrings.L_ClearTableStyle;this.UN=Pf.a.Ulc;this.qm=c.rk(Pf.a.fid);this.eHk()}Zmj(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;
case 3:return ResourceStrings.L_Medium;case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}Q3k(a,b){let c=null;(b=this.sA.W6b(b))&&(c=this.M0.v8f(b.styleIdField));return c?this.M0.Zlj(c.Aug,c.uBg-c.uBg%cp.fAh+a):this.M0.Kxb(a)}IRc(){return this.M0.IRc()}kmj(a){return this.M0.Kxb(a)}I3b(){this.M0.Z1d()}eHk(){this.J8a={};this.J8a["1"]="TableStylesBestMatch";this.J8a["2"]="TableStylesLight";this.J8a["3"]="TableStylesMedium";this.J8a["4"]=
"TableStylesDark"}}Object(n.a)(YN,"TableStyleRibbonControls",cp,[]);class ZN{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc){this.kE=this.lYa=null;this.ia=a;this.gf=b;this.Ha=c;this.Fa=f;this.pa=l;this.xt=w;this.Yc=H;this.dcc=U;this.Fb=ja;this.Ea=wa;this.je=Sa;this.Zea=ub;this.yc=Ub;this.ifa=cc;this.vYa=Ic;this.mA=eb;Fc.execute(Ud=>{this.lYa=Ud});this.Ha.YP&&Cc.execute(Ud=>{this.kE=Ud})}get Kd(){return this.Yc.instance}get xF(){return this.dcc.value}wb(){this.ia.ra(L.a.cAf,nc.a.application,
Object(F.a)(this,this.Yrj,"handleBeginEditShapeTextByF2"),4);this.ia.ra(L.a.H6a,nc.a.application,Object(F.a)(this,this.Xrj,"handleBeginEditShapeText"),4);this.ia.ra(L.a.fQa,Cb.a.view,Object(F.a)(this,this.Zrj,"handleBeginEditShapeTextForShapeMoniker"),5)}Ee(){const a=this.Fa.Fc(Lb.a.sg),b=this.Fa.Fc(Zi.a.Y2);a.bindAction(x.KeyInputManager.Oa(A.a.Mvc,0),L.a.cAf);a.bindAction(x.KeyInputManager.Oa(A.a.tq,0),L.a.H6a);b.bindAction(x.KeyInputManager.Oa(A.a.Mvc,0),L.a.Oii)}Xrj(a,b,c){if(this.ifa&&this.ifa.isVisible())return va.a.J(40735957,
820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),this.ifa.hide(2,!0),32;if(1===c&&this.pa.uUa())return 2;a=this.pa.kp();if(!a)return 16;b=Object(qa.a)(4,a.jaj(Pd.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Ea.yr(a);else{if(a.Qf&&b)return this.ia.La(L.a.G0a,c,b);if(a.If){var f=this.Ea.ix(a);if(0<f.length)return this.ia.La(L.a.G0a,c,f[0])}else if(this.Ha.YP&&1===a.mediaType&&!a.Og&&this.kE)return(f=this.kE.jL(a))&&f.setFocusOnPlayer(),
32}return this.ia.La(L.a.fQa,c,new uo.a(a,!1))}Yrj(a,b,c){a=this.pa.kp();if(!a)return 16;a.get_smartArtModelId()&&(a=this.Ea.yr(a));return this.ia.La(L.a.fQa,c,new uo.a(a,!1))}Zrj(a,b,c,f,l){if(!l||!Object(Ya.a)(uo.a,l))return va.a.J(8956046,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.tfa||a.Dq)||this.gf.$c(a))return 16;if(1===c)return 32;a.ud&&(c=this.yc.NN(a),c=!!c&&c.Np(),va.a.J(41007122,820,50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(L.a.v7a,
2));if(a.Dq){if(this.xF&&this.Kd)return l=this.xF.g3(a),this.Kd.notifyAgave(l.id,11),32;va.a.J(18989144,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.ng(this.Fb.Ma);if(!c)return 16;this.lYa&&this.lYa.B3d(a,!0);this.vYa&&this.Ha.d$k&&this.vYa.ping();Rc.a.Ib&&(Rc.a.Ib.actionName="BeginEditShapeText",(a.If||a.Og)&&on(a));if(this.mA&&a.Qf&&c.uL())Rc.a.Ak(Bh.a.fGc,"false"),this.je.Efh(new Kx.a(a));else{this.Fa.rf(Lb.a.sg,l.ajl);this.xt.uw();c.NZe();if(a.ud&&l.pKc&&(c=this.yc.NN(a))&&
c.Np())return(a=this.Zea.g4d(l.pKc.clientPoint,c,null,null))?(c=a.sc(this.Fb.Ma),this.Fb.H6(l.pKc.clientPoint,c,a,this.Fb,!1,!1,0),32):8;a.Og&&(c=this.Ea.ys(a))&&(c=c.ng(this.Fb.Ma))&&c.Qd&&c.Qd.XLb(!0);this.Fb.J8k(a,l.pKc)}return 32}}Object(n.a)(ZN,"TextEditorLaunchingActor",null,[365]);class UE{constructor(a,b,c,f,l,w,H,U){this.ia=a;this.Fa=b;this.Ea=c;this.Ms=f;this.gf=l;this.pa=w;this.PWa=H;this.Ih=U}wb(){this.ia.ya(L.a.KEf,nc.a.application,Object(F.a)(this,this.lsj,"handleChangeCaseMenu"));this.ia.ya(L.a.VLe,
nc.a.application,Object(F.a)(this,this.Rvj,"handlePowerPointInsertHyperlink"));this.ia.ra(L.a.clearFormatting,nc.a.application,Object(F.a)(this,this.wsj,"handleClearFormatting"),4)}Ee(){this.Fa.Fc(Lb.a.kQ).bindAction(x.KeyInputManager.Oa(A.a.pP,2),L.a.clearFormatting)}lsj(){var a=this.pa.Na.mb;return a&&(a=a.Ua)&&(a.contextId===Cb.a.Of||a.contextId===Cb.a.textRange)?32:this.gKh(!0)?32:8}Rvj(a,b,c,f,l){return(a=this.pa.Na.mb)&&this.pa.UOj()?8:!a||this.pa.eVa()&&!UE.nac(a)?8:this.ia.La(L.a.insertHyperlink,
c,l)}wsj(a,b,c){if(!this.gKh(!1))return 16;a=this.pa.Na.mb;if(!a)return 8;2===c&&this.pCa(a);return 32}pCa(a){va.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.pa.Xd();let c;if((c=this.Gkj(b))&&c.length){if(1===c.length){b=a.Ua;if(!b){va.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");return}if(b.contextId===Cb.a.Of){this.ofi(b,c[0]);return}if(b.contextId===Cb.a.textRange||b.contextId===Cb.a.paragraph){this.qfi(a,
c);return}}this.pfi(c)}else b.length?this.lLc(b)?va.a.J(593892317,820,50,"ClearFormatting on table(s)"):va.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):va.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}Gkj(a){a=this.Ea.r_(a,!1);const b=[];let c=!0;for(const f of a)f.If&&(c=!1,1!==a.length&&this.Mhl(f,a)?b.push.apply(b,this.uih(f,a,!1)):b.push.apply(b,this.uih(f,a,!0)));return c?a:b}Mhl(a,b){for(const c of b)if(c&&!c.If&&(b=
c.ys(),!b||a!==b))return!1;return!0}uih(a,b,c=!1){const f=[];for(const l of b)if(l!==a)f.push(l);else if(c){const w=this.Ea.r_(this.pa.aP(b),!1);f.push.apply(f,w)}return f}pfi(a){this.Ms.E8a(b=>{this.IVe(b,0,this.ykj(b))},a)}qfi(a,b){const c=a.Ua,f=this.E3f(c,b[0]);if(c.contextId===Cb.a.paragraph||-1!==f){var l=this.Anj(a);this.Ms.E8a(w=>{this.IVe(w,f,l)},b)}}ofi(a,b){const c=this.PWa.y6b(a);if(c){var f=c.Ua,l=this.E3f(a,b)+f.Qa;this.Ms.E8a(w=>{this.IVe(w,l,f.Lb-f.Qa)},[b])}}IVe(a,b,c){a.we(hb.a.clearFormatting,
!0);a.we(hb.a.l2e,b);a.we(hb.a.k2e,c)}E3f(a,b){let c=0,f=!1;if(!this.Ih.ae(a.node))return-1;const l=a.node;this.Ea.NJ(b,w=>{w===l?f=!0:f||(c+=this.Ih.textLength(w)+1)});return f?a.contextId===Cb.a.paragraph||a.contextId===Cb.a.Of?c:c+a.Qa:-1}Anj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===Cb.a.textRange?b+=f.Lb-f.Qa:f.contextId===Cb.a.paragraph?b+=this.Ih.textLength(f.node)+1:f.contextId===Cb.a.endOfParagraph&&b++}return b}ykj(a){let b=0;if(a.gB)return 1;this.Ea.NJ(a,c=>{b+=
this.Ih.textLength(c)+1});return b}lLc(a){for(const b of a)if(b.ud)return!0;return!1}gKh(a){const b=this.pa.Xd();if(!b||1>b.length)return!1;const c=this.pa.an();if(c&&!a&&1===b.length)return!1;a=this.Ea.r_(b);return 1>a.length&&!c||this.gf.FC(a)||this.gf.FC([c])?!1:!0}static nac(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua;a=a.ga(1);return!(!nb.SelectionEditor.ik(b)||!nb.SelectionEditor.Xl(a)||b.node!==a.node)}return!1}}Object(n.a)(UE,"TextOperationsActor",null,[365]);class VE{I_d(a,
b,c){return 1===c?32:VE.TLi(b.node)}static TLi(a){const b=new ob.GraphIterator;b.set(a);b.fv();if(xf.b(b))return 2;a=new qf.GraphTransaction(7);a.Iy(b);b.Oi();a.dispose();return 32}}Object(n.a)(VE,"DeleteOutlineLevelContentStrategy",null,[]);class ll{constructor(){this.bRh=new VE}wb(a){const b=Object(F.a)(this.iNc,this.iNc.J_d,"deleteView"),c=Object(F.a)(this,this.I_d,"deleteOutlineLevelContent"),f=Object(F.a)(this.eOf,this.eOf.ULi,"deleteParagraphContent");a.ya(D.a.backspace,Cb.a.Of,f);a.ya(D.a.backspace,
Cb.a.textRange,f);a.ya(D.a.backspace,Cb.a.endOfParagraph,ac.ActionManager.vv);a.ya(D.a.backspace,Cb.a.outline,c);a.ya(D.a.backspace,Cb.a.view,b);a.le(D.a.backspace,1124);a.ya(D.a.aDa,Cb.a.Of,ac.ActionManager.vv);a.ya(D.a.aDa,Cb.a.textRange,f);a.ya(D.a.aDa,Cb.a.endOfParagraph,ac.ActionManager.vv);a.ya(D.a.aDa,Cb.a.outline,c);a.ya(D.a.aDa,Cb.a.view,b);a.ra(D.a.tub,Cb.a.view,b,1124);a.ya(D.a.bL,Cb.a.Of,f);a.ya(D.a.bL,Cb.a.textRange,f);a.ya(D.a.bL,Cb.a.endOfParagraph,ac.ActionManager.vv);a.ya(D.a.bL,
Cb.a.outline,c);a.ya(D.a.bL,Cb.a.view,b);a.le(D.a.bL,1124);a.ra(D.a.$1b,Cb.a.view,b,1124);a.ra(D.a.$Ca,Cb.a.view,ll.$Ca,1028);a.ya(D.a.sRa,Cb.a.view,Object(F.a)(this.iNc,this.iNc.sRa,"deleteFromInputEvent"));a.ya(D.a.sRa,Cb.a.textRange,f);a.le(D.a.sRa,1028)}I_d(a,b,c,f,l){return this.bRh.I_d(a,b,c,f,l)}static get Zl(){return Gy.PageNavigator.instance}static get Qh(){return ll.Fi||(ll.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get LJ(){return ll.mI||(ll.mI=Ab.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get SLi(){return ll.Q2a||
(ll.Q2a=Ab.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get HB(){return ll.Ux||(ll.Ux=Ab.a.instance.resolve("Box4.IOutlineEditor"))}static get ze(){return ll.hd||(ll.hd=Ab.a.instance.rb("Box4.IFeatureHelper"))}static $Ca(a,b,c,f,l){f=b.view;if(!f.Mb||!f.Mb.Na.mb||nb.SelectionEditor.ox(f.Mb.Na.mb))return 8;if(1===c)return 32;c=f.Mb.Na;const w=c.mb;var H=w.Ua;let U=!1;var ja=null,wa=!1;if(c.jH)if(xf.a(H))U=!0;else{if(H.contextId===Cb.a.outline&&1===c.length){for(a=ob.GraphIterator.nb(H.node);a.Ii();)a.Oi();
ll.HB.iW(a,!0);Pa.OutlineElementNavigator.oi(a);a=Od.SelectionFactory.Sg(a.currentNode,0);f.Mb.setSelection(a);return 32}var Sa=H.node;ja=null;if(du.c(H)){var eb=Sa.sc(f.Ma);eb&&(eb=eb.zPl)&&0<=eb.width&&0<=eb.height&&(ja=new Xw.a(Of.a.qf(eb.x,0),Of.a.qf(eb.y,1)));ja||(ja=tq.b(Sa))}else ja=tq.b(H.node);H=ob.GraphIterator.nb(H.node);H.fv();ll.Zl.HKa(H);Sa=ll.LJ.F1b(H);tq.c(Sa,ja.x,ja.y);ll.HB.iW(H,!0);ja=Od.SelectionFactory.uj(Sa,!0)}else if(1===c.length){wa=c.last;H=de.a.WQa(wa);if(ll.ze&&ll.ze.isFeatureEnabled(33)&&
vh.ContextSetEditor.instance.TZe(H).returnValue)return 2;wa=wa.Ye;wa=!xf.a(wa)&&!c.Hl&&(nb.SelectionEditor.Xl(wa)||zb.ParagraphReader.tm(wa)||nb.SelectionEditor.ZW(wa))}wa&&(wa=nb.SelectionEditor.Sl(w,!1,!1,void 0,ll.SLi.nYe(null,1)),f.Mb.setSelection(wa),u.AFrameworkApplication.Ta.pi(b,D.a.CB,2,!1,null,l),ja=f.Mb.Na.mb,f.Mb.setSelection(w));l||(l=new K.DictionaryPropertySet);l.setValue(Yd.a.Yub,!0);u.AFrameworkApplication.Ta.pi(b,D.a.bL,2,!0,null,l);if(ja&&ja.Ua.isValid)return f.Mb.setSelection(ja),
32;c.jH&&(U||bo.instance.bBb(a,b.CE,f));nb.SelectionEditor.ox(f.Mb.Na.mb)||u.AFrameworkApplication.Ta.pi(b,D.a.CB,2,!1,null,l);return 32}}ll.mI=null;ll.Fi=null;ll.Q2a=null;ll.Ux=null;ll.hd=null;Object(n.a)(ll,"ADeleteActor",null,[]);class Zk{get ej(){return Kh.a.instance}ULi(a,b,c,f,l){if(1===c)return 32;f=a===D.a.backspace||a===D.a.sRa;if(Zk.er()&&Zk.er().instance&&Zk.er().instance.bX(b))return 4;c=b.node;var w=b.Qa;b=b.Lb;const H=zb.ParagraphReader.text(c),U=H.length;let ja=!1;if(w===b){if(f&&!w||
!f&&w===U)return 2;f?(R.a.instance.ga(14)&&({cp:w,returnValue:ja}=this.ej.rok(c,w)),ja||(w--,ha.a.rx(H,w)&&w--),a=D.a.gCa):(R.a.instance.ga(14)&&({cp:b,returnValue:ja}=this.ej.qok(c,b)),ja||(b++,ha.a.rx(H,b)&&b++),a=D.a.rRa)}w=w===b?Id.a.Mj(c,w):Id.a.createTextRange(c,w,b);f=new qf.GraphTransaction(15);f.jd=a;f.kd(c);c=Object(Ya.a)(Rs,l)&&l.X4b;if(Zk.Sf.hg&&Zk.Sf.Yy&&!c){c=Zk.Sf.tsb();try{let wa;if(({type:wa}=null.l9f()).returnValue){const Sa=Object(qa.a)(10,l);if(Sa&&Sa.sa(Qs.a.Aig,!1)||1===wa)Zk.Sf.$$g=
wa}l=0;for(let Sa=null.length-1;0<=Sa;--Sa){let eb;const ub=({nog:eb}=null.getContext(Sa)).returnValue;eb?(Zk.hyperlinkEditor.XGb(ub,null),l+=0,Zk.F6.VXd=b+l):this.fOf(ub)}}finally{c&&c.dispose()}}else this.fOf(w);f.dispose();return 32}static get Sf(){return Zk.fd||(Zk.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get F6(){return Zk.ap||(Zk.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get cuc(){return Zk.JD||(Zk.JD=
Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return Zk.zn||(Zk.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static er(){return Zk.Gm||(Zk.Gm=Ab.a.instance.Ja("Box4.IExternalSelectionManager"))}}Zk.fd=null;Zk.ap=null;Zk.JD=null;Zk.zn=null;Zk.Gm=null;Object(n.a)(Zk,"ADeleteParagraphContentStrategy",null,[]);class Vv extends Zk{constructor(){super()}fOf(a){Vv.characterPropertiesEditor.replaceTextRange(a,"")}static get characterPropertiesEditor(){return Vv.Inh||
(Vv.Inh=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}Vv.Inh=null;Object(n.a)(Vv,"DeleteParagraphContentStrategy",Zk,[]);var JR=d(473);class $N{constructor(a,b,c,f){this.E6e=a;this.UJ=c;this.rd=f;this.actionId=b}}Object(n.a)($N,"DeleteActionData",null,[]);class rf{get ovi(){return rf.c$e||(rf.c$e=Ab.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}vyl(a){return!nb.SelectionEditor.ik(a)}Rjj(a,b,c){if(!a)return null;if(!c)return a;b=nb.SelectionEditor.lSa(a,!1,!b,!0,
!0,!0);return Od.SelectionFactory.GN(a,b.Ua,!1)}J_d(a,b,c,f,l){if(1===c)return 32;var w=!1;a===D.a.$1b&&(a=D.a.bL,w=!0);a===D.a.tub&&(a=D.a.backspace,w=!0);a===D.a.aDa&&(b=new rC.a(Pc.App.Kb.Ld.Dn));var H=b;if(!H.view.Nh)return 2;var U=H.view.Mb;ph.GrippersManager.instance.setVisibility(!1);H=a===D.a.bL;U=0<U.Na.length?U.Na.ga(0):null;w=this.Rjj(U,H,w);return this.nOf(a,b,c,f,l,w,H)}nOf(a,b,c,f,l,w,H){const U=b.view,ja=U.Mb;var wa=l,Sa=l;a===D.a.aDa&&(Sa=wa=null,w=new gb.Selection(l,!0));if(!w)return 32;
const eb=new $N(b,a,f,Sa),ub=this.Fil(wa,H,ja);wa=!1;if(({AUa:wa}=this.evh(a,ub,ja)).returnValue)return a=wa?D.a.ZCa:D.a.deleteRow,u.AFrameworkApplication.Ta.pi(b,a,c,!1,f,l);let Ub;H?fd.a.mark(Ub=5009):fd.a.mark(Ub=5011);c=new qf.GraphTransaction(15);c.jd=a;c.kd(U.xg);wa=null;let cc=({n7k:wa}=this.C7i(a,l,ja,w)).returnValue;Sa=null;({zrd:Sa}=vh.ContextSetEditor.instance.TZe(cc)).returnValue&&(cc=Sa);if(!cc)return c.dispose(),32;this.CDh(cc);const Fc=this.b4i(w,H);let Ic=null;H?Ic=new cr(w):Fc&&(Ic=
new cr(Fc));Sa=!1;if(nb.SelectionEditor.Tg(cc)){if(a===D.a.sRa)return 2;const Cc=Rh.UTc(U.xg,ub);rf.WS.hG(()=>{this.LLi(b,f,l,cc,H,Ic,w,Cc,ja,ub,eb,Fc)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else rf.Sf.hg&&rf.Sf.Yy?(this.uyl(a,U.xg,cc,H,w,ja,ub,eb,Ic),Sa=!0):Sa=this.kah(a,U.xg,cc,ja,ub,eb,Ic,wa);rf.l_i(ja);this.Tlh(cc);c.dispose();fd.a.mark(Ub+1);return a===D.a.aDa?Sa?32:8:32}sRa(a,b,c,f,l){return b.view.Nh?this.nOf(a,b,c,f,null,l,!1):2}kah(a,b,c,f,l,w,H,U){b=Rh.UTc(b,l);this.vyl(c)&&
b.kpa(c);a=rf.Wc.Wp(a);a.properties.$("CountOfParagraphsDeleted",rf.M5.TXd(c).toString());c=rf.tOi(rf.Jil,Object(F.a)(this,this.Iil,"shouldDispatchNoSpecialize"),c,f,l,b,w,H,U);a.end();return c}uyl(a,b,c,f,l,w,H,U,ja){var wa=0,Sa=null;const eb=vh.ContextSetEditor.instance.MA(c),ub=eb[eb.length-1];if(ub.contextId===Cb.a.paragraph||ub.contextId===Cb.a.endOfParagraph){var Ub=ob.GraphIterator.nb(ub.node);Ub.Ze();Pa.OutlineElementNavigator.Re(Ub);Pa.OutlineElementNavigator.HJ(Ub,!0,!1)&&(Sa=Pa.OutlineElementNavigator.oi(Ub))&&
(wa=rf.M5.textLength(Sa))}else wa=rf.M5.textLength(ub.node)-ub.Lb;if((Ub=Object(qa.a)(10,U.rd))&&Ub.sa(Qs.a.Aig,!1))this.jah(a,b,c,w,H,U,ja,!1);else{Ub=rf.Sf.tsb();try{this.jah(a,b,c,w,H,U,ja,!0)}finally{Ub&&Ub.dispose()}}if(f){if(c.lx){a=eb.length-1;do l=eb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!rf.M5.ae(l.node))return;switch(ub.contextId){case Cb.a.paragraph:case Cb.a.endOfParagraph:wa=Sa&&Sa.isConnected?0:wa;break;case Cb.a.Of:case Cb.a.textRange:break;default:wa=0}wa=Od.SelectionFactory.Sg(l.node,
rf.M5.textLength(l.node)-wa);l.Z5a===wa.Ua.Qa&&(wa.Ua.SS=l.SS)}else{wa=l.Ua.node;if(!rf.M5.ae(wa))return;Sa=l.Ua.contextId===Cb.a.paragraph?0:l.Ua.contextId===Cb.a.endOfParagraph?rf.M5.textLength(wa):l.Ua.Qa;wa=Od.SelectionFactory.Sg(wa,Sa)}de.a.instance.setSelection(wa)}jah(a,b,c,f,l,w,H,U){this.n2i(f,c);!({type:ja}=null.l9f()).returnValue||U&&1!==ja||(rf.Sf.$$g=ja);for(c=null.length-1;0<=c;--c){var ja=({nog:U}=null.getContext(c)).returnValue;U?rf.hyperlinkEditor.XGb(ja,2):this.kah(a,b,ja,f,l,w,
H,null)}}n2i(a,b){if(Object(Ya.a)(JR.a,b))for(a=Fi.hta(a.Na,!0),b=0;b<a.length&&a.getContext(b).contextId!==Cb.a.table;b++);}C7i(a,b,c,f){a===D.a.aDa?(c=Wa.a.$Qa(b),a=fn.SelectionReferenceFactory.instance.ksa()):(a=null,c=1===c.Na.length?de.a.WQa(f):c.Qj);return{returnValue:c,n7k:a}}nqi(a){return!a.al||a.contextId!==Cb.a.paragraph||!rf.M5.ae(a.node)||rf.Sf.hg&&rf.Sf.Yy||R.a.instance.ga(14)&&rf.ej.M_c(a)?!1:!0}CDh(a){if(a.lx)for(let b=0;b<a.length;b++)this.CDh(a.getContext(b));else this.nqi(a)&&(a.node.uJc=
!0)}Tlh(a){if(a.lx)for(let b=0;b<a.length;b++)this.Tlh(a.getContext(b));else a.al&&(a=a.node)&&rf.M5.ae(a)&&(a.uJc=!1)}LLi(a,b,c,f,l,w,H,U,ja,wa,Sa,eb){const ub=new ob.GraphIterator,Ub=f.node;ub.set(Ub);ub.Ze();nb.SelectionEditor.GC(ub.currentNode,f,l)?this.PLi(a,b,c,f,l,w,H,U,ja,Sa,eb,ub,Ub):rf.QLi(f,l,w,H,U,ja,wa,Sa)}XVc(a,b,c,f){return!a&&rb.ListReader.vk(b)?(f=rf.moa(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}Xtj(a,b,c,f,l,w){return R.a.instance.ga(65)&&!a&&0<fe.OutlineElementReader.Uwb(b)?
(w=u.AFrameworkApplication.Ta.pi(c,D.a.rih,2,!1,f,l),{returnValue:!0,response:w}):{returnValue:!1,response:w}}Ayj(a,b,c,f,l,w){return R.a.instance.ga(54)&&!a&&0<fe.OutlineElementReader.O9a(b)?(w=u.AFrameworkApplication.Ta.pi(c,D.a.sYk,2,!1,f,l),{returnValue:!0,response:w}):{returnValue:!1,response:w}}Zvj(a,b,c,f,l,w){return R.a.instance.ga(80)&&!a&&rf.Bv.dtb(b)?(w=u.AFrameworkApplication.Ta.pi(c,D.a.Ey,2,!1,f,l),{returnValue:!0,response:w}):{returnValue:!1,response:w}}urj(a,b,c,f,l,w,H,U,ja,wa,Sa){const eb=
new nn.a;eb.Rc(b);if(Pa.OutlineElementNavigator.ZIa(eb,!1,!a,!1)){Sa=!0;wa=32;const ub=new ob.GraphIterator;ub.Rc(eb);Pa.OutlineElementNavigator.oi(eb);w&&f&&nb.SelectionEditor.ZW(f.Ua)?(c.kpa(l),rf.Qh.YXk(b.currentNode)):eb.currentNode.YW?(R.a.instance.ga(68)&&c.kpa(l),Pa.OutlineElementNavigator.Re(eb),eb.Oi()):R.a.instance.ga(66)&&a&&w?rf.ej.Klg(U)&&!({Iya:Sa}=this.fdh(a,U,eb.currentNode,f,Sa)).returnValue&&(c.kpa(l),rf.fq.moa(b),b.Oi()):hd.TableReader.eq(eb)?(c.kpa(l),this.mOf&&({response:wa,returnValue:Sa}=
this.mOf.nOl(a,ub,b,eb,H,ja,wa))):rf.M5.ae(eb.currentNode)&&(({Iya:Sa}=this.fdh(a,U,eb.currentNode,f,Sa)).returnValue||this.gOf&&this.gOf.MLi(a,c,l,b,U,eb));return{returnValue:!0,response:wa,Iya:Sa}}return{returnValue:!1,response:wa,Iya:Sa}}fdh(a,b,c,f,l){return rf.Sf.hg&&rf.Sf.Yy&&(a=(a?b:c).Ra.last,b=u.AFrameworkApplication.userName,!a.Ho||a.Ho.authorName!==b)?(f&&(de.a.instance.setSelection(f),l=!1),{returnValue:!0,Iya:l}):{returnValue:!1,Iya:l}}cyj(a,b,c,f,l,w,H,U){return R.a.instance.ga(67)&&
fe.OutlineElementReader.vjg(b,a)?(Ie.isInTableCell(b)&&(Rd.returnToContainingCell(b),Ie.isEmpty(b)&&c.kpa(f),{Kjl:a,returnValue:U}=rf.aok(b,H,a,l,w),a||(U=2)),{returnValue:!0,response:U}):{returnValue:!1,response:U}}puj(a,b,c,f,l,w,H,U){fe.OutlineElementReader.vjg(b,a)||({response:H,Iya:U}=rf.fPi(c,f,a,w,l,H,U));return{returnValue:!1,response:H,Iya:U}}PLi(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){let Ub=!1,cc=2;const Fc=rf.M5.isEmpty(eb),Ic=eb.currentNode;Pa.OutlineElementNavigator.Re(eb);({response:cc}=this.XVc(l,
eb,wa,cc)).returnValue||({response:cc}=this.Xtj(l,eb,a,b,c,cc)).returnValue||({response:cc}=this.Ayj(l,eb,a,b,c,cc)).returnValue||({response:cc}=this.Zvj(l,eb,a,b,c,cc)).returnValue||({response:cc,Iya:Ub}=this.urj(l,eb,U,Sa,f,Fc,Ic,ub,ja,cc,Ub)).returnValue||({response:cc}=this.cyj(l,eb,U,f,ja,wa,Ic,cc)).returnValue||({response:cc,Iya:Ub}=this.puj(l,eb,b,c,U,H,cc,Ub));rf.R0g(U,32===cc);Ub&&rf.QU(ja,w)}Fil(a,b,c){return a&&a.Sa(Yd.a.Yub)?this.ovi.Buh()||a.eb(Yd.a.Yub)?!a.sa(Yd.a.Yub,!1):this.E1f(!1,
c):this.E1f(b,c)}evh(){return{returnValue:!1,AUa:!1}}static get characterPropertiesEditor(){return rf.gh||(rf.gh=Ab.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Rf(){return rf.Wg||(rf.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}static get M5(){return rf.sr||(rf.sr=Ab.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return rf.zn||(rf.zn=Ab.a.instance.resolve("Box4.IHyperlinkEditor"))}static get fq(){return rf.Zo||(rf.Zo=Ab.a.instance.resolve("Box4.List.IListEditor"))}static get Qh(){return rf.ilf||
(rf.ilf=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}static get UH(){return am.a.instance}static get Bv(){return mv.a.mxb}static get Sf(){return rf.fd||(rf.fd=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get F6(){return rf.ap||(rf.ap=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get cuc(){return rf.JD||(rf.JD=Ab.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Wc(){return Nc.a.instance}static get ej(){return Kh.a.instance}static get Yt(){return rf.BD||
(rf.BD=Ab.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get WS(){return Ad.a.instance}static l_i(a){if(1===a.Na.length&&(a=a.Na.ga(0),nb.SelectionEditor.ox(a))){var b=a.Ua;a=b.node;b=b.Qa;var c=rf.M5.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&rf.characterPropertiesEditor.replaceTextRange(Id.a.createTextRange(a,b-1,b),"\u00a0")}}static tii(a,b){if(!b.hyperlink.Fzb){const c=new qf.GraphTransaction(15);try{c.kd(a.node),rf.Yt.CM(a,b)}finally{c&&c.dispose()}}}static moa(a,
b){a=rf.Rf.lw(a).G_c?D.a.mP:D.a.QM;return u.AFrameworkApplication.Ta.pi(b.E6e,a,2,!1,b.UJ,b.rd)}static fPi(a,b,c,f,l,w,H){if(c=nb.SelectionEditor.lSa(f,!1,!c,!1,!1,!0)){f=Od.SelectionFactory.GN(f,c.Ua);w=32;for(c=0;c<f.length;++c){l.kpa(f.ga(c));const U=u.AFrameworkApplication.Ta.pi(f.ga(c),D.a.bL,2,!0,a,b);2!==U&&(w=U)}32===w&&(H=!0)}return{response:w,Iya:H}}static tOi(a,b,c,f,l,w,H,U,ja){let wa=!1;a(c)?(wa=rf.x0d(c,!0,f,l,w,H))&&rf.qMa(U,f,ja):b(c)?(wa=rf.x0d(c,!1,f,l,w,H))&&rf.qMa(U,f,ja):(w.normalize(),
rf.qMa(U,f,ja));return wa}static qMa(a,b,c){c&&c.QU()||rf.QU(b,a)}static x0d(a,b,c,f,l,w){f||jj.OutlineReader.gla(a)||(c=rf.XBl(c))&&l.Ffl(c);a=32===u.AFrameworkApplication.Ta.pi(a,w.actionId,2,b,w.UJ,w.rd);rf.R0g(l,a);return a}static R0g(a,b){b?a.normalize():a.cancel()}static QU(a,b){b&&(b=b.restore())&&a.setSelection(b)}static QLi(a,b,c,f,l,w,H,U){let ja;!b&&({C8b:ja}=rf.Yt.dbb(a)).returnValue?(c=new cr(f),rf.tii(a,ja),l.normalize(),rf.QU(w,c)):rf.x0d(a,!1,w,H,l,U)&&(b&&rf.Sf.hg&&rf.Sf.Yy?(b=rf.F6.VXd)?
(w.setSelection(Od.SelectionFactory.Sg(a.node,b)),rf.F6.VXd=null):rf.QU(w,c):rf.QU(w,c))}static aok(a,b,c,f,l){let w,H=2;w=!0;if(Ie.isEmpty(a)){const U=Rd.getContainingTable(a),ja=hd.TableReader.tk(U),wa=hd.TableReader.Ci(U);1===ja&&1===wa?(H=u.AFrameworkApplication.Ta.pi(Id.a.create(U),D.a.t7a,2,!1,l.UJ,l.rd),f.setSelection(Od.SelectionFactory.Sg(b,0)),w=!1):1===ja?H=u.AFrameworkApplication.Ta.pi(l.E6e,D.a.ZCa,2,!1,l.UJ,l.rd):(b=Ie.isEmptyIncludingTheRestOfTheRow(a),Ie.isFirstCellInRow(a)&&b?H=u.AFrameworkApplication.Ta.pi(l.E6e,
D.a.deleteRow,2,!1,l.UJ,l.rd):!c&&b&&(H=32,a=nb.SelectionEditor.$sa(f.Na.mb,!1,!1,!1,!0),f.setSelection(a),w=!1))}return{returnValue:H,Kjl:w}}static Jil(a){return a.lx||jj.OutlineReader.gla(a)||rf.M5.tm(a)}static XBl(a){return(a=Fi.hta(a.Na,!0))&&1===a.length&&(a=a.getContext(0).node,hd.TableReader.zbb(a))?a:null}}rf.Wg=null;rf.gh=null;rf.ilf=null;rf.sr=null;rf.zn=null;rf.Zo=null;rf.fd=null;rf.ap=null;rf.JD=null;rf.c$e=null;rf.BD=null;Object(n.a)(rf,"ADeleteViewStrategy",null,[]);class vu{constructor(a,
b){this.Pb=a;this.Ih=b}MLi(a,b,c,f,l,w){l=this.Pb.Mc(l);a&&!this.Ih.isEmpty(l)?(Pa.OutlineElementNavigator.Re(w),b.EDh(w.currentNode),vu.Qh.merge(f,w,!1,!1)):(Pa.OutlineElementNavigator.Re(w),b.kpa(c),vu.Qh.merge(w,f,!1,!1))}static get Qh(){return vu.Fi||(vu.Fi=Ab.a.instance.resolve("Box4.IOutlineElementEditor"))}}vu.Fi=null;Object(n.a)(vu,"DeleteParagraphNodeStrategy",null,[1261]);class aO extends rf{constructor(a,b,c,f){super();this.H8j=new vu(c,f);this.la=a;this.QIg=b;this.Pb=c}get mOf(){throw Error.notImplemented();
}get gOf(){return this.H8j}b4i(a,b){return nb.SelectionEditor.lSa(a,!0,!b,!1,!1,!0)}Iil(a){return nb.SelectionEditor.ik(a)}E1f(a,b){if(!this.la.Qme||!this.la.EAb||!this.la.Rme||a)return!1;a=this.Xmj(b);return 1===(a&1)&&2!==(a&2)}Xmj(a){var b=a.Na;if(!b.length)return 0;a=Object(qa.a)(5,b.ga(0).Ua.node);if(!a||!a.Cs())return 0;a=(a=(a=a.lL())?a.b9f():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var w=Fi.eTc(l,!0),H=Fi.eTc(l,!1);if(w&&H){if(nb.SelectionEditor.$t(w)&&
!nb.SelectionEditor.xzb(w)||!zb.ParagraphReader.jke(w.node)||w!==H&&nb.SelectionEditor.$t(H)&&!nb.SelectionEditor.xzb(H)||!zb.ParagraphReader.IQj(H.node))return 0;if(l=Object(qa.a)(Wa.a,vh.ContextSetEditor.instance.b5b(Wa.a.$Qa(l.toArray()),16,!1)))for(w=0;w<l.length;++w)H=Object(qa.a)(Zl.TableCellNode,l.getContext(w).node),a.Np()&&H.isControllingCell?this.nJj(H,c):H.isGhostCell||Array.add(c,H)}}}if(!c.length)return 0;b=a.HY;f=a.h8;w=l=0;H=Array(b);const U=Array(f);for(var ja=0;ja<b;++ja)H[ja]=0;
for(ja=0;ja<f;++ja)U[ja]=0;for(ja=0;ja<c.length;++ja){const wa=c[ja].b9f();++H[wa.rowIndex]===f&&++l;++U[wa.ui]===b&&++w}if(0<l&&0<w){if(l===b&&w===f)return 3}else if(l||w){if(0<l){if(!a.Np())for(a=0;a<f;++a)if(U[a]!==l)return 0;return 1}if(0<w){if(!a.Np())for(a=0;a<b;++a)if(H[a]!==w)return 0;return 1}}return 0}nJj(a,b){Ie.foreachMergedCells(Object(qa.a)(yg.a,a),c=>{Array.add(b,c)})}XVc(a,b,c,f){if(!a&&rb.ListReader.vk(b)){var l=this.Pb.TSa();l.Rc(b);if((l=Object(qa.a)(4,l.Jg(10)))&&l.Qf){if(this.QIg.dtb(b))this.QIg.dib(b,
-1,0),f=32;else if(b.JF(1)){if(b.Cf(1),({response:f}=super.XVc(a,b,c,f)).returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.XVc(a,b,c,f)}return{returnValue:!1,response:f}}evh(a,b,c){if(!(b&&a===D.a.backspace&&c.Na&&c.Na.length&&c.Na.Hl))return{returnValue:!1,AUa:!1};b=c.an();if(!b||!b.Np())return{returnValue:!1,AUa:!1};a=b.HY;b=b.h8;let f=a,l=0,w=b,H=0;c=vh.ContextSetEditor.instance.MA(c.Qj);for(let wa=0;wa<c.length;wa++){if(!c[wa].al)return a=!1,
{returnValue:!1,AUa:a};var U=Object(qa.a)(5,c[wa].node);if(!U||!U.Cs())return a=!1,{returnValue:!1,AUa:a};var ja=(U=U.lL())?U.az():null;if(!ja)return a=!1,{returnValue:!1,AUa:a};U=ja.rowIndex;const Sa=ja.ui,eb=ja.rowSpan;ja=ja.colSpan;f=Math.min(f,U);l=Math.max(l,U+eb-1);w=Math.min(w,Sa);H=Math.max(H,Sa+ja-1)}return l-f+1!==a&&H-w+1!==b?{returnValue:!1,AUa:!1}:{returnValue:!0,AUa:l-f+1===a?!0:!1}}}Object(n.a)(aO,"DeleteViewStrategy",rf,[]);class bO extends ll{constructor(a,b,c,f){super();this.I8j=
new aO(a,b,c,f);this.G8j=new Vv}get iNc(){return this.I8j}get eOf(){return this.G8j}}Object(n.a)(bO,"Box4DeleteActor",ll,[]);class cO{constructor(a,b,c,f,l){this.ia=a;this.F8j=new bO(b,c,f,l);na.InteractiveViewManager.instance.editingView.u2b=!0}wb(){this.F8j.wb(this.ia)}Ee(){var a=D.a.backspace;const b=y.FocusManager.instance().Fc(O.AppFrame.FW);b.bindAction(x.KeyInputManager.Oa(A.a.VH,0),a);b.bindAction(x.KeyInputManager.Oa(A.a.VH,4),D.a.backspace);b.bindAction(x.KeyInputManager.Oa(A.a.VH,4|x.KeyInputManager.Oe),
G.a.ve);b.bindAction(x.KeyInputManager.Oa(A.a.VH,x.KeyInputManager.Oe),D.a.tub);b.bindAction(x.KeyInputManager.Oa(A.a.upa,0),D.a.bL);b.bindAction(x.KeyInputManager.Oa(A.a.upa,x.KeyInputManager.Oe),D.a.$1b);B.a.wk&&(b.bindAction(x.KeyInputManager.Oa(A.a.VH,3),D.a.backspace),b.bindAction(x.KeyInputManager.Oa(A.a.VH,7),D.a.backspace),b.bindAction(x.KeyInputManager.Oa(A.a.VH,5),D.a.backspace),b.bindAction(x.KeyInputManager.Oa(A.a.VH,1),D.a.tub))}}Object(n.a)(cO,"DeleteActor",null,[365]);class dO{constructor(a){this.y7j=
a}wb(){this.y7j.wb()}Ee(){}}Object(n.a)(dO,"EnterActor",null,[365]);class Zp{constructor(a,b,c){this.hv=a;this.UXb=b;this.Gm=c}get Mn(){return this.UXb.value}jUi(a,b,c,f,l){var w;if(!({Hf:c,selected:w,uF:ja}=this.ivh(b,c,!1)).returnValue)return ja;fd.a.mark(5013);var H=Zp.jm.MA(w);for(var U=0;U<H.length;++U){if(!H[U].isValid)continue;let wa=H[U].iterator;wa.fv();if(jj.OutlineReader.au(wa))return this.BTf(c,wa);if(xf.b(wa))return bo.instance.bBb(a,w,c),this.Mn.uw(),fd.a.mark(5014),32}H=this.v$i(w);
if(w.lx||nb.SelectionEditor.ik(w)||zb.ParagraphReader.tm(w)&&!nb.SelectionEditor.ZW(w)){if(Zp.ze&&Zp.ze.isFeatureEnabled(33)&&vh.ContextSetEditor.instance.TZe(w).returnValue)return 8;var ja=this.CTf(b,c,a,f,l,H)}else if(nb.SelectionEditor.Xl(w))ja=this.ATf(b,c,a,f,l,H);else if(nb.SelectionEditor.Tg(w)){ja=new ob.GraphIterator;ja.set(w.node);ja.rc(10);if(this.$ok()&&(U=vb.HyperlinkReader.vC(w,!1),0<U.length)){if(!U[0].hyperlink)return ka.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
U[0].Qa,U[0].Lb),8;Pc.App.R4b(U[0].hyperlink.url);return 32}Ie.isInTableCell(ja)&&!R.a.instance.ga(77)&&(Rd.returnToContainingCell(ja),R.a.instance.ga(30)&&Ie.isLastCellInTable(ja)&&!jj.OutlineReader.qWc(ja)&&jj.OutlineReader.GC(ja,w,!0)&&(Xg.OutlineNavigator.Y$(ja),rb.ListReader.vk(ja)||(H=D.a.eua),Rd.returnToCell(ja)),Ie.isFirstCellInRow(ja)&&(U=new ob.GraphIterator,U.Rc(ja),Rd.returnToContainingRow(U),R.a.instance.ga(30)&&ok.j(U)&&ok.e(U)&&1<hd.TableReader.tk(Rd.getContainingTable(U))?H=D.a.deleteRow:
jj.OutlineReader.GC(ja,w,!1)&&(ok.g(U)&&0>=w.SS?(H=D.a.f9b,Rd.returnToContainingTable(ja),Pa.OutlineElementNavigator.Re(ja),l||(l=new K.DictionaryPropertySet),l.we(Yd.a.targetObject,ja.currentNode.id)):R.a.instance.ga(30)&&(H=D.a.lUa))));ja=this.ETf(b,c,a,f,l,H)}else nb.SelectionEditor.ZW(w)&&(ja=u.AFrameworkApplication.Ta.pi(b,D.a.CB,2,!1,f,l));fd.a.mark(5014);return ja}ivh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,Hf:f,selected:l,uF:32};if(!a.view.Nh)return{returnValue:!1,Hf:f,selected:l,
uF:2};f=a.view;l=f.Mb.Qj;return!l||R.a.instance.ga(14)&&!Zp.ej.Xig(l,c)?{returnValue:!1,Hf:f,selected:l,uF:2}:this.Gm&&this.Gm.instance&&this.Gm.instance.bX(l)?{returnValue:!1,Hf:f,selected:l,uF:4}:{returnValue:!0,Hf:f,selected:l,uF:2}}gil(a,b,c,f,l){let w,H;if(!({Hf:c,selected:w,uF:H}=this.ivh(b,c,!0)).returnValue)return H;const U=Zp.jm.MA(w);for(let ja=0;ja<U.length;++ja){if(!U[ja].isValid)continue;const wa=U[ja].iterator;wa.fv();if(jj.OutlineReader.au(wa))return this.BTf(c,wa)}w.lx||nb.SelectionEditor.ik(w)?
H=this.CTf(b,c,a,f,l,D.a.d9b):nb.SelectionEditor.Xl(w)?H=this.ATf(b,c,a,f,l,D.a.d9b):nb.SelectionEditor.Tg(w)?H=this.ETf(b,c,a,f,l,D.a.d9b):nb.SelectionEditor.ZW(w)&&(H=u.AFrameworkApplication.Ta.pi(b,D.a.CB,2,!1,f,l));return H}BTf(a,b){a.Mb.setSelection(Od.SelectionFactory.uj(b.currentNode,!1));return 32}CTf(a,b,c,f,l,w){const H=new qf.GraphTransaction(15);H.jd=c;H.kd(b.xg);b=new K.DictionaryPropertySet;b.setValue(Yd.a.Yub,!0);b=u.AFrameworkApplication.Ta.pi(a,D.a.bL,2,!0,f,b);32===b&&(b=u.AFrameworkApplication.Ta.pi(a,
w,2,!1,f,l));H.dispose();return b}ATf(a,b,c,f,l,w){const H=new qf.GraphTransaction(15);H.jd=c;H.kd(b.xg);b.Mb.setSelection(nb.SelectionEditor.Sl(b.Mb.Na.ga(0),!1,!1));a=u.AFrameworkApplication.Ta.pi(a,w,2,!1,f,l);H.dispose();return a}ETf(a,b,c,f,l,w){const H=new qf.GraphTransaction(15,c);H.jd=c;H.kd(b.xg);a=u.AFrameworkApplication.Ta.pi(a,w,2,!1,f,l);H.dispose();return a}static get jm(){return vh.ContextSetEditor.instance}static get ej(){return Kh.a.instance}static get ze(){return Zp.hd||(Zp.hd=Ab.a.instance.rb("Box4.IFeatureHelper"))}}
Zp.hd=null;Object(n.a)(Zp,"AEnterViewStrategy",null,[1240]);class kt extends Zp{constructor(a,b,c){super(a,b,c)}v$i(a){let b=D.a.CB;if(a&&(a=Zp.jm.MA(a))&&0<a.length){const c=new ob.GraphIterator;c.set(a[0].node);c.rc(10);(a=c.Q1a())&&a.Sa(hb.a.Jj)&&(a=a.eb(hb.a.Jj),0===a||2===a)&&(b=D.a.d9b)}return b}$ok(){return kt.bV?!1:!0}static get bV(){null==kt.pI&&(kt.pI=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return kt.pI}}kt.pI=null;Object(n.a)(kt,
"EnterViewStrategy",Zp,[]);class WE{constructor(a){this.d$j=a}npd(a,b){this.d$j.YU(a,b)}}Object(n.a)(WE,"PPTFontNameFormattingStrategy",null,[1233]);class eO{Buh(){return!1}}Object(n.a)(eO,"PptClipboardOperationCutStrategy",null,[993]);class fO{constructor(a,b){this.fM=a;this.pa=b}TSj(a){return 10===a.vi||16===a.vi||60===a.vi}mqi(a){if(this.fM.fbb(a)&&this.fM.Azb(a))return!1;let b=a=null;this.pa.Na.mb&&(b=this.pa.Na.mb.Ua,a=this.pa.Na.mb.Ye);return this.sne(b)&&this.sne(a)}sne(a){if(a){if(a.contextId===
Cb.a.paragraph)return!0;if(a.contextId===Cb.a.endOfParagraph&&(a=a.node))return ha.a.Wa(a.characterData)}return!1}zjl(a,b){return this.nYe(a,b)}nYe(a,b){let c=null;this.pa.Na.mb&&(c=this.pa.Na.mb.Ua);return this.sne(c)?!!a&&this.fM.Azb(a)||1===b:!1}}Object(n.a)(fO,"PptDeleteOutlineElementNodeStrategy",null,[1144]);class gO{constructor(a,b,c){this.Kq=a;this.AJ=b;this.ob=c}ZTf(a){if(this.ob.Na&&this.ob.Na.Hl){const f=this.Kq.l0f(this.ob.Na).returnValue;if(!f.cSa()&&a.lx){a=new Wa.a;var b=this.ob.yv();
for(const l of b)if(b=Object(qa.a)(Zl.TableCellNode,l)){var c=ob.GraphIterator.nb(b);if(c.Ze()){const w=ok.c(c);c=this.AJ.lSc(Object(qa.a)(125,c.currentNode));f.mWi(w,c)&&a.wia(de.a.WQa(Od.SelectionFactory.wl(b)))}}}}return a}}Object(n.a)(gO,"PptDeleteTableSegmentStrategy",null,[994]);class hO{tAh(){return!1}rlg(a){return!!a&&!a.nm.equals(ia.a.nil)}}Object(n.a)(hO,"PptEopFormattingStrategy",null,[1142]);class iO{constructor(a,b,c){this.d8c=!1;this.Ea=a;this.pJ=b;this.pa=c}DFh(a,b){a&&b&&(b.beforeSpacing&&
(a.setValue(hb.a.cea,b.beforeSpacing.value),a.setValue(hb.a.xla,b.beforeSpacing.unit)),b.afterSpacing&&(a.setValue(hb.a.aea,b.afterSpacing.value),a.setValue(hb.a.wla,b.afterSpacing.unit)),b.lineSpacing&&(a.setValue(hb.a.xx,b.lineSpacing.value),a.setValue(hb.a.nX,b.lineSpacing.unit)));return!0}yuh(){return!1}lvh(){return!1}vuh(){return!this.d8c}fvh(a,b){return a===Cb.a.paragraph||a===Cb.a.endOfParagraph||b}wuh(a,b,c){this.pa.Na&&this.pa.Na.mb&&(c=!this.pa.Na.mb.Cca);return a!==Cb.a.textRange&&(b===
Cb.a.paragraph||c)}ewf(a,b,c){this.d8c=!1;if(a.Cs()&&this.pa.Na.mb){var f=this.pa.Na.mb.Ua;this.pa.Na&&this.pa.Na.Hl&&this.pa.Na.ga(0)&&(f=this.pa.Na.ga(0).Ua);if(f=Kb.a.xs(zb.ParagraphReader.ae(f.node)?f:Od.SelectionFactory.wl(a).Ua))if(f=f.cache)!c.Sa(hb.a.latinFont)&&f.Sa(hb.a.latinFont)&&c.setValue(hb.a.latinFont,f.JN),!c.Sa(Za.a.fontColor)&&f.V3&&c.setValue(Za.a.fontColor,f.fontColor),!c.Sa(Za.a.fontSize)&&f.Ota&&c.setValue(Za.a.fontSize,f.fontSize),!c.Sa(Za.a.bold)&&f.LTa&&c.setValue(Za.a.bold,
f.isBold)}if(b){if(f=a.qQ(this.pJ)){b.MT||a.sa(hb.a.pje,!1)||f.sa(hb.a.pje,!1)||(this.d8c=!0);const l=b.spacing;l&&(!l.beforeSpacing||l.beforeSpacing.value||f.Sa(hb.a.cea)||(l.beforeSpacing=null),!l.afterSpacing||l.afterSpacing.value||f.Sa(hb.a.aea)||(l.afterSpacing=null),l.lineSpacing&&2===l.lineSpacing.unit&&1===l.lineSpacing.value&&!f.Sa(hb.a.xx)&&(l.lineSpacing=null))}this.d8c||(b.MT||(b.MT=cf.a.yN(16,0)),b.MT.aZf=!0)}if((f=a.g7f())&&!f.Z$&&(c.Sa(Za.a.fontSize)&&(f=this.Ea.YDa(this.Ea.en(a)),
c.setValue(Za.a.fontSize,c.eb(Za.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.unit)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Ea.Gwb(this.Ea.en(a))}c.sa(Za.a.it,!1)&&c.setValue(Za.a.it,!1);c.sa(Za.a.G_,!1)&&c.setValue(Za.a.G_,!1)}}Object(n.a)(iO,"PptFormatPainterStrategy",null,[1145]);class pA{constructor(a,b,c,f,l,w,H){this.ia=a;this.Fa=f;this.pa=b;this.uE=c;this.Pu=l;this.yz=w;this.LXa=!H.vg;this.aye=H.jmg}wb(){this.ia.ra(G.a.pDh,Xd.a.frame,Object(F.a)(this,
this.tJk,"pptToggleRibbonUXHandler"),128);this.ia.ya(G.a.Vkh,Xd.a.frame,ac.ActionManager.Ng);this.ia.ya(G.a.Ukh,Xd.a.frame,ac.ActionManager.Ng)}Ee(){}tJk(a,b){if(b.contextId!==Xd.a.frame)return 2;this.pa.Rh();this.Fa.Ed();this.Pu.show(!0,a);this.aye?(va.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),u.AFrameworkApplication.Ta.processAction(G.a.Vkh,2)):(va.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),u.AFrameworkApplication.Ta.processAction(G.a.Ukh,
2));u.AFrameworkApplication.dv&&u.AFrameworkApplication.dv.B8();this.yz.N_&&2===this.yz.NE?pA.qoh(this.ia,this.aye,kx.a.BZa):this.uE.C3(!1,this.LXa,()=>{pA.qoh(this.ia,this.aye,kx.a.BZa)},null);return 32}static qoh(a,b,c){ui.a.aK(c,(!b).toString(),ui.a.FJ);a.processAction(L.a.refresh,2)}}Object(n.a)(pA,"ToggleRibbonUXActor",null,[365]);class jO extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.G4e=b;this.Ebb=c}}Object(n.a)(jO,"UndoRedoEventArgs",Sys.EventArgs,[]);class kO{constructor(a,
b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){this.ia=a;this.gf=b;this.pa=c;this.Fa=f;this.xt=l;this.z7c=w;this.Tek=H;this.sRg=U;this.tE=ja;this.Qfb=wa;this.hJ=Sa;this.I$j=eb;this.je=Ub}wb(){this.ia.ra(L.a.GZa,nc.a.application,Object(F.a)(this,this.xbg,"handleUndoRedo"),4);this.ia.ra(L.a.FZa,nc.a.application,Object(F.a)(this,this.xbg,"handleUndoRedo"),4)}Ee(){const a=this.Fa.Fc(Lb.a.hj);a.CIc(x.KeyInputManager.Oa(A.a.Gmb,x.KeyInputManager.Oe),L.a.GZa,()=>!0);a.bindAction(x.KeyInputManager.Oa(A.a.Vvc,x.KeyInputManager.Oe),
L.a.FZa)}xbg(a,b,c,f,l){b=!0;a===L.a.FZa&&(b=!1);if(this.gf.$c(this.sRg)||!this.qil(b,l))return 16;if(!this.ril())return this.xt.zoa(),16;if(1===c)return 32;if(c=!this.xt.WMj(b))this.pa.jj(),this.d3k();f=this.xt.ESc(b);(l=this.hJ.Z5(f))&&Rc.a.Ak("UndoRedoActionName",l);this.Qfb.Sed(!c);this.je.rRk(new jO(a,f,b));(f=this.xt.a7d(b))&&f.r6!==ia.a.nil&&Rc.a.Ak("UndoRedoRevision",Rc.a.h$a(f.r6.toString()).toString());this.I$j.Sed(f,l,b);if(b?!this.xt.undo():!this.xt.redo())return ka.ULS.sendTraceTag(512499928,
801,10,"User perform {0} failed!!",a===L.a.undo?"undo":"redo"),8;c&&this.gf.hw(this.sRg,a);return 32}qil(a,b){a&&!this.xt.SW&&b&&ka.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.xt.Yab());return(a?this.xt.SW:this.xt.Bka)&&!(this.Fa.Ae&&this.Fa.Ae.name===Lb.a.VQd)&&this.sil()}ril(){return this.z7c||!this.VPj()}VPj(){return!this.Tek.TDa&&!!this.tE.instance&&this.tE.instance.RTj()}sil(){return!this.WPj()}WPj(){const a=this.pa.kp();return a?a.iy:
!1}d3k(){const a=this.Fa.Ae;!a||a.name!==Lb.a.sg&&a.name!==Lb.a.Ana||this.Fa.Ed()}}Object(n.a)(kO,"UndoRedoActor",null,[365]);class lO{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af,Zf,lg,Tg,Ug,ag,ih,Vg,di,Si,rj,sg,Cg){this.MGa=this.Tva=this.$$c=null;this.ZDb=0;this.JAg=this.gxe=!1;if(Ub.Ln&&!Cg)throw Error.argumentNull("sorterViewActorLazy");this.uE=w;this.ia=a;this.TBb=b;this.Fa=c;this.Pg=f;this.pa=l;this.gf=H;this.qe=U;this.Vb=ja;this.ua=wa;this.Tb=Sa;this.Pic=eb;this.Qb=
ub;this.la=Ub;this.Pu=cc;this.Xa=Fc;this.yz=Ic;this.Ge=Cc;this.$Xa=Ud;this.ZIg=je;this.Iv=Vd;this.zb=Ve;this.Ds=af;this.c8c=Zf;this.fDg=Ub.Vjg;this.Lc=lg;this.Dcb=Tg;this.To=Ug;this.Hc=ag;this.Ub=ih;this.Fb=Vg;this.LO=di;this.Rb=Si;this.zH=rj;this.Bw=sg;this.cYa=Cg;this.vsi()}wb(){this.ia.ra(L.a.kJb,nc.a.application,Object(F.a)(this,this.kJb,"queryEdit"),96);this.ia.ra(L.a.NJb,nc.a.application,Object(F.a)(this,this.NJb,"querySorterView"),96);this.ia.ra(L.a.MJb,nc.a.application,Object(F.a)(this,this.MJb,
"querySlideInformation"),96);this.ia.ya(L.a.hld,nc.a.application,Object(F.a)(this,this.Ytl,"switchToReadingMode"));this.ia.ya(L.a.yNb,nc.a.application,Object(F.a)(this,this.csl,"startSlideShowFromBegnning"));this.ia.ya(L.a.TIb,nc.a.application,Object(F.a)(this,this.TIb,"present"));this.ia.ya(L.a.Yhb,nc.a.application,Object(F.a)(this,this.Yhb,"presentDropDown"));this.ia.ya(L.a.$lc,nc.a.application,Object(F.a)(this,this.$lc,"playFromBeginningTopBar"));this.ia.ya(L.a.Vya,nc.a.application,Object(F.a)(this,
this.Vya,"startSlideShowFromCurrentSlide"));this.ia.ya(L.a.Zvb,nc.a.application,Object(F.a)(this,this.Zvb,"forceClose"));this.ia.ya(L.a.Ufa,nc.a.application,Object(F.a)(this,this.Ufa,"rehearsePresentation"));this.ia.ya(L.a.zoc,nc.a.application,Object(F.a)(this,this.zoc,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.ya(L.a.TOc,nc.a.application,Object(F.a)(this,this.TOc,"enableSubtitlesKeyboardShortcut")),this.ia.ya(L.a.SOc,nc.a.application,Object(F.a)(this,this.SOc,
"enableLivePresenterKeyboardShortcut")));this.t7h();this.ia.ya(L.a.nLa,nc.a.application,Object(F.a)(this,this.nLa,"showEditTriPaneView"));this.Qb.ka("PPTSorterViewEnabled")&&(this.gxe=this.Qb.ka("FeedbackPaneExperienceIsEnabled")&&this.Qb.ka("HelpTabIsEnabled"),this.ia.ya(L.a.w0b,nc.a.application,Object(F.a)(this,this.w0b,"closeEditTriPaneView")));this.la.ZZc&&this.$Xa.WEj(u.AFrameworkApplication.buildVersion,this.Xa.qk,u.AFrameworkApplication.userSessionId,this.Hc)}Ee(){if(this.Qb.ka("SlideShowByShortcutEnabled")){const a=
this.Fa.Fc(E.AFrame.hj);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Ovc,x.KeyInputManager.Oe|4),L.a.Vya);E.AFrame.lk(a,x.KeyInputManager.Oa(A.a.Ovc,x.KeyInputManager.Oe),L.a.yNb)}}t7h(){this.ia.ya(L.a.DZa,nc.a.application,Object(F.a)(this,this.DZa,"presentLive"));this.ia.ya(L.a.Tmc,nc.a.application,Object(F.a)(this,this.Tmc,"presentLiveTopBar"));this.ia.ya(L.a.EZa,nc.a.application,Object(F.a)(this,this.EZa,"presentLiveSetAccessControlAnyone"));this.ia.ya(L.a.Smc,nc.a.application,Object(F.a)(this,this.Smc,
"presentLiveSetAccessControlOrganization"));this.ia.ra(L.a.CJb,nc.a.application,Object(F.a)(this,this.CJb,"queryPresentLiveAccessControlAnyone"),96);this.ia.ra(L.a.DJb,nc.a.application,Object(F.a)(this,this.DJb,"queryPresentLiveAccessControlOrganization"),96);Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.J3("L_PublicLivePresentations",!0).then(b=>{b||(va.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),
this.ia.RJ(L.a.EZa,Cb.a.application,Object(F.a)(this,this.EZa,"presentLiveSetAccessControlAnyone")),Pc.App.Kb.G1a(L.a.EZa,Object(F.a)(new Dp,(new Dp).XDa,"getCommandById")));return null},b=>{va.a.J(512499925,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}MJb(a,b,c,f,l){a=(a=this.ua.Ba)?a.me+1:0;a=(b=this.Tb.qj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[Fp.a.Value]=a;l[hm.a.labelText]=a;return 32}kJb(a,b,c,f,l){this.Fb&&0!==
this.Fb.Fl?l.Lf(!1):l.Lf(!0);return 32}NJb(a,b,c,f,l){(a=Object(qa.a)(Xh.a,l))&&(1!==this.Fb.Fl?a.Lf(!1):a.Lf(!0));return 32}nLa(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Fb.Fl&&(va.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Fb.Fl=0,this.Rb&&(this.Rb.slidePane.Ql(),this.la.Ln||this.Rb.thumbnailPane.Ql(),this.Rb.notesPane.Ql(),this.zH&&this.zH.setVisibility(!0)),this.ia.processAction(L.a.zjb,2),this.ia.processAction(L.a.Htb,2),this.LO.e6("PptEditingStatusBar.Notes",!0),
this.LO.e6("PptEditingStatusBar.ZoomScale",!0),this.LO.e6("PptEditingStatusBar.FitToWindow",!0),this.gxe?this.LO.e6("PptEditingStatusBar.GiveFeedbackPane",!0):this.LO.e6("PptEditingStatusBar.GiveFeedback",!0),this.Lc.Gy(new Xp.a(2)),this.Lc.Gy(new Xp.a(1)),this.la.Ln||this.Pg.rI(Lb.a.YE),this.Pg.rI(Lb.a.Ana),this.Pg.rI(Lb.a.sg),this.Pg.rI(Lb.a.kQ))}catch(f){va.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}w0b(a,b,c){try{if(1===c)return 32;2===c&&(this.Rb&&
(this.Rb.slidePane.Cr(),this.Rb.thumbnailPane.Cr(),this.Rb.notesPane.Cr(),this.zH&&this.zH.setVisibility(!1)),this.LO.e6("PptEditingStatusBar.Notes",!1),this.LO.e6("PptEditingStatusBar.ZoomScale",!1),this.LO.e6("PptEditingStatusBar.FitToWindow",!1),this.gxe?this.LO.e6("PptEditingStatusBar.GiveFeedbackPane",!1):this.LO.e6("PptEditingStatusBar.GiveFeedback",!1),this.Lc.Gy(new Xp.a(2)),this.Lc.Gy(new Xp.a(1)),this.la.Ln||this.Pg.Lo(Lb.a.YE),this.Pg.Lo(Lb.a.Ana),this.Pg.Lo(Lb.a.sg),this.Pg.Lo(Lb.a.kQ),
this.pa.Rh())}catch(f){va.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",f)}return 32}Ytl(a,b,c){if(this.gf.$c(this.Vb.xf))return 16;if(1===c)return this.ua.Ba?32:16;b=(new Date).getTime();let f=ig.a.Ni(window.document.URL,be.a.c$g,be.a.readingView,!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");c=this.ua.Ba.Cb;f=ig.a.Ni(f,be.a.Nlc,c?c.sid.toString():"",!0);f=this.TBb.instance&&this.TBb.instance.isVisible?ig.a.Ni(f,be.a.b$g,"1",!0):ig.a.removeParameter(f,
be.a.b$g,!0);this.usi();f=ig.a.Ni(f,u.AFrameworkApplication.Edd,b.toString(),!0);this.pa.Rh();this.Fa.Ed();this.Pu.show(!0,a);this.uE.C3(!1,!0,()=>{this.hzh(f)},()=>{va.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.hzh(f);return!0});return 32}hzh(a){this.Pic.openWindow(1,a,!1)||this.Pu.hide()}TIb(a,b,c){return this.Wkb(a,c,null)}Yhb(a,b,c){return this.Wkb(a,c,null)}$lc(a,b,c){return this.Wkb(a,c,null)}csl(a,b,c){return this.Wkb(a,c,null)}Vya(a,b,c){return this.Wkb(a,
c,this.ua.Ba?this.ua.Ba.Cb:null)}Wkb(a,b,c,f=!1,l=!1){if(!this.la.ZZc)return this.Jrl(a,b,c);if(this.gf.$c(this.Vb.xf)||!this.Tb.qj()||this.la.preventDuplicateSlideShowLaunches&&this.$Xa.tac()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.$Xa.jde)return 16;if(1===b)return 32;this.la.Nig&&!Pd.a("DummyChangeGateForTest")&&va.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.Bw.hasDeferredContent()&&va.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");
this.bsl(c,f,l);return 32}bsl(a,b,c){this.ZDb=(new Date).getTime();this.pa.Rh();this.Fa.rf(Lb.a.ND);this.Lc.Hfh();va.a.J(512499918,830,50,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.$Xa.jde);const f=a?a.sid:-1;a=(a=a?Object(qa.a)(115,this.Tb.uEa(a.sid)):null)?a.me+1:-1;let l=!1;this.To.instance?l=this.To.instance.m_?!0:!1:va.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.$Xa.Srd(f,a,b,this.Qb.Ga("361"),this.Xa.qk,this.Xa.podSessionId,
this.Qb.Ga("387"),u.AFrameworkApplication.userSessionId,this.la.QTj,this.ZDb,l,this.Xa,c);this.$Xa.Fia(Object(F.a)(this,this.ufd,"onExitSlideshowHandler"));this.yz.Yol()}zoc(a,b,c,f){return this.Ufa(a,b,c,f,{entryPoint:4})}Ufa(a,b,c,f,l){switch(c){case 2:if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.La(L.a.tsc,2,b),this.Hc&&(this.Hc.DDa=!1),this.Ub&&this.Ub.instance&&(this.Ub.instance.DDa=
!1));return this.$Xa.tac()?(this.Hc&&(this.Hc.Lh=!1),32):this.Wkb(a,c,this.ua.Ba.Cb,!0);case 1:if(0<this.Tb.qj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===this.ia.processAction(L.a.rLa,1)&&32===this.ia.processAction(L.a.tsc,1))return 32;break}else return this.ia.processAction(L.a.rLa,1);else break;default:va.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}TOc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Hc)return this.Hc.DDa=
!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:va.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}SOc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Ub&&this.Ub.instance)return this.Ub.instance.DDa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:va.a.J(512499914,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}Tmc(a,
b,c,f,l){return this.DZa(a,b,c,f,l)}DZa(a,b,c){if(this.JAg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){va.a.J(512499913,833,10,"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.M8a?0<this.Tb.qj()?32:8:8;this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&(this.Ub.instance.CDa=!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");return this.Wkb(a,
c,this.ua.Ba.Cb,!1,!0)}EZa(a,b,c){if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.M8a?32:8;this.Ub.instance.dr&&0!==this.Ub.instance.accessControl?this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.C3b(5);this.Ub.instance.accessControl=0;this.Lc.Gy(new Xp.a(1))},()=>{}):(this.Ub.instance.accessControl=0,this.Lc.Gy(new Xp.a(1)));return 32}Smc(a,b,c){if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.M8a&&this.Ub.instance.mVf?32:
8;this.Ub.instance.dr&&1!==this.Ub.instance.accessControl?this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.C3b(5);this.Ub.instance.accessControl=1;this.Lc.Gy(new Xp.a(1))},()=>{}):(this.Ub.instance.accessControl=1,this.Lc.Gy(new Xp.a(1)));return 32}CJb(a,b,c,f,l){try{const w=Object(qa.a)(Xh.a,l);w&&this.Ub.instance&&w.Lf(0===this.Ub.instance.accessControl)}catch(w){va.a.J(512499912,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",w)}return 32}DJb(a,
b,c,f,l){try{const w=Object(qa.a)(Xh.a,l);w&&this.Ub.instance&&w.Lf(1===this.Ub.instance.accessControl)}catch(w){va.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",w)}return 32}Jrl(a,b,c){if(this.gf.$c(this.Vb.xf))return 16;if(1===b)return this.Tb.qj()?32:16;this.ZDb=(new Date).getTime();this.pa.Rh();this.Fa.rf(Lb.a.ND);this.Lc.Hfh();this.Pu.show(!0,a);this.uE.C3(!1,!0,()=>{this.poh(c,this.ZDb)},()=>{va.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");
this.poh(c,this.ZDb);return!0});return 32}ufd(a,b){a=((new Date).getTime()-this.ZDb).toString();va.a.J(512499909,830,50,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",a,this.Bw.hasDeferredContent(),this.Bw.vce(b.slideId.toString()));this.Bw.hasDeferredContent()||this.Bw.vce(b.slideId.toString())?this.Bw.wra("DeferredExitSlideshowDuration",a):this.Bw.wra("ExitSlideshowDuration",a);this.$Xa.Wfa(Object(F.a)(this,
this.ufd,"onExitSlideshowHandler"));(this.Tva=b)&&!this.Tva.dLj&&!this.Tva.aPj&&0<this.Tva.slideId&&0<=this.Tva.slideIndex&&this.Pok(this.Tva.slideId,this.Tva.slideIndex);this.Fa.Ed();this.fDg?(this.MGa=Rc.a.zk("ExitSlideshow"),this.gf.blockContent(this.Vb.xf,"ExitSlideshow"),this.ZIg.kk(Object(F.a)(this,this.L5g,"onPageManifestNodePropertyChanged")),this.MGa.Va("UnlockPodsSessionStartTime",Rc.a.mf(new Date)),this.unlockPodsSession(c=>{this.MGa&&(this.MGa.Va("UnlockPodsSessionWithMerge",c.toString()),
this.MGa.Va("UnlockPodsSessionEndTime",Rc.a.mf(new Date)));c?this.Iv.O0i():this.kTe()})):this.kTe()}kTe(a=null){a&&(this.$$c=null);this.Tva&&(this.fDg&&(this.ZIg.Rm(Object(F.a)(this,this.L5g,"onPageManifestNodePropertyChanged")),this.gf.hK(this.Vb.xf),this.MGa&&(this.MGa.Va("InboundPresentationEndTime",Rc.a.mf(new Date)),this.MGa.finish(),this.MGa=null)),this.Tva=null,this.yz.K4k())}unlockPodsSession(a){const b=gh.a.create().toString();va.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",
b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",u.AFrameworkApplication.fa.appSettings["361"],this.Xa.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Xa.qk;this.Xph(c,f,0,a)}Xph(a,b,c,f){this.Ds.nj(a,2,null,b,!1,2,l=>{this.UCl(l,c,f)},l=>{this.yGh(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,Jx.a("2"))}UCl(a,b,c){if(b)va.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",
b);else{b=!1;try{a.data.Wd&&0<a.data.Wd.length&&(b=JSON.parse(a.data.Wd).FMerged)}catch(f){va.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",a.toString())}c(b)}}yGh(a,b,c,f,l){f||l(!1);3>f?this.Xph(b,c,f+1,l):va.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.c8c.hka(a),f)}L5g(a,b){this.$$c||b.property!==hb.a.R8b||(this.$$c=new Le.a(2,1,0,Object(F.a)(this,this.kTe,
"resumeEditor"),90,"65"),this.zb.Db(this.$$c))}poh(a,b){this.Pu.hide();let c=!0,f=!1,l=this.qe.slideShowUrl;l||(l=ig.a.Ni(window.document.URL,be.a.c$g,be.a.slideShowView,!0),f=!0);l=ig.a.removeParameter(l,be.a.BDk);l=a?ig.a.Ni(l,be.a.Nlc,a.sid.toString(),!0):ig.a.removeParameter(l,be.a.Nlc);0<b&&(l=ig.a.Ni(l,u.AFrameworkApplication.Edd,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);
b=null;try{b=this.Pic.RJe(4,l,"SlideShowWindow",a,f,!1)}catch(w){va.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",w),c=!1}b||(va.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),c=!1);Rc.a.Ak("Window Opened",c.toString());Rc.a.fud()}Zvb(a,b,c){if(2!==c)return this.ia.processAction(G.a.close,c);a=this.ia.processAction(G.a.close,2);32!==a&&(va.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location=
"about:blank");return 32}Pok(a,b){va.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Tb.uEa(a))?this.la.Ln?this.cYa.value.IJ(a.me):this.Ge.IJ(a.me):(va.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",b),a=this.Tb.qj()-1,b=b>a?a:b,0>b||(this.la.Ln?this.cYa.value.IJ(b):this.Ge.IJ(b)))}usi(){this.Dcb.instance&&this.Dcb.instance.BUa&&(this.Dcb.instance.HMc.uC?this.Dcb.instance.endCommentSession(this.Dcb.instance.HMc.uC.draftId,
7):this.Dcb.instance.endCommentSession("",7),this.Dcb.instance.Stf())}vsi(){this.la.powerPointLiveBroadcastEnabled&&Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",!1).then(b=>{b||(va.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),this.JAg=!0);return null})})}}Object(n.a)(lO,"ViewSwitchingActor",null,[365]);class mO{constructor(a,b){this.Cre=null;this.Xa=a;this.hna=
b;this.YAf();this.Xa.lvf(Object(F.a)(this,this.Ggd,"onSessionInfoChanged"))}YAf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Xa.presentationId.string));a.append(String.format("&{0}={1}",be.a.x$k,this.Xa.gvb));a.append(String.format("&{0}={1}",be.a.Tna,"368"in u.AFrameworkApplication.fa.appSettings?void 0===this.Xa.sessionInfo||null===this.Xa.sessionInfo?"undefined":this.Xa.sessionInfo:this.Xa.sessionInfo));this.Xa.qk&&a.append(String.format("&{0}={1}",be.a.d$g,this.Xa.qk));this.Xa.podSessionId&&
a.append(String.format("&{0}={1}",be.a.iaa,this.Xa.podSessionId));this.Cre=a.toString()}Ggd(){this.YAf()}resolve(a,b,c){if(!b||!b.length)return null;if(b.startsWith("./"+a))return b;const f=Pd.a("FixInvalidOperationErrorInEditImageHandler")?encodeURIComponent(b):b;return c?this.hna+a+this.Cre+`&cl=${c}&${be.a.$9g}=${f}`:this.hna+a+this.Cre+String.format("&{0}={1}",be.a.$9g,b)}dispose(){this.Xa.L_k(Object(F.a)(this,this.Ggd,"onSessionInfoChanged"))}}Object(n.a)(mO,"ResourceViewElementResolver",null,
[1170,106]);var KR=d(1047),LR=d(960);class nO{constructor(a,b){this.e3c=this.w4=0;this.tGg=null;this.uGg=-1;this.vGg=null;this.dva=a;this.Cc=b}get Jje(){return 0<this.e3c}get wpg(){return this.tGg}xsk(a){this.e3c++;this.Cc.fzh(a.CcpId,a.CcpCorrelation)}get One(){return this.vGg}set One(a){this.vGg=a}k2g(a,b){if(!a){const c=this.kpj(b);c>this.uGg&&(this.uGg=c,this.tGg=b.CcpId)}0<this.e3c?this.e3c--:va.a.J(20760084,307,15,"ClipServiceManager - bad state");this.Cc.ASf(b.CcpId,a,0)}PLc(a,b,c=!1,f=!1){a=
Object.assign(new LR.a,{xW:32,Jp:gh.a.create().toString(),version:this.w4++,location:this.dva.ccpInfo,tD:this.dva.qk||Ep.a.zKh,dataType:a,objectCount:b,mFa:c,kFa:f,Cy:gh.a.create().toString()});va.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}kpj(a){let b=null;a:{var c=a.PackageAccessKey;let l;l=null;if(c)try{const w=Jc.a(c);if(w&&"I"in w&&"V"in w){l=new ht(w.I,parseInt(w.V));var f={returnValue:!0,Cy:l};break a}}catch(w){}f={returnValue:!1,
Cy:l}}if(({Cy:b}=f).returnValue&&b)return b.version;va.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(n.a)(nO,"ClipServiceManager",null,[1159]);class oO{constructor(a,b,c,f,l,w,H,U,ja){this.Vg=a;this.eec=c;this.JFb=f;this.Kqe=l;this.Lr=w;this.Cc=H;this.y0=U;this.ia=ja;this.Bl=b;this.nea=this.Vg.contentWindow.document.body;this.Lr.addHandler(this.nea,sa.a.cut,Object(F.a)(this,this.Z2g,"onBrowserCut"));this.Lr.addHandler(this.nea,sa.a.copy,Object(F.a)(this,
this.Y2g,"onBrowserCopy"))}get Ic(){return this.eec.Ic}dispose(){this.Vg&&this.Vg.contentWindow&&(this.Lr.removeHandler(this.nea,sa.a.cut,Object(F.a)(this,this.Z2g,"onBrowserCut")),this.Lr.removeHandler(this.nea,sa.a.copy,Object(F.a)(this,this.Y2g,"onBrowserCopy")));this.Vg=null}Z2g(){if(Xk.FA&&!Xk.FA.f3d){var a=this.Cc.hP(1,0,"OnBrowserCut");this.Fsa(Object.assign(new it(!0,!0),{Wb:a}))}}Y2g(){if(Xk.FA&&!Xk.FA.f3d){var a=this.Cc.hP(0,0,"OnBrowserCopy");this.Fsa(Object.assign(new it(!0),{Wb:a}))}}mQ(a){if((u.AFrameworkApplication.BM||
u.AFrameworkApplication.iG)&&!u.AFrameworkApplication.ORa)return!1;for(let b=0;b<this.Bl.length;b++)if(this.Bl[b].mQ(a))return!0;return!1}Fsa(a){if(this.ia.fX)this.y0?(this.y0.show(5,-1),this.Cc.Hg(!1,a.Wb,26)):va.a.J(509444690,826,10,"m_offlineModalCallout is null");else if(!u.AFrameworkApplication.BM&&!u.AFrameworkApplication.iG||u.AFrameworkApplication.ORa){var b=0,c=!1;for(var f=0;f<this.Bl.length;f++)if(this.Bl[f].mQ(a)){c=!0;this.Bl[f].Fsa(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;
case 1:f=19;break;default:f=0}this.Cc.NB(f,a.Wb);if(c){if(a.jig&&(this.Kqe.Q_a(this.Vg),!a.JWi)){if(!this.JFb){this.Cc.Hg(!1,a.Wb,1);return}this.JFb.copy(this.Vg)||0!==b||(b=22)}this.Cc.Hg(0===b,a.Wb,b)}else this.Cc.Hg(!1,a.Wb,20)}else this.Cc.Hg(!1,a.Wb,32)}}Object(n.a)(oO,"CutCopyManager",null,[1155,106]);var MR=d(911);class pO{constructor(a,b,c){this.aY=a;this.aY.kk(Object(F.a)(this,this.ph,"onPropertyChanged"));this.lM=b;this.lM.kk(Object(F.a)(this,this.ph,"onPropertyChanged"));this.Jq=c}ph(a,
b){this.Jq.Yq&&0<this.Jq.Yq.length&&(this.Jq.Yq=Qa.a.zpa(this.Jq.Yq,c=>!(ia.a.WP(c.id,b.node.id)||Object(Ya.a)(Pv.a,c))));this.Jq.Yq&&!this.Jq.Yq.length&&(this.Jq.Yq=null)}}Object(n.a)(pO,"GraphNodeChangeListener",null,[]);class qO{constructor(a,b){this.Wcc=null;a&&b&&new pO(a,b,this)}get Yq(){return this.Wcc}set Yq(a){const b=this.Wcc&&0<this.Wcc.length?this.Wcc[0]:null,c=a?a[0]:null,f=!!b&&!!c&&b.id.equals(c.id)&&b.Gwf;this.Wcc=a;c&&(c.Gwf=f,c.IGf=f&&b?b.IGf:MR.a.create().toString())}}Object(n.a)(qO,
"InternalClipboard",null,[1154]);class rO{constructor(a,b,c,f,l,w,H,U,ja,wa){this.Utg=a;this.mi=b;this.Yea=c;this.OHa=f;this.p$=l;this.Ea=w;this.Exe=H;this.ifc=U;this.sbk=ja;this.F7c=wa}PVe(a,b,c){this.Utg.PVe(a,b,c);b=new DM.a;this.Exe&&c||(b.setValue(Za.a.bold,!1),b.setValue(Za.a.underline,!1),b.setValue(Za.a.Rw,We.Font.tV),b.setValue(Za.a.strikethrough,!1),b.setValue(Za.a.italic,!1),b.setValue(Za.a.it,!1),b.setValue(Za.a.G_,!1));this.mi.$We(a,b)}dWe(a,b,c){const f=b.cache;if(this.F7c){var l=this.U8i(b);
ha.a.Wa(l)||c?f.propertySet.Sa(Za.a.font)&&(f.sa(hb.a.qZc,!1)||c)&&this.mi.YU(a,f.JN):this.mi.YU(a,l);f.Ota&&this.mi.Pq(a,f.fontSize)}else this.Utg.dWe(a,b,c);(!this.ifc||this.Exe&&c)&&f.V3&&(this.mi.Cm(a,Za.a.fontColor,f.fontColor),this.ifc&&(l=jo.SchemeColor.create(null,f.fontColor),this.mi.Cm(a,hb.a.schemeColor,l.toString())));this.Exe&&c&&(this.mi.OH(a,f.isBold),this.mi.setItalic(a,f.isItalic),this.mi.MY(a,f.PF),this.mi.Tjb(a,f.D_),this.mi.PY(a,f.hE),this.mi.Qoa(a,f.Rw),this.mi.i0a(a,f.it),this.mi.Xjb(a,
f.G_),this.mi.h6(a,f.QF),this.mi.OY(a,f.isSuperscript),this.mi.yya(a,f.jn));this.mi.i0a(a,!1);this.fel(a,b)}C8d(a){return this.Yea.dTa(a)}QW(a){return this.Yea.QW(a)}nTa(a){return this.OHa.nTa(a)}N8(a){return this.p$.N8(a)}fel(a,b){b=b.Yz;if(null!==b&&b.Sa(hb.a.lKa)){b=b.eb(hb.a.lKa);var c=a.Yz;null===c?this.mi.Cm(a,hb.a.lKa,b):c.setValue(hb.a.lKa,b)}}Avh(a){return this.sbk&&a&&(a=a.paragraph)&&(a=this.Ea.en(a))&&a.Qf?!0:!1}U8i(a){if(!this.F7c||!a)return null;let b="";var c=a.paragraph;if(!c)return null;
var f=this.Ea.en(c);if(!f)return null;a=f.sa(Va.a.W_,[]);c=c.sa(Va.a.listLevel,Jg.a.PEa);a&&0<=c&&c<a.length&&(f=f.Gh)&&(a=f.Be(a[c]))&&(a.Sa(hb.a.r_d)?b=a.eb(hb.a.r_d):a.Sa(hb.a.o_d)?b=a.eb(hb.a.o_d):a.Sa(hb.a.l_d)?b=a.eb(hb.a.l_d):a.Sa(hb.a.v_d)&&(b=a.eb(hb.a.v_d)));return b}}Object(n.a)(rO,"PPTFormattingStewardBridge",null,[1136]);class sO{constructor(a,b,c,f){this.ic=c;this.sA=f}}Object(n.a)(sO,"PPTFormattingStewardHelper",null,[1141]);class tO{constructor(a,b,c,f,l){this.aek=[Va.a.$l,Va.a.ho];
this.la=a;this.HBb=b;this.zzg=c;this.pJ=f;this.Pb=l;this.Rdb=a.Elg;this.Cva=a.pptCopyPasteListMarkerEnabled;this.bfc=a.pptCopyPasteMarginAndIndentationEnabled}W3e(a){return this.HBb.GSj(a)}Ube(a,b){return this.HBb.tUi(a,b)}Moa(a,b,c,f=null,l=null){if(this.zzg.Thd)if(this.HBb.Pig(c))a.setValue(Yd.a.Zig,!0);else if(this.HBb.el(c)){if(this.bfc&&a&&b){var w=this.Pb.Mc(a);w.rc(11);w.Jg(11);c=rb.ListReader.vk(w);const H=this.pJ.Y8i(a,w);w=this.pJ.V8i(a,w);c&&(f||(va.a.J(41219841,826,50,"Default marginLeft for internal"),
b[Va.a.$l.id.toString()]=H),l||(va.a.J(41219843,826,50,"Default textIndent for internal"),b[Va.a.ho.id.toString()]=w));f&&va.a.J(41018240,826,50,"Customized marginLeft");l&&va.a.J(41018242,826,50,"Customized textIndent")}this.zzg.Moa(a,b)}if(this.la.h_c&&!zb.ParagraphReader.cX(a))for(const H of this.aek)void 0===a.Mh(H)&&a.we(H,0)}aMb(a,b,c){if(this.Rdb){var f=b.propertySet.Sa(Za.a.Ui)?b.propertySet.eb(Za.a.Ui).length:1;if(a=this.pJ.qQ(a,b.propertySet.sa(Va.a.listLevel,0)))if(this.Cva&&(0<c.Fsb||
c.zQa&&0<c.zQa.length)){f="";b.P$a&&!b.ecg&&(f=c.font);let l=null;c.zQa&&0<c.zQa.length&&(l=c.zQa,1===c.zQa.length&&va.a.J(41219847,826,50,"Customized bullet."));let w=-1;0<c.Fsb&&(w=c.Fsb,va.a.J(41219849,826,50,"Customized number list."));this.pJ.zLc(a,b.propertySet);l&&b.propertySet.setValue(Za.a.Ui,l);ha.a.Wa(f)||b.propertySet.setValue(Za.a.font,f);0<w&&b.propertySet.setValue(hb.a.autonumberBulletType,w)}else a.sa(Za.a.Ui,[]).length===f&&this.pJ.zLc(a,b.propertySet)}}TZc(a){return this.HBb.TZc(a)}get R_c(){return this.HBb.R_c}C1(a,
b){2===b.unit?(a.setValue(hb.a.nX,2),a.setValue(hb.a.xx,b.value)):va.a.J(36779851,826,50,"the un-support text spacing unit")}cLa(a,b){b.beforeSpacing.value&&(a.setValue(hb.a.cea,b.beforeSpacing.value),a.setValue(hb.a.xla,4));b.afterSpacing.value&&(a.setValue(hb.a.aea,b.afterSpacing.value),a.setValue(hb.a.wla,4))}Esh(a,b){const c=(new nv.a(b.unit,b.value)).WM;1===b.specialIndentType?a.setValue(Va.a.ho,c):2===b.specialIndentType?a.setValue(Va.a.ho,-c):0===b.specialIndentType&&a.setValue(Va.a.ho,0)}urh(a,
b){b=(new nv.a(b.unit,b.value)).WM;a.setValue(Va.a.$l,b)}get Dvh(){return!0}}Object(n.a)(tO,"PPTPasteStewardBridge",null,[1076]);class uO extends Es{constructor(a,b){super(a,b)}f5b(){return["PasteSlide"]}}Object(n.a)(uO,"PasteSlideReactFloatie",Es,[]);class vO{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af){this.Ibg=!1;this.qR=[];this.shc=[];this.Xpe=[];this.Cse=0;this.oc=c;this.pa=f;this.Tfb=l;this.Sfb=w;this.cna=H;this.Zc=U;this.fAe=Ud;this.ld=a;this.fjk=b;this.Qk=Sa;this.Mfk=
ja;this.Vb=eb;this.Fa=ub;this.Nr=Ub;this.C$j=cc;this.u$j=Fc;this.fc=Ic;this.USg=Cc;this.Qb=je;this.q$c=Vd;this.Vg=af;this.Ecb=Ab.a.instance.rb("Common.IReactContextualUILauncher");this.uCb=Ab.a.instance.rb("Common.IExternalUICommandDefinitionMapping")}G5(a){2===a.behavior&&(a=a.actionId,a!==L.a.iw&&a!==L.a.nCa&&a!==L.a.vna&&a!==L.a.C5&&a!==L.a.cja&&a!==L.a.iQ&&a!==L.a.insertPicture&&a!==L.a.vna&&a!==L.a.eta&&a!==L.a.m5d&&a!==L.a.l5d&&a!==L.a.insertPicture&&a!==L.a.dRc&&a!==L.a.eRc&&a!==L.a.CLe&&a!==
L.a.Vhd||this.tC(null,new mc(!0)))}F5(){}u8h(){this.fAe&&!this.Ibg&&(this.pa.KG(Object(F.a)(this,this.mY,"onSelectionChange")),this.fjk.xd(7).wF(Object(F.a)(this,this.FB,"onChildTopologyChanged")),this.ld.VBa(Object(F.a)(this,this.uY,"onThumbnailDrawCompleted")),Yc.a.addHandler(this.cna.IU,"scroll",Object(F.a)(this,this.L_a,"scrollHandler")),Yc.a.addHandler(this.Vg.contentWindow.document.body,sa.a.Xf,Object(F.a)(this,this.onKeyDown,"onKeyDown")),this.Zc.pb(sa.a.click,this.cna.IU,Object(F.a)(this,
this.lC,"clickHandler")),u.AFrameworkApplication.Aa.mca(Object(F.a)(this,this.o1,"resizeHandler")),this.Mfk.n6a(Object(F.a)(this,this.X0,"onSlidePresenceChanged")),this.Qk.svf(Object(F.a)(this,this.pJe,"onSlidesIdReturned")),this.C$j.l6a(Object(F.a)(this,this.Cgd,"onRevisionProcessedOnServerHandler")),this.u$j.U$h(Object(F.a)(this,this.Gsk,"onBlockingHandler")),this.q$c.bQd(Object(F.a)(this,this.Zwk,"onOnlyKeyPressed")),this.Ibg=!0)}Zwk(){if(HC.a.instance.keyCode===A.a.cba){const c=document.getElementById("PasteSlideControl");
if(c){var a=Kd.a.ai(c),b=this.USg.xa.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Uz.a.J4e?va.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(Bc.a.y6a)||"",Bc.a.Nia===a&&c.click())}else va.a.J(512497816,826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===A.a.X1&&this.tC(null,new mc(!0))}Gsk(a,b){1===b.block?this.tC(a,null):2===b.block&&this.tC(a,new mc(!0))}Cgd(a,b){b&&(a=b.MH)&&a.ActionInformation.ActionId!==""+L.a.Rlc&&a.ActionInformation.ActionId!==
""+L.a.hIb&&a.ActionInformation.ActionId!==""+L.a.Xhd&&this.Nr.J1c&&this.Nr.J1c<parseInt(a.ActionInformation.ActionTime)&&this.tC(null,new mc(!0))}X0(a,b){this.UWf(b.slideId.sid,this.qR)&&(this.tC(null,new mc(!0)),this.Nr.Ckb=!1)}UWf(a,b){for(const c of b)if(c.sid===a)return!0;return!1}pJe(a,b){if(b&&b.RYa){if(this.Xpe.length>=b.RYa.length&&!this.Ecb.Bzb&&(this.setSelection(b.RYa),this.qR.length===b.RYa.length)){this.showFloatie({},new Vi(1,u.AFrameworkApplication.isRtl));let c;(c=this.pa).j6a.apply(c,
this.qR)}this.Nr.GJa.length||(this.Nr.GJa=b.RYa,Array.clear(this.qR),Array.clear(this.shc))}}mY(a,b){if(this.Nr.Ckb){for(a=0;a<b.EE.length;a++)if(Object(qa.a)(4,b.EE[a].context.node)){this.tC(null,new mc(!0));return}!this.Fa.Ae||this.Fa.Ae.name!==Zi.a.Y2&&this.Fa.Ae.name!==Zi.a.aCf&&this.Fa.Ae.name!==Zi.a.YBf&&this.Fa.Ae.name!==Lb.a.ME&&this.Fa.Ae.name!==Lb.a.SI&&this.Fa.Ae.name!==Lb.a.KW||this.tC(null,new mc(!0))}}o1(){this.Ecb.Bzb&&this.tC(null,new mc(!1))}L_a(){this.rgh()}lC(){this.rgh();return!0}rgh(){if(this.Nr.Ckb){const a=
new Vi(1,u.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}uY(a,b){a=this.Nr.GJa;this.Xpe.push(b.Fd);if(!this.Ecb.Bzb&&this.Nr.Ckb&&a&&a.length>=this.shc.length&&b.succeeded)for(var c of a)if((b=this.oc.zl(new N.a(c)))&&!this.UWf(b.sid,this.shc)&&(this.shc.push(b),this.Cse++,b=a.length,this.Cse===b)){this.pa.Lub();this.setSelection(a);var f=void 0;(f=this.pa).j6a.apply(f,this.qR);if(c=this.gaj())this.Vb.Ba=c;this.Cse=0;c=!0;for(f=0;f<b;f++)(a=this.qR[f].ng(this.Tfb))&&a.Whb&&a.Whb.P8()&&0<
a.Whb.P8().length&&(c=!1);c&&this.showFloatie({},new Vi(1,u.AFrameworkApplication.isRtl));break}}gaj(){let a=this.qR.length;if(!a&&(this.setSelection(this.Nr.GJa),a=this.qR.length,!a))return va.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;let b=this.qR[0];for(let c=1;c<a;c++)b.slideIndex>this.qR[c].slideIndex&&(b=this.qR[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.qR);for(const b of a)(a=this.oc.zl(new N.a(b)))?this.qR.push(a):va.a.J(512497813,826,
50,"Cannot find the slide")}}Hcj(){let a=this.qR.length;if(!a&&(this.setSelection(this.Nr.GJa),a=this.qR.length,!a))return va.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;va.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",a));let b=this.qR[0];for(let c=1;c<a;c++)b.slideIndex<this.qR[c].slideIndex&&(b=this.qR[c]);return b}showFloatie(a,b){b.location=this.Xwb();if(b.location){const c=this.fc.$c(this.oc.$m);if(!c||c&&a)va.a.J(512497810,826,50,"ShowFloatie number"),
this.Qb.ka("ReactSlidePasteFloatieEnabled")&&(new uO(this.Ecb,this.uCb)).cZe(b.location,b.Iu),Array.clear(this.Xpe)}}tC(a,b){this.Ecb.Bzb&&(this.Ecb.tC(),b&&(this.Nr.Ckb=!b.Y3d,b.Y3d&&this.Nr.whb&&(a=this.Nr.whb.AA,null!=a&&va.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",a.toString()))),this.Nr.Ckb||(this.Nr.J1c=0)))}rxi(a){if(!this.Nr.e2b)return!0;a=a.cK;if(a.length!==this.Nr.e2b.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.Nr.e2b[c])||!a[c]&&
this.Nr.e2b[c])if(b++,b>this.shc.length)return!0;return!1}FB(a,b){this.Ecb.Bzb&&(a=Object(qa.a)(532,b.node))&&this.rxi(a)&&this.tC(null,null)}Xwb(){var a=this.Hcj();if(!a)return va.a.J(512497808,826,50,null),null;a=a.ng(this.Tfb);if(!a)return va.a.J(512497807,826,50,null),null;a=Kd.a.ai(a.zlb);const b=a.x+a.width-86;let c=a.y+a.height+61+2;const f=this.Sfb.xa.style.height;var l=this.USg.xa.style.height;l=parseInt(l.substr(0,l.length-2))+Uz.a.J4e;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/
2-2;else if(c<l)return this.tC(null,new mc(!1)),null;this.Nr.position=new Sys.UI.Point(b,c);return this.Nr.position}}Object(n.a)(vO,"PasteFloatieHelper",null,[1140,145]);class XE{constructor(){this.Ckb=!1;this.J1c=0;this.whb=null;this.DKe=0;this.Keb=[];this.position=this.e2b=null}get GJa(){return this.Keb}set GJa(a){a?this.Keb=a:Array.clear(this.Keb)}}Object(n.a)(XE,"PasteFromFloatieArgs",null,[]);var NR=d(1045);class wO{z9b(a){a=a.m8;return a===Lb.a.sg||a===Lb.a.YE||a===Lb.a.PB}}Object(n.a)(wO,"PasteHandlerUtil",
null,[1157]);class xO{constructor(a,b,c,f,l,w){this.ZT=0;this.ia=a;this.R4=b;this.PHa=c;this.zx=f;this.aDb=l;this.Uak=w}mQ(a){if(!this.PHa.z9b(this.R4.value))return!1;if(this.zx.YKj(a)){a=Array.isArray(a.WW)?a.WW:null;if(this.Yyj(a)&&!this.vzj(a))return!1;this.ZT=1}else if(this.aDb&&(this.zx.WKj(a)||this.zx.VKj(a))){a=this.zx.Lje(a.Du);if(!this.Uak&&a)return ka.ULS.sendTraceTag(36558551,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),this.ZT=0,!1;this.ZT=2}else this.ZT=0;return 0!==
this.ZT}paste(a){1===this.ZT?this.ia.La(L.a.Uhd,2,a):2===this.ZT&&this.ia.La(L.a.G$g,2,a)}Yyj(a){for(const b of a)if(!b.isConnected)return!0;return!1}vzj(a){for(const b of a)if(a=b.shapeNode,!a.Hj&&!a.ud)return!0;return!1}}Object(n.a)(xO,"ShapePasteHandler",null,[1207]);class yO{constructor(a,b,c){this.ZT=0;this.ia=a;this.zx=b;this.SWa=c}mQ(a){this.zx.Bhg(a)?this.ZT=1:this.SWa&&this.zx.XKj(a)?this.ZT=2:this.ZT=this.zx.$Kj(a)?3:0;return 0!==this.ZT}paste(a){a.AA=null!=a.AA?a.AA:!0;Pd.a("UseClipServiceForDestinationThemePaste")&&
1===this.ZT&&!a.AA&&a.Du&&(this.ZT=2);1===this.ZT?this.ia.La(L.a.Vhd,2,a):2===this.ZT?(a.Du?va.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.AA):va.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),this.ia.La(L.a.Xhd,2,a)):3===this.ZT&&this.ia.La(L.a.I$g,2,a)}}Object(n.a)(yO,"SlidePasteHandler",null,[1207]);class YE{constructor(a,b,c,f){this.Wwg=[gf.a.Sdg,gf.a.fOb,gf.a.JBh,gf.a.Jsd];this.ia=a;this.Fa=b;this.PHa=
c;this.zx=f}mQ(a){if(!this.PHa.z9b(this.Fa)||YE.$Sj(a)||this.zx.tYj(a))return!1;a.mQ=!this.wAi(a.Bm);return a.mQ}wAi(a){for(let b=0;b<this.Wwg.length;++b)if(0<a.getElementsByTagName(this.Wwg[b]).length)return!0;return!1}paste(a){va.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");this.ia.La(L.a.GKe,2,a)}static $Sj(a){if(!a||!a.Bm)return va.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),!0;a=Fb.b(a.Bm);return a&&a.length?!1:(va.a.J(17310406,
826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(n.a)(YE,"TextPasteHandler",null,[1207]);var OR=d(889),PR=d(962),QR=d(443),qA=d(681);class zO{constructor(a,b){this.yxa=a;this.pastedContent=b}}Object(n.a)(zO,"PasteContext",null,[]);class AO{constructor(a){this.Aye=0;this.SFb=null;this.iik=a;this.Jfb=this.iik.nGb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.Jfb.start()}LYb(a){if(a&&0<a.length){this.SFb||(this.SFb={});const b=this.Jfb.Vq;this.SFb[a]=
b-this.Aye;this.Aye=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.SFb){a=this.SFb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&va.a.J(20570128,826,50,b);this.reset()}reset(){this.Aye=0;this.SFb=null}}Object(n.a)(AO,"TimingLogger",null,[]);class $p{constructor(){this.objectCount=0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=null;this.skipUndo=!1;this.selectionSlide=null}static OGi(a){if(!a)return null;
a=a.getData($p.hni);return $p.Veg($p.mgh(a))}static PGi(a){return a?$p.Veg($p.mgh(a.pptSlide)):null}static Veg(a){if(!a||0===a.contentType)return va.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/$p.cni:Number.MAX_VALUE;a.skipUndo=!1;va.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",a.ccpid,a.dataSize,a.objectCount,a.errorInCopying);return a}static zYj(a){return!!a&&
0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static mgh(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if($p.zYj(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){va.a.J(541405765,826,15,"ReadPicklingData exception occured in parsing")}return null}}$p.cni=1048576;$p.hni="ppt/slides";Object(n.a)($p,"PicklingClipboardObject",null,[]);var RR=d(683);class Gg{constructor(a,b,
c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd){this.Lxe=!1;this.hRg=0;this.RXa=null;this.Mhc=!1;this.zye=null;this.Gxe=!1;this.R4=a;this.Vg=b;this.Jq=c;this.qGa=l;this.la=f;this.Bl=w;this.Lr=H;this.nea=this.Vg.contentWindow.document.body;this.Lr.addHandler(this.nea,sa.a.paste,Object(F.a)(this,this.sHe,"onBrowserPaste"));this.Sd=U;this.Qo=ja;this.qec=ub;this.ena=new AO(wa);this.Jla=eb;this.zgc=null;this.X7c=f.nXj;this.aFg=this.Qo.eO(7);this.zx=Sa;this.mO=Ub;this.WT=cc;this.Ea=Ic;this.ic=Fc;this.Cc=
Cc;this.y0=Ud;this.ia=je;this.lze=f.pptEditingImageMaxSizeInBytes;this.BHg=Math.floor(f.pptEditingImageMaxSizeInBytes*Gg.Vzf);this.Aec=f.Fhg;this.SWa=f.vje;this.U6c=f.VLj;this.iUg=f.jUj&&this.Qo.eX;this.$xe=this.Q7c=!1;this.aDb=f.uje;this.Kec=f.Rig&&this.Qo.vo;this.zhk=f.ibj&&this.Qo.fg;this.B6j=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&this.Qo.zua;this.i7c=this.la.AOj;this.NL=Vd;this.bXa=this.la.ka("IsPasteTextFloatieEnabled")}dispose(){this.Vg&&this.Lr.removeHandler(this.nea,sa.a.paste,Object(F.a)(this,
this.sHe,"onBrowserPaste"));this.ena=this.Vg=null}PEk(a){a===this.zye.Wb&&this.ia.La(L.a.Qlc,2,this.zye)}sHe(a){const b=this.Cc.hP(2,0,"OnBrowserPaste");this.ena.start();this.Q7c=this.Gxe=!1;if(Xk&&Xk.FA&&!Xk.FA.f3d){!this.Qo.RF||this.Qo.Vj||this.B6j?gf.a.j0b(this.Vg):this.qGa.Q_a(this.Vg);var c=this.WT.ida(a);c=this.zx.S_c()?$p.OGi(c):null;var f=new EE;f.U0d=a;f.Ach=b;null!=this.RXa&&(this.Cc.$h(Gg.iCf,"menu",b),this.Cc.$h(Gg.gCf,this.RXa?Gg.lni:Gg.jni,b));this.Mhc&&(this.Cc.$h(Gg.iCf,"menu",b),
this.Cc.$h(Gg.gCf,Gg.kni,b));var l=this.bXa&&this.TBe;!this.Mhc&&!l&&c&&this.v$g(c,null,b,L.a.Whd,f)?this.RXa=null:(this.u$g(a,b),this.RXa=null,this.Mhc=!1,this.bXa&&(this.TBe=!1))}}u$g(a,b){var c=this.WT.ida(a);const f=this.WT.TUf(c);this.Cc.ZWe(f,b);if(!this.iAl(a,b)){var l=Object.assign(new zm.a(!0),{Wb:b,AA:this.RXa});this.bXa&&(l.d4b=this.TBe);var w=null;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SlideSorterPasteViaKeyboardEnabled",!1)&&document.activeElement.classList.contains("grid-content-editable-cursor-hide-class")&&
(va.a.J(509669642,826,50,"Getting html from dom event for slide sorter"),(w=a=this.WT.R5b(c))||(w=c.getData("text/plain")));this.zhk&&(va.a.J(512356507,826,50,"OnBrowserPaste::Getting html data from Clipboard"),c=this.WT.R5b(c),a=this.WT.rZa(c),c?(this.vFf(a)&&(this.Jq.Yq[0].o7a=a.firstChild.className,l.WW=null),l.Bm=a):va.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.zye=l;Rc.a.Faa(()=>{this.SGe(void 0,l,w)},0,this.la.DSj?0:2)}}Zri(a,b){let c=!1;Xk.FA.f7a(f=>{va.a.J(512356505,
826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",f);null!=f&&f&&(c=this.fsi(a,b))});return c}fsi(a,b){const c=Date.now();let f=!1;Xk.FA.ida(this.Vg,a,l=>{va.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+(Date.now()-c));if(l){var w=this.la.ka("IsPasteTextFloatieEnabled")&&b;if(!a&&!w)l.html&&l.html.length<=Gg.coi?-1!==l.html.indexOf(Gg.LCf)&&(f=!0):l.pptSlide&&l.pptSlide.length&&(f=!0);else if(w)l.text&&0<l.text.length?f=!0:this.yzj(l.html)&&
(f=!0);else if(l.img||l.isImageAvailable)f=!0;f&&(l=[],a?(l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.qoi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.poi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.ooi,!1))):w?(l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.toi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.soi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.roi,!1))):(l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.Dni,
!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.Aoi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.Fni,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.Coi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.Eni,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Gg.Boi,!1))),appChrome.api.dispatch(l));va.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",
f,Date.now()-c)}else va.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});return f}yzj(a){return a&&0!=a.length?-1===a.indexOf(Gg.LCf)&&-1===a.indexOf(Gg.Nni)&&-1===a.indexOf(Gg.Oni):!1}v$g(a,b,c,f,l){b||(b=Object.assign(new zm.a(!0),{Wb:c,AA:this.RXa}));b.zM=a;this.Cc.$h(Gg.objectCount,a.objectCount.toString(),c);this.Cc.$h(Gg.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),c);this.Cc.$h(Gg.uoi,(b.zM.packageSize?
null==b.zM.packageSize?0:b.zM.packageSize/Gg.Vzf:b.zM.dataSize).toString(),b.Wb);return 0!==b.zM.errorInCopying?(va.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.zM.ccpid,b.zM.objectCount,b.zM.errorInCopying),this.qwh(b.zM.errorInCopying,f,l,b),!0):this.zx.eTj(b.zM.dataSize)?this.z0d(b):(va.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.zM.ccpid,b.zM.dataSize,b.zM.objectCount),this.qwh(1,
f,l,b),!0)}qwh(a,b,c,f){switch(a){case 1:this.Cc.Hg(!1,f.Wb,27);this.NL.kga(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,b,0,c,null,!1,Gg.hCf);break;default:this.Cc.Hg(!1,f.Wb,28),this.NL.kga(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,Gg.hCf)}}Whd(a,b){va.a.J(512356499,826,50,"PasteSlideAsImage called");
const c=this.Cc.hP(2,0,"PasteSlideAsImage");this.Cc.$h("PasteSlideAsImage",b,c);this.ena.start();this.Q7c=this.Gxe=!1;this.u$g(a,c)}gti(a){a=a.split("+");const b=this.ic.jg(this.Jq.Yq[0].Fd).Cb;return b.cid.toString()===a[0]&&b.sid.toString()===a[1]}iAl(a,b){let c=!1,f=this.Mhc;var l=this.WT.E6d(a.rawEvent,this.Vg.contentWindow);if(l){let w=null;({L8b:w,y1g:l}=this.WT.kud(l,this.la.clipboardDataImageBlobNumberLimitaton,this.Aec?50*Gg.EMh:this.BHg));this.ena.LYb("GetBlob");0<l&&(va.a.J(512356498,826,
50,"Blob is too large"),this.lrd(b),c=!0);w&&1===w.length&&(Rc.a.Faa(()=>{this.Ppi(w,b,f)},0),this.iUg&&a.preventDefault(),c=!0)}else this.X7c&&this.aFg&&(this.zgc=this.Jla.MAl(a.rawEvent));c&&this.Cc.NB(5,b);return c}Ppi(a,b,c){if(c||a&&(this.WT.Kvd(this.nea)||this.iUg)){const f=a[0],l=Rc.a.Ib;Rc.a.Ak(Bh.a.uji,f.size.toString());this.Aec&&f.size>=this.BHg?(this.$xe&&va.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),this.qec.Gqg(f,w=>{Rc.a.AF(l,()=>{w&&this.Dol(w,f.size,b)||(this.Q7c=
!0,this.SGe(b));this.$xe=!1})}),this.$xe=!0):(new OR.a).OEh(a,w=>{Rc.a.AF(l,()=>{this.Hbj(w,b)})})}else this.SGe(b)}Hbj(a,b){this.ena.LYb("GetDataUrl");this.rBl(a,b)||(va.a.J(512356496,826,15,"Paste image data uri failed"),this.paste(Object.assign(new zm.a(!0),{Wb:b}),null,!1))}SGe(a="",b=null,c=null){this.paste(b||Object.assign(new zm.a(!0),{Wb:a}),c,!1)}$Ek(a,b){if(Xk.FA){va.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",a.Wb);var c=Date.now();Xk.FA.ida(this.Vg,a.N8a,
f=>{a.N8a&&(f.html=null,f.pptSlide=null,f.text=null);this.b3j(f,c);if(f=$p.PGi(f)){var l=new FE;l.pastedContent=b;l.yxa=a;this.v$g(f,a,a.Wb,L.a.H$g,l)}else this.paste(a,b,!0)})}}b3j(a,b){if(a){var c=a.img?a.img.length:0,f=a.html?a.html.length:0,l=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;va.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-b,c,f,l,a)}else va.a.J(512356494,826,50,"clipboardObject is null")}paste(a,
b,c){if(this.ia.fX)this.y0.show(5,-1),this.Cc.Hg(!1,a.Wb,26);else if(a.c3d)this.Vbe(a,b);else if(Xk.FA){var f=this.Qo.zT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.$Yc&&!f||this.Kec?(a.zM=null,this.zx.S_c()&&!c?this.$Ek(a,b):(va.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.Kec,this.la.$Yc),this.STe(a,b))):(this.RXa=a.AA,this.Mhc=a.N8a,this.bXa&&(this.TBe=a.d4b),this.zx.S_c()&&Xk.FA.Czl(this.Vg,
a.Wb)?(this.Cc.$h(Gg.iFk,"true",a.Wb),this.Cc.Hg(!0,a.Wb)):(this.RXa=null,({content:b}=Xk.FA.paste(this.Vg,this.R4.value,a.Wb,!1)).returnValue?this.Vbe(a,b):(Xk.FA.Wca(!1),b=Xk.FA.ly,null==b?(a=new ii.a(null,Object(F.a)(this,this.bXi,"fWaitForAsyncAPIResult"),Object.assign(new LE,{rd:a.Wb})),a.Pl("ClipboardPreProcessForAsyncAPI"),a.run()):null!=b&&b&&this.STe(a,null))))}else this.Cc.Hg(!1,a.Wb,1)}bXi(a,b){a=Xk.FA.ly;if(null==a)return!0;b=b.rd.toString();a?this.STe(Object.assign(new zm.a(!1),{Wb:b}),
null):this.Cc.Hg(!1,b,29);return!1}STe(a,b){this.hRg=Date.now();this.Lxe=!1;Xk.FA.prepareForPaste(a.N8a,c=>{this.Cc.$h("isPasteFromAsyncApi",c.toString(),a.Wb);this.Lxe=!0});b=new zO(a,b);(new ii.a(null,Object(F.a)(this,this.prepareForPaste,"prepareForPaste"),b)).run()}EKe(a,b){return a&&0<a.length?(a=Object.assign(new zm.a(!0),{Wb:b,Qde:a,PPc:!0}),this.z0d(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.Lxe){let f;({content:f}=Xk.FA.paste(this.Vg,this.R4.value,b.yxa.Wb,b.yxa.N8a)).returnValue&&
f?this.Vbe(b.yxa,f):c=!0;a=!1}else Date.now()-this.hRg>this.la.EFf&&(va.a.J(512356491,826,50,null),a=!1,c=!0,Xk.FA.reset());c&&this.Cc.Hg(!1,b.yxa.Wb,29);return a}get kjl(){return this.Qo.Gj&&this.la.BLj}Vbe(a,b){if(!a.Bm)if(va.a.J(512356490,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.Olg&&this.kjl)if(this.Ojl()){b=gf.a.SA();b.src=this.zgc;this.zgc=null;var c=gf.a.Ie();c.appendChild(b);a.Bm=c}else this.vFf(this.nea)&&(va.a.J(512356488,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),
this.Jq.Yq[0].o7a=this.nea.firstChild.className,a.WW=null),va.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.Bm=this.nea;else va.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),c=gf.a.Ie(),PR.a.tpd(c,b,"PasteManager"),a.Bm=c;this.xTd(a);b=this.zx.SNj(a.Bm.firstChild);c=this.zx.VNj(a.Bm.firstChild);if(b||c)va.a.J(512356486,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",
b,c),this.Cc.Hg(!0,a.Wb);else if(this.k_i(a.Bm),b=a.Bm.innerHTML.startsWith("<img"),c=a.Bm.innerHTML.length,a.c3d&&b&&(this.ena.LYb("ConvertDataUrlToDOMNode"),this.ena.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.Qo.Wy,c,this.Gxe))),!c&&this.Q7c)this.lrd(a.Wb);else{var f=0,l=!1;({bWd:f,i3d:l}=this.gAl(a));1===f?(va.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",l),this.Cc.Hg(!1,a.Wb,25)):!a.WW&&!a.Du&&c>this.lze?(Pd.a("PasteManagerOacr73010Fix")?
(this.Vg.contentWindow.document.body.innerText="",a.Bm.innerText=""):(this.Vg.contentWindow.document.body.innerHTML=null,a.Bm.innerHTML=null),b?(va.a.J(512356484,826,50,"Image too large"),this.lrd(a.Wb)):(va.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",c)),this.Cc.Hg(!1,a.Wb,7))):(a.Du?(va.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.AA),this.Cc.$h(Ep.a.Jp,a.Du.Jp,a.Wb)):va.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),
this.z0d(a))}}xTd(a){a?a.Bm?a.Bm.firstChild?a.Bm.firstChild.getAttribute||va.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):va.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):va.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):va.a.J(512356480,826,50,"BuildDiagnosticInfo:pasteParams is null")}vFf(a){if(!(this.U6c&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&
a.firstChild.getAttribute(Ep.a.type)&&a.firstChild.getAttribute(Ep.a.skb)&&this.Jq.Yq))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(Ep.a.sessionId).toString()===this.Jq.Yq[0].sessionId&&b.startsWith("CID")&&b!==this.Jq.Yq[0].o7a&&(Object(Ya.a)(qA.a,this.Jq.Yq[0])&&"shape"===a.firstChild.getAttribute(Ep.a.type).toString()&&this.eti(a.firstChild.getAttribute(Ep.a.skb).toString())||Object(Ya.a)(Pv.a,this.Jq.Yq[0])&&"slide"===a.firstChild.getAttribute(Ep.a.type).toString()&&
this.gti(a.firstChild.getAttribute(Ep.a.slideId).toString()))}eti(a){a=a.split(",");let b=0;if(a.length!==this.Jq.Yq.length)return!1;for(const c of a)for(const f of this.Jq.Yq)if(c===this.Ea.Ixb(f.shapeNode).toString()){b++;break}return b===a.length}z0d(a){let b=!1;for(let c=0;c<this.Bl.length;c++)if(this.Bl[c].mQ(a)){b=!0;this.Bl[c].paste(a);break}b||this.Cc.Hg(!1,a.Wb,19);return b}Dol(a,b,c){if(a){const f=new RR.a("ShrinkImage",!0);a=this.qec.pxh(a,b,this.lze);f.stop();if(a)return this.ena.LYb("LoadAndShrinkImage"),
this.ena.flush(String.format("Browser={0}, Length={1}",this.Qo.Wy,a.length)),Rc.a.Ak(Bh.a.eDj,f.Laa.toFixed(0)),Rc.a.Ak(Bh.a.dDj,f.uOc.toFixed(0)),Rc.a.Ak(Bh.a.fDj,a.length.toString()),this.EKe(a,c)}return!1}k_i(a){this.i7c&&a&&(a=a.ownerDocument)&&(a=a.getElementById(Ep.a.oeg))&&a.parentNode&&a.parentNode.removeChild(a)}gAl(a){let b,c;b=0;c=!1;if(a&&a.Bm&&a.Bm.firstChild&&a.Bm.firstChild.getAttribute){var f=a.Bm.firstChild;const l=f.getAttribute(Ep.a.Jp),w=this.Jq.Yq;if(w&&0<w.length&&w[0]&&Sys.UI.DomElement.containsCssClass(f,
w[0].o7a)){let H=!1;(this.SWa&&Object(Ya.a)(Pv.a,w[0])||this.aDb&&Object(Ya.a)(qA.a,w[0]))&&this.rQj(w)&&(this.ZLj(l)?H=!0:(a.t8g=!1,va.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",a.Wb)),va.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.Wb,H));if(H)va.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",
a.Wb),this.Jq.Yq=null;else if(va.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Wb),a.WW=w,!Pd.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,bWd:b,i3d:c}}else va.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",l,a.Wb);f=this.zx.RVi(f,a.Wb);b=f.QQa;c=1===f.dataType;if(this.zx.kYj(f)&&void 0!==f&&null!==f&&32===f.xW)return a.Du=f,va.a.J(512356443,826,
50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.AA),{returnValue:!0,bWd:b,i3d:c};va.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",f?f.toString():"(null)")}va.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,bWd:b,i3d:c}}rBl(a,b){let c=!1;if(this.Jla.Ang(a))if(a.length>=this.lze)this.lrd(b),c=!0;else{if(a=this.Jla.wAl(a))this.ena.LYb("ExtractDataUri"),
this.ena.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.Qo.Wy,a.length));c=this.EKe(a,b)}return c}rQj(a){for(const b of a)if(b.mlg)return!0;return!1}ZLj(a){if(this.mO.Jje)return va.a.J(512356439,826,50,"Cannot predict copy result due to incompletion"),!1;va.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.mO.wpg);return!!a&&a!==this.mO.wpg}lrd(a){this.Cc.Hg(!1,a,18);this.Sd.cH(60,null)}Ojl(){let a=!1;if(this.zgc&&0<this.zgc.length&&this.aFg){const b=this.nea.getElementsByTagName(gf.a.Z8);
if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}va.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":"Failed"))}}return a}}Gg.EMh=1048576;Gg.Vzf=.75;Gg.coi=5E3;Gg.iFk="PasteViaTriggeringEvent";Gg.objectCount="ObjectCount";Gg.isDataCompressed="IsDataCompressed";Gg.uoi="PastedObjectDataSize";Gg.gCf="ActionName";Gg.iCf="CcpMethod";Gg.lni="PasteKeepingSourceFormatting";Gg.jni="PasteKeepingDestinationTheme";Gg.kni="PasteAsImage";
Gg.LCf='data-clipservice-type="slide"';Gg.Dni="ContextMenu.PasteKeepingDestinationTheme";Gg.Aoi="ContextMenu.PasteKeepingSourceFormatting";Gg.Fni="PasteKeepingDestinationTheme";Gg.Coi="PasteKeepingSourceFormatting";Gg.Eni="PasteKeepingDestinationThemeMLR";Gg.Boi="PasteKeepingSourceFormattingMLR";Gg.hCf=20;Gg.qoi="PasteAsImageSLR";Gg.poi="PasteAsImageMLR";Gg.ooi="ContextMenu.PasteAsImage";Gg.toi="PasteTextOnlySLR";Gg.soi="PasteTextOnlyMLR";Gg.roi="ContextMenu.PasteTextOnly";Gg.Nni="<img>";Gg.Oni="<table>";
Object(n.a)(Gg,"PasteManager",null,[1156,106]);class BO{constructor(a,b){this.Evg=a;this.Ha=b}gsl(a,b,c,f,l){this.Evg.J1(this.Ha.Eti,a,b,c,this.Ha.Fti,this.Ha.Gti,this.Ha.Hti,f,l)}Qqi(a){this.Evg.Pqi(a)}}Object(n.a)(BO,"PastedDataUploader",null,[1152]);class ZE{static create(a){const b=new ZE;b.gng=Pr.b(a,c=>c.isEditable);return b}}Object(n.a)(ZE,"ShapeCopyPasteParams",null,[]);class CO{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af){if(!a)throw Error.argumentNull("selectionManager");
if(!b)throw Error.argumentNull("clipboardTarget");if(!c)throw Error.argumentNull("lazyFocusManager");if(!l)throw Error.argumentNull("internalClipBoard");if(!f)throw Error.argumentNull("activeSlideViewManager");if(!w)throw Error.argumentNull("ccpUtils");if(!H)throw Error.argumentNull("clipboardHelper");if(!U)throw Error.argumentNull("clipServiceManager");if(!ja)throw Error.argumentNull("actionManager");if(!wa)throw Error.argumentNull("htmlExportProcessor");if(!Sa)throw Error.argumentNull("htmlExportUtils");
if(!Ic)throw Error.argumentNull("shapeReader");if(!Cc)throw Error.argumentNull("clipboardTelemetry");if(!je)throw Error.argumentNull("pptFileReaderHelper");if(!Ve)throw Error.argumentNull("systemClipboard");if(!af)throw Error.argumentNull("browserHelperManager");if(!Ud)throw Error.argumentNull("deferredContentManager");this.pa=a;this.Vg=b;this.R4=c;this.Jq=l;this.eec=f;this.Jla=w;this.zx=H;this.mO=U;this.ia=ja;this.R$j=wa;this.S$j=Sa;this.Bec=eb;this.Gec=ub;this.V6c=Ub;this.axe=cc;this.jIa=Fc;this.Ea=
Ic;this.Cc=Cc;this.Bw=Ud;this.Ngc=je;this.VCg=Vd;this.JFb=Ve;this.qGa=af}mQ(a){const b=this.pa.tg();let c=!1;b&&0<b.length&&this.R4.value.m8===Lb.a.sg&&(a.dataType=2,c=a.Lda?this.fWi(b):!this.pa.uUa());return c}fWi(a){let b=!0;for(const c of a){if(c.I0c&&!c.isLocal)return!0;c.gB||(b=!1)}return b}Fsa(a){u.AFrameworkApplication.Wj("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");const b=this.pa.tg();if(!b||!b.length)return this.Jq.Yq=null,!1;var c;let f=
({contentType:c}=this.Jla.qUd(b)).returnValue;this.Cc.NB(c,a.Wb);a.Lda?({qkb:f,returnValue:c}=this.hPi(b,a,f),f="Cut:"+f):({qkb:f,returnValue:c}=this.ePi(b,a,f),f="Copy:"+f);this.Bw.uce(b,"DoCutCopy")&&(va.a.J(509210822,826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.Lda?this.Bw.wra("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.Bw.wra("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));va.a.J(509210821,307,50,f);return c}hPi(a,b,c){var f=!0;let l=[];for(const w of a)w.I0c&&
l.push(w),w.gB||(f=!1);l=f?a:l;f=({qkb:c}=this.dLh(l,l,!0,!0,c,b.Wb,f)).returnValue;this.IJf(l,b.Lda);this.Gec&&this.LJf(a);return{returnValue:32===this.ia.La(L.a.UMf,2,f),qkb:c}}ePi(a,b,c){if(this.Bec&&this.JMj(this.tkj(),a))return{returnValue:!0,qkb:c};var f=[];for(const l of a)l.I0c&&f.push(l);f=({qkb:c}=this.dLh(a,f,this.Bec,!1,c,b.Wb)).returnValue;f.Du&&this.ia.La(L.a.KJf,2,f);this.IJf(a,b.Lda);this.Gec&&this.LJf(a);return{returnValue:32===this.ia.processAction(L.a.JJf,2),qkb:c}}JMj(a,b){if(!this.mO.Jje||
a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}cll(a){if(!a.length)return!0;let b=0,c=0;for(let f=0;f<a.length;f++){const l=a[f];if(l.isLocal)return!0;!l.Hj||l.get_isSVGBlipFilled()||l.isGif||b++;l.ud&&c++}return this.V6c?c===a.length:b+c===a.length}acj(a){const b=[];for(const c of a)c&&(a=new qA.a(c),a.sessionId=this.jIa,b.push(a));return b}tkj(){const a=[];if(this.Jq.Yq&&this.Jq.Yq.length)for(const b of this.Jq.Yq){const c=Object(qa.a)(qA.a,
b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}dLh(a,b,c,f,l,w,H=!1){let U=new Yx(null,w,null);this.Jq.Yq=this.acj(a);!c||this.cll(b)?(c&&(va.a.J(509210820,307,50,"Clip service shapes cut/copy is throttled"),this.Cc.$h(qu.a.FGf,"true",w)),this.zx.zwd(this.Vg,this.Jq.Yq,null,this.jIa,this.k7f(a),null,w)):(this.Jla.ryh(b),c=this.mO.PLc(2,b.length,f,H),c.Yjc=ZE.create(b),this.axe&&this.Bw.uce(a,f?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.QQa=1,c.xW=8),this.Cc.$h(qu.a.Jp,
c.Jp,w),l+=String.format(", CcpId={0}",c.Jp),this.zx.zwd(this.Vg,this.Jq.Yq,c,this.jIa,this.k7f(a),null,w),U=new Yx(c,w,b));return{returnValue:U,qkb:l}}k7f(a){const b=[];for(const c of a)Array.add(b,this.Ea.Ixb(c));return b}IJf(a,b){for(const c of a)c&&c.Hj&&(a=Tj.c(c,this.eec.Ic.Ma))&&!a.Al&&(a=a.cQa)&&(a=this.VCg?this.Goj(a):a.getAttribute(Ik.a.jXc))&&(this.VCg?this.vbj(a,c,b):this.lxf(a.toString(),c))}vbj(a,b,c){try{fetch(a).then(f=>{f.blob().then(l=>{this.Ngc.igh(l,w=>{w=w.target.result;c&&gf.a.j0b(this.Vg);
this.lxf(w,b);this.qGa.Q_a(this.Vg);this.JFb.copy(this.Vg)})}).catch(l=>{va.a.J(509207576,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in getting blob from response: {0}",l.toString())})}).catch(f=>{va.a.J(509207575,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob from url: {0}",f.toString())})}catch(f){va.a.J(509210634,826,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob: {0}",f)}}Goj(a){if((a=a.querySelectorAll("image"))&&
a.length&&(a=a[0].getAttribute("href")))try{if("blob:"===(new URL(a)).protocol)return a}catch(b){va.a.J(509207881,826,10,"Exception {0} while converting to URL.",b)}return null}lxf(a,b){let c=gf.a.SA();c.src=a;b.get_shapeRotation()||this.Jla.scl(c,b.wx,b.JC);c.className+=this.Jq.Yq[0].o7a;this.Vg.contentWindow.document.body.appendChild(c)}LJf(a){(a=this.S$j.Q2i(a,b=>!!b&&b.ud))&&0<a.length&&(a=this.R$j.R2i(a))&&this.Vg.contentWindow.document.body.appendChild(a)}}Object(n.a)(CO,"ShapeCutCopyHandler",
null,[1206]);class fs{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub){this.Vg=b;this.R4=c;this.Jq=f;this.ua=l;this.ia=w;this.zx=H;this.mO=U;this.W6c=ja;this.axe=wa;this.pa=a;this.jIa=Sa;this.Cc=eb;this.Bw=ub}mQ(a){var b=this.R4.value.m8;if(b=!!this.ua.Ba&&!!b&&b===Zi.a.PD||b===Lb.a.sg&&!this.pa.Xd().length||b===Lb.a.PB)a.dataType=1;return b}Fsa(a){this.Cc.NB(19,a.Wb);return this.kKi(a)}get Mb(){return this.pa}kKi(a){var b=this.Mb.Qe();if(!b||!b.length)return this.Jq.Yq=null,ka.ULS.sendTraceTag(512497806,
826,10,"Tried to copy slides but no slides were selected."),!1;var c=fs.Y0f(b,!0);if(!c.length)return a=this.C7f(b).join(","),ka.ULS.sendTraceTag(512497805,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),!1;b.length!==c.length&&(b=fs.Y0f(b,!1),b=this.C7f(b).join(","),ka.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=fs.getSlides(this.Jq),l=fs.sFi(this.jIa,c);this.Jq.Yq=fs.wxl(l);b=(b=
c[0])?b.Cb:null;const w=this.Bw.Xyj(c);this.W6c?this.JYe(f,l)?(va.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",a.Wb),this.Cc.$h(qu.a.FGf,"true",a.Wb)):(f=this.mO.PLc(1,c.length,a.Lda),c=new BE.a(f,a.Wb,c),this.Cc.$h(qu.a.Jp,f.Jp,a.Wb),l=8,w?this.axe&&(f.QQa=1,f.xW=8):a.Lda||(l=this.ia.La(L.a.PXd,2,c),f.xW=l),this.zx.zwd(this.Vg,this.Jq.Yq,f,this.jIa,null,b,a.Wb),!w&&a.Lda&&(l=this.ia.La(L.a.VMf,2,c)),va.a.J(512497802,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",
a.Lda,f.xW,f.Jp),a.Lda?this.Bw.wra("DeferredSlideCutStatus",f.xW.toString()):this.Bw.wra("DeferredSlideCopyStatus",f.xW.toString())):(this.zx.zwd(this.Vg,this.Jq.Yq,null,this.jIa,null,b,a.Wb),va.a.J(576745568,307,15,"Clip service has been disabled. CcpCorId: {0}",a.Wb));return!0}C7f(a){return dk.c(a,b=>b?b.Cb.toString():null)}JYe(a,b){if(!b||!b.length||fs.tgi(b))return!0;if(this.mO.Jje){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!fs.Lgi(a[c],b[c]))return!1;return!0}return!1}static Y0f(a,
b){const c=new Ka.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=[];if(!a||!a.Yq||!a.Yq.length)return b;for(let c=0;c<a.Yq.length;c++)b.push(Object(qa.a)(Pv.a,a.Yq[c]));return b}static Lgi(a,b){return!a&&!b||!!a&&!a.Fd&&!!b&&!b.Fd||!!a&&!!a.Fd&&!!b&&!!b.Fd&&(!a.Fd.id&&!b.Fd.id||!!a.Fd.id&&!!b.Fd.id&&a.Fd.id.equals(b.Fd.id))}static tgi(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].Fd&&!N.a.mx(a[b].Fd.Cb))return!1;return!0}static wxl(a){const b=[];for(const c of a)b.push(c);
return b}static sFi(a,b){const c=[];for(const f of b)c.push(Object.assign(new Pv.a(f),{sessionId:a}));return c}}Object(n.a)(fs,"SlideCopyHandler",null,[1206]);class DO{constructor(a,b,c,f){this.cma=this.Yue=!1;this.vXb=null;this.qGa=a;this.vik=b;this.ddc=c;this.Cc=f}get NM(){this.vXb||(this.vXb=this.vik.create());return this.vXb}get f3d(){return this.cma}Wca(a){this.NM.Wca(a)}f7a(a){this.NM.f7a(a)}get a6(){return this.NM.a6}get ly(){return this.NM.ly}prepareForPaste(a,b){this.cma=!0;this.NM.prepareForPaste(b,
a,this.ddc.tCa.contentWindow.document)}ida(a,b,c){this.cma=!0;this.NM.ida(a,b,c);this.cma=!1}reset(){this.cma=!1}Czl(a,b){if(!this.QLa(a,b))return!1;try{const c=a.contentWindow.document;let f=c.body;za.a.Cu(f);this.NM.C8a(c,f);return!0}catch(c){va.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.rf(Lb.a.sg);if(!this.QLa(a,c)&&(null==this.ly||null!=this.ly&&!this.ly))return{returnValue:!1,
content:f};b=a.contentWindow.document;let l=b.body;this.cma=!0;za.a.Cu(l);let w=!1;try{this.qGa.Q_a(a),l=this.NM.C8a(b,l),f=l.innerHTML,w=!0}catch(H){this.A7b(c)}this.cma=!1;return{returnValue:w,content:f}}copy(a){a.contentWindow.focus();this.cma=!0;let b;try{this.NM.xPc(a.contentWindow.document),b=!0}catch(c){b=!1}this.cma=!1;return b?!0:!1}QLa(a,b){if(this.Yue)return!0;this.cma=!0;let c=!1;try{c=this.NM.QLa(a.contentWindow.document.body,()=>{za.a.Cu(a.contentWindow.document.body)},()=>{this.qGa.Q_a(a)})}catch(f){}this.cma=
!1;c?this.Yue=!0:B.a.Gj||null==this.ly||this.ly||this.A7b(b);return c}A7b(a){this.Yue=!1;Aq.instance.fub(null,null);this.Cc.Hg(!1,a,29)}}Object(n.a)(DO,"SystemClipboard",null,[1153]);class EO{constructor(a,b,c,f,l,w,H,U){this.yxe=!0;this.szg=!1;l.pptOfflineModeEnabled&&a.TGc(Object(F.a)(this,this.tHb,"onNetworkHealthStateChanged"));this.ut=b;this.ia=c;this.y0=f;this.la=l;this.LO=w;this.WL=H;this.ua=U;this.FG=0;this.Qdb=!1;this.R3c=0;this.SGg=new Date}get status(){return this.FG}tHb(a,b){this.yxe=
b.y_c;this.szg||this.grh(this.yxe,"NetworkHealthStateChanged")}CYf(a){this.szg=!a;this.yxe&&this.grh(a,"PodSeamlessFailoverManager")}grh(a,b){a&&this.Qdb&&(this.y0.Arc=!1,this.FG=1,this.LO.HH());const c=!a,f=this.R3c+1;fm.a.instance.Db(new Le.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.$jb(c,f)},90,"107"));this.R3c++;ka.ULS.sendTraceTag(41272025,813,50,Dl.c({["Current state"]:this.Qdb.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}$jb(a,
b){this.R3c===b&&this.Qdb!==a&&(this.y0.Arc=a,a&&3!==this.ia.mode||((this.Qdb=a)?(this.FG=2,this.LO.HH(),this.WL.aX(this.ua.presentation)&&this.y0.show(0,-1)):(this.FG=0,this.y0.dismiss(),this.LO.HH()),this.ut.$jb(a),ka.ULS.sendTraceTag(41272026,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.R3c,Rc.a.mf(this.SGg)),this.SGg=new Date))}}Object(n.a)(EO,"PPTOfflineManager",null,[1172]);class FO{Xrc(a,b,c){DE.a(a,b,c)}}Object(n.a)(FO,
"WarningDialogProxy",null,[1150]);var SR=d(279);class fy extends ci.a{constructor(a,b,c,f,l,w,H,U,ja){super();this.p5c=!1;this.Ccc=null;this.heb=0;this.E8c=this.sfc=this.B8c=this.y8c=this.lad=this.I8c=this.Q4c=this.mcd=this.nXa=this.Mye=this.dze=this.I0=this.Q4=null;this.Xma=a;this.Lfc=b;this.qJ=c;this.Fck=f;this.u6j=l;this.B9j=ja;this.Fa=w;this.mUg=U;this.oc=H}dispose(){this.Mye=this.dze=this.I0=this.Q4=null;super.dispose()}nwh(a){this.NGh();this.aj(a,Object(F.a)(this,this.kSi,"endDialogHandler"),
{["MasterId"]:0,["LayoutId"]:0})}mph(a){if(a)for(let b=0;b<this.nXa.length;b++){const c=document.getElementById(this.nXa[b]);if(parseInt(c.getAttribute("LayoutId"))===a){this.lLb(c);break}}}qu(){super.qu();gf.a.Ie().appendChild(this.uFi());const a=document.getElementById(this.Oh("WACDialogPanel"));a&&a.removeAttribute(Bc.a.Jra)}BA(){super.BA();var a=document.getElementById(this.Oh("WACDialogPanel"));a.style.width=gf.a.Pc(532);a=parseInt(Jf.a.Xt(a).top);this.Q4.style.height=gf.a.Pc(Math.min(Math.max(0,
Nl.a.HU-a-100),398));this.eg=this.Q4.parentNode.innerHTML}b8(){super.b8();this.dze=document.getElementById("MasterId");this.Mye=document.getElementById("LayoutId");this.sfc=Object(F.a)(this,this.Jbb,"keyPressHandler");u.AFrameworkApplication.Aa.pG.yld(sa.a.Xf,window.document,this.sfc,null);this.y8c=Object(F.a)(this,this.O_j,"layoutClickHandler");this.B8c=Object(F.a)(this,this.P_j,"layoutDoubleClickHandler");this.E8c=Object(F.a)(this,this.R_j,"layoutOnFocus");for(let a=0;a<this.nXa.length;a++){const b=
document.getElementById(this.nXa[a]);this.yn.pb(sa.a.click,b,this.y8c);this.yn.pb(sa.a.doubleClick,b,this.B8c);Yc.a.addHandler(b.firstChild,"focus",this.E8c)}}xsa(){super.xsa();this.sfc&&u.AFrameworkApplication.Aa.pG.N4e(sa.a.Xf,window.document,this.sfc);this.sfc=null;for(let a=0;a<this.nXa.length;a++){const b=document.getElementById(this.nXa[a]);this.yn.yb(sa.a.click,b,this.y8c);this.yn.yb(sa.a.doubleClick,b,this.B8c);Yc.a.removeHandler(b.firstChild,"focus",this.E8c)}this.E8c=this.B8c=this.y8c=null}uFi(){if(this.Q4)return this.Q4;
this.Q4=gf.a.Ie();this.Q4.id="LayoutPickerDiv";this.Q4.className="LayoutPicker";this.heb=0;this.nXa=[];var a=this.Lfc.length;if(!a||1===a&&!this.Lfc[0].InContent)return va.a.J(509654401,822,10,"Legacy LayoutDialog:: Master not loaded."),this.Q4;var b=0;let c=!1;for(var f=0;f<a;f++)this.Lfc[f].Id===this.Fck&&(b=f,c=!0);c&&this.Tsf(this.Lfc[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.Tsf(this.Lfc[f],1!==a);a=gf.a.TKf();a.id="MasterId";a.type="hidden";b=gf.a.TKf();b.id="LayoutId";b.type="hidden";this.Q4.appendChild(a);
this.Q4.appendChild(b);return this.Q4}Tsf(a,b){a.InContent&&this.qJ.Gb(a.Id)&&(b&&this.Q4.appendChild(this.OFi(a)),this.Q4.appendChild(this.KDi(a)))}OFi(a){const b=gf.a.Ie();b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}KDi(a){const b=a.Id;a=a.ContentMasters;if(!this.qJ.Gb(b))return null;const c=this.qJ.ga(b),f=gf.a.Ie();f.className="LayoutTableContainer";var l=gf.a.$Lf();const w=gf.a.EIi();let H=null;f.appendChild(l);l.appendChild(w);l=this.Xma.width;let U=this.Xma.height,ja;l||(l=
1);U||(U=1);ja=U/l*145;let wa=0;const Sa=a.length;for(var eb=0;eb<Sa;eb++)!this.mUg&&this.oc.Iab(a[eb])||wa++;eb=1;for(let Ic=0;Ic<Sa;Ic++){var ub=a[Ic];if(!this.mUg&&this.oc.Iab(ub))continue;1===eb%3&&(H=gf.a.iZd(),w.appendChild(H));var Ub=ub.Id.toString();const Cc=ub.Name,Ud=gf.a.tMc();Ud.id="Layout"+this.heb;Ud.setAttribute("LayoutIndex",this.heb);Ud.setAttribute("MasterId",b);Ud.setAttribute("LayoutId",Ub);Ud.setAttribute(Bc.a.af,Bc.a.pN);Array.add(this.nXa,Ud.id);var cc=null;if(Ub=!!c.LayoutIcons&&
c.LayoutIcons.length>Ic&&!!c.LayoutIcons[Ic].Icon){cc=-1;for(var Fc=0;Fc<c.LayoutIcons.length;Fc++)if(c.LayoutIcons[Fc].LayoutId===ub.Id){cc=Fc;break}-1===cc&&(cc=Ic);cc=c.LayoutIcons[cc].Icon;Fc=new SR.a(cc.Clip.Bounds.Left,cc.Clip.Bounds.Top,145,ja);ub=gf.a.SA();ub.src=Ab.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(be.a.fvb,cc.ImgId,"LayoutPicker");ub.title=Cc;ub.style.clip=this.cUk(Fc);ub.style.left=gf.a.Pc(-Fc.Y1a);ub.style.overflow=nf.a.Qs;ub.style.position=nf.a.dpa;ub.style.top=
gf.a.Pc(-Fc.Z1a);ub.style.zIndex="0";l<U&&(ub.style.height=gf.a.Pc(ja));ub.setAttribute(Bc.a.af,Bc.a.YPa);cc=document.createElement("span");cc.style.width=gf.a.Pc(145);cc.style.height=gf.a.Pc(ja);cc.setAttribute("Unselectable","on");cc.style.zIndex="0";cc.style.overflow=nf.a.Qs;cc.style.display=nf.a.$sl;cc.style.position=nf.a.Csc;cc.appendChild(ub);cc.setAttribute(Bc.a.SK,Bc.a.jC)}ub=gf.a.Ie();ub.id="title_Layout"+this.heb;ub.className="LayoutTitle LayoutTitleHighContrast";ub.innerText=Cc;Fc=gf.a.Eca();
Fc.setAttribute("tabindex","0");Fc.setAttribute("onclick","return false;");Fc.setAttribute("unselectable","on");Fc.setAttribute(Bc.a.ns,Cc);Fc.setAttribute(Bc.a.af,Bc.a.YPa);Fc.setAttribute(Bc.a.iSd,eb);Fc.setAttribute(Bc.a.jSd,wa);Ub&&Fc.appendChild(cc);Fc.appendChild(ub);H.appendChild(Ud);Ud.appendChild(Fc);this.heb++;eb++}Sa%3&&(this.heb+=3-Sa%3);return f}cUk(a){let b;b="rect( "+(gf.a.Pc(a.Z1a)+", ");b+=gf.a.Pc(a.kNh)+", ";b+=gf.a.Pc(a.lNh)+", ";return b+=gf.a.Pc(a.Y1a)+")"}kSi(a,b){this.p5c&&
(Rc.a.Btb(this.Ccc),this.p5c=!1,this.Ccc=null);1===a&&this.u6j(b.MasterId,b.LayoutId)}R_j(a){a=a.target.parentNode;this.I0&&a.id===this.I0.id||this.lLb(a)}Jbb(a){a=a.qc;var b=this.Kej(a);if(b===A.a.jQb)return!0;if(b===A.a.tq)return(a=this.Fa.yl())&&"WACDialogCancelButton"!==a.wj.d_.id?(this.sqa(1),this.hide(),!0):!1;a.preventDefault();if(!this.I0)return a=document.getElementById("Layout0"),this.lLb(a),!0;a=parseInt(this.I0.getAttribute("LayoutIndex"));b=this.Kcj(b);for(let c=0;c<b.length;c++){const f=
document.getElementById("Layout"+(a+b[c]));if(f){this.lLb(f);break}}return!0}Kej(a){let b=A.a.jQb;switch(a.keyCode){case A.a.Y1:b=A.a.Y1;break;case A.a.W1:b=A.a.W1;break;case A.a.ZR:b=A.a.ZR;break;case A.a.oP:b=A.a.oP;break;case A.a.tq:b=A.a.tq}this.B9j&&(b===A.a.oP?b=A.a.ZR:b===A.a.ZR&&(b=A.a.oP));return b}Kcj(a){let b=[0];switch(a){case A.a.Y1:if(!this.mcd)for(this.mcd=Array(3),a=0;3>a;a++)this.mcd[a]=-3-a;b=this.mcd;break;case A.a.ZR:if(!this.I8c)for(this.I8c=Array(3),a=0;3>a;a++)this.I8c[a]=-1-
a;b=this.I8c;break;case A.a.oP:if(!this.lad)for(this.lad=Array(3),a=0;3>a;a++)this.lad[a]=a+1;b=this.lad;break;case A.a.W1:if(!this.Q4c)for(this.Q4c=Array(3),a=0;3>a;a++)this.Q4c[a]=3-a;b=this.Q4c}return b}O_j(a){this.lLb(a.kC);return!0}P_j(a){a=a.kC;a!==this.I0&&this.lLb(a);this.sqa(1);this.hide();return!0}lLb(a){this.NGh();this.I0=a;const b=this.Fa.yl();b?b.wj.ZE(a.firstChild):va.a.J(509654368,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");Sys.UI.DomElement.addCssClass(this.I0,
"Selected");this.HEl();this.p5c=!0;this.Ccc||(this.Ccc=Rc.a.Faa(Object(F.a)(this,this.z8k,"selectElement_Finish"),0))}z8k(){this.I0&&this.W7k(this.I0);this.p5c=!1;this.Ccc=null}NGh(){this.I0&&(Sys.UI.DomElement.removeCssClass(this.I0,"Selected"),this.I0=null)}W7k(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=gf.a.R1g(b,a)._y,w=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+c,l=w+l,l>a&&(b.scrollTop=c+(l-a)))}}HEl(){this.dze.value=
this.I0.getAttribute("MasterId");this.Mye.value=this.I0.getAttribute("LayoutId")}}Object(n.a)(fy,"LayoutPicker",ci.a,[]);class GO extends fy{constructor(a,b,c,f,l,w,H,U,ja){super(a,b,c,f,l,w,H,U,ja)}dispose(){super.dispose()}nrd(a){this.nwh(ResourceStrings.l_NewSlideTitle);this.mph(a)}qu(){this.Xe(1,ResourceStrings.l_AddSlide);super.qu()}}Object(n.a)(GO,"AddSlideDialog",fy,[1221]);class HO extends fy{constructor(a,b,c,f,l,w,H,U,ja){super(a,b,c,f,l,w,H,U,ja)}dispose(){super.dispose()}nrd(a){this.nwh(ResourceStrings.L_SlideLayoutDialog);
this.mph(a)}qu(){this.Xe(1,ResourceStrings.L_ChangeLayout);super.qu()}}Object(n.a)(HO,"ChangeLayoutDialog",fy,[1221]);class IO{constructor(a,b){this.Fa=a;this.oc=b}nYd(a,b,c,f,l,w,H,U){switch(a){case 1:return new GO(b,c,f,l,w,this.Fa,this.oc,H,U);case 0:return new HO(b,c,f,l,w,this.Fa,this.oc,H,U);default:return null}}}Object(n.a)(IO,"DialogFactory",null,[1205]);class JO{constructor(a,b,c,f,l){this.$ma=null;this.ia=a;this.kM=b;this.yt=c;this.sO=f;this.Tp=l;this.kM.R7(Object(F.a)(this,this.Rkc,"onShapeDisconneted"));
this.yt.pQd(Object(F.a)(this,this.Wkc,"onSlideBackgroundClicked"));this.yt.Obi(Object(F.a)(this,this.$6g,"onShapeViewElementBackgroundClicked"))}vah(a){if(!a)throw Error.argumentNull("template");this.$ma=a;va.a.J(18368227,822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.sO.O_=!0}vfi(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.$ma||a.id.equals(this.$ma.id)?b=!0:a.get_isSVGBlipFilled()&&(this.$ma.ux||!this.$ma.kla&&!this.$ma.get_isSVGBlipFilled())&&(b=!0);
b?this.sQa():(va.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",this.$ma.get_shapeId(),a.get_shapeId()),this.ia.La(L.a.n5d,2,new oA(this.$ma,a)))}sQa(){this.isActive&&(va.a.J(18368262,822,50,"FormatPainter::CancelFormat"),this.$ma=null,this.sO.O_=!1)}dispose(){this.kM.wKa(Object(F.a)(this,this.Rkc,"onShapeDisconneted"));this.yt.Wjh(Object(F.a)(this,this.Wkc,"onSlideBackgroundClicked"));this.yt.k0k(Object(F.a)(this,this.$6g,"onShapeViewElementBackgroundClicked"))}Rkc(a,
b){b.node===this.$ma&&this.sQa()}Wkc(){const a=this.isActive;this.sQa();this.Tp&&a&&this.ia.processAction(D.a.Xja,2)}$6g(a,b){this.isActive&&this.vfi(b.Px.shapeNode)}get isActive(){return this.sO.O_}get Vvl(){return this.$ma}}Object(n.a)(JO,"FormatPainter",null,[1169,106]);var TR=d(1154),rA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]=
"tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(rA||(rA={}));Object(n.b)("OfflineModalCalloutTrigger",rA);class KO{constructor(a){this.xo=null;this.Arc=!1;this.Rb=a;a=document.createElementNS(Ik.a.Y0e,"polyline");a.setAttribute(Ik.a.Nah,"1,1 15,14 30,1");a.setAttribute(Ik.a.gsd,"rgb(234,234,234)");a.setAttribute(Ik.a.m0e,"2");a.setAttribute(Ik.a.U3d,"white");a.setAttribute(Ik.a.l0e,"bevel");this.Cqe=new rm.a;this.Cqe.lh(32,16);this.Cqe.xa.appendChild(a);this.xcc=document.createElement("p");
this.xcc.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.xcc.style.width="258px";this.xcc.style.color="black";this.xcc.style.fontSize="14px"}dismiss(){this.xo&&(this.xo.dismiss(),this.xo=null)}show(a,b){ka.ULS.sendTraceTag(512497097,813,50,"OfflineModalCallout.Show is triggered by {0}",rA[a]);if(this.Arc){if(this.xo){if(this.xo.AL)return;this.xo.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");Pd.a("OfflineModalCalloutCrashFix")&&!c?ka.ULS.sendTraceTag(512497096,
813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=Kd.a.ai(c),this.xo=TR.a.IYd(a,c,this.Rb.Zrd,2),this.xo.TZ=4,0<b&&(this.xo.A2e=b),this.xo.Ar=!0,this.xo.content=this.xcc,this.xo.jWd=()=>{ka.ULS.sendTraceTag(512497095,813,50,"The user clicks the button to close the callout.");this.xo&&(this.xo.dispose(),this.xo=null)},this.xo.Igd=()=>{if(this.xo&&this.xo.content){this.xo.content.parentNode.style.width="258px";this.xo.KJ.style.borderColor="rgb(234,234,234)";for(var f=this.xo.rsb;f.firstChild;)f.removeChild(f.firstChild);
f.appendChild(this.Cqe.xa);this.xo.TWe()}else ka.ULS.sendTraceTag(512497094,813,50,"callout content is empty in OnShowCallback")},this.xo.show(),ka.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}Object(n.a)(KO,"OfflineModalCallout",null,[1171]);var LO=d(302),sA=d(208);class MO{constructor(a,b,c){this.ah=this.tO=this.xb=null;this.Eb=!0;this.ta=a;this.kdb=b;this.Kze=a.Hvb?a.hea:null;this.Oea=c}dispose(){this.Oea&&this.tO&&($removeHandler(this.tO.xa,"error",Object(F.a)(this,this.P4g,
"onImageLoadError")),this.tO.dispose(),this.tO=null);this.xb&&this.xb.zq();this.tO=this.ah=this.xb=null;this.Kze&&(this.kdb.revokeObjectURL(this.Kze),this.Kze=null)}Jm(a){this.xb=new aE.a;this.xb.Hoa($i.a.y0e);a.appendChild(this.xb.viewport);this.tO=new LO.a;this.tO.$j(0);this.xb.appendChild(this.tO);this.tO.Lw(this.ta.hea);$addHandler(this.tO.xa,"error",Object(F.a)(this,this.P4g,"onImageLoadError"));a=this.ta.fp;const b=cj.a.fDh(a);this.tO.setPosition(a.hc,a.kc);this.tO.lh(b.width,b.height);this.tO.Rd(!0);
this.ah=new qm.a;this.ah.$j(1);this.ah.setVisibility(!1);this.ah.xa.setAttribute("class","ShapeMoveHandle");this.ah.Rd(!0);this.ah.Et(a.points);this.ah.NY("cursor: move");this.xb.appendChild(this.ah);this.xb.Rl()}P4g(){va.a.J(34182307,826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ta.lbb)}setPosition(a,b){this.xb.setPosition(a,b)}lD(){}Kj(a){this.xb.Kj(a)}Qq(a){this.xb.QE(a,sA.a.tca)}Yu(a){this.xb.QE(a,sA.a.Ssb)}setZIndex(a){this.xb.OB(a)}Xy(){}bE(){return null}JB(){return[]}draw(){}OE(){}Zp(){return this.Eb?
this.xb.Zp():null}get visible(){return this.Eb}set visible(a){this.Eb=a;this.xb.Rd(this.Eb)}get qq(){return this.ah}get te(){return this.xb}PN(a){return a.Ec===this.qq.xa}Ox(){}setSelection(){}}Object(n.a)(MO,"LocalImageView",null,[1220,435,436,106]);class NO{constructor(a,b){this.kdb=a;this.eak=b}create(a){return new MO(a,this.kdb,this.eak)}}Object(n.a)(NO,"Factory",null,[1165]);class OO{constructor(a){this.Eb=!0;this.YVa=this.HWa=this.xb=null;this.Zd=a}dispose(){this.xb&&this.xb.zq();this.HWa=this.YVa=
this.xb=null;this.Eb=!1}Jm(a){this.xb=new aE.a;this.xb.Hoa($i.a.y0e);a.appendChild(this.xb.viewport);this.YVa=new qm.a;this.xb.appendChild(this.YVa);this.YVa.PE(Ik.a.none);a=this.Zd.shapeNode.fp;this.YVa.Zu(Pf.a.E1);this.YVa.mr(Pf.a.TE);this.YVa.Noa("2,2");this.YVa.Et(a.points);this.HWa=new LO.a;this.HWa.$j(0);this.xb.appendChild(this.HWa);this.HWa.Lw(vp.a.ZK(Pf.a.Zna));a=cj.a.fDh(a);const b=Pf.a.cJb,c=Pf.a.vjd;this.HWa.setPosition(a.width/2-b/2,a.height/2-c/2);this.HWa.lh(b,c);this.HWa.Rd(!0);this.xb.Rl()}setPosition(a,
b){this.xb.setPosition(a,b)}lD(){}Kj(){}Qq(a){this.xb.QE(a,sA.a.tca)}Yu(a){this.xb.QE(a,sA.a.Ssb)}setZIndex(a){this.xb.OB(a)}Xy(){}bE(){return null}JB(){return[]}draw(){}OE(){}Zp(){return this.Eb?this.xb.Zp():null}get visible(){return this.Eb}set visible(a){this.Eb=a;this.xb.Rd(this.Eb)}get te(){return this.xb}PN(){return!1}Ox(){}setSelection(){}}Object(n.a)(OO,"ShapeProgressIndicatorView",null,[1219,435,436,106]);class PO{create(a){return new OO(a)}}Object(n.a)(PO,"Factory",null,[1166]);var gs=d(325);
class $E{constructor(){this.ez=null;this.Vra=this.tN=this.Wra=0;this.startTime=this.ujd=this.$s=this.LH=this.DC=this.j4b=null}Qjc(){return this.tN<this.ez.wL?Object.assign(new $E,{ez:this.ez,Wra:this.tN,tN:this.tN+Math.min(this.Vra,this.ez.wL-this.tN),Vra:this.Vra,j4b:this.j4b,DC:this.DC,LH:this.LH,$s:this.$s,ujd:this.ujd}):null}}Object(n.a)($E,"ChunkUploadingContext",null,[]);var hs=d(507);class Wv{constructor(a,b,c,f){this.wf=this.BJ=this.BH=null;this.qfc=b;this.Bcc=c;this.Reb=f;this.zb=a}get v9(){return!!this.BH}J1(a,
b,c,f,l,w,H,U=null,ja=null){this.v9?H(new hs.a(Object.assign(new gs.a,{Code:59}))):(ja&&ja.register(Object(F.a)(this,this.abort,"abort")),0<l&&(this.BJ=Object.assign(new Le.a(2,1,l,Object(F.a)(this,this.uM,"onTimeout"),90,"85"),{customData:H}),this.zb.Db(this.BJ)),(this.BH=Object.assign(new $E,{ez:a,j4b:c,Wra:0,tN:0,Vra:b,DC:f,LH:w,$s:H,ujd:U,startTime:new Date}).Qjc())?this.EPb(this.BH):H(new hs.a(Object.assign(new gs.a,{Code:92}))))}EPb(a){this.qfc();if(this.Bcc()||!this.v9)this.reset();else{this.Hxa();
var b=a.ez,c=a.DC,f=a.Wra,l=a.tN,w=a.Vra,H=!f&&l===b.wL,U=new FormData;U.append("Type","2");U.append("FileName",a.ez.fileName);c&&U.append("ImageToken",c);U.append("Content-Range","bytes "+f+"-"+(l-1)+"/"+b.wL);va.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",f,l,w,b.wL);this.wf.onreadystatechange=()=>{this.wf&&4===this.wf.readyState&&this.AHe(a,this.wf.status)};b=H?a.j4b:a.j4b.slice(f,l);U.append("chunk",b);this.wf.send(U)}}AHe(a,
b){let c=Object.assign(new gs.a,{Code:94});if(200===b){this.Reb.Fuc(this.wf.getResponseHeader(Wv.MUd));b=a.ujd;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.wf.responseText)}catch(l){va.a.J(34420810,818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&f.Result){const l=f.Result;a.DC=l.ItemId;const w=a.Qjc();a.Wra===l.XOffset&&l.ItemId?w?(b&&b.Mxk(100*a.tN/a.ez.wL,!1),c=null,this.EPb(w)):(b&&b.Mxk(100,!0),c=null,va.a.J(34420812,
818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.LH(new $g.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else va.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",b,a.DC||"");c&&(this.reset(),a.$s(new hs.a(c)))}Hxa(){this.wf=new XMLHttpRequest;this.wf.open("POST",this.Reb.w$a(),!0);u.AFrameworkApplication.accessToken&&(this.wf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),
this.wf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.L7.toString()));u.AFrameworkApplication.canary&&this.wf.setRequestHeader(Wv.Eqi,u.AFrameworkApplication.canary)}uM(a){va.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.BJ=null;this.abort();(a=a.customData)&&a(new hs.a(Object.assign(new gs.a,{Code:299})))}abort(){if(this.v9){va.a.J(34420818,818,15,"ChunkedPictureUploader::Aborting upload");const a=this.wf;this.reset();a&&a.abort()}}reset(){this.BJ&&
(this.zb.Mg(this.BJ),this.BJ=null);this.BH=this.wf=null}}Wv.Eqi="X-Key";Wv.MUd="X-NewKey";Object(n.a)(Wv,"ChunkedPictureUploader",null,[1149]);class QO{constructor(a,b,c,f){this.zb=a;this.K9j=b;this.qec=c;this.kze=f.pptEditingImageMaxSizeInBytes;this.KHg=Math.floor(.75*this.kze);this.Kck=52428800;this.kFg=f.Fhg&&f.nje;this.zec=f.nje;this.j7c=f.BOj;this.hfc=f.dmg}get ajc(){return this.kFg?this.Kck:this.KHg}get xrc(){return this.zec}get Hqd(){return this.j7c}g1b(a,b){if(b)if(a&&1===a.length){const c=
a[0];c.size<this.KHg?this.convertToBase64AndCallback(a,b):this.kFg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.K9j.create();this.zec?c.NAl(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.kze&&(l=null);this.hfc?b(l):this.zb.Db(new Le.a(2,1,0,()=>{b(l)},90,"83"))}):c.OEh(a,b)}shrinkToBase64AndCallback(a,b){this.qec.Gqg(a,c=>{const f=this.qec.pxh(c,a.size,this.kze);this.hfc?b(f):this.zb.Db(new Le.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(n.a)(QO,
"PPTProcessImageStrategy",null,[1090]);var UR=d(1133);class tA{static get eg(){return ci.a.VA(tA.En,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}tA.En="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(n.a)(tA,
"InsertImageDialogHtml",null,[]);class RO extends ci.a{constructor(a){super();this.Kl=null;this.fw=[];this.rB=a;this.bqf=!1;this.NWa=u.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}bnl(a){this.eg=tA.eg;this.Xe(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(F.a)(this,this.MHj,"insertImageDialogHandler"));if(this.Kl=document.getElementById("fileInput"))this.Kl.setAttribute("accept","image/*"),this.NWa&&a&&this.Kl.setAttribute("multiple","multiple");
a=[];this.Kl&&(Yc.a.addHandler(this.Kl,sa.a.Xf,Object(F.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.Kl));var b=this.XRc(1);b&&a.push(b);(b=this.XRc(0))&&a.push(b);this.fw=a;this.bGl()}validate(){const a=this.rB.Yvd(this.Kl.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.rB.C$i(a);b.style.display="inline-block";return!1}return!0}dispose(){this.Kl&&Yc.a.removeHandler(this.Kl,sa.a.Xf,Object(F.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}MHj(a){1===a&&this.rB.xxk(this.Kl);
this.Kl=null}bGl(){if(0<this.fw.length){const a=new UR.a(this.fw),b=y.FocusManager.instance().yl();b&&(this.fw[0].focus(),b.wj=a,b.rX=!0)}}onKeyDown(a){4!==y.FocusManager.instance().jdh(a)&&a.preventDefault()}}Object(n.a)(RO,"InsertImageDialog",ci.a,[]);class aF{constructor(){this.fXc=this.file=this.fileName=null;this.wVf=!1;this.cHb=null;this.wL=this.imageHeight=this.imageWidth=0;this.d3d=!1}}Object(n.a)(aF,"ImageType",null,[]);class SO{constructor(a,b,c,f,l,w,H,U,ja,wa){this.FPb=0;this.I4c=this.Ggc=
this.iHg=this.wkb=!1;this.UL=[];this.LWa="image/*";this.ia=a;this.Feb=b?b.xa:null;this.LIa=null;this.Sd=c;this.Ngc=f;this.GDe=l;this.R9c=U.pptEditingUploadedImageMaxSizeInBytes;this.kdb=w;this.K7j=H;this.rAe=U.pptEditingUploadLargeImageMaxSizeInBytes;this.kek=U.pptEditingUploadLargeImageChunkSizeInBytes;this.lek=1E3*U.pptEditingUploadLargeImageTimeoutInSeconds;if(this.agb=U.jGk)this.LWa=this.agb.join(",");this.NWa=U.RHj;this.Reb=ja;this.Fe=wa;this.jdc=U.QNi}get s2c(){return this.iHg}set s2c(a){this.iHg=
a;this.Ggc=0<this.rAe&&this.kdb.cSj&&a}get iGk(){return this.Ggc}xxk(a){this.Nsf(a);this.Feb&&this.GDe.oZd(this.Feb,a,Object(F.a)(this,this.FJe,"onUploadFrameInitialized"),Object(F.a)(this,this.R9d,"getPictureUploadEndPoint"),this.LWa,!1,!1)}PDf(){return!(void 0===window.self.FormData||null===window.self.FormData)}Edh(a){if(this.Feb){if(this.jdc){if(this.PDf()){this.GDe.oZd(this.Feb,null,Object(F.a)(this,this.FJe,"onUploadFrameInitialized"),Object(F.a)(this,this.R9d,"getPictureUploadEndPoint"),this.LWa,
a&&this.NWa,!0);this.I4c=!1;return}va.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}B.a.Gj||B.a.lAb||B.a.ozb&&72>B.a.aKc?(this.GDe.oZd(this.Feb,null,Object(F.a)(this,this.FJe,"onUploadFrameInitialized"),Object(F.a)(this,this.R9d,"getPictureUploadEndPoint"),this.LWa,!1,!1),this.I4c=!1):((new RO(this)).bnl(a),this.I4c=!0)}else va.a.J(18643099,822,15,"PictureUploader initialize failed.")}kQi(a){this.Hvd&&(Array.addRange(this.UL,a),this.mJh())}get Hvd(){return 1>
this.UL.length}mJh(){if(!this.Hvd){const a=new aF,b=this.UL[0];b?(a.fileName=this.$2d(b.name),a.d3d=!0,this.kgh(a)):(va.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.UL.length.toString()),Array.clear(this.UL))}}R9d(){return this.Reb.w$a()}FJe(a){this.LIa=a;if(!this.I4c){if(this.jdc&&this.PDf()){a.I0d(Object(F.a)(this,this.Mwk,"onMultipleFileChosen"));return}if(B.a.RF){a.I0d(Object(F.a)(this,this.yzk,"onSingleFileChosen"));return}a=a.I0d(null);if(!a)return;
this.UL.push(a.files[0])}this.LQd()}Nsf(a){if(a)if(this.NWa)for(const b of a.files)this.UL.push(b);else this.UL.push(a.files[0])}Mwk(a){this.Nsf(a);this.LQd()}vPi(a){a=this.Yvd(a.fileName);return 0!==a?(this.LIa&&this.LIa.eNc(),2!==a&&3!==a||this.Ft(90,a),!1):!0}o4b(a){let b=!0;this.s2c&&a.fXc&&!this.EJl(a)&&(this.LIa&&(this.LIa.Pac=!1),b=!1);!a.cHb||!this.wkb&&b||(this.kdb.revokeObjectURL(a.cHb),a.cHb=null);if(b){switch(this.FPb){case 0:this.ia.La(L.a.pQc,2,a);break;case 1:this.ia.La(L.a.l5d,2,a)}this.mJh()}else Array.clear(this.UL)}$2d(a){if(a){let b=
-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}EJl(a){if(a.wL>this.R9c){if(this.Ggc&&a.wL<this.rAe)return va.a.J(34420823,822,50,"Upload large image: {0}",a.wL),a.d3d=!0;va.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.wL/1024/1024,this.R9c/1024/1024);this.Ft(87,4);return!1}return!0}SVi(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+1)}W_e(a,b,c,f=null){if(a.d3d||this.NWa&&1<this.UL.length){const l=
this.LIa,w=this.UL[0];Array.remove(this.UL,w);const H=Rc.a.Ib;H&&H.Va("FChuckedPictureUpload","True");this.K7j().J1(a,this.kek,w,f,this.lek,U=>{l&&(l.Pac=!1,l.dispose());b(U)},U=>{l&&(l.Pac=!1,l.dispose());Array.clear(this.UL);c(U)})}else this.LIa&&(a=this.Sgj(f),this.LIa.gtl(b,c,a)),Array.clear(this.UL)}Sgj(a){const b=new Vc.a;b.$("PresentationId",this.Fe.presentationId.string);b.$(be.a.Tna,this.Fe.sessionInfo);b.$("Canary",u.AFrameworkApplication.canary);b.$("access_token",u.AFrameworkApplication.accessToken);
b.$("Type",this.FPb.toString());a&&b.$("ImageToken",a);return b}yzk(a){a&&(Array.add(this.UL,a.files[0]),this.LQd())}LQd(){if(this.Hvd||!this.UL[0])Array.clear(this.UL);else{var a=new aF;a.fileName=this.$2d(this.UL[0].name);this.LIa.Pac=!0;this.kgh(a)}}kgh(a){this.vPi(a)?this.s2c?this.qSk(a):this.o4b(a):Array.clear(this.UL)}Yvd(a,b=!1){if(a&&a.length){if(1===this.FPb&&this.NWj(a))return va.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),3;if(this.ycg(a))return 0;
this.SVi(a)?va.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):va.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.FPb?3:2}return 1}NWj(a){return!!a&&0<a.length&&ha.a.rg(a).endsWith(".svg")}C$i(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.Ing()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;case 3:return ResourceStrings.l_InvalidImageErrorMessage;
default:return""}}Ing(){return this.ycg(".svg")}ycg(a){a=ha.a.rg(a);for(let b=0;b<this.agb.length;++b)if(this.agb[b]&&0<this.agb[b].length&&a.endsWith(this.agb[b].trim().toLowerCase()))return!0;return!1}Ft(a,b){if(87===a){const c=this.Ggc?this.rAe:this.R9c;this.Sd.cH(a,f=>{f.mC=1;f.$Ra=[(c/1024/1024).toString()];return!1})}else{const c=this.B$i(b);this.Sd.cH(a,f=>{f.mC=1;f.message=c;return!1})}}B$i(a){return 2===a&&this.Ing()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.agb.join(", ")):ResourceStrings.invalidImageFileError}qSk(a){let b=this.UL[0];if(b){a.wL=b.size;a.file=b;if(b.size>this.R9c&&this.Ggc)try{b=b.slice(0,6),a.wVf=!0}catch(c){va.a.J(34420828,822,50,"File.slice throw exception"),this.wkb=!0,this.o4b(a)}this.Ngc.igh(b,c=>{this.$4i(c,a)})}}$4i(a,b){try{let c=a.target.result;b.fXc=c;b.wVf&&(c=this.kdb.createObjectURL(b.file),b.cHb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.kKj(b.fXc)&&(this.wkb=!0,va.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.o4b(b)};f.onerror=()=>{va.a.J(20828428,822,50,"Read image failed");this.wkb=!0;this.o4b(b)};f.src=c}catch(c){va.a.J(20828430,822,50,"GetBase64Image throw exception"),this.wkb=!0,this.o4b(b)}}kKj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(n.a)(SO,"PictureUploader",null,[1148]);class TO{constructor(a){this.Fe=a}w$a(){let a="pptPictureUpload.ashx";if(Pc.App.webServiceBase)a=Pc.App.webServiceBase+
a;else if(B.a.fg||B.a.Kua)a=ig.a.ita(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.kTa(),this.Fe.presentationId.string,u.AFrameworkApplication.r5b());this.Fe.podSessionId&&(a+=String.format("&{0}={1}",be.a.iaa,this.Fe.podSessionId));this.Fe.qk&&(a+=String.format("&waccluster={0}",this.Fe.qk));return a}Fuc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}u.AFrameworkApplication.canary=a;u.AFrameworkApplication.Cbc&&
va.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(n.a)(TO,"PictureUploaderHelper",null,[1147]);class uA{constructor(a,b,c,f,l,w,H,U,ja,wa){this.Pac=!1;this.dU=null;this.kma=!1;this.wf=this.RX=this.wXa=this.Sdc=this.Cic=this.Kl=this.Cx=this.vve=null;this.kf=a;this.oak=f;this.Fe=c;this.O9=l;this.fDb=w;b&&(this.Kl=b.cloneNode(!0));this.r$j=H;this.LWa=U;this.jdk=ja;(this.Wcb=wa)?this.dTf():this.SCi()}SCi(){this.dU=document.createElement("iframe");this.dU.style.visibility=
$i.a.hidden;this.dU.id=uA.Noi;this.dU.className="ObjectInDialog";this.kf.appendChild(this.dU);this.Cic=Object(F.a)(this,this.h8g,"onUploadFrameLoad");Yc.a.addHandler(this.dU,"load",this.Cic);B.a.RF&&this.h8g(null)}I0d(a){u.AFrameworkApplication.Aa.Vhb();if(!this.Kl)return null;this.Wcb?Yc.a.addHandler(this.Kl,"change",()=>{this.$Xi(a)}):B.a.RF&&(this.vve=a,this.Sdc=Object(F.a)(this,this.cQc,"fileInputChange"),Yc.a.addHandler(this.Kl,"change",this.Sdc));try{this.Kl.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);va.a.J(19505501,818,10,c);return null}return this.Kl}$Xi(a){a&&a(this.Kl)}cQc(){this.vve&&this.vve(this.Kl)}gtl(a,b,c){a||va.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||va.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.wXa=a;this.RX=b;if(c.Gb("ImageToken")||c.Gb("AudioToken"))a=this.Cx.action,a+=String.format("&{0}={1}",be.a.sDk,1),this.Fe.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.Cx.action=a;for(let f of c.keys)this.$6h(f,c.ga(f));this.Wcb?this.htl():this.Cx.submit()}htl(){try{va.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.Cx);this.I9k(a)}catch(a){va.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.Wuc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.eNc()}}I9k(a){if(a){const b=this.Cx.action;this.wf=
new XMLHttpRequest;this.wf.open("POST",b);this.wf.onreadystatechange=Object(F.a)(this,this.EAk,"onUploadResponseReceived");this.wf.send(a)}}EAk(){4===this.wf.readyState&&(this.wf.status===Nk.a.Wv?this.Wuc(this.wf.responseText):(va.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.wf.status,this.wf.responseText?!1:!0),this.Wuc("Upload request failed")),this.eNc())}dispose(){this.O9(this);this.Wcb&&this.kf?this.kf.removeChild(this.Cx):this.kf&&this.dU&&(this.kf.contains(this.dU)&&
this.kf.removeChild(this.dU),this.Cic&&Yc.a.removeHandler(this.dU,"load",this.Cic),this.Cic=null);this.Sdc&&(Yc.a.removeHandler(this.Kl,"change",this.Sdc),this.Sdc=null);this.dU=this.Kl=this.Cx=this.kf=null}$6h(a,b){const c=this.oFi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.Cx.appendChild(c)}oFi(){return this.Wcb?document.createElement("input"):this.dU.contentWindow.document.createElement("input")}h8g(a){try{if(!this.dU.contentWindow.document.body)return}catch(b){va.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.Wuc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.kma?this.wXa?(this.Wuc(this.Eoj(this.dU.contentWindow.document.body)),this.eNc()):va.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.dTf()}dTf(){if(!this.kma){const a=this.r$j();this.Wcb?(this.Cx=document.createElement("form"),this.kf.appendChild(this.Cx)):(this.Cx=this.dU.contentWindow.document.createElement("form"),this.dU.contentWindow.document.body.appendChild(this.Cx));
this.AEi();this.Cx.id="formId";this.Cx.method="post";this.Cx.encoding="multipart/form-data";this.Cx.action=a;this.Cx.appendChild(this.Kl);this.kma=!0;this.oak(this)}}AEi(){this.Kl||(this.Wcb?(this.Kl=document.createElement("input"),this.Kl.style.opacity="0",this.jdk&&(this.Kl.multiple="multiple")):this.Kl=this.dU.contentWindow.document.createElement("input"),this.Kl.type="file",this.Kl.accept=this.LWa,this.Kl.id="fileInputId",this.Kl.name="fileInputId")}delayedDispose(){this.dispose()}eNc(){const a=
new Le.a(2,1,0,Object(F.a)(this,this.delayedDispose,"delayedDispose"),90,"82");u.AFrameworkApplication.ye.Db(a)}Wuc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){va.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.wXa?this.wXa(new $g.a(b.Result)):va.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new gs.a,
{Code:94}),this.RX?this.RX(new hs.a(a)):va.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}Kil(){return this.kma&&!this.Pac}Eoj(a){let b=null;this.fDb?(this.FYk(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=B.a.Gj?a.innerText:a.innerHTML;return b||"No response got from server"}FYk(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}uA.Noi="ppt_uploadframe";Object(n.a)(uA,
"UploadFrame",null,[1214,1215,1216]);class UO{constructor(a,b){this.ECb=[];this.Fe=a;this.fDb=b}oZd(a,b,c,f,l,w,H){if(0<this.ECb.length)for(let U=this.ECb.length-1;0<=U;U--)this.ECb[U].Kil()&&this.ECb[U].dispose();a=new uA(a,b,this.Fe,c,Object(F.a)(this,this.POi,"disposeHandler"),this.fDb,f,l,w,H);Array.add(this.ECb,a)}POi(a){Array.remove(this.ECb,a)}}Object(n.a)(UO,"UploadFrameFactory",null,[1146]);class VO extends Bq{constructor(a,b,c,f,l){super(a,b);this.ic=c;this.pa=f;this.Fec=l}Sr(a){var b="";
if(this.Fec){const c=jo.SchemeColor.parse(a);c&&(c.color&&!c.Nta&&(b=Object(qa.a)(115,this.ic.jg(this.pa.Na.mb.Ua.node)),(b=c.resolve(b?b.Jd:null))?c.ZP=Bl.g(b.D_a):va.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Bl.c(a))),b=c.toString());va.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Bl.c(b));this.Yk.setValue(hb.a.schemeColor,b);c&&c.Nta&&(a=Bl.i(c.ZP))}ha.a.Wa(a)||super.Sr(a)}}Object(n.a)(VO,"PptInsertionPointFormatting",
Bq,[]);class bF{constructor(){this.Vra=this.tN=this.Wra=0;this.packageKey=this.Rx=this.tpa=null;this.TKb=this.CYa=this.RZ=0;this.startTime=this.$s=this.LH=null}Qjc(){return this.tN<this.tpa.length?Object.assign(new bF,{Wra:this.tN,tN:this.tN+Math.min(this.Vra,this.tpa.length-this.tN),Vra:this.Vra,tpa:this.tpa,Rx:this.Rx,packageKey:this.packageKey,LH:this.LH,$s:this.$s,RZ:0,CYa:this.CYa,TKb:this.TKb,startTime:new Date}):null}}Object(n.a)(bF,"ChunkContext",null,[]);class WO{constructor(a,b,c,f,l){this.wf=
this.BJ=this.BH=null;this.qfc=b;this.Bcc=c;this.zb=a;this.Fe=f;this.Lv=l}get v9(){return!!this.BH}J1(a,b,c,f,l,w,H,U,ja){this.v9?(va.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.BH.Rx,f),ja&&ja(new hs.a(Object.assign(new gs.a,{Code:59})))):(0<l&&(this.BJ=Object.assign(new Le.a(2,1,l,Object(F.a)(this,this.uM,"onTimeout"),90,"85"),{customData:ja}),this.zb.Db(this.BJ)),(this.BH=Object.assign(new bF,{Wra:0,
tN:0,Vra:a,tpa:b,packageKey:c,Rx:f,LH:U,$s:ja,RZ:0,CYa:w,TKb:H,startTime:new Date}).Qjc())?this.EPb(this.BH):(va.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),ja&&ja(new hs.a(Object.assign(new gs.a,{Code:437})))))}Pqi(a){this.v9&&(va.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.BH.Rx),this.BH.Rx===a&&this.abort())}EPb(a){this.qfc();if(this.Bcc()||!this.v9)va.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.Rx),this.reset();else{var b=this.Hxa(a);this.wf.onreadystatechange=()=>{this.wf&&4===this.wf.readyState&&this.AHe(a,this.wf.status)};this.wf.send(b)}}AHe(a,b){let c=Object.assign(new gs.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.wf.responseText)}catch(f){va.a.J(512496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.Rx)}if(b&&!b.Error&&b.Result){const f=a.Qjc();f?(this.Lv.pMa(100*a.tN/
a.tpa.length),this.EPb(f)):(va.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.Rx),this.Lv.pMa(100),this.reset(),a.LH&&a.LH(new $g.a(b.Result)))}b&&(c=b.Error)}else va.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.Rx);c&&(a.RZ<a.CYa?(va.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.Wra,a.tN,a.Rx),window.setTimeout(()=>{a.RZ++;this.EPb(a)},a.TKb)):(va.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Wra,a.tN,a.Rx),this.reset(),a.$s&&a.$s(new hs.a(c))))}Hxa(a){this.wf=new XMLHttpRequest;this.wf.open("POST",this.w$a(),!0);u.AFrameworkApplication.accessToken&&(this.wf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.wf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.L7.toString()));
const b=a.packageKey,c=a.Wra,f=a.tN,l=!c&&f===a.tpa.length,w=new FormData;w.append("FileName",a.Rx);b&&w.append("PackageKey",b);w.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.tpa.length);va.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,f,a.tpa.length,a.Rx);a=l?a.tpa:a.tpa.slice(c,f);w.append("ChunkData",a);return w}w$a(){let a="PastedDataUpload.ashx";if(Pc.App.webServiceBase)a=Pc.App.webServiceBase+a;else if(B.a.fg||
B.a.Kua)a=ig.a.ita(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.kTa(),this.Fe.presentationId.string,u.AFrameworkApplication.r5b());this.Fe.podSessionId&&(a+=String.format("&{0}={1}",be.a.iaa,this.Fe.podSessionId));this.Fe.qk&&(a+=String.format("&waccluster={0}",this.Fe.qk));return a}uM(a){va.a.J(512496864,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.BH.Rx);this.BJ=null;this.abort();(a=a.customData)&&a(new hs.a(Object.assign(new gs.a,{Code:299})))}abort(){if(this.v9){va.a.J(512496863,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.BH.Rx);const a=this.wf;this.reset();a&&a.abort()}}reset(){this.BJ&&(this.zb.Mg(this.BJ),this.BJ=null);this.BH=this.wf=null}}Object(n.a)(WO,"ChunkedDataUploader",null,[1151]);class XO{constructor(){this.w9j=new kc.a(Object(F.a)(this,this.tLj,"isBrowerSupportObjectUrl"))}get cSj(){return this.w9j.value}tLj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(n.a)(XO,"PPTFileApiHelper",null,[1167]);class YO{yLj(){return window.FileReader?!0:!1}igh(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}$2d(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(n.a)(YO,"PPTFileReaderHelper",null,[1163]);var VR=d(967),WR=d(625),Fo;(function(a){a.Accent1="#4472C4";a.Accent2=
"#ED7D31";a.Accent3="#A5A5A5";a.Accent4="#FFC000";a.Accent5="#5B9BD5";a.Accent6="#70AD47";a.Hyperlink="#0563C1";a.ClickedHyperlink="#954F72";a.LightBackground="#FFFFFF";a.DarkBackground="#000000";a.TextColorLight="#E7E6E6";a.TextColorDark="#44546A"})(Fo||(Fo={}));Object(n.b)("DefaultOfficeThemeColorScheme",Fo);var vA;(function(a){a.ThemeFamilyId="{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}";a.VariantId="{4A3C46E8-61CC-4603-A589-7422A47A8E4A}"})(vA||(vA={}));Object(n.b)("DefaultOfficeThemeFamily",vA);const Ml=
a=>{if(a)return"#"+(16777216+(a.r<<16)+(a.g<<8)+a.b).toString(16).slice(1);va.a.J(509207453,811,10,"Color is null")};var YR=d(334),ZR=d(447),$R=d(305),ZO=d(539),Xv;(function(a){a.Insert="Insert";a.ReplaceAll="ReplaceAll"})(Xv||(Xv={}));Object(n.b)("MergeAction",Xv);var dp;(function(a){a.ChatPPTExitClicked="ChatPPTExitClicked";a.ChatPPTLikeClicked="ChatPPTLikeClicked";a.ChatPPTDislikeClicked="ChatPPTDislikeClicked";a.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked";a.ChatPPTShowDesigner="ChatPPTShowDesigner";
a.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart";a.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete";a.ChatPPTExecuteInsertSlideOperation="ChatPPTExecuteInsertSlideOperation";a.ChatPPTInsertSlideCompleted="ChatPPTInsertSlideCompleted";a.ChatPPTSearchClicked="ChatPPTSearchClicked";a.ChatPPTSearchCompleted="ChatPPTSearchCompleted";a.ChatPPTSlideUpdateCheckSuccessful="ChatPPTSlideUpdateCheckSuccessful"})(dp||(dp={}));Object(n.b)("ChatPPTEvents",dp);class $O{constructor(a,b,c,f,l,
w,H,U,ja,wa,Sa,eb){this.u0=!1;this.Eeb=null;this.Ccd=this.fEg=!1;this.Tu=ub=>{const Ub=ui.a.I3(kx.a.BZa,!1);Object(Pd.a)("ToggleRibbonModeOnModeSwitch")&&1!==ub.mode&&(this.la.eB&&Ub||this.la.$W)&&!this.u0&&this.showTaskPane()};this.$yk=ub=>{ub&&(this.u0=!1,va.a.J(509166466,811,50,"Copilot: Close SDX in offline mode"))};this.hZe=(ub,Ub,cc)=>{if(1==cc)return 32;this.u0?(this.Urg(!1),this.VGf()):(this.Urg(!0),this.showTaskPane());return 32};this.Nnc=(ub,Ub,cc,Fc,Ic)=>{if(!Ic)return 8;null===Ic||void 0===
Ic?void 0:Ic.Lf(this.u0);return 32};this.Ixl=(ub,Ub)=>{this.u0||this.fEg||!(this.la.eB&&"SingleLine".match(appChrome.selectors.getRibbonMode())||this.la.$W)?this.u0&&"Multiline".match(appChrome.selectors.getRibbonMode())&&Ub.ame?this.VGf():!this.u0&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&Ub.ame&&this.showTaskPane():this.showTaskPane()};this.M7d=()=>{const ub={};ub.XE=this.la.$W?"Copilot (Preview)":"What do you want to do? [Beta]";ub.UBh=this.la.$W?"Copilot (Preview)":"What do you want to do?";
ub.assetId="FA000000121";ub.nonPersistedSettings=this.c6i();ub.H5=this.bhb;Object(Pd.a)("AddClassOnSDXPaneContainer")&&(ub.SBh="ActionAITaskPane");return ub};this.tJa=(ub,Ub)=>{Ub&&(ub=Ub.instanceId)&&ub.length&&this.Eeb===ub&&(this.u0=!1,this.Eeb=null,Object(Pd.a)("EnableChatPPTEventListenerFromSDX")&&this.tsl())};this.bhb=()=>{this.Eeb=this.VSa();this.fEg=this.u0=!0;Object(Pd.a)("EnableChatPPTEventListenerFromSDX")&&this.xrl()};this.Obl=()=>{sj.UISurfaces.zr().then(ub=>{const Ub=this.VSa();Ub&&
ub.setSelectedTaskPane(Ub);return null}).catch(ub=>{va.a.J(509354912,811,10,"ChatPPTPane::SelectPane exception: {0}",ub.toString())})};this.MIk=ub=>Object(al.a)(this,void 0,void 0,function*(){var Ub=ub.slides;let cc=[];for(var Fc of Ub){var Ic=Fc;if(!Ic)throw Error.argumentNull("slideData");var Cc=Ic.Images;Ub=[];var Ud=[];for(var je of Cc)je&&(Ub.push(je.Prompt),Ud.push({Url:je.Url,Format:""}));Cc=Ic.Title;const Vd=Ic.KeyPoints;Ic=Ic.Notes;Cc&&Vd||va.a.J(509207452,811,15,"Copilot:InvalidOutlineInfo={0}{1}",
Cc?"":"slideTitle;",Vd?"":"keyPoints;");cc.push({Title:Cc,ImagesQuery:Ub,Images:Ud,KeyPoints:Vd,Notes:Ic})}je={Title:"",Slides:cc};Ub=this.ua.Ba;Fc=this.ua.currentSlideIndex;Ub||va.a.J(509207493,811,15,"Slide Node is Null. Using Office Default Theme Values");Ud=this.la.ka("ChatPPTUseColorSwapFix");Ub&&Ub.Jd?Ud=Ud?{["Accent1"]:Ml(Ub.Jd.Accent1),["Accent2"]:Ml(Ub.Jd.Accent2),["Accent3"]:Ml(Ub.Jd.Accent3),["Accent4"]:Ml(Ub.Jd.Accent4),["Accent5"]:Ml(Ub.Jd.Accent5),["Accent6"]:Ml(Ub.Jd.Accent6),["Hyperlink"]:Ml(Ub.Jd.Hyperlink),
["ClickedHyperlink"]:Ml(Ub.Jd.FollowedHyperlink),["TextColorLight"]:Ml(Ub.Jd.Light1),["TextColorDark"]:Ml(Ub.Jd.Dark1),["LightBackground"]:Ml(Ub.Jd.Light2),["DarkBackground"]:Ml(Ub.Jd.Dark2)}:{["Accent1"]:Ml(Ub.Jd.Accent1),["Accent2"]:Ml(Ub.Jd.Accent2),["Accent3"]:Ml(Ub.Jd.Accent3),["Accent4"]:Ml(Ub.Jd.Accent4),["Accent5"]:Ml(Ub.Jd.Accent5),["Accent6"]:Ml(Ub.Jd.Accent6),["Hyperlink"]:Ml(Ub.Jd.Hyperlink),["ClickedHyperlink"]:Ml(Ub.Jd.FollowedHyperlink),["LightBackground"]:Ml(Ub.Jd.Light1),["DarkBackground"]:Ml(Ub.Jd.Dark1),
["TextColorLight"]:Ml(Ub.Jd.Light2),["TextColorDark"]:Ml(Ub.Jd.Dark2)}:(va.a.J(509207489,811,50,"Slide Node is Null. Using Default Office Theme Color Scheme"),Ud={["Accent1"]:Fo.Accent1,["Accent2"]:Fo.Accent2,["Accent3"]:Fo.Accent3,["Accent4"]:Fo.Accent4,["Accent5"]:Fo.Accent5,["Accent6"]:Fo.Accent6,["Hyperlink"]:Fo.Hyperlink,["ClickedHyperlink"]:Fo.ClickedHyperlink,["LightBackground"]:Fo.LightBackground,["DarkBackground"]:Fo.DarkBackground,["TextColorLight"]:Fo.TextColorLight,["TextColorDark"]:Fo.TextColorDark});
Ic=this.ua;Ub&&(null===Ic||void 0===Ic?0:Ic.presentation)&&Ic.presentation.I6b(Ub)?Ic="{"+Ic.presentation.I6b(Ub).ThemeFamilyId+"}":(va.a.J(509207490,811,50,"Slide Node is Null. Using Default Office Theme Family Id"),Ic=vA.ThemeFamilyId);je={OutlineInput:{ColorScheme:Ud,PresOutline:je,ThemeIds:[Ic],FRenderFirstThumb:!0},ClientName:"ChatPPT",MergeAction:ub.mergeAction?ub.mergeAction:Xv.Insert,CorrelationId:void 0,InsertPosition:{ReferenceSlide:{Cid:null===Ub||void 0===Ub?void 0:Ub.cid,Sid:null===Ub||
void 0===Ub?void 0:Ub.sid},InsertBefore:!1}};va.a.J(509166875,811,15,"Copilot:MergeAction={0}",ub.mergeAction);je=yield this.iWa.AZf(je);return{slideIndex:-1===Fc||ub.mergeAction===Xv.ReplaceAll?cc.length-1:Fc+cc.length,success:je}});this.Vfl=ub=>{ub||va.a.J(509166874,811,10,"No data received from SDX");try{const Ub=JSON.parse(ub),cc=Ub.mergeAction===Xv.ReplaceAll?1:Ub.slideIndex;!cc||!this.oc.qj()||cc>this.oc.qj()?va.a.J(509166371,811,10,"Copilot:Invalid Slide Index provided to set focus"):this.la.Ln?
this.cYa.value.IJ(cc):this.Ge.IJ(cc)}catch(Ub){va.a.J(509166873,811,10,"Copilot:Unexpected Error Occurred setting slideIndex:{0}",Ub.toString())}};this.eIj=ub=>{if(null==ub)va.a.J(509207492,811,10,"No message received from SDX");else if(Object(Pd.a)("pptCreatorServiceForCopilotEnabled")){let Ub;try{Ub=JSON.parse(ub)}catch(cc){va.a.J(509207491,811,10,"Unexpected error parsing sdx request data {0}",cc.toString());return}this.MIk(Ub).then(cc=>{cc?(va.a.J(509211359,811,15,"Copilot:InsertSlideSuccessful={0}",
cc.success),this.n9k(JSON.stringify(cc))):va.a.J(509166872,811,10,"Copilot:No Response From API")}).catch(cc=>{va.a.J(509211358,811,10,"Copilot: Unexpected error in insert slide operation from copilot?: {0}",cc.toString())})}};this.n9k=ub=>{if(this.Eeb){var Ub=document.getElementById(this.Eeb);null==Ub?va.a.J(509196E3,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.u0):(ub={type:dp.ChatPPTInsertSlideCompleted,message:ub},Ub.contentWindow&&Ub.contentWindow.postMessage(ub,"*"))}else va.a.J(509166871,
811,10,"Copilot: SDX instance id is null",this.u0)};this.WEf=ub=>{if(null!==ub&&void 0!==ub&&ub.data)switch(ub.data.type){case dp.ChatPPTExecuteInsertSlideOperation:this.eIj(ub.data.message);break;case dp.ChatPPTShowDesigner:this.ia.processAction(L.a.I8g,2);break;case dp.ChatPPTQueryExecutionStart:this.la.eB&&this.ia.processAction(L.a.Qvb,2);break;case dp.ChatPPTQueryExecutionComplete:this.la.eB&&this.Obl();break;case dp.ChatPPTExitClicked:Object(Pd.a)("EnableFeedbackInChatPPTMode")?this.HBk():this.yUf();
break;case dp.ChatPPTLikeClicked:Object(Pd.a)("EnableFeedbackInChatPPTMode")&&this.Wsk();break;case dp.ChatPPTDislikeClicked:Object(Pd.a)("EnableFeedbackInChatPPTMode")&&this.Vsk();break;case dp.ChatPPTSearchClicked:this.$rl(ub.data.message);break;case dp.ChatPPTSlideUpdateCheckSuccessful:Object(Pd.a)("SetFocusFromSDX")&&this.Vfl(ub.data.message)}};this.ia=a;this.Yc=b;if(!c&&Object(Pd.a)("EnableChatPPTPaneOnEditingMode"))throw Error.argumentNull("appFrame");this.la=w;this.Jbk=H;this.Lpe=l;this.Yc.execute(ub=>
{ub.WGc(this.tJa)});f&&(this.je=f,this.je.vci(this.Ixl));Object(Pd.a)("EnableChatPPTPaneOnEditingMode")&&c.RK(ub=>{this.Tu(ub)});(this.la.$W||this.la.eB)&&Object(Pd.a)("EnhancementOfSDXPaneBootTime")&&db.a.get_instance().Uj(8,()=>{this.showTaskPane()});if(!U)throw Error.argumentNull("graphTopologyManager");if(!ja)throw Error.argumentNull("copilotProxy");if(this.la.Ln&&!wa)throw Error.argumentNull("sorterViewActorLazy");if(!this.la.Ln&&!Sa)throw Error.argumentNull("thumbnailNavigationPaneView");if(!eb)throw Error.argumentNull("presentationReader");
this.ua=U;this.iWa=ja;this.Ge=Sa;this.cYa=wa;this.oc=eb;Object(Pd.a)("FixAddInPaneVisibilityInOfflineMode")&&c&&(null===c||void 0===c?void 0:c.HPa(this.$yk))}wb(){this.ia.ya(L.a.Z_b,Cb.a.view,this.hZe);this.ia.ya(L.a.Z_b,Cb.a.notes,this.hZe);this.ia.ya(L.a.Z_b,Cb.a.Of,this.hZe);this.ia.le(L.a.Z_b,4);Object(Pd.a)("ShowEnabledStateOfChatPPT")&&this.ia.ra(L.a.Nnc,Cb.a.application,this.Nnc,96)}Ee(){}Urg(a){Object(Pd.a)("logTelemetryForOpenClosePane")&&va.a.J(509613323,811,15,"ChatPPT-IsOpen:"+a)}showTaskPane(){if(this.u0)return 8;
const a=this.M7d();if(!a)return 8;this.ia.La(L.a.lga,2,a);return 32}VGf(){this.u0&&this.Eeb?this.ia.La(L.a.Ftb,2,this.Eeb):this.u0=!1}c6i(){return Object(Pd.a)("NewSettingsForChatPPT")?{ChatPPTSessionID:gh.a.create().toString(),AugloopClouldALServiceUrl:u.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl"),ShouldUseEnvSpecificALUrl:this.Jbk?"true":"false",PPTCreatorEnabled:Object(Pd.a)("pptCreatorServiceForCopilotEnabled")&&(this.la.$W||this.la.eB)?"true":"false",PPTClientOrigin:window.location.origin,
PPTCopilotSearchEnabled:!Object(Pd.a)("pptCopilotSearch")}:{mNl:gh.a.create(),kNl:u.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl")}}VSa(){var a;if(null!==(a=this.Yc)&&void 0!==a&&a.instance)return a=this.Yc.instance.oQ("FA000000121"),null===a||void 0===a?void 0:a.instanceId;va.a.J(509207495,811,10,"Instance is null")}Kxl(){appChrome.onRibbonModeToggle()}yUf(){this.Kxl()}HBk(){va.a.J(509613280,811,15,"Chat PPT opt out via SDX");this.$Ye("optOut",!1,!0)}Wsk(){va.a.J(509613250,811,15,"Chat PPT like button clicked");
this.$Ye("like",!0,!1)}Vsk(){va.a.J(509613249,811,15,"Chat PPT dislike button clicked");this.$Ye("dislike",!1,!1)}$Ye(a,b,c){if(this.Lpe){var f=null;if(c){let l=this;f=function(){l.yUf()}}try{b?this.Lpe.bol(a,f):this.Lpe.Lml(a,f)}catch(l){va.a.J(509613584,811,10,"Missed opening dialog; Error:"+l.toString()+" isLikeDialog:"+b+" exitChatPPTMode:"+c),f(!1)}}else va.a.J(509613464,811,10,"ActionAIFeedback is received as null")}$rl(a){a&&!Object(Pd.a)("pptCopilotSearch")&&(a=Object.assign(new YR.a,{selection:Object.assign(new ZR.a,
{neighborhood:a,mentionStart:0,mentionLength:null===a||void 0===a?void 0:a.length}),launchData:Object.assign(new $R.a,{landingTab:Object(Pd.a)("pptCopilotSearchLandingTab")?"File":"All"}),entryPoint:Object(Pd.a)("Microsoft.Office.SharedOnline.ChangeGate.UseCopilotEntrypointForDeckGen")?ZO.a.powerPointCopilot:ZO.a.searchBoxGenerateDeck}),this.ia.La(G.a.FYc,2,a),a=document.getElementById(this.VSa()),null==a&&va.a.J(509196033,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.u0),a.contentWindow.postMessage({type:dp.ChatPPTSearchCompleted,
message:"1"},"*"))}xrl(){this.Ccd||(window.addEventListener("message",this.WEf),this.Ccd=!0)}tsl(){this.Ccd&&(window.removeEventListener("message",this.WEf),this.Ccd=!1)}}Object(n.a)($O,"ActionAIActor",null,[365]);class aP{constructor(a,b){this.PEl=(c,f,l,w,H)=>{if(1===l)return 32;c=this.la.VCa?"DataSync: Fluid":"DataSync: Box4";H[Fp.a.Value]=c;H[hm.a.labelText]=c;H[Fp.a.Visible]=!0;return 32};if(!a||!b)throw ka.ULS.sendTraceTag(509384847,844,10,"DataSyncActor:IActor: ActionManager or appSettings should not be null."),
Error.argumentNull("actionManager and appSettings cannot be null.");this.ia=a;this.la=b}wb(){this.ia.ra(L.a.$dh,Xd.a.frame,this.PEl,96)}Ee(){}}Object(n.a)(aP,"DataSyncActor",null,[365]);class bP{constructor(a){this.Zre=a}bol(a,b){let c=this.C1f();c.initialFeedbackType="Smile";this.showDialog(a,c,b)}Lml(a,b){let c=this.C1f();c.initialFeedbackType="Idea";this.showDialog(a,c,b)}showDialog(a,b,c){function f(w){va.a.J(509613319,811,15,"Feedback dialog dismissed. FeedbackSent:"+w+" Source:"+a);c&&c(w)}
let l=this.$s;sj.UISurfaces.f5f().then(w=>{w.initializeFeedbackModal(b,f,l)})}$s(a){va.a.J(509613318,811,10,"Error in submitting feedback: "+a)}C1f(){var a={};u.AFrameworkApplication.fa.jPd(a);a=this.Zre.getContext(a)||{};a.uiType="Modal";a.screenshot=!0;a.showEmailAddress=!0;let b=a.telemetryGroup||{};b.processSessionId=a.sessionId;b.officeBuild=a.build;b.featureArea="Chat PPT";a.telemetryGroup=b;return a}}Object(n.a)(bP,"ActionAIFeedback",null,[]);var aS=d(1022),bS=d(1258);class cP{constructor(a){this.X0a=
(b,c,f)=>{var l;c=new aS.a(new kc.a(()=>Pc.App.Kb?Pc.App.Kb.Ld.zi:null),na.InteractiveViewManager.instance,Ab.a.instance.rb("Box4.ISelectionFactory"),Ab.a.instance.rb("PowerPointWebEditor.ISlideReader"),Ab.a.instance.rb("PowerPointWebEditor.IPPTWorkspace"),Ab.a.instance.rb("PowerPointWebEditor.Graph.IGraphTopologyManager"),new bS.a,Ab.a.instance.rb("Common.IActionManagerExtended"),Ab.a.instance.rb("PowerPointWebEditor.IPptSelectionManager"),Ab.a.instance.rb("PowerPointWebEditor.IClipServiceManager"),
Ab.a.instance.rb("PowerPointWebEditor.IPresentationReader"));b=b===L.a.X0a?c.getSelectedSlidesAsPPTXStream():c.getAllSlidesAsPPTXStream();if(null===(l=null===b||void 0===b?void 0:b.selectedSlideIDs)||void 0===l||!l.length)return 16;if(1===f)return 2>b.selectedSlideIDs.length?16:32;this.ia.La(G.a.JYc,2,b);return 32};if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.wb()}wb(){this.ia.ya(L.a.X0a,nc.a.application,this.X0a);this.ia.ya(L.a.H0e,nc.a.application,this.X0a)}Ee(){}}Object(n.a)(cP,
"AICopilotActor",null,[365]);var dP=d(1046),cS=d(1006);class eP{constructor(){this.byg=this.wad=this.Dwe=this.Ewe=this.gCe=this.pB=this.Yla=this.K=null}get name(){return"PowerPointWebEditor.Actor"}Ska(a){return a.resolve("PowerPointWebEditor.IApplicationSettings").eB||a.resolve("PowerPointWebEditor.IApplicationSettings").$W}Zb(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");a.resolve("PowerPointWebEditor.IApplicationSettings").CPj?a.register(1136,"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>
new rO(new AE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").Yzb,a.resolve("PowerPointWebEditor.IApplicationSettings").emg,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):
a.register(1136,"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>new AE(a.resolve("Box4.IFormattingEditor")));this.Ska(this.K)&&Pd.a("EnhancementOfSDXPaneBootTime")&&a.register(dP.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new dP.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),
this.Ska(this.K))).ma();a.register(1137,"PowerPointWebEditor.IGraphTransactionHelper").ma().oa(()=>new cN(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.Ja("PowerPointWeb.Comments.ICommentFrame")));a.register(1138,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().oa(()=>new pN(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(1039,"Box4.IInsertionPointFormatting").ma().oa(()=>
new VO(a.rb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").$_c));a.register(1139,"Box4.IClipboardCommands").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?new xE(u.AFrameworkApplication.Ta,L.a.rbh,L.a.Wid,L.a.Xid,L.a.Bbh):new xE(u.AFrameworkApplication.Ta,D.a.b_b,D.a.HIc,
D.a.d8,D.a.Rhd));a.register(1130,"HtmlImport.IHtmlNormalizerSettings").ma().oa(()=>new yC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(1088,"HtmlImport.IHtmlTranslatorSettings").ma().oa(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new mC(c.Clg&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),void 0,void 0,void 0,!0,c.CUa||c.WEk,c.CUa,c.pptCopyPasteTextWithHighlight,c.CUa,c.CUa||c.pptCopyPasteFontFamilyEnabled,
void 0,c.pptCopyPasteMarginAndIndentationEnabled,a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,c.CUa,f=>f.J9b&&c.xle,()=>c.Jle)});a.register(1076,"Box4.Actors.IBox4PasteStewardBridge").ma().oa(()=>new tO(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),
a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(wE.a,"Common.PressOnlyKeyEvent").ma().oa(()=>wE.a.instance());a.register(XE,"PowerPointWebEditor.PasteFromFloatieArgs").ma().oa(()=>new XE);a.register(1140,"PowerPointWebEditor.IPasteFloatieHelper").ma().oa(()=>new vO(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").lmg,a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").tCa));a.register(yE,
"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().oa(()=>new yE);a.register(215,"Box4.IContextSetEditor").ma().oa(()=>vh.ContextSetEditor.instance);a.register(1141,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().oa(()=>new sO(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));
a.register(kt,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().oa(()=>new kt(a.rb("Box4.IAutoCorrectScheduler"),a.ke("Box4.IUndoManager"),a.Ja("Box4.IExternalSelectionManager")));a.register(WE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().oa(()=>new WE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(1142,"Box4.Actors.IEopFormattingStrategy").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").Sbb?
Object(qa.a)(1142,new hO):Object(qa.a)(1142,new CM));a.register(1143,"Box4.ISelectAllHandlers").ma().oa(()=>new ds(Ww.PageReader.instance,a.ke("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(1144,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().oa(()=>new fO(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(1145,"Box4.IFormatPainterStrategy").ma().oa(()=>new iO(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),
a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(993,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new eO);a.register(994,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>new gO(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(1146,"PowerPointWebEditor.IUploadFrameFactory").ma().oa(()=>new UO(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.IApplicationSettings").COj));a.register(1147,"PowerPointWebEditor.IPictureUploaderHelper").ma().oa(()=>new TO(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1148,"PowerPointWebEditor.IPictureUploader").ma().oa(()=>new SO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),
a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1149,"PowerPointWebEditor.IChunkedPictureUploader").oa(()=>new Wv(a.resolve("Common.ITaskManager"),()=>{Rc.a.QFa()},Object(F.a)(Mj.a.instance,Mj.a.instance.d7a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));
a.register(1150,"PowerPointWebEditor.IWarningDialog").ma().oa(()=>new FO);a.register(534,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().oa(()=>new KR.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").xa));a.register(1151,"PowerPointWebEditor.IDataUploader").oa(()=>new WO(a.resolve("Common.ITaskManager"),()=>{Rc.a.QFa()},Object(F.a)(Mj.a.instance,Mj.a.instance.d7a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(1152,"PowerPointWebEditor.IPastedDataUploader").ma().oa(()=>new BO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(161,"PowerPointWebEditor.IMediaUploader").oa(()=>new WR.a(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
()=>{Rc.a.QFa()},Mj.a.instance.d7a.bind(Mj.a.instance)));a.register(1153,"PowerPointWebEditor.ISystemClipboard").ma().oa(()=>new DO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1154,"PowerPointWebEditor.IInternalClipboard").ma().oa(()=>new qO(a.resolve("PowerPointWebEditor.IApplicationSettings").Bjg?
a.resolve("Box4.Graph.IGraphInstance").xd(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").Bjg?a.resolve("Box4.Graph.IGraphInstance").xd(8):null));a.register(1155,"PowerPointWebEditor.ICutCopyManager").ma().oa(()=>new oO(a.resolve("PowerPointWebEditor.IDesignModeManager").tCa,[new CO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").tCa,a.ke("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").aMj,a.resolve("PowerPointWebEditor.IApplicationSettings").QMj,a.resolve("PowerPointWebEditor.IApplicationSettings").$Lj,
a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").kwb,a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager")),new fs(a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IDesignModeManager").tCa,a.ke("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").bMj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,
a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended")));a.register(1156,"PowerPointWebEditor.IPasteManager").ma().oa(()=>
new Gg(a.ke("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").tCa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),[new xO(a.resolve("Common.IActionManagerExtended"),a.ke("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").uje,
a.resolve("PowerPointWebEditor.IApplicationSettings").fmg),new yO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").vje),new NR.a(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),
a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").WSj,a.resolve("PowerPointWebEditor.IApplicationSettings").zUj,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),new Zx(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),new gA(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),u.AFrameworkApplication.PQ),new YE(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));
a.register(748,"PowerPointWebEditor.ICopyPasteUtility").ma().oa(()=>new Iq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));
a.register(1157,"PowerPointWebEditor.IPasteHandlerUtil").ma().oa(()=>new wO);a.register(1158,"PowerPointWebEditor.IClipboardHelper").ma().oa(()=>new CE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.gTa().qk||Ep.a.zKh,a.resolve("Common.IAppSettingsManager").Ga("RedisCacheServiceEnabledDatacenters"),a.resolve("Common.IAppSettingsManager").Bc("ClipServiceItemExpireTimeInMinutes",60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));
a.register(1159,"PowerPointWebEditor.IClipServiceManager").ma().oa(()=>new nO(b.gTa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(1160,"Box4.TableEditors.ITableStylePreviewGenerator").ma().oa(()=>new Jq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),$z.bMf,c=>new $D(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),
c=>new YD(c),a.resolve("PowerPointWebEditor.IApplicationSettings").laa));a.register(1161,"Box4.TableEditors.ITableStyleRibbonControls").ma().oa(()=>new YN(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));a.register(1162,"Common.App.ImageProcessor.IImageProcessor").ma().oa(()=>new BM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));
a.register(1163,"PowerPointWebEditor.IPPTFileReaderHelper").ma().oa(()=>new YO);a.register(1164,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().oa(()=>new jA(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(1165,"PowerPointWebEditor.ILocalImageViewFactory").ma().oa(()=>new NO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Xab));a.register(1166,
"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().oa(()=>new PO);a.register(863,"PPTe.IColorPickerBuilderFactory").ma().oa(()=>new xR.a);a.register(1167,"PowerPointWebEditor.IFileApiHelper").ma().oa(()=>new XO);a.register(1168,"PowerPointWebEditor.IInsertImageHelper").ma().oa(()=>new nN(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(zE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().oa(()=>new zE(a.resolve("Box4.Styles.IStyleEditor"),
a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),Kh.a.instance,a.rb("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper")));a.register(1169,"PowerPointWebEditor.IFormatPainter").ma().oa(()=>
new JO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").xd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(1170,"PPTe.IResourceViewElementResolver").ma().oa(()=>new mO(b.gTa(),Pc.App.webServiceBase));a.register(1171,"PowerPointWebEditor.IOfflineModalCallout").ma().oa(()=>new KO(a.resolve("Box4.IAppFrame")));
a.register(1172,"PowerPointWebEditor.IPPTOfflineManager").ma().oa(()=>new EO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));
a.register(1173,"PowerPointWebEditor.IClipboardTelemetry").ma().oa(()=>new qu.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").xd(8),a.resolve("Box4.Graph.IGraphInstance").xd(10),a.resolve("Box4.Graph.IGraphInstance").xd(12),a.resolve("Box4.Graph.IGraphInstance").xd(60),a.resolve("Box4.Graph.IGraphInstance").xd(7),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")))}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.JS;var f=b.wq;const l=c.qd;var w=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),H=f.zhb;const U=a.resolve("Common.IActionManagerExtended"),ja=a.resolve("PowerPointWebEditor.IFrameContext"),wa=a.resolve("PowerPointWebEditor.IFocusManager"),Sa=
a.resolve("PowerPointWebEditor.IFormatPainter"),eb=a.resolve("PowerPointWebEditor.CoauthManager"),ub=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),Ub=Ab.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),cc=Ab.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Fc=Ab.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Ic=Ab.a.instance.resolve("Box4.ISelectionManager"),Cc=Ab.a.instance.Ja("Box4.IExternalSelectionManager"),Ud=Ab.a.instance.resolve("PowerPoint.IPathManager");
var je=Ab.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const Vd=f.Ld,Ve=Ab.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=Ab.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const af=Ab.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Zf=Ab.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),lg=Ab.a.instance.resolve("PowerPointWebEditor.INotesView"),Tg=Ab.a.instance.resolve("Box4.IFormatPainter"),Ug=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),
ag=a.resolve("Common.Transaction.ITransactionFactory"),ih=a.resolve("PowerPointWebEditor.IPresentationReader"),Vg=a.resolve("PowerPointWebEditor.IShapeReader"),di=a.resolve("PowerPointWebEditor.Graph.ITableReader"),Si=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),rj=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");var sg=a.resolve("PowerPointWebEditor.ITableEditor");const Cg=Ab.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),sh=Ab.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),
vk=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Ni=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),wk=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),Jl=Ab.a.instance.resolve("Box4.List.IListReader");var hk=a.resolve("Box4.Graph.IGraphIteratorFactory");const Kl=a.resolve("PPTe.IColorPickerBuilderFactory"),Vj=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.Yla=Ab.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.pB=Ab.a.instance.resolve("PowerPointWebEditor.IPasteManager");
const Wj=Ab.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),nk=Ab.a.instance.resolve("PPTe.IResourceViewElementResolver");Ab.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");Ab.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const gl=Ab.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),yj=Ab.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),wh=a.resolve("Common.Utils.IHighContrastDetector"),hl=
Ab.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),Yl=a.resolve("PowerPointWebEditor.IRibbonUser"),wm=a.resolve("Box4.CloudFontService"),Fk=a.resolve("Box4.CustomFontService");this.gCe=new dj(U,Ub,wa,ja.LCID,Fc,ag,sh,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ih,new IO(Ab.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Ab.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),Wj,l,nk);this.Ewe=new Pj(sh,U,wa,Fc,Ub,Vj,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),
a.resolve("Box4.Graph.IGraphInstance").xd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Ve,Cg,yj,a.resolve("PowerPointWebEditor.IApplicationSettings").kQj,a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.Ja("PowerPointWebEditor.IInsertShapeOverlayViewElement"),
a.resolve("PowerPointWebEditor.IApplicationSettings").Syb,l.oIj,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Box4.Graph.IGraphInstance").xd(10));this.Dwe=new lA(sh,U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ub,Vj,a.resolve("Box4.Graph.IGraphInstance").xd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,Ve,Cg,yj,a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));je=new TM(U,wa,a.resolve("PowerPointWebEditor.IPptSelectionManager"),Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ag,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),je,Ub,this.Yla,this.pB,a.resolve("PowerPointWebEditor.IDesignModeManager").tCa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),ih,Cg,Vj,a.resolve("PowerPointWebEditor.IWarningDialog"),
(Ei,mg,Md,Pe,zf,ge,Lg,ei,ti)=>new vN(Ei,mg,Md,Pe,zf,ge,Lg,ei,ti),yj,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.ITextPasteFloatieManager"):
null,u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?Ab.a.instance.resolve("Box4.IPasteFloatieEventSource"):null,u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("PowerPointWebEditor.IGraphHotColdManager"):null,u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.Graph.IGraphInstance").xd(10):null,u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"):null,u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?
a.resolve("Box4.IUndoManager"):null);const Gk=new vi(U,wa,ag,H,Sa,Ub,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),Tg,Ug,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
wh,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Ma),Di=new uN(U,Ub,ja,ag,Fc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));H=new eN(U,ag,Fc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja,a.resolve("PowerPointWebEditor.IApplicationSettings"));w=[new JM(U,l,w,Fc,ag,Ub),je,new $x(U,l,u.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),a.resolve("PowerPointWebEditor.IClipServiceManager"),wa,Ub,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ag,vk,Vd,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),Vj,yj,
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),gl,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.pB,
a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new WM(U,Ab.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),cc,a.ke("PowerPointWebEditor.IContextMenuUser"),Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),wa,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),l.pptContextMenuOnSelectionFixIsEnabled,l.Ln),new XM(U,Fc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.Tbh,l.OIb),new cO(U,l,mv.a.mxb,hk,a.resolve("Box4.IParagraphReader")),new dO(ou.instance),this.Ewe,this.Dwe,H,new by(U,Ub,wa,ja.notesPane,lg,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ja,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
f,Ab.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView")),new tN(U,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),Di,new BN(U,ja,Yl,wa,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled"),
a.resolve("PowerPointWebEditor.IApplicationSettings").eB),new EN(U,Ub,wa,cc,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),Sa,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),l.HC,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,
a.resolve("PowerPointWebEditor.IVideoManagerStore"),l.YP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.Y6a),Gk,new JN(U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ub,ag,wa,Wj,nk,Fc,Vg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new Qv(sh,U,wa,Ub,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("Box4.IFormattingEditor"),Vg,!!wm&&wm.isEnabled,!!Fk&&Fk.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new KN(sh,U,wa,Ub,Fc,Vg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),ag,l.Kle,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("Box4.List.IListReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),this.gCe,new LN(U,Ub,ag,sh,wa,Fc,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ih,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")),new MN(U,cc,wa,Ub,sh,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ih,af,(Ei,mg)=>new VR.a(Ei,mg),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
l.HC,l.Lle),new PN(U,Ub,Fc,ag,wa,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ve,ih,Cg,Vj,yj,a.resolve("PowerPointWebEditor.IShapeReader")),new RN(()=>Zf,new SN(Ic,mv.a.mxb,a.resolve("Box4.IContextSetEditor")),Cc,l),new ZN(U,Ub,l,wa,Fc,Zf,a.Ja("PowerPointWebEditor.IAppForOfficeManager"),a.ke("PowerPointWebEditor.IAppforOfficeClassFactory"),Vj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Ja("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.Ja("PowerPointWebEditor.IAudioManagerStore")),new pA(U,Fc,Ni,wa,b,ub,Ab.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new lO(U,a.Ja("PowerPointWebEditor.ICommentsPane"),wa,a.resolve("Common.IF6Manager"),
Fc,Ni,Ub,Ud,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ih,a.resolve("PowerPointWebEditor.IWindowUtils"),u.AFrameworkApplication.fa,l,b,c.gTa(),ub,af,Ab.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),Ab.a.instance.resolve("Box4.Graph.IGraphInstance").xd(7),Ab.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),Ab.a.instance.resolve("Common.ITaskManager"),u.AFrameworkApplication.Ke,Ab.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),Ab.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.Ja("PowerPointWeb.Comments.ICommentFrame"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),hl,Ab.a.instance.Ja("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),l.Ln?a.ke("PowerPointWebEditor.ISorterViewActorLazy"):null)];sg=new uu(U,hk,Ub,wa,Jl,Vg,di,rj,Si,Cg,sg,l,ag,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Fc,yj,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,Yl,a.resolve("Box4.Styles.ITableStyleReader"));
w.push(new su(U,Fc,wa,Jl,a.resolve("Box4.ILineSpacingHelper"),ag,wk,hk,Pc.App.ULa.TLc(12),Pc.App.ULa.TLc(10),Vg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),l.Kle,l.isPromoteDemoteOnParagraphEnabled,Kl,l.$_c,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),Tg,f,Vd,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),
a.resolve("Box4.IInsertionPointFormatting"),Ug,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").sjb));w.push(sg);f=new UE(U,wa,Vg,sh,Ub,Fc,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));w.push(f);l.D1k&&w.push(new zN(U,wa,a.resolve("PowerPointWebEditor.IPresentationReader")));l.yJk&&w.push(new UM(U,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.dOb||l.olb)&&w.push(new Uv(U,
l,ag,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Fc,di,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.r5h&&w.push(new HM(Fc,u.AFrameworkApplication.fa,l,Object(F.a)(Vz.App.Y5a,Vz.App.Y5a.FYf,"forceUpdateRibbonControls")));this.Ska(this.K)&&Pd.a("EnhancementOfSDXPaneBootTime")&&w.push(new cS.a(l,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),U,Vd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
ag,this.K.ke("PowerPointWebEditor.IClassFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),hk,Ub,yj));!this.Ska(this.K)||u.AFrameworkApplication.BM||u.AFrameworkApplication.iG||(hk=null,Object(Pd.a)("EnableFeedbackInChatPPTMode")&&(hk=this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),hk=new bP(hk)),f=!1,Object(Pd.a)("NewSettingsForChatPPT")&&(f=a.resolve("PowerPointWebEditor.IApplicationSettings").PVj),w.push(new $O(this.K.resolve("Common.IActionManagerExtended"),
this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),hk,a.resolve("PowerPointWebEditor.IApplicationSettings"),f,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ICopilotProxy"),l.Ln?a.ke("PowerPointWebEditor.ISorterViewActorLazy"):null,a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IPresentationReader"))));
l.lAh&&w.push(new cP(U));Pd.a("DataSyncModeOnStatusBar")&&"inner"===u.AFrameworkApplication.fa.Ga("Microsoft365Ring")&&w.push(new aP(U,l));for(const Ei of w)Ei.wb(),Ei.Ee();Ab.a.instance.Ja("PowerPointWebEditor.ISorterViewActorMain").execute(Ei=>{Ei.wb()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").lji(new QO(a.resolve("Common.ITaskManager"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));
const Mg=this;u.AFrameworkApplication.fa.ff(()=>{const Ei=ix.a(a),mg=[new kO(U,Ub,Fc,wa,Zf,l.zRj,eb,Vd.xf,a.Ja("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],Md=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");
l.pla&&Md&&mg.push(new ey(U,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),hl));Mg.wad=new CN(U,sh,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").xd(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPresentationReader"),Fc,a.resolve("PowerPointWebEditor.IApplicationSettings").Ln,a.resolve("PowerPointWebEditor.IApplicationSettings").HC);
mg.push(Mg.wad);mg.push(new GN(U,Fc,Vj,a.resolve("PowerPointWebEditor.IApplicationSettings").yka));mg.push(new FN(Ei,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.ISelectionPane"),Gk,Di,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
ja,Vg,a.resolve("Box4.IPageView").Ma,a.resolve("Common.Transaction.ITransactionFactory")));mg.push(new ZM(Ei,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,wa,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),Vg,l.Z0i,l.Dhl,l.yka,a.resolve("PowerPointWebEditor.IImageViewManager")));mg.push(new aN(Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,wa,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("Common.IDynamicScriptLoaderProvider").Vw,di,rj,Si));l.Dlg?mg.push(new lN(Ei,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
ag,l.iMe)):mg.push(new iN(Ei,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),ag,l.iMe));mg.push(new VM(Ei,U,wa,Vd));l.powerPointSmartLookupIsEnabled&&mg.push(new mN(sh,U,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Ub));l.vJk&&mg.push(new MM(a.resolve("Common.IDynamicScriptLoaderProvider").Vw,U,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));mg.push(new KM(U,Fc,wa,ag,a.Ja("PowerPointWebEditor.IAudioManagerStore"),l.YP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));mg.push(new GM(U,Fc,ag,Vd,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),l.U4h,l.BKl,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));l.BJk&&mg.push(new sN(a.resolve("Common.IDynamicScriptLoaderProvider").Vw,l.zJk,l.AJk,U,Ub,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Fc,yj));l.pptoCaptionDiscoverabilityPaneEnabled&&
mg.push(new Nv(a.resolve("Common.IDynamicScriptLoaderProvider").Vw,U,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.wJk));Mg.byg=new YM(U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
ag,a.resolve("Box4.Graph.IGraphInstance").xd(82));mg.push(Mg.byg);for(const Pe of mg)Pe.wb(),Pe.Ee();hl.b4b=Md});(new yN(c.VG(),c.g8d(),b,Ni,Fc,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).wb();u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.ume&&sR()}dispose(){this.Yla.dispose();this.pB.dispose();this.gCe.dispose();this.Ewe.dispose();this.Dwe.dispose();this.wad&&this.wad.dispose();
const a=this.K.Ja("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}}Object(n.a)(eP,"ActorPackage",null,[2,3]);class fP{constructor(a,b,c,f,l,w,H,U,ja,wa){this.xH=!1;this.Vb=a;this.ua=b;this.Yf=c;this.sH=f;this.Tb=l;this.Iv=w;this.zb=H;this.Ova=U;this.DUg=ja;this.Oc=wa;this.IAe=[0,1,2,3];this.i5=new qd.a;for(const Sa of this.IAe)this.i5.$(Sa,[]);this.i5.$(4,[]);this.Yf.tI(Object(F.a)(this,this.DB,"onActiveSlideChanged"));this.Ova.kk(Object(F.a)(this,this.Vfd,"onMainMastersLoaded"));
this.DUg.Gia(Object(F.a)(this,this.oJe,"onSlideLoaded"));this.DUg.kk(Object(F.a)(this,this.Pna,"onSlidePropertyChanged"));this.Oc.LA(Object(F.a)(this,this.tM,"onSessionClosed"));this.Oc.MPa(Object(F.a)(this,this.W0,"onSessionRehydrating"));this.Oc.iC(Object(F.a)(this,this.Eo,"onSessionRehydrated"));this.gRg=new Nx(Object(F.a)(this,this.VJk,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.zb,3);this.fRg=new Nx(Object(F.a)(this,this.UJk,"prefetchSlideMasterImage"),250,6E4,8E3,500,
"slide master image",this.zb,3);this.DB(null,null)}DB(){this.Y1d()}Y1d(){const a=this.ua.Ba;a&&8===a.type&&a.Sa(hb.a.ij)&&a.Sa(hb.a.Cn)&&this.yBl(a.ij,a.Cn)}VJk(){if(!this.xH){var a=this.i5.ga(0),b=this.i5.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.hWj(f.first,f.second)&&(Array.removeAt(a,c),Array.add(b,f),this.gRg.Ysd(),this.Iv.TJk(f.first,f.second))}}}UJk(){if(!this.xH){this.Wtd(1,2,c=>!!this.Tb.X8a(c.first,c.second));var a=this.i5.ga(2);if(0<a.length){const c=a[0];var b=this.Tb.X8a(c.first,
c.second);b&&this.wYe(b)?(b=b.Cyb(new gr.a(b.oq,b.Vk)),this.fRg.Ysd(),Array.removeAt(a,0),Array.add(this.i5.ga(3),c),this.sH.Pvb(b,!0,()=>{this.Wtd(3,4,f=>!this.wYe(this.Tb.X8a(f.first,f.second)));this.fRg.Usd()})):(Array.removeAt(a,0),Array.add(this.i5.ga(4),c))}this.Wtd(3,4,c=>!this.wYe(this.Tb.X8a(c.first,c.second)))}}nGf(){for(const a of this.IAe)Array.clear(this.i5.ga(a));Array.clear(this.i5.ga(4))}oJe(a,b){(a=Object(qa.a)(116,b.node))&&a.eE&&this.mkc(a)}Pna(a,b){a=b.property;b.node&&a===hb.a.Cn&&
b.node===this.ua.Ba&&this.Y1d()}mkc(a){if(this.eWj(a)&&a){const b=a.ij,c=a.Cn;b&&c&&(this.Wtd(1,2,f=>f.first===b&&f.second===c),this.gRg.Usd())}}Vfd(a,b){a=b.property;if(a===hb.a.kGb||a===hb.a.DY)this.nGf(),this.Y1d()}tM(){this.xH=!0}W0(){this.nGf()}Eo(){this.xH=!1}yBl(a,b){this.fWj(a,b)||this.gWj(a,b)||Array.add(this.i5.ga(0),new bx.a(a,b))}gWj(a,b){for(const c of this.IAe)for(const f of this.i5.ga(c))if(f.first===a&&f.second===b)return!0;return!1}fWj(a,b){for(const c of this.i5.ga(4))if(c.first===
a&&c.second===b)return!0;return!1}Wtd(a,b,c){a=this.i5.ga(a);b=this.i5.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}wYe(a){if(!a)return!1;a=a.Cyb(new gr.a(a.oq,a.Vk));if(null===a)return!1;for(const b of a)if(!this.sH.gXc.Umd(b).data)return!0;return!1}eWj(a){const b=this.Vb.xf.sa(hb.a.Mxh,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}hWj(a,b){var c=this.Tb.HI();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===
a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(n.a)(fP,"SlideMasterPrefetchManager",null,[267]);var dS=d(976);class gP{constructor(a,b,c,f,l,w,H){this.Eb=!1;this.zX=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");if(!w)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");this.zb=w;this.Ir=a;this.Rb=b;this.hu=c;this.yy=f;this.ld=l;this.lCg=
H;this.sgk=new Le.a(0,1,0,Object(F.a)(this,this.S0k,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Eb}Wnl(){if(!this.Eb&&this.Ir&&this.Ir.xa){this.zX=this.Yki();this.lCg||this.Ir.xa.appendChild(this.zX);this.Ir.setVisibility(!0);this.lCg&&this.ld.Xuf(Object(F.a)(this,this.dfd,"onCommentContainersChanged"));var a=new dS.a(!0);this.yy.Qeh(a);this.Rb.Kgb(1);this.Eb=!0}}dfd(){this.Rb.$Gc(Object(F.a)(this,this.jkh,"renderCommentShimmerOnSlideResize"));this.ld.f_k(Object(F.a)(this,
this.dfd,"onCommentContainersChanged"))}jkh(){this.zb.Db(this.sgk);this.Rb.Zld(Object(F.a)(this,this.jkh,"renderCommentShimmerOnSlideResize"))}S0k(){!this.zX||this.cVf()?va.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.Ir.xa.appendChild(this.zX)}bdg(){if(this.Eb&&this.Ir&&this.Ir.xa&&this.cVf()){this.Ir.xa.removeChild(this.zX);this.zX=null;this.Eb=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();va.a.J(523352018,809,50,pa.a.toJSON(a))}}eXi(){this.Eb&&
this.Ir&&this.Ir.xa&&(this.zX.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(F.a)(this,this.bdg,"hideShimmerUX"),600))}Yki(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.Zki());return a}Zki(){const a=document.createElement("div");a.className=this.hu?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";
const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const w=document.createElement("div");w.className="CommentShimmerActionStyles";a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(w);return a}cVf(){return!!document.getElementById("CommentShimmerContainer")}}Object(n.a)(gP,"CommentShimmerView",
null,[268]);class cF{constructor(a,b){this.Rb=a;this.Kwa=b;this.Kwa.Avf(Object(F.a)(this,this.Hoh,"scaleOnUIChanged"))}dispose(){this.Kwa.Njh(Object(F.a)(this,this.Hoh,"scaleOnUIChanged"))}G5(){}F5(a){2===a.behavior&&(a=a.actionId,a!==L.a.d1&&a!==L.a.c1&&a!==L.a.b1&&a!==L.a.Sna||this.updateCommandUI())}Hoh(){this.updateCommandUI()}updateCommandUI(){this.Rb.updateCommandUI()}}Object(n.a)(cF,"UpdateCommandUIActionListener",null,[145,106]);class dF{constructor(){this.correlationId=this.sessionId=this.rJd=
null;this.actionId=0;this.rd=null}get zf(){return this.rJd?this.rJd:""}set zf(a){this.rJd=a}}Object(n.a)(dF,"AssistanceSearchVariableUrlParameterSet",null,[]);class mr{constructor(){this.EP=!1;this.BP=!0;this.iof=this.AQb=null}get isInitialized(){return this.EP}initialize(a,b){const c=!!a&&!!b;c&&(this.AQb=a,this.iof=b);this.EP=c;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>
{f.J3("Enabled").then(l=>{this.BP=l;return null},()=>null)})}wb(a){a||(a=u.AFrameworkApplication.Ta);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.BP=u.AFrameworkApplication.UE,Ab.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",!0).then(c=>{this.BP=u.AFrameworkApplication.UE&&c;(c=u.AFrameworkApplication.Aa)&&
c.updateCommandUI();return null},()=>null)}));a.ya(G.a.jLb,Xd.a.frame,Object(F.a)(this,this.Tnl,"showSearchResults"))}Tnl(a,b,c,f,l){if(1===c)return u.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.BP=!1),l&&"SourceControlId"in l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.BP)?8:Bz.SessionStatusManager.instance.Aka?8:32;ka.ULS.sendTraceTag(4761738,1302,50,"");fd.a.mark(4771);
if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new dF,{actionId:G.a.jLb,rd:l});if(void 0!==a&&null!==a)l=mr.Hoj(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=G.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":l.actionId=G.a.fXd;break;case "btnShowTraining":case "Training":l.actionId=G.a.GDh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=
G.a.KKh}this.AQb.$ll(this.iof,l);fd.a.mark(4772);return 32}fd.a.mark(4772);return 8}dispose(){this.AQb&&(this.AQb.dispose(),this.AQb=null)}static get instance(){mr.Ka||(mr.Ka=new mr);return mr.Ka}static Hoj(a){const b=new dF,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,f);b.zf=a.substr(f+1);return b}}mr.Ka=null;Object(n.a)(mr,"AssistanceActor",null,[106]);class eF{constructor(){this.H8e=this.$a=this.bnb=null;this.rId=!1}$ll(a,b){if(b.actionId!==
G.a.giveFeedback||u.AFrameworkApplication.UE)if(this.rId&&!u.AFrameworkApplication.Asa)this.bnb||(this.bnb=this.H8e()),this.bnb.Ql(a,b);else if(b.actionId===G.a.giveFeedback)this.Lll();else{a=a.nVc(b);b=null;try{ha.a.n9(a)&&(b=Kd.a.vn(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no","AssistanceDisplayManager:HelpWindow"))}catch(c){throw ka.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+
c.message),c;}b?ka.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):ka.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else ka.ULS.sendTraceTag(554295451,356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.bnb&&
(this.bnb.dispose(),this.bnb=null)}xth(a,b,c){c&&Hk.b(a)?this.rId=!1:(this.H8e=a,this.rId=c);this.$a=b}Lll(){u.AFrameworkApplication.Ta.processAction(G.a.giveFeedback,2)}static createInstance(a,b,c=null){const f=new eF;null==c?f.xth(a,b,u.AFrameworkApplication.czf||b.ka("HelpTabIsEnabled")):f.xth(a,b,c);return f}}Object(n.a)(eF,"AssistanceDisplayManager",null,[1218,106]);class Yv{constructor(a,b,c,f,l){this.CG=a;this.OXh=b;this.jBc=c;this.kOh=f;this.PWh=l}get lcid(){return this.CG}get namespace(){return this.OXh}get TIa(){return this.jBc}get qgi(){return this.kOh}get locale(){return this.PWh}static ooj(a){const b=
a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:Yv.phi}static createInstance(a){return new Yv(u.AFrameworkApplication.lcid,a,Yv.ooj(u.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",Xa.a.xe(u.AFrameworkApplication.lcid).name)}}Yv.phi=16;Object(n.a)(Yv,"AssistanceSearchUrlParameterSet",null,[]);class fF{constructor(a,b){a=new ue.QueryStringBuilder(a);a.Xg("clid",b.lcid.toString());a.Xg("p1",b.namespace);a.Xg("ver",b.TIa.toString());
a.Xg("apps",b.qgi);a.Xg("lc",b.locale);this._url=a.toString()}nVc(a){const b=new ue.QueryStringBuilder(this._url);b.Xg("src","TellMe");b.Xg("query",a.zf);b.Xg("sessionid",a.sessionId);b.Xg("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new fF(u.AFrameworkApplication.dzf,a)}}Object(n.a)(fF,"AssistanceSearchUrlProvider",null,[1217]);class gF{Zb(){}init(){u.AFrameworkApplication.isb&&!u.AFrameworkApplication.UNb&&mr.instance.wb(u.AFrameworkApplication.Ta)}dispose(){mr.instance.dispose()}afg(a){mr.instance.initialize(eF.createInstance(a,
u.AFrameworkApplication.fa),fF.createInstance(Yv.createInstance("PPWAEndUser")))}}Object(n.a)(gF,"AssistancePackage",null,[2,3]);var eS=d(1025);class hP{constructor(a,b,c,f,l,w){this.ia=a;this.Yc=b;this.Zre=c;this.t8j=f;this.tve=l;this.Wua=w}Ql(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case G.a.fXd:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case G.a.giveFeedback:a.feedback=this.cAi(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case G.a.GDh:a.query=
"showtraining";c=ResourceStrings.L_Training;break;case G.a.KKh:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.zf,c=ResourceStrings.L_Help}const f={};f.XE=c;f.assetId="FA000000012";this.Wua.mle&&b.actionId===G.a.giveFeedback&&(f.sourceLocationOverrideResourceId="Help.GiveFeedback.Url");f.nonPersistedSettings=a;f.CJh=!1;b.actionId==G.a.fXd&&(f.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.La(L.a.lga,2,f)}}Cr(){const a=this.nxb();a&&this.ia&&this.ia.La(L.a.Ftb,
2,a)}dispose(){}nxb(){if(this.Yc.instance){const a=this.Yc.instance.oQ("FA000000012");if(a)return a.instanceId}return null}cAi(a){this.Wua.mle||(this.tve?this.tve.jUb?this.vEf():this.t8j.Z0d(Object(F.a)(this,this.yXi,"feedbackDownloaded")):va.a.J(512324302,1302,15,"feedbackFormManager is undefined"));a=a.rd?a.rd:{};u.AFrameworkApplication.fa.jPd(a);a=this.Zre.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===
a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}vEf(){if(eS.a.N1g())va.a.J(512324300,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(F.a)(this,this.obh,"postScreenshotData"));return}catch(a){va.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+
a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(F.a)(this,this.obh,"postScreenshotData"))}catch(a){va.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}yXi(a){a&&(this.tve.bpg(a),this.vEf())}obh(a){a=a.toDataURL("image/jpeg");const b=this.nxb(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(n.a)(hP,"AgaveAssistancePane",null,
[1202,106]);class iP extends gF{constructor(){super();this.D8e=this.jcf=this.U$e=this.V$e=this.Da=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}Zb(a){this.Da=a}load(){this.init()}init(){super.init();!u.AFrameworkApplication.isb&&u.AFrameworkApplication.UNb?va.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(va.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?
(this.V$e=this.Da.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.U$e=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.jcf=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.D8e=this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.afg(()=>new hP(this.Da.resolve("Common.IActionManagerExtended"),this.Da.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.V$e,this.U$e,this.jcf,this.D8e))):this.afg(null))}}Object(n.a)(iP,
"PowerPointAssistancePackage",gF,[1174]);class hF{PZi(a,b,c){return a?this.PYi(b,c):this.QZi(b,c)}OWf(a,b,c){return a?this.rZi(b,c):this.jZi(b,c)}hZi(a){var b=a.yf?a.mg.Ye:a.mg.Ua;const c=new ob.GraphIterator;a.nq?c.Rc(a.nq):c.set(b.node);c.rc(14);a=new ob.GraphIterator;a.Rc(c);a.rc(14);b=Ie.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Ie.isLastCellInRow(a)){do if((f=Rd.moveToNextColumn(a))&&Ie.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ie.isLastCellInRow(a))}if(!l&&
!Ie.isLastCellInColumn(c)){do if((f=Rd.moveToNextRow(c))&&Ie.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ie.isLastCellInColumn(c))}return l?f:null}pZi(a){var b=a.yf?a.mg.Ye:a.mg.Ua;const c=new ob.GraphIterator;a.nq?c.Rc(a.nq):c.set(b.node);c.rc(14);a=new ob.GraphIterator;a.Rc(c);a.rc(14);b=Ie.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Ie.isFirstCellInRow(a)){do if((f=Rd.moveToPreviousColumn(a))&&Ie.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ie.isFirstCellInRow(a))
}if(!l&&!Ie.isFirstCellInColumn(c)){do if((f=Rd.moveToPreviousRow(c))&&Ie.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Ie.isFirstCellInColumn(c))}return l?f:null}xQc(a,b){var c=a.yf?a.mg.Ye:a.mg.Ua;const f=new ob.GraphIterator;a.nq?f.Rc(a.nq):f.set(c.node);f.rc(14);a=Ie.findControllingCellFromNode(c.node);c=null;if(b){do{if(Ie.isFirstCellInColumn(f))break;c=Rd.moveToPreviousRow(f)}while(c&&Ie.findControllingCellFromNode(c)===a)}else{do{if(Ie.isLastCellInColumn(f))break;c=Rd.moveToNextRow(f)}while(c&&
Ie.findControllingCellFromNode(c)===a)}return c}NWf(a,b){if(!ok.l(a))return null;a=ob.GraphIterator.nb(a.currentNode);a.rc(14);let c;const f=hd.TableReader.Lu(a.origin);do c=b?Rd.moveToPreviousRow(a):Rd.moveToNextRow(a);while(f&&c&&ok.h(a));return c}MYa(a,b,c,f,l){let w=null;Pa.OutlineElementNavigator.Re(a);const H=fe.OutlineElementReader.isRtl(a.currentNode);if(c)if(Rd.returnToCell(a),b=Ie.isLastCellInRow(a),c=Ie.isFirstCellInRow(a),l||!H&&c||H&&f&&b)Rd.returnToContainingRow(a),(f=this.NWf(a,!0))?
w=Od.SelectionFactory.uj(f,!b):l&&(Pa.OutlineElementNavigator.Re(a),l=new nn.a,l.Rc(a),(a=Pa.OutlineElementNavigator.Rwa(l,!1,!1))&&(w=Od.SelectionFactory.uj(a,!1)));else{do H?Rd.moveToNextColumn(a):Rd.moveToPreviousColumn(a);while(Ie.isGhostCell(a)&&!Ie.isFirstCellInColumn(a));Ie.isGhostCell(a)||(w=Od.SelectionFactory.uj(a.currentNode,!H))}else fe.OutlineElementReader.GC(a,b,H)||nb.SelectionEditor.Tg(b)||Rd.returnToCell(a),w=Od.SelectionFactory.uj(a.currentNode,!H);return w}LYa(a,b,c,f,l){let w=
null;Pa.OutlineElementNavigator.Re(a);const H=fe.OutlineElementReader.isRtl(a.currentNode);if(c)if(Rd.returnToCell(a),c=Ie.isLastCellInRow(a),b=Ie.isFirstCellInRow(a),l||!H&&f&&c||H&&!f&&b)Rd.returnToContainingRow(a),(f=this.NWf(a,!1))?w=Od.SelectionFactory.uj(f,b):(Pa.OutlineElementNavigator.Re(a),f=new nn.a,f.Rc(a),(a=Pa.OutlineElementNavigator.HJ(f,!1,!1))&&(w=Od.SelectionFactory.uj(a,!0)));else{do H?Rd.moveToPreviousColumn(a):Rd.moveToNextColumn(a);while(Ie.isGhostCell(a)&&!Ie.isLastCellInRow(a));
Ie.isGhostCell(a)||(w=Od.SelectionFactory.uj(a.currentNode,H))}else fe.OutlineElementReader.GC(a,b,!H)||nb.SelectionEditor.Tg(b)||Rd.returnToCell(a),w=Od.SelectionFactory.uj(a.currentNode,H);return w}}Object(n.a)(hF,"ATableCellSelectionStrategy",null,[1211]);class iF extends hF{constructor(){super()}jZi(a,b){var c=a.mb;let f=null;if(a.Hl){let l=null;if(b){if(c.nq=a.Lja,a=Object(qa.a)(Zl.TableCellNode,this.hZi(c)))a.isGhostCell&&(l=a,a=a.az()),f=c.OG.isValid&&c.OG.node&&a===c.OG.node?Od.SelectionFactory.uj(c.OG.node,
!c.yf):Od.SelectionFactory.Fu(br.TableNodeContext.create(Object(qa.a)(yg.a,a)),c.yf)}else if(c=a.ga(Math.max(0,Math.min(a.zja,a.gza))),c=Object(qa.a)(Zl.TableCellNode,c.mg.Ye.node),c.isControllingCell&&(c=c.u8d(2)),a=c.o_(),b=c.wSc().aJa,!a&&b&&(c=b.nXf),a=c)a.isGhostCell&&(l=a,a=a.az()),f=nb.SelectionEditor.Sl(Od.SelectionFactory.wl(Object(qa.a)(yg.a,a)),!0,!1);f&&l&&(f.nq=ob.GraphIterator.nb(l))}return f}rZi(a,b){let c=a.mb,f=null;a.Hl&&(b?(c.nq=a.Lja,a=Object(qa.a)(Zl.TableCellNode,this.pZi(c)),
b=null,a&&(a.isGhostCell&&(b=a,a=a.az()),(f=c.OG&&c.OG.isValid&&a===Object(qa.a)(125,c.OG.node)?Od.SelectionFactory.uj(c.OG.node,!c.yf):Od.SelectionFactory.Fu(br.TableNodeContext.create(Object(qa.a)(yg.a,a)),c.yf))&&b&&(f.nq=ob.GraphIterator.nb(Object(qa.a)(yg.a,b))))):(a.zja>a.gza?(c=a.w6,c.nq=c.yf?a.O0a:null):c.nq=c.yf?null:a.Lja,f=nb.SelectionEditor.Sl(Od.SelectionFactory.wl(c.mg.Ua.node),!0,!1),f.nq=c.nq));return f}QZi(a,b){let c=a.mb;var f=null;if(a.Hl){const l=a.zja>a.gza;let w=null;if(b){if(c.nq=
a.Lja,a=Object(qa.a)(Zl.TableCellNode,this.xQc(c,!0)))a.isGhostCell&&(w=a,a=a.az()),f=l&&c.OG&&c.OG.isValid&&a===c.OG.node?Od.SelectionFactory.uj(c.OG.node,!c.yf):Od.SelectionFactory.Fu(br.TableNodeContext.create(Object(qa.a)(yg.a,a)),c.yf)}else l?(c=a.w6,c.yf&&(c=c.Vvb(),c.nq=a.O0a)):c.yf?c=c.Vvb():c.nq=a.Lja,f=Object(qa.a)(Zl.TableCellNode,this.xQc(c,!0)),f?f.isGhostCell&&(w=f,f=f.az()):(f=Object(qa.a)(Zl.TableCellNode,c.mg.Ua.node),w=c.nq?Object(qa.a)(Zl.TableCellNode,c.nq.currentNode):null),f=
Od.SelectionFactory.uj(Object(qa.a)(yg.a,f),!0);f&&w&&(f.nq=ob.GraphIterator.nb(Object(qa.a)(yg.a,w)))}return f}PYi(a,b){let c=a.mb;var f=null;if(a.Hl){const l=a.zja<a.gza;let w=null;if(b){if(c.nq=a.Lja,a=Object(qa.a)(Zl.TableCellNode,this.xQc(c,!1)))a.isGhostCell&&(w=a,a=a.az()),f=l&&c.OG&&c.OG.isValid&&a===Object(qa.a)(125,c.OG.node)?Od.SelectionFactory.uj(c.OG.node,!c.yf):Od.SelectionFactory.Fu(br.TableNodeContext.create(Object(qa.a)(yg.a,a)),c.yf)}else l?(c=a.w6,c.yf&&(c=c.Vvb(),c.nq=a.O0a)):
c.yf?c=c.Vvb():c.nq=a.Lja,f=Object(qa.a)(Zl.TableCellNode,this.xQc(c,!1)),f?f&&f.isGhostCell&&(w=f,f=f.az()):(f=Object(qa.a)(Zl.TableCellNode,c.mg.Ua.node),w=c.nq?Object(qa.a)(Zl.TableCellNode,c.nq.currentNode):null),f=Od.SelectionFactory.uj(Object(qa.a)(yg.a,f),!0);f&&w&&(f.nq=ob.GraphIterator.nb(Object(qa.a)(yg.a,w)))}return f}}Object(n.a)(iF,"TableCellSelectionStrategy",hF,[]);class jP extends mz{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){super(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc);this.w0h=
l;this.sUh=c;this.cxc=Fc}l1b(a,b){var c=Object(qa.a)($o,b);c&&c.LZa&&this.ysi(this.sUh.p2e)&&(c=c.LZa.sa(Xl.a.Wb,""),this.cxc.Xic(c),this.cxc.NB(6,c));return super.l1b(a,b)}ysi(a){const b=new xC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;a=ob.GraphIterator.nb(a);let c=a.Ii();for(;c;)b.enqueue(c),c=a.lp()}return!1}gNc(a,b){var c=Object(qa.a)($o,b);if(c&&c.LZa){c=c.LZa.sa(Xl.a.Wb,"");const f=Object(qa.a)(5,this.w0h.Na.mb.Ye.node);f&&(f.Wb=c)}return super.gNc(a,b)}}Object(n.a)(jP,
"PPTClipboardOperationCutCopy",mz,[]);class kP{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){this.Ca=a;this.nd=b;this.es=c;this.GZ=w;this.Tc=l;this.Fi=f;this.sr=H;this.jf=U;this.Vha=ja;this.AK=wa;this.Wha=Sa;this.Rpb=eb;this.Y4a=ub;this.$a=Ub;this.jk=cc;this.cxc=Fc}create(){return new jP(this.Ca,this.nd,this.es,this.Fi,this.Tc,this.GZ,this.sr,this.jf,this.Vha,this.AK,this.Wha,this.Rpb,this.Y4a,this.$a,this.jk,this.cxc)}}Object(n.a)(kP,"Factory",null,[1E3]);class lP{constructor(){}get qid(){return!1}wsb(){}get iZg(){return!1}set iZg(a){}get ymk(){return!1}Jna(){}fZa(){}get x1g(){return-1}get vNc(){return null}}
Object(n.a)(lP,"NoImageSteward",null,[1210]);class jF{constructor(a){this.ffc=a}create(a,b){return this.ffc||1!==a?new lP(b):null}}Object(n.a)(jF,"PPTImageStewardFactory",null,[1198]);class Kq extends Zr{constructor(a,b,c,f,l,w,H){super(a,b,c);this.ia=f;this.zx=l;this.Cc=H;this.nbk=w.QEk;this.SWa=w.vje;this.Pak=w.uje;this.ffc=w.Yzb;this.obk=w.ATj}Pke(a,b,c){const f=Kq.f0f(c);a=(!R.a.instance.ga(82)||this.ESj(a,b,f))&&super.Pke(a,b,c);3===c.RQa?this.Cc.Lw(2,f):2===c.RQa&&this.Cc.Lw(3,f);a&&(this.Cc.Xic(f),
this.hHh(b,f));return a}eYe(a,b,c){const f=Kq.f0f(c);a.setAttribute(qu.a.CEf,f);let l=!1;const w=Kq.CSj(a);if(w)va.a.J(17310354,826,50,null),l=!0;else if(this.obk&&1===a.getElementsByTagName("Table").length&&!b.iterator.rc(60))this.Cc.NB(6,f),l=!0;else{const H=Fb.b(a);H&&H.length||!Kq.N5b(a)||(va.a.J(17310356,826,50,null),l=!0)}l&&!Kq.Rnh&&(u.AFrameworkApplication.LL("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Kq.Rnh=!0);if(!this.nbk)return!0;l&&(this.ffc&&this.Plg(c)?
va.a.J(36779848,826,50,"Paste text only action."):(va.a.J(17310358,826,50,null),this.bVi(a.cloneNode(!0),w)));if(a=!l&&super.eYe(a,b,c))this.Cc.Xic(f),this.Cc.NB(1,f),this.hHh(b,f);return a}bVi(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.SWa||this.Pak)&&this.zx.qvi(a.firstChild,a));Rc.a.Faa(()=>{this.ia.La(L.a.t$g,2,a)},100)}ESj(a,b,c){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Kq.anj(a);
if(1!==a.count)return!1;this.Cc.NB(6,c);a=a.ga(0);return!u.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&this.Syj(a)?!1:Kq.XSj(b)}c=Object(qa.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.lL())?c.getContainingTable():null);return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.al&&b.node.Sa(hb.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.Np()}Syj(a){a=a.getElementsByTagName("Table");if(1===
a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");if(!f||!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}hHh(a,b){if(Object(qa.a)(5,a.node)&&a.iterator)if(a.iterator.rc(10)){if(a=Object(qa.a)(4,a.iterator.Sw(10)))a.Wb=b}else a.iterator.rc(60)&&(a=Object(qa.a)(1101,a.iterator.Sw(60)))&&(a.Wb=b)}static anj(a){a=a.getElementsByTagName("Table");
if(1===a.length){var b;return b=new Ka.a,b.add(a[0]),b}b=new Ka.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static XSj(a){return a.al&&a.node.Sa(hb.a.cellId)&&a.iterator.rc(14)?!0:!1}static N5b(a){a=a.getElementsByTagName(gf.a.Z8);if(!a.length)return null;a=a[0];return a.src?a:null}static CSj(a){return!!a.firstChild&&!!a.firstChild.className&&
QR.a.Ugg(a.firstChild.className)}static f0f(a){let b="";a&&a.LZa&&(b=a.LZa.sa(Xl.a.Wb,""));return b}}Kq.Rnh=!1;Object(n.a)(Kq,"PPTPasteCoordinator",Zr,[]);class mP{constructor(){}wsb(){}get Mca(){return!1}tY(){}qY(){}sY(){}rY(){}pY(){}oY(){}}Object(n.a)(mP,"TextOnlyTableSteward",null,[1045,1046]);class kF{constructor(a){this.ffc=a}create(a,b){return this.ffc||1!==a?new mP(b):null}}Object(n.a)(kF,"PPTTableStewardFactory",null,[1029]);class lF{constructor(a,b,c){this.j$j=a;this.gck=b;this.la=c}IQe(){this.j$j.execute(a=>
{this.la.Ale&&a.TQe(this.gck.value)})}}Object(n.a)(lF,"AccessibilityActor",null,[]);class wu{get key(){return"LIST"}get i8(){return Box4Intl.Box4Strings.l_ListContentTitle}P3e(a){let b;b=null;const c=wu.Rf.lw(a);if(!c)return{returnValue:!1,Utb:b};a=this.bdj(a,c);b=Object.assign(new iz,{e1:this.key,contentId:a.listId,bQ:a});return{returnValue:!0,Utb:b}}ASc(a,b){a=a.bQ;const c=this.gcj(a.MT),f=new qj.a;b?(b=b.bQ,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
a.level)),f.add(c)):b.id.equals(a.id)&&b.MT.listType===a.MT.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c));return f.toArray().join(" ")}gcj(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.lX);else if(1===a.listType)switch(c){case 1:b=this.IBf;break;case 2:b=this.Pmi;break;case 3:b=this.Qmi;break;default:b=
this.IBf}return b}static get Rf(){return wu.Wg||(wu.Wg=Ab.a.instance.resolve("Box4.List.IListReader"))}}wu.Wg=null;Object(n.a)(wu,"ListDetailsProvider",null,[1053,510]);class nP{constructor(){this.MT=this.listId=this.id=null;this.level=0}}Object(n.a)(nP,"ListItemInfo",null,[]);class mF extends wu{constructor(a){super();this.uH=a}get IBf(){return ResourceStrings.l_BulletStyle1}get Pmi(){return ResourceStrings.l_BulletStyle1}get Qmi(){return ResourceStrings.l_BulletStyle1}bdj(a,b){const c=this.uH.nda(a),
f=this.uH.$cj(a);return Object.assign(new nP,{id:a.currentNode.id,listId:new ia.a(gh.a.nil,f),MT:b,level:c+1})}}Object(n.a)(mF,"ListDetailsProvider",wu,[]);class oP{constructor(){this.lH=this.K=null}dispose(){}Zb(a){this.K=a;this.lH=this.K.resolve("Common.AFrameworkApplication");a.register(jF,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().oa(()=>new jF(a.resolve("PowerPointWebEditor.IApplicationSettings").Yzb));a.register(kF,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>
new kF(a.resolve("PowerPointWebEditor.IApplicationSettings").Yzb));a.register(Zr,"Box4.Actors.PasteCoordinator").ma().oa(()=>new Kq(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));
a.register(1E3,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new kP(u.AFrameworkApplication.Ta,Nc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),de.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),Ij.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(mF,"PowerPointWebEditor.ListDetailsProvider").oa(()=>new mF(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(lF,"PowerPointWebEditor.AccessibilityActor").ma().oa(()=>new lF(a.Ja("Box4.Accessibility.IAccessibilityContextManager"),a.ke("PowerPointWebEditor.ListDetailsProvider"),this.lH.JS.qd));a.register(iF,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().oa(()=>
new iF)}init(){const a=Pc.App.OD.VS;Wx.KFj(this.lH.wq,this.K.resolve("Common.IReactContextualUILauncher"),a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));this.K.resolve("PowerPointWebEditor.AccessibilityActor").IQe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(n.a)(oP,"Box4DelayedLoadedPackage",null,[2,3]);class pP{constructor(a,b,c,f,l,w,H,U){this.Kcb=this.hva=null;this.b3c=0;this.Y2c=new qd.a(0);this.bdb=this.Qse=this.zdc=null;this.Z2c=!1;this.Uxg=[sa.a.contextMenu,
sa.a.vza,sa.a.RM,sa.a.mouseDown,sa.a.pointerDown,sa.a.lQa,sa.a.Egb,sa.a.paste];this.$Wg=[sa.a.Xf,sa.a.Il,sa.a.my,sa.a.click,sa.a.doubleClick,sa.a.FR,sa.a.rTd,sa.a.GJ,sa.a.Wdd];this.hJ=a;this.Mpe=c||[];this.L6j=f||[];this.rre=l||[];this.hUg=w;this.Oc=b;this.Oc.K9h(Object(F.a)(this,this.y2g,"onAppClosing"));this.Oc.LA(Object(F.a)(this,this.GB,"onSessionEnd"));this.V9c=H;U&&(Ja.EventHandlerManager.instance.OQe(this.Uxg,Object(F.a)(this,this.ysk,"onBeforeEventActionContextCreated")),Ja.EventHandlerManager.instance.Ehh(this.Uxg,
Object(F.a)(this,this.Mrk,"onAfterEventActionContextCreated")),Ja.EventHandlerManager.instance.OQe(this.$Wg,Object(F.a)(this,this.zsk,"onBeforeEventTriggered")),Ja.EventHandlerManager.instance.Ehh(this.$Wg,Object(F.a)(this,this.Nrk,"onAfterEventTriggered")));this.zxe=!1}G5(a){if(2===a.behavior){var b=a.actionId;if(this.Uoa(b)){var c=this.getCommandName(b);va.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.Ddg(a,c,"",!1)+"; Current Event: "+(this.bdb||"")+"; Current ActionContext: "+
(Rc.a.Ib?Rc.a.Ib.toString():""));if(!this.b3c)if(this.Z2c=!0,this.Ail(a)){this.hva=Rc.a.yud(c);this.zxe=!0;a=a.telemetryData;c=this.zdc;let f=this.Qse;null===c&&a&&a[Bh.a.BDa]&&(c=a[Bh.a.BDa],f=Rc.a.Xlb(c));null!==f&&(this.hva.Va(Bh.a.X5a,f.toFixed(2)),null!==c&&this.hva.Va(Bh.a.BDa,c.toFixed(2)));a&&pa.a.forEach(a,(l,w)=>{this.hva.Aza(l,(null===w||void 0===w?void 0:w.toString())||"")},null);c=!1;Array.contains(Fl.R8k,b)?c=!0:this.hva.Ur=!0;c=c||this.Oj(b,a);this.hva.Oj=c}else this.hva=Rc.a.Ib}this.b3c++}}F5(a){if(2===
a.behavior){var b=a.actionId;if(this.Uoa(b)){var c=Rc.a.Ib;const f=c?c.dK(Bh.a.lsf).toString():"";va.a.J(18956762,817,50,"ActionContextListener::OnAfterAction "+this.Ddg(a,this.getCommandName(b),f,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.bdb||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.dK(Bh.a.FY).toString():""))}this.Ykl(b)&&(c=this.Y2c.YTc(b,0),this.Y2c.add(b,c+1));this.b3c--;0<this.b3c||!Rc.a.Ib||!this.hva||(Rc.a.Ak(Bh.a.g5h,a.response.toString()),
Rc.a.Ib!==this.hva||this.Kcb||this.s2g(),this.hva=null)}}s2g(){const a=Rc.a.Ib;if(a){var b=new Date;a.Oj&&!a.QMb&&null===a.tF&&(a.tF=b);a.Aza(Bh.a.a5h,(+b-+a.KD).toString());a.Ur?0<a.dK(Bh.a.FY).length&&Rc.a.Tfa(a):Rc.a.fud();this.zxe&&(Rc.a.Ib=null,this.zxe=!1)}}Uoa(a){if(!this.hUg)return!1;if(Array.contains(this.Mpe,a))return!0;a=u.AFrameworkApplication.Ta.hT(a);return!!a&&!(a.flags[32]||a.flags[64])}Oj(a,b){return Array.contains(this.L6j,a)?b&&Bh.a.fGc in b?b[Bh.a.fGc]:!0:!1}Ykl(a){return this.hUg&&
Array.contains(this.rre,a)}Ail(a){return this.V9c?!Rc.a.Ib:!Rc.a.Ib&&a.Qi}Ddg(a,b,c,f){if(null===a)return"null";b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.zIc+", InvocationMethod="+a.vT+", CommandLocation="+a.xq+", CommandTabName="+a.asa;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.hJ?this.hJ.Z5(a):null;return b?b:a.toString()}y2g(){if(!(1>this.Y2c.count)){var a={};this.Y2c.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});
va.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",Jc.c(a));this.Oc.tZk(Object(F.a)(this,this.y2g,"onAppClosing"))}}GB(){Rc.a.Qti()}ysk(a){this.bdb=a.type;this.Kcb=Rc.a.yud(this.bdb);this.Kcb.Oj=!0;this.Z2c=!1;a=Rc.a.iud(a);null!==a&&Rc.a.bAl(a)&&this.Kcb.Va(Bh.a.BDa,a.toFixed(2))}Mrk(){this.Kcb&&Rc.a.Ib===this.Kcb&&this.Z2c&&this.s2g();Rc.a.Ib=null;this.Z2c=!1;this.Kcb=this.bdb=null}zsk(a){this.bdb=a.type;this.zdc=Rc.a.iud(a);null!==this.zdc&&(this.Qse=Rc.a.Xlb(this.zdc))}Nrk(){this.bdb=
this.Qse=this.zdc=null}}Object(n.a)(pP,"ActionContextListener",null,[145]);var fS=d(374),gS=d(437);class nF{constructor(){this.K=null;this.Zwg=[];this.Qk=null;this.Vva="";this.TX=[new oP,new eP];this.d$=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}Zb(a){this.Vva=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());Eg.a.instance.jc("EditingPackageConfigureStart",Date.now());this.K=a;this.wb();for(const b of this.TX)b.Zb(a);
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ujg&&this.K.register(267,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().oa(()=>new fP(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),
this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").xd(7),this.K.resolve("Box4.Graph.IGraphInstance").xd(8),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(cF,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().oa(()=>new cF(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}ftj(a,b,c){return 1===c?32:2===c?(this.eGj(),va.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(L.a.ufg,
2),32):8}BFj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");a.Oq();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}nfg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.lMf=!0;b.AAh=a;b.Mqg()}$0j(a,b){va.a.J(512497351,835,50,"Init GC2 started");const c=new Date,f=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");f.D1j().continueWith(l=>{var w=new Date;va.a.J(512497350,813,50,
"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Rc.a.mf(c),Rc.a.mf(w),+w-+c);if(6===l.status){l=dK.a({});const H=(w=nD())&&l&&(b||a);va.a.J(512497349,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:l,["browserSupportsWebGL"]:w,["shouldUseShapeBuilder"]:H});l=H?document.createElement("canvas"):null;f.YFj(l,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(l=>
{6!==l.status&&va.a.J(512497348,835,10,"Exception: {0}",l.$i)})}hHj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").Pqg()}eGj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").Vbb().continueWith(()=>{this.K.resolve("PowerPointWebEditor.WetInkView")})}wb(){this.K.resolve("Common.IActionManagerExtended").ya(L.a.$kh,Xd.a.frame,Object(F.a)(this,this.ftj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;
this.Vva=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Vva,(new Date).getTime(),a);Eg.a.instance.jc("EditingPackageInitStart",Date.now());a?(this.Qk=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.Qk.wvf(Object(F.a)(this,this.Qeg,"initEditingPackage"))):this.Reg()}Qeg(){this.Qk.Kjh(Object(F.a)(this,this.Qeg,"initEditingPackage"));this.Reg()}Reg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Vva=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",
this.Vva,a.Qka,(new Date).getTime());a.dFa(()=>{this.nEj(a)});a.Pgg(()=>{this.Szi()})}nEj(a){this.Vva=String.format("{0}, InitStartInternal:{1}",this.Vva,(new Date).getTime());Eg.a.instance.jc("EditingPackageInitStartInternal",Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f=new iP;f.Zb(this.K);f.load(b);for(const w of this.TX)w.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(Ab.a.instance.resolve("PowerPointWebEditor.IImageViewManager").Ukb(),
c.PUa&&b.wq.ddg());this.BFj();this.K.resolve("Common.IActionManagerExtended").paa(new pP(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Fl.$qg,Fl.u2j,c.Kwi,c.MSj,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.XIa){let w=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(b=Tj.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma))?w=b.Bca:va.a.J(512497347,809,10,"slideViewElement is null."):
va.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").qj());this.K.register(268,"PowerPointWebEditor.ICommentShimmerView").ma().oa(()=>new gP(w,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Common.ITaskManager"),c.exi))}this.K.resolve("Common.IActionManagerExtended").paa(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));
a.hua||(gj.a.instance.cQe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&c.XIa&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),fS.a.WSk(),this.K.resolve("PowerPointWebEditor.ISessionState").U5("AppInteractive"),this.d$&&Eg.a.instance.jc("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").baa("canvas","slide"),
c.podTransmitMetricsBeaconOnBoot&&(Vz.App.ALb(null,fi.a.contentEditable),this.W2j()),db.a.get_instance().YJ(4),a.hua=!0);c.XIa&&((a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(a=a.XD(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").Cbg(a)&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").Wnl(),va.a.J(512497345,809,50,"CommentLandingSlide: true"))):va.a.J(512497344,809,10,"activeSlide is null"));Eg.a.instance.jc(gS.a.U2d,(new Date).getTime());c.Buc?
this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1250))):(a=Mx.a.create("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1250))),nl.a.fy(a));this.hHj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&va.a.J(512497315,809,50,"HighContrastMode enabled");!c.ije||a&&a.isInHighContrastMode?c.Xee&&c.ije&&this.nfg(!1):this.nfg(!0);c.OVc&&(this.Zwg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),
this.$0j(c.yRc,c.f2i));u.AFrameworkApplication.dv||(u.AFrameworkApplication.dv=va.a.C1b());c.Ujg&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const l=this.K.rb("Common.IFrameTimingMeter");l&&(va.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),l.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),this.K.resolve("Common.ITaskManager").Db(new Le.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,
()=>{l.stop()},90,"93")));this.Vva=String.format("{0}, InitDone:{1}",this.Vva,(new Date).getTime());Eg.a.instance.jc("EditingPackageInitDone",Date.now());va.a.J(512497313,809,50,this.Vva)}Szi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");va.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.gIh("{"+u.AFrameworkApplication.userSessionId+
"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Z9i();f&&(c.Guc(0<f.length?2:1),c.zHh(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").x3j(Date.now(),f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").mTf();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").rfg();va.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
u.AFrameworkApplication.fa.ff(Object(F.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").jzh,"startServerRtcConnection"))}W2j(){if(Eg.a.instance.S$a)va.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[fi.a.ODa,fi.a.WYf,fi.a.YYf,fi.a.mRc,fi.a.XYf,fi.a.Prb,fi.a.KHc,fi.a.Pca,fi.a.cQ,fi.a.contentEditable,fi.a.dvc,"UserClickTime",
"DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","BootJsStartTime","BootJsEndTime",fi.a.Kmd,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime",
"EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",fi.a.C4b,fi.a.D4b,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime",
"OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart",
"ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime","DeepLinkSlideIndex","CalculateVisibleThumbRangeEndTime"])Eg.a.instance.hp(b)&&(a[b]=Eg.a.instance.ih(b));u.AFrameworkApplication.fa.Ga("PodSID")&&(a.PodSessionID=u.AFrameworkApplication.fa.Ga("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&
(a.RealRibbonDisplaySource=b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:Eg.a.instance.hp("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=Eg.a.instance.ih("ThumbnailShimmerHideTime"));va.a.J(39184516,809,50,"Perf metrics: "+pa.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.fRj&&this.R4j(a,b)}}R4j(a,b){if(a[fi.a.cQ])if(a[fi.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[fi.a.contentEditable]-a[fi.a.cQ]>b.oii){var c=
new Map;c.set("ContentEditable",a[fi.a.contentEditable].toString());c.set("ContentViewable",a[fi.a.cQ].toString());dg.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new Nj.a,{extendedProperties:c}))}c=b.xUi;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[fi.a.cQ]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[fi.a.cQ].toString()),dg.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],
!1,!0,!1,!1,Object.assign(new Nj.a,{extendedProperties:c})))}else va.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");else va.a.J(512497309,809,15,"ContentEditable is null");else va.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.TX)a.dispose();for(const a of this.Zwg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();va.a.J(38876352,809,50,"EditingPackage::Register time:{0}",
a);Eg.a.instance.jc("EditingPackageRegisterTime",a);v.a.instance.Dc(new nF)}}Object(n.a)(nF,"EditingPackage",null,[2,3]);var hS=d(580);class oF{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub,cc,Fc){this.qma=this.g$=!1;this.jM={};this.F4=this.oJ=null;this.lxa=()=>{this.g$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");
if(!w)throw Error.argumentNull("shapeReader");if(!H)throw Error.argumentNull("pageView");if(!U)throw Error.argumentNull("actionManager");if(!ja)throw Error.argumentNull("slideDimensionsHelper");if(!wa)throw Error.argumentNull("presentationReader");if(!Sa)throw Error.argumentNull("transactionFactory");if(!eb)throw Error.argumentNull("pptPageView");if(!ub)throw Error.argumentNull("applicationSettings");if(!Ub)throw Error.argumentNull("viewElementEventHandlers");if(!cc)throw Error.argumentNull("viewCoreEventHandlers");
this.Rb=a;this.Kc=b;this.Le=c;this.MIa=f;this.pa=l;this.Ea=w;this.Fb=H;this.ia=U;this.hu=Fc;this.Nv=ja;this.oc=wa;this.Jb=Sa;this.Ogc=eb;this.yBe=ub.snh;this.ABe=ub.rnh;this.ld=Ub;this.DJ=cc}get Nic(){return document.getElementById(O.AppFrame.tKh)}dispose(){this.g$=!1;this.Rb.ljh(Object(F.a)(this,this.renderRuler,"renderRuler"));Yc.a.removeHandler(this.Nic,sa.a.scroll,Object(F.a)(this,this.fmb,"updateRulerLocation"));this.ld.RRe(Object(F.a)(this,this.ikc,"onCloseTextEditView"));this.ld.gmd(Object(F.a)(this,
this.Hkc,"onOpenTextEditView"));this.DJ.Uld(this.lxa);this.oJ&&this.F4?(za.a.tKa(this.oJ,"ShowWACHorizontalRulerContainer"),za.a.BI(this.oJ,"HideWACHorizontalRulerContainer"),sj.UISurfaces.yUc().then(a=>{a.dispose(this.F4);return null}),this.oJ.removeChild(this.F4),this.MIa.removeChild(this.oJ),this.F4=this.oJ=null):va.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.oJ&&this.F4){za.a.tKa(this.oJ,"HideWACHorizontalRulerContainer");
za.a.BI(this.oJ,"ShowWACHorizontalRulerContainer");var b=this.Kc.Ic;if(b&&b.Fd){var c=b.Fd;c=new gr.a(c.oq,c.Vk);b=this.Nv.F6b(c,b.Bca?b.Bca.xa.style.visibility===$i.a.visible:!1).width;c=this.Le.ai(this.Kc.Ic.MB).width;1===this.Ogc.Fl||0>=b||0>=c?va.a.J(512496003,824,50,"Ruler should not be rendered"):(this.jM.rulerCanvasProps=this.VGk(Of.a.Lfa(b,0)),c=Object(F.a)(this,this.Hvk,"onIndentChange"),this.jM.onIndentChange=c,this.jM.indents=this.jM.rulerCanvasProps.textEditableArea?this.BHk():null,this.jM.rtl=
this.qma?!this.hu:this.hu,this.jM.inverted=this.qma?!this.hu:this.hu,this.F4.style.width=this.Le.Pc(b),this.fmb(null),sj.UISurfaces.yUc().then(f=>{f.renderRuler(this.F4,this.jM);return null}),b=window.performance.now(),va.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else va.a.J(512496004,824,50,"Unable to get slideViewElement")}else va.a.J(512496005,824,50,"Ruler container div / Ruler div null")}VGk(a){const b={},c=te.a.Qv(this.oc.$m.eb(hb.a.slideWidth));var f=a/2;let l=
0,w=Of.a.fK(a,0);b.zeroScale=Of.a.fK(f,0);this.qma=!1;b.textEditableArea=!1;if(this.pa.C_()&&!this.pa.eVa()){f=this.pa.q_();var H=f.sc(this.Fb.Ma),U=H.rotation;U>this.yBe&&U<this.ABe&&(this.qma=!0);const ja=H.htmlElement.querySelector(".ShapeViewContent"),wa=this.Ea.GTc(f,this.Fb.Md);U=0;f.Og&&(U=f.ys().sc(this.Fb.Ma).htmlElement.offsetLeft);U+=H.htmlElement.offsetLeft+ja.parentNode.offsetLeft+(wa?wa.e:0);H=U+ja.offsetWidth;f=(this.qma?!this.hu:this.hu)?H:U;U>=l&&U<=w&&H>=l&&H<=w&&(l=U,w=H,b.zeroScale=
f,b.textEditableArea=!0)}U=te.a.Wta(c)/a;a=U*Of.a.Lfa(w-l,0);U*=Of.a.Lfa(l,0);b.leftMargin=l;b.rightMargin=w;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=te.a.iMa(a);b.leftBoundary=te.a.iMa(U);return b}Hkc(){this.g$&&this.renderRuler()}ikc(){this.g$&&this.renderRuler()}BHk(){var a={};if(32!==this.ia.La(D.a.pJb,2,a))return va.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},f={type:"LeftIndent"};
a=a.cB;if(!a)return va.a.J(512496E3,824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?te.a.iMa(a.vNb+a.VN):2===a.specialIndentType?te.a.iMa(a.VN-a.vNb):te.a.iMa(a.VN);c.value=te.a.iMa(a.VN);f.value=te.a.iMa(a.VN);return[b,c,f]}Hvk(a,b){const c=new hS.a;c.unit=1;c.value=te.a.Wta(b);this.LDj(a,c)}LDj(a,b){var c=this.pa.q_();if(a&&b&&c){var f=window.performance.now(),l=this.Jb.oe(15);l.nc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.La(L.a.pMb,2,b);l.jd=L.a.pMb;break;case "HangingIndent":c=
this.ia.La(L.a.rMb,2,b);l.jd=L.a.rMb;break;case "LeftIndent":c=this.ia.La(L.a.Ika,2,b);l.jd=L.a.Ika;break;default:va.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}l.dispose();b=window.performance.now();va.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&va.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else va.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}QJ(){this.uPd();this.g$=!0;this.Rb.Wuf(Object(F.a)(this,
this.renderRuler,"renderRuler"));Yc.a.addHandler(this.Nic,sa.a.scroll,Object(F.a)(this,this.fmb,"updateRulerLocation"));this.ld.hHc(Object(F.a)(this,this.ikc,"onCloseTextEditView"));this.ld.YYb(Object(F.a)(this,this.Hkc,"onOpenTextEditView"));this.DJ.QGc(this.lxa)}fmb(){if(this.g$){var a=this.Kc.Ic;a&&a.MB&&window.requestAnimationFrame(()=>{const b=Kd.a.H9a(a.MB),c=Kd.a.H9a(this.MIa);this.F4.style.marginLeft=this.Le.Pc(b.x-c.x+1)})}else va.a.J(512495967,824,10,"UpdateRulerLocation called with cookie value false")}eTi(){if(this.oJ)return this.oJ;
this.oJ=document.createElement("div");this.oJ.id="WACHorizontalRulerContainer";this.oJ.className="WACHorizontalRulerContainer";this.oJ.setAttribute(Bc.a.ns,"ruler");this.oJ.setAttribute(Bc.a.af,Bc.a.bCa);Sys.UI.DomElement.addCssClass(this.oJ,"HideWACHorizontalRulerContainer");return this.oJ}fTi(){if(this.F4)return this.F4;this.F4=document.createElement("div");this.F4.className="WACHorizontalRuler";this.F4.id="WACHorizontalRuler";return this.F4}uPd(){this.oJ=this.eTi();this.oJ.appendChild(this.fTi());
this.MIa.insertBefore(this.oJ,this.MIa.firstChild)}}Object(n.a)(oF,"HorizontalRuler",null,[367]);class pF{constructor(a,b,c,f,l){this.fNj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Rb=b;this.fTg=c;this.s6c=f;this.scd=l}wb(){this.ia.ra(L.a.jrd,Cb.a.application,Object(F.a)(this,this.jrd,
"showHideRuler"),4);this.ia.ra(L.a.bkd,Cb.a.application,Object(F.a)(this,this.bkd,"queryRulerToggle"),96)}MEj(){this.k0c()&&(va.a.J(523351431,824,15,"Ruler init is called"),this.fTg.mfg())}jrd(a,b,c){return this.k0c()?this.OAj(c):this.Snl(c)}FIh(){this.Rb.rG({ShowHideRuler:"ToggleButtonModel"})}Snl(a){if(1===a)return 32;va.a.J(523351432,824,15,"ShowRuler called");this.fTg.mfg();this.rsh(!0);this.Rb.Oq();this.FIh();return 32}OAj(a){if(1===a)return 32;va.a.J(523351433,824,15,"HideRuler called");this.VOi();
this.rsh(!1);this.Rb.Oq();this.FIh();return 32}VOi(){this.k0c()&&(this.s6c.dispose(),this.scd.dispose(),this.Rb.Oq())}bkd(a,b,c,f,l){if(1===c)return 32;l&&(l[Vh.a.On]=this.k0c());return 32}k0c(){return ui.a.I3(kx.a.Pbh,this.fNj)}rsh(a){ui.a.aK(u.AFrameworkApplication.fa.Ga("IsRulerOnCookieName"),a.toString(),ui.a.FJ)}}Object(n.a)(pF,"RulerActor",null,[]);class qP{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");
this.s6c=a;this.scd=b;this.Rb=c}mfg(){this.s6c.QJ();this.scd.QJ();this.Rb.Oq();this.s6c.renderRuler();this.scd.renderRuler()}}Object(n.a)(qP,"RulerFactory",null,[265]);class Lq{constructor(a,b,c,f,l,w,H,U,ja,wa,Sa,eb,ub,Ub){this.VTd="HideWACVerticalRulerContainer";this.NCf="ShowWACVerticalRulerContainer";this.qma=this.g$=!1;this.s5=this.CJ=null;this.lxa=()=>{this.g$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");
if(!l)throw Error.argumentNull("selectionManager");if(!w)throw Error.argumentNull("shapeReader");if(!H)throw Error.argumentNull("pageView");if(!U)throw Error.argumentNull("slideDimensionsHelper");if(!ja)throw Error.argumentNull("presentationReader");if(!wa)throw Error.argumentNull("pptPageView");if(!Sa)throw Error.argumentNull("applicationSettings");if(!eb)throw Error.argumentNull("viewElementEventHandlers");if(!ub)throw Error.argumentNull("viewCoreEventHandlers");this.Rb=a;this.Kc=b;this.Le=c;this.MIa=
f;this.pa=l;this.Fb=H;this.oc=ja;this.hu=Ub;this.Nv=U;this.Ogc=wa;this.yBe=Sa.snh;this.ABe=Sa.rnh;this.ld=eb;this.DJ=ub}get Nic(){return document.getElementById(O.AppFrame.tKh)}dispose(){this.g$=!1;Yc.a.removeHandler(this.Nic,sa.a.scroll,Object(F.a)(this,this.fmb,"updateRulerLocation"));this.Rb.ljh(Object(F.a)(this,this.renderRuler,"renderRuler"));this.ld.RRe(Object(F.a)(this,this.ikc,"onCloseTextEditView"));this.ld.gmd(Object(F.a)(this,this.Hkc,"onOpenTextEditView"));this.DJ.Uld(this.lxa);this.CJ&&
this.s5?(za.a.tKa(this.CJ,this.NCf),za.a.BI(this.CJ,this.VTd),sj.UISurfaces.yUc().then(a=>{a.dispose(this.s5);return null}),this.CJ.removeChild(this.s5),this.MIa.removeChild(this.CJ),this.s5=this.CJ=null):va.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.CJ&&this.s5){za.a.tKa(this.CJ,this.VTd);za.a.BI(this.CJ,this.NCf);var b=this.Kc.Ic;if(b&&b.Fd){var c=b.Fd;c=new gr.a(c.oq,c.Vk);b=this.Nv.F6b(c,b.Bca?b.Bca.xa.style.visibility===
$i.a.visible:!1).height;c=this.Le.ai(this.Kc.Ic.MB).height;if(1===this.Ogc.Fl||0>=b||0>=c)va.a.J(512495963,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.DHk(Of.a.Lfa(b,1));f.rtl=this.qma?!this.hu:this.hu;f.inverted=this.qma?!this.hu:this.hu;this.s5.style.height=this.Le.Pc(b);this.fmb(null);sj.UISurfaces.yUc().then(l=>{l.renderRuler(this.s5,f);return null});b=window.performance.now();va.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else va.a.J(512495964,
824,50,"Unable to get slideViewElement")}else va.a.J(512495965,824,50,"Ruler container div / Ruler div null")}DHk(a){const b={},c=te.a.Qv(this.oc.$m.eb(hb.a.slideHeight));var f=a/2;let l=0;a=Of.a.fK(a,0);b.zeroScale=Of.a.fK(f,0);this.qma=!1;b.textEditableArea=!1;if(this.pa.C_()&&!this.pa.eVa()){f=this.pa.q_();var w=f.sc(this.Fb.Ma);const U=w.htmlElement.querySelector(".ShapeViewContent");var H=w.rotation;H>this.yBe&&H<this.ABe&&(this.qma=!0);H=0;f.Og&&(H=f.ys().sc(this.Fb.Ma).htmlElement.offsetTop);
H+=w.htmlElement.offsetTop+U.parentNode.offsetTop+U.offsetTop;w=H+U.offsetHeight;f=(this.qma?!this.hu:this.hu)?w:H;H>=l&&H<=a&&w>=l&&w<=a&&(l=H,a=w,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}QJ(){this.uPd();this.g$=!0;Yc.a.addHandler(this.Nic,sa.a.scroll,Object(F.a)(this,this.fmb,"updateRulerLocation"));this.Rb.Wuf(Object(F.a)(this,this.renderRuler,"renderRuler"));this.ld.hHc(Object(F.a)(this,this.ikc,"onCloseTextEditView"));
this.ld.YYb(Object(F.a)(this,this.Hkc,"onOpenTextEditView"));this.DJ.QGc(this.lxa)}fmb(){if(this.g$){var a=this.Kc.Ic;a&&a.MB&&window.requestAnimationFrame(()=>{const b=Kd.a.H9a(a.MB),c=Kd.a.H9a(this.MIa);this.s5.style.marginTop=this.Le.Pc(b.y-c.y+1)})}else va.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}Hkc(){this.g$&&this.renderRuler()}ikc(){this.g$&&this.renderRuler()}uPd(){this.CJ=this.bUi();this.CJ.appendChild(this.cUi());this.MIa.insertBefore(this.CJ,this.MIa.firstChild)}bUi(){if(this.CJ)return this.CJ;
this.CJ=document.createElement("div");this.CJ.id=Lq.Qoi;this.CJ.className=Lq.Poi;this.CJ.setAttribute(Bc.a.ns,"ruler");this.CJ.setAttribute(Bc.a.af,Bc.a.bCa);Sys.UI.DomElement.addCssClass(this.CJ,this.VTd);return this.CJ}cUi(){if(this.s5)return this.s5;this.s5=document.createElement("div");this.s5.className=Lq.Ooi;this.s5.id=Lq.Roi;return this.s5}}Lq.Qoi="WACVerticalRulerContainer";Lq.Poi="WACVerticalRulerContainer";Lq.Roi="WACVerticalRuler";Lq.Ooi="WACVerticalRuler";Object(n.a)(Lq,"VerticalRuler",
null,[367]);class qF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}Zb(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").sjb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(oF,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().oa(()=>new oF(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.vvc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
u.AFrameworkApplication.isRtl));this.K.register(Lq,"PowerPointWebEditor.Ruler.VerticalRuler").ma().oa(()=>new Lq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.vvc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(265,"PowerPointWebEditor.Ruler.IRulerFactory").ma().oa(()=>new qP(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),a));this.K.register(pF,
"PowerPointWebEditor.Ruler.RulerActor").ma().oa(()=>new pF(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").wb();db.a.get_instance().Uj(8,()=>{this.qHe()})}}qHe(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").MEj()}dispose(){}static main(){v.a.instance.Dc(new qF)}}
Object(n.a)(qF,"PPTWebEditorRulerPackage",null,[2,3]);class wA{static get YMl(){return wA.ZMl}}wA.ZMl="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(n.a)(wA,"ZoomDialogHtml",null,[]);class gy extends ci.a{constructor(a,b,c,f,l=!1){super(!1,!1,l);this.nYb=this.mYb=this.Da=this.dwc=null;this.TMl=
"ZoomDialogBoxGroup";this.wPa=a;this.WFc=b;this.Xrf=c;this.Od=f;this.eg=this.fli();this.yd=1;this.ig="ZoomDialog"}get zPe(){return"ListRadioBox"}get boc(){return"radiobox"}get Jeh(){return"WACZoomDialogRadioRow"}get yPe(){return"WACZoomDialogRadioRow-highlight"}get No(){return this.Od}get M7(){return this.dwc}oxh(a,b){if(this.MK)this.Bol(a,b);else{const c={};for(let f=0;f<this.wPa.length;f++)c[this.boc+f]=this.WFc[f]===b?!0:!1;this.aj(a,Object(F.a)(this,this.VMl,"zoomDialogHandler"),c);this.aQe();
this.KQe()}}Bol(a,b){var c=Array(this.wPa.length);let f="";for(let l=0;l<this.wPa.length;l++){const w=l.toString();c[l]={["key"]:w,["text"]:this.wPa[l]};b===this.WFc[l]&&(f=w)}b={};b.dialogChoiceGroupProps={["id"]:this.TMl,["defaultSelectedKey"]:f,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.aj(a,Object(F.a)(this,this.$Ml,"zoomDialogReactHandler"),c)}C8k(){this.dwc=document.getElementsByName(this.zPe)[0];this.QQc(this.M7)}b8(){this.Da||(this.Da=document.getElementById("WACDialogText"));
this.Da&&(this.mYb||(this.mYb=Object(F.a)(this,this.UMl,"zoomDialogClickHandler"),this.yn.pb(sa.a.click,this.Da,this.mYb)),this.nYb||(this.nYb=Object(F.a)(this,this.WMl,"zoomDialogKeyDownHandler"),this.Rg.pb(sa.a.Xf,this.Da,this.nYb)));super.b8();this.Hb&&this.Rg.pb(sa.a.Il,this.Hb,Object(F.a)(this,this.DN,"dialogDefaultEnterKeyHandler"))}aQe(){this.No.yl().scope.Dp(y.FocusManager.instance().Wqa);this.No.yl().scope.Dp(y.FocusManager.instance().Xqa);this.No.yl().scope.bindAction(y.FocusManager.instance().Wqa,
G.a.Evc);this.No.yl().scope.bindAction(y.FocusManager.instance().Xqa,G.a.Dvc)}KQe(){const a=document.getElementsByName(this.zPe);for(let b=0;b<a.length;b++){const c=a[b];Yc.a.addHandler(c,sa.a.focus,Object(F.a)(this,this.Ekd,"radioButtonFocusHandler"));c.checked&&(this.dwc=c)}}VMl(a,b){if(1===a)for(a=0;a<this.wPa.length;a++)if(b[this.boc+a]){this.Xrf(this.WFc[a]);break}}Ekd(a){this.QQc(a.target)}UMl(a){a=a.Ec;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.Jeh))return!1;
a=this.A3f(a);a=document.getElementById(this.boc+a);this.QQc(a);return!0}$Ml(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.Xrf(this.WFc[a]))}WMl(a){a=a.qc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.A3f(this.M7);const c=this.wPa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.boc+b);this.QQc(a);return!0}DN(a){return a.eventName===
sa.a.Il&&a.qc.keyCode===Sys.UI.Key.enter?(super.DN(a),!0):!1}QQc(a){a&&(a.checked=!0,this.No.Ae&&this.No.Ae.name===this.iL||this.No.rf(this.iL),this.No.yl().wj.ZE(a),a.focus(),this.M7&&Sys.UI.DomElement.removeCssClass(this.M7.parentNode,this.yPe),Sys.UI.DomElement.addCssClass(a.parentNode,this.yPe),this.dwc=a)}A3f(a){return Number.parseInvariant(ha.a.substr(a.id,a.id.length-1,1))}BA(){super.BA();const a=document.getElementById(this.Oh("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}fli(){let a="";for(let b=0;b<this.wPa.length;b++)a+=ci.a.VA(gy.XMl,b.toString(),this.wPa[b],this.zPe);return a}dispose(){this.Da&&(this.yn&&this.mYb&&this.yn.yb(sa.a.click,this.Da,this.mYb),this.Rg&&this.nYb&&this.Rg.yb(sa.a.Xf,this.Da,this.nYb));this.yn&&this.Hb&&this.Rg.yb(sa.a.Il,this.Hb,Object(F.a)(this,this.DN,"dialogDefaultEnterKeyHandler"));super.dispose()}}gy.XMl=wA.YMl;Object(n.a)(gy,"ZoomDialog",ci.a,[394]);class rF{constructor(){this.Af=null}create(a,
b,c,f){return this.Af=new gy(a,b,c,f)}}Object(n.a)(rF,"ZoomDialogFactory",null,[398]);class sF{constructor(){this.Da=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}Zb(a){this.Da=a;this.Da.register(rF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").oa(()=>new rF).ma()}static main(){v.a.instance.Dc(new sF)}}Object(n.a)(sF,"ZoomPackage",null,[2,3]);class rP{constructor(a,b,c,f,l,w,H,U){this.Bkk=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.Kcd="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.Af=null;this.ia=a;this.Fa=b;this.oc=l;this.gj=c;this.Rb=f;this.Ik=w;this.utg=H;this.nYg=U}wb(){this.ia.ra(L.a.sPe,nc.a.application,Object(F.a)(this,this.xOk,"queryZoom"),96);this.ia.ya(L.a.SJe,nc.a.application,Object(F.a)(this,this.Cyj,"handleZoomConfig"));this.ia.ya(L.a.Fvc,nc.a.application,Object(F.a)(this,this.Dyj,"handleZoomToFit"));this.ia.ya(G.a.Evc,Xd.a.frame,Object(F.a)(this,this.rLh,"zoomDialogTabFocusHandler"));
this.ia.ya(G.a.Dvc,Xd.a.frame,Object(F.a)(this,this.rLh,"zoomDialogTabFocusHandler"));u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.ya(G.a.Cub,Xd.a.frame,Object(F.a)(this,this.Cub,"decreaseZoom")),this.ia.ya(G.a.Gyb,Xd.a.frame,Object(F.a)(this,this.Gyb,"increaseZoom")),this.ia.ya(G.a.bNl,Xd.a.frame,Object(F.a)(this,this.TAk,"onZoomToPercentage")),this.ia.ra(G.a.yOk,Xd.a.frame,Object(F.a)(this,this.Sxk,"onQueryZoomPercentage"),96),Pd.a("ZoomShortCutsEnabled")&&(this.ia.ya(D.a.qMf,
Xd.a.frame,ac.ActionManager.Ng),this.ia.ya(D.a.pMf,Xd.a.frame,ac.ActionManager.Ng)))}Ee(){if(u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&Pd.a("ZoomShortCutsEnabled")){const a=this.Fa.Fc(Lb.a.hj);a.bindAction(x.KeyInputManager.Oa(A.a.Svd,x.KeyInputManager.Oe),G.a.Gyb);a.bindAction(x.KeyInputManager.Oa(A.a.Vvd,x.KeyInputManager.Oe),G.a.Gyb);a.bindAction(x.KeyInputManager.Oa(A.a.Tvd,x.KeyInputManager.Oe),G.a.Cub);a.bindAction(x.KeyInputManager.Oa(A.a.jvc,x.KeyInputManager.Oe),G.a.Cub);this.utg&&
ra.a.instance.pb(sa.a.xGb,this.utg,Object(F.a)(this,this.Idi,"adjustZoomOnMouseWheel"))}}Idi(a){return a?a.a_?(0<a.LKh?this.sMa(this.I0g):0>a.LKh&&this.sMa(this.J0g),!0):!1:!1}get Q7a(){return Math.round(100*this.gj.TU)}get J0g(){return Math.floor(this.Q7a/10)/10+.1}get I0g(){return Math.ceil(this.Q7a/10)/10-.1}xOk(a,b,c,f,l){if(!l||Pd.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.Q7a)||0==this.Q7a))return 8;l[qE.a.LabelText]=Math.round(100*this.gj.TU)+"%";this.Ik&&(this.Ik.daa(this.Ik.R0a,this.Ik.sLh),
this.Ik.baa(this.Ik.R0a,this.Ik.sLh));return 32}Cyj(a,b,c,f,l){if(1===c)return this.oc.qj()?32:8;if(!l)return 8;this.Af=new gy(this.Bkk,this.Kcd,Object(F.a)(this,this.Ewd,"zoomSettingAction"),y.FocusManager.instance(),!0);this.Af.oxh(CommonUIStrings.l_ZoomDialogTitle,this.gj.Yka?this.Kcd[0]:this.gj.TU.toString());return 32}Ewd(a){if(a!==this.Kcd[0]){const b=parseFloat(a);if(isNaN(b)){va.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.gj.Yka=!1;this.gj.TU=b;this.gj.umb=2}else this.gj.Yka=
!0;this.Rb.Oq();va.a.J(512288458,827,50,"Succeeded to Zoom: {0}",a)}Dyj(a,b,c,f,l){if(1===c)return Pd.a("ZoomToFitTTVRImprovement")&&this.nYg?this.oc.$m&&!this.oc.qj()?8:32:this.oc.qj()?32:8;if(!l)return 8;if(Pd.a("ZoomToFitTTVRImprovement")&&this.nYg&&!this.oc.$m)return va.a.J(509212699,827,50,"Content Editable hasn't reached yet as presentation node hasn't been set"),8;this.Ewd(this.Kcd[0]);return 32}rLh(a){if(!this.Af)return 8;var b=this.Af.No.yl().wj.d_;if(b===this.Af.Yv&&a===G.a.Evc||b===this.Af.wD&&
a===G.a.Dvc)this.Af.M7||this.Af.C8k(),this.Af.No.yl().wj.ZE(this.Af.M7);else if(b.id.startsWith(this.Af.boc)||b.className.startsWith(this.Af.Jeh))b=null,a===G.a.Evc?b=this.Af.wD:a===G.a.Dvc&&(b=this.Af.Yv),this.Af.No.yl().wj.ZE(b),Sys.UI.DomElement.removeCssClass(this.Af.M7.parentNode,this.Af.yPe);else if(a===G.a.Evc)this.Af.No.yl().AGb();else if(a===G.a.Dvc)this.Af.No.yl().yGb();else return 16;return 32}Gyb(a,b,c){if(1===c)return 32;this.sMa(this.J0g);va.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");
return 32}Cub(a,b,c){if(1===c)return 32;this.sMa(this.I0g);va.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}TAk(a,b,c,f,l){if(1===c)return 32;a=l.value/100;this.sMa(a);va.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.CN=Math.floor(100*a));return 32}Sxk(a,b,c,f,l){if(Pd.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.Q7a)||0==this.Q7a))return 8;l.MinValue=10;l.MaxValue=400;l.value=this.Q7a;return 32}sMa(a){.1>a?a=.1:4<a&&(a=4);this.gj.Yka=!1;this.gj.TU=
a;this.gj.umb=2;this.Rb.Oq()}}Object(n.a)(rP,"ZoomActor",null,[365]);class tF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}Zb(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.AppFrame");const b=this.K.resolve("Common.IActionManagerExtended"),c=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new rP(b,c,this.K.resolve("PowerPointWebEditor.IZoomContext"),a,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),
a.mRd,this.K.resolve("Common.IAppSettingsManager").getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ZoomToFitTTVRImprovement",!1));a.wb();a.Ee()}dispose(){}static main(){v.a.instance.Dc(new tF)}}Object(n.a)(tF,"PPTWebEditorZoomPackage",null,[2,3]);var iS=d(379),jS=d(348),sP=d(663),kS=d(143);class Zv extends sP.a{constructor(){super();this.contextId=this.context=this.numSlides=this.prompt=null;this.H_=Object.assign(new kS.a,{T_:Zv.getTypeName(),B_:Zv.getBaseTypes()})}static getTypeName(){return"AugLoop_Storyteller_StorytellerSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(n.a)(Zv,"StorytellerSignal",sP.a,[]);class lS{}Object(n.a)(lS,"StorytellerDebugParams",null,[]);const Vw=new Map;class tP{constructor(a){this.Ddh=new Promise((b,c)=>{this.P3k=f=>{r("AugLoopGetQuestionsSucceeded",new Date);b(f)};this.YQe=f=>{r("AugLoopGetQuestionsFailed",new Date);c(f)}});this.Xfk=new Promise((b,c)=>{this.M3k=f=>{r("AugLoopGetOutlineSucceeded",new Date);b(f)};this.Uhh=f=>{r("AugLoopGetOutlineFailed",new Date);c(f)}});this.Wfk=new Promise((b,c)=>{this.F3k=f=>{r("AugLoopGetColorsSucceeded",
new Date);b(f)};this.Thh=f=>{r("AugLoopGetColorsFailed",new Date);c(f)}});this.Yfk=new Promise((b,c)=>{this.W3k=f=>{r("AugLoopGetTemplatesSucceeded",new Date);b(f)};this.Vhh=f=>{r("AugLoopGetTemplatesFailed",new Date);c(f)}});this.promise=Promise.allSettled([this.Xfk,this.Wfk,this.Yfk]);this.Udk=window.setTimeout(()=>{this.Uhh(`Timeout outlinePromise after ${a.tPe} ms`)},a.iCk);this.X7j=window.setTimeout(()=>{this.Thh(`Timeout colorsPromise after ${a.sHf} ms`)},a.sHf);this.Uik=window.setTimeout(()=>
{this.Vhh(`Timeout templatePromise after ${a.mCh} ms`)},a.mCh);this.dgk=window.setTimeout(()=>{this.YQe(`Timeout questionsPromise after ${a.tPe} ms`)},a.tPe)}}Object(n.a)(tP,"DeferredStorytellerAugLoopPromise",null,[]);class uF{constructor(a,b){this.fse=new Map;this.$pe=new Map;this.la=a;this.kz=b;this.kz.execute(c=>{this.la.ka("StoryTellerShowQuestions")&&(c.tia("AugLoop_Storyteller_StorytellerQuestionsResponse"),c.oKa("AugLoop_Storyteller_StorytellerQuestionsResponse",this.u_.bind(this)));c.tia("AugLoop_Storyteller_StorytellerOutlineResponse");
c.oKa("AugLoop_Storyteller_StorytellerOutlineResponse",this.u_.bind(this));c.tia("AugLoop_Storyteller_StorytellerColorsResponse");c.oKa("AugLoop_Storyteller_StorytellerColorsResponse",this.u_.bind(this));c.tia("AugLoop_Storyteller_StorytellerTemplatesResponse");c.oKa("AugLoop_Storyteller_StorytellerTemplatesResponse",this.u_.bind(this))})}T9k(a,b,c){var f;if(a.contextId){var l=Object.assign(new Zv,Object.assign(Object.assign({},a),{debugParams:{debugMetadataEnabled:this.la.RZc,outlinePromptTemplate:0<
(null===(f=this.la.Izh)||void 0===f?void 0:f.length)?this.la.Izh:void 0}})),w=Object.assign(new jS.a,{parentPath:["Signal",Zv.getTypeName()],items:[Object.assign(new iS.a,{body:l})]});f=new tP({tPe:this.la.Bc("StoryTellerQuestionsAnnotationTimeout",1E4),iCk:this.la.Bc("StoryTellerOutlineAnnotationTimeout",2E4),sHf:this.la.Bc("StoryTellerColorsAnnotationTimeout",1E4),mCh:this.la.Bc("StoryTellerTemplatesAnnotationTimeout",1E4)});this.la.ka("StoryTellerShowQuestions")||f.YQe("ShowStoryTellerQuestions disabled");
Promise.allSettled([f.Ddh,f.promise]).then(()=>{this.fse.delete(a.contextId);this.$pe.delete(a.contextId)});f.Ddh.then(H=>b(H.questionsResponse)).catch(H=>{H=this.la.RZc?"":JSON.stringify(H);va.a.J(509214794,817,10,`StorytellerAugLoopManager:sendStorytellerSignal questionsPromise Exception ${H}`)});f.promise.then(([H,U,ja])=>{var wa,Sa,eb,ub,Ub,cc,Fc,Ic,Cc,Ud,je,Vd,Ve,af;if("rejected"==H.status)return va.a.J(509195422,817,10,`StorytellerAugLoopManager:sendStorytellerSignal Promise rejected - outline:${H.status}, colors:${U.status}, templates:${ja.status}`),
c(void 0);const Zf={ColorScheme:"fulfilled"==U.status?{Accent1:null===(wa=U.value.colorPalette)||void 0===wa?void 0:wa.accent1,Accent2:null===(Sa=U.value.colorPalette)||void 0===Sa?void 0:Sa.accent2,Accent3:null===(eb=U.value.colorPalette)||void 0===eb?void 0:eb.accent3,Accent4:null===(ub=U.value.colorPalette)||void 0===ub?void 0:ub.accent4,Accent5:null===(Ub=U.value.colorPalette)||void 0===Ub?void 0:Ub.accent5,Accent6:null===(cc=U.value.colorPalette)||void 0===cc?void 0:cc.accent6,Hyperlink:null===
(Fc=U.value.colorPalette)||void 0===Fc?void 0:Fc.hyperlink,ClickedHyperlink:null===(Ic=U.value.colorPalette)||void 0===Ic?void 0:Ic.clickedHyperlink,LightBackground:null===(Cc=U.value.colorPalette)||void 0===Cc?void 0:Cc.lightBackground,DarkBackground:null===(Ud=U.value.colorPalette)||void 0===Ud?void 0:Ud.darkBackground,TextColorLight:null===(je=U.value.colorPalette)||void 0===je?void 0:je.textColorLight,TextColorDark:null===(Vd=U.value.colorPalette)||void 0===Vd?void 0:Vd.textColorDark}:{},PresOutline:{Title:null===
(Ve=H.value.presentation)||void 0===Ve?void 0:Ve.title,Slides:null===(af=H.value.presentation)||void 0===af?void 0:af.slides.map(lg=>{var Tg;return{Title:lg.title,Notes:lg.notes,KeyPoints:lg.keyPoints,ImagesQuery:lg.images,Images:null===(Tg=lg.imageUrls)||void 0===Tg?void 0:Tg.map(Ug=>({Url:Ug,Format:""}))}})},ThemeIds:"fulfilled"==ja.status?ja.value.templateIds:void 0};return c(Zf)}).catch(H=>{H=this.la.RZc?"":JSON.stringify(H);va.a.J(509214863,817,10,`StorytellerAugLoopManager:sendStorytellerSignal outlinePromise Exception ${JSON.stringify(H)}`)});
this.fse.set(a.contextId,f);this.$pe.set(a.contextId,new Date);this.kz.execute(H=>{H.submitOperation(w);r("AugLoopOpSubmitted",new Date)})}else va.a.J(509214865,817,10,"StorytellerAugLoopManager:sendStorytellerSignal No contextId")}u_(a){var b;if(a.contextId){var c=this.fse.get(a.contextId),f=this.$pe.get(a.contextId);if(c&&f){var l=null!==(b=a.loggableMetadata)&&void 0!==b?b:{};l.annotationType=a.ownerId;l.lQl=(+new Date-+f).toString();va.a.J(509207583,817,50,`StorytellerAugLoopManager:handleAnnotationEvent ${JSON.stringify(l)}`);
a.debugMetadata&&0<Object.keys(a.debugMetadata).length&&console.log(`Storyteller Debug Info for ${a.ownerId}: ${JSON.stringify(a.debugMetadata)}`);return uF.BYj(a)?this.gmh(!0,a,c):this.gmh(!1,a,c)}va.a.J(509214861,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No deferredPromise found")}else va.a.J(509214862,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No contextId")}gmh(a,b,c){switch(b.ownerId){case "StorytellerQuestions":clearTimeout(c.dgk);a?c.P3k(b):c.YQe(b);break;case "StorytellerOutline":clearTimeout(c.Udk);
a?c.M3k(b):c.Uhh(b);break;case "StorytellerColors":clearTimeout(c.X7j);a?c.F3k(b):c.Thh(b);break;case "StorytellerTemplates":clearTimeout(c.Uik);a?c.W3k(b):c.Vhh(b);break;default:va.a.J(509214860,817,10,`StorytellerAugLoopManager:resolveOrRejectDeferredPromise Invalid type:${b.ownerId}, resolve:${a}`)}}static BYj(a){if(!a)return va.a.J(509214859,822,10,"StorytellerAugLoopManager:isValidStorytellerAnnotation annotationItem is undefined."),!1;const b=null===a||void 0===a?void 0:a.status;if(!b||0!==
b.code)return va.a.J(509214858,817,10,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} error response. status: ${b?JSON.stringify(b):""}`),!1;va.a.J(509214857,817,50,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} is valid.`);return!0}dispose(){}}Object(n.a)(uF,"StorytellerAugLoopManager",null,[]);class hy extends Sys.EventArgs{constructor(a){super();this.SWi=a}}Object(n.a)(hy,"QueueShowingPanesEventEventArgs",Sys.EventArgs,[]);class vF{Yvh(){return this.la.ka("StoryTellerWaitForThumbnailRefreshForDismissDialog")}constructor(a,
b,c,f,l){this.p$c=5;this.y$c=new Date;this.mqe=0;this.E5c=!1;this.kxa=()=>{this.ld.VRe(this.kxa);this.E5c=!0};this.syk=()=>{wo.c(L.a.P4k,!0)};this.onClose=()=>{this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.je.Wkd(new hy(!1));this.Yvh()&&(this.ld.VRe(this.kxa),this.E5c=!1);wo.c(L.a.Evi,!0)};this.rJe=(w,H)=>{wo.c(L.a.ftl,!0);void 0!=this.x$c&&this.la.ka("StoryTellerShowQuestions")||(this.x$c=w,this.mqe++,this.y$c=new Date,r("PromptSubmitted",this.y$c));if(H)switch(H.presentationLength){case "shortLength":this.p$c=
5;break;case "mediumLength":this.p$c=8;break;case "longLength":this.p$c=11}const U=Object.assign(new Zv,{prompt:this.x$c,numSlides:this.p$c,context:null===H||void 0===H?void 0:H.additionalContext,contextId:gh.a.create().toString()});let ja=()=>{},wa=()=>{};H=new Promise((Sa,eb)=>{ja=(ub,Ub)=>{va.a.J(509158928,817,15,`Storyteller${Ub}Succeeded: ${JSON.stringify({totalDurationMs:+new Date-+this.y$c,augLoopContextId:U.contextId,attemptCount:this.mqe,events:Vw})}`);"PromptToOutlineFlow"===Ub&&Vw.clear();
Sa(ub)};wa=ub=>{va.a.J(509158927,817,10,`StorytellerFailed: ${JSON.stringify({reason:ub,totalDurationMs:+new Date-+this.y$c,augLoopContextId:U.contextId,attemptCount:this.mqe,events:Vw})}`);Vw.clear();eb(ub)}});this.jik.T9k(U,Sa=>Object(al.a)(this,void 0,void 0,function*(){if(this.la.ka("StoryTellerShowQuestions")){if(!Sa)return va.a.J(509195421,817,10,"StorytellerView:onSubmit:questionsCallback questionsAnnotation failed"),r("AugLoopGetQuestionsFailed",new Date),wa("questionsAnnotation failed");
if(this.x$c==w){const eb={ColorScheme:{},PresOutline:{Title:void 0,Slides:[{Title:Sa.slide.title,Notes:Sa.slide.notes,KeyPoints:Sa.slide.keyPoints,ImagesQuery:Sa.slide.images}]},ThemeIds:void 0};try{r("Send1stOutlineToPPT",new Date);const ub=yield this.iWa.w5f(eb);r("Send1stMergeSlides",new Date);this.iWa.MZg(ub)}catch(ub){va.a.J(509211014,817,10,`StorytellerView:onSubmit:questionsCallback Exception ${ub}`),r("QuestionsCallbackFailed",new Date),wa(`${ub}`)}r("QuestionsCallbackSucceeded",new Date);
return ja({prompts:Sa.qList,fShouldDismiss:!1},"PromptToQuestionFlow")}}else va.a.J(509159458,817,10,"StorytellerView:onSubmit:questionsCallback ShowStoryTellerQuestions disabled")}),Sa=>Object(al.a)(this,void 0,void 0,function*(){if(!Sa)return va.a.J(509195420,817,10,"StorytellerView:onSubmit:questionsCallback outlineAnnotation failed"),r("AugLoopGetOutlineFailed",new Date),wa("outlineAnnotation failed");if(this.x$c!=w||!this.la.ka("ShowStoryTellerQuestions"))try{r("Send2ndOutlineToPPT",new Date);
const eb=yield this.iWa.w5f(Sa);r("Send2ndMergeSlides",new Date);yield this.iWa.MZg(eb);this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.je.Wkd(new hy(!1));this.Yvh()&&(this.bXk(),yield this.lLl(this.la.Bc("StoryTellerDialogDismissTimeoutMs",3E3),this.la.Bc("StoryTellerDialogDismissPollIntervalMs",200)));r("2ndMergeSlidesSucceeded",new Date);return ja({prompts:[],fShouldDismiss:!0},"PromptToOutlineFlow")}catch(eb){return va.a.J(509211013,817,10,`StorytellerView:onSubmit:outlineCallback Exception ${eb}`),
r("OutlineCallbackFailed",new Date),wa(`${eb}`)}}));return H};this.iWa=a;this.jik=b;this.la=c;this.je=f;this.ld=l}dispose(){}m1j(){r("LoadDialog",new Date);const a=document.createElement("div");a.style.height="0px";a.style.width="0px";a.style.display="none";document.body.appendChild(a);const b={enableTryAgainButton:this.la.ka("StoryTellerEnableTryAgainButton"),promptCharacterLimit:this.la.Bc("StoryTellerPromptCharacterLimit",200),disableInputFieldEditOnBlur:this.la.ka("StoryTellerDisableInputFieldEditOnBlur"),
enablePromptCharacterLimit:this.la.ka("StoryTellerEnablePromptCharacterLimit")};(new storytellerDialog.StorytellerDialogManager(a,this.rJe,{settings:b},this.onClose,this.syk)).showDialog()}lLl(a,b){return Object(al.a)(this,void 0,void 0,function*(){function c(l=1E3){return new Promise(w=>{setTimeout(w,l)})}let f=0;for(;!this.E5c&&f<a;)yield c(b),f+=b;this.E5c||va.a.J(509141907,817,10,`StorytellerView:waitForThumbnailRefresh never received thumbnail refresh event; maxWaitTimeMs: ${a}`);va.a.J(509141906,
817,50,`StorytellerView:waitForThumbnailRefresh finished; currentWaitTimeMs: ${f}`)})}bXk(){this.ld.iHc(this.kxa)}}Object(n.a)(vF,"StorytellerView",null,[]);class uP{constructor(a,b,c){this.la=a;this.Ds=b;this.Xa=c}w5f(a){return new Promise((b,c)=>{let f=String.format("{0}?action=OutlineToPPT",this.la.Ga("CreatorServiceBase"));if(this.la.ka("StoryTellerForwardWdQueryParams")){var l=new URLSearchParams(window.location.search.toLowerCase());for(const [H,U]of l.entries())this.la.Ga("StoryTellerWdQueryParamsToForward").includes(H)&&
(f+="&"+H+"="+U)}l={};l.PodSID=this.Xa.podSessionId;l.Client="Storyteller";Object(Pd.a)("StoryTellerAddScenarioInHeader")&&(l.Scenario="Create");l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const w=new Date;this.Ds.nj(f,2,JSON.stringify(a),l,!1,0,H=>{var U;va.a.J(509211020,817,50,"CopilotProxy:getOutlineToPPTAsync: Time Taken {0}",+new Date-+w);null!==(U=null===H||void 0===H?void 0:H.data)&&void 0!==U&&U.Wd||(va.a.J(509211019,817,10,"CopilotProxy:getOutlineToPPTAsync: No response data"),
c("No response data"));H.data.ie!==Nk.a.Wv&&(va.a.J(509211018,817,10,"CopilotProxy:getOutlineToPPTAsync: Bad Http Status {0}",H.data.ie),c(`Bad Http Status ${H.data.ie}`));let ja;try{ja=JSON.parse(H.data.Wd)}catch(wa){va.a.J(509211017,817,10,"CopilotProxy:getOutlineToPPTAsync: Exception when parsing the json"),c("Exception when parsing the json")}va.a.J(509211016,817,50,"CopilotProxy:getOutlineToPPTAsync: call successful");b(ja)},H=>{var U,ja;const wa=new Date;va.a.J(509211015,817,50,"CopilotProxy:getOutlineToPPTAsync: request failed Status {0}, Time Taken {1}",
null===(U=null===H||void 0===H?void 0:H.data)||void 0===U?void 0:U.ie,+wa-+w);c(null===(ja=null===H||void 0===H?void 0:H.data)||void 0===ja?void 0:ja.ie)},null)})}MZg(a){return Object(al.a)(this,void 0,void 0,function*(){return new Promise((b,c)=>{a&&a.DownloadablePPTInfos&&0!=a.DownloadablePPTInfos.length||(va.a.J(509211025,817,10,"CopilotProxy:mergeSlides: invalid outlineToPPTResponse"),c("invalid outlineToPPTResponse"));let f=String.format("{0}",this.la.Ga("MergeSlidesFromUrlEndpoint"));if(this.la.ka("StoryTellerForwardWdQueryParams")){var l=
new URLSearchParams(window.location.search.toLowerCase());for(const [U,ja]of l.entries())this.la.Ga("StoryTellerWdQueryParamsToForward").includes(U)&&(f+="&"+U+"="+ja)}l={};l.PodSID=this.Xa.podSessionId;l.Client="Storyteller";Object(Pd.a)("StoryTellerAddScenarioInHeader")&&(l.Scenario="Create");l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const w=new Date,H=a.DownloadablePPTInfos[0].DownloadUrl;if(!H)return va.a.J(509159459,817,10,`CopilotProxy:mergeSlides: Error in getting DownloadUrl. Error Code: ${a.DownloadablePPTInfos[0].ErrorCode}.`),
!1;this.Ds.nj(f,2,JSON.stringify({DownloadUrl:H,MergeAction:"ReplaceAll"}),l,!1,0,U=>{va.a.J(509211024,817,50,"CopilotProxy:mergeSlides: Time Taken {0}",+new Date-+w);U.data.ie!==Nk.a.Wv&&(va.a.J(509211023,817,10,"CopilotProxy:mergeSlides: Bad Http Status {0}",U.data.ie),c(`Bad Http Status ${U.data.ie}`));va.a.J(509211022,817,50,"CopilotProxy:mergeSlides: call successful");b(!0)},U=>{var ja,wa;const Sa=new Date;va.a.J(509211021,817,50,"CopilotProxy:mergeSlides: request failed Status {0}, Time Taken {1}",
null===(ja=null===U||void 0===U?void 0:U.data)||void 0===ja?void 0:ja.ie,+Sa-+w);c(null===(wa=null===U||void 0===U?void 0:U.data)||void 0===wa?void 0:wa.ie)},null)})})}}Object(n.a)(uP,"CopilotProxy",null,[222]);class wF{get name(){return"PowerPointWebEditor.Storyteller"}Zb(a){this.K=a;a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(vF,"PowerPointWebEditor.StorytellerView").as("PowerPointWebEditor.IStorytellerView").ma().oa(()=>new vF(new uP(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
u.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")),new uF(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const b=u.AFrameworkApplication.BM||u.AFrameworkApplication.iG;if(a.vWj&&a.GQ&&
(""==a.iOb||"blank"==a.iOb)&&!b||a.RZc)a.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").Wkd(new hy(!0)),this.loadScript()}loadScript(){r("LoadDialogScript",new Date);db.a.get_instance().Uj(7,()=>{ix.a(this.K)("storytellerDialog").then(()=>{this.K.resolve("PowerPointWebEditor.IStorytellerView").m1j()}).catch(a=>{va.a.J(509154954,817,10,`PPTWebEditorStorytellerPackage:loadScript Exception while loading storytellerDialog ${JSON.stringify(a)}`);
this.K.resolve("PowerPointWebEditor.IApplicationSettings").ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").Wkd(new hy(!1))})})}init(){this.lik=this.K.resolve("PowerPointWebEditor.IStorytellerView")}dispose(){this.lik.dispose()}static main(){v.a.instance.Dc(new wF)}}Object(n.a)(wF,"PPTWebEditorStorytellerPackage",null,[2,3]);var mS=d(546),vP=d(680),wP=d(226);class xF{get name(){return"Common.App.OAuth.OAuthPackage"}Zb(a){a.register(217,"Common.App.OAuth.IOAuthManager").ma().oa(()=>
new mS.OAuthManager)}init(){const a=Ab.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.WBl(a)}WBl(a){const b=u.AFrameworkApplication.fa.Ga("FileSource");if(u.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||u.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===b){var c=wP.OAuthManagerSettings.QXd;if(c&&c.IsEnabled){var f=c.Application,l=wP.OAuthManagerSettings.authority;if(void 0!==f&&null!==f&&f.length&&void 0!==l&&null!==l&&l.length){var w=vP.a[a.U6],H=B.a.Wy,U=a.WD();
try{var ja=new Map;void 0!==ja&&null!==ja?(ja.set("SupportStatus",w),ja.set("Browser",H),ja.set("AuthStrategy",U)):ja=null}catch(Sa){ja=null}dg.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",ja);var wa=Kd.a.vj();a.sV("Core",f).then(Sa=>{const eb=Math.floor(Kd.a.vj()-wa);w=vP.a[a.U6];H=B.a.Wy;U=a.WD();ka.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
eb,Sa.IsSuccess,w,Sa.ErrorCode,b,H,U);ja&&(ja.set("SupportStatus",w),ja.set("Browser",H),ja.set("AuthStrategy",U));var ub=Object.assign(new Nj.a,{durationMs:eb,extendedProperties:ja});if(Sa.IsSuccess){if(dg.Health.instance.recordKpiSuccess("WacCorePFT",ub),Sa="Bearer "+Sa.Token,u.AFrameworkApplication.Ke.P6e=Sa,ub=c.Endpoint){var Ub=Kd.a.vj();u.AFrameworkApplication.Ke.krb(ub,1,null,{["Authorization"]:Sa},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(cc=>{var Fc=Math.floor(Kd.a.vj()-
Ub),Ic=null;cc.Vn?cc="Canceled":cc.rm?cc="Faulted":(Ic=cc.result,cc=Ic.succeeded?"Completed":"Failed");Fc={["TaskResult"]:cc,["BrowserTokenDurationMS"]:eb,["BrowserValidationDurationMS"]:Fc};Ic&&(Fc.HttpStatus=Ic.Yi.data.ie,Ic.succeeded&&(Ic=Jc.a(Ic.Yi.data.Wd),Fc.ServerValidationDurationMS=Ic.ElapsedMilliseconds,Fc.ServerValidationResult=Ic.ValidatedToken,Fc.KMSI=Ic.KMSI,Fc.Scopes=Ic.Scopes,Fc.TokenExpirationS=Math.floor(parseInt(Ic.Expiration)-(new Date).getTime()/1E3)));ka.ULS.sendTraceTag(520632322,
3E3,"Completed"===cc?50:15,pa.a.toJSON(Fc))})}}else dg.Health.instance.recordKpiFailure("WacCorePFT",Sa.ErrorCode,!1,!1,ub)}).catch(Sa=>{var eb=Math.floor(Kd.a.vj()-wa);eb=Object.assign(new Nj.a,{durationMs:eb,extendedProperties:ja});dg.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Sa.toString(),!1,!1,eb)})}}}}dispose(){}static main(){v.a.instance.Dc(new xF)}}Object(n.a)(xF,"OAuthPackage",null,[2,3]);var xP=d(12);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");
Type.registerNamespace("B4AuC");Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");
Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.DynamicScriptLoader");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");
Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");
Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");
Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");
Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");window.g_hermesExtJS=
Date.now();Object(xP.c)("Ext");Z.main();ma.main();Re.main();xb.main();lm.main();Km.main();v.a.instance.Dc(new Jj);fj.main();td.main();Oe.main();ol.main();rn.main();In.main();lk.main();Ln.main();Yi.main();ks.main();cq.main();sr.main();iq.main();Type.registerNamespace("Common.App.AccountSwitching");jq.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");
Pp.main();Type.registerNamespace("Common");Cu.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Eu.main();Type.registerNamespace("Common.App.ImageProcessor");Type.registerNamespace("Common.App.NewAndOpen.Core");v.a.instance.Dc(new hw);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");Hu.main();Uu.main();Et.main();Type.registerNamespace("Common.App.People");Hr.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=
oq;Bk.main();Type.registerNamespace("Common");v.a.instance.Dc(new So);Type.registerNamespace("CAUI");Ir.main();Type.registerNamespace("Common.App.SaveStatus");v.a.instance.Dc(new BF);Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1143).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");sF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"}};DA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");
Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");EA.main();MA.main();OA.main();PA.main();QA.main();RA.main();WA.main();XA.main();eB.main();window.PowerPointEditingJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",
attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",
Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",
Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},
{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",
Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",
Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",
Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",
Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",
Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",
Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",
Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",
Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",
QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",
LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};MB.main();Type.registerNamespace("Common.App.Insights");
v.a.instance.Dc(new mH);Type.registerNamespace("Common.App.Activities");QB.main();Type.registerNamespace("Common.App.ActivityAggregator");VB.main();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=$q;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");WB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");XB.main();Type.registerNamespace("Common.App.EventsCacheManager");
YB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");aC.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");dC.main();IC.main();MC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");OC.main();Type.registerNamespace("Common.App.VisibilityManagement");QC.main();Type.registerNamespace("Common.ModernFontPicker");
RC.main();SC.main();XC.main();cD.main();fD.main();oD.main();qD.main();wD.main();Qz.main();QD.main();SD.main();TD.main();gE.main();hE.main();iE.main();jE.main();lE.main();uE.main();vE.main();Type.registerNamespace("Common.App.OAuth");xF.main();nF.main();qF.main();tF.main();wF.main();Object(xP.b)("Ext")},125:function(J,aa,d){d.d(aa,"a",function(){return h});d.d(aa,"b",function(){return e});const h=r=>null===r||"undefined"===typeof r||!r.length,e=r=>null===r||"undefined"===typeof r},1258:function(J,
aa,d){J=d(0);class h{constructor(r,n,v,B){this.oQh=r;this.V_h=n;this.U_h=v;this.W_h=B}get eBi(){return this.oQh}get F4k(){return this.V_h}get C4k(){return this.U_h}get resultType(){return this.W_h}}Object(J.a)(h,"SearchContext",null,[790]);d.d(aa,"a",function(){return e});class e{FHi(r,n,v){var B=v-n;let y;if(100<=B)B=n,y=v;else{B=Math.max(0,n+Math.ceil(B/2)-50);y=Math.min(r.length,B+100);B=Math.max(0,y-100);let A;if(B&&" "!==r.charAt(B-1)){A=Math.min(n,B+10);for(var x=B;x<A;++x)if(" "===r.charAt(x)){B=
x+1;break}}if(y!==r.length&&" "!==r.charAt(y))for(A=Math.max(v,y-10),x=y-1;x>=A;--x)if(" "===r.charAt(x)){y=x;break}}return new h(r.substring(B,y),n-B,v-B,"")}}Object(J.a)(e,"SearchContextFactory",null,[775])},155:function(J,aa,d){d.d(aa,"a",function(){return e});d.d(aa,"b",function(){return r});var h=d(43);const e=(n,v,B)=>{n=h.a.zk(n);n.Va("CommandId",v.toString());try{return B()}finally{n.finish(!0)}},r=(n,v,B,y)=>e(n+v,B,y)},210:function(J,aa,d){d.d(aa,"a",function(){return n});J=d(0);var h=d(27),
e=d(1132),r=d(47);class n{static G2f(){return n.Lci+"_"+e.a.t8b+"_"+r.a.sN(h.AFrameworkApplication.userName)+"_"}static ERc(v){return v+"_"+e.a.t8b+"_"+r.a.sN(h.AFrameworkApplication.userName)+"_"}static d6f(){return n.iLk+"_"+e.a.t8b+"_"+r.a.sN(h.AFrameworkApplication.userName)+"_"}}n.T7="ack0";n.U7="ack1";n.mHc="ack2";n.Lci="ack3";n.$Yb="ack4";n.Ovf="ack7";n.aoe="ack8";n.ewh="ack9";n.ISd="ack10";n.SYe="ack13";n.Qvf="AddinDetailsRefreshed";n.Jci="DdaMethod";n.Ici="ControlId";n.yQd="SecurityOrigin";
n.q6a="ak0";n.vQd="ak1";n.xQd="ak2";n.Brb="ak4";n.Nvf="Office.AutoShowTaskpaneWithDocument";n.uQd="refreshRequired";n.Rvf="value";n.Oci="errorCode";n.o1d="SolutionId";n.m1d="MethodData";n.n1d="DynamicAddinCommandsMethodDispatchId";n.GQi="SourceControlId";n.EQi="OsfControl";n.FQi="RibbonUpdaterData";n.ptd="AddinShared";n.iLk="__OSF_PRIVATECATALOG_ADDINIDS";Object(J.a)(n,"AddinConstantsString",null,[])},236:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.wHc="AfterValidate";h.autoCorrect=
"AutoCorrect";h.Lii="BeforeValidate";h.iKi="CutAction";h.YQi="EditingElementContainerDisconnectingFromView";h.endEditing="EndEditing";h.WZi="FinishingSelectionValidation";h.jDj="ImeTypingEnd";h.lDj="ImeTypingStart";h.EJj="IpMode";h.my="KeyPress";h.Xf="KeyDown";h.$pk="NotFinishingSelectionValidation";h.zCk="OvertypeEnd";h.BCk="OvertypeStart";h.ECk="PaddingChanged";h.O9g="ParagraphContentUpdated";h.LEk="PasteAction";h.gdl="SetMode";h.typingProcess="TypingProcess";h.mvi="ClipboardModeBegin";h.nvi="ClipboardModeEnd";
Object(J.a)(h,"EditEventKeys",null,[])},237:function(J,aa,d){d.d(aa,"a",function(){return r});var h=d(27),e=d(14);const r=n=>h.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk:Object(e.a)(n.resolve("Common.IDynamicScriptLoaderProvider").Vw,n.resolve("Common.IDynamicScriptLoaderProvider").Vw.loadScript,"loadScript")},251:function(J,aa,d){d.r(aa);J=d(0);var h=d(387),e=d(57),r=d(27),n=d(47),v=d(583),B=d(1212),y=d(18);d(1204);var x=d(1010),A=d(29),E=d(76),u=d(123),K=
d(33),G=d(42),O=d(38),R=d(77),V=d(54),D=d(74),Q=d(59),Z=d(88);d(419);var P=d(51),ca=d(421);class T{constructor(ea,ra,F,na,ka){this.vId=ea;this.$2h=F;this.Z2h=ra;this.OSh=na;this.jYh=ka}Y6k(ea,ra){ra.Z6k(ea,this.vId,this.Z2h,this.$2h,this.OSh,this.jYh)}}Object(J.a)(T,"MathPropertyObject",null,[]);var da=d(32),fa=d(108);d.d(aa,"Box4PasteSteward",function(){return ma});class ma extends x.a{constructor(ea,ra,F,na,ka,Ua,za,ha=null,ua=null){super(ea,za,ha,ua);this.qo=this.z2=null;this.hqa=!1;this.t3a=null;
this.yob=-1;this.k4a=0;this.AMd=new y.a;fa.a(4223754,307,Q.OutlineElementReader.$g(ea));this.x3a=ra;this.x3a.wsb(this);this.rF=F;this.rF.wsb(this);this.rDd=na;this.Zo=ka;this.ZWh=Ua;this.HId=R.ListReader.vk(this.Ab);ma.tGj();ma.hGj();ma.YGj()}get e9(){return this.z2||(this.z2=e.a.instance.rb("Box4.IInternalLinkManager"))}get fRa(){return this.qo}get D7a(){return this.HId&&!this.rF.Mca}get S7a(){return 0<this.k4a}get Bv(){return this.rDd}get fq(){return this.Zo}get L2c(){return this.ZWh}get Zji(){return!!r.AFrameworkApplication.fa&&
r.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.qo=this.g7d(!1)}lRd(ea){fa.a(4223762,307,Q.OutlineElementReader.$g(this.Ab)||D.OutlineReader.au(this.Ab));this.BGb(!1);var ra=new da.GraphIterator;ra.Rc(this.Ab);ea=x.a.Qh.Hca(this.Ab,this.YSa(ea));this.YHc(ra,!1);fa.a(4223763,307,ea===this.Ab.currentNode);fa.a(4223764,307,K.ParagraphReader.ae(ea));-1!==this.qo.iE&&ma.paragraphEditor.$J(ea,this.qo.iE);if(ma.paragraphEditor.Bv&&!this.lZ.Dvh){if(this.qo.textIndent){let ka;
({unit:na,returnValue:ka}=ma.Jhd(this.qo.textIndent));var F=!1;if(ka||!R.ListReader.K8a){0>ka&&(F=!0,ka*=-1);var na=ma.HXd(ka,na);F||ma.paragraphEditor.Bv.Vjb(ea,na)}}!this.qo.marginLeft||ma.KL.e0c||R.ListReader.vk(ra)||({unit:ra,returnValue:F}=ma.Jhd(this.qo.marginLeft),ra=ma.HXd(F,ra),ma.paragraphEditor.Bv.rpd(ea,1,ra))}(ma.Sf.hg&&ma.Sf.Yy||O.a.instance.ga(45)&&A.App.OD.LOb)&&ea.setValue(G.a.w$b,!0);this.qo.lineSpacing&&ma.paragraphEditor.C1(ea,this.qo.lineSpacing);this.qo.paragraph=ea;this.hqa=
!0}YHc(ea,ra){fa.a(8128518,307,!ra);this.yM&&!O.a.instance.ga(76)&&(0<this.yM&&this.Bv.qNc(ea,this.yM),0>this.yM&&this.Bv.dib(ea,this.yM,0));O.a.instance.ga(29)&&(this.Ab.Rc(ea),V.OutlineElementNavigator.oi(this.Ab));!this.D7a||2===A.App.mode&&this.L2c.enc?ea&&this.fq.nWe(ea,this.S7a):this.fq.Zrh(ea);this.yM=0}Qtd(ea){this.AMd.add(ea)}NVd(){this.yM=0}Y0(ea,ra=null){fa.a(4223772,307,K.ParagraphReader.el(this.Ab));const F=this.Ab.currentNode;this.qo.J3e(F);if(!this.lZ.W3e(ra)){r.AFrameworkApplication.Wj("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");
var na=F.Ra.last,ka=P.a.VQa(F),Ua=!1;this.hqa&&(na.formatting=this.qo.j9a.ee(na),O.a.instance.ga(57)&&F.gv(),this.hqa=!1,Ua=!0);ea=this.lZ.Ube(ea,ra);this.lZ.Moa(this.Ab.currentNode,this.qo.Hfa,ra);this.characterPropertiesEditor.replaceTextRange(ka,ea);this.Zji&&Ua&&(ea=F.svb(ka.Qa),ea.formatting=this.qo.j9a.ee(ea));O.a.instance.ga(2)}}Kna(ea){this.lZ.R_c&&this.lZ.TZc(ea)?(this.vA(),this.wA(ea)):(fa.a(4223773,307,K.ParagraphReader.el(this.Ab)),ea=P.a.VQa(this.Ab.currentNode),this.characterPropertiesEditor.IXc(ea,
ra=>new ca.a(ra,ca.a.$Mc),E.AParagraphNode.j_))}kZa(){}Jna(ea){this.x3a.Jna(ea)}Ina(ea){this.qo=ea;this.hqa=!0}Ywa(ea){fa.a(4223774,307,K.ParagraphReader.el(this.Ab));fa.a(4223775,307,!this.t3a);fa.a(4223776,307,0>this.yob);this.t3a=ea;this.yob=K.ParagraphReader.textLength(this.Ab.currentNode)}Xwa(){fa.a(4223777,307,K.ParagraphReader.el(this.Ab));fa.a(4223778,307,!!this.t3a);fa.a(4223779,307,0<=this.yob);let ea=P.a.createTextRange(this.Ab.currentNode,this.yob,K.ParagraphReader.textLength(this.Ab.currentNode)),
ra="",F="";this.e9&&({Whh:ra,z1i:F}=this.e9.xEh(u.HyperlinkReader.qEa(this.t3a),!0)).returnValue&&(this.t3a=ra,F&&(this.characterPropertiesEditor.replaceTextRange(ea,F),ea=P.a.createTextRange(this.Ab.currentNode,this.yob,K.ParagraphReader.textLength(this.Ab.currentNode))));ma.hyperlinkEditor.tja(ea,this.t3a,!1);this.hqa=!0;this.t3a=null;this.yob=-1}wA(ea){this.lRd(ea);this.qo.dud(this.Ab.currentNode);ea&&"P"===ea.FU.y8b&&ma.paragraphEditor.cLa(this.Ab.currentNode,this.qo.zhd);this.lZ.Moa(this.Ab.currentNode,
this.qo.Hfa,ea,this.qo.marginLeft,this.qo.textIndent)}vA(){fa.a(4223808,307,K.ParagraphReader.el(this.Ab));ma.hyperlinkEditor.iTi(this.Ab.currentNode);V.OutlineElementNavigator.Re(this.Ab)}eZa(){}dZa(){}cxa(){}sJa(){}Nna(){fa.a(4223809,307,Q.OutlineElementReader.$g(this.Ab)||D.OutlineReader.au(this.Ab));let ea=!1;this.S7a||(ea=this.D7a||!0);ea||(this.yM+=1);this.k4a++}Lna(){this.k4a--;let ea=!1;this.S7a||(ea=this.D7a||!0);ea||--this.yM}bxa(ea){fa.a(4223810,307,Q.OutlineElementReader.$g(this.Ab)||
D.OutlineReader.au(this.Ab));fa.a(4223811,307,0!==ea.listStyleType);this.fq.aMb(this.J0j(ea))}Mna(){fa.a(4223813,307,Q.OutlineElementReader.$g(this.Ab));r.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ma.KL.e0c&&R.ListReader.vk(this.Ab)){const ea=K.ParagraphReader.Vwb(this.Ab.currentNode),ra=this.L2c.m4f(this.Ab);this.fq.wpd(ra,ea,null)}}fZa(ea){this.x3a.fZa(ea)}tY(ea){this.rF.tY(ea)}qY(){this.rF.qY()}sY(ea){this.rF.sY(ea)}rY(){this.rF.rY()}pY(ea){this.rF.pY(ea)}oY(){this.rF.oY()}static get paragraphEditor(){return ma.Yw||
(ma.Yw=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ma.zn||(ma.zn=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Sf(){return ma.fd||(ma.fd=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get NNb(){return ma.Ypf}static get KL(){return ma.CK||(ma.CK=e.a.instance.rb("Box4.List.ListSettings"))}static tGj(){const ea=O.a.instance.ga(61);ma.AJa[1]=ea?Z.StyleReader.rwd:Z.StyleReader.DNb;ma.AJa[2]=ea?Z.StyleReader.swd:Z.StyleReader.ENb;
ma.AJa[3]=ea?Z.StyleReader.twd:Z.StyleReader.FNb;ma.AJa[4]=ea?Z.StyleReader.uwd:Z.StyleReader.GNb;ma.AJa[5]=ea?Z.StyleReader.vwd:Z.StyleReader.HNb;ma.AJa[6]=ea?Z.StyleReader.wwd:Z.StyleReader.INb;ma.AJa[7]=ea?null:Z.StyleReader.zsc}static hGj(){ma.fea.unspecified=0;ma.fea.defaultUnordered=1;ma.fea.defaultOrdered=1;ma.fea.none=0;ma.fea.disc=1;ma.fea.circle=2;ma.fea.square=3;ma.fea.decimal=1;ma.fea.lowerAlpha=2;ma.fea.lowerRoman=3;ma.fea.upperAlpha=4;ma.fea.upperRoman=5}static YGj(){ma.Ypf=Z.StyleReader.Lxb()}static F7a(ea){return n.a.substring(ea,
4,6)+n.a.substring(ea,2,4)+n.a.substring(ea,0,2)}static Jhd(ea){let ra,F;ra=0;const na=ea.length;F=parseFloat(n.a.substring(ea,0,na-2));ea=n.a.substr(ea,na-2,2);switch(ea){case "in":ra=3;break;case "px":ra=7;break;case "cm":ra=1;break;case "pt":ra=5;break;default:h.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ea),F=0}return{returnValue:F,unit:ra}}static HXd(ea,ra){let F=0;switch(ra){case 3:F=v.a.Wta(ea);break;case 7:F=
B.a.Lfa(ea,0);break;case 1:F=v.a.ZUd(ea);break;case 5:F=v.a.Wta(v.a.Hid(ea));break;default:h.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ea,ra)}return F}}ma.Yw=null;ma.zn=null;ma.fd=null;ma.AJa=Array(8);ma.fea={};ma.Ypf=null;ma.CK=null;Object(J.a)(ma,"Box4PasteSteward",x.a,[])},265:function(J,aa,d){d.r(aa);J=d(0);d(387);var h=d(927);d(928);var e=d(27),r=d(97),n=d(57),v=d(37);class B{}Object(J.a)(B,"RibbonUpsellButtonCreator",
null,[]);class y extends Sys.EventArgs{constructor(ca){super();this.FLl=ca}}Object(J.a)(y,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(388);var x=d(364);d(174);var A=d(131);d(313);d(75);var E=d(225),u=d(163),K=d(67);class G{constructor(ca,T){this.cluster=ca;this.BMc=T}}Object(J.a)(G,"ImageInfo",null,[]);class O{constructor(ca,T,da,fa,ma,ea,ra,F,na,ka,Ua,za,ha,ua,Ga=null,sa=null){this.id=ca;this.ZFc=T;this.cGc=da;this.bGc=fa;this.aGc=ma;this.$Fc=ea;this.eGc=ra;this.zOd=F;this.lNb=new G(na,ka);this.Brd=
new G(Ua,za);this.Ydd=new G(ha,ua);Ga&&sa&&new G(Ga,sa)}}Object(J.a)(O,"PeoplesWellBaseSettings",null,[]);class R{constructor(){this.FAf=null}}Object(J.a)(R,"BreadcrumbControls",null,[]);class V{constructor(ca){this.id=ca}}new V("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(J.a)(V,"ChatButtonSettings",null,[]);class D{constructor(){this.id=this.image=this.label=this.command=null}}Object(J.a)(D,"SkypeButtonInfo",null,[]);class Q{constructor(){this.p6e=
this.ZCh=this.mTd=null}}Object(J.a)(Q,"TopRowControls",null,[]);var Z=d(195);d(47);d.d(aa,"CuiHelper",function(){return P});class P{constructor(ca,T,da=null,fa,ma=null){this.Cha=ca;this.tUh=Z.a.rnk(T,ma);this.tUh.push(CommonUIStrings);h.b();P.Ca=void 0===da||null===da?e.AFrameworkApplication.Ta:da}static get lAj(){return P.kqa||(P.kqa=n.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static Agj(ca,T,da){return new O(P.SKe,v.a.Yvi,v.a.tWd,v.a.awi,v.a.$vi,v.a.Zvi,v.a.bwi,v.a.r7a,ca,"per_SingleCollabUserGlyph_16x16x32",
T,"per_SingleCollabUserGlyph_32x32x32",da,"per_MoreUsersGlyph_16x16x32",null,null)}static YOi(ca){ca.mTd&&(P.XOi(ca.mTd),ca.mTd=null);ca.ZCh&&(P.WOi(),ca.ZCh=null);ca.p6e&&(P.ZOi(ca.p6e),ca.p6e=null);P.lAj.ZPk();let T;({i8b:T}=x.a.XOb(!1)).returnValue&&r.a.qCa(T)}static U8b(){e.AFrameworkApplication.Ta.processAction(v.a.U8b,2)}static WOi(){e.AFrameworkApplication.pOc&&u.EventHandlerManager.instance.Qud(e.AFrameworkApplication.pOc)}static addButton(ca,T,da,fa,ma,ea,ra,F){T=A.a(ca,T,da,fa,null,null,
null,ea,null,null,void 0,void 0,ma);(ca=F.hostControl(ca,T,ea))&&ra.appendChild(ca);return ca}static MLc(ca,T,da){let fa;fa=document.createElement("span");fa.className="BreadcrumbItem";fa.id=T;fa.innerText=da;fa.setAttribute("dir","auto");ca.appendChild(fa);return fa}static XOi(ca){ca.FAf&&u.EventHandlerManager.instance.$Cl(ca.FAf)}static ZOi(ca){E.a.instance.HGh(K.a.click,ca,P.uzk,!0)}static uzk(){e.AFrameworkApplication.m6e?(e.AFrameworkApplication.Aa.Yrc(e.AFrameworkApplication.Aa.hb.v7f()),e.AFrameworkApplication.m6e=
!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static V0c(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.V0c}}P.kqa=null;P.Ohl="ShareServerWhite_20x20x32";P.Z2d="ExternalHeaderFullTopBars";P.qAj="HeaderTopBars";P.nTd="BreadcrumbBrand";P.oTd="BreadcrumbFolder";P.pTd="BreadcrumbTitle";P.mYf="FolderSeparator";P.V1e="sbTellMe";P.XZe="TellMe-SearchBox";P.A8g="btnOpenInClient";P.MXe="btnFileSharing";P.apl="BasicChat";P.wmd="btnReplyWithChanges";P.TVf="jbtnGiveFeedback";
P.SKe="PeoplesWellControl";P.tRf="EditableBreadcrumbItem";P.Ca=null;P.J4e=50;P.jAj=null;Object(J.a)(P,"CuiHelper",null,[635])},304:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.alt="Alt";h.iconColor="IconColor";h.yyb="Image16by16Class";h.BCj="Image30by30Class";h.NEa="Image32by32Class";h.Pde="Image48by48Class";h.labelText="LabelText";h.ZZj="LabelTextUserGeneratedPlaceholderReplacements";h.visible="Visible";h.aV="SourceControlId";h.customTooltip="CustomTooltip";h.Icon="Icon";h.IconSet=
"IconSet";h.Ygh="ReduxActions";Object(J.a)(h,"SharedControlCommandProperties",null,[])},305:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.data=this.landingTab=null}}Object(J.a)(h,"LaunchData",null,[])},307:function(J,aa,d){J=d(0);var h=d(57),e=d(388),r=d(597),n=d(129),v=d(387),B=d(97),y=d(658),x=d(402),A=d(47),E=d(200),u=d(55),K=d(1116),G=d(27),O=d(165);class R{constructor(ha,ua){this.cp=ha;this.distance=ua}}Object(J.a)(R,"CpDistanceResult",null,[]);class V{constructor(){this.FEa=
0;this.nt=null;this.yub=this.zub=this.iRa=this.SCa=0;this.rtc=this.XFa=this.yLa=null;this.UAb=this.ada=this.ddd=0;this.R6e=this.h0d=!1;this.g2b=this.LDa=this.wja=this.m3=this.Wmc=0;this.tLh=this.zXf=this.ksc=this.sNb=!1;this.result=null;this.v1b=this.WXd=this.H7a=this.k8=this.Dca=0;this.Xka=this.HLc=!1;this.cP=null}}Object(J.a)(V,"CpFromPointState",null,[]);class D{constructor(ha,ua,Ga,sa,Ba,pa,ia,Da=null,Xa=0,Ka=null){this.HCa=this.cp=this.Qa=0;this.u1b=-1;this.deltaX=this.UJf=Number.MAX_VALUE;this.VYa=
0;this.yVa=-Number.MAX_VALUE;this.wVa=-Number.MAX_VALUE;this.y3d=this.T3b=this.vsb=this.LHe=!1;this.element=ha;this.point=Ga;this.Rbb=sa;this.FQe=Ba;this.EQe=pa;this.kgg=ia;this.Zia=Da;this.U6a=Xa;this.originalText=ua;this.wJa=this.originalText.length;this.Lb=this.wJa-1;this.o$b=4===this.Rbb||3===this.Rbb;this.cP=Ka}}Object(J.a)(D,"CpFromPointElementState",null,[]);var Q=d(44);class Z{constructor(ha,ua,Ga){this.CpBegin=ha;this.CpEnd=ua;this.IsEop=Ga}}Object(J.a)(Z,"CpFromPointResult",null,[]);class P{constructor(ha,
ua,Ga){this.LineBounds=ha;this.ClientRects=ua;this.IsRangeMultipleLines=Ga}}Object(J.a)(P,"LineCoordinateResult",null,[]);class ca{constructor(ha,ua,Ga,sa,Ba,pa){this.hnb={};this.ITb=!0;this.xpg=this.ZBc=this.uEc=this.wqb=this.l5a=null;this.nd=ha;this.zZ=ua;this.VVh=Ga?Ga.ka("TextFidelityLayoutFixesEnabled"):!1;this.aVh=Ga?Ga.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.LUh=Ga?Ga.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.oOa=sa)||v.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");
this.KP=Ba;this.X2h=pa}Ida(){this.ITb=!1}I7a(ha,ua,Ga,sa=null){this.xpg=[];var Ba=ha.A6;if(!ha.textLength)return this.qtj(ha,ua,Ga,sa);sa=Object.assign(new V,{yLa:Array(Ba.length),XFa:Array(Ba.length),rtc:Array(Ba.length),h0d:!0,nt:Ba,cP:sa});for(var pa=0;pa<=Ba.length;pa++){sa.SCa=0;sa.iRa=0;sa.zub=0;sa.yub=0;sa.FEa=0;sa.sNb=!1;sa.ksc=!1;if(pa<Ba.length){if(!this.eZi(ha,sa,pa))continue}else{sa.UAb=pa-1;break}if(this.HZi(ua,sa,pa))break}if(sa.R6e&&sa.Wmc<ua.y&&ua.y<sa.m3)return this.e8k(ha,ua,Ga,
sa);sa.result=null;sa.Dca=-1;sa.k8=sa.LDa;sa.H7a=Number.MAX_VALUE;sa.WXd=0;sa.v1b=0;sa.HLc=!1;sa.Xka=!1;for(Ba=sa.ada;Ba<=sa.UAb;Ba++)if(pa=this.FZi(ha,ua,Ga,Ba,sa))return pa;return this.$rj(ha,ua,Ga,sa)}qtj(ha,ua,Ga,sa){const Ba=ha.isRtl;if(!Ga)return new Z(0,0,!1);ha=this.kQa(ha,sa);return!Ba&&ua.x>ha.x+ha.width/2||Ba&&ua.x<ha.x+ha.width/2?new Z(-1,-1,!0):new Z(0,0,!0)}eZi(ha,ua,Ga){if(this.Xsi(ua.nt[Ga].htmlElement)||ua.nt[Ga].lzb)return!1;var sa=this.kTd(ua.nt[Ga],ua.cP);ua.yLa[Ga]=sa;var Ba=
sa.y;let pa=sa.y+sa.height;ua.nt[Ga].Wig||ua.nt[Ga].Xka||ua.nt[Ga].c4&&!ua.nt[Ga].JUa?({JMf:Ba,IMf:pa}=this.dwf(ua.nt[Ga].htmlElement,Ba,pa),ua.SCa=ua.zub=Ba,ua.iRa=ua.yub=pa,ua.XFa[Ga]=pa-Ba,ua.rtc[Ga]=ua.XFa[Ga]):(this.qll(ha,Ga)?(sa=this.Qt(ha,ua.g2b,void 0,void 0,void 0,ua.cP),Ba=this.S5b(ua.nt[Ga].htmlElement),ha=1<Ba?this.Qt(ha,ua.g2b+Ba-1,void 0,void 0,void 0,ua.cP):sa,ua.SCa=Ba=sa.y,ua.iRa=sa.y+sa.height,ua.zub=ha.y,ua.yub=ha.y+ha.height,ua.XFa[Ga]=sa.height,ua.rtc[Ga]=sa.height):(ha=this.X2h.rnj(ua.nt[Ga].htmlElement),
ua.FEa=this.oOa.zlj(ua.nt[Ga].htmlElement,ha),{JMf:Ba,IMf:pa}=this.dwf(ua.nt[Ga].htmlElement,Ba,pa),ua.tLh=1<Math.abs(sa.width-this.kbj(ua.nt[Ga].htmlElement))||1<Math.abs(sa.height-this.jbj(ua.nt[Ga].htmlElement)),ua.tLh&&this.zZ.instance&&(ha=Math.round(ha*this.zZ.instance.n3),ua.FEa=Math.round(ua.FEa*this.zZ.instance.n3)),ua.SCa=Ba-ua.FEa,ua.iRa=Ba+ha+ua.FEa,ua.zub=pa-ha-ua.FEa,ua.yub=pa+ua.FEa,ua.XFa[Ga]=ha+2*ua.FEa,ua.rtc[Ga]=ha),ua.ddd=Math.max(ua.ddd,ua.XFa[Ga]));ua.zXf||(ua.m3=ua.SCa,ua.wja=
ua.iRa,ua.zXf=!0);ua.ksc=ua.zub>(ua.SCa+ua.iRa)/2;Ga=ca.lta(ua.ddd);this.VVh&&(Ga=this.HQd(ua,Ga));ua.sNb=this.qLj(ua.m3,ua.wja,Ba,Ga);return!0}qLj(ha,ua,Ga,sa){return ha===ua?Ga>ua:Ga>=ua-sa}HQd(ha,ua){return ua=this.oOa.HQd(!!ha.cP&&ha.cP.jAb,ha.SCa,ha.iRa,ua)}HZi(ha,ua,Ga){if(ua.sNb||ua.ksc){ua.sNb?ua.UAb=Ga-1:(ua.m3=Math.min(ua.m3,ua.SCa),ua.wja=Math.max(ua.wja,ua.iRa),ua.UAb=Ga);Array.add(this.xpg,ua.wja);if(ha.y<=ua.wja)return!0;ua.Wmc=ua.wja;ua.m3=ua.zub;ua.wja=ua.yub;ua.ada=Ga;ua.LDa=ua.g2b;
ua.h0d=ua.sNb;ua.R6e=ua.ksc;ua.ddd=ua.nt[Ga].Xka||ua.nt[Ga].c4&&!ua.nt[Ga].JUa?0:ua.XFa[Ga]}else ua.m3=Math.min(ua.m3,ua.SCa),ua.wja=Math.max(ua.wja,ua.yub);ha.y>ua.Wmc&&ha.y<ua.m3&&!ua.nt[ua.ada].Xka&&!ua.nt[ua.ada].c4&&ua.m3-ua.Wmc<ua.rtc[ua.ada]/2&&(ua.m3=ha.y);ua.g2b+=this.ZJi(ua.nt[Ga]);return!1}e8k(ha,ua,Ga,sa){if(sa.nt[sa.ada].c4)return Ga?new Z(sa.LDa,sa.LDa,!1):new Z(sa.LDa,sa.LDa+1,!1);if(Ga=this.TJf(sa.nt[sa.ada].htmlElement,sa.yLa[sa.ada],ua,sa.h0d?4:3,sa.Wmc,sa.m3,sa.XFa[sa.ada],ha.isRtl,
ha.Zia,sa.LDa,sa.cP))return Ga=sa.LDa+Ga.cp,Ga=this.$vf(ha,ua,Ga,sa.ada,sa.LDa,void 0,void 0,sa.cP),new Z(Ga,Ga,!1);this.nd.Xb(y.a.Bpk,{["Reason"]:r.a.IVf});return null}FZi(ha,ua,Ga,sa,Ba){if(Ba.nt[sa].lzb)return null;const pa=Ba.nt[sa].c4,ia=Ba.nt[sa].Xka;let Da=!1;if(pa){if(Ba.yLa[sa].y>=Ba.m3&&(Ba.nt[sa].JUa||Ba.nt[sa].J_c)){var Xa=Ba.yLa[sa];const Ka=Xa.x+Xa.width/2,Ma=Math.abs(ua.x-Ka);if(Ma<Ba.H7a||!Xa.width&&Ma===Ba.H7a)Ba.HLc=!0,Ba.H7a=Ma,Ba.Xka=!1,Ba.Dca=!Ga||!ha.isRtl&&ua.x<Ka||ha.isRtl&&
ua.x>Ka?Ba.k8:Ba.k8+1}if(!Ba.nt[sa].JUa&&!Ba.nt[sa].J_c){Xa=Ba.yLa[sa];if(!Ga&&ua.x>Xa.x&&ua.x<Xa.x+Xa.width&&!Ba.nt[sa].NPj)return new Z(Ba.k8,Ba.k8+1,!1);Ba.result=ua.x<Xa.x+Xa.width/2?new R(ha.isRtl?1:0,Math.max(Xa.x-ua.x,0)):new R(ha.isRtl?0:1,Math.max(ua.x-Xa.x-Xa.width,0))}}else ia?(ha=this.kQa(ha,Ba.cP),Da=1>ha.width,Ba.result=new R(-1,x.a.aOc(ua,ha))):Ba.result=this.TJf(Ba.nt[sa].htmlElement,Ba.yLa[sa],ua,sa===Ba.ada&&Ba.R6e?1:sa===Ba.UAb&&!Ba.sNb&&Ba.ksc?0:2,Ba.m3,Ba.wja,Ba.XFa[sa],ha.isRtl,
ha.Zia,Ba.k8,Ba.cP);Ba.result&&(Ba.result.distance<Ba.H7a||Da&&Ba.result.distance<=Ba.H7a+1)&&(Ba.Dca=Ba.result.cp+Ba.k8,Ba.Xka=ia,Ba.H7a=Ba.result.distance,Ba.WXd=Ba.k8,Ba.v1b=sa,Ba.HLc=pa);Ba.k8=pa?Ba.k8+1:Ba.k8+this.S5b(Ba.nt[sa].htmlElement);return null}$rj(ha,ua,Ga,sa){if(-1===sa.Dca)return this.nd.Xb(y.a.LIj,{["Reason"]:r.a.DVf}),null;const Ba=ha.textLength;if(sa.Xka){if(Ga)return Ga=sa.yLa[sa.yLa.length-1],!ha.isRtl&&ua.x<Ga.x+Ga.width/2||ha.isRtl&&ua.x>Ga.x+Ga.width/2?new Z(Ba,Ba,!1):new Z(-1,
-1,!0);sa.Dca=Ba}sa.Dca>Ba&&(sa.Dca=Ba);!sa.HLc&&sa.Dca<Ba&&(sa.Dca=this.$vf(ha,ua,sa.Dca,sa.v1b,sa.WXd,sa.v1b===sa.ada,sa.v1b===sa.UAb,sa.cP));return new Z(sa.Dca,sa.Dca,!1)}$vf(ha,ua,Ga,sa,Ba,pa=!1,ia=!1,Da=null){const Xa=ha.isRtl,Ka=ha.characterData,Ma=ha.textLength;Ga=A.a.rx(Ka,Ga)?Ga-1:Ga;const Oa=A.a.GPj(Ka,Ga)?Ga+2:Ga+1,qa=this.Qt(ha,Ga,void 0,void 0,void 0,Da);ua=ua.x>qa.x+qa.width/2;if(Ga-Ba===this.S5b(ha.A6[sa].htmlElement)&&ha.A6.length>sa+1&&ha.A6[sa+1].c4)return Ga;if(ha.A6[sa].zMj)return++Ga;
if(ha.A6[sa].yMj)return Ga;let Ya=null,Fb=!1;0<Ga&&(Ya=this.Qt(ha,A.a.rx(Ka,Ga-1)?Ga-2:Ga-1,void 0,void 0,void 0,Da),0<Ga-Ba?Fb=Ya.y+Ya.height/2>qa.y:pa||ha.A6[sa-1].c4||(Fb=!0));pa=null;let hc=!1;if(this.LUh?Oa<=Ma:Oa<Ma)pa=this.Qt(ha,Oa,void 0,void 0,void 0,Da),Oa-Ba<this.S5b(ha.A6[sa].htmlElement)?hc=pa.y+pa.height/2<qa.y+qa.height:ia||ha.A6[sa+1].JUa||ha.A6[sa+1].J_c||(hc=!0);Fb&&hc?Ya.x<=qa.x&&pa.x>=qa.x?ua&&(Ga=Oa):Ya.x>=qa.x&&pa.x<=qa.x?ua||(Ga=Oa):Ya.x<pa.x?ua||(Ga=Oa):pa.x<Ya.x&&ua&&(Ga=
Oa):Fb||(hc?pa.x>=qa.x&&ua?Ga=Oa:pa.x<=qa.x&&!ua&&(Ga=Oa):!A.a.iz(Ka.charCodeAt(Ga))&&(!Xa&&ua||Xa&&!ua)&&(Ga=Oa));return Ga}hbj(ha){return B.a.zv(ha)}jbj(ha){return ha.offsetHeight}kbj(ha){return ha.offsetWidth}Xsi(ha){return!ha.parentNode}S5b(ha){return B.a.I9a(ha)}qll(ha,ua){ua=ha.A6[ua];if(ua.c4)return!1;ha=ha.htmlElement;Sys.UI.DomElement.containsCssClass(ha,"Paragraph")||(ha=ha.firstChild);return""!==ha.style.lineHeight&&ha.style.lineHeight!==ua.htmlElement.style.lineHeight}ZJi(ha){return ha.c4?
1:B.a.I9a(ha.htmlElement)}dwf(ha,ua,Ga){Ga=new Sys.UI.Bounds(0,ua,0,Ga-ua);this.bdi(ha,[Ga]);ua=Ga.y;Ga=Ga.y+Ga.height;return{JMf:ua,IMf:Ga}}bdi(ha,ua){if(ha=E.a.Xt(ha)){var Ga=ha.borderTopWidth,sa=Ga.indexOf("px");if(-1<sa)for(Ga=parseInt(Ga.substr(0,sa)),sa=0;sa<ua.length;sa++)ua[sa].y+=Ga,ua[sa].height-=Ga;ha=ha.borderBottomWidth;Ga=ha.indexOf("px");if(-1<Ga)for(ha=parseInt(ha.substr(0,Ga)),Ga=0;Ga<ua.length;Ga++)ua[Ga].height-=ha}}TJf(ha,ua,Ga,sa,Ba,pa,ia,Da,Xa,Ka,Ma=null){if(this.vOj(ha))return this.nd.Xb(y.a.a_i,
{["Reason"]:r.a.HVf}),new R(0,x.a.aOc(Ga,ua));if(this.uOj(ha))return this.nd.Xb(y.a.CQc,{["Reason"]:r.a.CQc}),null;ha=this.TDi(ha,Ga,sa,Ba,pa,ia,Xa,Ka,Ma);if(1>=ha.wJa)return new R(0,x.a.aOc(ha.point,ua));this.B4k(ha);do{if(ha.Qa>ha.Lb)return this.PKb(),this.nd.Xb(y.a.Apk,{["Reason"]:r.a.K0g}),null;this.xok(ha)}while(!ha.LHe);for(ha.HCa=!Da&&ha.VYa<ha.point.x||Da&&ha.VYa>ha.point.x?ha.Lb:ha.Qa;!ha.vsb&&!this.fji(ha););if(ha.y3d)for(ha.cp=ha.Qa;ha.cp<=ha.Lb&&!this.B0j(ha);ha.cp++);return this.Sti(ha)}TDi(ha,
ua,Ga,sa,Ba,pa,ia,Da,Xa=null){return new D(ha,this.hbj(ha),ua,Ga,sa,Ba,pa,ia,Da,Xa)}vOj(ha){return!ha.firstChild}uOj(ha){return 3!==ha.firstChild.nodeType}B4k(ha){let ua;if(0===ha.Rbb){ha.yVa=ha.FQe;ha.wVa=ha.EQe;for(var Ga=40;Ga<ha.wJa;Ga+=40)if(ua=this.jQa(ha.element,ha.originalText,Ga,ha.Zia,ha.U6a,void 0,void 0,ha.cP),ua.height&&ua.y+ua.height/2>ha.wVa){ha.Lb=Ga;break}}else if(1===ha.Rbb)for(ha.Lb=ha.wJa-1,ha.yVa=ha.FQe,ha.wVa=ha.EQe,Ga=ha.wJa-40;0<=Ga;Ga-=40){if(ua=this.jQa(ha.element,ha.originalText,
Ga,ha.Zia,ha.U6a,void 0,void 0,ha.cP),ua.height&&ua.y+ua.height/2<ha.yVa){ha.Qa=Ga;break}}else if(2===ha.Rbb)ha.Lb=ha.wJa-1,ha.yVa=ha.FQe,ha.wVa=ha.EQe;else if(3===ha.Rbb||4===ha.Rbb)for(Ga=0;Ga<ha.wJa+40;Ga+=40){const sa=Ga<ha.wJa?Ga:ha.wJa-1;ua=this.jQa(ha.element,ha.originalText,sa,ha.Zia,ha.U6a,void 0,void 0,ha.cP);if(ua.height&&(ua.y+ua.height<ha.point.y&&(ha.Qa=sa),ua.y>ha.point.y)){ha.Lb=sa;break}}}xok(ha){const ua=Math.floor((ha.Qa+ha.Lb)/2);ha.cp=ua;let Ga=this.jQa(ha.element,ha.originalText,
ha.cp,ha.Zia,ha.U6a,void 0,void 0,ha.cP);for(;ha.cp<ha.Lb&&!Ga.height;)ha.cp++,Ga=this.jQa(ha.element,ha.originalText,ha.cp,ha.Zia,ha.U6a,void 0,void 0,ha.cP);ha.cp!==ha.Lb||Ga.height?!ha.o$b&&Ga.y+Ga.height/2<ha.yVa||ha.o$b&&Ga.y+ha.kgg<ha.point.y?ha.Qa=ha.cp+1:!ha.o$b&&Ga.y+Ga.height/2>ha.wVa||ha.o$b&&Ga.y>ha.point.y?ha.Lb=ha.cp-1:Ga.x<=ha.point.x&&Ga.x+Ga.width>=ha.point.x?(ha.vsb=!0,ha.T3b=!0,ha.LHe=!0):(ha.LHe=!0,ha.VYa=Ga.x+Ga.width/2,ha.u1b=ha.cp,ha.deltaX=Math.abs(ha.VYa-ha.point.x),ha.o$b&&
(ha.yVa=Ga.y,ha.wVa=Ga.y+ha.kgg)):ha.Lb=ua-1}fji(ha){var ua=Math.abs(ha.HCa-ha.cp);if(ua<ha.UJf)ha.UJf=ua;else return ha.vsb=!0,ha.y3d=!0;ua=Math.floor((ha.cp+ha.HCa)/2);ua===ha.cp&&(ua=ha.HCa);var Ga=this.jQa(ha.element,ha.originalText,ua,ha.Zia,ha.U6a,void 0,void 0,ha.cP);if(0<Ga.height&&Ga.y+Ga.height/2<=ha.yVa||Ga.y+Ga.height/2>=ha.wVa)ha.HCa=ha.cp<ha.HCa?ua-1:ua+1;else if(Ga.x<=ha.point.x&&Ga.x+Ga.width>=ha.point.x)ha.cp=ua,ha.T3b=!0,ha.vsb=!0;else{Ga=Ga.x+Ga.width/2;const sa=Math.abs(ha.VYa-
Ga),Ba=Math.abs(ha.VYa-ha.point.x),pa=Math.abs(Ga-ha.point.x);pa<ha.deltaX&&(ha.u1b=ua,ha.deltaX=pa);sa+pa===Ba?(ha.cp=ua,ha.VYa=Ga):Ba+pa===sa?(ha.HCa=ha.cp<ha.HCa?ha.cp+1:ha.cp-1,ha.cp=ua,ha.VYa=Ga):sa+Ba===pa&&(ha.vsb=!0,ha.y3d=!0)}ha.HCa===ha.cp&&(ha.vsb=!0);return!1}B0j(ha){var ua=this.jQa(ha.element,ha.originalText,ha.cp,ha.Zia,ha.U6a,void 0,void 0,ha.cP);if(0<ua.height&&ua.y+ua.height/2<=ha.yVa||ua.y+ua.height/2>=ha.wVa)return!1;if(ua.x<=ha.point.x&&ua.x+ua.width>=ha.point.x)return ha.T3b=
!0;ua=Math.abs(ua.x+ua.width/2-ha.point.x);ua<ha.deltaX&&(ha.u1b=ha.cp,ha.deltaX=ua);return!1}Sti(ha){if(!ha.T3b&&-1===ha.u1b)return this.PKb(),this.nd.Xb(y.a.Cpk,{["Reason"]:r.a.EVf}),null;ha.T3b?ha.deltaX=0:ha.cp=ha.u1b;A.a.rx(ha.originalText,ha.cp)&&ha.cp--;this.PKb();return new R(ha.cp,ha.deltaX)}Qt(ha,ua,Ga=!1,sa=!1,Ba=!1,pa=null){let ia;ha||v.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Da=({i:qa,nt:ia,k8:Ba,epk:ua}=this.P7f(ha,ua,Ba)).returnValue,Xa="";Xa=ha.Zia;ha=B.a.zv(Da.htmlElement);
let Ka=ha.length,Ma,Oa=!1;if(!Ka)if(Ma=Sys.UI.DomElement.getBounds(Da.htmlElement),Oa=!0,!Ma.height&&qa<ia.length-1)qa++,Da=ia[qa],ha=O.b(Da.htmlElement),Ka=ha.length;else if(!Da.htmlElement.firstChild||Da.Wig)return this.KP.Iga(Ma,pa,()=>Da.htmlElement.offsetWidth/Da.htmlElement.offsetHeight);var qa=!1;!Oa&&ua>=Ka&&(ua=Ka-1,qa=!0);if(Ma=Da.c4||!Da.htmlElement.firstChild||Da.eig?this.kTd(Da,pa):this.jQa(Da.htmlElement,ha,ua,Xa,Ba,Ga,sa,pa))Oa?Ma.width=1:qa&&(Ma.x+=Ma.width,Ma.width=1);this.PKb();
return Ma}vEa(ha,ua,Ga=!1,sa=!0){return this.P7f(ha,ua,Ga,sa).returnValue}fac(ha,ua){return ua.y>ha.y+ha.height-ca.lta(ha.height)}P7f(ha,ua,Ga=!1,sa=!0){let Ba,pa,ia=ha;Ba=ha.A6;for(ha=pa=0;ha<Ba.length;ha++){if(Ba[ha].lzb)continue;let Da;if(Ba[ha].c4){if(!ua){Ga||this.NQj(Ba,ha)?ia=Ba[ha]:(ia=Ba[ha-1],ua=Da=B.a.I9a(ia.htmlElement),pa-=Da);break}ua--;pa++;continue}Da=B.a.I9a(Ba[ha].htmlElement);let Xa=!1;if(this.aVh){const Ka=Ba[ha].htmlElement,Ma=Ka.nextSibling;Ma&&(Xa=Sys.UI.DomElement.containsCssClass(Ka,
"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(Ma,"Hyperlink"))}if(ua<Da||!ua&&sa&&!Xa||ha>=Ba.length-1){ia=Ba[ha];break}else ua-=Da,pa+=Da}return{returnValue:ia,i:ha,nt:Ba,k8:pa,epk:ua}}NQj(ha,ua){if(!ua)return!0;const Ga=this.Asb(ha[ua-1].htmlElement);ha=this.Asb(ha[ua].htmlElement);return this.fac(Ga,ha)}jQa(ha,ua,Ga,sa,Ba,pa=!1,ia=!1,Da=null){let Xa=Ga+1;Ga||ua.length?A.a.rx(ua,Ga)?Ga--:A.a.rx(ua,Xa)&&Xa++:Xa=0;if(""!==sa)if(sa=Ba+Ga+"-"+sa,this.ITb){if(Ba=this.hnb[sa],void 0!==Ba&&null!==
Ba)return sa=this.KP.Iga(Ba,Da,()=>this.KP.r0f(ha,Ga)),sa=this.oOa.IQd(Da,ha,sa)}else this.hnb={},this.ITb=!0;Ba=this.Yuc(ha,Ga,Xa);pa=pa&&(u.a.Gj||u.a.vo);if(!Ba&&!ia||pa)ua=this.Jmk(ha,ua,Ga,Xa),Ba||(Ba=ua),pa&&Ba&&(Ba.y=ua.y,Ba.height=ua.height);""!==sa&&Ba&&(this.hnb[sa]=new Sys.UI.Bounds(Ba.x,Ba.y,Ba.width,Ba.height));sa=this.KP.Iga(Ba,Da,()=>this.KP.r0f(ha,Ga));return sa=this.oOa.IQd(Da,ha,sa)}Yuc(ha,ua,Ga){let sa=null;if(this.S5b(ha)<Ga)return null;u.a.hV&&(sa=this.Imk(ha,ua,Ga));!sa&&u.a.Gj&&
(sa=this.Kmk(ha,ua,Ga));return sa}xAf(ha,ua=null){return this.Asb(ha.htmlElement.firstChild,ua)}kTd(ha,ua=null){return ha.JUa?this.xAf(ha,ua):this.Asb(ha.htmlElement,ua)}Asb(ha,ua=null){var Ga=Sys.UI.DomElement.getBounds(ha);Ga=this.KP.Iga(Ga,ua,()=>ha.offsetWidth/ha.offsetHeight);return Ga=this.oOa.IQd(ua,ha,Ga)}oW(ha,ua,Ga,sa,Ba,pa){return ha!==ua.characterData.length||Ga?this.Yji(ha,ua,Ga,sa,Ba,pa):this.Xji(ua)}Xji(ha){const ua=this.kQa(ha);return this.t2f(ua,!ha.isRtl)}Yji(ha,ua,Ga,sa,Ba,pa){var ia=
ua.textLength;if(u.a.DT&&Ga&&0<ha&&ha<ia){var Da=this.vEa(ua,ha-1,!0),Xa=this.vEa(ua,ha,!0);Da===Xa&&(Ga=!1)}var Ka=Ga?ha-1:ha;A.a.rx(ua.characterData,Ka)&&--Ka;var Ma=!0;Xa=this.vEa(ua,Ka,!0,!1);if(Xa.c4)if(Xa.JUa){if(Ga)return this.oW(ha,ua,!1,sa,!1,pa);Da=this.xAf(Xa)}else if(Xa.J_c){if(Ga)return this.oW(ha,ua,!1,sa,!1,pa);if(ha)return this.oW(ha,ua,!0,sa,!1,pa);Da=this.kTd(Xa)}else Da=this.Asb(Xa.htmlElement),Xa.dQj&&(Ma=!1);else{Xa=Ka;do{Da=this.Qt(ua,Xa,Ba,pa);if(!Da)return null;Xa+=1}while(!Da.height&&
Xa<=ia)}Xa=ia=ua.isRtl;if(Ma){Ma=this.qHc(ua,Ka,-1,Ba,pa);Ba=this.qHc(ua,Ka,1,Ba,pa);pa=new Sys.UI.Point(Da.x+Da.width/2,Da.y+Da.height/2);Ka=Da.y;var Oa=Da.y+Da.height;Ka=!Ma||Ma.y+Ma.height<=Ka;Oa=!Ba||Ba.y>=Oa;let qa=!1;Ka||Oa?Ka||A.a.iz(ua.characterData.charCodeAt(ha))?Oa||(Ba.x>=pa.x?Xa=!1:Ba.x<=pa.x&&(Xa=!0),qa=Xa!==ia):(Ma.x<=pa.x?Xa=!1:Ma.x>=pa.x&&(Xa=!0),qa=Xa!==ia):Ma.x<=pa.x&&pa.x<=Ba.x?Xa=!1:Ba.x<=pa.x&&pa.x<=Ma.x?Xa=!0:Ma.x<Ba.x?(Xa=!0,qa=Ga?pa.x<Ma.x:Ma.x<pa.x):Ba.x<Ma.x&&(Xa=!1,qa=
Ga?Ma.x<pa.x:pa.x<Ma.x);if(qa&&u.a.RF){if(Ga&&!sa)return this.oW(ha,ua,!1,!1);ha||(Da=this.z9i(ua,ia))}}return this.t2f(Da,Xa===Ga)}qHc(ha,ua,Ga,sa,Ba){if(0>Ga&&0>=ua||0<Ga&&ua>=ha.characterData.length-1)return null;const pa=ua+Ga;return A.a.rx(ha.characterData,pa)?this.qHc(ha,pa,Ga,sa,Ba):this.vEa(ha,ua,!0,!1).JUa?null:(ua=this.Qt(ha,pa,sa,Ba))?ua.height&&ua.width?ua:this.qHc(ha,pa,Ga,sa,Ba):null}z9i(ha,ua){let Ga=null;for(var sa=0;sa<ha.A6.length;sa++){const Ba=ha.A6[sa];if(!Ba.lzb){Ga=Ba.htmlElement;
break}}for(sa=Ga.childNodes[0];sa&&1===sa.nodeType;)Ga=sa,sa=Ga.childNodes[0];sa=B.a.zv(Ga);B.a.Nx(Ga,(ua?"\u202e":"\u202d")+sa);this.Ida();ha=this.Qt(ha,0);B.a.Nx(Ga,sa);this.Ida();return ha}t2f(ha,ua){return new Sys.UI.Bounds(ua?ha.x:ha.x+ha.width,ha.y,0,ha.height)}kQa(ha,ua=null){return this.Asb(ha.FTf.htmlElement,ua)}Imk(ha,ua,Ga){this.PKb();try{const sa=ha.firstChild,Ba=sa.ownerDocument.createRange();Ba.setStart(sa,ua);Ba.setEnd(sa,Ga);const pa=this.vfj(Ba,(ia,Da)=>(0<ia||ua===Ga)&&0<Da);if(!pa||
!pa.length)return null;this.Zvf(sa,pa[0]);Ba.detach();return pa[0]}catch(sa){return null}}vfj(ha,ua){this.PKb();try{let Ga;Ga=ha.getClientRects();ha=[];for(let sa=0;sa<Ga.length;sa++){const Ba=Ga[sa];if(Ba){const pa=Math.floor(Ba.width/1),ia=Math.floor(Ba.height/1);if(ua(pa,ia)){const Da=new Sys.UI.Bounds(Math.floor(Ba.left/1),Math.floor(Ba.top/1),pa,ia);Array.add(ha,Da)}}}return ha}catch(Ga){return null}}Kmk(ha,ua,Ga){if(!u.a.TNb)return null;let sa=null;try{sa=ha.ownerDocument.body.createTextRange(),
sa.moveToElementText(ha)}catch(Ba){return null}if(sa.collapse&&sa.move&&sa.moveEnd)sa.collapse(),sa.move("character",ua),sa.moveEnd("character",Ga-ua);else return null;ua=new Sys.UI.Bounds(sa.boundingLeft,sa.boundingTop,sa.boundingWidth,sa.boundingHeight);if(!(ua.x||ua.y||ua.width||ua.height))return null;this.Zvf(ha,ua);ha=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==ha&&(ua.x=Math.round(ua.x/ha),ua.y=Math.round(ua.y/ha),ua.width=Math.round(ua.width/ha),ua.height=Math.round(ua.height/ha));
return ua}Jmk(ha,ua,Ga,sa){this.l5a&&this.l5a.ownerDocument===ha.ownerDocument||(this.l5a=ha.ownerDocument.createElement("SPAN"),this.wqb=ha.ownerDocument.createElement("SPAN"),this.uEc=ha.ownerDocument.createElement("SPAN"));ha.firstChild!==this.l5a&&(this.ZBc=new K.a(ha),B.a.Cu(ha),this.oOa&&this.oOa.uui(this.l5a,this.wqb,this.uEc),ha.appendChild(this.l5a),ha.appendChild(this.wqb),ha.appendChild(this.uEc));B.a.Nx(this.l5a,A.a.substring(ua,0,Ga));B.a.Nx(this.wqb,A.a.substring(ua,Ga,sa));B.a.Nx(this.uEc,
A.a.substring(ua,sa,ua.length));G.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&u.a.Vj&&u.a.TLj&&" "===A.a.substring(ua,Ga,sa)&&Sys.UI.DomElement.addCssClass(this.wqb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.wqb)}Zvf(ha,ua){this.Xci(ha,[ua])}Xci(ha,ua){try{if(void 0!==ha.ownerDocument.parentWindow){var Ga=ha.ownerDocument.parentWindow.frameElement;if(Ga&&("0"===Ga.frameBorder||"no"===Ga.frameBorder))for(ha=0;ha<ua.length;ha++)ua[ha].x+=2,ua[ha].y+=2}}catch(sa){}}PKb(){this.ZBc&&
this.ZBc.restore();this.ZBc=null}Bsb(ha,ua){if(""!==ua){let Ga;if(this.ITb){if(Ga=this.hnb["VE-"+ua])return ha=new Sys.UI.Bounds(Ga.x,Ga.y,Ga.width,Ga.height)}else this.hnb={},this.ITb=!0;Ga=Sys.UI.DomElement.getBounds(ha);this.hnb["VE-"+ua]=Ga;return ha=new Sys.UI.Bounds(Ga.x,Ga.y,Ga.width,Ga.height)}return Sys.UI.DomElement.getBounds(ha)}static get instance(){return ca.Ka||(ca.Ka=new ca(e.a.instance,h.a.instance.Ja("Common.IZoomManager"),G.AFrameworkApplication.fa,h.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),
h.a.instance.resolve("Box4.IRotatingCoordinateConverter"),h.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static lta(ha){return Q.SelectionEditor.lta(ha)}}ca.Ka=null;Object(J.a)(ca,"TextMetrics",null,[]);var T=d(98);class da{get JUa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.obc)}get c4(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.rN)}get J_c(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.GCk)}get dQj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
T.a.rHj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.qHj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.oHj)}get Wig(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.E1d)}get eig(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.SIf)}}Object(J.a)(da,"ATextMetricsElement",null,[438]);var fa=d(33),ma=d(151);class ea extends da{constructor(ha){super();this.zP=ha}get htmlElement(){return this.zP}get Xka(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
T.a.FN)}get lzb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ma.a.kW)}get NPj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.GJj)}get zMj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.wji)||Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.tHj)}get yMj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.vji)||Sys.UI.DomElement.containsCssClass(this.htmlElement,T.a.sHj)}}Object(J.a)(ea,"TextMetricsLeafElement",da,[459,438]);var ra=
d(54),F=d(59);class na extends da{constructor(ha){super();this.Bpb=ha;this.Ki=this.Bpb.gb;this.AXb=Array(ha.ot.length);for(ha=0;ha<this.Bpb.ot.length;ha++){const ua=new ea(this.Bpb.ot[ha]);this.AXb[ha]=ua}}get A6(){return this.AXb}get paragraphId(){return this.Ki.id.toString()}get htmlElement(){return this.Bpb.htmlElement}get Zia(){return this.Bpb.Qc.Nh?this.Bpb.gb.id.toString():""}get textLength(){return fa.ParagraphReader.textLength(this.Ki)}get isRtl(){return F.OutlineElementReader.um(ra.OutlineElementNavigator.WA(this.Ki))}get ps(){return fa.ParagraphReader.ae(this.Ki)&&
!this.Ki.YW}get characterData(){return this.Ki.characterData}get FTf(){return this.AXb.length?this.AXb[this.AXb.length-1]:null}static M7a(ha){return new na(ha)}}Object(J.a)(na,"TextMetricsParagraphElement",da,[437,438]);var ka=d(51),Ua=d(34);d.d(aa,"a",function(){return za});class za{static get t1b(){return za.HA||(za.HA=h.a.instance.rb("Box4.CharacterPointConverter"))}static get Wc(){return e.a.instance}static Qt(ha,ua,Ga=!1,sa=!1,Ba=!1,pa=null){ha=na.M7a(ha);return ca.instance.Qt(ha,ua,Ga,sa,Ba,
pa)}static Yuc(ha,ua,Ga){return ca.instance.Yuc(ha,ua,Ga)}static Bsb(ha,ua){return ca.instance.Bsb(ha,ua)}static oW(ha,ua,Ga,sa,Ba=!1,pa=!1){ua=na.M7a(ua);return ca.instance.oW(ha,ua,Ga,sa,Ba,pa)}static kQa(ha,ua=null){ha=na.M7a(ha);return ca.instance.kQa(ha,ua)}static Ida(){ca.instance.Ida()}static I7a(ha,ua,Ga,sa=null){let Ba=null,pa=null;try{const ia=na.M7a(ha);let Da=null;Ba=za.Wc.Wp(Ua.a.$5i);(Da=ca.instance.I7a(ia,ua,Ga,sa))&&(pa=za.t1b?za.t1b.jOl(Da,ha.gb):ka.a.TQa(Da.CpBegin,Da.CpEnd,Da.IsEop,
ha.gb))}catch(ia){za.Wc.Xb(n.a.HMl,{["Reason"]:r.a.EUi,["ExceptionMessage"]:ia.message,["ExceptionCallstack"]:ia.stack}),pa=null}Ba&&Ba.end();return pa}static vEa(ha,ua,Ga=!1,sa=!0){ha=na.M7a(ha);return ca.instance.vEa(ha,ua,Ga,sa).htmlElement}static fac(ha,ua){return ca.instance.fac(ha,ua)}}za.HA=null;Object(J.a)(za,"TextMetricsAdapter",null,[])},312:function(J,aa,d){J=d(0);var h=d(387),e=d(27),r=d(1231);const n=(B,y)=>{const x={};let A=null;switch(B){case 0:A="HtmlProcessor";var E=y.a;null!=E&&
(x.SessionID=E);var u=y.b.toString();null!=u&&(x.Elements=u);var K=y.c.toString();null!=K&&(x.PrunedElements=K);var G=y.d.toString();null!=G&&(x.TransparentElements=G);var O=y.e.toString();null!=O&&(x.VoidElements=O);var R=y.f.toString();null!=R&&(x.UnknownElements=R);break;case 1:A="WordConverter";var V=y.a;null!=V&&(x.SessionID=V);var D=y.b.toString();null!=D&&(x.BulletsConverted=D);var Q=y.c.toString();null!=Q&&(x.NumberedConverted=Q);break;case 2:A="FormattingSteward";var Z=y.a;null!=Z&&(x.SourceApp=
Z);var P=y.b;null!=P&&(x.Browser=P);var ca=y.c;null!=ca&&(x.OperationId=ca);var T=y.d.toString();null!=T&&(x.Lang=T);var da=y.e.toString();null!=da&&(x.TextDir=da);var fa=y.f.toString();null!=fa&&(x.Bold=fa);var ma=y.g.toString();null!=ma&&(x.Math=ma);var ea=y.h.toString();null!=ea&&(x.Italics=ea);var ra=y.i.toString();null!=ra&&(x.Underline=ra);var F=y.j.toString();null!=F&&(x.Strikethrough=F);var na=y.k.toString();null!=na&&(x.Subscript=na);var ka=y.l.toString();null!=ka&&(x.Superscript=ka);var Ua=
y.m.toString();null!=Ua&&(x.Fontsize=Ua);var za=y.n.toString();null!=za&&(x.Fontface=za);var ha=y.o.toString();null!=ha&&(x.GrowFontsize=ha);var ua=y.p.toString();null!=ua&&(x.ShrinkFontsize=ua);var Ga=y.q.toString();null!=Ga&&(x.FontColor=Ga);var sa=y.r.toString();null!=sa&&(x.FontHighlight=sa);var Ba=y.s.toString();null!=Ba&&(x.ParagraphStyle=Ba);var pa=y.t.toString();null!=pa&&(x.TextAlign=pa);var ia=y.u.toString();null!=ia&&(x.TextIndent=ia);var Da=y.v.toString();null!=Da&&(x.MarginLeft=Da);var Xa=
y.w.toString();null!=Xa&&(x.ParagraphSpaceBefore=Xa);var Ka=y.x.toString();null!=Ka&&(x.ParagraphSpaceAfter=Ka);var Ma=y.y.toString();null!=Ma&&(x.LineSpace=Ma);var Oa=y.z.toString();null!=Oa&&(x.CellShadingColor=Oa);break;case 3:A="SemanticEvents";var qa=y.a;null!=qa&&(x.SessionID=qa);var Ya=y.b.toString();null!=Ya&&(x.Text=Ya);var Fb=y.c.toString();null!=Fb&&(x.LineBreak=Fb);var hc=y.d.toString();null!=hc&&(x.Image=hc);var ec=y.e.toString();null!=ec&&(x.File=ec);var Tb=y.f.toString();null!=Tb&&
(x.FormattingChange=Tb);var vb=y.g.toString();null!=vb&&(x.Anchor=vb);var zb=y.h.toString();null!=zb&&(x.Paragraph=zb);var Xb=y.i.toString();null!=Xb&&(x.Math=Xb);var Za=y.j.toString();null!=Za&&(x.List=Za);var Va=y.k.toString();null!=Va&&(x.ListItem=Va);var tc=y.l.toString();null!=tc&&(x.RenderAugmentation=tc);var Kb=y.m.toString();null!=Kb&&(x.Span=Kb);break;case 4:A="SemanticTableEvents";var Pa=y.a;null!=Pa&&(x.SessionID=Pa);var mb=y.b.toString();null!=mb&&(x.Tables=mb);var qc=y.c.toString();null!=
qc&&(x.TableRow=qc);var oc=y.d.toString();null!=oc&&(x.TableCell=oc);var ib=y.e.toString();null!=ib&&(x.TablePart=ib);break;case 5:A="HtmlEvents";var $a=y.a;null!=$a&&(x.OperationId=$a);var Db=y.b;null!=Db&&(x.SourceApp=Db);var Mb=y.c;null!=Mb&&(x.Browser=Mb);var ob=null==y.d?null:y.d.toString();null!=ob&&(x.Text=ob);var jc=null==y.e?null:y.e.toString();null!=jc&&(x.A=jc);var Gb=null==y.f?null:y.f.toString();null!=Gb&&(x.Abbr=Gb);var Gc=null==y.g?null:y.g.toString();null!=Gc&&(x.Acronym=Gc);var bc=
null==y.h?null:y.h.toString();null!=bc&&(x.Address=bc);var dc=null==y.i?null:y.i.toString();null!=dc&&(x.Applet=dc);var Nb=null==y.j?null:y.j.toString();null!=Nb&&(x.Area=Nb);var Ac=null==y.k?null:y.k.toString();null!=Ac&&(x.B=Ac);var jb=null==y.l?null:y.l.toString();null!=jb&&(x.Base=jb);var Vb=null==y.m?null:y.m.toString();null!=Vb&&(x.Basefont=Vb);var Tc=null==y.n?null:y.n.toString();null!=Tc&&(x.Bdo=Tc);var wb=null==y.o?null:y.o.toString();null!=wb&&(x.Big=wb);var Rb=null==y.p?null:y.p.toString();
null!=Rb&&(x.Blockquote=Rb);var vc=null==y.q?null:y.q.toString();null!=vc&&(x.Body=vc);var rd=null==y.r?null:y.r.toString();null!=rd&&(x.Br=rd);var rc=null==y.s?null:y.s.toString();null!=rc&&(x.Button=rc);var cb=null==y.t?null:y.t.toString();null!=cb&&(x.Caption=cb);var Wb=null==y.u?null:y.u.toString();null!=Wb&&(x.Center=Wb);var Uc=null==y.v?null:y.v.toString();null!=Uc&&(x.Cite=Uc);var Ib=null==y.w?null:y.w.toString();null!=Ib&&(x.Code=Ib);var Vc=null==y.x?null:y.x.toString();null!=Vc&&(x.Col=Vc);
var gc=null==y.y?null:y.y.toString();null!=gc&&(x.Colgroup=gc);var rb=null==y.z?null:y.z.toString();null!=rb&&(x.Dd=rb);var Zb=null==y.ba?null:y.ba.toString();null!=Zb&&(x.Del=Zb);var Hc=null==y.bb?null:y.bb.toString();null!=Hc&&(x.Dfn=Hc);var Ab=null==y.bc?null:y.bc.toString();null!=Ab&&(x.Dir=Ab);var ad=null==y.bd?null:y.bd.toString();null!=ad&&(x.Div=ad);var Bd=null==y.be?null:y.be.toString();null!=Bd&&(x.Dl=Bd);var kd=null==y.bf?null:y.bf.toString();null!=kd&&(x.Dt=kd);var Be=null==y.bg?null:
y.bg.toString();null!=Be&&(x.Em=Be);var Qd=null==y.bh?null:y.bh.toString();null!=Qd&&(x.Fieldset=Qd);var ae=null==y.bi?null:y.bi.toString();null!=ae&&(x.Font=ae);var We=null==y.bj?null:y.bj.toString();null!=We&&(x.Form=We);var $d=null==y.bk?null:y.bk.toString();null!=$d&&(x.Frame=$d);var Re=null==y.bl?null:y.bl.toString();null!=Re&&(x.Frameset=Re);var Ta=null==y.bm?null:y.bm.toString();null!=Ta&&(x.H=Ta);var xb=null==y.bn?null:y.bn.toString();null!=xb&&(x.Head=xb);var kc=null==y.bo?null:y.bo.toString();
null!=kc&&(x.Hr=kc);var Nc=null==y.bp?null:y.bp.toString();null!=Nc&&(x.Html=Nc);var id=null==y.bq?null:y.bq.toString();null!=id&&(x.I=id);var Ed=null==y.br?null:y.br.toString();null!=Ed&&(x.Iframe=Ed);var Ja=null==y.bs?null:y.bs.toString();null!=Ja&&(x.Img=Ja);var db=null==y.bt?null:y.bt.toString();null!=db&&(x.Input=db);var zc=null==y.bu?null:y.bu.toString();null!=zc&&(x.Ins=zc);var Hd=null==y.bv?null:y.bv.toString();null!=Hd&&(x.Isindex=Hd);var Ad=null==y.bw?null:y.bw.toString();null!=Ad&&(x.Kbd=
Ad);var Kd=null==y.bx?null:y.bx.toString();null!=Kd&&(x.Label=Kd);var Pc=null==y.by?null:y.by.toString();null!=Pc&&(x.Legend=Pc);var tf=null==y.bz?null:y.bz.toString();null!=tf&&(x.Li=tf);var xe=null==y.ca?null:y.ca.toString();null!=xe&&(x.Link=xe);var ef=null==y.cb?null:y.cb.toString();null!=ef&&(x.Map=ef);var Id=null==y.cc?null:y.cc.toString();null!=Id&&(x.Math=Id);var qe=null==y.cd?null:y.cd.toString();null!=qe&&(x.Menu=qe);var jg=null==y.ce?null:y.ce.toString();null!=jg&&(x.Meta=jg);var of=null==
y.cf?null:y.cf.toString();null!=of&&(x.Noframes=of);var Cb=null==y.cg?null:y.cg.toString();null!=Cb&&(x.Noscript=Cb);var Df=null==y.ch?null:y.ch.toString();null!=Df&&(x.Object=Df);var Bf=null==y.ci?null:y.ci.toString();null!=Bf&&(x.Ol=Bf);var qg=null==y.cj?null:y.cj.toString();null!=qg&&(x.Optgroup=qg);var vd=null==y.ck?null:y.ck.toString();null!=vd&&(x.Option=vd);var $f=null==y.cl?null:y.cl.toString();null!=$f&&(x.P=$f);var ng=null==y.cm?null:y.cm.toString();null!=ng&&(x.Param=ng);var Qe=null==y.cn?
null:y.cn.toString();null!=Qe&&(x.Pre=Qe);var Gf=null==y.co?null:y.co.toString();null!=Gf&&(x.Q=Gf);var Jf=null==y.cp?null:y.cp.toString();null!=Jf&&(x.S=Jf);var xh=null==y.cq?null:y.cq.toString();null!=xh&&(x.Samp=xh);var he=null==y.cr?null:y.cr.toString();null!=he&&(x.Script=he);var de=null==y.cs?null:y.cs.toString();null!=de&&(x.Select=de);var xf=null==y.ct?null:y.ct.toString();null!=xf&&(x.Small=xf);var re=null==y.cu?null:y.cu.toString();null!=re&&(x.Span=re);var Ih=null==y.cv?null:y.cv.toString();
null!=Ih&&(x.Strike=Ih);var Le=null==y.cw?null:y.cw.toString();null!=Le&&(x.Strong=Le);var Cd=null==y.cx?null:y.cx.toString();null!=Cd&&(x.Style=Cd);var Lc=null==y.cy?null:y.cy.toString();null!=Lc&&(x.Sub=Lc);var Td=null==y.cz?null:y.cz.toString();null!=Td&&(x.Sup=Td);var Ge=null==y.da?null:y.da.toString();null!=Ge&&(x.Tables=Ge);var Xc=null==y.db?null:y.db.toString();null!=Xc&&(x.Tbody=Xc);var jf=null==y.dc?null:y.dc.toString();null!=jf&&(x.Td=jf);var Mh=null==y.dd?null:y.dd.toString();null!=Mh&&
(x.Textarea=Mh);var bd=null==y.de?null:y.de.toString();null!=bd&&(x.Tfoot=bd);var Bc=null==y.df?null:y.df.toString();null!=Bc&&(x.Th=Bc);var Hf=null==y.dg?null:y.dg.toString();null!=Hf&&(x.Thead=Hf);var Me=null==y.dh?null:y.dh.toString();null!=Me&&(x.Title=Me);var Tf=null==y.di?null:y.di.toString();null!=Tf&&(x.Tr=Tf);var Sd=null==y.dj?null:y.dj.toString();null!=Sd&&(x.Tt=Sd);var lf=null==y.dk?null:y.dk.toString();null!=lf&&(x.U=lf);var fb=null==y.dl?null:y.dl.toString();null!=fb&&(x.Ul=fb);var Qb=
null==y.dm?null:y.dm.toString();null!=Qb&&(x.Var=Qb);var ac=null==y.dn?null:y.dn.toString();null!=ac&&(x.Unknown=ac);break;case 6:A="List";var Jc=y.a;null!=Jc&&(x.SessionID=Jc);var pd=y.b.toString();null!=pd&&(x.MaxListLevel=pd)}x.Table=A;return Sys.Serialization.JavaScriptSerializer.serialize(x)};d.d(aa,"a",function(){return v});class v{static get p9(){null==v.M3a&&(v.M3a=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return v.M3a}static get Mkg(){null==
v.rEd&&(v.rEd=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return v.rEd}static RQ(B){h.ULS.sendTraceTag(5822145,307,50,B)}static o3f(B){const y={};y.a=B;y.b=0;y.c=0;y.d=0;y.e=0;y.f=0;return y}static g4j(B){v.p9||v.RQ(n(0,B))}static dbe(B){const y={};y.a=B;y.b=0;y.c=0;return y}static f6j(B){v.p9||v.RQ(n(1,B))}static n3f(B,y){const x={};x.c=r.a[B];x.a=y;return x}static f4j(B,y){v.Mkg&&B&&(B.b=y,v.RQ(n(5,B)))}static c7f(B){const y={};y.a=B;y.b=0;y.c=
0;y.d=0;y.e=0;y.f=0;y.g=0;y.h=0;y.i=0;y.j=0;y.k=0;y.l=0;y.m=0;return y}static t5j(B){v.p9||v.RQ(n(3,B))}static d7f(B){const y={};y.a=B;y.b=0;y.c=0;y.d=0;y.e=0;return y}static u5j(B){v.p9||v.RQ(n(4,B))}static W7d(B,y){const x={};x.b=r.a[B];x.c=y;x.d=0;x.e=0;x.f=0;x.g=0;x.h=0;x.i=0;x.j=0;x.k=0;x.l=0;x.m=0;x.n=0;x.o=0;x.p=0;x.q=0;x.r=0;x.s=0;x.t=0;x.w=0;x.x=0;x.y=0;x.z=0;x.u=0;x.v=0;return x}static V3j(B,y){v.Mkg&&B&&(B.a=y,v.RQ(n(2,B)))}static pdj(B){const y={};y.a=B;y.b=-1;return y}static z4j(B){!v.p9&&
B&&0<=B.b&&v.RQ(n(6,B))}}v.M3a=null;v.rEd=null;Object(J.a)(v,"UsageEditor",null,[])},330:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.jba=1E5;Object(J.a)(h,"ViewConstants",null,[])},331:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.re=this.$f=this.he=this.Nf=0}uWi(e){return e.re<this.$f&&this.re<e.$f&&e.he<this.Nf&&this.he<e.Nf}Evb(e){return e.re>=this.re&&e.$f<=this.$f&&e.he>=this.he&&e.Nf<=this.Nf}mWi(e,r){return e>=this.vXf&&e<=this.Vne&&
r>=this.oXf&&r<=this.Nne}cSa(){return 0>=this.UO||0>=this.AR}equals(e){return e.re===this.re&&e.$f===this.$f&&e.he===this.he&&e.Nf===this.Nf}clone(){return Object.assign(new h,{re:this.re,$f:this.$f,he:this.he,Nf:this.Nf})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",this.re,this.$f,this.he,this.Nf)}get UO(){return this.$f-this.re}get AR(){return this.Nf-this.he}get Vne(){return this.$f-1}get Nne(){return this.Nf-1}get vXf(){return this.re}get oXf(){return this.he}}
Object(J.a)(h,"CellRange",null,[])},332:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.xW="data-copystatus";h.QQa="data-copyfailedreason";h.Jp="data-clipservice-ccpid";h.version="data-clipservice-version";h.location="data-clipservice-location";h.tD="data-clipservice-dc";h.type="data-clipservice-type";h.IGe="data-clipservice-param";h.count="data-clipservice-count";h.mFa="data-clipservice-cut";h.kFa="data-clipservice-isEmptyPlaceholder";h.client="data-clipservice-client";h.ivi=
"data-clipboardasbytes-url";h.zKh="wacserver";h.sessionId="data-SessionId";h.skb="data-ShapeIds";h.slideId="data-SlideId";h.timeStamp="data-TimeStamp";h.mDj="data-willexpire";h.oeg="ClipboardAsImage";h.Cy="data-pkey";Object(J.a)(h,"ClipServiceConstants",null,[])},333:function(J,aa,d){d.d(aa,"a",function(){return E});J=d(0);var h=d(1204),e=d(42),r=d(481),n=d(161),v=d(39),B=d(63),y=d(28),x=d(973),A=d(974);class E{constructor(u){this.sE=u}get node(){return this.sE}get propertySet(){return this.sE}get Zw(){if(1074135132===
this.sE.Ue)return 0;if(1074135137===this.sE.Ue)return 1;y.a.J(18354962,802,10,"Invalid AppType {0}",r.a[this.sE.Ue]);return-1}get id(){return 0===this.Zw?this.propertySet.sa(v.a.NZ,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.sa(v.a.NZ,null)}get yQf(){return this.propertySet.sa(e.a.jRd,null)}get visibility(){return this.propertySet.sa(e.a.qZb,!1)}get width(){return this.propertySet.sa(e.a.Pei,320)}get row(){return this.propertySet.sa(e.a.Oei,0)}get bhg(){return this.propertySet.sa(n.a.isForUILessAction,
!1)}get Qxa(){return this.propertySet.sa(e.a.Qrb,null)}get version(){return this.propertySet.sa(e.a.QHc,null)}get store(){return this.propertySet.sa(e.a.PHc,null)}get storeType(){return this.propertySet.eb(v.a.nZb)}get ownerAddinSolutionId(){return this.propertySet.sa(v.a.l9g,null)}get sharedRuntimeId(){return this.propertySet.sa(n.a.sharedRuntimeId,null)}get settings(){const u={};x.a(this.node,(K,G)=>{A.b(G,u)});return u}get slideId(){return 0===this.Zw?B.a.VE(this.sE.eb(v.a.sid),this.sE.eb(v.a.cid)):
null}get shapeId(){const u=Object(h.a)(4,this.sE);return 0===this.Zw&&u?u.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.sa(v.a.ownerAddinStoreType,null)}get osb(){return this.propertySet.sa(v.a.osb,-1)}get F6a(){return this.propertySet.sa(v.a.F6a,null)}}Object(J.a)(E,"AppReader",null,[836])},334:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(27);class e{constructor(){this.currentDocumentPath=h.AFrameworkApplication.fa.Ga("EditDocInClientUrl")}}Object(J.a)(e,"SmartLookupApplicationInterface",
null,[])},343:function(J,aa,d){var h=d(18),e=d(114),r=d(503),n=d(149),v=d(230);J=d(0);var B=d(207),y=d(28);class x{constructor(Q,Z,P,ca){this.type=Q;this.stops=Z;this.angle=P;this.tFk=ca}oV(){const Q=B.b(this.stops,Z=>Z.oV()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",this.angle,Q);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.tFk.oV(),Q);y.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",
this.type));return v.Color.auto.oV()}static createLinearGradient(Q,Z){return new x(0,Q,Z,null)}static IGi(Q,Z){return new x(1,Q,0,Z)}}Object(J.a)(x,"GradientFill",null,[]);class A{constructor(Q,Z){this.left=Q;this.top=Z}oV(){return String.format("{0}% {1}%",this.left,this.top)}}Object(J.a)(A,"GradientPathCenter",null,[]);class E{constructor(Q,Z){this.color=Q;this.position=Z}oV(){return String.format("{0} {1}%",this.color.oV(),this.position)}}Object(J.a)(E,"GradientStop",null,[]);d.d(aa,"a",function(){return u});
d.d(aa,"g",function(){return K});d.d(aa,"e",function(){return G});d.d(aa,"b",function(){return O});d.d(aa,"c",function(){return R});d.d(aa,"f",function(){return V});d.d(aa,"d",function(){return D});const u=Q=>{Q?(Q=e.a(Q),Q=Object.assign(new r.a,{blipFillField:Q.blipFillField||null,gradFillField:Q.gradFillField||null,grpFillField:Q.grpFillField||null,noFillField:Q.noFillField||null,pattFillField:Q.pattFillField||null,solidFillField:Q.solidFillField||null})):Q=null;return Q},K=Q=>{n.Box4ColorHelper.NRa(Q)},
G=Q=>{Q=e.a(Q);return!Q||!Q.blipFillField&&!Q.gradFillField&&!Q.grpFillField&&!Q.noFillField&&!Q.pattFillField&&!Q.solidFillField},O=Q=>{n.Box4ColorHelper.NRa(Q)},R=Q=>{O(Q);Q&&(Q.cell3DField=null,Q.extLstField=null,Q.lnBField=null,Q.lnBlToTrField=null,Q.lnLField=null,Q.lnRField=null,Q.lnTField=null,Q.lnTlToBrField=null)},V=(Q,Z)=>{if(!Q)return null;var P=Q.gsLstField;if(P){var ca=new h.a;for(const T of P)P=n.Box4ColorHelper.GPc(T),n.Box4ColorHelper.Aab(P)?y.a.J(18397184,822,15,"Encountered invalid gradient stop color."):
ca.add(new E(n.Box4ColorHelper.KH(P,Z),T.posField/1E3));Z=ca.toArray()}else Z=null;if(Q.linField)return ca=90,Q.linField.angFieldSpecified&&(ca=(Q.linField.angField/6E4+90)%360),x.createLinearGradient(Z,ca);if(Q.pathField)return ca=new A(50,50),Q.pathField.fillToRectField&&(ca=new A(Q.pathField.fillToRectField.lField/1E3,Q.pathField.fillToRectField.tField/1E3)),x.IGi(Z,ca);y.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");return x.createLinearGradient(Z,90)},D=Q=>e.b(Q)},
348:function(J,aa,d){J=d(0);var h=d(520),e=d(143);class r extends h.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(J.a)(r,"OperationWithSiblingContext",h.a,[]);d.d(aa,"a",function(){return n});class n extends r{constructor(){super();this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(J.a)(n,"AddOperation",r,[])},349:function(J,aa,d){J=d(0);var h=d(387),e=d(270),r=d(666),n=d(29),v=d(522);class B{}Object(J.a)(B,"ProofingFeedbackLoopRequestObject",null,[]);var y=d(523),x=d(34),A=d(521);d.d(aa,"a",function(){return E});class E extends r.a{constructor(u,K,G,O,R=null){super(K);this.tba=u;this.BVh=G;this.QZh=O;this.xef=!1;this.$a=R;this.errorType=1===(this.tba.CritiqueActions&1)?0:1}get proofingType(){return v.b(this.tba)}get traceId(){return this.tba.TraceId}get typeId(){return this.tba.TypeId}get zN(){return this.tba}get suggestions(){const u=
[];if(this.tba.Suggestions)for(const K of this.tba.Suggestions)u.push(K.Text);return u}get metadata(){const u=[];if(this.tba.Metadata&&0<this.tba.Metadata.length)for(const K of this.tba.Metadata)K.Name&&K.Value&&u.push(K);return u}dMa(u,K=0){this.smf.track(()=>Object.assign(new y.a,{E:2,T:this.proofingType,A:u,I:K,G:this.typeId}));if(this.BVh){var G=e.a.xe(this.lcid);let O="";G?O=G.name:h.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);G=null;h.ULS.sendTraceTag(39416218,
375,50,"Sending proofing context with feedback loop API");G=Object.assign(new B,{AppId:A.a[n.App.mode]+"_online",TraceId:this.traceId,LanguageId:O,CritiqueTypeId:this.typeId,EventId:this.mlk(u),FlaggedText:this.token,SuggestionText:this.zmj(u),PreContextBegin:this.maa,PostContextEnd:this.QJa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.tba.Priority,Metadata:this.tba.Metadata});14!==G.EventId&&this.QZh.o9k(G)}}mlk(u){switch(u){case x.a.Eka:return 0;case x.a.Lde:return 1;
case x.a.bDa:return 3;case x.a.kza:return 4;case x.a.lza:return 5;case x.a.mza:return 6;case x.a.Xub:return 13;default:return 14}}zmj(u){switch(u){case x.a.kza:return this.suggestions[0];case x.a.lza:return this.suggestions[1];case x.a.mza:return this.suggestions[2];case x.a.LLa:return this.suggestions[3];case x.a.MLa:return this.suggestions[4];default:return""}}get MEa(){return this.xef}set MEa(u){this.xef=u}}Object(J.a)(E,"EditorServiceErrorDetails",r.a,[440,441])},350:function(J,aa,d){var h=d(273),
e=d(797),r=d(1233),n=d(47),v=d(205),B=d(27);J=d(0);class y{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(J.a)(y,"RecentColor",null,[]);var x=d(230),A=d(231),E=d(232),u=d(264),K=d(1048),G=d(538),O=d(28);d.d(aa,"f",function(){return R});d.d(aa,"e",function(){return V});d.d(aa,"d",function(){return D});d.d(aa,"c",function(){return Q});d.d(aa,"g",function(){return Z});d.d(aa,"b",function(){return P});d.d(aa,"a",function(){return ca});d.d(aa,"h",function(){return T});const R=(fa,ma,ea,ra,
F,na,ka)=>V(fa,ma,ea,ra,F,na,ka,!1),V=(fa,ma,ea,ra,F,na,ka,Ua)=>{ma=Object.assign(new h.a,{Id:ma,ControlsId:ea,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});ra=Object.assign(new e.a,{Id:ra,ExternalId:F,McuExternalId:String.format("{0}MCU",F),McuLayout:!0,Command:na,Width:10});if(fa)if(F=[],1===ka||2===ka){Ua=(new K.a).Q6i(fa);({themeColors:fa,FCh:ka}=da(Ua,fa));for(var za=0;6>za;za++)for(var ha=0;ha<fa.length;ha++){na=F;ea=na.push;var ua=void 0,Ga=void 0;ua=Ua;var sa=fa[ha][za];Ga=fa[ha][0];
var Ba=ka[ha],pa=za,ia=ha;sa=n.a.jw(sa.r,2)+n.a.jw(sa.g,2)+n.a.jw(sa.b,2);({HKc:ua,JOb:Ga}=ua.L6d(Ga,sa,Ba,pa,ia));sa=Object.assign(new r.a,{Color:"#"+ua,DisplayColor:"#"+sa,Alt:Ga});ea.call(na,sa)}}else for(Ua=(new K.a).K0f(fa,Ua),{themeColors:fa,FCh:ka}=da(Ua,fa),za=0;6>za;za++)for(ha=0;ha<fa.length;ha++)na=F,ea=na.push,ua=Ua,sa=fa[ha][za],Ga=fa[ha][0],Ba=ka[ha],pa=za,ia=ha,sa=n.a.jw(sa.r,2)+n.a.jw(sa.g,2)+n.a.jw(sa.b,2),{HKc:Ga,JOb:ua}=ua.L6d(Ga,sa,Ba,pa,ia),{$4k:Ga,K7k:ua,JOb:sa}={$4k:sa,K7k:Ga,
JOb:ua},sa=Object.assign(new r.a,{Color:ua,DisplayColor:"#"+Ga,Alt:sa}),ea.call(na,sa);else F=null;ra.Colors=F;Array.add(ma.ControlList,ra);return ma},D=(fa,ma,ea,ra,F,na)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:ma,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});ea=Object.assign(new e.a,{Id:ea,ExternalId:ra,Command:F,Width:10,Colors:[]});na?(ea.Colors.push(Object.assign(new r.a,{Color:"0000C0",Alt:n.a.ue(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),ea.Colors.push(Object.assign(new r.a,
{Color:"0000FF",Alt:n.a.ue(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),ea.Colors.push(Object.assign(new r.a,{Color:"00C0FF",Alt:n.a.ue(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),ea.Colors.push(Object.assign(new r.a,{Color:"00FFFF",Alt:n.a.ue(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),ea.Colors.push(Object.assign(new r.a,{Color:"50D092",Alt:n.a.ue(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),ea.Colors.push(Object.assign(new r.a,
{Color:"50B000",Alt:n.a.ue(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),ea.Colors.push(Object.assign(new r.a,{Color:"F0B000",Alt:n.a.ue(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),ea.Colors.push(Object.assign(new r.a,{Color:"C07000",Alt:n.a.ue(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),ea.Colors.push(Object.assign(new r.a,{Color:"602000",Alt:n.a.ue(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),ea.Colors.push(Object.assign(new r.a,
{Color:"A03070",Alt:n.a.ue(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(ea.Colors.push(Object.assign(new r.a,{Color:"#C00000",Alt:n.a.ue(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),ea.Colors.push(Object.assign(new r.a,{Color:"#FF0000",Alt:n.a.ue(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),ea.Colors.push(Object.assign(new r.a,{Color:"#FFC000",Alt:n.a.ue(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),ea.Colors.push(Object.assign(new r.a,
{Color:"#FFFF00",Alt:n.a.ue(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),ea.Colors.push(Object.assign(new r.a,{Color:"#92D050",Alt:n.a.ue(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),ea.Colors.push(Object.assign(new r.a,{Color:"#00B050",Alt:n.a.ue(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),ea.Colors.push(Object.assign(new r.a,{Color:"#00B0F0",Alt:n.a.ue(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),ea.Colors.push(Object.assign(new r.a,
{Color:"#0070C0",Alt:n.a.ue(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),ea.Colors.push(Object.assign(new r.a,{Color:"#002060",Alt:n.a.ue(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),ea.Colors.push(Object.assign(new r.a,{Color:"#7030A0",Alt:n.a.ue(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(fa.ControlList,ea);return fa},Q=(fa,ma,ea,ra,F,na,ka)=>{ma=Object.assign(new h.a,{Id:ma,ControlsId:ea,Title:ResourceStrings.L_RecentColors,ControlList:[]});
ra=Object.assign(new e.a,{Id:ra,ExternalId:F,Command:na,Width:10,Colors:[]});if(ka)for(ka=0;fa&&ka<fa.length&&fa[ka];ka++)F=fa[ka],ra.Colors.push(Object.assign(new r.a,{Color:F.hex,Alt:n.a.ue(F.hex),DisplayColor:F.hex}));else for(ka=0;fa&&ka<fa.length&&fa[ka];ka++)F=fa[ka],ra.Colors.push(Object.assign(new r.a,{Color:"#"+F.hex,Alt:n.a.ue("#"+F.hex),DisplayColor:"#"+F.hex}));Array.add(ma.ControlList,ra);return ma},Z=(fa,ma)=>{if(!ma)return fa;var ea=new y;ea.hex=ma;const ra=[];let F=0;ra[F++]=ea;for(ea=
0;fa&&ea<fa.length&&10>ea&&10>F&&fa[ea];ea++)fa[ea].hex!==ma&&(ra[F++]=fa[ea]);return ra},P=(fa,ma,ea,ra,F,na,ka,Ua)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:ma,DisplayMode:"Menu16",ControlList:[]});ea=Object.assign(new v.a,{Command:ea,LabelText:ra,Image16by16:B.AFrameworkApplication.qm,Image16by16Class:ka,Id:F,ExternalId:na,KeyTip:Ua});Array.add(fa.ControlList,ea);return fa},ca=(fa,ma,ea,ra,F,na,ka,Ua)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:ma,DisplayMode:"Menu16",ControlList:[]});ea=Object.assign(new v.a,
{Command:ea,LabelText:ra,Image16by16:B.AFrameworkApplication.qm,Image16by16Class:ka,Id:F,ExternalId:na,KeyTip:Ua});Array.add(fa.ControlList,ea);return fa},T=(fa,ma,ea)=>{for(let ua=0;ua<fa.MenuSectionList.length;ua++){var ra=fa.MenuSectionList[ua],F=ra.ControlList;if(F&&0<F.length&&(F=F[0]))if(ma)if(ra.Id===G.a.themeColors&&ea){var na=E.i(ma.sD)||"";ra=ea;var ka=F.Colors,Ua="#";if(ka&&ka.length)if(n.a.Wa(na))O.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");
else for(var za=0;za<ka.length;za++){var ha=ka[za].Color;if(!n.a.Wa(ha)&&(ha=(ha=A.a.parse(ka[za].Color))?ha.Rtc():u.SchemeColor.parse(ka[za].Color),ra&&ha&&ha.wQe(ra)&&ha.Nta&&(ha=E.i(ha.ZP),ha.toLowerCase()===na.toLowerCase()))){Ua=ka[za].Color;break}}ra=Ua;F.SelectedColorId=ra}else{ka=E.i(E.g(ma.sD))||"";ra=F.Colors;na="#";if(ra&&ra.length)if(n.a.Wa(ka))O.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ua=0;Ua<ra.length;Ua++)if(za=ra[Ua].DisplayColor,
!n.a.Wa(za)&&za.replace("#","").toLowerCase()===ka.toLowerCase()){na=ra[Ua].Color;break}ra=na;F.SelectedColorId=ra}else F.SelectedColorId="#"}},da=(fa,ma)=>{let ea;ea=Array(10);ea[0]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Background1));ea[1]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Text1));ea[2]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Background2));ea[3]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Text2));ea[4]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Accent1));ea[5]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Accent2));
ea[6]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Accent3));ea[7]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Accent4));ea[8]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Accent5));ea[9]=fa.kL(x.Color.Vi(ma.PresetSchemeColorMapping.Accent6));fa=Array(10);fa[0]=ResourceStrings.l_ThemeLabel1;fa[1]=ResourceStrings.l_ThemeLabel2;fa[2]=ResourceStrings.l_ThemeLabel3;fa[3]=ResourceStrings.l_ThemeLabel4;fa[4]=ResourceStrings.l_ThemeLabel5;fa[5]=ResourceStrings.l_ThemeLabel6;fa[6]=ResourceStrings.l_ThemeLabel7;
fa[7]=ResourceStrings.l_ThemeLabel8;fa[8]=ResourceStrings.l_ThemeLabel9;fa[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:ea,FCh:fa}}},378:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.lIf="CU";h.Lxi="CS";h.Ixi="CE";h.Fne="KP";h.lwl="TI";h.s4j="L";Object(J.a)(h,"CharacterBlockTrackerKeys",null,[])},379:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.body=this.contextId=this.revId=this.source=this.id=null}}Object(J.a)(h,"Item",null,[])},
380:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(36);class e{constructor(r,n){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=r;this.Flight=n}serialize(){return h.c([this.Zk(),this])}}Object(J.a)(e,"ACommonHandlerRequest",null,[])},381:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.Ytc="ToolbarButton";h.IOb="ToolbarButtonHome";h.insertPicture="InsertPicture";h.h_e="SlideNavigationDesignMode";h.ljb="Retrigger";h.refresh="Refresh";h.typing=
"Typing";h.qOf="DesignElementsDeleted";h.hVd="ChangeSlideSize";h.bsb="ApplyTheme";h.c_e="SlideChangeLayout";h.vna="NewSlide";h.bVd="ChangeIconInSmartArt";h.qtb="ChangeIcon";h.insertTable="InsertTable";h.zxa="PasteTable";h.JXc="InsertChart";h.BRd="ApplyReplaceObject";h.moreIdeas="MoreIdeas";h.newDocument="NewDocument";h.R_d="DesignTab";h.makeItVisual="MakeItVisual";h.EJa="PasteText";h.IXd="ConvertedToPPT";h.NQd="AgendaToPPT";Object(J.a)(h,"DesignerTrigger",null,[])},382:function(J,aa,d){d.d(aa,"a",
function(){return h});J=d(0);class h{}Object(J.a)(h,"OAuthResult",null,[])},386:function(J,aa,d){J=d(0);var h=d(55),e=d(27),r=d(47),n=d(109),v=d(1231),B=d(14),y=d(1204),x;(function(fa){fa[fa.none=0]="none";fa[fa.noSystemClipboardAccess=1]="noSystemClipboardAccess";fa[fa.cutCopyDisallowed=2]="cutCopyDisallowed";fa[fa.pasteDisallowed=3]="pasteDisallowed";fa[fa.invalidPasteContext=4]="invalidPasteContext";fa[fa.invalidCcpOperation=5]="invalidCcpOperation";fa[fa.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";
fa[fa.pastedHtmlLengthExceeded=7]="pastedHtmlLengthExceeded";fa[fa.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";fa[fa.noShapesPasted=9]="noShapesPasted";fa[fa.invalidImagePasteArgs=10]="invalidImagePasteArgs";fa[fa.invalidClipboardData=11]="invalidClipboardData";fa[fa.invalidCopiedShapes=12]="invalidCopiedShapes";fa[fa.invalidCopiedSlides=13]="invalidCopiedSlides";fa[fa.invalidHtmlContent=14]="invalidHtmlContent";fa[fa.textEditFailed=15]="textEditFailed";fa[fa.clipServiceDataInvalid=16]="clipServiceDataInvalid";
fa[fa.crossDCPasteDisallowed=17]="crossDCPasteDisallowed";fa[fa.imageTooLarge=18]="imageTooLarge";fa[fa.noAvailablePasteHandler=19]="noAvailablePasteHandler";fa[fa.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";fa[fa.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";fa[fa.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";fa[fa.copyObjectEmpty=23]="copyObjectEmpty";fa[fa.tableInvalid=24]="tableInvalid";fa[fa.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";fa[fa.userOffline=
26]="userOffline";fa[fa.picklingPasteFailedDueToMaxSizeLimit=27]="picklingPasteFailedDueToMaxSizeLimit";fa[fa.picklingInvalidCopyData=28]="picklingInvalidCopyData";fa[fa.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";fa[fa.chunkUploaderFailure=30]="chunkUploaderFailure";fa[fa.pasteCancelledByUser=31]="pasteCancelledByUser";fa[fa.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(x||(x={}));Object(J.b)("CcpFailure",x);var A=d(943),E=d(114),u=d(28),K=d(332),G;(function(fa){fa[fa.none=
0]="none";fa[fa.text=1]="text";fa[fa.shape=2]="shape";fa[fa.textbox=3]="textbox";fa[fa.normalShape=4]="normalShape";fa[fa.image=5]="image";fa[fa.table=6]="table";fa[fa.chart=7]="chart";fa[fa.video=8]="video";fa[fa.list=9]="list";fa[fa.ink=10]="ink";fa[fa.addin=11]="addin";fa[fa.smartArt=12]="smartArt";fa[fa.group=13]="group";fa[fa.placeholder=14]="placeholder";fa[fa.line=15]="line";fa[fa.activeX=16]="activeX";fa[fa.oleObject=17]="oleObject";fa[fa.media=18]="media";fa[fa.slide=19]="slide";fa[fa.mixed=
20]="mixed"})(G||(G={}));Object(J.b)("ClipboardContentType",G);var O;(function(fa){fa[fa.keyboard=0]="keyboard";fa[fa.menu=1]="menu";fa[fa.floatie=2]="floatie";fa[fa.ribbon=3]="ribbon"})(O||(O={}));Object(J.b)("ClipboardMethod",O);var R;(function(fa){fa[fa.copy=0]="copy";fa[fa.cut=1]="cut";fa[fa.paste=2]="paste"})(R||(R={}));Object(J.b)("ClipboardOperation",R);var V;(function(fa){fa[fa.other=0]="other";fa[fa.pptOnline=1]="pptOnline";fa[fa.pptOnlineSameSession=2]="pptOnlineSameSession";fa[fa.pptOnlineCrossSession=
3]="pptOnlineCrossSession";fa[fa.wordOnline=4]="wordOnline";fa[fa.xlOnline=5]="xlOnline";fa[fa.oneNoteOnline=6]="oneNoteOnline";fa[fa.pptWin32=7]="pptWin32";fa[fa.wordWin32=8]="wordWin32";fa[fa.xlWin32=9]="xlWin32";fa[fa.oneNoteWin32=10]="oneNoteWin32";fa[fa.googleDocs=11]="googleDocs";fa[fa.pptDesktop=12]="pptDesktop";fa[fa.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(V||(V={}));Object(J.b)("ClipboardSource",V);class D{constructor(){this.data={};this.BAf=!1;this.Ykb=null}}Object(J.a)(D,
"TelemetryEntry",null,[]);var Q=d(1045),Z=d(434),P=d(43),ca=d(30),T=d(68);d.d(aa,"a",function(){return da});class da{constructor(fa,ma,ea,ra,F,na,ka,Ua,za,ha,ua,Ga){this.Wtg=h.a.Wy;this.WSg=this.NAg=this.A4c="";this.tR=fa;this.WT=ma;this.Ov=new T.a;this.P$=new T.a;ra.l6a(Object(B.a)(this,this.gJe,"onRevisionProcessedOnServer"));F.Dia(Object(B.a)(this,this.Hyl,"trackSlideCcpRevision"));na.Dia(Object(B.a)(this,this.Gyl,"trackShapeCcpRevision"));ka.Dia(Object(B.a)(this,this.Dyl,"trackParagraphCcpRevision"));
Ua.Dia(Object(B.a)(this,this.Cyl,"trackNotesCcpRevision"));za&&za.Dia(Object(B.a)(this,this.Eyl,"trackPresentationCcpRevision"));this.NL=ua;this.ia=ha;this.Asg=ea.Frd;this.Lv=Ga;if(fa=e.AFrameworkApplication.gd)this.NAg=Object(y.a)(String,fa.Host)||"",this.WSg=Object(y.a)(String,fa.Ring)||"",this.A4c=Object(y.a)(String,fa.WACDatacenter)||""}HAb(fa){return this.Ov.Gb(fa)}NB(fa,ma){r.a.Wa(ma)||(this.HAb(ma)?da.contentType in this.Ov.ga(ma).data&&!this.BMj(ma,fa)||this.dW(da.contentType,G[fa],ma):u.a.J(50393377,
826,15,"attempted to update clipboard telemetry before tracking started "+ma))}s$a(fa,ma){if(!this.Ov.Gb(fa))return null;let ea=null;if(this.Ov.ga(fa)&&!(ma in this.Ov.ga(fa).data))switch(ma){case da.contentType:ea="none";break;case da.source:ea="other"}return ea?ea:this.Ov.ga(fa).data[ma].toString()}b1f(fa){return this.s$a(fa,da.contentType)}C0f(fa){return this.s$a(fa,da.source)}t6i(fa){return this.s$a(fa,da.operation)}$$b(fa){return"xlOnline"===this.C0f(fa)&&"chart"===this.b1f(fa)}F0c(fa){return"slide"===
this.b1f(fa)&&"paste"===this.t6i(fa)}UDk(fa){const ma=G;for(let ra in ma){var ea=ma[ra];if(ra.toLowerCase()===fa.toLowerCase())return ea}return 0}VDk(fa){const ma=V;for(let ra in ma){var ea=ma[ra];if(ra.toLowerCase()===fa.toLowerCase())return ea}return 0}BMj(fa,ma){fa=this.UDk(this.Ov.ga(fa).data[da.contentType].toString());return ma>fa}Lw(fa,ma){r.a.Wa(ma)||(this.HAb(ma)?da.source in this.Ov.ga(ma).data&&!this.pWj(ma,fa)||this.dW(da.source,V[fa],ma):u.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+
ma))}pWj(fa,ma){fa=this.VDk(this.Ov.ga(fa).data[da.source].toString());return ma>fa}$h(fa,ma,ea){r.a.Wa(ea)||this.dW(fa,ma,ea)}hP(fa,ma,ea){const ra=P.a.Ib&&!r.a.Wa(P.a.Ib.actionName)?P.a.Ib.actionName:ea,F=n.a.create().toString();this.Ov.$(F,Object.assign(new D,{Ykb:this.tR.Ei("UserAction","ClipboardTelemetry")}));this.dW(da.DEf,F,F);this.dW(da.actionName,ra,F);this.dW("ActualActionName",ea,F);this.dW("CcpOperation",R[fa],F);this.dW("CcpMethod",O[ma],F);this.dW("CcpBrowser",this.Wtg,F);this.dW("CcpHost",
this.NAg,F);this.dW("CcpDatacenter",this.A4c,F);this.dW("CcpRing",this.WSg,F);u.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",this.Wtg,F,O[ma],R[fa],ra);return F}Hg(fa,ma,ea=0){if(r.a.Wa(ma))u.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(r.a.Wa(ma)||!this.HAb(ma))u.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",ma);else{var ra=this.Ov.ga(ma);
this.dW("CcpTotalMs",ra.Ykb.Vq.toString(),ma);this.dW(da.EEf,fa.toString(),ma);0!==ea&&(this.dW("CcpFailureReason",x[ea],ma),this.$$b(ma)?16===ea?this.NL.kga(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,da.atb):(fa=Object.assign(new Z.a(!0),{Wb:ma}),this.NL.kga(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,
ca.a.GJf,ca.a.NXd,null,fa,!0,da.atb)):25===ea&&(u.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",ma),this.NL.kga(ResourceStrings.l_DeferredContentPasteDialogTitle,ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,da.atb)));u.a.J(50733397,826,50,E.c(ra.data));this.$$b(ma)||this.F0c(ma)||this.Ov.remove(ma)}}Nfl(fa,ma){r.a.Wa(ma)||(this.Lw(0,ma),this.Psh(fa,ma,0))}Psh(fa,ma,ea){if(fa){if(ea>=Q.a.VIc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",
Q.a.VIc));if(1===fa.nodeType){for(var ra=fa.firstChild;ra;)this.Psh(ra,ma,ea+1),ra=ra.nextSibling;this.ZWe(fa,ma)}}}ZWe(fa,ma){const {ClipboardHelper:ea}=d(716);if(!r.a.Wa(ma))if(!this.HAb(ma))u.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+ma);else if(fa)if("head"===fa.tagName.toLowerCase()){var ra=this.WT.UUf(fa);r.a.Wa(ra)||this.vfl(ra,ma)}else{ra=0;var F=fa.getAttribute(K.a.sessionId);F?ra=ea.Pmg(F.toString())?2:3:fa.getAttribute(A.a.YMf)?ra=5:fa.getAttribute(A.a.ZMf)||
fa.getAttribute(A.a.cNf)?ra=1:fa.id&&fa.id.startsWith&&fa.id.startsWith(A.a.k$f)&&(ra=11);if(fa.className&&fa.className.split)for(const na of fa.className.split(" "))if(na.startsWith(h.a.a_b)&&na.length===h.a.a_b.length+1&&(fa=parseInt(r.a.substring(na,na.length-1,na.length)),isNaN(fa)||this.dW("CcpSourceBrowser",v.a[fa],ma)),0===ra)if(na.startsWith(A.a.Abh))ra=1;else if(na.startsWith(A.a.o8g))ra=6;else if(na.startsWith(A.a.UKh))ra=4;else if(na===A.a.c0g||na===A.a.d0g)ra=8,this.NB(9,ma);0!==ra&&this.Lw(ra,
ma)}}vfl(fa,ma){switch(fa){case "PowerPoint.Slide":this.Lw(7,ma);break;case "Word.Document":this.Lw(8,ma);break;case "Excel.Sheet":this.Lw(9,ma);break;case "OneNote.File":this.Lw(10,ma)}}dW(fa,ma,ea){this.Ov.Gb(ea)&&(this.Ov.ga(ea).data[fa]=ma)}gJe(fa,ma){ma.MH&&!r.a.Wa(ma.MH.Id)&&this.P$.Gb(ma.MH.Id)&&this.ASf(ma.MH.Id,!ma.MH.Error,ma.MH.Error?ma.MH.Error.Code:0)}Hyl(fa,ma){this.buc(ea=>{let ra=null;if(ea=Object(y.a)(116,ea.node))ra=ea.Wb,ea.Wb=null;return ra},ma)}Gyl(fa,ma){this.buc(ea=>{let ra=
null;if(ea=Object(y.a)(4,ea.node))ra=ea.Wb,ea.Wb=null;return ra},ma)}Dyl(fa,ma){this.buc(ea=>{let ra=null;if(ea=Object(y.a)(5,ea.node))ra=ea.Wb,ea.Wb=null;return ra},ma)}Cyl(fa,ma){this.buc(ea=>{let ra=null;if(ea=Object(y.a)(1101,ea.node))ra=ea.Wb,ea.Wb=null;return ra},ma)}Eyl(fa,ma){this.buc(ea=>{let ra=null;if(ea=Object(y.a)(532,ea.node))ra=ea.Wb,ea.Wb=null;return ra},ma)}buc(fa,ma){ma.revisionId&&ma.node&&(fa=fa(ma),r.a.Wa(fa)||this.fzh(ma.revisionId.toString(),fa))}fzh(fa,ma){r.a.Wa(fa)||r.a.Wa(ma)||
this.P$.$(fa,ma)}ASf(fa,ma,ea){if(!r.a.Wa(fa)&&this.P$.Gb(fa)){this.Asg&&"pptDesktopWithDataUpload"===this.C0f(this.P$.ga(fa))&&this.Lv.P1d();var ra={};ra[da.DEf]=this.P$.ga(fa);ra[da.EEf]=ma;ra[da.kvi]=ea;this.$$b(this.P$.ga(fa))?(ra[da.source]="xlOnline",ra[da.contentType]="chart",0!==ea&&(ma=Object.assign(new Z.a(!0),{Wb:this.P$.ga(fa)}),this.NL.kga(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,
CommonUIStrings.l_CalloutNotificationSButtonLabel,ca.a.GJf,ca.a.NXd,null,ma,!0,da.atb))):433===ea?(this.F0c(this.P$.ga(fa))&&this.ia.processAction(ca.a.zI,2),this.NL.kga(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,da.atb)):434===ea&&(this.F0c(this.P$.ga(fa))&&(this.Asg?this.ia.processAction(ca.a.F_d,2):this.ia.processAction(ca.a.zI,2)),this.NL.kga(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,da.atb));u.a.J(50733400,826,50,E.c(ra));(this.$$b(this.P$.ga(fa))||this.F0c(this.P$.ga(fa)))&&this.Ov.remove(this.P$.ga(fa));this.P$.remove(fa)}}rLj(fa){return!r.a.Wa(fa)&&this.Ov.Gb(fa)?this.Ov.ga(fa).BAf:!1}Xic(fa){r.a.Wa(fa)||(this.HAb(fa)?this.Ov.ga(fa).BAf=!0:u.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+fa))}}da.source="CcpSource";da.contentType="CcpContentType";da.operation="CcpOperation";da.EEf="CcpSuccess";da.actionName=
"ActionName";da.atb=20;da.DEf="CcpCorrelation";da.hCi="CcpCopyIframeContent";da.FGf="ClipServiceThrottled";da.CEf="data-corr-id";da.Jp="CcpId";da.kvi="ClipServiceFailureReason";Object(J.a)(da,"ClipboardTelemetry",null,[1173])},393:function(J,aa,d){J=d(0);var h=d(47),e=d(195),r=d(1212),n=d(1204),v=d(58);class B{constructor(){this.shapeType=this.vEe=this.rZg=this.T1g=this.S1g=0;this.hr=this.eq=this.Op=this.Hj=!1;this.tIc=null}}Object(J.a)(B,"ShapeProperties",null,[]);var y=d(28),x=d(43),A=d(103),E=
d(216);d.d(aa,"a",function(){return u});class u{constructor(K,G,O,R,V,D,Q,Z,P){this.Ms=K;this.Sk=G;this.Ea=Q;this.Xad=D.Tkl;this.cgk=this.dHi();this.kq=O;this.WL=R;this.Te=V.Ma;this.yO=D.Cua;this.Sbk=D.zza;this.Tb=P}F$g(K,G,O,R,V,D=null){if(G){var Q=this.Ea.K9a(O);Q&&(Array.remove(O,Q),Array.add(O,this.Ea.yr(Q)));this.ryh(O);var Z=O.length;Q=Array(Z);R=this.U4f(G,R);for(var P=0;P<Z;P++){var ca=O[P],T=this.bfj(ca,R);Q[P]=Object.assign(new B,{S1g:T.x,T1g:T.y,rZg:ca.wx,vEe:ca.JC,shapeType:ca.shapeType,
Hj:ca.Hj,Op:ca.Op||2===ca.mediaType||1===ca.mediaType,eq:ca.ud,hr:ca.hr,tIc:""});Q[P].Hj&&(T=Object(n.a)(117,ca.sc(this.Te)),Q[P].tIc=T?T.v_e:"",y.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",ca.Ece,this.WL.aX(ca),0<Q[P].tIc.length))}P=G.Cb;ca=G.Wt();T=[];R=!0;var da=K.ij===G.ij,fa=K.Cn===G.Cn,ma=!1;K!==G&&(da?(ma=K.V$a||G.V$a,fa||(ma=K.N$a||G.N$a||ma),R=!ma):R=!1,R&&this.yO&&(K.oq!==G.oq||K.Vk!==G.Vk)&&(R=!1));for(var ea=0;ea<Z;ea++)this.Skl(O[ea])||(T.push(O[ea]),R&&(R=
this.Ril(O[ea],fa)));O=T;y.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:R,["SameSlide"]:K===G,["SameMaster"]:da,["SameLayout"]:fa,["ThemeOverrides"]:ma});Z=[];ea=ma=fa=da=T=!1;for(let ra=0;ra<O.length;ra++){const F=Q[ra];let na=this.Sk.pEi(P.cid,P.sid,F.S1g,F.T1g,F.rZg,1>F.vEe?1:F.vEe,ca+O[ra].get_zIndex(),K.id,O[ra],F.shapeType,F.Hj,F.tIc,R);h.a.Wa(D)||(na.Wb=D);Z.push(na);T=T||F.Hj;da=da||F.Op;fa=fa||F.eq;ma=ma||F.hr;ea=ea||this.Sbk&&u.pTj(na)}V=u.Jlh(T,da,fa,ma,ea,V);if(0<Z.length&&(K=R?
O:null,this.Ms.HW(Z,G,V,K),R&&x.a.Ib)){if(K){G="";for(const ra of K)G+=this.Ea.r6b(ra)+",";x.a.Ib.Va(A.a.cCi,G);x.a.Ib.Va(A.a.uhl,K.length.toString())}x.a.Ib.Oj=!0;x.a.Ib.QMb=!0}}}sJi(K,G,O,R,V,D){var Q=this.U4f(K,O);O=[];const Z=G.Yjc,P=!!Z&&!e.a.Wa(Z.gng);D=this.afj(D,Q);for(Q=0;Q<G.objectCount;Q++){const ca=this.Sk.BDi(K.cid,K.sid,D.x,D.y,V);ca.isEditable=P&&Z.gng[Q];O.push(ca)}0<O.length&&this.Ms.HW(O,K,R)}afj(K,G){const O=G*u.RS;G*=u.RS;let R=new v.a(O,G);K&&(R=this.Tb.Eta(K.clientWidth,K.clientHeight))&&
(R.x+=O,R.y+=G);return R}Skl(K){return K.gB&&this.Xad||!K.mig}Ril(K,G){return K.Ece||this.WL.aX(K)||K.fl&&K.hasText&&!G&&10!==K.Jj&&12!==K.Jj||K.Dq?!1:!0}ryh(K){K.sort((G,O)=>G.get_zIndex()-O.get_zIndex())}bUj(K){return K?this.cgk.contains(K):!1}U4f(K,G){if(!K)return 0;if(!G)return u.Gni;let O,R;return G.$(O=K.Cb,(R=G.ga(O))+1),R}bfj(K,G){var O=this.kq.presentation;if(!O)throw Error.argumentNull("Presentation is null");let R=K.Ay,V=K.By;K=O.glj(O.AC(K.slideId));O=Math.round(u.RS/K)*K;K=r.a.qf(O,0);
for(O=r.a.qf(O,1);0<G;)R+=K,V+=O,G--;return new v.a(R,V)}MAl(K){try{if(K&&K.clipboardData){const G=K.clipboardData.types;for(let O=0;O<G.length;O++){const R=K.clipboardData.getData(G[O]);if(this.FLj(R))return R}}}catch(G){}return null}FLj(K){return!!K&&0<K.length&&this.fYj(K)}fYj(K){K=K.trim().toLowerCase();return K.startsWith("http:")||K.startsWith("https:")}scl(K,G,O){K&&(K.setAttribute(u.sCf,G.toString()),K.setAttribute(u.rCf,O.toString()),K.setAttribute(u.tCf,"true"))}dHi(){const K=new E.a;K.add("param");
K.add("map");K.add("area");K.add("script");K.add("noscript");K.add("col");K.add("colgroup");K.add("caption");K.add("head");K.add("title");K.add("link");K.add("meta");K.add("style");K.add("base");K.add("input");K.add("textarea");K.add("select");K.add("option");K.add("optgroup");K.add("button");K.add("hr");return K}Gbj(K){return this.lFh(K,u.sCf)}xbj(K){return this.lFh(K,u.rCf)}RPj(K){return K?"true"===K.getAttribute(u.tCf):!1}wAl(K){if(this.Ang(K)){const G=K.indexOf('"')+1,O=K.lastIndexOf('"');if(1<
G&&O>G&&(K=K.slice(G,O),K.startsWith(u.Pni)))return K}return null}Ang(K){return!!K&&K.length>u.noi&&K.startsWith(u.Qni)}lFh(K,G){let O=0;this.RPj(K)&&(O=parseFloat(K.getAttribute(G)));return isNaN(O)?0:O}pUd(K){return this.qUd(K).returnValue}qUd(K){let G;G=2;let O=0,R=0,V=0,D=0,Q=0,Z=0,P=0,ca=0,T=0,da=0,fa=0,ma=0,ea=0,ra=0,F=0,na=0,ka=0;for(const Ua of K)Ua.ud?(G=2===G?6:20,O++):Ua.Qf?(G=2===G?12:20,R++):Ua.hr?(G=2===G?7:20,V++):Ua.If?(G=2===G?13:20,D++):22===Ua.v7b?(G=2===G?10:20,Q++):Ua.Hj?(G=2===
G?5:20,Z++):Ua.ux?(G=2===G?3:20,P++):Ua.m4?(G=2===G?14:20,Ua.gB&&T++,ca++):Ua.fl?(G=2===G?14:20,Ua.gB&&fa++,da++):Ua.gz?(G=2===G?15:20,ma++):Ua.wT?(G=2===G?16:20,ea++):Ua.Op?(G=2===G?18:20,ra++):Ua.Dq?(G=2===G?11:20,F++):Ua.Tda?(G=2===G?17:20,na++):(G=2===G?4:20,ka++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",
K.length,O,R,V,D,Q,Z,P,ca,T,da,fa,ma,ea,ra,F,na,ka),contentType:G}}static M8k(K){for(const G of K)if(!G.mig||G.isLocal)return!1;return!0}static pTj(K){return K&&4===K.TK?(!K.fill||!!K.fill.noFillField)&&(!K.lineStyle||!!K.lineStyle.noFillField):!1}static Jlh(K,G,O,R,V,D){return K||G||O||R||V?D:0}}u.tCf="data-from-ppt-online";u.sCf="data-image-width-mu";u.rCf="data-image-height-mu";u.Pni="data:image/";u.Qni="<img src=";u.noi=14;u.Gni=1;u.RS=15;Object(J.a)(u,"CopyPasteUtility",null,[748])},438:function(J,
aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.open="open";h.refresh="refresh";h.iUe="saveAs";h.translate="translate";h.modeSwitch="modeSwitch";h.cGi="createNew";h.convert="convert";Object(J.a)(h,"ReasonList",null,[])},439:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.func=this.outputSchema=this.inputSchema=this.name=null}}Object(J.a)(h,"Lambda",null,[677])},440:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.csc="SlideTextTile";
h.LXe="ShapeTextTile";Object(J.a)(h,"AugmentationSchemas",null,[])},441:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d(27);class h{static wb(){}static h1(e,r,n,v,B){return 1===n?32:h.hNk(e,B)?32:8}static dH(e,r,n,v,B){return 1===n?32:h.xqk(e,B)?32:8}static xqk(e,r){const n=h.qQh[e.toString()];if(void 0===n||null===n)return!1;n(e,r);return!0}static hNk(e,r){const n=h.tQh[e.toString()];if(void 0===n||null===n)return!1;n(e,r);return!0}}h.qQh={};h.tQh={};Object(J.a)(h,"DialogCuiControlActor",
null,[])},442:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.description=this.title=this.bQ=this.e1=null}}Object(J.a)(h,"CpContentDetails",null,[525])},443:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(109);class e{constructor(){this.Gwf=!1;this.sessionId=this.IGf=null;this.o7a=e.i3i()}static i3i(){return"CID"+h.a.create().toString()}static Ugg(r){return r&&r.length?r.startsWith("CID")&&h.a.isValid(r.substring(3,r.length))?!0:!1:!1}}Object(J.a)(e,
"InternalClipboardObject",null,[])},444:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.d1a=this.Bda=this.jV=null;this.T_c=this.TMb=!1;this.FKe=0;this.Wb=null;this.oje=this.K$b=!1;this.reset()}reset(){this.Bda=[];this.jV=null;this.d1a=[];this.T_c=this.TMb=!1;this.FKe=0;this.Wb=null;this.oje=this.K$b=!1}}Object(J.a)(h,"HtmlPasteContext",null,[])},445:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(443);class h extends d.a{constructor(e){super();this.Fd=
e}get mlg(){return!this.Fd||!this.Fd.isConnected}get id(){return this.Fd.id}get isConnected(){return this.Fd.isConnected}}Object(J.a)(h,"InternalClipboardSlide",d.a,[])},446:function(J,aa,d){d.d(aa,"a",function(){return e});var h=d(107);const e=(r,n,v)=>{const B=new h.StandardDialog;B.yd=0;B.fP(r,n,v);return B}},447:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"SmartLookupSelection",null,[])},458:function(J,aa,d){J=d(0);var h=d(387),e=d(14),r=d(27),n=d(179),v=d(75),
B=d(67),y=d(173),x=d(102),A=d(172);d(70);class E{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(J.a)(E,"MessageBarProps",null,[]);class u{constructor(Z,P){this.onExecute=this.label=this.type=null;this.label=Z;this.type="AppButtonProps";this.onExecute=P}}Object(J.a)(u,"AppButtonProps",
null,[]);var K=d(141),G=d(790),O=d(135),R=d(212),V=d(109),D=d(37);d.d(aa,"a",function(){return Q});class Q{constructor(Z,P,ca){this._message=this.aC=null;this.vEd=this.tnb=!1;this.lyd=0;this.Bha="";this.qS=0;this.dF=this.cS=this.Rpa=this.l7=this.Y3a=this.MQb=this.LQb=this.KQb=this.JQb=this.lN=this.V6=this.dra=this.QNa=null;this.lnb=this.knb=!1;this.k9e=this.Dyd="";this.Byd=!1;this.l9e=this.Hyd="";this.Fyd=!1;this.Gyd=this.Cyd=null;this.DUb=!1;this.lif=this.fpb="";this.X3a=null;this.LTb=this.Yef=!1;
this.BCa=this.e3=this.Cda=this.zP=this.businessBar=null;this.errorCode=0;this.Lwf=this.visible=!1;this.title=Z;this.message=P;this.t9b=ca;this.id=0;this.image=1;this.w_c=!0;this.Uzf=5}get htmlElement(){return this.zP}get w_c(){return this.vEd}set w_c(Z){this.vEd=Z}get Uzf(){return this.lyd}set Uzf(Z){this.lyd=Z}get title(){return this.aC}set title(Z){this.aC!==Z&&(this.aC=Z,this.dra&&(this.dra.innerText=this.aC))}get message(){return this._message}set message(Z){this._message!==Z&&(this._message=
Z,this.V6&&(this.V6.innerText=this._message))}get image(){return this.qS}set image(Z){this.qS=Z;4!==this.qS&&(this.Cda="")}get OEa(){return this.Bha}set OEa(Z){this.Bha=Z}get closeable(){return this.tnb}set closeable(Z){this.tnb!==Z&&(this.tnb=Z,this.Rpa&&(this.Rpa.style.display=this.tnb?"table-cell":"none"))}get goc(){return r.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get DJl(){return r.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(Z,P,ca,T=!1){this.Dyd=Z;this.Cyd=
P;this.knb=!0;this.k9e=ca;this.Byd=T}vPd(Z,P){this.Hyd=Z;this.Gyd=P;this.lnb=!0;this.l9e="";this.Fyd=!1}Ftf(Z,P){this.fpb=Z;this.X3a=P;this.DUb=!0}fHi(){var Z=R.a.I3(r.AFrameworkApplication.fa.Ga("VNextStyleOptOutCookieName"),!1);Z=this.DJl&&!Z;this.zP=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",Q.j9e,Q.m_h,Z?Q.k4h:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.BCa&&null!==this.BCa&&(this.htmlElement.id=this.BCa);Z=()=>{K.UISurfaces.Zdj().then(P=>
{this.businessBar.Rle||(P.initializeMessageBarInStore(),this.businessBar.Rle=!0);const ca=Object.assign(new E,{message:this._message,messageTitle:this.aC,isMultiline:this.vEd,messageBarType:this.lyd});if(this.tnb){ca.closeable=!0;var T=this._message+". "+CommonUIStrings.l_DialogClose;this.aC&&(T=this.aC+". "+T);ca.dismissButtonAriaLabel=T;ca.onDismiss=()=>{this.lWd(this)}}4===this.qS&&(ca.messageBarIconProps={["iconName"]:this.Cda});this.DUb&&(ca.linkProps={["type"]:"AppLinkProps",["text"]:this.fpb,
["handler"]:{["href"]:this.lif,["target"]:"_blank"}},this.X3a&&(T=Object(e.a)(this,this.wwk,"onMessageBarLinkClicked"),ca.linkProps.handler=T));this.knb&&(ca.firstActionButtonProps=new u(this.Dyd,()=>{this.Umi(this)}));this.lnb&&(ca.secondActionButtonProps=new u(this.Hyd,()=>{this.Wmi(this)}));P.createNewMessageBarWithCallback?P.createNewMessageBarWithCallback(this.htmlElement,ca,()=>{r.AFrameworkApplication.Aa.Oq()}):P.createNewMessageBar(this.htmlElement,ca);return null}).catch(()=>{h.ULS.sendTraceTag(595096981,
324,10,"Failed to load React Message Bar API");return null})};n.a.get_instance().isCompleted(7)?Z():n.a.get_instance().Uj(7,Z);this.t9b&&(r.AFrameworkApplication.Aa.Ly.pb(B.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),r.AFrameworkApplication.Aa.pG.OU(B.a.Il,this.htmlElement,Object(e.a)(this,this.oHe,"onBodyKeyUp"),this),this.Yef&&!this.LTb&&(r.AFrameworkApplication.Aa.Qaa.pb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.LTb=!0));return this.htmlElement}createElement(){r.AFrameworkApplication.LL("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");
if(this.goc)return this.fHi();this.zP=document.createElement("div");this.htmlElement.className=Q.j9e;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.BCa&&null!==this.BCa&&(this.htmlElement.id=this.BCa);this.QNa=null;if(0!==this.qS){this.QNa=document.createElement("span");this.QNa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.QNa);var Z=null;let P=null;switch(this.qS){case 2:Z=Q.$Rh;P=CommonUIStrings.l_DialogError;break;case 1:Z=Q.w4h;P=CommonUIStrings.l_DialogWarning;
break;case 3:Z=Q.hUh;P=CommonUIStrings.l_DialogInfo;break;case 4:Z=this.Cda,P=this.Bha}this.QNa.title=P;this.QNa.setAttribute(O.a.af,O.a.Ryf);this.QNa.appendChild(v.createClusteredImage(24,24,Z,Q.YTh,!0,""))}Z=V.a.create().toString();this.lN=document.createElement("div");this.lN.id="BBTitleAndBody"+Z;this.lN.className=Q.hPh;this.lN.tabIndex=0;this.aC&&(this.dra=document.createElement("p"),this.dra.innerText=this.aC,this.dra.className=Q.iPh+" UIFontBold",this.dra.id="BBTitle"+Z,this.dra.setAttribute("UNSELECTABLE",
"on"),this.lN.setAttribute(O.a.U2,this.dra.id),this.lN.appendChild(this.dra));this.V6=document.createElement("p");this.V6.className=Q.cPh;this.V6.innerText=this._message;this.V6.id="BBBody"+Z;this.V6.setAttribute("UNSELECTABLE","on");this.V6.style.width="100%";this.lN.setAttribute(O.a.Jra,this.V6.id);this.knb&&this.Ssf(this.V6,this.k9e);this.lnb&&this.Ssf(this.V6,this.l9e);this.lN.appendChild(this.V6);Z=document.createElement("div");Z.setAttribute(O.a.af,O.a.cSd);Z.appendChild(this.lN);this.htmlElement.appendChild(Z);
this.knb&&(this.KQb=document.createElement("span"),this.JQb=document.createElement("button"),this.mKf(this.KQb,this.JQb,this.Dyd,Object(e.a)(this,this.RBf,"buttonOneClickHandler")));this.lnb&&(this.MQb=document.createElement("span"),this.LQb=document.createElement("button"),this.mKf(this.MQb,this.LQb,this.Hyd,Object(e.a)(this,this.SBf,"buttonTwoClickHandler")));this.DUb&&(this.Y3a=document.createElement("span"),this.Y3a.className=Q.gPh,this.l7=document.createElement("a"),this.l7.className=G.a.fPh,
this.l7.innerText=this.fpb,this.X3a?(this.l7.tabIndex=0,r.AFrameworkApplication.Aa.Ly.OU(B.a.click,this.l7,Object(e.a)(this,this.lqg,"linkClickHandler"),this),r.AFrameworkApplication.Aa.pG.OU(B.a.Il,this.l7,Object(e.a)(this,this.f5g,"onLinkKeyUp"),this)):(this.l7.href=this.lif,this.l7.target="_blank"),this.Y3a.appendChild(this.l7),this.htmlElement.appendChild(this.Y3a));r.AFrameworkApplication.Aa.Ly.pb(B.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));r.AFrameworkApplication.Aa.pG.OU(B.a.Il,
this.lN,Object(e.a)(this,this.oHe,"onBodyKeyUp"),this);this.Yef&&!this.LTb&&(r.AFrameworkApplication.Aa.Qaa.pb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.LTb=!0);this.tnb&&(this.Rpa=document.createElement("span"),this.Rpa.className=Q.LPh,this.cS=document.createElement("a"),this.cS.className=Q.MPh,this.cS.tabIndex=0,this.cS.title=CommonUIStrings.l_DialogClose,this.cS.setAttribute(O.a.af,O.a.Au),this.dF=v.createClusteredImage(16,16,Q.NPh,"",!0,""),this.cS.appendChild(this.dF),
this.Rpa.style.display="table-cell",this.Rpa.appendChild(this.cS),this.htmlElement.appendChild(this.Rpa),r.AFrameworkApplication.Aa.Ly.OU(B.a.click,this.cS,Object(e.a)(this,this.j3g,"onCloseClick"),this),r.AFrameworkApplication.Aa.pG.OU(B.a.Il,this.cS,Object(e.a)(this,this.k3g,"onCloseKeyUp"),this));return this.htmlElement}qml(){this.lN&&this.lN.setAttribute(O.a.SK,O.a.Nia)}Ssf(Z,P){if(P&&""!==P){var ca=document.createElement("span");ca.className=Q.o0h;ca.innerText=P;Z.appendChild(ca)}}mKf(Z,P,ca,
T){Z.className=Q.ePh;P.setAttribute("type","button");P.className=Q.dPh;P.innerText=ca;Z.appendChild(P);this.htmlElement.appendChild(Z);r.AFrameworkApplication.Aa.Ly.OU(B.a.click,P,T,this)}dmh(){this.goc||(this.lN.style.whiteSpace="nowrap",this.closeable?this.Rpa.style.width="auto":this.DUb?this.Y3a.style.width="auto":this.lnb?this.MQb.style.width="auto":this.knb?this.KQb.style.width="auto":this.lN.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.lN.style.whiteSpace=
"normal":this.closeable?this.Rpa.style.width="100%":this.DUb?this.Y3a.style.width="100%":this.lnb?this.MQb.style.width="100%":this.knb?this.KQb.style.width="100%":this.lN.style.width="100%")}A4e(Z,P){if(A.a.dHb()){var ca={};ca.WacSessionId=r.AFrameworkApplication.userSessionId;ca.ActionName="BusinessBar"+Z;ca.InputMethod=P;h.ULS.sendTraceTag(35489761,207,50,JSON.stringify(ca))}}pX(Z,P,ca,T){this.A4e(Z,ca);A.a.nVa()&&x.c(P,!0,x.e,T,10)}RBf(Z){this.Cyd(Z.rD);this.pX("ButtonOne",D.a.LBf,"Mouse",2);this.Byd&&
(this.pX("Close",D.a.Ksb,"Mouse_ButtonOne",2),this.close(Z));return!0}Umi(Z){this.Cyd(Z);this.pX("ButtonOne",D.a.LBf,"Mouse",2);this.Byd&&(this.pX("Close",D.a.Ksb,"Mouse_ButtonOne",2),this.lWd(Z))}SBf(Z){this.Gyd(Z.rD);this.pX("ButtonTwo",D.a.MBf,"Mouse",2);this.Fyd&&(this.pX("Close",D.a.Ksb,"Mouse_ButtonTwo",2),this.close(Z));return!0}Wmi(Z){this.Gyd(Z);this.pX("ButtonTwo",D.a.MBf,"Mouse",2);this.Fyd&&(this.pX("Close",D.a.Ksb,"Mouse_ButtonTwo",2),this.lWd(Z))}lqg(Z){this.X3a(Z.rD);this.pX("Link",
D.a.PBf,"Mouse",2);return!0}wwk(){this.X3a(null)}f5g(Z){return Z.qc.keyCode!==y.a.tq||Z.qc.altKey?!1:(this.X3a(Z.rD),this.pX("Link",D.a.PBf,"Keyboard",1),!0)}oHe(Z){return Z.qc.keyCode===y.a.tq&&!Z.qc.altKey&&this.t9b?(this.t9b(Z.rD,Z),this.pX("Invoke",D.a.OBf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(r.AFrameworkApplication.Aa.Ly.yb(B.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),this.LTb&&r.AFrameworkApplication.Aa.Qaa.yb(this.htmlElement,Object(e.a)(this,this.onClick,
"onClick")));this.cS&&(r.AFrameworkApplication.Aa.Ly.yb(B.a.click,this.cS,Object(e.a)(this,this.j3g,"onCloseClick")),r.AFrameworkApplication.Aa.pG.yb(B.a.Il,this.cS,Object(e.a)(this,this.k3g,"onCloseKeyUp")));this.JQb&&r.AFrameworkApplication.Aa.Ly.yb(B.a.click,this.JQb,Object(e.a)(this,this.RBf,"buttonOneClickHandler"));this.LQb&&r.AFrameworkApplication.Aa.Ly.yb(B.a.click,this.LQb,Object(e.a)(this,this.SBf,"buttonTwoClickHandler"));this.l7&&this.X3a&&(r.AFrameworkApplication.Aa.Ly.yb(B.a.click,this.l7,
Object(e.a)(this,this.lqg,"linkClickHandler")),r.AFrameworkApplication.Aa.pG.yb(B.a.Il,this.l7,Object(e.a)(this,this.f5g,"onLinkKeyUp")));this.lN&&r.AFrameworkApplication.Aa.pG.yb(B.a.Il,this.lN,Object(e.a)(this,this.oHe,"onBodyKeyUp"));this.businessBar=this.cS=this.Rpa=this.dF=this.Y3a=this.l7=this.MQb=this.LQb=this.KQb=this.JQb=this.lN=this.V6=this.zP=this.dra=this.QNa=this.Bha=null}onClick(Z){this.pX("Invoke",D.a.OBf,"Mouse",2);return!!this.t9b&&this.t9b(this,Z)}j3g(Z){this.pX("Close",D.a.Ksb,
"Mouse",2);this.close(Z);return!0}k3g(Z){return Z.qc.keyCode!==y.a.tq||Z.qc.altKey?!1:(this.pX("Close",D.a.Ksb,"Keyboard",1),this.close(Z),!0)}close(Z){const P=Z.rD;this.businessBar.removeEntry(P);this.Igg(P,Z.Wf)}Igg(Z,P){if(Z.e3){const ca=r.AFrameworkApplication.Ta;ca.xq=10;ca.vT=P;Z.e3(Z);ca.xq=0;ca.vT=0}}lWd(Z){Z&&this.businessBar&&(this.businessBar.removeEntry(Z),this.Igg(Z,0))}}Q.j9e="WACBusinessBarEntry";Q.iPh="WACBusinessBarTitle";Q.cPh="WACBusinessBarBody";Q.hPh="WACBusinessBarTitleBodyHolder";
Q.ePh="WACBusinessBarButtonHolder";Q.dPh="WACBusinessBarButton";Q.gPh="WACBusinessBarLinkHolder";Q.MPh="WACBusinessBarClose";Q.LPh="WACBusinessBarCloseHolder";Q.NPh="BusinessBarClose_16x16x32";Q.YTh="WACBusinessBarImage";Q.o0h="WACScreenReaderOnly";Q.$Rh="CancelRequest_24x24x32";Q.w4h="Risks_24x24x32";Q.hUh="Info_24x24x32";Q.m_h="ReactBusinessBarEntry";Q.k4h="VNextBusinessBarEntry";Object(J.a)(Q,"BusinessBarEntry",null,[286,106])},518:function(J,aa,d){d.d(aa,"a",function(){return n});J=d(0);var h=
d(65),e=d(519),r=d(914);class n{D0b(v,B){if(1===v.nodeType&&B){var y=this.NW(B);v=this.XWf(v,y);this.Ewi(y,v,B)}}XWf(v,B){const {CombineHelper:y}=d(1155),x=[];let A=null;for(let u=0;u<v.childNodes.length;u++){var E=v.childNodes[u];3===E.nodeType?(A||(A=new y(v,u,B)),A.$8h(u)):(A&&(A.end(x,u-1),A=null),E=this.XWf(E,B),Array.addRange(x,E))}A&&A.end(x,v.childNodes.length-1);return x}Ewi(v,B,y){v=v.clone();let x=!1;for(let A=B.length-1;0<=A;A--){const E=B[A].Dwi();x=v.merge(E)||x}x&&this.setSelection(v,
y)}setSelection(v,B){B=h.a.aEa(B);B.setStart(v.start.element,v.start.offset);B.setEnd(v.end.element,v.end.offset)}NW(v){return(v=h.a.aEa(v))?Object.assign(new r.a,{start:Object.assign(new e.a,{element:v.startContainer,offset:v.startOffset}),end:Object.assign(new e.a,{element:v.endContainer,offset:v.endOffset})}):new r.a}}n.unused=-1;Object(J.a)(n,"TextNodeCombiner",null,[1414])},519:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new h,
{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(J.a)(h,"SelectionSide",null,[])},520:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);aa=d(320);var h=d(143);class e extends aa.a{constructor(){super();this.items=this.parentRevId=this.parentPath=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}}
Object(J.a)(e,"Operation",aa.a,[])},521:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]="word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(h||(h={}));Object(J.b)("AppMode",h)},522:function(J,aa,d){d.d(aa,"a",function(){return e});d.d(aa,"b",function(){return r});d.d(aa,"c",function(){return n});const h=v=>{switch(v){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;
default:return 0}},e=v=>h(n(v.Priority,v.Tag)),r=v=>n(v.Priority,v.Tag),n=(v,B)=>{switch(v){case 0:return 1;case 1:return 2;case 2:return B&1?5:3;case 3:return 4;default:return 0}}},523:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(J.a)(h,"ProofingTraceMetrics",null,[])},524:function(J,aa,d){d.d(aa,"a",function(){return r});d.d(aa,"b",function(){return n});d.d(aa,"c",function(){return v});var h=
d(27),e=d(525);const r=()=>{const B=h.AFrameworkApplication.Aa.hb.Uk;return(3===B||1===B||2===B||4===B)&&h.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},n=(B,y,x,A=!1)=>{y=1===y;1===B&&(y=2===h.AFrameworkApplication.Aa.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[B],y?"Editor":"Viewer",A?"Dime":"Unknown",x?x:"dimedefault")},v=B=>{switch(B){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";
default:return null}}},525:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(h||(h={}));Object(J.b)("OfficeAppType",h)},526:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.yzf="AugEditorServiceTileCheckRequest";h.zzf="AugEditorServiceTileCheckResponse";h.lRi="EditorServiceTileCheckRequest";h.YGf="Proofing.ProofingRequest";
h.nWd="Proofing.ProofingResponse";Object(J.a)(h,"ProofingAugmentationSchemaNames",null,[])},527:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.slideId=null;this.rch=this.bsc=0}}Object(J.a)(h,"SlidePresenceInfo",null,[])},528:function(J,aa,d){d.d(aa,"a",function(){return n});J=d(0);var h=d(387),e=d(1066),r=d(36);class n{execute(v,B,y=null){h.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",v.Zk());const x=new e.a,A=this.y8(v,B,y);A.continueWith(()=>{if(A.rm)x.qG(A.$i);
else if(A.Vn)x.P1();else{const E=A.result;if(E&&!E.succeeded&&E.Yi&&E.Yi.data&&5===A.result.Yi.data.status){const u=this.y8(v,B,y);u.continueWith(()=>{u.rm?x.qG(u.$i):u.Vn?x.P1():x.eK(u.result)})}else x.eK(E)}});return x.task}y8(v,B,y){y=this.Yjj(y);return B(y,{"Content-Type":"application/json; charset=utf-8"},v.serialize())}Yjj(v){return v?String.format("{0}/{1}",v,"people.ashx"):"people.ashx"}static a8a(v){if(!v)return h.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),
null;try{return r.a(v)}catch(B){h.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",B.message)}return null}}Object(J.a)(n,"CommonHandlerRequestManager",null,[])},529:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(387);class e{equals(r,n){if(!r||!n)return!r&&!n;if(r.UserId!==n.UserId){if(!e.CQf(r.Provider)||!e.CQf(n.Provider))return!1;const B=r.UserId.startsWith(e.zYb);var v=n.UserId.startsWith(e.zYb);if(B&&v){if(r.Provider!==n.Provider)return h.ULS.sendTraceTag(593368202,
327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",r.Provider,n.Provider),!1;v=e.RUf(r.UserId);n=e.RUf(n.UserId);return!!v&&v===n}r=r.Email&&""!==r.Email?r.Email:B?e.L8a(r.UserId):r.UserId;n=n.Email&&""!==n.Email?n.Email:v?e.L8a(n.UserId):n.UserId;return!!r&&r===n}return r.Provider!==n.Provider?!1:r.Provider&&""!==r.Provider||r.UserId&&""!==r.UserId?!0:r.DisplayName===n.DisplayName}PW(){return 0}static CQf(r){return"O365"===r||"AD"===r}static L8a(r){if(!r.startsWith(e.zYb))return null;
r=r.substr(e.zYb.length);const n=r.lastIndexOf("::");return-1===n?null:r.substr(0,n)}static RUf(r){if(!r.startsWith(e.zYb))return null;var n=r.lastIndexOf("::");if(-1===n)return null;n+=2;return n>=r.length?null:r.substr(n)}}e.zYb="S::";Object(J.a)(e,"CommentTaskPersonIdentityComparer",null,[139])},530:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(J.a)(h,"CrossDocumentMessage",null,[])},
531:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(J.a)(h,"OtelTelemetryEvent",null,[])},532:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.type=null;this.type=e}}Object(J.a)(h,"CustomContentProps",null,[])},533:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=this.commandRevertId=
this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=e;this.commandId=r}}Object(J.a)(h,"CommandMetadata",null,[])},534:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(304);class h{}h.CommandValueId="CommandValueId";h.Description="Description";h.Image16by16Class=d.a.yyb;h.Image30by30Class=d.a.BCj;h.Image32by32Class=d.a.NEa;h.Image48by48Class=d.a.Pde;h.On="On";h.LabelText=d.a.labelText;h.Visible=d.a.visible;h.SourceControlId="SourceControlId";
h.DisplayMode="DisplayMode";h.Alt=d.a.alt;Object(J.a)(h,"ToggleButtonCommandProperties",null,[])},535:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.Iu="InputMethod";h.Haa="ShouldCanvasTakeFocus";h.Gud="UILocation";Object(J.a)(h,"ReactRibbonConstants",null,[])},536:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{static get instance(){const {NewCustomEventFactory:e}=d(1127),{IECustomEventFactory:r}=d(1128);h.Ka||(h.Ka="function"===typeof window.CustomEvent?new e:
new r);return h.Ka}}h.Ka=null;Object(J.a)(h,"CustomEventFactory",null,[])},537:function(J,aa,d){d.d(aa,"a",function(){return e});d.d(aa,"b",function(){return n});var h=d(8);d(1066);const e=B=>r(B),r=B=>new Promise((y,x)=>{B.continueWith(A=>{A.rm?x(A.$i.message):A.Vn?x(h.a.OLc()):y(null)})}),n=B=>v(B),v=B=>new Promise((y,x)=>{B.continueWith(()=>{B.rm?x(B.$i.message):B.Vn?x(h.a.OLc()):y(B.result)})})},538:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.themeColors="Theme Colors";
Object(J.a)(h,"ReactColorConstants",null,[])},539:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.other=0]="other";e[e.searchBoxSearch=1]="searchBoxSearch";e[e.searchBoxDictionary=2]="searchBoxDictionary";e[e.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";e[e.smartLookupRibbon=4]="smartLookupRibbon";e[e.smartLookupContextMenu=5]="smartLookupContextMenu";e[e.entity=6]="entity";e[e.dictionary=7]="dictionary";e[e.web=8]="web";e[e.pictures=9]="pictures";e[e.files=10]="files";
e[e.bookmarks=11]="bookmarks";e[e.help=12]="help";e[e.chartRecommendation=13]="chartRecommendation";e[e.linkSkill=14]="linkSkill";e[e.searchBoxFindInDocument=15]="searchBoxFindInDocument";e[e.searchBoxEntity=16]="searchBoxEntity";e[e.searchSkill=17]="searchSkill";e[e.controlF=18]="controlF";e[e.ribbonFindButton=19]="ribbonFindButton";e[e.reuseSlides=20]="reuseSlides";e[e.data=21]="data";e[e.contextMenuDictionary=22]="contextMenuDictionary";e[e.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";
e[e.contextMenuSynonyms=24]="contextMenuSynonyms";e[e.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";e[e.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";e[e.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";e[e.note=28]="note";e[e.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";e[e.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";e[e.dataDisambiguate=31]="dataDisambiguate";e[e.linkFiles=32]="linkFiles";e[e.searchBoxNoteL2=33]="searchBoxNoteL2";e[e.contextMenuLaunchL2Document=
34]="contextMenuLaunchL2Document";e[e.actionAI=35]="actionAI";e[e.pasteAsNewSlide=36]="pasteAsNewSlide";e[e.slidesCompression=37]="slidesCompression";e[e.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";e[e.powerPointCopilot=39]="powerPointCopilot";e[e.tellMeService=40]="tellMeService";e[e.prefetch=99]="prefetch"})(h||(h={}));Object(J.b)("EntryPoint",h)},546:function(J,aa,d){d.r(aa);J=d(0);var h=d(387),e=d(1225),r=d(680),n;(function(sa){sa[sa.external=0]="external";sa[sa.msa=1]="msa";sa[sa.aad=2]=
"aad"})(n||(n={}));Object(J.b)("AuthorityType",n);var v=d(382);class B{constructor(sa){this.HXh=sa}initialize(){return Promise.resolve(0)}n2c(){return Promise.resolve(0)}sV(){h.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new v.a,{IsSuccess:!0,Token:this.HXh}))}oud(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}tsd(){return!1}O6b(){return"MockAuthTokenStrategy"}}
Object(J.a)(B,"MockAuthTokenStrategy",null,[254]);var y=d(727);class x{static get(sa,Ba,pa){if(!pa)return sa;let ia=0;return Promise.race([sa,new Promise(Da=>{ia=window.setTimeout(()=>{Da(Ba)},pa)})]).then(Da=>{window.clearTimeout(ia);return Promise.resolve(Da)}).catch(()=>{window.clearTimeout(ia);return Promise.resolve(Ba)})}}Object(J.a)(x,"PromiseWithTimeout",null,[]);var A=d(27),E=d(226);class u{constructor(sa,Ba,pa,ia,Da){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=sa;this.scope=Ba;this.silentLogin=pa;this.options=ia;this.correlationId=Da}}Object(J.a)(u,"TokenRequestParameters",null,[272]);var K=d(55),G=d(57);class O{constructor(){this.Krf=null;let sa=A.AFrameworkApplication.fa.Ga(A.AFrameworkApplication.gK),Ba=A.AFrameworkApplication.fa.Ga(A.AFrameworkApplication.aGh);this.Cqb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",sa&&""!==sa?sa:"Unspecified",Ba&&""!==Ba?Ba:"Unspecified")}initialize(){return new Promise(sa=>
{G.a.instance.Ja("Common.App.WopiIdentity.IWopiIdentity").execute(Ba=>{this.Krf=Ba;sa(0)})})}Fc(sa){const Ba=["HTTPS:","API:"];let pa=!1;const ia=sa.toLocaleUpperCase();for(const Da of Ba)if(ia.startsWith(Da)){pa=!0;break}return pa||this.uPj(sa)?sa+"/.default":sa}uPj(sa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(sa)}n2c(){return Promise.resolve(0)}sV(sa,Ba,pa,ia,Da,Xa,Ka){if(K.a.OFa){Da=E.OAuthManagerSettings.aLl;if(!Da)return Ba=Object.assign(new v.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ba);if(!Array.contains(Da,sa))return Ba=Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+sa}),Promise.resolve(Ba)}sa=this.Fc(pa);pa=new u(pa,sa,!ia,null,A.AFrameworkApplication.userSessionId);return this.Krf.getAccessToken(pa,Ba,Ka).then(Ma=>Object.assign(new v.a,{IsSuccess:!0,Token:Ma.accessToken}),Ma=>Object.assign(new v.a,{IsSuccess:!1,ErrorCode:Ma}))}oud(){return Promise.resolve(Object.assign(new v.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}tsd(){return!1}O6b(){return this.Cqb}}Object(J.a)(O,"ParentFrameTokenStrategy",null,[254]);var R=d(14),V=d(458),D=d(18);class Q{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Cdh=this.Xzf=null}}Object(J.a)(Q,"PromiseWrapper",null,[]);class Z{constructor(sa=0){this.eN=0;this.MVb=!1;this.xu=new D.a;this._timeout=sa}enqueue(sa){return new Promise((Ba,
pa)=>{this.xu.add(Object.assign(new Q,{Cdh:sa,resolve:Ba,reject:pa}));this.process()})}process(){if(this.MVb||this.eN===this.xu.count)return!1;const sa=this.xu.ga(this.eN++);try{this.MVb=!0,sa.Cdh().then(Ba=>{this.MVb=!1;this.SWd(sa,Ba,null,!0)}).catch(Ba=>{this.MVb=!1;this.SWd(sa,null,Ba,!1)})}catch(Ba){this.MVb=!1,this.SWd(sa,null,Ba,!1)}return!0}SWd(sa,Ba,pa,ia){if(ia){const Da=()=>{sa.resolve(Ba);this.process()};0<this._timeout?window.setTimeout(()=>{Da()},this._timeout):Da()}else{const Da=()=>
{sa.reject(pa);this.process()};0<this._timeout?window.setTimeout(()=>{Da()},this._timeout):Da()}}}Object(J.a)(Z,"PromiseQueue",null,[]);class P{constructor(){this.correlationId=this.resolve=null}}Object(J.a)(P,"ResolveWithCorrelation",null,[]);var ca=d(1204),T=d(79),da=d(530),fa=d(127);class ma extends T.a{constructor(sa,Ba,pa,ia,Da,Xa){super(!1,!1,!0);this.zaf=this.kha=null;this.Xba=sa;this.KZh=pa;this.eF=ia;this.u3h=Da;this.I3a=Xa;this.JA=document.createElement("iframe");this.JA.id="SharedAuthInteractiveFrame";
this.JA.setAttribute("name","SharedAuthInteractiveFrame");this.JA.setAttribute("title","SharedAuthInteractiveFrame");this.JA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.JA.style.border="0";this.JA.style.height="48px";this.JA.style.width="190px";$addHandler(this.JA,"error",Object(R.a)(this,this.szk,"onSharedAuthFrameError"));sa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Xba,Ba,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",A.AFrameworkApplication.userType);this.JA.src=sa;this.gRh=new Promise(Ka=>{this.zaf=Ka});this.Aaf=!1}j6(){this.kha={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.KZh,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:A.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(R.a)(this,this.LEi,"createFrame"),["resolveDialogStyles"]:this.zaf}};this.yd=5;this.aj(CommonUIStrings.l_SignIn,Object(R.a)(this,this.Vhl,"sharedAuthConsentDialogHandler"),
this.kha)}zIh(sa=!1,Ba=5){this.kha&&this.kha.bodyControls&&(!0!==Object(ca.a)(Object,this.kha.bodyControls).frameLoaded&&(Object(ca.a)(Object,this.kha.bodyControls).frameLoaded=!0),sa!==Object(ca.a)(Object,this.kha.bodyControls).frameLoadSuccess&&(Object(ca.a)(Object,this.kha.bodyControls).frameLoadSuccess=sa),Ba!==this.kha.dialogButtonsOption&&(this.kha.dialogButtonsOption=null,this.yd=Ba),this.update(this.kha))}Ynl(sa,Ba){const pa=new da.a(fa.a.Zhl);pa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:A.AFrameworkApplication.isRtl,["messageCorrelationId"]:sa,["dialogStyles"]:Ba};this.eF.Ijb(pa,this.JA.contentWindow,this.Xba)}DYf(){this.zIh(!1,6)}get Sth(){return this.JA}get rNi(){return this.gRh.then(sa=>{this.Aaf=!0;return sa})}get sNi(){return this.Aaf}szk(){this.DYf()}LEi(){return this.JA}Vhl(sa){0===sa&&(this.u3h.reject(Object.assign(new v.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.I3a(null))}}
Object(J.a)(ma,"SharedAuthConsentDialog",T.a,[280]);var ea=d(671),ra=d(96),F=d(222),na=d(65),ka=d(109),Ua=d(89);class za{constructor(){this.JA=null;this.Hzc=0;this.lpb=this.Vqb=this.dyd=this.I3a=this.FZ=this.Jqf=null;this.eF=new ea.a(null,null);this.Cqb="SharedAuthTokenStrategy Unloaded";this.Xba=E.OAuthManagerSettings.Xhl;this.Tof=E.OAuthManagerSettings.Whl;this.Cbf=E.OAuthManagerSettings.enableConsoleLogging;this.RRh=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.K1h=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.OOa={};this.rUh=new Z(1500)}O6b(){return this.Cqb}initialize(){var {OAuthManager:sa}=d(546);if("loadFrame"in this.OOa)return this.OOa.loadFrame.Xzf;if(!this.Xba)return ra.Health.instance.recordKpiFailure(sa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);
sa=this.csd("loadFrame");this.Hzc=na.a.vj();var Ba=this.Xba+this.Tof+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+A.AFrameworkApplication.userSessionId+"&WacUserType="+A.AFrameworkApplication.userType;this.JA=document.createElement("iframe");this.CXc(this.JA);this.JA.style.cssText="height:0;width:0;display:none;";this.JA.id="SharedAuthFrame";this.JA.setAttribute("name","SharedAuthFrame");this.JA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.JA.setAttribute("title","SharedAuthFrame");this.JA.src=Ba;document.body.appendChild(this.JA);Ba=na.a.vj()-this.Hzc;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Ba,this.JA.src);return sa}n2c(sa){this.dyd=sa;const Ba=new da.a(fa.a.Vth);Ba.Values=this.Bzf(sa);sa=this.csd("initFrame");this.eF.Ijb(Ba,this.JA.contentWindow,this.Xba);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");
return sa}sV(sa,Ba,pa,ia,Da,Xa){const Ka=new da.a(fa.a.$hl),Ma=this.z6f();Ka.Values=this.REh(sa,Ba,pa,ia,Da,Xa,Ma);sa=this.csd(Ma);ia&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.rUh.enqueue(()=>new Promise(Oa=>{this.UAl(Xa,Ka,Oa,Ma)})):(this.eF.Ijb(Ka,this.JA.contentWindow,this.Xba),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ba));return sa}UAl(sa,Ba,pa,ia){const Da=
this.OOa[ia];Da&&(this.Vqb=Ba,this.I3a=Object.assign(new P,{resolve:pa,correlationId:ia}),this.FZ=new ma(this.Xba,this.Tof,sa,this.eF,Da,pa),this.FZ.j6())}z6f(){return ka.a.create().toString()}REh(sa,Ba,pa,ia,Da,Xa,Ka){const Ma={};Ma.appName=sa;Ma.appId=Ba;Ma.target=pa;Ma.withPopup=ia;Ma.claims=Da;Ma.promptMessage=Xa;Ma.messageCorrelationId=Ka;return Ma}CXc(sa){$addHandler(sa,"load",Object(R.a)(this,this.Cvk,"onIFrameLoaded"));$addHandler(sa,"error",Object(R.a)(this,this.sIe,"onIFrameError"));this.eF.LBa(this.Xba);
this.eF.yu(fa.a.Yth);this.eF.KB(fa.a.Yth,Object(R.a)(this,this.Oyk,"onScriptLoaded"));this.eF.yu(fa.a.Xth);this.eF.KB(fa.a.Xth,Object(R.a)(this,this.Nyk,"onScriptInitialized"));this.eF.yu(fa.a.Tth);this.eF.KB(fa.a.Tth,Object(R.a)(this,this.jvk,"onGetTokenResponse"));this.eF.yu(fa.a.Zth);this.eF.KB(fa.a.Zth,Object(R.a)(this,this.qwk,"onLoginResponse"));this.eF.yu(fa.a.Wth);this.eF.KB(fa.a.Wth,Object(R.a)(this,this.Qvk,"onInteractiveFlowReady"));this.eF.yu(fa.a.Uth);this.eF.KB(fa.a.Uth,Object(R.a)(this,
this.yvk,"onHideDialog"));this.eF.yu(fa.a.Rth);this.eF.KB(fa.a.Rth,Object(R.a)(this,this.etk,"onCloseDialog"))}csd(sa){const Ba=new Q;Ba.startTime=na.a.vj();const pa=new Promise((ia,Da)=>{Ba.resolve=ia;Ba.reject=Da});Ba.Xzf=pa;this.OOa[sa]=Ba;return pa}Cvk(){const sa=na.a.vj()-this.Hzc;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",sa)}sIe(sa){const {OAuthManager:Ba}=d(546),pa=na.a.vj()-this.Hzc,ia=Object.assign(new Ua.a,{durationMs:pa});ra.Health.instance.recordKpiFailure(Ba.kpiName,
"SharedAuthWACOAuthAspxFrameError",!1,!0,ia);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",pa,this.Cbf?JSON.stringify(sa):"")}Oyk(sa){const {OAuthManager:Ba}=d(546),pa=this.OOa.loadFrame;var ia=na.a.vj()-pa.startTime,Da=sa.Values.AuthLibrary.toString();sa=sa.Values.Success.toString();h.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",sa,Da,ia);Da&&(this.Cqb="SharedAuthTokenStrategy "+Da);
Da=Boolean.parse(sa);Da||(sa=F.a.Uz(),void 0!==sa&&null!==sa&&(sa.set("AuthLibrary",this.O6b()),ia=Object.assign(new Ua.a,{durationMs:ia,extendedProperties:sa}),ra.Health.instance.recordKpiFailure(Ba.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ia)));pa.resolve(Da?0:1)}Nyk(sa){if(sa.Values.interactive&&this.Vqb&&this.Vqb.Values.messageCorrelationId){const pa=this.Vqb.Values.messageCorrelationId.toString();if(sa.Values.interactive&&this.FZ){this.FZ.rNi.then(ia=>{this.eF.Ijb(this.Vqb,this.FZ.Sth.contentWindow,
this.Xba);this.FZ.Ynl(pa,ia);this.FZ.zIh(!0);this.Vqb=null});return}}sa=this.OOa.initFrame;const Ba=na.a.vj()-sa.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ba);sa.resolve(0)}jvk(sa){if(sa.Values.messageCorrelationId&&sa.Values.messageCorrelationId.toString()){var Ba=sa.Values.messageCorrelationId.toString(),pa=this.OOa[Ba];if(pa){var ia=na.a.vj()-pa.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
ia);sa.Values.isSuccess&&sa.Values.isSuccess?pa.resolve(sa.Values.response):pa.reject(sa.Values.response);this.vFh(Ba)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Qvk(){if(this.FZ.sNi)this.FZ.DYf();else if(this.dyd&&this.FZ){const sa=new da.a(fa.a.Vth);sa.Values=this.Bzf(this.dyd,
!0);this.eF.Ijb(sa,this.FZ.Sth.contentWindow,this.Xba)}}yvk(){this.FZ&&this.FZ.gde()}etk(sa){sa.Values.cancelled&&sa.Values.cancelled&&sa.Values.messageCorrelationId&&this.vFh(sa.Values.messageCorrelationId.toString());this.FZ&&this.FZ.hide()}Bzf(sa,Ba=!1){const pa={};pa.appIds=this.F4i();pa.upn=sa.loginHint;pa.authority=sa.authority;pa.authorityType=Object(e.a)(n,sa.authorityType);pa.tenantId=sa.tenantId;pa.correlationId=A.AFrameworkApplication.userSessionId;pa.enableConsoleLogging=this.Cbf;pa.enablePopupFlash=
this.RRh;pa.skipUpnCheck=this.K1h;pa.interactive=Ba;return pa}F4i(){const sa=[],Ba=E.OAuthManagerSettings.dRd;for(let pa in Ba)Array.add(sa,Ba[pa]);return sa}oud(sa,Ba,pa,ia,Da,Xa){const Ka=new da.a(fa.a.Yhl),Ma=this.z6f();Ka.Values=this.REh(sa,Ba,pa,ia,Da,Xa,Ma);this.Jqf=Ka;sa=this.csd(Ma);h.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ba);this.Nll();return sa}tsd(){return!0}Nll(){this.lpb||(this.lpb=new V.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.lpb.id=16,this.lpb.w_c=!1,this.lpb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.eF.Ijb(this.Jqf,this.JA.contentWindow,this.Xba)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),A.AFrameworkApplication.Aa.hb.pGc(this.lpb,!0)||h.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}qwk(sa){if(sa.Values.messageCorrelationId&&
sa.Values.messageCorrelationId.toString()){var Ba=this.OOa[sa.Values.messageCorrelationId.toString()];if(Ba){var pa=na.a.vj()-Ba.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",pa);sa.Values.isSuccess&&sa.Values.isSuccess?Ba.resolve(sa.Values.response):Ba.reject(sa.Values.response)}else h.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}vFh(sa){this.I3a&&this.I3a.correlationId===sa&&(this.I3a.resolve(null),this.I3a=null)}}Object(J.a)(za,"SharedAuthTokenStrategy",null,[254]);class ha{constructor(sa){this.EJd=sa;this.Cqb="UnsupportedAuthTokenStrategy Reason="+r.a[this.EJd]}initialize(){return Promise.resolve(0)}n2c(){return Promise.resolve(0)}sV(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:r.a[this.EJd],ErrorMessage:"Unable to get a token. Reason: ["+
r.a[this.EJd]+"]"}))}oud(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}tsd(){return!1}O6b(){return this.Cqb}}Object(J.a)(ha,"UnsupportedAuthTokenStrategy",null,[254]);var ua=d(210);d.d(aa,"OAuthManager",function(){return Ga});class Ga{constructor(sa=null){this.U6=0;this.g2=null;this.O4a=0;const Ba=na.a.vj();this.iUh=this.QMi(sa).then(pa=>
pa?this.bEj():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(na.a.vj()-Ba)),pa=F.a.Uz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Ua.a,{durationMs:Math.floor(na.a.vj()-Ba),extendedProperties:pa}),ra.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyPickFailed",!1,!0,pa)),Promise.resolve(1))).then(pa=>0!==pa?Promise.resolve(pa):this.a1j())}RMi(){var sa=E.OAuthManagerSettings.Snk;
sa&&0<sa.length?(this.U6=1,this.g2=new B(sa)):A.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||A.AFrameworkApplication.fa.ka("IsO365CommercialHost")?A.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.U6=2,this.g2=new ha(this.U6)):(sa=y.a.getAuthContext().loginHint)&&sa.length?E.OAuthManagerSettings.Y$a?(this.U6=1,this.g2=new O):(this.U6=1,this.g2=new za):(this.U6=3,this.g2=new ha(this.U6)):(this.U6=4,this.g2=new ha(this.U6))}WD(){return this.g2?this.g2.O6b()||"Unknown":"None"}QMi(sa=null){h.ULS.sendTraceTag(562128578,
3E3,50,"Creating OAuthManager.");const Ba=na.a.vj();return A.AFrameworkApplication.fa.Baj().then(pa=>{pa?(this.RMi(),sa&&(this.g2=sa),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",E.OAuthManagerSettings.clientVersion,E.OAuthManagerSettings.appVersion,E.OAuthManagerSettings.DPi,this.WD(),Math.floor(na.a.vj()-Ba))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(na.a.vj()-Ba));return Promise.resolve(pa)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(na.a.vj()-Ba));return Promise.resolve(!1)})}bEj(){h.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.WD());const sa=na.a.vj();return x.get(this.g2.initialize(),2,E.OAuthManagerSettings.HNe).then(Ba=>{if(0===Ba)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.WD(),Math.floor(na.a.vj()-sa));else if(1===Ba){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(na.a.vj()-sa));var pa=F.a.Uz();void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Ua.a,{durationMs:Math.floor(na.a.vj()-sa),extendedProperties:pa}),ra.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyInitFailed",!1,!0,pa))}else 2===Ba&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.WD(),Math.floor(na.a.vj()-sa)),pa=F.a.Uz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Ua.a,{durationMs:Math.floor(na.a.vj()-sa),extendedProperties:pa}),ra.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyInitTimedOut",!1,!0,pa)));return Promise.resolve(Ba)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(na.a.vj()-sa));return Promise.resolve(1)})}a1j(){h.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.WD());const sa=na.a.vj();return x.get(this.g2.n2c(y.a.getAuthContext()),2,E.OAuthManagerSettings.HNe).then(Ba=>{if(0===Ba)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.WD(),Math.floor(na.a.vj()-sa));else if(1===Ba){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(na.a.vj()-sa));var pa=F.a.Uz();void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Ua.a,
{durationMs:Math.floor(na.a.vj()-sa),extendedProperties:pa}),ra.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyLoadFailed",!1,!0,pa))}else 2===Ba&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(na.a.vj()-sa)),pa=F.a.Uz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Ua.a,{durationMs:Math.floor(na.a.vj()-sa),extendedProperties:pa}),ra.Health.instance.recordKpiFailure(Ga.kpiName,
"StrategyLoadTimedOut",!1,!0,pa)));return Promise.resolve(Ba)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(na.a.vj()-sa));return Promise.resolve(1)})}sV(sa,Ba,pa=null){return this.$Ob(sa,Ba,!1,null,"",pa)}SEh(sa,Ba,pa,ia,Da=null){return this.$Ob(sa,Ba,!0,pa,ia,Da)}$Ob(sa,Ba,pa,ia,Da,Xa,Ka=0){Ka+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
sa,this.wjb(sa,Ba),this.WD(),Ka);var Ma=F.a.Uz();void 0!==Ma&&null!==Ma&&(Ma.set("AuthLibrary",this.WD()),Ma.set("AppName",sa),Ma.set("Target",this.wjb(sa,Ba)),ra.Health.instance.recordKpiUsage(Ga.kpiName,0,"WacOAuthFC",Ma));if(!E.OAuthManagerSettings.isEnabled){var Oa;return this.Uoe((Oa=new v.a,Oa.IsSuccess=!1,Oa.Token=null,Oa.ErrorCode="NotEnabled",Oa.ErrorMessage="OAuthManager is disabled.",Oa),sa)}const qa=E.OAuthManagerSettings.dRd[sa];if(void 0===qa||null===qa){h.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",sa);var Ya;return this.Uoe((Ya=new v.a,Ya.IsSuccess=!1,Ya.Token=null,Ya.ErrorCode="DisallowedApp",Ya.ErrorMessage="Disallowed appName: "+sa,Ya),sa)}const Fb=na.a.vj(),hc=this;Ma=this.iUh.then(zb=>hc.DJj(sa,qa,Ba,pa,ia,Da,Xa,zb));Oa=pa?0:E.OAuthManagerSettings.HNe;let ec;Ya=(ec=new v.a,ec.IsSuccess=!1,ec.Token=null,ec.ErrorCode="authTokenStrategy_timeout",ec.ErrorMessage="Auth Strategy timed out after ["+
Oa+"] ms when fetching token",ec);let Tb=this,vb=this;return x.get(Ma,Ya,Oa).then(zb=>Ka<=Ga.Cmk&&(zb.ErrorCode===Ga.YCh||zb.ErrorCode===Ga.Nsl)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ka,Math.floor(na.a.vj()-Fb)),Tb.$Ob(sa,Ba,pa,ia,Da,Xa,Ka)):zb.ErrorCode===Ga.Tog&&!pa&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ka,Ga.dSf),Ga.QRi&&Tb.g2.tsd()&&Tb.g2.oud(sa,qa,Ba,
pa,ia,Da).then(Xb=>Promise.resolve(Tb.D2c(Xb,sa,Ba,qa,Fb))).catch(()=>{let Xb;const Za=(Xb=new v.a,Xb.IsSuccess=!1,Xb.Token=null,Xb.ErrorCode="authTokenStrategy_failure",Xb.ErrorMessage="LoginPopup failed, GetToken could not be called",Xb);return Promise.resolve(Tb.D2c(Za,sa,Ba,qa,Fb))}),Ga.dSf)?Tb.$Ob(sa,Ba,!0,ia,Da,Xa,Ka):Promise.resolve(Tb.D2c(zb,sa,Ba,qa,Fb))).catch(()=>{let zb;const Xb=(zb=new v.a,zb.IsSuccess=!1,zb.Token=null,zb.ErrorCode="authTokenStrategy_failure",zb.ErrorMessage="Auth Strategy failed with an unknown error",
zb);return Promise.resolve(vb.D2c(Xb,sa,Ba,qa,Fb))})}DJj(sa,Ba,pa,ia,Da,Xa,Ka,Ma){return 1===Ma||2===Ma?this.Uoe(Object.assign(new v.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ma?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),sa):this.g2.sV(sa,Ba,pa,ia,Da,Xa,Ka).then(Oa=>Promise.resolve(this.S0g(Oa,!0,sa))).catch(Oa=>Promise.resolve(this.S0g(Oa,!1,sa)))}D2c(sa,Ba,pa,ia,Da){const Xa={};Da=na.a.vj()-Da;Xa.IsSuccess=sa.IsSuccess;Xa.ErrorCode=sa.IsSuccess?"Success":sa.ErrorCode||
"";Xa.ErrorMessage=sa.IsSuccess?"Success":this.wjb(Ba,sa.ErrorMessage||"");Xa.Target=this.wjb(Ba,pa||"");Xa.TimeInMS=Math.floor(Da);Xa.AuthLibrary=this.WD();Xa.AppName=Ba;Xa.AuthorityType=Object(e.a)(n,y.a.RRc());Xa.UserType=this.Xoj(y.a.getAuthContext());Xa.IsAuthSupportedInSession=r.a[this.U6];Xa.RequestCount=++this.O4a;Xa.AppId=ia;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Xa));sa.IsSuccess||(pa=F.a.Uz(),void 0!==pa&&null!==pa&&(pa.set("AppName",Ba),pa.set("AuthLibrary",this.WD()),pa.set("ErrorCode",
sa.ErrorCode),pa.set("ErrorMessage",this.wjb(Ba,sa.ErrorMessage)),Ba=Object.assign(new Ua.a,{durationMs:Da,extendedProperties:pa}),ra.Health.instance.recordKpiFailure(Ga.kpiName,"TryGetTokenFailure",!1,!0,Ba)));return sa}Uoe(sa,Ba){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ba,this.wjb(Ba,sa.ErrorMessage));const pa=F.a.Uz();void 0!==pa&&null!==pa&&(pa.set("AppName",Ba),pa.set("AuthLibrary",this.WD()),pa.set("ErrorCode",sa.ErrorCode),
pa.set("ErrorMessage",this.wjb(Ba,sa.ErrorMessage)),Ba=Object.assign(new Ua.a,{extendedProperties:pa}),ra.Health.instance.recordKpiFailure(Ga.kpiName,"FailureBeforeGetToken",!1,!0,Ba));return Promise.resolve(sa)}Gjg(sa){return sa===ua.a.ptd}wjb(sa,Ba){return this.Gjg(sa)&&Ba?"REDACTED":Ba}Xoj(sa){return A.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!sa.loginHint||1>sa.loginHint.length?"empty":-1<sa.loginHint.indexOf("guest#")?"guest":-1<sa.loginHint.indexOf("ext#")?"external":0>sa.upn.indexOf("@")?
"no-at":"supported"}PKj(){return 1===this.U6}S0g(sa,Ba,pa){let ia=null,Da=null,Xa=null,Ka=null;sa?sa.ErrorCode||sa.ErrorMessage?(Da=sa.ErrorCode?sa.ErrorCode:Ga.YTf,Xa=sa.ErrorMessage?sa.ErrorMessage:"No message"):sa.Token?Ba?ia=sa.Token:(Da=Ga.tXk,Xa="A rejected promise returned a token."):(Da=Ga.YTf,Xa=JSON.stringify(sa)):(Da=Ga.Gpk,Xa="No result came from Auth Token Strategy");sa&&sa.Telemetry&&!this.Gjg(pa)&&(Ka=sa.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Ka)));if(Da===Ga.eok||
Da===Ga.Zxl)Da=Ga.YCh,Xa="Auth Library Timed Out";Da===Ga.Zhi&&-1<Xa.indexOf(Ga.M4h)&&(Da=Ga.Tog);if(Da||Xa)ia=null;return Object.assign(new v.a,{IsSuccess:!!ia,Token:ia,ErrorCode:Da,ErrorMessage:Xa,Telemetry:Ka})}static get dSf(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get QRi(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Ga.Zxl="token_renewal_error";
Ga.YTf="Exception";Ga.Gpk="NoResult";Ga.tXk="RejectToken";Ga.eok="monitor_window_timeout";Ga.YCh="Timeout";Ga.Nsl="authTokenStrategy_timeout";Ga.Zhi="login_required";Ga.M4h="AADSTS50058";Ga.Tog="Cookies Disabled";Ga.kpiName="OAuthManager";Ga.Cmk=2;Object(J.a)(Ga,"OAuthManager",null,[217])},550:function(J,aa,d){J=d(0);var h=d(387),e=d(353),r=d(57),n=d(67),v=d(173),B=d(93),y=d(27);d(14);var x=d(36),A=d(50),E=d(99);class u{constructor(){this.Uhb=this.R5=null;this.tDh=0}}Object(J.a)(u,"CandidateManager",
null,[]);var K=d(661),G=d(659),O=d(660);class R{constructor(){this.keyCode=0;this.XLl=this.WLl=null}}Object(J.a)(R,"PredictionKeptState",null,[]);class V{constructor(){this.values={}}Ceg(Ba,pa,ia){Ba=this.X7f(Ba);Ba[pa]=pa in Ba?Ba[pa]+ia:ia}add(Ba,pa,ia){this.X7f(Ba)[pa]=ia}ga(Ba){return this.values[Ba]}$(Ba,pa){return this.values[Ba]=pa}FIf(Ba){return Ba in this.values?!0:!1}X7f(Ba){let pa;Ba in this.values?pa=this.values[Ba]:(pa={},this.values[Ba]=pa);return pa}}Object(J.a)(V,"PredictionState",
null,[]);class D{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=0;this.PredictionAccepted=!1}}Object(J.a)(D,"TypeAheadRoamingSettings",null,[]);var Q=d(195),Z=d(1204),P=d(18),ca=d(919),T=d(662);d(921);var da=d(920);class fa{constructor(Ba){this.uwc=null;this.xD=Ba;Ba=r.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Vw;const pa=r.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Ba,pa)}initialize(Ba,pa){const ia=new T.a;return Ba?pa?this.uwc?this.uwc:
y.AFrameworkApplication.Aa.hb.hjg?this.uwc=new Promise((Da,Xa)=>{const Ka=y.AFrameworkApplication.Bj("al",2);pa.iBb(Ka).continueWith(Ma=>{Ma.rm?(this.k5g(),Xa(Ma.$i.message)):(this.cfg(ia),Da({}))})}):this.uwc=Ba.loadScript("al").then(()=>{this.cfg(ia)}).catch(Da=>{this.k5g();return Promise.reject(Da)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}cfg(Ba){fa.WS.hG(()=>{h.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");const pa=
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let ia=y.AFrameworkApplication.fa.Ga("OfficeApplicationName")||"";ia=ia.replace("Web","");Ba.appName=Ba.appName||ia;Ba.serviceUrl=Ba.serviceUrl||y.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl");Ba.appVersion=Ba.appVersion||y.AFrameworkApplication.fa.Ga("BuildVersion")||"";Ba.releaseAudienceGroup=Ba.releaseAudienceGroup||(y.AFrameworkApplication.gd?Object(Z.a)(String,y.AFrameworkApplication.gd.AudienceGroup)||"":"");Ba.sessionId=Ba.sessionId||
y.AFrameworkApplication.fa.Ga("SessionId")||"";Ba.uiLanguage=Ba.uiLanguage||y.AFrameworkApplication.uiCulture;Ba.flights=this.Q4i();Ba.initSession=Ba.initSession||!0;pa.initialize(Ba);pa.activateAnnotation(Object.assign(new ca.a,{annotationType:da.a.getTypeName(),handler:this.xD}))},"WordPredictionAL:Initialize")}k5g(){h.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}Q4i(){var Ba=y.AFrameworkApplication.fa.Ga("FlightId"),pa=y.AFrameworkApplication.fa.YA("AugLoopFlightKeywordList");
Ba=this.tYi(Ba,pa);pa="";0<Ba.length&&(pa=Q.a.join(Ba,";"),h.ULS.sendTraceTag.apply(null,[595091610,3010,50,"FlightCount: [{0}], flightIds: [{1}]",Ba.length].concat(Ba)));return pa}tYi(Ba,pa){const ia=new P.a;if(Ba&&""!==Ba&&pa&&0<pa.length){for(let Da=0;Da<pa.length;Da++)pa[Da]=pa[Da].toLowerCase();Ba=Ba.toLowerCase().split(";");for(const Da of Ba)Q.a.any(pa,Xa=>-1<Da.indexOf(Xa))&&ia.add(Da)}return ia.toArray()}static get WS(){return e.a.instance}}Object(J.a)(fa,"WordPredictionAugLoopHandler",null,
[894]);var ma=d(142),ea=d(181),ra=d(126);class F{constructor(Ba,pa,ia,Da){this.m2b=null;this.sZg=Ba;this.u$k=ia;this.Rqi=Da;this.g$k=pa;this.TMc=Array(Ba);this.Nlh();this.$lh()}GDj(Ba,pa,ia){Ba>this.sZg-1||this.Beg(this.TMc[Ba],pa,ia)}iab(Ba,pa){this.Beg(this.m2b,Ba,pa)}UOd(Ba,pa){this.m2b[Ba]=pa}flush(){F.WS.hG(()=>{for(let Ba=0;Ba<this.TMc.length;Ba++){const pa=this.O3i(Ba);pa&&(pa.dataFields.push(Object.assign(new ra.a,{name:G.a.qP,int64:Ba})),ma.a.sendActivityEvent(pa))}this.Nlh()},"WPT:F")}k0i(){F.WS.hG(()=>
{const Ba=this.N3i();Ba&&ma.a.sendActivityEvent(Ba);this.$lh()},"WPT:FSD")}f0i(Ba){F.WS.hG(()=>{const pa=this.M3i(Ba);pa&&ma.a.sendActivityEvent(pa)},"WPT:FCD")}N3i(){const Ba=this.l9d(this.u$k);for(var pa=0;pa<O.a.zSa.length;pa++)this.VOd(O.a.zSa[pa],this.m2b,Ba.dataFields);for(pa=0;pa<O.a.j5b.length;pa++)this.PYb(O.a.j5b[pa],this.m2b,Ba.dataFields);return Ba.dataFields.length?Ba:null}O3i(Ba){const pa=this.l9d(this.g$k);for(let ia=0;ia<G.a.zSa.length;ia++)this.VOd(G.a.zSa[ia],this.TMc[Ba],pa.dataFields);
return pa.dataFields.length?pa:null}M3i(Ba){const pa=this.l9d(this.Rqi);for(var ia=0;ia<K.a.zSa.length;ia++)this.VOd(K.a.zSa[ia],Ba,pa.dataFields);for(ia=0;ia<K.a.j5b.length;ia++)this.PYb(K.a.j5b[ia],Ba,pa.dataFields);return pa.dataFields.length?pa:null}Beg(Ba,pa,ia){Ba[pa]=pa in Ba?Ba[pa]+ia:ia}l9d(Ba){const pa=new ea.a;pa.name=Ba;pa.dataFields=[];return pa}VOd(Ba,pa,ia){Ba in pa&&Array.add(ia,Object.assign(new ra.a,{name:Ba,int64:pa[Ba]}))}PYb(Ba,pa,ia){Ba in pa&&Array.add(ia,Object.assign(new ra.a,
{name:Ba,string:pa[Ba]}))}Nlh(){for(let Ba=0;Ba<this.sZg;Ba++)this.TMc[Ba]={}}$lh(){this.m2b={}}static get WS(){return e.a.instance}}Object(J.a)(F,"WordPredictionTelemetryHandler",null,[893]);var na=d(64),ka=d(33),Ua=d(385),za=d(307),ha=d(92);d(236);var ua=d(51),Ga=d(34);d(348);d(379);d(1050);d.d(aa,"a",function(){return sa});class sa{static get WS(){return e.a.instance}static get QD(){sa.Swc||(sa.Swc=new u);return sa.Swc}static set QD(Ba){sa.Swc=Ba}static get a0c(){return sa.Qrf}static set a0c(Ba){sa.Qrf=
Ba}static get VKh(){sa.gOd||(sa.gOd=sa.WGi());return sa.gOd}static get settings(){sa.eEc||(sa.eEc=Object.assign(new D,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return sa.eEc}static set settings(Ba){sa.eEc=Ba}static get CZa(){sa.aJd||(sa.aJd=new V);return sa.aJd}static get Nvl(){return sa.pLi}static get x6(){sa.iOd||(sa.iOd=new F(sa.Nvl,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));
return sa.iOd}static get aKi(){return sa.U5a?sa.U5a.instance?sa.U5a.instance.n3:1:(sa.U5a=r.a.instance.Ja("Common.IZoomManager"),sa.U5a&&sa.U5a.instance?sa.U5a.instance.n3:1)}static get characterPropertiesEditor(){sa.azd||(sa.azd=r.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return sa.azd}static get yjd(){sa.mJd||r.a.instance.Ja("Box4.Proofing.IProofingSentenceSeparator").execute(Ba=>{Ba&&(sa.mJd=Ba)});return sa.mJd}static get YLl(){sa.hOd||(sa.hOd=r.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));
return sa.hOd}static l7k(){window.setTimeout(()=>{const Ba={};Ba.WordPredIsEnabled=sa.settings.WordPredIsEnabled;Ba.PredictionSeenCount=sa.settings.PredictionSeenCount;Ba.PredictionAccepted=sa.settings.PredictionAccepted;sa.YLl.OPl(x.c(Ba))},sa.qNf)}static Qbe(Ba,pa){if(!Ba||!pa||Ba.eventName!==n.a.eQa)return!1;const ia=Ba.qc.keyCode;if(sa.Jhg(pa)){sa.CVk();pa=pa.node;if((ia===v.a.oP||ia===v.a.Sq)&&sa.VUa)return B.a.Bn(Ba.qc),sa.dIj(pa),sa.EGl(ia),h.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),
!0;if(ia===v.a.pP)sa.a0c&&(sa.a0c=!1);else if(ia===v.a.X1&&sa.VUa)sa.a0c=!0,h.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),sa.$Ta();else if(ia===v.a.Gmb&&Ba.qc.ctrlKey&&sa.$Id)return h.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),sa.Ylh(),!1}if(ia===v.a.mmb&&Ba.qc.shiftKey||ia===v.a.cba&&Ba.qc.ctrlKey||ia===v.a.vMa&&Ba.qc.altKey)return!1;pa=sa.QD.R5;const Da=ia===v.a.fZ||ia===v.a.O6||ia===v.a.Rga||ia===v.a.dba;if(Da||Da&&(Ba.qc.ctrlKey||Ba.qc.shiftKey)||ia!==v.a.cba&&Ba.qc.ctrlKey||
ia!==v.a.vMa&&Ba.qc.altKey||ia===v.a.VH||sa.VUa&&pa&&0<pa.U8.length&&!pa.U8.toLowerCase().startsWith(String.fromCharCode(ia).toLowerCase()))sa.$Ta(),sa.QD.R5=null,h.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");sa.Ylh();return!1}static kxj(){5>sa.settings.PredictionSeenCount&&(sa.settings.PredictionSeenCount+=1)}static $Ta(){Ua.a.$Ta();sa.VUa=!1}static dIj(Ba){sa.WS.hG(()=>{var pa=document.getElementById("inlinePredictedWord");
if(pa){var ia=pa.innerText;if(ia&&0<ia.length&&(Ba=Ba?Ba:sa.Yfj())){var Da=new A.GraphTransaction(7);Da.kd(Ba);var Xa=Ba.Ra.last,Ka=ua.a.VQa(Ba),Ma=ha.a.xs(Ka);Xa.formatting=Ma.ee(Xa);sa.characterPropertiesEditor.replaceTextRange(Ka,ia,!0,!0,Ga.a.typing);Da.dispose();ia=E.InteractiveViewManager.instance.Qd;Da=Ba.ng(ia.Ma);Da=za.a.Qt(Da,ka.ParagraphReader.textLength(Ba));Xa=new Sys.UI.Point(Da.x,Da.y);Xa.y+=Da.height;ia.H6(Xa,null,null,ia,!1);sa.VUa=!1;pa.innerText="";(pa=document.getElementById("inlinePlaceholderTab"))&&
sa.tbg()&&(pa.className="hidePanel")}}},"WPT:IIG")}static hdl(Ba){sa.Kof=Ba;sa.x6.UOd(O.a.modelId,Ba.modelId);sa.x6.UOd(O.a.modelVersion,Ba.modelVersion);sa.x6.UOd(O.a.configId,Ba.configId)}static oej(){return sa.Kof}static ARd(Ba,pa){const ia=sa.VKh;var Da=document.getElementById("inlinePredictedWord");Da&&(Da.innerText=pa,(pa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<pa.length&&(pa=pa[pa.length-1],Da.style.fontSize=pa.style.fontSize,
Da.style.fontFamily=pa.style.fontFamily,Da.style.color=pa.style.color,Da.style.whiteSpace="pre",Da=Da.parentNode,Ba="suggestion: "+Ba,pa=document.getElementById("inlinePlaceholderTab"),pa.className="hidePanel",pa&&sa.tbg()&&(pa.className="inlinePlaceholderTab",Ba+=". Tab to accept"),Da.parentNode.setAttribute("aria-label",Ba)),ia&&(ia.className="textareaCaretTracker"),sa.Vdl()&&(sa.VUa=!0,h.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static Jhg(Ba){Ba||(Ba=sa.y7i());if(Ba){const pa=
Ba.node;try{return ka.ParagraphReader.textLength(pa)<=Ba.Qa}catch(ia){}}return!1}static T2j(Ba){Ba=sa.CZa.ga(Ba);Ba=Ba[O.a.bRd]-Ba[O.a.Zrc];300<Ba?(sa.x6.iab(O.a.XNf,Ba),sa.x6.iab(O.a.WNf,1)):(sa.x6.iab(O.a.Azf,Ba),sa.x6.iab(O.a.Owf,1))}static I4d(Ba){sa.Cjg("TextPredictionTelemetryIsEnabled")&&sa.x6.f0i(Ba)}static krg(Ba,pa){Ba=sa.CZa.ga(Ba);const ia=Ba[O.a.Zrc];pa?sa.x6.iab(O.a.wxh,Ba[O.a.Pwf]-ia):sa.x6.iab(O.a.uxh,Ba[O.a.Nwf]-ia)}static Dbc(Ba){sa.x6.iab(Ba,1)}static Mua(Ba,pa,ia){sa.x6.GDj(Ba,
pa,ia)}static Imd(){sa.QD.R5=null;sa.QD.Uhb=null}static PJk(){sa.Qlb("TextPredictionsSeen","TextPredictionsSeenIsEnabled");sa.kxj();sa.BJj()}static Qlb(Ba,pa){sa.Cjg(pa)&&window.setTimeout(()=>{const ia=r.a.instance.Ja("Common.ISystemInitiatedFeedback");ia&&ia.execute(Da=>{Da.logActivity(Ba,pa)})},sa.qNf)}static Cjg(Ba){return!!y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.ka(Ba)}static WGi(){var Ba=document.body;const pa=document.createElement("div");if(Ba){Ba.appendChild(pa);pa.setAttribute("id",
"textareaCaretTracker");pa.className="hidePanel";pa.setAttribute("role","alert");Ba=document.createElement("button");const ia=document.createElement("span");Ba.setAttribute("disabled",!0);Ba.setAttribute("aria-disabled",!0);Ba.setAttribute("aria-hidden",!0);ia.setAttribute("aria-disabled",!0);ia.setAttribute("aria-hidden",!0);ia.setAttribute("id","inlinePredictedWord");ia.className="inlinePredictedWord";Ba.className="inlinePredictedWordButton";Ba.appendChild(ia);pa.appendChild(Ba);pa.appendChild(sa.DIi());
(Ba=document.getElementById("WACViewPanel"))&&$addHandler(Ba,"scroll",sa.ivj)}return pa}static Vdl(){const Ba=sa.VKh;var pa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");pa=(pa=pa?pa.getElementsByClassName("EOP")[0]:null)?pa.getBoundingClientRect():null;return Ba&&pa?(Ba.style.cssText="transform: scale("+sa.aKi+"); transform-origin: 0% 0%",Ba.style.top=pa.top+"px",Ba.style.left=pa.left+"px",!0):!1}static tbg(){return!sa.settings.PredictionAccepted}static BJj(){5!==sa.settings.PredictionSeenCount||
sa.settings.PredictionAccepted||(sa.Qlb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),sa.l7k())}static DIi(){const Ba=document.createElement("button");Ba.setAttribute("aria-hidden",!0);Ba.className="hidePanel";Ba.id="inlinePlaceholderTab";Ba.disabled=!0;Ba.innerText="Tab";return Ba}static ivj(){sa.$Ta()}static Yfj(){const Ba=na.a.instance.Na.mb;return Ba&&Ba.Ye?Ba.Ye.node:null}static CVk(){sa.EMd||(sa.EMd=window.setTimeout(sa.Etj,6E4*sa.oLi))}static Etj(){sa.x6.flush();sa.x6.k0i();sa.EMd=
0}static X3f(Ba){return Ba&&0<Ba.length&&(Ba=Ba.split(" "),0<Ba.length)?Ba[Ba.length-1].length:-1}static EGl(Ba){const pa=sa.QD.R5,ia=sa.QD.Uhb;pa&&(sa.$Id=Object.assign(new R,{keyCode:Ba,WLl:pa,XLl:ia}))}static y7i(){const Ba=na.a.instance.Na.mb;return Ba&&Ba.Ye?Ba.Ye:null}static Ylh(){sa.$Id=null}}sa.pLi=30;sa.oLi=5;sa.qNf=5E3;sa.gOd=null;sa.mJd=null;sa.azd=null;sa.U5a=null;sa.Qrf=!1;sa.EMd=0;sa.iOd=null;sa.aJd=null;sa.$Id=null;sa.hOd=null;sa.eEc=null;sa.Kof=null;sa.Swc=null;sa.VUa=!1;Object(J.a)(sa,
"WordPredictionHandler",null,[])},658:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.Apk="NoCharacterPositionOnLine";h.Cpk="NoCharacterPositionOnSpan";h.Bpk="NoCharacterPositionOnMultilineSpan";h.Q2b="DoNothingResult";h.Qja="FailedProcessingStep";h.P8a="FailedResult";h.CQc="FirstChildNotText";h.a_i="FirstChildNull";h.LIj="InvalidCharacterPositionResult";h.xh="NoExecute";h.Wo="NoApply";h.R1="UnexpectedState";Object(J.a)(h,"ActivityEventName",null,[])},659:function(J,aa,d){d.d(aa,
"a",function(){return h});J=d(0);class h{}h.qP="WordIndex";h.ykh="RenderedCandidateCount";h.U0g="NotRenderedCandidateCount";h.pEf="CandidateListCount";h.uMf="CumulativeIndexOfSeen";h.LJi="CumulativeIndexOfRejected";h.KJi="CumulativeIndexOfKept";h.tMf="CumulativeIndexOfCorrect";h.JJi="CumulativeIndexOfAcceptedCandidate";h.hph="SeenCount";h.uXk="RejectedCount";h.FZj="KeptCount";h.UFh="TypedThroughCount";h.MJi="CumulativeScoreOfKept";h.NJi="CumulativeScoreOfRejected";h.wMf="CumulativeScoreOfTypeThrough";
h.zkh="RenderedCharSum";h.EZj="KeptCharSum";h.DZj="KeptCandidateTokenSum";h.FCl="UndoOfKeptCount";h.ICl="UndoneKeptCharCount";h.VFh="TypedThroughLastMatchingCharCount";h.language="Language";h.zSa=[h.ykh,h.U0g,h.pEf,h.uMf,h.LJi,h.KJi,h.tMf,h.JJi,h.hph,h.uXk,h.FZj,h.UFh,h.MJi,h.NJi,h.wMf,h.zkh,h.EZj,h.DZj,h.FCl,h.ICl,h.VFh,h.language];Object(J.a)(h,"DataFieldsPerSentence",null,[])},660:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.modelId="ModelId";h.configId="ConfigId";h.modelVersion=
"ModelVersion";h.NJk="PredictionAcceptedByTab";h.MJk="PredictionAcceptedByRightArrow";h.Azf="AugLoopResponseTime";h.wxh="SignalRenderedTime";h.uxh="SignalNotRenderedTime";h.XNf="DelayedResponseTime";h.Hol="SignalGeneratedCount";h.Owf="AnnotationReceivedCount";h.cch="PredictionRenderedCount";h.bch="PredictionNotRenderedCount";h.D1d="EmptyPredictionResponseCount";h.Gxh="SkippedPredictionResponseCount";h.WNf="DelayedResponseCount";h.Mpk="NonEnglishSkipCount";h.Zrc="SignalGenerationTime";h.bRd="AnnotationReceivedTime";
h.Pwf="AnnotationRenderedTime";h.Nwf="AnnotationNotRenderedTime";h.zSa=[h.MJk,h.NJk,h.Azf,h.wxh,h.uxh,h.XNf,h.Hol,h.Owf,h.cch,h.bch,h.D1d,h.Gxh,h.WNf,h.Mpk];h.j5b=[h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerSession",null,[])},661:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.language="Language";h.kVd="CharIndex";h.SJc="CharIndexRendered";h.npg="KeptCharCount";h.modelId="ModelId";h.ach="PredictionLength";h.dch="PredictionTokenCount";h.score="Score";h.status=
"Status";h.w4e="TypedThroughCharCount";h.qP="WordIndex";h.modelVersion="ModelVersion";h.WCh="TimeTakenAugloop";h.xtd="TimeToRender";h.configId="ConfigId";h.zSa=[h.kVd,h.SJc,h.npg,h.ach,h.dch,h.score,h.status,h.w4e,h.qP,h.WCh,h.xtd];h.j5b=[h.language,h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerCandidate",null,[])},662:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=
this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(J.a)(h,"InitializeParameters",null,[])},663:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);aa=d(320);var h=d(143);class e extends aa.a{constructor(){super();
this.timestamp=this.targetObject=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}}Object(J.a)(e,"Signal",aa.a,[])},664:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.bHa=!0;this.E3c=this.kad=this.bcd=this.H8c=null;this.Ila=e}copy(){return new h(this.Ila.copy())}move(e,r){this.bHa=!0;this.Ila.move(e,r)}setOffsets(e){this.bHa=!0;this.Ila.setOffsets(e)}Vf(){return this.Ila.Vf()}get hc(){this.Uud();
return this.H8c}get kc(){this.Uud();return this.bcd}get $b(){this.Uud();return this.kad}get Yb(){this.Uud();return this.E3c}Uud(){if(this.bHa){var e=this.Ila.points;this.H8c=this.kad=e[0].x;this.bcd=this.E3c=e[0].y;for(const r of e)this.H8c=Math.min(this.H8c,r.x),this.bcd=Math.min(this.bcd,r.y),this.kad=Math.max(this.kad,r.x),this.E3c=Math.max(this.E3c,r.y);this.bHa=!1}}}Object(J.a)(h,"Boundary",null,[])},665:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.NE=e}}Object(J.a)(h,"SessionEndedEventArgs",Sys.EventArgs,[])},666:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(57);class e{constructor(r){this.Rqg=this.errorType=0;this.originalText=this.token=null;this.QJa=this.maa=this.lcid=0;this.EKh=!1;this.smf=r}Hke(){const r=this.token?this.token:null;return 0!==this.errorType&&e.vCj.contains(r,this.lcid)}static get vCj(){return e.PNa||(e.PNa=h.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.PNa=null;Object(J.a)(e,"ProofingErrorDetails",
null,[441])},667:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.Load=0]="Load";e[e.Edit=1]="Edit"})(h||(h={}));Object(J.b)("UserAction",h)},668:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);aa=d(110);class h extends aa.a{constructor(){super();this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}Zk(){return 4}static I1i(e,r){const n=new h;h.ALe(n,e,r);n.UserActionType=e.paragraphNode.QTb?"Edit":
"Load";return n}static ALe(e,r,n){e.Lcid=r.range.lcid;e.Input=r.Rna.substring(r.range.begin,r.range.end);e.ApplicationMode=n;0<=r.range.maa&&(e.PreContextText=r.Rna.substring(r.range.maa,r.range.begin));0<=r.range.QJa&&(e.PostContextText=r.Rna.substring(r.range.end,r.range.QJa))}static Vjj(e,r,n,v,B,y,x,A){const {SpellingRequestObjectUpdatedV2:E}=d(1117),{SpellingRequestObjectUpdated:u}=d(1118);return A?E.x5d(r,n):e?u.x5d(r,n,v,B,y,x):h.I1i(r,n)}}Object(J.a)(h,"SpellingRequestObject",aa.a,[])},669:function(J,
aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r=null,n=null,v=null,B=!1,y=null){this.DisplayName=this.ClientId=this.Provider=this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=r;this.DisplayName=n;this.Email=v;this.IsAnonymous=B;this.ClientId=y}}Object(J.a)(h,"Person",null,[])},670:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(82);class e{static prb(r,n,v="GenericCommentsTask"){v=new h.a(2,1,0,()=>{n()},92,v);r.Db(v)}static Ys(r){return Error.create("SDXHostAPI Error : "+
r,{["SDXHostAPIErrorCode"]:r})}}Object(J.a)(e,"OfficeSharedCommentsUtils",null,[])},671:function(J,aa,d){d.d(aa,"a",function(){return n});J=d(0);var h=d(387);aa=d(731);var e=d(1039),r=d(925);class n extends aa.a{constructor(v,B,y=null){super(v,B,y||e.a.instance,n.yFj)}static yFj(){r.a.sendTraceTag=n.a$k;r.a.debugAssertTag=n.wKi}static a$k(v,B,y,...x){h.ULS.sendTraceTag.apply(null,[v,204,n.rJi(B),y].concat(x))}static wKi(){}static rJi(v){switch(v){case 0:return 200;case 1:return 100;case 2:return 50;
case 4:return 15;case 3:return 10;default:return 100}}}n.LMe="wdPreviousSession";n.GMf="wdUserSession";Object(J.a)(n,"CommonCrossDocumentMessenger",aa.a,[])},672:function(J,aa,d){d.d(aa,"a",function(){return r});J=d(0);var h=d(387),e=d(27);class r{static Sae(n,v){let B=null;if(n&&0<n.length&&v&&0<v.length){const y=window[v];y?y&&n in y?B=y[n]:h.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+n+" from dictionary "+v):h.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+
v)}return B}static qke(){const n=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",!1);n?h.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):h.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return n}}Object(J.a)(r,"CommonUtils",null,[])},673:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(304);class h{}h.LabelText=d.a.labelText;h.LabelTextUserGeneratedPlaceholderReplacements=d.a.ZZj;
h.Visible=d.a.visible;h.ImageIsVisible="ImageIsVisible";h.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";h.Image16by16Class=d.a.yyb;h.Image32by32Class=d.a.NEa;h.Image48by48Class=d.a.Pde;h.ImageBackColor="ImageBackColor";h.On="On";h.SourceControlId="SourceControlId";Object(J.a)(h,"FlyoutAnchorCommandProperties",null,[])},674:function(J,aa,d){d.d(aa,"a",function(){return y});J=d(0);var h=d(265),e=d(27),r=d(364),n=d(200),v=d(97),B=d(65);class y{static K_a(x){let A,E;({fyl:A,gyl:E}=y.NYi());
y.q7k(A,E,x)}static NYi(){({i8b:A}=r.a.XOb(!e.AFrameworkApplication.CQ));var x=$get(h.CuiHelper.qAj);if(A)var A=document.getElementById(h.CuiHelper.Z2d);else A=x.childNodes[0],x=x.childNodes[1];return{fyl:A,gyl:x}}static q7k(x,A,E){if(x&&A&&0<A.clientHeight){const u=-1!==A.parentNode.parentNode.className.indexOf("cui-ribbon");y.Goh(x,A,E,u)}}static Goh(x,A,E,u){let K=null,G=null,O=null,R=null,V=null,D=null,Q=null,Z=null,P=null,ca=null,T=null,da=null,fa=null,ma=null,ea=null,ra=null,F=null,na=null,
ka=null,Ua=null;({URf:K,TRf:G,VRf:O,s8a:R,t8a:V,JRa:D,dT:Q,wv:Z,KRa:P,lQ:ca,LRa:T,WRf:Ua}=y.AWf(x,K,G,O,R,V,D,Q,Z,P,ca,T,Ua));({t3b:da,TG:fa,SRf:ma,QRf:ea,u8a:ra,kvb:F,lvb:na,RRf:ka}=y.ZWf(A,da,fa,ma,ea,ra,F,na,ka));x=[K,G,O,R,V,D,Q,Z,P,ca,T,ma,ea,ra,F,na,ka,Ua];for(var za of x)y.nml(za);za=[K,G,O,V,Q,Z,ca,T,ea,F,na,ka];for(const ha of za)y.V4e(ha);y.Xlh(G);y.erh(fa,0);y.FTi(K,G,O,R,V,D,Q,Z,P,ca,T,da,fa,ma,ea,ra,F,na,ka,Ua,u,E);y.$ci(D,Q)}static t7k(x,A){y.Goh(x,null,A,!1)}static $ci(x,A){x&&A&&(x.style.marginTop=
(A.offsetHeight-x.offsetHeight)/2+"px")}static AWf(x,A,E,u,K,G,O,R,V,D,Q,Z,P){for(let ca=0;x&&ca<x.childNodes.length;ca++){const T=x.childNodes[ca],da=v.a.cka(T),fa=!!T.id;-1!==da.indexOf("cui-QATRowLeft")?A=T:-1!==da.indexOf("cui-QATRowCenter")?E=T:-1!==da.indexOf("cui-QATRowRight")?u=T:-1!==da.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?K=T:T.id===h.CuiHelper.nTd?G=T:T.id===h.CuiHelper.mYf?O=T:T.id===h.CuiHelper.oTd?R=T:T.id===h.CuiHelper.pTd?V=T:fa&&y.LNj(T)?D=T:-1!==da.indexOf("UsernameNameContainer")?
Q=T:-1!==da.indexOf("UsernameNameItem")?Z=T:-1!==da.indexOf("FreemiumUpsellButton")&&(P=T);({URf:A,TRf:E,VRf:u,s8a:K,t8a:G,JRa:O,dT:R,wv:V,KRa:D,lQ:Q,LRa:Z,WRf:P}=y.AWf(T,A,E,u,K,G,O,R,V,D,Q,Z,P))}return{URf:A,TRf:E,VRf:u,s8a:K,t8a:G,JRa:O,dT:R,wv:V,KRa:D,lQ:Q,LRa:Z,WRf:P}}static ZWf(x,A,E,u,K,G,O,R,V){for(let D=0;x&&D<x.childNodes.length;D++){const Q=x.childNodes[D],Z=v.a.cka(Q),P=!!Q.id;-1!==Z.indexOf("cui-jewel-container")?A=Q:-1!==Z.indexOf("cui-tts")?E=Q:-1!==Z.indexOf("cui-TabRowInline")?K=
Q:-1!==Z.indexOf("cui-TabRowRight")?V=Q:-1!==Z.indexOf("cui-separator")?u=Q:P&&Q.id.startsWith(h.CuiHelper.A8g)&&!G?G=Q:P&&Q.id.startsWith(h.CuiHelper.TVf)?O=Q:P&&Q.id.startsWith(h.CuiHelper.SKe)&&(R=Q);({t3b:A,TG:E,SRf:u,QRf:K,u8a:G,kvb:O,lvb:R,RRf:V}=y.ZWf(Q,A,E,u,K,G,O,R,V))}return{t3b:A,TG:E,SRf:u,QRf:K,u8a:G,kvb:O,lvb:R,RRf:V}}static p7k(x,A,E,u,K,G,O,R,V){y.GR(x,A,V)&&(y.AWc(A),y.GR(x,A,V)&&y.AWc(A));y.GR(A,u,V)&&(y.vL(E),y.vL(K),y.GR(A,u,V)&&(y.AWc(A),y.GR(A,u,V)&&(y.AWc(A),y.GR(A,u,V)&&y.vL(u))));
y.GR(u,R,V)&&(y.vL(E),y.vL(K));x=[G,O,R];y.Ocg(u,R,x,V);y.Ocg(A,R,x,V)}static Ocg(x,A,E,u){let K=0;for(;K<E.length&&y.GR(x,A,u);)y.vL(E[K]),K++}static ijj(x){if(!x)return 0;if(void 0===x._scaleStep||null===x._scaleStep){let A=0;-1!==x.className.indexOf("cui-tts-scale1")?A=1:-1!==x.className.indexOf("cui-tts-scale2")&&(A=2);x._scaleStep=A}return parseInt(x._scaleStep)}static AWc(x){let A=y.ijj(x);2>A&&y.erh(x,++A)}static erh(x,A){x&&(x.className=y.c5k[A],x._scaleStep=A)}static GR(x,A,E){return x&&
A?B.a.dqg(B.a.ai(x),B.a.ai(A),E):!1}static RHb(x,A,E){let u=0;x&&A&&(u=B.a.koe(B.a.ai(x),B.a.ai(A),E));return u}static CXd(x){for(let A=0;x&&A<x.childNodes.length;A++)if(-1!==x.childNodes[A].className.indexOf("cui-cg"))return!0;return!1}static K7d(x){let A=null;for(let E=x.childNodes.length-1;x&&0<=E;E--){const u=x.childNodes[E];if(-1===u.className.indexOf("cui-cg"))break;A=u}return A}static VOb(x,A,E){if(x&&!y.jn(x)){var u=n.a.Xt(x);u=v.a.xM(u.paddingLeft)+v.a.xM(u.paddingRight);E=x.offsetWidth-
E-u;let K=0;for(;A&&A!==x;)(u=n.a.Xt(A))&&(K+=v.a.xM(u.paddingLeft)+v.a.xM(u.paddingRight)),A=A.parentNode;E=Math.max(E,75+K);x.style.width=E+"px"}}static y2k(x,A,E){if(x&&A){let u=0,K=0;({left:u,top:K}=B.a.c2f(A,u,K));y.lok(x,E?u-x.offsetWidth:u+A.offsetWidth)}}static FTi(x,A,E,u,K,G,O,R,V,D,Q,Z,P,ca,T,da,fa,ma,ea,ra,F,na){F&&y.p7k(Z,P,ca,T,da,fa,ma,ea,na);y.CXd(P)?y.y7k(P,x,A,E,u,K,G,O,R,V,D,Q,ra,na):y.x7k(x,A,E,u,K,G,O,R,V,D,Q,ra,na)}static x7k(x,A,E,u,K,G,O,R,V,D,Q,Z,P){const ca=!!K,T=!!O,da=
!!R;let fa=0;if((T||da)&&0<(fa=y.RHb(x,A,P))){let ma=T;da&&(!T||R.offsetWidth>O.offsetWidth)&&(ma=!1);y.VOb(ma?O:R,ma?O:R,ma?fa:2*fa);T&&da&&0<(fa=y.RHb(x,A,P))&&y.VOb(ma?O:R,ma?O:R,ma?fa:2*fa)}if(T&&y.GR(O,A,P)||ca&&y.GR(K,A,P))y.vL(u),y.vL(K),y.vL(G),y.vL(O),da&&(y.V4e(A),y.V4e(R));y.aih(A,E,R,V,D,Q,Z,P);da&&y.tEf(R,x,E,P)}static y7k(x,A,E,u,K,G,O,R,V,D,Q,Z,P,ca){const T=!!R,da=!!V,fa=!!D,ma=!!P,ea=y.K7d(x);0<(A=y.RHb(A,ea,ca))&&(T&&y.VOb(R,R,A),!T||y.GR(R,ea,ca))&&(y.vL(K),y.vL(G),y.vL(O),y.vL(R));
y.GR(x,E,ca)&&y.y2k(E,x,ca);y.aih(E,u,V,D,Q,Z,P,ca);0<(A=y.RHb(x,u,ca))&&(y.VOb(Q,Z,A),ma&&y.GR(x,u,ca)&&y.vL(P),fa&&y.GR(x,u,ca)&&y.vL(D));da&&!y.jn(E)&&y.tEf(V,x,u,ca)}static aih(x,A,E,u,K,G,O,R){const V=!!E,D=!!u,Q=!!K,Z=!!O;let P=0;if((V||Q)&&0<(P=y.RHb(x,A,R))){const ca=!!x&&"absolute"!==x.style.position;let T=V;Q&&(!V||K.offsetWidth>E.offsetWidth)&&(T=!1);y.VOb(T?E:K,T?E:G,T&&ca?2*P:P);V&&Q?(0<(P=y.RHb(x,K,R))&&(T=!T,y.VOb(T?E:K,T?E:G,T&&ca?2*P:P)),y.GR(x,K,R)&&y.vL(x)):V&&y.GR(x,A,R)&&y.vL(x)}Z&&
y.GR(x,A,R)&&y.vL(O);D&&y.GR(x,A,R)&&y.vL(u)}static jn(x){if(!x)return!0;x=x._isHidden;return!(void 0===x||null===x||"0"===x)}static vL(x){x&&!y.jn(x)&&(x.style.display="none",x._isHidden="1")}static nml(x){x&&y.jn(x)&&(x.style.display="",x._isHidden="0")}static V4e(x){x&&(x.style.width="auto",x.style.maxWidth="none")}static lok(x,A){x&&(x.style.position="absolute",x.style.left=A+"px")}static Xlh(x){x&&(x.style.position="static",x.style.left="auto")}static tEf(x,A,E,u){if(x&&x.parentNode&&x.parentNode.parentNode){var K=
y.PFk(x);"auto"!==x.parentNode.style.width&&(x.style.width=x.parentNode.offsetWidth-K+"px");var G=u?E:A;A=u?A:E;E=B.a.ai(x.parentNode.parentNode);G=G?B.a.ai(G):new Sys.UI.Bounds(E.x,0,0,0);A=A?B.a.H9a(A):new Sys.UI.Point(E.x+E.width,0);"absolute"===x.parentNode.style.position?K=A.x-(G.x+G.width)-K-1:(E=B.a.ai(x.nextSibling?x.parentNode:x),E=E.x+E.width/2,K=2*Math.min(E-(G.x+G.width),A.x-E)-K-1);x.style.maxWidth=K+"px"}}static PFk(x){var A=n.a.Xt(x);A=A?v.a.xM(A.paddingLeft)+v.a.xM(A.paddingRight):
0;var E=n.a.Xt(x.parentNode);E=E?v.a.xM(E.paddingLeft)+v.a.xM(E.paddingRight):0;let u=0;for(;x.nextSibling;)x=x.nextSibling,u+=x.offsetWidth;return A+E+u}static LNj(x){return!!x.id&&(x.id.startsWith(h.CuiHelper.MXe)||x.id.startsWith(h.CuiHelper.wmd))}}y.c5k=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(J.a)(y,"RibbonTabScalingActor",null,[])},675:function(J,aa,d){d.d(aa,"a",function(){return x});J=d(0);var h=d(387),e=d(14),r=d(27),n=d(142),v=d(57),B=d(181),y=d(126);class x{constructor(){this.L2=
null;this.fpf=!0}xud(){try{this.L2||(this.L2=v.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.fpf=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!0))}catch(A){h.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+A)}}Lae(A,E,u){return this.L2?this.L2.getToken(A,E,u):new Promise(K=>{v.a.instance.Ja("Common.App.SearchCommon.ISearchOAuthManager").execute(G=>
{G?(this.L2=G,this.L2.getToken(A,E,u).then(O=>K(O))):K(null)})})}zdj(){this.xud();return this.L2?this.L2.getToken("Search",r.AFrameworkApplication.spe,!1):null}h8f(){if("Dev Box"===r.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(A=>{window.setTimeout(()=>{A(window.TellMeSubstrateTokenOverride)},750)});this.xud();return this.L2?this.L2.getToken("Search",r.AFrameworkApplication.D0e,
!0):null}inj(){this.xud();return this.L2?this.L2.getToken("Search",this.fnj(),this.fpf):null}fnj(){return r.AFrameworkApplication.fa.Ga("TellMeServiceAuthEndpointForSearch")}Pkj(){if("Dev Box"===r.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(A=>{window.setTimeout(()=>{A(window.TellMeSubstrateTokenOverride)},750)});this.xud();return this.L2?this.L2.getToken("SmartLookup",this.Okj()):
null}Okj(){return r.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint")}Adj(){return Object(e.a)(this,this.zdj,"getLokiTokenPromise")}qmj(){return Object(e.a)(this,this.h8f,"getSubstrateTokenPromise")}NMb(){return!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.hb.NMb}Unj(){const A={};this.NMb()&&(A.Loki=this.Adj(),A.Substrate=this.qmj());return A}Lbc(A){n.a.QKa(Object.assign(new B.a,{name:"Events",dataFields:[Object.assign(new y.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new y.a,
{name:"Status",bool:A})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}Y1j(){return r.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.Lbc(!1);return!1}).then(()=>{this.Lbc(!0);return!0}):new Promise((A,E)=>{const u=v.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Vw;u?u.loadScript("tellme-strings").then(()=>{this.Lbc(!0);A(!0)}).catch(()=>{this.Lbc(!1);E(!1)}):(this.Lbc(!1),E(!1))})}static jVj(){return!!r.AFrameworkApplication.Aa&&
(r.AFrameworkApplication.Aa.hb.Fac||r.AFrameworkApplication.Aa.hb.tAb)}static o0c(){return!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.hb.tAb}}Object(J.a)(x,"ReactSharedHeaderSearchUtils",null,[])},676:function(J,aa,d){d.d(aa,"a",function(){return x});J=d(0);var h=d(387),e=d(47),r=d(942),n=d(29),v=d(44),B=d(76),y=d(33);class x{constructor(A=2E3){this.nOa=A}XMj(){const A=x.NW();return this.pYj(A)}pYj(A){return 0<this.EUc(A).mentionLength}getSelectedText(){const A=x.NW();return this.EUc(A)}EUc(A){return this.Ijj(A)}Ijj(A){var E=
null;A&&A.Cca&&v.SelectionEditor.Tg(A.Ua)&&v.SelectionEditor.qAb(A.Ua)&&(h.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),E=v.SelectionEditor.XRa(A.Ua,!1));E&&(A=E);if(!A)return Object.assign(new r.a,{neighborhood:"",mentionStart:0,mentionLength:0});const u=new Sys.StringBuilder;let K=E=0;const G=[],O=A.length;for(let V=0;V<O;V++){const D=A.ga(V);if(!y.ParagraphReader.ae(D.node)||Array.contains(G,D.node.lMa))continue;G.push(D.node.lMa);let Q=y.ParagraphReader.text(D.node),
Z=0;var R=y.ParagraphReader.Ata(D.node,!0,!0,!0);let P=y.ParagraphReader.Ata(D.node,!1,!0,!0),ca=0;for(;Q.length<this.nOa&&(R||P);){if(!(ca%2)&&R){const T=y.ParagraphReader.text(R);Q=T+" "+Q;Z+=T.length+1;R=y.ParagraphReader.Ata(R,!0,!0,!0)}1===ca%2&&P&&(Q=Q+" "+y.ParagraphReader.text(P),P=y.ParagraphReader.Ata(P,!1,!0,!0));ca++}R=V===O-1;V||-1===D.Qa||(E=D.Qa);K+=R&&-1!==D.Lb?D.Lb:Q.length;u.append(Q);E+=Z;K+=Z;R||(u.append(" "),K++)}for(A=B.AParagraphNode.Pld(u.toString()," ");E<K&&e.a.iz(A.charCodeAt(E));)E++;
for(;K>E&&e.a.iz(A.charCodeAt(K-1));)K--;return this.ydi(A,E,K)}ydi(A,E,u){if(A.length>this.nOa){var K=u-E;if(K>this.nOa)A=A.substr(E,this.nOa),u=this.nOa,E=0;else{K=Math.max(E-Math.floor((this.nOa-K)/2),0);let G;G=Math.min(K+this.nOa,A.length);K=Math.max(G-this.nOa,0);E-=K;u-=K;A=A.substring(K,G)}}return Object.assign(new r.a,{neighborhood:A,mentionStart:E,mentionLength:u-E})}static NW(){var A=n.App.Kb.Ld.Dn;if(!A)return h.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;A=A.Mb;return A&&
A.Na&&A.Na.length?A.Na.mb:(h.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(J.a)(x,"Box4InsightsSelection",null,[419,420])},677:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(J.a)(h,"NewOutlineElementInfo",null,[])},678:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.xed="Listening";h.ZGb="Warning";h.SYa="Error";Object(J.a)(h,"VoiceNotificationResourceStrings",
null,[])},679:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.CoachButton="coachButton";h.MicButton="micButton";h.PrevButton="prevButton";h.NextButton="nextButton";h.GridButton="gridButton";h.InkButton="inkButton";h.SubtitlesButton="subButton";h.LiveButton="liveButton";h.MoreButton="moreButton";h.ExitButton="exitButton";h.CameraButton="cameraButton";Object(J.a)(h,"SlideshowToolbarButtonIDs",null,[])},680:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=
0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(h||(h={}));Object(J.b)("SupportStatus",h)},681:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(443);class h extends d.a{constructor(e){super();this.shapeNode=e}get mlg(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}
Object(J.a)(h,"InternalClipboardShape",d.a,[])},682:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(961);class h extends d.a{constructor(e,r,n){super(e,r);this.Nxh=n}}Object(J.a)(h,"ClipServiceSlideCopyParams",d.a,[])},683:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(43);class e{constructor(r,n){this.Hfb=!1;this.RAd=this.Epf=-1;this.Xw=r;n&&this.start()}start(){this.Hfb=!0;this.RAd=-1;const r=h.a.cZ();r&&(this.Epf=r)}stop(){this.Hfb=!1;const r=h.a.cZ();r&&0<this.Laa&&
r>=this.Laa&&(this.RAd=r-this.Laa)}get operation(){return this.Xw}get uOc(){return this.RAd}get Laa(){return this.Epf}}Object(J.a)(e,"PPTStopwatch",null,[])},684:function(J,aa,d){d.d(aa,"a",function(){return B});J=d(0);var h=d(1212),e=d(40),r=d(39),n=d(63),v=d(43);class B{static sMc(y,x,A,E,u,K,G,O,R,V,D,Q,Z,P,ca){K=Q.aRa(!1,y.cid,y.sid,0,x.shapeType,K,G,O,R,V+1);K.setValue(r.a.TK,x.sga);({Qth:E,Ith:P}=u.j7f(E,x,A,ca,Z,P));Z=Z.Md;K.setValue(e.a.wx,Z.qf(ca.GM(E,A),0));K.setValue(e.a.JC,Z.qf(ca.GM(P,
A),1));K.setValue(r.a.aQb,K.wx);K.setValue(r.a.kyb,K.JC);K.setValue(r.a.kmd,!0);K.Sca=h.a.LJa(E,0);K.Rca=h.a.LJa(P,1);K.setValue(r.a.DRa,0);K.setValue(r.a.ERa,0);K.setValue(r.a.RUa,!0);K.setValue(r.a.isResizable,!0);K.setValue(r.a.FL,!0);K.bO=!0;K.LUa=!0;ca=(Z=95===x.sga||97===x.sga)||Array.contains(B.ooe,x.sga);K.FL=!Z;K.isResizable=!0;K.setValue(r.a.gz,Z);K.setValue(r.a.Q_,95===x.sga);K.oG=n.a.VE(y.sid,y.cid);K.Skb=K.get_shapeId();K.setValue(r.a.jua,!0);y=u.kKf(E,P,A);K.SU=y;(D.GL(K)||D.$ka(K))&&
v.a.Ib&&(v.a.Ib.Oj=!0);ca?u.wrh(K):u.Hrh(K);return K}}B.ooe=[88,93,94,89,90,91,92];Object(J.a)(B,"InsertContentShapeNodeFactory",null,[])},685:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r,n,v){this.sga=e;this.shapeType=r;this.height=n;this.width=v}}Object(J.a)(h,"AutoShapeProps",null,[])},686:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(){super()}}Object(J.a)(h,"SlidesChangedArgs",Sys.EventArgs,[])},687:function(J,
aa,d){d.d(aa,"a",function(){return e});d.d(aa,"b",function(){return r});var h=d(47);const e=n=>{n=btoa(n);n=n.replace(RegExp("\\+","g"),"-");n=n.replace(RegExp("\\/","g"),"_");return n=n.replace(RegExp("\\=+$","g"),"")},r=n=>{if(h.a.Wa(n))return null;const v=RegExp("%([0-9A-F]{2})","g");n=encodeURIComponent(n);let B="",y=0,x;for(;x=v.exec(n);){const A=v.lastIndex-3;A>y&&(B+=n.substring(y,A));B+=h.a.fromCharCode(parseInt(String("0x"+x[1])));y=v.lastIndex}y<n.length&&(B+=n.substring(y,n.length));return btoa(B)}},
688:function(J,aa,d){d.d(aa,"a",function(){return y});J=d(0);var h=d(27),e=d(176),r=d(93),n=d(14);aa=d(18);var v=d(28),B=d(69);class y{constructor(x,A,E,u,K,G,O,R,V,D,Q,Z,P,ca){this.r5=this.Kl=this.Cx=null;this.HDf=!0;this.LWa=x;this.Yjk=A;this.o$j=E;this.Tdc=u;this.X4=G;this.fc=O;this.Sd=R;this.Pf=V;this.Mjk=D;this.neb=Q;this.Sck=Z;this.Rck=P;this.Qck=ca;this.iJ=K}openDialog(){this.KEi();h.AFrameworkApplication.Aa.Vhb();try{this.Kl.click()}catch(x){const A=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
x.message,x.stack);v.a.J(509727820,818,10,A);throw x;}}submit(){const x=this.Kl.files[0];this.r5=this.o$j();this.r5.mHe&&this.r5.mHe(this.X4,this.fc,this.Sd,this.Pf);if(this.Mjk)this.tIl(x);else{const A=new FormData;for(let u of this.r5.FQd)A.append(u.key,u.value);A.append("fileInputId",x,x.name);const E=new XMLHttpRequest;E.onreadystatechange=()=>{this.IHb(E)};E.open("POST",this.r5.ibh);E.send(A)}}IHb(x){if(4===x.readyState){const A=x.status;if(!A||A>=e.a.Wv&&A<e.a.yii){if(this.r5.onSuccess)this.r5.onSuccess(x.responseText,
this.X4,this.fc,this.Sd,this.Pf,this.Kl)}else this.r5.Bz&&this.r5.Bz(x.responseText,this.X4,this.fc,this.Sd,this.Pf);this.dispose()}}tIl(x){this.neb().J1(this.Tdc,this.iJ,x.size,x,this.r5.FQd.ga("MediaToken"),this.Pf,this.Sck,this.Rck,this.Qck,A=>{if(this.r5.onSuccess)this.r5.onSuccess(A.result,this.X4,this.fc,this.Sd,this.Pf,this.Kl)},A=>{this.r5.Bz&&this.r5.Bz(A.error.Code.toString(),this.X4,this.fc,this.Sd,this.Pf)})}dispose(){this.Cx&&(r.a.removeHandler(this.Kl,"change",Object(n.a)(this,this.cQc,
"fileInputChange")),document.body.removeChild(this.Cx),this.Kl=this.Cx=null,y.$5e.remove(this))}KEi(){this.Cx||(this.Cx=document.createElement("form"),this.Cx.id="uploadFormId",this.Cx.style.visibility=B.a.hidden,this.Cx.method="post",this.Cx.encoding="multipart/form-data",this.Cx.action="",this.Kl=document.createElement("input"),this.Kl.style.visibility=B.a.hidden,this.Kl.type="file",this.Kl.id="uploadFileInputId",this.Kl.name="uploadFileInputId",this.Kl.accept=this.LWa,this.Cx.appendChild(this.Kl),
document.body.appendChild(this.Cx),r.a.addHandler(this.Kl,"change",Object(n.a)(this,this.cQc,"fileInputChange")))}cQc(){this.Kl.value&&this.Kl.value.length?(this.HDf=!1,this.Yjk(this.Kl,this.Sd,this.Pf,this.Tdc).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static OZe(x,A,E,u,K,G,O,R,V,D,Q,Z,P,ca){for(let T of y.$5e)T.HDf&&T.dispose();x=new y(x,A,E,u,K,G,O,R,V,D,Q,Z,P,ca);y.$5e.add(x);x.openDialog()}}y.$5e=new aa.a;Object(J.a)(y,"UploadFileDialog",null,[])},707:function(J,
aa,d){d.r(aa);J=d(0);var h=d(387),e=d(192),r=d(936),n=d(1101),v=d(27),B=d(1100),y=d(14),x=d(1203),A=d(1204),E=d(29),u=d(466);class K extends u.a{constructor(za,ha,ua,Ga,sa,Ba){super();this.init(za);this.Pl("DummyClipboardOperation");this.QEa(v.AFrameworkApplication.Ta,ha,Ga,sa,Ba);this.vu=ua;this.Gp=8;this.KY()}run(){this.TNa=!0;this.Sjb(this.vu);this.Yna();this.Gp=32}}Object(J.a)(K,"DummyClipboardOperation",u.a,[]);var G=d(97),O=d(129),R=d(119),V=d(61);class D{constructor(za,ha,ua){h.ULS.shipAssertTag(6305502,
307,!!za);this.properties=za;this.nd=ha;this.Sqa=ua}get Wc(){return this.nd}G5f(){return this.properties.sa(V.a.JU,"")}hch(){return!0}MEh(){let za,ha=!1;za=null;const ua=this.G5f();if(this.Sqa||""!==ua)try{({l8a:za,returnValue:ha}=this.e4e(ua))}catch(Ga){h.ULS.shipAssertTag(4203138,307,!1),this.Wc.Xb(O.a.Qja,{["Reason"]:R.a.NAf}),G.a.qCa(za)}else h.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Wc.Xb(O.a.R1,{["Reason"]:R.a.Q2d});return{returnValue:ha,oLc:za}}}Object(J.a)(D,"AStringInputImportStrategy",
null,[1051]);class Q extends D{constructor(za,ha,ua,Ga,sa){super(za,ha,sa);this.jk=ua;this.mLd=Ga}e4e(za){const {ClipboardActor:ha}=d(707);let ua;if(this.Sqa&&!za)return h.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,l8a:null};ua=null;if(this.Sqa)return ua=this.jk.rZa(za),{returnValue:!0,l8a:ua};if(this.mLd){const Ga=this.properties.sa(V.a.KKe,"");Ga&&(ua=this.jk.rZa(Ga))}ua||(h.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),
ua=ha.D$g,ua.innerHTML=za);return{returnValue:!0,l8a:ua}}}Object(J.a)(Q,"HtmlStringImportStrategy",D,[]);var Z=d(47);class P extends D{constructor(za,ha,ua){super(za,ha,ua)}e4e(za){let ha;if(this.Sqa&&!za)return h.ULS.sendTraceTag(541172642,307,10,"No htmlDomContent"),{returnValue:!1,l8a:null};ha=document.createElement("div");za=za.split(RegExp("\r\n|\r|\n"));for(var ua=0;ua<za.length-1;ua++){const Ga=document.createElement("p");Ga.innerText=this.roe(za[ua]);ha.appendChild(Ga)}ua=document.createElement("span");
ua.innerText=Z.a.L1d(za[za.length-1]);ha.appendChild(ua);return{returnValue:!0,l8a:ha}}roe(za){return Z.a.L1d(za.length?za:" ")}}Object(J.a)(P,"MultiLineTextImportStrategy",D,[]);class ca extends P{constructor(za,ha,ua){super(za,ha,ua)}G5f(){return this.properties.sa(V.a.yhb,"")}roe(za){za=super.roe(za);return za.length&&" "!==za?za:"\u00a0"}}Object(J.a)(ca,"MultiLinePlainTextImportStrategy",P,[]);class T extends D{constructor(za,ha,ua){super(za,ha,ua)}e4e(za){var {ClipboardActor:ha}=d(707);if(this.Sqa&&
!za)return h.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,l8a:null};ha=ha.D$g;ha.innerText=za;return{returnValue:!0,l8a:ha}}}Object(J.a)(T,"PlainTextImportStrategy",D,[]);var da=d(388);class fa{constructor(za){this.gg=this.Mle=!1;this.GZ=za}hch(){this.Mle||(this.Mle=!0,this.gg=!1,this.GZ.prepareForPaste(()=>{this.gg=!0}));return this.gg}MEh(){let za;this.Mle=!1;za=this.GZ.paste();return za?za.hasChildNodes()?{returnValue:!0,oLc:za}:(h.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),
fa.Wc.Xb(O.a.R1,{["Reason"]:R.a.Q2d}),{returnValue:!1,oLc:za}):(h.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),fa.Wc.Xb(O.a.P8a,{["Reason"]:R.a.j1e}),{returnValue:!1,oLc:za})}static get Wc(){return da.a.instance}}Object(J.a)(fa,"SystemClipboardImportStrategy",null,[1051]);var ma=d(64),ea=d(38),ra=d(51),F=d(41),na=d(34),ka=d(259);d.d(aa,"ClipboardActor",function(){return Ua});class Ua{constructor(za,ha,ua,Ga,sa,Ba,pa,ia){this.m9e=null;this.vUb=0;this.JPh=za;this.GZ=ha;this.nd=ua;
this.jk=Ga;this.Tc=sa;this.Ca=Ba;this.Xs=pa;this.Ngf=!!ia&&ia.ka("SupportImageDragDropExternalIsEnabled");this.yLd=!!ia&&ia.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.gN=new ka.a;this.gN.$(na.a.paste,257);this.gN.$(na.a.O5,8449);this.gN.$(na.a.d8,1);this.gN.$(na.a.pgg,513);this.gN.$(na.a.reformatPastedContent,4097);this.gN.$(na.a.f_a,12289);this.gN.$(na.a.Rhd,7);this.gN.$(na.a.Qhd,1);this.gN.$(na.a.x$g,8193);this.gN.$(na.a.copy,272);this.gN.$(na.a.HIc,16);this.gN.$(na.a.cut,304);this.gN.$(na.a.b_b,
48);this.gN.$(na.a.Pdd,64);this.gN.$(na.a.Qdd,64);this.gN.$(na.a.showPlaceholderGlossary,65536);this.Ngf&&this.gN.$(na.a.RQf,1)}get HGf(){return this.JPh.value}get FA(){return this.GZ}wb(){this.Ca.ra(na.a.JNk,F.a.application,Object(y.a)(this,this.Vjd,"queryPasteOptions"),97);this.Ca.ra(na.a.KNk,F.a.application,Object(y.a)(this,this.Vjd,"queryPasteOptions"),97);this.yLd?this.Ca.ra(na.a.peh,F.a.application,Object(y.a)(this,this.DOe,"queryReformatPasteOptions"),97):this.Ca.ra(na.a.qeh,F.a.application,
Object(y.a)(this,this.DOe,"queryReformatPasteOptions"),97);this.Ca.ra(na.a.reh,F.a.application,Object(y.a)(this,this.DOe,"queryReformatPasteOptions"),97);this.Ca.aW(na.a.b_b,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.aW(na.a.cut,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.MBa(na.a.HIc,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"));this.Ca.MBa(na.a.copy,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"));this.Ngf&&this.Ca.aW(na.a.RQf,F.a.view,
Object(y.a)(this,this.sQi,"dropBrowserContent"),1028);this.Ca.aW(na.a.d8,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.aW(na.a.paste,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.aW(na.a.O5,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.aW(na.a.x$g,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.aW(na.a.Qhd,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.aW(na.a.Rhd,F.a.view,Object(y.a)(this,this.tW,
"clipboardAction"),1028);this.Ca.aW(na.a.reformatPastedContent,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.aW(na.a.f_a,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"),1028);this.Ca.ya(na.a.Cmd,F.a.view,e.ActionManager.Ng);this.Ca.ya(na.a.sFk,F.a.view,e.ActionManager.Ng);this.Ca.ya(na.a.P$g,F.a.view,e.ActionManager.Ng);this.Ca.ya(na.a.Q$g,F.a.view,e.ActionManager.Ng);this.Ca.ya(na.a.R$g,F.a.view,e.ActionManager.Ng);this.Ca.ya(na.a.O$g,F.a.view,e.ActionManager.Ng);this.Ca.MBa(na.a.Pdd,
F.a.view,Object(y.a)(this,this.tW,"clipboardAction"));this.Ca.MBa(na.a.Qdd,F.a.view,Object(y.a)(this,this.Qdd,"moveSelectedContentWithinCurrentParagraph"));this.Ca.MBa(na.a.pgg,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"));this.Ca.MBa(na.a.showPlaceholderGlossary,F.a.view,Object(y.a)(this,this.tW,"clipboardAction"));this.Ca.ya(na.a.rMf,F.a.view,e.ActionManager.Ng);this.Ca.ya(na.a.TMf,F.a.view,e.ActionManager.Ng)}Vjd(za,ha,ua,Ga,sa){if(1===ua)return 32;sa[r.a.On]=!1;return 32}sQi(za,ha,ua,
Ga,sa,Ba){h.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var pa=Ba.DataTransfer;Ba=pa.getData("text/html");pa=pa.getData("text/plain");let ia=!1;const Da=new n.DictionaryPropertySet;0<Ba.length?(h.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Da.setValue(V.a.JU,Ba),ia=!0):0<pa.length&&(h.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Da.setValue(V.a.yhb,pa),ia=!0);if(ia){const Xa=this.gN.ga(ha);return this.HGf.create(za,
ha,Xa,new x.a(()=>this.OOf(Xa,Da)),ua,Ga,sa,Da)}return null}DOe(za,ha,ua,Ga,sa){if(ha=Object(A.a)(Object,sa))v.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),!this.yLd&&za===na.a.qeh||this.yLd&&za===na.a.peh?(za=this.vUb!==na.a.reformatPastedContent&&this.vUb!==na.a.f_a,ha[r.a.On]=this.vUb===na.a.reformatPastedContent||za):za===na.a.reh&&(ha[r.a.On]=this.vUb===na.a.f_a);return 32}tW(za,ha,ua,Ga,sa,Ba){if((v.AFrameworkApplication.BM||
v.AFrameworkApplication.iG)&&!v.AFrameworkApplication.ORa||ea.a.instance.ga(83))return new K(za,ha,ua,Ga,sa,Ba);const pa=this.gN.ga(ha);1!==Ga&&pa&1&&(this.vUb=ha);1!==Ga&&Ba&&pa&1&&(this.m9e=Ba);1!==Ga&&!Ba&&pa&4096&&(Ba=this.m9e);return this.HGf.create(za,ha,pa,new x.a(()=>this.OOf(pa,Ba)),ua,Ga,sa,Ba)}Qdd(za,ha,ua,Ga,sa,Ba){Ba=ra.a.Mj(ma.a.instance.Na.mb.Ua.node,Ba);return this.tW(za,ha,ua,Ga,sa,Ba)}OOf(za,ha){return za&256?new fa(this.FA):za&2?za&4096?new Q(ha,this.nd,this.jk,E.App.instance.g$b,
E.App.instance.KMb):new T(ha,this.nd,E.App.instance.KMb):ha.Sa(V.a.yhb)?new ca(ha,this.nd,E.App.instance.KMb):new Q(ha,this.nd,this.jk,E.App.instance.g$b,E.App.instance.KMb)}static get D$g(){return B.a.j$a("Box4PasteScratchPad")}}Object(J.a)(Ua,"ClipboardActor",null,[])},714:function(J,aa,d){J=d(0);var h=d(18),e=d(14),r=d(399),n=d(400);class v{constructor(u,K,G,O=0,R=0,V=null,D=null){this.commandId=u;this.controlId=K;this.timeStamp=G;this.commandSurface=r.a[O];this.Iu=n.a[R];this.contentType=V;this.atd=
D}}Object(J.a)(v,"CommandActionInfo",null,[]);class B{constructor(){this.BNh=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}FYj(u){return!this.BNh.exec(u)}}Object(J.a)(B,"EventsCacheLoggingUtils",null,[]);var y=d(27),x=d(1124),A=d(763);d.d(aa,"a",function(){return E});class E{constructor(){this.Lif=null;this.wGd=20;this.Qyc=this.z2a=this.uRb=null}init(){this.Lif=new B;this.uRb=new h.a;this.z2a=new h.a;this.Qyc=new h.a;this.wGd=y.AFrameworkApplication.fa.Bc("MaxCommandClickedEventQueueSize",
20);x.a.Y$h(Object(e.a)(this,this.Hwi,"commandClickEventRaised"));A.a.instance.Quf(Object(e.a)(this,this.MSk,"recordActionEvent"))}E3e(u){u.count>this.wGd&&u.removeAt(this.wGd)}Hwi(u,K){this.uRb.insert(0,new v(K.commandId,K.controlId,K.time,K.commandSurface,K.Iu,K.contentType));this.E3e(this.uRb)}MSk(u,K){this.z2a.insert(0,new v(K.actionName,K.controlId,K.timeStamp,K.commandSurface,K.Iu,K.contentType,K.atd));this.E3e(this.z2a);this.Lif.FYj(K.actionName)&&(this.Qyc.insert(0,new v(K.actionName,K.controlId,
K.timeStamp,K.commandSurface,K.Iu,K.contentType,K.atd)),this.E3e(this.Qyc))}static get instance(){return E.Ka||(E.Ka=new E)}}E.Ka=null;Object(J.a)(E,"CommandClickEventsCache",null,[])},716:function(J,aa,d){d.r(aa);J=d(0);var h=d(722),e=d(27),r=d(47),n=d(55),v=d(109),B=d(1205),y=d(1206),x=d(24),A=d(332);const E=(P,ca)=>{if(P){P=P.trim().toLowerCase();if("true"===P)return!0;if("false"===P)return!1}return ca};var u=d(734),K=d(28),G=d(960),O;(function(P){P[P.none=0]="none";P[P.internal=1]="internal";
P[P.clipService=2]="clipService"})(O||(O={}));Object(J.b)("ClipboardIframeContent",O);var R=d(386),V=d(681),D=d(445),Q=d(49);d.d(aa,"ClipboardHelper",function(){return Z});class Z{constructor(P,ca,T,da,fa,ma){this.M7j=[A.a.xW,A.a.Jp,A.a.location,A.a.tD,A.a.type,A.a.IGe,A.a.count,A.a.mFa,A.a.kFa,A.a.skb,A.a.slideId,A.a.sessionId,A.a.timeStamp,A.a.Cy];this.WAe=new h.a;this.qAe=new B.a(y.a.Hn());this.Jq=P;this.wvg=ca;this.Cc=ma;if(T&&0<T.length){P=T.split(";");for(const ea of P)P=this.X4f(ea),0<P.length&&
this.WAe.add(P)}this.N7j=da;this.bye=fa;if(this.S_c()){da=e.AFrameworkApplication.fa.Ga("PicklingAPIMaxPackageSizeInMB").split(";");for(const ea of da)da=ea.split(":"),2===da.length&&0<da[0].length&&0<da[1].length&&this.qAe.add(da[0],parseInt(da[1]))}}zwd(P,ca,T,da,fa,ma,ea){if(P.contentWindow&&P.contentWindow.document&&P.contentWindow.document.body){Q.a.j0b(P);const F=Q.a.Eca();var ra=document.createTextNode(Q.a.gGe);F.appendChild(ra);ra=null;let na=0;if(!ca)K.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",
ea),Sys.UI.DomElement.addCssClass(F,Q.a.B1d);else if(ca.length&&ca[0]&&ca[0].o7a&&(Sys.UI.DomElement.addCssClass(F,this.Jq.Yq[0].o7a),na=1,T)){r.a.Wa(T.tD)&&K.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",T.Jp);na=2;ca=u.a(T.dataType);F.setAttribute(A.a.xW,T.xW);F.setAttribute(A.a.QQa,T.QQa);F.setAttribute(A.a.Jp,T.Jp);F.setAttribute(A.a.version,T.version);F.setAttribute(A.a.location,T.location);F.setAttribute(A.a.tD,T.tD);F.setAttribute(A.a.type,
ca);F.setAttribute(A.a.count,T.objectCount.toString());F.setAttribute(A.a.mFa,T.mFa);F.setAttribute(A.a.kFa,T.kFa);F.setAttribute(A.a.Cy,T.Cy);const ka=(new Date).toUTCString();K.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",ca,T.mFa,ka);F.setAttribute(A.a.timeStamp,ka);if(1===T.dataType||2===T.dataType)ca=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ga("361"))+"?Id="+r.a.Ne(T.Jp)+"&DC="+r.a.Ne(T.tD)+
"&pkey="+r.a.Ne(T.Cy)+"&wdwaccluster="+r.a.Ne(T.tD)+"&DataType="+ca,F.setAttribute(A.a.ivi,ca);T.Yjc&&F.setAttribute(A.a.IGe,this.m$k(T.Yjc));1===T.dataType&&this.bye&&(ra=Q.a.SA(),ra.id=A.a.oeg,ra.setAttribute(A.a.mDj,"true"),T=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ga("361"))+"?Id="+r.a.Ne(T.Jp)+"&DC="+r.a.Ne(T.tD)+"&pkey="+r.a.Ne(T.Cy)+"&wdwaccluster="+r.a.Ne(T.tD),ra.src=T)}F.setAttribute(A.a.sessionId,da);F.setAttribute(A.a.skb,fa?fa.join(","):"");ma?F.setAttribute(A.a.slideId,
ma.cid.toString()+"+"+ma.sid.toString()):F.setAttribute(A.a.slideId,"");P.contentWindow.document.body.appendChild(F);ra&&P.contentWindow.document.body.appendChild(ra);this.Cc.$h(R.a.hCi,O[na],ea)}}eTj(P){var ca="";n.a.Vj?ca="Chromium":n.a.fg?ca="Firefox":n.a.eac&&(ca="Safari");ca=this.qAe.Gb(ca)?this.qAe.ga(ca):0;(ca=Math.ceil(P)<=ca)||K.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",n.a.Wy,P);return ca}SNj(P){return P&&Sys.UI.DomElement.containsCssClass(P,Q.a.B1d)?
!0:!1}VNj(P){return!!P&&!!P.getAttribute&&E(P.getAttribute(A.a.kFa),!1)}tYj(P){return!!P&&!!P.Bm&&!!P.Bm.firstChild&&!!P.Bm.firstChild.className&&this.uYj(P.Bm.firstChild.className)}uYj(P){return!!P&&P.startsWith("CID")&&v.a.isValid(P.substring(3,P.length))}kYj(P){return!!P&&!!P.Jp&&!!P.tD&&0!==P.dataType&&0<P.objectCount&&!!P.Cy}Pjl(P){if(!this.dKj(P))return K.a.J(512329174,307,50,"DC '{0}' is not allowed",P.tD),!1;if(P.Qsa&&"TimeStamp"in P.Qsa){var ca=new Date(Date.parse(P.Qsa.TimeStamp));P=60*
this.N7j-5;ca=Z.cDf(ca);if(ca>=P)return K.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",P,ca),!1}return!0}X4f(P){return P?P.trim().toUpperCase():""}dKj(P){return!this.Lje(P)||this.WAe.contains(this.X4f(P.tD))||this.WAe.contains("ALL")}Ahg(P){return!!P&&!!P.WW&&!!P.WW.length&&!!P.WW[0]}Bhg(P){return this.Ahg(P)&&Object(x.a)(D.a,P.WW[0])}YKj(P){return this.Ahg(P)&&Object(x.a)(V.a,P.WW[0])}jje(P){return!!P&&!!P.Du&&this.Pjl(P.Du)}XKj(P){return this.jje(P)&&1===
P.Du.dataType}WKj(P){return this.jje(P)&&2===P.Du.dataType}VKj(P){return this.jje(P)&&3===P.Du.dataType}ZKj(P){return!!P&&!!P.zM}$Kj(P){return this.ZKj(P)&&1===P.zM.contentType}S_c(){return!(n.a.px||n.a.eac)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}qvi(P,ca){if(P&&ca&&P.getAttribute)for(const T of this.M7j){const da=P.getAttribute(T);da&&ca.setAttribute(T,da)}}Lje(P){if(P.tD!==this.wvg)return K.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",
u.a(P.dataType),P.tD,this.wvg,P.Jp)),!0;K.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",u.a(P.dataType),P.tD,P.Jp));return!1}RVi(P,ca){var T=P.getAttribute(A.a.Jp),da=parseInt(P.getAttribute(A.a.version)),fa=P.getAttribute(A.a.Cy),ma=parseInt(P.getAttribute(A.a.xW)),ea=parseInt(P.getAttribute(A.a.QQa)),ra=P.getAttribute(A.a.type);ra=ra?u.b(ra):2;var F=Object,na=F.assign,ka=new G.a;ma=isNaN(ma)?32:ma;ea=isNaN(ea)?0:ea;da=isNaN(da)?0:da;var Ua=P.getAttribute(A.a.location),
za=P.getAttribute(A.a.tD),ha=P.getAttribute(A.a.count);ha=parseInt(ha);T=na.call(F,ka,{xW:ma,QQa:ea,Jp:T,version:da,location:Ua,tD:za,dataType:ra,objectCount:isNaN(ha)?-1:ha,mFa:E(P.getAttribute(A.a.mFa),!1),kFa:E(P.getAttribute(A.a.kFa),!1),Cy:fa});fa=Z.YVi(P);ra=Z.bWi(P);T.Qsa={["SessionId"]:fa,["TimeStamp"]:ra?ra.toUTCString():""};ca=Z.xTd(T,ra,this.Cc,ca);K.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",ca);if(P=P.getAttribute(A.a.IGe))T.Yjc=this.rMi(P);return T}m$k(P){return JSON.stringify(P)}rMi(P){try{return JSON.parse(P)}catch(ca){return K.a.J(512329169,
826,15,"{0} when parse json string: {1}",ca.toString(),P),null}}static Shg(P){return P&&P.Qsa&&"SessionId"in P.Qsa?Z.Pmg(P.Qsa.SessionId.toString()):!1}static Pmg(P){return r.a.Wa(P)||r.a.Wa(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===P.toLowerCase()}static xTd(P,ca,T,da){const fa=u.a(P.dataType);P=String.format("A {0} ClipServiceObject was just created: '{1}'",fa,P);ca&&(ca=Z.cDf(ca),P+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",
ca),T.$h("CopyPasteElapsedSec",ca.toString(),da));return P}static YVi(P){P=P.getAttribute(A.a.sessionId);return void 0===P||null===P?"":P}static bWi(P){P=P.getAttribute(A.a.timeStamp);return void 0===P||null===P?null:new Date(Date.parse(P))}static cDf(P){var ca=new Date;if(!P)throw Error.argumentNull("fromTime");if(!ca)throw Error.argumentNull("toTime");return(ca.getTime()-P.getTime())/1E3}}Object(J.a)(Z,"ClipboardHelper",null,[1158])},727:function(J,aa,d){J=d(0);class h{}Object(J.a)(h,"AuthContext",
null,[]);var e=d(27),r=d(226);d.d(aa,"a",function(){return n});class n{static getAuthContext(){const v=e.AFrameworkApplication.fa.Ga("UserPrincipalName")||"";let B=v;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(B=r.OAuthManagerSettings.erk||v);return Object.assign(new h,{upn:v,loginHint:B,authority:r.OAuthManagerSettings.authority,authorityType:n.RRc(),tenantId:e.AFrameworkApplication.fa.Ga("TenantId")||""})}static RRc(){let v=0;const B=
n.B_f();"aad"===B.toLowerCase()?v=2:"msa"===B.toLowerCase()&&(v=1);return v}static B_f(){return e.AFrameworkApplication.fa.Ga("HostAuthType")||""}}Object(J.a)(n,"OAuthIdentity",null,[])},731:function(J,aa,d){J=d(0);var h=d(14),e=d(27),r=d(81),n=d(55),v=d(47),B=d(109);class y{constructor(G,O){this.message=G;this.Zi=O}}Object(J.a)(y,"CrossDocumentEventArgs",null,[]);var x=d(530),A=d(175),E=d(574),u=d(925);d.d(aa,"a",function(){return K});class K{constructor(G,O,R,V){this._name="";this.KMa={};this.njf=
null;this.fWb=[];this.TSb=[];this.USb=[];this.tVb=[];this.jqf=G;this.iqf=O;this.q7={};this.yba={};this.cVb=R;K._id++;V&&V();this.yG=this.enable()}get NLa(){return this.iqf}get OBh(){return this.jqf}enable(){if(!E.a())return u.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.FIj();u.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.yG}FIj(){u.a.debugAssertTag(5018253,!!this.cVb,null);this.njf=Object(h.a)(this,this.vnk,"messageListener");this.cVb.Bhi(this.njf)}disable(){this.yG=
!1;this.fWb=[];this.TSb=[];this.USb=[];this.tVb=[];this.jqf=null;this.iqf="";this.cVb.NMi();this.q7={};this.yba={}}dispose(){this.disable()}dle(G){return!!this.fWb&&Array.contains(this.fWb,G)||this.Vkg(G)}Vkg(G){return!!this.TSb&&Array.contains(this.TSb,G)}yu(G){u.a.debugAssertTag(5018259,!!this.fWb,null);Array.add(this.fWb,G);u.a.sendTraceTag(5018260,2,"Allow receiving : {0}",G)}Bsf(G){u.a.debugAssertTag(5018261,!!this.TSb,null);Array.add(this.TSb,G);u.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",
G)}nRj(G){return!!this.USb&&Array.contains(this.USb,G)}Csf(G){u.a.debugAssertTag(5018263,!!this.USb,null);Array.add(this.USb,G);u.a.sendTraceTag(5018264,2,"Allow free sending: {0}",G)}C$b(G){G=r.a.sQ(G);return!!G&&!!this.tVb&&Array.contains(this.tVb,G)}LBa(G){u.a.debugAssertTag(5018265,!!this.tVb,null);if(G===K.lZb)return u.a.debugAssertTag(5018266,!1,null),!1;let O=r.a.sQ(G);if(!O)return u.a.sendTraceTag(5018267,4,"Get origin fail:{0}",G),!1;e.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&
(O=v.a.rg(O));Array.add(this.tVb,O);u.a.sendTraceTag(5018268,2,"Add origin:{0}",O);return!0}send(G,O=null){let R=this.NLa;if(O){O=r.a.sQ(O);if(!O)return!1;R=O}return this.Ijb(G,this.OBh,R)}sendMessage(G,O,R=""){R=R&&""!==R?R:B.a.create().toString();return this.send(this.dKe(G,O,R,e.AFrameworkApplication.userSessionId))}postMessage(G){const O=B.a.create().toString();if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!G.shouldRetry)return this.send(this.dKe(G.messageId,G.values,O,
G.userSessionId));if(!this.q7[G.XFc]){this.yu(G.XFc);const R=Object(h.a)(this,this.ackMessageHandler,"ackMessageHandler");this.KB(G.XFc,R)}this.KMa[O]="";return this.mbh(G,O,1)}mbh(G,O,R){if(""!==O&&O in this.KMa&&"ACK_RECEIVED"===this.KMa[O])return delete this.KMa[O],!0;if(R>G.Owa)return u.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',G.XFc,O),delete this.KMa[O],!1;u.a.sendTraceTag(40716251,1<R?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',
G.Owa-R,G.messageId,O);R++;window.setTimeout(()=>{this.mbh(G,O,R)},G.X4h);G.values[A.a.W4h]=!0;return this.send(this.dKe(G.messageId,G.values,O,G.userSessionId))}ackMessageHandler(G){G=G.CorrelationId;""!==G&&G in this.KMa&&(u.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.KMa[G],G),this.KMa[G]="ACK_RECEIVED")}dKe(G,O,R,V){G=new x.a(G);G.CorrelationId=R;O&&(G.Values=O);G.Values.wdUserSession=V;return G}Ijb(G,O,R){u.a.debugAssertTag(5018269,!!G,null);if(!this.yG)return!1;
u.a.debugAssertTag(5018270,!!O,null);u.a.debugAssertTag(5018271,!!R,null);if(!O||!R)return u.a.debugAssertTag(5018272,!1,null),!1;if(R===K.lZb&&!this.nRj(G.MessageId))return u.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:G.MessageId}),!1;G.SendTime=(new Date).getTime();let V="";try{V=Sys.Serialization.JavaScriptSerializer.serialize(G)}catch(D){return u.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:D.message}),!1}O=K.sendMessage(O,V,R);u.a.sendTraceTag(5018275,2,
"Send {0}. {1}",O?"succeeded":"failed",{["id"]:G.MessageId,["origin"]:R});return O}KB(G,O){u.a.debugAssertTag(5018304,!!O,null);u.a.debugAssertTag(5018305,!!this.q7&&!!this.yba,null);this.yG&&(this.dle(G)?this.q7[G]!==O&&(u.a.debugAssertTag(5018307,!this.q7[G]&&!this.yba[G],null),this.q7[G]=O,delete this.yba[G]):u.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:G}))}i_a(G,O){u.a.debugAssertTag(40420062,!!O,null);u.a.debugAssertTag(40420063,!!this.yba&&!!this.q7,null);this.yG&&(this.dle(G)?
this.yba[G]!==O&&(u.a.debugAssertTag(40420065,!this.q7[G]&&!this.yba[G],null),this.yba[G]=O,delete this.q7[G]):u.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:G}))}aDl(G){this.yG&&(this.q7[G]&&delete this.q7[G],this.yba[G]&&delete this.yba[G])}vnk(G){const O=this.$dj(G);if(!O)return!1;if(this.q7[O.MessageId])return this.cVb.AYc(this.q7[O.MessageId],O),!0;if(this.yba[O.MessageId]){let R=this.yba[O.MessageId];G=new y(O,G);this.cVb.oJj(R,G);return!0}return!1}$dj(G){const O=new Date;this.f5j(G);
if(!G.origin||!G.source||void 0===G.data||null===G.data)return u.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const R=this.tZj(G.data);if(!R)return null;if(!this.C$b(G.origin)){if(!this.Vkg(R.MessageId))return u.a.sendTraceTag(5018309,1,"{0}",{["id"]:R.MessageId}),null;if(!n.a.bbb&&G.source!==this.OBh)return u.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}u.a.debugAssertTag(5018311,!!R.Values,null);R.Values.m_Source=G.source;
R.Values.m_Origin=G.origin;R.Values.m_ReceivedTime=O.getTime();return R}tZj(G){if(!G)return null;let O=null;try{O=Sys.Serialization.JavaScriptSerializer.deserialize(G,!0)}catch(D){return 2>K.naf&&(u.a.sendTraceTag(5018312,2,"Deser failed"),K.naf++),null}if(!O)return u.a.debugAssertTag(5018313,!1,null),null;for(G=0;G<K.AMc.length;G++)if(!O[K.AMc[G]])return"MessageId"!==K.AMc[G]&&u.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",K.AMc[G]),null;if(O.Values)try{O.Values}catch(D){return u.a.sendTraceTag(5018314,
4,"Not a valid dictionary: {0}",D.message),null}else u.a.sendTraceTag(41502556,2,"No values in message");G=O.MessageId;if(!this.dle(G))return u.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:G}),null;const R=O.SendTime,V=(new Date).getTime()-R;if(0>R)return u.a.sendTraceTag(520435660,2,"{0}",{["t"]:R,["id"]:G}),null;6E4<V&&u.a.sendTraceTag(520435659,2,"{0}",{["t"]:R,["delta"]:V,["id"]:G});-300>V&&u.a.sendTraceTag(520435658,2,"{0}",{["t"]:R,["delta"]:V,["id"]:G});G=new x.a;G.MessageId=O.MessageId;
G.SendTime=O.SendTime;G.CorrelationId=O.CorrelationId;O.Values&&(G.Values=O.Values);u.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",G.MessageId,G.SendTime,G.CorrelationId);return G}f5j(G){u.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:G.origin,["data"]:G.data,["source"]:G.source}))}static sendMessage(G,O,R){if(!E.a())return u.a.debugAssertTag(5018319,!1,null),!1;try{return G.postMessage(O,R),!0}catch(V){u.a.sendTraceTag(5018320,
4,"{0}",{["exception"]:V.message})}return!1}}K.AMc=["MessageId","SendTime"];K.lZb="*";K._id=0;K.naf=0;Object(J.a)(K,"CrossDocumentMessenger",null,[106,371])},732:function(J,aa,d){d.r(aa);var h=d(278);J=d(0);var e=d(398),r=d(78),n=d(142),v=d(93),B=d(67),y=d(289),x=d(27),A=d(47),E=d(270),u=d(55),K=d(96),G=d(28),O=d(35),R=d(86),V=d(954),D=d(946),Q=d(944),Z=d(947),P=d(948),ca=d(951),T=d(952),da=d(949),fa=d(945),ma=d(953),ea=d(950),ra=d(57);class F{createAuthProviderAsync(za){ra.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").dja();
return new Promise(ha=>{ra.a.instance.Ja("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(ua=>{ua=ua.mDi(za);ha(ua)})})}}Object(J.a)(F,"SlideShowAppForOfficeAuthFactory",null,[]);var na=d(1008),ka=d(72);d.d(aa,"SlideShowCoreFrame",function(){return Ua});class Ua{constructor(za,ha,ua,Ga,sa,Ba,pa,ia,Da,Xa,Ka,Ma,Oa,qa){this.Om=this.$gc=this.T9c=null;this.Sea=new e.a;this.va=new r.a;this.SDe="";this.yw=null;this.zcd="";this.rCe=this.EBg=this.Uhc=this.aR=this.H$=this.G$=this.uva=this.K=null;this.Whc=
!0;this.mXa=Date.now();this.kXa=Date.now();this.odb=this.gVg=0;this.kDb=!1;this.ouk=()=>{G.a.J(512309270,830,50,"SlideShowCoreFrame::OnEditHappened");this.kXa=Date.now()};this.ewk=()=>{G.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.kXa=Date.now()};this.Xxk=()=>{G.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.kXa=Date.now()};this.kf=za;this.la=ha;this.Hc=ua;this.kCb=Ga;this.Ll=sa;this.Ub=Ba;this.lO=ia;this.fu=pa;this.IDe=Da;this.qe=Xa;this.lxg=
Ka;this.ei=Ma;this.HO=Oa;this.Ds=qa;this.Rik=n.a.getInstance();this.lxg&&this.lxg.execute(Ya=>{Ya.VGc(this.ouk)});this.ei&&(this.ei.z$h(this.ewk),this.ei.vbi(this.Xxk));try{const Ya=this.g5=JSON.parse(this.la.Ga("Settings"))||{};Ya.slideshowcore||(Ya.slideshowcore={});Ya.slideshowcore&&Ya.slideshowcore.forceSvg&&"true"===Ya.slideshowcore.forceSvg.toString().toLowerCase()?this.IDe=!0:this.IDe&&(Ya.slideshowcore.forceSvg="True");Ya.slideshowcore.enableCameoInPPTOSlideShow=this.la.OOc.toString()}catch(Ya){G.a.J(512495906,
830,15,"Exception in parsing settings:{0}",Ya),this.g5={}}}preloadShaders(){this.xXe();this.jqd();SlideShowCore.SlideShowCore.preloadShaders()}init(za,ha,ua,Ga){return Object(h.a)(this,void 0,void 0,function*(){this.SDe=ua;this.HO=Ga;this.zcd=ha;if(this.yw)G.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.uec);else{this.uva=document.getElementById("HiddenFocusTrapAnchor");this.yw=document.createElement("div");this.yw.id="SlideShowBackground";this.yw.className="SlideShowBackground";
this.yw.style.visibility=ka.a.Qs;this.yw.tabIndex=-1;this.K=document.createElement("div");this.K.id="SlideShowContainer";this.K.className="SlideShowContainer";this.K.tabIndex=-1;this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";v.a.addHandler(this.yw,B.a.Pwa,pa=>{this.Jwk(pa)});y.a.instance.pb(this.yw,pa=>this.Tgb(pa));this.yw.appendChild(this.K);O.a("PresenterCoachTabFix")&&this.uva?this.kf.insertBefore(this.yw,this.uva):this.kf.appendChild(this.yw);var sa=
this.la.Ga("pptSlideShowCoreCssUrl"),Ba=document.createElement("link");Ba.setAttribute("rel","stylesheet");Ba.setAttribute("type","text/css");Ba.setAttribute("href",sa);this.K.appendChild(Ba);na.a.instance.init(this.la,this.yw,this.Hc,this,this.Ll,this.Ub,this.lO);this.G$=document.getElementById("slideshowBeginningFocusTrap");this.H$=document.getElementById("slideshowEndFocusTrap");this.G$||this.H$||(this.G$=document.createElement("div"),this.G$.id="slideshowBeginningFocusTrap",this.G$.className=
"FocusTrap",this.G$.tabIndex=0,v.a.addHandler(this.G$,B.a.focus,pa=>{this.Xkc(pa)}),this.H$=document.createElement("div"),this.H$.id="slideshowEndFocusTrap",this.H$.className="FocusTrap",this.H$.tabIndex=0,v.a.addHandler(this.H$,B.a.focus,pa=>{this.Xkc(pa)}),O.a("PresenterCoachTabFix")&&this.uva?(this.kf.insertBefore(this.G$,this.kf.firstChild),this.kf.insertBefore(this.H$,this.uva.nextSibling)):(sa=document.getElementById("slideshow-toolbar"),this.kf.insertBefore(this.G$,this.yw),this.kf.insertBefore(this.H$,
sa)));this.uec=this.K7f(1)}yield this.uec})}K7f(za){return Object(h.a)(this,void 0,void 0,function*(){const ha=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.HO),ua={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ua["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;const Ga=new Date;return new Promise((sa,Ba)=>{this.Ds.nj(ha,1,"",ua,!1,0,pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.oIe(pa,
Ga);G.a.J(509636751,830,50,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");sa()}),pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.nIe(pa,za);G.a.J(509636750,830,50,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");Ba()}),null,null)})})}oIe(za,ha){return Object(h.a)(this,void 0,void 0,function*(){G.a.J(512309283,830,50,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+ha);const ua=JSON.parse(za.data.Wd);this.aR=ua.downloadUrl;A.a.Wa(this.aR)?
G.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",ua):(this.mXa=Date.now(),yield this.VEj())})}n6f(){const za={};za.settings=this.g5;za.retryCount=this.la.Bc("GetItemsRetryCount",3);za.retryOnCategories=this.la.Ga("GetItemsRetryCategories").split(";");const ha={};ha.Slide=ResourceStrings.l_Slide;ha.AnimNum=ResourceStrings.l_AccSsAnimNum;ha.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;ha.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;
ha.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;ha.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;za.localizedStrings=ha;return za}VEj(){return Object(h.a)(this,void 0,void 0,function*(){this.xXe();this.jqd();this.T9c=new PodsProxy.PodsProxy(this.la.W9a?this.la.BTc:this.la.podsWebServiceBase,{DownloadUrl:this.aR,DocID:x.AFrameworkApplication.hh,CustomFontCatalogUrl:this.la.Ga("CustomFontCatalogURL")},this.la.MJa?A.a.pQ(this.la.MJa).toLowerCase():"",this.Sea,this.M5f(),this.N5f());
this.$gc=new SlideShowCore.DefaultResourceProviders(this.T9c,this.Sea,this.n6f());const za={};za.initTime=Ua.h6b();za.uiHost="Unified App";za.serverUrl=A.a.Ne(this.la.podsWebServiceBase);za.userSessionId=this.SDe;za.jsScriptsBasePath=this.la.Ga("StaticContentHost")+"pptscripts/ssapp/";za.fileHost=this.la.Ga("FileHost");za.isRtl=x.AFrameworkApplication.isRtl;za.applicationLcid=x.AFrameworkApplication.lcid;za.applicationLocaleName=x.AFrameworkApplication.uiCulture;za.areThirdPartyAddInsAllowed=x.AFrameworkApplication.Mia;
za.theWsaClient=x.AFrameworkApplication.kj;za.appForOfficeContextActivationParameters=V.a.Z7f(this.qe);za.hubbleVideoEndpoint=this.la.insertOnlineVideoEndpoint;za.acceptLanguage=E.a.xe(x.AFrameworkApplication.lcid).name;this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ModernSlideShowAddInSSO",!1)&&(za.appForOfficeAuthFactory=new F);const ha={};ha.settings=this.g5;ha.transitionResourceCDNPath=this.la.RMf;ha.transitionDisabledList=this.la.fMa;ha.clickTargetEnabled=!0;ha.mediaEnabled=
!0;ha.gifEnabled=!0;ha.convertGifToVideo=!0;ha.crossSlideAudioEnabled=!0;ha.editAudioEnabled=this.la.ka("PPTOAudioPlaybackOptionsEnabled");ha.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");ha.useNewYoutubePlayer=!0;ha.useNewVimeoPlayer=!0;ha.useOnlineVideoPlayer=!0;ha.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");ha.isStream2Enabled=this.la.ka("IsStream2VideoEnabled");ha.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;ha.enableSVGAsWebGLTexture=!u.a.fg&&
this.la.ka("SlideShowShapeBuilderSVGEnabled");ha.maxSvgTextureSize=this.la.Bc("ShapeBuilderMaxSvgTextureSize",2048);ha.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");ha.slideSizeMax={["x"]:this.la.Bc("SlideShowMaxWidth",1504),["y"]:this.la.Bc("SlideShowMaxHeight",849)};ha.slideSizeMin={["x"]:this.la.Bc("SlideShowMinWidth",348),["y"]:this.la.Bc("SlideShowMinHeight",261)};ha.slideSizeDefault={["x"]:this.la.Bc("SlideShowDefaultWidth",1504),["y"]:this.la.Bc("SlideShowDefaultHeight",849)};ha.streamVideoUseThinEmbed=
this.la.ka("StreamVideoUseThinEmbed");ha.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");ha.disabledChangeGates=this.la.Ga("PPTDisabledChangeGates");ha.combineBootRequest=!0;ha.localVideoTelemetryEnabled=this.la.ka("IsGFXVideoLocalTelemetryEnabled");ha.imageSettings={["imageAppendOption"]:"all"};const ua={["slideShowCoreSettings"]:ha,["appSettings"]:za};this.Om=new SlideShowCore.SlideShowCore(this.K,this.$gc,this.Sea,ua);new SlideShowCore.PrefetchAddon(this.Om,this.Sea,{["forwardPrefechCount"]:this.la.Bc("PptModernSlideShowForwardPrefetchCount",
10),["backwardPrefechCount"]:this.la.Bc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.Bc("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.la.Bc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Om,this.Sea);this.gVg=Date.now();this.rCe=this.Om.init();this.Om.events.on("slideLocationChanged",()=>{this.ugd()});this.Om.events.on("animationStateChanged",()=>{this.ugd()});this.Om.events.on("slideDimensionsChanged",
()=>{this.getCurrentSlideDimensions()});this.Om.events.on("exitFromEndOfShow",()=>{this.bIe(!0)});this.Om.events.on("blankSlideStateChanged",Ga=>{this.Fsk(Ga)});this.Om.events.on("slideshowError",Ga=>{this.tfd(Ga)});return new Promise(Ga=>{this.rCe.then(()=>{this.Whc=!1;this.EBg=new SlideShowCore.InputsAddon(this.Om,this.K,x.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Om,ua,this.Sea);new SlideShowCore.TransitionLoggerAddon(this.Om,ua,this.Sea);new SlideShowCore.PerfCheckerAddon(this.Om,
ua,this.Sea);this.Uhc=new SlideShowCore.SlideShowInkAddon(this.Om,this.Sea,this.K,()=>this.kCb.loadScript("slideshowink"),{["telemetryLogger"]:this.Rik});this.la.OOc&&(this.hbd=new SlideShowCore.CameoWebcamAddon(this.Om));this.EBg.events.on("keydown",sa=>{this.qJa(sa)});G.a.J(509636749,830,50,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");Ga()})})})}N5f(){const za={};za.timeout=this.la.Bc("PptModernSlideShowGetItemsTimeoutMs",3E4);za.throwHttpErrors=!1;za.enableServerSpecificErrorCode=
O.a("SSCore.EnableServerSpecificErrorCode");return za}jqd(){try{const za=this.g5;if(za.slideshowcore){const ha={};ha.settings=za;ha.logger=this.Sea;ha.disabledChangeGates=this.la.Ga("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(ha)}}catch(za){G.a.J(509703488,830,15,"Exception in passing settings to slideshowcore:{0}",za)}}xXe(){try{const za=this.g5;if(za.podsproxy){const ha={};ha.settings=za;window.PodsProxy.setupGlobals_PodsProxy(ha)}}catch(za){G.a.J(512309267,830,15,
"Exception in passing settings to podsproxy:{0}",za)}}UIh(za,ha){return Object(h.a)(this,void 0,void 0,function*(){this.xXe();this.jqd();this.T9c=new PodsProxy.PodsProxy(this.la.W9a?this.la.BTc:this.la.podsWebServiceBase,{DownloadUrl:this.aR,DocID:x.AFrameworkApplication.hh,CustomFontCatalogUrl:this.la.Ga("CustomFontCatalogURL")},this.la.MJa?A.a.pQ(this.la.MJa).toLowerCase():"",this.Sea,this.M5f(),this.N5f());const ua=this.$gc;this.$gc=new SlideShowCore.DefaultResourceProviders(this.T9c,this.Sea,
this.n6f());yield this.Om.updateResourceProviders(this.$gc,{shouldRerenderSlide:!0});ua&&ua.dispose();G.a.J(593827098,830,50,"Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",za,ha,Date.now(),this.vbb())})}nIe(za,ha){return Object(h.a)(this,void 0,void 0,function*(){const ua=za.data?za.data.ie:-1;0<ha--?(G.a.J(512309281,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
ua),yield this.K7f(ha)):G.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",ua)})}Srd(za,ha,ua,Ga,sa,Ba,pa,ia,Da){Object(h.a)(this,void 0,void 0,function*(){this.uec&&(G.a.J(509617947,830,50,"SlideShowCoreFrame::StartFrom - initPromise {0}",this.uec),yield this.uec,this.vbb()||this.show());if(this.Om&&!A.a.Wa(this.aR)){const Xa={};this.kXa>this.mXa||this.Whc?(this.g5.slideshowcore.vetoBootDurationMs=this.la.Bc("PptModernSlideShowEditVetoBootDurationMs",8E3),Xa.BootScenario=
this.kXa>this.mXa?"AfterEdit":"Init",G.a.J(509703459,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Bc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.kXa,this.mXa,this.Whc)):(this.g5.slideshowcore.vetoBootDurationMs=this.la.Bc("PptModernSlideShowCachedVetoBootDurationMs",2E3),Xa.BootScenario="Relaunch",G.a.J(509703458,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",
this.la.Bc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.kXa,this.mXa,this.Whc));this.jqd();this.kXa>this.mXa&&(yield this.VIh(1));Xa.startFromTime=Da-window.performance.timing.navigationStart;Xa.SSCoreFrameStartTime=Ua.h6b();na.a.instance.iZk();this.K.style.top="0";this.G$&&this.H$&&(this.G$.tabIndex=0,this.H$.tabIndex=0);const Ka={["slideId"]:{["sid"]:za,["cid"]:0}};Ka.slideIndex=ha-1;this.fu.a$b&&!this.fu.m9?this.xsi(Ka,Xa):this.iXf(Ka,Xa)}else G.a.J(512495901,830,15,"Failed to get download Url")})}prev(){this.Om&&
this.Om.prevStep("0_anim").then(()=>{})}next(){this.Om&&this.Om.nextStep("0_anim",3).then(()=>{})}show(){this.Ttc(!0)}vbb(){return this.yw&&this.yw.style.visibility===ka.a.Hz?!0:!1}Q8(){return"Modern"}Ttc(za){na.a.instance.setVisibility(za&&this.Hc.Lh);this.yw&&(za?(this.yw.style.visibility=ka.a.Hz,$addHandler(window,"visibilitychange",ha=>{this.mZa(ha)})):(this.yw.style.visibility=ka.a.Qs,$removeHandler(window,"visibilitychange",ha=>{this.mZa(ha)})))}exit(){this.bIe(!1)}wRc(){this.bIe(!1)}transcribe(za,
ha,ua,Ga,sa,Ba,pa){const ia=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.eSa||this.Ub.instance.dr);(this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.CDa||ia)&&!this.Ub.instance.Jvb()?G.a.J(512495900,830,50,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(na.a.instance.transcribe(za,ha,ua,Ga,sa,Ba,pa),this.Hc.Lh&&this.Om.recordSessionStats({["metadata"]:"subtitles"}),this.M0d())}iXf(za,ha){this.Om.clearNavigationState();const ua={navigationType:"init"};
ua.startFromTime=ha.startFromTime;ha.waitedForInit=this.Whc;ha.startInitTime=this.gVg;ha.beforeInitPromise=Ua.h6b();this.rCe.then(()=>{ha.afterInitPromise=Ua.h6b();ua.bootMetrics=ha;if(0>za.slideIndex)this.Om.gotoFirstSlide(!0,ua).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)});else{const Ga={};Ga.actionContext=ua;Ga.fSkipTransition=!0;this.Om.gotoSlide(za,Ga).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",
new Sys.EventArgs)})}})}xsi(za,ha){const ua=this.la.Bc("PptModernSlideShowCheckFullscreenCounter",10);let Ga=ua;this.odb=window.setInterval(()=>{Ga--;G.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",Ga);if(this.fu.m9||0>=Ga){window.clearInterval(this.odb);this.odb=0;const sa=20*(ua-Ga);ha.checkFullscreenMs=sa;G.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",sa);this.iXf(za,ha)}},20)}M0d(){let za=0,ha=100;this.Hc.Lh&&
na.a.instance.isVisible()&&("AboveSlide"===this.Hc.Vv?(za=15,ha=85):"BelowSlide"===this.Hc.Vv&&(ha=85));const ua=document.getElementById("LiveURLBarLayerHost");this.kDb&&ua?(this.K.style.top=String.format("calc({0}% + {1})",za.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",ha.toString(),"26px")):(this.K.style.top=za.toString()+"%",this.K.style.height=ha.toString()+"%")}setMicrophoneState(za){na.a.instance.setMicrophoneState(za)}GVe(za){za?this.wrl():this.Azh()}FOb(za,ha=""){this.kDb=
za;na.a.instance.oDh(za,ha);this.M0d()}toggleTranscriberUIVisibility(za){na.a.instance.setVisibility(za);na.a.instance.rHc();this.M0d()}P2e(){this.va.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}restoreFocus(){this.yw&&this.yw.style.visibility!==ka.a.Qs&&!this.Zje()&&this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.Om){const za=this.Om.getSlideLocation();za?this.va.raiseEvent("OnGetCurrentPosition",new Z.a({["SlideId"]:za.slideId.sid,["SlideIndex"]:za.slideIndex})):G.a.J(512495897,
830,15,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.Om){const za=this.Om.getSlideLocation();if(za){const ha=this.Om.getAnimationState(!0),ua=ha.timelineStates,Ga=[];for(let sa=0;sa<ua.length;sa+=1)Ga.push({["TimeLineId"]:ua[sa].timelineId,["Step"]:ua[sa].step,["LastClickTime"]:ua[sa].lastClickTime,["StartTimeOffset"]:ha.startTimeOffset});this.va.raiseEvent("OnGetCurrentPosition",new Z.a({["SlideId"]:za.slideId.sid,["SlideIndex"]:za.slideIndex,
["TimeLineMappings"]:Ga}))}else G.a.J(512495896,830,15,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.Om&&this.yw&&this.yw.style.visibility!==ka.a.Qs){const za=document.getElementById(this.IDe?"svg-canvas":"webgl-canvas");za&&this.va.raiseEvent("OnGetCurrentSlideDimensions",new P.a({["SlideHeight"]:za.offsetHeight,["SlideWidth"]:za.offsetWidth,["SlideLeftBound"]:za.offsetLeft,["SlideBottomBound"]:za.offsetTop+za.offsetHeight}))}}uTa(za){this.Om&&
this.Om.gotoSlide({["slideIndex"]:za},{actionContext:{navigationType:"goto"},fSkipTransition:!1}).then(()=>{})}h$f(za,ha){if(this.Om){const ua={},Ga=[];let sa=0;for(let Ba=0;Ba<ha.length;Ba+=1){const pa={};pa.timelineId=ha[Ba].TimeLineId;pa.step=ha[Ba].Step;pa.lastClickTime=ha[Ba].LastClickTime;sa=ha[Ba].StartTimeOffset;Ga.push(pa)}ua.timelineStates=Ga;ua.startTimeOffset=sa;ha={actionContext:{navigationType:"goto"}};ha.animationState=ua;ha.fSkipTransition=!1;this.Om.gotoSlide({["slideIndex"]:za},
ha).then(()=>{})}}VIh(za){return Object(h.a)(this,void 0,void 0,function*(){G.a.J(512309260,830,50,"updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.HO);const ha=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.HO),ua={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ua["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;const Ga=new Date;return new Promise((sa,Ba)=>{this.Ds.nj(ha,1,"",ua,!1,0,
pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.svk(pa,Ga);G.a.J(509636748,830,50,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");sa()}),pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.qvk(pa,za);G.a.J(509636747,830,50,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");Ba()}),null,null)})})}svk(za,ha){return Object(h.a)(this,void 0,void 0,function*(){const ua=new Date;G.a.J(512309279,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",
+ua-+ha);const Ga=JSON.parse(za.data.Wd);this.aR=Ga.downloadUrl;A.a.Wa(this.aR)?G.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",Ga):(this.mXa=Date.now(),yield this.UIh(ha,ua))})}qvk(za,ha){return Object(h.a)(this,void 0,void 0,function*(){const ua=za.data?za.data.ie:-1;0<ha--?(G.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
ua),yield this.VIh(ha)):G.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",ua)})}refreshPodSession(za,ha,ua=1){G.a.J(512309259,830,50,"RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.HO,za);this.HO=za;this.zcd=ha;za=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.HO);ha={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ha["X-UserSessionId"]=
x.AFrameworkApplication.userSessionId;const Ga=new Date;this.Ds.nj(za,1,"",ha,!1,0,sa=>Object(h.a)(this,void 0,void 0,function*(){yield this.tvk(sa,Ga)}),sa=>Object(h.a)(this,void 0,void 0,function*(){yield this.rvk(sa,ua)}),null,null)}tvk(za,ha){return Object(h.a)(this,void 0,void 0,function*(){var ua=new Date;G.a.J(512309275,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+ua-+ha);const Ga=JSON.parse(za.data.Wd);this.aR=Ga.downloadUrl;A.a.Wa(this.aR)?
(G.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",Ga),this.vbb()&&(ua=R.a.Vh(413),x.AFrameworkApplication.zp(ua),K.Health.instance.recordQosError(R.a.qja(ua),["SlideShowACE"],!1,!0,!0,!0,null),this.Om&&this.Om.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.mXa=Date.now(),yield this.UIh(ha,ua))})}rvk(za,ha){za=za.data?za.data.ie:-1;0<ha--?(G.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
za),this.refreshPodSession(this.HO,this.zcd,ha)):(G.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",za),this.vbb()&&this.exit())}setVisibility(za){this.Ttc(za)}mga(za){this.yw&&(this.yw.style.cursor=za?"default":"none");na.a.instance.mga(za)}setOsfLocalStorage(){}OLe(za){if(this.Uhc)this.Uhc.onInkManagerActivity(za)}qJa(za){this.lVe(za)}lVe(za){this.va.raiseEvent("OnSpecialKey",new fa.a({["Key"]:za.keyCode,["ShiftKey"]:za.shiftKey}))}Sph(){}Xkc(){this.yw&&
this.restoreFocus()}M5f(){const za=new Map;za.set("X-UserSessionId",this.SDe);za.set("X-WacNoAuth","1");za.set("X-WacCluster",this.zcd);za.set("Client","Unified App");this.la.hcj&&za.set("UseDocCache","True");return za}wrl(){this.hbd&&this.hbd.startWebcam()}Azh(){this.hbd&&this.hbd.stopWebcam()}bIe(za=!1){this.odb&&(G.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.odb),window.clearInterval(this.odb),this.odb=0);this.Uhc&&this.Uhc.resetInkCanvas();
this.G$&&this.H$&&(this.G$.tabIndex=-1,this.H$.tabIndex=-1);if(this.Om){const ha=this.Om.getSlideLocation();this.Om.endSession(Ua.h6b());ha?(this.va.raiseEvent("OnExit",new Q.a({["SlideId"]:ha.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:ha.slideIndex,["IsFromEndOfSlideshow"]:za})),this.Azh()):G.a.J(512495889,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")}this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";this.Ttc(!1);na.a.instance.e0e()}ugd(){if(this.Om&&
this.yw&&this.yw.style.visibility!==ka.a.Qs){const za=this.Om.getSlideLocation();if(za){const ha=this.Om.getAnimationState(!0),ua=ha.timelineStates,Ga=[];for(let sa=0;sa<ua.length;sa+=1)Ga.push({["TimeLineId"]:ua[sa].timelineId,["Step"]:ua[sa].step,["LastClickTime"]:ua[sa].lastClickTime,["StartTimeOffset"]:ha.startTimeOffset});this.va.raiseEvent("OnPositionChangeEventId",new T.a({["SlideId"]:za.slideId.sid,["SlideIndex"]:za.slideIndex,["TimeLineMappings"]:Ga}))}else G.a.J(512495888,830,50,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}Fsk(za){if(this.Om&&
this.yw&&this.yw.style.visibility!==ka.a.Qs)switch(za){case "Hidden":this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:G.a.J(512495887,830,50,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",za)}}tfd(za){if(this.Om){G.a.J(512495886,830,15,"SlideshowCoreFrame.OnErrorHandler {0}",za);let ha;za.startsWith("Server")&&(za="GetItemsRequestFailed");switch(za){case "GetItemsFailedDownloadFile":G.a.J(512495885,
830,50,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.HO);this.va.raiseEvent("OnPodSessionExpired",new ca.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.HO}));return;case "LoadFailed":ha=407;break;case "GetItemsFailedInvalidResponse":ha=408;break;case "GetItemsRequestFailed":ha=409;break;case "GetItemsTimeout":ha=411;break;case "EnsureSlideFailed":ha=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":ha=
414;break;default:ha=359}if(0!==ha)if(this.vbb()){const ua=R.a.Vh(ha);x.AFrameworkApplication.zp(ua);za=409===ha?za:R.a.qja(ua);K.Health.instance.recordQosError(za,["SlideShowACE"],!1,!0,!0,!0,null);this.Om.recordSessionStats({["errorName"]:za})}else G.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",za)}}ahd(za){G.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Om&&this.yw&&this.yw.style.visibility!==ka.a.Qs&&
this.va.raiseEvent("OnTranscriberStartedEventId",new ma.a({["TranscriberSessionId"]:za}));this.Hc.Lvb=!0}mZa(){G.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.va.raiseEvent("OnVisibilityChangeEventId",new ea.a(!1))}Zje(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.hVf}aHc(za){this.va.addHandler("OnSlideshowReady",za)}$ld(za){this.va.removeHandler("OnSlideshowReady",za)}XPd(za){this.va.addHandler("OnBrowserEvent",za)}DRe(za){this.va.removeHandler("OnBrowserEvent",
za)}evf(za){this.va.addHandler("OnFullscreenClick",za)}ujh(za){this.va.removeHandler("OnFullscreenClick",za)}ZPd(za){this.va.addHandler("OnSlideshowContextMenu",za)}FRe(za){this.va.removeHandler("OnSlideshowContextMenu",za)}Fia(za){this.va.addHandler("OnExit",za)}Wfa(za){this.va.removeHandler("OnExit",za)}bvf(za){this.va.addHandler("OnSlideshowError",za)}rjh(za){this.va.removeHandler("OnSlideshowError",za)}XGc(za){this.va.addHandler("OnGetCurrentSlideDimensions",za)}Yld(za){this.va.removeHandler("OnGetCurrentSlideDimensions",
za)}WYb(za){this.va.addHandler("OnGetCurrentPosition",za)}Qib(za){this.va.removeHandler("OnGetCurrentPosition",za)}bHc(za){this.va.addHandler("OnSpecialKey",za)}amd(za){this.va.removeHandler("OnSpecialKey",za)}rvf(za){this.va.addHandler("OnVisibilityChangeEventId",za)}NRe(za){this.va.removeHandler("OnVisibilityChangeEventId",za)}dQd(za){this.va.addHandler("OnPodSessionExpired",za)}JRe(za){this.va.removeHandler("OnPodSessionExpired",za)}hvf(za){this.va.addHandler("OnLogEndOfTranscriptionSession",za)}wjh(za){this.va.removeHandler("OnLogEndOfTranscriptionSession",
za)}IPa(za){this.va.addHandler("OnPositionChangeEventId",za)}Rib(za){this.va.removeHandler("OnPositionChangeEventId",za)}gvf(za){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",za)}vjh(za){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",za)}aQd(za){this.va.addHandler("OnEnterEndOfShowEventId",za)}GRe(za){this.va.removeHandler("OnEnterEndOfShowEventId",za)}cQd(za){this.va.addHandler("OnLeaveEndOfShowEventId",za)}IRe(za){this.va.removeHandler("OnLeaveEndOfShowEventId",za)}ovf(za){this.va.addHandler("OnSubtitleUpdatedEventId",
za)}Djh(za){this.va.removeHandler("OnSubtitleUpdatedEventId",za)}qvf(za){this.va.addHandler("OnTranscriberStartedEventId",za)}Ejh(za){this.va.removeHandler("OnTranscriberStartedEventId",za)}yvf(za){this.va.addHandler("RecordQosErrorEventId",za)}Ljh(za){this.va.addHandler("RecordQosErrorEventId",za)}Jwk(za){this.va.raiseEvent("OnBrowserEvent",new D.a({["ClientX"]:za.clientX,["ClientY"]:za.clientY}))}Tgb(za){this.va.raiseEvent("OnSlideshowContextMenu",new da.a({["ClientX"]:za.clientPoint.x,["ClientY"]:za.clientPoint.y}));
return!0}static h6b(){return Math.round(window.performance.now())}}Object(J.a)(Ua,"SlideShowCoreFrame",null,[335])},734:function(J,aa,d){J=d(0);class h{}h.slideType="slide";h.shapeType="shape";h.utb="chart";Object(J.a)(h,"ClipserviceDataConstants",null,[]);d.d(aa,"b",function(){return e});d.d(aa,"a",function(){return r});const e=n=>n===h.slideType?1:n===h.shapeType?2:n===h.utb?3:0,r=n=>1===n?h.slideType:2===n?h.shapeType:""},735:function(J,aa,d){J=d(0);var h=d(18),e=d(47),r=d(850),n=d(230),v=d(231),
B=d(232),y=d(494);class x{constructor(E,u){this.D_a=E;this.description=u}}Object(J.a)(x,"ColorEntry",null,[]);d.d(aa,"a",function(){return A});class A{constructor(E){this.qre={};this.BCe=null;this.Am=E}get rrl(){if(!this.BCe){const E=new Sys.StringBuilder;for(let u of this.standardColors)E.append(String.format(A.bUd,this.eDh(u.D_a),this.G2e(u.D_a),u.description));this.BCe=E.toString()}return this.BCe}get standardColors(){let E;return E=new h.a,E.add(new x(12582912,ResourceStrings.L_FontColorDarkRed)),
E.add(new x(16711680,ResourceStrings.L_FontColorRed)),E.add(new x(16760832,ResourceStrings.L_FontColorOrange)),E.add(new x(16776960,ResourceStrings.L_FontColorYellow)),E.add(new x(9621584,ResourceStrings.L_FontColorLightGreen)),E.add(new x(45136,ResourceStrings.L_FontColorDarkGreen)),E.add(new x(45296,ResourceStrings.L_FontColorLightBlue)),E.add(new x(28864,ResourceStrings.L_FontColorBlue)),E.add(new x(8288,ResourceStrings.L_FontColorDarkBlue)),E.add(new x(7352480,ResourceStrings.L_FontColorPurple)),
E}eDh(E){return String.format("#{0}",B.i(E))}G2e(E){return B.i(E)}Rtc(E){return Object.assign(new v.a,{ThemeColor:E.ThemeColor,ColorLuminance:E.ColorLuminance,FTintColor:E.FTintColor}).toString()}fbe(E,u,K){const G=new Sys.StringBuilder;G.append(this.vTd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,E));this.c9h(G);G.append(this.uTd());G.append(this.vTd("StandardColors",ResourceStrings.L_StandardFontColor,!1,E));G.append(this.rrl);G.append(this.uTd());u&&0<u.length&&(G.append(this.vTd("RecentColors",
ResourceStrings.L_RecentColors,!1,K)),G.append(this.Shj(u)),G.append(this.uTd()));return G.toString()}Shj(E){const u=new Sys.StringBuilder;for(let K=0;K<E.length;K++){const G=E[K];u.append(String.format(A.bUd,"#"+G.hex,G.hex,"#"+G.hex))}return u.toString()}vTd(E,u,K,G){return String.format(A.wni,E,u,"ColorPicker",K?'McuLayout = "true" ':"",G)}uTd(){return A.vni}c9h(E){const u=Array(10);u[0]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Background1));u[1]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Text1));
u[2]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Background2));u[3]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Text2));u[4]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Accent1));u[5]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Accent2));u[6]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Accent3));u[7]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Accent4));u[8]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Accent5));u[9]=this.kL(n.Color.Vi(this.Am.PresetSchemeColorMapping.Accent6));
const K=Array(10);K[0]=ResourceStrings.l_ThemeLabel1;K[1]=ResourceStrings.l_ThemeLabel2;K[2]=ResourceStrings.l_ThemeLabel3;K[3]=ResourceStrings.l_ThemeLabel4;K[4]=ResourceStrings.l_ThemeLabel5;K[5]=ResourceStrings.l_ThemeLabel6;K[6]=ResourceStrings.l_ThemeLabel7;K[7]=ResourceStrings.l_ThemeLabel8;K[8]=ResourceStrings.l_ThemeLabel9;K[9]=ResourceStrings.l_ThemeLabel10;for(let G=0;5>=G;G++)for(let O=0;O<u.length;O++)E.append(this.d3i(u[O][G],u[O][0],K[O],G,O))}kL(E){const u=e.a.jw(E.r,2)+e.a.jw(E.g,
2)+e.a.jw(E.b,2);if(this.qre[u])return this.qre[u];const K=y.a.tSa(E),G=[];Array.add(G,E);if(E.k3d())for(var O=0;O<r.a.MKh.length;++O)E=y.a.a5b(K),E.darken(r.a.MKh[O]/100),Array.add(G,E.Gta());else if(E.vWi())for(O=0;O<r.a.kAf.length;++O)E=y.a.a5b(K),E.lighten(r.a.kAf[O]/100),Array.add(G,E.Gta());else if(K.lum<A.gni)for(O=0;O<r.a.msg.length;++O)E=y.a.a5b(K),E.lighten(r.a.msg[O]/100),Array.add(G,E.Gta());else if(K.lum>A.fni)for(O=0;O<r.a.lsg.length;++O)E=y.a.a5b(K),E.darken(r.a.lsg[O]/100),Array.add(G,
E.Gta());else for(O=0;O<r.a.JKc.length+r.a.pHf.length;++O)E=y.a.a5b(K),O<r.a.JKc.length?E.lighten(r.a.JKc[O]/100):E.darken(r.a.pHf[O-r.a.JKc.length]/100),Array.add(G,E.Gta());return this.qre[u]=G}d3i(E,u,K,G,O){E=this.G2e(E.D_a);({HKc:u,JOb:K}=this.L6d(u,E,K,G,O));return String.format(A.bUd,u,E,K)}L6d(E,u,K,G,O){var R;var V=R=null;if(0>G)return{HKc:R,JOb:V};u=Object.assign(new v.a,{RGBColor:u,ThemeColor:O,ColorLuminance:0,FTintColor:!1});G?(O=y.a.tSa(E),V=G-1,O.lum?1===O.lum?(G=!1,V=[242,217,191,
166,127][V]):.8<O.lum?(G=!1,V=[229,191,127,64,25][V]):.2>O.lum?(G=!0,V=[25,64,127,191,229][V]):(O=[51,102,153],R=[191,127],V=(G=V<O.length)?O[V]:R[V-O.length]):(G=!0,V=[127,166,191,217,242][V]),V=255-V,V=Math.round(100*V/255),u.ColorLuminance=100-V,u.FTintColor=G,V=String.format(G?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,E.toString(),K,V)):V=String.format(ResourceStrings.l_ColorPickerTooltipBase,E.toString(),K);R=this.Rtc(u);return{HKc:R,JOb:V}}}A.wni='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';
A.vni="</Colors></ColorPicker></Controls></MenuSection>";A.bUd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';A.gni=.2;A.fni=.8;Object(J.a)(A,"ColorPickerBuilder",null,[])},736:function(J,aa,d){var h=d(109),e=d(55),r=d(81),n=d(27),v=d(36),B=d(87),y=d(29),x=d(233),A=d(325),E=d(28),u=d(975);J=d(0);class K{constructor(){this.Bz=this.onSuccess=this.mHe=this.FQd=this.ibh=null}}Object(J.a)(K,"UploadFileDialogData",null,[]);var G=d(68),O=d(35);J=d(78);d.d(aa,"d",function(){return V});d.d(aa,"e",function(){return D});
d.d(aa,"a",function(){return ca});d.d(aa,"c",function(){return T});d.d(aa,"b",function(){return da});const R=new J.a,V=(fa,ma,ea,ra,F)=>{const na=String.format("{0}{1}",ea,h.a.create().toString());return Object.assign(new K,{FQd:P(na,ra),ibh:Z(ea,ra),mHe:(ka,Ua)=>{switch(ea){case "video":Ua.blockContent(F,fa);break;default:Ua.blockContent(ka,"Insert Media")}},onSuccess:(ka,Ua,za,ha,ua,Ga)=>{ma(fa,na,Ua,za,ua,Ga,F)},Bz:(ka,Ua,za,ha,ua)=>{za.YN(Ua)?E.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+Ua.lja):za.YN(F)&&E.a.J(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+F.lja);O.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(ea)?za.hK(F):za.hK(Ua);Ua=null;try{const Ga=v.a(ka);Ua=Ga?Ga.Error:null}catch(Ga){E.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",ka)}if(!Ua){let Ga;O.a("FixHideShimmerIssueOnUploadFailure")&&ka&&!isNaN(parseInt(ka))&&(Ga=Enum.parse(x.a,
x.a[parseInt(ka)],!0));Ua=Object.assign(new A.a,{Code:Ga?Ga:444})}ua&&(ua.finish(),ua=null);E.a.J(509727821,822,10,"Upload media failed");ca(ea)?T(ResourceStrings.l_FileInsertFailedMessageTitle,Ua&&449===Ua.Code?ResourceStrings.l_VideoUploadTimeoutMessage:ResourceStrings.l_FileInsertFailedMessage,null):Q(ha,ua,Ua.Code,null)}})},D=(fa,ma,ea,ra)=>new Promise((F,na)=>{const ka=new u.a(ra);E.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}, media file size: {2}",
fa&&fa.value?fa.files.length:0,u.a.A7d(fa),u.a.s2f(fa));ea&&ea.Va("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}, media file size: {2}",fa&&fa.value?fa.files.length:0,u.a.A7d(fa),"video"===ra?"":u.a.s2f(fa)));if(fa&&fa.value&&fa.value.length)if(ka.TJl(fa.value)){var Ua=fa.files[0];if(ka.UJl(Ua.size))ka.Dsi(Ua).then(za=>{za?(ea&&ea.Va("MediaFileValidationPassedOnUI","true"),F(!0)):(ca(ra)?T(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,
[ka.gna.join(", ")]):Q(ma,ea,443,[ka.gna.join(", ")]),na(443))},()=>{E.a.J(509727825,822,10,"Invalid media file, fileType:{0}",ra);ca(ra)?T(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ka.gna.join(", ")]):Q(ma,ea,443,[ka.gna.join(", ")]);na(443)});else{E.a.J(509727826,822,10,"video"===ra?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${Ua.size}`);Ua=O.a("FetchMediaSizeLimitFromValidationHelper")?ka.Pfc.toString():"16";const za=
"video"===ra?450:442;ca(ra)?T(ResourceStrings.l_MaxFileSizeValidationErrorTitle,ResourceStrings.l_MaxVideoSizeValidationErrorMessage,[Ua]):Q(ma,ea,za,[Ua]);na(442)}}else E.a.J(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",null===ra||void 0===ra?void 0:ra.toString(),u.a.A7d(fa)),ca(ra)?T(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ka.gna.join(", ")]):Q(ma,ea,441,[ka.gna.join(", ")]),na(441);else ca(ra)?T(ResourceStrings.l_FileInsertFailedMessageTitle,
ResourceStrings.l_FileInsertFailedMessage,null):Q(ma,ea,440,null),na(440)}),Q=(fa,ma,ea,ra)=>{ma&&(ma.Va("MediaFileValidationPassedOnUI","false"),ea&&ma.Va("ErrorCode",ea.toString()),ma.finish());fa.cH(ea,F=>{F.mC=1;F.$Ra=ra;return!1})},Z=(fa,ma)=>{let ea="MediaUpload.ashx";if(y.App.webServiceBase)ea=y.App.webServiceBase+ea;else if(e.a.fg||e.a.Kua)ea=r.a.ita(ea);let ra="";switch(fa){case "audio":ra="audio";break;case "captions":ra="captions";break;case "video":ra="video";break;default:E.a.J(509727824,
822,10,"Media::GetMediaUploadEndpoint: file type not supported")}ea+=String.format("?MediaType={0}&{1}&{2}&{3}",ra,n.AFrameworkApplication.kTa(),ma.presentationId.string,n.AFrameworkApplication.r5b());ma.podSessionId&&(ea+=String.format("&{0}={1}",B.a.iaa,ma.podSessionId));ma.qk&&(ea+=String.format("&waccluster={0}",ma.qk));return ea},P=(fa,ma)=>{const ea=new G.a;ea.$("PresentationId",ma.presentationId.string);ea.$(B.a.Tna,ma.sessionInfo);ea.$("Canary",n.AFrameworkApplication.canary);ea.$("access_token",
n.AFrameworkApplication.accessToken);ea.$("MediaToken",fa);return ea},ca=fa=>O.a("EnableCalloutNotificationsForVideos")&&"video".match(fa)?!0:!1,T=(fa,ma,ea)=>{let ra=new A.a;ra.Title=fa;ra.Message=ma;ra.ExtraErrorParam=ea;R.raiseEvent("videoCalloutNotificationEvent",ra)},da=fa=>{R.addHandler("videoCalloutNotificationEvent",fa)}},913:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.cGe="TraceIdNoBar";h.d2c="TraceIdLeftBar";h.jnd="TraceIdRightBar";h.FIc="TraceIdBothBar";Object(J.a)(h,
"ConsistencyCheckTraceIdType",null,[])},914:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(519);class e{constructor(){this.start=new h.a;this.end=new h.a}clone(){return Object.assign(new e,{start:this.start.clone(),end:this.end.clone()})}merge(r){let n=!1;r.start&&(n=this.start.merge(r.start));r.end&&(n=this.end.merge(r.end)||n);return n}}Object(J.a)(e,"TextNodeSelection",null,[])},915:function(J,aa,d){d.d(aa,"a",function(){return 19})},916:function(J,aa,d){d.d(aa,"a",function(){return r});
var h=d(47),e=d(27);const r=n=>{if(h.a.Wa(n))return!1;var v=e.AFrameworkApplication.fa.Ga("PPTDisabledChangeGates");return v?(v=v.split(";"))&&0<v.length?0>Array.indexOf(v,n):!0:!1}},917:function(J,aa,d){d.r(aa);d.d(aa,"WordPredictionAugLoopResponseManager",function(){return A});J=d(0);aa=d(18);var h=d(353),e=d(918),r=d(661),n=d(659),v=d(660),B=d(550),y=d(64),x=d(33);class A{J7b(E){A.WS.hG(()=>{this.Oil(E)||(this.k3e(E),this.PHl(),this.Pfi())},"WPT:PR")}Pfi(){const E=B.a.QD.R5,u=B.a.QD.Uhb;if(E){var K=
y.a.instance.Na.mb;if(K&&K.Ye&&B.a.Jhg(K.Ye)){K=K.Ye.node;var G=x.ParagraphReader.text(K);G=G.substring(E.Hod,G.length);K=this.$7d(K,E,G);"string"===typeof K?K.length?(E.U8=K,E.jNb+=1,B.a.ARd(E.text,K),this.PGl(),E.qKe=G,this.OGl(E)):u&&0===u[r.a.status]?(this.hIh(),B.a.Imd()):this.fIl():(this.hIh(),B.a.Imd())}}}OGl(E){A.Vwd.count>=A.oXh&&A.Vwd.removeAt(0);A.Vwd.add(this.pvi(E))}pvi(E){return Object.assign(new e.a,{id:E.id,Pya:E.Pya,Hx:E.Hx,Hod:E.Hod,text:E.text,U8:E.U8,W_b:E.W_b,b7a:E.b7a,score:E.score,
V2e:E.V2e,U2e:E.U2e,qP:E.qP,jNb:E.jNb,qKe:E.qKe})}Oil(E){if(E&&E.parentPath&&7===E.parentPath.length){const u=E.parentPath[6];B.a.CZa.add(u,v.a.bRd,(new Date).getTime());B.a.T2j(u)}else return B.a.Dbc(v.a.D1d),!0;return B.a.VUa?(E=this.g9f(E),E=this.ich(E[0]),E[r.a.status]=5,B.a.I4d(E),B.a.Dbc(v.a.Gxh),!0):!1}k3e(E){(E=this.g9f(E))&&E.length?(B.a.QD.R5=E[0],B.a.QD.tDh=E.length,B.a.QD.Uhb=this.ich(E[0])):(B.a.Imd(),B.a.Dbc(v.a.D1d))}g9f(E){if(!E||!E.items||!E.parentPath||7!==E.parentPath.length)return null;
var u=E.items[0];let K;try{K=u.body}catch(D){return null}u=E.parentPath[2];const G=parseInt(E.parentPath[3]),O=parseInt(E.parentPath[4]),R=E.parentPath[5];E=E.parentPath[6];if(!K.predictions.length)return null;B.a.hdl(K.modelInfo);const V=Array(K.predictions.length);for(let D=0;D<K.predictions.length;D++){const Q=K.predictions[D];if(Q.text){const Z=Q.characterRange,P=Q.tokenRange;V[D]=Object.assign(new e.a,{id:R,Pya:E,Hx:u,Hod:G,text:Q.text,U8:Q.text.substr(Z.start),W_b:Z.start,b7a:Z.length,score:Q.score,
V2e:P.start,U2e:P.length,qP:O,jNb:0})}}return V}ich(E){const u={};u[r.a.language]="en-US";const K=B.a.oej();u[r.a.modelId]=K.modelId;u[r.a.modelVersion]=K.modelVersion;u[r.a.configId]=K.configId;u[r.a.kVd]=E.b7a;u[r.a.SJc]=E.b7a;u[r.a.npg]=E.U8.length;u[r.a.ach]=E.text.length;u[r.a.dch]=E.text.split(" ").length;u[r.a.score]=E.score;u[r.a.status]=0;u[r.a.w4e]=E.U8.length;u[r.a.qP]=E.qP;E=B.a.CZa.ga(E.Pya);u[r.a.WCh]=E[v.a.bRd]-E[v.a.Zrc];u[r.a.xtd]=0;return u}PHl(){const E=B.a.QD.R5;E&&(B.a.Mua(E.qP,
n.a.pEf,B.a.QD.tDh),B.a.Mua(E.qP,n.a.tMf,E.b7a))}PGl(){const E=B.a.QD.R5,u=B.a.QD.Uhb;if(E&&1===E.jNb){const K=(new Date).getTime();B.a.CZa.Ceg(E.Pya,v.a.Pwf,K);B.a.krg(E.Pya,!0);B.a.Dbc(v.a.cch);const G=B.a.CZa.ga(E.Pya)[v.a.Zrc];u[r.a.xtd]=K-G;u[r.a.status]=1;u[r.a.SJc]=E.text.length-E.U8.length;B.a.Mua(E.qP,n.a.hph,1);B.a.Mua(E.qP,n.a.ykh,1);B.a.Mua(E.qP,n.a.zkh,E.U8.length);B.a.Mua(E.qP,n.a.uMf,E.text.length-E.U8.length);B.a.PJk()}}fIl(){const E=B.a.QD.R5,u=B.a.QD.Uhb;E&&(u[r.a.status]=3,u[r.a.SJc]=
0,u[r.a.w4e]=E.text.length-u[r.a.kVd],B.a.I4d(u),B.a.Mua(E.qP,n.a.UFh,1),B.a.Mua(E.qP,n.a.wMf,E.score),B.a.Mua(E.qP,n.a.VFh,E.text.length-E.b7a),B.a.Imd())}hIh(){const E=B.a.QD.R5,u=B.a.QD.Uhb;if(E){if(0===u[r.a.status]){const K=(new Date).getTime();B.a.CZa.Ceg(E.Pya,v.a.Nwf,K);B.a.krg(E.Pya,!1);B.a.Dbc(v.a.bch);const G=B.a.CZa.ga(E.Pya)[v.a.Zrc];u[r.a.xtd]=K-G;B.a.Mua(E.qP,n.a.U0g,1);u[r.a.status]=6}B.a.I4d(u)}}$7d(E,u,K){let G=null;u.Hx===E.id.toString()&&K&&u.W_b<K.length&&(E=K.substring(0,u.W_b)+
u.text,E=E.replace(RegExp("\\u00a0","g")," "),K=K.replace(RegExp("\\u00a0","g")," "),0<E.length&&0<K.length&&(E.indexOf(K)||(G=E.substring(K.length,E.length))));return G}static get WS(){return h.a.instance}}A.oXh=4;A.Vwd=new aa.a;Object(J.a)(A,"WordPredictionAugLoopResponseManager",null,[])},918:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.Hx=this.Pya=this.id=null;this.qP=this.Hod=0;this.U8=this.text=null;this.jNb=this.U2e=this.V2e=this.score=this.b7a=this.W_b=
0;this.qKe=null}}Object(J.a)(h,"Candidate",null,[])},919:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(J.a)(h,"ActivateAnnotationParameters",null,[])},920:function(J,aa,d){d.d(aa,"a",function(){return e});J=d(0);aa=d(611);var h=d(143);class e extends aa.a{constructor(){super();this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),
B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(J.a)(e,"TextPredictionAnnotation",aa.a,[])},921:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.operation=null}}Object(J.a)(h,"SubmitOperationParameters",null,[])},922:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,r,n){super();this.actionId=e;this.Nzb=r;this.revisionId=
n}}Object(J.a)(h,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},923:function(J,aa,d){d.d(aa,"c",function(){return v});d.d(aa,"b",function(){return B});d.d(aa,"a",function(){return y});var h=d(18),e=d(387),r=d(27),n=d(36);const v=x=>{if(!x)return null;let A;try{A=n.b(x)}catch(E){A=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",E)}return A},B=(x,A)=>{let E=[];if(x.breadcrumbs&&0<x.breadcrumbs.length)E=x.breadcrumbs;else{const u=x.service_info;
u&&u.friendly_service_name&&Array.add(E,u.friendly_service_name);x.display_path&&Array.addRange(E,x.display_path)}return E.join(A?" \u00ab ":" \u200f\u00bb ")},y=(x,A=!1)=>{if(!x)return[];if(!x.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!x.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];x=x.documents.items;const E=new h.a;for(let K=0;K<x.length;K++){const G=x[K];var u=G.web_url;if(!u){e.ULS.sendTraceTag(578320064,202,
15,"Empty web_url");if(!G.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}u=String.format("{0}?web=1",G.url)}const O={};O.DocumentUrl=u;O.MruId=G.mru_id;{u=G;let R=u.title;R?(u.extension&&(R=String.format("{0}.{1}",R,u.extension)),u=R):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),u="")}O.FileName=u;O.IsPinned=G.is_pinned;O.Path=B(G,r.AFrameworkApplication.isRtl);A&&(O.App=G.app,O.TimeStamp=G.time_stamp);E.add(O)}return E.toArray()}},924:function(J,aa,d){d.d(aa,"a",function(){return x});
J=d(0);var h=d(387),e=d(1024),r=d(1204),n=d(14),v=d(18),B=d(40),y=d(35);class x{constructor(A,E,u,K,G,O,R,V,D){this.ER=new e.a;this.oRg=A;this.Tb=E;this.kB=G;this.Ea=u;this.Yc=O;this.dcc=R;this.Yl=K;this.Ih=V;this.la=D;this.JEj()}get Kd(){return this.Yc.instance}get xF(){return this.dcc.value}JEj(){this.ER.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.ER.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.ER.$(2,[ResourceStrings.l_PhTypeCenterTitle,
ResourceStrings.l_ClickToAddTitle]);this.ER.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.ER.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.ER.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.ER.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.ER.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.ER.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);
this.ER.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.ER.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.ER.$(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.ER.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}i7f(A,E){A&&(this.rda(A,E),A.kla?E.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.S9d(A,null,E));return null}ukj(A){if(!this.oRg.instance||!A)return null;
A=this.oRg.instance.n7f(A);if(!A||!A.length)return null;const E=A.length;return 1===E?String.format(ResourceStrings.l_ShapePresenceForOneUser,A[0].userName):2===E?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,A[0].userName,A[1].userName):3===E?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,A[0].userName,A[1].userName,A[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,E)}Cae(A){let E="";A&&A.ZN&&A.image.title&&0<A.image.title.length&&(E=A.image.title);
A&&(E=String.format(ResourceStrings.l_ThumbnailInfoNew,A.slideIndex+1,this.Tb.qj(),E),A=this.Nnj(A),0<A.length&&(E+=A));return E}Nnj(A){const E=new Sys.StringBuilder;A.isSelected&&E.append(ResourceStrings.L_SlideIsSelected);A.jn&&E.append(ResourceStrings.l_SlideIsHidden);const u=Object(r.a)(116,A.Fd);if(u){var K=u.aTa();K&&!this.Yl.kle(K)&&E.append(ResourceStrings.l_SlideHasNotes);(K=u.XD())&&this.kB.instance&&this.kB.instance.Mbg(K)&&(K=this.kB.instance.rSc(K),E.append(1===K?ResourceStrings.l_SlideHasOneComment:
String.format(ResourceStrings.l_SlideHasCommentsWithCount,K)))}A.AQ&&E.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(A.Whb&&(A=A.Whb.P8())&&0<A.length)if(1===A.length)E.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,A[0].userName));else{K="";for(const G of A)K+=G.userName+",";E.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,K))}u&&u.isUnread&&E.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return E.toString()}a$a(A,E){return String.format(ResourceStrings.l_MultipleSlidesSelected,
A,E)}l9i(A,E){return String.format(ResourceStrings.l_DesignerSuggestionSelected,A+1,E)}Xkj(){return ResourceStrings.l_SlidePanel}Hej(){return ResourceStrings.l_MultipleShapes}jWk(A){A&&(this.la.Y6a&&A.V5(Object(n.a)(this,this.L5i,"getCameoAccMessage")),A.V5(Object(n.a)(this,this.Kmj,"getTableAccMessage")),A.V5(Object(n.a)(this,this.tbj,"getImageAccMessage")),A.V5(Object(n.a)(this,this.Pdj,"getMediaAccMessage")),A.V5(Object(n.a)(this,this.a6i,"getChartAccMessage")),this.Gqd?(A.V5(Object(n.a)(this,
this.G7f,"getSmartArtAccMessage")),A.V5(Object(n.a)(this,this.S9d,"getPlaceHolderAccMessage"))):(A.V5(Object(n.a)(this,this.S9d,"getPlaceHolderAccMessage")),A.V5(Object(n.a)(this,this.G7f,"getSmartArtAccMessage"))),A.V5(Object(n.a)(this,this.Cnj,"getTextboxAccMessage")),A.V5(Object(n.a)(this,this.jkj,"getShapeGroupAccMessage")),A.V5(Object(n.a)(this,this.gkj,"getShapeAccMessage")),A.V5(Object(n.a)(this,this.V3i,"getAddinAccMessage")),A.V5(Object(n.a)(this,this.A3i,"get3DAccMessage")))}S9d(A,E,u,K=
null){if(A&&u&&A.fl&&(this.eVc(A,u),E=A.get_altTitle(),this.ER.Gb(A.Jj))){K&&K(String.format("{0} {1}",this.ER.ga(A.Jj)[0],ResourceStrings.l_Placeholder));if(A.GT||!u.count){u=this.ER.ga(A.Jj)[0];K="";if(!this.Gqd||A.GT)K=this.ER.ga(A.Jj)[1];return String.format(A.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,u,E,K,A.get_alt())}A=String.format(A.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,
this.ER.ga(A.Jj)[0],E,A.get_alt());u.insert(0,document.createTextNode(A))}return null}Cnj(A,E,u,K=null){if(A&&u&&A.ux)if(this.eVc(A,u),K&&K(ResourceStrings.L_TextBox),0<u.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,A.get_altTitle(),A.get_alt()),u.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,A.get_altTitle(),
A.get_alt());return null}G7f(A,E,u,K=null){if(A&&u&&A.Qf)if(this.eVc(A,u),K&&K(ResourceStrings.L_SmartArt),0<u.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.I7f(A)||"",A.get_altTitle(),A.get_alt()),u.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.I7f(A)||"",A.get_altTitle(),A.get_alt());return null}rda(A,
E){A&&E&&this.Ea.NJ(A,u=>{u.Sa(B.a.pq)&&this.U3f(u,E)})}eVc(A,E){if(A&&E){const u=this.Gqd?new v.a:E;let K=!1;this.Ea.NJ(A,G=>{const O=this.Ih.cX(G),R=this.Ih.thb(G);O&&u.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,R)));K=this.U3f(G,u)||K});this.Gqd&&K&&E.addRange(u);E.count||(A=A.Y1e)&&E.add(document.createTextNode(A))}}get Gqd(){return y.a("AriaMessageHelper.FixAccMessageForEmptyList")}U3f(A,E){let u;const K=A.sa(B.a.wtc,null),G=A.sa(B.a.pq,"");if(G&&E){if(K){let O=
0,R=null,V;for(let D=0;D<K.length+1;D++)V=this.Ea.CTc(A,D),R&&R!==V&&(u=document.createElement("span"),u.setAttribute("lang",R),u.innerText=G.substring(O,K[D-1]),O=K[D-1],E.add(u)),R=V;u=document.createElement("span");R&&u.setAttribute("lang",R);u.innerText=G.substring(O,G.length)}else u=document.createElement("span"),(A=this.Ea.CTc(A,0))&&u.setAttribute("lang",A),u.innerText=G;E.add(u)}return!!G&&0<G.length}Kmj(A,E,u,K=null){return A&&A.ud?(K&&K(ResourceStrings.L_Table),String.format(A.get_alt()?
ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,A.get_altTitle(),A.get_alt())):null}tbj(A,E,u,K=null){return A&&A.Hj?(K&&K(ResourceStrings.l_Image),String.format(A.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,A.get_altTitle(),A.get_alt())):null}L5i(A,E,u,K=null){if(!A||!A.uFa)return null;K&&K(ResourceStrings.l_Cameo);return A.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,A.get_altTitle(),A.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):
String.format(ResourceStrings.l_AccMessageCameo,A.get_altTitle(),ResourceStrings.l_CameoLearnMoreMessage)}Pdj(A,E,u,K=null){if(A){if(0===A.mediaType)return null;if(1===A.mediaType)return K&&K(ResourceStrings.l_Audio),this.la.YP?String.format(ResourceStrings.l_AccMessageCanvasAudio,A.shapeName):String.format(A.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,A.get_altTitle(),A.get_alt());if(2===A.mediaType)return K&&K(ResourceStrings.l_Video),String.format(A.get_alt()?
ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,A.get_altTitle(),A.get_alt())}return null}a6i(A,E,u,K=null){return A&&A.hr?(K&&K(ResourceStrings.l_Chart),String.format(A.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.b6i(A)||"",A.get_altTitle(),A.get_alt())):null}jkj(A,E,u,K=null){return A&&A.If?(K&&K(ResourceStrings.L_GroupObjects),y.a("GroupShapeAltTitleFixEnabled")?String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:
ResourceStrings.l_AccMessageShapeGroup,A.ix().length,A.get_alt()):String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,A.get_altTitle(),A.get_alt())):null}gkj(A,E,u,K=null){if(A&&u&&A.kla&&!A.ux)if(this.eVc(A,u),E=this.Ea.p7f(A),A.iFa&&(E=ResourceStrings.l_DecorativeLabel),K&&K(E||ResourceStrings.l_TextShape),0<u.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,E||ResourceStrings.l_TextShape,
A.get_altTitle(),A.get_alt()),u.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,E||ResourceStrings.l_TextShape,A.get_altTitle(),A.get_alt());return null}V3i(A,E,u,K=null){return A&&A.Dq&&this.Kd&&this.xF?(A=this.xF.g3(A),A=this.Kd.uwb(A.id),K&&K(A?A.nca:null),A?A.nca:null):null}A3i(A,E,u,K=null){return A&&A.a4?(K&&K(ResourceStrings.l_3DModel),String.format(A.get_alt()?ResourceStrings.l_AccMessage3DAlt:
ResourceStrings.l_AccMessage3D,A.get_altTitle(),A.get_alt())):null}I7f(A){return A.smartArtInfo?x.E$d(A.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(h.ULS.sendTraceTag(588375196,815,10,"SmartArt {0}#{1} has no SmartArtInfo",A.slideId?A.slideId.toString():"",A.get_shapeId()),null)}b6i(A){return x.E$d(A.utb,0,102,"L_ChartType")}vkj(A,E){return(A=this.Ea.wUc(A))&&E?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,E,A):null}static Bnj(A){return x.E$d(A,1,177,"L_SAType")}static E$d(A,
E,u,K){return A>=E&&A<=u&&(A=ResourceStrings[K+A])?A:null}}Object(J.a)(x,"AriaMessageHelper",null,[813])},925:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{static b$k(){}static xKi(){}}h.sendTraceTag=h.b$k;h.debugAssertTag=h.xKi;Object(J.a)(h,"BULS",null,[])},926:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(1014),e=d(27),r=d(166),n=d(57);class v{constructor(B,y,x,A,E,u){this.Pba=B;this.Qba=y;this.$Cd=x;this.sP=A;this.fyc=E;this.$mb=u}get wwh(){return!this.Qba&&
!this.$Cd}get M1g(){return 2===this.$mb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get KTf(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Fdg(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get XTa(){return CommonUIStrings.l_OICErrorHelpLink}get Fcg(){return"OICFailure"}get icon(){return 3}get jsf(){return 2===this.$mb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get eDa(){return CommonUIStrings.l_DefaultDialogTitle}WRk(B){this.W1g(B)}m0j(B){this.W1g(B)}W1g(B){let y=
10;1===B?(n.a.instance.resolve("Common.IOfficeTrialExperience").eoe(this.$mb),y=3):2===B&&((!this.$Cd||this.$Cd(this.sP))&&this.Qba&&h.a.instance.qGi(this.Qba,this.Pba,this.sP),y=5);(0===B||1===B)&&this.Pba&&this.Pba(this.sP);e.AFrameworkApplication.bjb(r.a.E8g,this.fyc,y);this.dispose()}dispose(){this.sP=this.Qba=this.Pba=null}}Object(J.a)(v,"AOICErrorDialogWithTrial",null,[106])},927:function(J,aa,d){d.d(aa,"b",function(){return n});d.d(aa,"g",function(){return v});d.d(aa,"d",function(){return B});
d.d(aa,"f",function(){return x});d.d(aa,"e",function(){return A});d.d(aa,"c",function(){return E});d.d(aa,"a",function(){return u});var h=d(27);d(720);var e=d(1121),r=d(524);d(471);const n=()=>h.AFrameworkApplication.isEmbedded,v=()=>{const K=h.AFrameworkApplication.Aa.hb.dO;return!n()&&!h.AFrameworkApplication.hideHeader&&r.a()&&(K||1===h.AFrameworkApplication.x1i)},B=()=>h.AFrameworkApplication.fa.ka("DiscoverPremiumButtonEnabled"),y=()=>h.AFrameworkApplication.xvh&&!n()&&!h.AFrameworkApplication.hideHeader,
x=()=>y()&&"officecomhwa"!==(h.AFrameworkApplication.fa.Ga(h.AFrameworkApplication.gK)||"").toLowerCase()&&!h.AFrameworkApplication.Kcg,A=()=>!h.AFrameworkApplication.cde&&y(),E=()=>!n()&&!h.AFrameworkApplication.hideHeader&&h.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),u=()=>{if(h.AFrameworkApplication.edg)return null;var K=!!h.AFrameworkApplication.Aa&&h.AFrameworkApplication.Aa.hb.dO;if((h.AFrameworkApplication.Yle&&h.AFrameworkApplication.o_a||h.AFrameworkApplication.avc)&&K)return Object.assign(new e.a,
{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(265).CuiHelper.wmd});if(h.AFrameworkApplication.workflowEnabled){K="";switch(h.AFrameworkApplication.Cvc){case "Assign":K=CommonUIStrings.l_Assign;break;case "Submit":K=CommonUIStrings.l_Submit}if(""!==K)return Object.assign(new e.a,{command:"2988588587",label:K,id:"btnWorkflow"})}return null}},928:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"RibbonPeripheralSection",null,[])},929:function(J,aa,
d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.isForAlertableKpi=this.extendedProperties=null}}Object(J.a)(h,"IKpiUsageOptionalProperties",null,[])},930:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.kpiName=null;this.kpiType=0;this.blockFutureEmissionDurationInMs=this.optionalProperties=null}}Object(J.a)(h,"KpiUsageParams",null,[])},931:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.doNotEmitAggregatedCount=
this.areaName=this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(J.a)(h,"FeatureUsageAndHealthConfig",null,[])},932:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(J.a)(h,"ImageProps",null,[])},933:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=
this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(J.a)(h,"CalloutParameters",null,[])},934:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ICalloutProps",null,[])},935:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.IsFreeForm="IsFreeForm";h.Value="Value";h.Key="Key";h.FontStyle="FontStyle";
Object(J.a)(h,"ComboBoxCommandProperties",null,[])},936:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}h.Alt="Alt";h.CommandValueId="CommandValueId";h.InnerHTML="InnerHTML";h.On="On";h.IsRtl="IsRtl";h.GalleryButtonProps="GalleryButtonProps";h.Text="Text";h.HighlightOn="HighlightOn";Object(J.a)(h,"GalleryButtonCommandProperties",null,[])},937:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(242);class h extends d.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=
this.IconName=this.Label=null}get ControlType(){return 12}}Object(J.a)(h,"ErrorViewProps",d.a,[])},938:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(242);class h extends d.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionId=this.Links=this.Description=this.Label=this.iconSet=this.ActionCommandId=this.CommandId=null}get ControlType(){return 13}}Object(J.a)(h,"MultiActionButtonProps",d.a,[])},939:function(J,aa,d){d.d(aa,"a",function(){return h});
J=d(0);class h{}Object(J.a)(h,"PersonaInfo",null,[])},940:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"PersonaIdentifiers",null,[])},941:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.Vm=e}P5d(e){const r=[];if(e)for(let B in e){var n=B,v=e[B];const y=this.Vm.v7d(n);if(y)for(let x of y)r.push(appChrome.actions.updateControlHiddenState(x,v));else if(n=this.Vm.Saj(n))for(const x of n)if(x.externalUxCommandIds)for(const A of x.externalUxCommandIds)r.push(appChrome.actions.updateControlHiddenState(A,
v));else r.push(appChrome.actions.updateGroupHiddenState(x.externalUxGroupId,v))}return r}L3i(e){const r=[];if(e)for(let n in e){if(!e[n])continue;const v=n;v&&r.push(appChrome.actions.deactivateRibbonTab(v))}return r}}Object(J.a)(h,"ReactRibbonTrimmingHelper",null,[])},942:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(h,"InsightsParameters",null,[])},943:function(J,aa,d){d.d(aa,"a",function(){return h});
J=d(0);class h{}h.YMf="data-ccp-timestamp";h.ZMf="data-clipservice-ccpid";h.cNf="data-shapeids";h.k$f="docs-internal-guid-";h.o8g="SCXO";h.Abh="SCXP";h.UKh="SCXW";h.c0g="MsoListParagraphCxSpFirst";h.d0g="MsoListParagraphCxSpLast";Object(J.a)(h,"HtmlContentMetadataConstants",null,[])},944:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.dLj=e.IsBeforeReady;this.aPj=e.IsFromEndOfSlideshow;
this.summary=e.Summary}}Object(J.a)(h,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},945:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(J.a)(h,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},946:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnBrowserEventArgs",Sys.EventArgs,
[])},947:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.Ptc=e.TimeLineMappings}}Object(J.a)(h,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},948:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;this.slideWidth=e.SlideWidth;this.Lxh=e.SlideLeftBound;this.Ixh=e.SlideBottomBound}}Object(J.a)(h,
"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},949:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},950:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.isVisible=e.IsVisible}}Object(J.a)(h,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},951:function(J,
aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}Object(J.a)(h,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},952:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.Ptc=e.TimeLineMappings}}Object(J.a)(h,"OnPositionChangedEventArgs",Sys.EventArgs,[])},953:function(J,
aa,d){d.d(aa,"a",function(){return e});J=d(0);var h=d(1204);class e extends Sys.EventArgs{constructor(r){super();this.HDh=null;this.HDh="string"===typeof r?Object(h.a)(String,r):r.TranscriberSessionId}}Object(J.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},954:function(J,aa,d){d.d(aa,"a",function(){return x});J=d(0);var h=d(387),e=d(270),r=d(27),n=d(174),v=d(55),B=d(47),y=d(226);class x{static Z7f(A){const E={};E.appSettings=x.fDi();E.singleSignOnSettings=x.w7f();E.appVersion="16";E.appUILocale=
e.a.xe(r.AFrameworkApplication.lcid).dwb;E.dataLocale=e.a.xe(r.AFrameworkApplication.lcid).dwb;E.osfOmexBaseUrl=r.AFrameworkApplication.fa.Ga("50");E.firstPartyManifestCDNUrl=r.AFrameworkApplication.fa.Ga("565");E.sdxCdnUrl=r.AFrameworkApplication.fa.Ga("649");E.sdxDmsUrl=r.AFrameworkApplication.fa.Ga("650");E.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Ga("974");E.docUrl=A?A.documentUrl:"";E.pageBaseUrl=n.a.iP;E.lcid=r.AFrameworkApplication.lcid.toString();E.allowExternalMarketplace=r.AFrameworkApplication.fa.ka("51");
E.localizedScriptsUrl=(r.AFrameworkApplication.mwd?r.AFrameworkApplication.fa.Ga("StaticContentHostNonOverriden"):n.a.iP)+r.AFrameworkApplication.fa.Ga("52");A=A?A.aeg:"";E.localizedImagesUrl=n.a.iP+A;E.localizedStylesUrl=n.a.iP+A;E.localizedResourcesUrl=n.a.P4h(A);E.enableAddinCommands=r.AFrameworkApplication.fa.ka("203");E.enableMyApps=r.AFrameworkApplication.fa.ka("186");E.enableMyOrg=r.AFrameworkApplication.fa.ka("187");E.enableUploadFileDevCatalog=r.AFrameworkApplication.fa.ka("203")&&!r.AFrameworkApplication.fa.ka("847");
E.enableDevCatalog=r.AFrameworkApplication.fa.ka("221");E.devCatalogUrl=r.AFrameworkApplication.fa.Ga("220");E.enablePrivateCatalog=r.AFrameworkApplication.fa.ka("305");E.showSignOutFromPrivateCatalogMessage=r.AFrameworkApplication.fa.ka("307");E.enableBlackForestRedirect=r.AFrameworkApplication.fa.ka("348");E.enableSingleSignOnForAddin=r.AFrameworkApplication.fa.ka("342")&&r.AFrameworkApplication.EKj;E.enableTaskpaneUpgradeToAppCommand=r.AFrameworkApplication.fa.ka("381");E.hideAppsExtensionUrl=
r.AFrameworkApplication.hideAppsExtensionUrl;E.enableAnonymousUseLegacyCatalogService=r.AFrameworkApplication.fa.ka("549");E.enableInsertDialogAccessibilityFix=r.AFrameworkApplication.fa.ka("584");E.enableFirstPartySDXErrorMessages=r.AFrameworkApplication.fa.ka("677");E.disableAppsForOfficeThirdParty=r.AFrameworkApplication.fa.ka("569");E.wacSessionId=r.AFrameworkApplication.userSessionId;E.disableLogging=!r.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");E.loggableUserId=r.AFrameworkApplication.fa.Ga("LoggableUserId");
E.sessionStartInfoJson=r.AFrameworkApplication.fa.Ga("SessionStartInfoJson");E.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;E.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Ga("PostMessageOrigin");E.wacIsEmbedded=r.AFrameworkApplication.fa.ka("IsEmbedded");E.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.ka("1055");E.disableMicrophonePermission=v.a.eO(1)&&r.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&r.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");
E.isHostFrameTrustCheckEnabledForAddIns=r.AFrameworkApplication.fa.ka("1100");E.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;E.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");E.hostAllowedOfficeStore=r.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");E.hostInstallAddIns=r.AFrameworkApplication.fa.Ga("HostInstallAddIns");E.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");E.approvedAddIns=r.AFrameworkApplication.fa.Ga("ApprovedAddIns");
E.isUpnCheckEnabled=r.AFrameworkApplication.fa.ka("1132");E.wacUpn=r.AFrameworkApplication.fa.Ga("UserPrincipalName");E.isReactRibbonEnabled=!0;E.enableSetFocusOnTaskpaneOnUserAction=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);E.enableMyOrg&&E.docUrl&&(A=E.docUrl.split("/"),E.spBaseUrl=2<A.length?A[0]+"//"+A[2]:null,E.spBaseUrl||h.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",
E.docUrl)));E.userNameHashCode=B.a.sN(r.AFrameworkApplication.userName);E.envCode=r.AFrameworkApplication.fa.Bc("312",0).toString();return E}static fDi(){const A={};A.AddinRibbonIdAllowUnknown=r.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");A.AddinRibbonNativeGroupControlIsEnabled=!0;A.AddinRibbonTabAutoFocusIsEnabled=!0;A.AddinRibbonTabPositionIsEnabled=!0;A.AgaveAddinUploadEnabled=r.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");A.DevConsoleEnabled=r.AFrameworkApplication.fa.ka("AddinDevConsoleLog");
A.ManifestParserDevConsoleEnabled=!0;A.flightingTreatmentVariables=r.AFrameworkApplication.fa.IQc;A.DisabledChangeGates=r.AFrameworkApplication.fa.Ga("DisabledChangeGates");return A}static w7f(){try{const A={};v.a.OFa&&y.OAuthManagerSettings.Y$a&&(A.UiHostSupportsAuthTokenAddinList=x.EQc);A.UiHostSupportsAuthToken=y.OAuthManagerSettings.Y$a;return A}catch(A){h.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",A.message)}return null}}x.EQc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
Object(J.a)(x,"AppForOfficeHelper",null,[])},955:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.A0g=e}}Object(J.a)(h,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},956:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r,n){this.qYa={};this.M9c=e;this.qDb=r;this.Iec=n}Kta(e,r,n,v){r=h.CNf;if(this.qDb)if(this.Iec){const B=e.UserId?e.UserId.toLowerCase():null;n=n?n.toLowerCase():null;r=B&&B in this.qYa?
this.qYa[B]:n&&n in this.qYa?this.qYa[n]:this.M9c.Kta(e,v);!B||B in this.qYa||(this.qYa[B]=r);!n||n in this.qYa||(this.qYa[n]=r)}else r=this.M9c.Kta(e,v);return r}}h.CNf="#C0C0C0";Object(J.a)(h,"PresenceColorProvider",null,[316])},957:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.NE=e}}Object(J.a)(h,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},958:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(1153),e=d(27),r=
d(36),n=d(81);class v{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}CLb(){return r.c([this.Zk(),this])}execute(B,y,x){let A="RoamingAppsHandler.ashx";h.a.instance.CTe&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(A=n.a.Ni(A,"wdEnableRoaming","1"));e.AFrameworkApplication.Ke.nj(A,2,this.CLb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.vxb(),B,y,x,void 0,void 0,void 0,void 0,"6")}}Object(J.a)(v,"ARoamingAppsRequest",null,[])},959:function(J,aa,d){d.d(aa,
"a",function(){return 2});d.d(aa,"c",function(){return h});d.d(aa,"b",function(){return e});const h=(r,n,v=2)=>{let B;if(0>n||n>r[r.length-1])throw Error.argumentOutOfRange("y");B=!0;let y=0,x;const A=r.length-1;for(x=0;x<A;x++){const E=y;y=r[x+1];if(n<y){y-n<v&&x<A-1?x++:n-E>=v&&(B=!1);break}}return{returnValue:x<A?x:-1,rle:B}},e=(r,n,v=2)=>{let B;if(0>n||n>r[r.length-1])throw Error.argumentOutOfRange("x");B=!0;let y=0,x;const A=r.length-1;for(x=0;x<A;x++){const E=y;y=r[x+1];if(n<y){y-n<v&&x<A-1?
x++:n-E>=v&&(B=!1);break}}return{returnValue:x<A?x:-1,rle:B}}},960:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.QQa=this.xW=0;this.skipUndo=!1;this.Jp=this.selectionSlide=null;this.version=0;this.tD=this.location=null;this.dataType=0;this.Yjc=null;this.objectCount=0;this.kFa=this.mFa=!1;this.Cy=this.Qsa=this.nodes=null}toString(){const e=JSON.stringify(this.Qsa);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",
this.Jp,this.version,this.tD,this.dataType,this.objectCount,this.mFa,this.kFa,e,this.xW)}}Object(J.a)(h,"ClipServiceObject",null,[])},961:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r){this.Du=e;this.Wb=r}}Object(J.a)(h,"ClipServiceCopyParams",null,[])},962:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(387),e=d(97);aa=d(1134);var r=d.n(aa),n=d(916);class v{static tpd(B,y,x){if(B&&x&&(e.a.qCa(B),y&&""!==y))try{n.a("HtmlStringSanitizeByDomPurify")&&
(y=r.a.sanitize(y));const A=v.vRh.parseFromString(y,"text/html");if(A&&A.body){const E=A.body.childNodes;for(y=0;y<E.length;y+=1)B.appendChild(E[y].cloneNode(!0))}}catch(A){h.ULS.sendTraceTag(523106530,324,10,"In class: {0}, unable to parse HTML, {1}",x,A.message)}}}v.vRh=new DOMParser;Object(J.a)(v,"DOMParserHelper",null,[])},963:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(14),e=d(75),r=d(67),n=d(135);class v extends Sys.UI.Control{constructor(B,y,x,A){super(document.createElement("div"));
this.a7=this.Y6=this.dF=this.G2a=this.oS=this.UMa=this.EOa=null;this.eTb=this.HNa=!1;this.content=this.aC=null;this.gba=0;this.Yzf=null;this.TZ=0;this.Igd=null;this.hqf=B;this.Cpb=y;this.GP=x;this.jWd=A;this.ji=y.ownerDocument;this.f8b=this.Ar=this.NTb=!1}get KJ(){this.EOa||(this.EOa=this.ji.createElement("div"),this.EOa.id=this.Oh("WACCalloutOuter"),this.EOa.className="WACCalloutOuter",this.EOa.setAttribute(n.a.af,n.a.fSd),this.EOa.style.width=this.gba+"px");return this.EOa}get rsb(){if(!this.UMa){this.UMa=
this.ji.createElement("div");this.UMa.id=this.Oh("WACCalloutBeakContainer");this.UMa.className="WACCalloutBeakContainer";var B="CalloutBeakTopFilled_32x16x32";if(5===this.TZ||6===this.TZ||4===this.TZ)B="CalloutBeakBottomFilled_32x16x32";B=e.createClusteredImage(32,16,B,"WACCalloutBeak",!0,"");this.UMa.appendChild(B)}return this.UMa}set rsb(B){this.UMa=B}get AL(){return this.NTb}get title(){return this.aC}set title(B){this.aC!==B&&(this.aC=B,this.Y6&&(this.Y6.innerText=this.aC))}get Ar(){return this.HNa}set Ar(B){this.HNa!==
B&&(this.HNa=B,this.oS&&(this.oS.contains(this.dF)&&!this.HNa?this.oS.removeChild(this.dF):!this.oS.contains(this.dF)&&this.HNa&&this.Osf()))}get f8b(){return this.eTb}set f8b(B){this.eTb!==B&&(this.eTb=B,this.oS&&(this.oS.contains(this.Y6)&&!this.eTb?this.oS.removeChild(this.Y6):!this.oS.contains(this.Y6)&&this.eTb&&this.puf()))}show(){this.NTb||(this.nEi(),this.zhi(),this.Cpb.appendChild(this.KJ),this.KJ.style.display="Block",this.TWe(),this.NTb=!0,this.Igd&&this.Igd())}dismiss(){this.NTb&&(this.LMi(),
this.Cpb.removeChild(this.KJ),this.NTb=!1,this.jWd&&this.jWd())}dispose(){this.dismiss();this.Y6=this.dF=this.G2a=this.UMa=this.oS=this.EOa=null;Sys.Component.prototype.dispose.call(this)}Oh(B){return this.get_element().id+B}nEi(){this.oS=this.ji.createElement("div");this.oS.id=this.Oh("WACCalloutHeader");this.oS.className="WACCalloutHeader";this.Ar&&this.Osf();this.f8b&&this.puf();this.G2a=this.ji.createElement("div");this.G2a.id=this.Oh("WACCalloutContent");this.G2a.className="WACCalloutContent";
this.G2a.style.width=190<this.gba?this.gba-26+"px":"164px";this.G2a.appendChild(this.content);this.KJ.appendChild(this.rsb);this.KJ.appendChild(this.oS);this.KJ.appendChild(this.G2a)}Osf(){this.dF=this.ji.createElement("a");this.dF.className="WACCalloutCloseAnchor";this.dF.id=this.Oh("WACCalloutCloseAnchor");this.dF.href="#";this.oS.appendChild(this.dF);const B=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.dF.appendChild(B)}puf(){this.Y6=
this.ji.createElement("div");this.Y6.className="WACCalloutTitle UIFontBold";this.Y6.style.width=190<this.gba?this.gba-30+"px":"160px";this.Y6.id=this.Oh("WACCalloutTitle");this.Y6.innerText=this.title;this.oS.contains(this.dF)?this.oS.insertBefore(this.Y6,this.dF):this.oS.appendChild(this.Y6)}TWe(){var B=this.hqf;let y;if(1===this.TZ){var x=this.Yzf.y+16;y=-16}else 2===this.TZ||3===this.TZ||0===this.TZ?(x=B.y+B.height+15,y=-15):(x=B.y-this.KJ.clientHeight-15-2,y=this.KJ.clientHeight-1);this.KJ.style.top=
x+"px";this.rsb.style.top=y+"px";1===this.TZ?(B=this.Yzf.x-16,this.KJ.style.left="50%",this.KJ.style.marginLeft=-this.gba/2+"px",x=Sys.UI.DomElement.getBounds(this.KJ),this.rsb.style.left=B-x.x+"px"):(x=B.x+this.hqf.width/2,2===this.TZ||5===this.TZ?(B=20,x-=36):0===this.TZ||4===this.TZ?(B=this.gba/2-16,x-=this.gba/2):(B=this.gba-20-32,x=x-this.gba+36),this.KJ.style.left=x+"px",this.rsb.style.left=B+"px")}zhi(){this.Ar&&!this.a7&&(this.a7=Object(h.a)(this,this.e3,"closeHandler"),this.GP.pb(r.a.click,
this.dF,this.a7,null))}LMi(){this.Ar&&this.a7&&(this.GP.yb(r.a.click,this.dF,this.a7),this.a7=null)}e3(){this.dismiss();return!0}}Object(J.a)(v,"Callout",Sys.UI.Control,[650])},964:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=
this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(J.a)(h,"CT_LineProperties",null,[])},965:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(J.a)(h,"CT_PresetLineDashProperties",null,[])},966:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e){this.Dhk=e}get Arc(){return this.Dhk}}Object(J.a)(h,
"ShowHideNotesData",null,[])},967:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);d=d(898);class h extends d.a{constructor(e,r){super(r);this.THg=e;this.beb=0}pVf(){const e=(new Date).getTime(),r=e-this.beb;if(0<this.beb&&0>=this.THg-r)return this.beb=0,this.RUd(),!0;this.beb=e;this.RUd();this.setTimeout(this.THg);return!1}}Object(J.a)(h,"FunctionDelayer",d.a,[])},968:function(J,aa,d){d.d(aa,"b",function(){return e});d.d(aa,"a",function(){return r});d.d(aa,"c",function(){return n});var h=
d(47);d(402);d(29);d(61);const e=(v,B)=>{const y=[];if(v.length!==B.length)return y;for(let x=0;x<v.length;x++){const A={};A.key=B[x];A.text=v[x];A.type="AppComboBoxItem";y[x]=A}return y},r=(v,B,y,x,A)=>({["unitType"]:v,["unitPlaceholder"]:h.a.rLe(B),["minValue"]:y,["maxValue"]:x,["step"]:A}),n=v=>"1.00"===v?1:"1.50"===v?1.5:"2.00"===v?2:0},969:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{static add(e,r,n,v,B){h.vtg[h.SZf(e,r,n,v,B)]=!0}static contains(e,r,n,v,B){return h.SZf(e,
r,n,v,B)in h.vtg}static SZf(e,r,n,v,B){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),r,n.toLowerCase(),v.toLowerCase(),B.toLowerCase())}}h.vtg={};Object(J.a)(h,"AppsInsertedStorage",null,[])},970:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);var h;(function(e){e[e.myAddins=0]="myAddins";e[e.adminManaged=1]="adminManaged";e[e.popular=2]="popular"})(h||(h={}));Object(J.b)("AddinCollectionType",h)},971:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,
"AppsForOfficeEntitlementQueryInfo",null,[])},972:function(J,aa,d){d.d(aa,"a",function(){return E});J=d(0);var h=d(105),e=d(1204),r=d(40),n=d(42),v=d(32),B=d(84),y=d(247),x=d(39),A=d(973);class E{static dDi(u,K,G){u=Object(e.a)(B.a,u.createInstance(1074135137));E.Otf(u,K,G);return u}static H5h(u,K){v.GraphIterator.nb(u).Cl(K,19)}static Otf(u,K,G){u.setValue(n.a.LHc,0===K.targetType);u.setValue(n.a.Qrb,K.solutionId);u.setValue(n.a.QHc,K.version);u.setValue(n.a.oZb,K.storeType);u.setValue(n.a.PHc,K.storeId);
u.setValue(x.a.nZb,G.uLc(K.storeType));K.assetId&&u.setValue(x.a.cRd,K.assetId);u.setValue(x.a.Swf,K.assetStoreId);void 0===K.isAddinCommands?u.setValue(x.a.isAddinCommands,!1):u.setValue(x.a.isAddinCommands,K.isAddinCommands);K.sharedRuntimeId&&-1!==K.backgroundState&&(u.setValue(x.a.osb,K.backgroundState),u.setValue(x.a.F6a,K.sharedRuntimeId));0===K.targetType&&(u.setValue(x.a.Dq,!0),G=K.height?K.height:200,u.setValue(r.a.wx,K.width?K.width:200),u.setValue(r.a.JC,G))}static YGh(u,K,G){const O=h.a.Yqc(G);
A.b(K,V=>{V=V.eb(n.a.NHc);return!!V&&!(V in O)});A.a(K,(V,D)=>{const Q=D.eb(n.a.NHc);Q&&Q in O&&(E.FDl(D,O[Q],V),delete O[Q])});const R=v.GraphIterator.nb(K);h.a.forEach(O,(V,D)=>{R.Cl(E.eDi(u,V,D),21)},null)}static eDi(u,K,G){u=Object(e.a)(B.a,u.createInstance(1074135139));u.setValue(n.a.NHc,K);u.setValue(n.a.OHc,G);return u}static FDl(u,K,G){u.setValue(n.a.OHc,K);G.sa(n.a.LHc,!0)?y.d(G,u,E.h6k):y.d(G,u,E.A6k)}}E.h6k=[x.a.sid,x.a.cid,x.a.shapeId];E.A6k=[n.a.Qrb];Object(J.a)(E,"AppEditor",null,[])},
973:function(J,aa,d){d.d(aa,"a",function(){return r});d.d(aa,"b",function(){return n});var h=d(32),e=d(974);const r=(v,B)=>{const y=new h.GraphIterator;y.set(v);let x=y.Bb(21);for(;x;)e.a(x)&&B(v,x),x=y.Cf(21)},n=(v,B)=>{const y=new h.GraphIterator;y.set(v);let x=y.Bb(21);for(;x&&x!==v;)x=e.a(x)&&B(x)?y.vRa(21):y.Fj(21)}},974:function(J,aa,d){d.d(aa,"b",function(){return e});d.d(aa,"a",function(){return r});var h=d(42);const e=(n,v)=>{v[n.eb(h.a.NHc)]=n.eb(h.a.OHc)},r=n=>1074135139===n.Ue},975:function(J,
aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(47),e=d(93),r=d(28),n=d(35);class v{constructor(B){this.gna=null;this.Pfc=0;this.Tdc=B;switch(this.Tdc){case "audio":this.gna=v.Vjk;this.Pfc=v.o7j;break;case "captions":this.gna=v.Wjk;this.Pfc=v.E7j;break;case "video":this.gna=v.Xjk;this.Pfc=v.ekk;break;default:r.a.J(509727835,822,10,"Invalid file type")}}static set FJl(B){v.Xjk=B}static set AKl(B){v.ekk=B}Dsi(B){switch(this.Tdc){case "audio":return v.Bsi(B);case "captions":return v.Csi(B);case "video":return n.a("DisableVideoAsFileCheck")?
new Promise(y=>{y(!0)}):v.Esi(B);default:return r.a.J(509727834,822,10,"Invalid file type"),new Promise(y=>{y(!1)})}}TJl(B){B=h.a.rg(B);for(let y=0;y<this.gna.length;++y){const x=this.gna[y];if(x&&0<x.length&&B.endsWith(x))return!0}return!1}UJl(B){return B<=1048576*this.Pfc}static Bsi(B){return new Promise((y,x)=>{if(B&&B.size){var A=document.createElement("video"),E=URL.createObjectURL(B);A.setAttribute("src",E);e.a.addHandler(A,"loadedmetadata",()=>{URL.revokeObjectURL(E);const u=A.videoHeight,
K=A.videoWidth;0<A.duration&&!u&&!K?y(!0):(r.a.J(509727832,822,10,"Invalid audio File"),y(!1))});e.a.addHandler(A,"error",()=>{URL.revokeObjectURL(E);r.a.J(509727831,822,10,"Invalid audio File");x(ResourceStrings.L_InvalidAudioFileError)})}else r.a.J(509727833,822,10,"Empty media File"),y(!1)})}static Csi(B){return new Promise((y,x)=>{if(B&&B.size){var A=URL.createObjectURL(B),E=document.createElement("video"),u=document.createElement("track");E.appendChild(u);e.a.addHandler(u,"load",()=>{URL.revokeObjectURL(A);
y(!0)});e.a.addHandler(u,"error",()=>{URL.revokeObjectURL(A);r.a.J(509727829,822,10,"Invalid captions File");x(ResourceStrings.l_InvalidCaptionsFileError)});u.setAttribute("src",A);u.setAttribute("default","true")}else r.a.J(509727830,822,10,"Empty captions File"),y(!1)})}static Esi(B){return new Promise((y,x)=>{if(B&&B.size){var A=document.createElement("video"),E=URL.createObjectURL(B);A.setAttribute("src",E);e.a.addHandler(A,"loadedmetadata",()=>{URL.revokeObjectURL(E);const u=A.videoHeight,K=
A.videoWidth;0<A.duration&&0<u&&0<K?y(!0):(r.a.J(509727837,822,10,"Invalid video File"),y(!1))});e.a.addHandler(A,"error",()=>{URL.revokeObjectURL(E);r.a.J(509727836,822,10,"Invalid video File");x(ResourceStrings.L_InvalidVideoFileError)})}else r.a.J(509727838,822,10,"Empty media File"),y(!1)})}static s2f(B){return B&&B.value?B.files[0].size.toString():"Invalid number of files"}static A7d(B){if(!B||!B.value)return"Input file name is null";const y=B.value.lastIndexOf(".");return-1===y?"":B.value.substring(y+
1,y+5)}}v.o7j=16;v.E7j=16;v.Wjk=[".vtt"];v.Vjk=[".mp3",".wav",".m4a",".aac",".oga"];Object(J.a)(v,"MediaValidationHelper",null,[])},976:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.aVf=e}}Object(J.a)(h,"CommentContainersChangedEventArgs",Sys.EventArgs,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.ext.js.map