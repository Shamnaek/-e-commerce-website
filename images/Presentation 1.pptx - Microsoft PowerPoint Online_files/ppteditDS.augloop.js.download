'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1243:function(J,aa,d){d.r(aa);var h=d(0),e=d(387),r=d(27),n=d(55),v=d(71),B=d(18),y=d(14);class x{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(h.a)(x,"AugmentationServiceRequest",null,[]);var A=d(36),E=d(68);class u{constructor(xa,sb,Jb){this.Tqb=this.jra=null;this.iOh=Jb;this.$a=sb;this.Yh=xa}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");
const xa=this.$a.Ga("AugmentationLoopWebServiceBase"),sb=this.$a.Ga("WebServiceBase");this.jra=(void 0===xa?sb:xa)+"proofing.ashx?"+r.AFrameworkApplication.hh+"&apitype=AL";this.Tqb=new E.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(xa,sb){if(xa&&""!==xa)if(sb){if(!({value:Jb}=this.Tqb.Tf(xa)).returnValue){var Jb=new B.a;this.Tqb.add(xa,Jb)}Jb.contains(sb)||Jb.add(sb)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,
306,15,"topic is empty or null")}removeEventHandler(xa,sb){xa&&""!==xa?sb?this.Tqb.Gb(xa)?({value:xa}=this.Tqb.Tf(xa),xa&&xa.contains(sb)&&xa.remove(sb)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",xa):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}$Ue(xa,sb,Jb){this.fpc(xa,sb,Jb,Object(y.a)(this,this.DKa,"requestSucceeded"),Object(y.a)(this,this.BKa,"requestFailed"))}fpc(xa,sb,Jb,uc,Gd,
ee=null){xa=Object.assign(new x,{Topic:xa,Payload:sb,AppId:this.iOh,SessionId:this.Yh.userSessionId,ContextId:Jb});this.Yh.nj(this.jra,2,A.c(xa),{"Content-Type":"application/json; charset=utf-8"},!1,3,uc,Gd,ee?ee:xa,void 0,void 0,void 0,void 0,"18")}DKa(xa){!r.AFrameworkApplication.Ug&&xa&&xa.data&&this.rsk(xa.data.Wd)}BKa(xa){!r.AFrameworkApplication.Ug&&xa&&xa.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",xa.data.Wd)}rsk(xa){if(xa){try{var sb=A.a(xa)}catch(Jb){e.ULS.sendTraceTag(36284437,306,10,
"Try parse aug response failed:{0}",Jb.message);return}if(({value:xa}=this.Tqb.Tf(sb.Topic)).returnValue)for(let Jb of xa)Jb(sb.ContextId,sb.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",sb.Topic)}}}Object(h.a)(u,"AugmentationManager",null,[950]);var K=d(1204);class G{}Object(h.a)(G,"HostMetadata",null,[]);class O{}Object(h.a)(O,"Lambda",null,[]);class R extends O{constructor(){super()}}Object(h.a)(R,"WrapperLambda",O,[]);var V=d(398),D=d(142);class Q{constructor(){this.handler=
this.schemaName=null}}Object(h.a)(Q,"AddEventHandlerParameters",null,[]);var Z=d(662);class P{constructor(){this.lambda=this.name=null}}Object(h.a)(P,"RegisterSimpleLocalWorkflowParameters",null,[]);class ca{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(h.a)(ca,"RegisterSimpleRemoteWorkflowParameters",null,[]);var T=d(978);class da{constructor(){this.requestAuthTokenCallback=null}}Object(h.a)(da,"SetRequestAuthTokenCallbackParameters",null,[]);class fa{constructor(){this.sendOTelEvent=
null}}Object(h.a)(fa,"SetSendOTelEventCallbackParameters",null,[]);class ma{constructor(){this.ulsLogger=null}}Object(h.a)(ma,"SetULSLoggerParameters",null,[]);var ea=d(921);class ra{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(h.a)(ra,"SubmitParameters",null,[]);var F=d(531);class na{constructor(xa,sb=null){this.kZ=null;new E.a;new G;this.J0h=xa;this.zOa=sb}initialize(xa){this.kZ?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(xa||(xa=new Z.a),
this.kZ=new Promise(sb=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const Jb=r.AFrameworkApplication.Bj("al",2);this.J0h.iBb(Jb).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const uc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();uc.setRequestAuthTokenCallback(Object.assign(new da,{requestAuthTokenCallback:Object(y.a)(this,this.B2k,"requestAuthToken")}));uc.setULSLogger(Object.assign(new ma,{ulsLogger:new V.a}));
uc.setSendOTelEventCallback(Object.assign(new fa,{sendOTelEvent:Object(y.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let Gd=r.AFrameworkApplication.fa.Ga("OfficeApplicationName")||"";Gd=Gd.replace("Web","");xa.appName=xa.appName||Gd;xa.serviceUrl=xa.serviceUrl||r.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl");xa.appVersion=xa.appVersion||r.AFrameworkApplication.fa.Ga("BuildVersion")||"";xa.releaseAudienceGroup=xa.releaseAudienceGroup||(r.AFrameworkApplication.gd?Object(K.a)(String,r.AFrameworkApplication.gd.AudienceGroup)||
"":"");xa.sessionId=xa.sessionId||r.AFrameworkApplication.fa.Ga("SessionId")||"";xa.uiLanguage=xa.uiLanguage||r.AFrameworkApplication.uiCulture;xa.flights=xa.flights||this.B3i();xa.initSession=xa.initSession||!0;xa.downloadBaseUrl=xa.downloadBaseUrl||r.AFrameworkApplication.fa.Ga("AugLoopDownloadBaseUrl");uc.initialize(xa);sb({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.kZ}registerSimpleLocalWorkflow(xa,sb){return this.kZ.then(()=>{e.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",xa);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new P,{name:xa,lambda:this.Xtd(sb)}))})}registerSimpleRemoteWorkflow(xa,sb,Jb,uc){return this.kZ.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",xa);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new ca,{name:xa,lambdaBefore:this.Xtd(sb),lambdaRemote:this.Xtd(Jb),
lambdaAfter:this.Xtd(uc)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.kZ}submit(xa,sb){this.kZ.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",xa);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new ra,{inputSchema:xa,input:sb}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(xa){this.kZ.then(()=>{e.ULS.sendTraceTag(51185358,306,
100,"Submitting Operation: {0} to AugLoop.",xa);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new ea.a,{operation:xa}))})}setSessionDataCallback(xa){this.kZ.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(xa)})}setInitSessionCallback(xa){this.kZ.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(xa)})}setSessionInitOverrideCallback(xa){this.kZ.then(()=>
{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(xa)})}setAnnotationResultCallback(xa){this.kZ.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new T.a,{handler:xa}))})}activateAnnotation(xa){return this.kZ.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
xa.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(xa)})}releaseAnnotation(xa){return this.kZ.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",xa.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(xa)})}addEventHandler(xa,sb){xa&&""!==xa?sb?this.kZ.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new Q,
{schemaName:xa,handler:Jb=>{Jb&&sb(Jb.inputSchema,Jb.input,Jb.outputSchema,Jb.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}B2k(){const xa=r.AFrameworkApplication.fa.Ga("AugLoopOAuthResourceUriV2");if(this.zOa)return new Promise(sb=>{this.zOa.execute(Jb=>{Jb.sV("AugLoop",xa).then(uc=>{uc.IsSuccess?sb(uc.Token):(e.ULS.sendTraceTag(51499467,
306,15,uc.ErrorMessage),sb(r.AFrameworkApplication.fa.Ga("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(xa){D.a.sendOtelEvent(Object.assign(new F.a,{otelEvent:xa}))}Xtd(xa){if(xa){let sb=null;xa.func&&(sb=(Jb,uc,Gd,ee)=>{xa.func(Jb,uc,ee)});return Object.assign(new R,{name:xa.name,inputSchema:xa.inputSchema,outputSchema:xa.outputSchema,func:sb})}return null}B3i(){var xa=r.AFrameworkApplication.fa.Ga("FlightId");
const sb=r.AFrameworkApplication.fa.YA("AugLoopFlightKeywordList"),Jb=[];if(xa&&""!==xa&&sb&&0<sb.length){xa=xa.split(";");for(let uc=0;uc<xa.length;uc++)for(let Gd=0;Gd<sb.length;Gd++)-1<xa[uc].toLowerCase().indexOf(sb[Gd].toLowerCase())&&Array.add(Jb,xa[uc])}return 0<Jb.length?Jb.join(";"):""}}Object(h.a)(na,"NewAugLoopRuntimeManager",null,[949]);var ka=d(57),Ua=d(1235),za=d(47);class ha{}Object(h.a)(ha,"Lambda",null,[974]);var ua=d(919);class Ga{constructor(){this.documentOpenType=this.getItemsEndPoint=
this.downloadUrl=null}}Object(h.a)(Ga,"PowerPointParameters",null,[]);class sa{constructor(){this.initSessionCallback=null}}Object(h.a)(sa,"SetInitSessionCallbackParameters",null,[]);class Ba{constructor(){this.sessionDataCallback=this.handler=null}}Object(h.a)(Ba,"SetSessionDataCallbackParameters",null,[]);class pa{constructor(){this.handler=null}}Object(h.a)(pa,"SetSessionInitOverrideCallbackParameters",null,[]);var ia=d(348),Da=d(520),Xa=d(143);class Ka extends Da.a{constructor(){super();this.H_=
Object.assign(new Xa.a,{T_:Ka.getTypeName(),B_:Ka.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(h.a)(Ka,"DeleteOperation",Da.a,[]);var Ma=d(695),Oa=d(320);class qa extends Oa.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new Xa.a,{T_:qa.getTypeName(),B_:qa.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}
Object(h.a)(qa,"Message",Oa.a,[]);class Ya extends qa{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new Xa.a,{T_:Ya.getTypeName(),B_:Ya.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}
Object(h.a)(Ya,"SessionInitMessage",qa,[]);class Fb extends Ya{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new Xa.a,{T_:Fb.getTypeName(),B_:Fb.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(h.a)(Fb,"PowerPointSessionInitMessage",Ya,[]);var hc=d(35);class ec{constructor(){this.authToken=
this.origin=this.jqh=null}}Object(h.a)(ec,"SessionData",null,[]);var Tb=d(537);class vb{constructor(xa,sb,Jb){this.Zpe=new E.a;this.p3c=new E.a;this.zpe=new E.a;this.oFb=this.Gad=this.pCb=this.aR=null;this.kz=xa;this.Ha=sb;this.wi=Jb;const uc=new Z.a;uc.powerpoint=new Ga;if(hc.a("AL.SendSlideTile"))if(hc.a("AL.EnableRehydration"))this.kz.initialize(new Z.a),this.kz.setInitSessionCallback(Object.assign(new sa,{initSessionCallback:Object(y.a)(this,this.Yyk,"onSessionInit")})),this.kz.setSessionInitOverrideCallback(Object.assign(new pa,
{handler:Object(y.a)(this,this.Zyk,"onSessionInitOverride")})),this.oFb=this.EXc(),this.kz.setAnnotationResultCallback(Object(y.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.Q9=Promise.resolve(null);else{xa=ka.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;sb=ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;xa=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",sb,xa);sb=ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").W9a?
ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").BTc:ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Gd=String.format("{0}getitems.ashx",sb);sb=new Ua.a(r.AFrameworkApplication.Ke);this.Q9=Tb.b(sb.kVe(xa));this.Q9.then(ee=>{try{const se=JSON.parse(ee),$e=se.downloadUrl;za.a.Wa($e)?e.ULS.sendTraceTag(51422528,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",se):(uc.powerpoint.downloadUrl=$e,uc.powerpoint.getItemsEndPoint=
Gd,this.Ha.z3b&&(uc.powerpoint.documentOpenType=this.k5f()))}catch(se){e.ULS.sendTraceTag(51422529,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",se)}this.kz.initialize(uc);this.oFb=this.EXc();this.kz.setAnnotationResultCallback(Object(y.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(ee=>{e.ULS.sendTraceTag(51422530,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",ee);this.kz.initialize(uc);this.oFb=this.EXc();
this.kz.setAnnotationResultCallback(Object(y.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.Q9=new Promise(ee=>{this.kz.initialize(uc);this.oFb=this.EXc();this.kz.setAnnotationResultCallback(Object(y.a)(this,this.onAnnotationResult,"onAnnotationResult"));ee("")})}tia(xa){this.Q9.then(sb=>{this.kz.activateAnnotation(Object.assign(new ua.a,{annotationType:xa}));return sb})}oKa(xa,sb){if(xa)if(sb){if(!({value:Jb}=this.Zpe.Tf(xa)).returnValue){var Jb=new B.a;this.Zpe.add(xa,Jb)}Jb.contains(sb)||
Jb.add(sb)}else e.ULS.sendTraceTag(51388803,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(51388802,306,15,"Annotation Type is null or empty")}qhh(xa,sb){if(xa)if(sb){if(!({value:Jb}=this.p3c.Tf(xa)).returnValue){var Jb=new B.a;this.p3c.add(xa,Jb)}Jb.contains(sb)||Jb.add(sb)}else e.ULS.sendTraceTag(575931363,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(575931362,306,15,"Annotation Type is null or empty")}addEventHandler(xa,sb){this.Q9.then(()=>{this.kz.addEventHandler(xa,
sb);return null})}removeEventHandler(xa,sb){this.Q9.then(()=>{this.kz.removeEventHandler(xa,sb);return null})}registerSimpleLocalWorkflow(xa,sb){return this.Q9.then(()=>this.kz.registerSimpleLocalWorkflow(xa,this.Ytd(sb)))}registerSimpleRemoteWorkflow(xa,sb,Jb,uc){return this.Q9.then(()=>this.kz.registerSimpleRemoteWorkflow(xa,this.Ytd(sb),this.Ytd(Jb),this.Ytd(uc)))}submit(xa,sb){this.Q9.then(()=>{this.kz.submit(xa,sb);return null})}submitOperation(xa){this.Q9.then(()=>{this.kz.submitOperation(xa);
return null})}vIl(xa,sb,Jb,uc,Gd){this.oFb&&this.oFb.then(()=>{this.wi.augmentImage(xa,sb,Jb,!0,this.Gad.jqh,this.Gad.origin,this.Gad.authToken,uc,Gd);return null})}Zyk(xa){e.ULS.sendTraceTag(594609494,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const sb=Object.assign(new Fb,{protocolVersion:xa.protocolVersion,clientMetadata:xa.clientMetadata,sessionKey:xa.sessionKey,origin:xa.origin,authToken:xa.authToken,messageId:xa.messageId,cv:xa.cv});try{this.Ha.z3b&&(sb.documentOpenType=this.k5f())}catch(Jb){e.ULS.sendTraceTag(578155528,
306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",Jb)}this.Mbl(xa);if(za.a.Wa(this.aR)||za.a.Wa(this.pCb))return e.ULS.sendTraceTag(594609493,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),xa;sb.downloadUrl=this.aR;sb.getItemsEndPoint=this.pCb;this.pCb=this.aR=null;return sb}Yyk(){e.ULS.sendTraceTag(594609492,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var xa=ka.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;
const sb=ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Jb=ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").W9a?ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").BTc:ka.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;xa=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",sb,xa);const uc=String.format("{0}getitems.ashx",Jb);Jb=new Ua.a(r.AFrameworkApplication.Ke);return Tb.b(Jb.kVe(xa)).then(Gd=>
{try{const ee=JSON.parse(Gd),se=ee.downloadUrl;za.a.Wa(se)?e.ULS.sendTraceTag(594609491,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",ee):(this.aR=se,this.pCb=uc)}catch(ee){e.ULS.sendTraceTag(594609490,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",ee)}return null}).catch(Gd=>{e.ULS.sendTraceTag(594609489,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Gd)})}EXc(){return new Promise(xa=>{this.kz.setSessionDataCallback(Object.assign(new Ba,
{sessionDataCallback:(sb,Jb,uc)=>{this.Gad=Object.assign(new ec,{jqh:sb,origin:Jb,authToken:uc});xa(null)}}))})}onAnnotationResult(xa){if(xa&&xa.items)if(Oa.a.sTa(xa)!==ia.a.getTypeName()&&Oa.a.sTa(xa)!==Ma.a.getTypeName())this.Ha.YRf&&Oa.a.sTa(xa)===Ka.getTypeName()&&this.Mtk(xa);else for(const Jb of xa.items){if(!Jb||!Jb.body)continue;const uc=Oa.a.sTa(Jb.body);if(!uc)continue;var sb=Jb.body||{};xa.parentPath&&(sb.parentPath=xa.parentPath);let Gd=null;if(!({value:Gd}=this.Zpe.Tf(uc)).returnValue)e.ULS.sendTraceTag(51388804,
306,50,"Cannot find handlers for annotation:{0};",uc);else if(Gd)for(let ee of Gd)ee(sb);if(this.Ha.YRf){sb=null;if(({value:sb}=this.p3c.Tf(uc)).returnValue)for(let ee of sb)ee(Jb,!1);za.a.Wa(Jb.id)||this.zpe.$(Jb.id,uc)}}}Mtk(xa){for(const sb of xa.items){if(!sb||!sb.id)continue;if(!({value:xa}=this.zpe.Tf(sb.id)).returnValue)continue;let Jb=null;if(({value:Jb}=this.p3c.Tf(xa)).returnValue)for(let uc of Jb)uc(sb,!0);this.zpe.remove(sb.id)}}Ytd(xa){return xa?Object.assign(new ha,{name:xa.name,inputSchema:xa.inputSchema,
outputSchema:xa.outputSchema,func:xa.func}):null}k5f(){try{return this.Ha.GQ?0:this.Ha.qVa?2:1}catch(xa){return e.ULS.sendTraceTag(578697036,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",xa),2}}Mbl(xa){try{za.a.Wa(xa.clientMetadata.flights)?xa.clientMetadata.flights=";":xa.clientMetadata.flights+=";",this.Ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?xa.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":
xa.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;"}catch(sb){e.ULS.sendTraceTag(559445142,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",sb)}}}Object(h.a)(vb,"PPTAugLoopRuntimeManager",null,[948]);class zb{constructor(xa){this.TT=xa;this.TT.initialize()}addEventHandler(xa,sb){this.TT.addEventHandler(xa,sb)}removeEventHandler(xa,sb){this.TT.removeEventHandler(xa,sb)}$Ue(xa,sb,Jb){this.TT.$Ue(xa,sb,Jb)}fpc(xa,sb,Jb,uc,Gd,ee=
null){this.TT.fpc(xa,sb,Jb,uc,Gd,ee)}}Object(h.a)(zb,"PPTAugmentationManager",null,[853]);var Xb=d(352),Za=d(109);class Va{constructor(xa){Va.assign(Va,this,xa)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static sTa(xa){return xa&&xa.H_?xa.H_.T_:void 0}static SRc(xa){return xa&&xa.H_&&xa.H_.B_?xa.H_.B_:[]}static i_f(xa){const sb=Va.sTa(xa);return sb?[sb,...Va.SRc(xa)]:[]}static v5(xa,sb){if(!Array.isArray(sb)||0===sb.length)return!0;const Jb=Va.sTa(xa);xa=
Va.SRc(xa);for(const uc of sb)if(uc===Jb||0<=xa.indexOf(uc))return!0;return!1}static assign(xa,sb,Jb){if(Jb)for(const uc of Object.keys(Jb))sb[uc]=Jb[uc];sb.H_=xa.H_;return sb}}Va.H_={T_:Va.getTypeName(),B_:Va.getBaseTypes()};class tc{constructor(xa){Va.assign(tc,this,xa)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(xa){return Va.v5(xa,[tc.getTypeName()])}}tc.H_={T_:tc.getTypeName(),B_:tc.getBaseTypes()};class Kb{constructor(xa){Va.assign(Kb,
this,xa)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(xa){return Va.v5(xa,[Kb.getTypeName()])}}Kb.H_={T_:Kb.getTypeName(),B_:Kb.getBaseTypes()};class Pa{constructor(xa){Va.assign(Pa,this,xa)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(xa){return Va.v5(xa,[Pa.getTypeName()])}}Pa.H_={T_:Pa.getTypeName(),B_:Pa.getBaseTypes()};class mb{constructor(xa){Va.assign(mb,this,
xa)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(xa){return Va.v5(xa,[mb.getTypeName()])}}mb.H_={T_:mb.getTypeName(),B_:mb.getBaseTypes()};class qc{constructor(xa){Va.assign(qc,this,xa)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(xa){return Va.v5(xa,[qc.getTypeName()])}}qc.H_={T_:qc.getTypeName(),B_:qc.getBaseTypes()};var oc=d(28);class ib{constructor(xa){this.wH=
xa;xa.body&&(xa=xa.body,this.ID=xa.id,this.Status=xa.status,this.Text=xa.text,this.Lwd=this.Sjj())}Sjj(){return this.wH.parentPath&&0<this.wH.parentPath.length?this.wH.parentPath[this.wH.parentPath.length-1]:""}}Object(h.a)(ib,"ALChatHelperResponse",null,[892]);class $a{constructor(xa,sb){this.qdk=0;this.ASg=new Map;this.kz=sb;const Jb=["session","chats"],uc=(new Xb.a(Za.a.create(),1)).toString(),Gd=[...Jb,uc];this.Wck=[...Gd,"messages"];this.kz.execute(ee=>{ee.submitOperation($a.dXd(Jb,uc,xa.chat));
ee.submitOperation($a.dXd(Gd,"messages",new Pa));ee.tia(xa.responseType);ee.qhh(xa.responseType,this.u_.bind(this))})}u_(xa){xa=new ib(xa);if(xa.Lwd){const sb=this.ASg.get(xa.Lwd);if(sb){sb(xa);this.ASg.delete(xa.Lwd);return}}this.z8j?this.z8j(xa):oc.a.J(509366417,822,15,"No handler found")}send(xa){const sb=`${this.qdk++}`;this.kz.execute(Jb=>{Jb.submitOperation($a.dXd(this.Wck,sb,xa))})}static dXd(xa,sb,Jb){return Object.assign(new ia.a,{parentPath:xa,items:[{id:sb,body:Jb}]})}}Object(h.a)($a,"ALChatHelper",
null,[870]);class Db{constructor(xa){this.u3c=xa}create(xa){return new $a(xa,this.u3c)}}Object(h.a)(Db,"ALChatHelperFactory",null,[854]);class Mb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}Zb(xa){this.K=xa;this.K.register(zb,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().oa(()=>new zb(new u(r.AFrameworkApplication.Ke,xa.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));
this.K.register(vb,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().oa(()=>{const sb=n.a.RYj();e.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",sb);r.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=sb.toString();return new vb(new na(xa.resolve("Common.ISharedDependencyLoader"),xa.Ja("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))});
Object(hc.a)("EnableALChatHelper")&&this.K.register(Db,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").ma().oa(()=>new Db(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&(this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
Object(hc.a)("EnableALChatHelper")&&this.K.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){v.a.instance.Dc(new Mb)}}Object(h.a)(Mb,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var ob=d(1203),jc=d(920),Gb=d(918),Gc=d(550),bc=d(64),dc=d(33);class Nb{constructor(xa){if(!xa)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");this.O0=xa}J7b(xa){this.k3e(xa)}k3e(xa){if(xa){try{const Gd=
xa.parentPath;if(!Gd||4>Gd.length){oc.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const ee=Gd[3];var sb=Gd[2];if(!ee){oc.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var Jb=this.O0.Ubj(ee);this.O0.yYk(ee);const se=xa.predictions;if(!se||!se.length){oc.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const $e=se[0];if(!$e)return;var uc=$e.text;if(!uc||!uc.length){oc.a.J(590181641,820,50,"Text Predictions Null or Empty.");return}}catch(Gd){oc.a.J(590710030,
820,10,"Unable to parse output because of modified output type from Augloop");return}uc&&Nb.FOi(uc,Jb,sb)}else oc.a.J(590181649,820,50,"Annotations returned from service is null.")}static FOi(xa,sb,Jb){xa&&xa.length&&(sb=Nb.Xgj(xa,sb),-1!==sb&&(sb=xa.substring(sb,xa.length),Jb=Object.assign(new Gb.a,{text:xa,U8:sb,Hx:Jb}),Gc.a.QD.R5=Jb,Gc.a.ARd(xa,sb)))}static Xgj(xa,sb){var Jb=bc.a.instance.Na.mb.Ye.node;if(!Jb||!sb)return-1;Jb=dc.ParagraphReader.text(Jb);if(!Jb)return-1;if(Jb!==sb)if(Jb.length>
sb.length&&Jb.substring(0,sb.length)===sb){if(!xa.startsWith(Jb.substring(sb.length,Jb.length-sb.length)))return-1;oc.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===Jb.substring(Jb.length-1,1)?0:Nb.X3f(Jb)}static X3f(xa){return xa?xa.length-1-xa.lastIndexOf(" "):-1}}Object(h.a)(Nb,"TextPredictionAugLoopResponseManager",null,[]);var Ac=d(379);class jb extends Da.a{constructor(){super();this.H_=Object.assign(new Xa.a,{T_:jb.getTypeName(),B_:jb.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(h.a)(jb,"SignalOperation",Da.a,[]);var Vb=d(1050);class Tc{constructor(){this.rMe=!1}}Object(h.a)(Tc,"PredictionSettings",null,[]);class wb{constructor(xa,sb){this.Lad=null;this.nwe={};this.kz=xa;this.Rb=sb;this.Rb.$Gc(Object(y.a)(this,this.$ag,"handleResize"))}Ubj(xa){return this.nwe[xa]}Ccl(xa,sb){this.nwe[xa]=sb}yYk(xa){xa&&delete this.nwe[xa]}get settings(){this.Lad||(this.Lad=Object.assign(new Tc,{rMe:!1}));return this.Lad}set settings(xa){this.Lad=xa}IAl(xa){if(this.settings.rMe&&xa){var sb=
xa.id.toString(),Jb=Gc.a.QD.R5,uc=bc.a.instance.Na.mb;if(uc&&1===uc.length&&uc.Ye){uc=uc.Ye;var Gd=uc.node;if(dc.ParagraphReader.textLength(Gd)===uc.Qa){if(Jb&&Gd&&sb===Jb.Hx&&sb===Gd.id.toString()&&(uc=this.$7d(Jb,Gd))){Jb.U8=uc;Gc.a.ARd(Jb.text,uc);return}Gc.a.QD.R5=null;Jb=Za.a.create().toString();uc=dc.ParagraphReader.text(xa);this.Ccl(Jb,uc);xa=["Signal",Vb.a.getTypeName(),sb,Jb];Jb=wb.Rej(uc);sb=[Object.assign(new Ac.a,{id:sb,body:Jb})];var ee=Object.assign(new jb,{parentPath:xa,items:sb});
this.kz.execute(se=>{se.submitOperation(ee);oc.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}rKb(){Gc.a.QD.R5=null;Gc.a.$Ta()}sxj(xa){!xa||1<xa.length?this.rKb():1>xa.length||((xa=xa[0])&&xa.context?(xa=xa.context,xa.Qa===xa.Lb&&dc.ParagraphReader.textLength(xa.node)===xa.Qa||this.rKb()):this.rKb())}$7d(xa,sb){var Jb=null;if(xa&&sb){sb=dc.ParagraphReader.text(sb);xa=xa.text;if(!sb||!xa)return Jb;sb=sb.replace(RegExp("\\u00a0","g")," ");xa=xa.replace(RegExp("\\u00a0","g"),
" ");if(sb){if(sb.endsWith(xa))return this.rKb(),Jb;Jb=wb.Qfj(sb,xa);Jb=xa.substring(Jb,xa.length)}}return Jb}$ag(){Gc.a.$Ta()}dispose(){this.Rb.Zld(Object(y.a)(this,this.$ag,"handleResize"))}static Rej(xa){return Object.assign(new Vb.a,{languageId:"en-US",startOfSentence:!0,text:xa})}static Qfj(xa,sb){for(let Jb=sb.length;0<Jb;Jb--){const uc=sb.substring(0,Jb);if(xa.endsWith(uc.trimStart()))return uc.length}return 0}}wb.VUa=!1;Object(h.a)(wb,"TextPredictionHandler",null,[835]);var Rb=d(52),vc=d(30);
class rd{constructor(xa,sb){this.ia=xa;this.oc=sb}wb(){this.ia.ya(vc.a.LJk,Rb.a.application,Object(y.a)(this,this.OJk,"predictionHandler"))}OJk(xa,sb,Jb){return r.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===Jb?this.oc.qj()?32:2:8:8}}Object(h.a)(rd,"TextPredictorActor",null,[]);class rc{constructor(){this.dDe=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}Zb(xa){this.K=xa;xa.register(rd,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().oa(()=>new rd(xa.resolve("Common.IActionManagerExtended"),
xa.resolve("PowerPointWebEditor.IPresentationReader")));xa.register(835,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().oa(()=>new wb(xa.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),xa.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").wb();this.dDe=new ob.a(()=>new Nb(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(xa=>
{xa.tia(jc.a.getTypeName());xa.oKa(jc.a.getTypeName(),Object(y.a)(this.dDe.value,this.dDe.value.J7b,"handleResponse"))})}dispose(){}static main(){v.a.instance.Dc(new rc)}}Object(h.a)(rc,"TextPredictionPackage",null,[2,3]);var cb=d(270),Wb=d(29);class Uc{}Object(h.a)(Uc,"AugContextId",null,[]);class Ib{}Object(h.a)(Ib,"AugParagraph",null,[]);class Vc{}Object(h.a)(Vc,"AugShape",null,[]);class gc{}Object(h.a)(gc,"ShapeTextTile",null,[]);class rb{constructor(xa,sb,Jb,uc){this.Ea=Jb;this.Ih=uc;this.Pb=
xa;this.Ml=sb}Q1b(xa,sb){return xa&&xa.isConnected&&this.Ea.MFa(xa)?(xa=Object(K.a)(4,xa))?Object.assign(new gc,{Topic:"ShapeText",ContextId:A.c(rb.$zi(xa,sb)),Data:A.c(this.aAi(xa))}):null:null}q1b(xa){return xa&&xa.get_shapeId()&&xa.hasText&&!xa.aq?xa.Fje:!1}aAi(xa){const sb=[];xa=this.Pb.Mc(xa);for(xa=this.Ml.h3(xa,xa.currentNode);xa.moveNext();){var Jb=xa.currentNode;const uc=Jb;this.Ih.ae(uc)&&(Jb=Object.assign(new Ib,{t:this.Ih.text(uc),l:this.Ih.thb(Jb)}),Array.add(sb,Jb))}return Object.assign(new Vc,
{p:sb,c:cb.a.xe(r.AFrameworkApplication.lcid).dwb})}static $zi(xa,sb){return Object.assign(new Uc,{gid:xa.id,sid:xa.slideSid,cid:xa.slideCid,shapeId:xa.get_shapeId(),rid:(xa.M1c||xa.TFa||Wb.App.Ym).toString(),t:sb,c:(new Date).getTime()})}}Object(h.a)(rb,"ShapeTextTileManager",null,[831,860]);var Zb=d(105),Hc=d(1225),Ab=d(195),ad=d(82),Bd;(function(xa){xa[xa.none=0]="none";xa[xa.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";xa[xa.onSelectionFinished=2]="onSelectionFinished";xa[xa.onActiveSlideDomReady=
4]="onActiveSlideDomReady";xa[xa.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";xa[xa.onParagraphDisconnect=16]="onParagraphDisconnect";xa[xa.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";xa[xa.onNumberListDisconnect=64]="onNumberListDisconnect";xa[xa.onSlideConnected=128]="onSlideConnected";xa[xa.onSlideDisconnected=256]="onSlideDisconnected"})(Bd||(Bd={}));Object(h.b)("EventNames",Bd);class kd{constructor(){this.o1a=this.graphNode=null;this.tVa=0;this.v2e=null}}Object(h.a)(kd,
"TileGraphNode",null,[]);class Be{constructor(){this.Loh=this.tUe=this.ube=this.s$f=0}}Object(h.a)(Be,"TileTelemetry",null,[]);var Qd;(function(xa){xa[xa.unknown=0]="unknown";xa[xa.activeSlideChanged=1]="activeSlideChanged";xa[xa.shapeSelected=2]="shapeSelected";xa[xa.listLevelChanged=3]="listLevelChanged";xa[xa.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";xa[xa.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";xa[xa.paragraphDeleted=6]="paragraphDeleted";xa[xa.numberListDeleted=
7]="numberListDeleted";xa[xa.numberListPropertyChanged=8]="numberListPropertyChanged";xa[xa.slideAdded=9]="slideAdded";xa[xa.slideDeleted=10]="slideDeleted"})(Qd||(Qd={}));Object(h.b)("TriggerName",Qd);var ae=d(432);class We{constructor(xa,sb,Jb,uc){this.zb=sb;this.O9j=Jb;this.ojk=xa;this.fDe={};this.gdc={};this.Rb=uc}initialize(){this.Wu()}dispose(){this.ppa()}onParagraphPropertyChanged(xa,sb){this.ata(sb,1)}AHb(xa,sb){this.ata(sb,2)}onActiveSlideDomReady(xa,sb){this.ata(sb,4)}onShapeChildTopologyChanged(xa,
sb){this.ata(sb,8)}lJa(xa,sb){this.ata(sb,16)}$7g(xa,sb){xa=new ae.a(!1,null,sb.Ba);this.ata(xa,4)}get My(){return this.ojk}get g_(){return this.fDe}get Fja(){return this.gdc}ata(xa,sb){try{if(2===this.Rb.mode&&Object(Hc.a)(Bd,sb)in this.fDe){var Jb=Date.now();Object(K.a)(872,this.fDe[Object(Hc.a)(Bd,sb)]).M3(xa,(uc,Gd)=>{this.Ptk(uc,Gd,Jb)})}}catch(uc){oc.a.J(36495880,306,10,"Exception thrown at DetectTiles: "+uc)}}Ptk(xa,sb,Jb){if(!Ab.a.Wa(xa))try{for(const uc of xa){if(!Zb.a.count(this.gdc)){const se=
new ad.a(3,1,this.O9j,Object(y.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.zb.Db(se)}let Gd;if(uc.id.toString()in this.gdc)Gd=Object(K.a)(kd,this.gdc[uc.id.toString()]),Gd.tVa=sb;else{const se=new Be;Gd=Object.assign(new kd,{graphNode:uc,tVa:sb,o1a:{},v2e:se});this.gdc[uc.id.toString()]=Gd;this.Prk(se,Jb)}const ee=Qd[sb];Gd.o1a[ee]=(ee in Gd.o1a?Gd.o1a[ee]:0)+1}}catch(uc){oc.a.J(36495882,306,10,"Exception thrown at FireTiles: "+uc)}}Prk(xa,sb){xa&&(xa.s$f=sb,xa.ube=Date.now())}r2g(xa,
sb){xa&&(xa.tUe=sb,xa.Loh=Date.now())}KZf(xa){return xa?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",xa.ube-xa.s$f,xa.tUe-xa.ube,xa.Loh-xa.tUe):""}}Object(h.a)(We,"TileTriggerControllerBase",null,[878,106]);class $d extends We{constructor(xa,sb,Jb,uc,Gd,ee,se,$e,gg,Th,Uh,Qj,Xd){super(se&31,$e,Th,Qj);this.kU=xa.xd(12);this.kM=xa.xd(10);this.pa=sb;this.ld=Jb;this.TT=uc;this.u$=Gd;this.sU=ee;this.ua=gg;this.yU=Uh;this.Pjk=Xd}Wu(){1===(this.My&1)&&(this.kU.kk(Object(y.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.g_[Object(Hc.a)(Bd,1)]=this.yU.RHi());2===(this.My&2)&&(this.pa.KG(Object(y.a)(this,this.AHb,"onProcessSetSelectionFinished")),this.g_[Object(Hc.a)(Bd,2)]=this.yU.SHi());4===(this.My&4)&&(this.ld.eW(Object(y.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.g_[Object(Hc.a)(Bd,4)]=this.yU.PHi());8===(this.My&8)&&(this.kM.wF(Object(y.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.g_[Object(Hc.a)(Bd,
8)]=this.yU.THi());16===(this.My&16)&&(this.kU.TBa(Object(y.a)(this,this.lJa,"onBeforeParagraphDisconnect")),this.g_[Object(Hc.a)(Bd,16)]=this.yU.QHi())}ppa(){this.kU.Rm(Object(y.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.pa.yKa(Object(y.a)(this,this.AHb,"onProcessSetSelectionFinished"));this.ld.Yxa(Object(y.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.kM.bP(Object(y.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.kU.vKa(Object(y.a)(this,
this.lJa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ua&&this.ua.Ba){var xa=this.ua.Ba.gk();for(const sb of xa){const Jb=sb.id.toString();Jb in this.Fja&&(this.y4b(Object(K.a)(kd,this.Fja[Jb])),delete this.Fja[Jb])}Zb.a.forEach(this.Fja,sb=>{delete this.Fja[sb]},null)}}catch(sb){oc.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+sb)}}y4b(xa){if(xa){var sb=Date.now(),Jb=this.sU.Q1b(xa.graphNode,Qd[xa.tVa]);if(Jb){this.Pjk?this.u$.execute(Gd=>{Gd.submit("ShapeTextTile",Jb)}):
this.TT.execute(Gd=>{Gd.$Ue(Jb.Topic,Jb.Data,Jb.ContextId)});const uc=xa.v2e;this.r2g(uc,sb);oc.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",Qd[xa.tVa],xa.o1a,this.KZf(uc))}}}}Object(h.a)($d,"ShapeTextTileTriggerController",We,[]);var Re=d(24),Ta=d(76),xb=d(40),kc=d(92),Nc=d(84),id=d(161),Ed=d(39);class Ja{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(h.a)(Ja,"TextSpan",null,[]);class db{}Object(h.a)(db,"AugCharFormat",null,[]);class zc{}Object(h.a)(zc,
"AugCharFormatRun",null,[]);class Hd{}Object(h.a)(Hd,"AugDrawingElement",null,[]);class Ad{}Object(h.a)(Ad,"AugDrawingElementMoniker",null,[]);class Kd{}Object(h.a)(Kd,"AugPara",null,[]);class Pc{}Object(h.a)(Pc,"AugParaFormat",null,[]);class tf{}Object(h.a)(tf,"AugParaFormatRun",null,[]);class xe{}Object(h.a)(xe,"AugSlide",null,[]);class ef{}Object(h.a)(ef,"AugSlideMoniker",null,[]);class Id{}Object(h.a)(Id,"AugText",null,[]);class qe{}Object(h.a)(qe,"AugTextTile",null,[]);class jg{constructor(xa,
sb,Jb,uc,Gd,ee,se,$e,gg,Th,Uh,Qj){this.Ih=xa;this.Yl=sb;this.SAe=Jb;this.Pb=uc;this.cY=Gd;this.yc=ee;this.Ml=se;this.yXa=Uh;this.K8c=$e;this.Pgc=gg;this.nA=Th;this.c$c=Qj}Q1b(xa){if(!xa||!xa.isConnected)return null;var sb=Object(K.a)(116,xa);if(!sb)return null;let Jb=xa=0;sb=({xhd:xa,LNc:Jb}=this.kIi(sb)).returnValue;if(!sb)return null;sb=Object.assign(new qe,{Id:Za.a.create().toString(),Content:A.c(sb)});oc.a.J(37091038,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",sb.Id,xa,Jb);return sb}kIi(xa){let sb=
0,Jb=0;const uc=[];var Gd=xa?xa.gk():[];for(ee of Gd)if(!this.Yl.yFa(ee)||this.yXa)if(ee.ud){if(Gd=this.yc.NN(ee))Gd=this.Pb.Mc(Gd),this.cY.XQc(Gd,se=>{(se=Object(K.a)(125,se.currentNode))&&!se.isGhostCell&&({xhd:sb,LNc:Jb}=this.BZf(se,sb,Jb,uc));return!0})}else({xhd:sb,LNc:Jb}=this.BZf(ee,sb,Jb,uc));var ee=sb;Gd=Jb;return{returnValue:Object.assign(new xe,{id:xa.id.toString(),mk:Object.assign(new ef,{sId:xa.sid,cId:xa.cid}),drawingElems:uc,isSlideCritiqueReady:xa.isSlideCritiqueReady}),xhd:ee,LNc:Gd}}BZf(xa,
sb,Jb,uc){const Gd=[];let ee=0;var se=this.Pb.Mc(xa);for(se=this.Ml.h3(se,se.currentNode);se.moveNext();){var $e=se.currentNode;$e&&this.Ih.ae($e)&&$e.Sa(xb.a.pq)&&($e=this.w2i($e))&&($e.pfRuns&&0<$e.pfRuns.length&&$e.pfRuns[0].pf.proofingDirty&&ee++,Array.add(Gd,$e))}0<Gd.length&&(sb+=Gd.length,Jb+=ee,xa=Object.assign(new Hd,{id:xa.id.toString(),mk:this.u2i(xa),text:Object.assign(new Id,{paragraphs:Gd})}),Array.add(uc,xa));return{xhd:sb,LNc:Jb}}u2i(xa){if(!xa)return null;var sb="";let Jb=0,uc=0;
if(Object(Re.a)(125,xa))sb=Object(K.a)(125,xa),uc=3,sb=sb.cellId.toString();else if(Object(Re.a)(4,xa))if(xa=Object(K.a)(4,xa),sb=xa.get_shapeId().toString(),Jb=xa.get_cid(),xa.m4)uc=1;else if(xa.Qf)uc=2;else if(xa.ux||xa.fl)uc=4;return Object.assign(new Ad,{id:sb,cId:Jb,type:uc})}w2i(xa){if(!xa)return null;xa=Object(K.a)(Ta.AParagraphNode,xa);if(!xa)return null;var sb=xa.sa(Ed.a.GT,!1);sb=Object.assign(new Kd,{id:xa.id.toString(),chars:sb?"":this.Ih.text(xa)});const Jb=this.v2i(xa);Jb&&0<Jb.length&&
(sb.pfRuns=Jb);(xa=this.t2i(xa))&&0<xa.length&&(sb.cfRuns=xa);return sb}v2i(xa){const sb=[],Jb=Object(K.a)(Nc.a,this.Pgc.ITc(xa));let uc=16,Gd="",ee=0,se=0;if(Jb&&this.c$c){const $e=this.nA.Y9a(Jb);if($e)if(uc=$e.listType,1===uc)Gd=this.K8c.fBb(Jb);else if(0===uc){ee=Jb.sa(Ed.a.autonumberBulletType,8);const gg=Object(K.a)(861,this.K8c);gg&&(se=gg.Zcj($e,Jb))}}xa=Object.assign(new tf,{pf:Object.assign(new Pc,{lvl:this.Ih.thb(xa),proofingDirty:!xa.sa(id.a.Uda,!1),revisionId:xa.sa(id.a.S1c,0).toString(),
listType:uc,listTag:Gd,listNumeration:ee,listElementIndex:se})});Array.add(sb,xa);return sb}t2i(xa){const sb=[];let Jb=this.Ccj(xa);if(0<Jb.count){Jb=this.cki(this.SAe.MSc(xa),Jb);for(let uc of Jb)xa=uc.end-uc.start,Array.add(sb,Object.assign(new zc,{len:xa,cf:Object.assign(new db,{lang:uc.lcid,noProof:uc.noProof})}))}return sb}Ccj(xa){const sb=new B.a,Jb=xa.characterData;let uc=-1,Gd=-1,ee=0;for(let se=0;se<xa.Ra.length;se++){const $e=xa.Ra.ga(se).formatting;$e&&(Gd=kc.a.language($e),-1!==uc&&uc!==
Gd&&(sb.add(Object.assign(new Ja,{start:ee,end:xa.Ra.ga(se).cp,lcid:uc,noProof:!1})),ee=xa.Ra.ga(se).cp),uc=Gd)}sb.add(Object.assign(new Ja,{start:ee,end:Jb.length,lcid:Gd,noProof:!1}));return sb}cki(xa,sb){if(!xa)return sb;for(const Jb of xa){xa=!1;for(let uc=0;uc<sb.count;uc++){if(!xa)if(sb.ga(uc).start===Jb.begin)xa=!0,sb.ga(uc).noProof=!0;else if(Jb.begin>sb.ga(uc).start&&Jb.begin<sb.ga(uc).end){sb.insert(uc+1,Object.assign(new Ja,{start:Jb.begin,end:sb.ga(uc).end,lcid:sb.ga(uc).lcid,noProof:!0}));
xa=!0;sb.ga(uc).end=Jb.begin;continue}if(xa)if(Jb.end>sb.ga(uc).end)sb.ga(uc).noProof=!0;else{if(Jb.end===sb.ga(uc).end){sb.ga(uc).noProof=!0;break}if(Jb.end<sb.ga(uc).end){sb.insert(uc+1,Object.assign(new Ja,{start:Jb.end,end:sb.ga(uc).end,lcid:sb.ga(uc).lcid,noProof:!1}));sb.ga(uc).end=Jb.end;sb.ga(uc).noProof=!0;break}}}}return sb}}Object(h.a)(jg,"SlideTextTileManager",null,[832,860]);var of=d(440);class Cb extends We{constructor(xa,sb,Jb,uc,Gd,ee,se,$e,gg,Th,Uh){super(sb&125,Jb,uc,Uh);this.ld=
xa;this.yU=Gd;this.Thk=ee;this.kU=se.xd(12);this.kM=se.xd(10);this.u$=$e;this.ua=gg;this.HWg=Th;this.q9c=se.xd(22)}Wu(){4===(this.My&4)&&(this.ld.eW(Object(y.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.HWg.uci(Object(y.a)(this,this.$7g,"onTilingModuleLoaded")),this.g_[Object(Hc.a)(Bd,4)]=this.yU.eIi());16===(this.My&16)&&(this.kU.TBa(Object(y.a)(this,this.lJa,"onBeforeParagraphDisconnect")),this.g_[Object(Hc.a)(Bd,16)]=this.yU.hIi());1===(this.My&1)&&(this.kU.kk(Object(y.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.g_[Object(Hc.a)(Bd,1)]=this.yU.iIi());8===(this.My&8)&&(this.kM.wF(Object(y.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.g_[Object(Hc.a)(Bd,8)]=this.yU.jIi());64===(this.My&64)&&(this.q9c.TBa(Object(y.a)(this,this.O2g,"onBeforeNumberListDicsonnect")),this.g_[Object(Hc.a)(Bd,64)]=this.yU.fIi());32===(this.My&32)&&(this.q9c.kk(Object(y.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),
this.g_[Object(Hc.a)(Bd,32)]=this.yU.gIi())}ppa(){this.ld.Yxa(Object(y.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.kU.Rm(Object(y.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.kU.vKa(Object(y.a)(this,this.lJa,"onBeforeParagraphDisconnect"));this.HWg.G0k(Object(y.a)(this,this.$7g,"onTilingModuleLoaded"));this.q9c.vKa(Object(y.a)(this,this.O2g,"onBeforeNumberListDicsonnect"));this.q9c.Rm(Object(y.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}O2g(xa,
sb){this.ata(sb,64)}onNumberListPropertyChanged(xa,sb){this.ata(sb,32)}fireTileEvents(){try{Zb.a.forEach(this.Fja,xa=>{this.y4b(Object(K.a)(kd,this.Fja[xa]));delete this.Fja[xa]},null)}catch(xa){oc.a.J(36525513,306,10,"Exception thrown at FireTileEvents: "+xa)}}y4b(xa){if(xa&&this.ua.Ba&&xa.graphNode&&this.ua.Ba.id===xa.graphNode.id){var sb=Date.now(),Jb=this.Thk.Q1b(xa.graphNode,Qd[xa.tVa]);if(Jb){this.u$.execute(Gd=>{Gd.submit(of.a.csc,Jb)});const uc=xa.v2e;this.r2g(uc,sb);oc.a.J(36525515,306,50,
"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",Qd[xa.tVa],xa.o1a,A.c(Jb).length,Jb.Id,this.KZf(uc))}}}}Object(h.a)(Cb,"SlideTextTileTriggerController",We,[]);class Df{constructor(xa){Va.assign(Df,this,xa)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(xa){return Va.v5(xa,[Df.getTypeName()])}}Df.H_={T_:Df.getTypeName(),B_:Df.getBaseTypes()};class Bf{constructor(xa){Va.assign(Bf,this,xa)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(xa){return Va.v5(xa,
[Bf.getTypeName()])}}Bf.H_={T_:Bf.getTypeName(),B_:Bf.getBaseTypes()};class qg{constructor(xa){Va.assign(qg,this,xa)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(xa){return Va.v5(xa,[qg.getTypeName()])}}qg.H_={T_:qg.getTypeName(),B_:qg.getBaseTypes()};class vd{constructor(xa){Va.assign(vd,this,xa)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile",
"AugLoop_Text_TextTile"]}static typeGuard(xa){return Va.v5(xa,[vd.getTypeName()])}}vd.H_={T_:vd.getTypeName(),B_:vd.getBaseTypes()};class $f{constructor(xa){Va.assign($f,this,xa)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(xa){return Va.v5(xa,[$f.getTypeName()])}}$f.H_={T_:$f.getTypeName(),B_:$f.getBaseTypes()};class ng{constructor(xa){Va.assign(ng,this,xa)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(xa){return Va.v5(xa,
[ng.getTypeName()])}}ng.H_={T_:ng.getTypeName(),B_:ng.getBaseTypes()};class Qe{constructor(xa){Va.assign(Qe,this,xa)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static getBaseTypes(){return[]}static typeGuard(xa){return Va.v5(xa,[Qe.getTypeName()])}}Qe.H_={T_:Qe.getTypeName(),B_:Qe.getBaseTypes()};class Gf{constructor(xa){Va.assign(Gf,this,xa)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static getBaseTypes(){return[]}static typeGuard(xa){return Va.v5(xa,[Gf.getTypeName()])}}
Gf.H_={T_:Gf.getTypeName(),B_:Gf.getBaseTypes()};var Jf;(function(xa){xa[xa.Title=0]="Title";xa[xa.Subtitle=1]="Subtitle";xa[xa.Content=2]="Content";xa[xa.Note=3]="Note";xa[xa.SmartArt=4]="SmartArt";xa[xa.Image=5]="Image";xa[xa.TextBox=6]="TextBox";xa[xa.Table=7]="Table";xa[xa.Chart=8]="Chart";xa[xa.Other=9]="Other"})(Jf||(Jf={}));class xh{constructor(xa,sb,Jb,uc,Gd,ee){this.Pb=xa;this.Ml=sb;this.Ih=uc;this.Ha=Jb;this.ejk=Gd;this.oc=ee}Q1b(xa){if(!xa||!xa.isConnected)return null;xa=Object(K.a)(116,
xa);if(!xa)return null;var sb=null;const Jb=new B.a;var uc=xa.gk();for(var Gd of uc)(uc=this.LZf(Gd,!1))&&Jb.add(uc);(Gd=xa.aTa())&&Gd.isConnected&&(Gd=this.LZf(Gd,!0))&&Jb.add(Gd);if(0<Jb.count){let ee,se;if(this.Ha.z3b){sb=xa.jn;Gd=this.oTa(xa);try{ee=xa.cid.toString(),se=xa.sid.toString()}catch($e){oc.a.J(509203980,822,50,"Exception message: "+$e.message)}sb=new Gf({shapes:Jb.toArray(),isSlideHidden:sb,themeId:Gd,cid:ee,sid:se})}}return sb}LZf(xa,sb){if(!xa)return null;var Jb=this.Pb.Mc(xa),uc=
this.Ml.h3(Jb,Jb.currentNode);Jb=null;const Gd=new B.a;for(;uc.moveNext();){var ee=uc.currentNode;if(ee&&this.Ih.ae(ee)){ee=Object(K.a)(Ta.AParagraphNode,ee);const $e=this.Ih.text(ee);let gg={};this.Ha.z3b&&(gg=this.ejk.jHk(ee));$e&&(ee=new Bf({content:$e,listType:gg.listType,indentation:gg.indentation,outlineLevel:gg.outlineLevel}),Gd.add(ee))}}let se;this.Ha.z3b&&(se=this.SXi(xa,sb));uc=null;this.Ha.HJj&&(uc=sb?"notesNode":xa.get_shapeId().toString());0<Gd.count&&(Jb=new Qe({textTiles:Gd.toArray(),
shapeType:se,shapeId:uc}));return Jb}SXi(xa,sb){if(sb)return Jf.Note;if(!xa)return Jf.Other;switch(xa.Jj){case 0:case 2:return Jf.Title;case 3:return Jf.Subtitle;case 10:return Jf.Table;case 15:return Jf.Image;case 9:case 12:return Jf.Chart;case 8:return this.Dkj(xa)}return Jf.Other}Dkj(xa){return xa?0<xa.W$d().length?Jf.SmartArt:xa.Tda?Jf.Other:xa.ux?Jf.TextBox:Jf.Content:Jf.Other}oTa(xa){if(!xa)return"";xa=xa.ij;let sb=null;const Jb=this.oc.HI();if(Jb&&0<Jb.length&&xa)for(const uc of Jb)if(uc.Id===
xa){sb=uc;break}return sb&&sb.ThemeFamilyId?sb.ThemeFamilyId:""}}Object(h.a)(xh,"SlideTileManager",null,[860]);class he extends We{constructor(xa,sb,Jb,uc,Gd,ee,se,$e){super(sb&401,Jb,uc,$e);this.fbd=xa.xd(8);this.kU=xa.xd(12);this.yU=Gd;this.Uhk=ee;this.u$=se}Wu(){16===(this.My&16)&&(this.kU.TBa(Object(y.a)(this,this.lJa,"onBeforeParagraphDisconnect")),this.g_[Object(Hc.a)(Bd,16)]=this.yU.cIi());1===(this.My&1)&&(this.kU.kk(Object(y.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),
this.g_[Object(Hc.a)(Bd,1)]=this.yU.dIi());128===(this.My&128)&&(this.fbd.Eia(Object(y.a)(this,this.onSlideConnected,"onSlideConnected")),this.g_[Object(Hc.a)(Bd,128)]=this.yU.aIi());256===(this.My&256)&&(this.fbd.R7(Object(y.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.g_[Object(Hc.a)(Bd,256)]=this.yU.bIi())}ppa(){this.kU.Rm(Object(y.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.kU.vKa(Object(y.a)(this,this.lJa,"onBeforeParagraphDisconnect"));this.fbd.qoa(Object(y.a)(this,
this.onSlideConnected,"onSlideConnected"));this.fbd.wKa(Object(y.a)(this,this.onSlideDisconnected,"onSlideDisconnected"))}onSlideConnected(xa,sb){this.ata(sb,128)}onSlideDisconnected(xa,sb){this.ata(sb,256)}fireTileEvents(){try{Zb.a.forEach(this.Fja,xa=>{this.y4b(Object(K.a)(kd,this.Fja[xa]));delete this.Fja[xa]},null)}catch(xa){oc.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+xa)}}y4b(xa){if(xa&&xa.graphNode){var sb=this.Uhk.Q1b(xa.graphNode,Qd[xa.tVa]),Jb=null,uc=Object(K.a)(116,xa.graphNode);
if(uc&&!uc.XN&&!uc.xAb){var Gd=hc.a("AL.SlideTileIdOriginalFormat")?uc.sid.toString()+uc.cid.toString():uc.sid.toString()+"#"+uc.cid.toString();uc=["session","doc"];sb=[Object.assign(new Ac.a,{id:Gd,body:sb})];10===xa.tVa?"slideAdded"in xa.o1a||(Jb=Object.assign(new Ka,{parentPath:uc,items:sb})):Jb="slideAdded"in xa.o1a?Object.assign(new ia.a,{parentPath:uc,items:sb}):Object.assign(new Ma.a,{parentPath:uc,items:sb});Jb&&this.u$.execute(ee=>{ee.submitOperation(Jb)})}}}}Object(h.a)(he,"SlideTileTriggerController",
We,[]);var de=d(1212),xf=d(32),re;(function(xa){xa[xa.Unspecified=0]="Unspecified";xa[xa.Inline=1]="Inline";xa[xa.Floating=2]="Floating"})(re||(re={}));var Ih;(function(xa){xa[xa.Undefined=0]="Undefined";xa[xa.Bullet=1]="Bullet";xa[xa.Numbered=2]="Numbered";xa[xa.Lim=3]="Lim";xa[xa.Nil=4]="Nil";xa[xa.Any=5]="Any";xa[xa.NoList=6]="NoList";xa[xa.Invalid=7]="Invalid"})(Ih||(Ih={}));var Le;(function(xa){xa[xa.DontCare=1]="DontCare";xa[xa.Thin=2]="Thin";xa[xa.ExtraLight=3]="ExtraLight";xa[xa.Light=4]=
"Light";xa[xa.Normal=5]="Normal";xa[xa.Medium=6]="Medium";xa[xa.SemiBold=7]="SemiBold";xa[xa.Bold=8]="Bold";xa[xa.ExtraBold=9]="ExtraBold";xa[xa.Heavy=10]="Heavy"})(Le||(Le={}));var Cd;(function(xa){xa[xa.NoCaps=0]="NoCaps";xa[xa.SmallCaps=1]="SmallCaps";xa[xa.AllCaps=2]="AllCaps";xa[xa.AllPetiteCaps=3]="AllPetiteCaps";xa[xa.PetiteCaps=4]="PetiteCaps";xa[xa.Unicase=5]="Unicase";xa[xa.Titling=6]="Titling";xa[xa.Other=7]="Other"})(Cd||(Cd={}));var Lc;(function(xa){xa[xa.None=0]="None";xa[xa.Words=1]=
"Words";xa[xa.SingleLine=2]="SingleLine";xa[xa.DoubleLine=3]="DoubleLine";xa[xa.HeavyLine=4]="HeavyLine";xa[xa.DottedLine=5]="DottedLine";xa[xa.DottedHeavyLine=6]="DottedHeavyLine";xa[xa.DashLine=7]="DashLine";xa[xa.DashHeavyLine=8]="DashHeavyLine";xa[xa.DashLongLine=9]="DashLongLine";xa[xa.DashLongHeavyLine=10]="DashLongHeavyLine";xa[xa.DotDashLine=11]="DotDashLine";xa[xa.DotDashHeavyLine=12]="DotDashHeavyLine";xa[xa.DotDotDashLine=13]="DotDotDashLine";xa[xa.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";
xa[xa.WavyLine=15]="WavyLine";xa[xa.WavyHeavyLine=16]="WavyHeavyLine";xa[xa.WavyDoubleLine=17]="WavyDoubleLine"})(Lc||(Lc={}));var Td;(function(xa){xa[xa.Left=0]="Left";xa[xa.Right=1]="Right";xa[xa.Center=2]="Center";xa[xa.Justified=3]="Justified";xa[xa.Other=4]="Other";xa[xa.None=5]="None";xa[xa.JustifyLow=6]="JustifyLow";xa[xa.Distributed=7]="Distributed";xa[xa.ThaiDistributed=8]="ThaiDistributed"})(Td||(Td={}));var Ge;(function(xa){xa[xa.Image=0]="Image";xa[xa.TextBox=1]="TextBox";xa[xa.Chart=
2]="Chart";xa[xa.SmartArt=3]="SmartArt";xa[xa.Drawing=4]="Drawing";xa[xa.EquationObject=5]="EquationObject";xa[xa.Ink=6]="Ink";xa[xa.InkSpace=7]="InkSpace";xa[xa.InkEndOfLine=8]="InkEndOfLine";xa[xa.LineBreak=9]="LineBreak";xa[xa.PageBreak=10]="PageBreak";xa[xa.PageNumbers=11]="PageNumbers";xa[xa.FootnoteEndnote=12]="FootnoteEndnote";xa[xa.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";xa[xa.Tab=14]="Tab";xa[xa.UnsupportedObject=15]="UnsupportedObject";xa[xa.Other=16]="Other"})(Ge||
(Ge={}));var Xc;(function(xa){xa[xa.Initial=0]="Initial";xa[xa.FirstLine=1]="FirstLine";xa[xa.Hanging=2]="Hanging"})(Xc||(Xc={}));class jf{constructor(xa,sb){this.nA=xa;this.p$=sb}jHk(xa){const sb={};try{sb.listType=this.gxb(xa),sb.outlineLevel=dc.ParagraphReader.bUc(xa),sb.indentation=jf.Ncj(this.p$.N8(xa))}catch(Jb){oc.a.J(509203979,822,50,"Exception message: "+Jb.message)}return sb}gxb(xa){const sb=new xf.GraphIterator;sb.set(xa);sb.rc(11);sb.Jg(11);return(xa=this.nA.lw(sb))?jf.PBi(xa.listType):
Ih.NoList}static PBi(xa){switch(xa){case 15:return Ih.Any;case 1:return Ih.Bullet;case 42:return Ih.Invalid;case 13:return Ih.Lim;case 14:return Ih.Nil;case 16:return Ih.NoList;case 0:return Ih.Numbered;default:return Ih.Invalid}}static Ncj(xa){return 2===xa.unit?Math.floor(de.a.VEf(xa.value)/20):Math.floor(xa.value/20)}}Object(h.a)(jf,"TextTileFormatter",null,[833]);var Mh=d(78);class bd{constructor(){this.w2e="TML";this.va=new Mh.a}uci(xa){this.va.addHandler(this.w2e,xa)}G0k(xa){this.va.removeHandler(this.w2e,
xa)}pRk(xa){this.va.raiseEvent(this.w2e,xa)}}Object(h.a)(bd,"TilingEventSource",null,[855,856,857]);class Bc{}Bc.Ehl="ShapeTextOnActiveSlideDomReady";Bc.Hhl="ShapeTextOnSelectionFinished";Bc.Ghl="ShapeTextOnParagraphPropertyChanged";Bc.Ihl="ShapeTextOnShapeChildTopologyChanged";Bc.Fhl="ShapeTextOnParagraphDisconnect";Bc.Apl="SlideTextOnActiveSlideDomReady";Bc.Epl="SlideTextOnParagraphPropertyChanged";Bc.Dpl="SlideTextOnParagraphDisconnect";Bc.Fpl="SlideTextOnShapeChildTopologyChanged";Bc.Cpl="SlideTextOnNumberListPropertyChanged";
Bc.Bpl="SlideTextOnNumberListDisconnect";Bc.xpl="SlideOnParagraphPropertyChanged";Bc.wpl="SlideOnParagraphDisconnect";Bc.upl="SlideOnConnect";Bc.vpl="SlideOnDisconnect";Object(h.a)(Bc,"DetectStrategyName",null,[]);class Hf{constructor(xa){this.sU=xa}get My(){return 4}M3(xa,sb){const Jb=[];if((xa=Object(K.a)(ae.a,xa))&&xa.Ba&&(xa=Object(K.a)(116,xa.Ba))){xa=xa.gk();for(const uc of xa)this.sU.q1b(uc)&&Array.add(Jb,uc);0<Jb.length&&sb(Jb,1)}}}Object(h.a)(Hf,"ShapeTextOnActiveSlideDomReadyDetectStrategy",
null,[872]);var Me=d(254);class Tf{constructor(xa,sb,Jb){this.Ea=xa;this.sU=sb;this.pa=Jb}get My(){return 16}M3(xa,sb){if((xa=Object(K.a)(Me.a,xa))&&xa.node&&12===xa.node.type&&(xa=this.Ea.en(xa.node))&&this.sU.q1b(xa)){var Jb=this.pa.q_();Jb&&Jb.id===xa.id&&(Jb=[],Array.add(Jb,xa),sb(Jb,6))}}}Object(h.a)(Tf,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[872]);var Sd=d(42),lf=d(358);class fb{constructor(xa,sb,Jb){this.Ea=xa;this.sU=sb;this.pa=Jb}get My(){return 1}M3(xa,sb){if((xa=Object(K.a)(lf.a,
xa))&&xa.node&&12===xa.node.type){const uc=this.Ea.en(xa.node);if(uc&&this.sU.q1b(uc)){var Jb=this.pa.q_();Jb&&Jb.id===uc.id&&(xa.property===Sd.a.listLevel?this.Oub(3,uc,sb):xa.property===xb.a.pq&&this.Oub(4,uc,sb))}}}Oub(xa,sb,Jb){if(sb){var uc=[];Array.add(uc,sb);Jb(uc,xa)}}}Object(h.a)(fb,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[872]);var Qb=d(849);class ac{constructor(xa,sb,Jb,uc){this.pa=xa;this.sU=sb;this.O0=Jb;this.kic=uc}get My(){return 2}M3(xa,sb){const Jb=[];if(xa=Object(K.a)(Qb.a,
xa))if(this.kic&&this.O0&&this.O0.sxj(xa.kG),!this.pa.b4())this.kic&&this.O0&&this.O0.rKb();else if(xa.EE&&xa.EE.length){this.kic&&this.O0&&this.O0.rKb();xa=this.pa.Xd();for(const uc of xa)this.sU.q1b(uc)&&Array.add(Jb,uc);0<Jb.length&&sb(Jb,2)}}}Object(h.a)(ac,"ShapeTextOnSelectionFinishedDetectStrategy",null,[872]);var Jc=d(589);class pd{constructor(xa,sb){this.pa=xa;this.sU=sb}get My(){return 8}M3(xa,sb){const Jb=[];if((xa=Object(K.a)(Jc.a,xa))&&xa.node&&10===xa.node.type&&1===xa.VZ&&(xa=Object(K.a)(4,
xa.node))&&this.sU.q1b(xa)){var uc=this.pa.q_();uc&&uc.get_shapeId()===xa.get_shapeId()&&(Array.add(Jb,xa),sb(Jb,5))}}}Object(h.a)(pd,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[872]);class qd{constructor(xa){this.zsg=xa}get My(){return 1===this.zsg?128:256}M3(xa,sb){if((xa=Object(K.a)(Me.a,xa))&&xa.node&&8===xa.node.type){const Jb=[];Array.add(Jb,xa.node);1===this.zsg?sb(Jb,9):sb(Jb,10)}}}Object(h.a)(qd,"SlideOnConnectOrDisconnectDetectStrategy",null,[872]);class sd{constructor(xa){this.ic=
xa}get My(){return 16}M3(xa,sb){if((xa=Object(K.a)(Me.a,xa))&&xa.node&&12===xa.node.type){const Jb=this.ic.jg(xa.node);Jb&&(xa=[],Array.add(xa,Jb),sb(xa,6))}}}Object(h.a)(sd,"SlideOnParagraphDisconnectDetectStrategy",null,[872]);class ze{constructor(xa){this.ic=xa}get My(){return 1}M3(xa,sb){var Jb=Object(K.a)(lf.a,xa);if(Jb&&Jb.node&&12===Jb.node.type){const uc=this.ic.jg(Jb.node);uc&&Object(K.a)(Ta.AParagraphNode,Jb.node)&&(xa=0,Jb.property===Sd.a.listLevel?xa=3:Jb.property===xb.a.pq&&(xa=4),Jb=
[],Array.add(Jb,uc),sb(Jb,xa))}}}Object(h.a)(ze,"SlideOnParagraphPropertyChangedDetectStrategy",null,[872]);class Wd{get My(){return 4}M3(xa,sb){if((xa=Object(K.a)(ae.a,xa))&&xa.Ba&&(xa=Object(K.a)(116,xa.Ba))){var Jb=xa.gk();for(var uc of Jb)if(uc.hasText){uc=[];Array.add(uc,xa);sb(uc,1);break}}}}Object(h.a)(Wd,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[872]);class ye{constructor(xa,sb){this.ic=xa;this.ua=sb}get My(){return 64}M3(xa,sb){if((xa=Object(K.a)(Me.a,xa))&&this.ua.Ba&&xa.node&&
22===xa.node.type&&(xa=this.ic.jg(xa.node))&&xa.id===this.ua.Ba.id){const Jb=[];Array.add(Jb,xa);sb(Jb,7)}}}Object(h.a)(ye,"SlideTextOnNumberListDisconnectDetectStrategy",null,[872]);class Yc{constructor(xa,sb){this.ic=xa;this.ua=sb}get My(){return 32}M3(xa,sb){var Jb=Object(K.a)(lf.a,xa);Jb&&Jb.node&&22===Jb.node.type&&(xa=this.ic.jg(Jb.node))&&this.ua.Ba&&xa.id===this.ua.Ba.id&&Jb.property===xb.a.Ui&&(Jb=[],Array.add(Jb,xa),sb(Jb,8))}}Object(h.a)(Yc,"SlideTextOnNumberListPropertyChangedDetectStrategy",
null,[872]);class Ae{constructor(xa,sb,Jb,uc){this.ua=xa;this.Yl=sb;this.ic=Jb;this.yXa=uc}get My(){return 16}M3(xa,sb){if((xa=Object(K.a)(Me.a,xa))&&xa.node&&this.ua.Ba&&12===xa.node.type){const Jb=this.ic.jg(xa.node);!Jb||Jb.id!==this.ua.Ba.id||this.Yl.Tka(xa.node)&&!this.yXa||(xa=[],Array.add(xa,this.ua.Ba),sb(xa,6))}}}Object(h.a)(Ae,"SlideTextOnParagraphDisconnectDetectStrategy",null,[872]);class hd{constructor(xa,sb,Jb,uc,Gd,ee,se,$e){this.ua=xa;this.Yl=sb;this.ic=Jb;this.Ea=uc;this.yXa=Gd;this.O0=
se;this.kic=$e}get My(){return 1}M3(xa,sb){if((xa=Object(K.a)(lf.a,xa))&&xa.node&&this.ua.Ba&&12===xa.node.type){var Jb=this.ic.jg(xa.node);if(Jb&&Jb.id===this.ua.Ba.id&&(Jb=Object(K.a)(Ta.AParagraphNode,xa.node))&&(!this.Yl.Tka(Jb)||this.yXa)){var uc=this.Ea.en(Jb);uc.kla||uc.ux||uc.Qf||uc.ud||!uc.fl||!this.kic||(this.O0.settings.rMe=!0,this.O0.IAl(Jb));xa.property===Sd.a.listLevel?this.Oub(3,this.ua.Ba,sb):xa.property===xb.a.pq?this.Oub(4,this.ua.Ba,sb):xa.property===id.a.Uda&&(Jb.sa(id.a.Uda,!1)||
this.Oub(4,this.ua.Ba,sb))}}}Oub(xa,sb,Jb){if(sb){var uc=[];Array.add(uc,sb);Jb(uc,xa)}}}Object(h.a)(hd,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[872]);class oe{constructor(xa,sb){this.ua=xa;this.ic=sb}get My(){return 8}M3(xa,sb){xa=Object(K.a)(Jc.a,xa);this.ua.Ba&&xa&&xa.node&&10===xa.node.type&&1===xa.VZ&&(xa=Object(K.a)(4,xa.node))&&(xa=this.ic.jg(xa))&&xa.id===this.ua.Ba.id&&(xa=[],Array.add(xa,this.ua.Ba),sb(xa,5))}}Object(h.a)(oe,"SlideTextOnShapeChildTopologyChangedDetectStrategy",
null,[872]);class Xe{constructor(xa,sb,Jb,uc,Gd,ee,se,$e,gg){this.ic=xa;this.Ea=sb;this.ob=Jb;this.sU=uc;this.ua=Gd;this.Yl=ee;this.Ha=se;this.kz=$e;this.O0=gg}o$i(xa){if(Ab.a.Wa(xa))return 0;let sb=0;for(const Jb of xa)sb|=this.Y3k(Jb);return sb}q$i(xa){if(Ab.a.Wa(xa))return 0;let sb=0;for(const Jb of xa)sb|=this.$3k(Jb);return sb}p$i(xa){if(Ab.a.Wa(xa))return 0;let sb=0;for(const Jb of xa)sb|=this.Z3k(Jb);return sb}RHi(){return new fb(this.Ea,this.sU,this.ob)}SHi(){return new ac(this.ob,this.sU,
this.O0,this.Ha.Nmc)}PHi(){return new Hf(this.sU)}THi(){return new pd(this.ob,this.sU)}QHi(){return new Tf(this.Ea,this.sU,this.ob)}eIi(){return new Wd}hIi(){return new Ae(this.ua,this.Yl,this.ic,this.Ha.pptNotesInSlideTextTileIsEnabled)}iIi(){return new hd(this.ua,this.Yl,this.ic,this.Ea,this.Ha.pptNotesInSlideTextTileIsEnabled,this.kz,this.O0,this.Ha.Nmc)}jIi(){return new oe(this.ua,this.ic)}gIi(){return new Yc(this.ic,this.ua)}fIi(){return new ye(this.ic,this.ua)}cIi(){return new sd(this.ic)}dIi(){return new ze(this.ic)}bIi(){return new qd(2)}aIi(){return new qd(1)}Y3k(xa){return xa===
Bc.Ghl?1:xa===Bc.Hhl?2:xa===Bc.Ehl?4:xa===Bc.Ihl?8:xa===Bc.Fhl?16:0}$3k(xa){return xa===Bc.Apl?4:xa===Bc.Dpl?16:xa===Bc.Epl?1:xa===Bc.Fpl?8:xa===Bc.Cpl?32:xa===Bc.Bpl?64:0}Z3k(xa){return xa===Bc.wpl?16:xa===Bc.xpl?1:xa===Bc.upl?128:xa===Bc.vpl?256:0}}Object(h.a)(Xe,"TilingFactory",null,[834]);class Ke extends Sys.EventArgs{constructor(xa){super();this.Ba=xa}}Object(h.a)(Ke,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class me{constructor(){this.K=null;this.nCe=this.tqe=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}Zb(xa){this.K=
xa;xa.register(bd,"PowerPointWebEditor.ContentUpdateDetection.TilingEventSource").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventSource").ma().oa(()=>new bd);xa.register(831,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().oa(()=>new rb(xa.resolve("Box4.Graph.IGraphIteratorFactory"),xa.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
xa.resolve("PowerPointWebEditor.IShapeReader"),xa.resolve("Box4.IParagraphReader")));xa.register(832,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().oa(()=>new jg(xa.resolve("Box4.IParagraphReader"),xa.resolve("PowerPointWebEditor.Graph.INotesReader"),xa.resolve("Box4.Proofing.IProofingTextUtility"),xa.resolve("Box4.Graph.IGraphIteratorFactory"),xa.resolve("Box4.ITableNavigator"),xa.resolve("PowerPointWebEditor.Graph.ITableReader"),xa.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
xa.resolve("Box4.IListMarkerUtility"),xa.resolve("PowerPointWebEditor.IPPTParagraphReader"),xa.resolve("Box4.List.IListReader"),xa.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,xa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));xa.register(833,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().oa(()=>new jf(xa.resolve("Box4.List.IListReader"),xa.resolve("Box4.IParagraphIndentationReader")));
xa.register(xh,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().oa(()=>new xh(xa.resolve("Box4.Graph.IGraphIteratorFactory"),xa.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),xa.resolve("PowerPointWebEditor.IApplicationSettings"),xa.resolve("Box4.IParagraphReader"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),xa.resolve("PowerPointWebEditor.IPresentationReader")));xa.register(834,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().oa(()=>
new Xe(xa.resolve("PowerPointWebEditor.ISlideReader"),xa.resolve("PowerPointWebEditor.IShapeReader"),xa.resolve("PowerPointWebEditor.IPptSelectionManager"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),xa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xa.resolve("PowerPointWebEditor.Graph.INotesReader"),xa.resolve("PowerPointWebEditor.IApplicationSettings"),xa.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),xa.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));
xa.register($d,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().oa(()=>new $d(xa.resolve("Box4.Graph.IGraphInstance"),xa.resolve("PowerPointWebEditor.IPptSelectionManager"),xa.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),xa.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),xa.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").o$i(xa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),
xa.resolve("Common.ITaskManager"),xa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),xa.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),xa.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));xa.register(Cb,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().oa(()=>
new Cb(xa.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").q$i(xa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),xa.resolve("Common.ITaskManager"),xa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),
xa.resolve("Box4.Graph.IGraphInstance"),xa.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),xa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers"),xa.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));xa.register(he,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().oa(()=>new he(xa.resolve("Box4.Graph.IGraphInstance"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").p$i(xa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),
xa.resolve("Common.ITaskManager"),xa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,xa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),xa.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),xa.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),xa.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),xa.resolve("PowerPointWebEditor.IApplicationSettings")))}nVf(){return hc.a("AL.SendSlideTile")}init(){const xa=
this.K.resolve("Common.IAppSettingsManager");xa.ff(()=>{this.tqe=xa.ka("497");this.nCe=xa.ka("810")||xa.ka("809");this.tqe&&(xa.ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.nCe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.nVf()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());
this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").pRk(new Ke(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba))})}dispose(){this.tqe&&(this.K.resolve("Common.IAppSettingsManager").ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.nCe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),
this.nVf()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize())}static main(){v.a.instance.Dc(new me)}}Object(h.a)(me,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var Uf=d(1024),yf=d(651),Cf=d(141),Ld=d(155),od=d(526),ug=d(111),Kf=d(48);class Vf{constructor(xa,sb,Jb,uc,Gd,ee,se,$e){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=
this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=xa;this.critiqueCountGrammar=sb;this.critiqueCountFormality=Jb;this.critiqueCountPunctuationConvention=uc;this.critiqueCountVocabulary=Gd;this.critiqueCountConciseness=ee;this.critiqueCountClarity=se;this.critiqueCountInclusiveness=$e}}Object(h.a)(Vf,"EditorPaneProps",null,[]);class Ch{constructor(xa,sb,Jb,uc,Gd,ee,se,$e,gg,Th,Uh,Qj,Xd,Wf,yk){this.Eb=!1;this.Hni=320;this.MXa=!1;this.Saa=
{};if(!xa)throw Error.argumentNull("pptSelectionManager");if(!sb)throw Error.argumentNull("appFrame");if(!Jb)throw Error.argumentNull("actionManager");if(!uc)throw Error.argumentNull("focusManager");if(!Gd)throw Error.argumentNull("editorPane");if(!se)throw Error.argumentNull("graphOperationEventHandler");if(!$e)throw Error.argumentNull("viewElementEventHandlers");if(!gg)throw Error.argumentNull("viewEventSource");if(!Th)throw Error.argumentNull("pageView");if(!Qj)throw Error.argumentNull("workspace");
if(!Xd)throw Error.argumentNull("dynamicScriptLoader");if(!yk)throw Error.argumentNull("graphTopologyManager");Xd.loadScript("powerpoint-editor-intl").then(()=>{this.MXa=!0}).catch(ak=>{oc.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+ak.toString())});this.Rb=sb;this.ia=Jb;this.gre=Wf;this.Fa=uc;this.Yf=se;this.ld=$e;this.Lc=gg;this.u$=Uh;this.ua=yk;this.Yf.tI(this.nJa.bind(this));this.Yf.SBa(this.nJa.bind(this));this.Lc.JPa(this.nJa.bind(this));this.ld.VBa(this.nJa.bind(this));this.Rb.RK(this.Tu.bind(this));
this.initialize()}initialize(){this.u$.execute(xa=>{xa.addEventHandler(od.a.nWd,this.ntj.bind(this))})}dispose(){this.Yf.X5(this.nJa.bind(this));this.Yf.l_a(this.nJa.bind(this));this.Lc.Sib(this.nJa.bind(this));this.ld.Uib(this.nJa.bind(this));this.Rb.CY(this.nJa.bind(this))}wb(){this.ia.ra(vc.a.erd,Rb.a.application,this.erd.bind(this),4);this.ia.ra(vc.a.Hjd,Rb.a.application,this.Hjd.bind(this),96)}Ee(){}nJa(){this.Eb&&this.Ql(!0)}Tu(xa){1===xa.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Fa.Ej(Kf.a.u8,
this.Eb))}Hjd(xa,sb,Jb,uc,Gd){(xa=Object(K.a)(ug.a,Gd))&&xa.Lf(this.Eb);return 32}erd(xa,sb,Jb){return this.MXa?1===Jb?32:2===Jb?(this.Eb=!this.Eb,Ld.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Eb.toString(),xa,()=>{this.Eb?this.Ql():this.Cr();return 32})):8:8}Ql(xa=!1){const sb=this.yC(),Jb=Object.assign(new yf.a,{title:"Editor Pane",hideHeader:!1,width:this.Hni,location:2,contentProps:sb,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0});Cf.UISurfaces.zr().then(uc=>{xa?uc.updateTaskPane(Kf.a.u8,
Jb):uc.showTaskPane(Kf.a.u8,Jb);return null}).catch(uc=>{oc.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+uc.toString())})}Cr(){Cf.UISurfaces.zr().then(xa=>{xa.hideTaskPane(Kf.a.u8,2);return null}).catch(xa=>{oc.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+xa.toString())})}yC(){let xa=0,sb=0,Jb=0,uc=0,Gd=0,ee=0,se=0,$e=0;const gg=this.ua.Ba?this.ua.Ba.cid:void 0;gg&&this.Saa[gg]&&Object.keys(this.Saa[gg]).forEach(Th=>
{this.Saa[gg][Th].forEach(Uh=>{switch(Uh.CategoryTitle){case "Spelling":xa+=1;break;case "Grammar":sb+=1;break;case "Conciseness":ee+=1;break;case "Formality":Jb+=1;break;case "PunctuationConventions":uc+=1;break;case "Clarity":se+=1;break;case "Inclusiveness":$e+=1;break;case "Vocabulary":Gd+=1;break;default:oc.a.J(509727769,822,50,"Unknown Critique Type: "+Uh.CategoryTitle)}})});return new Vf(xa,sb,Jb,uc,Gd,ee,se,$e)}IEl(xa,sb){const Jb={};Object.keys(xa).forEach(uc=>{this.Saa[sb]?(Object.keys(this.Saa[sb]).includes(uc),
this.Saa[sb][uc]=xa[uc]):(Jb[uc]=xa[uc],this.Saa[sb]=Jb)})}ntj(xa,sb,Jb,uc){sb&&uc&&(xa=JSON.parse(sb.Content),uc=this.gre.lJf(uc.critiques),sb=this.ua.Ba.cid,null!=uc&&0<uc.length?this.IEl(this.Q5i(uc),sb):0==uc.length&&this.Saa[sb]&&this.LQi(xa.drawingElems,sb),this.Saa[sb]&&this.hZk(xa.drawingElems,sb),this.Ql(!0))}hZk(xa,sb){const Jb=Object.keys(this.Saa[sb]),uc=this.foj(xa);Jb.forEach(Gd=>{uc.includes(Gd)||delete this.Saa[sb][Gd]})}foj(xa){const sb=[];xa.forEach(Jb=>{0<Jb.text.paragraphs.length&&
Jb.text.paragraphs.forEach(uc=>{sb.push(uc.id)})});return sb}LQi(xa,sb){xa.forEach(Jb=>{0<Jb.text.paragraphs.length&&this.Ysi(Jb.text.paragraphs,sb)})}Ysi(xa,sb){xa.forEach(Jb=>{this.Saa[sb][Jb.id]&&(Jb.pfRuns[0].pf.proofingDirty||""==Jb.chars)&&delete this.Saa[sb][Jb.id]})}Q5i(xa){const sb={};if(xa)for(const Jb of xa)Jb.TileId in sb?Array.add(sb[Jb.TileId],Jb):sb[Jb.TileId]=[Jb];return sb}}Object(h.a)(Ch,"DexLitePaneActor",null,[106,365]);class xg{constructor(){this.va=new Mh.a}CPe(xa){this.va.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",
xa)}avf(xa){this.va.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",xa)}}Object(h.a)(xg,"EditorRuntimeEventSource",null,[951,952,953]);var lh=d(16),Oi=d(51),ph=d(692),Dh=d(34);class mh{constructor(xa,sb){this.paragraph=xa;this.critiqueId=sb}}Object(h.a)(mh,"CritiqueToHighlight",null,[]);class Od{constructor(xa,sb,Jb,uc,Gd,ee,se,$e,gg,Th){this.Dea=xa;this.o8j=sb;this.ua=Jb;this.PC=uc;this.Jb=Gd;this.lJ=ee;this.pa=se;this.Hre=$e;this.Fa=gg;this.Y9j=Th;this.Dea.LQe(this.o8j)}OWc(xa){xa.length?
(xa=this.Wfj(xa),xa.length&&(xa=Object.assign(new ph.a,{action:0,type:2,Ada:xa,aib:this.Dea.Nbb?this.Dea.Nbb.Ada:null}),this.Dea.fpd(xa))):this.wLi()}wLi(){var xa=this.Dea.Nbb?this.Dea.Nbb.Ada:null;xa=Object.assign(new ph.a,{action:1,type:2,Ada:xa,aib:xa});this.Dea.fpd(xa)}Wfj(xa){const sb=[];if(!this.Hre.isEnabled(2))return sb;var Jb=this.ua.Ba;if(Jb&&Jb.isSlideCritiqueReady){var uc=Jb.tLa;if(!uc.count)return this.dpe(2),sb;Jb=0;for(let ee of uc)if(uc=Object(K.a)(Ta.AParagraphNode,ee)){var Gd=this.o8d(uc);
for(const se of Gd)Gd=Object(K.a)(440,se.Hh),Gd.zN&&Array.contains(xa,Gd.zN.TraceId)&&(Jb++,Gd=new mh(uc,Gd.zN.TraceId),Array.add(sb,Gd))}Jb!==xa.length&&this.ppe(2,Jb,xa.length)}else this.lpe(2,Jb);return sb}MBh(xa){if(!this.Hre.isEnabled(3))return!1;var sb=this.ua.Ba;if(sb&&sb.isSlideCritiqueReady){sb=sb.tLa;if(!sb.count)return this.dpe(3),!1;let Jb=0;const uc=this.Jb.Ad(15,void 0,()=>{this.$bh()});try{let Gd=!1;uc.nc(sb.ga(0));uc.jd=Dh.a.Ssd;for(let ee of sb){const se=Object(K.a)(Ta.AParagraphNode,
ee);if(se){const $e=new B.a,gg=this.o8d(se);for(const Th of gg){const Uh=Object(K.a)(440,Th.Hh);if(Uh.zN&&xa.Gb(Uh.zN.TraceId)){const Qj=xa.ga(Uh.zN.TraceId);let Xd;try{Xd=Uh.zN.Suggestions[Qj].Text;const Wf=new lh.a(Th,Xd);$e.add(Wf);Gd||(Uh.dMa(this.llk(Qj)),Gd=!0);Jb++}catch(Wf){oc.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",Wf)}}}$e.count&&($e.Sc((Th,Uh)=>Uh.key.begin-Th.key.begin),this.H1k(se,$e))}}Jb!==xa.count&&this.ppe(3,Jb,xa.count)}finally{uc&&uc.dispose()}}else return this.lpe(3,
sb),!1;return!0}llk(xa){switch(xa){case 0:return Dh.a.kza;case 1:return Dh.a.lza;case 2:return Dh.a.mza;case 3:return Dh.a.LLa;case 4:return Dh.a.MLa;default:return 0}}H1k(xa,sb){for(let Jb of sb)this.lJ.replaceTextRange(Oi.a.createTextRange(xa,0<Jb.key.begin?Jb.key.begin:0,Jb.key.end),Jb.value,!0,!1)}ignoreCritiques(xa,sb){if(!this.Hre.isEnabled(sb))return!1;var Jb=this.ua.Ba;if(Jb&&Jb.isSlideCritiqueReady){var uc=Jb.tLa;if(!uc.count)return this.dpe(sb),!1;this.$bh();Jb=!1;let Gd=0;for(let ee of uc)if(uc=
Object(K.a)(Ta.AParagraphNode,ee)){uc=this.o8d(uc);for(const se of uc)uc=Object(K.a)(440,se.Hh),uc.zN&&Array.contains(xa,uc.zN.TraceId)&&(uc.MEa=!0,Jb||(uc.dMa(Dh.a.Lde),Jb=!0),Gd++)}Gd!==xa.length&&this.ppe(sb,Gd,xa.length)}else return this.lpe(sb,Jb),!1;return!0}o8d(xa){return this.PC.GF(xa,sb=>{sb=Object(K.a)(440,sb.Hh);return!!sb&&5===sb.proofingType&&!sb.MEa})}dpe(xa){oc.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",xa)}ppe(xa,sb,Jb){oc.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",
xa,sb,Jb)}lpe(xa,sb){oc.a.J(38843404,375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",xa,!!sb)}$bh(){this.pa.ey();this.pa.jj();this.Y9j&&this.Fa.rf(Kf.a.sg,!0)}}Object(h.a)(Od,"ConsistencyCheckActor",null,[820]);var Ue=d(314),yh=d(97),Hj=d(913),fe=d(689),Zh=d(50),Pi=d(690),Zj=d(691);class Wg extends fe.a{constructor(xa,sb){super();this.e5c=[Hj.a.cGe,Hj.a.d2c,Hj.a.jnd,Hj.a.FIc];this.ua=xa;this.tbk=sb;this.gwe=[new Pi.a("InconsistentCritiquesHighlight",null),
new Pi.a("InconsistentCritiquesLeftSidebar",null),new Pi.a("InconsistentCritiquesRightSidebar",null)]}get pyb(){return this.tbk}get pde(){return this.gwe}p9b(xa,sb){xa=Object(Re.a)(Array,xa)?Array.isArray(xa)?xa:null:null;if(!xa||0<xa.length&&!Object(K.a)(mh,xa[0]))return sb;const Jb=new Zh.GraphTransaction(3);try{Jb.kd(this.ua.presentation);for(const uc of xa)Zj.b(uc.paragraph),sb.add(uc.paragraph)}finally{Jb&&Jb.dispose()}return sb}Jkc(xa,sb){if(this.pyb&&this.w_&&this.w_.vja&&this.w_.vja.Ada&&
2===this.w_.vja.type){var Jb=[],uc=[];this.Uah(this.w_.vja.Ada,Jb,uc);var Gd=[];this.Uah(this.w_.vja.aib,null,Gd);sb=sb.querySelectorAll("*");for(let ee=0;ee<sb.length;ee++){let se="",$e="";const gg=sb[ee];for(let Th=0;Th<this.e5c.length;Th++)Ue.a.Be(gg,this.e5c[Th])&&($e=this.e5c[Th],se=Ue.a.Be(gg,this.e5c[Th]));se.length&&2===this.w_.vja.type&&(0===this.w_.vja.action?Array.contains(uc,xa)&&Array.contains(Jb,se)?this.UAj(gg,$e):this.Ild(gg):1===this.w_.vja.action&&Array.contains(Gd,xa)&&this.Ild(gg))}}}UAj(xa,
sb){yh.a.BI(xa,"InconsistentCritiquesHighlight");switch(sb){case Hj.a.d2c:yh.a.BI(xa,"InconsistentCritiquesLeftSidebar");break;case Hj.a.jnd:yh.a.BI(xa,"InconsistentCritiquesRightSidebar");break;case Hj.a.FIc:yh.a.BI(xa,"InconsistentCritiquesLeftSidebar"),yh.a.BI(xa,"InconsistentCritiquesRightSidebar")}}Uah(xa,sb,Jb){if(xa)for(const uc of xa)Array.add(Jb,uc.paragraph),sb&&Array.add(sb,uc.critiqueId)}}Object(h.a)(Wg,"CritiquesHighlightActor",fe.a,[]);class $h{}Object(h.a)($h,"Critique",null,[]);class Fe{}
Object(h.a)(Fe,"Suggestion",null,[]);class Ph{jJf(xa,sb){if(!xa)return[];const Jb=Array(xa.length);for(let uc=0;uc<xa.length;uc++)Jb[uc]=sb(xa[uc]);return Jb}rBi(xa){return Object.assign(new $h,{critiqueId:xa.TraceId,typeId:xa.TypeId,tag:xa.Tag,bucketId:xa.BucketId,paragraphId:xa.TileId,start:xa.Start,length:xa.Length,categoryTitle:xa.CategoryTitle,explanationTitle:xa.ExplanationTitle,explanationLabel:xa.ExplanationLabel,explanation:xa.Explanation,suggestions:this.jJf(xa.Suggestions,Object(y.a)(this,
this.sBi,"convertBox4Suggestion"))})}sBi(xa){return Object.assign(new Fe,{text:xa.Text,description:xa.Description,bucketId:xa.BucketId,numberOfInstances:xa.NumberOfInstances})}}Object(h.a)(Ph,"DataContractMapper",null,[823]);class rg extends Sys.EventArgs{constructor(xa){super();this.instanceId=xa}}Object(h.a)(rg,"PaneClosedEventArgs",Sys.EventArgs,[]);var zg=d(189);class lj{constructor(xa,sb,Jb,uc,Gd,ee,se,$e){this.ia=xa;this.Yc=sb;this.Lc=Jb;this.Lse=uc;this.oEb=Gd;this.QCb=ee;this.qwe=se;this.Sjk=
$e;this.Je=0;this.Yc.execute(gg=>{gg.WGc(Object(y.a)(this,this.tJa,"onPaneClosed"))})}get state(){return this.Je}iqd(xa){this.Je!==xa&&(this.Je=xa,this.Lc.Gy(new zg.a(1)))}J8g(xa){0===this.state&&(oc.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",xa,(new Date).getTime()),this.iqd(1),xa={},xa.XE=ResourceStrings.L_EditorPaneTitle,xa.assetId=this.oEb.getAssetId(),xa.H5=Object(y.a)(this,this.bhb,"onPaneRendered"),xa.nonPersistedSettings={},xa.nonPersistedSettings.IdeasEnabled=
this.qwe.toString(),xa.CJh=this.Sjk,32!==this.ia.La(vc.a.lga,2,xa)&&(oc.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),this.iqd(0)))}YK(xa){if(2===this.state){var sb=this.oEb.VSa();sb&&(oc.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",xa),32!==this.ia.La(vc.a.Ftb,2,sb)&&oc.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}tJa(xa,sb){2===this.state&&sb&&(xa=sb.instanceId)&&xa.length&&(sb=this.oEb.VSa(),sb!==xa&&sb||(oc.a.J(37626588,375,50,
"[EditorPane] Pane closed"),this.Lse.eQk(new rg(xa)),this.iqd(0),this.QCb.sessionEnd()))}bhb(){const xa=this.oEb.VSa();1!==this.state?oc.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",xa):(oc.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",xa),this.iqd(2),this.QCb.E$k())}}Object(h.a)(lj,"EditorPane",null,[825]);class pg{constructor(xa,sb){this.type=0;this.id=null;this.type=xa;this.id=sb}static Tlb(xa){return xa.id&&
xa.id.toString().length&&Object(Re.a)(Number,xa.type)?new pg(xa.type,xa.id.toString()):null}}Object(h.a)(pg,"Message",null,[]);var Nh=d(2);class Ha{constructor(xa,sb,Jb,uc,Gd,ee,se,$e,gg,Th,Uh,Qj,Xd,Wf,yk,ak){this.F2d=new Uf.a;this.ia=xa;this.i0=sb;this.mCb=Jb;this.nxg=uc;this.j0=Gd;this.dJg=ee;this.RL=se;this.Lse=$e;this.ua=gg;this.Gma=Th;this.dbd=Uh;this.Qk=Qj;this.c9j=Xd;this.Lc=Wf;this.i$j=yk;this.oc=ak;this.uPc=new Uf.a(0);this.uPc.add(0,2001);this.uPc.add(1,2002);this.uPc.add(2,2003)}wb(){this.ia.ra(vc.a.SLe,
Rb.a.application,Object(y.a)(this,this.DRf,"editorPaneButtonClicked"),4);this.ia.ra(vc.a.zOe,Rb.a.application,Object(y.a)(this,this.ceh,"queryEditorPaneButton"),96);this.ia.ra(vc.a.hIk,Rb.a.application,Object(y.a)(this,this.DRf,"editorPaneButtonClicked"),4);this.ia.ra(vc.a.AOe,Rb.a.application,Object(y.a)(this,this.ceh,"queryEditorPaneButton"),96);this.ia.ra(vc.a.RLe,Rb.a.application,Object(y.a)(this,this.ERf,"editorPaneExtenal"),4);this.ia.ra(vc.a.vbh,Rb.a.application,Object(y.a)(this,this.ERf,"editorPaneExtenal"),
4);this.nxg.TPd(Object(y.a)(this,this.ruk,"onEditorPaneMessageReceived"));this.Gma.n6a(Object(y.a)(this,this.X0,"onSlidePresenceChanged"));this.dbd.kk(Object(y.a)(this,this.Pna,"onSlidePropertyChanged"));this.Qk.tI(Object(y.a)(this,this.DB,"onActiveSlideChanged"));this.Lse.ibi(Object(y.a)(this,this.tJa,"onPaneClosed"))}Ee(){}ERf(xa,sb,Jb){if(1===Jb)return 32;switch(xa){case vc.a.RLe:this.i0.J8g(2);break;case vc.a.vbh:this.i0.YK(2);break;default:return oc.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",
xa),16}return 32}DRf(xa,sb,Jb){if(1===Jb)return this.oc.qj()?32:16;switch(this.i0.state){case 0:return this.i0.J8g(1),32;case 2:return this.i0.YK(1),32;case 1:return oc.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Lc.Gy(new zg.a(1)),32;default:return oc.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}ceh(xa,sb,Jb,uc,Gd){if(!Gd||!Object(Re.a)(ug.a,Gd))return 8;Gd.Lf(2===this.i0.state||1===this.i0.state);return 32}ruk(xa,
sb){this.suk(sb)}suk(xa){const sb=this.j0.qMi(xa.message);if(sb){var Jb;({value:Jb}=this.dJg.Tf(sb.type)).returnValue||(Jb=this.dJg.ga(0));var uc=Jb.process(xa,sb);uc.continueWith(()=>{const Gd=uc.result,ee=this.j0.nSf(Gd);this.sendMessage(xa.instanceId,ee);this.j4j(xa,sb,Gd)})}else oc.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),Nh.Task.gt(!1)}DPe(xa){this.F2d.Gb(xa)||this.F2d.$(xa,this.i$j.tYd(200,()=>{const sb=this.mCb.nmj(xa);if(sb.length){var Jb=
new pg(this.uPc.ga(xa),Xb.a.create().toString());Jb=this.j0.nSf(Jb);this.A9k(sb,Jb)}this.c9j.CPe(xa)}));this.F2d.ga(xa).perform()}A9k(xa,sb){for(const Jb of xa)this.sendMessage(Jb,sb)}sendMessage(xa,sb){this.nxg.sendMessage(xa,sb)}j4j(xa,sb,Jb){const uc=new Date,Gd=+uc-+xa.tgh;2E3<=Gd&&oc.a.J(39331167,375,1E4<=Gd?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",
xa.instanceId,xa.vke,xa.tgh.toUTCString(),uc.getTime(),Gd.toString(),sb.id,sb.type,Jb.id,Jb.type)}Pna(xa,sb){sb.property===id.a.isSlideCritiqueReady&&this.DPe(1)}DB(){this.DPe(0)}X0(xa,sb){(xa=this.ua.Ba)&&sb.slideId.equals(xa.Cb)&&this.DPe(2)}tJa(xa,sb){this.mCb.ADl(sb.instanceId);this.RL.visualizeCritiques([])}}Object(h.a)(Ha,"EditorPaneActor",null,[]);class kb{constructor(){this.va=new Mh.a}ibi(xa){this.va.addHandler("PaneClosed",xa)}eQk(xa){this.va.raiseEvent("PaneClosed",xa)}}Object(h.a)(kb,
"EditorPaneEventSource",null,[826,938,939]);var Hb=d(4);class ic{}Object(h.a)(ic,"Paragraph",null,[]);var Qc=d(216);class Jd{constructor(xa,sb,Jb,uc,Gd,ee,se,$e,gg){this.ua=xa;this.PC=sb;this.eWa=Jb;this.ia=uc;this.Ea=Gd;this.$fk=ee;this.$re=se;this.Ih=$e;this.ybk=gg}checkProofingDirty(xa){const sb=xa.includedTags;if(2===xa.critiqueSelection&&1===sb)return xa=(xa=this.ua.Ba)&&xa.isConnected?!xa.isSlideCritiqueReady:!0,this.Nua(0,!0),xa;this.$rg("CheckProofingDirty");return!0}getCritiques(xa){var sb=
xa.includedTags;if(2===xa.critiqueSelection&&1===sb){xa=this.ua.Ba;if(!xa||!xa.isConnected||!xa.isSlideCritiqueReady)return null;sb=xa.tLa;xa=[];for(let Jb of sb)if((sb=Jb)&&sb.isConnected){sb=this.PC.GF(sb,uc=>{uc=Object(K.a)(440,uc.Hh);return!!uc&&5===uc.proofingType&&!uc.MEa});for(const uc of sb)(sb=Object(K.a)(440,uc.Hh))&&xa.push(sb.zN)}this.Nua(1,!0);return this.$re.jJf(xa,Object(y.a)(this.$re,this.$re.rBi,"convertBox4Critique"))}this.$rg("GetCritiques");return null}E5f(xa){var sb=this.ua.Ba;
if(!sb||!sb.isConnected)return null;const Jb=[];xa=Jd.apk(xa);sb=sb.aja;for(const uc of xa)(xa=Object(K.a)(Nc.a,sb.Be(Xb.a.Gf(uc))))&&xa.isConnected&&Jb.push(Object.assign(new ic,{paragraphId:uc,text:this.Ih.nSe(xa,"\n")}));return Jb}getSupportedLanguages(xa){return this.$fk.g8i(xa.includedTags).CWR(sb=>{const Jb=[];if(sb=Object(K.a)(Hb.a,sb)){sb=sb.result;for(let uc of sb)(sb=cb.a.xe(uc))&&Array.add(Jb,sb.name)}this.Nua(6,!0);return Jb})}getLanguagesOnCurrentSlide(){const xa=[],sb=[],Jb=this.ua.Ba;
let uc=[];Jb&&(uc=Jb.gk());for(const Gd of uc)this.Ea.NJ(Gd,ee=>{if(ee&&Object(Re.a)(Ta.AParagraphNode,ee)){ee=Object(K.a)(Ta.AParagraphNode,ee);var se=ee.characterData;if(se&&se.length){var $e=-1,gg;for(se=0;se<ee.Ra.length;se++)if(gg=ee.Ra.ga(se).formatting)gg=kc.a.language(gg),$e===gg||Array.contains(xa,gg)||(Array.add(xa,gg),($e=cb.a.xe(gg))&&Array.add(sb,$e.name)),$e=gg}}});this.Nua(7,!0);return sb}visualizeCritiques(xa){if(!xa)return this.Nua(2,!1),1;const sb=Array(xa.length);if(!xa.length)return this.eWa.OWc(sb),
this.Nua(2,!0),0;for(let Jb=0;Jb<xa.length;Jb++)sb[Jb]=xa[Jb].critiqueId;this.eWa.OWc(sb);this.Nua(2,!0);return 0}resolveCritiques(xa){if(!xa||!xa.length)return 1;const sb=new Uf.a(0);for(const Jb of xa)sb.add(Jb.critiqueId,Jb.suggestionIndex);xa=this.eWa.MBh(sb);this.Nua(3,xa);return xa?0:1}ignoreCritiques(xa){if(!xa||!xa.length)return 1;const sb=[];for(const Jb of xa)Array.add(sb,Jb.critiqueId);xa=this.eWa.ignoreCritiques(sb,4);this.Nua(4,xa);return xa?0:1}openProofingSettingsDialog(){if(this.ybk){const xa=
this.ia.processAction(Dh.a.MHb,2);this.Nua(5,32===xa)}}Nua(xa,sb){oc.a.J(37266337,375,50,"{0}: {1}",xa,sb?0:1)}$rg(xa){oc.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",xa)}static apk(xa){const sb=new Qc.a;for(var Jb of xa)sb.contains(Jb.paragraphId)||sb.add(Jb.paragraphId);xa=Array(sb.count);Jb=0;for(let uc of sb)xa[Jb++]=uc;return xa}}Object(h.a)(Jd,"EditorPaneHost",null,[822]);class yd{}Object(h.a)(yd,"EditorRuntimeNotificationData",null,[]);class He extends Sys.EventArgs{constructor(){super();
this.q3b=this.Jka=null}}Object(h.a)(He,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class sf{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(h.a)(sf,"InfraredResultBase",null,[]);var bg=d(337),Ag=d(527);class Ii{constructor(xa,sb){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=xa;this.includedTags=sb}static TH(xa){return Object(Re.a)(Number,xa.critiqueSelection)&&Object(Re.a)(Number,xa.includedTags)?
new Ii(xa.critiqueSelection,xa.includedTags):null}}Object(h.a)(Ii,"CritiqueFilter",null,[]);class aj{constructor(xa,sb,Jb,uc){this.ia=xa;this.RL=sb;this.ua=Jb;this.oxg=uc}CPe(xa){if(this.oxg){var sb=new Ii(2,1),Jb=this.RL.checkProofingDirty(sb),uc=Jb?[]:this.RL.getCritiques(sb),Gd=Jb?[]:this.RL.E5f(uc);sb=this.CGe();xa=Object.assign(new yd,{isProofingDirty:Jb,critiques:uc,paragraphs:Gd,numberOfCoAuthors:sb,contextChanged:0===xa});Gd=(uc=!!uc&&0<uc.length)?1:0;let ee=bg.a.success;0<sb?ee=bg.a.cJa:
Jb?ee=bg.a.pending:uc||(ee=bg.a.cJa);Jb=Object.assign(new He,{Jka:Object.assign(new sf,{notificationConfidence:Gd,shouldRaiseNotification:!1,confidence:1,resultStatus:ee}),q3b:xa});this.oxg.CPe(Jb)}}CGe(){var xa=this.ua.Ba;if(!xa||!xa.isConnected)return 0;xa=Object.assign(new Ag.a,{slideId:xa.Cb});this.ia.La(vc.a.XZa,2,xa);return xa.bsc}}Object(h.a)(aj,"EditorRuntimeEventRaiser",null,[821]);var Xg=d(544),Qi=d(704);class Jh{constructor(xa){this.nak=xa}E$k(){this.X_a(0,0)}sessionEnd(){this.X_a(1,0)}utl(){this.X_a(2,
4)}vtl(){this.X_a(2,3)}X_a(xa,sb){this.nak.execute(Jb=>{const uc=Object.assign(new Qi.a,{cardId:Xg.a.BRf,actionType:xa,actionEngagement:sb});Jb.yed(uc)})}}Object(h.a)(Jh,"InfraredTelemetryLogger",null,[824]);class Og extends pg{constructor(xa,sb,Jb){super(xa,sb);this.payload=null;this.payload=Jb}}Object(h.a)(Og,"MessageWithPayload",pg,[]);class Qh extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}}Object(h.a)(Qh,"CheckProofingDirtyAndGetCritiquesResponse",Og,[]);class Yg extends Og{constructor(xa,
sb,Jb){super(xa,sb,Jb)}}Object(h.a)(Yg,"ResponseMessage",Og,[]);class If{constructor(xa){this.statusCode=0;this.logErrorMessage=null;this.statusCode=xa;this.logErrorMessage="";0!==xa&&(this.logErrorMessage=xa.toString())}}Object(h.a)(If,"Response",null,[]);class mj extends If{constructor(xa,sb,Jb,uc){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=xa;this.critiques=sb;this.paragraphs=Jb;this.languagesOnTheCurrentSlide=uc}}Object(h.a)(mj,
"ProofingDirtyAndCritiques",If,[]);class xi{constructor(xa,sb,Jb){this.ua=xa;this.RL=sb;this.j0=Jb}process(xa,sb){var Jb=this.j0.AKi(xa.message);if(!Jb)return oc.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),xa=new If(1),Nh.Task.gt(new Yg(1003,sb.id,xa));xa=this.ua.Ba;if(!xa||!xa.isConnected)return oc.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),xa=new mj(!1,[],[],[]),sb=new Qh(1003,sb.id,
xa),Nh.Task.gt(sb);Jb=(xa=this.RL.checkProofingDirty(Jb.payload))?[]:this.RL.getCritiques(Jb.payload);if(!Jb)return oc.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),xa=new If(2),Nh.Task.gt(new Yg(1003,sb.id,xa));const uc=xa?[]:this.RL.E5f(Jb),Gd=xa?[]:this.RL.getLanguagesOnCurrentSlide();if(!Gd)return oc.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),xa=new If(7),Nh.Task.gt(new Yg(1003,
sb.id,xa));xa=new mj(xa,Jb,uc,Gd);sb=new Qh(1003,sb.id,xa);return Nh.Task.gt(sb)}}Object(h.a)(xi,"CheckProofingDirtyAndGetCritiquesProcessor",null,[901]);class Bj{constructor(xa,sb,Jb){this.RL=xa;this.j0=sb;this.QCb=Jb}process(xa,sb){var Jb=this.j0.CKi(xa.message);if(!Jb)return oc.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),xa=new If(1),Nh.Task.gt(new Yg(1006,sb.id,xa));Jb=this.RL.ignoreCritiques(Jb.payload);0===Jb&&xa.vke&&this.QCb.vtl();xa=0===Jb?new If(0):new If(6);return Nh.Task.gt(new Yg(1006,
sb.id,xa))}}Object(h.a)(Bj,"IgnoreProcessor",null,[901]);class yi extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}}Object(h.a)(yi,"NumberOfCoAuthorsResponse",Og,[]);class Zg extends If{constructor(xa){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=xa}}Object(h.a)(Zg,"NumberOfCoAuthorsModel",If,[]);class ya{constructor(xa,sb){this.ia=xa;this.ua=sb}process(xa,sb){xa=this.CGe();xa=new Zg(xa);return Nh.Task.gt(new yi(1009,sb.id,xa))}CGe(){var xa=this.ua.Ba;if(!xa||!xa.isConnected)return 0;
xa=Object.assign(new Ag.a,{slideId:xa.Cb});this.ia.La(vc.a.XZa,2,xa);return xa.bsc}}Object(h.a)(ya,"NumberOfCoAuthorsProcessor",null,[901]);class La{constructor(xa,sb,Jb){this.ia=xa;this.i0=sb;this.qwe=Jb}process(xa,sb){if(!this.qwe)return oc.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),xa=new If(10),Nh.Task.gt(new Yg(1011,sb.id,xa));this.i0.YK(3);xa=this.ia.processAction(vc.a.iZe,2);32!==xa&&oc.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");
xa=new If(32!==xa?9:0);return Nh.Task.gt(new Yg(1011,sb.id,xa))}}Object(h.a)(La,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[901]);class Qa{constructor(xa){this.RL=xa}process(xa,sb){this.RL.openProofingSettingsDialog();xa=new If(0);return Nh.Task.gt(new Yg(1007,sb.id,xa))}}Object(h.a)(Qa,"OpenProofingSettingsProcessor",null,[901]);class Eb{constructor(xa,sb,Jb){this.RL=xa;this.j0=sb;this.QCb=Jb}process(xa,sb){var Jb=this.j0.DKi(xa.message);if(!Jb)return oc.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),
xa=new If(1),Nh.Task.gt(new Yg(1005,sb.id,xa));Jb=this.RL.resolveCritiques(Jb.payload);0===Jb&&xa.vke&&this.QCb.utl();xa=0===Jb?new If(0):new If(5);return Nh.Task.gt(new Yg(1005,sb.id,xa))}}Object(h.a)(Eb,"ResolveProcessor",null,[901]);class fc extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}}Object(h.a)(fc,"SubscriptionResponse",Og,[]);class mc extends If{constructor(xa){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=xa}}Object(h.a)(mc,"SubscriptionModel",If,[]);class Mc{constructor(xa,
sb){this.mCb=xa;this.j0=sb}process(xa,sb){const Jb=this.j0.EKi(xa.message);if(!Jb)return oc.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),xa=new If(1),Nh.Task.gt(new Yg(1001,sb.id,xa));oc.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",Jb.payload.telemetryCorrelationId);this.mCb.subscribe(xa.instanceId,0);this.mCb.subscribe(xa.instanceId,1);this.mCb.subscribe(xa.instanceId,2);xa=new mc("not available");return Nh.Task.gt(new fc(1001,sb.id,xa))}}Object(h.a)(Mc,"SubscribeProcessor",
null,[901]);class nd extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}}Object(h.a)(nd,"SupportedLanguagesResponse",Og,[]);class ba extends If{constructor(xa){super(0);this.supportedLanguages=null;this.supportedLanguages=xa}}Object(h.a)(ba,"SupportedLanguagesModel",If,[]);class Aa{constructor(xa,sb){this.RL=xa;this.j0=sb}process(xa,sb){xa=this.j0.FKi(xa.message);if(!xa)return oc.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),xa=new If(1),Nh.Task.gt(new Yg(1010,sb.id,xa));
const Jb=this.RL.getSupportedLanguages(xa.payload);return Jb.CWR(()=>{var uc=Jb.result;if(!uc)return oc.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),uc=new If(8),new Yg(1010,sb.id,uc);uc=new ba(uc);return new nd(1010,sb.id,uc)})}}Object(h.a)(Aa,"SupportedLanguagesProcessor",null,[901]);class Wa{process(xa,sb){oc.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",sb.type);xa=new If(3);return Nh.Task.gt(new Yg(sb.type,sb.id,
xa))}}Object(h.a)(Wa,"UnsupportedMessageProcessor",null,[901]);class gb{constructor(xa,sb){this.RL=xa;this.j0=sb}process(xa,sb){xa=this.j0.GKi(xa.message);if(!xa)return oc.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),xa=new If(1),Nh.Task.gt(new Yg(1004,sb.id,xa));xa=0===this.RL.visualizeCritiques(xa.payload)?new If(0):new If(4);return Nh.Task.gt(new Yg(1004,sb.id,xa))}}Object(h.a)(gb,"VisualizeProcessor",null,[901]);class nb extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}static TH(xa){const sb=
pg.Tlb(xa);return sb&&xa.payload?(xa=Ii.TH(xa.payload))?new nb(sb.type,sb.id,xa):null:null}}Object(h.a)(nb,"CheckProofingDirtyAndGetCritiquesMessage",Og,[]);class lc{constructor(xa){this.xRb=xa}get critiqueId(){return this.xRb}static TH(xa){return xa.critiqueId&&Object(K.a)(String,xa.critiqueId)?new lc(xa.critiqueId.toString()):null}}Object(h.a)(lc,"CritiqueIgnore",null,[]);class jd extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}static TH(xa){const sb=pg.Tlb(xa);if(!sb||!xa.payload||!Object(Re.a)(Array,
xa.payload))return null;xa=xa.payload;const Jb=Array(xa.length);for(let uc=0;uc<xa.length;uc++){const Gd=lc.TH(xa[uc]);if(!Jb)return null;Jb[uc]=Gd}return new jd(sb.type,sb.id,Jb)}}Object(h.a)(jd,"IgnoreCritiquesMessage",Og,[]);class xd{constructor(xa,sb){this.xRb=xa;this.g2h=sb}get critiqueId(){return this.xRb}get suggestionIndex(){return this.g2h}static TH(xa){return xa.critiqueId&&Object(K.a)(String,xa.critiqueId)&&Object(Re.a)(Number,xa.suggestionIndex)?new xd(xa.critiqueId.toString(),xa.suggestionIndex):
null}}Object(h.a)(xd,"CritiqueResolution",null,[]);class Kc extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}static TH(xa){const sb=pg.Tlb(xa);if(!sb||!xa.payload||!Object(Re.a)(Array,xa.payload))return null;xa=xa.payload;const Jb=Array(xa.length);for(let uc=0;uc<xa.length;uc++){const Gd=xd.TH(xa[uc]);if(!Jb)return null;Jb[uc]=Gd}return new Kc(sb.type,sb.id,Jb)}}Object(h.a)(Kc,"ResolveCritiquesMessage",Og,[]);class Zc{constructor(xa){this.telemetryCorrelationId=null;this.telemetryCorrelationId=xa}static TH(xa){let sb=
"unavailable";xa.telemetryCorrelationId&&Object(K.a)(String,xa.telemetryCorrelationId)&&xa.telemetryCorrelationId.toString().length&&50>=xa.telemetryCorrelationId.toString().length&&(sb=xa.telemetryCorrelationId.toString());return new Zc(sb)}}Object(h.a)(Zc,"Subscription",null,[]);class Sc extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}static TH(xa){const sb=pg.Tlb(xa);if(!sb)return null;xa.payload||(xa.payload={});return(xa=Zc.TH(xa.payload))?new Sc(sb.type,sb.id,xa):null}}Object(h.a)(Sc,"SubscribeMessage",
Og,[]);class ld extends Og{constructor(xa,sb,Jb){super(xa,sb,Jb)}static TH(xa){const sb=pg.Tlb(xa);return sb&&xa.payload?(xa=Ii.TH(xa.payload))?new ld(sb.type,sb.id,xa):null:null}}Object(h.a)(ld,"SupportedLanguagesMessage",Og,[]);class Dg{constructor(xa){this.xRb=xa}get critiqueId(){return this.xRb}static TH(xa){return xa.critiqueId&&Object(K.a)(String,xa.critiqueId)&&xa.critiqueId.toString().length?new Dg(xa.critiqueId.toString()):null}}Object(h.a)(Dg,"CritiqueToVisualize",null,[]);class De extends Og{constructor(xa,
sb,Jb){super(xa,sb,Jb)}static TH(xa){const sb=pg.Tlb(xa);if(!sb||!xa.payload||!Object(Re.a)(Array,xa.payload))return null;xa=xa.payload;const Jb=Array(xa.length);for(let uc=0;uc<xa.length;uc++){const Gd=Dg.TH(xa[uc]);if(!Jb)return null;Jb[uc]=Gd}return new De(sb.type,sb.id,Jb)}}Object(h.a)(De,"VisualizeCritiquesMessage",Og,[]);class gi{qMi(xa){return this.Slb(xa,pg.Tlb)}EKi(xa){return this.Slb(xa,Sc.TH)}AKi(xa){return this.Slb(xa,nb.TH)}GKi(xa){return this.Slb(xa,De.TH)}DKi(xa){return this.Slb(xa,
Kc.TH)}CKi(xa){return this.Slb(xa,jd.TH)}FKi(xa){return this.Slb(xa,ld.TH)}Slb(xa,sb){try{let Jb;return({sv:Jb}=A.d(xa)).returnValue?sb(Jb):null}catch(Jb){return null}}nSf(xa){return A.c(xa)}}Object(h.a)(gi,"MessageEncoder",null,[830]);var pk=d(81);class Kh extends Sys.EventArgs{constructor(xa,sb,Jb){super();this.instanceId=xa;this.message=sb;this.vke=Jb;this.tgh=new Date}}Object(h.a)(Kh,"MessageReceivedEventArgs",Sys.EventArgs,[]);class Yd{constructor(xa,sb,Jb){this.va=new Mh.a;this.oEb=xa;this.btg=
sb;this.Z$j=new RegExp(Jb,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(y.a)(this,this.njc,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(y.a)(this,this.njc,"messageReceivedHandler")),!0;oc.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(xa){oc.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
xa.message,xa.stack)}return!1}TPd(xa){this.va.addHandler("MessageReceived",xa)}gjh(xa){this.va.removeHandler("MessageReceived",xa)}sendMessage(xa,sb){if(xa&&sb){var Jb={};Jb.message=sb;Jb.editorPaneWildCard=".";this.x9k(xa,Jb)}}x9k(xa,sb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(xa,"onCustomMessage",sb,Jb=>{Jb&&oc.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",Jb)})}njc(xa){const sb=xa.origin;if(this.C$b(sb)){var Jb;({sv:Jb}=A.d(xa.data)).returnValue&&
Jb&&"."===Jb.editorPaneWildCard&&Jb.message&&this.va.raiseEvent("MessageReceived",new Kh(this.oEb.VSa(),Jb.message,sb===this.btg))}}C$b(xa){const sb=pk.a.sQ(window.location.href);return!!xa&&0<xa.length&&"null"!==xa&&(xa===this.btg||xa===sb||this.Z$j.test(xa))}}Object(h.a)(Yd,"Messenger",null,[829]);class Kk{constructor(xa,sb){this.Yc=xa;this.assetId=sb.Gbh}VSa(){if(!this.Yc.instance)return oc.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const xa=this.Yc.instance.oQ(this.assetId);
return xa?xa.instanceId?xa.instanceId:(oc.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(oc.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(h.a)(Kk,"PaneIdsProvider",null,[827]);class zi{constructor(){this.Js=new Uf.a}subscribe(xa,sb){xa&&(this.Js.Gb(sb)||this.Js.add(sb,[]),Array.contains(this.Js.ga(sb),xa)||this.Js.ga(sb).push(xa))}unsubscribe(xa,sb){xa&&this.Js.Gb(sb)&&(xa=Array.indexOf(this.Js.ga(sb),
xa),-1!==xa&&Array.removeAt(this.Js.ga(sb),xa))}ADl(xa){xa&&(this.unsubscribe(xa,0),this.unsubscribe(xa,1),this.unsubscribe(xa,2))}nmj(xa){return this.Js.Gb(xa)?this.Js.ga(xa):[]}}Object(h.a)(zi,"EditorPaneSubscriptionsManager",null,[828]);class Vi{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}Zb(xa){xa&&(this.K=xa,this.K.register(Wg,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().oa(()=>new Wg(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(820,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().oa(()=>new Od(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(Ha,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().oa(()=>new Ha(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.ZFi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").xd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),Vi.iNj&&this.K.register(Ch,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().oa(()=>new Ch(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Vw,this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(821,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().oa(()=>new aj(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.K.register(xg,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().oa(()=>new xg),this.K.register(822,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().oa(()=>new Jd(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka("299"))),this.K.register(823,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().oa(()=>
new Ph),this.K.register(824,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().oa(()=>new Jh(this.K.Ja("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(825,"PowerPointWebEditor.EditorPane.IEditorPane").ma().oa(()=>new lj(this.K.resolve("Common.IActionManagerExtended"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(826,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().oa(()=>new kb),this.K.register(827,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().oa(()=>new Kk(this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(828,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().oa(()=>
new zi),this.K.register(829,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().oa(()=>new Yd(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").OIk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),this.K.register(830,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().oa(()=>new gi),this.K.register(Wa,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().oa(()=>
new Wa),this.K.register(Mc,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().oa(()=>new Mc(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Eb,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().oa(()=>new Eb(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Bj,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().oa(()=>new Bj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Qa,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().oa(()=>
new Qa(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(xi,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().oa(()=>new xi(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(gb,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().oa(()=>
new gb(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(ya,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().oa(()=>new ya(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(Aa,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().oa(()=>new Aa(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(La,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().oa(()=>new La(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").ff(()=>{var xa=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
Vi.Ejl(xa)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(xa=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),xa.wb(),xa.Ee(),xa=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),xa.wb(),xa.Ee())})}dispose(){}ZFi(){const xa=new Uf.a;xa.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));xa.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
xa.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));xa.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));xa.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));xa.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));xa.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));xa.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));xa.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));xa.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return xa}static main(){v.a.instance.Dc(new Vi)}static Ejl(xa){return xa.pptEditorConsistencyCheckIsEnabled&&Vi.LKj(xa.Gbh)}static iNj(xa){return xa.UOf}static LKj(xa){return!!xa&&0<xa.length}}
Object(h.a)(Vi,"PptWebEditorEditorPanePackage",null,[2,3]);var hi=d(12);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");
Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Object(hi.c)("AugLoop");Mb.main();rc.main();me.main();Vi.main();Object(hi.b)("AugLoop")},689:function(J,aa,d){d.d(aa,"a",function(){return v});J=d(0);var h=d(18),e=d(97),r=d(29),n=d(50);d(98);class v{constructor(){this.w_=null}get pyb(){return!1}$Dh(B,y){let x=new h.a;const A=new n.GraphTransaction(3);try{A.kd(r.App.Kb.Ld.Dn.xg),
this.Qac(y)&&(x=this.p9b(y,x)),y!==B&&this.Qac(B)&&(x=this.p9b(B,x))}finally{A&&A.dispose()}return x.toArray()}Qac(B){return!!B}Ild(B){let y=!1;for(const x of this.pde)y||!Sys.UI.DomElement.containsCssClass(B,x.className)&&!Sys.UI.DomElement.containsCssClass(B,x.w7b)||(y=!0),e.a.tKa(B,x.className),e.a.tKa(B,x.w7b)}}Object(J.a)(v,"AHighlightActor",null,[966])},690:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(e,r){this.className=e;this.w7b=r}}Object(J.a)(h,"HighlightCssClassPair",
null,[])},691:function(J,aa,d){d.d(aa,"b",function(){return n});d.d(aa,"a",function(){return v});var h=d(97);d(29);var e=d(50);d(33);d(94);var r=d(98);const n=B=>{const y=new e.GraphTransaction(3);try{y.kd(B),B.Cv(32,!0)}finally{y&&y.dispose()}},v=B=>{if(B){B=h.a.cka(B);if(-1===B.indexOf(r.a.l8)&&-1!==B.indexOf(r.a.rN)&&-1===B.indexOf(r.a.Z1b))return 2;if(-1===B.indexOf(r.a.l8)&&(-1!==B.indexOf(r.a.Y1b)||-1!==B.indexOf(r.a.FN)||-1!==B.indexOf(r.a.Z1b)||-1!==B.indexOf(r.a.SKc)||-1!==B.indexOf(r.a.FMc)||
-1!==B.indexOf(r.a.DMc)||-1!==B.indexOf(r.a.CMc)||-1!==B.indexOf(r.a.FZd)||-1!==B.indexOf(r.a.AZd)||-1!==B.indexOf(r.a.CZd)||-1!==B.indexOf(r.a.EMc)||-1!==B.indexOf(r.a.zZd)))return 1;if(-1!==B.indexOf("WACImageContainer"))return 3}return 0}},692:function(J,aa,d){d.d(aa,"a",function(){return h});J=d(0);class h{constructor(){this.type=this.action=0;this.aib=this.Ada=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19004222/wdjs/ppteditDS.augloop.js.map